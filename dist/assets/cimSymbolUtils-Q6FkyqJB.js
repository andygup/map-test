import{Jt as e,Zt as t,en as n,kt as r,on as i,rh as a,xt as o}from"./index-CZ4oMP1N.js";function s(e,t,n,r){if(e)if(e.type!==`CIMTextSymbol`){if(n&&e.effects)for(let n of e.effects)u(n,t);if(e.symbolLayers)for(let n of e.symbolLayers){switch(n.type){case`CIMPictureMarker`:case`CIMVectorMarker`:c(n,t,r);break;case`CIMPictureStroke`:case`CIMSolidStroke`:case`CIMGradientStroke`:!r?.preserveOutlineWidth&&n.width&&(n.width*=t);break;case`CIMPictureFill`:n.height&&(n.height*=t),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t);break;case`CIMHatchFill`:s(n.lineSymbol,t,!0,{...r,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t),n.separation&&(n.separation*=t)}if(n.effects)for(let e of n.effects)u(e,t)}}else e.height!=null&&(e.height*=t)}function c(e,t,n){if(e&&(e.markerPlacement&&l(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&e.anchorPointUnits===`Absolute`&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=e.size==null?0:e.size*t,e.type===`CIMVectorMarker`&&e.markerGraphics))for(let r of e.markerGraphics)e.scaleSymbolsProportionally||s(r.symbol,t,!0,n)}function l(t,n){switch(e(t)&&t.offset&&(t.offset*=n),t.type){case`CIMMarkerPlacementAlongLineRandomSize`:case`CIMMarkerPlacementAlongLineSameSize`:t.customEndingOffset&&(t.customEndingOffset*=n),t.offsetAlongLine&&(t.offsetAlongLine*=n),t.placementTemplate&&t.placementTemplate.length&&(t.placementTemplate=t.placementTemplate.map(e=>e*n));break;case`CIMMarkerPlacementAlongLineVariableSize`:t.maxRandomOffset&&(t.maxRandomOffset*=n),t.placementTemplate&&t.placementTemplate.length&&(t.placementTemplate=t.placementTemplate.map(e=>e*n));break;case`CIMMarkerPlacementOnLine`:t.startPointOffset&&(t.startPointOffset*=n);break;case`CIMMarkerPlacementAtExtremities`:t.offsetAlongLine&&(t.offsetAlongLine*=n);break;case`CIMMarkerPlacementAtMeasuredUnits`:case`CIMMarkerPlacementOnVertices`:break;case`CIMMarkerPlacementAtRatioPositions`:t.beginPosition&&(t.beginPosition*=n),t.endPosition&&(t.endPosition*=n);break;case`CIMMarkerPlacementPolygonCenter`:t.offsetX&&(t.offsetX*=n),t.offsetY&&(t.offsetY*=n);break;case`CIMMarkerPlacementInsidePolygon`:t.offsetX&&(t.offsetX*=n),t.offsetY&&(t.offsetY*=n),t.stepX&&(t.stepX*=n),t.stepY&&(t.stepY*=n)}}function u(e,t){switch(e.type){case`CIMGeometricEffectArrow`:case`CIMGeometricEffectDonut`:e.width&&(e.width*=t);break;case`CIMGeometricEffectBuffer`:e.size&&(e.size*=t);break;case`CIMGeometricEffectCut`:e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case`CIMGeometricEffectDashes`:e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length&&(e.dashTemplate=e.dashTemplate.map(e=>e*t));break;case`CIMGeometricEffectExtension`:case`CIMGeometricEffectJog`:case`CIMGeometricEffectRadial`:e.length&&(e.length*=t);break;case`CIMGeometricEffectMove`:e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case`CIMGeometricEffectOffset`:case`CIMGeometricEffectOffsetTangent`:e.offset&&(e.offset*=t);break;case`CIMGeometricEffectRegularPolygon`:e.radius&&(e.radius*=t);break;case`CIMGeometricEffectTaperedPolygon`:e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case`CIMGeometricEffectWave`:e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function d(e){let t=[];return f(i(e),t),t.length?new a(r(t[0])):null}function f(n,r){if(!n)return;let i;i=n.type===`CIMTextSymbol`?n.symbol:n;let a=n.type===`CIMPolygonSymbol`;if(i?.symbolLayers){for(let n of i.symbolLayers)if(!(n.colorLocked||a&&(o(n)||t(n)&&n.markerPlacement&&e(n.markerPlacement))))switch(n.type){case`CIMPictureMarker`:case`CIMPictureStroke`:case`CIMPictureFill`:n.tintColor&&p(r,n.tintColor);break;case`CIMVectorMarker`:n.markerGraphics?.forEach(e=>{f(e.symbol,r)});break;case`CIMSolidStroke`:case`CIMSolidFill`:p(r,n.color);break;case`CIMGradientFill`:m(r,n);break;case`CIMHatchFill`:f(n.lineSymbol,r)}}}function p(e,t){for(let n of e)if(n.join(`.`)===t.join(`.`))return;e.push(t)}function m(e,t){switch(t.colorRamp?.type){case`CIMMultipartColorRamp`:t.colorRamp.colorRamps?.forEach(t=>{t.type===`CIMLinearContinuousColorRamp`&&h(e,t)});break;case`CIMLinearContinuousColorRamp`:case`CIMPolarContinuousColorRamp`:h(e,t.colorRamp)}}function h(e,t){t&&(t.fromColor&&p(e,t.fromColor),t.toColor&&p(e,t.toColor))}function g(e,t,n){t instanceof a||(t=new a(t));let r=i(e);r&&_(r,t,n)}function _(r,i,a){if(!r)return;let s;s=r.type===`CIMTextSymbol`?r.symbol:r;let c=s?.type===`CIMPolygonSymbol`;if(s?.symbolLayers)for(let r of s.symbolLayers){if(r.colorLocked)continue;if(c){if(a){let{layersToColor:i}=a;if((o(r)||t(r)&&r.markerPlacement&&e(r.markerPlacement))&&i===`fill`||n(r)&&i===`outline`)continue}else if(o(r)||t(r)&&r.markerPlacement&&e(r.markerPlacement))continue}let s=i.toArray();switch(r.type){case`CIMPictureMarker`:case`CIMPictureStroke`:case`CIMPictureFill`:r.tintColor=s;break;case`CIMVectorMarker`:r.markerGraphics?.forEach(e=>{_(e.symbol,i,a)});break;case`CIMSolidStroke`:case`CIMSolidFill`:r.color=s;break;case`CIMGradientFill`:v(r,i);break;case`CIMHatchFill`:_(r.lineSymbol,i,a)}}}function v(e,t){switch(e.colorRamp?.type){case`CIMMultipartColorRamp`:e.colorRamp.colorRamps?.forEach(e=>{e.type===`CIMLinearContinuousColorRamp`&&y(e,t)});break;case`CIMLinearContinuousColorRamp`:case`CIMPolarContinuousColorRamp`:y(e.colorRamp,t)}}function y(e,t){if(e&&(e.fromColor&&=t.toArray(),e.toColor)){let n=t.clone();n.a=0,e.toColor=n.toArray()}}function b(e,n,r=!1){let a=i(e);if(r&&(n=360-n),a?.type!==`CIMTextSymbol`){if(a?.type===`CIMPointSymbol`&&a.symbolLayers){let e=n-(a.angle||0);for(let n of a.symbolLayers)if(t(n)){let t=n.rotation||0;n.rotateClockwise?t-=e:t+=e,n.rotation=t}a.angle=n}}else a.angle=n}export{d as i,s as n,g as r,b as t};