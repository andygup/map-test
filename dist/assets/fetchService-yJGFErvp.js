import{RS as e,_h as t,mh as n}from"./index-CZ4oMP1N.js";async function r(t,n){return(await e(t,{responseType:`json`,query:{f:`json`,...n?.customParameters,token:n?.apiKey}})).data}var i=new Set([`Catalog Layer`,`Feature Layer`,`Oriented Imagery Layer`]);async function a(e,i){let{loadContext:a,...o}=i||{},s=a?await a.fetchServiceMetadata(e,o):await r(e,o),l=t();d(s),c(s);let u={serviceJSON:s,preferredHost:l};if((s.currentVersion??0)<10.5)return u;let f=`${n()??e}/layers`,p=a?await a.fetchServiceMetadata(f,o):await r(f,o);return d(p),c(p),u.layersJSON={layers:p.layers,tables:p.tables},u}function o(e){let{type:t}=e;return!!t&&i.has(t)}function s(e){return e.type===`Table`}function c(e){e.layers=e.layers?.filter(o),e.tables=e.tables?.filter(s)}function l(e){e.type||=`Feature Layer`}function u(e){e.type||=`Table`}function d(e){e.layers?.forEach(l),e.tables?.forEach(u)}function f(e){switch(e){case`Feature Layer`:case`Table`:return`FeatureLayer`;case`Oriented Imagery Layer`:return`OrientedImageryLayer`;case`Catalog Layer`:return`CatalogLayer`}return`FeatureLayer`}export{f as n,r,a as t};