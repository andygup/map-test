import{DT as e,OT as t,Uh as n,Wh as r,Z_ as i,gD as a,iv as o,nv as s}from"./index-CZ4oMP1N.js";import"./layerViewUtils-RSw-QNoB.js";import"./Container-BuEih3Ua.js";import{t as c}from"./LayerView2D-BsKgTWnO.js";import{t as l}from"./LayerView-2jeNRFkG.js";var u=class extends l{constructor(e){super(e),this.type=`group`,this.layerViews=new o}destroy(){this.layerViews.removeAll()}_allLayerViewVisibility(e){this.layerViews.forEach(t=>{t.visible=e})}initialize(){this.addHandles([this.layerViews.on(`change`,e=>this._layerViewsChangeHandler(e)),s(()=>this.layer?.visibilityMode,()=>{this.layer&&this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(null))},i),s(()=>this.visible,e=>{this._applyVisibility(()=>this._allLayerViewVisibility(e),()=>{})},i)],`grouplayerview`),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}get creatingLayerViews(){return this.view?.layerViewManager?.isCreatingLayerViewsForLayer(this.layer)??!1}set layerViews(e){this._set(`layerViews`,r(e,this._get(`layerViews`)))}get updatingProgress(){return this.layerViews.length===0?1:this.layerViews.reduce((e,t)=>e+t.updatingProgress,0)/this.layerViews.length}isUpdating(){return this.creatingLayerViews||this.layerViews.some(e=>e.updating)}_hasLayerViewVisibleOverrides(){return this.layerViews.some(e=>e._isOverridden(`visible`))}_findLayerViewForLayer(e){return e&&this.layerViews.find(t=>t.layer===e)}_firstVisibleOnLayerOrder(){let e=this.layer.layers.find(e=>!!this._findLayerViewForLayer(e)?.visible);return e&&this._findLayerViewForLayer(e)}_applyExclusiveVisibility(e){e==null&&(e=this._firstVisibleOnLayerOrder())==null&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.at(0))),this.layerViews.forEach(t=>{t.visible=t===e})}_layerViewsChangeHandler(e){this.removeHandles(`grouplayerview:visible`),this.addHandles(this.layerViews.map(e=>s(()=>e.visible,t=>this._applyVisibility(()=>{t!==this.visible&&(e.visible=this.visible)},()=>this._applyExclusiveVisibility(t?e:null)),i)).toArray(),`grouplayerview:visible`);let t=e.added[e.added.length-1];this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(t?.visible?t:null))}_applyVisibility(e,t){this._hasLayerViewVisibleOverrides()&&(this.layer?.visibilityMode===`inherited`?e():this.layer?.visibilityMode===`exclusive`&&t())}};a([e({readOnly:!0})],u.prototype,`creatingLayerViews`,null),a([e({cast:n})],u.prototype,`layerViews`,null),a([e({readOnly:!0})],u.prototype,`updatingProgress`,null),a([e()],u.prototype,`view`,void 0),u=a([t(`esri.views.layers.GroupLayerView`)],u);var d=class extends c(u){attach(){this._updateStageChildren(),this.addAttachHandles(this.layerViews.on(`after-changes`,()=>this._updateStageChildren()))}detach(){this.container.removeAllChildren()}update(e){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,t)=>this.container.addChildAt(e.container,t))}};d=a([t(`esri.views.2d.layers.GroupLayerView2D`)],d);var f=d;export{f as default};