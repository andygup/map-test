const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/loadGLTFMesh-C0k4_Puq.js","assets/index-CzMixifc.js","assets/index-CDgdHpAj.css","assets/loader-CQRWF1Br.js","assets/quatf64-eO7UAs9K.js","assets/quat-XKFzqP_i.js","assets/BufferView-BPABY7if.js","assets/Util-YNFIi00s.js","assets/resourceUtils-BqN6xlVZ.js","assets/indexUtils-Bo96jceH.js","assets/Indices-DELx3He_.js","assets/vec3-D13Z1xO0.js","assets/vec4-CJBDH7oG.js","assets/computeTranslationToOriginAndRotation-DwwRDWAD.js","assets/projectPointToVector-D72S8Uh5.js","assets/spatialReferenceEllipsoidUtils-b6wDfyu0.js","assets/MeshComponent-B_wmH396.js","assets/MeshMaterialMetallicRoughness-dLgvoHFj.js","assets/meshCloneUtils-5rtyOBgA.js","assets/meshProperties-DwrhStLW.js","assets/MeshLocalVertexSpace-Dfv_NBsU.js","assets/MeshVertexAttributes-Dvo9ht5s.js","assets/types-DsLx34Br.js","assets/vertexSpaceConversion-WXuyjrGI.js","assets/meshVertexSpaceUtils-CrM2H6JB.js","assets/gltfexport-DlUqZkgN.js"])))=>i.map(i=>d[i]);
import{$w as e,BS as t,BT as n,Bh as r,Bm as i,Cf as a,Cl as o,Cx as s,DT as c,Ey as l,Gg as u,Hh as d,Kw as f,Ll as p,Nf as m,Nl as h,OT as g,Og as _,Ol as ee,Om as te,Q_ as ne,Rf as v,Rw as re,TT as ie,_f as ae,_m as oe,al as se,ax as ce,bf as le,bm as ue,c_ as y,eT as b,gD as x,gw as de,hw as fe,i_ as S,iv as pe,jm as me,kv as he,mC as ge,nv as _e,pf as ve,px as C,r_ as ye,rl as be,tT as xe,uD as Se,uE as w,u_ as Ce,ul as we,xm as Te,yC as Ee,yf as De,yl as Oe,zy as ke}from"./index-CzMixifc.js";import{n as Ae,t as je}from"./quatf64-eO7UAs9K.js";import{s as Me}from"./quat-XKFzqP_i.js";import{l as Ne,n as Pe,o as Fe,r as Ie,s as T}from"./axisAngleDegrees-GaSk0_KM.js";import{i as Le,n as Re,t as ze}from"./meshCloneUtils-5rtyOBgA.js";import{t as E}from"./MeshComponent-B_wmH396.js";import{n as D,t as Be}from"./MeshLocalVertexSpace-Dfv_NBsU.js";import{t as O}from"./MeshTransform-BGwY5MT4.js";import{t as k}from"./MeshVertexAttributes-Dvo9ht5s.js";import{a as A,n as Ve,o as He,r as j}from"./meshVertexSpaceUtils-CrM2H6JB.js";import{t as Ue}from"./triangulationUtils-DZOlYzLu.js";import{n as M}from"./projectPointToVector-D72S8Uh5.js";import{t as We}from"./computeTranslationToOriginAndRotation-DwwRDWAD.js";import{s as Ge,t as Ke}from"./vec3-D13Z1xO0.js";import{c as qe,d as N,f as P,h as Je,m as Ye,n as Xe,o as Ze,r as Qe,s as $e,t as et,u as tt}from"./vertexSpaceConversion-WXuyjrGI.js";import{t as nt}from"./spatialReferenceEllipsoidUtils-b6wDfyu0.js";import{i as rt,n as it,o as at}from"./External-BGzO9MR2.js";var ot=`Provided component is not part of the list of components`,st=`Expected polygon to be a Polygon instance`,F=`Expected location to be a Point instance`,ct=class extends n{constructor(){super(`invalid-input:location`,F)}};function lt(e,t,n,r){if(r!==void 0){ie(e(),`option: geographic`,{replacement:"Use mesh `vertexSpace` and spatial reference to control how operations are performed instead.",version:`4.30`,warnOnce:!0});let i=t.type===`local`;if(!A(t)||r===i)return n.isGeographic||n.isWebMercator&&r;e().warnOnce(`Specifying the 'geographic' parameter (${r}) for a Mesh vertex space of type "${t.type}" is not supported. This parameter will be ignored.`)}switch(t.type){case`georeferenced`:return n.isGeographic;case`local`:return n.isGeographic||n.isWebMercator}}var I=()=>w.getLogger(`esri.geometry.support.meshUtils.centerAt`);function ut(e,t,n){if(!e.vertexAttributes?.position)return;let{vertexSpace:r}=e,i=n?.origin??e.origin,a=lt(I,r,i.spatialReference,n?.geographic);A(r)?dt(e,t,i):a?ft(e,t,i):pt(e,t,i)}function dt(e,t,n){let{vertexSpace:r}=e;if(!A(r))return;let i=gt,a=ht;if(!M(t,a,e.spatialReference))return void P(I(),t.spatialReference,e.spatialReference,N);if(!M(n,i,e.spatialReference)){let t=e.origin;i[0]=t.x,i[1]=t.y,i[2]=t.z,P(I(),n.spatialReference,e.spatialReference,N);return}let o=Oe(_t,a,i);r.origin=h(y(),r.origin,o)}function ft(e,t,n){let r=Ce(n.x,n.y,n.z??0),i=Xe(e,new Be({origin:r}));if(!i)return;let a=Ce(t.x,t.y,t.z??0),o=Xe({vertexAttributes:i,spatialReference:e.spatialReference,vertexSpace:new Be({origin:a})},D.absolute);if(!o)return;let{position:s,normal:c,tangent:l}=o;e.vertexAttributes.position=s,e.vertexAttributes.normal=c,e.vertexAttributes.tangent=l,e.vertexAttributesChanged()}function pt(e,t,n){let r=gt,i=ht;if(M(t,i,e.spatialReference)){if(!M(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,P(I(),n.spatialReference,e.spatialReference,N);return}mt(e.vertexAttributes.position,i,r),e.vertexAttributesChanged()}else P(I(),t.spatialReference,e.spatialReference,N)}function mt(e,t,n){if(e)for(let r=0;r<e.length;r+=3)for(let i=0;i<3;i++)e[r+i]+=t[i]-n[i]}var ht=y(),gt=y(),_t=y();function vt(e){let{spatialReference:t,vertexSpace:n,untransformedBounds:r}=e,i=ae(r,bt);if(A(n)&&e.transform&&Ge(i,i,e.transform.localMatrix),n.type===`georeferenced`){let e=n.origin;return e&&Ke(i,i,e),De(a(i),t)}let o=nt(t),s=n.origin;if(!_(o,t)){let[e,n,r]=s;return new ce({xmin:e,ymin:n,zmin:r,xmax:e,ymax:n,zmax:r,spatialReference:t})}return We(t,s,yt,o),Ge(i,i,yt),u(i,o,0,i,t,0),De(a(i),t)}var yt=v(),bt=m(24);async function xt(e,t,n){switch(t.source.type){case`client`:case`service`:return St(e,t,n);case`loadable`:return t.source.load(e,n);default:Se(t.source)}}async function St(r,i,a){let{source:o}=i,{loadGLTFMesh:s}=await e(t(()=>import(`./loadGLTFMesh-C0k4_Puq.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),a),c=await wt(o,a);b(a);let l=s(new C({x:0,y:0,z:0,spatialReference:r.spatialReference}),c.url,{resolveFile:Ct(c),signal:a?.signal,expectedType:c.type,unitConversionDisabled:i.unitConversionDisabled});l.then(()=>c.dispose(),()=>c.dispose());let{mesh:{vertexAttributes:u,components:d},meta:{isDracoDecompressed:f}}=await l;if(f)throw new n(`mesh-load-external:draco-not-supported`,`The provided mesh uses Draco compression which is not supported.`);r.vertexAttributes=u,r.components=d}function Ct(e){let t=Ee(e.url);return n=>{let r=ge(n,t,t),i=r?r.replace(/^ *\.\//,``):null;return(i?e.files.get(i):null)??n}}async function wt(e,t){switch(e.type){case`client`:return Array.isArray(e.files)?Dt(e.files):Et(e.files);case`service`:return Ot(e.assets,t);default:throw new n(`mesh-load-external:invalid-source`,`Invalid source type`)}}async function Tt(e,t){let{parts:n,assetMimeType:r,assetName:i}=e;if(n.length===1)return new L(n[0].partUrl);let a=await e.toBlob(t);return b(t),L.fromBlob(a,Ft(i,r))}function Et(e){return L.fromBlob(e,Ft(e.name,e.type))}function Dt(e){if(!e.length)throw new n(`mesh-load-external:missing-assets`,`There must be at least one file to load`);return Pt(e.map(e=>({name:e.name,mimeType:e.type,source:Et(e)})))}async function Ot(e,t){if(!e.length)throw new n(`mesh-load-external:missing-assets`,`There must be at least one file to load`);let r=await re(e.map(async e=>{let n=await Tt(e);return b(t),{name:e.assetName,mimeType:e.assetMimeType,source:n}}));if(f(t))throw r.forEach(e=>e.source.dispose()),xe();return Pt(r)}var kt=/^model\/gltf\+json$/,At=/^model\/gltf-binary$/,jt=/\.gltf$/i,Mt=/\.glb$/i;function Nt({mimeType:e,source:t,name:n}){return kt.test(e)||jt.test(n)?{url:t.url,type:`gltf`}:At.test(e)||Mt.test(n)?{url:t.url,type:`glb`}:null}function Pt(e){let t=new Map,r=null,i=null;for(let n of e){let{source:e,name:a}=n;r??=Nt(n),a===`ESRI3DO_NORM.glb`&&(i=Nt(n)),t.set(a,e.url),e.files.forEach((e,n)=>t.set(n,e))}let a=i??r;if(a==null)throw new n(`mesh-load-external:missing-files`,`Missing files to load external mesh source`);return new L(a.url,()=>e.forEach(({source:e})=>e.dispose()),t,a.type)}var L=class e{constructor(e,t=()=>{},n=new Map,r){this.url=e,this.dispose=t,this.files=n,this.type=r}static fromBlob(t,n){let r=URL.createObjectURL(t);return new e(r,()=>URL.revokeObjectURL(r),void 0,n)}};function Ft(e,t){return kt.test(t)||jt.test(e)?`gltf`:At.test(t)||jt.test(e)?`glb`:void 0}var R=class extends fe{constructor(e){super(e),this.externalSources=new pe,this._explicitDisplaySource=null,this.addHandles(ne(()=>this.externalSources,`after-remove`,({item:e})=>{e===this._explicitDisplaySource&&(this._explicitDisplaySource=null)},{sync:!0,onListenerRemove:()=>this._explicitDisplaySource=null}))}get displaySource(){return this._explicitDisplaySource??this._implicitDisplaySource}set displaySource(e){if(e!=null&&!at(e))throw Error(`Cannot use this source for display: it is not in a supported format.`);this._explicitDisplaySource=e,e&&this.externalSources.every(t=>!rt(t,e))&&this.externalSources.add(e)}clearSources(){this.externalSources.removeAll()}getExternalSourcesOnService(e){return this.externalSources.items.filter(t=>it(t,e))}get _implicitDisplaySource(){return this.externalSources.find(at)}};x([c()],R.prototype,`externalSources`,void 0),x([c()],R.prototype,`displaySource`,null),x([c()],R.prototype,`_implicitDisplaySource`,null),x([c()],R.prototype,`_explicitDisplaySource`,void 0),R=x([g(`esri.geometry.support.meshUtils.Metadata`)],R);function It(){let{faceDescriptions:e,faceVertexOffsets:t,uvScales:n}=Gt,r=4*e.length,i=new Float64Array(3*r),a=new Float32Array(3*r),o=new Float32Array(2*r),s=new Uint32Array(2*e.length*3),c=0,l=0,u=0,d=0;for(let r=0;r<e.length;r++){let f=e[r],p=c/3;for(let e of t)s[d++]=p+e;let m=f.corners;for(let e=0;e<4;e++){let t=m[e],r=0;o[u++]=.25*n[e][0]+f.uvOrigin[0],o[u++]=f.uvOrigin[1]-.25*n[e][1];for(let e=0;e<3;e++)f.axis[e]===0?(i[c++]=.5*t[r++],a[l++]=0):(i[c++]=.5*f.axis[e],a[l++]=f.axis[e])}}return{position:i,normal:a,uv:o,faces:s}}function Lt(e,t){let n=e.components[0],r=n.faces,i=Kt[t],a=6*i,o=[,,,,,,],s=Array(r.length-6),c=0,l=0;for(let e=0;e<r.length;e++)e>=a&&e<a+6?o[c++]=r[e]:s[l++]=r[e];if(e.vertexAttributes.uv!=null){let t=new Float32Array(e.vertexAttributes.uv),n=4*i*2,r=[0,1,1,1,1,0,0,0];for(let e=0;e<r.length;e++)t[n+e]=r[e];e.vertexAttributes.uv=t}return e.components=[new E({faces:o,material:n.material}),new E({faces:s})],e}function Rt(e=0){let t=Math.round(8*2**e),n=2*t,r=(t-1)*(n+1)+2*n,i=new Float64Array(3*r),a=new Float32Array(3*r),o=new Float32Array(2*r),s=new Uint32Array(3*((t-1)*n*2)),c=0,l=0,u=0,d=0;for(let e=0;e<=t;e++){let r=e/t*Math.PI+.5*Math.PI,f=Math.cos(r);W[2]=Math.sin(r);let p=e===0||e===t,m=p?n-1:n;for(let r=0;r<=m;r++){let h=r/m*2*Math.PI;W[0]=-Math.sin(h)*f,W[1]=Math.cos(h)*f;for(let e=0;e<3;e++)i[c]=.5*W[e],a[c]=W[e],++c;o[l++]=(r+(p?.5:0))/n,o[l++]=e/t,e!==0&&r!==n&&(e!==t&&(s[u++]=d,s[u++]=d+1,s[u++]=d-n),e!==1&&(s[u++]=d,s[u++]=d-n,s[u++]=d-n-1)),d++}}return{position:i,normal:a,uv:o,faces:s}}function zt(e=0){let t=Math.round(16*2**e),n=4*(t+1)+2*t,r=new Float64Array(3*n),i=new Float32Array(3*n),a=new Float32Array(2*n),o=new Uint32Array(3*(4*t)),s=0,c=0,l=0,u=0,d=0;for(let e=0;e<=5;e++){let n=e===0||e===5,f=e<=1||e>=4,p=e===2||e===4,m=n?t-1:t;for(let h=0;h<=m;h++){let g=h/m*2*Math.PI,_=n?0:.5;W[0]=_*Math.sin(g),W[1]=_*-Math.cos(g),W[2]=e<=2?.5:-.5;for(let t=0;t<3;t++)r[s++]=W[t],i[c++]=f?t===2?e<=1?1:-1:0:t===2?0:W[t]/_;a[l++]=(h+(n?.5:0))/t,a[l++]=e<=1?1*e/3:e<=3?1*(e-2)/3+1/3:1*(e-4)/3+2/3,p||e===0||h===t||(e!==5&&(o[u++]=d,o[u++]=d+1,o[u++]=d-t),e!==1&&(o[u++]=d,o[u++]=d-t,o[u++]=d-t-1)),d++}}return{position:r,normal:i,uv:a,faces:o}}function Bt(e,t){let n=typeof t==`number`?t:t==null?1:t.width,r=typeof t==`number`?t:t==null?1:t.height;switch(e){case`up`:case`down`:return{width:n,depth:r};case`north`:case`south`:return{width:n,height:r};case`east`:case`west`:return{depth:n,height:r}}}function Vt(e){let t=H.facingAxisOrderSwap[e],n=H.position,r=H.normal,i=new Float64Array(n.length),a=new Float32Array(r.length),o=0;for(let e=0;e<4;e++){let e=o;for(let s=0;s<3;s++){let c=t[s],l=Math.abs(c)-1,u=c>=0?1:-1;i[o]=n[e+l]*u,a[o]=r[e+l]*u,o++}}return{position:i,normal:a,uv:new Float32Array(H.uv),faces:new Uint32Array(H.faces),isPlane:!0}}var z=1,B=2,V=3,H={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[V,z,B],west:[-V,-z,B],north:[-z,V,B],south:[z,-V,B],up:[z,B,V],down:[z,-B,-V]}};function U(e,t,n){e.isPlane||Ht(e),Wt(e,Ut(n?.size,n?.unit,t.spatialReference));let r=j(t,n),i=t.spatialReference.isGeographic?j(t):r,a=Xe({vertexAttributes:e,vertexSpace:i,spatialReference:t.spatialReference},r,{allowBufferReuse:!0});return{vertexAttributes:new k({...a,uv:e.uv}),vertexSpace:r,components:[new E({faces:e.faces,material:n?.material||null})],spatialReference:t.spatialReference}}function Ht(e){for(let t=0;t<e.position.length;t+=3)e.position[t+2]+=.5}function Ut(e,t,n){let r=Qe(t,n);if(e==null&&r===1)return null;if(e==null)return[r,r,r];if(typeof e==`number`){let t=e*r;return[t,t,t]}return[e.width==null?r:e.width*r,e.depth==null?r:e.depth*r,e.height==null?r:e.height*r]}function Wt(e,t){if(t!=null){G[0]=t[0],G[4]=t[1],G[8]=t[2];for(let t=0;t<e.position.length;t+=3){for(let n=0;n<3;n++)W[n]=e.position[t+n];we(W,W,G);for(let n=0;n<3;n++)e.position[t+n]=W[n]}if(t[0]!==t[1]||t[1]!==t[2]){G[0]=1/t[0],G[4]=1/t[1],G[8]=1/t[2];for(let t=0;t<e.normal.length;t+=3){for(let n=0;n<3;n++)W[n]=e.normal[t+n];we(W,W,G),be(W,W);for(let n=0;n<3;n++)e.normal[t+n]=W[n]}}}}var Gt={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},Kt={south:0,east:1,north:2,west:3,up:4,down:5},W=y(),G=l(),K=()=>w.getLogger(`esri.geometry.support.meshUtils.rotate`);function qt(e,t,n){if(!e.vertexAttributes?.position||t[3]===0)return;let{spatialReference:r,vertexSpace:i}=e,a=n?.origin??e.origin,o=n?.geographic,s=lt(K,i,r,o);Ve(e)?Jt(e,t,a):s?Yt(e,t,a):Xt(e,t,a)}function Jt(e,t,n){e.transform??=new O;let{vertexSpace:r,transform:i,spatialReference:a}=e,[o,s,c]=r.origin,l=new C({x:o,y:s,z:c,spatialReference:a}),u=J;if(l.equals(n))ee(u,0,0,0);else if(!et(u,n,e))return void P(K(),n.spatialReference,a,N);Me(tn,T(t),Ne(t));let d=oe(Zt,tn,S,ye,u),{localMatrix:f}=i,m=te(Zt,d,f);i.scale=Te(y(),m),me(m,m,p(J,i.scale));let h=i.rotationAxis;i.rotation=Fe(m),i.rotationAngle===0&&(i.rotationAxis=h),i.translation=ue(y(),m)}function Yt(e,t,n){let r=e.spatialReference,i=nt(r),a=en;if(!M(n,a,i)&&(P(K(),n.spatialReference,i,`Falling back to mesh origin`),!M(e.origin,a,i)))return void P(K(),e.origin.spatialReference,i);let o=e.vertexAttributes.position,s=e.vertexAttributes.normal,c=e.vertexAttributes.tangent,l=new Float64Array(o.length),u=s==null?null:new Float32Array(s.length),d=c==null?null:new Float32Array(c.length);We(i,a,Y,i),ke($t,Y);let f=Qt;we(T(Qt),T(t),$t),f[3]=t[3],tt(o,r,l,i)&&(s==null||u==null||Ye(s,o,r,l,i,u))&&(c==null||d==null||Ze(c,o,r,l,i,d))?(q(l,f,3,a),Je(l,i,o,r)&&(s==null||u==null||(q(u,f,3),$e(u,o,r,l,i,s)))&&(c==null||d==null||(q(d,f,4),qe(d,o,r,l,i,c)))?e.vertexAttributesChanged():P(K(),i,r)):P(K(),r,i)}function Xt(e,t,n){let r=en;if(!M(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,P(K(),n.spatialReference,e.spatialReference,N);return}q(e.vertexAttributes.position,t,3,r),q(e.vertexAttributes.normal,t,3),q(e.vertexAttributes.tangent,t,4),e.vertexAttributesChanged()}function q(e,t,n,r=S){if(e!=null){i(Y,Ne(t),T(t));for(let t=0;t<e.length;t+=n){for(let n=0;n<3;n++)J[n]=e[t+n]-r[n];se(J,J,Y);for(let n=0;n<3;n++)e[t+n]=J[n]+r[n]}}}var J=y(),Zt=v(),Qt=Ie(),Y=v(),$t=l(),en=y(),tn=je(),X=()=>w.getLogger(`esri.geometry.support.meshUtils.scale`);function nn(e,t,n){if(!e.vertexAttributes?.position)return;let{vertexSpace:r,spatialReference:i}=e,a=n?.origin??e.origin,o=n?.geographic,s=lt(X,r,i,o);Ve(e)?rn(e,t,a):s?an(e,t,a):on(e,t,a)}function rn(e,t,n){e.transform??=new O;let{vertexSpace:r,transform:i,spatialReference:a}=e,[o,s,c]=r.origin,l=new C({x:o,y:s,z:c,spatialReference:a}),u=Z;if(l.equals(n))ee(u,0,0,0);else if(!et(u,n,e))return void P(X(),n.spatialReference,a,N);let d=ee(cn,t,t,t),f=oe(ln,Ae,S,d,u),{localMatrix:m}=i,h=te(ln,f,m);i.scale=Te(y(),h),me(h,h,p(Z,i.scale));let g=i.rotationAxis;i.rotation=Fe(h),i.rotationAngle===0&&(i.rotationAxis=g),i.translation=ue(y(),h)}function an(e,t,n){let r=e.spatialReference,i=nt(r),a=un;if(!M(n,a,i)&&(P(X(),n.spatialReference,i,`Falling back to mesh origin`),!M(e.origin,a,i)))return void P(X(),e.origin.spatialReference,i);let o=e.vertexAttributes.position,s=e.vertexAttributes.normal,c=e.vertexAttributes.tangent,l=new Float64Array(o.length),u=s==null?null:new Float32Array(s.length),d=c==null?null:new Float32Array(c.length);tt(o,r,l,i)&&(s==null||u==null||Ye(s,o,r,l,i,u))&&(c==null||d==null||Ze(c,o,r,l,i,d))?(sn(l,t,a),Je(l,i,o,r)&&(s==null||u==null||$e(u,o,r,l,i,s))&&(c==null||d==null||qe(d,o,r,l,i,c))?e.vertexAttributesChanged():P(X(),i,r)):P(X(),r,i)}function on(e,t,n){let r=un;if(!M(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,P(X(),n.spatialReference,e.spatialReference,N);return}sn(e.vertexAttributes.position,t,r),e.vertexAttributesChanged()}function sn(e,t,n=S){if(e)for(let r=0;r<e.length;r+=3){for(let t=0;t<3;t++)Z[t]=e[r+t]-n[t];o(Z,Z,t);for(let t=0;t<3;t++)e[r+t]=Z[t]+n[t]}}var Z=y(),cn=y(),ln=v(),un=y(),Q,dn={base:null,key:`type`,defaultKeyValue:`georeferenced`,typeMap:{georeferenced:D,local:Be}},$=Q=class extends de(r(d(s))){constructor(e){super(e),this.components=null,this.vertexSpace=new D,this.transform=null,this.metadata=new R,this.hasZ=!0,this.hasM=!1,this.vertexAttributes=new k,this.type=`mesh`}initialize(){(this.metadata.externalSources.length===0||this.vertexAttributes.position.length)&&(this.loadStatus=`loaded`),this.when(()=>{this.addHandles(_e(()=>({vertexAttributes:this.vertexAttributes,components:this.components?.map(e=>e.clone())}),()=>this._clearSources(),{once:!0,sync:!0}))})}get hasExtent(){return this.loaded?this.vertexAttributes.position.length>0&&(!this.components||this.components.length>0):this.metadata.displaySource?.extent!=null}get _transformedExtent(){let{spatialReference:e,vertexSpace:t}=this,n=this;return vt({get transform(){return n.transform},vertexSpace:t,spatialReference:e,untransformedBounds:this._untransformedBounds})}get _untransformedBounds(){let{vertexAttributes:{position:e},components:t}=this;return e.length===0||t?.length===0?le(ve):a(e)}get origin(){let e=He(this.vertexSpace,this.spatialReference);if(e!=null)return e;let{center:t,zmin:n}=this._transformedExtent;return new C({x:t.x,y:t.y,z:n,spatialReference:this.spatialReference})}get extent(){return this.loaded||this.metadata?.displaySource?.extent==null?this._transformedExtent:this.metadata.displaySource.extent.clone()}addComponent(e){this._checkIfLoaded(`addComponent()`)&&(this.components||=[],this.components.push(E.from(e)),this.notifyChange(`components`))}removeComponent(e){if(this._checkIfLoaded(`removeComponent()`)){if(this.components){let t=this.components.indexOf(e);if(t!==-1)return this.components.splice(t,1),void this.notifyChange(`components`)}w.getLogger(this).error(`removeComponent()`,ot)}}rotate(e,t,n,r){return Pe(e,t,n,fn),qt(this,fn,r),this}offset(e,t,n){if(!this._checkIfLoaded(`offset()`))return this;let{vertexSpace:r,vertexAttributes:i}=this,a=i?.position;if(!a)return this;if(A(r)){let[i,a,o]=r.origin;r.origin=Ce(i+e,a+t,o+n)}else{for(let r=0;r<a.length;r+=3)a[r]+=e,a[r+1]+=t,a[r+2]+=n;this.vertexAttributesChanged()}return this}scale(e,t){return this._checkIfLoaded(`scale()`)&&nn(this,e,t),this}centerAt(e,t){return this._checkIfLoaded(`centerAt()`)&&ut(this,e,t),this}load(e){let{metadata:{displaySource:t}}=this;return t&&this.addResolvingPromise(xt(this,t,e)),Promise.resolve(this)}addExternalSources(e){this.metadata.externalSources.addMany(e)}updateDisplaySource(e){this.metadata.displaySource=e}clone(e){return super.clone(Re(ze(e)))}cloneShallow(){return new Q({components:this.components,spatialReference:this.spatialReference,vertexAttributes:this.vertexAttributes,vertexSpace:this.vertexSpace.clone(),transform:this.transform,metadata:this.metadata})}vertexAttributesChanged(){this.notifyChange(`vertexAttributes`)}async toBinaryGLTF(e){let[{toBinaryGLTF:n}]=await Promise.all([t(()=>import(`./gltfexport-DlUqZkgN.js`),__vite__mapDeps([25,1,2,11,12,4,5,13,14,15,20,17,18,6,7,23,24,8])),this.load(e)]);return b(e),await n(this,e)}get usedMemory(){return this.components?this.components.reduce((e,t)=>e+t.memoryUsage,this.vertexAttributes.usedMemory):this.vertexAttributes.usedMemory}_clearSources(){this.metadata.clearSources()}_checkIfLoaded(e){return!!this.loaded||(w.getLogger(this).error(e,`Mesh must be loaded before applying operations`),!1)}static createBox(e,t){if(!(e instanceof C))return w.getLogger(this.prototype).error(`.createBox()`,F),null;let n=new Q(U(It(),e,t));return t?.imageFace&&t.imageFace!==`all`?Lt(n,t.imageFace):n}static createSphere(e,t){return e instanceof C?new Q(U(Rt(t?.densificationFactor||0),e,t)):(w.getLogger(this.prototype).error(`.createSphere()`,F),null)}static createCylinder(e,t){return e instanceof C?new Q(U(zt(t?.densificationFactor||0),e,t)):(w.getLogger(this.prototype).error(`.createCylinder()`,F),null)}static createPlane(e,t){if(!(e instanceof C))return w.getLogger(this.prototype).error(`.createPlane()`,F),null;let n=t?.facing??`up`,r=Bt(n,t?.size);return new Q(U(Vt(n),e,{...t,size:r}))}static createFromPolygon(e,t){if(!(e instanceof he))return w.getLogger(this.prototype).error(`.createFromPolygon()`,st),null;let n=Ue(e);return new Q({vertexAttributes:new k({position:n.position}),components:[new E({faces:n.faces,shading:`flat`,material:t?.material??null})],spatialReference:e.spatialReference,vertexSpace:new D})}static async createFromGLTF(n,r,i){if(!(n instanceof C)){let e=new ct;throw w.getLogger(this.prototype).error(`.createfromGLTF()`,e.message),e}let{loadGLTFMesh:a}=await e(t(()=>import(`./loadGLTFMesh-C0k4_Puq.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),i);return new Q((await a(n,r,i)).mesh)}static createWithExternalSource(e,t,n){let r=n?.extent??null,{spatialReference:i}=e,a=n?.transform?.clone()??new O,o=j(e,n),s=n?.unitConversionDisabled,c={source:t,extent:r,unitConversionDisabled:s},l=new R;return l.externalSources.push(c),new Q({metadata:l,transform:a,vertexSpace:o,spatialReference:i})}static createIncomplete(e,t){let{spatialReference:r}=e,i=t?.transform?.clone()??new O,a=j(e,t),o=new Q({transform:i,vertexSpace:a,spatialReference:r});return o.addResolvingPromise(Promise.reject(new n(`mesh-incomplete`,`Mesh resources are not complete`))),o}};x([c({type:[E],json:{write:!0}})],$.prototype,`components`,void 0),x([c({nonNullable:!0,types:dn,constructOnly:!0,json:{write:!0},clonable:(e,t)=>Le(t)?.vertexSpace??e.clone(t)})],$.prototype,`vertexSpace`,void 0),x([c({type:O,clonable:(e,t)=>{let n=Le(t);return n&&`transform`in n?n.transform:e?.clone()??e},json:{write:!0}})],$.prototype,`transform`,void 0),x([c({constructOnly:!0,type:R,clonable:(e,t)=>Le(t)?.metadata??e.clone()})],$.prototype,`metadata`,void 0),x([c()],$.prototype,`hasExtent`,null),x([c()],$.prototype,`_transformedExtent`,null),x([c()],$.prototype,`_untransformedBounds`,null),x([c()],$.prototype,`origin`,null),x([c({readOnly:!0,json:{read:!1}})],$.prototype,`extent`,null),x([c({readOnly:!0,json:{read:!1,write:!0,default:!0}})],$.prototype,`hasZ`,void 0),x([c({readOnly:!0,json:{read:!1,write:!0,default:!1}})],$.prototype,`hasM`,void 0),x([c({type:k,nonNullable:!0,json:{write:!0},clonable:(e,t)=>Le(t)?.vertexAttributes??e.clone(t)})],$.prototype,`vertexAttributes`,void 0),$=Q=x([g(`esri.geometry.Mesh`)],$);var fn=Ie();export{$ as t};