import{$m as e,CE as t,C_ as n,Fl as r,Hl as i,Jf as a,Nl as o,Rl as s,Ul as c,Um as l,Vl as u,Xm as d,gl as f,hl as p,hw as ee,kl as m,pl as h,ux as te,x_ as g,xl as _,y_ as ne,yl as re,zl as ie}from"./index-BN8X5Ryz.js";import{C as ae,S as oe,a as se,b as v,c as y,d as b,g as ce,j as x,o as le,r as S,s as ue,t as de,v as fe,y as C}from"./plane-Da5EsY0J.js";import{t as w}from"./vectorStacks-Cuo89CNO.js";import{t as T}from"./ObjectStack-l5kM7JZu.js";import{o as pe}from"./ray-LkJ58wpZ.js";import{d as me,s as he,t as E}from"./lineSegment-BudcKS0C.js";var D=()=>t.getLogger(`esri.views.3d.support.geometryUtils.boundedPlane`);function O(e=J){return{plane:C(e.plane),origin:n(e.origin),basis1:n(e.basis1),basis2:n(e.basis2)}}function ge(e,t,n){let r=je.get();return r.origin=e,r.basis1=t,r.basis2=n,r.plane=fe(0,0,0,0),j(r),r}function k(e,t=O()){return A(e.origin,e.basis1,e.basis2,t)}function _e(e,t){i(t.origin,e.origin),i(t.basis1,e.basis1),i(t.basis2,e.basis2),ae(t.plane,e.plane)}function A(e,t,n,r=O()){return i(r.origin,e),i(r.basis1,t),i(r.basis2,n),j(r),ke(r,`fromValues()`),r}function j(e){S(e.basis2,e.basis1,e.origin,e.plane)}function M(e,t,n){e!==n&&k(e,n);let r=o(w.get(),U(e),t);return c(n.origin,n.origin,r),n.plane[3]-=t,n}function ve(e,t,n){return N(t,n),M(n,H(e,e.origin),n),n}function ye(e,t){let n=e.basis1[0],r=e.basis2[1],[i,a]=e.origin;return te(i-n,a-r,i+n,a+r,t)}function N(e,t=O()){let n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return s(t.origin,e[0]+n,e[1]+r,0),s(t.basis1,n,0,0),s(t.basis2,0,r,0),oe(0,0,1,0,t.plane),t}function P(e,t,n){return!!se(e.plane,t,n)&&W(e,n)}function be(e,t,n){if(P(e,t,n))return n;let r=F(e,t,w.get());return c(n,t.origin,o(w.get(),t.direction,ie(t.origin,r)/u(t.direction))),n}function F(e,t,n){let r=Y.get();q(e,t,r,Y.get());let a=1/0;for(let o of Z){let s=K(e,o,X.get()),c=w.get();if(le(r,s,c)){let e=re(w.get(),t.origin,c),r=Math.abs(ee(_(t.direction,e)));r<a&&(a=r,i(n,c))}}return a===1/0?I(e,t,n):n}function xe(e,t){return(t-e)/t}function I(e,t,n){if(P(e,t,n))return n;let r=Y.get(),a=Y.get();q(e,t,r,a);let o=1/0;for(let s of Z){let c=K(e,s,X.get()),l=w.get();if(ue(r,c,l)){let e=pe(t,l);if(!y(a,l))continue;e<o&&(o=e,i(n,l))}}return z(e,t.origin)<o&&L(e,t.origin,n),n}function L(e,t,n){let r=b(e.plane,t,w.get()),i=E(G(e,e.basis1),r,-1,1,w.get()),a=E(G(e,e.basis2),r,-1,1,w.get());return m(n,c(w.get(),i,a),e.origin),n}function R(e,t,n){let{origin:r,basis1:i,basis2:a}=e,o=m(w.get(),t,r),c=x(i,o),l=x(a,o),u=x(U(e),o);return s(n,c,l,u)}function z(e,t){let n=R(e,t,w.get()),{basis1:r,basis2:i}=e,a=u(r),o=u(i),s=Math.max(Math.abs(n[0])-a,0),c=Math.max(Math.abs(n[1])-o,0),l=n[2];return s*s+c*c+l*l}function B(e,t){return Math.sqrt(z(e,t))}function V(e,t){let n=-1/0;for(let r of Z){let i=K(e,r,X.get()),a=he(i,t);a>n&&(n=a)}return Math.sqrt(n)}function Se(e,t){return ce(e.plane,t)>0&&W(e,t)}function Ce(e,t,n,r){return Oe(e,n,r)}function H(e,t){let n=-e.plane[3];return x(U(e),t)-n}function we(e,t,n,r){let i=H(e,t),a=o(Ae,U(e),n-i);return c(r,t,a),r}function Te(e,t){return f(e.basis1,t.basis1)&&f(e.basis2,t.basis2)&&f(e.origin,t.origin)}function Ee(t,n,r){return t!==r&&k(t,r),l(Q,n),e(Q,Q),p(r.basis1,t.basis1,Q),p(r.basis2,t.basis2,Q),p(v(r.plane),v(t.plane),Q),p(r.origin,t.origin,n),de(r.plane,r.plane,r.origin),r}function De(e,t,n,r){return e!==r&&k(e,r),d($,t,n),p(r.basis1,e.basis1,$),p(r.basis2,e.basis2,$),j(r),r}function U(e){return v(e.plane)}function Oe(e,t,n){switch(t){case 0:i(n,e.basis1),h(n,n);break;case 1:i(n,e.basis2),h(n,n);break;case 2:i(n,U(e))}return n}function W(e,t){let n=m(w.get(),t,e.origin),i=r(e.basis1),a=r(e.basis2),o=_(e.basis1,n),s=_(e.basis2,n);return-o-i<0&&o-i<0&&-s-a<0&&s-a<0}function G(e,t){let n=X.get();return i(n.origin,e.origin),i(n.vector,t),n}function K(e,t,n){let{basis1:r,basis2:i,origin:a}=e,s=o(w.get(),r,t.origin[0]),l=o(w.get(),i,t.origin[1]);c(n.origin,s,l),c(n.origin,n.origin,a);let u=o(w.get(),r,t.direction[0]),d=o(w.get(),i,t.direction[1]);return o(n.vector,c(u,u,d),2),n}function ke(e,t){Math.abs(_(e.basis1,e.basis2)/(u(e.basis1)*u(e.basis2)))>1e-6&&D().warn(t,`Provided basis vectors are not perpendicular`),Math.abs(_(e.basis1,U(e)))>1e-6&&D().warn(t,`Basis vectors and plane normal are not perpendicular`),Math.abs(-_(U(e),e.origin)-e.plane[3])>1e-6&&D().warn(t,`Plane offset is not consistent with plane origin`)}function q(e,t,n,r){let i=U(e);S(i,t.direction,t.origin,n),S(v(n),i,t.origin,r)}var J={plane:C(),origin:g(0,0,0),basis1:g(1,0,0),basis2:g(0,1,0)},Y=new T(C),X=new T(me),Ae=ne(),je=new T(()=>O()),Z=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Q=a(),$=a(),Me=Object.freeze(Object.defineProperty({__proto__:null,altitudeAt:H,axisAt:Ce,cameraFrustumCoverage:xe,closestPoint:I,closestPointOnSilhouette:F,copy:k,copyWithoutVerify:_e,create:O,distance:B,distance2:z,distanceToSilhouette:V,elevate:M,equals:Te,extrusionContainsPoint:Se,fromAABoundingRect:N,fromValues:A,getExtent:ye,intersectRay:P,intersectRayClosestSilhouette:be,normal:U,projectPoint:L,projectPointLocal:R,rotate:De,setAltitudeAt:we,setExtent:ve,transform:Ee,up:J,updateUnboundedPlane:j,wrap:ge},Symbol.toStringTag,{value:`Module`}));export{k as a,j as i,O as n,Me as o,A as r,B as s,N as t};