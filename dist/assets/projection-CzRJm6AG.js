import{dx as g,dy as C,dz as _,dA as j,dB as L,dC as R,dD as w,cG as v,dE as O,dF as N,bn as b,dG as S,dH as B,dI as W,c6 as z,dJ as J,dK as Y,dL as q,cd as G,ck as D,dM as H,cj as I,dN as K,cA as U}from"./index-DzfnmjFP.js";import{t as V,o as Q}from"./DoubleArray-vvGJsfPE.js";import{i as A,T as F}from"./BufferView-DowTxg_p.js";import{f as X,l as k,e as x}from"./vec3-Lc_U4bRi.js";import{n as Z}from"./vec4-D8kcCT2e.js";const ir="Projection may be possible after calling projection.load().";function fr(r,o,t,a){r.error(`Failed to project from (wkid:${o.wkid}) to (wkid:${t.wkid}).${a?" ":""}${a}`)}function lr(r,o,t,a,e){return E(y.TO_PCPF,A.fromTypedArray(r),u.NORMAL,F.fromTypedArray(o),F.fromTypedArray(t),a,A.fromTypedArray(e))?e:null}function ur(r,o,t,a,e){return E(y.FROM_PCPF,A.fromTypedArray(r),u.NORMAL,F.fromTypedArray(o),F.fromTypedArray(t),a,A.fromTypedArray(e))?e:null}function Tr(r,o,t){return g(r,o,0,t,C(o),0,r.length/3)?t:null}function pr(r,o,t){return g(r,C(t),0,o,t,0,r.length/3)?o:null}function dr(r,o,t){return _(f,t),X(o,r,f),j(f)&&k(o,o),o}function Pr(r,o,t){return L(f,t),Z(o,r,f),j(f)&&k(o,o,4),o}function mr(r,o,t,a){const e=o===u.NORMAL;return $(r,o,t,(c,l)=>{const n=Math.cos(U(c));l[0]=e?n:1/n,l[1]=1},a)}function yr(r,o,t,a){const e=o===u.NORMAL;return $(r,o,t,(c,l)=>{const n=Math.cosh(-c/K.radius);l[0]=1,l[1]=e?n:1/n},a)}function $(r,o,t,a,e){const c=o===u.NORMAL?3:4,l=[0,0];for(let n=0,T=1;n<r.length;n+=c,T+=3){a(t[T],l);const i=r[n]*l[0],p=r[n+1]*l[1],s=r[n+2],P=1/Math.sqrt(i*i+p*p+s*s);e[n]=i*P,e[n+1]=p*P,e[n+2]=s*P,c===4&&(e[n+3]=r[n+3])}return e}function Ar(r,o,t,a,e){if(!E(y.TO_PCPF,A.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),u.TANGENT,F.fromTypedArray(o),F.fromTypedArray(t),a,A.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let c=3;c<r.length;c+=4)e[c]=r[c];return e}function Fr(r,o,t,a,e){if(!E(y.FROM_PCPF,A.fromTypedArray(r,16),u.TANGENT,F.fromTypedArray(o),F.fromTypedArray(t),a,A.fromTypedArray(e,16)))return null;for(let c=3;c<r.length;c+=4)e[c]=r[c];return e}var u,y;function h(r,o,t,a,e){switch(S(a,t,m,a),r===y.FROM_PCPF&&I(m,m),o){case u.NORMAL:return _(e,m);case u.TANGENT:return L(e,m)}}function E(r,o,t,a,e,c,l){if(!o)return;const n=a.count,T=C(c);if(tr(c))for(let i=0;i<n;i++)e.getVec(i,M),o.getVec(i,d),R(d,d,h(r,t,M,T,f)),l.setVec(i,d);else for(let i=0;i<n;i++){e.getVec(i,M),o.getVec(i,d);const p=w(a.get(i,1));let s=Math.cos(p);t===u.TANGENT!=(r===y.TO_PCPF)&&(s=1/s),h(r,t,M,T,f),r===y.TO_PCPF?(f[0]*=s,f[1]*=s,f[2]*=s,f[3]*=s,f[4]*=s,f[5]*=s):(f[0]*=s,f[3]*=s,f[6]*=s,f[1]*=s,f[4]*=s,f[7]*=s),R(d,d,f),v(d,d),l.setVec(i,d)}return l}function Nr(r){return r.vertexSpace.type==="local"?rr(r):or(r)}function rr({vertexSpace:r,transform:o,inSpatialReference:t,outSpatialReference:a,localMode:e,outPositions:c,positions:l}){const n=r.origin??O,T=r.origin!=null?(o==null?void 0:o.localMatrix)??N:N,i=C(t),p=a.isWebMercator&&e||!b(t,i)?t:i;S(t,n,m,p),B(m,m,T);const s=c??V(l.length);return x(s,l,m),g(s,p,0,s,a,0,s.length/3),s}function or({vertexSpace:r,transform:o,outPositions:t,positions:a,inSpatialReference:e,outSpatialReference:c}){const l=r.origin!=null?(o==null?void 0:o.localMatrix)??N:N,n=t??V(a.length);W(l,N)?Q(n,a):x(n,a,l);const T=r.origin??O;if(!z(T,O)){const[i,p,s]=T;for(let P=0;P<n.length;P+=3)n[P]+=i,n[P+1]+=p,n[P+2]+=s}return g(n,e,0,n,c,0,n.length/3)?n:null}function tr(r){return r.isWGS84||J(r)||Y(r)||q(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(u||(u={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(y||(y={}));const M=G(),d=G(),m=D(),f=H();export{u as VectorType,ir as loadProjectErrorMessage,fr as logProjectionError,Nr as project,pr as projectFromPCPF,ur as projectNormalFromPCPF,lr as projectNormalToPCPF,Fr as projectTangentFromPCPF,Ar as projectTangentToPCPF,Tr as projectToPCPF,dr as transformNormal,Pr as transformTangent,mr as transformVectorENUPlateCarree,yr as transformVectorWMPlateCarree};
