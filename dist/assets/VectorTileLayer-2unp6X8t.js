import{A as e,AC as t,AT as n,BT as r,CS as i,DT as a,Dh as o,Ha as s,IE as c,Jw as l,Kw as u,L as d,LE as f,Li as p,M as m,Ma as h,OC as g,OT as ee,RS as _,SC as v,SE as y,Uo as b,VC as te,_C as x,aE as ne,ax as S,bx as C,cC as w,ca as re,dg as ie,eT as T,gC as E,gD as D,j as O,jT as k,kC as A,lC as j,mS as M,ma as ae,nT as oe,pa as se,px as ce,qw as le,tC as ue,tl as N,uE as de,ua as fe,vT as pe,wC as P,wx as me,xg as F,yC as I,yg as L}from"./index-CzMixifc.js";import"./memoryEstimations-C3WUBUZI.js";import"./TileInfoTilemapCache-BaA3PaKH.js";import{t as R}from"./TilemapCache-COWu3ipP.js";import{t as z}from"./ArcGISCachedService-CKzfjz3U.js";import"./colorUtils-Btp0B-0Y.js";import"./constants-BLcRkv0L.js";import"./GeometryUtils-C6BJBMi9.js";import{t as he}from"./StyleRepository-BDcTsPYe.js";import"./VertexAttributeLocations-DOYYzMyn.js";import"./VertexElementDescriptor-C9CNG143.js";var B=null;function ge(e){if(B)return B;let t={lossy:`UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA`,lossless:`UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==`,alpha:`UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==`,animation:`UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA`};return B=new Promise(n=>{let r=new Image;r.onload=()=>{r.onload=r.onerror=null,n(r.width>0&&r.height>0)},r.onerror=()=>{r.onload=r.onerror=null,n(!1)},r.src=`data:image/webp;base64,`+t[e]}),B}var V=1.15,H=class{constructor(e,t){this._spriteSource=e,this._maxTextureSize=t,this.devicePixelRatio=1,this._spriteImageFormat=`png`,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus=`not-loaded`,e.type===`url`&&e.spriteFormat&&(this._spriteImageFormat=e.spriteFormat),e.pixelRatio&&(this.devicePixelRatio=e.pixelRatio),this.baseURL=e.spriteUrl}get spriteNames(){let e=[];for(let t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData?this._spritesData[e]:null}async load(e){if(this.baseURL){this.loadStatus=`loading`;try{await this._loadSprites(e),this.loadStatus=`loaded`}catch{this.loadStatus=`failed`}}else this.loadStatus=`failed`}async _loadSprites(e){this._isRetina=this.devicePixelRatio>V;let{width:t,height:n,data:i,json:a}=await this._getSpriteData(this._spriteSource,e),o=Object.keys(a);if(!o||o.length===0||!i)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=a,this.width=t,this.height=n;let s=Math.max(this._maxTextureSize,4096);if(t>s||n>s){let e=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${s} pixels}`;throw de.getLogger(`esri.layers.support.SpriteSource`).error(e),new r(`SpriteSource`,e)}let c;for(let e=0;e<i.length;e+=4)c=i[e+3]/255,i[e]=i[e]*c,i[e+1]=i[e+1]*c,i[e+2]=i[e+2]*c;this.image=i}async _getSpriteData(e,t){if(e.type===`image`){let t,n;if(this.devicePixelRatio<V){if(!e.spriteSource1x)throw new r(`SpriteSource`,`no image data provided for low resolution sprites!`);t=e.spriteSource1x.image,n=e.spriteSource1x.json}else{if(!e.spriteSource2x)throw new r(`SpriteSource`,`no image data provided for high resolution sprites!`);t=e.spriteSource2x.image,n=e.spriteSource2x.json}return`width`in t&&`height`in t&&`data`in t&&(c(t.data)||f(t.data))?{width:t.width,height:t.height,data:new Uint8Array(t.data),json:n}:{...U(t),json:n}}let n=E(this.baseURL),i=n.query?`?`+w(n.query):``,a=this._isRetina?`@2x`:``,o=`${n.path}${a}.${this._spriteImageFormat}${i}`,s=`${n.path}${a}.json${i}`,[l,u]=await Promise.all([_(s,t),_(o,{responseType:`image`,...t})]);return{...U(u.data),json:l.data}}};function U(e){let t=document.createElement(`canvas`),n=t.getContext(`2d`);t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(r.data)}}var _e=class{constructor(e){this.url=e}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||=_(this.url).then(e=>e.data.index),this._tileIndexPromise}async dataKey(e,t){let n=await this.fetchTileIndex();return T(t),this._getIndexedDataKey(n,e)}_getIndexedDataKey(e,t){let n=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return null;let r=t;for(;r.level!==0;)r=new N(r.level-1,r.row>>1,r.col>>1,r.world),n.push(r);let i,a,o=e,s=n.pop();if(o===1)return s;for(;n.length;)if(i=n.pop(),a=(1&i.col)+((1&i.row)<<1),o){if(o[a]===0){s=null;break}if(o[a]===1){s=i;break}s=i,o=o[a]}return s}},ve=class{constructor(e,t){this._tilemap=e,this._tileIndexUrl=t}destroy(){this._tilemap=pe(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(e){return this._tileIndexPromise||=_(this._tileIndexUrl,{query:{...e?.query}}).then(e=>e.data.index),this._tileIndexPromise}dataKey(e,t){let{level:n,row:r,col:i}=e,a=new N(e);return this._tilemap.fetchAvailabilityUpsample(n,r,i,a,t).then(()=>(a.world=e.world,a)).catch(e=>{if(le(e))throw e;return null})}},ye=class{constructor(e){this._tileUrl=e,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(e){(this._promise==null||u(this._abortController?.signal))&&(this._promise=this._makeRequest(this._tileUrl));let t=this._abortOptions;return t.push(e),oe(e,()=>{t.every(e=>u(e))&&this._abortController.abort()}),this._promise.then(e=>y(e))}async _makeRequest(e){this._abortController=new AbortController;let{data:t}=await _(e,{responseType:`array-buffer`,signal:this._abortController.signal});return t}},W=new Map;function be(e,t,n,r,i){let a=E(e),o=a.query;if(o)for(let[e,i]of Object.entries(o))switch(i){case`{x}`:o[e]=r.toString();break;case`{y}`:o[e]=n.toString();break;case`{z}`:o[e]=t.toString()}let s=a.path;return xe(j(s.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,n.toString()).replaceAll(/\{x\}/gi,r.toString()),{...a.query}),i)}function xe(e,t){return ne(W,e,()=>new ye(e)).getData(t).finally(()=>W.delete(e))}var Se=class{constructor(e,t,n){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=e,this.sourceUrl=t;let r=E(this.sourceUrl),i=y(n),a=i.tiles;if(r)for(let e=0;e<a.length;e++){let t=E(a[e]);t&&(P(t.path)||(t.path=v(r.path,t.path)),a[e]=j(t.path,{...r.query,...t.query}))}this.tileServers=a;let o=n.capabilities&&n.capabilities.split(`,`).map(e=>e.toLowerCase().trim()),s=!0===n?.exportTilesAllowed,c=!0===o?.includes(`tilemap`),l=s&&n.hasOwnProperty(`maxExportTilesCount`)?n.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:s,supportsTileMap:c},exportTiles:s?{maxExportTilesCount:+l}:null},this.tileInfo=L.fromJSON(i.tileInfo);let u=n.tileMap?j(v(r.path,n.tileMap),r.query??{}):null;c?(this.type=`vector-tile`,this.tilemap=new ve(new R({layer:{parsedUrl:r,tileInfo:this.tileInfo},minLOD:i.minLOD??this.tileInfo.lods[0].level,maxLOD:i.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),u)):u&&(this.tilemap=new _e(u)),this.fullExtent=S.fromJSON(n.fullExtent),this.initialExtent=S.fromJSON(n.initialExtent)}destroy(){this.tilemap?.destroy()}async getRefKey(e,t){return this.tilemap?this.tilemap.dataKey(e,t):e}requestTile(e,t,n,r){let i=this.tileServers[t%this.tileServers.length];return be(i,e,t,n,r)}isCompatibleWith(e){let t=this.tileInfo,n=e.tileInfo;if(!t.spatialReference.equals(n.spatialReference)||!t.origin.equals(n.origin)||Math.round(t.dpi)!==Math.round(n.dpi))return!1;let r=t.lods,i=n.lods,a=Math.min(r.length,i.length);for(let e=0;e<a;e++){let t=r[e],n=i[e];if(t.level!==n.level||Math.round(t.scale)!==Math.round(n.scale))return!1}return!0}};async function Ce(e,t){let n={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:``,spriteFormat:`png`},[r,i]=typeof e==`string`?[e,null]:[null,e.jsonUrl];return await K(n,`esri`,e,i,t),{layerDefinition:n.validatedSource,url:r,serviceUrl:n.sourceUrl,style:n.style,styleUrl:n.styleUrl,spriteUrl:n.style&&n.style.sprite&&G(n.styleBase,n.style.sprite),spriteFormat:n.spriteFormat,glyphsUrl:n.style&&n.style.glyphs&&G(n.styleBase,n.style.glyphs),sourceNameToSource:n.sourceNameToSource,primarySourceName:n.primarySourceName}}function G(...e){let n;for(let t of e)t!=null&&(g(t)?n&&=n.split(`://`)[0]+`:`+t.trim():n=P(t)?t:v(n,t));return n?t(n):void 0}async function K(e,t,n,r,i){let a,o,s;if(T(i),typeof n==`string`){let e=x(n);s=await _(e,{...i,responseType:`json`,query:{f:`json`,...i?.query}}),s.ssl&&(a&&=a.replace(/^http:/i,`https:`),o&&=o.replace(/^http:/i,`https:`)),a=e,o=e}else n!=null&&(s={data:n},a=n.jsonUrl||null,o=r);let c=s?.data;if(J(c))return e.styleUrl=a||null,Te(e,c,o,i);if(we(c))return e.sourceUrl?Y(e,c,o,!1,t,i):(e.sourceUrl=a||null,q(c)&&e.style==null&&(t=`tilejson`),Y(e,c,o,!0,t,i));throw Error(`You must specify the URL or the JSON for a service or for a style.`)}function q(e){return typeof e==`object`&&!!e&&`tilejson`in e&&e.tilejson!=null}function J(e){return!!e&&`sources`in e&&!!e.sources}function we(e){return!J(e)}async function Te(e,t,n,r){let i=n?I(n):A();e.styleBase=i,e.style=t,t[`sprite-format`]&&t[`sprite-format`].toLowerCase()===`webp`&&(e.spriteFormat=`webp`);let a=[];if(t.sources&&t.sources.esri){let n=t.sources.esri;n.url?await K(e,`esri`,G(i,n.url),void 0,r):a.push(K(e,`esri`,n,i,r))}for(let n of Object.keys(t.sources))n!==`esri`&&n!==`tilejson`&&t.sources[n].type===`vector`&&(t.sources[n].url?a.push(K(e,n,G(i,t.sources[n].url),void 0,r)):t.sources[n].tiles&&a.push(K(e,n,t.sources[n],i,r)));await Promise.all(a)}async function Y(e,n,r,i,a,o){let s=r?t(r)+`/`:A(),c=Ee(n,e),l=new Se(a,j(s,o?.query??{}),c);if(!i&&e.primarySourceName in e.sourceNameToSource){let t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(l))return;l.fullExtent!=null&&(t.fullExtent==null?t.fullExtent=l.fullExtent.clone():t.fullExtent.union(l.fullExtent)),t.tileInfo&&l.tileInfo&&t.tileInfo.lods.length<l.tileInfo.lods.length&&(t.tileInfo=l.tileInfo)}if(i&&(e.sourceBase=s,e.source=n,e.validatedSource=c,e.primarySourceName=a),e.sourceNameToSource[a]=l,!q(e)&&`defaultStyles`in n&&!e.style){if(n.defaultStyles==null)throw Error();return typeof n.defaultStyles==`string`?K(e,``,G(s,n.defaultStyles,`root.json`),void 0,o):K(e,``,n.defaultStyles,G(s,`root.json`),o)}if(q(n)&&e.style==null&&c.defaultStyles)return K(e,``,c.defaultStyles,G(s,`root.json`),o)}function Ee(e,t){if(X(e)){let t=e?.tileInfo;return t!=null&&(t.rows??=512,t.cols??=512),e}let n={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100,latestWkid:3857}},r,a=null;if(q(e)){let{bounds:n,vector_layers:o}=e;if(n){let e=C({x:n[0],y:n[1],spatialReference:y(M)}),t=C({x:n[2],y:n[3],spatialReference:y(M)});a={xmin:e.x,ymin:e.y,xmax:t.x,ymax:t.y,spatialReference:y(i)}}if(o&&o.length>0)r={version:8,sprite:``,glyphs:``,sources:{tilejson:{type:`vector`,url:e.tilejson}},layers:De(o)};else if(t.style==null)throw Error(`The TileJSON source does not contain any vector_layers. This VectorTileLayer cannot be loaded.`)}a===null&&(a=n);let o=78271.51696400007,s=295828763.7957775,c=[],l=e.hasOwnProperty(`maxzoom`)&&e.maxzoom!=null?Math.abs(+e.maxzoom):22;for(let e=0;e<=l;e++)c.push({level:e,scale:s,resolution:o}),o/=2,s/=2;return{capabilities:`TilesOnly`,initialExtent:a,fullExtent:n,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:`pbf`,origin:{x:-20037508.342787,y:20037508.342787},lods:c,spatialReference:y(i)},defaultStyles:r}}function X(e){return e.hasOwnProperty(`tileInfo`)}function De(e){let t=[];for(let n of e)n.geometry_type?t.push(Z(n.geometry_type.toLowerCase(),n,!1)):(t.push(Z(`polygon`,n,!0)),t.push(Z(`line`,n,!0)),t.push(Z(`circle`,n,!0)));return t}function Z(e,t,n){let{id:r,minzoom:i,maxzoom:a}=t,o={type:e===`polygon`||e===`polygons`?`fill`:e===`line`||e===`lines`?`line`:`circle`,id:r,source:`tilejson`,"source-layer":r,minzoom:i,maxzoom:a};switch(e){case`fill`:n&&(o.id+=`_polygon`,o.filter=`(["==", "$type", "Polygon"])`),o.paint={"fill-color":`#808080`};break;case`line`:n&&(o.id+=`_line`,o.filter=`(["==", "$type", "LineString"])`);break;case`circle`:n&&(o.id+=`_point`,o.filter=`(["==", "$type", "Point"])`)}return o}var Q=1e-6;function Oe(e,t){if(e===t)return!0;if(e==null&&t!=null||e!=null&&t==null||e==null||t==null||!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;let n=e.origin,r=t.origin;if(Math.abs(n.x-r.x)>=Q||Math.abs(n.y-r.y)>=Q)return!1;let i,a;e.lods[0].scale>t.lods[0].scale?(i=e,a=t):(a=e,i=t);for(let e=i.lods[0].scale;e>=a.lods[a.lods.length-1].scale-Q;e/=2)if(Math.abs(e-a.lods[0].scale)<Q)return!0;return!1}function ke(e,t){if(e===t)return e;if(e==null&&t!=null)return t;if(e!=null&&t==null)return e;if(e==null||t==null)return null;let n=e.size[0],r=e.format,i=e.dpi,a=new ce({x:e.origin.x,y:e.origin.y}),o=e.spatialReference,s=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],c=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],l=s.scale,u=s.resolution,d=c.scale,f=[],p=l,m=u,h=0;for(;p>=d;)f.push(new F({level:h,resolution:m,scale:p})),h++,p/=2,m/=2;return new L({size:[n,n],dpi:i,format:r||`pbf`,origin:a,lods:f,spatialReference:o})}var $=class extends fe(e(O(z(se(d(m(re(ae(s(o)))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType=`VectorTileLayer`,this.path=null,this.refreshInterval=0,this.style=null,this.tilemapCache=null,this.type=`vector-tile`}normalizeCtorArgs(e,t){return typeof e==`string`?{url:e,...t}:e}destroy(){if(this.sourceNameToSource)for(let e of Object.values(this.sourceNameToSource))e?.destroy();this.primarySource?.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){let t=this.loadFromPortal({supportedTypes:[`Vector Tile Service`],supportsData:!1},e).catch(l).then(async()=>{if(!this.portalItem?.id)return;let t=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await _(t,{...e,query:{f:`json`,...this.customParameters,token:this.apiKey},authMode:this.portalItem.portal.authMode})).data&&this.read({url:t},h(this.portalItem,`portal-item`))}).catch(l).then(()=>this._loadStyle(e));return this.addResolvingPromise(t),Promise.resolve(this)}get apiKey(){return super.apiKey}set apiKey(e){super.apiKey=e}get portalItem(){return super.portalItem}set portalItem(e){super.portalItem=e}get attributionDataUrl(){let e=this.currentStyleInfo,t=e?.serviceUrl&&E(e.serviceUrl);if(!t)return null;let n=this._getDefaultAttribution(t.path);return n?j(n,{...this.customParameters,token:this.apiKey}):null}get capabilities(){let e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){return this.primarySource?.fullExtent||null}get initialExtent(){return this.primarySource?.initialExtent||null}get parsedUrl(){return this.serviceUrl?E(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo?.serviceUrl||null}get spatialReference(){return this.tileInfo?.spatialReference??null}get styleUrl(){return this.currentStyleInfo?.styleUrl||null}writeStyleUrl(e,t){e&&g(e)&&(e=`https:${e}`);let n=te(e);t.styleUrl=ue(e,n)}get tileInfo(){let e=[];for(let t in this.sourceNameToSource)e.push(this.sourceNameToSource[t]);let t=this.primarySource?.tileInfo||new L;if(e.length>1)for(let n=0;n<e.length;n++)Oe(t,e[n].tileInfo)&&(t=ke(t,e[n].tileInfo));return t}readTilemapCache(e,t){return t.capabilities?.includes(`Tilemap`)?new R({layer:this}):null}set url(e){if(!e)return void this._set(`url`,e);let t=E(e);this._set(`url`,t.path),t.query&&(this.customParameters={...this.customParameters,...t.query})}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){let n=b().maxTextureSize,r=this.currentStyleInfo?.spriteUrl?j(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,i=new H({type:`url`,spriteUrl:r,pixelRatio:e,spriteFormat:this.currentStyleInfo?.spriteFormat},n);await i.load(t),this._spriteSourceMap.set(e,i)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;let n=b().maxTextureSize,r=e.spriteUrl,i=r?j(r,{...this.customParameters,token:this.apiKey}):null;if(!i&&e.type===`url`)return null;let a=new H(e,n);try{await a.load(t);let n=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(n,a),i&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=i),this.emit(`spriteSource-change`,{spriteSource:a}),a}catch(e){l(e)}return null}async loadStyle(e,t){let n=e||this.style||this.url;return this._loadingTask&&typeof n==`string`&&this.url===n||(this._loadingTask?.abort(),this._loadingTask=ie(e=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(n,{signal:e})),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return y(this.styleRepository?.getPaintProperties(e))}setPaintProperties(e,t){let n=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);let r=this.styleRepository.isPainterDataDriven(e);this.emit(`paint-change`,{layer:e,paint:t,isDataDriven:n||r})}getStyleLayer(e){return y(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit(`style-layer-change`,{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit(`delete-style-layer`,{layer:e})}getLayoutProperties(e){return y(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit(`layout-change`,{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit(`style-layer-visibility-change`,{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(e,t){return t?.origin&&!this.styleUrl?(t.messages&&t.messages.push(new r(`vectortilelayer:unsupported`,`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}getTileUrl(e,t,n){return null}async _getSourceAndStyle(e,t){if(!e)throw Error(`invalid style!`);let n=await Ce(e,{...t,query:{...this.customParameters,token:this.apiKey}});n.spriteFormat===`webp`&&(await ge(`lossy`)||(n.spriteFormat=`png`)),this._set(`currentStyleInfo`,{...n}),typeof e==`string`?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set(`sourceNameToSource`,n.sourceNameToSource),this._set(`primarySource`,n.sourceNameToSource[n.primarySourceName]),this._set(`styleRepository`,new he(n.style,!1)),this.read(n.layerDefinition,{origin:`service`}),this.emit(`load-style`)}_getDefaultAttribution(e){let t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i),n=[`OpenBasemap_v2`,`OpenBasemap_GCS_v2`,`OpenStreetMap_v2`,`OpenStreetMap_Daylight_v2`,`OpenStreetMap_Export_v2`,`OpenStreetMap_FTS_v2`,`OpenStreetMap_GCS_v2`,`World_Basemap`,`World_Basemap_v2`,`World_Basemap_Export_v2`,`World_Basemap_GCS_v2`,`World_Basemap_WGS84`,`World_Contours_v2`,`World_Hillshade_v2`];if(!t)return;let r=t[2]&&t[2].toLowerCase();if(!r)return;let i=t[1]||``;for(let e of n)if(e.toLowerCase().includes(r))return x(`//static.arcgis.com/attribution/Vector${i}/${e}`)}async _loadStyle(e){return this._loadingTask?.promise??this.loadStyle(null,e)}};D([a({readOnly:!0})],$.prototype,`attributionDataUrl`,null),D([a({type:[`show`,`hide`]})],$.prototype,`listMode`,void 0),D([a({json:{read:!0,write:!0}})],$.prototype,`blendMode`,void 0),D([a({readOnly:!0,json:{read:!1}})],$.prototype,`capabilities`,null),D([a({readOnly:!0})],$.prototype,`currentStyleInfo`,void 0),D([a({json:{read:!1},readOnly:!0,type:S})],$.prototype,`fullExtent`,null),D([a({json:{read:!1},readOnly:!0,type:S})],$.prototype,`initialExtent`,null),D([a({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],$.prototype,`isReference`,void 0),D([a({type:[`VectorTileLayer`]})],$.prototype,`operationalLayerType`,void 0),D([a({readOnly:!0})],$.prototype,`parsedUrl`,null),D([a({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],$.prototype,`path`,void 0),D([a({type:Number,json:{write:!1,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],$.prototype,`refreshInterval`,void 0),D([a()],$.prototype,`style`,void 0),D([a({readOnly:!0})],$.prototype,`serviceUrl`,null),D([a({type:me,readOnly:!0})],$.prototype,`spatialReference`,null),D([a({readOnly:!0})],$.prototype,`styleRepository`,void 0),D([a({readOnly:!0})],$.prototype,`sourceNameToSource`,void 0),D([a({readOnly:!0})],$.prototype,`primarySource`,void 0),D([a({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],$.prototype,`styleUrl`,null),D([n([`portal-item`,`web-document`],`styleUrl`)],$.prototype,`writeStyleUrl`,null),D([a({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:L})],$.prototype,`tileInfo`,null),D([a()],$.prototype,`tilemapCache`,void 0),D([k(`service`,`tilemapCache`,[`capabilities`,`tileInfo`])],$.prototype,`readTilemapCache`,null),D([a({json:{read:!1},readOnly:!0,value:`vector-tile`})],$.prototype,`type`,void 0),D([a({json:{origins:{"web-document":{read:{source:`styleUrl`}},"portal-item":{read:{source:`url`}}},write:!1,read:!1}}),a(p)],$.prototype,`url`,null),D([a({readOnly:!0})],$.prototype,`version`,void 0),D([k(`version`,[`version`,`currentVersion`])],$.prototype,`readVersion`,null),$=D([ee(`esri.layers.VectorTileLayer`)],$);var Ae=$;export{Ae as default};