import{Nl as e,Ol as t,Rl as n,Ul as r,Vl as i,_l as a,gl as o,hw as s,kl as c,pl as l,ww as u,xl as d,y_ as f}from"./index-BN8X5Ryz.js";import{i as p,t as m}from"./vectorStacks-Cuo89CNO.js";function h(t,n,r){let i=d(t,n)/d(t,t);return e(r,t,i)}function g(e,t){return d(e,t)/i(e)}function _(e,t){let n=d(e,t)/(i(e)*i(t));return-s(n)}function v(e,n,r){l(y,e),l(b,n);let i=d(y,b),a=s(i),o=t(y,y,b);return d(o,r)<0?2*Math.PI-a:a}var y=f(),b=f();function ee(e){let t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],n=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],r=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}function x(e,t){let r=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),i=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),a=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return n(e,r,i,a),e}function S(e,r,i){Math.abs(e[0])>Math.abs(e[1])?n(r,0,1,0):n(r,1,0,0),t(i,e,r),t(r,i,e),l(i,i),l(r,r)}function C(t,n,o,s=f()){let c=i(t),l=i(n),u=d(t,n)/(c*l);if(u<.9999999999999999){let i=Math.acos(u),a=((1-o)*c+o*l)/Math.sin(i),d=a/c*Math.sin((1-o)*i),f=a/l*Math.sin(o*i);return e(w,t,d),e(T,n,f),r(s,w,T)}return a(s,t,n,o)}f(),f(),f();var w=f(),T=f();function E(e=$){return[e[0],e[1],e[2],e[3]]}function te(e=$[0],t=$[1],n=$[2],r=$[3]){return k(e,t,n,r,p.get())}function D(e,t){return k(t[0],t[1],t[2],t[3],e)}function O(e){return e}function k(e,t,n,r,i=E()){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function A(e,t,n){let r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function j(e,t,n,r=E()){let i=n[0]-t[0],a=n[1]-t[1],o=n[2]-t[2],s=e[0]-t[0],c=e[1]-t[1],l=e[2]-t[2],u=a*l-o*c,d=o*s-i*l,f=i*c-a*s,p=u*u+d*d+f*f,m=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return r[0]=u*m,r[1]=d*m,r[2]=f*m,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function M(e,t,n,r=0,i=Math.floor(n*(1/3)),a=Math.floor(n*(2/3))){if(n<3)return!1;t(N,r);let s=i,u=!1;for(;s<n-1&&!u;)t(P,s),s++,u=!o(N,P);if(!u)return!1;for(s=Math.max(s,a),u=!1;s<n&&!u;)t(F,s),s++,c(I,N,P),l(I,I),c(L,P,F),l(L,L),u=!o(N,F)&&!o(P,F)&&Math.abs(d(I,L))<re;return u?(j(N,P,F,e),!0):(r!==0||i!==1||a!==2)&&M(e,t,n,0,1,2)}function ne(e,t,r=!0){let i=t.length/3;return M(e,(e,r)=>n(e,t[3*r+0],t[3*r+1],t[3*r+2]),r?i-1:i)}var re=.99619469809,N=f(),P=f(),F=f(),I=f(),L=f();function R(e,t,n){return t!==e&&D(e,t),e[3]=-d(O(e),n),e}function z(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function B(e,n,r,i){return t(F,n,e),A(r,F,i)}function V(e,t,n,r){return Z(Q(e,t,c(m.get(),n,t),oe,r))}function H(e,t,n){return t!=null&&Z(Q(e,t.origin,t.direction,se,n))}function U(e,t,n){return Z(Q(e,t.origin,t.vector,0,n))}function W(e,t,n){return Z(Q(e,t.origin,t.vector,1,n))}function G(e,t){return X(e,t)>=0}function K(e,t){let n=d(O(e),t.ray.direction),r=-X(e,t.ray.origin);if(r<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return r>0;if((r<0||n<0)&&!(r<0&&n<0))return!0;let i=r/n;return n>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function q(e,t){let n=d(O(e),t.ray.direction),r=-X(e,t.ray.origin);if(n>-1e-6&&n<1e-6)return r>0;let i=r/n;return n>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function J(t,n,i){let a=e(m.get(),O(t),-t[3]),o=ie(t,c(m.get(),n,a),m.get());return r(i,o,a),i}function Y(e,t,r,i){let a=O(e),o=m.get(),s=m.get();S(a,o,s);let l=c(m.get(),r,t),u=g(o,l),d=g(s,l),f=g(a,l);return n(i,u,d,f)}function ie(t,n,r){let i=e(m.get(),O(t),d(O(t),n));return c(r,n,i),r}function ae(e,t){return Math.abs(X(e,t))}function X(e,t){return d(O(e),t)+e[3]}function Z(e){return e===0||e===1}function Q(t,n,i,a,o){let s=d(O(t),i),c=X(t,n);if(s===0)return c>=0?2:3;let l=-c/s;return 1&a&&(l=u(l,0,1)),!(4&a)&&l<0||!(8&a)&&l>1?c>=0?2:3:(r(o,n,e(o,i,l)),c>=0?0:1)}var $=[0,0,1,0],oe=12,se=8;export{h as A,D as C,ee as D,S as E,v as M,C as O,k as S,x as T,Q as _,H as a,O as b,G as c,J as d,M as f,X as g,ae as h,V as i,g as j,_ as k,K as l,A as m,z as n,U as o,Y as p,B as r,W as s,R as t,q as u,te as v,ne as w,j as x,E as y};