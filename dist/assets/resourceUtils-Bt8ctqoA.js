import{$T as e,FC as t,PC as n,ZS as r}from"./index-BN8X5Ryz.js";async function i(e,n={},r){await e.load(r);let i=t(e.itemUrl,`resources`),{start:a=1,num:o=10,sortOrder:s=`asc`,sortField:c=`resource`}=n,l={query:{start:a,num:o,sortOrder:s,sortField:c,token:e.apiKey},signal:r?.signal},u=await e.portal.request(i,l);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map(({created:t,size:n,resource:r})=>({created:new Date(t),size:n,resource:e.resourceFromPath(r)}))}}async function a(n,r,i,a){let o=new Map;for(let{resource:t,content:n,compress:a,access:s}of r){if(!t.hasPath())throw new e(`portal-item-resource-${i}:invalid-path`,`Resource does not have a valid path`);let[r,l]=c(t.path),u=`${r}/${a??``}/${s??``}`;o.has(u)||o.set(u,{prefix:r,compress:a,access:s,files:[]}),o.get(u).files.push({fileName:l,content:n})}await n.load(a);let s=t(n.userItemUrl,i===`add`?`addResources`:`updateResources`);for(let{prefix:e,compress:t,access:r,files:i}of o.values())for(let o=0;o<i.length;o+=25){let c=i.slice(o,o+25),l=new FormData;e&&e!==`.`&&l.append(`resourcesPrefix`,e),t&&l.append(`compress`,`true`),r&&l.append(`access`,r);let u=0;for(let{fileName:e,content:t}of c)l.append(`file`+ ++u,t,e);l.append(`f`,`json`),await n.portal.request(s,{method:`post`,body:l,signal:a?.signal})}}async function o(n,r,i){if(!r.hasPath())throw new e(`portal-item-resources-remove:invalid-path`,`Resource does not have a valid path`);await n.load(i);let a=t(n.userItemUrl,`removeResources`);await n.portal.request(a,{method:`post`,query:{resource:r.path},signal:i?.signal}),r.portalItem=null}async function s(e,n){await e.load(n);let r=t(e.userItemUrl,`removeResources`);return e.portal.request(r,{method:`post`,query:{deleteAll:!0},signal:n?.signal})}function c(e){let t=e.lastIndexOf(`/`);return t===-1?[`.`,e]:[e.slice(0,t),e.slice(t+1)]}function l(e){let[t,n]=u(e),[r,i]=c(t);return[r,i,n]}function u(e){let t=n(e);return t==null?[e,``]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function d(e){return e.type===`blob`?e.blob:e.type===`json`?new Blob([e.jsonString],{type:`application/json`}):(await r(e.url,{responseType:`blob`})).data}function f(e,n){if(!e.hasPath())return null;let[r,,i]=l(e.path);return e.portalItem.resourceFromPath(t(r,n+i))}export{o as a,f as i,s as n,i as o,l as r,d as s,a as t};