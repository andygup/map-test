const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingTools-CYJrF2TC.js","assets/index-BN8X5Ryz.js","assets/index-CWJhHB6-.css","assets/editPlaneUtils-DwX4f2SP.js","assets/boundedPlane-DKHNKWJN.js","assets/ObjectStack-l5kM7JZu.js","assets/vectorStacks-Cuo89CNO.js","assets/quatf64-D37SEdPg.js","assets/lineSegment-BudcKS0C.js","assets/plane-Da5EsY0J.js","assets/ray-LkJ58wpZ.js","assets/ReactiveSet-CN-U9t41.js","assets/memoize-Dl61_jt0.js","assets/quantity-Co6flzuS.js","assets/createUtils-BVlp8HHH.js","assets/distanceOperator-Cfhn9VMw.js","assets/Distance2DCalculator-CXhBP-8I-CYkwuMp9.js","assets/SpatialReference-CfUjvF_j.js","assets/Envelope2D-B7gkUj4e.js","assets/Point2D-DJueHbCy.js","assets/OperatorDefinitions-C5Pat-Jx.js","assets/SimpleGeometryCursor-BILtMaQf.js","assets/Transformation2D-D07KwcEj.js","assets/apiConverter-Dsm0pxcs.js","assets/jsonConverter-CoA5-zxu.js","assets/FlatGeometry-BsPiiSVP.js","assets/memoryEstimations-D_IbKyOk.js","assets/OptimizedGeometry-BQJ7w5VU.js","assets/simplifyOperator-C6TgASU6.js","assets/operatorSimplify-BCW0XIAz.js","assets/quat-C8PgLo31.js","assets/geodesicUtils-D99LxQ6q.js","assets/rotate-Drb-fn66.js","assets/quantityFormatUtils-DorrZj0i.js","assets/unitFormatUtils-DIX5VDC2.js","assets/MeshTransform-BaPjlQwH.js","assets/axisAngleDegrees-DzAS4tF-.js","assets/meshVertexSpaceUtils-s2jLb8qI.js","assets/MeshLocalVertexSpace-vomIk0sx.js","assets/getDefaultUnitForView-DyZIV1hK.js","assets/angularMeasurementUtils-DQYnovl-.js","assets/projectVectorToVector-DGzn2p7I.js","assets/projectPointToVector-BkRdoTqD.js","assets/dehydratedPoint-CWZQBefp.js","assets/GraphicsLayer-DBcl42yN.js","assets/dehydratedFeatureComparison-BCFMkftR.js","assets/hydratedFeatures-Cf3ay5ZM.js","assets/drapedUtils-BaZZPZSM.js","assets/elevationInfoUtils-uoMH3ofe.js","assets/SnappingContext-CJ1Obe6m.js","assets/curveOperationUtils-CjGTFE3v.js","assets/LineSnappingHint-CmFAetWF.js","assets/ParallelSnappingHint-CVYaPm-q.js","assets/IntersectionSnappingHint-CvQZ8eWi.js","assets/PointSnappingHint-F2JtYtXH.js","assets/RightAngleSnappingHint-tXLlHR_t.js","assets/euclideanLengthMeasurementUtils-CvEUUrXw.js","assets/spatialReferenceEllipsoidUtils-qw9wv8RL.js","assets/SketchOptions-DjwJVzbR.js","assets/constraints-Ch5tsKD8.js","assets/sphere-d9-4vNcj.js","assets/vec3-B94Y7ih2.js","assets/snappingUtils-D3oTIKrZ.js","assets/colorUtils-CzajW9E7.js","assets/cimSymbolUtils-CLt57XQ8.js","assets/SnappingVisualizer2D-DBg2fFdu.js","assets/drawUtils-BUBS53Cs.js","assets/hitTestSelectUtils-DrV1belT.js"])))=>i.map(i=>d[i]);
import{$S as e,Aw as t,BT as n,VT as r,dv as i,iE as a,kD as o,nE as s,ng as c,rE as l,tT as u,wg as d}from"./index-BN8X5Ryz.js";var f={redo:`r`,undo:`z`},p=Symbol(),m=Symbol(),h=Symbol(),g=class extends t{constructor(e){super(e),this._tool=null,this._updatingHandles=new d,this.enabled=!1,this._onPointerMove=u(async e=>{let t=await this._updatingHandles.addPromise(this._findElementAtScreenPoint(e));this.destroyed||(this.removeHandles(m),t&&t!==this.selectedElement&&this.addHandles(this.view.acquireCursor(`pointer`,`high`),m))})}initialize(){this.addHandles(s(this._updatingHandles)),this._updatingHandles.add(()=>this.enabled,e=>this._setEnabled(e),i),this._updatingHandles.add(()=>this._preferredInteractionTool,()=>this._preferredInteractionToolChanged())}get _validatedSelectedElement(){let e=this.selectedElement;if(!e)return null;let{layer:{source:t}}=this;return t?`hasElement`in t?t.hasElement(e)?e:null:t===e?e:null:null}get _preferredInteractionTool(){return this.options?.tool??`transform`}get updating(){return this._updatingHandles.updating}_setEnabled(e){if(this.removeHandles(p),!e)return;let{view:t}=this;this.addHandles([t.on(`immediate-click`,e=>this._onClick(e),c.TOOL),t.on(`pointer-move`,e=>this._onPointerMove(e).catch(()=>{}),c.TOOL),t.on(`key-down`,e=>{e.key===f.undo&&this._tool?.canUndo()&&(this._tool.undo(),e.stopPropagation()),e.key===f.redo&&this._tool?.canRedo()&&(this._tool.redo(),e.stopPropagation())}),this._updatingHandles.add(()=>this._validatedSelectedElement,e=>this._selectedElementChanged(e),i),l(()=>{this.removeHandles(m),this._removeTool()})],p)}async _findElementAtScreenPoint(e){let t=(await this.view.hitTest(e,{include:[this.layer]})).results[0];return t?.type===`media`?t.element:null}async _onClick(e){await this._updatingHandles.addPromise(e.defer(async()=>{let t=await this._findElementAtScreenPoint(e);this.destroyed||(t&&e.stopPropagation(),this.selectedElement=t,this.selectedElement&&this.removeHandles(m))}))}_preferredInteractionToolChanged(){let{_tool:e}=this;e&&(this._preferredInteractionTool===e.type||this._updatingHandles.addPromise(this._recreateTool()))}async _recreateTool(){this.removeHandles(h),this._removeTool();let t=this._validatedSelectedElement;if(!t)return;let n=new AbortController;this.addHandles(a(n),h);let{TransformTool:r,ControlPointsTransformTool:i}=await e(async()=>{let{TransformTool:e,ControlPointsTransformTool:t}=await import(`./editingTools-CYJrF2TC.js`);return{TransformTool:e,ControlPointsTransformTool:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));if(n.signal.aborted)return;let{view:o}=this;switch(this._preferredInteractionTool){case`transform`:this._tool=new r({target:t,view:o});break;case`reshape`:this._tool=new i({mediaElement:t,view:o})}this.addHandles(l(()=>{this._tool&&=(o.tools.remove(this._tool),null)}),this._tool),o.addAndActivateTool(this._tool)}_removeTool(){this._tool&&this.removeHandles(this._tool)}async _selectedElementChanged(e){e?.georeference?await this._updatingHandles.addPromise(this._recreateTool()):this._removeTool()}};o([n()],g.prototype,`_validatedSelectedElement`,null),o([n()],g.prototype,`_preferredInteractionTool`,null),o([n({constructOnly:!0})],g.prototype,`view`,void 0),o([n({constructOnly:!0})],g.prototype,`layer`,void 0),o([n()],g.prototype,`selectedElement`,void 0),o([n()],g.prototype,`enabled`,void 0),o([n()],g.prototype,`options`,void 0),o([n()],g.prototype,`updating`,null),g=o([r(`esri.views.2d.layers.support.MediaLayerInteraction`)],g);export{g as MediaLayerInteraction};