import{DT as e,Df as t,Dh as n,Ha as r,L as i,OT as a,Sf as o,Sg as s,Uh as c,WC as l,Wh as u,_w as d,gD as f,gw as p,hT as m,hw as h,iv as g,nv as _,px as v,qm as y,rv as b,tD as x,yf as S,zi as C}from"./index-ByaFsVj4.js";import"./quatf64-eO7UAs9K.js";import"./vectorStacks-DhZu7qGn.js";import{g as w}from"./elevationInfoUtils-CyQsBf6_.js";import{t as T}from"./Analysis-PUMMONnF.js";import"./ObjectStack-C2IlraSC.js";import"./ray-CUcS4KDu.js";import"./HUDIntersectorResult-qQNDrr8a.js";import"./Intersector-DrVIdDEe.js";import{n as E,t as D}from"./featureReferenceUtils-BiG_1GyV.js";var O=class extends l(p(d)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return m(this.position,e.position)&&m(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};f([e({type:v,json:{write:{isRequired:!0}}})],O.prototype,`position`,void 0),f([e({type:C}),y()],O.prototype,`elevationInfo`,void 0),f([e(E)],O.prototype,`feature`,void 0),O=f([a(`esri.analysis.LineOfSightAnalysisObserver`)],O);var k=O,A=class extends l(h){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return m(this.position,e.position)&&m(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};f([e({type:v,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),y()],A.prototype,`position`,void 0),f([e({type:C}),y()],A.prototype,`elevationInfo`,void 0),f([e(E)],A.prototype,`feature`,void 0),A=f([a(`esri.analysis.LineOfSightAnalysisTarget`)],A);var j=g.ofType(A),M=class extends T{constructor(e){super(e),this.type=`line-of-sight`,this.observer=null,this.extent=null}initialize(){this.addHandles(_(()=>this._computeExtent(),e=>{e?.pending??this._set(`extent`,e==null?null:e.extent)},b))}get targets(){return this._get(`targets`)||new j}set targets(e){this._set(`targets`,u(e,this.targets,j))}get spatialReference(){return this.observer?.position==null?null:this.observer.position.spatialReference}get valid(){return this.observer?.position!=null}async waitComputeExtent(){let e=this._computeExtent();return e==null?Promise.resolve():e.pending}_computeExtent(){let e=this.spatialReference;if(this.observer?.position==null||e==null)return null;let n=e=>w(e.position,e.elevationInfo)===`absolute-height`,r=this.observer.position,i=t(r.x,r.y,r.z,r.x,r.y,r.z);for(let t of this.targets)if(t.position!=null){let n=s(t.position,e);if(n.pending!=null)return{pending:n.pending,extent:null};if(n.geometry!=null){let{x:e,y:t,z:r}=n.geometry;o(i,[e,t,r])}}let a=S(i,e);return n(this.observer)&&this.targets.every(n)||(a.zmin=void 0,a.zmax=void 0),{pending:null,extent:a}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&m(this.observer,e.observer)&&x(this.targets.toArray(),e.targets.toArray(),(e,t)=>e.equals(t))}};f([e({type:[`line-of-sight`]})],M.prototype,`type`,void 0),f([e({type:k,json:{read:!0,write:!0}})],M.prototype,`observer`,void 0),f([e({cast:c,type:j,nonNullable:!0,json:{read:!0,write:!0}})],M.prototype,`targets`,null),f([e({value:null,readOnly:!0})],M.prototype,`extent`,void 0),f([e()],M.prototype,`spatialReference`,null),f([e({readOnly:!0})],M.prototype,`valid`,null),M=f([a(`esri.analysis.LineOfSightAnalysis`)],M);var N=g.ofType(A),P=class extends i(r(n)){constructor(e){super(e),this.type=`line-of-sight`,this.operationalLayerType=`LineOfSightLayer`,this.analysis=new M,this.opacity=1}initialize(){this.addHandles(_(()=>this.analysis,(e,t)=>{t!=null&&t.parent===this&&(t.parent=null),e!=null&&(e.parent=this)},b))}async load(){return this.analysis!=null&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(e){let{analysis:t}=this;t&&(t.observer=e)}get targets(){return this.analysis==null?new g:this.analysis.targets}set targets(e){u(e,this.analysis?.targets)}get fullExtent(){return this.analysis==null?null:this.analysis.extent}get spatialReference(){return this.analysis==null?null:this.analysis.spatialReference}releaseAnalysis(e){this.analysis===e&&(this.analysis=new M)}};f([e({json:{read:!1},readOnly:!0})],P.prototype,`type`,void 0),f([e({type:[`LineOfSightLayer`]})],P.prototype,`operationalLayerType`,void 0),f([e({type:k,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],P.prototype,`observer`,null),f([e({type:N,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],P.prototype,`targets`,null),f([e({type:M,nonNullable:!0,json:{read:!1,write:!1}})],P.prototype,`analysis`,void 0),f([e({readOnly:!0})],P.prototype,`fullExtent`,null),f([e({readOnly:!0})],P.prototype,`spatialReference`,null),f([e({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],P.prototype,`opacity`,void 0),f([e({type:[`show`,`hide`]})],P.prototype,`listMode`,void 0),P=f([a(`esri.layers.LineOfSightLayer`)],P);var F=P;export{F as default};