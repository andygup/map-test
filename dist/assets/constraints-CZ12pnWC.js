import{Al as e,Cb as t,Fu as n,JE as r,Ml as i,Mu as a,Nb as o,Nu as s,Ol as c,Pl as l,Qg as u,Tb as d,Tl as f,Z as p,_b as m,_l as h,ab as g,c_ as _,cl as v,ct as y,dl as b,f_ as x,gb as S,hb as C,kl as w,mb as T,mt as ee,n_ as E,ob as te,ol as D,ow as ne,pl as O,rl as re,sw as ie,tD as ae,u_ as oe,vl as se,wb as ce,yb as le,yl as ue}from"./index-CzMixifc.js";import{E as de,b as fe,c as pe,d as me,g as he,h as ge,i as _e,m as ve,x as ye,y as k}from"./plane--nqwMDYx.js";import{a as be,i as xe,r as Se}from"./geodesicUtils-DoIAZh7n.js";import{_ as A,a as Ce,c as j,d as M,l as we,m as Te,u as N}from"./LineSnappingHint-C4TfMb_L.js";import{t as Ee}from"./sphere-DkSdrT5o.js";function De({start:e,end:t,type:n},r,i){let a=[],o=m(I,t,e),c=m(L,e,r),l=ce(o),u=2*le(o,c),d=u*u-4*l*(ce(c)-i*i);if(d===0){let t=-u/(2*l);(n===0||t>=0)&&a.push(S(s(),e,o,t))}else if(d>0){let t=Math.sqrt(d),r=(-u+t)/(2*l);(n===0||r>=0)&&a.push(S(s(),e,o,r));let i=(-u-t)/(2*l);(n===0||i>=0)&&a.push(S(s(),e,o,i))}return a}function Oe(t,n){let r=t.start,i=t.end,a=m(I,i,r),s=c(z,-a[1],a[0],0),l=n.start,u=n.end,d=O(Ue,u,l),f=b(d,s),p=c(We,r[0],r[1],0),h=O(Ge,p,l),_=b(h,s),v=o();if(Math.abs(f)<v)return[];let y=e(Ke,l,d,_/f);if(n.type===0){let e=O(qe,y,l);if(b(e,d)<-v)return[]}if(t.type===1){let e=g(L,y,r);if(le(e,a)<-v)return[]}return[x(y)]}function ke(e,t){return Le(ze(Ye,t[2],e),t)}function Ae(e,t){return Ie(ze(Ye,0,e),ze(Xe,0,t)).map(([e,t])=>n(e,t))}function je(e,t,n){return Ne(e,ze(Ye,e[2],t),n)}function Me(e,t,n,r=_()){let i=m(I,e,t),a=d(i);return S(r,t,i,a===0?1:n/a),r[2]=e[2],r}function Ne(t,{start:n,end:r,type:i},a=_()){let o=O(R,t,n),s=O(z,r,n),c=b(o,s)/b(s,s);return e(a,n,s,i===0?Math.max(c,0):c)}var Pe=(()=>{let n=_(),r=_(),o=_();return({start:s,end:c},{center:l,radius:u,normal:d,slicePlane:f})=>{let p=ve(l,d,Je);if(P(ge(p,s),0)&&P(ge(p,c),0)){de(d,n,r);let p=(e,i)=>(ue(o,i,l),t(e,b(o,n),b(o,r)),e),m=Ce({start:p(I,s),end:p(L,c),type:1},a,u),h=[];for(let[t,a]of m){let o=i(_(),l);e(o,o,n,t),e(o,o,r,a),f&&!F(f,o)||h.push(o)}return h}let m=_();return _e(p,s,c,m)?!P(w(m,l),u)||f&&!F(f,m)?[]:[m]:[]}})();function Fe({start:t,end:n,type:r},i,a){let o=[],s=ue(R,n,t),c=m(L,t,i),l=ce(s),u=2*le(s,c),d=u*u-4*l*(ce(c)-a*a);if(d===0){let n=-u/(2*l);(r===1||n>=0)&&o.push(e(_(),t,s,n))}else if(d>0){let n=Math.sqrt(d),i=(-u+n)/(2*l);(r===1||i>=0)&&o.push(e(_(),t,s,i));let a=(-u-n)/(2*l);(r===1||a>=0)&&o.push(e(_(),t,s,a))}return o}function Ie(t,n){let r=t.start,i=t.end,a=n.start,s=n.end,c=O(R,i,r),l=O(z,s,a),u=O(Ue,a,r),d=se(We,c,l);if(!P(b(u,d),0))return[];let f=h(d);if(P(f,0))return[];let p=se(Ge,u,l),m=b(p,d)/f,g=e(Ke,r,c,m);if(t.type===0){let e=O(qe,g,r);if(b(c,e)<-o())return[]}if(n.type===0){let e=O(qe,g,a);if(b(l,e)<-o())return[]}return[x(g)]}function Le({start:e,end:t,type:n},r){let i=O(R,r,e),a=O(z,t,e),s=se(Ue,a,i),c=h(s)/h(a),l=o();if(c<l)switch(n){case 1:return[x(r)];case 0:return b(a,i)<-l?[]:[x(r)]}return[]}function Re(e,t,r,i){let[a,o]=e,[s,c]=r,l=s-a,u=c-o,d=l*l+u*u,f=Math.sqrt(d);if(f>t+i||f<Math.abs(t-i)||P(f,0)&&P(t,i))return[];let p=(t*t-i*i+d)/(2*f),m=Math.sqrt(t*t-p*p),h=m*u/f,g=m*l/f,[_,v]=T(I,e,r,p/f);return P(h,g)?[n(_,v)]:[n(_+h,v-g),n(_-h,v+g)]}function ze(e,t,{start:n,end:r,type:i}){return c(e.start,n[0],n[1],t),c(e.end,r[0],r[1],t),e.type=He[i],e}function Be(e,t){return P(e[2],t[2])}function P(e,t){return ie(Math.abs(e-t),0,o())}function Ve(e,t){return t.filter(t=>F(e,t))}function F(e,t){return pe(e,t)}var He={0:1,1:0},I=s(),L=s(),R=_(),z=_(),Ue=_(),We=_(),Ge=_(),Ke=_(),qe=_(),Je=k(),Ye={start:_(),end:_(),type:1},Xe={start:_(),end:_(),type:1},B=class{intersect(e){return U(this,e)}closestPoints(e){return[this.closestTo(e)]}},V=class extends B{constructor(e){super(),this.point=e}equals(e){return this===e||K(e)&&D(this.point,e.point)}closestTo(){return N(this.point)}},Ze=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.lineLike={start:e,end:t,type:n}}equals(e){return this===e||q(e)&&this.lineLike.type===e.lineLike.type&&D(this.start,e.start)&&D(this.end,e.end)}closestTo(e){let t=M();return Ne(e,this.lineLike,t),t}},Qe=class extends Ze{constructor(e,t){super(e,t,1)}},$e=class extends Ze{constructor(e,t){super(e,t,0)}},et=class extends B{constructor(e){super(),this.constraints=e}equals(e){return this===e||Vt(e)&&ae(this.constraints,e.constraints,(e,t)=>e.equals(t))}closestTo(e){let t,n=1/0;for(let r of this.constraints){let i=r.closestTo(e),a=l(e,i);a<n&&(n=a,t=i)}return N(t??e)}closestPoints(e){return this.constraints.flatMap(t=>t===this?[]:t.closestPoints(e))}},tt=class extends B{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||X(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){let t=M();return Me(e,this.center,this.radius,t),t}},nt=class extends B{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||Z(e)&&D(this.center,e.center)&&this.radius===e.radius}closestTo(e){let t=M();return Me(e,this.center,this.radius,t),t[2]=this.center[2],t}asCircle(){return new rt(N(this.center),this.radius,j(0,0,1))}},rt=class extends B{constructor(e,t,n,r){super(),this.center=e,this.radius=t,this.normal=n,this.slicePlane=r}equals(e){return this===e||Q(e)&&D(this.center,e.center)&&D(this.normal,e.normal)&&this.radius===e.radius}closestTo(t){let{center:n,radius:r}=this;me(this.getPlane(at),t,it);let i=O(it,it,n),a=f(i);if(P(a,0))return N(t);let o=r/Math.sqrt(a),s=M();e(s,n,i,o);let{slicePlane:c}=this;return c&&!F(c,s)?Et(c,this)?.closestTo(t)??N(t):s}getPlane(e=k()){return ve(this.center,this.normal,e)}},it=_(),at=k(),ot=class extends B{constructor(e){super(),this.z=e}equals(e){return this===e||J(e)&&this.z===e.z}closestTo(e){return j(e[0],e[1],this.z)}getPlane(e=k()){return c(st,0,0,this.z),ve(st,E,e)}},st=_(),ct=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.planeLike={start:A(e),end:A(t),type:n}}equals(e){return this===e||Y(e)&&this.planeLike.type===e.planeLike.type&&D(this.start,e.start)&&D(this.end,e.end)}closestTo(e){let t=M();return je(e,this.planeLike,t),t}closestEndTo(e){let{start:t,end:n}=this.planeLike;return Math.sign(le(m(lt,n,t),m(ut,A(e),t)))>0?this.end:this.start}getPlane(e=k()){let t=i(dt,this.end);return t[2]+=1,ye(this.start,this.end,t,e)}getSlicePlane(e=k()){let{start:t,end:n,type:r}=this.planeLike;if(r===0)return;let i=c(dt,t[0],t[1],0),a=c(ft,n[0],n[1],0),o=ue(ft,a,i);return ve(i,o,e),e}},lt=s(),ut=s(),dt=_(),ft=_(),pt=class extends ct{constructor(e,t){super(e,t,1)}},mt=class extends ct{constructor(e,t){super(e,t,0)}},ht=class extends B{constructor(e,t){super(),this.sphere=new Ee(e,t),this._center=x(e)}equals(e){return this===e||$(e)&&this.sphere.exactEquals(e.sphere)}closestTo(e){let t=M();return this.sphere.projectPoint(e,t),t}get center(){return this._center}get radius(){return this.sphere.radius}},gt=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.getZ=n,this.planeLike={start:A(e),end:A(t),type:0}}equals(e){return this===e||Ht(e)&&D(this.start,e.start)&&D(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return St(this,e)}addIfOnTheGround(e,t){for(let n of t){let t=this.getZ(n[0],n[1])??0;P(n[2],t)&&(n[2]=t,e.push(n))}}},_t=class extends B{constructor(e,t,n){super(),this._x=e,this._y=t,this._z=n}equals(e){return this===e||Wt(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,t,n]){return Te(this._x??e,this._y??t,this._z??n)}},vt=class extends B{constructor(e,t,n,r,i){super(),this._origin=e,this._spatialReference=t,this._distanceMeters=n,this._z=r,this._directionDegrees=i}equals(e){return this===e||Ut(e)&&te(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,r]){return t(H,e,n),te(H,this._origin)||this._applyDirectionAndDistance(H),Te(H[0],H[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)xe(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)bt(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){let{azimuth:t}=be(yt,this._origin,e,this._spatialReference);xe(e,this._origin,t??0,this._distanceMeters,this._spatialReference)}}},H=[0,0],yt=new Se;function bt(e,t,n,r,i){let{azimuth:a,distance:o}=be(xt,t,r,i);a??=0;let s=o*Math.cos((a-n)*u);s=Math.max(0,s),xe(e,t,n,s,i)}var xt=new Se;function St(e,t){let n=M();return je(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??Gt,n}function U(e,t){if(Vt(e)){let n=[];for(let r of e.constraints){let e=r.intersect(t);e&&n.push(e)}return G(n)}if(Vt(t))return U(t,e);if(Ht(e))return Rt(e,t);if(Ht(t))return Rt(t,e);if(K(e)){let{point:n}=e;if(K(t))return D(n,t.point)?e:void 0;let r=t.closestTo(n);return v(r,n)?e:void 0}if(q(e)){if(K(t))return U(t,e);if(q(t))return W(Ie(e.lineLike,t.lineLike));if(J(t))return Ct(e,t);if(Y(t))return W(Oe(t.planeLike,e.lineLike));if(X(t))return W(Fe(e.lineLike,t.center,t.radius));if(Q(t))return W(Pe(e.lineLike,t));if(Z(t))return wt(e,t);if($(t))return Tt(e,t)}else if(J(e)){if(K(t)||q(t))return U(t,e);if(J(t))return Dt(e,t);if(Y(t))return Ot(e,t);if(X(t))return kt(e,t);if(Q(t))return jt(e,t);if(Z(t))return At(e,t);if($(t))return Mt(e,t)}else if(Y(e)){if(K(t)||q(t)||J(t))return U(t,e);if(Y(t))return zt(Ae(e.planeLike,t.planeLike));if(X(t))return zt(De(e.planeLike,t.center,t.radius));if(Q(t))return Pt(e,t);if(Z(t))return Nt(e,t);if($(t))return Ft(e,t)}else if(X(e)){if(K(t)||q(t)||J(t)||Y(t))return U(t,e);if(X(t))return zt(Re(A(e.center),e.radius,A(t.center),t.radius));if(Q(t))return;if(Z(t))return It(e,t);if($(t))return}else if(Q(e)){if(K(t)||q(t)||J(t)||Y(t)||X(t))return U(t,e);if(Q(t))return;if(Z(t))return t.asCircle(),void 0;if($(t))return}else if(Z(e)){if(K(t)||q(t)||J(t)||Y(t)||X(t)||Q(t))return U(t,e);if(Z(t))return Lt(t,e);if($(t))return}else if($(e)){if(K(t)||q(t)||J(t)||Y(t)||X(t)||Z(t))return U(t,e);if($(t))return}}var Ct=(()=>{let e=k();return(t,n)=>{let{start:r,end:i}=t;if(Be(r,i)&&P(r[2],n.z))return t;let a=M();return _e(n.getPlane(e),r,i,a)?new V(a):void 0}})();function wt({lineLike:e},{center:t,radius:n}){let r=t[2];return W(Fe(e,t,n).filter(e=>P(e[2],r)))}function Tt({lineLike:e},{sphere:t}){return W(t.intersectLine(e.start,e.end))}var Et=(()=>{let t=p(),n=_(),r=_();return(i,a,o)=>{let{normal:s,center:c,radius:l}=a;de(s,n,r);let u=fe(i),d=l*b(u,n),f=l*b(u,r);ee(t,c[0],c[1],c[2],1);let p=y(i,t),m=Math.hypot(d,f),h=P(m,0);if(P(ge(i,c),0)){if(h)return a;if(P(l,0))return!o||F(o,c)?new V(N(c)):void 0;se(n,u,s),re(n,n);let t=[],r=x(c);e(r,r,n,l),o&&!F(o,r)||t.push(r);let i=x(c);return e(i,i,n,-l),o&&!F(o,i)||t.push(i),W(t)}if(h)return;let g=-p/m;if(Math.abs(g)>1||P(g,1))return;let v=Math.atan(d/f),S=ne(g)-v,C=Math.PI-S,w=[],T=_();e(T,c,n,l*Math.cos(S)),e(T,T,r,l*Math.sin(S)),w.push(T);let E=_();return e(E,c,n,l*Math.cos(C)),e(E,E,r,l*Math.sin(C)),w.push(E),W(o?Ve(o,w):w)}})();function Dt(e,t){return P(e.z,t.z)?e:void 0}function Ot({z:e},{planeLike:t}){let[n,r]=t.start,[i,a]=t.end,o=j(n,r,e),s=j(i,a,e);return t.type===0?new Qe(o,s):new $e(o,s)}function kt(e,t){let[n,r]=t.center;return new nt(j(n,r,e.z),t.radius)}function At(e,t){return P(t.center[2],e.z)?t:void 0}var jt=(()=>{let e=k();return(t,n)=>Et(t.getPlane(e),n,n.slicePlane)})();function Mt(e,{center:t,radius:n}){let r=Math.abs(t[2]-e.z);if(r>n&&!P(r,n))return;let i=j(t[0],t[1],e.z),a=Math.sqrt(n**2-r**2);return P(a,0)?void 0:new nt(i,a)}var Nt=(()=>{let e=k();return(t,{center:n,radius:r})=>{let i=De(t.planeLike,n,r),a=n[2];t.getSlicePlane(e);let o=[];for(let[t,n]of i){let r=[t,n,a];F(e,r)&&o.push(r)}return W(o)}})(),Pt=(()=>{let e=k(),t=k();return(n,r)=>Et(n.getPlane(e),r,n.getSlicePlane(t))})(),Ft=(()=>{let t=k();return(n,{center:r,radius:i})=>{let a=n.getPlane(t),o=he(a,r),s=Math.abs(o);if(s>i&&!P(s,i))return;let c=Math.sqrt(i**2-o**2);if(P(c,0)){let e=M();return me(a,r,e),new V(e)}let l=M(),u=x(fe(a));return e(l,r,u,o),new rt(l,c,u,n.getSlicePlane())}})();function It(e,t){let n=C(A(e.center),A(t.center));return P(n,0)&&P(e.radius,t.radius)?t:Bt(Re(A(e.center),e.radius,A(t.center),t.radius),t.center[2])}function Lt(e,t){if(!Be(e.center,t.center))return;let n=C(A(e.center),A(t.center));return P(n,0)&&P(e.radius,t.radius)?e:Bt(Re(A(e.center),e.radius,A(t.center),t.radius),e.center[2])}function Rt(e,t){let{planeLike:n,getZ:r}=e,i=[];if(K(t))e.addIfOnTheGround(i,ke(n,t.point));else if(q(t))e.addIfOnTheGround(i,Oe(n,t.lineLike));else if(X(t))for(let[e,a]of De(n,t.center,t.radius)){let t=r(e,a);t!=null&&i.push(oe(e,a,t))}else if(Y(t)||Ht(t))for(let[e,a]of Ae(n,t.planeLike)){let t=r(e,a)??Gt;i.push(oe(e,a,t))}return W(i)}function zt(e){return G(e.map(([e,t])=>{let n=j(e,t,0),r=j(e,t,1);return new Qe(n,r)}))}function W(e){return G(e.map(e=>e?new V(we(e)):void 0))}function Bt(e,t){return W(e.map(([e,n])=>[e,n,t]))}function G(e){if(e.length!==0)return e.length===1?e[0]??void 0:new et(e.filter(r))}function Vt(e){return e instanceof et}function K(e){return e instanceof V}function q(e){return e instanceof Ze}function J(e){return e instanceof ot}function Y(e){return e instanceof ct}function X(e){return e instanceof tt}function Z(e){return e instanceof nt}function Q(e){return e instanceof rt}function $(e){return e instanceof ht}function Ht(e){return e instanceof gt}function Ut(e){return e instanceof vt}function Wt(e){return e instanceof _t}var Gt=0;export{V as a,Qe as c,ot as d,Ne as f,G as i,tt as l,vt as n,mt as o,_t as r,K as s,gt as t,pt as u};