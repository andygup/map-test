import{Gx as e,Nx as t,Vi as n}from"./index-CZ4oMP1N.js";import{t as r}from"./memoize-BNsZjv91.js";function i(e){return e?k:A}function a(e,t){return t?.mode?t.mode:i(e).mode}function o(e,t){return t??i(e)}function s(e,t){return a(e==null||(e.hasZ??!1),t)}function c(e,t){return o(e==null||(e.hasZ??!1),t)}function l(e){let t=m(e);return s(e.geometry,t)}function u(e){let t=m(e),n=s(e.geometry,t),r=t!=null&&n!==`on-the-ground`?O(t):0,i=t?.featureExpressionInfo;return{mode:n,offset:r,featureExpressionInfo:i}}function d(e){return p(e)||f(e)}function f(e){return e?.featureExpressionInfo?.expression===`0`}function p(e){if(!e||e.mode===`on-the-ground`)return!1;let t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||t===`0`)}function m(e){return e.layer&&`elevationInfo`in e.layer?e.layer.elevationInfo:null}var h=r((n,r,i)=>{if(!n||r===`decimal-degrees`)return 0;let a=r!==`unknown`&&r?r:`meters`,o=e(i);return o?t(n,a,o):0});function g(e,t){return h(e?.offset,e?.unit,t)}function _(e,t,n){if(!n?.mode)return;let r=e.hasZ?e.z:0,i=g(n,e.spatialReference);switch(n.mode){case`absolute-height`:return r-i;case`on-the-ground`:return 0;case`relative-to-ground`:return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,`ground`)??0)+i);case`relative-to-scene`:return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,`scene`)??0)+i)}}function v(e,t,n,r=null){return b(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,r)}function y(e,t,n,r,i=null){return b(e,t[0],t[1],t.length>2?t[2]:0,n,r,i)}function b(e,t,n,r,i,a,o=null){if(a==null)return;let s=o==null?`absolute-height`:o.mode;if(s===`on-the-ground`)return 0;let{absoluteZ:c}=x(t,n,r,i,e,a);return S(c,t,n,r,i,e,o,s)}function x(e,t,n,r,i,a){let o=g(a,r);switch(a.mode){case`absolute-height`:return{absoluteZ:n+o,elevation:0};case`on-the-ground`:{let n=i.elevationProvider.getElevation(e,t,0,r,`ground`)??0;return{absoluteZ:n,elevation:n}}case`relative-to-ground`:{let a=i.elevationProvider.getElevation(e,t,n,r,`ground`)??0;return{absoluteZ:n+a+o,elevation:a}}case`relative-to-scene`:{let a=i.elevationProvider.getElevation(e,t,n,r,`scene`)??0;return{absoluteZ:n+a+o,elevation:a}}}}function S(e,t,n,r,i,a,o,s){let c=g(o,i);switch(s){case`absolute-height`:return e-c;case`relative-to-ground`:return e-((a.elevationProvider.getElevation(t,n,r,i,`ground`)??0)+c);case`relative-to-scene`:return e-((a.elevationProvider.getElevation(t,n,r,i,`scene`)??0)+c)}}function C(e,t){if(t==null)return!1;let{mode:n}=t;return n!=null&&(e===`scene`&&n===`relative-to-scene`||e===`ground`&&n!==`absolute-height`)}function w(e,t,n){return n&&n.mode!==t?`${e} only support ${t} elevation mode`:null}function T(e,t,n){return n?.mode===t?`${e} do not support ${t} elevation mode`:null}function E(e,t){return t?.featureExpressionInfo!=null&&t.featureExpressionInfo.expression!==`0`?`${e} do not support featureExpressionInfo`:null}function D(e,t){t&&e.warn(`.elevationInfo=`,t)}function O(e){return(e?.offset??0)*n(e?.unit)}var k={mode:`absolute-height`,offset:0},A={mode:`on-the-ground`,offset:null};export{a as _,C as a,_ as b,y as c,g as d,o as f,s as g,c as h,b as i,u as l,k as m,A as n,E as o,D as p,v as r,l as s,T as t,d as u,f as v,x,w as y};