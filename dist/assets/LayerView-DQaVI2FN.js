import{$h as e,$u as t,BT as n,CE as r,ET as i,Qu as a,Sg as o,VT as s,Wh as c,Xu as l,Zu as u,ed as d,jT as f,kD as p,mD as m,pT as h,td as g,vv as _,wg as v}from"./index-BN8X5Ryz.js";import{n as y}from"./layerViewUtils-CJcMVuwG.js";var b=class extends c(e(_)){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new v,this._attributionIndexTask=null,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if(e.name!==`layerview:create-error`){let t=this.layer&&this.layer.id||`no id`,n=this.layer?.title||`no title`;r.getLogger(this).error(`#resolve()`,`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}})}destroy(){this._updatingHandles=f(this._updatingHandles),this._attributionIndexTask=i(this._attributionIndexTask),this._set(`parent`,null)}get attributionItems(){let e=this._get(`attributionItems`)??[];if(this.suspended||!this.layer?.attributionVisible)return e.length===0?e:[];if(!this.view.stationary)return e;let t=this.getAttributionItems();return m(e,t,(e,t)=>e.text===t.text)?e:t}get attributionUpdating(){return!!this._attributionIndexTask&&!this._attributionIndexTask.finished}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome(`visible`,e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){let e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){let e=this.layer&&`effectiveScaleRange`in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&this.parent&&!this.parent.suspended&&this.view?.ready&&y(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){let e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);let t=this.layer&&`effectiveScaleRange`in this.layer?this.layer.effectiveScaleRange:null;return y(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}getAttributionItems(){let e=u(this.layer);if(e)return[e];if(l(this.layer)&&(this._attributionIndexTask||(this._attributionIndexTask=o(async e=>{let t=await this.layer.fetchAttributionData();return h(e),g(t)}),this._updatingHandles.addPromise(this._attributionIndexTask.promise)),this._attributionIndexTask?.finished&&this._attributionIndexTask.value))return t(this._attributionIndexTask.value,this.layer.tileInfo,this.view.scale,this.view.extent);let n=a(this.layer);if(n)return[n];let r=d(this.layer);return r?[r]:[]}};p([n({readOnly:!0})],b.prototype,`spatialReferenceSupported`,null),p([n()],b.prototype,`view`,void 0),p([n({readOnly:!0})],b.prototype,`attributionItems`,null),p([n({readOnly:!0})],b.prototype,`attributionUpdating`,null),p([n()],b.prototype,`fullOpacity`,null),p([n()],b.prototype,`layer`,void 0),p([n()],b.prototype,`parent`,void 0),p([n({readOnly:!0})],b.prototype,`suspended`,null),p([n({readOnly:!0})],b.prototype,`suspendInfo`,null),p([n({readOnly:!0})],b.prototype,`legendEnabled`,null),p([n({type:Boolean,readOnly:!0})],b.prototype,`updating`,null),p([n({readOnly:!0})],b.prototype,`updatingProgress`,null),p([n()],b.prototype,`updateSuspended`,null),p([n()],b.prototype,`visible`,null),p([n({readOnly:!0})],b.prototype,`visibleAtCurrentScale`,null),p([n({readOnly:!0})],b.prototype,`visibleAtCurrentTimeExtent`,null),b=p([s(`esri.views.layers.LayerView`)],b);var x=b;export{x as t};