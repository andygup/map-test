const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-BKz5_YnZ.js","assets/index-CzMixifc.js","assets/index-CDgdHpAj.css"])))=>i.map(i=>d[i]);
import{An as e,BS as t,Cd as n,Hf as r,r_ as i,rh as a,ug as o,xd as s}from"./index-CzMixifc.js";import{i as c,t as l}from"./cimSymbolUtils-Dwr_LmxD.js";new e(1e3),(()=>{let e={};return t=>{if(e[t])return e[t];let n=t.replaceAll(`-`,``);return e[t]=n,n}})(),new a([128,128,128]);function u(e){if(e==null||!(`symbolLayers`in e)||e.symbolLayers==null)return!1;switch(e.type){case`point-3d`:return e.symbolLayers.some(e=>e.type===`object`);case`line-3d`:return e.symbolLayers.some(e=>e.type===`path`);case`polygon-3d`:return e.symbolLayers.some(e=>e.type===`object`||e.type===`extrude`);default:return!1}}function d(e){return e.resource?.href??``}function f(e,t){if(!e)return null;let r=null;return s(e)?r=p(e):n(e)&&(r=e.type===`cim`?c(e):e.color?new a(e.color):null),r?m(r,t):null}function p(e){let t=e.symbolLayers;if(!t)return null;let n=null;return t.forEach(e=>{e.type===`object`&&e.resource?.href||(n=e.type===`water`?e.color:e.material?e.material.color:null)}),n?new a(n):null}function m(e,t){if(t==null||e==null)return e;let n=e.toRgba();return n[3]*=t,new a(n)}function h(e,t,n){let i=e.symbolLayers;if(!i)return;let o=(e,r=!1)=>{let i=t??e??null;return n?.override!=null&&(!i&&r&&(i=new a([255,255,255])),i&&(i.a=n.override)),m(i,n?.add)};i.forEach(e=>{if(e.type===`water`)return void(e.color=m(e.color,n?.add));let t=e.material==null?null:e.material.color,i=o(t,e.type===`icon`&&e.resource?.href!=null);e.material==null?e.material=new r({color:i}):e.material.color=i,`outline`in e&&e.outline?.color&&n?.add!=null&&(e.outline.color=m(e.outline.color,n.add)),`marker`in e&&e.marker!=null&&(e.marker.color=o(e.marker.color))})}function g(e,t,n){t??=e.color,n?.override!=null&&t&&(t.a=n.override),t&&(e.color=m(t,n?.add)),`outline`in e&&e.outline?.color&&(e.outline.color=m(e.outline.color,n?.add))}function _(e,t,r){e&&(t||r!=null)&&(t&&=new a(t),s(e)?h(e,t,r):n(e)&&g(e,t,r))}async function v(e,t){let n=e.symbolLayers;n&&await o(n,async e=>y(e,t))}async function y(e,t){switch(e.type){case`extrude`:S(e,t);break;case`icon`:case`line`:case`text`:b(e,t);break;case`path`:w(e,t);break;case`object`:await C(e,t)}}function b(e,t){let n=x(t);n!=null&&(e.size=n)}function x(e){for(let t of e)if(typeof t==`number`)return t;return null}function S(e,t){let n=t[2];typeof n==`number`&&(e.size=n)}async function C(e,t){let{resourceSize:n,symbolSize:r}=await E(e),i=T(t,n,r);i!=null&&(e.width=D(t[0],r[0],n[0],i),e.depth=D(t[1],r[1],n[1],i),e.height=D(t[2],r[2],n[2],i))}function w(e,t){let n=T(t,i,[e.width,void 0,e.height]);n!=null&&(e.width=D(t[0],e.width,1,n),e.height=D(t[2],e.height,1,n))}function T(e,t,n){for(let r=0;r<3;r++){let i=e[r];switch(i){case`symbol-value`:{let e=n[r];return e==null?1:e/t[r]}case`proportional`:break;default:if(i&&t[r])return i/t[r]}}return null}async function E(e){let{computeObjectLayerResourceSize:n}=await t(async()=>{let{computeObjectLayerResourceSize:e}=await import(`./symbolLayerUtils-BKz5_YnZ.js`);return{computeObjectLayerResourceSize:e}},__vite__mapDeps([0,1,2])),r=await n(e,10),{width:i,height:a,depth:o}=e,s=[i,o,a],c=1;for(let e=0;e<3;e++){let t=s[e];if(t!=null){c=t/r[e];break}}for(let e=0;e<3;e++)s[e]??(s[e]=r[e]*c);return{resourceSize:r,symbolSize:s}}function D(e,t,n,r){switch(e){case`proportional`:return n*r;case`symbol-value`:return t??n;default:return e}}function O(e,t){let n=x(t);if(n!=null)switch(e.type){case`simple-marker`:e.size=n;break;case`picture-marker`:{let t=e.width/e.height;t>1?(e.width=n,e.height=n*t):(e.width=n*t,e.height=n);break}case`simple-line`:e.width=n;break;case`text`:e.font.size=n}}async function k(e,t){if(e&&t)return s(e)?v(e,t):void(n(e)&&O(e,t))}function A(e,t,r){if(e&&t!=null){if(s(e)){let n=e.symbolLayers;n&&n.forEach(e=>{if(e.type===`object`)switch(r){case`tilt`:e.tilt=(e.tilt??0)+t;break;case`roll`:e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}e.type===`icon`&&(e.angle+=t)})}else if(n(e))switch(e.type){case`simple-marker`:case`picture-marker`:case`text`:e.angle+=t;break;case`cim`:l(e,t,!0)}}}function j(e){return e!=null&&e.type===`polygon-3d`&&e.symbolLayers.some(e=>e.type===`extrude`)}export{f as a,A as i,_ as n,d as o,k as r,u as s,j as t};