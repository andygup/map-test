import{Ay as e,BT as t,Bv as n,Ex as r,Ld as i,Ny as a,Od as o,Oy as s,Py as c,Rd as l,VT as u,Vd as d,Zb as f,bb as p,cy as m,dv as h,dy as g,jT as _,kD as v,ky as y,mD as b,mv as x,mx as S,pv as C,uv as w,vv as T,zv as E}from"./index-BN8X5Ryz.js";import"./quatf64-D37SEdPg.js";import"./quat-C8PgLo31.js";import"./axisAngleDegrees-DzAS4tF-.js";import"./MeshLocalVertexSpace-vomIk0sx.js";import"./MeshTransform-BaPjlQwH.js";import"./meshVertexSpaceUtils-s2jLb8qI.js";import"./projectPointToVector-BkRdoTqD.js";import"./dehydratedPoint-CWZQBefp.js";import"./projectVectorToVector-DGzn2p7I.js";import"./layerViewUtils-CJcMVuwG.js";import"./memoize-Dl61_jt0.js";import"./GraphicsLayer-DBcl42yN.js";import"./getDefaultUnitForView-DyZIV1hK.js";import{i as D}from"./quantity-Co6flzuS.js";import"./unitFormatUtils-DIX5VDC2.js";import"./quantityFormatUtils-DorrZj0i.js";import"./geodesicUtils-D99LxQ6q.js";import{r as O}from"./layerUtils-BZgsYerz.js";import{t as k}from"./SketchOptions-DjwJVzbR.js";import{l as A,n as j,r as M,t as N}from"./rotate-Drb-fn66.js";import"./angularMeasurementUtils-DQYnovl-.js";import"./curveOperationUtils-CjGTFE3v.js";import{a as P,n as F,r as I,t as L}from"./drawUtils-BUBS53Cs.js";import{t as R}from"./TranslateTooltipInfo-_IhWPH6-.js";import{n as z,r as B,t as V}from"./ExtentScaleTooltipInfo-Ck2BWdDe.js";import{n as H,t as U}from"./GraphicMover-C6nMhwuQ.js";import{t as W}from"./settings-D0ZT6y9O.js";function G(e,t,n,r){let i=[];for(let a of e){let e=a.slice();i.push(e);let o=t*(a[0]-r.x)-n*(a[1]-r.y)+r.x,s=n*(a[0]-r.x)+t*(a[1]-r.y)+r.y;e[0]=o,e[1]=s}return i}function K(e,t,n,r){let i=[r.x,r.y];if(y(e)){let t=[...e];return p(t,t,i,n)}return a(e)?j(e,i,n):c(e)?M(e,i,n):t?N(t,e,i,n):e}function q(e,t,n,r){let i=[];for(let a of e){let e=[],o=r&&a.length>0&&b(s(a[0]),s(a.at(-1)));for(let r=0;r<a.length;r++){let i=a[r],o=r>0?s(a[r-1]):void 0;e.push(K(i,o,t,n))}o&&(e[0]=[...s(e.at(-1))]),i.push(e)}return i}function J({spatialReference:e,xmin:t,ymin:r,ymax:i,xmax:a}){return new n({spatialReference:e??void 0,hasM:!1,hasZ:!1,rings:[[[t,r],[t,i],[a,i],[a,r],[t,r]]]})}function Y(t,i,a){let{hasM:o,hasZ:s,spatialReference:c,type:l}=t,u=i*Math.PI/180,d=Math.cos(u),f=Math.sin(u);switch(l){case`point`:return a??=t,new r({x:d*(t.x-a.x)-f*(t.y-a.y)+a.x,y:f*(t.x-a.x)+d*(t.y-a.y)+a.y,z:t.z,m:t.m,spatialReference:c});case`extent`:case`polygon`:{t=l===`extent`?J(t):t,a??=t.extent.center;let r=e(t),i=q(t.curveRings??t.rings,u,a,!0);return new n({spatialReference:c,hasZ:t.hasZ,hasM:t.hasM,curveRings:r?i:void 0,rings:r?void 0:i})}case`polyline`:{a??=t.extent.center;let n=e(t),r=q(t.curvePaths??t.paths,u,a,!1);return new E({hasZ:s,hasM:o,spatialReference:c,curvePaths:n?r:void 0,paths:n?void 0:r})}case`multipoint`:return a??=t.extent.center,new m({hasM:o,hasZ:s,points:G(t.points,d,f,a),spatialReference:c})}return null}var X=W.transformGraphics,ee={centerIndicator:new i({style:`cross`,size:X.center.size,color:X.center.color}),fill:{default:new l({color:X.fill.color,outline:{color:X.fill.outlineColor,join:`round`,width:1}}),active:new l({color:X.fill.stagedColor,outline:{color:X.fill.outlineColor,join:`round`,style:`dash`,width:1}})},handles:{default:new i({style:`square`,size:X.vertex.size,color:X.vertex.color,outline:{color:X.vertex.outlineColor,width:1}}),hover:new i({style:`square`,size:X.vertex.hoverSize,color:X.vertex.hoverColor,outline:{color:X.vertex.hoverOutlineColor,width:1}})},rotator:{default:new i({style:`circle`,size:X.vertex.size,color:X.vertex.color,outline:{color:X.vertex.outlineColor,width:1}}),hover:new i({style:`circle`,size:X.vertex.hoverSize,color:X.vertex.hoverColor,outline:{color:X.vertex.hoverOutlineColor,width:1}})},rotatorLine:new d({color:X.line.color,width:1})},Z=Symbol(),Q=class extends T{constructor(e){super(e),this._activeHandleGraphic=null,this._graphicAttributes={esriSketchTool:`box`},this._mover=null,this._centerGraphic=null,this._backgroundGraphic=null,this._vertexGraphics=[],this._rotateHandleGraphic=null,this._rotateGraphicOffset=20,this._angleOfRotation=0,this._rotateLineGraphic=null,this._startInfo=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this.tooltip=null,this.type=`box`,this.callbacks={onMoveStart(){},onMove(){},onMoveStop(){},onScaleStart(){},onScale(){},onScaleStop(){},onRotateStart(){},onRotate(){},onRotateStop(){},onGraphicClick(){}},this.enableMovement=!0,this.enableRotation=!0,this.enableScaling=!0,this.graphics=[],this.highlightName=null,this.highlightsEnabled=!0,this.layer=null,this.preserveAspectRatio=!1,this.showCenterGraphic=!0,this.symbols=ee,this.sketchOptions=new k,this.view=null,this._getBounds=(()=>{let e=S();return(t,n)=>{t[0]=1/0,t[1]=1/0,t[2]=-1/0,t[3]=-1/0;for(let r of n){if(!r)continue;let n,i,a,o;if(r.type===`point`)n=a=r.x,i=o=r.y;else if(r.type===`extent`)[n,i,a,o]=[r.xmin,r.ymin,r.xmax,r.ymax];else{let t=g(e,r);[n,i,a,o]=t}t[0]=Math.min(n,t[0]),t[1]=Math.min(i,t[1]),t[2]=Math.max(a,t[2]),t[3]=Math.max(o,t[3])}return t}})()}initialize(){let e=this.view;this._highlightHelper=new H({view:e}),this._setup(),this.addHandles([w(()=>e?.ready,()=>{let{layer:e,view:t}=this;O(t,e)},{once:!0,initial:!0}),C(()=>this.preserveAspectRatio,()=>{this._activeHandleGraphic&&(this._scaleGraphic(this._activeHandleGraphic),this._updateGraphics(),this._updateTooltip(this._activeHandleGraphic))}),C(()=>e?.scale,()=>{this._updateRotateGraphic(),this._updateRotateLineGraphic()}),C(()=>this.graphics,()=>this.refresh()),C(()=>this.layer,(e,t)=>{t&&this._resetGraphics(t),this.refresh()}),C(()=>[this.highlightsEnabled,this.highlightName],()=>{this._highlightHelper?.removeAll(),this._setUpHighlights()}),C(()=>this.sketchOptions.tooltips.effectiveEnabled,t=>{this.tooltip=t?A(()=>({view:e,options:this.sketchOptions.tooltips})):_(this.tooltip)},x),C(()=>this.view.effectiveTheme.accentColor,()=>this._updateSymbolsForTheme(),h),this.on(`move-start`,e=>this.callbacks?.onMoveStart?.(e)),this.on(`move`,e=>this.callbacks?.onMove?.(e)),this.on(`move-stop`,e=>this.callbacks?.onMoveStop?.(e)),this.on(`rotate-start`,e=>this.callbacks?.onRotateStart?.(e)),this.on(`rotate`,e=>this.callbacks?.onRotate?.(e)),this.on(`rotate-stop`,e=>this.callbacks?.onRotateStop?.(e)),this.on(`scale-start`,e=>this.callbacks?.onScaleStart?.(e)),this.on(`scale`,e=>this.callbacks?.onScale?.(e)),this.on(`scale-stop`,e=>this.callbacks?.onScaleStop?.(e))])}destroy(){this._reset(),this.tooltip=_(this.tooltip)}get state(){let e=this.view?.ready??!1,t=this.graphics.length&&this.layer;return e&&t?`active`:e?`ready`:`disabled`}isUIGraphic(e){return this._vertexGraphics.includes(e)||e===this._backgroundGraphic||e===this._centerGraphic||e===this._rotateHandleGraphic||e===this._rotateLineGraphic}move(e,t){if(this._mover&&this.graphics.length){for(let n of this.graphics){let r=n.geometry;n.geometry=P(r,e,t,this.view)}this.refresh(),this.emit(`move-stop`,{graphics:this.graphics,mover:null,dx:e,dy:t,type:`move-stop`})}}scale(e,t){if(!this._mover||!this.graphics.length)return;let n=this._getBoxBounds(S()),r=f(n);for(let n of this.graphics){let i=n.geometry;n.geometry=L(i,e,t,r)}this.refresh(),this.emit(`scale-stop`,{graphics:this.graphics,mover:null,xScale:e,yScale:t,type:`scale-stop`})}rotate(e,t){if(this._mover&&this.graphics.length){if(!t){let e=this._vertexGraphics[1].geometry.x,n=this._vertexGraphics[3].geometry.y;t=new r(e,n,this.view.spatialReference)}for(let n of this.graphics){let r=n.geometry;n.geometry=Y(r,e,t)}this.refresh(),this.emit(`rotate-stop`,{graphics:this.graphics,mover:null,angle:e,type:`rotate-stop`})}}refresh(){this._reset(),this._setup()}reset(){this.graphics=[]}_setup(){this.state===`active`&&(this._setUpHighlights(),this._setupGraphics(),this._setupMover(),this._updateGraphics())}_reset(){this._highlightHelper?.removeAll(),this._resetGraphicStateVars(),this._resetGraphics(),this._updateTooltip(),this._mover?.destroy(),this._mover=null,this.removeHandles(Z)}_resetGraphicStateVars(){this._startInfo=null,this._activeHandleGraphic=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this._angleOfRotation=0}_resetGraphics(e){(e||=this.layer)&&(e.removeMany(this._vertexGraphics),e.remove(this._backgroundGraphic),e.remove(this._centerGraphic),e.remove(this._rotateHandleGraphic),e.remove(this._rotateLineGraphic)),this._vertexGraphics.forEach(e=>!e.destroyed&&e.destroy()),!this._backgroundGraphic.destroyed&&this._backgroundGraphic.destroy(),!this._centerGraphic.destroyed&&this._centerGraphic.destroy(),!this._rotateHandleGraphic.destroyed&&this._rotateHandleGraphic.destroy(),!this._rotateLineGraphic.destroyed&&this._rotateLineGraphic.destroy(),this._vertexGraphics=[],this._backgroundGraphic=null,this._centerGraphic=null,this._rotateHandleGraphic=null,this._rotateLineGraphic=null}_setupMover(){let e=[];this.enableScaling&&(e=e.concat(this._vertexGraphics)),this.enableRotation&&e.push(this._rotateHandleGraphic),this.enableMovement&&(e=e.concat(this.graphics,this._backgroundGraphic)),this.showCenterGraphic&&e.push(this._centerGraphic),this._mover=new U({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,view:this.view,graphics:e,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_setCursor(e){this.addHandles(this.view.acquireCursor(e,`high`),Z)}_getStartInfo(e){let[t,n,r,i]=this._getBoxBounds(S()),a=Math.abs(r-t),o=Math.abs(i-n),s=(r+t)/2,c=(i+n)/2,{x:l,y:u}=e.geometry;return{width:a,height:o,centerX:s,centerY:c,startX:l,startY:u,graphicInfos:this._getGraphicInfos(),box:this._backgroundGraphic.geometry,rotate:this._rotateHandleGraphic.geometry}}_getGraphicInfos(){return this.graphics.map(e=>this._getGraphicInfo(e))}_getGraphicInfo(e){let t=e.geometry,[n,r,i,a]=this._getBounds(S(),[t]);return{width:Math.abs(i-n),height:Math.abs(a-r),centerX:(i+n)/2,centerY:(a+r)/2,geometry:t}}_onGraphicClickCallback(e){e.viewEvent.stopPropagation(),this.emit(`graphic-click`,e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e)}_onGraphicMoveStartCallback(e){let{_angleOfRotation:t,_xScale:n,_yScale:r,_backgroundGraphic:i,_vertexGraphics:a,_rotateHandleGraphic:o,symbols:s,graphics:c}=this,{graphic:l,dx:u,dy:d,viewEvent:f}=e;this._resetGraphicStateVars(),this._hideGraphicsBeforeUpdate(),i.symbol=s.fill.active,this._startInfo=this._getStartInfo(l),this._updateTooltip(l,f),l===o?(this._setCursor(`grabbing`),this.emit(`rotate-start`,{type:`rotate-start`,mover:l,graphics:c,angle:t})):a.includes(l)?(this._activeHandleGraphic=l,this.emit(`scale-start`,{type:`scale-start`,mover:l,graphics:c,xScale:n,yScale:r})):this.emit(`move-start`,{type:`move-start`,graphics:c,mover:l,dx:u,dy:d})}_onGraphicMoveCallback(e){let t=e.graphic;if(!this._startInfo)return;let{_xScale:n,_yScale:r,_angleOfRotation:i,graphics:a}=this;if(this._vertexGraphics.includes(t))this._scaleGraphic(t),this._updateTooltip(t,e.viewEvent),this.emit(`scale`,{type:`scale`,graphics:a,mover:t,xScale:n,yScale:r});else if(t===this._rotateHandleGraphic)this._rotateGraphic(t),this._updateTooltip(t,e.viewEvent),this.emit(`rotate`,{type:`rotate`,graphics:a,mover:t,angle:i});else{let{dx:n,dy:r}=e;this._totalDx+=n,this._totalDy+=r,this._moveGraphic(t,n,r),this._updateTooltip(t,e.viewEvent),this.emit(`move`,{type:`move`,graphics:a,mover:t,dx:n,dy:r})}}_onGraphicMoveStopCallback(e){let t=e.graphic;if(!this._startInfo)return void this.refresh();let{_angleOfRotation:n,_totalDx:r,_totalDy:i,_xScale:a,_yScale:o,_vertexGraphics:s,_rotateHandleGraphic:c,graphics:l}=this;this.refresh(),t===c?(this._setCursor(`pointer`),this.emit(`rotate-stop`,{type:`rotate-stop`,graphics:l,mover:t,angle:n})):s.includes(t)?this.emit(`scale-stop`,{type:`scale-stop`,mover:t,graphics:l,xScale:a,yScale:o}):this.emit(`move-stop`,{type:`move-stop`,graphics:l,mover:t,dx:r,dy:i})}_onGraphicPointerOverCallback(e){let{_backgroundGraphic:t,_vertexGraphics:n,graphics:r,_rotateHandleGraphic:i,symbols:a,view:o}=this,s=e.graphic;if(this._hoveredGraphic=s,s===i)return i.symbol=a.rotator.hover,this._setCursor(`pointer`),void this._updateTooltip(s);if(r.includes(s)||s===t)return void this._setCursor(`move`);if(!n.includes(s))return void this._setCursor(`pointer`);this._updateTooltip(s),e.graphic.symbol=a.handles.hover;let c=o.rotation,l,u=e.index;switch(u<8&&(c>=0&&c<45?u%=8:u=c>=45&&c<90?(u+1)%8:c>=90&&c<135?(u+2)%8:c>=135&&c<180?(u+3)%8:c>=180&&c<225?(u+4)%8:c>=225&&c<270?(u+5)%8:c>=270&&c<315?(u+6)%8:(u+7)%8),u){case 0:case 4:l=`nwse-resize`;break;case 1:case 5:l=`ns-resize`;break;case 2:case 6:l=`nesw-resize`;break;case 3:case 7:l=`ew-resize`;break;default:l=`pointer`}this._setCursor(l)}_onGraphicPointerOutCallback(e){let{_vertexGraphics:t,_rotateHandleGraphic:n,symbols:r}=this;this._hoveredGraphic=null,e.graphic===n?n.symbol=r.rotator.default:t.includes(e.graphic)&&(e.graphic.symbol=r.handles.default),this.removeHandles(Z),this._updateTooltip()}_scaleGraphic(e){let{_startInfo:t,_vertexGraphics:n,preserveAspectRatio:i,view:a}=this,{centerX:o,centerY:s,graphicInfos:c,height:l,startX:u,startY:d,width:f}=t,{resolution:p,transform:m}=a.state,h=n.indexOf(e);h!==1&&h!==5||this._updateX(e,o),h!==3&&h!==7||this._updateY(e,s);let{x:g,y:_}=e.geometry,v=m[0]*g+m[2]*_+m[4],y=m[1]*g+m[3]*_+m[5],b=c?.map(e=>e.geometry)??[],x=b.every(e=>e.type===`point`);if((f===0||l===0)&&x){let e=$((g-u)/p),n=$((d-_)/p);for(let t=0;t<b.length;t++)this.graphics[t].geometry=P(b[t],e,n,a,!0);this._centerGraphic.geometry=new r(g,_,a.spatialReference),this._backgroundGraphic.geometry=P(t.box,e,n,a,!0);return}if(i){let e=$(m[0]*o+m[2]*s+m[4],2),t=$(m[1]*o+m[3]*s+m[5],2),n=$(m[0]*u+m[2]*d+m[4],2),r=$(m[1]*u+m[3]*d+m[5],2),i=F(e,t,n,r,v,y);i!==0&&Math.abs(i)!==1/0||(i=1),this._xScale=this._yScale=i;for(let e of b){let t=b.indexOf(e);this.graphics[t].geometry=L(e,this._xScale,this._yScale,[o,s])}this._updateBackgroundGraphic()}else{let e=g-u,n=d-_;if(h===1||h===5?e=0:h!==3&&h!==7||(n=0),e===0&&n===0)return;let i=o+e/2,c=s+n/2,m=(f+(u>o?e:-1*e))/f,v=(l+(d<s?n:-1*n))/l;h!==1&&h!==5&&m!==0&&Math.abs(m)!==1/0||(m=1),h!==3&&h!==7&&v!==0&&Math.abs(v)!==1/0||(v=1),this._xScale=m,this._yScale=v;let y=(i-o)/p,x=(c-s)/p,S=L(t.box,this._xScale,this._yScale);this._backgroundGraphic.geometry=P(S,y,x,a,!0);let{centerX:C,centerY:w}=this._getGraphicInfo(this._backgroundGraphic),T=(C-o)/p,E=-1*(w-s)/p;for(let e of b){let t=b.indexOf(e),n=L(e,this._xScale,this._yScale,[o,s]);this.graphics[t].geometry=P(n,T,E,a,!0)}this._centerGraphic.geometry=new r(C,w,a.spatialReference)}}_rotateGraphic(e){let{centerX:t,centerY:n,startX:i,startY:a,box:o,rotate:s}=this._startInfo,c=this.view.spatialReference,l=new r(i,a,c),u=new r(t,n,c),d=e.geometry;this._angleOfRotation=I(l,d,u);let f=this._startInfo.graphicInfos?.map(e=>e.geometry)??[];for(let e of f){let t=f.indexOf(e),n=Y(e,this._angleOfRotation,u);this.graphics[t].geometry=n}this._backgroundGraphic.geometry=Y(o,this._angleOfRotation,u),this._rotateHandleGraphic.geometry=Y(s,this._angleOfRotation,u)}_moveGraphic(e,t,n){if(this.graphics.includes(e)){let r=this._backgroundGraphic.geometry;this._backgroundGraphic.geometry=P(r,t,n,this.view);for(let r of this.graphics)r!==e&&(r.geometry=P(r.geometry,t,n,this.view))}else if(e===this._centerGraphic){let e=this._backgroundGraphic.geometry;this._backgroundGraphic.geometry=P(e,t,n,this.view)}if(e===this._backgroundGraphic||e===this._centerGraphic)for(let e of this.graphics)e.geometry=P(e.geometry,t,n,this.view)}_setUpHighlights(){this.highlightsEnabled&&this.graphics.length&&this._highlightHelper?.add(this.graphics,this.highlightName)}_setupGraphics(){let{_graphicAttributes:e,symbols:t}=this;this._centerGraphic=new o({symbol:t.centerIndicator,attributes:e}),this.showCenterGraphic&&this.layer.add(this._centerGraphic),this._backgroundGraphic=new o({symbol:t.fill.default,attributes:e}),this.layer.add(this._backgroundGraphic),this._rotateLineGraphic=new o({symbol:t.rotatorLine,attributes:e}),this._rotateHandleGraphic=new o({symbol:t.rotator.default,attributes:e}),this.enableRotation&&!this._hasExtentGraphic()&&this.layer.addMany([this._rotateLineGraphic,this._rotateHandleGraphic]);for(let n=0;n<8;n++)this._vertexGraphics.push(new o({symbol:t.handles.default,attributes:e}));this.enableScaling&&this.layer.addMany(this._vertexGraphics)}_updateSymbolsForTheme(){let e=this.view.effectiveTheme.accentColor;this.symbols={...this.symbols,fill:{active:this.symbols.fill.active?.clone().set(`outline.color`,e),default:this.symbols.fill.default?.clone().set(`outline.color`,e)},handles:{...this.symbols.handles,default:this.symbols.handles.default.clone().set(`outline.color`,e)},rotator:{...this.symbols.rotator,default:this.symbols.rotator.default.clone().set(`outline.color`,e)},rotatorLine:this.symbols.rotatorLine.clone().set(`color`,e)};for(let e of this._vertexGraphics)e.symbol=e===this._hoveredGraphic?this.symbols.handles.hover:this.symbols.handles.default;this._backgroundGraphic.symbol=this.symbols.fill.default,this._rotateHandleGraphic.symbol=this._rotateHandleGraphic===this._hoveredGraphic?this.symbols.rotator.hover:this.symbols.rotator.default,this._rotateLineGraphic.symbol=this.symbols.rotatorLine}_updateGraphics(){this._updateBackgroundGraphic(),this._updateHandleGraphics(),this._updateCenterGraphic(),this._updateRotateGraphic(),this._updateRotateLineGraphic()}_hideGraphicsBeforeUpdate(){this._centerGraphic.visible=!1,this._rotateHandleGraphic.visible=!1,this._rotateLineGraphic.visible=!1,this._vertexGraphics.forEach(e=>e.visible=!1)}_updateHandleGraphics(){let e=this._getCoordinates(!0);this._vertexGraphics.forEach((t,n)=>{let[r,i]=e[n];this._updateXY(t,r,i)})}_updateBackgroundGraphic(){let e=this._getCoordinates().map(([e,t])=>[e,t]);this._backgroundGraphic.geometry=new n({rings:[e],spatialReference:this.view.spatialReference})}_updateCenterGraphic(){let[e,t,n,i]=this._getBoxBounds(S()),a=(n+e)/2,o=(i+t)/2;this._centerGraphic.geometry=new r(a,o,this.view.spatialReference)}_updateRotateGraphic(){if(!this._vertexGraphics.length)return;let{x:e,y:t}=this._vertexGraphics[1].geometry,n=t+this.view.state.resolution*this._rotateGraphicOffset;this._rotateHandleGraphic.geometry=new r(e,n,this.view.spatialReference)}_updateRotateLineGraphic(){if(!this._vertexGraphics.length||!this._rotateHandleGraphic?.geometry)return;let e=this._vertexGraphics[1].geometry,t=this._rotateHandleGraphic.geometry;this._rotateLineGraphic.geometry=new E({paths:[[[e.x,e.y],[t.x,t.y]]],spatialReference:this.view.spatialReference})}_updateXY(e,t,n){e.geometry=new r(t,n,this.view.spatialReference)}_updateX(e,t){let n=e.geometry.y;e.geometry=new r(t,n,this.view.spatialReference)}_updateY(e,t){let n=e.geometry.x;e.geometry=new r(n,t,this.view.spatialReference)}_hasExtentGraphic(){return this.graphics.some(e=>e?.geometry!=null&&e.geometry.type===`extent`)}_getBoxBounds(e){let t=this.graphics.map(e=>e.geometry);return this._getBounds(e,t)}_getCoordinates(e){let[t,n,r,i]=this._getBoxBounds(S());if(e){let e=(t+r)/2,a=(i+n)/2;return[[t,i],[e,i],[r,i],[r,a],[r,n],[e,n],[t,n],[t,a]]}return[[t,i],[r,i],[r,n],[t,n]]}_updateTooltip(e,t){if(this.tooltip==null)return;if(!e)return void this.tooltip.clear();let{_backgroundGraphic:n,graphics:r,_vertexGraphics:i,_rotateHandleGraphic:a}=this;e===a?this._updateRotateTooltip():i.includes(e)?this._updateScaleTooltip():(r.includes(e)||e===n)&&this._updateMoveTooltip(t)}_updateRotateTooltip(){this.tooltip!=null&&(this.tooltip.info=new B({sketchOptions:this.sketchOptions,angle:-this._angleOfRotation}))}_updateScaleTooltip(){let{tooltip:e,_xScale:t,_yScale:n,sketchOptions:r,view:i,automaticLengthMeasurementUtils:a}=this;if(e==null)return;let o=this._getCoordinates(),s=z({topLeft:o[0],topRight:o[1],bottomRight:o[2],bottomLeft:o[3],spatialReference:i.spatialReference,automaticLengthMeasurementUtils:a});if(s==null)return;let{xSize:c,ySize:l}=s;e.info=new V({sketchOptions:r,xScale:Math.abs(t),yScale:Math.abs(n),xSize:c,ySize:l})}_updateMoveTooltip(e){let{tooltip:t,sketchOptions:n,view:r,automaticLengthMeasurementUtils:i}=this;if(t==null)return;let a=new R({sketchOptions:n});if(e){let{x:t,y:n}=e.origin,o=r.toMap(e),s=r.toMap({x:t,y:n});a.distance=i.autoDistanceBetweenPoints2D(s,o)??D}t.info=a}};function $(e,t=2){return Number.parseFloat(e.toFixed(t))}v([t()],Q.prototype,`tooltip`,void 0),v([t({readOnly:!0})],Q.prototype,`type`,void 0),v([t()],Q.prototype,`callbacks`,void 0),v([t()],Q.prototype,`enableMovement`,void 0),v([t()],Q.prototype,`enableRotation`,void 0),v([t()],Q.prototype,`enableScaling`,void 0),v([t()],Q.prototype,`graphics`,void 0),v([t()],Q.prototype,`highlightName`,void 0),v([t()],Q.prototype,`highlightsEnabled`,void 0),v([t()],Q.prototype,`layer`,void 0),v([t()],Q.prototype,`preserveAspectRatio`,void 0),v([t()],Q.prototype,`showCenterGraphic`,void 0),v([t({readOnly:!0})],Q.prototype,`state`,null),v([t()],Q.prototype,`symbols`,void 0),v([t({type:k})],Q.prototype,`sketchOptions`,void 0),v([t({constructOnly:!0})],Q.prototype,`view`,void 0),v([t({constructOnly:!0})],Q.prototype,`automaticLengthMeasurementUtils`,void 0),Q=v([u(`esri.views.draw.support.Box`)],Q);var te=Q;export{te as default};