import{Ba as e,Fa as t,Ha as n,La as r}from"./index-BN8X5Ryz.js";import"./originUtils-CJnuu7mB.js";import"./saveUtils-CEfw3trS.js";import{n as i}from"./datasetUtils-QzMOwZxx.js";import{n as a,t as o}from"./utils-BnryXVma.js";var s=`Image Service`,c=`imagery-layer-save`,l=`imagery-layer-save-as`,u=`imagery-tile-layer-save`,d=`imagery-tile-layer-save-as`,f=`WCS`,p=`wcs-layer-save`,m=`wcs-layer-save-as`;function h(e){if(e.type===`imagery`||e.type===`wcs`)return{isValid:!0};let{raster:t}=e,n=i(t)[0];return{isValid:n?.datasetFormat===`RasterTileServer`&&(n.tileType===`Raster`||n.tileType===`Map`),errorMessage:`imagery tile layer should be created from a tiled image service.`}}function g(e){let t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}async function _(i,a){let{parsedUrl:o,title:s,fullExtent:c}=i;a.url=o.path,a.title||=s;try{a.extent=await e(c)}catch{a.extent=void 0}r(a,t.METADATA),n(a,t.TILED_IMAGERY,i.type===`imagery-tile`)}async function v(e,t){let n=e.type===`imagery`?c:e.type===`imagery-tile`?u:p,r=e.type===`wcs`?f:s;return a({layer:e,itemType:r,validateLayer:h,createItemData:g,errorNamePrefix:n},t)}async function y(e,t,n){let r=e.type===`imagery`?l:e.type===`imagery-tile`?d:m,i=e.type===`wcs`?f:s;return o({layer:e,itemType:i,validateLayer:h,createItemData:g,errorNamePrefix:r,newItem:t,setItemProperties:_},n)}export{v as save,y as saveAs};