const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lclayout-p0qz3GPK.js","assets/_commonjsHelpers-YBF0zzdz.js"])))=>i.map(i=>d[i]);
import{$S as e,$T as t,A as n,AE as r,Ai as i,Aw as a,BT as o,Bv as s,C as c,CE as l,Ca as u,D as d,DS as f,Da as p,Di as m,Ea as h,Eh as g,Ex as _,FE as v,Fh as y,Fi as b,Fn as x,H as S,Hr as ee,Id as C,Ii as te,KT as ne,Kg as w,Kh as re,Lx as T,N as ie,NE as E,O as ae,Oa as oe,Od as se,Ov as D,P as ce,Pn as O,Qp as le,R as ue,Ra as de,Rd as fe,Rh as pe,S as me,Sa as he,T as ge,Ta as _e,U as ve,UT as ye,Ua as be,Ui as xe,VT as k,Vg as A,Wi as Se,XS as Ce,ZS as we,_ as Te,ba as Ee,bd as j,cp as De,da as Oe,ea as ke,ha as Ae,ip as je,j as Me,k as Ne,kD as M,ki as Pe,kv as Fe,la as Ie,mT as Le,na as Re,pd as N,ph as ze,rm as Be,rv as Ve,sT as He,sm as Ue,sp as We,ta as Ge,tp as Ke,ua as qe,vC as Je,vE as P,vx as F,wa as Ye,wp as Xe,xa as Ze,xu as Qe,z as $e,zi as et,zv as tt}from"./index-BN8X5Ryz.js";import{t as nt}from"./OptimizedGeometry-BQJ7w5VU.js";import{n as rt}from"./OptimizedFeatureSet-CLjmRHYn.js";import{a as it}from"./featureConversionUtils-o9-cJXzl.js";import{i as at,t as ot}from"./Relationship-CyGEtlAI.js";import{t as I}from"./GraphQueryStreaming-DUkFf9hi.js";import{n as st,t as ct}from"./QueryEngineCapabilities-CxeEdoTy.js";import{r as lt}from"./clientSideDefaults-Iizf0eUh.js";import{n as ut}from"./utils-BGjabRH0.js";import{F as dt,I as ft,L as pt,p as L,s as mt,v as ht}from"./knowledgeGraphService-IHR0Dm6J.js";import{a as gt,i as R,n as _t,o as z,r as B,t as V}from"./constants-nHW_AykQ.js";import{t as vt}from"./GraphicsLayer-DBcl42yN.js";import{t as yt}from"./FeatureStore-DxVA8hqB.js";import{t as bt}from"./QueryEngine-CD8WljsT.js";var xt=class{constructor(){this.version=``,this.queryResult=new St}},St=class{constructor(){this.featureResult=new Ct}},Ct=class{constructor(){this.objectIdFieldName=``,this.uniqueIdField=new wt,this.globalIdFieldName=``,this.geohashFieldName=``,this.geometryProperties=new Tt,this.geometryType=null,this.spatialReference=new T,this.exceededTransferLimit=!1,this.hasZ=!1,this.hasM=!1,this.transform=new Et,this.fields=[],this.fieldNameToAttributeIndexMap={},this.values=[],this.features=[],this.geometryFields=[]}},wt=class{constructor(){this.name=``,this.isSystemMaintained=!1}},Tt=class{constructor(){this.shapeAreaFieldName=``,this.shapeLengthFieldName=``,this.units=``}},Et=class{constructor(){this.quantizeOriginPosition=`upperLeft`,this.scale=new Dt,this.translate=new Ot}},Dt=class{constructor(){this.xScale=0,this.yScale=0,this.mScale=0,this.zScale=0}},Ot=class{constructor(){this.xTranslate=0,this.yTranslate=0,this.mTranslate=0,this.zTranslate=0}},kt=class{constructor(){this.name=``,this.fieldType=`esriFieldTypeString`,this.alias=``,this.sqlType=`sqlTypeVarchar`,this.domain=``,this.defaultValue=``}},At=class{constructor(){this.attributes=[],this.compressedGeometry=new H,this.centroid=new H,this.aggregateGeometries=[]}},H=class{constructor(){this.geometryType=null,this.lengths=[],this.coords=[]}},jt=[`ELEMENTUID`,`TYPENAME`],Mt={upperLeft:0,lowerLeft:1},Nt={sqlTypeBigInt:0,sqlTypeBinary:1,sqlTypeBit:2,sqlTypeChar:3,sqlTypeDate:4,sqlTypeDecimal:5,sqlTypeDouble:6,sqlTypeFloat:7,sqlTypeGeometry:8,sqlTypeGUID:9,sqlTypeInteger:10,sqlTypeLongNVarchar:11,sqlTypeLongVarbinary:12,sqlTypeLongVarchar:13,sqlTypeNChar:14,sqlTypeNVarChar:15,sqlTypeOther:16,sqlTypeReal:17,sqlTypeSmallInt:18,sqlTypeSqlXml:19,sqlTypeTime:20,sqlTypeTimestamp:21,sqlTypeTimestamp2:22,sqlTypeTinyInt:23,sqlTypeVarbinary:24,sqlTypeVarchar:25};function Pt(e){let t=new xt;t.version=e.version;let n=e.get_query_result();if(n.results_type.value!==0)throw Error(`Got a non-feature collection type`);let r=n.get_feature_result(),i=t.queryResult.featureResult;i.objectIdFieldName=r.objectid_field_name,i.exceededTransferLimit=r.exceeded_transfer_limit,i.hasM=r.has_m,i.hasZ=r.has_z,i.geometryType=E(dt,r.geometry_type.value),i.globalIdFieldName=r.globalid_field_name,i.geohashFieldName=r.geohash_field_name;let a=i.uniqueIdField,o=r.unique_id_field;a.name=o.name,a.isSystemMaintained=o.isSystemMaintained;let s=i.geometryProperties,c=r.geometry_properties;s.shapeAreaFieldName=c.shapeAreaFieldName,s.shapeLengthFieldName=c.shapeLengthFieldName,s.units=c.units;let l=i.spatialReference,u=r.spatial_reference;l.wkid=u.wkid,l.latestWkid=u.latestWkid,l.vcsWkid=u.vcsWkid,l.latestVcsWkid=u.latestVcsWkid,l.wkt=u.wkt,i.transform=Lt(r.transform);let d=i.fields,f=i.fieldNameToAttributeIndexMap,p=r.fields,m=p.size();for(let e=0;e<m;e++){let t=p.get(e),n=Ft(t);d.push(n),f[n.name]=e,t.delete()}p.delete();let h=i.values,g=r.values_count();for(let e=0;e<g;e++)h.push(r.get_value_at(e));let _=i.features,v=r.features,y=v.size();if(y>0){for(let e of jt)if(f[e]===void 0)throw Error(`Feature collection missing required attribute: ${e}`)}for(let e=0;e<y;e++){let t=new At,n=v.get(e),r=t.attributes,i=n.attributes_count();for(let e=0;e<i;e++)r.push(n.get_attribute_at(e));let a=n.get_compressed_geometry();a&&(t.compressedGeometry=U(a),t.centroid=U(n.get_centroid()));let o=t.aggregateGeometries,s=n.aggregate_geometries,c=s.size();for(let e=0;e<c;e++){let t=s.get(e),n=U(t);o.push(n),t.delete()}s.delete(),_.push(t),n.delete()}v.delete();let b=i.geometryFields,x=r.geometry_fields,S=x.size();for(let e=0;e<S;e++){let t=x.get(e),n=It(t);b.push(n),t.delete()}return x.delete(),t}function U(e){let t=new H;t.geometryType=E(dt,e.geometry_type.value);let n=[],r=[];for(let t=0;t<e.lengths.length;t++)n.push(e.lengths[t]);for(let t=0;t<e.coords.length;t++)r.push(e.coords[t]);return t.lengths=n,t.coords=r,t}function Ft(e){let t=new kt;return t.name=e.name,t.alias=e.alias,t.fieldType=E(ft,e.field_type.value),t.sqlType=E(Nt,e.sql_type.value),t.domain=e.domain,t.defaultValue=e.default_value,t}function It(e){let t=Ft(e);return t.geometryType=E(dt,e.geometry_type.value),t}function Lt(e){let t=new Et;t.quantizeOriginPosition=E(Mt,e.quantizeOriginPosition.value);let n=t.scale,r=e.scale;n.xScale=r.xScale,n.yScale=r.yScale,n.mScale=r.mScale,n.zScale=r.zScale;let i=t.translate,a=e.translate;return i.xTranslate=a.xTranslate,i.yTranslate=a.yTranslate,i.mTranslate=a.mTranslate,i.zTranslate=a.zTranslate,t}async function Rt(e,t){let n=[],r={generateAllSublayers:!1,namedTypeDefinitions:new Map};return e.entitiesUrl&&n.push(Ht(e.entitiesUrl,t).then(e=>{Kt(e,r)})),e.relationshipsUrl&&n.push(Ht(e.relationshipsUrl,t).then(e=>{Kt(e,r)})),await Promise.all(n),r}async function zt(e,t,n){t??=!1;let r={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Wt(e,n).then(e=>{qt(e,r)}),r}async function Bt(e){let n=await pt(),r=new n.MapOfObjectIdentifierSets;Vt(r,n,e);let i=new n.MapOfObjectIdentifierSetsEncoder;try{i.set_map_of_identifier_sets(r),i.encode();let e=i.get_encoding_result();if(e.error.error_code!==0)throw new t(`knowledge-graph:layer-support-utils`,e.error.error_message);let n=structuredClone(e.get_byte_buffer());return i.delete(),n}finally{r.delete()}}function Vt(e,t,n){for(let[r,i]of n.namedTypeDefinitions){if(!i.members||i.useAllData)continue;let n=i.members.keys(),a=!1,o=!0,s=new t.ObjectIdArray,c=new t.StringArray,l=new t.GlobalIdArray,u=new t.IdentifierArray,d=new t.ObjectIdentifierSet;for(let e of n)o&&=(a=!isNaN(Number(e)),!1),a?s.add_objectid(Number(e)):(c.add_string(e),l.add_globalid(e)),u.add_identifier(e);d.set_oid_array(s),d.set_string_array(c),d.set_globalid_array(l),d.set_identifier_array(u),s.delete(),c.delete(),l.delete(),u.delete(),e.put_identifier_set(r,d),d.delete()}return e}async function Ht(e,t){let n=await we(e,{responseType:`array-buffer`,signal:t?.signal});return Ut(await n.data)}async function Ut(e){let n=new(await(pt())).FeatureCollectionDecoder,r=n.decode(new Uint8Array(e));if(r.error_code!==0)throw new t(`knowledge-graph:layer-support-utils`,r.error_message);let i=n.get_feature_collection(),a=Pt(i);return n.delete(),a}async function Wt(e,t){let n=await we(e,{responseType:`array-buffer`,signal:t?.signal}),r=await n.data;return Gt(new Uint8Array(r))}async function Gt(e){let n=new(await(pt())).MapOfObjectIdentifierSetsDecoder,r=n.decode(new Uint8Array(e)),i=new Map;if(r.error_code!==0)throw new t(`knowledge-graph:layer-support-utils`,r.error_message);let a=n.get_map_of_identifier_sets(),o=a.keys,s=o.size();for(let e=0;e<s;e++){let n=o.get(e),r=a.query_identifier_set(n),s=[];if(r.id_array_type.value===1){let e=r.get_globalid_array(),t=e.count();for(let n=0;n<t;n++)s.push(e.get_globalid_at(n))}else if(r.id_array_type.value===3){let e=r.get_identifier_array(),t=e.count();for(let n=0;n<t;n++)s.push(e.get_identifier_at(n).toString())}else if(r.id_array_type.value===2){let e=r.get_string_array(),t=e.count();for(let n=0;n<t;n++)s.push(e.get_string_at(n))}else{if(r.id_array_type.value!==0)throw new t(`knowledge-graph:layer-support-utils`,`Tried to encode an unexpected ID Array type.`);{let e=r.get_oid_array(),t=e.count();for(let n=0;n<t;n++)s.push(e.get_objectid_at(n).toString())}}i.set(n,s)}return n.delete(),i}function Kt(e,t){if(!e?.queryResult?.featureResult)return t;let{hasZ:n,hasM:r}=e.queryResult.featureResult,i=e.queryResult.featureResult.fieldNameToAttributeIndexMap;for(let a of e.queryResult.featureResult.features){let e=a.attributes[i.TYPENAME],o=P(t.namedTypeDefinitions,e,()=>({useAllData:!1,members:new Map})),s=a.attributes[i.ELEMENTUID];if(a.compressedGeometry?.coords?.length>0){let e=a.compressedGeometry.lengths;a.compressedGeometry.geometryType===`esriGeometryPoint`&&(e=[]),o.members.set(s,{id:s,linkChartLocation:new nt(e,a.compressedGeometry.coords,n,r)})}else o.members.set(s,{id:s})}return t}function qt(e,t){for(let[n,r]of e){let e=P(t.namedTypeDefinitions,n,()=>({useAllData:!1,members:new Map}));for(let t of r)e.members.has(t)||e.members.set(t,{id:t})}return t}var Jt={fetchAndConvertSerializedLinkChart:(e,t)=>Rt(e,t)},Yt=(e,t)=>{if(e.type===`column-reference`)return e.column===t.systemOidFieldName?`ID(n)`:`n.${e.column}`;if(e.type===`string`)return`'${e.value}'`;if(e.type===`number`)return`${e.value}`;if(e.type===`binary-expression`&&t.supportedSqlTypes.has(e.left.type)&&t.supportedSqlTypes.has(e.right.type)&&t.supportedSqlOperators.has(e.operator))return`${Yt(e.left,t)} ${e.operator} ${Yt(e.right,t)}`;if(e.type===`binary-expression`&&e.operator===`LIKE`){let n=``;if(e.left.type===`function`&&e.left.args.value[0].type===`column-reference`)n+=`lower(n.${e.left.args.value[0].column})`;else{if(e.left.type!==`column-reference`)return t.unsupportedOperationFound=!0,``;n+=`lower(n.${e.left.column})`}if(n+=` CONTAINS (`,e.right.type!==`string`)return t.unsupportedOperationFound=!0,``;{let t=e.right.value;t.startsWith(`%`)&&(t=t.slice(1)),t.endsWith(`%`)&&(t=t.slice(0,-1)),n+=`'${t.toLowerCase()}')`}return n}return t.unsupportedOperationFound=!0,``},W=class e{constructor(){this._featureLookup=new Map}static getInstance(){return e.instance||=new e,e.instance}static resetInstance(){e.instance&&=null}deleteFromStore(e){e.forEach(e=>{this._featureLookup.delete(e)})}readFromStoreByList(e){let t=[];return e.forEach(e=>{let n=this.readFromStoreById(e);n&&t.push(n)}),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,n){let r=[];return e.forEach(e=>{if(!e?.id)return;e.properties||=[];let i=null;n&&e.properties[n]&&(i=it(e.properties[n])),`originId`in e&&`destinationId`in e&&(e.properties.ESRI__OriginID=e.originId,e.properties.ESRI__DestID=e.destinationId),e.properties[t]=e.id;let a=e.properties;if(e.id){let t=this._featureLookup.get(e.id);if(t?.attributes){a={...t.attributes,...a};let e=n&&a[n];e!=null&&(a[n]=Fe(e)),i??=t.geometry}}let o=new rt(i?.clone(),a,null,e.id);this._featureLookup.set(`${e.typeName?`${e.typeName}__${e.id}`:e.id}`,o),r.push(o)}),r}},Xt,G=null;function Zt(){return Xt||(Xt=e(()=>import(`./lclayout-p0qz3GPK.js`),__vite__mapDeps([0,1])).then(e=>e.l).then(({default:e})=>e({locateFile:e=>Ce(`esri/libs/linkchartlayout/${e}`)})).then(e=>{Qt(e)}),Xt)}function Qt(e){G=e}var $t={right:0,left:1,top:2,bottom:3},en={none:0,"start-only":1,"start-and-end":2};function tn(e){let t={timeDirection:`right`,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:`start-and-end`,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0,...e?.toJSON(),eventsTicksVisualization:e?.eventsTicksVisualization??`start-and-end`};return{...t,timeDirection:{value:$t[t.timeDirection]??$t.right},eventsTicksVisualization:{value:en[t.eventsTicksVisualization]??en[`start-and-end`]}}}function K(e,t,n,r,i,a){let o=n.length,s=i.length,c=Float64Array.BYTES_PER_ELEMENT,l=Uint32Array.BYTES_PER_ELEMENT,u=Uint8Array.BYTES_PER_ELEMENT,d=16+o*(u+2*c)+s*(2*l),f=G._malloc(d);try{let u=f+16-f%16,d=u+o*c,p=d+o*c,m=p+s*l,h=m+s*l,g=()=>[G.HEAPF64.subarray(u>>3,(u>>3)+o),G.HEAPF64.subarray(d>>3,(d>>3)+o),G.HEAPU32.subarray(p>>2,(p>>2)+s),G.HEAPU32.subarray(m>>2,(m>>2)+s),G.HEAPU8.subarray(h,h+o)],[_,v,y,b,x]=g();_.set(n),v.set(r),y.set(i),b.set(a),x.set(t);let S=e(o,h,u,d,s,p,m),ee=null,C=null;if(S.value===0){let e=G.getLayoutLinksTypes(),t=G.getLayoutLinksVerticesEndIndices(),n=G.getLayoutLinksVertices(),r=G.countLayoutLinksVertices();!s||e&&t?r&&!n?S.value=1:(ee={types:new Uint8Array(G.HEAPU8.subarray(e,e+s)),vertexEndIndex:new Uint32Array(G.HEAPU32.subarray(t>>2,(t>>2)+s)),vertices:new Float64Array(G.HEAPF64.subarray(n>>3,(n>>3)+2*r))},C=G.getAuxiliaryGraphicElements()):S.value=1}let[te,ne,w,re,T]=g();return n.set(te),r.set(ne),i.set(w),a.set(re),t.set(T),{status:S.value,links:ee,graphics:C}}finally{G._free(f),G.cleanupLayout()}}var nn,rn,an,on,sn,cn,ln;(function(e){function t(){return G.getMinIdealEdgeLength()}function n(e,t,n,r,i,a,o=2,s=1,c=-1){return K((t,n,r,i,a,l,u)=>G.applyForceDirectedLayout(e,t,n,r,i,a,l,u,o,s,c),t,n,r,i,a)}e.getMinIdealEdgeLength=t,e.apply=n})(nn||={}),function(e){function t(e,t,n,r,i,a,o=2,s=1,c=-1){return K((t,n,r,i,a,l,u)=>G.applyCommunityLayout(e,t,n,r,i,a,l,u,o,s,c),t,n,r,i,a)}e.apply=t}(rn||={}),function(e){function t(e,t,n,r,i,a){return K((t,n,r,i,a,o,s)=>G.applySimpleLayout(e,t,n,r,i,a,o,s),t,n,r,i,a)}e.apply=t}(an||={}),function(e){function t(e,t,n,r,i,a){return K((t,n,r,i,a,o,s)=>G.applyHierarchicalLayout(e,t,n,r,i,a,o,s),t,n,r,i,a)}e.apply=t}(on||={}),function(e){function t(e,t,n,r,i,a){return K((t,n,r,i,a,o,s)=>G.applyRadialTreeLayout(e,t,n,r,i,a,o,s),t,n,r,i,a)}e.apply=t}(sn||={}),function(e){function t(e,t,n,r,i,a){return K((t,n,r,i,a,o,s)=>G.applySmartTreeLayout(e,t,n,r,i,a,o,s),t,n,r,i,a)}e.apply=t}(cn||={}),function(e){function t(e,t,n,r,i,a,o,s,c,l,u,d){return K((t,n,r,o,s,f,p)=>{if(i.length!==t||a.length!==t||c.length!==s||l.length!==s)return{value:1};let m=Float64Array.BYTES_PER_ELEMENT,h=G._malloc(16+t*m),g=G._malloc(16+t*m),_=G._malloc(16+s*m),v=G._malloc(16+s*m),y=h+16-h%16,b=g+16-g%16,x=_+16-_%16,S=v+16-v%16;try{return G.HEAPF64.subarray(y>>3,(y>>3)+t).set(i),G.HEAPF64.subarray(b>>3,(b>>3)+t).set(a),G.HEAPF64.subarray(x>>3,(x>>3)+s).set(c),G.HEAPF64.subarray(S>>3,(S>>3)+s).set(l),G.applyChronologicalLayout(e,t,n,r,o,y,b,s,f,p,x,S,u,tn(d))}finally{G._free(h),G._free(g),G._free(_),G._free(v)}},t,n,r,o,s)}e.apply=t}(ln||={}),ne()({none:`none`,startAndEnd:`start-and-end`,startOnly:`start-only`}),ne()({absoluteValue:`absolute-value`,multiplier:`multiplier`});var un=new Map([[`basic-grid`,`basic-grid`],[`geographic-organic-standard`,`geographic-organic-standard`],[`hierarchical-bottom-to-top`,`hierarchical-bottom-to-top`],[`hierarchical-top-to-bottom`,`hierarchical-bottom-to-top`],[`organic-community`,`organic-community`],[`organic-fusiform`,`organic-standard`],[`organic-leaf-circle`,`organic-standard`],[`organic-standard`,`organic-standard`],[`radial-node-centric`,`radial-root-centric`],[`radial-root-centric`,`radial-root-centric`],[`tree-bottom-to-top`,`tree-left-to-right`],[`tree-left-to-right`,`tree-left-to-right`],[`tree-right-to-left`,`tree-left-to-right`],[`tree-top-to-bottom`,`tree-left-to-right`],[`chronological-mono-timeline`,`chronological-mono-timeline`],[`chronological-multi-timeline`,`chronological-multi-timeline`]]);function dn(e,t){let n=new Map;if(t.dataModel?.relationshipTypes)for(let e of t.dataModel.relationshipTypes)e.name&&n.set(e.name,[]);for(let t of e)n.has(t.typeName)&&n.get(t.typeName)?.push(t.id);return n}async function fn(e,t,n){let r=[],i=dn(e,t),a={},o=[];for(let[e,t]of i){if(t.length<1)continue;let n=`${e}_ids`;a[n]=t,o.push(`MATCH (n)-[r:${e}]->(m) WHERE id(r) in $${n} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(o.length===0)return[];let s=o.join(` UNION `),c=new I({openCypherQuery:s,bindParameters:a}),l=(await L(t,c,n?.requestOptions)).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await l.read();if(e)break;for(let e of t)r.push({id:e[0],typeName:e[1]}),r.push({id:e[2],typeName:e[3]})}return r}var pn=e=>un.get(e)??`radial-root-centric`;function mn(e){if(!e.spatialReference.isWGS84)throw new t(`knowledge-graph:layer-support-utils`,`The utilsExtentToInBoundsRings function only supports WGS84 spatial references.`);return e.clone().normalize().map(e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]])}var q=class extends a{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;let t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach(n=>{n.name&&(t.set(n.name,`entity`),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(n.name),n.properties?.forEach(e=>{e.geometryType&&e.geometryType!==`esriGeometryNull`&&this.geographicLookup.set(n.name,{name:e.name??``,geometryType:e.geometryType})}))}),e.knowledgeGraph.dataModel.relationshipTypes?.forEach(n=>{n.name&&(t.set(n.name,`relationship`),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(n.name),n.properties?.forEach(e=>{e.geometryType&&e.geometryType!==`esriGeometryNull`&&this.geographicLookup.set(n.name,{name:e.name??``,geometryType:e.geometryType})}))}),e.inclusionModeDefinition?.namedTypeDefinitions.forEach((n,r)=>{if(t.get(r)===`entity`)this.entityTypeNames.add(r);else{if(t.get(r)!==`relationship`)return l.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);this.relationshipTypeNames.add(r)}let i=new Map;n.members?.forEach(e=>{P(this.memberIdTypeLookup,e.id,()=>new Set).add(r)}),this.sublayerCaches.set(r,i)})}addToLayer(e){e.forEach(({typeName:e,id:n})=>{if(!this.inclusionModeDefinition)throw new t(`knowledge-graph:layer-data-manager`,`You cannot add to a layer's exclusion list if it was not created with an exclusion list originally`);if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){let t=this.inclusionModeDefinition.namedTypeDefinitions.get(e);t.members||=new Map,t.members.set(n,{id:n}),P(this.memberIdTypeLookup,n,()=>new Set).add(e)}}else{let t=new Map;t.set(n,{id:n}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:t}),P(this.memberIdTypeLookup,n,()=>new Set).add(e)}})}getById(e){return W.getInstance().readFromStoreById(e)}async getData(e,t,n){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let r;if(r=e||new N({where:`1=1`,outFields:[`*`]}),t.parentCompositeLayer.type===`link-chart`){let e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(t.objectType.name??``),i=r.outFields;i&&i.length===1&&i[0]===`ESRI__ID`&&r.where===`1=1`||await Promise.all(n??[]);let a=this.sublayerCaches.has(t.objectType.name??``)?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],o=[];return a.forEach(n=>{if(this.relationshipTypeNames.has(t.objectType.name)){n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]);let r=this.memberIdTypeLookup.get(n.attributes[_t]),i=this.memberIdTypeLookup.get(n.attributes[z]),a=this._isEndEntitySpatial(r,n,_t),o=this._isEndEntitySpatial(i,n,z);n.attributes[V]=Number(a&&o)}else{n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]);let r=this.geographicLookup.get(t.objectType.name);r&&n.attributes[r.name]?n.attributes[V]=1:n.attributes[V]=0}n.attributes[B]=n.geometry,o.push(n)}),o}return this.retrieveDataFromService(r,t,n)}async getConnectedRecordIds(e,t,n){let r=[],i=``,a=this._getNamedTypeIdMapFromNodeIds(e);if(t&&t?.length!==0){for(let e of t)i=i+e+`|`;i=i.slice(0,-1)}let o={},s=[];for(let[e,n]of a){let r=`${e}_ids`;o[r]=n,t&&t?.length!==0?s.push(`MATCH (n:${e}) WHERE id(n) IN $${r} WITH n MATCH (n)-[r:${i}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`):s.push(`MATCH (n:${e}) WHERE id(n) IN $${r} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`)}if(!s.length)return r;let c=s.join(` UNION `),l=(await L(this.knowledgeGraph,new I({openCypherQuery:c,bindParameters:o}),{signal:n?.signal})).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await l.read();if(e)break;for(let e=0;e<t.length;e++){let n=t[e];r.push({id:n[0],typeName:n[1]}),r.push({id:n[2],typeName:n[3]})}}return r}async getRelationshipsBetweenNodes(e,t,n){let r=this._getNamedTypeIdMapFromNodeIds(e);if(r.size===0)return[];let i={relationshipExclusionIds:t,possibleConnectionEntityIds:e},a=[];for(let[e,t]of r.entries()){let n=`${e}_ids`;i[n]=t,a.push(`MATCH (n:${e}) WHERE id(n) IN $${n} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}let o=a.join(` UNION `),s=[],c=(await L(this.knowledgeGraph,new I({openCypherQuery:o,bindParameters:i}),{signal:n?.signal})).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await c.read();if(e)break;for(let e=0;e<t.length;e++){let n=t[e];s.push({id:n[0],typeName:n[1]})}}return s}async getRelationshipsFromNodes(e,t,n,r){let i=this._getNamedTypeIdMapFromNodeIds(e);if(i.size===0||t.length===0)return[];let a={relationshipExclusionIds:n,possibleConnectionEntityIds:t},o=[];for(let[e,t]of i.entries()){let n=`${e}_ids`;a[n]=t,o.push(`MATCH (n:${e}) WHERE id(n) IN $${n} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}let s=o.join(` UNION `),c=new Map,l=(await L(this.knowledgeGraph,new I({openCypherQuery:s,bindParameters:a}),{signal:r?.signal})).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await l.read();if(e)break;for(let e=0;e<t.length;e++){let n=t[e],r=c.get(n[1]);r||(r=new Set,c.set(n[1],r)),r.add(n[0])}}let u=[];for(let[e,t]of c)for(let n of t)u.push({id:n,typeName:e});return u}async refreshCacheContent(e,n,r,i=!0,a){let o=W.getInstance(),s=[],c=new Map,l=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach(e=>{e.name&&l.set(e.name,e)}),this.knowledgeGraph.dataModel.relationshipTypes?.forEach(e=>{e.name&&l.set(e.name,e)}),e||this.inclusionModeDefinition?e?e.forEach(e=>{if(this.memberIdTypeLookup.has(e))for(let t of this.memberIdTypeLookup.get(e))c.has(t)?c.get(t)?.push(e):c.set(t,[e])}):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach((e,t)=>{e.useAllData?c.set(t,null):e.members&&e.members.forEach(e=>{c.has(t)&&c.get(t)!==null?c.get(t)?.push(e.id):c.set(t,[e.id])})}):(this.knowledgeGraph.dataModel.entityTypes?.forEach(e=>{e.name&&c.set(e.name,null)}),this.knowledgeGraph.dataModel.entityTypes?.forEach(e=>{e.name&&c.set(e.name,null)}));for(let[e,u]of c){let c=new Set(u),d=new Promise((s,d)=>{(async()=>{let s=new Set,d=[],f,p=``,m=!1;if(n||l.get(e)?.properties?.forEach(e=>{e.name&&s.add(e.name)}),r&&this.geographicLookup.has(e)){let t=this.geographicLookup.get(e)?.name;t&&s.add(t)}if(this.entityTypeNames.has(e))p=`MATCH (n:${e}) ${u?`WHERE id(n) IN $ids `:``}return ID(n)`,s.forEach(e=>{p+=`, n.${e}`,d.push(e)});else{if(!this.relationshipTypeNames.has(e))throw new t(`knowledge-graph:layer-data-manager`,`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);m=!0,p=`MATCH ()-[n:${e}]->() ${u?`WHERE id(n) IN $ids `:``}return ID(n), id(startNode(n)), id(endNode(n))`,s.forEach(e=>{p+=`, n.${e}`,d.push(e)})}f=new I(u?{openCypherQuery:p,bindParameters:{ids:u}}:{openCypherQuery:p});let h=(await L(this.knowledgeGraph,f,{signal:a?.signal})).resultRowsStream.getReader();for(;;){let{done:t,value:n}=await h.read();if(t)break;let r=[];for(let e=0;e<n.length;e++){let t=n[e],i=0,a=0,o={properties:{}};for(o.id=t[i],i++,a++,m&&(o.originId=t[i],i++,a++,o.destinationId=t[i],i++,a++,P(this.nodeConnectionsLookup,o.originId,()=>new Set).add(o.id),P(this.nodeConnectionsLookup,o.destinationId,()=>new Set).add(o.id),P(this.relationshipConnectionsLookup,o.id,()=>[o.originId,o.destinationId]));i<t.length;i++)o.properties[d[i-a]]=t[i];c.delete(o.id),r.push(o)}let a=o.writeToStore(r,R,this.geographicLookup.get(e)?.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),i&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(e)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map}),i&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);let s=this.sublayerCaches.get(e);a.forEach(t=>{s?.set(t.attributes[R],t),i&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.has(t.attributes.ESRI__ID)&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.set(t.attributes.ESRI__ID,{id:t.attributes.ESRI__ID}),P(this.memberIdTypeLookup,t.attributes.ESRI__ID,()=>new Set).add(e))})}let g=this.inclusionModeDefinition?.namedTypeDefinitions.get(e);if(g)for(let e of c)g.members?.delete(e)})().then(()=>{s(null)}).catch(e=>{e.name===`AbortError`?s(null):d(e)})});s.push(d),this._processingCacheUpdatesLookup.get(e)?.push(d)}if(await Promise.all(s),a?.signal?.aborted)throw Le()}removeFromLayer(e){let t=new Set,n=new Set(e.map(e=>e.id));for(let n of e)t.add(n.typeName),this.memberIdTypeLookup.get(n.id)?.size===1?this.memberIdTypeLookup.delete(n.id):this.memberIdTypeLookup.get(n.id)?.delete(n.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach((e,t)=>{t===n.typeName&&e.members?.has(n.id)&&e.members.delete(n.id)});t.forEach(e=>{this.sublayerCaches.get(e)?.forEach((t,r)=>{n.has(r)&&this.sublayerCaches.get(e)?.delete(r)})})}async retrieveDataFromService(e,n,r){let i=W.getInstance(),a=new Set,o=[],c,l=``,u=[],d=n.graphType===`relationship`,p=this.inclusionModeDefinition?.namedTypeDefinitions?.get(n.objectType.name)?.useAllData,m=n.parentCompositeLayer.sublayerIdsCache.get(n.objectType.name),h=!p&&m?Array.from(m).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(n.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(n.objectType.name)?.useAllData&&e.objectIds!=null&&(h=e.objectIds);else if(e.objectIds!=null&&h&&h.length>0){let t=e.objectIds;e.objectIds=h.filter(e=>t.includes(e))}else if(e.objectIds!=null)h=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(n.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(n.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(n.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=h}if(e.outFields!=null){let t=e.outFields;t.includes(`*`)?n.fields.forEach(e=>{a.add(e.name)}):t.forEach(e=>{e!==`ESRI__ID`&&e!==n.geometryFieldName&&a.add(e)})}if(e.geometry!=null){let r=e.geometry,i,u=n.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,p=u?.spatialReference,m=u?.serviceCapabilities?.geometryCapabilities,h=m?.geometryMaxBoundingRectangleSizeX,g=m?.geometryMaxBoundingRectangleSizeY;if(r.type===`point`){let e=r;e.spatialReference?.isWGS84||(await A(e.spatialReference,f),e=w(e,f)),i=new F({spatialReference:f,xmin:e.x-1e-4,ymin:e.y-1e-4,xmax:e.x+1e-4,ymax:e.y+1e-4})}else r?.extent?.spatialReference&&!r.spatialReference?.isWGS84?(await A(r.extent.spatialReference,f),i=w(r.extent,f)):i=r.extent;if(h&&g&&p){if(p.wkid!==4326){let e=new F({spatialReference:p,xmax:h,ymax:g}),t=w(e,f);h=t.xmax,g=t.ymax}if(i.xmax-i.xmin>h)throw new t(`knowledge-graph:layer-data-manager`,`Extent x bounds should be within ${h}° latitude, limit exceeded`);if(i.ymax-i.ymin>g)throw new t(`knowledge-graph:layer-data-manager`,`Extent y bounds should be within ${g}° longitude, limit exceeded`)}if(e.where!=null&&e.where!==`1=1`){let t=await Be(e.where.toUpperCase(),n.fieldsIndex);n.fields.forEach(e=>{t.fieldNames.includes(e.name)&&a.add(e.name)})}l=d?`Match ()-[n:${n.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${n.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${n.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${n.geometryFieldName}) return ID(n)`,n.geometryFieldName&&a.add(n.geometryFieldName),a.forEach(e=>{l+=`, n.${e}`,o.push(e)}),c=new I({openCypherQuery:l,bindParameters:{param_filter_geom:new s({rings:mn(i)})}})}else{let t=``;if(e.where!=null&&e.where!==`1=1`){let r=await Be(e.where,n.fieldsIndex);n.fields.forEach(e=>{r.fieldNames.includes(e.name)&&a.add(e.name)});let i={systemOidFieldName:R,supportedSqlTypes:new Set([`column-reference`,`string`,`number`,`binary-expression`]),supportedSqlOperators:new Set([`=`,`<`,`<=`,`<>`,`>`,`>=`,`AND`,`OR`,`LIKE`]),unsupportedOperationFound:!1};t=Yt(r.parseTree,i),i.unsupportedOperationFound&&(t=``)}let r=``;r=d?`Match ()-[n:${n.objectType.name}]->()`:`Match (n:${n.objectType.name})`;let i=!1;h&&(i=!0,r+=` WHERE ID(n) IN $ids`),t&&(r+=i?` AND`:` WHERE`,r+=` ${t}`),r+=` return ID(n)`,d&&(r+=`, id(startNode(n)), id(endNode(n))`),e.returnGeometry&&n.geometryFieldName&&a.add(n.geometryFieldName),a.forEach(e=>{r+=`, n.${e}`,o.push(e)}),c=new I(h?{openCypherQuery:r,bindParameters:{ids:h}}:{openCypherQuery:r})}let g=(await L(n.parentCompositeLayer.dataManager.knowledgeGraph,c,r)).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await g.read();if(e)break;let r=[];for(let e=0;e<t.length;e++){let n=t[e],i=0,a=0,s={properties:{}};for(s.id=n[i],i++,a++,d&&(s.originId=n[i],i++,a++,s.destinationId=n[i],i++,a++);i<n.length;i++)s.properties[o[i-a]]=n[i];r.push(s)}u=u.concat(i.writeToStore(r,R,n.parentCompositeLayer.dataManager.geographicLookup.get(n.objectType.name)?.name))}return u}_isEndEntitySpatial(e,t,n){for(let r of e??[])if(this.entityTypeNames.has(r)){let e=this.geographicLookup.get(r),i=e&&this.sublayerCaches.get(r)?.get(t.attributes[n]);if(e&&i?.attributes[e.name])return!0}return!1}_getNamedTypeIdMapFromNodeIds(e){let t=new Map;return e.forEach(e=>{if(this.memberIdTypeLookup.has(e))for(let n of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(n))return;t.has(n)?t.get(n)?.push(e):t.set(n,[e])}}),t}};M([o()],q.prototype,`knowledgeGraph`,void 0),M([o()],q.prototype,`inclusionModeDefinition`,void 0),M([o()],q.prototype,`entityTypeNames`,void 0),M([o()],q.prototype,`relationshipTypeNames`,void 0),M([o()],q.prototype,`geographicLookup`,void 0),M([o()],q.prototype,`sublayerCaches`,void 0),M([o()],q.prototype,`nodeConnectionsLookup`,void 0),M([o()],q.prototype,`relationshipConnectionsLookup`,void 0),M([o()],q.prototype,`memberIdTypeLookup`,void 0),q=M([k(`esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager`)],q);var hn=Symbol(`isKnowledgeGraphGraphicOriginSymbol`),gn,_n=class extends Ee{get[(gn=hn,je)](){return this.sublayer}get[We](){return this.sublayer}get[Ze](){return this.sublayer}constructor(e,t){super(),this[gn]=!0,this.type=`knowledge-graph`,this.layer=e,this.sublayer=t}get id(){return this.layer.id}},vn=Symbol(`isLinkChartGraphicOriginSymbol`),yn,bn=class extends Ee{get[(yn=vn,Ze)](){return this.layer}constructor(e,t){super(),this[yn]=!0,this.type=`link-chart`,this.layer=e,this.sublayer=t}get id(){return`${this.layer.id}:__${this.sublayer.id}__`}},xn=c(),Sn=e=>{let t=e,n=class extends t{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return M([o(xn.fields)],n.prototype,`fields`,void 0),M([o(xn.fieldsIndex)],n.prototype,`fieldsIndex`,void 0),n=M([k(`esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase`)],n),n},Cn=p,J=class extends a{constructor(e){super(e),this.entityAdds=void 0,this.entityUpdates=void 0,this.entityDeletes=void 0,this.relationshipAdds=void 0,this.relationshipUpdates=void 0,this.relationshipDeletes=void 0,this.options=void 0}};M([o()],J.prototype,`entityAdds`,void 0),M([o()],J.prototype,`entityUpdates`,void 0),M([o()],J.prototype,`entityDeletes`,void 0),M([o()],J.prototype,`relationshipAdds`,void 0),M([o()],J.prototype,`relationshipUpdates`,void 0),M([o()],J.prototype,`relationshipDeletes`,void 0),M([o()],J.prototype,`options`,void 0),J=M([k(`esri.rest.knowledgeGraph.GraphApplyEdits`)],J);var wn={initializeLayersFromClientData:async(e,t,n)=>{if(t||=[...e.layers,...e.tables].map(e=>e.graphTypeName),t?.length===0)return;let r=new Map;for(let n of t)r.set(n,Tn(e,n));let i=await ht(e.dataManager.knowledgeGraph,Array.from(r.values()),{requestOptions:{signal:n?.signal}});for(let t of[...e.layers,...e.tables]){let n=t.objectType.name;if(n==null)continue;let r=i.get(Tn(e,n));if(r){let e=JSON.parse(r);typeof e!=`object`||!e||e.hasOwnProperty(`showLabels`)||(e.showLabels=!1),t.read(e,{origin:`service`})}}},getInclusionDefinitionFromCypherResults:async(e,t,n)=>{let r=Wn(e.dataModel),i=(await L(e,t,n)).resultRowsStream.getReader();for(;;){let{done:e,value:t}=await i.read();if(e)break;for(let e of t)for(let t of e)Y(t,r)}return r},getInclusionDefinitionFromIdTypePairs:(e,n)=>{let r=Wn(e.dataModel);for(let{id:e,typeName:i}of n){let n=r.namedTypeDefinitions.get(i);if(!n)throw new t(`WebLinkChart:data-model-desync`,`The provided id-type pairs contained a named type not reflected in the provided knowledge graph data model.`);n.members?.set(e,{id:e})}return r},getUserKGSPrivileges:async(e,t,n)=>{let i=!0,a=!1,o=!1;if(!r.userPrivilegesApplied)return{edit:i,fullEdit:a,updateItem:o};let s=await g(t,n);if(!s||!Je?.getCredential(`${s}/sharing`,{...n,prompt:!1}))return{edit:i,fullEdit:a,updateItem:o};let c=new re({id:e,portal:{url:s}});return await c.load(n),{features:{edit:i,fullEdit:a},content:{updateItem:o}}=de(c),{edit:i,fullEdit:a,updateItem:o}}},Tn=(e,t)=>e.type===`knowledge-graph`?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function En(e,t,n){return wn.initializeLayersFromClientData(e,t,n)}var Dn=`#4a0932.#b31515.#18382e.#a64f1b.#102432.#8c213f.#ed9310.#2c6954.#144d59.#ffc730.#75351e.#454f4b.#78b1c2.#191921.#8f8f82.#9be0c0.#dbb658.#87b051.#11495c.#c43541.#9c5596.#44498b.#ad9d63.#86afb3.#5c98ca.#b0bfa2.#73241f.#b86b53.#d9d78c.#3e756d.#f260a1.#a0d17d.#c27c30.#eb82eb.#ffdf3c.#ffb259.#ab52b3.#3cccb4.#0095ba.#d92b30`.split(`.`),On=`#8f8f82`;function kn(e){return e<0||e>=Dn.length?new ze(On):new ze(Dn[e])}function An(e){let t=e.toArray();return new Ke({data:{type:`CIMSymbolReference`,symbol:{type:`CIMLineSymbol`,symbolLayers:[{type:`CIMSolidStroke`,enable:!0,style:`solid`,width:.75,color:t},{type:`CIMVectorMarker`,enable:!0,size:6,markerPlacement:{type:`CIMMarkerPlacementOnLine`,angleToLine:!0,relativeTo:`LineMiddle`},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:`CIMMarkerGraphic`,geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:`CIMPolygonSymbol`,symbolLayers:[{type:`CIMSolidFill`,enable:!0,color:t}]}}]}]}}})}function jn(e){let t=`ESRI__ID`,n=4;for(let r of e)if(r.name){if(r.name.toLowerCase()===`name`){t=r.name;break}r.name.toLowerCase().includes(`name`)?(t=r.name,n=2):r.fieldType===`esriFieldTypeString`&&n>3&&(t=r.name,n=3)}return t}function Mn(e,t,n){let r={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:`normal`}},i=new O({labelExpressionInfo:new x({expression:n===`ESRI__ID`?`${t}`:`$feature.${n}`}),labelPlacement:`above-center`,symbol:new C(r)}),a=new O({labelExpressionInfo:new x({expression:`'${t}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')`}),labelPlacement:`center-along`,labelPosition:`parallel`,repeatLabel:!1,symbol:new C({...r,yoffset:`12px`})});return e===`entity`?[i]:[a]}function Nn(e,t,n){let r={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:`bold`}},i=n===`ESRI__ID`?`${e}`:`$feature.${n}`;return t===`point`?[new O({labelExpressionInfo:new x({expression:i}),labelPlacement:`above-center`,symbol:new C(r)})]:t===`polyline`?[new O({labelExpressionInfo:new x({expression:i}),labelPlacement:`center-along`,repeatLabel:!0,symbol:new C(r)})]:t===`polygon`?[new O({labelExpressionInfo:new x({expression:i}),labelPlacement:`always-horizontal`,symbol:new C(r)})]:null}async function Pn(e,t,n){return wn.getUserKGSPrivileges(e,t,n).catch(e=>(He(e),{edit:!0,fullEdit:!1,updateItem:!1}))}var Fn={capabilities:[],allowGeometryUpdates:!1,serviceCapabilities:{geometryCapabilities:{supportsZValues:!1,supportsMValues:!1}}};function In(e){let{capabilities:t,allowGeometryUpdates:n,serviceCapabilities:{geometryCapabilities:{supportsZValues:r,supportsMValues:i}}}=e?.serviceDefinition||Fn,a=e?.dataModel.arcgisManaged?t:t.filter(e=>e===`Query`),o=new Set(a);return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportedCurveTypes:[],supportsAttachment:!1,supportsM:i,supportsTrueCurve:!1,supportsZ:r},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:o.has(`Create`),supportsDelete:o.has(`Delete`),supportsEditing:o.has(`Editing`),supportsChangeTracking:!1,supportsQuery:o.has(`Query`),supportsQueryBins:!1,supportsQueryPivot:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:o.has(`Update`),supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:st,queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:ct,editing:{supportsGeometryUpdate:!!e?.dataModel.arcgisManaged&&n,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsTrueCurveUpdate:!1,supportsTrueCurveUpdateByTrueCurveClientsOnly:!0,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:o.has(`Delete`),supportsUpdateByAnonymous:!1,supportsUpdateByOthers:o.has(`Update`),supportsAsyncApplyEdits:!1,zDefault:void 0}}}async function Ln(e,t){let n=new J,r=t.graphTypeName,i=t.graphType,a=t.parentCompositeLayer.type===`knowledge-graph`?t.geometryFieldName:null,o=!!t.fieldsIndex.get(a)?.editable,s=e=>{let n={...e};for(let e of t.fields)e.editable||delete n[e.name];for(let t of Object.keys(e))t.includes(`ESRI__`)&&delete n[t];return n},c=async e=>{await A(e.spatialReference,T.WGS84);let t=w(e,T.WGS84);return t.type===`point`?t.normalize():(await Qe(t))[0]};for(let t of e.addFeatures??[]){let e=s(t.attributes);y(t.sourceLayer)&&t.sourceLayer.graphTypeName===r&&(i===`entity`?(n.entityAdds||=[],a&&t.geometry&&(e[a]=await c(t.geometry)),n.entityAdds.push(new at({properties:e,typeName:r}))):(n.relationshipAdds||=[],n.relationshipAdds.push(new ot({properties:e,typeName:r}))))}for(let t of e.updateFeatures??[]){let e=t.attributes[R],l=s(t.attributes);y(t.sourceLayer)&&t.sourceLayer.graphTypeName===r&&(i===`entity`?(n.entityUpdates||=[],a&&o&&t.geometry&&(l[a]=await c(t.geometry)),n.entityUpdates.push(new at({id:e,properties:l,typeName:r}))):(n.relationshipUpdates||=[],n.relationshipUpdates.push(new ot({id:e,properties:l,typeName:r}))))}let l=new Map;for(let t of e.deleteFeatures??[])if(Ue(t)){let e=t,n=P(l,e.sourceLayer.graphTypeName,()=>({typeName:e.sourceLayer.graphTypeName,ids:[]}));e.sourceLayer.graphTypeName===r&&n.ids.push(e.attributes.ESRI__ID)}else t.objectId&&typeof t.objectId==`string`&&P(l,r,()=>({typeName:r,ids:[]})).ids.push(t.objectId);for(let e of l.values())e.ids.length>0&&(i===`entity`?(n.entityDeletes||=[],n.entityDeletes.push({typeName:e.typeName,ids:e.ids})):(n.relationshipDeletes||=[],n.relationshipDeletes.push({typeName:e.typeName,ids:e.ids})));return n}function Rn(e,t){let n={addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]};for(let r of e.editResults)if(r.typeName===t){for(let e of r.adds)n.addFeatureResults.push({objectId:e.id,globalId:e.id});for(let e of r.updates)n.updateFeatureResults.push({objectId:e.id,globalId:e.id});for(let e of r.deletes)n.deleteFeatureResults.push({objectId:e.id,globalId:e.id})}return n}function zn(e){if(!e.objectType)return null;let t=[];for(let n of e.fields)!n.name.includes(`ESRI__`)&&n.editable&&n.type!==`geometry`&&t.push(new Cn({fieldName:n.name}));return new he({elements:t})}function Bn(e){if(!e.objectType)return null;let t=null;switch(e.geometryType){case`point`:case`multipoint`:t=`point`;break;case`polyline`:t=`line`;break;case`polygon`:t=`polygon`;break;default:t=null}return[new ge({name:e.graphTypeName,drawingTool:t,prototype:{}})]}function Vn(e){return!(!e||typeof e!=`object`||Array.isArray(e))&&`id`in e&&`typeName`in e}function Hn(e){return!(!e||typeof e!=`object`||Array.isArray(e))&&e&&`path`in e&&Array.isArray(e.path)}function Un(e){return!(!e||typeof e!=`object`||Array.isArray(e)||`id`in e)&&`properties`in e&&typeof e.properties==`object`}function Wn(e){let t={namedTypeDefinitions:new Map,generateAllSublayers:!1},{entityTypes:n,relationshipTypes:r}=e,i=[...n,...r];for(let e of i)t.namedTypeDefinitions.set(e.name,{useAllData:!1,members:new Map});return t}function Y(e,n){if(e&&typeof e==`object`){if(Vn(e)){let r=n.namedTypeDefinitions.get(e.typeName);if(!r)throw new t(`WebLinkChart:data-model-desync`,`The query result contained a named type not reflected in the provided knowledge graph data model.`);r.members.set(e.id,{id:e.id})}else if(Hn(e))for(let t of e.path)Y(t,n);else if(Array.isArray(e))for(let t of e)Y(t,n);else if(Un(e))for(let t of Object.values(e.properties??{}))Y(t,n)}}function X(e){if(!e.json)return e;e.json.write=Gn(e.json.write);let t=e.json.origins;if(!t)return e;let n;for(n in t){let e=t[n];e&&(e.write=Gn(e.write))}return e}function Gn(e){return typeof e==`object`&&e?(!1!==e.enabled&&(e.overridePolicy=Kn(e)),e):!0===e?Z():e}function Kn(e){let{target:t,writer:n,overridePolicy:r,...i}=e;return function(e,t){let n=qn.call(this,e,t);return n.enabled?{...i,...n}:n}}function Z(){return{overridePolicy:qn}}function qn(e,t){let n=!!this.geometryType,r={enabled:n};return n&&(r={...r,...Q.call(this,e,t)}),r}function Q(e,t){return{ignoreOrigin:this.originIdOf(t)>0}}var $=class extends Sn(Ge(ue(xe(qe(ce(ae(n(Me(be(pe)))))))))){constructor(e){super(e),this.blendMode=`normal`,this.charts=null,this.definitionExpression=null,this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=R,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{let e=new MessageChannel;return new Ve(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{let n=N.fromJSON(e);return this.queryFeaturesJSON(n,t)}}}),[e.port2]})},this.type=`knowledge-graph-sublayer`,this.useViewTime=!0,this.visible=!0}get capabilities(){return this.parent?this.parent.sublayerCapabilities:In(null)}get isTable(){return this.parentCompositeLayer?.type!==`link-chart`&&this.geometryFieldName==null}get defaultPopupTemplate(){return this.createPopupTemplate()}get editingEnabled(){return this.capabilities.operations.supportsEditing&&this.userHasEditingPrivileges}set editingEnabled(e){this._overrideIfSome(`editingEnabled`,e)}get effectiveCapabilities(){let e=v(this.capabilities),{operations:t,editing:n}=e;return this.userHasUpdateItemPrivileges&&(t.supportsAdd=t.supportsDelete=t.supportsEditing=t.supportsQuery=t.supportsUpdate=n.supportsDeleteByOthers=n.supportsGeometryUpdate=n.supportsUpdateByOthers=!0),this.userHasFullEditingPrivileges&&t.supportsEditing&&(t.supportsAdd=t.supportsDelete=t.supportsUpdate=n.supportsGeometryUpdate=!0),e}get effectiveEditingEnabled(){return this.userHasUpdateItemPrivileges||this.editingEnabled}set featureReduction(e){let t=this._normalizeFeatureReduction(e);this._set(`featureReduction`,t)}get fields(){let e=[],t=new Map;for(let e of this.parent?.knowledgeGraph.dataModel.domains??[])t.set(e.name,e);return this.objectType?.properties?.forEach(n=>{let r=n.fieldType===`esriFieldTypeOID`?`esriFieldTypeInteger`:n.fieldType,i=j.fromJSON({name:n.name,type:r,alias:n.alias,defaultValue:n.defaultValue,editable:n.editable,nullable:n.nullable,domain:n.domain&&t.has(n.domain)?t.get(n.domain).toJSON():void 0});e.push(i)}),e.push(j.fromJSON({name:this.objectIdField,type:`esriFieldTypeString`,alias:this.objectIdField,editable:!1}),j.fromJSON({name:gt,type:`esriFieldTypeInteger`,alias:gt,editable:!1}),j.fromJSON({name:V,type:`esriFieldTypeInteger`,alias:V,editable:!1})),e}get formTemplate(){return this._isOverridden(`formTemplate`)?this._get(`formTemplate`):zn(this)}set formTemplate(e){this._overrideIfSome(`formTemplate`,e)}get geometryType(){if(this.parentCompositeLayer?.type===`link-chart`)return this.graphType===`relationship`?`polyline`:`point`;let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&t!==`esriGeometryNull`?D.fromJSON(t):null}get geometryFieldName(){return this.parentCompositeLayer?.type===`link-chart`?B:this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name)?.name??null}get graphicOrigin(){if(!this.parent)return null;switch(this.parent.type){case`knowledge-graph`:return new _n(this.parent,this);case`link-chart`:return new bn(this.parent,this)}}get graphTypeName(){return this.objectType?.name}set graphTypeName(e){this._set(`graphTypeName`,e)}get hasM(){let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name;return(t?this.objectType?.properties?.[t]:null)?.hasM??!1}get hasZ(){let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name;return(t?this.objectType?.properties?.[t]:null)?.hasZ??!1}set labelingInfo(e){this._set(`labelingInfo`,e)}get labelingInfo(){if(this._isOverridden(`labelingInfo`))return this._get(`labelingInfo`);if(!this.objectType||!this.parentCompositeLayer||!this.graphTypeName)return null;let e=this.objectType.properties?jn(this.objectType.properties):`ESRI__ID`;return this.parentCompositeLayer.type===`link-chart`?Mn(this.graphType,this.graphTypeName,e):Nn(this.graphTypeName,this.geometryType,e)}set renderer(e){le(e,this.fieldsIndex),this._set(`renderer`,e)}get renderer(){if(this._isOverridden(`renderer`))return this._get(`renderer`);let e=this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel,t=[...e?.entityTypes??[],...e?.relationshipTypes??[]].map(e=>e.name).indexOf(this.graphTypeName),n=kn(t);if(this.parentCompositeLayer?.type===`link-chart`){if(this.graphType===`relationship`)return new ee({type:`simple`,symbol:An(n)});let e=S(lt(D.toJSON(`point`)).renderer);return ut(e.symbol,n),e}let r=S(lt(D.toJSON(this.geometryType)).renderer);return ut(r.symbol,n),r}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??T.WGS84}get templates(){return this._isOverridden(`templates`)?this._get(`templates`):Bn(this)}set templates(e){this._overrideIfSome(`templates`,e)}set timeInfo(e){this._set(`timeInfo`,e)}get title(){return this._isOverridden(`title`)?this._get(`title`):this.graphTypeName}set title(e){this._set(`title`,e)}writeTitle(e,t){t.title=e??`Layer`}get userHasEditingPrivileges(){return!this.parent||this.parent.userHasEditingPrivileges}get userHasFullEditingPrivileges(){return!!this.parent&&this.parent.userHasFullEditingPrivileges}get userHasUpdateItemPrivileges(){return!!this.parent&&this.parent.userHasUpdateItemPrivileges}createPopupTemplate(e){return Te(this,e)}createQuery(){return new N({where:`1=1`,outFields:[`*`]})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){return this.fields.find(t=>t.name===e)?.domain||null}async queryFeatures(e,t){await this.load();let{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e),i=this.graphicOrigin,a=Ae.fromJSON(await r.executeQuery(n.toJSON(),t?.signal));return a.features.forEach(e=>{e.sourceLayer=this,e.origin=i}),a}async queryFeaturesJSON(e,t){await this.load();let{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return await r.executeQuery(n.toJSON(),t?.signal)}async queryFeatureCount(e,t){await this.load();let{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return r.executeQueryForCount(n.toJSON(),t?.signal)}async queryExtent(e={},t){await this.load();let n={...e,returnGeometry:!0},{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(n),a=await i.executeQueryForExtent(r.toJSON(),t?.signal),o;return o=a.extent?.xmin!=null&&a.extent?.xmax!=null&&a.extent?.ymin!=null&&a.extent?.ymax!=null?new F(a.extent):new F,{count:a.count,extent:o}}async queryObjectIds(e,t){await this.load();let n=N.from(e),r;if(this.parentCompositeLayer.type===`link-chart`&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{let e=await this.parentCompositeLayer.dataManager.getData(n,this,t);r=this.loadQueryEngine(e)}return await r.executeQueryForIds(n.toJSON(),t?.signal)}async applyEdits(e){if(!this.parentCompositeLayer.dataManager.knowledgeGraph)throw new t(`knowledge-graph-sublayer:no-knowledge-graph`,`ApplyEdits cannot be executed because the parent does not have a Knowledge Graph model.  This is usually caused by the layer not yet being loaded`);let n=await Ln(e,this);n.options={cascadeDelete:!0,cascadeProvenanceDelete:!!this.parent?.knowledgeGraph.serviceDefinition.supportsProvenance||void 0};let r=await mt(this.parentCompositeLayer.dataManager.knowledgeGraph,n),i=Rn(r,this.graphTypeName),a={addedFeatures:i.addFeatureResults,updatedFeatures:i.updateFeatureResults,deletedFeatures:i.deleteFeatureResults,addedAttachments:i.addAttachmentResults,deletedAttachments:i.deleteAttachmentResults,updatedAttachments:i.updateAttachmentResults,exceededTransferLimit:!1,historicMoment:new Date,edits:void 0};return this.emit(`edits`,a),this.emit(`apply-edits`,{result:Promise.resolve(a)}),this.parentCompositeLayer.type===`link-chart`&&await this.parentCompositeLayer.refreshLinkChartCache([...a.addedFeatures.map(e=>e.globalId),...a.updatedFeatures.map(e=>e.globalId),...a.deletedFeatures.map(e=>e.globalId)]),i}loadQueryEngine(e){let t=new yt({geometryType:D.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new bt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:D.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,featureIdInfo:{type:`object-id`,fieldName:this.objectIdField},spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){let e=await this.parentCompositeLayer.dataManager.getData(new N({where:`1=1`,outFields:[R]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>Xe(this.timeInfo,this.fieldsIndex))),Promise.resolve(this)}async _setupQueryObjects(e,t){let n=N.from(e),r=n.geometry;if(r&&!r.spatialReference?.isWGS84&&(await A(r.spatialReference,f),n.geometry=w(r instanceof s||r instanceof tt||r instanceof _?r:r.extent,f)),this.parentCompositeLayer.type===`link-chart`&&this._cachedQueryEngine)return{resolvedQuery:n,queryEngine:this._cachedQueryEngine};let i=await this.parentCompositeLayer.dataManager.getData(n,this,t);return{resolvedQuery:n,queryEngine:this.loadQueryEngine(i)}}};function Jn(e,t,n){let r=[[`ESRI__AGGREGATION_COUNT`,gt],[`ESRI__ORIGIN_ID`,_t],[`ESRI__DESTINATION_ID`,z],[`ESRI__LAYOUT_GEOMETRY`,B]];try{for(let t of e)for(let[e,n]of r)t.labelExpression=t.labelExpression?.replaceAll(e,n),t.labelExpressionInfo?.expression&&(t.labelExpressionInfo.expression=t.labelExpressionInfo.expression.replaceAll(e,n))}catch(e){l.getLogger(this).warn(`Error updating labelingInfo`,e)}return me(e,t,n)}M([o(X(v(Oe)))],$.prototype,`blendMode`,void 0),M([o({readOnly:!0})],$.prototype,`capabilities`,null),M([o()],$.prototype,`isTable`,null),M([o({json:{origins:{"web-scene":{write:!1}},write:Z()}})],$.prototype,`charts`,void 0),M([o({readOnly:!0})],$.prototype,`defaultPopupTemplate`,null),M([o({type:String,json:{origins:{service:{read:!1}},name:`layerDefinition.definitionExpression`,write:{ignoreOrigin:!0}}})],$.prototype,`definitionExpression`,void 0),M([o(X(v(ke)))],$.prototype,`displayFilterEnabled`,void 0),M([o(X(v(Re)))],$.prototype,`displayFilterInfo`,void 0),M([o()],$.prototype,`editingEnabled`,null),M([o(X(v(Ie)))],$.prototype,`effect`,void 0),M([o({readOnly:!0})],$.prototype,`effectiveCapabilities`,null),M([o({readOnly:!0})],$.prototype,`effectiveEditingEnabled`,null),M([o({type:et})],$.prototype,`elevationInfo`,void 0),M([o(X(v(Se)))],$.prototype,`featureEffect`,void 0),M([o(X(v($e)))],$.prototype,`featureReduction`,null),M([o()],$.prototype,`fields`,null),M([o({type:he})],$.prototype,`formTemplate`,null),M([o()],$.prototype,`geometryType`,null),M([o()],$.prototype,`geometryFieldName`,null),M([o({readOnly:!0})],$.prototype,`graphicOrigin`,null),M([o({type:[`entity`,`relationship`],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],$.prototype,`graphType`,void 0),M([o({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],$.prototype,`graphTypeName`,null),M([o()],$.prototype,`hasM`,null),M([o()],$.prototype,`hasZ`,null),M([o({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],$.prototype,`id`,void 0),M([o({type:Boolean,value:!0,nonNullable:!0,json:{name:`showLabels`,default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],$.prototype,`labelsVisible`,void 0),M([o({type:[O],json:{name:`layerDefinition.drawingInfo.labelingInfo`,read:Jn,write:Z()}})],$.prototype,`labelingInfo`,null),M([o({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer?.type){case`link-chart`:t.layerType=`LinkChartSubLayer`;break;case`knowledge-graph`:t.layerType=this.geometryType?`KnowledgeGraphSubLayer`:`KnowledgeGraphSubTable`}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],$.prototype,`layerType`,void 0),M([o(X(v(m)))],$.prototype,`legendEnabled`,void 0),M([o(X(v(b)))],$.prototype,`maxScale`,void 0),M([o(X(v(Pe)))],$.prototype,`minScale`,void 0),M([o()],$.prototype,`objectIdField`,void 0),M([o()],$.prototype,`objectType`,void 0),M([o(X(v(te)))],$.prototype,`opacity`,void 0),M([o(X(v(ie)))],$.prototype,`orderBy`,void 0),M([o({clonable:!1})],$.prototype,`parent`,void 0),M([o()],$.prototype,`parentCompositeLayer`,void 0),M([o(X(v(i)))],$.prototype,`popupEnabled`,void 0),M([o({type:De,json:{name:`popupInfo`,write:{ignoreOrigin:!0}}})],$.prototype,`popupTemplate`,void 0),M([o({type:Number,json:{write:{overridePolicy:Q}}})],$.prototype,`refreshInterval`,void 0),M([o({types:ve,json:{name:`layerDefinition.drawingInfo.renderer`,write:Z()}})],$.prototype,`renderer`,null),M([o()],$.prototype,`source`,void 0),M([o()],$.prototype,`spatialReference`,null),M([o({type:ge})],$.prototype,`templates`,null),M([o({type:Ne,json:{name:`layerDefinition.timeInfo`,write:{overridePolicy:Q},origins:{"web-document":{name:`layerDefinition.timeInfo`,read:!0,write:{overridePolicy:Q}},"portal-item":{name:`layerDefinition.timeInfo`,read:!0,write:{overridePolicy:Q}}}}})],$.prototype,`timeInfo`,null),M([o({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],$.prototype,`title`,null),M([ye(`title`)],$.prototype,`writeTitle`,null),M([o({json:{read:!1}})],$.prototype,`type`,void 0),M([o(X(v(d)))],$.prototype,`useViewTime`,void 0),M([o({readOnly:!0})],$.prototype,`userHasEditingPrivileges`,null),M([o({readOnly:!0})],$.prototype,`userHasFullEditingPrivileges`,null),M([o({readOnly:!0})],$.prototype,`userHasUpdateItemPrivileges`,null),M([o({type:Boolean,json:{name:`visibility`,write:Z()}})],$.prototype,`visible`,void 0),$=M([k(`esri.layers.knowledgeGraph.KnowledgeGraphSublayer`)],$);export{Jt as _,q as a,an as c,ln as d,cn as f,W as g,Zt as h,In as i,sn as l,nn as m,En as n,pn as o,rn as p,Pn as r,fn as s,$ as t,on as u,zt as v,Bt as y};