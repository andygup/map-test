import{Bl as e,C_ as t,Cl as n,Db as r,Dl as i,Eb as a,Fb as o,Fl as s,Gb as c,Gu as l,Hl as u,Hu as d,Ib as f,Lb as p,Ob as m,Ol as h,Rl as g,Uu as _,Wl as v,Z as y,_b as b,bw as ee,ct as te,gl as x,jb as S,kb as C,kl as ne,l_ as re,mD as ie,mt as ae,p_ as oe,pl as se,sD as ce,vb as le,vl as ue,x_ as de,xl as w,y_ as T,yw as fe,zl as pe}from"./index-BN8X5Ryz.js";import{E as me,b as he,c as ge,d as _e,g as ve,h as ye,i as be,m as E,x as xe,y as D}from"./plane-Da5EsY0J.js";import{a as Se,i as Ce,r as we}from"./geodesicUtils-D99LxQ6q.js";import{_ as O,a as Te,c as k,d as A,l as Ee,m as De,u as j}from"./LineSnappingHint-CmFAetWF.js";import{r as Oe}from"./sphere-d9-4vNcj.js";function ke({start:e,end:t,type:n},r,i){let a=[],o=C(F,t,e),s=C(I,e,r),c=f(o),l=2*S(o,s),u=l*l-4*c*(f(s)-i*i);if(u===0){let t=-l/(2*c);(n===0||t>=0)&&a.push(m(_(),e,o,t))}else if(u>0){let t=Math.sqrt(u),r=(-l+t)/(2*c);(n===0||r>=0)&&a.push(m(_(),e,o,r));let i=(-l-t)/(2*c);(n===0||i>=0)&&a.push(m(_(),e,o,i))}return a}function Ae(r,i){let a=r.start,o=r.end,s=C(F,o,a),l=g(R,-s[1],s[0],0),u=i.start,d=i.end,f=n(We,d,u),p=w(f,l),m=g(Ge,a[0],a[1],0),h=n(Ke,m,u),_=w(h,l),v=c();if(Math.abs(p)<v)return[];let y=e(qe,u,f,_/p);if(i.type===0){let e=n(Je,y,u);if(w(e,f)<-v)return[]}if(r.type===1){let e=b(I,y,a);if(S(e,s)<-v)return[]}return[t(y)]}function je(e,t){return ze(M(Xe,t[2],e),t)}function Me(e,t){return Re(M(Xe,0,e),M(Ze,0,t)).map(([e,t])=>l(e,t))}function Ne(e,t,n){return Fe(e,M(Xe,e[2],t),n)}function Pe(e,t,n,r=T()){let i=C(F,e,t),a=p(i);return m(r,t,i,a===0?1:n/a),r[2]=e[2],r}function Fe(t,{start:r,end:i,type:a},o=T()){let s=n(L,t,r),c=n(R,i,r),l=w(s,c)/w(c,c);return e(o,r,c,a===0?Math.max(l,0):l)}var Ie=(()=>{let t=T(),n=T(),r=T();return({start:i,end:a},{center:s,radius:c,normal:l,slicePlane:f})=>{let p=E(s,l,Ye);if(N(ye(p,i),0)&&N(ye(p,a),0)){me(l,t,n);let p=(e,i)=>(ne(r,i,s),o(e,w(r,t),w(r,n)),e),m=Te({start:p(F,i),end:p(I,a),type:1},d,c),h=[];for(let[r,i]of m){let a=u(T(),s);e(a,a,t,r),e(a,a,n,i),f&&!P(f,a)||h.push(a)}return h}let m=T();return be(p,i,a,m)?!N(pe(m,s),c)||f&&!P(f,m)?[]:[m]:[]}})();function Le({start:t,end:n,type:r},i,a){let o=[],s=ne(L,n,t),c=C(I,t,i),l=f(s),u=2*S(s,c),d=u*u-4*l*(f(c)-a*a);if(d===0){let n=-u/(2*l);(r===1||n>=0)&&o.push(e(T(),t,s,n))}else if(d>0){let n=Math.sqrt(d),i=(-u+n)/(2*l);(r===1||i>=0)&&o.push(e(T(),t,s,i));let a=(-u-n)/(2*l);(r===1||a>=0)&&o.push(e(T(),t,s,a))}return o}function Re(r,a){let o=r.start,s=r.end,l=a.start,u=a.end,d=n(L,s,o),f=n(R,u,l),p=n(We,l,o),m=h(Ge,d,f);if(!N(w(p,m),0))return[];let g=i(m);if(N(g,0))return[];let _=h(Ke,p,f),v=w(_,m)/g,y=e(qe,o,d,v);if(r.type===0){let e=n(Je,y,o);if(w(d,e)<-c())return[]}if(a.type===0){let e=n(Je,y,l);if(w(f,e)<-c())return[]}return[t(y)]}function ze({start:e,end:r,type:a},o){let s=n(L,o,e),l=n(R,r,e),u=h(We,l,s),d=i(u)/i(l),f=c();if(d<f)switch(a){case 1:return[t(o)];case 0:return w(l,s)<-f?[]:[t(o)]}return[]}function Be(e,t,n,r){let[i,o]=e,[s,c]=n,u=s-i,d=c-o,f=u*u+d*d,p=Math.sqrt(f);if(p>t+r||p<Math.abs(t-r)||N(p,0)&&N(t,r))return[];let m=(t*t-r*r+f)/(2*p),h=Math.sqrt(t*t-m*m),g=h*d/p,_=h*u/p,[v,y]=a(F,e,n,m/p);return N(g,_)?[l(v,y)]:[l(v+g,y-_),l(v-g,y+_)]}function M(e,t,{start:n,end:r,type:i}){return g(e.start,n[0],n[1],t),g(e.end,r[0],r[1],t),e.type=Ue[i],e}function Ve(e,t){return N(e[2],t[2])}function N(e,t){return ee(Math.abs(e-t),0,c())}function He(e,t){return t.filter(t=>P(e,t))}function P(e,t){return ge(e,t)}var Ue={0:1,1:0},F=_(),I=_(),L=T(),R=T(),We=T(),Ge=T(),Ke=T(),qe=T(),Je=T(),Ye=D(),Xe={start:T(),end:T(),type:1},Ze={start:T(),end:T(),type:1},z=class{intersect(e){return H(this,e)}closestPoints(e){return[this.closestTo(e)]}},B=class extends z{constructor(e){super(),this.point=e}equals(e){return this===e||G(e)&&x(this.point,e.point)}closestTo(){return j(this.point)}},Qe=class extends z{constructor(e,t,n){super(),this.start=e,this.end=t,this.lineLike={start:e,end:t,type:n}}equals(e){return this===e||K(e)&&this.lineLike.type===e.lineLike.type&&x(this.start,e.start)&&x(this.end,e.end)}closestTo(e){let t=A();return Fe(e,this.lineLike,t),t}},$e=class extends Qe{constructor(e,t){super(e,t,1)}},et=class extends Qe{constructor(e,t){super(e,t,0)}},tt=class extends z{constructor(e){super(),this.constraints=e}equals(e){return this===e||Ht(e)&&ie(this.constraints,e.constraints,(e,t)=>e.equals(t))}closestTo(e){let t,n=1/0;for(let r of this.constraints){let i=r.closestTo(e),a=v(e,i);a<n&&(n=a,t=i)}return j(t??e)}closestPoints(e){return this.constraints.flatMap(t=>t===this?[]:t.closestPoints(e))}},nt=class extends z{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||Y(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){let t=A();return Pe(e,this.center,this.radius,t),t}},rt=class extends z{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||X(e)&&x(this.center,e.center)&&this.radius===e.radius}closestTo(e){let t=A();return Pe(e,this.center,this.radius,t),t[2]=this.center[2],t}asCircle(){return new it(j(this.center),this.radius,k(0,0,1))}},it=class extends z{constructor(e,t,n,r){super(),this.center=e,this.radius=t,this.normal=n,this.slicePlane=r}equals(e){return this===e||Z(e)&&x(this.center,e.center)&&x(this.normal,e.normal)&&this.radius===e.radius}closestTo(t){let{center:r,radius:i}=this;_e(this.getPlane(ot),t,at);let a=n(at,at,r),o=s(a);if(N(o,0))return j(t);let c=i/Math.sqrt(o),l=A();e(l,r,a,c);let{slicePlane:u}=this;return u&&!P(u,l)?Dt(u,this)?.closestTo(t)??j(t):l}getPlane(e=D()){return E(this.center,this.normal,e)}},at=T(),ot=D(),st=class extends z{constructor(e){super(),this.z=e}equals(e){return this===e||q(e)&&this.z===e.z}closestTo(e){return k(e[0],e[1],this.z)}getPlane(e=D()){return g(ct,0,0,this.z),E(ct,oe,e)}},ct=T(),lt=class extends z{constructor(e,t,n){super(),this.start=e,this.end=t,this.planeLike={start:O(e),end:O(t),type:n}}equals(e){return this===e||J(e)&&this.planeLike.type===e.planeLike.type&&x(this.start,e.start)&&x(this.end,e.end)}closestTo(e){let t=A();return Ne(e,this.planeLike,t),t}closestEndTo(e){let{start:t,end:n}=this.planeLike;return Math.sign(S(C(ut,n,t),C(dt,O(e),t)))>0?this.end:this.start}getPlane(e=D()){let t=u(ft,this.end);return t[2]+=1,xe(this.start,this.end,t,e)}getSlicePlane(e=D()){let{start:t,end:n,type:r}=this.planeLike;if(r===0)return;let i=g(ft,t[0],t[1],0),a=g(pt,n[0],n[1],0),o=ne(pt,a,i);return E(i,o,e),e}},ut=_(),dt=_(),ft=T(),pt=T(),mt=class extends lt{constructor(e,t){super(e,t,1)}},ht=class extends lt{constructor(e,t){super(e,t,0)}},gt=class extends z{constructor(e,n){super(),this.sphere=new Oe(e,n),this._center=t(e)}equals(e){return this===e||Q(e)&&this.sphere.exactEquals(e.sphere)}closestTo(e){let t=A();return this.sphere.projectPoint(e,t),t}get center(){return this._center}get radius(){return this.sphere.radius}},_t=class extends z{constructor(e,t,n){super(),this.start=e,this.end=t,this.getZ=n,this.planeLike={start:O(e),end:O(t),type:0}}equals(e){return this===e||$(e)&&x(this.start,e.start)&&x(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return Ct(this,e)}addIfOnTheGround(e,t){for(let n of t){let t=this.getZ(n[0],n[1])??0;N(n[2],t)&&(n[2]=t,e.push(n))}}},vt=class extends z{constructor(e,t,n){super(),this._x=e,this._y=t,this._z=n}equals(e){return this===e||Wt(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,t,n]){return De(this._x??e,this._y??t,this._z??n)}},yt=class extends z{constructor(e,t,n,r,i){super(),this._origin=e,this._spatialReference=t,this._distanceMeters=n,this._z=r,this._directionDegrees=i}equals(e){return this===e||Ut(e)&&le(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,t,n]){return o(V,e,t),le(V,this._origin)||this._applyDirectionAndDistance(V),De(V[0],V[1],this._z??n)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Ce(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)xt(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){let{azimuth:t}=Se(bt,this._origin,e,this._spatialReference);Ce(e,this._origin,t??0,this._distanceMeters,this._spatialReference)}}},V=[0,0],bt=new we;function xt(e,t,n,r,i){let{azimuth:a,distance:o}=Se(St,t,r,i);a??=0;let s=o*Math.cos((a-n)*re);s=Math.max(0,s),Ce(e,t,n,s,i)}var St=new we;function Ct(e,t){let n=A();return Ne(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??Gt,n}function H(e,t){if(Ht(e)){let n=[];for(let r of e.constraints){let e=r.intersect(t);e&&n.push(e)}return W(n)}if(Ht(t))return H(t,e);if($(e))return zt(e,t);if($(t))return zt(t,e);if(G(e)){let{point:n}=e;if(G(t))return x(n,t.point)?e:void 0;let r=t.closestTo(n);return ue(r,n)?e:void 0}if(K(e)){if(G(t))return H(t,e);if(K(t))return U(Re(e.lineLike,t.lineLike));if(q(t))return wt(e,t);if(J(t))return U(Ae(t.planeLike,e.lineLike));if(Y(t))return U(Le(e.lineLike,t.center,t.radius));if(Z(t))return U(Ie(e.lineLike,t));if(X(t))return Tt(e,t);if(Q(t))return Et(e,t)}else if(q(e)){if(G(t)||K(t))return H(t,e);if(q(t))return Ot(e,t);if(J(t))return kt(e,t);if(Y(t))return At(e,t);if(Z(t))return Mt(e,t);if(X(t))return jt(e,t);if(Q(t))return Nt(e,t)}else if(J(e)){if(G(t)||K(t)||q(t))return H(t,e);if(J(t))return Bt(Me(e.planeLike,t.planeLike));if(Y(t))return Bt(ke(e.planeLike,t.center,t.radius));if(Z(t))return Ft(e,t);if(X(t))return Pt(e,t);if(Q(t))return It(e,t)}else if(Y(e)){if(G(t)||K(t)||q(t)||J(t))return H(t,e);if(Y(t))return Bt(Be(O(e.center),e.radius,O(t.center),t.radius));if(Z(t))return;if(X(t))return Lt(e,t);if(Q(t))return}else if(Z(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t))return H(t,e);if(Z(t))return;if(X(t))return t.asCircle(),void 0;if(Q(t))return}else if(X(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t)||Z(t))return H(t,e);if(X(t))return Rt(t,e);if(Q(t))return}else if(Q(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t)||X(t))return H(t,e);if(Q(t))return}}var wt=(()=>{let e=D();return(t,n)=>{let{start:r,end:i}=t;if(Ve(r,i)&&N(r[2],n.z))return t;let a=A();return be(n.getPlane(e),r,i,a)?new B(a):void 0}})();function Tt({lineLike:e},{center:t,radius:n}){let r=t[2];return U(Le(e,t,n).filter(e=>N(e[2],r)))}function Et({lineLike:e},{sphere:t}){return U(t.intersectLine(e.start,e.end))}var Dt=(()=>{let n=y(),r=T(),i=T();return(a,o,s)=>{let{normal:c,center:l,radius:u}=o;me(c,r,i);let d=he(a),f=u*w(d,r),p=u*w(d,i);ae(n,l[0],l[1],l[2],1);let m=te(a,n),g=Math.hypot(f,p),_=N(g,0);if(N(ye(a,l),0)){if(_)return o;if(N(u,0))return!s||P(s,l)?new B(j(l)):void 0;h(r,d,c),se(r,r);let n=[],i=t(l);e(i,i,r,u),s&&!P(s,i)||n.push(i);let a=t(l);return e(a,a,r,-u),s&&!P(s,a)||n.push(a),U(n)}if(_)return;let v=-m/g;if(Math.abs(v)>1||N(v,1))return;let y=Math.atan(f/p),b=fe(v)-y,ee=Math.PI-b,x=[],S=T();e(S,l,r,u*Math.cos(b)),e(S,S,i,u*Math.sin(b)),x.push(S);let C=T();return e(C,l,r,u*Math.cos(ee)),e(C,C,i,u*Math.sin(ee)),x.push(C),U(s?He(s,x):x)}})();function Ot(e,t){return N(e.z,t.z)?e:void 0}function kt({z:e},{planeLike:t}){let[n,r]=t.start,[i,a]=t.end,o=k(n,r,e),s=k(i,a,e);return t.type===0?new $e(o,s):new et(o,s)}function At(e,t){let[n,r]=t.center;return new rt(k(n,r,e.z),t.radius)}function jt(e,t){return N(t.center[2],e.z)?t:void 0}var Mt=(()=>{let e=D();return(t,n)=>Dt(t.getPlane(e),n,n.slicePlane)})();function Nt(e,{center:t,radius:n}){let r=Math.abs(t[2]-e.z);if(r>n&&!N(r,n))return;let i=k(t[0],t[1],e.z),a=Math.sqrt(n**2-r**2);return N(a,0)?void 0:new rt(i,a)}var Pt=(()=>{let e=D();return(t,{center:n,radius:r})=>{let i=ke(t.planeLike,n,r),a=n[2];t.getSlicePlane(e);let o=[];for(let[t,n]of i){let r=[t,n,a];P(e,r)&&o.push(r)}return U(o)}})(),Ft=(()=>{let e=D(),t=D();return(n,r)=>Dt(n.getPlane(e),r,n.getSlicePlane(t))})(),It=(()=>{let n=D();return(r,{center:i,radius:a})=>{let o=r.getPlane(n),s=ve(o,i),c=Math.abs(s);if(c>a&&!N(c,a))return;let l=Math.sqrt(a**2-s**2);if(N(l,0)){let e=A();return _e(o,i,e),new B(e)}let u=A(),d=t(he(o));return e(u,i,d,s),new it(u,l,d,r.getSlicePlane())}})();function Lt(e,t){let n=r(O(e.center),O(t.center));return N(n,0)&&N(e.radius,t.radius)?t:Vt(Be(O(e.center),e.radius,O(t.center),t.radius),t.center[2])}function Rt(e,t){if(!Ve(e.center,t.center))return;let n=r(O(e.center),O(t.center));return N(n,0)&&N(e.radius,t.radius)?e:Vt(Be(O(e.center),e.radius,O(t.center),t.radius),e.center[2])}function zt(e,t){let{planeLike:n,getZ:r}=e,i=[];if(G(t))e.addIfOnTheGround(i,je(n,t.point));else if(K(t))e.addIfOnTheGround(i,Ae(n,t.lineLike));else if(Y(t))for(let[e,a]of ke(n,t.center,t.radius)){let t=r(e,a);t!=null&&i.push(de(e,a,t))}else if(J(t)||$(t))for(let[e,a]of Me(n,t.planeLike)){let t=r(e,a)??Gt;i.push(de(e,a,t))}return U(i)}function Bt(e){return W(e.map(([e,t])=>{let n=k(e,t,0),r=k(e,t,1);return new $e(n,r)}))}function U(e){return W(e.map(e=>e?new B(Ee(e)):void 0))}function Vt(e,t){return U(e.map(([e,n])=>[e,n,t]))}function W(e){if(e.length!==0)return e.length===1?e[0]??void 0:new tt(e.filter(ce))}function Ht(e){return e instanceof tt}function G(e){return e instanceof B}function K(e){return e instanceof Qe}function q(e){return e instanceof st}function J(e){return e instanceof lt}function Y(e){return e instanceof nt}function X(e){return e instanceof rt}function Z(e){return e instanceof it}function Q(e){return e instanceof gt}function $(e){return e instanceof _t}function Ut(e){return e instanceof yt}function Wt(e){return e instanceof vt}var Gt=0;export{B as a,$e as c,st as d,Fe as f,W as i,nt as l,yt as n,ht as o,vt as r,G as s,_t as t,mt as u};