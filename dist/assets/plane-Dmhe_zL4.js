import{Cl as e,Nl as t,Ol as n,c_ as r,dl as i,dw as a,jl as o,nw as s,ol as c,rl as l,sl as u,vl as d,yl as f}from"./index-ByaFsVj4.js";import{i as p,t as m}from"./vectorStacks-DhZu7qGn.js";function h(t,n,r){let a=i(t,n)/i(t,t);return e(r,t,a)}function g(e,t){return i(e,t)/o(e)}function _(e,t){let n=i(e,t)/(o(e)*o(t));return-s(n)}function v(e,t,n){l(y,e),l(b,t);let r=i(y,b),a=s(r),o=d(y,y,b);return i(o,n)<0?2*Math.PI-a:a}var y=r(),b=r();function ee(e){let t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],n=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],r=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}function x(e,t){let r=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),i=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),a=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return n(e,r,i,a),e}function S(e,t,r){Math.abs(e[0])>Math.abs(e[1])?n(t,0,1,0):n(t,1,0,0),d(r,e,t),d(t,r,e),l(r,r),l(t,t)}function C(n,a,s,c=r()){let l=o(n),d=o(a),f=i(n,a)/(l*d);if(f<.9999999999999999){let r=Math.acos(f),i=((1-s)*l+s*d)/Math.sin(r),o=i/l*Math.sin((1-s)*r),u=i/d*Math.sin(s*r);return e(w,n,o),e(T,a,u),t(c,w,T)}return u(c,n,a,s)}r(),r(),r();var w=r(),T=r();function E(e=$){return[e[0],e[1],e[2],e[3]]}function te(e=$[0],t=$[1],n=$[2],r=$[3]){return k(e,t,n,r,p.get())}function D(e,t){return k(t[0],t[1],t[2],t[3],e)}function O(e){return e}function k(e,t,n,r,i=E()){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function A(e,t,n){let r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function j(e,t,n,r=E()){let i=n[0]-t[0],a=n[1]-t[1],o=n[2]-t[2],s=e[0]-t[0],c=e[1]-t[1],l=e[2]-t[2],u=a*l-o*c,d=o*s-i*l,f=i*c-a*s,p=u*u+d*d+f*f,m=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return r[0]=u*m,r[1]=d*m,r[2]=f*m,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function M(e,t,n,r=0,a=Math.floor(n*(1/3)),o=Math.floor(n*(2/3))){if(n<3)return!1;t(N,r);let s=a,u=!1;for(;s<n-1&&!u;)t(P,s),s++,u=!c(N,P);if(!u)return!1;for(s=Math.max(s,o),u=!1;s<n&&!u;)t(F,s),s++,f(I,N,P),l(I,I),f(L,P,F),l(L,L),u=!c(N,F)&&!c(P,F)&&Math.abs(i(I,L))<re;return u?(j(N,P,F,e),!0):(r!==0||a!==1||o!==2)&&M(e,t,n,0,1,2)}function ne(e,t,r=!0){let i=t.length/3;return M(e,(e,r)=>n(e,t[3*r+0],t[3*r+1],t[3*r+2]),r?i-1:i)}var re=.99619469809,N=r(),P=r(),F=r(),I=r(),L=r();function R(e,t,n){return t!==e&&D(e,t),e[3]=-i(O(e),n),e}function z(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function B(e,t,n,r){return d(F,t,e),A(n,F,r)}function V(e,t,n,r){return Z(Q(e,t,f(m.get(),n,t),oe,r))}function H(e,t,n){return t!=null&&Z(Q(e,t.origin,t.direction,se,n))}function U(e,t,n){return Z(Q(e,t.origin,t.vector,0,n))}function W(e,t,n){return Z(Q(e,t.origin,t.vector,1,n))}function G(e,t){return X(e,t)>=0}function K(e,t){let n=i(O(e),t.ray.direction),r=-X(e,t.ray.origin);if(r<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return r>0;if((r<0||n<0)&&!(r<0&&n<0))return!0;let a=r/n;return n>0?a<t.c1&&(t.c1=a):a>t.c0&&(t.c0=a),t.c0<=t.c1}function q(e,t){let n=i(O(e),t.ray.direction),r=-X(e,t.ray.origin);if(n>-1e-6&&n<1e-6)return r>0;let a=r/n;return n>0?a<t.c1&&(t.c1=a):a>t.c0&&(t.c0=a),t.c0<=t.c1}function J(n,r,i){let a=e(m.get(),O(n),-n[3]),o=ie(n,f(m.get(),r,a),m.get());return t(i,o,a),i}function Y(e,t,r,i){let a=O(e),o=m.get(),s=m.get();S(a,o,s);let c=f(m.get(),r,t),l=g(o,c),u=g(s,c),d=g(a,c);return n(i,l,u,d)}function ie(t,n,r){let a=e(m.get(),O(t),i(O(t),n));return f(r,n,a),r}function ae(e,t){return Math.abs(X(e,t))}function X(e,t){return i(O(e),t)+e[3]}function Z(e){return e===0||e===1}function Q(n,r,o,s,c){let l=i(O(n),o),u=X(n,r);if(l===0)return u>=0?2:3;let d=-u/l;return 1&s&&(d=a(d,0,1)),!(4&s)&&d<0||!(8&s)&&d>1?u>=0?2:3:(t(c,r,e(c,o,d)),u>=0?0:1)}var $=[0,0,1,0],oe=12,se=8;export{h as A,D as C,ee as D,S as E,v as M,C as O,k as S,x as T,Q as _,H as a,O as b,G as c,J as d,M as f,X as g,ae as h,V as i,g as j,_ as k,K as l,A as m,z as n,U as o,Y as p,B as r,W as s,R as t,q as u,te as v,ne as w,j as x,E as y};