import{$T as e,$x as t,Bv as n,Cy as r,Ex as i,Ey as a,Iy as o,Ly as s,Ny as c,Oy as l,Py as u,Sy as d,Ty as f,by as p,cb as m,ib as h,ky as g,lb as _,mb as v,ob as y,ub as b,uw as x,vy as S,wy as C,yy as w}from"./index-BN8X5Ryz.js";import{t as T}from"./closestPointOnCurve-CwZL45U3.js";function E(e,t,n){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0))}function D(e,t,n){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0)}var O=[];for(let e of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){let t=e[0];for(let n=1;n<e.length;n++)O[e[n]]=t}var k=[];function A(e){return e.vcsWkid&&O[e.vcsWkid]!==void 0?k[O[e.vcsWkid]]:e.latestVcsWkid&&O[e.latestVcsWkid]!==void 0?k[O[e.latestVcsWkid]]:1}function j(e,t,n){let r=t[0]-e[0],i=t[1]-e[1];if(n){let e=t[2]-t[2];return Math.sqrt(r*r+i*i+e*e)}return Math.sqrt(r*r+i*i)}function M(e,t,n){let r=t[0]-e[0],i=t[1]-e[1];if(n){let e=t[2]-t[2];return r*r+i*i+e*e}return r*r+i*i}function ee(e,t){return e.x*t.x+e.y*t.y}function te(e,t){return e.x*t.y-t.x*e.y}function N(e,t,n=0){for(;e<n;)e+=t;let r=n+t;for(;e>=r;)e-=t;return e}function P(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function F(e,t){return N(P(e,t),2*Math.PI)*(180/Math.PI)}function I(e,t){return N(Math.PI/2-P(e,t),2*Math.PI)*(180/Math.PI)}function L(e,t,n){let r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Math.atan2(te(r,i),ee(r,i))}function R(e,t,n){return x(N(L(e,t,n),2*Math.PI))}function z(e,t,n){return x(N(-1*L(e,t,n),2*Math.PI))}function B(e,t,n){return Math.max(t,Math.min(n,e))}function V(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function H(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function U(e,t,n){let r=[n[0]-t[0],n[1]-t[1],n[2]-t[2]],i=B(V(r,[e[0]-t[0],e[1]-t[1],e[2]-t[2]])/H(r),0,1);return[t[0]+(n[0]-t[0])*i,t[1]+(n[1]-t[1])*i,t[2]+(n[2]-t[2])*i]}function W(e,t,n){let r=0,i=n[0]-t[0],a=n[1]-t[1],o=i*i+a*a;return o===0?r=.5:(r=((e[0]-t[0])*i+(e[1]-t[1])*a)/o,r<0?r=0:r>1&&(r=1)),r<=.5?[t[0]+(n[0]-t[0])*r,t[1]+(n[1]-t[1])*r]:[n[0]-(n[0]-t[0])*(1-r),n[1]-(n[1]-t[1])*(1-r)]}k[9002]=.3048,k[9003]=.3048006096012192,k[9095]=.3048007491;function G(e,t,n=1){if(c(t))return b(e,t,n);if(u(t)){let n=o(e,t);return n.isInvalid?Math.sqrt(v(e,t.c[0])):h(n)}if(a(t)){let n=r(e,t);return n.isInvalid?Math.sqrt(v(e,t.a[0])):h(n)}return S(e,t,n)}var K=1e-6;function q(e,t,n,r){let i=_(e,t,n).filter(({distance:e})=>e<=r),a=[],o=0,s=t;for(let{t}of i){let n=(t-o)/(1-o);if(n<K||1-n<K)continue;let[r,i]=m(e,s,t);a.push(r),s=i,o=t}return a.push(s),a}function J(e,t,n,r){let i=o(e,t);if(i.isInvalid)return[f(t)];let{t:a,distance:c}=y(i,n);return c<=r?s(i,t,a):[f(t)]}function Y(e,t,n,i){let a=r(e,t);if(a.isInvalid)return[f(t)];let{t:o,distance:s}=y(a,n);return s<=i?C(a,t,o):[f(t)]}function ne(e,t,n,r){let i=w(e,t);if(i.isInvalid)return[f(t)];let{t:a,distance:o}=p(i,n);return o<=r?d(i,t,a):[f(t)]}function re(e,t,n,r){return g(t)?[f(t)]:c(t)?q(e,t,n,r):u(t)?J(e,t,n,r):a(t)?Y(e,t,n,r):ne(e,t,n,r)}function ie(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function ae(e){let t=ie(e);return[e[0]/t,e[1]/t,e[2]/t]}function X(e,t,n,r){let i=ae([t[0]-e[0],t[1]-e[1],t[2]*r-e[2]*r]);return[e[0]+i[0]*n,e[1]+i[1]*n,e[2]+i[2]*n]}function Z(e,t,n,r){return e+(t-e)/n*r}function Q(e,t,n){let r=t[0]-e[0],i=t[1]-e[1],a=Math.sqrt(r*r+i*i);return r/=a,i/=a,r*=n,i*=n,[e[0]+r,e[1]+i]}function oe(e,n){if(!e)return null;switch(e.type){case`extent`:case`multipoint`:case`mesh`:case`point`:return null}let r=e.type===`polygon`?e.rings:e.paths,a=1;if((e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(a=A(e.spatialReference)/t(e.spatialReference)),r.length===0||r[0].length===0||!1===e.hasM)return null;let o=-1,s=0,{hasM:c,hasZ:l}=e,u=l?3:2;for(let t of r){if(o++,t.length>0&&t[0][u]===n)return{partId:o,distanceAlong:s,coordinate:new i({hasZ:l,hasM:c,spatialReference:e.spatialReference,x:t[0][0],y:t[0][1],...l?{z:t[0][2]}:{},...c?{m:t[0][u]}:{}}),segmentId:0};let r=-1;for(let d=1;d<t.length;d++){let f=$(t[d-1],t[d],l,a);r++;let p=t[d][u]-t[d-1][u],m=t[d][u];if(m===n)return{partId:o,distanceAlong:f+s,coordinate:new i({hasZ:l,hasM:c,spatialReference:e.spatialReference,x:t[d][0],y:t[d][1],...l?{z:t[d][2]}:{},...c?{m:t[d][u]}:{}}),segmentId:r};if(m>n&&n>t[d-1][u]){let m=(n-t[d-1][u])/p*f,h=l?X(t[d-1],t[d],m,a):Q(t[d-1],t[d],m);h=[...h,n];let g=new i({hasZ:l,hasM:c,spatialReference:e.spatialReference,x:h[0],y:h[1],...l?{z:h[2]}:{},...c?{m:h[u]}:{}});return{partId:o,distanceAlong:s+$(t[d-1],[g.x,g.y,...l?[g.z]:[],...c?[g.m]:[]],l,a),coordinate:g,segmentId:r}}s+=f}}return null}function se(e,n){if(!e)return null;switch(e.type){case`extent`:case`multipoint`:case`mesh`:case`point`:return null}let r=e.type===`polygon`?e.rings:e.paths;if(n<0)return null;let a=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(a=A(e.spatialReference)/t(e.spatialReference));let o=0,{hasZ:s,hasM:c}=e,l=s?3:2,u=-1;if(n===0)return r.length===0||r[0].length===0?null:{partId:0,coordinate:new i({hasZ:s,hasM:c,spatialReference:e.spatialReference,x:r[0][0][0],y:r[0][0][1],...s?{z:r[0][0][2]}:{},...c?{m:r[0][0][l]}:{}}),segmentId:0};for(let t of r){u++;let r=-1;for(let d=1;d<t.length;d++){r++;let f=$(t[d-1],t[d],s,a),p=o+f;if(p===n)return{partId:u,coordinate:new i({hasZ:s,hasM:c,spatialReference:e.spatialReference,x:t[d][0],y:t[d][1],...s?{z:t[d][2]}:{},...c?{m:t[d][l]}:{}}),segmentId:r};if(p>n){let p=s?X(t[d-1],t[d],n-o,a):Q(t[d-1],t[d],n-o);return p=[...p,Z(t[d-1][l],t[d][l],f,n-o)],{partId:u,coordinate:new i({hasZ:s,hasM:c,spatialReference:e.spatialReference,x:p[0],y:p[1],...s?{z:p[2]}:{},...c?{m:p[l]}:{}}),segmentId:r}}o=p}}return null}function ce(e,n){if(!e||!n)return null;let r=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(r=A(n.spatialReference)/t(n.spatialReference));let i=null,a=0;return i=e,a=e.hasZ&&n.hasZ?E([n.x,n.y,n.z],[e.x,e.y,e.z],r):j([n.x,n.y],[e.x,e.y],!1),{coordinate:i,distance:a}}function le(e,n){if(!e||!n)return null;let r=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(r=A(n.spatialReference)/t(n.spatialReference));let i=null,a=0,o=Number.MAX_VALUE,s=-1,c=-1;for(let t of e.points||[]){c++;let i=e.hasZ&&n.hasZ?D([t[0],t[1],t[2]],[n.x,n.y,n.z],r):M([t[0],t[1]],[n.x,n.y],!1);i<o&&(o=i,s=c)}return s<0?null:(a=o,i=e.getPoint(s),{coordinate:i,distance:Math.sqrt(a)})}function ue(e,n){if(!e||!n)return null;let r=e.type===`polygon`?e.curveRings??e.rings:e.curvePaths??e.paths,a=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(a=A(n.spatialReference)/t(n.spatialReference));let o=Number.MAX_VALUE,s=-1,c=-1,u=-1,d=e.hasZ&&n.hasZ,f=null,p=d?[n.x,n.y,n.z]:[n.x,n.y];for(let e of r){c++;for(let t=1;t<e.length;t++){let n=de(p,e[t-1],e[t],d,a);n.distance<o&&(o=n.distance,f=n.closestPoint,u=c,s=t-1)}}if(s<0||!f)return null;let m=e.hasM&&e.hasZ?3:2,h=r[u][s],_=l(h),v=r[u][s+1],y=l(v),b=null,x=null,S=d?f[2]:null,C=g(v)?f:re(_,v,f,.001)[0],w=$(_,C,d,a),T=$(_,v,d,a);e.hasM&&(x=Z(_[m],y[m],T,w)),!e.hasZ||!1!==n.hasZ&&g(C)||(S=Z(_[2],y[2],T,w),l(C)[2]=S,w=$(_,C,!0,a)),b=new i({hasZ:d,hasM:e.hasM,spatialReference:n.spatialReference,x:f[0],y:f[1],...e.hasZ?{z:S}:{},...e.hasM?{m:x}:{}});let E=0;for(let t=0;t<=u;t++){let n=r[t],i=t===u?s:n.length-1;for(let t=1;t<=i;t++)E+=$(l(n[t-1]),n[t],e.hasZ,a)}return E+=w,{partId:u,segmentId:s,coordinate:b,distance:o,distanceAlong:E}}function de(t,n,r,i,a){let o=l(n);if(g(r)){let e=i?U(t,o,r):W(t,o,r);return{closestPoint:e,distance:i?E(e,t,a):j(e,t,!1)}}let s=T(o,r,t);if(!s)throw new e(`arcade:closestPointOnSegment`,`The given point is not on the curve`);return{closestPoint:s.curvePoint,distance:s.distance}}function $(e,t,n,r){return g(t)?n?E(e,t,r):j(e,t,!1):G(e,t,.001)}function fe(e,t){if(!e||!t)return null;if(e.type===`extent`){let t=e;e=new n({spatialReference:e.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})}switch(e.type){case`point`:return ce(e,t)??null;case`multipoint`:return le(e,t)??null;case`polygon`:case`polyline`:return ue(e,t)??null;default:return null}}export{z as a,A as c,R as i,F as l,fe as n,I as o,se as r,E as s,oe as t};