import{sD as e}from"./index-BN8X5Ryz.js";import{cn as t,ln as n,vn as r}from"./Point2D-DJueHbCy.js";import{Cn as i,Dn as a,Un as o,dt as s,gn as c,ht as l,p as u,rt as d,s as f,tt as p,un as m,yn as h}from"./SpatialReference-CfUjvF_j.js";import{n as g}from"./SimpleGeometryCursor-BILtMaQf.js";import{l as _,n as v,p as y,r as b,t as x}from"./apiConverter-Dsm0pxcs.js";var S=l;function C(e,t){return{m_geometry:e,m_side:t}}function w(e,t,n,r,a,o){if(t.isEmpty()){let e=C(t,0);a.push(e);return}if(n.isEmpty()){let e=C(t,0);a.push(e);return}let c=[],l=new i;{let i=l.createGeometryUserIndex(),m=l.addGeometry(t),h=l.addGeometry(n),g=new u(o),_=0,v=null;if(l.hasCurves()){v=new S;let e=l.getEnvelope2D(o);_=s(r.total());let t=p(r.total(),e);d(l,t,r.total(),12e3,v,null,o)}l.dbgVerifyCurves(),g.setEditShapeCrackAndCluster(l,r),g.cut(e,i,m,h,c);for(let e of c){v!==null&&v.stitchCurves(l,e,_,!1);let t=C(l.getGeometry(e),f(l.getGeometryUserIndex(e,i)));a.push(t)}v!==null&&v.clearStitcher(l)}}function T(e,t,n,r,a,o){if(t.isEmpty()){let e=C(t,0);a.push(e);return}if(n.isEmpty()){let e=C(t,0);a.push(e);return}let c=[],l=new i;{let e=l.createGeometryUserIndex(),f=l.addGeometry(t),m=l.addGeometry(n),g=new u(o),_=0,v=null;if(l.hasCurves()){v=new S;let e=l.getEnvelope2D(o);_=s(r.total());let t=p(r.total(),e);d(l,t,r.total(),12e3,v,null,o)}l.dbgVerifyCurves(),g.setEditShapeCrackAndCluster(l,r),g.cut(!1,e,f,m,c),v!==null&&v.stitchCurves(l,-1,_,!0);let y=l.getGeometry(f),b=new h,x=new h,w=[];for(let t=0;t<c.length;t++){let n=null;{let a=new i,u=a.addGeometry(y),f=a.addGeometry(l.getGeometry(c[t]));if(a.hasCurves()){let e=a.getEnvelope2D(o);_=s(r.total());let t=p(r.total(),e);d(a,t,r.total(),12e3,v,null,o)}g.setEditShapeCrackAndCluster(a,r);let m=g.intersection(u,f);if(v!==null&&v.stitchCurves(a,-1,_,!0),n=a.getGeometry(m),n.isEmpty())continue;let h=l.getGeometryUserIndex(c[t],e);h===2?b.add(n,!1):h===1?x.add(n,!1):w.push(n)}{let e=new i,n=e.addGeometry(y),a=e.addGeometry(l.getGeometry(c[t]));if(e.hasCurves()){let t=e.getEnvelope2D(o);_=s(r.total());let n=p(r.total(),t);d(e,n,r.total(),12e3,v,null,o)}g.setEditShapeCrackAndCluster(e,r);let u=g.difference(n,a);v!==null&&v.stitchCurves(e,-1,_,!0),y=e.getGeometry(u)}}if(!y.isEmpty()&&c.length>0&&w.push(y),b.isEmpty()&&x.isEmpty())return;if(!b.isEmpty()){let e=C(b,1);a.push(e)}if(!x.isEmpty()){let e=C(x,2);a.push(e)}for(let e=0,t=w.length;e<t;++e){let t=C(w[e],3);a.push(t)}}}var E=class{getOperatorType(){return 10005}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,r,i){return new D(e,t,n,r,i)}},D=class extends g{constructor(e,t,n,r,i){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=i,this.m_cuttee=t.clone(),this.m_cutter=new m({copy:n}),this.m_bConsiderTouch=e;let s=a(t,n);this.m_tolerance=o(r,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case t.enumPolyline:this.generatePolylineCuts();break;case t.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){let e=new m,t=new m,r=new m;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(t);let i=[];w(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,i,this.m_progressTracker);for(let a=0;a<i.length;a++){let o=i[a];o.m_side===1?e.add(o.m_geometry,!1):o.m_side===2||o.m_side===4?t.add(o.m_geometry,!1):o.m_side===3?this.m_cuts.push(o.m_geometry):o.m_side===0?r.add(o.m_geometry,!1):n(``)}r.isEmpty()||e.isEmpty()&&t.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(r),e.isEmpty()&&t.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){let e=new h,t=new h,i=new h;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(t);let a=[];T(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,a,this.m_progressTracker);for(let r=0;r<a.length;r++){let o=a[r];o.m_side===1?e.add(o.m_geometry,!1):o.m_side===2?t.add(o.m_geometry,!1):o.m_side===3?this.m_cuts.push(o.m_geometry):o.m_side===0?i.add(o.m_geometry,!1):n(``)}r(i.isEmpty()||a.length===1),e.isEmpty()&&t.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}},O=new E;function k(e,t,n){let r=O.execute(!0,e,t,n,null);return Array.from(r)}function A(){return O.supportsCurves()}function j(t,n){let r=x(t);return k(b(t),_(n),y(r)).map(e=>v(e,r)).filter(e)}var M=A(),N=Object.freeze(Object.defineProperty({__proto__:null,execute:j,supportsCurves:M},Symbol.toStringTag,{value:`Module`}));export{N as n,j as r,M as t};