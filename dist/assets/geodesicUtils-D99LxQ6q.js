import{$T as e,Bv as t,Kx as n,LS as r,Lx as i,SS as a,c_ as o,l_ as s,mE as c,u_ as l,zv as u}from"./index-BN8X5Ryz.js";function d(e){if(!e)return null;let t=e.wkid;if(t)return o[t];let n=e.wkt2??e.wkt;return n?f(n):null}function f(e){let t=l.exec(e);if(!t||t.length!==2)return null;let n=t[1].split(`,`);if(!n||n.length<3)return null;let r=parseFloat(n[1]),i=parseFloat(n[2]);return isNaN(r)||isNaN(i)?null:{a:r,f:i===0?0:1/i}}function p(e){let t=d(e);if(m(t))return t;let n=t.a*(1-t.f);return Object.assign(t,{b:n,eSq:1-(n/t.a)**2,radius:(2*t.a+n)/3,densificationRatio:1e4/((2*t.a+n)/3)})}function m(e){return e!=null&&`b`in e&&`eSq`in e&&`radius`in e}function h(e,t,n){let{a:r,eSq:i}=p(n),a=Math.sqrt(i),o=Math.sin(t[1]*s),c=r*t[0]*s,l;return l=i>0?r*((1-i)*(o/(1-i*(o*o))-1/(2*a)*Math.log((1-a*o)/(1+a*o))))*.5:r*o,e[0]=c,e[1]=l,e}function g(e){return a(e)&&!!d(e)}function _(t,r=`square-meters`){if(t.some(e=>!g(e.spatialReference)))throw new e(`geodesic-areas:invalid-spatial-reference`,`the input geometries spatial reference is not supported`);let i=[];for(let e=0;e<t.length;e++){let n=t[e],r=n.spatialReference,{radius:a,densificationRatio:o}=p(r),s=a*o;i.push(y(n,s))}let a=[],o=[0,0],s=[0,0];for(let e=0;e<i.length;e++){let{rings:t,spatialReference:c}=i[e],l=0;for(let e=0;e<t.length;e++){let n=t[e];h(o,n[0],c),h(s,n[n.length-1],c);let r=s[0]*o[1]-o[0]*s[1];for(let e=0;e<n.length-1;e++)h(o,n[e+1],c),h(s,n[e],c),r+=s[0]*o[1]-o[0]*s[1];l+=r}l=n(l,`square-meters`,r),a.push(l/-2)}return a}function v(t,r=`meters`){if(!t)throw new e(`geodesic-lengths:invalid-geometries`,`the input geometries type is not supported`);if(t.some(e=>!g(e.spatialReference)))throw new e(`geodesic-lengths:invalid-spatial-reference`,`the input geometries spatial reference is not supported`);let i=[];for(let e=0;e<t.length;e++){let a=t[e],{spatialReference:o}=a,s=a.type===`polyline`?a.paths:a.rings,c=0;for(let e=0;e<s.length;e++){let t=s[e],n=0;for(let e=1;e<t.length;e++){let r=t[e-1][0],i=t[e][0],a=t[e-1][1],s=t[e][1];if(a!==s||r!==i){let e=new b;S(e,[r,a],[i,s],o),n+=e.distance}}c+=n}c=n(c,`meters`,r),i.push(c)}return i}function y(n,r){if(n.type!==`polyline`&&n.type!==`polygon`)throw new e(`geodesic-densify:invalid-geometry`,`the input geometry is neither polyline nor polygon`);let{spatialReference:a}=n;if(!g(a))throw new e(`geodesic-densify:invalid-spatial-reference`,`the input geometry spatial reference is not supported`);let o=n.type===`polyline`?n.paths:n.rings,s=[],l=[0,0],d=new b;for(let e of o){let t=[];s.push(t),t.push([e[0][0],e[0][1]]);let n,i,o=e[0][0],c=e[0][1];for(let s=0;s<e.length-1;s++){if(n=e[s+1][0],i=e[s+1][1],o===n&&c===i)continue;let u=[o,c];S(d,[o,c],[n,i],a);let{azimuth:f,distance:p}=d,m=p/r;if(m>1){for(let e=1;e<=m-1;e++)x(l,u,f,e*r,a),t.push(l.slice());x(l,u,f,(p+Math.floor(m-1)*r)/2,a),t.push(l.slice())}x(l,u,f,p,a),t.push(l.slice()),o=l[0],c=l[1]}}let f=c(i,a);return n.type===`polyline`?new u({paths:s,spatialReference:f}):new t({rings:s,spatialReference:f})}var b=class{constructor(e=0,t,n){this.distance=e,this.azimuth=t,this.reverseAzimuth=n}};function x(e,t,n,r,i){let a=t[0],o=t[1],c=a*s,l=o*s,u=(n??0)*s,{a:d,b:f,f:m}=p(i),h=Math.sin(u),g=Math.cos(u),_=(1-m)*Math.tan(l),v=1/Math.sqrt(1+_*_),y=_*v,b=Math.atan2(_,g),x=v*h,S=x*x,C=1-S,w=C*(d*d-f*f)/(f*f),T=1+w/16384*(4096+w*(w*(320-175*w)-768)),E=w/1024*(256+w*(w*(74-47*w)-128)),D,O,k,A=r/(f*T),j=2*Math.PI;for(;Math.abs(A-j)>1e-12;)k=Math.cos(2*b+A),D=Math.sin(A),O=Math.cos(A),j=A,A=r/(f*T)+E*D*(k+E/4*(O*(2*k*k-1)-E/6*k*(4*D*D-3)*(4*k*k-3)));let M=y*D-v*O*g,N=Math.atan2(y*O+v*D*g,(1-m)*Math.sqrt(S+M*M)),P=m/16*C*(4+m*(4-3*C)),F=Math.atan2(D*h,v*O-y*D*g)-(1-P)*m*x*(A+P*D*(k+P*O*(2*k*k-1)));return e[0]=(c+F)/s,e[1]=N/s,e}function S(e,t,n,r){let i=t[0]*s,a=t[1]*s,o=n[0]*s,c=n[1]*s,{a:l,b:u,f:d,radius:f}=p(r),m=o-i,h=Math.atan((1-d)*Math.tan(a)),g=Math.atan((1-d)*Math.tan(c)),_=Math.sin(h),v=Math.cos(h),y=Math.sin(g),b=Math.cos(g),x,S,C,w,T,E,D,O,k,A,j=1e3,M=m;do{if(D=Math.sin(M),O=Math.cos(M),C=Math.sqrt(b*D*(b*D)+(v*y-_*b*O)*(v*y-_*b*O)),C===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;T=_*y+v*b*O,E=Math.atan2(C,T),k=v*b*D/C,S=1-k*k,w=T-2*_*y/S,isNaN(w)&&(w=0),A=d/16*S*(4+d*(4-3*S)),x=M,M=m+(1-A)*d*k*(E+A*C*(w+A*T*(2*w*w-1)))}while(Math.abs(M-x)>1e-12&&--j>0);if(j===0){let t=f,n=Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(o-i))*t,r=o-i,l=Math.sin(r)*Math.cos(c),u=Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(r);return e.azimuth=Math.atan2(l,u)/s,e.distance=n,e.reverseAzimuth=void 0,e}let N=S*(l*l-u*u)/(u*u),P=N/1024*(256+N*(N*(74-47*N)-128)),F=u*(1+N/16384*(4096+N*(N*(320-175*N)-768)))*(E-P*C*(w+P/4*(T*(2*w*w-1)-P/6*w*(4*C*C-3)*(4*w*w-3)))),I=Math.atan2(b*Math.sin(M),v*y-_*b*Math.cos(M)),L=Math.atan2(v*Math.sin(M),v*y*Math.cos(M)-_*b);return e.azimuth=I/s,e.distance=F,e.reverseAzimuth=L/s,e}function C(e){return g(e)?e:r(e)?i.WGS84:null}export{S as a,y as c,x as i,_ as n,v as o,b as r,g as s,C as t};