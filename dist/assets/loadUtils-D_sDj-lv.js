import{Xb as e,dx as t,rx as n,sw as r}from"./index-BN8X5Ryz.js";import{r as i}from"./dataUtils-CwkEyGtp.js";function a(e,t,n){let{extent:r,valid:i}=e,[a,o,s,c]=r;return!(n<o||n>c)&&(i!=null&&a>s?t>=s||t<=a:t>=a&&t<=s)}function o(e,t,i,a){let{extent:o,modelSize:c,valid:l}=e,[u,d,f]=o,p=s(u,f,l),m=t/c[0]*p+u;return l!=null&&a&&(m=new r(l[0],l[1]).normalize(m)),[m,(c[1]-i)/c[1]*n(o)+d]}function s(e,t,n){if(n!=null&&e>t){let[r,i]=n;return i-e+(t-r)}return t-e}function c(e){return e?4:3}function l(r,s,c){let[l,u]=c.modelSize,d=null,f=new Map;s.forEach(e=>{f.set(e.lij,i(r,e))});let p=(t,n,r)=>e(t.extent,n,r);return(e,i)=>{let m=Math.round(e),h=Math.round(i);if(!r.wrapAround&&(m<0||m>=l||h<0||h>=u))return[0,0];let[g,_]=o(c,e,i,!0);if(!a(c,g,_))return[0,0];if(d==null||!p(d,g,_)){d=null;for(let[e,t]of s)if(p(t,g,_)){d=t;break}}if(d?.data==null)return[0,0];let v=f.get(d.lij);if(v==null)return[0,0];let{width:y,height:b,extent:x}=d;return v((g-x[0])/t(x)*y,b-(_-x[1])/n(x)*b)}}export{c as n,l as t};