import{H as e,M as t,V as n,W as r,b as i,k as a,r as o}from"./BufferView-DuUrcLgU.js";import{t as s}from"./types-DsLx34Br.js";var c=class{constructor(e,t,n){this.elementCount=e,this.elementType=t,this.bufferViewConstructor=n,this.byteSize=l(n)}};function l(e){return s(e.ElementType)*e.ElementCount}var u={u8:new c(1,`uint`,i),vec4u8:new c(4,`uint`,e),unorm8:new c(1,`float`,t),vec4unorm8:new c(4,`float`,a),f16:new c(1,`float`,r?n:o),f32:new c(1,`float`,o)},d=class{constructor(e,t,n,r){this._declaration=e,this._byteOffset=t,this._creationInfo=r,this._startTexel=Math.floor(t/n);let i=r.byteSize;this._numTexels=Math.ceil((t+i)/n)-this._startTexel;let a=this._startTexel,o=t%n,s=[],c=[`x`,`y`,`z`,`w`];for(let e=0;e<i;++e){let e=`texel${a}.${c[o]}`;s.push(e),++o,o>=n&&(o=0,++a)}this._glslDecodeArgumentString=s.join(`, `)}get name(){return this._declaration.name}get fieldType(){return this._declaration.type}get byteOffset(){return this._byteOffset}get startTexel(){return this._startTexel}get numTexels(){return this._numTexels}get elementType(){return this._creationInfo.elementType}get elementCount(){return this._creationInfo.elementCount}get glslDecodeArgumentString(){return this._glslDecodeArgumentString}get bufferViewConstructor(){return this._creationInfo.bufferViewConstructor}},f=class{constructor(e,t,n,r=0){this.layout=e,this.byteOffset=r,this._bufferViews=new Map,this.buffer=typeof t==`number`?new ArrayBuffer(t*e.byteStride):t,this.texelElementBuffer=new n(this.buffer,r);let i=this._bufferViews;for(let[e,t]of this.layout.fields)i.set(e,new t.bufferViewConstructor(this.buffer,r+t.byteOffset,this.layout.byteStride))}get stride(){return this.layout.byteStride}get count(){return this.byteLength/this.stride}get byteLength(){return this.buffer.byteLength-this.byteOffset}getField(e,t){let n=this._bufferViews.get(e);return n!=null&&n.elementCount===t.ElementCount&&n.elementType===t.ElementType?n:null}get usedMemory(){return this.byteLength}},p=class{constructor(e){this._fields=new Map,this.texelByteStride=4,this.texelElementArrayConstructor=Uint8Array;let t=0,n=[];for(let r=0;r<e.length;++r){let i=e[r],{type:a}=i,o=u[a];n.push({declaration:i,byteOffset:t,creationInfo:o}),t+=o.byteSize}t=m(t);let r=t,i=this._fields,{texelByteStride:a}=this;for(let{declaration:e,byteOffset:t,creationInfo:r}of n)i.set(e.name,new d(e,t,a,r));this.byteStride=r,this.texelStride=Math.ceil(r/a)}get stride(){return this.byteStride}get fields(){return this._fields}createBuffer(e){return new f(this,e,this.texelElementArrayConstructor)}createView(e,t){return new f(this,e,this.texelElementArrayConstructor,t)}};function m(e){return e+3&-4}export{p as t};