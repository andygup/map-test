const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingTools-BmjIjJ1L.js","assets/index-CZ4oMP1N.js","assets/index-CDgdHpAj.css","assets/editPlaneUtils-BV-yWTYi.js","assets/boundedPlane-C8nQBQLB.js","assets/ObjectStack-CBI5g-Qc.js","assets/vectorStacks-FfDNcZoS.js","assets/quatf64-BJJPhW0N.js","assets/lineSegment-BJ2rgalW.js","assets/plane-Bg1a5O73.js","assets/ray-CWXoVP-g.js","assets/ReactiveSet-Jf4MiUGe.js","assets/memoize-BNsZjv91.js","assets/quantity-CPor8qMe.js","assets/createUtils-BdtfcpTy.js","assets/distanceOperator-CYf0gmY_.js","assets/Distance2DCalculator-CXhBP-8I-CqzpU8vR.js","assets/SpatialReference-HLIf1Z5k.js","assets/Envelope2D-Cwxt0azx.js","assets/Point2D-7VmvyXN4.js","assets/OperatorDefinitions-CscAnk1m.js","assets/SimpleGeometryCursor-5wFw2ZZo.js","assets/Transformation2D-CPSmiNnd.js","assets/apiConverter-BH2GqpH4.js","assets/jsonConverter-CbeIyOFG.js","assets/OptimizedGeometry-hOUTi-cB.js","assets/memoryEstimations-DQOvnrRz.js","assets/simplifyOperator-CdQI_hSF.js","assets/operatorSimplify-CKtdefMF.js","assets/quat-BszBv_-H.js","assets/geodesicUtils-CbiJFASl.js","assets/rotate-CRgbbiZK.js","assets/quantityFormatUtils-DJ98D30D.js","assets/unitFormatUtils-3ZxnJ6-6.js","assets/MeshTransform-mXzx59gA.js","assets/axisAngleDegrees-B_kvpSNV.js","assets/meshVertexSpaceUtils-CsTvVRUI.js","assets/MeshLocalVertexSpace-OEvelzSD.js","assets/getDefaultUnitForView-BwZf47ZU.js","assets/angularMeasurementUtils-DzYsrBw4.js","assets/projectVectorToVector-DX3Yd1qf.js","assets/projectPointToVector-HYpbaZqA.js","assets/dehydratedPoint-rdg1UAtQ.js","assets/GraphicsLayer-Bx8Nz7ax.js","assets/dehydratedFeatureComparison-Uk3aLNrk.js","assets/hydratedFeatures-B670wkRA.js","assets/drapedUtils-BIPbWxSw.js","assets/elevationInfoUtils-9csVBlEH.js","assets/SnappingContext-BtkpPzK4.js","assets/curveOperationUtils-Be_6553J.js","assets/LineSnappingHint-BOeMI0cS.js","assets/ParallelSnappingHint-C_mSlwpq.js","assets/IntersectionSnappingHint-CdcMZxUs.js","assets/PointSnappingHint-DvioR9Jz.js","assets/RightAngleSnappingHint-BXbBqf-p.js","assets/euclideanLengthMeasurementUtils-C9WB-wbk.js","assets/spatialReferenceEllipsoidUtils-B0E4spY0.js","assets/SketchOptions-Dp8M5XoK.js","assets/constraints-Bf0IRs4G.js","assets/sphere-9YfqUkuX.js","assets/vec3-zq4-AU_O.js","assets/snappingUtils-Od8uWW_a.js","assets/colorUtils-DJOs5VE1.js","assets/cimSymbolUtils-Q6FkyqJB.js","assets/SnappingVisualizer2D-CvimaA4v.js","assets/drawUtils-JVK9yFCX.js","assets/hitTestSelectUtils-DQf3EOGe.js"])))=>i.map(i=>d[i]);
import{BS as e,DT as t,GT as n,Gh as r,Hw as i,OT as a,UT as o,WT as s,_w as c,ev as l,gD as u,pg as d}from"./index-CZ4oMP1N.js";var f={redo:`r`,undo:`z`},p=Symbol(),m=Symbol(),h=Symbol(),g=class extends c{constructor(e){super(e),this._tool=null,this._updatingHandles=new d,this.enabled=!1,this._onPointerMove=i(async e=>{let t=await this._updatingHandles.addPromise(this._findElementAtScreenPoint(e));this.destroyed||(this.removeHandles(m),t&&t!==this.selectedElement&&this.addHandles(this.view.acquireCursor(`pointer`,`high`),m))})}initialize(){this.addHandles(o(this._updatingHandles)),this._updatingHandles.add(()=>this.enabled,e=>this._setEnabled(e),l),this._updatingHandles.add(()=>this._preferredInteractionTool,()=>this._preferredInteractionToolChanged())}get _validatedSelectedElement(){let e=this.selectedElement;if(!e)return null;let{layer:{source:t}}=this;return t?`hasElement`in t?t.hasElement(e)?e:null:t===e?e:null:null}get _preferredInteractionTool(){return this.options?.tool??`transform`}get updating(){return this._updatingHandles.updating}_setEnabled(e){if(this.removeHandles(p),!e)return;let{view:t}=this;this.addHandles([t.on(`immediate-click`,e=>this._onClick(e),r.TOOL),t.on(`pointer-move`,e=>this._onPointerMove(e).catch(()=>{}),r.TOOL),t.on(`key-down`,e=>{e.key===f.undo&&this._tool?.canUndo()&&(this._tool.undo(),e.stopPropagation()),e.key===f.redo&&this._tool?.canRedo()&&(this._tool.redo(),e.stopPropagation())}),this._updatingHandles.add(()=>this._validatedSelectedElement,e=>this._selectedElementChanged(e),l),s(()=>{this.removeHandles(m),this._removeTool()})],p)}async _findElementAtScreenPoint(e){let t=(await this.view.hitTest(e,{include:[this.layer]})).results[0];return t?.type===`media`?t.element:null}async _onClick(e){await this._updatingHandles.addPromise(e.defer(async()=>{let t=await this._findElementAtScreenPoint(e);this.destroyed||(t&&e.stopPropagation(),this.selectedElement=t,this.selectedElement&&this.removeHandles(m))}))}_preferredInteractionToolChanged(){let{_tool:e}=this;e&&(this._preferredInteractionTool===e.type||this._updatingHandles.addPromise(this._recreateTool()))}async _recreateTool(){this.removeHandles(h),this._removeTool();let t=this._validatedSelectedElement;if(!t)return;let r=new AbortController;this.addHandles(n(r),h);let{TransformTool:i,ControlPointsTransformTool:a}=await e(async()=>{let{TransformTool:e,ControlPointsTransformTool:t}=await import(`./editingTools-BmjIjJ1L.js`);return{TransformTool:e,ControlPointsTransformTool:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66]));if(r.signal.aborted)return;let{view:o}=this;switch(this._preferredInteractionTool){case`transform`:this._tool=new i({target:t,view:o});break;case`reshape`:this._tool=new a({mediaElement:t,view:o})}this.addHandles(s(()=>{this._tool&&=(o.tools.remove(this._tool),null)}),this._tool),o.addAndActivateTool(this._tool)}_removeTool(){this._tool&&this.removeHandles(this._tool)}async _selectedElementChanged(e){e?.georeference?await this._updatingHandles.addPromise(this._recreateTool()):this._removeTool()}};u([t()],g.prototype,`_validatedSelectedElement`,null),u([t()],g.prototype,`_preferredInteractionTool`,null),u([t({constructOnly:!0})],g.prototype,`view`,void 0),u([t({constructOnly:!0})],g.prototype,`layer`,void 0),u([t()],g.prototype,`selectedElement`,void 0),u([t()],g.prototype,`enabled`,void 0),u([t()],g.prototype,`options`,void 0),u([t()],g.prototype,`updating`,null),g=u([a(`esri.views.2d.layers.support.MediaLayerInteraction`)],g);export{g as MediaLayerInteraction};