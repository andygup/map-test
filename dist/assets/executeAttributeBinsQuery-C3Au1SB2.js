import{AS as e,FC as t,Rv as n,TS as r,Tu as i,ZS as a,kC as o,xu as s}from"./index-BN8X5Ryz.js";import{t as c}from"./urlUtils-CW4cnJ3W.js";import"./queryUtils-DGU5ISbw.js";import"./FixedIntervalBinParameters-CMgMaWGN.js";import{t as l}from"./AttributeBinsFeatureSet-B5vZtDTA.js";import{t as u}from"./AttributeBinsQuery-sRteDZ8D.js";function d(t){let i=t.geometry,a=t.toJSON(),o=a,s,c,l;if(i!=null&&(c=i.spatialReference,l=r(c),o.geometryType=n(i),o.geometry=JSON.stringify(i),o.inSR=l),a.outSR?(o.outSR=r(a.outSR),s=t.outSpatialReference):i&&(o.outSR=o.inSR,s=c),o.bin&&=JSON.stringify(o.bin),o.quantizationParameters&&=JSON.stringify(o.quantizationParameters),o.outStatistics&&=JSON.stringify(o.outStatistics),o.outTimeReference&&=JSON.stringify(o.outTimeReference),a.timeExtent){let e=a.timeExtent,{start:t,end:n}=e;t==null&&n==null||(o.time=t===n?t:`${t??`null`},${n??`null`}`),delete a.timeExtent}return t.defaultSpatialReference&&e(c,s)&&(o.defaultSR=o.inSR,delete o.inSR,delete o.outSR),o}async function f(e,t,n){return t.timeExtent!=null&&t.timeExtent.isEmpty?{data:{features:[]}}:await p(e,t,n)}async function p(e,n,r={}){let i=typeof e==`string`?o(e):e,l=n.geometry?[n.geometry]:[],u=await s(l,null,{signal:r.signal}),f=u?.[0];f!=null&&((n=n.clone()).geometry=f);let p=c({...i.query,f:`json`,...d(n)});return a(t(i.path,`queryBins`),{...r,query:{...p,...r.query}})}async function m(e,t,n){let{data:r}=await f(i(e),u.from(t),n);return l.fromJSON(r)}export{m as executeAttributeBinsQuery};