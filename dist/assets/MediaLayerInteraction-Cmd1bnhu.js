const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingTools-B0SRcERS.js","assets/index-ByaFsVj4.js","assets/index-DiFef-Um.css","assets/editPlaneUtils-C7OPxvLG.js","assets/boundedPlane-C7yz49Rx.js","assets/ObjectStack-C2IlraSC.js","assets/vectorStacks-DhZu7qGn.js","assets/quatf64-eO7UAs9K.js","assets/lineSegment-DXWFDhyj.js","assets/plane-Dmhe_zL4.js","assets/ray-CUcS4KDu.js","assets/ReactiveSet-u4MbrV3A.js","assets/elevationInfoUtils-CyQsBf6_.js","assets/quantity-b_p_m453.js","assets/createUtils-3b89FeCM.js","assets/distanceOperator-DlO1zQSq.js","assets/Distance2DCalculator-CXhBP-8I-CMWE8buR.js","assets/SpatialReference-Cd_hfGxp.js","assets/Envelope2D-n2TB2v9l.js","assets/Point2D-BslC4Gs9.js","assets/OperatorDefinitions-DoM9xd5U.js","assets/SimpleGeometryCursor-BbFgAuic.js","assets/Transformation2D-B6W9saMR.js","assets/apiConverter-BjBJsb1W.js","assets/jsonConverter-BFhN50xl.js","assets/OptimizedGeometry-DX91by73.js","assets/memoryEstimations-C5pKF3kD.js","assets/simplifyOperator-D2b5Xyc6.js","assets/operatorSimplify-C1bIOAQc.js","assets/quat-sUyQdiZR.js","assets/geodesicUtils-Dvm-3luO.js","assets/rotate-BnySm23F.js","assets/quantityFormatUtils-CHMoo4-a.js","assets/unitFormatUtils-CD_SX1-N.js","assets/MeshTransform-DDT-1d0m.js","assets/axisAngleDegrees-jawZYrHR.js","assets/meshVertexSpaceUtils-D9WJf86L.js","assets/MeshLocalVertexSpace-UBa2rGXG.js","assets/getDefaultUnitForView-D9ShoeZp.js","assets/angularMeasurementUtils-g0-pmZ8Q.js","assets/projectVectorToVector-BnpPb96u.js","assets/projectPointToVector-DjmX75N6.js","assets/dehydratedPoint-CVzHYxaL.js","assets/GraphicsLayer-DwoVChbR.js","assets/dehydratedFeatureComparison-S5E2zKzh.js","assets/hydratedFeatures-4dblZlCy.js","assets/SnappingContext-BSHa6eQl.js","assets/GraphicManipulator-Bcgu8Y5Q.js","assets/drapedUtils-EsGgYHzF.js","assets/LineSnappingHint-3ZzJwo5I.js","assets/ParallelSnappingHint-68YI0lzr.js","assets/IntersectionSnappingHint-DV5I0-bt.js","assets/PointSnappingHint-BJjMKkS5.js","assets/RightAngleSnappingHint-CU6G_WVm.js","assets/euclideanLengthMeasurementUtils-DIbCzEM_.js","assets/spatialReferenceEllipsoidUtils-nVny0a-O.js","assets/SketchOptions-QYfkQRrC.js","assets/constraints-CFQ1UrIW.js","assets/sphere-BCy4W-Wa.js","assets/vec3-DP8KhY5h.js","assets/snappingUtils-C_5v3bem.js","assets/colorUtils-BunzVBdd.js","assets/cimSymbolUtils-CFPGcy5T.js","assets/SnappingVisualizer2D-Yjvn5xkg.js","assets/drawUtils-D8SijXp2.js","assets/hitTestSelectUtils-B7XlogWA.js"])))=>i.map(i=>d[i]);
import{BS as e,DT as t,GT as n,Gh as r,Hw as i,OT as a,UT as o,WT as s,_w as c,ev as l,gD as u,pg as d}from"./index-ByaFsVj4.js";var f={redo:`r`,undo:`z`},p=Symbol(),m=Symbol(),h=Symbol(),g=class extends c{constructor(e){super(e),this._tool=null,this._updatingHandles=new d,this.enabled=!1,this._onPointerMove=i(async e=>{let t=await this._updatingHandles.addPromise(this._findElementAtScreenPoint(e));this.destroyed||(this.removeHandles(m),t&&t!==this.selectedElement&&this.addHandles(this.view.acquireCursor(`pointer`,`high`),m))})}initialize(){this.addHandles(o(this._updatingHandles)),this._updatingHandles.add(()=>this.enabled,e=>this._setEnabled(e),l),this._updatingHandles.add(()=>this._preferredInteractionTool,()=>this._preferredInteractionToolChanged())}get _validatedSelectedElement(){let e=this.selectedElement;if(!e)return null;let{layer:{source:t}}=this;return t?`hasElement`in t?t.hasElement(e)?e:null:t===e?e:null:null}get _preferredInteractionTool(){return this.options?.tool??`transform`}get updating(){return this._updatingHandles.updating}_setEnabled(e){if(this.removeHandles(p),!e)return;let{view:t}=this;this.addHandles([t.on(`immediate-click`,e=>this._onClick(e),r.TOOL),t.on(`pointer-move`,e=>this._onPointerMove(e).catch(()=>{}),r.TOOL),t.on(`key-down`,e=>{e.key===f.undo&&this._tool?.canUndo()&&(this._tool.undo(),e.stopPropagation()),e.key===f.redo&&this._tool?.canRedo()&&(this._tool.redo(),e.stopPropagation())}),this._updatingHandles.add(()=>this._validatedSelectedElement,e=>this._selectedElementChanged(e),l),s(()=>{this.removeHandles(m),this._removeTool()})],p)}async _findElementAtScreenPoint(e){let t=(await this.view.hitTest(e,{include:[this.layer]})).results[0];return t?.type===`media`?t.element:null}async _onClick(e){await this._updatingHandles.addPromise(e.defer(async()=>{let t=await this._findElementAtScreenPoint(e);this.destroyed||(t&&e.stopPropagation(),this.selectedElement=t,this.selectedElement&&this.removeHandles(m))}))}_preferredInteractionToolChanged(){let{_tool:e}=this;e&&(this._preferredInteractionTool===e.type||this._updatingHandles.addPromise(this._recreateTool()))}async _recreateTool(){this.removeHandles(h),this._removeTool();let t=this._validatedSelectedElement;if(!t)return;let r=new AbortController;this.addHandles(n(r),h);let{TransformTool:i,ControlPointsTransformTool:a}=await e(async()=>{let{TransformTool:e,ControlPointsTransformTool:t}=await import(`./editingTools-B0SRcERS.js`);return{TransformTool:e,ControlPointsTransformTool:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65]));if(r.signal.aborted)return;let{view:o}=this;switch(this._preferredInteractionTool){case`transform`:this._tool=new i({target:t,view:o});break;case`reshape`:this._tool=new a({mediaElement:t,view:o})}this.addHandles(s(()=>{this._tool&&=(o.tools.remove(this._tool),null)}),this._tool),o.addAndActivateTool(this._tool)}_removeTool(){this._tool&&this.removeHandles(this._tool)}async _selectedElementChanged(e){e?.georeference?await this._updatingHandles.addPromise(this._recreateTool()):this._removeTool()}};u([t()],g.prototype,`_validatedSelectedElement`,null),u([t()],g.prototype,`_preferredInteractionTool`,null),u([t({constructOnly:!0})],g.prototype,`view`,void 0),u([t({constructOnly:!0})],g.prototype,`layer`,void 0),u([t()],g.prototype,`selectedElement`,void 0),u([t()],g.prototype,`enabled`,void 0),u([t()],g.prototype,`options`,void 0),u([t()],g.prototype,`updating`,null),g=u([a(`esri.views.2d.layers.support.MediaLayerInteraction`)],g);export{g as MediaLayerInteraction};