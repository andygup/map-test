const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/loadGLTFMesh-BOKYHmYs.js","assets/index-BN8X5Ryz.js","assets/index-CWJhHB6-.css","assets/loader-DeUs1yRB.js","assets/quatf64-D37SEdPg.js","assets/quat-C8PgLo31.js","assets/BufferView-BW77W5ev.js","assets/Util-BQgFCZvD.js","assets/resourceUtils-BhD6CfOV.js","assets/indexUtils-BSuZn8vT.js","assets/Indices-tJiSUK6w.js","assets/vec3-B5yu4INg.js","assets/vec4-BLZ_ZPtE.js","assets/computeTranslationToOriginAndRotation-0WDVmpJG.js","assets/projectPointToVector-BkRdoTqD.js","assets/spatialReferenceEllipsoidUtils-qw9wv8RL.js","assets/MeshComponent-BFk18JiH.js","assets/MeshMaterialMetallicRoughness-Bdr2gXmV.js","assets/meshCloneUtils-BXMzy817.js","assets/meshProperties-CbjLwdbT.js","assets/MeshLocalVertexSpace-vomIk0sx.js","assets/MeshVertexAttributes-CBsb_nVo.js","assets/types-BEunqM4i.js","assets/vertexSpaceConversion-Dz87RqR7.js","assets/meshVertexSpaceUtils-s2jLb8qI.js","assets/gltfexport-CaxC2h3L.js"])))=>i.map(i=>d[i]);
import{$S as e,$T as t,$h as n,Af as r,Am as i,BT as a,Bv as o,CD as s,CE as c,Cf as l,DC as u,Df as d,Dm as f,Ex as p,Ix as m,Jf as h,MC as g,Nf as _,Nl as ee,Ow as te,RT as ne,Rl as v,Rm as re,Ry as ie,Uf as ae,Ul as oe,VT as se,Vm as ce,Xm as le,Zh as ue,Zw as de,Zy as fe,aT as pe,bl as me,fT as he,h_ as y,hl as ge,hv as _e,jm as ve,kD as b,kf as ye,kl as be,kw as xe,lv as Se,mT as Ce,m_ as we,n_ as Te,pT as x,pl as Ee,pv as De,ql as Oe,vx as ke,x_ as Ae,y_ as S,zg as je}from"./index-BN8X5Ryz.js";import{n as Me,t as Ne}from"./quatf64-D37SEdPg.js";import{s as Pe}from"./quat-C8PgLo31.js";import{l as Fe,n as Ie,o as Le,r as Re,s as C}from"./axisAngleDegrees-DzAS4tF-.js";import{i as w,n as ze,t as Be}from"./meshCloneUtils-BXMzy817.js";import{t as T}from"./MeshComponent-BFk18JiH.js";import{n as E,t as Ve}from"./MeshLocalVertexSpace-vomIk0sx.js";import{t as D}from"./MeshTransform-BaPjlQwH.js";import{t as O}from"./MeshVertexAttributes-CBsb_nVo.js";import{a as k,n as He,o as Ue,r as A}from"./meshVertexSpaceUtils-s2jLb8qI.js";import{t as We}from"./triangulationUtils-DNxIB1ux.js";import{n as j}from"./projectPointToVector-BkRdoTqD.js";import{t as Ge}from"./computeTranslationToOriginAndRotation-0WDVmpJG.js";import{s as Ke,t as qe}from"./vec3-B5yu4INg.js";import{c as Je,d as M,f as N,h as Ye,m as Xe,n as P,o as Ze,r as Qe,s as $e,t as et,u as tt}from"./vertexSpaceConversion-Dz87RqR7.js";import{t as nt}from"./spatialReferenceEllipsoidUtils-qw9wv8RL.js";import{i as rt,n as it,o as at}from"./External-C55iwtd6.js";var ot=`Provided component is not part of the list of components`,st=`Expected polygon to be a Polygon instance`,F=`Expected location to be a Point instance`,ct=class extends t{constructor(){super(`invalid-input:location`,F)}};function lt(e,t,n,r){if(r!==void 0){ne(e(),`option: geographic`,{replacement:"Use mesh `vertexSpace` and spatial reference to control how operations are performed instead.",version:`4.30`,warnOnce:!0});let i=t.type===`local`;if(!k(t)||r===i)return n.isGeographic||n.isWebMercator&&r;e().warnOnce(`Specifying the 'geographic' parameter (${r}) for a Mesh vertex space of type "${t.type}" is not supported. This parameter will be ignored.`)}switch(t.type){case`georeferenced`:return n.isGeographic;case`local`:return n.isGeographic||n.isWebMercator}}var I=()=>c.getLogger(`esri.geometry.support.meshUtils.centerAt`);function ut(e,t,n){if(!e.vertexAttributes?.position)return;let{vertexSpace:r}=e,i=n?.origin??e.origin,a=lt(I,r,i.spatialReference,n?.geographic);k(r)?dt(e,t,i):a?ft(e,t,i):pt(e,t,i)}function dt(e,t,n){let{vertexSpace:r}=e;if(!k(r))return;let i=gt,a=ht;if(!j(t,a,e.spatialReference))return void N(I(),t.spatialReference,e.spatialReference,M);if(!j(n,i,e.spatialReference)){let t=e.origin;i[0]=t.x,i[1]=t.y,i[2]=t.z,N(I(),n.spatialReference,e.spatialReference,M);return}let o=be(_t,a,i);r.origin=oe(S(),r.origin,o)}function ft(e,t,n){let r=Ae(n.x,n.y,n.z??0),i=P(e,new Ve({origin:r}));if(!i)return;let a=Ae(t.x,t.y,t.z??0),o=P({vertexAttributes:i,spatialReference:e.spatialReference,vertexSpace:new Ve({origin:a})},E.absolute);if(!o)return;let{position:s,normal:c,tangent:l}=o;e.vertexAttributes.position=s,e.vertexAttributes.normal=c,e.vertexAttributes.tangent=l,e.vertexAttributesChanged()}function pt(e,t,n){let r=gt,i=ht;if(j(t,i,e.spatialReference)){if(!j(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,N(I(),n.spatialReference,e.spatialReference,M);return}mt(e.vertexAttributes.position,i,r),e.vertexAttributesChanged()}else N(I(),t.spatialReference,e.spatialReference,M)}function mt(e,t,n){if(e)for(let r=0;r<e.length;r+=3)for(let i=0;i<3;i++)e[r+i]+=t[i]-n[i]}var ht=S(),gt=S(),_t=S();function vt(e){let{spatialReference:t,vertexSpace:n,untransformedBounds:r}=e,i=d(r,bt);if(k(n)&&e.transform&&Ke(i,i,e.transform.localMatrix),n.type===`georeferenced`){let e=n.origin;return e&&qe(i,i,e),ye(_(i),t)}let a=nt(t),o=n.origin;if(!je(a,t)){let[e,n,r]=o;return new ke({xmin:e,ymin:n,zmin:r,xmax:e,ymax:n,zmax:r,spatialReference:t})}return Ge(t,o,yt,a),Ke(i,i,yt),Te(i,a,0,i,t,0),ye(_(i),t)}var yt=h(),bt=ae(24);async function xt(e,t,n){switch(t.source.type){case`client`:case`service`:return St(e,t,n);case`loadable`:return t.source.load(e,n);default:s(t.source)}}async function St(n,r,i){let{source:a}=r,{loadGLTFMesh:o}=await he(e(()=>import(`./loadGLTFMesh-BOKYHmYs.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),i),s=await wt(a,i);x(i);let c=o(new p({x:0,y:0,z:0,spatialReference:n.spatialReference}),s.url,{resolveFile:Ct(s),signal:i?.signal,expectedType:s.type,unitConversionDisabled:r.unitConversionDisabled});c.then(()=>s.dispose(),()=>s.dispose());let{mesh:{vertexAttributes:l,components:u},meta:{isDracoDecompressed:d}}=await c;if(d)throw new t(`mesh-load-external:draco-not-supported`,`The provided mesh uses Draco compression which is not supported.`);n.vertexAttributes=l,n.components=u}function Ct(e){let t=g(e.url);return n=>{let r=u(n,t,t),i=r?r.replace(/^ *\.\//,``):null;return(i?e.files.get(i):null)??n}}async function wt(e,n){switch(e.type){case`client`:return Array.isArray(e.files)?Dt(e.files):Et(e.files);case`service`:return Ot(e.assets,n);default:throw new t(`mesh-load-external:invalid-source`,`Invalid source type`)}}async function Tt(e,t){let{parts:n,assetMimeType:r,assetName:i}=e;if(n.length===1)return new L(n[0].partUrl);let a=await e.toBlob(t);return x(t),L.fromBlob(a,Ft(i,r))}function Et(e){return L.fromBlob(e,Ft(e.name,e.type))}function Dt(e){if(!e.length)throw new t(`mesh-load-external:missing-assets`,`There must be at least one file to load`);return Pt(e.map(e=>({name:e.name,mimeType:e.type,source:Et(e)})))}async function Ot(e,n){if(!e.length)throw new t(`mesh-load-external:missing-assets`,`There must be at least one file to load`);let r=await de(e.map(async e=>{let t=await Tt(e);return x(n),{name:e.assetName,mimeType:e.assetMimeType,source:t}}));if(pe(n))throw r.forEach(e=>e.source.dispose()),Ce();return Pt(r)}var kt=/^model\/gltf\+json$/,At=/^model\/gltf-binary$/,jt=/\.gltf$/i,Mt=/\.glb$/i;function Nt({mimeType:e,source:t,name:n}){return kt.test(e)||jt.test(n)?{url:t.url,type:`gltf`}:At.test(e)||Mt.test(n)?{url:t.url,type:`glb`}:null}function Pt(e){let n=new Map,r=null,i=null;for(let t of e){let{source:e,name:a}=t;r??=Nt(t),a===`ESRI3DO_NORM.glb`&&(i=Nt(t)),n.set(a,e.url),e.files.forEach((e,t)=>n.set(t,e))}let a=i??r;if(a==null)throw new t(`mesh-load-external:missing-files`,`Missing files to load external mesh source`);return new L(a.url,()=>e.forEach(({source:e})=>e.dispose()),n,a.type)}var L=class e{constructor(e,t=()=>{},n=new Map,r){this.url=e,this.dispose=t,this.files=n,this.type=r}static fromBlob(t,n){let r=URL.createObjectURL(t);return new e(r,()=>URL.revokeObjectURL(r),void 0,n)}};function Ft(e,t){return kt.test(t)||jt.test(e)?`gltf`:At.test(t)||jt.test(e)?`glb`:void 0}var R=class extends te{constructor(e){super(e),this.externalSources=new _e,this._explicitDisplaySource=null,this.addHandles(Se(()=>this.externalSources,`after-remove`,({item:e})=>{e===this._explicitDisplaySource&&(this._explicitDisplaySource=null)},{sync:!0,onListenerRemove:()=>this._explicitDisplaySource=null}))}get displaySource(){return this._explicitDisplaySource??this._implicitDisplaySource}set displaySource(e){if(e!=null&&!at(e))throw Error(`Cannot use this source for display: it is not in a supported format.`);this._explicitDisplaySource=e,e&&this.externalSources.every(t=>!rt(t,e))&&this.externalSources.add(e)}clearSources(){this.externalSources.removeAll()}getExternalSourcesOnService(e){return this.externalSources.items.filter(t=>it(t,e))}get _implicitDisplaySource(){return this.externalSources.find(at)}};b([a()],R.prototype,`externalSources`,void 0),b([a()],R.prototype,`displaySource`,null),b([a()],R.prototype,`_implicitDisplaySource`,null),b([a()],R.prototype,`_explicitDisplaySource`,void 0),R=b([se(`esri.geometry.support.meshUtils.Metadata`)],R);function It(){let{faceDescriptions:e,faceVertexOffsets:t,uvScales:n}=Gt,r=4*e.length,i=new Float64Array(3*r),a=new Float32Array(3*r),o=new Float32Array(2*r),s=new Uint32Array(2*e.length*3),c=0,l=0,u=0,d=0;for(let r=0;r<e.length;r++){let f=e[r],p=c/3;for(let e of t)s[d++]=p+e;let m=f.corners;for(let e=0;e<4;e++){let t=m[e],r=0;o[u++]=.25*n[e][0]+f.uvOrigin[0],o[u++]=f.uvOrigin[1]-.25*n[e][1];for(let e=0;e<3;e++)f.axis[e]===0?(i[c++]=.5*t[r++],a[l++]=0):(i[c++]=.5*f.axis[e],a[l++]=f.axis[e])}}return{position:i,normal:a,uv:o,faces:s}}function Lt(e,t){let n=e.components[0],r=n.faces,i=Kt[t],a=6*i,o=[,,,,,,],s=Array(r.length-6),c=0,l=0;for(let e=0;e<r.length;e++)e>=a&&e<a+6?o[c++]=r[e]:s[l++]=r[e];if(e.vertexAttributes.uv!=null){let t=new Float32Array(e.vertexAttributes.uv),n=4*i*2,r=[0,1,1,1,1,0,0,0];for(let e=0;e<r.length;e++)t[n+e]=r[e];e.vertexAttributes.uv=t}return e.components=[new T({faces:o,material:n.material}),new T({faces:s})],e}function Rt(e=0){let t=Math.round(8*2**e),n=2*t,r=(t-1)*(n+1)+2*n,i=new Float64Array(3*r),a=new Float32Array(3*r),o=new Float32Array(2*r),s=new Uint32Array(3*((t-1)*n*2)),c=0,l=0,u=0,d=0;for(let e=0;e<=t;e++){let r=e/t*Math.PI+.5*Math.PI,f=Math.cos(r);W[2]=Math.sin(r);let p=e===0||e===t,m=p?n-1:n;for(let r=0;r<=m;r++){let h=r/m*2*Math.PI;W[0]=-Math.sin(h)*f,W[1]=Math.cos(h)*f;for(let e=0;e<3;e++)i[c]=.5*W[e],a[c]=W[e],++c;o[l++]=(r+(p?.5:0))/n,o[l++]=e/t,e!==0&&r!==n&&(e!==t&&(s[u++]=d,s[u++]=d+1,s[u++]=d-n),e!==1&&(s[u++]=d,s[u++]=d-n,s[u++]=d-n-1)),d++}}return{position:i,normal:a,uv:o,faces:s}}function zt(e=0){let t=Math.round(16*2**e),n=4*(t+1)+2*t,r=new Float64Array(3*n),i=new Float32Array(3*n),a=new Float32Array(2*n),o=new Uint32Array(3*(4*t)),s=0,c=0,l=0,u=0,d=0;for(let e=0;e<=5;e++){let n=e===0||e===5,f=e<=1||e>=4,p=e===2||e===4,m=n?t-1:t;for(let h=0;h<=m;h++){let g=h/m*2*Math.PI,_=n?0:.5;W[0]=_*Math.sin(g),W[1]=_*-Math.cos(g),W[2]=e<=2?.5:-.5;for(let t=0;t<3;t++)r[s++]=W[t],i[c++]=f?t===2?e<=1?1:-1:0:t===2?0:W[t]/_;a[l++]=(h+(n?.5:0))/t,a[l++]=e<=1?1*e/3:e<=3?1*(e-2)/3+1/3:1*(e-4)/3+2/3,p||e===0||h===t||(e!==5&&(o[u++]=d,o[u++]=d+1,o[u++]=d-t),e!==1&&(o[u++]=d,o[u++]=d-t,o[u++]=d-t-1)),d++}}return{position:r,normal:i,uv:a,faces:o}}function Bt(e,t){let n=typeof t==`number`?t:t==null?1:t.width,r=typeof t==`number`?t:t==null?1:t.height;switch(e){case`up`:case`down`:return{width:n,depth:r};case`north`:case`south`:return{width:n,height:r};case`east`:case`west`:return{depth:n,height:r}}}function Vt(e){let t=H.facingAxisOrderSwap[e],n=H.position,r=H.normal,i=new Float64Array(n.length),a=new Float32Array(r.length),o=0;for(let e=0;e<4;e++){let e=o;for(let s=0;s<3;s++){let c=t[s],l=Math.abs(c)-1,u=c>=0?1:-1;i[o]=n[e+l]*u,a[o]=r[e+l]*u,o++}}return{position:i,normal:a,uv:new Float32Array(H.uv),faces:new Uint32Array(H.faces),isPlane:!0}}var z=1,B=2,V=3,H={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[V,z,B],west:[-V,-z,B],north:[-z,V,B],south:[z,-V,B],up:[z,B,V],down:[z,-B,-V]}};function U(e,t,n){e.isPlane||Ht(e),Wt(e,Ut(n?.size,n?.unit,t.spatialReference));let r=A(t,n),i=t.spatialReference.isGeographic?A(t):r,a=P({vertexAttributes:e,vertexSpace:i,spatialReference:t.spatialReference},r,{allowBufferReuse:!0});return{vertexAttributes:new O({...a,uv:e.uv}),vertexSpace:r,components:[new T({faces:e.faces,material:n?.material||null})],spatialReference:t.spatialReference}}function Ht(e){for(let t=0;t<e.position.length;t+=3)e.position[t+2]+=.5}function Ut(e,t,n){let r=Qe(t,n);if(e==null&&r===1)return null;if(e==null)return[r,r,r];if(typeof e==`number`){let t=e*r;return[t,t,t]}return[e.width==null?r:e.width*r,e.depth==null?r:e.depth*r,e.height==null?r:e.height*r]}function Wt(e,t){if(t!=null){G[0]=t[0],G[4]=t[1],G[8]=t[2];for(let t=0;t<e.position.length;t+=3){for(let n=0;n<3;n++)W[n]=e.position[t+n];me(W,W,G);for(let n=0;n<3;n++)e.position[t+n]=W[n]}if(t[0]!==t[1]||t[1]!==t[2]){G[0]=1/t[0],G[4]=1/t[1],G[8]=1/t[2];for(let t=0;t<e.normal.length;t+=3){for(let n=0;n<3;n++)W[n]=e.normal[t+n];me(W,W,G),Ee(W,W);for(let n=0;n<3;n++)e.normal[t+n]=W[n]}}}}var Gt={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},Kt={south:0,east:1,north:2,west:3,up:4,down:5},W=S(),G=ie(),K=()=>c.getLogger(`esri.geometry.support.meshUtils.rotate`);function qt(e,t,n){if(!e.vertexAttributes?.position||t[3]===0)return;let{spatialReference:r,vertexSpace:i}=e,a=n?.origin??e.origin,o=n?.geographic,s=lt(K,i,r,o);He(e)?Jt(e,t,a):s?Yt(e,t,a):Xt(e,t,a)}function Jt(e,t,n){e.transform??=new D;let{vertexSpace:r,transform:a,spatialReference:o}=e,[s,c,l]=r.origin,u=new p({x:s,y:c,z:l,spatialReference:o}),d=J;if(u.equals(n))v(d,0,0,0);else if(!et(d,n,e))return void N(K(),n.spatialReference,o,M);Pe(tn,C(t),Fe(t));let m=f(Zt,tn,y,we,d),{localMatrix:h}=a,g=re(Zt,m,h);a.scale=ve(S(),g),ce(g,g,Oe(J,a.scale));let _=a.rotationAxis;a.rotation=Le(g),a.rotationAngle===0&&(a.rotationAxis=_),a.translation=i(S(),g)}function Yt(e,t,n){let r=e.spatialReference,i=nt(r),a=en;if(!j(n,a,i)&&(N(K(),n.spatialReference,i,`Falling back to mesh origin`),!j(e.origin,a,i)))return void N(K(),e.origin.spatialReference,i);let o=e.vertexAttributes.position,s=e.vertexAttributes.normal,c=e.vertexAttributes.tangent,l=new Float64Array(o.length),u=s==null?null:new Float32Array(s.length),d=c==null?null:new Float32Array(c.length);Ge(i,a,Y,i),fe($t,Y);let f=Qt;me(C(Qt),C(t),$t),f[3]=t[3],tt(o,r,l,i)&&(s==null||u==null||Xe(s,o,r,l,i,u))&&(c==null||d==null||Ze(c,o,r,l,i,d))?(q(l,f,3,a),Ye(l,i,o,r)&&(s==null||u==null||(q(u,f,3),$e(u,o,r,l,i,s)))&&(c==null||d==null||(q(d,f,4),Je(d,o,r,l,i,c)))?e.vertexAttributesChanged():N(K(),i,r)):N(K(),r,i)}function Xt(e,t,n){let r=en;if(!j(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,N(K(),n.spatialReference,e.spatialReference,M);return}q(e.vertexAttributes.position,t,3,r),q(e.vertexAttributes.normal,t,3),q(e.vertexAttributes.tangent,t,4),e.vertexAttributesChanged()}function q(e,t,n,r=y){if(e!=null){le(Y,Fe(t),C(t));for(let t=0;t<e.length;t+=n){for(let n=0;n<3;n++)J[n]=e[t+n]-r[n];ge(J,J,Y);for(let n=0;n<3;n++)e[t+n]=J[n]+r[n]}}}var J=S(),Zt=h(),Qt=Re(),Y=h(),$t=ie(),en=S(),tn=Ne(),X=()=>c.getLogger(`esri.geometry.support.meshUtils.scale`);function nn(e,t,n){if(!e.vertexAttributes?.position)return;let{vertexSpace:r,spatialReference:i}=e,a=n?.origin??e.origin,o=n?.geographic,s=lt(X,r,i,o);He(e)?rn(e,t,a):s?an(e,t,a):on(e,t,a)}function rn(e,t,n){e.transform??=new D;let{vertexSpace:r,transform:a,spatialReference:o}=e,[s,c,l]=r.origin,u=new p({x:s,y:c,z:l,spatialReference:o}),d=Z;if(u.equals(n))v(d,0,0,0);else if(!et(d,n,e))return void N(X(),n.spatialReference,o,M);let m=v(cn,t,t,t),h=f(ln,Me,y,m,d),{localMatrix:g}=a,_=re(ln,h,g);a.scale=ve(S(),_),ce(_,_,Oe(Z,a.scale));let ee=a.rotationAxis;a.rotation=Le(_),a.rotationAngle===0&&(a.rotationAxis=ee),a.translation=i(S(),_)}function an(e,t,n){let r=e.spatialReference,i=nt(r),a=un;if(!j(n,a,i)&&(N(X(),n.spatialReference,i,`Falling back to mesh origin`),!j(e.origin,a,i)))return void N(X(),e.origin.spatialReference,i);let o=e.vertexAttributes.position,s=e.vertexAttributes.normal,c=e.vertexAttributes.tangent,l=new Float64Array(o.length),u=s==null?null:new Float32Array(s.length),d=c==null?null:new Float32Array(c.length);tt(o,r,l,i)&&(s==null||u==null||Xe(s,o,r,l,i,u))&&(c==null||d==null||Ze(c,o,r,l,i,d))?(sn(l,t,a),Ye(l,i,o,r)&&(s==null||u==null||$e(u,o,r,l,i,s))&&(c==null||d==null||Je(d,o,r,l,i,c))?e.vertexAttributesChanged():N(X(),i,r)):N(X(),r,i)}function on(e,t,n){let r=un;if(!j(n,r,e.spatialReference)){let t=e.origin;r[0]=t.x,r[1]=t.y,r[2]=t.z,N(X(),n.spatialReference,e.spatialReference,M);return}sn(e.vertexAttributes.position,t,r),e.vertexAttributesChanged()}function sn(e,t,n=y){if(e)for(let r=0;r<e.length;r+=3){for(let t=0;t<3;t++)Z[t]=e[r+t]-n[t];ee(Z,Z,t);for(let t=0;t<3;t++)e[r+t]=Z[t]+n[t]}}var Z=S(),cn=S(),ln=h(),un=S(),Q,dn={base:null,key:`type`,defaultKeyValue:`georeferenced`,typeMap:{georeferenced:E,local:Ve}},$=Q=class extends xe(ue(n(m))){constructor(e){super(e),this.components=null,this.vertexSpace=new E,this.transform=null,this.metadata=new R,this.hasZ=!0,this.hasM=!1,this.vertexAttributes=new O,this.type=`mesh`}initialize(){(this.metadata.externalSources.length===0||this.vertexAttributes.position.length)&&(this.loadStatus=`loaded`),this.when(()=>{this.addHandles(De(()=>({vertexAttributes:this.vertexAttributes,components:this.components?.map(e=>e.clone())}),()=>this._clearSources(),{once:!0,sync:!0}))})}get hasExtent(){return this.loaded?this.vertexAttributes.position.length>0&&(!this.components||this.components.length>0):this.metadata.displaySource?.extent!=null}get _transformedExtent(){let{spatialReference:e,vertexSpace:t}=this,n=this;return vt({get transform(){return n.transform},vertexSpace:t,spatialReference:e,untransformedBounds:this._untransformedBounds})}get _untransformedBounds(){let{vertexAttributes:{position:e},components:t}=this;return e.length===0||t?.length===0?r(l):_(e)}get origin(){let e=Ue(this.vertexSpace,this.spatialReference);if(e!=null)return e;let{center:t,zmin:n}=this._transformedExtent;return new p({x:t.x,y:t.y,z:n,spatialReference:this.spatialReference})}get extent(){return this.loaded||this.metadata?.displaySource?.extent==null?this._transformedExtent:this.metadata.displaySource.extent.clone()}addComponent(e){this._checkIfLoaded(`addComponent()`)&&(this.components||=[],this.components.push(T.from(e)),this.notifyChange(`components`))}removeComponent(e){if(this._checkIfLoaded(`removeComponent()`)){if(this.components){let t=this.components.indexOf(e);if(t!==-1)return this.components.splice(t,1),void this.notifyChange(`components`)}c.getLogger(this).error(`removeComponent()`,ot)}}rotate(e,t,n,r){return Ie(e,t,n,fn),qt(this,fn,r),this}offset(e,t,n){if(!this._checkIfLoaded(`offset()`))return this;let{vertexSpace:r,vertexAttributes:i}=this,a=i?.position;if(!a)return this;if(k(r)){let[i,a,o]=r.origin;r.origin=Ae(i+e,a+t,o+n)}else{for(let r=0;r<a.length;r+=3)a[r]+=e,a[r+1]+=t,a[r+2]+=n;this.vertexAttributesChanged()}return this}scale(e,t){return this._checkIfLoaded(`scale()`)&&nn(this,e,t),this}centerAt(e,t){return this._checkIfLoaded(`centerAt()`)&&ut(this,e,t),this}load(e){let{metadata:{displaySource:t}}=this;return t&&this.addResolvingPromise(xt(this,t,e)),Promise.resolve(this)}addExternalSources(e){this.metadata.externalSources.addMany(e)}updateDisplaySource(e){this.metadata.displaySource=e}clone(e){return super.clone(ze(Be(e)))}cloneShallow(){return new Q({components:this.components,spatialReference:this.spatialReference,vertexAttributes:this.vertexAttributes,vertexSpace:this.vertexSpace.clone(),transform:this.transform,metadata:this.metadata})}vertexAttributesChanged(){this.notifyChange(`vertexAttributes`)}async toBinaryGLTF(t){let[{toBinaryGLTF:n}]=await Promise.all([e(()=>import(`./gltfexport-CaxC2h3L.js`),__vite__mapDeps([25,1,2,11,12,4,5,13,14,15,20,17,18,6,7,23,24,8])),this.load(t)]);return x(t),await n(this,t)}get usedMemory(){return this.components?this.components.reduce((e,t)=>e+t.memoryUsage,this.vertexAttributes.usedMemory):this.vertexAttributes.usedMemory}_clearSources(){this.metadata.clearSources()}_checkIfLoaded(e){return!!this.loaded||(c.getLogger(this).error(e,`Mesh must be loaded before applying operations`),!1)}static createBox(e,t){if(!(e instanceof p))return c.getLogger(this.prototype).error(`.createBox()`,F),null;let n=new Q(U(It(),e,t));return t?.imageFace&&t.imageFace!==`all`?Lt(n,t.imageFace):n}static createSphere(e,t){return e instanceof p?new Q(U(Rt(t?.densificationFactor||0),e,t)):(c.getLogger(this.prototype).error(`.createSphere()`,F),null)}static createCylinder(e,t){return e instanceof p?new Q(U(zt(t?.densificationFactor||0),e,t)):(c.getLogger(this.prototype).error(`.createCylinder()`,F),null)}static createPlane(e,t){if(!(e instanceof p))return c.getLogger(this.prototype).error(`.createPlane()`,F),null;let n=t?.facing??`up`,r=Bt(n,t?.size);return new Q(U(Vt(n),e,{...t,size:r}))}static createFromPolygon(e,t){if(!(e instanceof o))return c.getLogger(this.prototype).error(`.createFromPolygon()`,st),null;let n=We(e);return new Q({vertexAttributes:new O({position:n.position}),components:[new T({faces:n.faces,shading:`flat`,material:t?.material??null})],spatialReference:e.spatialReference,vertexSpace:new E})}static async createFromGLTF(t,n,r){if(!(t instanceof p)){let e=new ct;throw c.getLogger(this.prototype).error(`.createfromGLTF()`,e.message),e}let{loadGLTFMesh:i}=await he(e(()=>import(`./loadGLTFMesh-BOKYHmYs.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),r);return new Q((await i(t,n,r)).mesh)}static createWithExternalSource(e,t,n){let r=n?.extent??null,{spatialReference:i}=e,a=n?.transform?.clone()??new D,o=A(e,n),s=n?.unitConversionDisabled,c={source:t,extent:r,unitConversionDisabled:s},l=new R;return l.externalSources.push(c),new Q({metadata:l,transform:a,vertexSpace:o,spatialReference:i})}static createIncomplete(e,n){let{spatialReference:r}=e,i=n?.transform?.clone()??new D,a=A(e,n),o=new Q({transform:i,vertexSpace:a,spatialReference:r});return o.addResolvingPromise(Promise.reject(new t(`mesh-incomplete`,`Mesh resources are not complete`))),o}};b([a({type:[T],json:{write:!0}})],$.prototype,`components`,void 0),b([a({nonNullable:!0,types:dn,constructOnly:!0,json:{write:!0},clonable:(e,t)=>w(t)?.vertexSpace??e.clone(t)})],$.prototype,`vertexSpace`,void 0),b([a({type:D,clonable:(e,t)=>{let n=w(t);return n&&`transform`in n?n.transform:e?.clone()??e},json:{write:!0}})],$.prototype,`transform`,void 0),b([a({constructOnly:!0,type:R,clonable:(e,t)=>w(t)?.metadata??e.clone()})],$.prototype,`metadata`,void 0),b([a()],$.prototype,`hasExtent`,null),b([a()],$.prototype,`_transformedExtent`,null),b([a()],$.prototype,`_untransformedBounds`,null),b([a()],$.prototype,`origin`,null),b([a({readOnly:!0,json:{read:!1}})],$.prototype,`extent`,null),b([a({readOnly:!0,json:{read:!1,write:!0,default:!0}})],$.prototype,`hasZ`,void 0),b([a({readOnly:!0,json:{read:!1,write:!0,default:!1}})],$.prototype,`hasM`,void 0),b([a({type:O,nonNullable:!0,json:{write:!0},clonable:(e,t)=>w(t)?.vertexAttributes??e.clone(t)})],$.prototype,`vertexAttributes`,void 0),$=Q=b([se(`esri.geometry.Mesh`)],$);var fn=Re();export{$ as t};