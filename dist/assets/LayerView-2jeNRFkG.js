import{Bu as e,DT as t,Gu as n,Hh as r,Hu as i,Nh as a,OT as o,Uu as s,Vu as c,Wu as l,dg as u,eT as d,gD as f,pT as p,pg as m,sv as h,tD as g,uE as _,vT as v}from"./index-CZ4oMP1N.js";import{n as y}from"./layerViewUtils-RSw-QNoB.js";var b=class extends a(r(h)){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new m,this._attributionIndexTask=null,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if(e.name!==`layerview:create-error`){let t=this.layer&&this.layer.id||`no id`,n=this.layer?.title||`no title`;_.getLogger(this).error(`#resolve()`,`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}})}destroy(){this._updatingHandles=v(this._updatingHandles),this._attributionIndexTask=p(this._attributionIndexTask),this._set(`parent`,null)}get attributionItems(){let e=this._get(`attributionItems`)??[];if(this.suspended||!this.layer?.attributionVisible)return e.length===0?e:[];if(!this.view.stationary)return e;let t=this.getAttributionItems();return g(e,t,(e,t)=>e.text===t.text)?e:t}get attributionUpdating(){return!!this._attributionIndexTask&&!this._attributionIndexTask.finished}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome(`visible`,e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){let e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){let e=this.layer&&`effectiveScaleRange`in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&this.parent&&!this.parent.suspended&&this.view?.ready&&y(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){let e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);let t=this.layer&&`effectiveScaleRange`in this.layer?this.layer.effectiveScaleRange:null;return y(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}getAttributionItems(){let t=c(this.layer);if(t)return[t];if(e(this.layer)&&(this._attributionIndexTask||(this._attributionIndexTask=u(async e=>{let t=await this.layer.fetchAttributionData();return d(e),n(t)}),this._updatingHandles.addPromise(this._attributionIndexTask.promise)),this._attributionIndexTask?.finished&&this._attributionIndexTask.value))return s(this._attributionIndexTask.value,this.layer.tileInfo,this.view.scale,this.view.extent);let r=i(this.layer);if(r)return[r];let a=l(this.layer);return a?[a]:[]}};f([t({readOnly:!0})],b.prototype,`spatialReferenceSupported`,null),f([t()],b.prototype,`view`,void 0),f([t({readOnly:!0})],b.prototype,`attributionItems`,null),f([t({readOnly:!0})],b.prototype,`attributionUpdating`,null),f([t()],b.prototype,`fullOpacity`,null),f([t()],b.prototype,`layer`,void 0),f([t()],b.prototype,`parent`,void 0),f([t({readOnly:!0})],b.prototype,`suspended`,null),f([t({readOnly:!0})],b.prototype,`suspendInfo`,null),f([t({readOnly:!0})],b.prototype,`legendEnabled`,null),f([t({type:Boolean,readOnly:!0})],b.prototype,`updating`,null),f([t({readOnly:!0})],b.prototype,`updatingProgress`,null),f([t()],b.prototype,`updateSuspended`,null),f([t()],b.prototype,`visible`,null),f([t({readOnly:!0})],b.prototype,`visibleAtCurrentScale`,null),f([t({readOnly:!0})],b.prototype,`visibleAtCurrentTimeExtent`,null),b=f([o(`esri.views.layers.LayerView`)],b);var x=b;export{x as t};