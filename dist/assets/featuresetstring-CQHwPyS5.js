import{wn as e}from"./index-CZ4oMP1N.js";import"./ImmutableArray-C3KNQCVd.js";import{E as t,G as n,N as r,S as i,V as a,X as o,a as s,c,h as l,l as u,lt as d,m as f,s as p,st as m,t as h,y as g}from"./Dictionary-ByWMrwnf.js";import{o as _}from"./shared-CBxUlSgW.js";import"./number-bp6QQFrm.js";function v(e,t){return e&&e.domain?e.domain.type===`coded-value`||e.domain.type===`codedValue`?h.convertObjectToArcadeDictionary({type:`codedValue`,name:e.domain.name,dataType:_[e.field.type],codedValues:e.domain.codedValues.map(e=>({name:e.name,code:e.code}))},g(t)):h.convertObjectToArcadeDictionary({type:`range`,name:e.domain.name,dataType:_[e.field.type],min:e.domain.minValue,max:e.domain.maxValue},g(t)):null}function y(_){_.mode===`async`&&(_.functions.domain=function(t,r){return _.standardFunctionAsync(t,r,async(i,a,s)=>{if(o(s,2,3,t,r),f(s[0]))return v(l(s[0],n(s[1]),s[2]===void 0?void 0:s[2]),t);if(p(s[0]))return await s[0]._ensureLoaded(),v(u(n(s[1]),s[0],null,s[2]===void 0?void 0:s[2]),t);throw new e(t,`InvalidParameter`,r)})},_.functions.subtypes=function(t,n){return _.standardFunctionAsync(t,n,async(i,a,s)=>{if(o(s,1,1,t,n),f(s[0])){let e=r(s[0]);return e?h.convertObjectToArcadeDictionary(e,g(t)):null}if(p(s[0])){await s[0]._ensureLoaded();let e=s[0].subtypeMetadata();return e?h.convertObjectToArcadeDictionary(e,g(t)):null}throw new e(t,`InvalidParameter`,n)})},_.functions.domainname=function(t,r){return _.standardFunctionAsync(t,r,async(i,a,c)=>{if(o(c,2,4,t,r),f(c[0]))return s(c[0],n(c[1]),c[2],c[3]===void 0?void 0:c[3]);if(p(c[0])){await c[0]._ensureLoaded();let e=u(n(c[1]),c[0],null,c[3]===void 0?void 0:c[3]);return m(e,c[2])}throw new e(t,`InvalidParameter`,r)})},_.signatures.push({name:`domainname`,min:2,max:4}),_.functions.domaincode=function(t,r){return _.standardFunctionAsync(t,r,async(a,s,l)=>{if(o(l,2,4,t,r),f(l[0]))return c(l[0],n(l[1]),l[2],l[3]===void 0?void 0:l[3]);if(p(l[0])){await l[0]._ensureLoaded();let e=u(n(l[1]),l[0],null,l[3]===void 0?void 0:l[3]);return i(e,l[2])}throw new e(t,`InvalidParameter`,r)})},_.signatures.push({name:`domaincode`,min:2,max:4}),_.functions.text=function(t,n){return _.standardFunctionAsync(t,n,async(r,i,s)=>{if(o(s,1,2,t,n),p(s[0])){let i=d(s[1],``);if(i===``)return s[0].castToText();if(i.toLowerCase()===`schema`)return s[0].convertToText(`schema`,r.abortSignal);if(i.toLowerCase()===`featureset`)return s[0].convertToText(`featureset`,r.abortSignal);throw new e(t,`InvalidParameter`,n)}return a(s[0],s[1])})},_.functions.gdbversion=function(t,n){return _.standardFunctionAsync(t,n,async(r,i,a)=>{if(o(a,1,1,t,n),f(a[0]))return a[0].gdbVersion();if(p(a[0]))return(await a[0].load()).gdbVersion;throw new e(t,`InvalidParameter`,n)})},_.functions.schema=function(n,r){return _.standardFunctionAsync(n,r,async(i,a,s)=>{if(o(s,1,1,n,r),p(s[0]))return await s[0].load(),h.convertObjectToArcadeDictionary(s[0].schema(),g(n));if(f(s[0])){let e=t(s[0]);return e?h.convertObjectToArcadeDictionary(e,g(n)):null}throw new e(n,`InvalidParameter`,r)})})}export{y as registerFunctions};