import{$g as e,BT as t,Nx as n,Ov as r,Qg as i,Zg as a,kv as o,lS as s,tE as c,wS as l,wx as u}from"./index-CZ4oMP1N.js";function d(e){if(!e)return null;let t=e.wkid;if(t)return a[t];let n=e.wkt2??e.wkt;return n?f(n):null}function f(t){let n=e.exec(t);if(!n||n.length!==2)return null;let r=n[1].split(`,`);if(!r||r.length<3)return null;let i=parseFloat(r[1]),a=parseFloat(r[2]);return isNaN(i)||isNaN(a)?null:{a:i,f:a===0?0:1/a}}function p(e){let t=d(e);if(m(t))return t;let n=t.a*(1-t.f);return Object.assign(t,{b:n,eSq:1-(n/t.a)**2,radius:(2*t.a+n)/3,densificationRatio:1e4/((2*t.a+n)/3)})}function m(e){return e!=null&&`b`in e&&`eSq`in e&&`radius`in e}function h(e,t,n){let{a:r,eSq:a}=p(n),o=Math.sqrt(a),s=Math.sin(t[1]*i),c=r*t[0]*i,l;return l=a>0?r*((1-a)*(s/(1-a*(s*s))-1/(2*o)*Math.log((1-o*s)/(1+o*s))))*.5:r*s,e[0]=c,e[1]=l,e}function g(e){return s(e)&&!!d(e)}function _(e,r=`square-meters`){if(e.some(e=>!g(e.spatialReference)))throw new t(`geodesic-areas:invalid-spatial-reference`,`the input geometries spatial reference is not supported`);let i=[];for(let t=0;t<e.length;t++){let n=e[t],r=n.spatialReference,{radius:a,densificationRatio:o}=p(r),s=a*o;i.push(y(n,s))}let a=[],o=[0,0],s=[0,0];for(let e=0;e<i.length;e++){let{rings:t,spatialReference:c}=i[e],l=0;for(let e=0;e<t.length;e++){let n=t[e];h(o,n[0],c),h(s,n[n.length-1],c);let r=s[0]*o[1]-o[0]*s[1];for(let e=0;e<n.length-1;e++)h(o,n[e+1],c),h(s,n[e],c),r+=s[0]*o[1]-o[0]*s[1];l+=r}l=n(l,`square-meters`,r),a.push(l/-2)}return a}function v(e,r=`meters`){if(!e)throw new t(`geodesic-lengths:invalid-geometries`,`the input geometries type is not supported`);if(e.some(e=>!g(e.spatialReference)))throw new t(`geodesic-lengths:invalid-spatial-reference`,`the input geometries spatial reference is not supported`);let i=[];for(let t=0;t<e.length;t++){let a=e[t],{spatialReference:o}=a,s=a.type===`polyline`?a.paths:a.rings,c=0;for(let e=0;e<s.length;e++){let t=s[e],n=0;for(let e=1;e<t.length;e++){let r=t[e-1][0],i=t[e][0],a=t[e-1][1],s=t[e][1];if(a!==s||r!==i){let e=new b;S(e,[r,a],[i,s],o),n+=e.distance}}c+=n}c=n(c,`meters`,r),i.push(c)}return i}function y(e,n){if(e.type!==`polyline`&&e.type!==`polygon`)throw new t(`geodesic-densify:invalid-geometry`,`the input geometry is neither polyline nor polygon`);let{spatialReference:i}=e;if(!g(i))throw new t(`geodesic-densify:invalid-spatial-reference`,`the input geometry spatial reference is not supported`);let a=e.type===`polyline`?e.paths:e.rings,s=[],l=[0,0],d=new b;for(let e of a){let t=[];s.push(t),t.push([e[0][0],e[0][1]]);let r,a,o=e[0][0],c=e[0][1];for(let s=0;s<e.length-1;s++){if(r=e[s+1][0],a=e[s+1][1],o===r&&c===a)continue;let u=[o,c];S(d,[o,c],[r,a],i);let{azimuth:f,distance:p}=d,m=p/n;if(m>1){for(let e=1;e<=m-1;e++)x(l,u,f,e*n,i),t.push(l.slice());x(l,u,f,(p+Math.floor(m-1)*n)/2,i),t.push(l.slice())}x(l,u,f,p,i),t.push(l.slice()),o=l[0],c=l[1]}}let f=c(u,i);return e.type===`polyline`?new r({paths:s,spatialReference:f}):new o({rings:s,spatialReference:f})}var b=class{constructor(e=0,t,n){this.distance=e,this.azimuth=t,this.reverseAzimuth=n}};function x(e,t,n,r,a){let o=t[0],s=t[1],c=o*i,l=s*i,u=(n??0)*i,{a:d,b:f,f:m}=p(a),h=Math.sin(u),g=Math.cos(u),_=(1-m)*Math.tan(l),v=1/Math.sqrt(1+_*_),y=_*v,b=Math.atan2(_,g),x=v*h,S=x*x,C=1-S,w=C*(d*d-f*f)/(f*f),T=1+w/16384*(4096+w*(w*(320-175*w)-768)),E=w/1024*(256+w*(w*(74-47*w)-128)),D,O,k,A=r/(f*T),j=2*Math.PI;for(;Math.abs(A-j)>1e-12;)k=Math.cos(2*b+A),D=Math.sin(A),O=Math.cos(A),j=A,A=r/(f*T)+E*D*(k+E/4*(O*(2*k*k-1)-E/6*k*(4*D*D-3)*(4*k*k-3)));let M=y*D-v*O*g,N=Math.atan2(y*O+v*D*g,(1-m)*Math.sqrt(S+M*M)),P=m/16*C*(4+m*(4-3*C)),F=Math.atan2(D*h,v*O-y*D*g)-(1-P)*m*x*(A+P*D*(k+P*O*(2*k*k-1)));return e[0]=(c+F)/i,e[1]=N/i,e}function S(e,t,n,r){let a=t[0]*i,o=t[1]*i,s=n[0]*i,c=n[1]*i,{a:l,b:u,f:d,radius:f}=p(r),m=s-a,h=Math.atan((1-d)*Math.tan(o)),g=Math.atan((1-d)*Math.tan(c)),_=Math.sin(h),v=Math.cos(h),y=Math.sin(g),b=Math.cos(g),x,S,C,w,T,E,D,O,k,A,j=1e3,M=m;do{if(D=Math.sin(M),O=Math.cos(M),C=Math.sqrt(b*D*(b*D)+(v*y-_*b*O)*(v*y-_*b*O)),C===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;T=_*y+v*b*O,E=Math.atan2(C,T),k=v*b*D/C,S=1-k*k,w=T-2*_*y/S,isNaN(w)&&(w=0),A=d/16*S*(4+d*(4-3*S)),x=M,M=m+(1-A)*d*k*(E+A*C*(w+A*T*(2*w*w-1)))}while(Math.abs(M-x)>1e-12&&--j>0);if(j===0){let t=f,n=Math.acos(Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos(s-a))*t,r=s-a,l=Math.sin(r)*Math.cos(c),u=Math.cos(o)*Math.sin(c)-Math.sin(o)*Math.cos(c)*Math.cos(r);return e.azimuth=Math.atan2(l,u)/i,e.distance=n,e.reverseAzimuth=void 0,e}let N=S*(l*l-u*u)/(u*u),P=N/1024*(256+N*(N*(74-47*N)-128)),F=u*(1+N/16384*(4096+N*(N*(320-175*N)-768)))*(E-P*C*(w+P/4*(T*(2*w*w-1)-P/6*w*(4*C*C-3)*(4*w*w-3)))),I=Math.atan2(b*Math.sin(M),v*y-_*b*Math.cos(M)),L=Math.atan2(v*Math.sin(M),v*y*Math.cos(M)-_*b);return e.azimuth=I/i,e.distance=F,e.reverseAzimuth=L/i,e}function C(e){return g(e)?e:l(e)?u.WGS84:null}export{S as a,y as c,x as i,_ as n,v as o,b as r,g as s,C as t};