import{$T as e,A as t,BT as n,CE as r,L as i,M as a,Rh as o,Ua as s,VT as c,WT as l,ca as u,cv as d,fC as f,ji as p,kD as m,kw as h,lv as g,ma as _,pa as v,rh as y,sT as b}from"./index-BN8X5Ryz.js";import{n as x}from"./SceneService-CV9CcpT-.js";import{i as S,n as C,r as w,t as T}from"./I3SLayerDefinitions-DCkrs9K5.js";import"./originUtils-CJnuu7mB.js";import"./resourceUtils-Bt8ctqoA.js";import"./resourceUtils-t_8WR2aj.js";import"./saveUtils-CEfw3trS.js";import"./memoize-Dl61_jt0.js";import{o as E,p as D,y as O}from"./elevationInfoUtils-uoMH3ofe.js";import{t as k}from"./SceneModifications-BfQhIZ_m.js";var A=class extends x(v(i(a(t(s(u(_(h(o))))))))){constructor(...e){super(...e),this.geometryType=`mesh`,this.operationalLayerType=`IntegratedMeshLayer`,this.type=`integrated-mesh`,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile=`mesh-pyramids`,this.modifications=null,this.path=null,this.definitionExpression=null}initialize(){this.addHandles(g(()=>this.modifications,`after-changes`,()=>this.modifications=this.modifications,d))}normalizeCtorArgs(e,t){return typeof e==`string`?{url:e,...t}:e}readModifications(e,t,n){this._modificationsSource={url:f(e,n),context:n}}set elevationInfo(e){e!=null&&e.mode!==`absolute-height`||this._set(`elevationInfo`,e),this._validateElevationInfo(e)}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){let t=e?.signal;try{await this.loadFromPortal({supportedTypes:[`Scene Service`]},e)}catch(e){b(e)}if(await this._fetchService(t),this._modificationsSource!=null){let t=await k.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin(`modifications`,t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(this._modificationsSource!=null)return this.load().then(()=>{},()=>{})}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:`integrated-mesh`},e)}async save(){return this._debouncedSaveOperations(0,{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:`integrated-mesh`})}validateLayer(t){if(t.layerType&&t.layerType!==`IntegratedMesh`)throw new e(`integrated-mesh-layer:layer-type-not-supported`,`IntegratedMeshLayer does not support this layer type`,{layerType:t.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new e(`layer:service-version-not-supported`,`Service version is not supported.`,{serviceVersion:this.version.versionString,supportedVersions:`1.x`});if(this.version.major>1)throw new e(`layer:service-version-too-new`,`Service version is too new.`,{serviceVersion:this.version.versionString,supportedVersions:`1.x`})}_getTypeKeywords(){return[`IntegratedMeshLayer`]}_validateElevationInfo(e){let t=`Integrated mesh layers`;D(r.getLogger(this),O(t,`absolute-height`,e)),D(r.getLogger(this),E(t,e))}};m([n({type:String,readOnly:!0})],A.prototype,`geometryType`,void 0),m([n({type:[`show`,`hide`]})],A.prototype,`listMode`,void 0),m([n({type:[`IntegratedMeshLayer`]})],A.prototype,`operationalLayerType`,void 0),m([n({json:{read:!1},readOnly:!0})],A.prototype,`type`,void 0),m([n({type:w,readOnly:!0,clonable:!1})],A.prototype,`nodePages`,void 0),m([n({type:[T],readOnly:!0,clonable:!1})],A.prototype,`materialDefinitions`,void 0),m([n({type:[S],readOnly:!0,clonable:!1})],A.prototype,`textureSetDefinitions`,void 0),m([n({type:[C],readOnly:!0,clonable:!1})],A.prototype,`geometryDefinitions`,void 0),m([n({readOnly:!0})],A.prototype,`serviceUpdateTimeStamp`,void 0),m([n({type:k,clonable:e=>e?.clone()??e}),y({origins:[`web-scene`,`portal-item`],type:`resource`,prefix:`modifications`})],A.prototype,`modifications`,void 0),m([l([`web-scene`,`portal-item`],`modifications`)],A.prototype,`readModifications`,null),m([n(p)],A.prototype,`elevationInfo`,null),m([n({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],A.prototype,`path`,void 0),A=m([c(`esri.layers.IntegratedMeshLayer`)],A);var j=A;export{j as default};