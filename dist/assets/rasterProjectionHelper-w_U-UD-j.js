const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projectOperator-B1FLzd6L.js","assets/SimpleGeometryCursor-5wFw2ZZo.js","assets/projectionZScaling-DAQiVc32.js","assets/index-CZ4oMP1N.js","assets/index-CDgdHpAj.css","assets/projectOperator-CfopyaTY.js","assets/geographicTransformationUtils-B-vz8mqT.js"])))=>i.map(i=>d[i]);
import{AS as e,BS as t,BT as n,Bx as r,FS as i,IS as a,JE as o,Lw as s,Mg as c,NS as l,ax as u,bS as d,jS as f,kv as p,px as m,wx as h}from"./index-CZ4oMP1N.js";function g(){if(!D)throw new n(`rasterprojectionhelper-project`,`projection operator is not loaded`)}var _=(e,t,n,r=0)=>{if(n[0]===1)return[0,0];let i=1,a=-1,o=1,s=-1;for(let t=0;t<e.length;t+=2)isNaN(e[t])||(i=i>e[t]?e[t]:i,a=a>e[t]?a:e[t],o=o>e[t+1]?e[t+1]:o,s=s>e[t+1]?s:e[t+1]);let{cols:c,rows:l}=t,u=(a-i)/c/n[0],d=(s-o)/l/n[1],f=2*r,p=0,m=!1,h=[0,0];for(let t=0;t<c-3;t++){for(let n=0;n<l-3;n++){let r=t*l*2+2*n,i=(e[r]+e[r+4]+e[r+4*l]+e[r+4*l+4])/4,a=(e[r+1]+e[r+5]+e[r+4*l+1]+e[r+4*l+5])/4,o=Math.abs((i-e[r+2*l+2])/u),s=Math.abs((a-e[r+2*l+3])/d);if(o+s>p&&(p=o+s,h=[o,s]),f&&p>f){m=!0;break}}if(m)break}return h},v={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},y=new Map,b=new Map,x=500,S=39.37,C=96,w,T,E,D=!1;async function O(){return w||(w=s(),T=await t(()=>import(`./projectOperator-B1FLzd6L.js`),__vite__mapDeps([0,1,2,3,4,5])),E=await t(()=>import(`./geographicTransformationUtils-B-vz8mqT.js`),__vite__mapDeps([6,3,4])),T.isLoaded()||await T.load(),E.isLoaded()||await E.load(),D=!0,w.resolve()),w.promise}function k(e,t,n){if(g(),n){let n=T.execute(e,t);return E.getTransformation(t,e.spatialReference,n)}return E.getTransformation(e.spatialReference,t,e)}function A(e,t,n,r){let i=e.spatialReference;if(!i||!t||i.equals(t))return e;g();let a=n.center,o=new u({xmin:a.x-e.x/2,xmax:a.x+e.x/2,ymin:a.y-e.y/2,ymax:a.y+e.y/2,spatialReference:i}),s=T.execute(o,t,{geographicTransformation:r}),c=q(t);return s==null||c!=null&&s.width>=c?j(e,i,t):{x:s.width,y:s.height}}function j(e,t,n){let i=r(t)/r(n);return{x:e.x*i,y:e.y*i}}function M(e,t,i){let{spatialReference:a}=i;if(!a||!t||a.equals(t))return e;if(a.isGeographic&&t.isGeographic)return j(e,a,t);if(g(),!D)throw new n(`raster-projection-helper:project-dataset-resolution`,`geometry engine is not loaded`);let{x:o,y:s}=e,c=(o+s)/2*r(a),l=1;c>30&&(l=30/c,o*=l,s*=l);let u=o*256/2,d=s*256/2,{x:f,y:m}=i.center,h=[];for(let e=0;e<=256;e++)h.push([f-u,m-d+e*s]);for(let e=1;e<=256;e++)h.push([f-u+e*o,m+d]);for(let e=1;e<=256;e++)h.push([f+u,m+d-e*s]);for(let e=1;e<256;e++)h.push([f+u-e*o,m-d]);h.push(h[0]);let _=new p({rings:[h],spatialReference:a}),v=T.execute(_,t);if(!v)return j(e,a,t);let y=v.extent,b=q(t);if(y==null||b!=null&&y.width>=b)return j(e,a,t);let x=de(v.rings),S=o*s*256*256,C=Math.sqrt(x/S)/l,w={x:y.width/l/256,y:y.height/l/256},E={x:o*C,y:s*C},O=w.x*w.y;return Math.abs(O-E.x*E.y)/O<.1?w:E}function N(e,t){return(typeof e==`number`?e:(e.x+e.y)/2)*r(t)*C*S}function P(e,t){let{pixelSize:n,extent:r}=e;return N(M(n,t,r),t)}function F(e,t=.01){return r(e)?t/r(e):0}function I(e,t,n,r=!0){let i=e.spatialReference;if(i.equals(t))return e;g();let a=T.execute(e,t,{geographicTransformation:n});return r&&a&&L([e],[a],i,t),a}function L(e,t,n,r){let i=J(n,!0),a=J(r,!0),o=F(n,x),s=F(r,x);if(o&&i!=null&&a!=null)for(let n=0;n<e.length;n++){let r=t[n];if(!r)continue;let{x:c}=e[n],{x:l}=r;l>=a[1]-s&&Math.abs(c-i[0])<o?r.x-=a[1]-a[0]:l<=a[0]+s&&Math.abs(c-i[1])<o&&(r.x+=a[1]-a[0])}}function R(e){let{inSR:t,outSR:n,preferPE:r}=e;if(t.equals(n)){let{points:t}=U(e,null);return t}return t.isWebMercator&&n.isWGS84||t.isWGS84&&n.isWebMercator?ee(e):r&&(t.isGeographic||V(t)!=null)?B(e):z(e)}function z(e){let{points:t}=U(e,null),{inSR:n,outSR:r,datumTransformation:i}=e,a=t.map(e=>new m(e[0],e[1],n)),o=T.executeMany(a,r,{geographicTransformation:i});return i&&L(a,o,n,r),o.map(e=>e?[e.x,e.y]:[NaN,NaN])}function B(e){let{inSR:t,outSR:n,datumTransformation:r}=e,o=V(t),{points:s,mask:c}=U(e,o);if(!t.isGeographic){let e=t.wkid?f.coordsys(t.wkid):f.fromString(t.isGeographic?i.PE_TYPE_GEOGCS:i.PE_TYPE_PROJCS,t.wkt2||t.wkt);l.projToGeog(e,s.length,s)}if(r!=null&&r.steps.length){let e,t=179.9955;if(n.isGeographic&&(e=s.map(([e])=>e>t?1:e<-t?-1:0)),r.steps.forEach(e=>{let t=e.wkid?f.geogtran(e.wkid):f.fromString(i.PE_TYPE_GEOGTRAN,e.wkt);a.geogToGeog(t,s.length,s,null,e.isInverse?i.PE_TRANSFORM_2_TO_1:i.PE_TRANSFORM_1_TO_2)}),e)for(let n=0;n<s.length;n++){let r=e[n],i=s[n][0],a=i>t?1:i<-t?-1:0;r&&a&&r!==a&&(s[n][0]=r>0?i+360:i-360)}}if(!n.isGeographic){let e=V(n,!0),t=e!=null&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90];te(s,t);let r=n.wkid?f.coordsys(n.wkid):f.fromString(n.isGeographic?i.PE_TYPE_GEOGCS:i.PE_TYPE_PROJCS,n.wkt2||n.wkt);l.geogToProj(r,s.length,s)}let u=s;if(c&&s.length!==c.length){u=[];for(let e=0,t=0;e<c.length;e++)c[e]?u.push(s[t++]):u.push([NaN,NaN])}return u}function ee(e){let{cols:t,rows:n,xres:r,yres:i,usePixelCenter:a,inSR:o,outSR:s}=e,{xmin:l,ymax:u}=e;a&&(l+=r/2,u-=i/2);let d=[],f=[],p=Math.max(t,n);for(let e=0;e<p;e++){let a=l+r*Math.min(t,e),p=u-i*Math.min(n,e),h=c(new m({x:a,y:p,spatialReference:o}),o,s);e<=t&&d.push(h.x),e<=n&&f.push(h.y)}let h=[];for(let e=0;e<t;e++)for(let t=0;t<n;t++)h.push([d[e],f[t]]);return h}function V(e,t=!1){let n=e.wkid||e.wkt2||e.wkt;if(!n||e.isGeographic)return null;if(n=String(n),y.has(n)){let e=y.get(n);return t?e?.gcs:e?.pcs}let r=e.wkid?f.coordsys(e.wkid):f.fromString(e.isGeographic?i.PE_TYPE_GEOGCS:i.PE_TYPE_PROJCS,e.wkt2||e.wkt),a=H(r,F(e,1e-4)),o=H(r,0,!0);return y.set(n,{pcs:a,gcs:o}),t?o:a}function H(t,n=0,r=!1){let i=e.generate(t),a=r?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!i||!a?.length)return null;let o=!1,s=a.find(e=>e.getInclusive()===1&&e.getKind()===1);if(!s){if(s=a.find(e=>e.getInclusive()===1&&e.getKind()===0),!s)return null;o=!0}let c=r?0:(i.getNorthPoleLocation()===2?1:0)|(i.getSouthPoleLocation()===2?2:0),l=i.isPannableRectangle(),u=s.getCoord();if(o)return{isEnvelope:o,isPannable:l,vertices:u,coef:null,bbox:[u[0][0]-n,u[0][1]-n,u[1][0]+n,u[1][1]+n],poleLocation:c};let d=0,f=[],[p,m]=u[0],[h,g]=u[0];for(let e=0,t=u.length;e<t;e++){d++,d===t&&(d=0);let[n,r]=u[e],[i,a]=u[d];if(a===r)f.push([n,i,r,a,2]);else{let e=(i-n)/(a-r||1e-4),t=n-e*r;r<a?f.push([e,t,r,a,0]):f.push([e,t,a,r,1])}p=p<n?p:n,m=m<r?m:r,h=h>n?h:n,g=g>r?g:r}return{isEnvelope:!1,isPannable:l,vertices:u,coef:f,bbox:[p,m,h,g],poleLocation:c}}function U(e,t){let n=[],{cols:r,rows:i,xres:a,yres:o,usePixelCenter:s}=e,{xmin:c,ymax:l}=e;if(s&&(c+=a/2,l-=o/2),t==null){for(let e=0;e<r;e++)for(let t=0;t<i;t++)n.push([c+a*e,l-o*t]);return{points:n}}let u=new Uint8Array(r*i);if(t.isEnvelope){let{bbox:[e,s,d,f]}=t;for(let p=0,m=0;p<r;p++){let r=c+a*p,h=t.isPannable||r>=e&&r<=d;for(let e=0;e<i;e++,m++){let t=l-o*e;h&&t>=s&&t<=f&&(n.push([r,t]),u[m]=1)}}return{points:n,mask:u}}let d=t.coef,f=[];for(let e=0;e<i;e++){let t=l-o*e,n=[],r=[];for(let e=0;e<d.length;e++){let[i,a,o,s,c]=d[e];if(t===o&&o===s)n.push(i),n.push(a),r.push(2),r.push(2);else if(t>=o&&t<=s){let e=i*t+a;n.push(e),r.push(c)}}let i=n;if(n.length>2){let e=r[0]===2?0:r[0],t=n[0];i=[];for(let a=1;a<r.length;a++)r[a]===2&&a!==r.length-1||(r[a]!==e&&(i.push(e===0?Math.min(t,n[a-1]):Math.max(t,n[a-1])),e=r[a],t=n[a]),a===r.length-1&&i.push(r[a]===0?Math.min(t,n[a]):Math.max(t,n[a])));i.sort((e,t)=>e-t)}else n[0]>n[1]&&(i=[n[1],n[0]]);f.push(i)}for(let e=0,t=0;e<r;e++){let r=c+a*e;for(let e=0;e<i;e++,t++){let i=l-o*e,a=f[e];if(a.length===2)r>=a[0]&&r<=a[1]&&(n.push([r,i]),u[t]=1);else if(a.length>2){let e=!1;for(let t=0;t<a.length;t+=2)if(r>=a[t]&&r<=a[t+1]){e=!0;break}e&&(n.push([r,i]),u[t]=1)}}}return{points:n,mask:u}}function te(e,t){let[n,r]=t;for(let t=0;t<e.length;t++){let i=e[t][1];(i<n||i>r)&&(e[t]=[NaN,NaN])}}function W(e,t){let n=q(e[0].spatialReference);if(e.length<2||n==null||(t??=F(e[0].spatialReference),(e=e.filter(e=>e.width>t)).length===1))return e[0];let{xmin:r,xmax:i,ymin:a,ymax:o}=e[0];for(let t=1;t<e.length;t++){let r=e[t];i=r.xmax+n*t,a=Math.min(a,r.ymin),o=Math.max(o,r.ymax)}return new u({xmin:r,xmax:i,ymin:a,ymax:o,spatialReference:e[0].spatialReference})}function G(e,t,n=null,r=!0){let i=e.spatialReference;if(i.equals(t)||!t)return e;let a=X(e),s=q(i,!0),c=q(t);if(a===0||s==null||c==null){let a=K(e,t,n,r);if(a&&s==null&&c!=null&&Math.abs(a.width-c)<F(t)&&T.isLoaded()){let n=V(i);if(n!=null&&n.poleLocation===0&&e.width<(n.bbox[2]-n.bbox[0])/2)return re(e,t)||a}return a}let l=e.clone().normalize();if(l.length===1&&e.xmax<s&&e.xmax-s/2>F(i)){let{xmin:t,xmax:n}=e;for(let r=0;r<=a;r++){let o=r===0?t:-s/2,c=r===a?n-s*r:s/2;l[r]=new u({xmin:o,xmax:c,ymin:e.ymin,ymax:e.ymax,spatialReference:i})}}let d=l.map(e=>K(e,t,n,r)).filter(o);return d.length===0?null:W(d)}function ne(e,t,n){if(e.type===`extent`){let{xmin:t,ymin:n,xmax:r,ymax:i,spatialReference:a}=e;e=new p({rings:[[[t,i],[r,i],[r,n],[t,n],[t,i]]],spatialReference:a})}return e.spatialReference.equals(t)?e:(g(),T.execute(e,t,{geographicTransformation:n}))}function re(e,t){let n=q(t);if(n==null)return null;let{xmin:r,ymin:i,xmax:a,ymax:o}=e,s=e.spatialReference,c=new p({spatialReference:s,rings:[[[r,i],[a,i],[a,o],[r,o],[r,i]]]}),l=T.execute(c,t);if(l.rings.length!==2||!l.rings[0].length||!l.rings[1].length)return null;let{rings:d}=l,f=F(s),m=new u({spatialReference:t});for(let e=0;e<2;e++){r=a=d[e][0][0],i=o=d[e][0][1];for(let t=0;t<d[e].length;t++)r=r>d[e][t][0]?d[e][t][0]:r,a=a<d[e][t][0]?d[e][t][0]:a,i=i>d[e][t][1]?d[e][t][1]:i,o=o<d[e][t][1]?d[e][t][1]:o;if(e===0)m.ymin=i,m.ymax=o,m.xmin=r,m.xmax=a;else if(m.ymin=Math.min(m.ymin,i),m.ymax=Math.max(m.ymax,o),Math.abs(a-n/2)<f)m.xmin=r,m.xmax+=n;else{if(!(Math.abs(r+n/2)<f))return null;m.xmax=a+n}}return m}function K(e,t,n,r=!0,i=!0){let a=e.spatialReference;if(a.equals(t)||!t)return e;g();let o=T.execute(e,t,{geographicTransformation:n});if(i&&t.isWebMercator&&o&&(o.ymax=Math.min(20037508.342787,o.ymax),o.ymin=Math.max(-20037508.342787,o.ymin),o.ymin>=o.ymax))return null;if(!r||!o)return o;let s=J(a,!0),c=J(t,!0);if(s==null||c==null)return o;let l=F(a,.001),u=F(a,x),d=F(t,.001);if(Math.abs(o.xmin-c[0])<d&&Math.abs(o.xmax-c[1])<d){let r=Math.abs(e.xmin-s[0]),i=Math.abs(s[1]-e.xmax);if(r<l&&i>u){o.xmin=c[0];let r=[];r.push(new m(e.xmax,e.ymin,a)),r.push(new m(e.xmax,(e.ymin+e.ymax)/2,a)),r.push(new m(e.xmax,e.ymax,a));let i=r.map(e=>I(e,t,n)).filter(e=>!isNaN(e?.x)).map(e=>e.x);o.xmax=Math.max.apply(null,i)}if(i<l&&r>u){o.xmax=c[1];let r=[];r.push(new m(e.xmin,e.ymin,a)),r.push(new m(e.xmin,(e.ymin+e.ymax)/2,a)),r.push(new m(e.xmin,e.ymax,a));let i=r.map(e=>I(e,t,n)).filter(e=>!isNaN(e?.x)).map(e=>e.x);o.xmin=Math.min.apply(null,i)}}else{let e=F(t,.001);Math.abs(o.xmin-c[0])<e&&(o.xmin=c[0]),Math.abs(o.xmax-c[1])<e&&(o.xmax=c[1])}return o}function q(e,t=!1){if(!e)return null;let n=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*n:e.wkid&&e.isGeographic?360:2*v[e.wkid]||null}function J(e,t=!1){if(e.isGeographic)return[-180,180];let n=q(e,t);return n==null?null:[-n/2,n/2]}function Y(e,t,n,r){let i=(e-t)/n;return i-Math.floor(i)===0?r&&--i:i=Math.floor(i),i}function X(e,t=!1){let n=q(e.spatialReference);if(n==null)return 0;let r=t?0:-(n/2),i=F(e.spatialReference),a=!t&&Math.abs(e.xmax-n/2)<i?n/2:e.xmax,o=!t&&Math.abs(e.xmin+n/2)<i?-n/2:e.xmin;return Y(a,r,n,!0)-Y(o,r,n,!1)}function ie(e){let t=e.storageInfo.origin.x,n=q(e.spatialReference,!0);if(n==null)return{originX:t,halfWorldWidth:null,pyramidsInfo:null};let r=n/2,{nativePixelSize:i,storageInfo:a,extent:o}=e,{maximumPyramidLevel:s,blockWidth:c,pyramidScalingFactor:l}=a,u=i.x,d=[],f=e.transform!=null&&e.transform.type===`gcs-shift`,p=t+(f?0:r),m=f?n-t:r-t;for(let e=0;e<=s;e++){let e=(o.xmax-t)/u/c,n=e-Math.floor(e)===0?e:Math.ceil(e),r=m/u/c,i=r-Math.floor(r)===0?r:Math.ceil(r),a=Math.floor(p/u/c),s=Math.round(p/u)%c,f=(c-Math.round(m/u)%c)%c;d.push({resolutionX:u,blockWidth:c,datasetColumnCount:n,worldColumnCountFromOrigin:i,leftMargin:s,rightPadding:f,originColumnOffset:a}),u*=l}return{originX:t,halfWorldWidth:r,pyramidsInfo:d,hasGCSSShiftTransform:f}}function ae(e){if(!e||e.isGeographic)return e;let t=String(e.wkid||e.wkt2||e.wkt),n;return b.has(t)?n=b.get(t):(n=(e.wkid?f.coordsys(e.wkid):f.fromString(i.PE_TYPE_PROJCS,e.wkt2||e.wkt)).getGeogcs().getCode(),b.set(t,n)),new h({wkid:n})}function oe(e){let t=e.isAdaptive&&e.spacing==null,n=e.spacing||[32,32],r=Z(e),i={cols:r.size[0]+1,rows:r.size[1]+1},a=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2,o=r.outofBoundPointCount===r.offsets.length/2||t&&a?[0,0]:_(r.offsets,i,n,4),s=(o[0]+o[1])/2,c=e.projectedExtent.spatialReference,l=e.srcBufferExtent.spatialReference;if(t&&(a||s>4)&&(c.isGeographic||V(c),n=[4,4],r=Z({...e,spacing:n}),i={cols:r.size[0]+1,rows:r.size[1]+1},o=_(r.offsets,i,n,4)),r.error=o,n[0]>1&&(r.coefficients=Q(r.offsets,i,a)),e.includeGCSGrid&&!c.isGeographic&&!c.isWebMercator)if(l.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:n};else{let t=V(c);if(t!=null&&!t.isEnvelope){let t=ae(c),o=G(e.projectedExtent,t),{offsets:s}=Z({...e,srcBufferExtent:o,spacing:n}),l=Q(s,i,a);r.gcsGrid={offsets:s,coefficients:l,spacing:n}}}return r}function Z(e){let{projectedExtent:t,srcBufferExtent:n,pixelSize:r,datumTransformation:i,rasterTransform:a}=e,o=t.spatialReference,s=n.spatialReference;g();let{xmin:c,ymin:l,xmax:u,ymax:d}=t,f=q(s),p=f!=null&&(e.hasWrapAround||a?.type===`gcs-shift`),h=e.spacing||[32,32],_=h[0]*r.x,v=h[1]*r.y,y=h[0]===1,b=Math.ceil((u-c)/_-.1/h[0])+(y?0:1),S=Math.ceil((d-l)/v-.1/h[1])+(y?0:1),C=R({cols:b,rows:S,xmin:c,ymax:d,xres:_,yres:v,inSR:o,outSR:s,datumTransformation:i,preferPE:h[0]<=4,usePixelCenter:y}),w=[],T,E=0,D=y?-1:NaN,{xmin:O,xmax:k,ymax:A,width:j,height:M}=n,N=F(s,x),P=f!=null&&O>0&&k>f/2,I=V(o),L=I!=null&&I.poleLocation>0;for(let e=0;e<b;e++){let t=[];for(let n=0;n<S;n++){let r=C[e*S+n];if(p&&r[0]>k&&r[0]>f/2-N?r[0]-=f:p&&e===0&&r[0]<0&&P&&!a&&(r[0]+=f),!r||isNaN(r[0])||isNaN(r[1]))w.push(D),w.push(D),t.push(null),E++;else{if(a){let e=a.inverseTransform(new m({x:r[0],y:r[1],spatialReference:s}));r=[e.x,e.y]}t.push(r),e>0&&p&&T[n]&&r[0]<T[n][0]&&(r[0]+=f,L&&r[0]>k&&r[0]>f&&(r[0]-=f)),w.push((r[0]-O)/j),w.push((A-r[1])/M)}}T=t}return{offsets:w,error:null,coefficients:null,outofBoundPointCount:E,spacing:h,size:y?[b,S]:[b-1,S-1]}}function Q(e,t,n){let{cols:r,rows:i}=t,a=new Float32Array((r-1)*(i-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),s=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let t=0;t<r-1;t++){for(let n=0;n<i-1;n++){let c=t*i*2+2*n,l=e[c],u=e[c+1],d=e[c+2],f=e[c+3];c+=2*i;let p=e[c],m=e[c+1],h=e[c+2],g=e[c+3],_=0,v=12*(n*(r-1)+t);for(let e=0;e<3;e++)a[v++]=o[_++]*l+o[_++]*d+o[_++]*h;_=0;for(let e=0;e<3;e++)a[v++]=o[_++]*u+o[_++]*f+o[_++]*g;_=0;for(let e=0;e<3;e++)a[v++]=s[_++]*l+s[_++]*p+s[_++]*h;_=0;for(let e=0;e<3;e++)a[v++]=s[_++]*u+s[_++]*m+s[_++]*g}if(n)for(let e=0;e<a.length;e++)isNaN(a[e])&&(a[e]=-1)}return a}function se(e,t){let n=e.clone().normalize();return n.length===1?n[0]:W(n,t)}function ce(e){let{spatialReference:t}=e,n=d(t);if(!n)return e;let[r,i]=n.valid,a=i-r,o=0;if(e.xmin<r){let t=r-e.xmin;o=Math.ceil(t/a)}else if(e.xmin>i){let t=e.xmin-i;o=-Math.ceil(t/a)}return new u({spatialReference:e.spatialReference,xmin:e.xmin+o*a,ymin:e.ymin,xmax:e.xmax+o*a,ymax:e.ymax})}function le(e,t,n){let{storageInfo:i,pixelSize:a}=t,o=0,s=!1,{pyramidResolutions:c}=i,l=i.tileInfo.format?.toLowerCase()===`mixed`?Math.max(1,Math.min(3,i.tileInfo.dpi/96)):1,u=(e.x+e.y)/2/l;if(c!=null&&c.length){let e=c[c.length-1],i=(e.x+e.y)/2,l=(a.x+a.y)/2;if(u<=l)o=0;else if(u>=i)o=c.length,s=u/i>8;else{let e,t=l;for(let r=1;r<=c.length;r++){if(e=(c[r-1].x+c[r-1].y)/2,u<=e){u===e?o=r:n===`down`?(o=r-1,s=u/t>8):o=n===`up`||u-t>e-u||u/t>2?r:r-1;break}t=e}}let d=o===0?a:c[o-1];return s&&Math.min(d.x,d.y)*r(t.spatialReference)>19567&&(s=!1),{pyramidLevel:o,pyramidResolution:new m({x:d.x,y:d.y,spatialReference:t.spatialReference}),excessiveReading:s}}let d=Math.log(e.x/a.x)/Math.LN2,f=Math.log(e.y/a.y)/Math.LN2,p=t.storageInfo.maximumPyramidLevel||0;o=n===`down`?Math.floor(Math.min(d,f)):n===`up`?Math.ceil(Math.max(d,f)):Math.round((d+f)/2),o<0?o=0:o>p&&(s=o>p+3,o=p);let h=2**o;return{pyramidLevel:o,pyramidResolution:new m({x:h*t.nativePixelSize.x,y:h*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:s}}function $(e,t,n=!1){let{pixelSize:r,extent:i}=e,a=k(i,t,!1),o=G(se(i,(r.x+r.y)/16),t,a);return!o||n||X(o)===0?o:K(i,t,a)}function ue(e,t,n){let r=n?.tileSize??512,i=n?.alignGlobalDatasetWithAGOL??!0,a=!!n?.limitToSrcResolution,{extent:o,spatialReference:s,pixelSize:c}=e,l=M(c,t,o);if(l==null)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};let u=(l.x+l.y)/2,d=N(u,t),f=t.isGeographic?256/r*295828763.7958547:256/r*591657527.591555,p=e.dataType===`vector-magdir`||e.dataType===`vector-uv`,m=$(e,t,!0),g=Math.min(Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),Math.ceil(Math.log(f/2/d)/Math.LN2));if(!p&&m&&i&&(t.isGeographic||t.isWebMercator)){let n=q(t);if(p=X(m)>0||n!=null&&m.width>n/4,!p&&n!=null){let t=-1;if(g<3)t=2**g*u*r;else if(e.storageInfo){let{maximumPyramidLevel:n=0,pyramidScalingFactor:i=2}=e.storageInfo;t=i**n*u*r}let i=Math.ceil(n/t);p=i===1||i===2&&n/2-m.xmax<t}}let _,v=d,y=1.001,b=Math.min(2,Math.max(1.414,e.storageInfo?.pyramidScalingFactor||2));if(p){v=f;let n=t.isGeographic?1341104507446289e-21:.29858214164761665,r=N(n,t),i=t.isGeographic?4326:3857;_=M({x:n,y:n},s,$(e,new h({wkid:i}),!0)),_.x*=v/r,_.y*=v/r}else{_={x:c.x,y:c.y};let e=0;for(;v<f*(y/2)&&e<g;)e++,v*=b,_.x*=b,_.y*=b;Math.max(v,f)/Math.min(v,f)<=y&&(v=f)}let x=[v],S=[{x:_.x,y:_.y}],C=Math.min(70.5310735,d)/y;for(;v>=C;)v/=b,_.x/=b,_.y/=b,x.push(v),S.push({x:_.x,y:_.y});if(a){let e=.001*c.x,t=S.findIndex(t=>t.x>=c.x-e&&t.x<=c.x+e);t>-1?(S.length=t+1,x.length=t+1):(t=S.findIndex(t=>t.x<=c.x+e),t>0&&(S.length=t,x.length=t))}return{projectedPixelSize:l,scales:x,srcResolutions:S,isCustomTilingScheme:!p}}function de(e){let t=0;for(let n of e){let e=n.length,r=n[0][0]*(n[1][1]-n[e-2][1]);for(let t=1;t<e-1;t++)r+=n[t][0]*(n[t+1][1]-n[t-1][1]);t+=r/2}return Math.abs(t)}export{ne as a,le as c,ue as d,X as f,k as h,P as i,ie as l,$ as m,A as n,I as o,oe as p,G as r,ce as s,q as t,O as u};