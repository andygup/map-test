import{$S as e,A as t,BT as n,DT as r,Dh as i,Ha as a,Jw as o,L as s,M as c,OT as l,Q_ as u,Z_ as d,ca as f,gD as p,gw as m,jT as h,ji as g,ma as _,pa as v,qm as y,uE as b}from"./index-ByaFsVj4.js";import{n as x}from"./SceneService-sH-A36GQ.js";import{i as S,n as C,r as w,t as T}from"./I3SLayerDefinitions-BJzd7L2I.js";import"./originUtils-BJaUzj5W.js";import"./resourceUtils-C04-w-fM.js";import"./resourceUtils-DYI0vrsK.js";import"./saveUtils-BB0-rUbr.js";import{o as E,p as D,y as O}from"./elevationInfoUtils-CyQsBf6_.js";import{t as k}from"./SceneModifications-LoJwZXk2.js";var A=class extends x(v(s(c(t(a(f(_(m(i))))))))){constructor(...e){super(...e),this.geometryType=`mesh`,this.operationalLayerType=`IntegratedMeshLayer`,this.type=`integrated-mesh`,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile=`mesh-pyramids`,this.modifications=null,this.path=null,this.definitionExpression=null}initialize(){this.addHandles(u(()=>this.modifications,`after-changes`,()=>this.modifications=this.modifications,d))}normalizeCtorArgs(e,t){return typeof e==`string`?{url:e,...t}:e}readModifications(t,n,r){this._modificationsSource={url:e(t,r),context:r}}set elevationInfo(e){e!=null&&e.mode!==`absolute-height`||this._set(`elevationInfo`,e),this._validateElevationInfo(e)}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){let t=e?.signal;try{await this.loadFromPortal({supportedTypes:[`Scene Service`]},e)}catch(e){o(e)}if(await this._fetchService(t),this._modificationsSource!=null){let t=await k.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin(`modifications`,t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(this._modificationsSource!=null)return this.load().then(()=>{},()=>{})}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:`integrated-mesh`},e)}async save(){return this._debouncedSaveOperations(0,{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:`integrated-mesh`})}validateLayer(e){if(e.layerType&&e.layerType!==`IntegratedMesh`)throw new n(`integrated-mesh-layer:layer-type-not-supported`,`IntegratedMeshLayer does not support this layer type`,{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new n(`layer:service-version-not-supported`,`Service version is not supported.`,{serviceVersion:this.version.versionString,supportedVersions:`1.x`});if(this.version.major>1)throw new n(`layer:service-version-too-new`,`Service version is too new.`,{serviceVersion:this.version.versionString,supportedVersions:`1.x`})}_getTypeKeywords(){return[`IntegratedMeshLayer`]}_validateElevationInfo(e){let t=`Integrated mesh layers`;D(b.getLogger(this),O(t,`absolute-height`,e)),D(b.getLogger(this),E(t,e))}};p([r({type:String,readOnly:!0})],A.prototype,`geometryType`,void 0),p([r({type:[`show`,`hide`]})],A.prototype,`listMode`,void 0),p([r({type:[`IntegratedMeshLayer`]})],A.prototype,`operationalLayerType`,void 0),p([r({json:{read:!1},readOnly:!0})],A.prototype,`type`,void 0),p([r({type:w,readOnly:!0,clonable:!1})],A.prototype,`nodePages`,void 0),p([r({type:[T],readOnly:!0,clonable:!1})],A.prototype,`materialDefinitions`,void 0),p([r({type:[S],readOnly:!0,clonable:!1})],A.prototype,`textureSetDefinitions`,void 0),p([r({type:[C],readOnly:!0,clonable:!1})],A.prototype,`geometryDefinitions`,void 0),p([r({readOnly:!0})],A.prototype,`serviceUpdateTimeStamp`,void 0),p([r({type:k,clonable:e=>e?.clone()??e}),y({origins:[`web-scene`,`portal-item`],type:`resource`,prefix:`modifications`})],A.prototype,`modifications`,void 0),p([h([`web-scene`,`portal-item`],`modifications`)],A.prototype,`readModifications`,null),p([r(g)],A.prototype,`elevationInfo`,null),p([r({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],A.prototype,`path`,void 0),A=p([l(`esri.layers.IntegratedMeshLayer`)],A);var j=A;export{j as default};