import{Bm as e,Cl as t,Ml as n,Nl as r,Nm as i,Ol as a,Rf as o,Tl as s,Um as c,Zb as l,al as u,c_ as d,dl as f,f_ as p,jl as m,kl as ee,ll as te,nw as ne,ol as h,rl as g,uE as re,u_ as _,yl as v}from"./index-CzMixifc.js";import{C as ie,S as ae,a as oe,b as y,c as se,d as ce,g as b,j as x,o as le,r as S,s as ue,t as C,v as de,y as w}from"./plane--nqwMDYx.js";import{t as T}from"./vectorStacks-BQiry9fn.js";import{t as E}from"./ObjectStack-DiVLRoBj.js";import{o as fe}from"./ray-XqUMyuyU.js";import{d as pe,s as me,t as D}from"./lineSegment-WEn1ku7V.js";var O=()=>re.getLogger(`esri.views.3d.support.geometryUtils.boundedPlane`);function k(e=J){return{plane:w(e.plane),origin:p(e.origin),basis1:p(e.basis1),basis2:p(e.basis2)}}function he(e,t,n){let r=je.get();return r.origin=e,r.basis1=t,r.basis2=n,r.plane=de(0,0,0,0),M(r),r}function A(e,t=k()){return j(e.origin,e.basis1,e.basis2,t)}function ge(e,t){n(t.origin,e.origin),n(t.basis1,e.basis1),n(t.basis2,e.basis2),ie(t.plane,e.plane)}function j(e,t,r,i=k()){return n(i.origin,e),n(i.basis1,t),n(i.basis2,r),M(i),ke(i,`fromValues()`),i}function M(e){S(e.basis2,e.basis1,e.origin,e.plane)}function N(e,n,i){e!==i&&A(e,i);let a=t(T.get(),U(e),n);return r(i.origin,i.origin,a),i.plane[3]-=n,i}function _e(e,t,n){return P(t,n),N(n,H(e,e.origin),n),n}function ve(e,t){let n=e.basis1[0],r=e.basis2[1],[i,a]=e.origin;return l(i-n,a-r,i+n,a+r,t)}function P(e,t=k()){let n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return a(t.origin,e[0]+n,e[1]+r,0),a(t.basis1,n,0,0),a(t.basis2,0,r,0),ae(0,0,1,0,t.plane),t}function F(e,t,n){return!!oe(e.plane,t,n)&&W(e,n)}function ye(e,n,i){if(F(e,n,i))return i;let a=I(e,n,T.get());return r(i,n.origin,t(T.get(),n.direction,ee(n.origin,a)/m(n.direction))),i}function I(e,t,r){let i=Y.get();q(e,t,i,Y.get());let a=1/0;for(let o of Z){let s=K(e,o,X.get()),c=T.get();if(le(i,s,c)){let e=te(T.get(),t.origin,c),i=Math.abs(ne(f(t.direction,e)));i<a&&(a=i,n(r,c))}}return a===1/0?L(e,t,r):r}function be(e,t){return(t-e)/t}function L(e,t,r){if(F(e,t,r))return r;let i=Y.get(),a=Y.get();q(e,t,i,a);let o=1/0;for(let s of Z){let c=K(e,s,X.get()),l=T.get();if(ue(i,c,l)){let e=fe(t,l);if(!se(a,l))continue;e<o&&(o=e,n(r,l))}}return B(e,t.origin)<o&&R(e,t.origin,r),r}function R(e,t,n){let i=ce(e.plane,t,T.get()),a=D(G(e,e.basis1),i,-1,1,T.get()),o=D(G(e,e.basis2),i,-1,1,T.get());return v(n,r(T.get(),a,o),e.origin),n}function z(e,t,n){let{origin:r,basis1:i,basis2:o}=e,s=v(T.get(),t,r),c=x(i,s),l=x(o,s),u=x(U(e),s);return a(n,c,l,u)}function B(e,t){let n=z(e,t,T.get()),{basis1:r,basis2:i}=e,a=m(r),o=m(i),s=Math.max(Math.abs(n[0])-a,0),c=Math.max(Math.abs(n[1])-o,0),l=n[2];return s*s+c*c+l*l}function V(e,t){return Math.sqrt(B(e,t))}function xe(e,t){let n=-1/0;for(let r of Z){let i=K(e,r,X.get()),a=me(i,t);a>n&&(n=a)}return Math.sqrt(n)}function Se(e,t){return b(e.plane,t)>0&&W(e,t)}function Ce(e,t,n,r){return Oe(e,n,r)}function H(e,t){let n=-e.plane[3];return x(U(e),t)-n}function we(e,n,i,a){let o=H(e,n),s=t(Ae,U(e),i-o);return r(a,n,s),a}function Te(e,t){return h(e.basis1,t.basis1)&&h(e.basis2,t.basis2)&&h(e.origin,t.origin)}function Ee(e,t,n){return e!==n&&A(e,n),i(Q,t),c(Q,Q),u(n.basis1,e.basis1,Q),u(n.basis2,e.basis2,Q),u(y(n.plane),y(e.plane),Q),u(n.origin,e.origin,t),C(n.plane,n.plane,n.origin),n}function De(t,n,r,i){return t!==i&&A(t,i),e($,n,r),u(i.basis1,t.basis1,$),u(i.basis2,t.basis2,$),M(i),i}function U(e){return y(e.plane)}function Oe(e,t,r){switch(t){case 0:n(r,e.basis1),g(r,r);break;case 1:n(r,e.basis2),g(r,r);break;case 2:n(r,U(e))}return r}function W(e,t){let n=v(T.get(),t,e.origin),r=s(e.basis1),i=s(e.basis2),a=f(e.basis1,n),o=f(e.basis2,n);return-a-r<0&&a-r<0&&-o-i<0&&o-i<0}function G(e,t){let r=X.get();return n(r.origin,e.origin),n(r.vector,t),r}function K(e,n,i){let{basis1:a,basis2:o,origin:s}=e,c=t(T.get(),a,n.origin[0]),l=t(T.get(),o,n.origin[1]);r(i.origin,c,l),r(i.origin,i.origin,s);let u=t(T.get(),a,n.direction[0]),d=t(T.get(),o,n.direction[1]);return t(i.vector,r(u,u,d),2),i}function ke(e,t){Math.abs(f(e.basis1,e.basis2)/(m(e.basis1)*m(e.basis2)))>1e-6&&O().warn(t,`Provided basis vectors are not perpendicular`),Math.abs(f(e.basis1,U(e)))>1e-6&&O().warn(t,`Basis vectors and plane normal are not perpendicular`),Math.abs(-f(U(e),e.origin)-e.plane[3])>1e-6&&O().warn(t,`Plane offset is not consistent with plane origin`)}function q(e,t,n,r){let i=U(e);S(i,t.direction,t.origin,n),S(y(n),i,t.origin,r)}var J={plane:w(),origin:_(0,0,0),basis1:_(1,0,0),basis2:_(0,1,0)},Y=new E(w),X=new E(pe),Ae=d(),je=new E(()=>k()),Z=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Q=o(),$=o(),Me=Object.freeze(Object.defineProperty({__proto__:null,altitudeAt:H,axisAt:Ce,cameraFrustumCoverage:be,closestPoint:L,closestPointOnSilhouette:I,copy:A,copyWithoutVerify:ge,create:k,distance:V,distance2:B,distanceToSilhouette:xe,elevate:N,equals:Te,extrusionContainsPoint:Se,fromAABoundingRect:P,fromValues:j,getExtent:ve,intersectRay:F,intersectRayClosestSilhouette:ye,normal:U,projectPoint:R,projectPointLocal:z,rotate:De,setAltitudeAt:we,setExtent:_e,transform:Ee,up:J,updateUnboundedPlane:M,wrap:he},Symbol.toStringTag,{value:`Module`}));export{A as a,M as i,k as n,Me as o,j as r,V as s,P as t};