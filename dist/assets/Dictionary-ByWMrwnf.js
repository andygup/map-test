import{$p as e,Cx as t,I_ as n,Ov as r,Qp as i,U_ as a,Vv as o,Xp as s,Yp as c,Zp as l,Zv as u,_E as ee,_n as te,ax as ne,em as re,gn as ie,kv as d,pn as ae,px as f,rC as oe,tm as p,vn as m,vv as se,wn as h,wx as ce,zw as le}from"./index-CZ4oMP1N.js";import{t as g}from"./ImmutableArray-C3KNQCVd.js";import{f as ue,t as de}from"./shared-CBxUlSgW.js";import{n as fe,r as pe}from"./number-bp6QQFrm.js";var _=class{},v=class{constructor(){}};function y(e,t,n){if(e instanceof v&&!(e instanceof b)){let r=new b;return r.fn=e,r.parameterEvaluator=n,r.context=t,r}return e}var me=class extends v{constructor(e){super(),this.fn=e}createFunction(e){return(...t)=>this.fn(e,{preparsed:!0,arguments:t})}call(e,t){return this.fn(e,t)}marshalledCall(e,t,n,r){return r(e,t,(t,i,a)=>{a=a.map(t=>t instanceof v&&!(t instanceof b)?y(t,e,r):t);let o=this.call(n,{args:a});return le(o)?o.then(e=>y(e,n,r)):o})}},b=class extends v{constructor(){super(...arguments),this.fn=null,this.context=null}createFunction(e){return this.fn.createFunction(this.context)}call(e,t){return this.fn.marshalledCall(e,t,this.context,this.parameterEvaluator)}marshalledCall(e,t,n){return this.fn.marshalledCall(e,t,this.context,this.parameterEvaluator)}},x=class e extends g{constructor(e,t,n,r,i,a){super(e),this._lazyPt=[],this._hasZ=!1,this._hasM=!1,this._spRef=t,this._hasZ=n,this._hasM=r,this._cacheId=i,this._partId=a}get(e){if(this._lazyPt[e]===void 0){let t=this._elements[e];if(t===void 0)return;let n=new f(t[0],t[1],this._spRef);this._hasZ&&(n.z=t[2]),this._hasM&&(n.m=this._hasZ?t[3]:t[2]),n.cache._arcadeCacheId=this._cacheId.toString()+`-`+this._partId.toString()+`-`+e.toString(),this._lazyPt[e]=n}return this._lazyPt[e]}equalityTest(t){return t===this||t!==null&&t instanceof e!=0&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()+`-`+this._partId.toString()}},he=class e extends g{constructor(e,t,n,r,i){super(e),this._lazyPath=[],this._hasZ=!1,this._hasM=!1,this._hasZ=n,this._hasM=r,this._spRef=t,this._cacheId=i}get(e){if(this._lazyPath[e]===void 0){let t=this._elements[e];if(t===void 0)return;this._lazyPath[e]=new x(t,this._spRef,this._hasZ,this._hasM,this._cacheId,e)}return this._lazyPath[e]}equalityTest(t){return t===this||t!==null&&t instanceof e!=0&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()}},ge=class{constructor(e){this.value=e}},_e=class{constructor(e){this.value=e}},S={type:`VOID`},ve=Symbol(`BREAK`),ye=Symbol(`CONTINUE`);function C(e,t,n){return t===``||t==null||t===n||t===n?e:e=e.split(t).join(n)}function w(e){return e instanceof v}function T(e){return e instanceof _}function E(e){return!!s(e)||!!i(e)||!!I(e)||!!L(e)||!!R(e)||!!p(e)||e===null||e===S}function be(e,t){return e===void 0?t:e}function xe(t){return t==null?``:e(t)||F(t)?`Array`:I(t)?`Date`:R(t)?`Time`:L(t)?`DateOnly`:s(t)?`String`:p(t)?`Boolean`:i(t)?`Number`:t?.declaredClass===`esri.arcade.Attachment`?`Attachment`:t?.declaredClass===`esri.arcade.Portal`?`Portal`:t?.declaredClass===`esri.arcade.Dictionary`?`Dictionary`:P(t)?`KnowledgeGraph`:t instanceof _?`Module`:O(t)?`Feature`:t instanceof f?`Point`:t instanceof d?`Polygon`:t instanceof r?`Polyline`:t instanceof u?`Multipoint`:t instanceof ne?`Extent`:w(t)?`Function`:j(t)?`FeatureSet`:N(t)?`FeatureSetCollection`:k(t)?`Voxel`:A(t)?`Pixel`:t===S?``:typeof t==`number`&&isNaN(t)?`Number`:`Unrecognized Type`}function Se(e){return e===S}function D(e){return e instanceof t}function O(e){return e?.arcadeDeclaredClass===`esri.arcade.Feature`}function k(e){return e?.arcadeDeclaredClass===`esri.arcade.Voxel`}function A(e){return e?.arcadeDeclaredClass===`esri.arcade.Pixel`}function j(e){return e?.declaredRootClass===`esri.arcade.featureset.support.FeatureSet`}function M(e){return e?.declaredClass===`esri.arcade.Dictionary`}function Ce(e){return M(e)||O(e)||k(e)||A(e)}function N(e){return e?.declaredRootClass===`esri.arcade.featureSetCollection`}function P(e){return e?.declaredClass===`esri.rest.knowledgeGraph.KnowledgeGraph`}function F(e){return e instanceof g}function I(e){return e instanceof m}function L(e){return e instanceof ie}function R(e){return e instanceof ae}function z(e){return typeof e==`object`&&!!e}function we(e,t,n,r,i){if(e.length<t||e.length>n)throw new h(r,`WrongNumberOfParameters`,i)}function Te(e){return e==null||Se(e)||e===``}function Ee(e){return e<0?-Math.round(-e):Math.round(e)}function B(e,t){return isNaN(e)||t==null||t===``?e.toString():(t=C(t,`‰`,``),t=C(t,`¤`,``),fe(e,{pattern:t}))}function V(e,t){return t==null||t===``?e.toISOString(!0):e.toFormat(De(t),{locale:a(),numberingSystem:`latn`})}function De(e,t=!1){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,`[$&]`);let n=``;for(let r of e.match(/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|Z{1,5}|.)/g)||[])switch(r){case`D`:n+=`d`;break;case`DD`:n+=`dd`;break;case`DDD`:n+=`o`;break;case`d`:n+=`c`;break;case`ddd`:n+=`ccc`;break;case`dddd`:n+=`cccc`;break;case`M`:n+=`L`;break;case`MM`:n+=`LL`;break;case`MMM`:n+=`LLL`;break;case`MMMM`:n+=`LLLL`;break;case`YY`:n+=`yy`;break;case`Y`:case`YYYY`:n+=`yyyy`;break;case`Q`:n+=`q`;break;case`Z`:n+=`Z`;break;case`ZZ`:n+=`ZZ`;break;case`ZZZ`:n+=`ZZZ`;break;case`ZZZZ`:n+=t?`[ZZZZ]`:`ZZZZ`;break;case`ZZZZZ`:n+=t?`[ZZZZZ]`:`ZZZZZ`;break;case`S`:n+=`'S'`;break;case`SS`:n+=`'SS'`;break;case`SSS`:n+=`u`;break;case`A`:case`a`:n+=`a`;break;case`m`:case`mm`:case`h`:case`hh`:case`H`:case`HH`:case`s`:case`ss`:case`X`:case`x`:n+=r;break;default:r.length>=2&&r.startsWith(`[`)&&r.endsWith(`]`)?n+=`'${r.slice(1,-1)}'`:n+=`'${r}'`}return n}function H(e,t,n){switch(n){case`>`:return e>t;case`<`:return e<t;case`>=`:return e>=t;case`<=`:return e<=t}return!1}function Oe(e,t,n){if(e===null){if(t===null||t===S)return H(null,null,n);if(i(t))return H(0,t,n);if(s(t)||p(t))return H(0,K(t),n);if(I(t))return H(0,t.toNumber(),n);if(R(t)||L(t))return H(e,t.toNumber(),n)}if(e===S){if(t===null||t===S)return H(null,null,n);if(i(t))return H(0,t,n);if(s(t)||p(t))return H(0,K(t),n);if(I(t))return H(0,t.toNumber(),n);if(R(t)||L(t))return H(e,t.toNumber(),n)}else if(i(e)){if(i(t))return H(e,t,n);if(p(t))return H(e,K(t),n);if(t===null||t===S)return H(e,0,n);if(s(t))return H(e,K(t),n);if(I(t)||R(t)||L(t))return H(e,t.toNumber(),n)}else if(s(e)){if(s(t))return H(U(e),U(t),n);if(I(t)||R(t)||L(t))return H(K(e),t.toNumber(),n);if(i(t))return H(K(e),t,n);if(t===null||t===S)return H(K(e),0,n);if(p(t))return H(K(e),K(t),n)}else if(I(e)){if(I(t))return e.timeZone!==t.timeZone&&(e.isUnknownTimeZone?e=m.arcadeDateAndZoneToArcadeDate(e,t.timeZone):t.isUnknownTimeZone&&(t=m.arcadeDateAndZoneToArcadeDate(t,e.timeZone))),H(e.toNumber(),t.toNumber(),n);if(t===null||t===S)return H(e.toNumber(),0,n);if(i(t))return H(e.toNumber(),t,n);if(p(t)||s(t))return H(e.toNumber(),K(t),n);if(R(t))throw new h(null,`CannotCompareDateAndTime`,null);if(L(t))return H(e.toNumber(),t.toNumber(),n)}else if(p(e)){if(p(t))return H(e,t,n);if(i(t))return H(K(e),K(t),n);if(I(t)||R(t)||L(t))return H(K(e),t.toNumber(),n);if(t===null||t===S)return H(K(e),0,n);if(s(t))return H(K(e),K(t),n)}else if(L(e)){if(I(t))return H(e.toNumber(),t.toNumber(),n);if(t===null||t===S)return H(e.toNumber(),0,n);if(i(t))return H(e.toNumber(),t,n);if(p(t)||s(t))return H(e.toNumber(),K(t),n);if(R(t))throw new h(null,`CannotCompareDateAndTime`,null);if(L(t))return H(e.toNumber(),t.toNumber(),n)}else if(R(e)){if(I(t))throw new h(null,`CannotCompareDateAndTime`,null);if(t===null||t===S)return H(e.toNumber(),0,n);if(i(t))return H(e.toNumber(),t,n);if(p(t)||s(t))return H(e.toNumber(),K(t),n);if(R(t))return H(e.toNumber(),t.toNumber(),n);if(L(t))throw new h(null,`CannotCompareDateAndTime`,null)}return!!ke(e,t)&&(n===`<=`||n===`>=`)}function ke(e,t){if(e===t||e===null&&t===S||t===null&&e===S)return!0;if(I(e)&&I(t)||R(e)&&R(t)||L(e)&&L(t))return e.equals(t);if(e instanceof he||e instanceof x)return e.equalityTest(t);if(e instanceof f&&t instanceof f){let n=e.cache._arcadeCacheId,r=t.cache._arcadeCacheId;if(n!=null)return n===r}return!!(z(e)&&z(t)&&(e._arcadeCacheId===t._arcadeCacheId&&e._arcadeCacheId!==void 0&&e._arcadeCacheId!==null||e._underlyingGraphic===t._underlyingGraphic&&e._underlyingGraphic!==void 0&&e._underlyingGraphic!==null))}function Ae(e,{useNumbersForDates:t}){let n=``;for(let r in e){n!==``&&(n+=`,`);let a=e[r];a==null?n+=JSON.stringify(r)+`:null`:p(a)||i(a)||s(a)?n+=JSON.stringify(r)+`:`+JSON.stringify(a):D(a)?n+=JSON.stringify(r)+`:`+W(a):R(a)||L(a)?n+=`${JSON.stringify(r)}:${JSON.stringify(a.toString())}`:F(a)||Array.isArray(a)?n+=JSON.stringify(r)+`:`+W(a,null,t):I(a)?n+=t?JSON.stringify(r)+`:`+JSON.stringify(a.getTime()):JSON.stringify(r)+`:`+a.stringify():typeof a==`object`&&a&&`castToText`in a&&(n+=JSON.stringify(r)+`:`+a.castToText(t))}return`{`+n+`}`}function U(n,r){if(s(n))return n;if(n===null)return``;if(i(n))return B(n,r);if(p(n))return n.toString();if(I(n))return V(n,r);if(R(n)||L(n))return n.toFormat(r);if(n instanceof t)return JSON.stringify(n.toJSON());if(e(n)){let e=[];for(let t=0;t<n.length;t++)e[t]=G(n[t]);return`[`+e.join(`,`)+`]`}if(n instanceof g){let e=[];for(let t=0;t<n.length();t++)e[t]=G(n.get(t));return`[`+e.join(`,`)+`]`}return typeof n==`object`&&n&&`castToText`in n?n.castToText():w(n)?`object, Function`:n===S?``:T(n)?`object, Module`:``}function je(t){let n=[];if(t instanceof g){for(let e=0;e<t.length();e++)n[e]=K(t.get(e));return n}if(!e(t))return null;for(let e=0;e<t.length;e++)n[e]=K(t[e]);return n}function W(n,r,a=!1){if(s(n))return n;if(n===null)return``;if(i(n))return B(n,r);if(p(n))return n.toString();if(I(n))return V(n,r);if(R(n)||L(n))return n.toFormat(r);if(n instanceof t)return n instanceof ne?`{"xmin":`+n.xmin.toString()+`,"ymin":`+n.ymin.toString()+`,`+(n.hasZ?`"zmin":`+n.zmin.toString()+`,`:``)+(n.hasM?`"mmin":`+n.mmin.toString()+`,`:``)+`"xmax":`+n.xmax.toString()+`,"ymax":`+n.ymax.toString()+`,`+(n.hasZ?`"zmax":`+n.zmax.toString()+`,`:``)+(n.hasM?`"mmax":`+n.mmax.toString()+`,`:``)+`"spatialReference":`+Ve(n.spatialReference)+`}`:Ve(n.toJSON(),(e,t)=>e.key===t.key?0:e.key===`spatialReference`?1:t.key===`spatialReference`||e.key<t.key?-1:e.key>t.key?1:0);if(e(n)){let e=[];for(let t=0;t<n.length;t++)e[t]=G(n[t],a);return`[`+e.join(`,`)+`]`}if(n instanceof g){let e=[];for(let t=0;t<n.length();t++)e[t]=G(n.get(t),a);return`[`+e.join(`,`)+`]`}return typeof n==`object`&&n&&`castToText`in n?n.castToText(a):w(n)?`object, Function`:n===S?``:T(n)?`object, Module`:``}function G(e,n=!1){if(e===null)return`null`;if(p(e)||s(e))return JSON.stringify(e);if(i(e))return e.toString();if(e instanceof t||e instanceof g||Array.isArray(e))return W(e,null,n);if(I(e))return n?JSON.stringify(e.getTime()):JSON.stringify(V(e,``));if(R(e)||L(e))return JSON.stringify(e.toString());if(typeof e==`object`&&e){if(`castToText`in e)return e.castToText(n)}else if(e===S)return`null`;return`null`}function K(t,n){return i(t)?t:t===null||t===``?0:I(t)||L(t)||R(t)?NaN:p(t)?t?1:0:e(t)||t===``||t===void 0?NaN:n!==void 0&&s(t)?(n=C(n,`‰`,``),n=C(n,`¤`,``),pe(t,{pattern:n})):t===S?0:Number(t)}function Me(e,t){if(I(e))return e;if(s(e)){let n=Ne(e,t);if(n)return m.dateTimeToArcadeDate(n)}return null}function Ne(e,t){let r=/ (\d\d)/,i=te(t),a=n.fromISO(e,{zone:i});return a.isValid||r.test(e)&&(e=e.replace(r,`T$1`),a=n.fromISO(e,{zone:t}),a.isValid)?a:null}function Pe(e){return p(e)?e:s(e)?(e=e.toLowerCase())===`true`:!!i(e)&&e!==0&&!isNaN(e)}function Fe(e,t){let n=JSON.parse(e);return n&&!n.spatialReference&&(n.spatialReference=t),se(n)}function Ie(e,t){return e==null?null:(e.spatialReference!==null&&e.spatialReference!==void 0||(e.spatialReference=t),e)}function Le(e){if(e===null)return null;if(e instanceof f)return e.x===`NaN`||e.x===null||isNaN(e.x)?null:e;if(e instanceof d){if((e.curveRings??e.rings).length===0)return null;for(let t of e.curveRings??e.rings)if(t.length>0)return e;return null}if(e instanceof r){if((e.curvePaths??e.paths).length===0)return null;for(let t of e.curvePaths??e.paths)if(t.length>0)return e;return null}return e instanceof u?e.points.length===0?null:e:e instanceof ne?e.xmin===`NaN`||e.xmin===null||isNaN(e.xmin)?null:e:null}function Re(e,t){if(!e||!e.domain)return t;let n=null,r=null;if(I(t))n=t.toNumber();else if(L(t))n=t.toString();else if(R(t))n=t.toStorageString();else if(e.field.type===`string`||e.field.type===`esriFieldTypeString`)n=U(t);else{if(t==null)return null;if(t===``)return t;n=K(t)}for(let t=0;t<e.domain.codedValues.length;t++){let i=e.domain.codedValues[t];i.code===n&&(r=i)}return r===null?U(t):r.name}function ze(e,t){if(!e||!e.domain)return t;let n=null,r=U(t);for(let t=0;t<e.domain.codedValues.length;t++){let i=e.domain.codedValues[t];i.name===r&&(n=i)}return n===null?t:n.code}function q(e,t,n=null,r=null){if(!t||!t.fields)return null;let i,a,o=null;for(let n=0;n<t.fields.length;n++){let r=t.fields[n];r.name.toLowerCase()===e.toString().toLowerCase()&&(o=r)}if(o===null)throw new h(null,`FieldNotFound`,null,{key:e});let s=t.typeIdField,c=`id`,l=t.types;if(t.subtypeField&&(s=t.subtypeField,c=`code`,l=t.subtypes??[]),r===null&&n&&s)r=n.hasField(s)?n.field(s):null;else if(s&&r!==null){let e=!1;for(let t of l||[])if(r===t[c]){e=!0;break}if(!e){for(let t of l||[])if(r===t.name){r=t[c],e=!0;break}}e||(r=null,n&&s&&(r=n.hasField(s)?n.field(s):null))}return r!=null&&l.some(e=>e[c]===r&&(i=e.domains?.[o.name],i&&i.type===`inherited`&&(i=Be(o.name,t),a=!0),!0)),a||i||(i=Be(e,t)),{field:o,domain:i}}function Be(e,t){let n;return t.fields.some(t=>(t.name.toLowerCase()===e.toLowerCase()&&(n=t.domain),!!n)),n}function Ve(e,t){t||={},typeof t==`function`&&(t={cmp:t});let n=typeof t.cycles==`boolean`&&t.cycles,r=t.cmp&&(i=t.cmp,function(e){return function(t,n){let r={key:t,value:e[t]},a={key:n,value:e[n]};return i(r,a)}});var i;let a=[];return function e(t){if(t?.toJSON&&typeof t.toJSON==`function`&&(t=t.toJSON()),t===void 0)return;if(typeof t==`number`)return isFinite(t)?``+t:`null`;if(typeof t!=`object`)return JSON.stringify(t);let i,o;if(Array.isArray(t)){for(o=`[`,i=0;i<t.length;i++)i&&(o+=`,`),o+=e(t[i])||`null`;return o+`]`}if(t===null)return`null`;if(a.includes(t)){if(n)return JSON.stringify(`__cycle__`);throw TypeError(`Converting circular structure to JSON`)}let s=a.push(t)-1,c=Object.keys(t).sort(r?.(t));for(o=``,i=0;i<c.length;i++){let n=c[i],r=e(t[n]);r&&(o&&(o+=`,`),o+=JSON.stringify(n)+`:`+r)}return a.splice(s,1),`{`+o+`}`}(e)}function He(e){if(e===null)return null;let t=[];for(let n of e)O(n)?t.push(n.geometry()):t.push(n);return t}function J(e,t){if(!(t instanceof f))throw new h(null,`InvalidParameter`,null);e.push(t.hasZ?t.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])}function Ue(t,n){if(e(t)||F(t)){let r=!1,i=!1,a=[],s=n;if(e(t)){for(let e of t)J(a,e);a.length>0&&(s=t[0].spatialReference,r=t[0].hasZ,i=t[0].hasM)}else if(t instanceof x)a=t._elements,a.length>0&&(r=t._hasZ,i=t._hasM,s=t.get(0).spatialReference);else{if(!F(t))throw new h(null,`InvalidParameter`,null);for(let e of t.toArray())J(a,e);a.length>0&&(s=t.get(0).spatialReference,r=!0===t.get(0).hasZ,i=!0===t.get(0).hasM)}return a.length===0?null:(o(a)||(a=a.slice().reverse()),new d({rings:[a],spatialReference:s,hasZ:r,hasM:i}))}return t}function We(t,n){if(e(t)||F(t)){let i=!1,a=!1,o=[],s=n;if(e(t)){for(let e of t)J(o,e);o.length>0&&(s=t[0].spatialReference,i=!0===t[0].hasZ,a=!0===t[0].hasM)}else if(t instanceof x)o=t._elements,o.length>0&&(i=t._hasZ,a=t._hasM,s=t.get(0).spatialReference);else if(F(t)){for(let e of t.toArray())J(o,e);o.length>0&&(s=t.get(0).spatialReference,i=!0===t.get(0).hasZ,a=!0===t.get(0).hasM)}return o.length===0?null:new r({paths:[o],spatialReference:s,hasZ:i,hasM:a})}return t}function Ge(t,n){if(e(t)||F(t)){let r=!1,i=!1,a=[],o=n;if(e(t)){for(let e of t)J(a,e);a.length>0&&(o=t[0].spatialReference,r=!0===t[0].hasZ,i=!0===t[0].hasM)}else if(t instanceof x)a=t._elements,a.length>0&&(r=t._hasZ,i=t._hasM,o=t.get(0).spatialReference);else if(F(t)){for(let e of t.toArray())J(a,e);a.length>0&&(o=t.get(0).spatialReference,r=!0===t.get(0).hasZ,i=!0===t.get(0).hasM)}return a.length===0?null:new u({points:a,spatialReference:o,hasZ:r,hasM:i})}return t}function Ke(t,n=!0){if(t==null)return[];if(e(t)){let e=[];for(let r of t){let t=U(r);(n||t!==``)&&e.push(t)}return e}if(F(t)){let e=[];for(let r=0;r<t.length();r++){let i=U(t.get(r));(n||i!==``)&&e.push(i)}return e}if(E(t)){let e=U(t);if(n||e!==``)return[e]}return[]}var qe=0;function Je(){return qe++,qe%100==0?(qe=0,new Promise(e=>{setTimeout(()=>{e()},0)})):Promise.resolve()}function Ye(e,t,n){switch(n){case`&`:return e&t;case`|`:return e|t;case`^`:return e^t;case`<<`:return e<<t;case`>>`:return e>>t;case`>>>`:return e>>>t}}function Y(e,n=null){return e==null?null:p(e)||i(e)||s(e)?e:e instanceof t?!0===n?.keepGeometryType?e:e.toJSON():e instanceof g?e.toArray().map(e=>Y(e,n)):Array.isArray(e)?e.map(e=>Y(e,n)):c(e)?e:I(e)?e.toJSDate():R(e)?e.toString():L(e)?e.toJSDate():typeof e==`object`&&e&&e.castAsJson!==void 0?e.castAsJson(n):null}async function Xe(e,t,n,r,i){i[r]=await Ze(e,t,n)}async function Ze(e,n=null,r=null){if(e instanceof g&&(e=e.toArray()),e==null)return null;if(E(e)||e instanceof t||c(e)||I(e))return Y(e,r);if(Array.isArray(e)){let i=[],a=[];for(let o of e)o===null||E(o)||o instanceof t||c(o)||I(o)?a.push(Y(o,r)):(a.push(null),i.push(Xe(o,n,r,a.length-1,a)));return i.length>0&&await Promise.all(i),a}return typeof e==`object`&&e&&e.castAsJsonAsync!==void 0?e.castAsJsonAsync(n,r):null}function X(e){return Z(e)?e.parent:e}function Z(e){return e&&`declaredClass`in e&&e.declaredClass===`esri.layers.support.SubtypeSublayer`}function Qe(e){return e&&`declaredClass`in e&&e.declaredClass===`esri.layers.SubtypeGroupLayer`}function $e(e,t,n){let r=X(e.fullSchema());return r===null||!r.fields?null:q(t,r,e,n)}function et(e){let t=X(e.fullSchema());return t===null?null:t.fields?t.subtypeField?{subtypeField:t.subtypeField,subtypes:t.subtypes?t.subtypes.map(e=>({name:e.name,code:e.code})):[]}:t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map(e=>({name:e.name,code:e.id})):[]}:null:null}function tt(e,t,n,r){let i=X(e.fullSchema());if(i===null||!i.fields)return null;let a=q(t,i,e,r);if(n===void 0)try{n=e.field(t)}catch{return null}return Re(a,n)}function nt(e,t,n,r){let i=X(e.fullSchema());if(i===null||!i.fields)return null;if(n===void 0){try{n=e.field(t)}catch{return null}return n}return ze(q(t,i,e,r),n)}function rt(e){return e?.timeZone??`system`}function it(e){let t=X(e.fullSchema());if(t===null||!t.fields)return null;let n=[];for(let e of t.fields)n.push(ue(e));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField??``,geometryType:de[t.geometryType]===void 0?``:de[t.geometryType],fields:n}}function at(e,t){let n=m.systemTimeZoneCanonicalName;return e===`system`&&(e=n),{version:ot,engineVersion:`5.0`,timeZone:e,userTimeZone:n,spatialReference:t instanceof ce?t.toJSON():t,application:ee.applicationName??``,engine:`web`,locale:a()}}var ot=`1.34`,st=Object.freeze(Object.defineProperty({__proto__:null,ImplicitResult:_e,ReturnResult:ge,absRound:Ee,arcadeVersion:ot,autoCastArrayOfPointsToMultiPoint:Ge,autoCastArrayOfPointsToPolygon:Ue,autoCastArrayOfPointsToPolyline:We,autoCastFeatureToGeometry:He,binaryOperator:Ye,breakResult:ve,castAsJson:Y,castAsJsonAsync:Ze,castRecordToText:Ae,continueResult:ye,defaultExecutingContext:at,defaultTimeZone:rt,defaultUndefined:be,equalityTest:ke,featureDomainCodeLookup:nt,featureDomainValueLookup:tt,featureFullDomain:$e,featureSchema:it,featureSubtypes:et,fixNullGeometry:Le,fixSpatialReference:Ie,formatDate:V,formatNumber:B,getDomain:q,getDomainCode:ze,getDomainValue:Re,getType:xe,greaterThanLessThan:Oe,isArray:e,isBoolean:p,isDate:I,isDateOnly:L,isDictionary:M,isDictionaryLike:Ce,isEmpty:Te,isFeature:O,isFeatureSet:j,isFeatureSetCollection:N,isFunctionParameter:w,isGeometry:D,isGraphic:l,isImmutableArray:F,isInteger:re,isJsDate:c,isKnowledgeGraph:P,isModule:T,isNumber:i,isObject:z,isPixel:A,isSimpleType:E,isString:s,isSubtypeGrouplayer:Qe,isSubtypeSublayer:Z,isTime:R,isVoid:Se,isVoxel:k,multiReplace:C,parseGeometryFromJson:Fe,pcCheck:we,stableStringify:Ve,standardiseDateFormat:De,tick:Je,toBoolean:Pe,toDate:Me,toNumber:K,toNumberArray:je,toString:U,toStringArray:Ke,toStringExplicit:W,voidOperation:S},Symbol.toStringTag,{value:`Module`}));function ct(e){lt=e}var lt;function Q(t){return t===null?null:I(t)?t.clone():E(t)?t:D(t)?t.clone():F(t)?t.toArray().map(e=>Q(e)):e(t)?t.map(e=>Q(e)):O(t)?lt.createFromArcadeFeature(t):N(t)||j(t)?t:M(t)||t?.declaredClass===`esri.arcade.Attachment`?t.deepClone():(t?.declaredClass===`esri.arcade.Portal`||P(t)||t instanceof _||w(t),t)}function $(t,n,r=!1,a=!1){if(t==null)return null;if(i(t)||p(t)||s(t)||I(t)||L(t)||R(t))return t;if(e(t)){let e=[];for(let i of t)e.push($(i,n,r,a));return e}if(a&&D(t))return t;let o=new ut;o.immutable=!1;for(let[e,i]of Object.entries(t))i!==void 0&&o.setField(e,$(i,n,r,a));return o.immutable=r,o}var ut=class e{constructor(t){this.declaredClass=`esri.arcade.Dictionary`,this.plain=!1,this.immutable=!0,t instanceof e?this.attributes=t.attributes:t==null?this.attributes=Object.create(null):Object.getPrototypeOf(t)==null?this.attributes=t:this.attributes={__proto__:null,...t}}static containerEntry(t,n){return new e({__proto__:null,key:t,value:n})}static textFormatting(){let t=new e({__proto__:null,newline:`
`,tab:`	`,singlequote:`'`,doublequote:`"`,forwardslash:`/`,backwardslash:`\\`});return t.immutable=!1,t}field(e){let t=e.toLowerCase(),n=this.attributes[e];if(n!==void 0)return n;for(let e in this.attributes)if(e.toLowerCase()===t)return this.attributes[e];throw new h(null,`FieldNotFound`,null,{key:e})}setField(e,t){if(this.immutable)throw new h(null,`Immutable`,null);if(w(t))throw new h(null,`NoFunctionInDictionary`,null);let n=e.toLowerCase();if(t instanceof Date&&(t=m.dateJSToArcadeDate(t)),this.attributes[e]===void 0){for(let e in this.attributes)if(e.toLowerCase()===n)return void(this.attributes[e]=t);this.attributes[e]=t}else this.attributes[e]=t}eraseField(e){if(this.immutable)throw new h(null,`Immutable`,null);if(e in this.attributes)return void delete this.attributes[e];let t=e.toLowerCase();for(let e in this.attributes)if(e.toLowerCase()===t)return void delete this.attributes[e]}hasField(e){let t=e.toLowerCase();if(this.attributes[e]!==void 0)return!0;for(let e in this.attributes)if(e.toLowerCase()===t)return!0;return!1}keys(){let e=[];for(let t in this.attributes)e.push(t);return e=e.sort(),e}values(){return this.keys().map(e=>this.attributes[e])}entryCount(){return Object.keys(this.attributes).length}isEmpty(){return this.entryCount()<=0}castToText(e=!1){return Ae(this.attributes,{useNumbersForDates:e})}static convertObjectToArcadeDictionary(t,n,r=!0,i=!1){let a=new e;for(let e in a.immutable=!1,t){let o=t[e];o!==void 0&&a.setField(e.toString(),$(o,n,r,i))}return a.immutable=r,a}static convertJsonToArcade(e,t,n=!1,r=!1){return $(e,t,n,r)}castAsJson(e=null){let t=Object.create(null);for(let n in this.attributes){let r=this.attributes[n];r!==void 0&&(e?.keyTranslate&&(n=e.keyTranslate(n)),t[n]=Y(r,e))}return t}async castDictionaryValueAsJsonAsync(e,t,n,r=null,i){let a=await Ze(n,r,i);return e[t]=a,a}async castAsJsonAsync(e=null,n=null){let r=Object.create(null),i=[];for(let a in this.attributes){let o=this.attributes[a];n?.keyTranslate&&(a=n.keyTranslate(a)),o!==void 0&&(E(o)||o instanceof t||o instanceof m?r[a]=Y(o,n):i.push(this.castDictionaryValueAsJsonAsync(r,a,o,e,n)))}return i.length>0&&await Promise.all(i),r}deepClone(){let t=new e;t.immutable=!1;for(let e of this.keys())t.setField(e,Q(this.field(e)));return t}};export{Z as $,D as A,Ke as B,S as C,ge as D,it as E,at as F,U as G,De as H,C as I,Le as J,je as K,Je as L,k as M,et as N,Ue as O,N as P,Se as Q,Me as R,ze as S,Ce as T,Oe as U,W as V,P as W,we as X,I as Y,Ae as Z,He as _,tt as a,_e as at,w as b,nt as c,ke as ct,xe as d,x as dt,L as et,T as f,me as ft,ye as g,_ as gt,$e as h,b as ht,A as i,Te as it,E as j,K as k,q as l,be as lt,O as m,v as mt,Q as n,F as nt,Pe as o,We as ot,Y as p,y as pt,R as q,ct as r,st as rt,j as s,Re as st,ut as t,Ee as tt,Ie as u,he as ut,M as v,Ge as w,Ye as x,rt as y,ve as z};