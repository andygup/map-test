import{BT as e,Bx as t,Jy as n,Ky as r,Qy as i,Sy as a,Ty as o,Xy as s,Yy as c,ZC as l,Zy as u,_y as d,cy as f,dy as p,fy as m,gy as h,kv as g,my as _,nb as v,oy as y,px as b,py as x,sy as S,uy as C,wy as w,xy as T}from"./index-CZ4oMP1N.js";function E(e,t,n){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0))}function D(e,t,n){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0)}var O=[];for(let e of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){let t=e[0];for(let n=1;n<e.length;n++)O[e[n]]=t}var k=[];function A(e){return e.vcsWkid&&O[e.vcsWkid]!==void 0?k[O[e.vcsWkid]]:e.latestVcsWkid&&O[e.latestVcsWkid]!==void 0?k[O[e.latestVcsWkid]]:1}function j(e,t,n){let r=t[0]-e[0],i=t[1]-e[1];if(n){let e=t[2]-t[2];return Math.sqrt(r*r+i*i+e*e)}return Math.sqrt(r*r+i*i)}function M(e,t,n){let r=t[0]-e[0],i=t[1]-e[1];if(n){let e=t[2]-t[2];return r*r+i*i+e*e}return r*r+i*i}function ee(e,t){return e.x*t.x+e.y*t.y}function te(e,t){return e.x*t.y-t.x*e.y}function N(e,t,n=0){for(;e<n;)e+=t;let r=n+t;for(;e>=r;)e-=t;return e}function P(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function ne(e,t){return N(P(e,t),2*Math.PI)*(180/Math.PI)}function F(e,t){return N(Math.PI/2-P(e,t),2*Math.PI)*(180/Math.PI)}function I(e,t,n){let r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Math.atan2(te(r,i),ee(r,i))}function re(e,t,n){return l(N(I(e,t,n),2*Math.PI))}function L(e,t,n){return l(N(-1*I(e,t,n),2*Math.PI))}function R(e,t,n){return Math.max(t,Math.min(n,e))}function z(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function B(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function V(e,t,n){let r=[n[0]-t[0],n[1]-t[1],n[2]-t[2]],i=R(z(r,[e[0]-t[0],e[1]-t[1],e[2]-t[2]])/B(r),0,1);return[t[0]+(n[0]-t[0])*i,t[1]+(n[1]-t[1])*i,t[2]+(n[2]-t[2])*i]}function H(e,t,n){let r=0,i=n[0]-t[0],a=n[1]-t[1],o=i*i+a*a;return o===0?r=.5:(r=((e[0]-t[0])*i+(e[1]-t[1])*a)/o,r<0?r=0:r>1&&(r=1)),r<=.5?[t[0]+(n[0]-t[0])*r,t[1]+(n[1]-t[1])*r]:[n[0]-(n[0]-t[0])*(1-r),n[1]-(n[1]-t[1])*(1-r)]}k[9002]=.3048,k[9003]=.3048006096012192,k[9095]=.3048007491;function U(t,r,i){if(d(r))return c(t,r,i);if(T(r)){let n=u(t,r,i)[0];if(n==null)throw new e(`closestPointOnCurve:unexpected-error`,`Failed to find close point on bezier curve`);return n}if(a(r)){let e=w(t,r);return n(e,i)}if(_(r)){let e=p(t,r);return n(e,i)}let o=S(t,r);return f(o,i)}function W(e,t,n=1){if(T(t))return i(e,t,n);if(a(t)){let n=w(e,t);return n.isInvalid?Math.sqrt(v(e,t.c[0])):r(n)}if(_(t)){let n=p(e,t);return n.isInvalid?Math.sqrt(v(e,t.a[0])):r(n)}return y(e,t,n)}var G=1e-6;function K(e,t,n,r){let i=u(e,t,n).filter(({distance:e})=>e<=r),a=[],o=0,c=t;for(let{t}of i){let n=(t-o)/(1-o);if(n<G||1-n<G)continue;let[r,i]=s(e,c,t);a.push(r),c=i,o=t}return a.push(c),a}function q(e,t,r,i){let a=w(e,t);if(a.isInvalid)return[x(t)];let{t:s,distance:c}=n(a,r);return c<=i?o(a,t,s):[x(t)]}function J(e,t,r,i){let a=p(e,t);if(a.isInvalid)return[x(t)];let{t:o,distance:s}=n(a,r);return s<=i?m(a,t,o):[x(t)]}function Y(e,t,n,r){let i=S(e,t);if(i.isInvalid)return[x(t)];let{t:a,distance:o}=f(i,n);return o<=r?C(i,t,a):[x(t)]}function ie(e,t,n,r){return d(t)?[x(t)]:T(t)?K(e,t,n,r):a(t)?q(e,t,n,r):_(t)?J(e,t,n,r):Y(e,t,n,r)}function ae(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function oe(e){let t=ae(e);return[e[0]/t,e[1]/t,e[2]/t]}function X(e,t,n,r){let i=oe([t[0]-e[0],t[1]-e[1],t[2]*r-e[2]*r]);return[e[0]+i[0]*n,e[1]+i[1]*n,e[2]+i[2]*n]}function Z(e,t,n,r){return e+(t-e)/n*r}function Q(e,t,n){let r=t[0]-e[0],i=t[1]-e[1],a=Math.sqrt(r*r+i*i);return r/=a,i/=a,r*=n,i*=n,[e[0]+r,e[1]+i]}function se(e,n){if(!e)return null;switch(e.type){case`extent`:case`multipoint`:case`mesh`:case`point`:return null}let r=e.type===`polygon`?e.rings:e.paths,i=1;if((e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(i=A(e.spatialReference)/t(e.spatialReference)),r.length===0||r[0].length===0||!1===e.hasM)return null;let a=-1,o=0,{hasM:s,hasZ:c}=e,l=c?3:2;for(let t of r){if(a++,t.length>0&&t[0][l]===n)return{partId:a,distanceAlong:o,coordinate:new b({hasZ:c,hasM:s,spatialReference:e.spatialReference,x:t[0][0],y:t[0][1],...c?{z:t[0][2]}:{},...s?{m:t[0][l]}:{}}),segmentId:0};let r=-1;for(let u=1;u<t.length;u++){let d=$(t[u-1],t[u],c,i);r++;let f=t[u][l]-t[u-1][l],p=t[u][l];if(p===n)return{partId:a,distanceAlong:d+o,coordinate:new b({hasZ:c,hasM:s,spatialReference:e.spatialReference,x:t[u][0],y:t[u][1],...c?{z:t[u][2]}:{},...s?{m:t[u][l]}:{}}),segmentId:r};if(p>n&&n>t[u-1][l]){let p=(n-t[u-1][l])/f*d,m=c?X(t[u-1],t[u],p,i):Q(t[u-1],t[u],p);m=[...m,n];let h=new b({hasZ:c,hasM:s,spatialReference:e.spatialReference,x:m[0],y:m[1],...c?{z:m[2]}:{},...s?{m:m[l]}:{}});return{partId:a,distanceAlong:o+$(t[u-1],[h.x,h.y,...c?[h.z]:[],...s?[h.m]:[]],c,i),coordinate:h,segmentId:r}}o+=d}}return null}function ce(e,n){if(!e)return null;switch(e.type){case`extent`:case`multipoint`:case`mesh`:case`point`:return null}let r=e.type===`polygon`?e.rings:e.paths;if(n<0)return null;let i=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(i=A(e.spatialReference)/t(e.spatialReference));let a=0,{hasZ:o,hasM:s}=e,c=o?3:2,l=-1;if(n===0)return r.length===0||r[0].length===0?null:{partId:0,coordinate:new b({hasZ:o,hasM:s,spatialReference:e.spatialReference,x:r[0][0][0],y:r[0][0][1],...o?{z:r[0][0][2]}:{},...s?{m:r[0][0][c]}:{}}),segmentId:0};for(let t of r){l++;let r=-1;for(let u=1;u<t.length;u++){r++;let d=$(t[u-1],t[u],o,i),f=a+d;if(f===n)return{partId:l,coordinate:new b({hasZ:o,hasM:s,spatialReference:e.spatialReference,x:t[u][0],y:t[u][1],...o?{z:t[u][2]}:{},...s?{m:t[u][c]}:{}}),segmentId:r};if(f>n){let f=o?X(t[u-1],t[u],n-a,i):Q(t[u-1],t[u],n-a);return f=[...f,Z(t[u-1][c],t[u][c],d,n-a)],{partId:l,coordinate:new b({hasZ:o,hasM:s,spatialReference:e.spatialReference,x:f[0],y:f[1],...o?{z:f[2]}:{},...s?{m:f[c]}:{}}),segmentId:r}}a=f}}return null}function le(e,n){if(!e||!n)return null;let r=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(r=A(n.spatialReference)/t(n.spatialReference));let i=null,a=0;return i=e,a=e.hasZ&&n.hasZ?E([n.x,n.y,n.z],[e.x,e.y,e.z],r):j([n.x,n.y],[e.x,e.y],!1),{coordinate:i,distance:a}}function ue(e,n){if(!e||!n)return null;let r=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(r=A(n.spatialReference)/t(n.spatialReference));let i=null,a=0,o=Number.MAX_VALUE,s=-1,c=-1;for(let t of e.points||[]){c++;let i=e.hasZ&&n.hasZ?D([t[0],t[1],t[2]],[n.x,n.y,n.z],r):M([t[0],t[1]],[n.x,n.y],!1);i<o&&(o=i,s=c)}return s<0?null:(a=o,i=e.getPoint(s),{coordinate:i,distance:Math.sqrt(a)})}function de(e,n){if(!e||!n)return null;let r=e.type===`polygon`?e.curveRings??e.rings:e.curvePaths??e.paths,i=1;(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid)&&(i=A(n.spatialReference)/t(n.spatialReference));let a=Number.MAX_VALUE,o=-1,s=-1,c=-1,l=e.hasZ&&n.hasZ,u=null,f=l?[n.x,n.y,n.z]:[n.x,n.y];for(let e of r){s++;for(let t=1;t<e.length;t++){let n=fe(f,e[t-1],e[t],l,i);n.distance<a&&(a=n.distance,u=n.closestPoint,c=s,o=t-1)}}if(o<0||!u)return null;let p=e.hasM&&e.hasZ?3:2,m=r[c][o],g=h(m),_=r[c][o+1],v=h(_),y=null,x=null,S=l?u[2]:null,C=d(_)?u:ie(g,_,u,.001)[0],w=$(g,C,l,i),T=$(g,_,l,i);e.hasM&&(x=Z(g[p],v[p],T,w)),!e.hasZ||!1!==n.hasZ&&d(C)||(S=Z(g[2],v[2],T,w),h(C)[2]=S,w=$(g,C,!0,i)),y=new b({hasZ:l,hasM:e.hasM,spatialReference:n.spatialReference,x:u[0],y:u[1],...e.hasZ?{z:S}:{},...e.hasM?{m:x}:{}});let E=0;for(let t=0;t<=c;t++){let n=r[t],a=t===c?o:n.length-1;for(let t=1;t<=a;t++)E+=$(h(n[t-1]),n[t],e.hasZ,i)}return E+=w,{partId:c,segmentId:o,coordinate:y,distance:a,distanceAlong:E}}function fe(t,n,r,i,a){let o=h(n);if(d(r)){let e=i?V(t,o,r):H(t,o,r);return{closestPoint:e,distance:i?E(e,t,a):j(e,t,!1)}}let s=U(o,r,t);if(!s)throw new e(`arcade:closestPointOnSegment`,`The given point is not on the curve`);return{closestPoint:s.curvePoint,distance:s.distance}}function $(e,t,n,r){return d(t)?n?E(e,t,r):j(e,t,!1):W(e,t,.001)}function pe(e,t){if(!e||!t)return null;if(e.type===`extent`){let t=e;e=new g({spatialReference:e.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})}switch(e.type){case`point`:return le(e,t)??null;case`multipoint`:return ue(e,t)??null;case`polygon`:case`polyline`:return de(e,t)??null;default:return null}}export{L as a,A as c,re as i,ne as l,pe as n,F as o,ce as r,E as s,se as t};