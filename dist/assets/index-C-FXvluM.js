const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pe-wasm-ihfvgCko.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/ElevationLayer-Bauhy7sV.js","assets/ArcGISCachedService-BAlPta50.js","assets/TileInfoTilemapCache-Dm9X2Gv3.js","assets/TilemapCache-BVCKt_-g.js","assets/WorkerHandle-BZG9YJdQ.js","assets/layersCreator-BBOzKftP.js","assets/portalLayers-CZ_qkpre.js","assets/associatedFeatureServiceUtils-DhjeK2rJ.js","assets/fetchService-DD7rvIY6.js","assets/arcgisLayers-Nhlf3lr2.js","assets/geometryEngineBase-yFIvKOkM.js","assets/webdocSaveUtils-CgoUfAOU.js","assets/originUtils-D69mHv66.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/resourceUtils-DtxSm850.js","assets/resourceUtils-DTdmibk4.js","assets/saveAPIKeyUtils-BNhQUlBG.js","assets/saveUtils-BorRtW_E.js","assets/arcadeUtils-BfdEM_4F.js","assets/languageUtils-D6fITh3r.js","assets/shared-B2Wi1qXt.js","assets/number-BhozGW4E.js","assets/featureConversionUtils-COeKMnVA.js","assets/OptimizedFeature-swgcyHeh.js","assets/OptimizedGeometry-C9mSZhHi.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/geometryEngineJSON-BwrklJA_.js","assets/json-Wa8cmqdu.js","assets/statsWorker-COAYQ8tm.js","assets/utils-BDcN5nDq.js","assets/utils-qFucBQQq.js","assets/ClassBreaksDefinition-4fI5XmSN.js","assets/geometryEngineWorker-BiqU-FdE.js","assets/CSVSourceWorker-DGb3EZM6.js","assets/date-DLgTylpo.js","assets/FeatureStore-CWEIAwdz.js","assets/BoundsStore-D96zP6uo.js","assets/PooledRBush-BhaUOkfN.js","assets/timeSupport-BVpoo_Si.js","assets/queryUtils-DcP-VfzF.js","assets/optimizedFeatureQueryEngineAdapter-DrXZKbZy.js","assets/centroid-DdLmOD72.js","assets/QueryEngine-QcFno8io.js","assets/WhereClause-DLw-__iv.js","assets/QueryEngineCapabilities-DjYb9CEb.js","assets/SnappingCandidate-O5eRSE6e.js","assets/clientSideDefaults-Cl6Ho016.js","assets/capabilities-Y9lFlGVh.js","assets/EdgeProcessingWorker-exssg-OL.js","assets/workerHelper-DEiexMd5.js","assets/InterleavedLayout-FN5nlSrs.js","assets/BufferView-Dk0MoByh.js","assets/types-D0PSWh4d.js","assets/Util-B1cu74ll.js","assets/edgeProcessing-DTuw2DSc.js","assets/deduplicate-CHguaZER.js","assets/Indices-JUNGgdWS.js","assets/glUtil-DIb2YQRb.js","assets/VertexElementDescriptor-BOD-G50G.js","assets/Normals-Dt6YiP0J.js","assets/ElevationSamplerWorker-CzVShatr.js","assets/MeshLocalVertexSpace-cD48CuiV.js","assets/vertexSpaceConversion-B-Meq4J1.js","assets/meshVertexSpaceUtils-6Oit8r3Z.js","assets/vec3-Ba3sX4Tq.js","assets/vec4-BXZ1pugf.js","assets/FeatureServiceSnappingSourceWorker-BU2pHsc6.js","assets/symbologySnappingCandidates-CHJFnhZ_.js","assets/pbfQueryUtils-B6R04oFA.js","assets/pbf-BGagEEBr.js","assets/query-B80JGegX.js","assets/GeoJSONSourceWorker-BHaa3qp-.js","assets/geojson-CCyMTr1g.js","assets/sourceUtils-ZhGCdF_6.js","assets/MemorySourceWorker-1Bx-cNSg.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-Dt9Fmnlu.js","assets/dehydratedFeatures-6UTvZGuJ.js","assets/FeaturePipelineWorker-C1a4izQ9.js","assets/AttributeStore-D_Wdpo6w.js","assets/LabelMetric-DcZDHLPh.js","assets/Program-nKTILKyt.js","assets/BufferObject-DuXoHzsa.js","assets/BoundingBox-CIf8VSjb.js","assets/CIMSymbolHelper-Bovf745t.js","assets/BidiEngine-DNnuvc1i.js","assets/fontUtils-Bn43fyGA.js","assets/GeometryUtils-BW2m9k2j.js","assets/Rect-CUzevAry.js","assets/UpdateTracking2D-Do6QaUaF.js","assets/BindType-BmZEZMMh.js","assets/MeshWriterRegistry-BKgpyRQb.js","assets/PieChartMeshWriter-CeqyfKrD.js","assets/TurboLine-DCj44Fo5.js","assets/earcut-Lltz9D9k.js","assets/constants-F8oTIn7N.js","assets/grouping-PYviiPPg.js","assets/ogcFeatureUtils-DMzs9NnN.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-D86g48gQ.js","assets/PointCloudWorker-BGLJ6ntk.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-BXZyM0d9.js","assets/I3SBinaryReader-o976SSUL.js","assets/RasterWorker-Bug7ziTw.js","assets/dataUtils-D7g_Qwjf.js","assets/RasterSymbolizer-DbB4MWYI.js","assets/PolynomialTransform-hfLt-FQ6.js","assets/rasterProjectionHelper-CkX4dlhy.js","assets/SceneLayerSnappingSourceWorker-CPCxEXP7.js","assets/Octree-CXz4dNsB.js","assets/SceneLayerWorker-Dba2M2rZ.js","assets/I3SUtil-BWNQd_G4.js","assets/edgeUtils-CVmqmk8_.js","assets/floatRGBA-omvZ6LNc.js","assets/symbolColorUtils-D2BjTDpb.js","assets/NormalAttribute.glsl-BzcwcK9j.js","assets/WFSSourceWorker-C8k5xmyP.js","assets/wfsUtils-BLUmRWF4.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-Dt0ZK55H.js","assets/enums-BRzLM11V.js","assets/config-MDUrh2eL.js","assets/StyleDefinition-DY46tDlF.js","assets/SourceLayerData-D8TPnzpG.js","assets/StyleRepository-E3helNnM.js","assets/Feature3DPipelineWorker-Be3E7Zj-.js","assets/projectVectorToPoint-BnOuJcbq.js","assets/VertexArrayObject-km1At7bV.js","assets/NestedMap-GuqgquCN.js","assets/basicInterfaces-CZwQPxTp.js","assets/Geometry-BTp0yhOg.js","assets/renderState-CfpGbofm.js","assets/requestImageUtils-CswTYnN2.js","assets/triangle-C57UtqE7.js","assets/VertexArrayObject-DcaNvwOy.js","assets/GeometryUtil-BqnSbvZN.js","assets/doublePrecisionUtils-B0owpBza.js","assets/RealisticTree.glsl-GbAbnvS_.js","assets/DefaultBufferWriter-BeC23u2e.js","assets/LodResources-BJQowJAY.js","assets/HUDMaterial.glsl-wE3zFfZp.js","assets/graphicUtils-9SiY0FaR.js","assets/hydratedFeatures-DXGiFJc-.js","assets/layersLoader-DqJx-HNP.js","assets/featureLayerUtils-BgwHzo8-.js","assets/utils-Ytg-xMOY.js","assets/FeatureLayerSource-BDTcG7cw.js","assets/External-CNHlILjO.js","assets/MeshTransform-DerVYA28.js","assets/axisAngleDegrees-B_k9QdRo.js","assets/editingSupport-6f_hxNS7.js","assets/QueryTask-DdILlRBg.js","assets/executeForIds-BalbhETe.js","assets/executeQueryJSON-CbsvSguQ.js","assets/BinsQuery-BQg-EC0B.js","assets/queryAssociations-CKoXt7GN.js","assets/Association-B52OFC3Z.js","assets/synthesizeAssociationGeometries-RJLXwCIA.js","assets/Popup-Dve3xjU3.js","assets/webglDeps-Cx2-yDpC.js","assets/ProgramTemplate-Dj-c0Ukb.js","assets/mapViewDeps-Cg6sVZZq.js","assets/FeatureCommandQueue-C1PN4jCm.js","assets/WGLContainer-DdfRQITb.js","assets/Container-xUFVjfQc.js","assets/SDFHelper-Doywti8d.js","assets/GridShader-D0jNQwJx.js","assets/testSVGPremultipliedAlpha-BL_DHGJ5.js","assets/RenderingContext-B2PGSTe9.js","assets/CIMResourceManager-DMoIYO08.js","assets/rasterizingUtils-DOHohXna.js","assets/utils-C8ddrmgE.js","assets/GraphicsView2D-CwuOV7Jz.js","assets/normalizeUtilsSync-BVDxgSK-.js","assets/GraphicContainer-DyDHJIGK.js","assets/AGraphicContainer-CP4ANRKM.js","assets/TechniqueInstance-Bkg4rrM5.js","assets/TileContainer-BNH6o0Hr.js","assets/gridUtils-DnVGRhB5.js","assets/TileLayerView2D-HliUoVdT.js","assets/imageUtils-BxioPECC.js","assets/Bitmap-CQF2m3r0.js","assets/LayerView2D-CACwUEON.js","assets/HighlightGraphicContainer-CN9StLv3.js","assets/LayerView-BoJFcTuW.js","assets/RefreshableLayerView-BcyJYs-0.js","assets/MapServiceLayerViewHelper-Dm2-Fdfl.js","assets/highlightUtils-BaUADjox.js","assets/popupUtils-Do3dDMQc.js","assets/FeatureLayerView2D-wuTb12dR.js","assets/timeSupport-BV7VRAJn.js","assets/timeUtils-C35TngI1.js","assets/tagSymbols-BPcGfZon.js","assets/HighlightCounter-Czi-fdpx.js","assets/BaseDynamicLayerView2D-B_6Jyw7Z.js","assets/BitmapContainer-Bjcy8-ag.js","assets/ExportStrategy-BKbv8AIL.js","assets/CatalogLayerView2D-BZ4ozt3h.js","assets/CatalogDynamicGroupLayerView2D-DsJUM7_I.js","assets/CatalogFootprintLayerView2D-B5nFyL6K.js","assets/GeoRSSLayerView2D-BfkmbDIb.js","assets/GraphicsLayerView2D-C0Uj0YQC.js","assets/GroupLayerView2D-DYcP1vls.js","assets/ImageryLayerView2D-YKylDrtJ.js","assets/RasterVFDisplayObject-8o0_8-di.js","assets/ImageryTileLayerView2D-BdaPCeX_.js","assets/multidimensionalUtils-3HhXdiAi.js","assets/rasterUtils-BAGOtmNn.js","assets/RawBlockCache-DrF10t2v.js","assets/KMLLayerView2D-C7wb6Sqd.js","assets/kmlUtils-BvVPXWDr.js","assets/KnowledgeGraphLayerView2D-D6NFrRen.js","assets/MapImageLayerView2D-BM350LoS.js","assets/MapNotesLayerView2D-DyFmh6XI.js","assets/MediaLayerView2D-BAtGYMKQ.js","assets/perspectiveUtils-W46FhXBq.js","assets/OverlayContainer-dmmrjUtD.js","assets/OGCFeatureLayerView2D-9ZZCZjIg.js","assets/RouteLayerView2D-DW52tYf8.js","assets/Stop-BJGSztcB.js","assets/StreamLayerView2D-B-uY2FXG.js","assets/SubtypeGroupLayerView2D-tuKDo99u.js","assets/VectorTileLayerView2D-CJn3lf8l.js","assets/VideoLayerView2D-CXgJUcM3.js","assets/TelemetryDisplay-xOOQoWCP.js","assets/WMSLayerView2D-C_Fy7c0C.js","assets/ExportWMSImageParameters--eNWhhX5.js","assets/WMTSLayerView2D-C81nWJGw.js","assets/apng-BPXwicFc.js","assets/calcite-button-EcJw6lo6.js","assets/button-CSzA_bli.js","assets/form-DQKnXXcg.js","assets/dom-BREfK1_w.js","assets/interactive-D-sRmNmu.js","assets/label-6px4mHiC.js","assets/component-CeOigQot.js","assets/loadable-Cvdx6nsl.js","assets/locale-DEBMqv85.js","assets/key-BSF9a80T.js","assets/observers-D1cKOKbq.js","assets/t9n-D2cye325.js","assets/icon-8lrZIbmV.js","assets/loader-ANQMuyi7.js","assets/calcite-icon-Dy-uICJg.js","assets/calcite-action-DS3OQO0H.js","assets/action-CAtzgaiz.js","assets/calcite-chip-group-zGCgRG2Y.js","assets/calcite-chip-DfTljyqc.js","assets/chip-fX8aJe-j.js","assets/calcite-fab-p72cyu3Z.js","assets/calcite-flow-pVqs_qJ1.js","assets/calcite-flow-item-Dp3v--sg.js","assets/panel-C3cQywDZ.js","assets/action-menu-Twcqn8VH.js","assets/array-D9rxjK_-.js","assets/popover-BX__IWwR.js","assets/floating-ui-Dm8u0tOT.js","assets/debounce-DUf35w49.js","assets/focusTrapComponent-BriOoisk.js","assets/openCloseComponent-CeEAhbSR.js","assets/Heading-DXUJ8E3s.js","assets/FloatingArrow-DkP1Wvq2.js","assets/scrim-DsHHWNOm.js","assets/calcite-input-Dp8TE27V.js","assets/input2-DWqwRSdq.js","assets/Validation-aFOmH5lh.js","assets/input-De-TCHNF.js","assets/input-message-BVKsAPi_.js","assets/progress-B3_Mj3lS.js","assets/calcite-input-message-DSO14iRF.js","assets/calcite-label-B30aR4Rh.js","assets/calcite-list-uoMWRhXD.js","assets/resources4-BWCcs03d.js","assets/utils3-C2Q9KN47.js","assets/filter-Ig933xs6.js","assets/calcite-list-item-C35I928x.js","assets/handle-Da6AMhzT.js","assets/calcite-loader-QhHZunGs.js","assets/calcite-notice-BUqfqS28.js","assets/conditionalSlot-BMmxtGPE.js","assets/calcite-scrim-BZKfzama.js","assets/calcite-switch-CIQH1lYU.js","assets/calcite-table-P_rK2SuP.js","assets/calcite-table-cell-CgfU6GWf.js","assets/table-cell-CxLI4qjL.js","assets/calcite-table-header-B4ldu6J4.js","assets/table-header-CL5sT_eE.js","assets/calcite-table-row-CqQ6Olw-.js","assets/calcite-panel-Cs9RGIrt.js","assets/calcite-popover-Bvialn6r.js","assets/calcite-sheet-BJ9NcUIr.js","assets/calcite-radio-button-B5bB2U0E.js","assets/calcite-radio-button-group-BBdDVhdp.js","assets/calcite-block-aUGSXHTV.js","assets/calcite-combobox-BGpwkbPG.js","assets/combobox-DqFkMKNG.js","assets/core-CoDzbbcw.js","assets/utils2-BKNC2H5o.js","assets/combobox-item-DtFdg1js.js","assets/calcite-combobox-item-Cvy0gMR5.js","assets/calcite-combobox-item-group-BD_XbU7X.js","assets/combobox-item-group-Bg4Slb40.js","assets/calcite-input-date-picker-CoOgUF4I.js","assets/input-text-BMNaWK1I.js","assets/calcite-input-number-C2RkDlhZ.js","assets/input-number-CfTJMXXj.js","assets/calcite-input-time-picker--hO1r-3P.js","assets/math-CkFPD3oi.js","assets/calcite-input-time-zone-D42iDMYS.js","assets/calcite-text-area-CsEUbODU.js","assets/throttle-B9yWORl3.js","assets/previewSymbol2D-CazLRysr.js","assets/previewCIMSymbol-BQBea4d8.js","assets/CIMSymbolRasterizer-DXOYaRBd.js","assets/SelfSnappingEngine-oFtQ9oyH.js","assets/geodesicLengthMeasurementUtils-aKK2JX7V.js","assets/geometryEngine-TWT-eAO7.js","assets/hydrated-9-RWfdv1.js","assets/GridSnappingEngine-ESnzrF91.js","assets/Upload-C27B9pol.js","assets/progressUtils-DP8A_uOL.js","assets/editingTools-Ch1OnvIB.js","assets/SnappingVisualizer2D-BJn51igu.js","assets/SnappingContext-B18hoYec.js","assets/PointSnappingHint-AK6eT6XJ.js","assets/automaticLengthMeasurementUtils-DtYsKEhL.js","assets/editPlaneUtils-DnNfWwtr.js","assets/helpMessageUtils3d-D44teqP4.js","assets/GraphicManipulator-Cc2xYGId.js","assets/drawUtils-C-ib6wg9.js","assets/ImageMaterial.glsl-BPsHBZUt.js","assets/TextOverlayItem-CI9KU8jv.js","assets/OverlayCompositing.glsl-BdWJ9dYd.js","assets/line-B3A6Shbe.js","assets/triangulationUtils-DYBtHM4K.js","assets/RibbonLine.glsl-BRlvmZSr.js","assets/DefaultLayouts-CpAPH6T4.js","assets/SelectedVertexTooltipInfo-DtoIbX-j.js","assets/TranslateTooltipInfo-x20Np7PO.js","assets/persistable-RFKVf4Z5.js","assets/resourceExtension-UaJY_0EB.js","assets/ExtentScaleTooltipInfo-Dd_ABieO.js","assets/LineCallout.glsl-DwFUBaWf.js","assets/geometryServiceUtils-CXXR2rKW.js","assets/GraphicMover-C-z_G-S4.js","assets/Box-PS3VvIsX.js","assets/settings-DHFzbEJO.js","assets/Reshape-CaegEi0x.js","assets/calcite-tooltip-DHysjdJv.js","assets/calcite-checkbox-D7cySzqb.js","assets/GridControls-BtoSKwMj.js","assets/calcite-accordion-yML8vOIh.js","assets/calcite-accordion-item-BbVSO2ON.js","assets/MapImageLayer-D3RDKDRf.js","assets/SublayersOwner-Bq208Zmn.js","assets/imageBitmapUtils-C8aS69lc.js","assets/calcite-link-CePZkldV.js","assets/calcite-action-group-B6cGYo2B.js","assets/action-group-ZaT5qOFT.js","assets/calcite-action-menu-CzcgXQJh.js","assets/ElevationProfileView2D-CxSf8RhQ.js","assets/HoveredPoints-DzkJRY6G.js","assets/ElevationProfileView3D-N92bioYZ.js","assets/calcite-option-DtIKFu1I.js","assets/calcite-select-DcusL6Ql.js","assets/chartUtils-DhrT9nUT.js","assets/ResponsiveTheme-CDvlYDgs.js","assets/Theme-UVcs7T9B.js","assets/chartUtilsAm5-LclRXLzy.js","assets/Tooltip-7ZisqvDP.js","assets/DefaultTheme-BKjULGwp.js","assets/LineSeries-CiITLLN7.js","assets/ColorSet-D_2jxhZI.js","assets/Tick-ttBH7KXy.js","assets/Button-BXJc_YUC.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();function l(t,e,i,r){var n,s=arguments.length,o=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function ZWe(t,e){return function(i,r){e(i,r,t)}}function JWe(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function a(p){try{d(r.next(p))}catch(h){o(h)}}function u(p){try{d(r.throw(p))}catch(h){o(h)}}function d(p){p.done?s(p.value):n(p.value).then(a,u)}d((r=r.apply(t,[])).next())})}const wde="modulepreload",Sde=function(t){return"/map-test/dist/"+t},Rj={},k=function(e,i,r){let n=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(i.map(u=>{if(u=Sde(u),u in Rj)return;Rj[u]=!0;const d=u.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":wde,d||(h.as="script"),h.crossOrigin="",h.href=u,a&&h.setAttribute("nonce",a),document.head.appendChild(h),d)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};let Hh;function G(t){return typeof Hh[t]=="function"?Hh[t]=Hh[t](globalThis):Hh[t]}var BW,HW,qW,WW;Hh=(BW=globalThis.dojoConfig)!=null&&BW.has||(HW=globalThis.esriConfig)!=null&&HW.has?{...(qW=globalThis.dojoConfig)==null?void 0:qW.has,...(WW=globalThis.esriConfig)==null?void 0:WW.has}:{},G.add=(t,e,i,r)=>{(r||Hh[t]===void 0)&&(Hh[t]=e),i&&G(t)},G.cache=Hh,G.add("big-integer-warning-enabled",!0),G.add("esri-deprecation-warnings",!0),G.add("esri-tests-disable-screenshots",!1),G.add("esri-tests-use-full-window",!1),G.add("esri-tests-post-to-influx",!0),G.add("esri-cim-animations-enable-status","enabled"),G.add("esri-cim-animations-spotlight",!1),G.add("esri-cim-animations-freeze-time",!1),G.add("enable-feature:multiple-highlights",!1),(()=>{var e;G.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(G.add("host-browser",t),G.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),G.add("dom",t),G("host-browser")){const i=navigator,r=i.userAgent,n=i.appVersion,s=parseFloat(n);if(G.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),G.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),G.add("khtml",n.includes("Konqueror")?s:void 0),G.add("edge",parseFloat(r.split("Edge/")[1])||void 0),G.add("opr",parseFloat(r.split("OPR/")[1])||void 0),G.add("webkit",!G("wp")&&!G("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),G.add("chrome",!G("edge")&&!G("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),G.add("android",!G("wp")&&parseFloat(r.split("Android ")[1])||void 0),G.add("safari",!n.includes("Safari")||G("wp")||G("chrome")||G("android")||G("edge")||G("opr")?void 0:parseFloat(n.split("Version/")[1])),G.add("mac",n.includes("Macintosh")),!G("wp")&&/(iPhone|iPod|iPad)/.test(r)){const o=RegExp.$1.replace(/P/,"p"),a=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",u=parseFloat(a.replace(/_/,".").replaceAll("_",""));G.add(o,u),G.add("ios",u)}G("webkit")||(!r.includes("Gecko")||G("wp")||G("khtml")||G("edge")||G.add("mozilla",s),G("mozilla")&&G.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&G.add("esri-mobile",e),i&&G.add("esri-iPhone",i),G.add("esri-geolocation",!!navigator.geolocation)}G.add("esri-wasm","WebAssembly"in globalThis),G.add("esri-performance-mode-frames-between-render",20),G.add("esri-force-performance-mode",!1),G.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),G.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),G.add("esri-atomics","Atomics"in globalThis),G.add("esri-workers","Worker"in globalThis),G.add("web-feat:cache","caches"in globalThis),G.add("esri-workers-arraybuffer-transfer",!G("safari")||Number(G("safari"))>=12),G.add("workers-pool-size",8),G.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),G.add("featurelayer-simplify-payload-size-factors",[1,1,4]),G.add("featurelayer-fast-triangulation-enabled",!0),G.add("featurelayer-animation-enabled",!0),G.add("featurelayer-snapshot-enabled",!0),G.add("featurelayer-snapshot-point-min-threshold",8e4),G.add("featurelayer-snapshot-point-max-threshold",4e5),G.add("featurelayer-snapshot-point-coverage",.1),G.add("featurelayer-query-max-depth",4),G.add("featurelayer-query-pausing-enabled",!1),G.add("featurelayer-advanced-symbols",!1),G.add("featurelayer-pbf",!0),G.add("featurelayer-pbf-statistics",!1),G.add("feature-layers-workers",!0),G.add("feature-polyline-generalization-factor",1),G.add("mapview-transitions-duration",200),G.add("mapview-essential-goto-duration",200),G.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),G.add("mapserver-pbf-version-support",10.81),G.add("mapservice-popup-identify-max-tolerance",20),G("host-webworker")||G("host-browser")&&(G.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),G.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{G.add("esri-image-decode",!0,!0,!0)}).catch(()=>{G.add("esri-image-decode",!1,!0,!0)})}return!1}),G.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();let fL=class Km{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*Km._m}getInt(){return this._seed=(Km._a*this._seed+Km._c)%Km._m,this._seed}getFloat(){return this.getInt()/(Km._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const r=i-e;return e+this.getInt()/Km._m*r}};fL._m=2147483647,fL._a=48271,fL._c=0;const $de=1.5,YWe=1/$de,KWe=.5;function Ede(t,e){if(!e)return t;for(const i of e)t.push(i);return t}function QW(t){return t}function Tde(t,e=QW){if(!t||t.length===0)return;let i=t[0],r=e(i);for(let n=1;n<t.length;++n){const s=t[n],o=Number(e(s));o>r&&(r=o,i=s)}return i}function eZ(t,e=QW){return Tde(t,i=>-e(i))}function Ide(t,e){return e?t.filter((i,r,n)=>n.findIndex(e.bind(null,i))===r):Array.from(new Set(t))}function eg(t,e,i){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(i){for(let r=0;r<t.length;r++)if(!i(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function RO(t,e,i){let r,n;return i?(r=e.filter(s=>!t.some(o=>i(o,s))),n=t.filter(s=>!e.some(o=>i(o,s)))):(r=e.filter(s=>!t.includes(s)),n=t.filter(s=>!e.includes(s))),{added:r,removed:n}}function XWe(t){return t&&typeof t.length=="number"}function xde(t,e){const i=t.length;if(i===0)return[];const r=[];for(let n=0;n<i;n+=e)r.push(t.slice(n,n+e));return r}let tZ=class{constructor(){this.last=0}};const iZ=new tZ;function PO(t,e,i,r){r=r||iZ;const n=Math.max(0,r.last-10);for(let o=n;o<i;++o)if(t[o]===e)return r.last=o,o;const s=Math.min(n,i);for(let o=0;o<s;++o)if(t[o]===e)return r.last=o,o;return-1}function Mde(t,e,i,r){const n=t.length,s=PO(t,e,n,r);if(s!==-1)return t[s]=t[n-1],t.pop(),e}const ll=new Set;function Cde(t,e,i=t.length,r=e.length,n,s){if(r===0||i===0)return i;ll.clear();for(let a=0;a<r;++a)ll.add(e[a]);n=n||iZ;const o=Math.max(0,n.last-10);for(let a=o;a<i;++a)if(ll.has(t[a])&&(s==null||s.push(t[a]),ll.delete(t[a]),t[a]=t[i-1],--i,--a,ll.size===0||i===0))return ll.clear(),i;for(let a=0;a<o;++a)if(ll.has(t[a])&&(s==null||s.push(t[a]),ll.delete(t[a]),t[a]=t[i-1],--i,--a,ll.size===0||i===0))return ll.clear(),i;return ll.clear(),i}function eZe(t,e){let i=0;for(let r=0;r<t.length;++r){const n=t[r];e(n,r)&&(t[i]=n,i++)}t.length=i}function RS(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function ot(t,e){return t!=null}const tZe=[];function rZ(t){return 32+t.length}function YD(){return 16}function iZe(t){if(!t)return 0;let e=sZ;for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];switch(typeof r){case"string":e+=rZ(r);break;case"number":e+=YD();break;case"boolean":e+=4}}return e}function kde(t){if(!t)return 0;if(Array.isArray(t))return Lde(t);let e=sZ;for(const i in t)t.hasOwnProperty(i)&&(e+=nZ(t[i]));return e}function Lde(t){const e=t.length;if(e===0||typeof t[0]=="number")return 32+8*e;let i=oZ;for(let r=0;r<e;r++)i+=nZ(t[r]);return i}function nZ(t){switch(typeof t){case"object":return kde(t);case"string":return rZ(t);case"number":return YD();case"boolean":return 4;default:return 8}}function Ade(t,e){return oZ+t.length*e}const sZ=32,oZ=16;function rZe(t){return t instanceof ArrayBuffer}function KD(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function aZ(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function lZ(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function XD(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function uZ(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function QD(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function cZ(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function $C(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function EC(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function dZ(t){return!("buffer"in t)}function nZe(...t){return t.reduce((e,i)=>e+(i?dZ(i)?Ade(i,YD()):i.byteLength+Ode:0),0)}const Ode=145,pZ=1024;function sZe(t){return EC(t)||$C(t)||QD(t)||XD(t)||KD(t)}function oZe(t){return EC(t)||$C(t)}function aZe(t){return EC(t)?179769e303:$C(t)?3402823e32:cZ(t)?4294967295:uZ(t)?65535:aZ(t)||lZ(t)?255:QD(t)?2147483647:XD(t)?32767:KD(t)?127:256}function Rde(t,e){let i;for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function R(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=fZ(t);if(e!=null)return e;if(AM(t))return t.clone();if(hZ(t))return t.map(R);if(mZ(t))return t.clone();const i={};for(const r of Object.getOwnPropertyNames(t))i[r]=R(t[r]);return i}function FO(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=fZ(t);if(e!=null)return e;if(hZ(t)){let i=!0;const r=t.map(n=>{const s=FO(n);return n!=null&&s==null&&(i=!1),s});return i?r:null}if(AM(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!mZ(t)){const i=new(Object.getPrototypeOf(t)).constructor;for(const r of Object.getOwnPropertyNames(t)){const n=t[r],s=FO(n);if(n!=null&&s==null)return null;i[r]=s}return i}return null}function AM(t){return typeof t.clone=="function"}function hZ(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function mZ(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function Pj(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function fZ(t){if(KD(t)||aZ(t)||lZ(t)||XD(t)||uZ(t)||QD(t)||cZ(t)||$C(t)||EC(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,r]of t)e.set(i,R(r));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(R(i));return e}return null}function eV(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t==null?void 0:t.getTime)=="function"&&typeof(e==null?void 0:e.getTime)=="function"&&t.getTime()===e.getTime()||!1}function tV(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&eg(t,e):t instanceof Set?e instanceof Set&&Fde(t,e):t instanceof Map?e instanceof Map&&Nde(t,e):!!Pj(t)&&Pj(e)&&Pde(t,e))}function Pde(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const r of i)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function Fde(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function Nde(t,e){if(t.size!==e.size)return!1;for(const[i,r]of t){const n=e.get(i);if(n!==r||n===void 0&&!e.has(i))return!1}return!0}function iV(t,e,i=!1){return gZ(t,e,i)}function k$(t,e){if(e!=null)return e[t]||yZ(t.split("."),!1,e)}function Zr(t,e,i){const r=t.split("."),n=r.pop(),s=yZ(r,!0,i);s&&n&&(s[n]=e)}function Fj(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let r=0;r<t.length;r++)if(Fj(t[r],i[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t)if(Fj(t[i],e[i]))return!0;return!1}return t!==e}function yZ(t,e,i){let r=i;for(const n of t){if(r==null)return;if(!(n in r)){if(!e)return;r[n]={}}r=r[n]}return r}function gZ(t,e,i){return e?Object.keys(e).reduce((r,n)=>{let s=r[n],o=e[n];return s===o?r:s===void 0?(r[n]=R(o),r):(Array.isArray(o)||Array.isArray(r)?(s=s?Array.isArray(s)?r[n]=s.slice():r[n]=[s]:r[n]=[],o&&(Array.isArray(o)||(o=[o]),i?o.forEach(a=>{s.includes(a)||s.push(a)}):r[n]=o.slice())):o&&typeof o=="object"?r[n]=gZ(s,o,i):r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[n]=o),r)},t||{}):t}const TC="20241020",vZ="bd3b8a290e6104f2acfbe70391ba8f3c465ef546";var ZW;const et={apiKey:void 0,applicationName:"",applicationUrl:(ZW=globalThis.location)==null?void 0:ZW.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(iV(et,globalThis.esriConfig,!0),delete et.has),!et.assetsPath){{const t="4.31.0";et.assetsPath=`https://cdn.jsdelivr.net/npm/@arcgis/core@${t}-next.${TC}/assets`}et.defaultAssetsPath=et.assetsPath}const Dde=/\{([^}]+)\}/g;function Nj(t){return t??""}function mu(t,e){return e?t.replaceAll(Dde,typeof e=="object"?(i,r)=>Nj(k$(r,e)):(i,r)=>Nj(e(r))):t}function Vde(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,i=>e!=null&&e.includes(i)?i:`\\${i}`)}function bZ(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let Dj;function Ude(t){return Dj??(Dj=new DOMParser),Dj.parseFromString(t||"","text/html").body.innerText||""}function PS(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function lZe(t,...e){let i=t[0];for(let r=0;r<e.length;++r)i+=e[r]+t[r+1];return i}const Vj={info:0,warn:1,error:2,none:3};let U=class wo{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,wo._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=wo.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,wo._loggers.get(e)||new wo({module:e})}_log(e,i,...r){if(this._matchLevel(e)){if(i!=="always"&&!wo._throttlingDisabled){const n=Gde(r),s=this._loggedMessages[e].get(n);if(i==="once"&&s!=null||i==="oncePerTick"&&s&&s>=wo._tickCounter)return;this._loggedMessages[e].set(n,wo._tickCounter),wo._scheduleTickCounterIncrement()}for(const n of et.log.interceptors)if(n(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,i){let r=this;for(;r!=null;){const n=r[e];if(n!=null)return n;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",jde)}_matchLevel(e){const i=et.log.level||"warn";return Vj[this._parentWithMember("level",i)]<=Vj[e]}static _scheduleTickCounterIncrement(){wo._tickCounterScheduled||(wo._tickCounterScheduled=!0,Promise.resolve().then(()=>{wo._tickCounter++,wo._tickCounterScheduled=!1}))}};function jde(t,e,...i){console[t](`[${e}]`,...i)}function Gde(...t){return bZ(JSON.stringify(t,(i,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}U._loggers=new Map,U._tickCounter=0,U._tickCounterScheduled=!1,U._throttlingDisabled=!1;function zde(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(i,r)=>r===""?"$":(k$(r,e)??"").toString())}let _Z=class{constructor(e,i,r=void 0){this.name=e,this.details=r,this.message=(i&&zde(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},L=class wZ extends _Z{constructor(e,i,r){super(e,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return R(i)}catch{return"[object]"}}))}}catch(e){throw U.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new wZ(e.name,e.message,e.details)}};L.prototype.type="error";const Uj=new WeakMap;function Bde(t,e,i=!1){const r=`🛑 DEPRECATED - ${e}`;if(!i)return void t.warn(r);let n=Uj.get(t);n||(n=new Set,Uj.set(t,n)),n.has(e)||(n.add(e),t.warn(r))}function IC(t,e,i={}){if(G("esri-deprecation-warnings")){const{moduleName:r}=i;FS(t,`Function: ${(r?r+"::":"")+e+"()"}`,i)}}function Ga(t,e,i={}){if(G("esri-deprecation-warnings")){const{moduleName:r}=i;FS(t,`Property: ${(r?r+"::":"")+e}`,i)}}function Hde(t,e,i={}){G("esri-deprecation-warnings")&&FS(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function FS(t,e,i={}){if(G("esri-deprecation-warnings")){const{replacement:r,version:n,see:s,warnOnce:o}=i;let a=e;r&&(a+=`
	🛠️ Replacement: ${r}`),n&&(a+=`
	⚙️ Version: ${n}`),s&&(a+=`
	🔗 See ${s} for more details.`),Bde(t,a,o)}}function cZe(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function qde(t,e){for(const i of t)if(i!=null&&e(i))return i}function NS(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let e_=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(NS(e)){const r=this._getOrCreateGroup(i);for(const n of e)Gj(n)&&r.push(n)}else Gj(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&i&&r.forEach(i)}}has(e){return this._groups.has(JE(e))}remove(e){if(typeof e!="string"&&NS(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(jj(this._getGroup(e)),this._groups.delete(JE(e)),this):this}removeAll(){return this._groups.forEach(jj),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(JE(e),i),i}_getGroup(e){return this._groups.get(JE(e))}};function JE(t){return t||"_default_"}function jj(t){for(const e of t)e instanceof e_?e.removeAll():e.remove()}function Gj(t){return t!=null&&(!!t.remove||t instanceof e_)}function $m(t,e){if(t==null)throw new Error(e??"value is None")}function xe(t){return t==null||t.destroy(),null}function pZe(t){return t==null||t.dispose(),null}function Kt(t){return t==null||t.remove(),null}function mr(t){return t==null||t.abort(),null}function hZe(t){return t==null||t.release(),null}function Wde(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function mb(t,e){let i;return t.some((r,n)=>(i=e(r,n),i!=null)),i??void 0}const SZ=Symbol("Accessor-beforeDestroy"),Zde={remove:()=>{}};function ye(t){return t?{remove(){t&&(t(),t=void 0)}}:Zde}function $Z(t){t.forEach(e=>e==null?void 0:e.remove())}function Su(t){$Z(t),t.length=0}function kr(t){return ye(()=>$Z(t))}function mZe(t){return ye(()=>{var e;return(e=t())==null?void 0:e.remove()})}function Jde(t){return ye(()=>t==null?void 0:t.abort())}function Yde(t){return ye(t!=null?()=>t.destroy():void 0)}function ao(t){return t.__accessor__??null}function Kde(t,e){var i;return((i=t==null?void 0:t.metadata)==null?void 0:i[e])!=null}function PI(t,e,i){return i?OM(t,e,{policy:i,path:""}):OM(t,e,null)}function OM(t,e,i){return e?Object.keys(e).reduce((r,n)=>{const s=n;let o=null,a="merge";if(i&&(o=i.path?`${i.path}.${n}`:n,a=i.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[s]))return r[s]=e[s],r;if(r[s]===void 0)return r[s]=R(e[s]),r;let u=r[s],d=e[s];if(u===d)return r;if(Array.isArray(d)||Array.isArray(r))u=u?Array.isArray(u)?r[s]=u.slice():r[s]=[u]:r[s]=[],d&&(Array.isArray(d)||(d=[d]),d.forEach(p=>{u.includes(p)||u.push(p)}));else if(d&&typeof d=="object")if(i){const p=i.path;i.path=o,r[s]=OM(u,d,i),i.path=p}else r[s]=OM(u,d,null);else r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[s]=d);return r},t||{}):t}function EZ(t){return Array.isArray(t)?t:t.split(".")}function zj(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function Xde(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...zj(i));return e}return zj(t)}function TZ(t,e,i,r){const n=Xde(e);if(n.length!==1){const s=n.map(o=>r(t,o,i));return kr(s)}return r(t,n[0],i)}function IZ(t,e){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const r=ao(e);return Kde(r,i)?r.get(i):e[i]}function xZ(t,e,i){if(t==null)return t;const r=IZ(e[i],t);return!r&&i<e.length-1?void 0:i===e.length-1?r:xZ(r,e,i+1)}function L$(t,e,i=0){return typeof e!="string"||e.includes(".")?xZ(t,EZ(e),i):IZ(e,t)}function rs(t,e){return L$(t,e)}function Bj(t,e){return L$(e,t)!==void 0}var eo;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"})(eo||(eo={}));function A$(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const r in e)e[r]=R(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function xC(t,e){const i=A$(t);let r=i[e];return r||(r=i[e]={}),r}function Qde(t,e){return PI(t,e,tpe)}const epe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function tpe(t){return epe.test(t)?"replace":"merge"}function ipe(t){return(t==null?void 0:t.release)&&typeof t.release=="function"}function rpe(t){return(t==null?void 0:t.acquire)&&typeof t.acquire=="function"}let tg=class NO{constructor(e,i,r,n=1,s=0){this._ctor=e,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=n,this._pool=new Array(s),this._initialSize=s;for(let o=0;o<s;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...e){let i;if(NO.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let n=0;n<r;n++)this._pool[n]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):rpe(i)&&i.acquire(...e),i}release(e){e&&!NO.test.disabled&&(this._releaseFunction?this._releaseFunction(e):ipe(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};tg.test={disabled:!1};let npe=class{constructor(e,i){this._observers=e,this._observer=i}remove(){RS(this._observers,this._observer)}},MZ=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return spe;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,n=!1;const s=i.length;for(let o=0;o<s;++o){const a=i[o];if(a.destroyed)n=!0;else if(a===e){r=!0;break}}return r||(i.push(e),n&&this._removeDestroyedObservers()),new npe(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let r=0;for(let n=0;n<i;++n){for(;n+r<i&&e[n+r].destroyed;)++r;if(r>0){if(!(n+r<i))break;e[n]=e[n+r]}}e.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const spe=ye();var Le;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(Le||(Le={}));const DO=Le.USER+1;function qh(t){switch(t){case"defaults":return Le.DEFAULTS;case"service":return Le.SERVICE;case"portal-item":return Le.PORTAL_ITEM;case"web-scene":return Le.WEB_SCENE;case"web-map":return Le.WEB_MAP;case"link-chart":return Le.LINK_CHART;case"user":return Le.USER;default:return null}}function RM(t){switch(t){case Le.DEFAULTS:return"defaults";case Le.SERVICE:return"service";case Le.PORTAL_ITEM:return"portal-item";case Le.WEB_SCENE:return"web-scene";case Le.WEB_MAP:return"web-map";case Le.LINK_CHART:return"link-chart";case Le.USER:return"user"}}function ope(t){return RM(t)}var Rt;(function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(Rt||(Rt={}));let MC=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){var e;(e=this.accessed)==null||e.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const PM=new MC,kw=[];let eS=PM;function he(t){eS.onAccessed(t)}let FI=!1,NI=!1;function lp(t,e,i){if(FI)return rV(t,e,i);let r=null;return CZ(t),r=e.call(i),kZ(),r}function ape(t,e){return lp(PM,t,e)}function rV(t,e,i){const r=FI;FI=!0,CZ(t);let n=null;try{n=e.call(i)}catch(s){NI&&U.getLogger("esri.core.accessorSupport.tracking").error(s)}return kZ(),FI=r,n}function CZ(t){eS=t,kw.push(t)}function kZ(){const t=kw.length;if(t>1){const e=kw.pop();eS=kw[t-2],e.onTrackingEnd()}else if(t===1){const e=kw.pop();eS=PM,e.onTrackingEnd()}else eS=PM}function LZ(t,e){if(e.flags&Rt.DepTrackingInitialized)return;e.flags|=Rt.DepTrackingInitialized;const i=NI;NI=!1,e.flags&Rt.AutoTracked?rV(e.trackingTarget,e.metadata.get,t):AZ(t,e),NI=i}const lpe=[];function AZ(t,e){e.flags&Rt.ExplicitlyTracking||(e.flags|=Rt.ExplicitlyTracking,rV(e.trackingTarget,()=>{const i=e.metadata.dependsOn||lpe;for(const r of i)if(typeof r!="string"||r.includes(".")){const n=EZ(r);for(let s=0,o=t;s<n.length&&o!=null&&typeof o=="object";++s)o=Hj(o,n[s],s!==n.length-1)}else Hj(t,r,!1)}),e.flags&=~Rt.ExplicitlyTracking)}function Hj(t,e,i){const r=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const n=ao(t);if(n){const s=n.propertiesByName.get(r);s&&(he(s),LZ(t,s))}return i?t[r]:void 0}let qj=class extends MZ{constructor(e,i){super(),this.propertyName=e,this.metadata=i,this.trackingTarget=new MC(this),this.flags=0,this.flags=Rt.Dirty|(i.nonNullable?Rt.NonNullable:0)|(i.hasOwnProperty("value")?Rt.HasDefaultValue:0)|(i.get===void 0?Rt.DepTrackingInitialized:0)|(i.dependsOn===void 0?Rt.AutoTracked:0)}destroy(){this.flags&Rt.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&he(this);const i=e.store,r=this.propertyName,n=this.flags,s=i.get(r);if(n&Rt.Computing||~n&Rt.Dirty&&i.has(r))return s;this.flags|=Rt.Computing;const o=e.host;let a;n&Rt.AutoTracked?a=lp(this.trackingTarget,this.metadata.get,o):(AZ(o,this),a=this.metadata.get.call(o)),this.flags|=Rt.DepTrackingInitialized,i.set(r,a,Le.COMPUTED);const u=i.get(r);return u===s?this.flags&=~Rt.Dirty:ape(this.commit,this),this.flags&=~Rt.Computing,u}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~Rt.Dirty,this.onCommitted()}onInvalidated(){~this.flags&Rt.Overridden&&(this.flags|=Rt.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onCommitted()}}},upe=class OZ{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new OZ;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,R(r))}),i}get(e){return this._values.get(e)}originOf(){return Le.USER}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function YE(t,e,i){return t!==void 0}function Wj(t,e,i,r){return t!==void 0&&(!(i==null&&t.flags&Rt.NonNullable)||(r.lifecycle,eo.INITIALIZING,!1))}let cpe=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=eo.INITIALIZING,this.store=new upe,this.mutable=!0,this._origin=Le.USER;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const n=new qj(r,i[r]);this.propertiesByName.set(r,n)}this.metadata=i}initialize(){this.lifecycle=eo.CONSTRUCTING}constructed(){this.lifecycle=eo.CONSTRUCTED}destroy(){this.lifecycle=eo.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==eo.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(i.metadata.get)return i.getComputed(this);this.mutable&&he(i);const r=this.store;return r.has(e)?r.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&Rt.HasDefaultValue)return"defaults"}return RM(i)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(YE(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const r=this.propertiesByName.get(e);YE(r)&&this._internalSet(r,i)}getDependsInfo(e,i,r){const n=this.propertiesByName.get(i);if(!YE(n))return"";const s=new MC,o=lp(s,()=>{var d;return(d=n.metadata.get)==null?void 0:d.call(e)});let a=`${r}${e.declaredClass.split(".").pop()}.${i}: ${o}
`;const u=s.accessed??new Set;if(u.size===0)return a;r+="  ";for(const d of u)d instanceof qj&&(a+=`${r}${d.propertyName}: undefined
`);return a}setAtOrigin(e,i,r){const n=this.propertiesByName.get(e);if(YE(n))return this._setAtOrigin(n,i,r)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.flags&Rt.Overridden)}clearOverride(e){const i=this.propertiesByName.get(e);i&&i.flags&Rt.Overridden&&(i.flags&=~Rt.Overridden,i.notifyChange())}override(e,i){const r=this.propertiesByName.get(e);if(!Wj(r,e,i,this))return;const n=r.metadata.cast;if(n){const s=this._cast(n,i),{valid:o,value:a}=s;if(yL.release(s),!o)return;i=a}r.flags|=Rt.Overridden,this._internalSet(r,i)}set(e,i){const r=this.propertiesByName.get(e);if(!Wj(r,e,i,this))return;const n=r.metadata.cast;if(n){const o=this._cast(n,i),{valid:a,value:u}=o;if(yL.release(o),!a)return;i=u}const s=r.metadata.set;s?s.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(e){this._origin=qh(e)}getDefaultOrigin(){return RM(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const r=this.lifecycle!==eo.INITIALIZING?this._origin:Le.DEFAULTS;this._setAtOrigin(e,i,r)}_setAtOrigin(e,i,r){const n=this.store,s=e.propertyName;n.has(s,r)&&eV(i,n.get(s))&&~e.flags&Rt.Overridden&&r===n.originOf(s)||(e.invalidate(),n.set(s,i,r),e.commit(),LZ(this.host,e))}_cast(e,i){const r=yL.acquire();return r.valid=!0,r.value=i,e&&(r.value=e.call(this.host,i,r)),r}},dpe=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const yL=new tg(dpe);function FM(t,e,i){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))FM(t,r,e[r]);else{if(e.includes(".")){const n=e.split("."),s=n.splice(-1,1)[0];return void FM(rs(t,n),s,i)}const r=t.__accessor__;r!=null&&ppe(e,r),t[e]=i}}function ppe(t,e){if(G("esri-unknown-property-errors")&&!hpe(t,e))throw new L("set:unknown-property",mpe(t,e))}function hpe(t,e){return e.metadata[t]!=null}function mpe(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let fpe;function ype(){return fpe}var Zj;(function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"})(Zj||(Zj={}));function gpe(t){t.length=0}let Is=class{constructor(e=50,i=50){this._pool=new tg(Array,void 0,gpe,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return gL.acquire()}static release(e){return gL.release(e)}static prune(){gL.prune()}};const gL=new Is(100);let RZ=class extends tg{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const KE=[];function fb(t){KE.push(t),KE.length===1&&queueMicrotask(()=>{const e=KE.slice();KE.length=0;for(const i of e)i()})}let tS=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var VO;(function(t){const e=(s,o,a,u)=>{let d=o,p=o;const h=a>>>1,m=s[d-1];for(;p<=h;){p=d<<1,p<a&&u(s[p-1],s[p])<0&&++p;const y=s[p-1];if(u(y,m)<=0)break;s[d-1]=y,d=p}s[d-1]=m},i=(s,o)=>s<o?-1:s>o?1:0;function r(s,o,a,u){o===void 0&&(o=0),a===void 0&&(a=s.length),u===void 0&&(u=i);for(let p=a>>>1;p>o;p--)e(s,p,a,u);const d=o+1;for(let p=a-1;p>o;p--){const h=s[o];s[o]=s[p],s[p]=h,e(s,d,p,u)}}function*n(s,o,a,u){o===void 0&&(o=0),a===void 0&&(a=s.length),u===void 0&&(u=i);for(let p=a>>>1;p>o;p--)e(s,p,a,u),yield;const d=o+1;for(let p=a-1;p>o;p--){const h=s[o];s[o]=s[p],s[p]=h,e(s,d,p,u),yield}}t.sort=r,t.iterableSort=n})(VO||(VO={}));const Jj=VO,vpe=1.5,bpe=1.1;let vy=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new tZ,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>Yj(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let r=0;r<this._length;r++){const n=this.data[r];e(n)&&i.push(n)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const r=this.data.indexOf(e,i);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let r=0;r<i;r++)this.data[this._length++]=e[r]}fill(e,i){for(let r=0;r<i;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,Yj(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=PO(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(PO(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,r){this.length=Cde(this.data,e,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const r=this.data[e];this.data[e]=this.data[i],this.data[i]=r}sort(e){Jj.sort(this.data,0,this.length,e)}iterableSort(e){return Jj.iterableSort(this.data,0,this.length,e)}some(e,i){for(let r=0;r<this.length;++r)if(e.call(i,this.data[r],r,this.data))return!0;return!1}find(e,i){const{data:r,length:n}=this;for(let s=0;s<n;++s)if(e.call(i,r[s]))return r[s]}filterInPlace(e,i){let r=0;for(let n=0;n<this._length;++n){const s=this.data[n];e.call(i,s,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let n=r;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=r,this._shrink(),this}forAll(e,i){const{data:r,length:n}=this;for(let s=0;s<n;++s)e.call(i,r[s],s,r)}forEach(e,i){this.data.slice(0,this.length).forEach(e,i)}map(e,i){const r=new Array(this.length);for(let n=0;n<this.length;++n)r[n]=e.call(i,this.data[n],n,this.data);return r}reduce(e,i){let r=i;for(let n=0;n<this.length;++n)r=e(r,this.data[n],n,this.data);return r}has(e){const i=this.length,r=this.data;for(let n=0;n<i;++n)if(r[n]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function Yj(t){t.data.length>vpe*t.length&&(t.data.length=Math.floor(t.length*bpe))}function _pe(t){return{setTimeout:(e,i)=>{const r=t.setTimeout(e,i);return ye(()=>t.clearTimeout(r))}}}const t_=_pe(globalThis);function CC(t){return wpe(t)||PZ(t)}function wpe(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function PZ(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function O$(t,e,i){if(!CC(t))throw new TypeError("target is not a Evented or EventTarget object");return PZ(t)?Spe(t,e,i):t.on(e,i)}function Spe(t,e,i,r){if(Array.isArray(e)){const n=e.slice();for(const s of n)t.addEventListener(s,i,r);return ye(()=>{for(const s of n)t.removeEventListener(s,i,r)})}return t.addEventListener(e,i,r),ye(()=>t.removeEventListener(e,i,r))}function FZ(t,e,i){if(!CC(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const r=O$(t,e,n=>{r.remove(),i.call(t,n)});return r}function mt(t="Aborted"){return new L("AbortError",t)}function qe(t,e="Aborted"){if(lo(t))throw mt(e)}function R$(t){return t instanceof AbortSignal?t:(t==null?void 0:t.signal)??void 0}function lo(t){const e=R$(t);return e!=null&&e.aborted}function Vo(t){if(rr(t))throw t}function NM(t){if(!rr(t))throw t}function ks(t,e){const i=R$(t);if(i!=null){if(!i.aborted)return FZ(i,"abort",()=>e());e()}}function nV(t,e){const i=R$(t);if(i!=null)return qe(i),FZ(i,"abort",()=>e(mt()))}function Xa(t,e){return R$(e)==null?t:new Promise((i,r)=>{let n=ks(e,()=>r(mt()));const s=()=>{n=Kt(n)};t.then(s,s),t.then(i,r)})}function rr(t){return(t==null?void 0:t.name)==="AbortError"}async function zo(t){try{return await t}catch(e){if(!rr(e))throw e;return}}async function py(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),r=i.map(o=>t[o]),n=await py(r),s={};return i.map((o,a)=>s[o]=n[a]),s}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(r,n)=>{const s=i[n];return s.status==="fulfilled"?{promise:r,value:s.value}:{promise:r,error:s.reason}}))}async function $pe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function TZe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function i_(t,e=void 0,i){const r=new AbortController;return ks(i,()=>r.abort()),new Promise((n,s)=>{let o=setTimeout(()=>{o=0,n(e)},t);ks(r,()=>{o&&(clearTimeout(o),s(mt()))})})}function Epe(t,e){const i=new AbortController,r=setTimeout(()=>i.abort(),e);return ks(t,()=>{i.abort(),clearTimeout(r)}),{...t,signal:i.signal}}function kc(t){return t&&typeof t.then=="function"}function UO(t){return kc(t)?t:Promise.resolve(t)}function Bo(t,e=-1){let i,r,n,s,o=null;const a=(...u)=>{if(i){r=u,s&&s.reject(mt()),s=fn();const m=s.promise;if(o){const y=o;o=null,y.abort()}return m}if(n=s||fn(),s=null,e>0){const m=new AbortController;i=UO(t(...u,m.signal));const y=i;i_(e).then(()=>{i===y&&(s?m.abort():o=m)})}else i=1,i=UO(t(...u));const d=()=>{const m=r;r=n=i=o=null,m!=null&&a(...m)},p=i,h=n;return p.then(d,d),p.then(h.resolve,h.reject),h.promise};return a}function fn(){let t,e;const i=new Promise((n,s)=>{t=n,e=s}),r=n=>{t(n)};return r.resolve=n=>t(n),r.reject=n=>e(n),r.timeout=(n,s)=>t_.setTimeout(()=>r.reject(s),n),r.promise=i,r}async function Kj(t){await Promise.resolve(),qe(t)}function IZe(t){return t}function Tpe(t){return 1e3*t}function xZe(t){return t}function MZe(t){return .001*t}let Ipe=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},xpe=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},jO=0;const F_={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},GO=["prepare","preRender","render","postRender","update","finish"],zO=[],Ay=new vy;let Mpe=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};function Cpe(){by!=null&&(cancelAnimationFrame(by),by=requestAnimationFrame(sV))}const DM={frameTasks:Ay,willDispatch:!1,clearFrameTasks:kpe,dispatch:DZ,executeFrameTasks:Lpe,reschedule:Cpe};function P$(t){const e=new xpe(t);return zO.push(e),DM.willDispatch||(DM.willDispatch=!0,fb(DZ)),e}function yb(t){const e=new Ipe(t);return Ay.push(e),by==null&&(jO=performance.now(),by=requestAnimationFrame(sV)),new Mpe(e)}let by=null;function kpe(t=!1){Ay.forAll(e=>{e.removed=!0}),t&&NZ()}function sV(){const t=performance.now();by=null,by=Ay.length>0?requestAnimationFrame(sV):null,DM.executeFrameTasks(t)}function Lpe(t){const e=t-jO;jO=t;const i=1e3/60,r=Math.max(0,e-i);F_.time=t,F_.frameDuration=i-r;for(let n=0;n<GO.length;n++){const s=performance.now(),o=GO[n];Ay.forAll(a=>{var u;a.paused||a.removed||(n===0&&a.ticks++,a.phases[o]&&(F_.elapsedFrameTime=performance.now()-t,F_.deltaTime=a.ticks===0?0:e,(u=a.phases[o])==null||u.call(a,F_)))}),Rpe[n].push(performance.now()-s)}NZ(),Ppe.push(performance.now()-t)}const XE=new vy;function NZ(){Ay.forAll(t=>{t.removed&&XE.push(t)}),Ay.removeUnorderedMany(XE.data,XE.length),XE.clear()}function DZ(){for(;zO.length;){const t=zO.shift();t.isActive&&t.callback()}DM.willDispatch=!1}function Ape(t=1,e){const i=fn(),r=()=>{lo(e)?i.reject(mt()):t===0?i():(--t,fb(()=>r()))};return r(),i.promise}function Ope(t){return Ape(1,t)}async function VZ(t){await Ope(t),await new Promise(e=>requestAnimationFrame(()=>{t!=null&&t.aborted||e()}))}const Rpe=GO.map(t=>new tS(t)),Ppe=new tS("total");function UZ(t,e){for(const i of t.values())if(e(i))return!0;return!1}function DS(t,e){if(!e)return t;for(const i of e)i!=null&&t.add(i);return t}function Xj(t,e){return e!=null&&t.add(e),t}function oV(t,e){const i=new Set;return DS(i,t),DS(i,e),i}function jZ(t,e){const i=new Set;for(const r of e)t.has(r)&&i.add(r);return i}function AZe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function OZe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function Fpe(t,e){const i=new Set(t);for(const r of e)i.delete(r);return i}function Npe(t,e){return Fpe(oV(t,e),jZ(t,e))}function Qj(t){let e;for(e of t);return e}let Dpe=0;function rm(){return++Dpe}let kC=class extends MC{constructor(e){super(new Vpe(e)),this._observer&&eG.register(this,new WeakRef(this._observer),this)}destroy(){var e,i;this._observer&&eG.unregister(this._observer),(e=this.accessed)==null||e.clear(),this.clear(),(i=this._observer)==null||i.destroy()}},Vpe=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=Upe}};const eG=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function Upe(){}let R0=!1;const VM=[];function GZ(t,e){let i=new kC(s),r=null,n=!1;function s(){if(!i||n)return;if(R0)return void HZ(s);const a=r;i.clear(),R0=!0,n=!0,r=lp(i,t),n=!1,R0=!1,e(r,a),qZ()}function o(){i&&(i.destroy(),i=null,r=null)}return n=!0,r=lp(i,t),n=!1,ye(o)}function zZ(t,e){let i=new kC(n),r=null;function n(){e(r,o)}function s(){i&&(i.destroy(),i=null),r=null}function o(){return i?(i.clear(),r=lp(i,t),r):null}return o(),ye(s)}function BZ(t,e){let i=!1,r=!1;const n=!!(e!=null&&e.sync);let s=new kC(()=>{i||r||(r=!0,n?o():queueMicrotask(o))});function o(){r=!1,s&&!i&&(R0?HZ(o):(s.clear(),R0=!0,i=!0,lp(s,t),i=!1,R0=!1,qZ()))}function a(){s&&(s.destroy(),s=null)}return i=!0,lp(s,t),i=!1,ye(a)}function HZ(t){VM.includes(t)||VM.unshift(t)}function qZ(){for(;VM.length;)VM.pop()()}var iS;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})(iS||(iS={}));let VS=class{constructor(){this.uid=rm(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,r,n,s){return this.pool.acquire(iS.Untracked,e,i,r,n,s,eV)}static acquireTracked(e,i,r,n){return this.pool.acquire(iS.Tracked,e,i,r,null,null,n)}notify(e,i){this.type===iS.Untracked?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,r,n,s,o,a){this.uid=rm(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=r,this.getValue=n,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=rm(),this.removed=!0}};VS.pool=new RZ(VS);const DI=new Is,Kd=new Set;let UM;function jM(t){Kd.delete(t),Kd.add(t),UM||(UM=P$(zpe))}function jpe(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Gpe(t){for(const e of Kd.values())e.target===t&&(e.removed=!0)}function zpe(){let t=10;for(;UM&&t--;){UM=null;const e=Bpe(),i=DI.acquire();for(const r of e){const n=r.uid;jpe(r),n===r.uid&&r.removed&&i.push(r)}for(const r of Kd)r.removed&&(i.push(r),Kd.delete(r));for(const r of i)VS.pool.release(r);DI.release(i),DI.release(e),BO.forEach(r=>r())}}function Bpe(){const t=DI.acquire();t.length=Kd.size;let e=0;for(const i of Kd)t[e]=i,++e;return Kd.clear(),t}const BO=new Set;function Hpe(t){return BO.add(t),ye(()=>BO.delete(t))}function qpe(t,e,i){let r=TZ(t,e,i,(n,s,o)=>{let a,u,d=zZ(()=>L$(n,s),(p,h)=>{var m;((m=n.__accessor__)==null?void 0:m.lifecycle)===eo.DESTROYED||a&&a.uid!==u?r.remove():(a||(a=VS.acquireUntracked(p,o,h,n,s),u=a.uid),jM(a))});return ye(()=>{d.remove(),a&&(a.uid!==u||a.removed||(a.removed=!0,jM(a)),a=null),r=d=null})});return r}function Wpe(t,e,i){const r=TZ(t,e,i,(n,s,o)=>{let a=!1;return GZ(()=>L$(n,s),(u,d)=>{n.__accessor__.lifecycle!==eo.DESTROYED?a||(a=!0,eV(d,u)||o.call(n,u,d,s,n),a=!1):r.remove()})});return r}function Zpe(t,e,i,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==eo.DESTROYED?r?Wpe(t,e,i):qpe(t,e,i):ye()}function Jpe(t,e,i){let r,n,s=zZ(t,(o,a)=>{r&&r.uid!==n?s.remove():(r||(r=VS.acquireTracked(o,e,a,i),n=r.uid),jM(r))});return ye(()=>{s.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,jM(r)),r=null),s=null})}function Ype(t,e,i){let r=!1;return GZ(t,(n,s)=>{r||(r=!0,i(s,n)||e(n,s),r=!1)})}function Kpe(t,e,i=!1,r=tV){return i?Ype(t,e,r):Jpe(t,e,r)}function tG(t){return UZ(Kd,e=>e.oldValue===t)}function Xpe(t,e){for(const i of t.values())if(e(i))return!0;return!1}function NZe(t,e){for(const i of t.values())if(e(i))return i;return null}function Xd(t,e,i){const r=t.get(e);if(r!==void 0)return r;const n=i();return t.set(e,n),n}function DZe(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}const P0=()=>U.getLogger("esri.core.accessorSupport.ensureTypes");function Qpe(t){return t==null?t:new Date(t)}function ehe(t){return t==null?t:!!t}function F$(t){return t==null?t:t.toString()}function xs(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function LC(t){return t==null?t:Math.round(parseFloat(t))}function the(t){return null}function ihe(t,e){return i=>{let r=t(i);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function WZ(t){return(t==null?void 0:t.constructor)&&t.constructor.__accessorMetadata__!==void 0}function GM(t,e){return e!=null&&t&&!(e instanceof t)}function ZZ(t){return t&&"isCollection"in t}function iG(t){return t!=null&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function rhe(t,e){if(!(e!=null&&e.constructor)||!ZZ(e.constructor))return HO(t,e)?e:new t(e);const i=iG(t.prototype.itemType),r=iG(e.constructor.prototype.itemType);return i?r?i===r?e:i.prototype.isPrototypeOf(r.prototype)?new t(e):(HO(t,e),e):new t(e):e}function HO(t,e){return!!WZ(e)&&(P0().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+AC(t)+"'"),!0)}function r_(t,e){return e==null?e:ZZ(t)?rhe(t,e):GM(t,e)?HO(t,e)?e:new t(e):e}function AC(t){var e;return((e=t==null?void 0:t.prototype)==null?void 0:e.declaredClass)||"unknown"}const nhe=new WeakMap;function she(t){switch(t){case Number:return e=>xs(e);case Xe:return LC;case Boolean:return ehe;case String:return F$;case Date:return Qpe;case n_:return the;default:return Xd(nhe,t,()=>r_.bind(null,t))}}function pi(t,e){const i=she(t);return arguments.length===1?i:i(e)}function US(t,e,i){return arguments.length===1?US.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,i)):[t(e,i)])}function ohe(t,e){return arguments.length===1?US(i=>pi(t,i)):US(i=>pi(t,i),e)}function JZ(t,e,i){return e!==0&&Array.isArray(i)?i.map(r=>JZ(t,e-1,r)):t(i)}function zM(t,e,i){if(arguments.length===2)return s=>zM(t,e,s);if(!i)return i;i=JZ(t,e,i);let r=e,n=i;for(;r>0&&Array.isArray(n);)r--,n=n[0];if(n!==void 0)for(let s=0;s<r;s++)i=[i];return i}function ahe(t,e,i){return arguments.length===2?zM(r=>pi(t,r),e):zM(r=>pi(t,r),e,i)}function YZ(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function qO(t,e){if(arguments.length===2)return qO(t).call(null,e);const i=new Set,r=t.filter(a=>typeof a!="function"),n=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let s=null,o=null;return(a,u)=>{if(a==null)return a;const d=typeof a,p=d==="string"||d==="number";return p&&(i.has(a)||n.some(h=>d==="string"&&h===String||d==="number"&&h===Number))||d==="object"&&n.some(h=>!GM(a,h))?a:(p&&r.length?(s||(s=r.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),P0().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&n.length?(o||(o=n.map(h=>AC(h)).join(", ")),P0().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):P0().error("Accessor#set",`'${a}' is not a valid value for this property`),u&&(u.valid=!1),null)}}function Qa(t,e){if(arguments.length===2)return Qa(t).call(null,e);const i={},r=[],n=[];for(const u in t.typeMap){const d=t.typeMap[u];i[u]=pi(d),r.push(AC(d)),n.push(u)}const s=()=>`'${r.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a=typeof t.key=="string"?u=>u[t.key]:t.key;return u=>{if(t.base&&!GM(t.base,u)||u==null)return u;const d=a(u)||t.defaultKeyValue,p=i[d];if(!p)return P0().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!GM(t.typeMap[d],u))return u;if(typeof t.key=="string"&&!WZ(u)){const h={};for(const m in u)m!==t.key&&(h[m]=u[m]);return p(h)}return p(u)}}let Xe=class{},n_=class{};const jZe={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function lhe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function KZ(t){switch(t.type){case"native":return pi(t.value);case"array":return US(KZ(t.value));case"one-of":return uhe(t);default:return null}}function uhe(t){let e=null;return(i,r)=>ZO(i,t)?i:(e==null&&(e=WO(t)),P0().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function WO(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Xe:return"integer";case Date:return"date";case n_:return"null";default:return AC(t.value)}case"array":return`array of ${WO(t.value)}`;case"one-of":{const e=t.values.map(i=>WO(i));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function ZO(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Xe:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case n_:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!ZO(i,e.value));case"one-of":return e.values.some(i=>ZO(t,i))}}function c(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),n=xC(e,i);r&&(r.get||r.set?(n.get=r.get||n.get,n.set=r.set||n.set):"value"in r&&("value"in t&&U.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=r.value)),t.readOnly!=null&&(n.readOnly=t.readOnly);const s=t.aliasOf;if(s){const u=typeof s=="string"?s:s.source,d=typeof s=="string"?null:s.overridable===!0;let p;n.dependsOn=[u],n.get=function(){let h=rs(this,u);if(typeof h=="function"){p||(p=u.split(".").slice(0,-1).join("."));const m=rs(this,p);m&&(h=h.bind(m))}return h},n.readOnly||(n.set=d?function(h){this._override(i,h)}:function(h){FM(this,u,h)})}const o=t.type,a=t.types;if(!n.cast){let u;o?u=che(o):a&&(u=Array.isArray(a)?US(Qa(a[0])):Qa(a)),t.cast=dhe(t.cast,u)}Qde(n,t),t.range&&(n.cast=ihe(n.cast,t.range))}}function XZ(t,e,i){const r=xC(t,i);r.json||(r.json={});let n=r.json;return e!==void 0&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function che(t){let e=0,i=t;if(lhe(t))return KZ(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const r=i;if(YZ(r))return e===0?qO(r):zM(qO(r),e);if(e===1)return ohe(r);if(e>1)return ahe(r,e);const n=t;return n.from?n.from:pi(n)}function dhe(t,e){if(t||e)return t?e?(i,r)=>e(t(i,r),r):t:e}function phe(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(e[r]){const n=e[r];i[r].forEach(s=>{e[s]=n}),delete e[r]}}}let Jo=class extends _Z{constructor(e,i,r){super(e,i,r)}};Jo.prototype.type="warning";function QZ(t){var e;return!!t&&((e=t.prototype)==null?void 0:e.declaredClass)&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const JO=()=>U.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function rG(t,e,i){var r,n;t&&(!i&&!e.read||(r=e.read)!=null&&r.reader||((n=e.read)==null?void 0:n.enabled)===!1||fhe(t)&&Zr("read.reader",s_(t),e))}function s_(t){var i,r;const e=t.ndimArray??0;if(e>1)return mhe(t);if(e===1)return nG(t);if("type"in t&&tJ(t.type)){const n=(r=(i=t.type.prototype)==null?void 0:i.itemType)==null?void 0:r.Type,s=nG(typeof n=="function"?{type:n}:{types:n});return(o,a,u)=>{const d=s(o,a,u);return d&&new t.type(d)}}return aV(t)}function aV(t){return"type"in t?hhe(t.type):yhe(t.types)}function hhe(t){return t.prototype.read?(e,i,r)=>{if(e==null)return e;const n=typeof e;if(n!=="object")return void JO().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const s=new t;return s.read(e,r),s}:t.fromJSON}function eJ(t,e,i,r){return r!==0&&Array.isArray(e)?e.map(n=>eJ(t,n,i,r-1)):t(e,void 0,i)}function mhe(t){const e=aV(t),i=eJ.bind(null,e),r=t.ndimArray??0;return(n,s,o)=>{if(n==null)return n;n=i(n,o,r);let a=r,u=n;for(;a>0&&Array.isArray(u);)a--,u=u[0];if(u!==void 0)for(let d=0;d<a;d++)n=[n];return n}}function nG(t){const e=aV(t);return(i,r,n)=>{if(i==null)return i;if(Array.isArray(i)){const o=[];for(const a of i){const u=e(a,void 0,n);u!==void 0&&o.push(u)}return o}const s=e(i,void 0,n);return s!==void 0?[s]:void 0}}function tJ(t){if(!QZ(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?lV(e.Type):iJ(e.Type))}function fhe(t){return"types"in t?iJ(t.types):lV(t.type)}function lV(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||tJ(t))}function iJ(t){for(const e in t.typeMap)if(!lV(t.typeMap[e]))return!1;return!0}function yhe(t){let e=null;const i=t.errorContext??"type",r=t.validate;return(n,s,o)=>{if(n==null)return n;const a=typeof n;if(a!=="object")return void JO().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=ghe(t));const u=t.key;if(typeof u!="string")return;const d=n[u],p=d?e[d]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!p){const m=`Type '${d||"unknown"}' is not supported`;return o!=null&&o.messages&&n&&o.messages.push(new Jo(`${i}:unsupported`,m,{definition:n,context:o})),void JO().error(m)}const h=new p;return h.read(n,o),r?r(h):h}}function ghe(t){var i,r;const e={};for(const n in t.typeMap){const s=t.typeMap[n],o=A$(s.prototype);if(typeof t.key=="function")continue;const a=o[t.key];if(!a)continue;if((i=a.json)!=null&&i.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"){e[a.json.type[0]]=s;continue}const u=(r=a.json)==null?void 0:r.write;if(!(u!=null&&u.writer)){e[n]=s;continue}const d=u.target,p=typeof d=="string"?d:t.key,h={};u.writer(n,h,p),h[p]&&(e[h[p]]=s)}return e}function vhe(t){if(t.json||(t.json={}),oG(t.json),aG(t.json),sG(t.json),t.json.origins)for(const e in t.json.origins)oG(t.json.origins[e]),aG(t.json.origins[e]),sG(t.json.origins[e]);return!0}function sG(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function oG(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function aG(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function lG(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=(t==null?void 0:t.ndimArray)??0;t&&(i===1||"type"in t&&QZ(t.type))?e.write.writer=whe:i>1?e.write.writer=She(i):e.types?Array.isArray(e.types)?e.write.writer=_he(e.types[0]):e.write.writer=bhe(e.types):e.write.writer=jS}function bhe(t){return(e,i,r,n)=>e?rJ(e,t,n)?jS(e,i,r,n):void 0:jS(e,i,r,n)}function rJ(t,e,i){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(i!=null&&i.messages){const r=e.errorContext??"type",n=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new L(`${r}:unsupported`,n,{definition:t,context:i})),U.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function _he(t){return(e,i,r,n)=>!e||!Array.isArray(e)?jS(e,i,r,n):jS(e.filter(s=>rJ(s,t,n)),i,r,n)}function jS(t,e,i,r){Zr(i,BM(t,r),e)}function BM(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?HM(t):t}function HM(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function whe(t,e,i,r){let n;t===null?n=null:t&&typeof t.map=="function"?(n=t.map(s=>BM(s,r)),typeof n.toArray=="function"&&(n=n.toArray())):n=[BM(t,r)],Zr(i,n,e)}function nJ(t,e,i){return i!==0&&Array.isArray(t)?t.map(r=>nJ(r,e,i-1)):BM(t,e)}function She(t){return(e,i,r,n)=>{let s;if(e===null)s=null;else{s=nJ(e,n,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let u=0;u<o;u++)s=[s]}Zr(r,s,i)}}function $he(t,e){return uV(t,"any",e==null?void 0:e.origin)}function YO(t,e){return uV(t,"read",e==null?void 0:e.origin)}function sJ(t,e){return uV(t,"write",e==null?void 0:e.origin)}function uV(t,e,i){let r=t==null?void 0:t.json;if(r!=null&&r.origins&&i){let n;n=i==="link-chart"?r.origins[i]&&(e==="any"||e in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],n&&(e==="any"||e in n)&&(r=n)}return r}function Ehe(t){var i;const e=The(t);if(t.json.origins)for(const r in t.json.origins){const n=t.json.origins[r],s=n.types?Ihe(n):e;rG(s,n,!1),n.types&&!n.write&&((i=t.json.write)!=null&&i.enabled)&&(n.write={...t.json.write}),lG(s,n)}rG(e,t.json,!0),lG(e,t.json)}function The(t){return t.json.types?KO(t.json):t.type?oJ(t):KO(t)}function Ihe(t){return t.type?oJ(t):KO(t)}function oJ(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!YZ(i);)i=i[0],e++;return{type:i,ndimArray:e}}function KO(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function xhe(t){vhe(t)&&(phe(t),Ehe(t))}const vL=new Set,bL=new Set;function $(t){return e=>{t??(t="esri.core.Accessor"),e.prototype.declaredClass=t,Che(e);const i=[],r=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!vL.has(n.initialize)&&(vL.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!bL.has(n.destroy)&&(bL.add(n.destroy),r.push(n.destroy)),n=Object.getPrototypeOf(n);vL.clear(),bL.clear();const s=class extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let u=i.length-1;u>=0;u--)i[u].call(this)}}),r.length){let u=!1;const d=this[SZ];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!u){u=!0,d.call(this);for(let p=0;p<r.length;p++)r[p].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};s.__accessorMetadata__=A$(e.prototype),s.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:o,configurable:!0}),s}}function Mhe(t,e){return e.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r===void 0)return;i.mutable&&he(r);const n=i.store;return n.has(t)?n.get(t):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r!==void 0)return r.getComputed(i)}}function Che(t){const e=t.prototype,i=A$(e),r={};for(const n of Object.getOwnPropertyNames(i)){const s=i[n];xhe(s),r[n]={enumerable:!0,configurable:!0,get:Mhe(n,s),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&s.readOnly?uG("read-only",n):a.lifecycle===eo.CONSTRUCTED&&s.constructOnly?uG("construct-only",n):void a.set(n,o)}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,r)}const uG=(t,e)=>{U.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var aJ,lJ;function khe(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Mu=Symbol("Accessor-Handles"),XO=Symbol("Accessor-Initialized");let q=class VI{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:n}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...u){super(...u),this.inherited=null,n&&n.apply(this,u)}}A$(o.prototype);for(const a in e){const u=e[a];o.prototype[a]=typeof u=="function"?function(...d){const p=this.inherited;let h;this.inherited=function(...m){if(s.prototype[a])return s.prototype[a].apply(this,m)};try{h=u.apply(this,d)}catch(m){throw this.inherited=p,m}return this.inherited=p,h}:e[a]}for(const a in i){const u=khe(i[a]);c(u)(o.prototype,a)}return $(r)(o)}static freeze(e){return e instanceof VI?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof VI?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){var r;if(this[aJ]=null,this[lJ]=!1,this.constructor===VI)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new cpe(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&(i.ctorArgs=((r=this.normalizeCtorArgs)==null?void 0:r.apply(this,e))??e[0])}postscript(){const e=this.__accessor__,i=e.ctorArgs;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[XO]=!0}initialize(){}[SZ](){this[Mu]=xe(this[Mu])}destroy(){var e;this.destroyed||(Gpe(this),this.__accessor__.destroy(),(e=ype())==null||e.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[XO]}get destroyed(){var e;return((e=this.__accessor__)==null?void 0:e.lifecycle)===eo.DESTROYED||!1}commitProperty(e){rs(this,e)}get(e){return IC(U.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),rs(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return FM(this,e,i),this}watch(e,i,r){return Zpe(this,e,i,r)}addHandles(e,i){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const n of r)n.remove();return}(this[Mu]??(this[Mu]=new e_)).add(e,i)}removeHandles(e){var i;(i=this[Mu])==null||i.remove(e)}removeAllHandles(){var e;(e=this[Mu])==null||e.removeAll()}removeHandlesReference(e){var i;(i=this[Mu])==null||i.removeReference(e)}hasHandles(e){var i;return((i=this[Mu])==null?void 0:i.has(e))===!0}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}};aJ=Mu,lJ=XO;let Lhe=class uJ{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new uJ;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,R(r.value),r.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const r=this._values.get(e);return i==null||(r==null?void 0:r.origin)===i?r==null?void 0:r.value:void 0}originOf(e){var i;return((i=this._values.get(e))==null?void 0:i.origin)??Le.USER}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(r=>{var n;return((n=this._values.get(r))==null?void 0:n.origin)===e})}set(e,i,r){if((r=this._normalizeOrigin(r))===Le.DEFAULTS){const n=this._values.get(e);if((n==null?void 0:n.origin)!=null&&n.origin>r)return}this._values.set(e,new Ahe(i,r))}delete(e,i){var r;(i=this._normalizeOrigin(i))!=null&&((r=this._values.get(e))==null?void 0:r.origin)!==i||this._values.delete(e)}has(e,i){var r;return(i=this._normalizeOrigin(i))!=null?((r=this._values.get(e))==null?void 0:r.origin)===i:this._values.has(e)}forEach(e){this._values.forEach(({value:i},r)=>e(i,r))}_normalizeOrigin(e){if(e!=null)return e===Le.DEFAULTS?e:Le.USER}},Ahe=class{constructor(e,i){this.value=e,this.origin=i}};function cJ(t,e,i){e.keys().forEach(n=>{i.set(n,e.get(n),Le.DEFAULTS)});const r=t.metadata;Object.keys(r).forEach(n=>{t.internalGet(n)&&i.set(n,t.internalGet(n),Le.DEFAULTS)})}function Ohe(t,e,i){if(!(t!=null&&t.read)||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.indexOf(e)===0&&Bj(r,i))return!0}else for(const n of r)if(n===e||n.includes(".")&&n.indexOf(e)===0&&Bj(n,i))return!0;return!1}function Rhe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function Phe(t,e,i,r,n){let s=YO(e[i],n);Rhe(s)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))s=YO(e[o],n),Ohe(s,i,r)&&(t[o]=!0)}function Fhe(t,e,i,r){const n=i.metadata,s=$he(n[e],r),o=s==null?void 0:s.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,r):o;a!==void 0&&i.set(e,a)}const dJ={origin:"service"};function pJ(t,e,i=dJ){if(!e||typeof e!="object")return;const r=ao(t),n=r.metadata,s={};for(const o of Object.getOwnPropertyNames(e))Phe(s,n,o,e,i);r.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(s)){const a=YO(n[o],i).read,u=a==null?void 0:a.source;let d;d=u&&typeof u=="string"?L$(e,u):e[o],a!=null&&a.reader&&(d=a.reader.call(t,d,e,i)),d!==void 0&&r.set(o,d)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(n))s[o]||Fhe(t,o,r,i)}r.setDefaultOrigin("user")}function hJ(t,e,i,r=dJ){var s;const n={...r,messages:[]};i(n),(s=n.messages)==null||s.forEach(o=>{o.type!=="warning"||t.loaded?r!=null&&r.messages&&r.messages.push(o):t.loadWarnings.push(o)})}function Nhe(t,e,i,r,n){var o,a;const s={};return(a=(o=e.write)==null?void 0:o.writer)==null||a.call(t,r,s,i,n),s}function mJ(t,e,i,r,n,s){if(!(r!=null&&r.write))return!1;const o=rs(t,i);if(!n&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,o,i,s??void 0);a!==void 0&&(n=a)}if(n||(n=r.write),!n||n.enabled===!1||n.layerContainerTypes&&(s!=null&&s.layerContainerType)&&!n.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!n.allowNull&&!n.writerEnsuresNonNull||o===void 0)&&n.isRequired){const a=new L("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&(s!=null&&s.messages)?s.messages.push(a):a&&!s&&U.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!n.allowNull&&!n.writerEnsuresNonNull||!n.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===Le.DEFAULTS)&&Dhe(t,i,s,r,o)||!n.ignoreOrigin&&(s!=null&&s.origin)&&e.store.multipleOriginsSupported&&e.store.originOf(i)<qh(s.origin))}function Dhe(t,e,i,r,n){const s=r.default;if(s===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(n);if(typeof s=="function"){if(Array.isArray(n)){const o=s.call(t,e,i??void 0);return eg(o,n)}return!1}return s===n}function Vhe(t,e,i,r){const n=ao(t),s=n.metadata,o=sJ(s[e],r);return!!o&&mJ(t,n,e,o,i,r)}function fJ(t,e,i){var s,o;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return PI(e,t.toJSON(i));const r=ao(t),n=r.metadata;for(const a in n){const u=sJ(n[a],i);if(!mJ(t,r,a,u,void 0,i))continue;const d=rs(t,a),p=Nhe(t,u,u.write&&typeof u.write.target=="string"?u.write.target:a,d,i);Object.keys(p).length>0&&(e=PI(e,p),(o=(s=i==null?void 0:i.resources)==null?void 0:s.pendingOperations)!=null&&o.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>PI(e,p,()=>"replace-arrays"))),i!=null&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:ope(r.store.originOf(a)),newOrigin:i.origin}))}return e}const ig=t=>{let e=class extends t{constructor(...i){super(...i);const r=ao(this),n=r.store,s=new Lhe;r.store=s,cJ(r,n,s)}read(i,r){pJ(this,i,r)}write(i,r){return fJ(this,i??{},r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return Uhe.call(this,i,r)}};return e=l([$("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function Uhe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}function qM(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}let j=class extends ig(q){};j=l([$("esri.core.JSONSupport")],j);const cV=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,jhe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function QO(t){const e=t==null?void 0:t.match(cV);if(!e)return null;const[,i,r,n]=e;if(!i)return null;let s=null,o=null,a=null;const{devext:u,qaext:d,www:p}=jhe;if(r)if(s=i,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=u);break;case"qa":({customBaseUrl:o,portalHostname:a}=d);break;default:return null}else({customBaseUrl:o,portalHostname:a}=p);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=u);break;case"qaext":({customBaseUrl:o,portalHostname:a}=d);break;case"www":({customBaseUrl:o,portalHostname:a}=p);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function Ghe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function yJ(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function gJ(t){const e=atob(t),i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i.buffer}function zhe(t){const e=new Uint8Array(t);let i="";for(let r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);return btoa(i)}const Bhe=()=>U.getLogger("esri.core.urlUtils"),o_=et.request,cG="esri/config: esriConfig.request.proxyUrl is not set.",vJ=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,bJ=/^\s*http:/i,Hhe=/^\s*https:/i,qhe=/^\s*file:/i,Whe=/:\d+$/,Zhe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Jhe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Yhe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let nm=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(Jhe);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(Yhe),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const QE={},Khe=new nm(et.applicationUrl);let es=Khe;const Xhe=Qhe();let dV=Xhe;const pV=()=>es,qZe=()=>dV;function Qhe(){const t=es.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${es.scheme}://${es.host}${es.port!=null?`:${es.port}`:""}`}${e}`}function nr(t){if(!t)return null;const e={path:null,query:null},i=new nm(t),r=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.slice(0,r),e.query=hV(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.slice(0,e.path.length-(i.fragment.length+1)))),e}function hV(t){const e=t.split("&"),i={};for(const r of e){if(!r)continue;const n=r.indexOf("=");let s,o;n<0?(s=decodeURIComponent(r),o=""):(s=decodeURIComponent(r.slice(0,n)),o=decodeURIComponent(r.slice(n+1)));let a=i[s];typeof a=="string"&&(a=i[s]=[a]),Array.isArray(a)?a.push(o):i[s]=o}return i}function GS(t,e){return t?Object.keys(t).map(i=>{const r=t[i];if(r==null)return"";const n=encodeURIComponent(i)+"=",s=e==null?void 0:e[i];return s?n+encodeURIComponent(s(r)):Array.isArray(r)?r.map(o=>qM(o)?n+encodeURIComponent(JSON.stringify(o)):n+encodeURIComponent(o)).join("&"):qM(r)?n+encodeURIComponent(JSON.stringify(r)):n+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function _J(t=!1){let e,i=o_.proxyUrl;if(typeof t=="string"){e=EJ(t);const r=OC(t);r&&(i=r.proxyUrl)}else e=!!t;if(!i)throw Bhe().warn(cG),new L("urlUtils:proxy-not-set",cG);return e&&tR()&&(i=vV(i)),nr(i)}function eme(t,e=!1){const i=OC(t);let r,n;if(i){const s=mV(i.proxyUrl);r=s.path,n=s.query?hV(s.query):null}else if(e){const s=_J(t);r=s.path,n=s.query}if(r){const s=nr(t);t=r+"?"+s.path;const o=GS({...n,...s.query});o&&(t=`${t}?${o}`)}return t}const N_={path:"",query:""};function mV(t){const e=t.indexOf("?");return e!==-1?(N_.path=t.slice(0,e),N_.query=t.slice(e+1)):(N_.path=t,N_.query=null),N_}function wJ(t){return t=(t=ZM(t=cme(t=mV(t).path),!0)).toLowerCase()}function tme(t){const e={proxyUrl:t.proxyUrl,urlPrefix:wJ(t.urlPrefix)},i=o_.proxyRules,r=e.urlPrefix;let n=i.length;for(let s=0;s<i.length;s++){const o=i[s].urlPrefix;if(r.indexOf(o)===0){if(r.length===o.length)return-1;n=s;break}o.indexOf(r)===0&&(n=s+1)}return i.splice(n,0,e),n}function OC(t){const e=o_.proxyRules,i=wJ(t);for(let r=0;r<e.length;r++)if(i.indexOf(e[r].urlPrefix)===0)return e[r]}function ime(t,e){if(!t||!e)return!1;t=WM(t),e=WM(e);const i=QO(t),r=QO(e);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&Oy(t,e,!0)}function SJ(t,e){return t=WM(t),e=WM(e),ZM(t)===ZM(e)}function WM(t){const e=(t=kn(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function eR(t,e=o_.interceptors){const i=r=>r==null||r instanceof RegExp&&r.test(t)||typeof r=="string"&&t.startsWith(r);if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(i))return r}else if(i(r.urls))return r}return null}function Oy(t,e,i=!1){if(!t||!e)return!1;const r=rR(t),n=rR(e);return!(!i&&r.scheme!==n.scheme)&&r.host!=null&&n.host!=null&&r.host.toLowerCase()===n.host.toLowerCase()&&r.port===n.port}function fV(t){if(typeof t=="string"){if(!Ho(t))return!0;t=rR(t)}if(Oy(t,es))return!0;const e=o_.trustedServers||[];for(let i=0;i<e.length;i++){const r=rme(e[i]);for(let n=0;n<r.length;n++)if(Oy(t,r[n]))return!0}return!1}function rme(t){return QE[t]||(gV(t)||Sc(t)?QE[t]=[new nm(ro(t))]:QE[t]=[new nm(`http://${t}`),new nm(`https://${t}`)]),QE[t]}function ro(t,e=dV,i){return Sc(t)?i!=null&&i.preserveProtocolRelative?t:es.scheme==="http"&&es.authority===Ja(t).slice(2)?`http:${t}`:`https:${t}`:gV(t)?t:gb(t[0]==="/"?ume(e):e,t)}function yV(t,e=dV,i){if(t==null||!Ho(t))return t;const r=kn(t),n=r.toLowerCase(),s=kn(e).toLowerCase().replace(/\/+$/,""),o=i?kn(i).toLowerCase().replace(/\/+$/,""):null;if(o&&s.indexOf(o)!==0)return t;const a=(h,m,y)=>(y=h.indexOf(m,y))===-1?h.length:y;let u=a(n,"/",n.indexOf("//")+2),d=-1;for(;n.slice(0,u+1)===s.slice(0,u)+"/"&&(d=u+1,u!==n.length);)u=a(n,"/",u+1);if(d===-1||o&&d<o.length)return t;t=r.slice(d);const p=s.slice(d-1).replaceAll(/[^/]+/g,"").length;if(p>0)for(let h=0;h<p;h++)t=`../${t}`;else t=`./${t}`;return t}function kn(t){return t=hme(t=pme(t=dme(t=ro(t=t.trim()))))}function gb(...t){const e=t.filter(ot);if(!(e!=null&&e.length))return;const i=[];if(Ho(e[0])){const n=e[0],s=n.indexOf("//");s!==-1&&(i.push(n.slice(0,s+1)),ame(e[0])&&(i[0]+="/"),e[0]=n.slice(s+2))}else e[0][0]==="/"&&i.push("");const r=e.reduce((n,s)=>s?n.concat(s.split("/")):n,[]);for(let n=0;n<r.length;n++){const s=r[n];s===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!s&&n===r.length-1||s&&(s!=="."||i.length===0))&&i.push(s)}return i.join("/")}function Ja(t,e=!1){if(t==null||RC(t)||bp(t))return null;let i=t.indexOf("://");if(i===-1&&Sc(t))i=2;else{if(i===-1)return null;i+=3}const r=t.indexOf("/",i);return r!==-1&&(t=t.slice(0,r)),e&&(t=ZM(t,!0)),t}function Ho(t){return Sc(t)||gV(t)}function RC(t){return t!=null&&t.slice(0,5)==="blob:"}function bp(t){return t!=null&&t.slice(0,5)==="data:"}function nme(t){const e=dm(t);return e!=null&&e.isBase64?gJ(e.data):null}function WZe(t){return zhe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const sme=/^data:(.*?)(;base64)?,(.*)$/;function dm(t){const e=t.match(sme);if(!e)return null;const[,i,r,n]=e;return{mediaType:i,isBase64:!!r,data:n}}function $J(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function ZZe(t){return(await fetch(t)).blob()}function JZe(t){const e=nme(t);if(!e)return null;const i=dm(t);return new Blob([e],{type:i.mediaType})}function Sc(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function gV(t){return t!=null&&vJ.test(t)}function EJ(t){return t!=null&&Hhe.test(t)||es.scheme==="https"&&Sc(t)}function ome(t){return t!=null&&bJ.test(t)||es.scheme==="http"&&Sc(t)}function ame(t){return t!=null&&qhe.test(t)}function vV(t){return Sc(t)?`https:${t}`:t.replace(bJ,"https:")}function lme(){return es.scheme==="http"}function tR(){return es.scheme==="https"}function ZM(t,e=!1){return Sc(t)?t.slice(2):(t=t.replace(vJ,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function ume(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function bV(t){let e=0;if(Ho(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function YZe(t,e){if(!t)return"";const i=nr(t).path.replace(/\/+$/,""),r=i.slice(i.lastIndexOf("/")+1);if(!(e!=null&&e.length))return r;const n=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(n,"")}function cme(t){return t.endsWith("/")?t:`${t}/`}function TJ(t){return t.replace(/\/+$/,"")}function dme(t){if(/^https?:\/\//i.test(t)){const e=mV(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function pme(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function hme(t){const e=o_.httpsDomains;if(!ome(t))return t;const i=t.indexOf("/",7);let r;if(r=i===-1?t:t.slice(0,i),r=r.toLowerCase().slice(7),Whe.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return lme()&&r===es.authority&&!Zhe.test(t)||(tR()&&r===es.authority||e&&e.some(n=>r===n||r.endsWith(`.${n}`))||tR()&&!OC(t))&&(t=vV(t)),t}function iR(t,e,i){if(!(e&&i&&t&&Ho(t)))return t;const r=t.indexOf("//"),n=t.indexOf("/",r+2),s=t.indexOf(":",r+2),o=Math.min(n<0?t.length:n,s<0?t.length:s);return t.slice(r+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${i}${t.slice(o)}`}function rR(t){return typeof t=="string"?new nm(ro(t)):(t.scheme||(t.scheme=es.scheme),t)}function KZe(t){return mme.test(t)}function IJ(t,e){const i=nr(t),r=Object.keys(i.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function xJ(t,e,i){const r=nr(t),n=r.query||{};return n[e]=String(i),`${r.path}?${GS(n)}`}function UI(t,e){if(!e)return t;const i=nr(t),r=i.query||{};for(const[s,o]of Object.entries(e))o!=null&&(r[s]=o);const n=GS(r);return n?`${i.path}?${n}`:i.path}function XZe(t){if(t==null)return null;const e=t.match(MJ);return e?e[2]:null}function dG(t){if(t==null)return null;const e=t.match(MJ);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function QZe(t){return typeof t=="string"?dm(t)??{data:t}:new Promise((e,i)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(dm(r.result)),r.onerror=n=>i(n)})}const MJ=/([^.]*)\.([^/]*)$/,mme=/(^data:image\/svg|\.svg$)/i;Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const xr="4.31";let Te,_V=xr;_V=`4.31.0-next.${TC}`;function eJe(t){Te=t}function fme(t){const e=Te==null?void 0:Te.findCredential(t);return e!=null&&e.token?xJ(t,"token",e.token):t}G("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),G("host-webworker");const yme=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function wV(t){const e=Ja(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!yme.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function gme(t,e,i=!1,r){return new Promise((n,s)=>{if(lo(r))return void s(pG());let o=()=>{d(),s(new Error(`Unable to load ${e}`))},a=()=>{const p=t;d(),n(p)},u=()=>{if(!t)return;const p=t;d(),p.src="",s(pG())};const d=()=>{G("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,r!=null&&r.removeEventListener("abort",u),u=null,i&&URL.revokeObjectURL(e)};r!=null&&r.addEventListener("abort",u),G("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))})}function pG(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const CJ="Timeout exceeded";function vme(){return new Error(CJ)}function tJe(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===CJ}function bme(t){et.request.crossOriginNoCorsDomains||(et.request.crossOriginNoCorsDomains={});const e=et.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[Ja(i)??""]=0:(e[Ja("http://"+i)??""]=0,e[Ja("https://"+i)??""]=0)}function _me(t){const e=et.request.crossOriginNoCorsDomains;if(e){let i=Ja(t);if(i)return i=i.toLowerCase(),!Oy(i,pV())&&e[i]<Date.now()-36e5}return!1}async function wme(t){var n;const e=nr(t);t=e.path,((n=e.query)==null?void 0:n.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const i=et.request.crossOriginNoCorsDomains,r=Ja(t);i&&r&&(i[r.toLowerCase()]=Date.now())}async function Ee(t,e){var m;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=hV(e.query.toString().replaceAll("+"," ")));const i=bp(t),r=RC(t);r||i||(t=kn(t));const n={url:t,requestOptions:{...e}},s=y=>({data:y,getAllHeaders:vb,getHeader:vb,httpStatus:200,requestOptions:n.requestOptions,url:n.url}),o=eR(t,Fa.internalInterceptors);if(o){const y=await mG(o,n);if(y!=null)return s(y)}let a=eR(t);if(a){const y=await mG(a,n);if(y!=null)return s(y);a.after||a.error||(a=null)}if(t=n.url,(e=n.requestOptions).responseType==="image"&&(G("host-webworker")||G("host-node")))throw bc("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n);if(e.method==="head"){if(e.body)throw bc("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||r)throw bc("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await Ime(),JM)return JM.execute(t,e);const u=new AbortController,d=ks(e,()=>u.abort()),p={controller:u,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:n,redoRequest:!1,useIdentity:Fa.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=await kme(p).finally(()=>d==null?void 0:d.remove());return(m=a==null?void 0:a.after)==null||m.call(a,h),h}let JM;const Fa=et.request,kJ="FormData"in globalThis,Sme=new Set([499,498,403,401]),$me=new Set(["COM_0056","COM_0057","SB_0008"]),Eme=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],vb=()=>null,YM=Symbol();function Tme(t){const e=Ja(t);e&&!Ee._corsServers.includes(e)&&Ee._corsServers.push(e)}function hG(t){const e=Ja(t);return!e||e.endsWith(".arcgis.com")||Ee._corsServers.includes(e)||fV(e)}function bc(t,e,i,r){let n="Error";const s={url:i.url,requestOptions:i.requestOptions,getAllHeaders:vb,getHeader:vb,ssl:!1};if(e instanceof L)return e.details?(e.details=R(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=s,e;if(e){const o=r&&(()=>Array.from(r.headers)),a=r&&(p=>r.headers.get(p)),u=r==null?void 0:r.status,d=e.message;d&&(n=d),o&&a&&(s.getAllHeaders=o,s.getHeader=a),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||u||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?s.messages=[e.details]:s.messages=e.details,s.raw=YM in e?e[YM]:e}return rr(e)?mt():new L(t,n,s)}async function Ime(){G("host-webworker")&&!JM&&(JM=await k(()=>import("./request-DTOhl52E.js"),[]))}async function nR(){Te||await k(()=>import("./IdentityManager-DzKUGz-K.js"),[])}async function xme(t){var a;const e=t.params.url,i=t.params.requestOptions,r=t.controller.signal,n=i.body;let s=null,o=null;if(kJ&&"HTMLFormElement"in globalThis&&(n instanceof FormData?s=n:n instanceof HTMLFormElement&&(s=new FormData(n))),typeof n=="string"&&(o=n),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Fa.priority,redirect:"follow",signal:r},(s||o)&&(t.fetchOptions.body=s||o),i.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(a=i.query)!=null&&a.token||s!=null&&s.get("token")),!t.hasToken&&et.apiKey&&wV(e)&&(i.query||(i.query={}),i.query.token=et.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!LJ(e)&&!lo(r)){let u;i.authMode==="immediate"?(await nR(),u=await Te.getCredential(e,{signal:r}),t.credential=u):i.authMode==="no-prompt"?(await nR(),u=await Te.getCredential(e,{prompt:!1,signal:r}).catch(()=>{}),t.credential=u):Te&&(u=Te.findCredential(e)),u&&(t.credentialToken=u.token,t.useSSL=!!u.ssl)}}function LJ(t){return Eme.some(e=>e.test(t))}async function Mme(t){let e=t.params.url;const i=t.params.requestOptions,r=t.fetchOptions??{},n=RC(e)||bp(e),s=i.responseType||"json",o=n?0:i.timeout!=null?i.timeout:Fa.timeout;let a=!1;if(!n){t.useSSL&&(e=vV(e));let m={...i.query};t.credentialToken&&(m.token=t.credentialToken);let y=GS(m);G("esri-url-encodes-apostrophe")&&(y=y.replaceAll("'","%27"));const g=e.length+1+y.length;let v;a=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||g>Fa.maxUrlLength;const _=i.useProxy||!!OC(e);if(_){const w=_J(e);v=w.path,!a&&v.length+1+g>Fa.maxUrlLength&&(a=!0),w.query&&(m={...w.query,...m})}if(r.method==="HEAD"&&(a||_)){if(a)throw g>Fa.maxUrlLength?bc("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):bc("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(_)throw bc("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(r.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=UI(e,m):(r.body=GS(m),r.headers||(r.headers={}),r.headers["Content-Type"]="application/x-www-form-urlencoded")):e=UI(e,m),_&&(t.useProxy=!0,e=`${v}?${e}`),m.token&&kJ&&r.body instanceof FormData&&!Ghe(e)&&r.body.set("token",m.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Oy(e,pV())){if(fV(e))t.withCredentials=!0;else if(Te){const w=Te.findServerInfo(e);w!=null&&w.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(r.credentials="include",_me(e)&&await wme(a?UI(e,m):e))}let u,d,p=0,h=!1;o>0&&(p=setTimeout(()=>{h=!0,t.controller.abort()},o));try{if(i.responseType==="native-request-init")d=r,d.url=e,i.signal?d.signal=i.signal:delete d.signal;else if(i.responseType!=="image"||r.cache!=="default"||r.method!=="GET"||a||Cme(i.headers)||!n&&!t.useProxy&&Fa.proxyUrl&&!hG(e)){if(Ee._beforeFetch&&await Ee._beforeFetch(e,r),u=await fetch(e,r),Ee._afterFetch&&await Ee._afterFetch(u),t.useProxy||Tme(e),i.responseType==="native")d=u;else if(r.method!=="HEAD")if(u.ok){switch(s){case"array-buffer":d=await u.arrayBuffer();break;case"blob":case"image":d=await u.blob();break;default:d=await u.text()}if(p&&(clearTimeout(p),p=0),s==="json"||s==="xml"||s==="document")if(d)switch(s){case"json":d=JSON.parse(d);break;case"xml":d=fG(d,"application/xml");break;case"document":d=fG(d,"text/html")}else d=null;if(d){if(s==="array-buffer"||s==="blob"){const m=u.headers.get("Content-Type");if(m&&/application\/json|text\/plain/i.test(m)&&d[s==="blob"?"size":"byteLength"]<=750)try{const y=await new Response(d).json();y.error&&(d=y)}catch{}}s==="image"&&d instanceof Blob&&(d=await yG(URL.createObjectURL(d),t,!0))}}else{d=await u.text();try{d=JSON.parse(d)}catch{}}}else d=await yG(e,t)}catch(m){if(m.name==="AbortError")throw h?vme():mt("Request canceled");if(!(!u&&m instanceof TypeError&&Fa.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||hG(e))throw m;t.redoRequest=!0,tme({proxyUrl:Fa.proxyUrl,urlPrefix:Ja(e)??""})}finally{p&&clearTimeout(p)}return[u,d]}async function mG(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,r;try{r=await t.before(e)}catch(n){i=bc("request:interceptor",n,e)}if((r instanceof Error||r instanceof L)&&(i=bc("request:interceptor",r,e)),i)throw t.error&&t.error(i),i;return r}}function Cme(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function fG(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function kme(t){var s,o;let e,i;await xme(t);try{do[e,i]=await Mme(t);while(!await Lme(t,e,i))}catch(a){const u=bc("request:server",a,t.params,e);throw u.details.ssl=t.useSSL,(s=t.interceptor)!=null&&s.error&&t.interceptor.error(u),u}const r=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&((o=i.user)!=null&&o.username)&&!fV(r)){const a=Ja(r,!0);a&&Fa.trustedServers.push(a)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&bme(i.authorizedCrossOriginNoCorsDomains)}const n=t.credential;if(n&&Te){const a=Te.findServerInfo(n.server);let u=a==null?void 0:a.owningSystemUrl;if(u){u=u.replace(/\/?$/,"/sharing");const d=Te.findCredential(u,n.userId);d&&Te._getIdenticalSvcIdx(u,d)===-1&&d.resources.unshift(u)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):vb,getHeader:e?a=>e.headers.get(a):vb,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Lme(t,e,i){var d;if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let n,s;if(i&&(i.error&&typeof i.error=="object"?n=i.error:i.status==="error"&&Array.isArray(i.messages)&&(n={...i},n[YM]=i,n.details=i.messages)),!n&&!e.ok)throw n=new Error(`Unable to load ${e.url} status: ${e.status}`),n[YM]=i,n;let o,a=null;n&&(s=Number(n.code),a=n.hasOwnProperty("subcode")?Number(n.subcode):null,o=n.messageCode,o=o==null?void 0:o.toUpperCase());const u=r.authMode;if(s===403&&(a===4||(d=n.message)!=null&&d.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(u!=="no-prompt"||s===498)&&s!==void 0&&Sme.has(s)&&!LJ(t.params.url)&&(s!==403||(!o||!$me.has(o))&&(a==null||a===2&&t.credentialToken))){await nR();try{const p=await Te.getCredential(t.params.url,{error:bc("request:server",n,t.params),prompt:u!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=p,t.credentialToken=p.token,t.useSSL=t.useSSL||p.ssl,!1}catch(p){if(u==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;n=p}}if(n)throw n;return!0}function yG(t,e,i=!1){const r=e.controller.signal,n=new Image;return e.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=Fa.priority,n.src=t,gme(n,t,i,r)}Ee._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Ee._beforeFetch=void 0,Ee._afterFetch=void 0;let jI=class AJ{constructor(){this._emitter=new AJ.EventEmitter(this)}emit(e,i){return this._emitter.emit(e,i)}on(e,i){return this._emitter.on(e,i)}once(e,i){return this._emitter.once(e,i)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(n=null){this._target=n,this._listenersMap=null}clear(){var n;(n=this._listenersMap)==null||n.clear(),this._listenersMap=null}destroy(){this.clear()}emit(n,s){var d;let o=(d=this._listenersMap)==null?void 0:d.get(n);if(!o)return!1;const a=this._target||this;let u=!1;for(const p of o.slice()){const h="deref"in p?p.deref():p;h?h==null||h.call(a,s):u=!0}return u&&(o=o.filter(p=>!("deref"in p)||p.deref()!=null),this._listenersMap.set(n,o)),o.length>0}on(n,s){if(Array.isArray(n)){const a=n.map(u=>this.on(u,s));return kr(a)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const o=this._listenersMap.get(n)||[];return o.push(s),this._listenersMap.set(n,o),ye(()=>{var d;const a=(d=this._listenersMap)==null?void 0:d.get(n),u=(a==null?void 0:a.indexOf(s))??-1;u>=0&&a.splice(u,1)})}once(n,s){const o=this.on(n,a=>{o.remove();const u="deref"in s?s.deref():s;u==null||u.call(null,a)});return o}hasEventListener(n){var o;const s=(o=this._listenersMap)==null?void 0:o.get(n);return s!=null&&s.length>0}}t.EventEmitter=e,t.EventedMixin=r=>{let n=class extends r{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(s,o){return this._emitter.emit(s,o)}on(s,o){return this._emitter.on(s,o)}once(s,o){return this._emitter.once(s,o)}hasEventListener(s){return this._emitter.hasEventListener(s)}};return n=l([$("esri.core.Evented")],n),n};let i=class extends q{constructor(){super(...arguments),this._emitter=new jI.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,n){return this._emitter.emit(r,n)}on(r,n){return this._emitter.on(r,n)}once(r,n){return this._emitter.once(r,n)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=l([$("esri.core.Evented.EventedAccessor")],i),t.EventedAccessor=i})(jI||(jI={}));const ji=jI;var xt;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(xt||(xt={}));function SV(t){return(e,i)=>{e[i]=t}}let a_=class extends MZ{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}};var jd;let Ame=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},Ome=class{constructor(e,i,r,n,s){this.target=e,this.added=i,this.removed=r,this.start=n,this.deleteCount=s}};const ta=new tg(Ame,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function gG(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function _L(t){return t?t instanceof Rd?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function wL(t){if(t!=null&&t.length)return t[0]}function Rme(t,e,i,r){const n=Math.min(t.length-i,e.length-r);let s=0;for(;s<n&&t[i+s]===e[r+s];)s++;return s}function OJ(t,e,i,r){e&&e.forEach((n,s,o)=>{t.push(n),OJ(t,i.call(r,n,s,o),i,r)})}const Mp=new Set,Cp=new Set,kp=new Set,SL=new Map;let Pme=0,Rd=jd=class extends ji.EventedAccessor{static isCollection(t){return t!=null&&t instanceof jd}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new a_,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Pme++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof jd?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return he(this._observable),this._items}set items(t){this._emitBeforeChanges(xt.ADD)||(this._splice(0,this.length,_L(t)),this._emitAfterChanges(xt.ADD))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return ye();if(t==="change"){const i=this._chgListeners,r={removed:!1,callback:e};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),ye(()=>{r.removed=!0,i.splice(i.indexOf(r),1)})}return this._emitter.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,r=this.on(t,n=>{var s;(s=i())==null||s.call(null,n),r.remove()});return r}add(t,e){if(he(this._observable),this._emitBeforeChanges(xt.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(xt.ADD),this}addMany(t,e=this._items.length){if(he(this._observable),!(t!=null&&t.length))return this;if(this._emitBeforeChanges(xt.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,_L(t)),this._emitAfterChanges(xt.ADD),this}at(t){if(he(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(he(this._observable),!this.length||this._emitBeforeChanges(xt.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(xt.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return he(this._observable),this._createNewInstance({items:this._items.map(R)})}concat(...t){he(this._observable);const e=t.map(_L);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(he(this._observable),!this.length||this._emitBeforeChanges(xt.REMOVE))return;const i=this._splice(0,this.length),r=i.length;for(let n=0;n<r;n++)t.call(e,i[n],n,i);this._emitAfterChanges(xt.REMOVE)}destroyAll(){this.drain(gG)}destroyMany(t){const e=this.removeMany(t);return e.forEach(gG),e}every(t,e){return he(this._observable),this._items.every(t,e)}filter(t,e){let i;return he(this._observable),i=arguments.length===2?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return he(this._observable),this._items.find(t,e)}findIndex(t,e){return he(this._observable),this._items.findIndex(t,e)}flatten(t,e){he(this._observable);const i=[];return OJ(i,this,t,e),new jd(i)}forEach(t,e){return he(this._observable),this._items.forEach(t,e)}getItemAt(t){return he(this._observable),this._items[t]}getNextIndex(t){he(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return he(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return he(this._observable),this._items.indexOf(t,e)}join(t=","){return he(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return he(this._observable),this._items.lastIndexOf(t,e)}map(t,e){he(this._observable);const i=this._items.map(t,e);return new jd({items:i})}reorder(t,e=this.length-1){he(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(xt.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(xt.MOVE)}return t}}pop(){if(he(this._observable),!this.length||this._emitBeforeChanges(xt.REMOVE))return;const t=wL(this._splice(this.length-1,1));return this._emitAfterChanges(xt.REMOVE),t}push(...t){return he(this._observable),this._emitBeforeChanges(xt.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(xt.ADD)),this.length}reduce(t,e){he(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){he(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return he(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(he(this._observable),t<0||t>=this.length||this._emitBeforeChanges(xt.REMOVE))return;const e=wL(this._splice(t,1));return this._emitAfterChanges(xt.REMOVE),e}removeMany(t){if(he(this._observable),!(t!=null&&t.length)||this._emitBeforeChanges(xt.REMOVE))return[];const e=t instanceof jd?t.toArray():t,i=this._items,r=[],n=e.length;for(let s=0;s<n;s++){const o=e[s],a=i.indexOf(o);if(a>-1){const u=1+Rme(e,i,s+1,a+1),d=this._splice(a,u);d&&d.length>0&&r.push.apply(r,d),s+=u-1}}return this._emitAfterChanges(xt.REMOVE),r}reverse(){if(he(this._observable),this._emitBeforeChanges(xt.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(xt.MOVE),this}shift(){if(he(this._observable),!this.length||this._emitBeforeChanges(xt.REMOVE))return;const t=wL(this._splice(0,1));return this._emitAfterChanges(xt.REMOVE),t}slice(t=0,e=this.length){return he(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return he(this._observable),this._items.some(t,e)}sort(t){if(he(this._observable),!this.length||this._emitBeforeChanges(xt.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(xt.MOVE),this}splice(t,e,...i){he(this._observable);const r=(e?xt.REMOVE:0)|(i.length?xt.ADD:0);if(this._emitBeforeChanges(r))return[];const n=this._splice(t,e,i)||[];return this._emitAfterChanges(r),n}toArray(){return he(this._observable),this._items.slice()}toJSON(){return he(this._observable),this.toArray()}toLocaleString(){return he(this._observable),this._items.toLocaleString()}toString(){return he(this._observable),this._items.toString()}unshift(...t){return he(this._observable),!t.length||this._emitBeforeChanges(xt.ADD)||(this._splice(0,0,t),this._emitAfterChanges(xt.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const r=this._items,n=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=P$(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=r.splice(t,e),this.hasEventListener("before-remove")){const a=ta.acquire();a.target=this,a.cancellable=!0;for(let u=0,d=o.length;u<d;u++)s=o[u],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(u,1),r.splice(t,0,s),t+=1,u-=1,d-=1);ta.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=ta.acquire();a.target=this,a.cancellable=!1;const u=o.length;for(let d=0;d<u;d++)a.reset(o[d]),this.emit("after-remove",a);ta.release(a)}}if(i!=null&&i.length){if(n){const p=[];for(const h of i){const m=n.ensureType(h);m==null&&h!=null||p.push(m)}i=p}const a=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),d=t===this.length;if(a||u){const p=ta.acquire();p.target=this,p.cancellable=!0;const h=ta.acquire();h.target=this,h.cancellable=!1;for(const m of i)a?(p.reset(m),this.emit("before-add",p),p.defaultPrevented||(d?r.push(m):r.splice(t++,0,m),this._set("length",r.length),u&&(h.reset(m),this.emit("after-add",h)))):(d?r.push(m):r.splice(t++,0,m),this._set("length",r.length),h.reset(m),this.emit("after-add",h));ta.release(h),ta.release(p)}else{if(d)for(const p of i)r.push(p);else r.splice(t,0,...i);this._set("length",r.length)}}if((i!=null&&i.length||o!=null&&o.length)&&this._notifyChangeEvent(i,o),this.hasEventListener("after-splice")){const a=new Ome(this,i,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=ta.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,ta.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=ta.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),ta.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;Mp.clear(),Cp.clear(),kp.clear();for(const{added:u,removed:d}of i){if(u)if(kp.size===0&&Cp.size===0)for(const p of u)Mp.add(p);else for(const p of u)Cp.has(p)?(kp.add(p),Cp.delete(p)):kp.has(p)||Mp.add(p);if(d)if(kp.size===0&&Mp.size===0)for(const p of d)Cp.add(p);else for(const p of d)Mp.has(p)?Mp.delete(p):(kp.delete(p),Cp.add(p))}const r=Is.acquire();Mp.forEach(u=>{r.push(u)});const n=Is.acquire();Cp.forEach(u=>{n.push(u)});const s=this._items,o=e.items,a=Is.acquire();if(kp.forEach(u=>{o.indexOf(u)!==s.indexOf(u)&&a.push(u)}),e.listeners&&(r.length||n.length||a.length)){const u={target:this,added:r,removed:n,moved:a},d=e.listeners.length;for(let p=0;p<d;p++){const h=e.listeners[p];h.removed||h.callback.call(this,u)}}Is.release(r),Is.release(n),Is.release(a)}Mp.clear(),Cp.clear(),kp.clear()}};Rd.ofType=t=>{if(!t)return jd;if(SL.has(t))return SL.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const n=t.typeMap[r].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends jd{};return l([SV({Type:t,ensureType:typeof t=="function"?pi(t):Qa(t)})],i.prototype,"itemType",void 0),i=l([$(`esri.core.Collection<${e}>`)],i),SL.set(t,i),i},l([c()],Rd.prototype,"_updating",void 0),l([c()],Rd.prototype,"length",void 0),l([c()],Rd.prototype,"items",null),l([c({readOnly:!0})],Rd.prototype,"updating",null),Rd=jd=l([$("esri.core.Collection")],Rd);const Y=Rd;function up(t,e,i=Y){return e||(e=new i),e===t||(e.removeAll(),Fme(t)?e.addMany(t):t&&e.add(t)),e}function RJ(t){return t}function Fme(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var Ph;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(Ph||(Ph={}));let Nme=class{constructor(){this._resolver=fn(),this._status=Ph.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=Ph.RESOLVED,this._cleanUp()},()=>{this._status=Ph.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===Ph.RESOLVED}isRejected(){return this._status===Ph.REJECTED}isFulfilled(){return this._status!==Ph.PENDING}abort(){this._resolver.reject(mt())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=fn(),i=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},n=>{this.isFulfilled()||this._allPromise!==r||rr(n)||this._resolver.reject(n)}),e.resolve()}};const l_=t=>{let e=class extends t{constructor(...i){super(...i),this._promiseProps=new Nme,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return this._promiseProps.promise.then(()=>this).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return e=l([$("esri.core.Promise")],e),e};let KM=class extends l_(q){};KM=l([$("esri.core.Promise")],KM);const Dme="not-loaded",Vme="loading",Ume="failed",vG="loaded",PJ=t=>{let e=class extends t{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(r=>{const n=this.load.bind(this);this.load=s=>{const o=new Promise((a,u)=>{const d=nV(s,u);this.destroyed&&u(new L("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,u).finally(()=>{d&&d.remove()})});if(this.loadStatus===Dme){this._set("loadStatus",Vme);const a=this._loadController=new AbortController;n({signal:a.signal})}return r(),o}})),this.when(()=>{this._set("loadStatus",vG),this._loadController=null},r=>{this._set("loadStatus",Ume),this._set("loadError",r),this._loadController=null})}destroy(){this._loadController&&(this._loadController=mr(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===vG}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new L("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort(),this._promiseProps.abort()),this}};return l([c({readOnly:!0})],e.prototype,"loaded",null),l([c({readOnly:!0})],e.prototype,"loadError",void 0),l([c({clonable:!1})],e.prototype,"loadStatus",void 0),l([c({type:[Jo],readOnly:!0})],e.prototype,"loadWarnings",null),e=l([$("esri.core.Loadable")],e),e};let Lw=class extends PJ(KM){};Lw=l([$("esri.core.Loadable")],Lw),function(t){function e(i){return!(!i||!i.load)}t.LoadableMixin=PJ,t.isLoadable=e}(Lw||(Lw={}));const uo=Lw;function jme(t,e,i){return py(t.map((r,n)=>e.apply(i,[r,n])))}async function Gme(t,e,i){return(await py(t.map((r,n)=>e.apply(i,[r,n])))).map(r=>r.value)}function $V(t){return{ok:!0,value:t}}function EV(t){return{ok:!1,error:t}}function zme(t){return t!=null&&t.ok===!0?t.value:null}function Bme(t){return t!=null&&t.ok===!1?t.error:null}async function N$(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return $V(await t)}catch(e){return EV(e)}}async function Hme(t){try{return $V(await t)}catch(e){return Vo(e),EV(e)}}function Xo(t,e){return new qp(t,e)}let qp=class extends q{get value(){return zme(this._result)}get error(){return Bme(this._result)}get finished(){return this._result!=null}constructor(e,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=mr(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(n=>{this._result=$V(n),this._cleanup()},n=>{this._result=EV(n),this._cleanup()}),this._abortHandle=ks(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Kt(this._abortHandle),this._abortController=null}};l([c()],qp.prototype,"value",null),l([c()],qp.prototype,"error",null),l([c()],qp.prototype,"finished",null),l([c()],qp.prototype,"promise",void 0),l([c()],qp.prototype,"_result",void 0),qp=l([$("esri.core.asyncUtils.ReactiveTask")],qp);async function PC(t,e){return await t.load(),qme(t,e)}async function qme(t,e){const i=[],r=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?r(...o):Y.isCollection(o)?o.forEach(a=>r(a)):uo.isLoadable(o)&&i.push(o))};e(r);let n=null;if(await Gme(i,async s=>{const o=await N$(Wme(s)?s.loadAll():s.load());o.ok!==!1||n||(n=o)}),n)throw n.error;return t}function Wme(t){return"loadAll"in t&&typeof t.loadAll=="function"}function te(t,e,i){let r,n;return e===void 0?(n=t,r=[void 0]):typeof e!="string"?(n=t,r=[void 0],i=e):(n=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const u of r){const d=XZ(s,u,n);d.write&&typeof d.write=="object"||(d.write={}),i&&(d.write.target=i),d.write.writer=a[o]}}}let $e=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=Zme(e),this.apiValues=bG(this._apiToJSON),this.jsonValues=bG(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,n,s)=>{const o=this.toJSON(r);o!==void 0&&Zr(s,o,n)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function Zme(t){const e={};for(const i in t)e[t[i]]=i;return e}function bG(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function Me(){return function(t,e){return new $e(t,{ignoreUnknown:!0,...e})}}let TV=class{constructor(e,i,r,n,s,o){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=n,this.scaleHeight=s;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Wi=new TV(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),_c=new TV(3396190,1/169.8944472236118,23e4,6e4,.111),pm=new TV(1737400,0,0,0,0);function ut(t){if(!et.assetsPath)throw U.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new L("assets:path-not-set","config.assetsPath is not set");return gb(et.assetsPath,t)}let $L,P=null;function FC(){return!!P}function Jme(){return!!G("esri-wasm")}function IV(){return $L||($L=k(()=>import("./pe-wasm-ihfvgCko.js"),__vite__mapDeps([0,1])).then(t=>t.p).then(({default:t})=>t({locateFile:e=>ut(`esri/geometry/support/${e}`)})).then(t=>{DJ(t)}),$L)}var sR,_i;(function(t){function e(s,o,a){P.ensureCache.prepare();const u=iy(a),d=a===u,p=P.ensureFloat64(u),h=P._pe_geog_to_proj(P.getPointer(s),o,p);return h&&zh(a,o,p,d),h}function i(s,o,a,u){switch(u){case _i.PE_TRANSFORM_P_TO_G:return r(s,o,a);case _i.PE_TRANSFORM_G_TO_P:return e(s,o,a)}return 0}function r(s,o,a){return n(s,o,a,0)}function n(s,o,a,u){P.ensureCache.prepare();const d=iy(a),p=a===d,h=P.ensureFloat64(d),m=P._pe_proj_to_geog_center(P.getPointer(s),o,h,u);return m&&zh(a,o,h,p),m}t.geogToProj=e,t.projGeog=i,t.projToGeog=r,t.projToGeogCenter=n})(sR||(sR={})),function(t){function e(){t.PE_BUFFER_MAX=P.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=P.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=P.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=P.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=P.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=P.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=P.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=P.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=P.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=P.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=P.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=P.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=P.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=P.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=P.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=P.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=P.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=P.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=P.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=P.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=P.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=P.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=P.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=P.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=P.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=P.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=P.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=P.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=P.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=P.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=P.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=P.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(_i||(_i={}));let FJ=null;var zS;(function(t){const e={},i={},r=y=>{const g=y.getType();switch(g){case _i.PE_TYPE_GEOGCS:y=P.castObject(y,P.PeGeogcs);break;case _i.PE_TYPE_PROJCS:y=P.castObject(y,P.PeProjcs);break;case _i.PE_TYPE_GEOGTRAN:y=P.castObject(y,P.PeGeogtran);break;default:g&_i.PE_TYPE_UNIT&&(y=P.castObject(y,P.PeUnit))}return y};function n(){P.PeFactory.prototype.initialize(null)}function s(y){return o(_i.PE_TYPE_COORDSYS,y)}function o(y,g){let v=null,_=e[y];if(_||(_={},e[y]=_),_.hasOwnProperty(String(g))&&(v=_[g],P.compare(v,P.NULL)&&(v=null)),!v){const w=P.PeFactory.prototype.factoryByType(y,g);P.compare(w,P.NULL)||(v=r(w),_[g]=v)}return v}function a(y,g){let v=null,_=i[y];if(_||(_={},i[y]=_),_.hasOwnProperty(g)&&(v=_[g],P.compare(v,P.NULL)&&(v=null)),!v){const w=P.PeFactory.prototype.fromString(y,g);P.compare(w,P.NULL)||(v=r(w),_[g]=v)}return v}function u(y){return o(_i.PE_TYPE_GEOGCS,y)}function d(y){return o(_i.PE_TYPE_GEOGTRAN,y)}function p(y){return P.PeFactory.prototype.getCode(y)}function h(y){return o(_i.PE_TYPE_PROJCS,y)}function m(y){return o(_i.PE_TYPE_UNIT,y)}t.initialize=n,t.coordsys=s,t.factoryByType=o,t.fromString=a,t.geogcs=u,t.geogtran=d,t.getCode=p,t.projcs=h,t.unit=m})(zS||(zS={}));let NJ=null;var XM,oR,aR,lR,uR,cR,QM,dR,e2,t2,pR;function DJ(t){function e(s,o,a){s[o]=a(s[o])}P=t,_i.init(),XM.init(),QM.init(),e2.init(),t2.init(),FJ=class extends P.PeDouble{constructor(s=NaN){super(s)}destroy(){P.destroy(this)}[Symbol.dispose](){this.destroy()}},NJ=class extends P.PeGCSExtent{destroy(){P.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[P.PeAngunit,P.PeDatum,P.PeGeogcs,P.PeGeogtran,P.PeObject,P.PeParameter,P.PePrimem,P.PeProjcs,P.PeSpheroid,P.PeUnit];for(const s of i)e(s.prototype,"getName",o=>function(){return o.call(this,new Array(_i.PE_NAME_MAX))});for(const s of[P.PeGeogtran,P.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array(_i.PE_PARM_MAX);let u=o.call(this);for(let d=0;d<a.length;d++){const p=P.getValue(u,"*");a[d]=p?P.wrapPointer(p,P.PeParameter):null,u+=Int32Array.BYTES_PER_ELEMENT}return a});e(P.PeHorizon.prototype,"getCoord",s=>function(o=!1){const a=this.getSize();if(!a)return null;const u=[];return zh(u,a,s.call(this),o),u}),e(P.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=P._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const u=s.call(this);if(!P.compare(u,P.NULL)){a=[u];const d=this.getSteps();if(d>1){const p=P.getPointer(u);for(let h=1;h<d;h++)a.push(P.wrapPointer(p+o*h,P.PeGTlistExtendedGTs))}}return a}});const r=P._pe_getPeHorizonSize(),n=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const u=s.call(this);if(!P.compare(u,P.NULL)){a=[u];const d=u.getNump();if(d>1){const p=P.getPointer(u);for(let h=1;h<d;h++)a.push(P.wrapPointer(p+r*h,P.PeHorizon))}}return o.set(s,a),a};e(P.PeProjcs.prototype,"horizonGcsGenerate",n),e(P.PeProjcs.prototype,"horizonPcsGenerate",n),P.PeObject.prototype.toString=function(s=_i.PE_STR_OPTS_NONE){P.ensureCache.prepare();const o=P.getPointer(this),a=P.ensureInt8(new Array(_i.PE_BUFFER_MAX));return P.UTF8ToString(P._pe_object_to_string_ext(o,s,a))},P.PeGeogcs.prototype.destroy=function(){this.Delete(),Wl(this),this.ptr=0},P.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},P.PeProjcs.prototype.destroy=function(){this.Delete(),Wl(this),this.ptr=0},P.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function Wl(t){if(!t)return;const e=P.getClass(t);if(!e)return;const i=P.getCache(e);if(!i)return;const r=P.getPointer(t);r&&delete i[r]}function eT(t,e){const i=[],r=new Array(e);for(let n=0;n<t;n++)i.push(P.ensureInt8(r));return i}function iy(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function zh(t,e,i,r=!1){if(r)for(let n=0;n<2*e;n++)t[n]=P.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=t.length===0;for(let s=0;s<e;s++)n&&(t[s]=new Array(2)),t[s][0]=P.getValue(i,"double"),t[s][1]=P.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=P.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=P._pe_getPeGTlistExtendedEntrySize()}function r(n,s,o,a,u,d){let p=null;const h=new P.PeInteger(d);try{const m=P.PeGTlistExtended.prototype.getGTlist(n,s,o,a,u,h);if((d=h.val)&&(p=[m],d>1)){const y=P.getPointer(m);for(let g=1;g<d;g++)p.push(P.wrapPointer(y+e*g,P.PeGTlistExtendedEntry))}}finally{P.destroy(h)}return p}t.init=i,t.getGTlist=r})(XM||(XM={})),function(t){function e(i){if(i!=null&&i.length){for(const r of i)Wl(r),r.getEntries().forEach(n=>{Wl(n);const s=n.getGeogtran();Wl(s),s.getParameters().forEach(Wl),[s.getGeogcs1(),s.getGeogcs2()].forEach(o=>{Wl(o);const a=o.getDatum();Wl(a),Wl(a.getSpheroid()),Wl(o.getPrimem()),Wl(o.getUnit())})});P.PeGTlistExtendedEntry.prototype.Delete(i[0])}}t.destroy=e}(oR||(oR={})),function(t){function e(i,r,n,s,o){P.ensureCache.prepare();const a=iy(n),u=n===a,d=P.ensureFloat64(a);let p=0;s&&(p=P.ensureFloat64(s));const h=P._pe_geog_to_geog(P.getPointer(i),r,d,p,o);return h&&zh(n,r,d,u),h}t.geogToGeog=e}(aR||(aR={})),function(t){function e(s,o,a,u,d,p,h,m){P.PeLineType.prototype.geodesic_coordinate(s,o,a,u,d,p,h,m)}function i(s,o,a,u,d,p,h,m,y){P.PeLineType.prototype.geodetic_coordinate(s,o,a,u,d,p,h,m,y)}function r(s,o,a,u,d,p,h,m,y,g){P.PeLineType.prototype.geodetic_distance(s,o,a,u,d,p,h,m,y,g)}function n(s,o,a,u,d,p,h,m,y){P.PeLineType.prototype.great_elliptic_distance(s,o,a,u,d,p,h,m,y)}t.geodesicCoordinate=e,t.geodeticCoordinate=i,t.geodeticDistance=r,t.greatEllipticDistance=n}(lR||(lR={})),function(t){function e(o,a){return P.PeMath.prototype.phi_to_eta(o,a)}function i(o,a){return P.PeMath.prototype.eta_to_phi(o,a)}function r(o,a){return P.PeMath.prototype.phi_to_phig(o,a)}function n(o,a,u){return P.PeMath.prototype.q(o,a,u)}function s(o,a){return P.PeMath.prototype.q90(o,a)}t.phiToEta=e,t.etaToPhi=i,t.phiToPhig=r,t.q=n,t.q90=s}(uR||(uR={})),function(t){const e=(d,p,h,m,y,g)=>{let v,_;switch(P.ensureCache.prepare(),d){case"dd":v=P._pe_geog_to_dd,_=_i.PE_DD_MAX;break;case"ddm":v=P._pe_geog_to_ddm,_=_i.PE_DDM_MAX;break;case"dms":v=P._pe_geog_to_dms,_=_i.PE_DMS_MAX}let w=0;p&&(w=P.getPointer(p));const S=iy(m),E=P.ensureFloat64(S),T=eT(h,_),M=v(w,h,E,y,P.ensureInt32(T));if(M)for(let x=0;x<h;x++)g[x]=P.UTF8ToString(T[x]);return M},i=(d,p,h,m,y)=>{let g;switch(P.ensureCache.prepare(),d){case"dd":g=P._pe_dd_to_geog;break;case"ddm":g=P._pe_ddm_to_geog;break;case"dms":g=P._pe_dms_to_geog}let v=0;p&&(v=P.getPointer(p));const _=m.map(T=>P.ensureString(T)),w=P.ensureInt32(_),S=P.ensureFloat64(new Array(2*h)),E=g(v,h,w,S);return E&&zh(y,h,S),E};function r(d,p,h,m,y){return e("dms",d,p,h,m,y)}function n(d,p,h,m){return i("dms",d,p,h,m)}function s(d,p,h,m,y){return e("ddm",d,p,h,m,y)}function o(d,p,h,m){return i("ddm",d,p,h,m)}function a(d,p,h,m,y){return e("dd",d,p,h,m,y)}function u(d,p,h,m){return i("dd",d,p,h,m)}t.geogToDms=r,t.dmsToGeog=n,t.geogToDdm=s,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=u}(cR||(cR={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=P.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=P.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=P.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=P.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=P.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(n,s,o,a,u,d,p){P.ensureCache.prepare();let h=0;n&&(h=P.getPointer(n));const m=iy(o),y=P.ensureFloat64(m),g=eT(s,_i.PE_MGRS_MAX),v=P.ensureInt32(g),_=P._pe_geog_to_mgrs_extended(h,s,y,a,u,d,v);if(_)for(let w=0;w<s;w++)p[w]=P.UTF8ToString(g[w]);return _}function r(n,s,o,a,u){P.ensureCache.prepare();let d=0;n&&(d=P.getPointer(n));const p=o.map(g=>P.ensureString(g)),h=P.ensureInt32(p),m=P.ensureFloat64(new Array(2*s)),y=P._pe_mgrs_to_geog_extended(d,s,h,a,m);return y&&zh(u,s,m),y}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=r}(QM||(QM={})),function(t){function e(r,n,s,o,a,u,d){P.ensureCache.prepare();let p=0;r&&(p=P.getPointer(r));const h=iy(s),m=P.ensureFloat64(h),y=eT(n,_i.PE_MGRS_MAX),g=P.ensureInt32(y),v=P._pe_geog_to_usng(p,n,m,o,a,u,g);if(v)for(let _=0;_<n;_++)d[_]=P.UTF8ToString(y[_]);return v}function i(r,n,s,o){P.ensureCache.prepare();let a=0;r&&(a=P.getPointer(r));const u=s.map(m=>P.ensureString(m)),d=P.ensureInt32(u),p=P.ensureFloat64(new Array(2*n)),h=P._pe_usng_to_geog(a,n,d,p);return h&&zh(o,n,p),h}t.geogToUsng=e,t.usngToGeog=i}(dR||(dR={})),function(t){function e(){t.PE_UTM_OPTS_NONE=P.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=P.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=P.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(n,s,o,a,u){P.ensureCache.prepare();let d=0;n&&(d=P.getPointer(n));const p=iy(o),h=P.ensureFloat64(p),m=eT(s,_i.PE_UTM_MAX),y=P.ensureInt32(m),g=P._pe_geog_to_utm(d,s,h,a,y);if(g)for(let v=0;v<s;v++)u[v]=P.UTF8ToString(m[v]);return g}function r(n,s,o,a,u){P.ensureCache.prepare();let d=0;n&&(d=P.getPointer(n));const p=o.map(g=>P.ensureString(g)),h=P.ensureInt32(p),m=P.ensureFloat64(new Array(2*s)),y=P._pe_utm_to_geog(d,s,h,a,m);return y&&zh(u,s,m),y}t.init=e,t.geogToUtm=i,t.utmToGeog=r}(e2||(e2={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=P.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=P.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=P.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=P.PePCSInfo.prototype.PE_POLE_POINT}function r(n,s=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(n)&&(a=e.get(n),a[s]&&(o=a[s])),o||(o=P.PePCSInfo.prototype.generate(n,s),a||(a=[],e.set(n,a)),a[s]=o),o}t.init=i,t.generate=r}(t2||(t2={})),function(t){function e(){return P.PeVersion.prototype.version_string()}t.versionString=e}(pR||(pR={}));const Yme=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return sR},get PeDefs(){return _i},get PeDouble(){return FJ},get PeFactory(){return zS},get PeGCSExtent(){return NJ},get PeGTTransformations(){return aR},get PeGTlistExtended(){return XM},get PeGTlistExtendedEntry(){return oR},get PeLineType(){return lR},get PeMath(){return uR},get PeNotationDms(){return cR},get PeNotationMgrs(){return QM},get PeNotationUsng(){return dR},get PeNotationUtm(){return e2},get PePCSInfo(){return t2},get PeVersion(){return pR},_init:DJ,get _pe(){return P},isLoaded:FC,isSupported:Jme,load:IV},Symbol.toStringTag,{value:"Module"}));var Ry;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(Ry||(Ry={}));let f;const I={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(f=2e3;f<=2045;f++)I[f]=0;for(f=2056;f<=2065;f++)I[f]=0;for(f=2067;f<=2135;f++)I[f]=0;for(f=2137;f<=2154;f++)I[f]=0;for(f=2161;f<=2170;f++)I[f]=0;for(f=2172;f<=2193;f++)I[f]=0;for(f=2195;f<=2198;f++)I[f]=0;for(f=2200;f<=2203;f++)I[f]=0;for(f=2205;f<=2217;f++)I[f]=0;for(f=2222;f<=2224;f++)I[f]=1;for(f=2225;f<=2250;f++)I[f]=2;for(f=2251;f<=2253;f++)I[f]=1;for(f=2257;f<=2264;f++)I[f]=2;for(f=2274;f<=2279;f++)I[f]=2;for(f=2280;f<=2282;f++)I[f]=1;for(f=2283;f<=2289;f++)I[f]=2;for(f=2290;f<=2292;f++)I[f]=0;for(f=2308;f<=2313;f++)I[f]=0;for(f=2315;f<=2491;f++)I[f]=0;for(f=2494;f<=2866;f++)I[f]=0;for(f=2867;f<=2869;f++)I[f]=1;for(f=2870;f<=2888;f++)I[f]=2;for(f=2891;f<=2895;f++)I[f]=2;for(f=2896;f<=2898;f++)I[f]=1;for(f=2902;f<=2908;f++)I[f]=2;for(f=2915;f<=2920;f++)I[f]=2;for(f=2921;f<=2923;f++)I[f]=1;for(f=2924;f<=2930;f++)I[f]=2;for(f=2931;f<=2962;f++)I[f]=0;for(f=2964;f<=2968;f++)I[f]=2;for(f=2969;f<=2973;f++)I[f]=0;for(f=2975;f<=2991;f++)I[f]=0;for(f=2995;f<=3051;f++)I[f]=0;for(f=3054;f<=3079;f++)I[f]=0;for(f=3081;f<=3088;f++)I[f]=0;for(f=3092;f<=3101;f++)I[f]=0;for(f=3106;f<=3138;f++)I[f]=0;for(f=3146;f<=3151;f++)I[f]=0;for(f=3153;f<=3166;f++)I[f]=0;for(f=3168;f<=3172;f++)I[f]=0;for(f=3174;f<=3203;f++)I[f]=0;for(f=3294;f<=3358;f++)I[f]=0;for(f=3367;f<=3403;f++)I[f]=0;for(f=3408;f<=3416;f++)I[f]=0;for(f=3417;f<=3438;f++)I[f]=2;for(f=3441;f<=3446;f++)I[f]=2;for(f=3447;f<=3450;f++)I[f]=0;for(f=3451;f<=3459;f++)I[f]=2;for(f=3460;f<=3478;f++)I[f]=0;for(f=3554;f<=3559;f++)I[f]=0;for(f=3560;f<=3570;f++)I[f]=2;for(f=3571;f<=3581;f++)I[f]=0;for(f=3594;f<=3597;f++)I[f]=0;for(f=3601;f<=3604;f++)I[f]=0;for(f=3637;f<=3639;f++)I[f]=0;for(f=3665;f<=3667;f++)I[f]=0;for(f=3693;f<=3695;f++)I[f]=0;for(f=3701;f<=3727;f++)I[f]=0;for(f=3728;f<=3739;f++)I[f]=2;for(f=3740;f<=3751;f++)I[f]=0;for(f=3753;f<=3760;f++)I[f]=2;for(f=3761;f<=3773;f++)I[f]=0;for(f=3775;f<=3777;f++)I[f]=0;for(f=3779;f<=3781;f++)I[f]=0;for(f=3783;f<=3785;f++)I[f]=0;for(f=3788;f<=3791;f++)I[f]=0;for(f=3797;f<=3802;f++)I[f]=0;for(f=3814;f<=3816;f++)I[f]=0;for(f=3825;f<=3829;f++)I[f]=0;for(f=3832;f<=3841;f++)I[f]=0;for(f=3844;f<=3852;f++)I[f]=0;for(f=3873;f<=3885;f++)I[f]=0;for(f=3890;f<=3893;f++)I[f]=0;for(f=3907;f<=3912;f++)I[f]=0;for(f=3942;f<=3950;f++)I[f]=0;for(f=3968;f<=3970;f++)I[f]=0;for(f=3973;f<=3976;f++)I[f]=0;for(f=3986;f<=3989;f++)I[f]=0;for(f=3994;f<=3997;f++)I[f]=0;for(f=4048;f<=4051;f++)I[f]=0;for(f=4056;f<=4063;f++)I[f]=0;for(f=4093;f<=4096;f++)I[f]=0;for(f=4390;f<=4398;f++)I[f]=0;for(f=4399;f<=4413;f++)I[f]=2;for(f=4418;f<=4433;f++)I[f]=2;for(f=4455;f<=4457;f++)I[f]=2;for(f=4484;f<=4489;f++)I[f]=0;for(f=4491;f<=4554;f++)I[f]=0;for(f=4568;f<=4589;f++)I[f]=0;for(f=4652;f<=4656;f++)I[f]=0;for(f=4766;f<=4800;f++)I[f]=0;for(f=5014;f<=5016;f++)I[f]=0;for(f=5069;f<=5072;f++)I[f]=0;for(f=5105;f<=5130;f++)I[f]=0;for(f=5167;f<=5188;f++)I[f]=0;for(f=5253;f<=5259;f++)I[f]=0;for(f=5269;f<=5275;f++)I[f]=0;for(f=5292;f<=5311;f++)I[f]=0;for(f=5329;f<=5331;f++)I[f]=0;for(f=5343;f<=5349;f++)I[f]=0;for(f=5355;f<=5357;f++)I[f]=0;for(f=5387;f<=5389;f++)I[f]=0;for(f=5459;f<=5463;f++)I[f]=0;for(f=5479;f<=5482;f++)I[f]=0;for(f=5518;f<=5520;f++)I[f]=0;for(f=5530;f<=5539;f++)I[f]=0;for(f=5550;f<=5552;f++)I[f]=0;for(f=5562;f<=5583;f++)I[f]=0;for(f=5623;f<=5625;f++)I[f]=2;for(f=5631;f<=5639;f++)I[f]=0;for(f=5649;f<=5653;f++)I[f]=0;for(f=5663;f<=5680;f++)I[f]=0;for(f=5682;f<=5685;f++)I[f]=0;for(f=5875;f<=5877;f++)I[f]=0;for(f=5896;f<=5899;f++)I[f]=0;for(f=5921;f<=5940;f++)I[f]=0;for(f=6050;f<=6125;f++)I[f]=0;for(f=6244;f<=6275;f++)I[f]=0;for(f=6328;f<=6348;f++)I[f]=0;for(f=6350;f<=6356;f++)I[f]=0;for(f=6366;f<=6372;f++)I[f]=0;for(f=6381;f<=6387;f++)I[f]=0;for(f=6393;f<=6404;f++)I[f]=0;for(f=6480;f<=6483;f++)I[f]=0;for(f=6511;f<=6514;f++)I[f]=0;for(f=6579;f<=6581;f++)I[f]=0;for(f=6619;f<=6624;f++)I[f]=0;for(f=6625;f<=6627;f++)I[f]=2;for(f=6628;f<=6632;f++)I[f]=0;for(f=6634;f<=6637;f++)I[f]=0;for(f=6669;f<=6692;f++)I[f]=0;for(f=6707;f<=6709;f++)I[f]=0;for(f=6720;f<=6723;f++)I[f]=0;for(f=6732;f<=6738;f++)I[f]=0;for(f=6931;f<=6933;f++)I[f]=0;for(f=6956;f<=6959;f++)I[f]=0;for(f=7005;f<=7007;f++)I[f]=0;for(f=7057;f<=7070;f++)I[f]=2;for(f=7074;f<=7082;f++)I[f]=0;for(f=7109;f<=7118;f++)I[f]=0;for(f=7119;f<=7127;f++)I[f]=1;for(f=7374;f<=7376;f++)I[f]=0;for(f=7528;f<=7586;f++)I[f]=0;for(f=7587;f<=7645;f++)I[f]=2;for(f=7692;f<=7696;f++)I[f]=0;for(f=7755;f<=7787;f++)I[f]=0;for(f=7791;f<=7795;f++)I[f]=0;for(f=7799;f<=7801;f++)I[f]=0;for(f=7803;f<=7805;f++)I[f]=0;for(f=7825;f<=7831;f++)I[f]=0;for(f=7845;f<=7859;f++)I[f]=0;for(f=8013;f<=8032;f++)I[f]=0;for(f=8065;f<=8068;f++)I[f]=1;for(f=8518;f<=8529;f++)I[f]=2;for(f=8533;f<=8536;f++)I[f]=2;for(f=8538;f<=8540;f++)I[f]=2;for(f=8677;f<=8679;f++)I[f]=0;for(f=8836;f<=8840;f++)I[f]=0;for(f=8857;f<=8859;f++)I[f]=0;for(f=8908;f<=8910;f++)I[f]=0;for(f=9154;f<=9159;f++)I[f]=0;for(f=9205;f<=9218;f++)I[f]=0;for(f=9271;f<=9273;f++)I[f]=0;for(f=9295;f<=9297;f++)I[f]=0;for(f=9356;f<=9360;f++)I[f]=0;for(f=9404;f<=9407;f++)I[f]=0;for(f=9476;f<=9482;f++)I[f]=0;for(f=9487;f<=9494;f++)I[f]=0;for(f=9697;f<=9699;f++)I[f]=0;for(f=9821;f<=9865;f++)I[f]=0;for(f=10285;f<=10291;f++)I[f]=0;for(f=10314;f<=10317;f++)I[f]=0;for(f=10448;f<=10465;f++)I[f]=0;for(f=10731;f<=10733;f++)I[f]=0;for(f=11114;f<=11118;f++)I[f]=0;for(f=20004;f<=20032;f++)I[f]=0;for(f=20047;f<=20049;f++)I[f]=0;for(f=20062;f<=20092;f++)I[f]=0;for(f=20135;f<=20138;f++)I[f]=0;for(f=20248;f<=20258;f++)I[f]=0;for(f=20348;f<=20358;f++)I[f]=0;for(f=20436;f<=20440;f++)I[f]=0;for(f=20822;f<=20824;f++)I[f]=0;for(f=20904;f<=20932;f++)I[f]=0;for(f=20934;f<=20936;f++)I[f]=0;for(f=21004;f<=21032;f++)I[f]=0;for(f=21035;f<=21037;f++)I[f]=0;for(f=21095;f<=21097;f++)I[f]=0;for(f=21148;f<=21150;f++)I[f]=0;for(f=21207;f<=21264;f++)I[f]=0;for(f=21307;f<=21364;f++)I[f]=0;for(f=21413;f<=21423;f++)I[f]=0;for(f=21453;f<=21463;f++)I[f]=0;for(f=21473;f<=21483;f++)I[f]=0;for(f=21780;f<=21782;f++)I[f]=0;for(f=21891;f<=21894;f++)I[f]=0;for(f=21896;f<=21899;f++)I[f]=0;for(f=22171;f<=22177;f++)I[f]=0;for(f=22181;f<=22187;f++)I[f]=0;for(f=22191;f<=22197;f++)I[f]=0;for(f=22207;f<=22222;f++)I[f]=0;for(f=22229;f<=22232;f++)I[f]=0;for(f=22234;f<=22236;f++)I[f]=0;for(f=22243;f<=22250;f++)I[f]=0;for(f=22262;f<=22265;f++)I[f]=0;for(f=22307;f<=22322;f++)I[f]=0;for(f=22348;f<=22357;f++)I[f]=0;for(f=22407;f<=22422;f++)I[f]=0;for(f=22462;f<=22465;f++)I[f]=0;for(f=22521;f<=22525;f++)I[f]=0;for(f=22607;f<=22622;f++)I[f]=0;for(f=22641;f<=22646;f++)I[f]=0;for(f=22648;f<=22657;f++)I[f]=0;for(f=22707;f<=22722;f++)I[f]=0;for(f=22762;f<=22765;f++)I[f]=0;for(f=22807;f<=22822;f++)I[f]=0;for(f=22991;f<=22994;f++)I[f]=0;for(f=23028;f<=23038;f++)I[f]=0;for(f=23301;f<=23333;f++)I[f]=2;for(f=23830;f<=23853;f++)I[f]=0;for(f=23866;f<=23872;f++)I[f]=0;for(f=23877;f<=23884;f++)I[f]=0;for(f=23886;f<=23894;f++)I[f]=0;for(f=23946;f<=23948;f++)I[f]=0;for(f=24311;f<=24313;f++)I[f]=0;for(f=24342;f<=24347;f++)I[f]=0;for(f=24370;f<=24374;f++)I[f]=10;for(f=24375;f<=24381;f++)I[f]=0;for(f=24718;f<=24721;f++)I[f]=0;for(f=24817;f<=24821;f++)I[f]=0;for(f=24877;f<=24882;f++)I[f]=0;for(f=24891;f<=24893;f++)I[f]=0;for(f=25391;f<=25395;f++)I[f]=0;for(f=25828;f<=25838;f++)I[f]=0;for(f=26191;f<=26195;f++)I[f]=0;for(f=26391;f<=26393;f++)I[f]=0;for(f=26701;f<=26722;f++)I[f]=0;for(f=26729;f<=26799;f++)I[f]=2;for(f=26801;f<=26803;f++)I[f]=2;for(f=26811;f<=26813;f++)I[f]=2;for(f=26847;f<=26870;f++)I[f]=2;for(f=26891;f<=26899;f++)I[f]=0;for(f=26901;f<=26923;f++)I[f]=0;for(f=26929;f<=26946;f++)I[f]=0;for(f=26948;f<=26998;f++)I[f]=0;for(f=27037;f<=27040;f++)I[f]=0;for(f=27205;f<=27232;f++)I[f]=0;for(f=27258;f<=27260;f++)I[f]=0;for(f=27391;f<=27398;f++)I[f]=0;for(f=27561;f<=27564;f++)I[f]=0;for(f=27571;f<=27574;f++)I[f]=0;for(f=27581;f<=27584;f++)I[f]=0;for(f=27591;f<=27594;f++)I[f]=0;for(f=27700;f<=27707;f++)I[f]=0;for(f=28191;f<=28193;f++)I[f]=0;for(f=28348;f<=28358;f++)I[f]=0;for(f=28402;f<=28432;f++)I[f]=0;for(f=28462;f<=28492;f++)I[f]=0;for(f=29118;f<=29122;f++)I[f]=0;for(f=29168;f<=29172;f++)I[f]=0;for(f=29177;f<=29185;f++)I[f]=0;for(f=29187;f<=29195;f++)I[f]=0;for(f=29900;f<=29903;f++)I[f]=0;for(f=30161;f<=30179;f++)I[f]=0;for(f=30491;f<=30494;f++)I[f]=0;for(f=30729;f<=30732;f++)I[f]=0;for(f=31251;f<=31259;f++)I[f]=0;for(f=31265;f<=31268;f++)I[f]=0;for(f=31275;f<=31279;f++)I[f]=0;for(f=31281;f<=31297;f++)I[f]=0;for(f=31461;f<=31469;f++)I[f]=0;for(f=31491;f<=31495;f++)I[f]=0;for(f=31917;f<=31922;f++)I[f]=0;for(f=31965;f<=32e3;f++)I[f]=0;for(f=32001;f<=32003;f++)I[f]=2;for(f=32005;f<=32031;f++)I[f]=2;for(f=32033;f<=32060;f++)I[f]=2;for(f=32064;f<=32067;f++)I[f]=2;for(f=32074;f<=32077;f++)I[f]=2;for(f=32081;f<=32086;f++)I[f]=0;for(f=32107;f<=32130;f++)I[f]=0;for(f=32133;f<=32159;f++)I[f]=0;for(f=32164;f<=32167;f++)I[f]=2;for(f=32180;f<=32199;f++)I[f]=0;for(f=32201;f<=32260;f++)I[f]=0;for(f=32301;f<=32360;f++)I[f]=0;for(f=32401;f<=32460;f++)I[f]=0;for(f=32501;f<=32560;f++)I[f]=0;for(f=32601;f<=32662;f++)I[f]=0;for(f=32664;f<=32667;f++)I[f]=2;for(f=32701;f<=32761;f++)I[f]=0;for(f=53001;f<=53004;f++)I[f]=0;for(f=53008;f<=53019;f++)I[f]=0;for(f=53021;f<=53032;f++)I[f]=0;for(f=53034;f<=53037;f++)I[f]=0;for(f=53042;f<=53046;f++)I[f]=0;for(f=53074;f<=53080;f++)I[f]=0;for(f=54001;f<=54004;f++)I[f]=0;for(f=54008;f<=54019;f++)I[f]=0;for(f=54021;f<=54032;f++)I[f]=0;for(f=54034;f<=54037;f++)I[f]=0;for(f=54042;f<=54046;f++)I[f]=0;for(f=54048;f<=54053;f++)I[f]=0;for(f=54074;f<=54080;f++)I[f]=0;for(f=54098;f<=54101;f++)I[f]=0;for(f=102001;f<=102040;f++)I[f]=0;for(f=102042;f<=102063;f++)I[f]=0;for(f=102065;f<=102067;f++)I[f]=0;for(f=102070;f<=102117;f++)I[f]=0;for(f=102122;f<=102216;f++)I[f]=0;for(f=102221;f<=102377;f++)I[f]=0;for(f=102382;f<=102388;f++)I[f]=0;for(f=102389;f<=102398;f++)I[f]=2;for(f=102399;f<=102444;f++)I[f]=0;for(f=102445;f<=102447;f++)I[f]=2;for(f=102448;f<=102458;f++)I[f]=0;for(f=102459;f<=102468;f++)I[f]=2;for(f=102469;f<=102499;f++)I[f]=0;for(f=102500;f<=102519;f++)I[f]=1;for(f=102520;f<=102524;f++)I[f]=0;for(f=102525;f<=102529;f++)I[f]=2;for(f=102530;f<=102588;f++)I[f]=0;for(f=102590;f<=102598;f++)I[f]=0;for(f=102601;f<=102603;f++)I[f]=0;for(f=102605;f<=102628;f++)I[f]=0;for(f=102629;f<=102646;f++)I[f]=2;for(f=102648;f<=102700;f++)I[f]=2;for(f=102701;f<=102703;f++)I[f]=0;for(f=102707;f<=102730;f++)I[f]=2;for(f=102733;f<=102758;f++)I[f]=2;for(f=102767;f<=102900;f++)I[f]=0;for(f=102901;f<=102933;f++)I[f]=2;for(f=102934;f<=102950;f++)I[f]=13;for(f=102951;f<=102963;f++)I[f]=0;for(f=102965;f<=102969;f++)I[f]=0;for(f=102971;f<=102973;f++)I[f]=0;for(f=102975;f<=102989;f++)I[f]=0;for(f=102990;f<=102992;f++)I[f]=1;for(f=102997;f<=103002;f++)I[f]=0;for(f=103003;f<=103008;f++)I[f]=2;for(f=103009;f<=103011;f++)I[f]=0;for(f=103012;f<=103014;f++)I[f]=2;for(f=103019;f<=103021;f++)I[f]=0;for(f=103022;f<=103024;f++)I[f]=2;for(f=103029;f<=103031;f++)I[f]=0;for(f=103032;f<=103034;f++)I[f]=2;for(f=103065;f<=103068;f++)I[f]=0;for(f=103074;f<=103076;f++)I[f]=0;for(f=103077;f<=103079;f++)I[f]=1;for(f=103080;f<=103082;f++)I[f]=0;for(f=103083;f<=103085;f++)I[f]=2;for(f=103090;f<=103093;f++)I[f]=0;for(f=103097;f<=103099;f++)I[f]=0;for(f=103100;f<=103102;f++)I[f]=2;for(f=103107;f<=103109;f++)I[f]=0;for(f=103110;f<=103112;f++)I[f]=2;for(f=103113;f<=103116;f++)I[f]=0;for(f=103117;f<=103120;f++)I[f]=2;for(f=103153;f<=103157;f++)I[f]=0;for(f=103158;f<=103162;f++)I[f]=2;for(f=103163;f<=103165;f++)I[f]=0;for(f=103166;f<=103168;f++)I[f]=1;for(f=103169;f<=103171;f++)I[f]=2;for(f=103186;f<=103188;f++)I[f]=0;for(f=103189;f<=103191;f++)I[f]=2;for(f=103192;f<=103195;f++)I[f]=0;for(f=103196;f<=103199;f++)I[f]=2;for(f=103200;f<=103224;f++)I[f]=0;for(f=103225;f<=103227;f++)I[f]=1;for(f=103232;f<=103237;f++)I[f]=0;for(f=103238;f<=103243;f++)I[f]=2;for(f=103244;f<=103246;f++)I[f]=0;for(f=103247;f<=103249;f++)I[f]=2;for(f=103254;f<=103256;f++)I[f]=0;for(f=103257;f<=103259;f++)I[f]=2;for(f=103264;f<=103266;f++)I[f]=0;for(f=103267;f<=103269;f++)I[f]=2;for(f=103300;f<=103375;f++)I[f]=0;for(f=103381;f<=103383;f++)I[f]=0;for(f=103384;f<=103386;f++)I[f]=1;for(f=103387;f<=103389;f++)I[f]=0;for(f=103390;f<=103392;f++)I[f]=2;for(f=103397;f<=103399;f++)I[f]=0;for(f=103400;f<=103471;f++)I[f]=2;for(f=103476;f<=103478;f++)I[f]=0;for(f=103479;f<=103481;f++)I[f]=2;for(f=103486;f<=103488;f++)I[f]=0;for(f=103489;f<=103491;f++)I[f]=2;for(f=103492;f<=103495;f++)I[f]=0;for(f=103496;f<=103499;f++)I[f]=2;for(f=103528;f<=103543;f++)I[f]=0;for(f=103544;f<=103548;f++)I[f]=2;for(f=103549;f<=103551;f++)I[f]=0;for(f=103552;f<=103554;f++)I[f]=1;for(f=103555;f<=103557;f++)I[f]=2;for(f=103558;f<=103560;f++)I[f]=0;for(f=103571;f<=103573;f++)I[f]=0;for(f=103574;f<=103576;f++)I[f]=2;for(f=103577;f<=103580;f++)I[f]=0;for(f=103581;f<=103583;f++)I[f]=2;for(f=103595;f<=103694;f++)I[f]=0;for(f=103696;f<=103699;f++)I[f]=0;for(f=103700;f<=103793;f++)I[f]=2;for(f=103794;f<=103890;f++)I[f]=0;for(f=103891;f<=103896;f++)I[f]=2;for(f=103900;f<=103971;f++)I[f]=2;for(f=103972;f<=103977;f++)I[f]=0;for(f=112e3;f<=112101;f++)I[f]=0;const VJ=[102100,102113,3857,3785,900913],Kme=[104905,104971],Xme=[4326,...VJ,...Kme],BS=[-20037508342788905e-9,20037508342788905e-9],hR=[-20037508342787e-6,20037508342787e-6],EL={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:BS,origin:hR,dx:1e-5},UJ={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:BS,origin:hR,dx:1e-5},102100:EL,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:BS,origin:hR,dx:1e-5},3857:EL,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:EL};function ci(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const i=t.wkid,r=e.wkid;if(i!=null||r!=null){if(i===r||el(t)&&el(e))return!0;const o=t.latestWkid;if(o!=null&&r===o)return!0;const a=e.latestWkid;return a!=null&&i===a}let n,s;return t.wkt2&&e.wkt2?(n=t.wkt2,s=e.wkt2):t.wkt&&e.wkt&&(n=t.wkt,s=e.wkt),!(!n||!s)&&n.toUpperCase()===s.toUpperCase()}async function dJe(t,e){if(t===e)return!0;FC()||await IV();const i=s=>{var u;const o=s.wkt2||s.wkt;if(o){const d=zS.fromString(_i.PE_TYPE_NONE,o);return d==null?void 0:d.getCode()}const a=s.wkid??s.latestWkid;return a?(u=zS.coordsys(a))==null?void 0:u.getCode():null},r=t?i(t):null,n=e?i(e):null;return r!=null&&n!=null&&r===n}function Ln(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&UJ[e]||null}function i2(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function u_(t){if(!Cs(t))return!1;const{wkid:e}=t;if(e)return I[e]==null;const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function Qme(t){return!(jJ(t)||GJ(t))}function hm(t){return(t==null?void 0:t.wkid)===4326}function pJe(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function _G(t){return(t==null?void 0:t.wkid)===Ry.CGCS2000}function el(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&VJ.includes(e)}function mR(t){return(t==null?void 0:t.wkid)===32662}function bb(t){return t===Ry.GCSMARS2000||t===Ry.GCSMARS2000_SPHERE}function jJ(t){return bb(t==null?void 0:t.wkid)}function _b(t){return t===Ry.GCSMOON2000}function GJ(t){return _b(t==null?void 0:t.wkid)}function efe(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&Xme.includes(e)}function Cs(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const zJ={wkid:4326,wkt:mu(UJ[4326].wkTemplate,{Central_Meridian:"0.0"})},BJ={wkid:102100,latestWkid:3857},tfe={wkid:32662};function xV(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const HJ=xV(Wi),NC=xV(_c),DC=xV(pm),qJ={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Wi.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},ife=NC.wkt.toUpperCase(),rfe=DC.wkt.toUpperCase();function VC(t){if(t!=null&&Cs(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(bb(e))return _c;const r=i==null?void 0:i.toUpperCase();if(i&&r===ife)return _c;if(_b(e)||r&&r===rfe)return pm}return Wi}function hJe(t){return bb(t)?_c:_b(t)?pm:Wi}function r2(t){return ci(t,HJ)}function mm(t){return r2(t)||ci(t,NC)||ci(t,DC)}const UC=39.37,nfe=Wi.radius*Math.PI/200,WJ=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,_y=I,ZJ=/UNIT\[([^\]]+)]/i,sfe=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),ofe=Me()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain:"chains",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),$u=t=>t*t,Lp=t=>t*t*t,HS={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937},"clarke-feet":{inBaseUnits:.3047972654},"clarke-yards":{inBaseUnits:.9143917962},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"gold-coast-feet":{inBaseUnits:.3047997101815088},chains:{inBaseUnits:20.1168},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:$u(.001)},"square-centimeters":{inBaseUnits:$u(.01)},"square-decimeters":{inBaseUnits:$u(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:$u(1e3)},"square-inches":{inBaseUnits:$u(.0254)},"square-feet":{inBaseUnits:$u(.3048)},"square-yards":{inBaseUnits:$u(.9144)},"square-miles":{inBaseUnits:$u(1609.344)},"square-us-feet":{inBaseUnits:$u(1200/3937)},acres:{inBaseUnits:.0015625*$u(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Lp(.001)},"cubic-centimeters":{inBaseUnits:1e3*Lp(.01)},"cubic-decimeters":{inBaseUnits:1e3*Lp(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Lp(1e3)},"cubic-inches":{inBaseUnits:1e3*Lp(.0254)},"cubic-feet":{inBaseUnits:1e3*Lp(.3048)},"cubic-yards":{inBaseUnits:1e3*Lp(.9144)},"cubic-miles":{inBaseUnits:1e3*Lp(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},afe=(()=>{const t={};for(const e in HS)for(const i in HS[e].units)t[i]=e;return t})();function lfe(t,e,i){return t*HS[i].units[e].inBaseUnits}function ufe(t,e,i){return t/HS[i].units[e].inBaseUnits}const n2=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],cfe=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function dfe(t){return t==="imperial"||t==="metric"}function cp(t){const e=afe[t];if(!e)throw new Error("unknown type");return e}function wG(t,e=null){return e=e||cp(t),HS[e].baseUnit===t}function Oe(t,e,i){if(e===i)return t;const r=cp(e);if(r!==cp(i))throw new Error("incompatible units");const n=wG(e,r)?t:lfe(t,e,r);return wG(i,r)?n:ufe(n,i,r)}function pfe(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function mJe(t){return pfe(t)}function fJe(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function hfe(t,e,i){switch(i){case"metric":return MV(t,e);case"imperial":return kV(t,e);default:return i}}function mfe(t,e,i){switch(i){case"metric":return CV(t,e);case"imperial":return LV(t,e);default:return i}}function MV(t,e){const i=Oe(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function CV(t,e){const i=Oe(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function kV(t,e){const i=Oe(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function LV(t,e){const i=Oe(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function ffe(t,e){const i=Oe(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function yfe(t,e){const i=Oe(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function gfe(t,e,i){return Oe(t,e,"meters")/(i*Math.PI/180)}function JJ(t){return ofe.fromJSON(t.toLowerCase())||null}function fu(t){if(t!=null&&!Qme(t))return 1;const e=Ci(t);return e>1e5?1:e}function YJ(t){return Ci(t)>=VC(t).metersPerDegree?"meters":D$(t)}function Ci(t,e=Wi.metersPerDegree){return KJ(t,!0)??e}function KJ(t,e=!1){const i=(t==null?void 0:t.wkid)??null,r=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let n=null;if(i){if(bb(i))return _c.metersPerDegree;if(_b(i))return pm.metersPerDegree;n=_y.values[_y[i]],!n&&e&&sfe.has(i)&&(n=nfe)}else r&&(eY(r)?n=SG(WJ.exec(r),n):QJ(r)&&(n=SG(ZJ.exec(r),n)));return n}function yJe(t){return u_(t)?1:Ci(t)}function SG(t,e){return t!=null&&t[1]?XJ(t[1]):e}function XJ(t){return parseFloat(t.split(",")[1])}function D$(t){const e=(t==null?void 0:t.wkid)??null,i=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let r=null;if(e)r=_y.units[_y[e]];else if(i){const n=eY(i)?WJ:QJ(i)?ZJ:null;if(n){const s=n.exec(i);s!=null&&s[1]&&(r=_fe(s[1]))}}return r!=null?JJ(r):null}function gJe(t){const e=D$(t);return e!=null&&n2.includes(e)?e:null}function vfe(t){const e=YJ(t);return e!=null&&n2.includes(e)?e:null}function vJe(t){const e=D$(t);return e==null?null:cfe.get(e)}function QJ(t){return/^GEOCCS/i.test(t)}function eY(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const bfe=1e-7;function _fe(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let i=e==null?void 0:e[1];if(!i||!_y.units.includes(i)){const r=XJ(t);i=null;const n=_y.values;for(let s=0;s<n.length;++s)if(Math.abs(r-n[s])<bfe){i=_y.units[s];break}}return i}function wfe(t){const e=D$(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"chains":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const Sfe={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},$fe={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},Efe={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Tfe=Me()(Sfe),Ife=Me()($fe),bJe=Me()(Efe);var Cu;let Nt=Cu=class extends j{static fromJSON(t){if(!t)return null;if((t==null?void 0:t.wkid)===102100)return Cu.WebMercator;if((t==null?void 0:t.wkid)===4326)return Cu.WGS84;const e=new Cu;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return hm(this)}get isWebMercator(){return el(this)}get isGeographic(){return u_(this)}get isWrappable(){return efe(this)}get metersPerUnit(){return Ci(this)}get unit(){return D$(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===Cu.WGS84)return new Cu(zJ);if(this===Cu.WebMercator)return new Cu(BJ);const t=new Cu;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(t.wkt=this.wkt),this.wkt2!=null&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=R(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:r}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return e==null||r?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return ci(this,t)}toJSON(t){return this.write(void 0,t)}};Nt.GCS_NAD_1927=null,Nt.WGS84=null,Nt.WebMercator=null,Nt.PlateCarree=null,l([c({readOnly:!0})],Nt.prototype,"isWGS84",null),l([c({readOnly:!0})],Nt.prototype,"isWebMercator",null),l([c({readOnly:!0})],Nt.prototype,"isGeographic",null),l([c({readOnly:!0})],Nt.prototype,"isWrappable",null),l([c({type:Xe,json:{write:!0}})],Nt.prototype,"latestWkid",void 0),l([c({readOnly:!0})],Nt.prototype,"metersPerUnit",null),l([c({readOnly:!0})],Nt.prototype,"unit",null),l([c({type:Xe,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Nt.prototype,"wkid",void 0),l([c({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Nt.prototype,"wkt",void 0),l([te("wkt"),te("web-scene","wkt")],Nt.prototype,"writeWkt",null),l([c({type:String,json:{write:!1}})],Nt.prototype,"wkt2",void 0),l([c({type:Xe,json:{write:!0}})],Nt.prototype,"vcsWkid",void 0),l([c({type:Xe,json:{write:!0}})],Nt.prototype,"latestVcsWkid",void 0),l([c()],Nt.prototype,"imageCoordinateSystem",void 0),Nt=Cu=l([$("esri.geometry.SpatialReference")],Nt),Nt.prototype.toJSON.isDefaultToJSON=!0,Nt.GCS_NAD_1927=q.freeze(new Nt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Nt.WGS84=q.freeze(new Nt(zJ)),Nt.WebMercator=q.freeze(new Nt(BJ)),Nt.PlateCarree=q.freeze(new Nt(tfe));const le=Nt;function X(t,e,i){let r,n;return e===void 0||Array.isArray(e)?(n=t,i=e,r=[void 0]):(n=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;r.forEach(u=>{const d=XZ(s,u,n);d.read&&typeof d.read=="object"||(d.read={}),d.read.reader=a[o],i&&(d.read.source=(d.read.source||[]).concat(i))})}}let ku=class extends j{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=le.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof le)return e;if(e!=null){const r=new le;return r.read(e,i),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};l([c()],ku.prototype,"type",void 0),l([c({readOnly:!0})],ku.prototype,"cache",null),l([c({readOnly:!0})],ku.prototype,"extent",null),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ku.prototype,"hasM",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ku.prototype,"hasZ",void 0),l([c({type:le,json:{write:!0},value:le.WGS84})],ku.prototype,"spatialReference",void 0),l([X("spatialReference")],ku.prototype,"readSpatialReference",null),ku=l([$("esri.geometry.Geometry")],ku);const _p=ku,xfe=Object.prototype.toString;function Mfe(t){const e="__accessorMetadata__"in t?pi(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Cfe.apply(this,i)}}function Cfe(t,e,i,r){xC(t,e).cast=r}function kfe(t){return(e,i)=>{xC(e,t).cast=e[i]}}function We(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&xfe.call(t[0])==="[object Function]"?Mfe(t[0]):t.length===1&&typeof t[0]=="string"?kfe(t[0]):void 0}const Lfe=57.29577951308232,Afe=.017453292519943;function $G(t){return t*Lfe}function EG(t){return t*Afe}function wJe(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Wi.radius))}function fR(t){return t.wkid!=null||t.wkt!=null}const TL=[0,0];function s2(t,e,i,r,n){const s=t,o=n;if(o.spatialReference=i,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,TL,r);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,TL,r),[o.xmax,o.ymax]=e(s.xmax,s.ymax,TL,r);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,u=[];let d;for(let p=0;p<a.length;p++){const h=a[p];d=[],u.push(d);for(let m=0;m<h.length;m++)d.push(e(h[m][0],h[m][1],[0,0],r)),h[m].length>2&&d[m].push(h[m][2]),h[m].length>3&&d[m].push(h[m][3])}"paths"in o?o.paths=u:o.rings=u}else if("points"in s&&"points"in o){const a=s.points,u=[];for(let d=0;d<a.length;d++)u[d]=e(a[d][0],a[d][1],[0,0],r),a[d].length>2&&u[d].push(a[d][2]),a[d].length>3&&u[d].push(a[d][3]);o.points=u}return n}function GI(t,e){const i=t&&(fR(t)?t:t.spatialReference),r=e&&(fR(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!r)&&(!!ci(r,i)||el(r)&&hm(i)||el(i)&&hm(r))}function V$(t,e){if(t==null)return null;const i=t.spatialReference,r=e&&(fR(e)?e:e.spatialReference);return GI(i,r)?ci(i,r)?R(t):el(r)?s2(t,b0,le.WebMercator,!1,R(t)):hm(r)?s2(t,jC,le.WGS84,!1,R(t)):null:null}function b0(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=EG(e);return i[0]=EG(t)*Wi.radius,i[1]=Wi.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function jC(t,e,i=[0,0],r=!1){if(t===BS[0])i[0]=-180;else if(t===BS[1])i[0]=180;else{const n=$G(t/Wi.radius);i[0]=r?n:n-360*Math.floor((n+180)/360)}return i[1]=$G(Math.PI/2-2*Math.atan(Math.exp(-e/Wi.radius))),i}function Qd(t,e=!1,i=R(t)){return s2(t,b0,le.WebMercator,e,i)}function hy(t,e=!1,i=R(t)){return s2(t,jC,le.WGS84,e,i)}function tY(t,e){const i=t.x-e.x,r=t.y-e.y,n=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(i*i+r*r+n*n)}function Ofe(t){var e;return((e=iY(t,rY))==null?void 0:e[0])??null}function Rfe(t){var e;return((e=iY(t,rY))==null?void 0:e[1])??null}function iY({x:t,y:e,spatialReference:i},r=[0,0]){if(i){if(el(i))return jC(t,e,r);if(u_(i))return r[0]=t,r[1]=e,r}return null}const rY=[0,0];var zI;const IL=[0,0];function TG(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let ms=zI=class extends _p{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",q.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,r,n){let s;if(Array.isArray(t))s=t,n=e,t=s[0],e=s[1],i=s[2],r=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,i=s.z,r=s.m,(n=s.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new le(n)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)U.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)U.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&(n!=null&&n.isWebMercator)){const a=b0(s.longitude,s.latitude,IL);t=a[0],e=a[1]}}}else TG(i)?(n=i,i=null):TG(r)&&(n=r,r=null);const o={x:t,y:e};return o.x==null&&o.y!=null?U.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&U.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(o.spatialReference=n),i!=null&&(o.z=i),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return Rfe(this)}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",b0(i,t,IL)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return Ofe(this)}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",b0(t,e,IL)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new zI;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return zI.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:r,m:n,spatialReference:s}=this,{z:o,m:a}=t;let{x:u,y:d,spatialReference:p}=t;if(!s.equals(p))if(s.isWebMercator&&p.isWGS84)[u,d]=b0(u,d),p=s;else{if(!s.isWGS84||!p.isWebMercator)return!1;[u,d]=jC(u,d),p=s}return e===u&&i===d&&r===o&&n===a&&s.wkid===p.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=Ln(this.spatialReference);if(!t)return this;let e=this.x;const[i,r]=t.valid,n=2*r;let s;return e>r?(s=Math.ceil(Math.abs(e-r)/n),e-=s*n):e<i&&(s=Math.ceil(Math.abs(e-i)/n),e+=s*n),this._set("x",e),this}distance(t){return tY(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};l([c({readOnly:!0})],ms.prototype,"cache",null),l([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ms.prototype,"hasM",null),l([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ms.prototype,"hasZ",null),l([c({type:Number})],ms.prototype,"latitude",null),l([c({type:Number})],ms.prototype,"longitude",null),l([c({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),We(t=>isNaN(t)?t:xs(t))],ms.prototype,"x",void 0),l([te("x")],ms.prototype,"writeX",null),l([X("x")],ms.prototype,"readX",null),l([c({type:Number,json:{write:!0}})],ms.prototype,"y",void 0),l([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ms.prototype,"z",void 0),l([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],ms.prototype,"m",void 0),ms=zI=l([$("esri.geometry.Point")],ms),ms.prototype.toJSON.isDefaultToJSON=!0;const we=ms,xL=[0,0];function U$(t,e){return e!=null&&Es(t,e.x,e.y,e.z)}function SJe(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!wb(t,i))return!1;return!0}function Pfe(t,e){const{xmin:i,ymin:r,zmin:n,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Es(t,i,r,n)&&Es(t,i,o,n)&&Es(t,s,o,n)&&Es(t,s,r,n)&&Es(t,i,r,a)&&Es(t,i,o,a)&&Es(t,s,o,a)&&Es(t,s,r,a):Es(t,i,r)&&Es(t,i,o)&&Es(t,s,o)&&Es(t,s,r)}function wb(t,e){return Es(t,e[0],e[1])}function Ffe(t,e){return Es(t,e[0],e[1],e[2])}function Es(t,e,i,r){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function AV(t,e){return xL[1]=e.y,xL[0]=e.x,Nfe(t,xL)}function Nfe(t,e){return OV(t.rings,e)}function OV(t,e){if(!t)return!1;if(Dfe(t))return IG(!1,t,e);let i=!1;for(let r=0,n=t.length;r<n;r++)i=IG(i,t[r],e);return i}function Dfe(t){return!Array.isArray(t[0][0])}function IG(t,e,i){const[r,n]=i;let s=t,o=0;for(let a=0,u=e.length;a<u;a++){o++,o===u&&(o=0);const[d,p]=e[a],[h,m]=e[o];(p<n&&m>=n||m<n&&p>=n)&&d+(n-p)/(m-p)*(h-d)<r&&(s=!s)}return s}function Vfe(t,e){return U$(t,e)}function Ufe(t,e){const i=t.hasZ&&e.hasZ;let r,n,s;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(n=e.ymin,t.ymax<n)return!1}else if(n=t.ymin,e.ymax<n)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function jfe(t,e){const{points:i,hasZ:r}=e,n=r?Ffe:wb;for(const s of i)if(n(t,s))return!0;return!1}const Py=[0,0],Fy=[0,0],Ny=[0,0],Dy=[0,0],Gfe=[Py,Fy,Ny,Dy],nY=[[Ny,Py],[Py,Fy],[Fy,Dy],[Dy,Ny]];function zfe(t,e){return Bfe(t,e.rings)}function Bfe(t,e){Py[0]=t.xmin,Py[1]=t.ymax,Fy[0]=t.xmax,Fy[1]=t.ymax,Ny[0]=t.xmin,Ny[1]=t.ymin,Dy[0]=t.xmax,Dy[1]=t.ymin;for(const i of Gfe)if(OV(e,i))return!0;for(const i of e){if(!i.length)continue;let r=i[0];if(wb(t,r))return!0;for(let n=1;n<i.length;n++){const s=i[n];if(wb(t,s)||sY(r,s,nY))return!0;r=s}}return!1}function Hfe(t,e){Py[0]=t.xmin,Py[1]=t.ymax,Fy[0]=t.xmax,Fy[1]=t.ymax,Ny[0]=t.xmin,Ny[1]=t.ymin,Dy[0]=t.xmax,Dy[1]=t.ymin;const i=e.paths;for(const r of i){if(!i.length)continue;let n=r[0];if(wb(t,n))return!0;for(let s=1;s<r.length;s++){const o=r[s];if(wb(t,o)||sY(n,o,nY))return!0;n=o}}return!1}const tn=[0,0];function qfe(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const s=i[n],o=i[n+1];for(let a=e+1;a<t.length;a++)for(let u=0;u<t[a].length-1;u++){const d=t[a][u],p=t[a][u+1];if(yR(s,o,d,p,tn)&&!(tn[0]===s[0]&&tn[1]===s[1]||tn[0]===d[0]&&tn[1]===d[1]||tn[0]===o[0]&&tn[1]===o[1]||tn[0]===p[0]&&tn[1]===p[1]))return!0}}const r=i.length;if(!(r<=4))for(let n=0;n<r-3;n++){let s=r-1;n===0&&(s=r-2);const o=i[n],a=i[n+1];for(let u=n+2;u<s;u++){const d=i[u],p=i[u+1];if(yR(o,a,d,p,tn)&&!(tn[0]===o[0]&&tn[1]===o[1]||tn[0]===d[0]&&tn[1]===d[1]||tn[0]===a[0]&&tn[1]===a[1]||tn[0]===p[0]&&tn[1]===p[1]))return!0}}}return!1}function sY(t,e,i){for(let r=0;r<i.length;r++)if(yR(t,e,i[r][0],i[r][1]))return!0;return!1}function yR(t,e,i,r,n){const[s,o]=t,[a,u]=e,[d,p]=i,[h,m]=r,y=h-d,g=s-d,v=a-s,_=m-p,w=o-p,S=u-o,E=_*v-y*S;if(E===0)return!1;const T=(y*w-_*g)/E,M=(v*w-S*g)/E;return T>=0&&T<=1&&M>=0&&M<=1&&(n&&(n[0]=s+T*(a-s),n[1]=o+T*(u-o)),!0)}function Wfe(t){switch(t){case"esriGeometryEnvelope":case"extent":return Ufe;case"esriGeometryMultipoint":case"multipoint":return jfe;case"esriGeometryPoint":case"point":return Vfe;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return zfe;case"esriGeometryPolyline":case"polyline":return Hfe}}var ua;function Zfe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Ap(t,e,i){return e==null?i:i==null?e:t(e,i)}let Dr=ua=class extends _p{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,r,n){return Zfe(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?le.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:r,spatialReference:n??le.WGS84}}static fromBounds(t,e){return new ua({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new ua({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new we({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new ua;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&GI(e,i)&&(t=e.isWebMercator?Qd(t):hy(t,!0)),t.type==="point"?U$(this,t):t.type==="extent"&&Pfe(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&GI(e,i)&&(t=e.isWebMercator?Qd(t):hy(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,r=this.height*e;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const n=(this.zmax-this.zmin)*e;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*e;this.mmin+=n,this.mmax-=n}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!ci(e,i)&&GI(e,i)&&(t=e.isWebMercator?Qd(t):hy(t,!0)),Wfe(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Ap(Math.min,this.zmin,t.zmin),this.zmax=Ap(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Ap(Math.min,this.mmin,t.mmin),this.mmax=Ap(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Ap(Math.max,this.zmin,t.zmin),this.zmax=Ap(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Ap(Math.max,this.mmin,t.mmin),this.mmax=Ap(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Ln(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const r=e.isWebMercator?hy(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(r.x=ML(r.x,t).x),this.spatialReference=new le(mu((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[i,r]=t.valid,n=this.xmin,s=this.xmax;return n>=i&&n<=r&&s>=i&&s<=r||(e=this.center),e}_normalize(t,e,i){const r=this.spatialReference;if(!r)return this;const n=i??Ln(r);if(n==null)return this;const s=this._getParts(n).map(u=>u.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(t)return this._shiftCM(n);if(e)return s;let o=!0,a=!0;return s.forEach(u=>{u.hasZ||(o=!1),u.hasM||(a=!1)}),{rings:s.map(u=>{const d=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(o){const p=(u.zmax-u.zmin)/2;for(let h=0;h<d.length;h++)d[h].push(p)}if(a){const p=(u.mmax-u.mmin)/2;for(let h=0;h<d.length;h++)d[h].push(p)}return d}),hasZ:o,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:n,ymax:s,spatialReference:o}=this,a=this.width,u=this.xmin,d=this.xmax;let p;t=t||Ln(o);const[h,m]=t.valid;p=ML(this.xmin,t);const y=p.x,g=p.frameId;p=ML(this.xmax,t);const v=p.x,_=p.frameId,w=y===v&&a>0;if(a>2*m){const S=new ua(u<d?y:v,n,m,s,o),E=new ua(h,n,u<d?v:y,s,o),T=new ua(0,n,m,s,o),M=new ua(h,n,0,s,o),x=[],C=[];S.contains(T)&&x.push(g),S.contains(M)&&C.push(g),E.contains(T)&&x.push(_),E.contains(M)&&C.push(_);for(let O=g+1;O<_;O++)x.push(O),C.push(O);e.push({extent:S,frameIds:[g]},{extent:E,frameIds:[_]},{extent:T,frameIds:x},{extent:M,frameIds:C})}else y>v||w?e.push({extent:new ua(y,n,m,s,o),frameIds:[g]},{extent:new ua(h,n,v,s,o),frameIds:[_]}):e.push({extent:new ua(y,n,v,s,o),frameIds:[g]});this.cache._parts=e}const i=this.hasZ,r=this.hasM;if(i||r){const n={};i&&(n.zmin=this.zmin,n.zmax=this.zmax),r&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(n)}return e}};function ML(t,e){const[i,r]=e.valid,n=2*r;let s,o=0;return t>r?(s=Math.ceil(Math.abs(t-r)/n),t-=s*n,o=s):t<i&&(s=Math.ceil(Math.abs(t-i)/n),t+=s*n,o=-s),{x:t,frameId:o}}l([c({readOnly:!0})],Dr.prototype,"cache",null),l([c({readOnly:!0})],Dr.prototype,"center",null),l([c({readOnly:!0})],Dr.prototype,"extent",null),l([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dr.prototype,"hasM",null),l([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dr.prototype,"hasZ",null),l([c({readOnly:!0})],Dr.prototype,"height",null),l([c({readOnly:!0})],Dr.prototype,"width",null),l([c({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"xmin",void 0),l([c({type:Number,json:{write:!0}})],Dr.prototype,"ymin",void 0),l([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dr.prototype,"mmin",void 0),l([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dr.prototype,"zmin",void 0),l([c({type:Number,json:{write:!0}})],Dr.prototype,"xmax",void 0),l([c({type:Number,json:{write:!0}})],Dr.prototype,"ymax",void 0),l([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dr.prototype,"mmax",void 0),l([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dr.prototype,"zmax",void 0),Dr=ua=l([$("esri.geometry.Extent")],Dr),Dr.prototype.toJSON.isDefaultToJSON=!0;const at=Dr;let oY,rS;var JW,YW;const Jfe=((JW=globalThis.esriConfig)==null?void 0:JW.locale)??((YW=globalThis.dojoConfig)==null?void 0:YW.locale);var KW;const nS=(KW=globalThis.document)==null?void 0:KW.documentElement;function aY(){var i;const t=nS==null?void 0:nS.getAttribute("lang"),e=(i=globalThis.navigator)==null?void 0:i.language;return Jfe??t??e??"en"}function An(){return rS===void 0&&(rS=aY()),rS}function Yfe(t){oY=t||void 0,gR()}function lY(t=An()){const e=/^([a-zA-Z]{2,3})(?:[_-][a-zA-Z0-9]+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const BI=[];function GC(t){return BI.push(t),ye(()=>BI.splice(BI.indexOf(t),1))}const HI=[];function RV(t){return HI.push(t),ye(()=>HI.splice(HI.indexOf(t),1))}function gR(){const t=oY??aY();rS!==t&&([...HI].forEach(e=>e(t)),rS=t,[...BI].forEach(e=>e(t)))}var XW;(XW=globalThis.addEventListener)==null||XW.call(globalThis,"languagechange",gR),nS&&new MutationObserver(()=>{gR()}).observe(nS,{attributeFilter:["lang"]});let tT;function Kfe(t){return tT&&!tT.destroyed||(tT=t()),tT}var vR;const Xfe=new $e({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let ca=vR=class extends q{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new vR({categories:this.categories?R(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let r="";if(this.extent){const o=V$(this.extent,le.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const s={categories:i,bbox:r,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>Xfe.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};l([c()],ca.prototype,"categories",void 0),l([c()],ca.prototype,"disableExtraQuery",void 0),l([c({type:at})],ca.prototype,"extent",void 0),l([c()],ca.prototype,"filter",void 0),l([c()],ca.prototype,"num",void 0),l([c()],ca.prototype,"query",void 0),l([c()],ca.prototype,"sortField",void 0),l([c()],ca.prototype,"sortOrder",null),l([c()],ca.prototype,"start",void 0),ca=vR=l([$("esri.portal.PortalQueryParams")],ca);const Uo=ca;var bR;let vr=bR=class extends j{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var i;const t=this.url,e=this.thumbnail;return t&&e&&this.portal?(i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const i=e.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):i})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new L("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new bR({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=pi(Uo,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Uo,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Uo,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then(r=>{const n=r.contentCategorySetsGroupQuery;if(n){const s=new Uo({disableExtraQuery:!0,num:1,query:n});return i.queryGroups(s,e)}throw new L("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const n=r.results[0],s=new Uo({num:1,query:`typekeywords:"${t}"`});return n.queryItems(s,e)}throw new L("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(n=>{const s=n==null?void 0:n.categorySchema;return s!=null&&s.length?s:[]}):[])}};l([c()],vr.prototype,"access",void 0),l([c({type:Date})],vr.prototype,"created",void 0),l([c()],vr.prototype,"description",void 0),l([c()],vr.prototype,"id",void 0),l([c()],vr.prototype,"isInvitationOnly",void 0),l([c({type:Date})],vr.prototype,"modified",void 0),l([c()],vr.prototype,"owner",void 0),l([c()],vr.prototype,"portal",void 0),l([c()],vr.prototype,"snippet",void 0),l([c()],vr.prototype,"sortField",void 0),l([c()],vr.prototype,"sortOrder",void 0),l([c()],vr.prototype,"sourceJSON",void 0),l([c()],vr.prototype,"tags",void 0),l([c()],vr.prototype,"thumbnail",void 0),l([c({readOnly:!0})],vr.prototype,"thumbnailUrl",null),l([c()],vr.prototype,"title",void 0),l([c({readOnly:!0})],vr.prototype,"url",null),vr=bR=l([$("esri.portal.PortalGroup")],vr);const _R=vr;let Xm=class extends q{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};l([c()],Xm.prototype,"nextQueryParams",void 0),l([c()],Xm.prototype,"queryParams",void 0),l([c()],Xm.prototype,"results",void 0),l([c()],Xm.prototype,"total",void 0),Xm=l([$("esri.portal.PortalQueryResult")],Xm);const Qfe=Xm;let Jc=class extends j{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var i;const e=(i=this.portal)==null?void 0:i.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new L("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};l([c({type:Date})],Jc.prototype,"created",void 0),l([c()],Jc.prototype,"id",void 0),l([c()],Jc.prototype,"portal",void 0),l([c()],Jc.prototype,"title",void 0),l([c({readOnly:!0})],Jc.prototype,"url",null),l([c()],Jc.prototype,"username",void 0),Jc=l([$("esri.portal.PortalFolder")],Jc);const eye=Jc;var wR;let li=wR=class extends j{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t==null?void 0:t.data,r=t==null?void 0:t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),i!=null&&(typeof i=="string"?n.query.text=i:typeof i=="object"&&(n.query.text=JSON.stringify(i))));let s=this.userContentUrl;return r&&(s+="/"+(typeof r=="string"?r:r.id)),this.portal.request(s+"/addItem",n).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const i=this.userContentUrl+"/deleteItems",r=[],n=t.map(s=>s.id);if(n.length){const s={method:"post",query:{items:n.join(","),permanentDelete:e}},o=await this.portal.request(i,s);for(const a of o.results){const u=t.find(h=>a.itemId===h.id),d=a.success;let p=null;d?(u.id=null,u.portal=null):a.error&&(p=new L("portal:delete-item-failed",a.error.message,a.error)),r.push({item:u,success:d,error:p})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(r=>{const n=eye.fromJSON(r);return n.portal=this.portal,n}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const r=_R.fromJSON(i);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??(t={});let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await k(()=>Promise.resolve().then(()=>dY),void 0),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},n=await this.portal.request(e,{query:r});let s;return n!=null&&n.items?(s=n.items.map(o=>{const a=i.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(s.map(o=>o.load())),{items:s,nextStart:n.nextStart,total:n.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new _R({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new L("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new L("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new wR({sourceJSON:t});return e.read(t),e}};l([c()],li.prototype,"access",void 0),l([c({type:Date})],li.prototype,"created",void 0),l([c()],li.prototype,"culture",void 0),l([c()],li.prototype,"description",void 0),l([c()],li.prototype,"email",void 0),l([c()],li.prototype,"favGroupId",void 0),l([c()],li.prototype,"fullName",void 0),l([c({type:Date})],li.prototype,"modified",void 0),l([c()],li.prototype,"orgId",void 0),l([c()],li.prototype,"portal",void 0),l([c()],li.prototype,"preferredView",void 0),l([c()],li.prototype,"privileges",void 0),l([c()],li.prototype,"region",void 0),l([c()],li.prototype,"role",void 0),l([c()],li.prototype,"roleId",void 0),l([c()],li.prototype,"sourceJSON",void 0),l([c()],li.prototype,"thumbnail",void 0),l([c({readOnly:!0})],li.prototype,"thumbnailUrl",null),l([c()],li.prototype,"units",void 0),l([c({readOnly:!0})],li.prototype,"userContentUrl",null),l([c({readOnly:!0})],li.prototype,"url",null),l([c()],li.prototype,"username",void 0),l([c()],li.prototype,"userLicenseTypeId",void 0),l([c()],li.prototype,"userType",void 0),li=wR=l([$("esri.portal.PortalUser")],li);const PV=li;var So;let D_;const xG={PortalGroup:()=>Promise.resolve({default:_R}),PortalItem:()=>k(()=>Promise.resolve().then(()=>dY),void 0),PortalUser:()=>Promise.resolve({default:PV})};let re=So=class extends ig(uo){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=et.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){MG.unregister(this),this.defaultBasemap=xe(this.defaultBasemap),this.defaultDevBasemap=xe(this.defaultDevBasemap),this.defaultVectorBasemap=xe(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Kt(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)et.request.trustedServers.includes(e)||et.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){var i;const t=(i=this.user)==null?void 0:i.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.slice(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=PV.fromJSON(t),e.portal=this),e}load(t){const e=k(()=>Promise.resolve().then(()=>Mye),void 0).then(({default:i})=>{qe(t),D_=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(i=>{var r;if(Te){const n=Te;this.credential=n.findCredential(this.restUrl),this.credential||this.authMode!==So.AUTH_MODE_AUTO&&this.authMode!==So.AUTH_MODE_NO_PROMPT||((r=this._esriIdCredentialCreateHandle)==null||r.remove(),this._esriIdCredentialCreateHandle=n.on("credential-create",tye(new WeakRef(this))),MG.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await k(async()=>{const{default:i}=await import("./ElevationLayer-Bauhy7sV.js");return{default:i}},__vite__mapDeps([2,3,4,5,6]))).default;return t?t.map(i=>new e({id:i.id,url:i.url})):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const r=await this._fetchBasemaps3D(t,e);i.unshift(...r)}return i}async fetchDefault3DBasemap(t){if(!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const e=new Uo;e.query=this.default3DBasemapQuery,e.disableExtraQuery=!0;const i=(await this.queryItems(e,t)).results.find(r=>r.type==="Web Scene");return i?new D_({portalItem:i}):null}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):lo(t)?Promise.reject(mt()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new Uo({num:100,sortField:"title"});if(e!=null&&e.length){const r=[];for(const n of e)r.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=r.join(" OR "),this.queryGroups(i,t).then(n=>n.results)}return lo(t)?Promise.reject(mt()):Promise.resolve([])}fetchRegions(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||An();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||An();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return Kfe(()=>new So)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const r=this.restUrl+"/portals/self",n={authMode:t,query:{culture:An().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this.request(r,n)}queryPortal(t,e,i,r){const n=pi(Uo,e),s=o=>this.request(this.restUrl+t,{...n.toRequestOptions(this),...r}).then(a=>{const u=n.clone();return u.start=a.nextStart,new Qfe({nextQueryParams:u,queryParams:n,total:a.total,results:So._resultsToTypedArray(o,{portal:this},a,r)})}).then(a=>Promise.all(a.results.map(u=>typeof u.when=="function"?u.when():a)).then(()=>a,u=>(Vo(u),a)));return i&&xG[i]?xG[i]().then(({default:o})=>(qe(r),s(o))):s()}signIn(){if(this.authMode===So.AUTH_MODE_ANONYMOUS||this.authMode===So.AUTH_MODE_NO_PROMPT&&!Te)return Promise.reject(new L("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return Te?Te.getCredential(this.restUrl,{prompt:this.authMode!==So.AUTH_MODE_NO_PROMPT}).then(e=>t(e)):t(this.credential)}normalizeUrl(t){var i;const e=(i=this.credential)==null?void 0:i.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then(r=>{const n=So._resultsToTypedArray(i,{portal:this},r);return Promise.all(n.map(s=>typeof s.when=="function"?s.when():r)).then(()=>n,()=>n)})}request(t,e={}){const i={f:"json",...e.query},{authMode:r=this.authMode===So.AUTH_MODE_ANONYMOUS||this.authMode===So.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:s=!1,method:o="auto",responseType:a="json",signal:u}=e,d={authMode:r,body:n,cacheBust:s,method:o,query:i,responseType:a,timeout:0,signal:u};return e.withCredentials&&(d.withCredentials=!0),Ee(this._normalizeSSL(t),d).then(p=>p.data)}toJSON(){throw new L("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new So({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new L("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new Uo;i.query=t||(et.apiKey&&wV(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const r=await this.queryGroups(i,e);if(!r.total)return[];const n=r.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const s=await n.queryItems(i,e);return s.total?s.results.filter(o=>o.type==="Web Map").map(o=>new D_({portalItem:o})):[]}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const r=new Uo({query:i,disableExtraQuery:!0}),n=await this.queryGroups(r,e);if(!n.total)return[];const s=n.results[0];r.num=100,r.query='type:"Web Scene"',r.sortField=s.sortField||"name",r.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(r,e);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new D_({portalItem:a})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=D_.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,r){let n;if(i){const s=r!=null?r.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map(o=>{const a=Object.assign(t?t.fromJSON(o):o,e);return typeof a.load=="function"&&a.load(s),a}))}else n=[];return n}};re.AUTH_MODE_ANONYMOUS="anonymous",re.AUTH_MODE_AUTO="auto",re.AUTH_MODE_IMMEDIATE="immediate",re.AUTH_MODE_NO_PROMPT="no-prompt",l([c()],re.prototype,"access",void 0),l([c()],re.prototype,"allSSL",void 0),l([c()],re.prototype,"authMode",void 0),l([c()],re.prototype,"authorizedCrossOriginDomains",void 0),l([X("authorizedCrossOriginDomains")],re.prototype,"readAuthorizedCrossOriginDomains",null),l([c()],re.prototype,"basemapGalleryGroupQuery",void 0),l([c({json:{name:"3DBasemapGalleryGroupQuery"}})],re.prototype,"basemapGalleryGroupQuery3D",void 0),l([c()],re.prototype,"bingKey",void 0),l([c()],re.prototype,"canListApps",void 0),l([c()],re.prototype,"canListData",void 0),l([c()],re.prototype,"canListPreProvisionedItems",void 0),l([c()],re.prototype,"canProvisionDirectPurchase",void 0),l([c()],re.prototype,"canSearchPublic",void 0),l([c()],re.prototype,"canShareBingPublic",void 0),l([c()],re.prototype,"canSharePublic",void 0),l([c()],re.prototype,"canSignInArcGIS",void 0),l([c()],re.prototype,"canSignInIDP",void 0),l([c()],re.prototype,"colorSetsGroupQuery",void 0),l([c()],re.prototype,"commentsEnabled",void 0),l([c({type:Date})],re.prototype,"created",void 0),l([c()],re.prototype,"credential",void 0),l([c()],re.prototype,"culture",void 0),l([c()],re.prototype,"currentVersion",void 0),l([c()],re.prototype,"customBaseUrl",void 0),l([c()],re.prototype,"default3DBasemapQuery",void 0),l([c()],re.prototype,"defaultBasemap",void 0),l([X("defaultBasemap")],re.prototype,"readDefaultBasemap",null),l([c()],re.prototype,"defaultDevBasemap",void 0),l([X("defaultDevBasemap")],re.prototype,"readDefaultDevBasemap",null),l([c({type:at})],re.prototype,"defaultExtent",void 0),l([c()],re.prototype,"defaultVectorBasemap",void 0),l([X("defaultVectorBasemap")],re.prototype,"readDefaultVectorBasemap",null),l([c()],re.prototype,"description",void 0),l([c()],re.prototype,"devBasemapGalleryGroupQuery",void 0),l([c()],re.prototype,"eueiEnabled",void 0),l([c({readOnly:!0})],re.prototype,"extraQuery",null),l([c()],re.prototype,"featuredGroups",void 0),l([c()],re.prototype,"featuredItemsGroupQuery",void 0),l([c()],re.prototype,"galleryTemplatesGroupQuery",void 0),l([c()],re.prototype,"layoutGroupQuery",void 0),l([c()],re.prototype,"livingAtlasGroupQuery",void 0),l([c()],re.prototype,"hasCategorySchema",void 0),l([c()],re.prototype,"hasClassificationSchema",void 0),l([c()],re.prototype,"helpBase",void 0),l([c()],re.prototype,"helperServices",void 0),l([c()],re.prototype,"helpMap",void 0),l([c()],re.prototype,"homePageFeaturedContent",void 0),l([c()],re.prototype,"homePageFeaturedContentCount",void 0),l([c()],re.prototype,"httpPort",void 0),l([c()],re.prototype,"httpsPort",void 0),l([c()],re.prototype,"id",void 0),l([c()],re.prototype,"ipCntryCode",void 0),l([c({readOnly:!0})],re.prototype,"isOrganization",null),l([c()],re.prototype,"isPortal",void 0),l([c()],re.prototype,"isReadOnly",void 0),l([c({readOnly:!0})],re.prototype,"itemPageUrl",null),l([c()],re.prototype,"layerTemplatesGroupQuery",void 0),l([c()],re.prototype,"maxTokenExpirationMinutes",void 0),l([c({type:Date})],re.prototype,"modified",void 0),l([c()],re.prototype,"name",void 0),l([c()],re.prototype,"portalHostname",void 0),l([c()],re.prototype,"portalMode",void 0),l([c()],re.prototype,"portalProperties",void 0),l([c()],re.prototype,"region",void 0),l([c()],re.prototype,"recycleBinEnabled",void 0),l([c({readOnly:!0})],re.prototype,"restUrl",null),l([c()],re.prototype,"rotatorPanels",void 0),l([c()],re.prototype,"showHomePageDescription",void 0),l([c()],re.prototype,"sourceJSON",void 0),l([c()],re.prototype,"staticImagesUrl",void 0),l([c({json:{name:"2DStylesGroupQuery"}})],re.prototype,"stylesGroupQuery2d",void 0),l([c({json:{name:"stylesGroupQuery"}})],re.prototype,"stylesGroupQuery3d",void 0),l([c()],re.prototype,"supportsHostedServices",void 0),l([c()],re.prototype,"symbolSetsGroupQuery",void 0),l([c()],re.prototype,"templatesGroupQuery",void 0),l([c()],re.prototype,"thumbnail",void 0),l([c({readOnly:!0})],re.prototype,"thumbnailUrl",null),l([c()],re.prototype,"units",void 0),l([c()],re.prototype,"url",void 0),l([c()],re.prototype,"urlKey",void 0),l([X("urlKey")],re.prototype,"readUrlKey",null),l([c()],re.prototype,"user",void 0),l([X("user")],re.prototype,"readUser",null),l([c()],re.prototype,"use3dBasemaps",void 0),l([c()],re.prototype,"useStandardizedQuery",void 0),l([c()],re.prototype,"useVectorBasemaps",void 0),l([c()],re.prototype,"vectorBasemapGalleryGroupQuery",void 0),re=So=l([$("esri.portal.Portal")],re);const ki=re,MG=new FinalizationRegistry(t=>{t.remove()});function tye(t){const e=Te;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let Yc=class extends q{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e!=null&&e.portalItem&&e.path?{...e,path:CG(e.path,e.portalItem)}:e}set path(e){e!=null&&Ho(e)?U.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return CG(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",i){const r=this.cdnUrl;if(r==null)throw new L("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey,_ts:i!=null&&i.cacheBust?Date.now():null},signal:i==null?void 0:i.signal})}async update(e,i){const{addOrUpdateResources:r}=await k(()=>import("./resourceUtils-DTdmibk4.js"),[]);return await r(this.portalItem,[{resource:this,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"update",i),this}hasPath(){return this.path!=null}};function CG(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&Ho(t)&&(t=yV(t,e.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}l([c()],Yc.prototype,"portalItem",void 0),l([c({type:String,value:null})],Yc.prototype,"path",null),l([We("path")],Yc.prototype,"_castPath",null),l([c({type:String,readOnly:!0})],Yc.prototype,"url",null),l([c({type:String,readOnly:!0})],Yc.prototype,"cdnUrl",null),l([c({type:String,readOnly:!0})],Yc.prototype,"itemRelativeUrl",null),Yc=l([$("esri.portal.PortalItemResource")],Yc);const iye=Yc;let Aw=class extends q{constructor(e){super(e),this.created=null,this.rating=null}};l([c()],Aw.prototype,"created",void 0),l([c()],Aw.prototype,"rating",void 0),Aw=l([$("esri.portal.PortalRating")],Aw);const CL=Aw;function fm(t,e){var r;const i=(r=e==null?void 0:e.url)==null?void 0:r.path;if(t&&i&&(t=ro(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const n=yV(t,e.portalItem.itemUrl);n!=null&&rye.test(n)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(n).path)}return(t=SR(t,e==null?void 0:e.portal))&&zC.test(t)?NV(t):t}function j$(t,e,i=qS.YES){var n,s;if((t=t&&zC.test(t)?cY(t):t)==null)return t;!Ho(t)&&(e!=null&&e.blockedRelativeUrls)&&e.blockedRelativeUrls.push(t);let r=ro(t);if(e){const o=((n=e.verifyItemRelativeUrls)==null?void 0:n.rootPath)||((s=e.url)==null?void 0:s.path);if(o){const a=SR(o,e.portal),u=SR(r,e.portal);r=yV(u,a,a),r!=null&&r!==u&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=uY(r,e==null?void 0:e.portal),Ho(r)&&(r=kn(r)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!Ho(r)&&!bp(r)&&i===qS.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function FV(t,e,i){return fm(t,i)}function Vy(t,e,i,r){const n=j$(t,r);n!==void 0&&(e[i]=n)}const zC=/\/items\/([^/]+)\/resources\/(.*)/,rye=/^\.\/resources\//;function nye(t){const e=(t==null?void 0:t.match(zC))??null;return(e==null?void 0:e[1])??null}function sye(t){const e=(t==null?void 0:t.match(zC))??null;if(e==null)return null;const i=e[2],r=i.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=dG(i);return{prefix:null,filename:o,extension:a}}const{path:n,extension:s}=dG(i.slice(r+1));return{prefix:i.slice(0,r),filename:n,extension:s}}function uY(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?iR(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function SR(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,r=pV();return Oy(r,`${r.scheme}://${i}`)?iR(t,e.portalHostname,i):iR(t,i,e.portalHostname)}function NV(t){if(!t)return t||null;let e=t;return e&&Te&&!Te.findCredential(e)&&(e=yJ(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function cY(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Te&&!Te.findCredential(e)&&(e=yJ(e)),e}var qS;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(qS||(qS={}));const xJe=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return qS},ensureMainOnlineDomain:uY,fromCDNUrl:cY,fromJSON:fm,itemIdFromResourceUrl:nye,prefixAndFilenameFromResourceUrl:sye,read:FV,toCDNUrl:NV,toJSON:j$,write:Vy},Symbol.toStringTag,{value:"Module"}));var Qm;const oye=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),aye=new Set(["KML","GeoJson","CSV"]);let Ve=Qm=class extends ig(uo){static from(t){return r_(Qm,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return t==="Feature Service"||t==="Feature Collection"?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?i="Scene Layer":t==="Video Service"?i="Video Layer":t==="Scene Package"?i="Scene Layer Package":t==="Stream Service"?i="Feature Layer":t==="Geoprocessing Service"?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?i="GeoEnrichment Service":t==="Geocoding Service"?i="Locator":t==="Microsoft Powerpoint"?i="Microsoft PowerPoint":t==="GeoJson"?i="GeoJSON":t==="Globe Service"?i="Globe Layer":t==="Vector Tile Service"?i="Tile Layer":t==="netCDF"?i="NetCDF":t==="Map Service"?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t!=null&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?i="Big Data File Share":t==="Compact Tile Package"?i="Tile Package (tpkx)":t==="Raster function template"?i="Raster Function Template":t==="OGCFeatureServer"?i="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?i="Instant App":t==="Insights Page"?i="Insights Report":t==="Excalibur Imagery Project"?i="Excalibur Project":t==="3DTiles Service"?i="3D tiles layer":t==="3DTiles Package"&&(i="3D tiles package"),i}readExtent(t){return t&&t.length?new at(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){var y;const t=((y=this.type)==null?void 0:y.toLowerCase())||"",e=this.typeKeywords||[],i="esri/images/portal/",r="16";let n,s=!1,o=!1,a=!1,u=!1,d=!1,p=!1,h=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),u=e.includes("Markup"),d=e.includes("Spatiotemporal"),p=e.includes("UtilityNetwork"),n=d&&o?"spatiotemporaltable":o?"table":a?"routelayer":u?"markup":d?"spatiotemporal":p?"utilitynetwork":s?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(d=e.includes("Spatiotemporal"),h=e.includes("Relational"),n=d||h?"mapimages":s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):n=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?n="maps":t==="web scene"?n=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?n="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?n="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?n="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?n="datafiles":t==="360 vr experience"?n="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?n="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?n="addindesktop":t==="pdf"?n="pdf":t==="microsoft word"?n="word":t==="microsoft excel"?n="excel":t==="microsoft powerpoint"?n="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?n="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?n="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?n="layersgray":t==="analysis model"?n="analysismodel":t==="scene package"?n="scenepackage":t==="3dtiles package"?n="3dtileslayerpackage":t==="3dtiles service"?n="3dtileslayer":t==="mobile scene package"?n="mobilescenepackage":t==="tile package"||t==="compact tile package"?n="tilepackage":t==="task file"?n="taskfile":t==="report template"?n="report-template":t==="statistical data collection"?n="statisticaldatacollection":t==="insights workbook"?n="workbook":t==="insights model"?n="insightsmodel":t==="insights page"?n="insightspage":t==="insights theme"?n="insightstheme":t==="hub initiative"?n="hubinitiative":t==="hub page"?n="hubpage":t==="hub site application"?n="hubsite":t==="hub event"?n="hubevent":t==="hub project"?n="hubproject":t==="relational database connection"?n="relationaldatabaseconnection":t==="big data file share"?n="datastorecollection":t==="image collection"?n="imagecollection":t==="desktop style"?n="desktopstyle":t==="style"?n=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?n="dashboard":t==="raster function template"?n="rasterprocessingtemplate":t==="vector tile package"?n="vectortilepackage":t==="ortho mapping project"?n="orthomappingproject":t==="ortho mapping template"?n="orthomappingtemplate":t==="solution"?n="solutions":t==="geopackage"?n="geopackage":t==="deep learning package"?n="deeplearningpackage":t==="real time analytic"?n="realtimeanalytics":t==="reality mapping project"?n="realitymappingproject":t==="big data analytic"?n="bigdataanalytics":t==="feed"?n="feed":t==="excalibur imagery project"?n="excaliburimageryproject":t==="notebook"?n="notebook":t==="storymap"?n="storymap":t==="survey123 add in"?n="survey123addin":t==="mission"?n="mission":t==="mission report"?n="missionreport":t==="mission template"?n="missiontemplate":t==="quickcapture project"?n="quickcaptureproject":t==="pro report"?n="proreport":t==="pro report template"?n="proreporttemplate":t==="urban model"?n="urbanmodel":t==="urban project"?n="urbanproject":t==="web experience"?n="experiencebuilder":t==="web experience template"?n="webexperiencetemplate":t==="experience builder widget"?n="experiencebuilderwidget":t==="experience builder widget package"?n="experiencebuilderwidgetpackage":t==="workflow"?n="workflow":t==="kernel gateway connection"?n="kernelgatewayconnection":t==="insights script"?n="insightsscript":t==="hub initiative template"?n="hubinitiativetemplate":t==="storymap theme"?n="storymaptheme":t==="knowledge graph"?n="knowledgegraph":t==="knowledge graph layer"?n="knowledgegraphlayer":t==="knowledge studio project"?n="knowledgestudio":t==="native application"?n="nativeapp":t==="native application installer"?n="nativeappinstaller":t==="web link chart"?n="linkchart":t==="knowledge graph web investigation"?n="investigation":t==="ogcfeatureserver"?n="features":t==="pro presentation"?n="propresentation":t==="pro project"?n="proproject":t==="insights workbook package"?n="insightsworkbookpackage":t==="apache parquet"?n="apacheparquet":t==="notebook code snippet library"?n="notebookcodesnippets":t==="suitability model"?n="suitabilitymodel":t==="esri classifier definition"?n="classifierdefinition":t==="esri classification schema"?n="classificationschema":t==="insights data engineering workbook"?n="dataengineeringworkbook":t==="insights data engineering model"?n="dataengineeringmodel":t==="deep learning studio project"?n="deeplearningproject":t==="discussion"?n="discussion":t==="allsource project"?n="allsourceproject":t==="api key"?n="apikey":t==="data pipeline"?n="datapipelines":t==="group layer"?(m=e.includes("Map"),n=m?"layergroup2d":"layergroup"):n=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":"maps",n?ut(i+n+r+".png"):null}get isLayer(){return this.type!=null&&oye.has(this.type)}get itemCdnUrl(){return NV(this.itemUrl)}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const t=this.itemUrl,e=this.thumbnail;return t&&e?((i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){var i,r,n;const t=(i=this.portal)==null?void 0:i.restUrl;if(!t)return null;const e=this.owner||((n=(r=this.portal)==null?void 0:r.user)==null?void 0:n.username);return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=ki.getDefault()),i=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof CL&&(t=t.rating),t==null||isNaN(t)||typeof t!="number"||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new CL({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:R(this.applicationProxies),avgRating:this.avgRating,categories:R(this.categories),classification:R(this.classification),created:R(this.created),culture:this.culture,description:this.description,extent:R(this.extent),groupCategories:R(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:R(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:R(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:R(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:R(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new Qm({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var e;const t=this.toJSON();for(const i of["tags","typeKeywords","categories"])t[i]=(e=t[i])==null?void 0:e.join(", ");for(const i of["extent","classification"]){const r=t[i];r&&(t[i]=JSON.stringify(r))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new CL(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},Qm)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t==null?void 0:t.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?i.query.text=e:typeof e=="object"&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new L("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new L("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await e.signIn();const{copyResources:r,folder:n,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof n=="string"?n:n==null?void 0:n.id,includeResources:!!r,tags:s==null?void 0:s.join(","),title:o}},{itemId:u}=await e.request(`${i}/copy`,a);return new Qm({id:u,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,i=t.filename,r={method:"post"};if(typeof e=="string")bp(e)?r.query={data:e}:r.query={url:ro(e)},i!=null&&(r.query.filename=i);else{const n=new FormData;i!=null?n.append("file",e,i):n.append("file",e),r.body=n}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new L("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await k(()=>import("./resourceUtils-DTdmibk4.js"),[]);return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResources:r}=await k(()=>import("./resourceUtils-DTdmibk4.js"),[]);return t.portalItem=this,await r(this,[{resource:t,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"add",i),t}async removeResource(t,e){const{removeResource:i}=await k(()=>import("./resourceUtils-DTdmibk4.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new L("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await k(()=>import("./resourceUtils-DTdmibk4.js"),[]);return e(this,t)}resourceFromPath(t){return new iye({portalItem:this,path:t})}toJSON(){var i,r;const t=this.extent,e={accessInformation:this.accessInformation,categories:R(this.categories),classification:R(this.classification),created:(i=this.created)==null?void 0:i.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(r=this.modified)==null?void 0:r.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:R(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:R(this.typeKeywords),url:this.url};return Rde(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Qm({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};l([c({type:["private","shared","org","public"]})],Ve.prototype,"access",void 0),l([c()],Ve.prototype,"accessInformation",void 0),l([c({type:String})],Ve.prototype,"apiKey",void 0),l([c({json:{read:{source:"appProxies"}}})],Ve.prototype,"applicationProxies",void 0),l([c()],Ve.prototype,"avgRating",void 0),l([c()],Ve.prototype,"categories",void 0),l([c()],Ve.prototype,"classification",void 0),l([c({type:Date})],Ve.prototype,"created",void 0),l([c()],Ve.prototype,"culture",void 0),l([c()],Ve.prototype,"description",void 0),l([c({readOnly:!0})],Ve.prototype,"displayName",null),l([c({type:at})],Ve.prototype,"extent",void 0),l([X("extent")],Ve.prototype,"readExtent",null),l([c()],Ve.prototype,"groupCategories",void 0),l([c({readOnly:!0})],Ve.prototype,"iconUrl",null),l([c()],Ve.prototype,"id",void 0),l([c({readOnly:!0})],Ve.prototype,"isLayer",null),l([c({type:Boolean,readOnly:!0})],Ve.prototype,"isOrgItem",void 0),l([c()],Ve.prototype,"itemControl",void 0),l([c({readOnly:!0})],Ve.prototype,"itemPageUrl",null),l([c({readOnly:!0})],Ve.prototype,"itemUrl",null),l([c()],Ve.prototype,"licenseInfo",void 0),l([c({type:Date})],Ve.prototype,"modified",void 0),l([c()],Ve.prototype,"name",void 0),l([c()],Ve.prototype,"numComments",void 0),l([c()],Ve.prototype,"numRatings",void 0),l([c()],Ve.prototype,"numViews",void 0),l([c()],Ve.prototype,"owner",void 0),l([c()],Ve.prototype,"ownerFolder",void 0),l([c({type:ki})],Ve.prototype,"portal",void 0),l([c()],Ve.prototype,"screenshots",void 0),l([c()],Ve.prototype,"size",void 0),l([c()],Ve.prototype,"snippet",void 0),l([c()],Ve.prototype,"sourceJSON",void 0),l([c({type:String})],Ve.prototype,"sourceUrl",void 0),l([c({type:String})],Ve.prototype,"spatialReference",void 0),l([c()],Ve.prototype,"tags",void 0),l([c()],Ve.prototype,"thumbnail",void 0),l([c({readOnly:!0})],Ve.prototype,"thumbnailUrl",null),l([c()],Ve.prototype,"title",void 0),l([c()],Ve.prototype,"type",void 0),l([c()],Ve.prototype,"typeKeywords",void 0),l([c({type:String,json:{read(t,e){var i;if(aye.has(e.type)){const r=(i=this.portal)==null?void 0:i.restUrl;t||(t=r&&this.id?`${r}/content/items/${this.id}/data`:null)}return t}}})],Ve.prototype,"url",void 0),l([c({readOnly:!0})],Ve.prototype,"userItemUrl",null),Ve=Qm=l([$("esri.portal.PortalItem")],Ve);const so=Ve,dY=Object.freeze(Object.defineProperty({__proto__:null,default:so},Symbol.toStringTag,{value:"Module"})),kG=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,lye={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function LG(t){return t in lye}const Ow=[],F0=new Map;function AG(t){for(const e of F0.keys())pY(t.pattern,e)&&F0.delete(e)}function uye(t){return Ow.includes(t)||(AG(t),Ow.unshift(t)),ye(()=>{const e=Ow.indexOf(t);e>-1&&(Ow.splice(e,1),AG(t))})}async function BC(t){const e=An();F0.has(t)||F0.set(t,dye(t,e));const i=F0.get(t);return i&&await pye.add(i),i}function cye(t){if(!kG.test(t))return null;const e=kG.exec(t);if(e===null)return null;const[,i,r]=e,n=i+(r?"-"+r.toUpperCase():"");return LG(n)?n:LG(i)?i:null}async function dye(t,e){const i=[];for(const r of Ow)if(pY(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(n){i.push(n)}throw i.length?new L("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new L("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function pY(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}RV(()=>{F0.clear()});const pye=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=fn())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function hye(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,i=await BC("esri/t9n/basemaps");return i[t]||i[e]}const Sb={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return ut("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return ut("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return ut("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return ut("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return ut("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return ut("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return ut("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return ut("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return ut("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return ut("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return ut("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return ut("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return ut("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return ut("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return ut("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return ut("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}},mye=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let Kc=class extends q{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const e=An().toLowerCase();switch(e){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const i=lY(e);return i==="pt"?"pt-BR":i&&mye.has(i)?i:"global"}};l([c()],Kc.prototype,"apiKey",void 0),l([c()],Kc.prototype,"id",void 0),l([c()],Kc.prototype,"language",void 0),l([c()],Kc.prototype,"places",void 0),l([c()],Kc.prototype,"serviceUrl",void 0),l([c()],Kc.prototype,"worldview",void 0),Kc=l([$("esri.support.BasemapStyle")],Kc);const fye=Kc;function hY(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function DV(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function ef(t){return(t==null?void 0:t.type)==="subtype-sublayer"}const CJe={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function $R(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function yye(t){return t==="integrated-mesh"||t==="integrated-mesh-3dtiles"}function HC(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function kJe(t){var i;const e=t==null?void 0:t.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&((i=t.source)==null?void 0:i.type)==="feature-layer"}async function VV(t,e){const i=Te==null?void 0:Te.findServerInfo(t);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const n=`${t.slice(0,r)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await Ee(n,{query:{f:"json"},responseType:"json",signal:s});return(o==null?void 0:o.owningSystemUrl)||null}function gye(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function wy(t){return t!=null&&typeof t=="object"&&"isTable"in t&&!!t.isTable}function Uy(t){return gye(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function vye(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function mY(t){return!!vye(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function fY(t){return t?("subtypes"in t?t.subtypes:DV(t.parent)?t.parent.subtypes:[])??[]:[]}const bye=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),_ye=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function wye(t){return t.layerContainerType==="basemap"?bye:t.layerContainerType==="operational-layers"?_ye:null}function Sye(t,e){if(e.restrictedWebMapWriting){const i=wye(e);return i==null||i.has(t.type)&&!HC(t)}return!0}function $ye(t,e){var i;if(e)if(HC(t)){const r=k$("featureCollection.layers",e),n=(i=r==null?void 0:r[0])==null?void 0:i.layerDefinition;n&&OG(t,n)}else t.type!=="group"&&OG(t,e)}function OG(t,e){"maxScale"in t&&(e.maxScale=HM(t.maxScale)??void 0),"minScale"in t&&(e.minScale=HM(t.minScale)??void 0)}function Eye(t,e){if($ye(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=HM(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(HC(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function ER(t,e,i){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return i!=null&&i.messages&&i.messages.push(new L("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(HC(t)&&!t.isTable)e=t.resourceInfo;else if(Sye(t,i)){const r={};return t.write(r,i)?r:null}return e!=null&&Eye(t,e=R(e)),e}var Rw;let Tye=0,$o=Rw=class extends ig(uo){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+Tye++,this.baseLayers=new Y,this.referenceLayers=new Y;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&U.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.addHandles([this.baseLayers.on("after-add",r=>e(r.item)),this.referenceLayers.on("after-add",r=>e(r.item)),this.baseLayers.on("after-remove",r=>i(r.item)),this.referenceLayers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{U.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const i of t)i.destroy();const e=this.referenceLayers.toArray();for(const i of e)i.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=xe(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",up(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const r=[];t&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{const s=ER(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);s!=null&&r.push(s)}),this.referenceLayers.forEach(n=>{const s=ER(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);s!=null&&(n.type!=="scene"&&(s.isReference=!0),r.push(s))})),e.baseMapLayers=r}set referenceLayers(t){this._set("referenceLayers",up(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return PC(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>AM(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>AM(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new Rw({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){var i;return t=t||{},e!=null&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&((i=this.resourceInfo)!=null&&i.data.baseMapLayers)&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const n=R(r);return n.url&&Sc(n.url)&&(n.url=`https:${n.url}`),n.templateUrl&&Sc(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`),n})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i,style:r}=this;qe(t);const n=[];if(e){const s=e.context?e.context.url:null;if(n.push(this._loadLayersFromJSON(e.data,s,t)),e.data.id&&!e.data.title){const o=e.data.id;n.push(hye(o).then(a=>{a&&this.read({title:a},e.context)}))}}else i?n.push(this._loadFromItem(i,t)):r&&n.push(this._loadFromStylesService(r,t));await Promise.all(n)}async _loadLayersFromJSON(t,e,i){var u,d;const r=(u=this.resourceInfo)==null?void 0:u.context,n=((d=this.portalItem)==null?void 0:d.portal)||(r==null?void 0:r.portal)||null,s=xye[(r==null?void 0:r.origin)||""]??"web-map",{populateOperationalLayers:o}=await k(async()=>{const{populateOperationalLayers:p}=await import("./layersCreator-BBOzKftP.js");return{populateOperationalLayers:p}},__vite__mapDeps([7,8,9,10])),a=[];if(qe(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const p={context:{...r,origin:s,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},h=g=>s==="web-scene"&&g.layerType==="ArcGISSceneServiceLayer"||g.isReference,m=o(this.baseLayers,t.baseMapLayers.filter(g=>!h(g)),p);a.push(m);const y=o(this.referenceLayers,t.baseMapLayers.filter(h),p);a.push(y)}await Promise.allSettled(a)}async _loadFromItem(t,e){const i=await t.load(e),r=await i.fetchData("json",e),n=nr(t.itemUrl??"");return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:Iye[t.type||""]??"web-map",portal:t.portal||ki.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||ki.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}async _loadFromStylesService(t,e){const i=`${t.serviceUrl}/${t.id}`,r=(await Ee(i,{query:{language:t.getLanguageParamValue(),places:t.places,worldview:t.worldview,token:t.apiKey},signal:e==null?void 0:e.signal})).data,n=nr(i);if(this._set("resourceInfo",{data:r.baseMap??{},context:{origin:"web-map",url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,n,e),t.apiKey)for(const s of[...this.baseLayers,...this.referenceLayers])"apiKey"in s&&(s.apiKey=t.apiKey)}static fromId(t){const e=Sb[t];return e?e.itemId?new Rw({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):Rw.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};l([c({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Y}},writer(t,e,i,r){this._writeBaseLayers(t,e,r)}}}}}})],$o.prototype,"baseLayers",null),l([c({type:String,json:{origins:{"web-scene":{write:!0}}}})],$o.prototype,"id",void 0),l([c({type:so})],$o.prototype,"portalItem",void 0),l([c()],$o.prototype,"referenceLayers",null),l([c({readOnly:!0})],$o.prototype,"resourceInfo",void 0),l([c({type:le})],$o.prototype,"spatialReference",void 0),l([c({type:fye})],$o.prototype,"style",void 0),l([c()],$o.prototype,"thumbnailUrl",void 0),l([c({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],$o.prototype,"title",void 0),l([te("title")],$o.prototype,"writeTitle",null),$o=Rw=l([$("esri.Basemap")],$o);const Iye={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},xye={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},sS=$o,Mye=Object.freeze(Object.defineProperty({__proto__:null,default:sS},Symbol.toStringTag,{value:"Module"})),o2={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function yY(t){return!!o2[t]||!!o2[t.toLowerCase()]}function UV(t){return o2[t]??o2[t.toLowerCase()]}function Cye(t){return[...UV(t)]}function kL(t,e,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?t+(e-t)*r:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function gY(t,e,i,r=1){const n=(t%360+360)%360/360,s=i<=.5?i*(e+1):i+e-i*e,o=2*i-s;return[Math.round(255*kL(o,s,n+1/3)),Math.round(255*kL(o,s,n)),Math.round(255*kL(o,s,n-1/3)),r]}function kye(t){const e=t.length>5,i=e?8:4,r=(1<<i)-1,n=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let u;return s&&(u=o&r,o>>=i,a[3]=n*u/255),u=o&r,o>>=i,a[2]=n*u,u=o&r,o>>=i,a[1]=n*u,u=o&r,o>>=i,a[0]=n*u,a}const RG=new Float32Array(1);function LJe(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function fr(t,e,i){return Math.min(Math.max(t,e),i)}function AJe(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Wh(t,e,i){return t+(e-t)*i}function OJe(t,e,i,r,n){return Wh(r,n,(t-e)/(i-e))}function G$(t){return t*Math.PI/180}function vY(t){return 180*t/Math.PI}function RJe(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function qC(t){return Math.acos(fr(t,-1,1))}function jV(t){return Math.asin(fr(t,-1,1))}function N0(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}const a2=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function TR(t){return a2.setFloat64(0,t),a2.getBigInt64(0)}function Lye(t){return a2.setBigInt64(0,t),a2.getFloat64(0)}const qI=BigInt("1000000"),Aye=bY(1);function bY(t){const e=TR(t=Math.abs(t)),i=Lye(e<=qI?qI:e-qI);return Math.abs(t-i)}function Oye(t,e,i=Aye){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(i!=null&&bY(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i;const r=TR(t),n=TR(e);return r<0!=n<0?!1:!((r<n?n-r:r-n)>qI)}function PJe(t){return _Y(Math.max(-PG,Math.min(t,PG)))}function _Y(t){return RG[0]=t,RG[0]}function FJe(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(N0(e,1)&&N0(i,1)&&N0(r,1))}function NJe(t,e){return(t%e+e)%e}const PG=_Y(34028234663852886e22);function DJe(t,e,i){if(i===void 0||+i==0)return Math[t](e);if(e=+e,i=+i,isNaN(e)||typeof i!="number"||i%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-i:-i)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+i:i))}function iT(t){return fr(LC(t),0,255)}function rT(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}function nT(t,e){const i=t.toString(16).padStart(2,"0");return e?i.slice(0,1):i}let WI=class Vr{static blendColors(e,i,r,n=new Vr){return n.r=Math.round(e.r+(i.r-e.r)*r),n.g=Math.round(e.g+(i.g-e.g)*r),n.b=Math.round(e.b+(i.b-e.b)*r),n.a=e.a+(i.a-e.a)*r,n._sanitize()}static fromRgb(e,i){const r=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(r){const n=r[2].split(/\s*,\s*/),s=r[1];if(s==="rgb"&&n.length===3||s==="rgba"&&n.length===4){const o=n[0];if(o.charAt(o.length-1)==="%"){const a=n.map(u=>2.56*parseFloat(u));return n.length===4&&(a[3]=parseFloat(n[3])),Vr.fromArray(a,i)}return Vr.fromArray(n.map(a=>parseFloat(a)),i)}if(s==="hsl"&&n.length===3||s==="hsla"&&n.length===4)return Vr.fromArray(gY(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),i)}return null}static fromHex(e,i=new Vr){if(e[0]!=="#"||isNaN(+`0x${e.slice(1)}`))return null;switch(e.length){case 4:case 5:{const r=parseInt(e.slice(1,2),16),n=parseInt(e.slice(2,3),16),s=parseInt(e.slice(3,4),16),o=e.length===5?15:parseInt(e.slice(4),16);return Vr.fromArray([r+16*r,n+16*n,s+16*s,(o+16*o)/255],i)}case 7:case 9:{const r=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16),o=e.length===7?255:parseInt(e.slice(7),16);return Vr.fromArray([r,n,s,o/255],i)}default:return null}}static fromArray(e,i=new Vr){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const r=yY(e)?UV(e):null;return r&&Vr.fromArray(r,i)||Vr.fromRgb(e,i)||Vr.fromHex(e,i)}static fromJSON(e){return e!=null?new Vr([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Vr.fromString(e,this):Array.isArray(e)?Vr.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Vr||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const i=(e==null?void 0:e.capitalize)??!1,r=(e==null?void 0:e.digits)??6,n=r===3||r===4,s=r===4||r===8,o=`#${nT(this.r,n)}${nT(this.g,n)}${nT(this.b,n)}${s?nT(Math.round(255*this.a),n):""}`;return i?o.toUpperCase():o}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=Vr.AlphaMode.ALWAYS){const i=iT(this.r),r=iT(this.g),n=iT(this.b);return e===Vr.AlphaMode.ALWAYS||this.a!==1?[i,r,n,iT(255*this.a)]:[i,r,n]}clone(){return new Vr(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(rT(this.r,0,255)),this.g=Math.round(rT(this.g,0,255)),this.b=Math.round(rT(this.b,0,255)),this.a=rT(this.a,0,1),this}_set(e,i,r,n){this.r=e,this.g=i,this.b=r,this.a=n}};WI.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(WI||(WI={}));const ee=WI;function VJe(t){}function Rye(t){return()=>t}function oe(t,e={}){const i=t instanceof $e?t:new $e(t,e),{alwaysWriteDefaults:r,default:n,ignoreUnknown:s=!0,name:o,nonNullable:a,readOnly:u=!1}=e;return c({type:s?i.apiValues:String,json:{type:i.jsonValues,default:n,name:o,read:!u&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:u})}var IR;let ZI=IR=class extends j{constructor(t){super(t),this.type="none"}clone(){return new IR({type:this.type})}};l([oe({none:"none",stayAbove:"stay-above"})],ZI.prototype,"type",void 0),ZI=IR=l([$("esri.ground.NavigationConstraint")],ZI);function WC(t){const e=LC(100*(1-t));return Math.max(0,Math.min(e,100))}function WS(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var xR;let Xc=xR=class extends ig(uo){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Y;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&U.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{rr(t)||U.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)xe(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",up(t,this._get("layers")))}writeLayers(t,e,i,r){const n=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};Rye(s)().write(o,r)&&n.push(o)}else r!=null&&r.messages&&r.messages.push(new L("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return PC(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await k(()=>Promise.resolve().then(()=>EW),void 0);qe(e);const r=new i,n=this.layers.filter(FG).toArray();return r.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await k(()=>Promise.resolve().then(()=>EW),void 0);qe(e);const r=new i,n=this.layers.filter(FG).toArray();return r.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:R(this.surfaceColor),navigationConstraint:R(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new xR({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const r=(e==null?void 0:e.origin)||"web-scene",n=(e==null?void 0:e.portal)||null,s=(e==null?void 0:e.url)||null,{populateOperationalLayers:o}=await k(async()=>{const{populateOperationalLayers:u}=await import("./layersCreator-BBOzKftP.js");return{populateOperationalLayers:u}},__vite__mapDeps([7,8,9,10]));qe(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const u={context:{origin:r,url:s,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,u))}await Promise.allSettled(a)}};function Pye(t){return t&&"createElevationSampler"in t}function FG(t){return t.type==="elevation"||Pye(t)}l([c({json:{read:!1}})],Xc.prototype,"layers",null),l([te("layers")],Xc.prototype,"writeLayers",null),l([c({readOnly:!0})],Xc.prototype,"resourceInfo",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Xe,read:{reader:WS,source:"transparency"},write:{writer:(t,e)=>{e.transparency=WC(t)},target:"transparency"}}})],Xc.prototype,"opacity",void 0),l([c({type:ee,json:{type:[Xe],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Xc.prototype,"surfaceColor",void 0),l([c({type:ZI,json:{write:!0}})],Xc.prototype,"navigationConstraint",void 0),Xc=xR=l([$("esri.Ground")],Xc);const ZS=Xc;function N(t,e,i={}){return GV(t,e,i,wY)}function Hi(t,e,i={}){return GV(t,e,i,SY)}function GV(t,e,i={},r){let n=null;const s=i.once?(o,a)=>{r(o)&&(Kt(n),e(o,a))}:(o,a)=>{r(o)&&e(o,a)};if(n=Kpe(t,s,i.sync,i.equals),i.initial){const o=t();s(o,o)}return n}function St(t,e,i,r={}){let n=null,s=null,o=null;function a(){var p;n&&s&&(s.remove(),(p=r.onListenerRemove)==null||p.call(r,n),n=null,s=null)}function u(p){r.once&&r.once&&Kt(o),i(p)}const d=N(t,(p,h)=>{var m;a(),CC(p)&&(n=p,s=O$(p,e,u),(m=r.onListenerAdd)==null||m.call(r,p))},{sync:r.sync,initial:!0});return o=ye(()=>{d.remove(),a()}),o}function wi(t,e){return Fye(t,SY,e)}function Fye(t,e,i){if(lo(i))return Promise.reject(mt());const r=t();if(e!=null&&e(r))return Promise.resolve(r);let n=null;function s(){n=Kt(n)}return new Promise((o,a)=>{n=kr([ks(i,()=>{s(),a(mt())}),GV(t,u=>{s(),o(u)},{sync:!1,once:!0},e??wY)])})}function wY(t){return!0}function SY(t){return!!t}function Nye(t,e,i={}){let r=!1;const n=N(t,(s,o)=>{r||e(s,o)},i);return{remove(){n.remove()},pause(){r=!0},resume(){r=!1}}}function Dye(t,e){const i=new Y,r=St(t,"after-splice",({added:n,start:s,deleteCount:o})=>{const a=i.splice(s,o);for(const u of a)u.remove();if(n!=null&&n.length){const u=n.map(e);i.addMany(u,s)}},{sync:!0,onListenerRemove:()=>i.drain(n=>n.remove()),onListenerAdd:n=>i.addMany(n.items.map(e))});return i.addHandles(r),i}function UJe(t,e){const i=new Y,r=Dye(t,a=>Xo(async u=>{const d=await e(a,u);if(lo(u))throw d.remove(),mt();return d})),n=()=>null,s=async a=>{const u=await a.promise,d=r.indexOf(a);d<0||i.splice(d,1,u)};i.addMany(r.items.map(n));for(const a of r)zo(s(a));const o=r.on("after-splice",({added:a,start:u,deleteCount:d})=>{const p=i.splice(u,d);for(const h of p)h==null||h.remove();if(a!=null&&a.length){i.addMany(a.map(n),u);for(const h of a)zo(s(h))}});return i.addHandles([Yde(r),o]),i}const yn={sync:!0},be={initial:!0},gt={sync:!0,initial:!0};let nv=class extends Y{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(BZ(()=>this._refresh(),yn))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let i=0;for(const r of e)r!=null&&(i=this._processCollection(i,r));this.splice(i,this.length)}_createNewInstance(e){return new Y(e)}_processCollection(e,i){if(!i)return e;const r=this.itemFilterFunction??(n=>!!n);for(const n of i)if(n){if(r(n)){const s=this.indexOf(n,e);s>=0?s!==e&&this.reorder(n,e):this.add(n,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(n);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};l([c()],nv.prototype,"getCollections",void 0),l([c()],nv.prototype,"getChildrenFunction",void 0),l([c()],nv.prototype,"itemFilterFunction",void 0),nv=l([$("esri.core.CollectionFlattener")],nv);const JS=nv,sT=new WeakMap;function zV(t){return!t.destroyed&&(sT.has(t)||t.addHandles([N(()=>{const e=t.parent;return!(!e||!("type"in e))&&(e.type==="catalog-dynamic-group"||zV(e))},e=>sT.set(t,e),gt),ye(()=>sT.delete(t))]),sT.get(t))}function Vye(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function YS(t){var e,i;return!(!Vye(t)||!((i=(e=Uy(t))==null?void 0:e.operations)!=null&&i.supportsEditing)||"editingEnabled"in t&&!mY(t)||zV(t))}const Uye=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,jye="screenUtils.toPt: input not recognized!",$Y=96;function si(t){return t?t/72*$Y:0}function Jr(t){return t?72*t/$Y:0}function dt(t){if(typeof t=="string"){const e=t.match(Uye);if(e){const i=Number(e[1]),r=e[3]&&e[3].toLowerCase(),n=t.charAt(0)==="-",s=r==="px"?Jr(i):i;return n?-s:s}return console.warn(jye),null}return t}function Mi(t=0,e=0){return{x:t,y:e}}function GJe(t){return t?Mi(t.x,t.y):null}function Gye(t=0,e=0){return[t,e]}function zJe(t=0,e=0,i=0){return[t,e,i]}function BJe(t){return t}function HJe(t){return t}function qJe(t){return t}function WJe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function ZC(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function zye(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Bye(t,e,i,r,n,s,o,a,u,d,p,h,m,y,g,v){const _=new Float32Array(16);return _[0]=t,_[1]=e,_[2]=i,_[3]=r,_[4]=n,_[5]=s,_[6]=o,_[7]=a,_[8]=u,_[9]=d,_[10]=p,_[11]=h,_[12]=m,_[13]=y,_[14]=g,_[15]=v,_}function Hye(t,e){return new Float32Array(t,e,16)}const qye=ZC();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:qye,clone:zye,create:ZC,createView:Hye,fromValues:Bye},Symbol.toStringTag,{value:"Module"}));function W(){return[0,0,0]}function Yr(t){return[t[0],t[1],t[2]]}function Lr(t,e,i){return[t,e,i]}function EY(t,e,i){return[t,e,i]}function Wye(t,e=W()){const i=Math.min(3,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function Zye(t,e){return new Float64Array(t,e,3)}function TY(){return W()}function IY(){return Lr(1,1,1)}function xY(){return Lr(1,0,0)}function MY(){return Lr(0,1,0)}function CY(){return Lr(0,0,1)}const kY=TY(),LY=IY(),Jye=xY(),Yye=MY(),KS=CY();Object.freeze(Object.defineProperty({__proto__:null,ONES:LY,UNIT_X:Jye,UNIT_Y:Yye,UNIT_Z:KS,ZEROS:kY,clone:Yr,create:W,createView:Zye,freeze:EY,fromArray:Wye,fromValues:Lr,ones:IY,unitX:xY,unitY:MY,unitZ:CY,zeros:TY},Symbol.toStringTag,{value:"Module"}));let BV=1e-6;function qi(){return BV}function Kye(t){BV=t}const z$=Math.random,Xye=Math.PI/180,Qye=180/Math.PI;function HV(t){return t*Xye}function ege(t){return t*Qye}function tge(t,e){return Math.abs(t-e)<=BV*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:z$,equals:tge,getEpsilon:qi,setEpsilon:Kye,toDegree:ege,toRadian:HV},Symbol.toStringTag,{value:"Module"}));function $b(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Em(t,e,i,r,n,s,o,a,u,d,p,h,m,y,g,v,_){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t[6]=a,t[7]=u,t[8]=d,t[9]=p,t[10]=h,t[11]=m,t[12]=y,t[13]=g,t[14]=v,t[15]=_,t}function B$(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tl(t,e){if(t===e){const i=e[1],r=e[2],n=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=n,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ige(t,e){return JC(t,e)||B$(t),t}function JC(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],d=e[7],p=e[8],h=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],w=e[15],S=i*a-r*o,E=i*u-n*o,T=i*d-s*o,M=r*u-n*a,x=r*d-s*a,C=n*d-s*u,O=p*v-h*g,F=p*_-m*g,V=p*w-y*g,z=h*_-m*v,H=h*w-y*v,Q=m*w-y*_;let J=S*Q-E*H+T*z+M*V-x*F+C*O;return J?(J=1/J,t[0]=(a*Q-u*H+d*z)*J,t[1]=(n*H-r*Q-s*z)*J,t[2]=(v*C-_*x+w*M)*J,t[3]=(m*x-h*C-y*M)*J,t[4]=(u*V-o*Q-d*F)*J,t[5]=(i*Q-n*V+s*F)*J,t[6]=(_*T-g*C-w*E)*J,t[7]=(p*C-m*T+y*E)*J,t[8]=(o*H-a*V+d*O)*J,t[9]=(r*V-i*H-s*O)*J,t[10]=(g*x-v*T+w*S)*J,t[11]=(h*T-p*x-y*S)*J,t[12]=(a*F-o*z-u*O)*J,t[13]=(i*z-r*F+n*O)*J,t[14]=(v*E-g*M-_*S)*J,t[15]=(p*M-h*E+m*S)*J,t):null}function rge(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],d=e[7],p=e[8],h=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],w=e[15];return t[0]=a*(m*w-y*_)-h*(u*w-d*_)+v*(u*y-d*m),t[1]=-(r*(m*w-y*_)-h*(n*w-s*_)+v*(n*y-s*m)),t[2]=r*(u*w-d*_)-a*(n*w-s*_)+v*(n*d-s*u),t[3]=-(r*(u*y-d*m)-a*(n*y-s*m)+h*(n*d-s*u)),t[4]=-(o*(m*w-y*_)-p*(u*w-d*_)+g*(u*y-d*m)),t[5]=i*(m*w-y*_)-p*(n*w-s*_)+g*(n*y-s*m),t[6]=-(i*(u*w-d*_)-o*(n*w-s*_)+g*(n*d-s*u)),t[7]=i*(u*y-d*m)-o*(n*y-s*m)+p*(n*d-s*u),t[8]=o*(h*w-y*v)-p*(a*w-d*v)+g*(a*y-d*h),t[9]=-(i*(h*w-y*v)-p*(r*w-s*v)+g*(r*y-s*h)),t[10]=i*(a*w-d*v)-o*(r*w-s*v)+g*(r*d-s*a),t[11]=-(i*(a*y-d*h)-o*(r*y-s*h)+p*(r*d-s*a)),t[12]=-(o*(h*_-m*v)-p*(a*_-u*v)+g*(a*m-u*h)),t[13]=i*(h*_-m*v)-p*(r*_-n*v)+g*(r*m-n*h),t[14]=-(i*(a*_-u*v)-o*(r*_-n*v)+g*(r*u-n*a)),t[15]=i*(a*m-u*h)-o*(r*m-n*h)+p*(r*u-n*a),t}function nge(t){const e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],u=t[7],d=t[8],p=t[9],h=t[10],m=t[11],y=t[12],g=t[13],v=t[14],_=t[15];return(e*o-i*s)*(h*_-m*v)-(e*a-r*s)*(p*_-m*g)+(e*u-n*s)*(p*v-h*g)+(i*a-r*o)*(d*_-m*y)-(i*u-n*o)*(d*v-h*y)+(r*u-n*a)*(d*g-p*y)}function qV(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=e[6],p=e[7],h=e[8],m=e[9],y=e[10],g=e[11],v=e[12],_=e[13],w=e[14],S=e[15];let E=i[0],T=i[1],M=i[2],x=i[3];return t[0]=E*r+T*a+M*h+x*v,t[1]=E*n+T*u+M*m+x*_,t[2]=E*s+T*d+M*y+x*w,t[3]=E*o+T*p+M*g+x*S,E=i[4],T=i[5],M=i[6],x=i[7],t[4]=E*r+T*a+M*h+x*v,t[5]=E*n+T*u+M*m+x*_,t[6]=E*s+T*d+M*y+x*w,t[7]=E*o+T*p+M*g+x*S,E=i[8],T=i[9],M=i[10],x=i[11],t[8]=E*r+T*a+M*h+x*v,t[9]=E*n+T*u+M*m+x*_,t[10]=E*s+T*d+M*y+x*w,t[11]=E*o+T*p+M*g+x*S,E=i[12],T=i[13],M=i[14],x=i[15],t[12]=E*r+T*a+M*h+x*v,t[13]=E*n+T*u+M*m+x*_,t[14]=E*s+T*d+M*y+x*w,t[15]=E*o+T*p+M*g+x*S,t}function sge(t,e,i){const r=i[0],n=i[1],s=i[2];if(e===t)t[12]=e[0]*r+e[4]*n+e[8]*s+e[12],t[13]=e[1]*r+e[5]*n+e[9]*s+e[13],t[14]=e[2]*r+e[6]*n+e[10]*s+e[14],t[15]=e[3]*r+e[7]*n+e[11]*s+e[15];else{const o=e[0],a=e[1],u=e[2],d=e[3],p=e[4],h=e[5],m=e[6],y=e[7],g=e[8],v=e[9],_=e[10],w=e[11];t[0]=o,t[1]=a,t[2]=u,t[3]=d,t[4]=p,t[5]=h,t[6]=m,t[7]=y,t[8]=g,t[9]=v,t[10]=_,t[11]=w,t[12]=o*r+p*n+g*s+e[12],t[13]=a*r+h*n+v*s+e[13],t[14]=u*r+m*n+_*s+e[14],t[15]=d*r+y*n+w*s+e[15]}return t}function oge(t,e,i){const r=i[0],n=i[1],s=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function age(t,e,i,r){let n=r[0],s=r[1],o=r[2],a=Math.sqrt(n*n+s*s+o*o);if(a<=qi())return void $b(t,e);a=1/a,n*=a,s*=a,o*=a;const u=Math.sin(i),d=Math.cos(i),p=1-d,h=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],w=e[6],S=e[7],E=e[8],T=e[9],M=e[10],x=e[11],C=n*n*p+d,O=s*n*p+o*u,F=o*n*p-s*u,V=n*s*p-o*u,z=s*s*p+d,H=o*s*p+n*u,Q=n*o*p+s*u,J=s*o*p-n*u,ne=o*o*p+d;t[0]=h*C+v*O+E*F,t[1]=m*C+_*O+T*F,t[2]=y*C+w*O+M*F,t[3]=g*C+S*O+x*F,t[4]=h*V+v*z+E*H,t[5]=m*V+_*z+T*H,t[6]=y*V+w*z+M*H,t[7]=g*V+S*z+x*H,t[8]=h*Q+v*J+E*ne,t[9]=m*Q+_*J+T*ne,t[10]=y*Q+w*J+M*ne,t[11]=g*Q+S*J+x*ne,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function lge(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[4],o=e[5],a=e[6],u=e[7],d=e[8],p=e[9],h=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+d*r,t[5]=o*n+p*r,t[6]=a*n+h*r,t[7]=u*n+m*r,t[8]=d*n-s*r,t[9]=p*n-o*r,t[10]=h*n-a*r,t[11]=m*n-u*r,t}function uge(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[0],o=e[1],a=e[2],u=e[3],d=e[8],p=e[9],h=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-d*r,t[1]=o*n-p*r,t[2]=a*n-h*r,t[3]=u*n-m*r,t[8]=s*r+d*n,t[9]=o*r+p*n,t[10]=a*r+h*n,t[11]=u*r+m*n,t}function cge(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[0],o=e[1],a=e[2],u=e[3],d=e[4],p=e[5],h=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n+d*r,t[1]=o*n+p*r,t[2]=a*n+h*r,t[3]=u*n+m*r,t[4]=d*n-s*r,t[5]=p*n-o*r,t[6]=h*n-a*r,t[7]=m*n-u*r,t}function AY(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function dge(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function WV(t,e,i){if(e===0)return B$(t);let r=i[0],n=i[1],s=i[2],o=Math.sqrt(r*r+n*n+s*s);if(o<=qi())return null;o=1/o,r*=o,n*=o,s*=o;const a=Math.sin(e),u=Math.cos(e),d=1-u;return t[0]=r*r*d+u,t[1]=n*r*d+s*a,t[2]=s*r*d-n*a,t[3]=0,t[4]=r*n*d-s*a,t[5]=n*n*d+u,t[6]=s*n*d+r*a,t[7]=0,t[8]=r*s*d+n*a,t[9]=n*s*d-r*a,t[10]=s*s*d+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pge(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hge(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mge(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function OY(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=r+r,u=n+n,d=s+s,p=r*a,h=r*u,m=r*d,y=n*u,g=n*d,v=s*d,_=o*a,w=o*u,S=o*d;return t[0]=1-(y+v),t[1]=h+S,t[2]=m-w,t[3]=0,t[4]=h-S,t[5]=1-(p+v),t[6]=g+_,t[7]=0,t[8]=m+w,t[9]=g-_,t[10]=1-(p+y),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function fge(t,e){const i=yge,r=-e[0],n=-e[1],s=-e[2],o=e[3],a=e[4],u=e[5],d=e[6],p=e[7],h=r*r+n*n+s*s+o*o;return h>0?(i[0]=2*(a*o+p*r+u*s-d*n)/h,i[1]=2*(u*o+p*n+d*r-a*s)/h,i[2]=2*(d*o+p*s+a*n-u*r)/h):(i[0]=2*(a*o+p*r+u*s-d*n),i[1]=2*(u*o+p*n+d*r-a*s),i[2]=2*(d*o+p*s+a*n-u*r)),OY(t,e,i),t}const yge=W();function gge(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function vge(t,e){const i=e[0],r=e[1],n=e[2],s=e[4],o=e[5],a=e[6],u=e[8],d=e[9],p=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(u*u+d*d+p*p),t}function bge(t,e){const i=e[0]+e[5]+e[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function _ge(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3],u=n+n,d=s+s,p=o+o,h=n*u,m=n*d,y=n*p,g=s*d,v=s*p,_=o*p,w=a*u,S=a*d,E=a*p,T=r[0],M=r[1],x=r[2];return t[0]=(1-(g+_))*T,t[1]=(m+E)*T,t[2]=(y-S)*T,t[3]=0,t[4]=(m-E)*M,t[5]=(1-(h+_))*M,t[6]=(v+w)*M,t[7]=0,t[8]=(y+S)*x,t[9]=(v-w)*x,t[10]=(1-(h+g))*x,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function wge(t,e,i,r,n){const s=e[0],o=e[1],a=e[2],u=e[3],d=s+s,p=o+o,h=a+a,m=s*d,y=s*p,g=s*h,v=o*p,_=o*h,w=a*h,S=u*d,E=u*p,T=u*h,M=r[0],x=r[1],C=r[2],O=n[0],F=n[1],V=n[2],z=(1-(v+w))*M,H=(y+T)*M,Q=(g-E)*M,J=(y-T)*x,ne=(1-(m+w))*x,Pe=(_+S)*x,_e=(g+E)*C,ue=(_-S)*C,it=(1-(m+v))*C;return t[0]=z,t[1]=H,t[2]=Q,t[3]=0,t[4]=J,t[5]=ne,t[6]=Pe,t[7]=0,t[8]=_e,t[9]=ue,t[10]=it,t[11]=0,t[12]=i[0]+O-(z*O+J*F+_e*V),t[13]=i[1]+F-(H*O+ne*F+ue*V),t[14]=i[2]+V-(Q*O+Pe*F+it*V),t[15]=1,t}function Sge(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i+i,a=r+r,u=n+n,d=i*o,p=r*o,h=r*a,m=n*o,y=n*a,g=n*u,v=s*o,_=s*a,w=s*u;return t[0]=1-h-g,t[1]=p+w,t[2]=m-_,t[3]=0,t[4]=p-w,t[5]=1-d-g,t[6]=y+v,t[7]=0,t[8]=m+_,t[9]=y-v,t[10]=1-d-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $ge(t,e,i,r,n,s,o){const a=1/(i-e),u=1/(n-r),d=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+r)*u,t[10]=(o+s)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*d,t[15]=0,t}function Ege(t,e,i,r,n){const s=1/Math.tan(e/2);let o;return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(r-n),t[10]=(n+r)*o,t[14]=2*n*r*o):(t[10]=-1,t[14]=-2*r),t}function Tge(t,e,i,r){const n=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+a),d=2/(n+s);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-(o-a)*u*.5,t[9]=(n-s)*d*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t}function Ige(t,e,i,r,n,s,o){const a=1/(e-i),u=1/(r-n),d=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+i)*a,t[13]=(n+r)*u,t[14]=(o+s)*d,t[15]=1,t}function xge(t,e,i,r){const n=e[0],s=e[1],o=e[2];let a=n-i[0],u=s-i[1],d=o-i[2];const p=qi();if(Math.abs(a)<p&&Math.abs(u)<p&&Math.abs(d)<p)return void B$(t);let h=1/Math.sqrt(a*a+u*u+d*d);a*=h,u*=h,d*=h;const m=r[0],y=r[1],g=r[2];let v=y*d-g*u,_=g*a-m*d,w=m*u-y*a;h=Math.sqrt(v*v+_*_+w*w),h?(h=1/h,v*=h,_*=h,w*=h):(v=0,_=0,w=0);let S=u*w-d*_,E=d*v-a*w,T=a*_-u*v;h=Math.sqrt(S*S+E*E+T*T),h?(h=1/h,S*=h,E*=h,T*=h):(S=0,E=0,T=0),t[0]=v,t[1]=S,t[2]=a,t[3]=0,t[4]=_,t[5]=E,t[6]=u,t[7]=0,t[8]=w,t[9]=T,t[10]=d,t[11]=0,t[12]=-(v*n+_*s+w*o),t[13]=-(S*n+E*s+T*o),t[14]=-(a*n+u*s+d*o),t[15]=1}function Mge(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=r[0],u=r[1],d=r[2];let p=n-i[0],h=s-i[1],m=o-i[2],y=p*p+h*h+m*m;y>0&&(y=1/Math.sqrt(y),p*=y,h*=y,m*=y);let g=u*m-d*h,v=d*p-a*m,_=a*h-u*p;return y=g*g+v*v+_*_,y>0&&(y=1/Math.sqrt(y),g*=y,v*=y,_*=y),t[0]=g,t[1]=v,t[2]=_,t[3]=0,t[4]=h*_-m*v,t[5]=m*g-p*_,t[6]=p*v-h*g,t[7]=0,t[8]=p,t[9]=h,t[10]=m,t[11]=0,t[12]=n,t[13]=s,t[14]=o,t[15]=1,t}function Cge(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function kge(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function Lge(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function RY(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function Age(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function Oge(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t}function Rge(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Pge(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],d=t[7],p=t[8],h=t[9],m=t[10],y=t[11],g=t[12],v=t[13],_=t[14],w=t[15],S=e[0],E=e[1],T=e[2],M=e[3],x=e[4],C=e[5],O=e[6],F=e[7],V=e[8],z=e[9],H=e[10],Q=e[11],J=e[12],ne=e[13],Pe=e[14],_e=e[15],ue=qi();return Math.abs(i-S)<=ue*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(r-E)<=ue*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(n-T)<=ue*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(s-M)<=ue*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(o-x)<=ue*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-C)<=ue*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(u-O)<=ue*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(d-F)<=ue*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(p-V)<=ue*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(h-z)<=ue*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(m-H)<=ue*Math.max(1,Math.abs(m),Math.abs(H))&&Math.abs(y-Q)<=ue*Math.max(1,Math.abs(y),Math.abs(Q))&&Math.abs(g-J)<=ue*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(v-ne)<=ue*Math.max(1,Math.abs(v),Math.abs(ne))&&Math.abs(_-Pe)<=ue*Math.max(1,Math.abs(_),Math.abs(Pe))&&Math.abs(w-_e)<=ue*Math.max(1,Math.abs(w),Math.abs(_e))}function Fge(t){const e=qi(),i=t[0],r=t[1],n=t[2],s=t[4],o=t[5],a=t[6],u=t[8],d=t[9],p=t[10];return Math.abs(1-(i*i+s*s+u*u))<=e&&Math.abs(1-(r*r+o*o+d*d))<=e&&Math.abs(1-(n*n+a*a+p*p))<=e}function Nge(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const Dge=qV,Vge=RY;Object.freeze(Object.defineProperty({__proto__:null,add:Lge,adjoint:rge,copy:$b,determinant:nge,equals:Pge,exactEquals:Rge,frob:kge,fromQuat:Sge,fromQuat2:fge,fromRotation:WV,fromRotationTranslation:OY,fromRotationTranslationScale:_ge,fromRotationTranslationScaleOrigin:wge,fromScaling:dge,fromTranslation:AY,fromXRotation:pge,fromYRotation:hge,fromZRotation:mge,frustum:$ge,getRotation:bge,getScaling:vge,getTranslation:gge,hasIdentityRotation:Nge,identity:B$,invert:JC,invertOrIdentity:ige,isOrthoNormal:Fge,lookAt:xge,mul:Dge,multiply:qV,multiplyScalar:Age,multiplyScalarAndAdd:Oge,ortho:Ige,perspective:Ege,perspectiveFromFieldOfView:Tge,rotate:age,rotateX:lge,rotateY:uge,rotateZ:cge,scale:oge,set:Em,str:Cge,sub:Vge,subtract:RY,targetTo:Mge,translate:sge,transpose:tl},Symbol.toStringTag,{value:"Module"}));const Uge=(t,e)=>{const i=Em(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return tl(i,i)},jge=(t,e)=>{const i=Em(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return tl(i,i)},Gge=(t,e)=>{const i=1-e,r=Em(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return tl(r,r)},zge=(t,e)=>{const i=Math.sin(e*Math.PI/180),r=Math.cos(e*Math.PI/180),n=Em(t,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return tl(n,n)},Bge=(t,e)=>{const i=1-2*e,r=Em(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return tl(r,r)},Hge=(t,e)=>{const i=Em(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return tl(i,i)},qge=(t,e)=>{const i=1-e,r=Em(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return tl(r,r)};let PY=class FY{constructor(e,i,r){this.strength=e,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(e,i,r){this.strength=Qs(e.strength,i.strength,r),this.radius=Qs(e.radius,i.radius,r),this.threshold=Qs(e.threshold,i.threshold,r)}clone(){return new FY(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:oS(this.radius),strength:this.strength,threshold:this.threshold}}},NY=class DY{constructor(e){this.radius=e,this.type="blur"}interpolate(e,i,r){this.radius=Math.round(Qs(e.radius,i.radius,r))}clone(){return new DY(this.radius)}toJSON(){return{type:"blur",radius:oS(this.radius)}}},MR=class VY{constructor(e,i){this.type=e,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.amount=Qs(e.amount,i.amount,r),this._updateMatrix()}clone(){return new VY(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||ZC();switch(this.type){case"brightness":this._colorMatrix=Uge(e,this.amount);break;case"contrast":this._colorMatrix=jge(e,this.amount);break;case"grayscale":this._colorMatrix=Gge(e,this.amount);break;case"invert":this._colorMatrix=Bge(e,this.amount);break;case"saturate":this._colorMatrix=Hge(e,this.amount);break;case"sepia":this._colorMatrix=qge(e,this.amount)}}},UY=class jY{constructor(e,i,r,n){this.offsetX=e,this.offsetY=i,this.blurRadius=r,this.color=n,this.type="drop-shadow"}interpolate(e,i,r){this.offsetX=Qs(e.offsetX,i.offsetX,r),this.offsetY=Qs(e.offsetY,i.offsetY,r),this.blurRadius=Qs(e.blurRadius,i.blurRadius,r),this.color[0]=Math.round(Qs(e.color[0],i.color[0],r)),this.color[1]=Math.round(Qs(e.color[1],i.color[1],r)),this.color[2]=Math.round(Qs(e.color[2],i.color[2],r)),this.color[3]=Qs(e.color[3],i.color[3],r)}clone(){return new jY(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:oS(this.offsetX),yoffset:oS(this.offsetY),blurRadius:oS(this.blurRadius),color:e}}},GY=class zY{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.angle=Qs(e.angle,i.angle,r),this._updateMatrix()}clone(){return new zY(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||ZC();this._colorMatrix=zge(e,this.angle)}},BY=class HY{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,i,r){this.amount=Qs(e.amount,i.amount,r)}clone(){return new HY(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Qs(t,e,i){return t+(e-t)*i}function oS(t){return Math.round(1e3*Jr(t))/1e3}function Wge(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new MR(t.type,0);case"saturate":case"brightness":case"contrast":return new MR(t.type,1);case"opacity":return new BY(1);case"hue-rotate":return new GY(0);case"blur":return new NY(0);case"drop-shadow":return new UY(0,0,0,[...UV("transparent")]);case"bloom":return new PY(0,0,1)}}function qY(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every((r,n)=>r.type===i[n].type)}function WY(t,e){const i=t.length>e.length?t:e,r=t.length>e.length?e:t;for(let n=r.length;n<i.length;n++)r.push(Wge(i[n]))}function Zge(t){const e=t[0];return!!e&&"type"in e}function Jge(t,e){return JSON.stringify(t??null)===JSON.stringify(e??null)}const LL=()=>U.getLogger("esri.support.basemapUtils");function Yge(){return{}}function ZY(t){for(const e in t){const i=t[e];xe(i),delete t[e]}}function JI(t,e){let i;if(typeof t=="string"){const r=t in Sb,n=!r&&t.includes("/");if(!r&&!n){if(et.apiKey)LL().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const s=Object.entries(Sb).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");LL().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${s}`)}return null}e&&(i=e[t]),i||(i=r?sS.fromId(t):new sS({style:{id:t}}),e&&(e[t]=i))}else i=pi(sS,t);return i!=null&&i.destroyed&&(LL().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function ZJe(t,e){var i,r,n,s;return((r=(i=t.basemap)==null?void 0:i.referenceLayers)==null?void 0:r.some(o=>o.uid===e))||((s=(n=t.basemap)==null?void 0:n.baseLayers)==null?void 0:s.some(o=>o.uid===e))}function Kge(t){let e=null;const i=tve(t),r=!(i!=null&&i.baseLayers.length);for(const n in Sb){const s=nve(i,JY(Sb[n]),{mustMatchReferences:r});if(s==="equal"){e=n;break}s==="base-layers-equal"&&(e=n)}return e}function JJe(t){return!!(t!=null&&t.baseLayers.concat(t.referenceLayers).some(Xge))}function Xge(t){if(NG(t.url))return!0;if(t.type==="vector-tile")for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(NG(i==null?void 0:i.sourceUrl))return!0}return!1}function Qge(t,e){var s;if(e==null||t==null)return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?(s=i.tileInfo)==null?void 0:s.spatialReference:i.spatialReference]).filter(Boolean),n=t.spatialReference;return n?{spatialReference:r.find(o=>n.equals(o))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}const eve=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function NG(t){if(!t)return!1;const e=new nm(ro(t));return!!e.authority&&eve.test(e.authority)}function tve(t){return t?!t.loaded&&t.resourceInfo?JY(t.resourceInfo.data):{baseLayers:DG(t.baseLayers),referenceLayers:DG(t.referenceLayers)}:null}function DG(t){return(Y.isCollection(t)?t.toArray():t).map(ive)}function ive(t){var e,i;return{type:t.type,effect:"effect"in t?t.effect:void 0,url:YY("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&t.minScale!=null?t.minScale:0,maxScale:"maxScale"in t&&t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visible==null||!!t.visible,sublayers:t.type!=="map-image"&&t.type!=="wms"||t.sublayers==null||(e=t.sublayers)==null?void 0:e.map(r=>({id:r.id,visible:r.visible})),activeLayerId:t.type==="wmts"?(i=t.activeLayer)==null?void 0:i.id:void 0}}function VG(t){return t.isReference||t.layerType==="ArcGISSceneServiceLayer"}function JY(t){return t?{baseLayers:UG((t.baseMapLayers??[]).filter(e=>!VG(e))),referenceLayers:UG((t.baseMapLayers??[]).filter(e=>VG(e)))}:null}function UG(t){return t.map(e=>rve(e))}function rve(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;case"ArcGISSceneServiceLayer":e="scene";break;default:e="unknown"}return{type:e,effect:t.effect,url:YY(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:t.visibility==null||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function nve(t,e,i){return t!=null!=(e!=null)?"not-equal":!t||!e?"equal":jG(t.baseLayers,e.baseLayers)?jG(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function jG(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!sve(t[i],e[i]))return!1;return!0}function sve(t,e){if(t.type!==e.type||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity||!Jge(t.effect,e.effect))return!1;if(t.activeLayerId!=null||e.activeLayerId!=null)return t.activeLayerId===e.activeLayerId;if(t.sublayers!=null||e.sublayers!=null){if(t.sublayers==null||e.sublayers==null||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const r=t.sublayers.at(i),n=e.sublayers.at(i);if((r==null?void 0:r.id)!==(n==null?void 0:n.id)||(r==null?void 0:r.visible)!==(n==null?void 0:n.visible))return!1}}return!0}function YY(t){return t?kn(t).replace(/^\s*https?:/i,"").toLowerCase():""}function KY(t){if(!t)return null;const{thumbnailUrl:e}=t;if(e)return e;const i=Kge(t);return i?Sb[i].thumbnailUrl:mb(t.baseLayers,ove)}function ove(t){var e;return"portalItem"in t?(e=t.portalItem)==null?void 0:e.thumbnailUrl:void 0}function ave(t){return new JS({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const i=[];return"tables"in e&&i.push(e.tables),"layers"in e&&i.push(e.layers),i},itemFilterFunction:e=>{const i=e.parent;return!!i&&"tables"in i&&i.tables.includes(e)}})}function AL(t){for(const e of t.values())e==null||e.destroy();t.clear()}const GG={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function lve(t){let e=null;if(typeof t=="string")if(t in GG){const i=GG[t];e=new ZS({resourceInfo:{data:{layers:[i]}}})}else U.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=pi(ZS,t);return e}function Eb(t,e,i=!1){let{hasM:r,hasZ:n}=t;Array.isArray(e)?e.length!==4||r||n?e.length===3&&i&&!r?(n=!0,r=!1):e.length===3&&r&&n&&(r=!1,n=!1):(r=!0,n=!0):(n=!n&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=r}var CR;function zG(t){return(e,i)=>e==null?i:i==null?e:t(e,i)}function uve(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Wp=CR=class extends _p{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){var n;if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):uve(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const r=(n=i.points)==null?void 0:n[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new at,i=this.hasZ,r=this.hasM,n=i?3:2,s=t[0],o=zG(Math.min),a=zG(Math.max);let u,d,p,h,[m,y]=s,[g,v]=s;for(let _=0,w=t.length;_<w;_++){const S=t[_],[E,T]=S;if(m=o(m,E),y=o(y,T),g=a(g,E),v=a(v,T),i&&S.length>2){const M=S[2];u=o(u,M),p=a(p,M)}if(r&&S.length>n){const M=S[n];d=o(d,M),h=a(h,M)}}return e.xmin=m,e.ymin=y,e.xmax=g,e.ymax=v,e.spatialReference=this.spatialReference,i?(e.zmin=u,e.zmax=p):(e.zmin=void 0,e.zmax=void 0),r?(e.mmin=d,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=R(this.points)}addPoint(t){return Eb(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:R(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new CR(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=e[2],r=3),this.hasM&&(i.m=e[r]),new we(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new we(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Eb(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};l([c({readOnly:!0})],Wp.prototype,"cache",null),l([c()],Wp.prototype,"extent",null),l([c({type:[[Number]],json:{write:{isRequired:!0}}})],Wp.prototype,"points",void 0),l([te("points")],Wp.prototype,"writePoints",null),Wp=CR=l([$("esri.geometry.Multipoint")],Wp),Wp.prototype.toJSON.isDefaultToJSON=!0;const ep=Wp;function YJe(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function cve(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var uu;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(uu||(uu={}));function BG(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,i=t.hasM;if(t.type==="point")return i&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:i?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.slice();if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let n=!1,s=!1;return r.forEach(o=>{o.hasZ&&(n=!0),o.hasM&&(s=!0)}),r.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(n&&o.hasZ){const u=.5*(o.zmax-o.zmin);for(let d=0;d<a.length;d++)a[d].push(u)}if(s&&o.hasM){const u=.5*(o.mmax-o.mmin);for(let d=0;d<a.length;d++)a[d].push(u)}return a})}return null}function YC(t,e){const i=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)}return Math.sqrt(i*i+r*r)}function XY(t,e,i){const r=t[0]+i*(e[0]-t[0]),n=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[r,n,t[2]+i*(e[2]-t[2])]:[r,n]}function dve(t,e,i,r){return pve(t,e,i[r],i[r+1])}function pve(t,e,i,r){const[n,s]=e,[o,a]=i,[u,d]=r,p=u-o,h=d-a,m=p*p+h*h,y=(n-o)*p+(s-a)*h,g=Math.min(1,Math.max(0,y/m));return t[0]=o+p*g,t[1]=a+h*g,t}function KJe(t,e,i,r,n,s){let o=i,a=r,u=n-o,d=s-a;if(u!==0||d!==0){const p=((t-o)*u+(e-a)*d)/(u*u+d*d);p>1?(o=n,a=s):p>0&&(o+=u*p,a+=d*p)}return u=t-o,d=e-a,u*u+d*d}function QY(t,e){return XY(t,e,.5)}function XJe(t){const e=t.length;let i=0;for(let r=0;r<e-1;++r)i+=YC(t[r],t[r+1]);return i}function QJe(t,e){if(e<=0)return t[0];const i=t.length;let r=0;for(let n=0;n<i-1;++n){const s=YC(t[n],t[n+1]);if(e-r<s){const o=(e-r)/s;return XY(t[n],t[n+1],o)}r+=s}return t[i-1]}function eK(t,e=uu.X,i=uu.Y){let r=0;const n=t.length;let s=t[0];for(let o=1;o<n;o++){const a=t[o];r+=(a[e]-s[e])*(a[i]+s[i]),s=a}if(!tK(t)){const o=t[0];r+=(o[e]-s[e])*(o[i]+s[i])}return r>=0}function tK(t){const e=t.length;return e<3||eg(t[0],t[e-1])}function eYe(t){"rings"in t&&(hve(t),mve(t))}function hve(t){if(!("rings"in t))return!1;let e=!1;for(const i of t.rings)tK(i)||(i.push(i[0].slice()),e=!0);return e}function mve(t){if(!("rings"in t)||t.rings.length===0||eK(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function tYe(t){return t.type!=="polygon"&&t.type!=="polyline"||fve(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function fve(t,e){const i=Ln(e);if(!i)return;const r=i.valid[0],n=i.valid[1],s=n-r;for(const o of t){let a=1/0,u=-1/0;for(const p of o){const h=iK(p[0],r,n);a=Math.min(a,h),u=Math.max(u,h),p[0]=h}const d=u-a;s-d<d&&o.forEach(p=>{p[0]<0&&(p[0]+=s)})}}function iK(t,e,i){const r=i-e;return t<e?i-(e-t)%r:t>i?e+(t-e)%r:t}function iYe(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[i,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return i.length===r.length&&i.every((n,s)=>n.length===r[s].length)}function rYe(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function yve(t){return t?gve(t.rings,t.hasZ??!1):null}function gve(t,e){if(!(t!=null&&t.length))return null;const i=[],r=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=rK(t[s],e,n);a&&r.push(a)}if(r.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const s=t[0]&&t[0].length?vve(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}function rK(t,e,i){let r=0,n=0,s=0,o=0,a=0;const u=t.length?t[0][0]:0,d=t.length?t[0][1]:0,p=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const y=t[m],g=t[(m+1)%t.length],[v,_,w]=y,S=v-u,E=_-d,[T,M,x]=g,C=T-u,O=M-d,F=S*O-C*E;if(o+=F,r+=(S+C)*F,n+=(E+O)*F,e&&y.length>2&&g.length>2){const V=w-p,z=x-p,H=S*z-C*V;s+=(V+z)*H,a+=H}v<i[0]&&(i[0]=v),v>i[1]&&(i[1]=v),_<i[2]&&(i[2]=_),_>i[3]&&(i[3]=_),e&&(w<i[4]&&(i[4]=w),w>i[5]&&(i[5]=w))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[r/(6*o)+u,n/(6*o)+d,o];return e&&(i[4]===i[5]||a===0?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=s/(6*a)+p,h[4]=a)),h}function nYe(t,e){let i=0,r=0,n=0;t.nextPoint();const s=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const u=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const d=[t.x,t.y],[p,h]=u,m=p-s,y=h-o,[g,v]=d,_=g-s,w=v-o,S=m*w-_*y;n+=S,i+=(m+_)*S,r+=(y+w)*S,p<e[0]&&(e[0]=p),p>e[1]&&(e[1]=p),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return n>0&&(n*=-1),n?(n*=.5,[i/(6*n)+s,r/(6*n)+o,n]):null}function vve(t,e){const i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;for(let u=0,d=t.length;u<d-1;u++){const p=t[u],h=t[u+1];if(p&&h){i[0]=p[0],i[1]=p[1],r[0]=h[0],r[1]=h[1],e&&p.length>2&&h.length>2&&(i[2]=p[2],r[2]=h[2]);const m=YC(i,r);if(m){n+=m;const y=QY(p,h);s+=m*y[0],o+=m*y[1],e&&y.length>2&&(a+=m*y[2])}}}return n>0?e?[s/n,o/n,a/n]:[s/n,o/n]:t.length?t[0]:null}function bve(t){const{hasZ:e,totalSize:i}=t;if(i===0)return null;const r=[],n=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=rK(cve(t),t.hasZ,s);o&&n.push(o)}if(n.sort((o,a)=>{let u=o[2]-a[2];return u===0&&e&&(u=o[4]-a[4]),u}),n.length&&(r[0]=n[0][0],r[1]=n[0][1],e&&(r[2]=n[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const o=t.pathSize?_ve(t):null;if(!o)return null;r[0]=o[0],r[1]=o[1],e&&o.length>2&&(r[2]=o[2])}return r}function _ve(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;if(t.nextPoint()){let u=t.x,d=t.y,p=t.z;for(;t.nextPoint();){const h=t.x,m=t.y,y=t.z;i[0]=u,i[1]=d,r[0]=h,r[1]=m,e&&(i[2]=p,r[2]=y);const g=YC(i,r);if(g){n+=g;const v=QY(i,r);s+=g*v[0],o+=g*v[1],e&&v.length>2&&(a+=g*v[2])}u=h,d=m,p=y}}return n>0?e?[s/n,o/n,a/n]:[s/n,o/n]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const wve=1e-6;function sYe(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<wve){const n=bve(t);return n?[n[0],n[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)$ve(i,r,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=r[0],i[1]+=r[1],i}const Sve=1/3;function $ve(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,n=i.y;i.nextPoint();let s,o=i.x-r,a=i.y-n,u=0,d=0;for(;i.nextPoint();)u=i.x-r,d=i.y-n,s=.5*Sve*(u*a-d*o),t[0]+=s*(o+u),t[1]+=s*(a+d),o=u,a=d;const p=i.getCurrentRingArea(),h=[r,n];return h[0]-=e[0],h[1]-=e[1],h[0]*=p,h[1]*=p,t[0]+=h[0],t[1]+=h[1],t}function Cn(t=Ive){return[t[0],t[1],t[2],t[3]]}function nK(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Eve(t,e,i,r,n=Cn()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function Tve(t,e=Cn()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function sK(t,e){return new at({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function oYe(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function aYe(t,e,i){if(e!=null)if("length"in e)kR(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else nK(i,t)}function lYe(t,e,i=t){const r=e.length;let n=t[0],s=t[1],o=t[2],a=t[3];for(let u=0;u<r;u++){const d=e[u];n=Math.min(n,d[0]),s=Math.min(s,d[1]),o=Math.max(o,d[0]),a=Math.max(a,d[1])}return i[0]=n,i[1]=s,i[2]=o,i[3]=a,i}function uYe(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function oK(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function aK(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function cYe(t){return oK(t)*aK(t)}function dYe(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function pYe(t,e){return lK(t,e.x,e.y)}function lK(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function hYe(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function ZV(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function mYe(t,e,i,r=t){return r[0]=t[0]+e,r[1]=t[1]+i,r[2]=t[2]+e,r[3]=t[3]+i,r}function fYe(t){return t?nK(t,HG):Cn(HG)}function kR(t){return t!=null&&t.length===4}function yYe(t,e){return kR(t)&&kR(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const HG=[1/0,1/0,-1/0,-1/0],Ive=[0,0,0,0];function uK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function cK(t){return t.points!==void 0}function dK(t){return t.x!==void 0&&t.y!==void 0}function pK(t){return t.paths!==void 0}function hK(t){return t.rings!==void 0}function mK(t){function e(i,r){return i==null?r:r==null?i:t(i,r)}return e}const Zh=mK(Math.min),Jh=mK(Math.max);function gYe(t,e){return pK(e)?Tb(t,e.paths,!1,!1):hK(e)?Tb(t,e.rings,!1,!1):cK(e)?JV(t,e.points,!1,!1,!1,!1):uK(e)?fK(t,e):(dK(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function vYe(t){let e,i,r,n;for(t.reset(),e=r=1/0,i=n=-1/0;t.nextPath();){const s=xve(t);e=Math.min(s[0],e),r=Math.min(s[1],r),i=Math.max(s[2],i),n=Math.max(s[3],n)}return Cn([e,r,i,n])}function xve(t){let e,i,r,n;for(e=r=1/0,i=n=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),i=Math.max(t.x,i),n=Math.max(t.y,n);return Cn([e,r,i,n])}function bYe(t,e){return pK(e)?Tb(t,e.paths,!0,!1):hK(e)?Tb(t,e.rings,!0,!1):cK(e)?JV(t,e.points,!0,!1,!0,!1):uK(e)?fK(t,e,!0,!1,!0,!1):(dK(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Tb(t,e,i,r){const n=i?3:2;if(!e.length||!e[0].length)return null;let s,o,a,u,[d,p]=e[0][0],[h,m]=e[0][0];for(let y=0;y<e.length;y++){const g=e[y];for(let v=0;v<g.length;v++){const _=g[v],[w,S]=_;if(d=Zh(d,w),p=Zh(p,S),h=Jh(h,w),m=Jh(m,S),i&&_.length>2){const E=_[2];s=Zh(s,E),o=Jh(o,E)}if(r&&_.length>n){const E=_[n];a=Zh(s,E),u=Jh(o,E)}}}return i?r?(t[0]=d,t[1]=p,t[2]=s,t[3]=a,t[4]=h,t[5]=m,t[6]=o,t[7]=u,t.length=8,t):(t[0]=d,t[1]=p,t[2]=s,t[3]=h,t[4]=m,t[5]=o,t.length=6,t):r?(t[0]=d,t[1]=p,t[2]=a,t[3]=h,t[4]=m,t[5]=u,t.length=6,t):(t[0]=d,t[1]=p,t[2]=h,t[3]=m,t.length=4,t)}function fK(t,e,i,r,n,s){const o=e.xmin,a=e.xmax,u=e.ymin,d=e.ymax;let p=e.zmin,h=e.zmax,m=e.mmin,y=e.mmax;return n?(p=p||0,h=h||0,s?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=p,t[3]=m,t[4]=a,t[5]=d,t[6]=h,t[7]=y,t):(t[0]=o,t[1]=u,t[2]=p,t[3]=a,t[4]=d,t[5]=h,t)):s?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=m,t[3]=a,t[4]=d,t[5]=y,t):(t[0]=o,t[1]=u,t[2]=a,t[3]=d,t)}function JV(t,e,i,r,n,s){const o=i?3:2,a=r&&s,u=i&&n;if(!e.length||!e[0].length)return null;let d,p,h,m,[y,g]=e[0],[v,_]=e[0];for(let w=0;w<e.length;w++){const S=e[w],[E,T]=S;if(y=Zh(y,E),g=Zh(g,T),v=Jh(v,E),_=Jh(_,T),u&&S.length>2){const M=S[2];d=Zh(d,M),p=Jh(p,M)}if(a&&S.length>o){const M=S[o];h=Zh(d,M),m=Jh(p,M)}}return n?(d=d||0,p=p||0,s?(h=h||0,m=m||0,t[0]=y,t[1]=g,t[2]=d,t[3]=h,t[4]=v,t[5]=_,t[6]=p,t[7]=m,t):(t[0]=y,t[1]=g,t[2]=d,t[3]=v,t[4]=_,t[5]=p,t)):s?(h=h||0,m=m||0,t[0]=y,t[1]=g,t[2]=h,t[3]=v,t[4]=_,t[5]=m,t):(t[0]=y,t[1]=g,t[2]=v,t[3]=_,t)}function Mve(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Cve(t){return t.points!==void 0}function kve(t){return t.x!==void 0&&t.y!==void 0}function Lve(t){return t.paths!==void 0}function Ave(t){return t.rings!==void 0}const YV=[];function yK(t,e,i,r){return{xmin:t,ymin:e,xmax:i,ymax:r}}function gK(t,e,i,r,n,s){return{xmin:t,ymin:e,zmin:i,xmax:r,ymax:n,zmax:s}}function vK(t,e,i,r,n,s){return{xmin:t,ymin:e,mmin:i,xmax:r,ymax:n,mmax:s}}function bK(t,e,i,r,n,s,o,a){return{xmin:t,ymin:e,zmin:i,mmin:r,xmax:n,ymax:s,zmax:o,mmax:a}}function KV(t,e=!1,i=!1){return e?i?bK(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):gK(t[0],t[1],t[2],t[3],t[4],t[5]):i?vK(t[0],t[1],t[2],t[3],t[4],t[5]):yK(t[0],t[1],t[2],t[3])}function _Ye(t){return t?Mve(t)?t:kve(t)?Rve(t):Ave(t)?_K(t):Lve(t)?wK(t):Cve(t)?Ove(t):null:null}function Ove(t){const{hasZ:e,hasM:i,points:r}=t;return KV(JV(YV,r,e??!1,i??!1),e,i)}function Rve(t){const{x:e,y:i,z:r,m:n}=t,s=n!=null;return r!=null?s?bK(e,i,r,n,e,i,r,n):gK(e,i,r,e,i,r):s?vK(e,i,n,e,i,n):yK(e,i,e,i)}function _K(t){const{hasZ:e,hasM:i,rings:r}=t,n=Tb(YV,r,e??!1,i??!1);return n?KV(n,e,i):null}function wK(t){const{hasZ:e,hasM:i,paths:r}=t,n=Tb(YV,r,e??!1,i??!1);return n?KV(n,e,i):null}var YI;function qG(t){return!Array.isArray(t[0])}function Pve(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function Fve(t){var s,o;if(!t)return;let{rings:e,hasM:i,hasZ:r,spatialReference:n}=t;switch(e??(e=[]),Pve(e)&&(e=[e]),(o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length){case 4:r??(r=!0),i??(i=!0);break;case 3:r??(r=i!==!0),i??(i=!r);break;default:r??(r=!1),i??(i=!1)}return n??(n=le.WGS84),{...t,hasM:i,hasZ:r,rings:e,spatialReference:n}}let ic=YI=class extends _p{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:i}=t;let r=!1,n=!1;for(const o of e)o.hasZ&&(r=!0),o.hasM&&(n=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const u=o.zmin+.5*(o.zmax-o.zmin);for(let d=0;d<a.length;d++)a[d].push(u)}if(n&&o.hasM){const u=o.mmin+.5*(o.mmax-o.mmin);for(let d=0;d<a.length;d++)a[d].push(u)}return a}),spatialReference:i};return r&&(s.hasZ=!0),n&&(s.hasM=!0),new YI(s)}constructor(t){super(Fve(t)),this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=yve(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new we;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=_K(this);if(!e)return null;const i=new at(e);return i.spatialReference=t,i}get isSelfIntersecting(){return qfe(this.rings)}writeRings(t,e){e.rings=R(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(qG(t)){const r=[];for(let n=0,s=t.length;n<s;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new YI;return t.spatialReference=this.spatialReference,t.rings=R(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const r=([n,s,o,a],[u,d,p,h])=>n===u&&s===d&&(o==null&&p==null||o===p)&&(a==null&&h==null||a===h);for(let n=0;n<this.rings.length;n++){const s=this.rings[n],o=t.rings[n];if(!eg(s,o,r))return!1}return!0}contains(t){if(!t)return!1;const e=V$(t,this.spatialReference);return AV(this,e??t)}isClockwise(t){const e=qG(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t;return eK(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new we(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new we(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new we(i[0],i[1],i[2],i[3],this.spatialReference):new we(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Eb(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new we(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new we(n,i));return this.notifyChange("rings"),r}setPoint(t,e,i){return this._validateInputs(t,e)?(Eb(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};l([c({readOnly:!0})],ic.prototype,"cache",null),l([c({readOnly:!0})],ic.prototype,"centroid",null),l([c({readOnly:!0})],ic.prototype,"extent",null),l([c({readOnly:!0})],ic.prototype,"isSelfIntersecting",null),l([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],ic.prototype,"rings",void 0),l([te("rings")],ic.prototype,"writeRings",null),ic=YI=l([$("esri.geometry.Polygon")],ic);const os=ic;ic.prototype.toJSON.isDefaultToJSON=!0;var LR;function Nve(t){return!Array.isArray(t[0])}function Dve(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function Vve(t){var s,o;if(!t)return;let{paths:e,hasM:i,hasZ:r,spatialReference:n}=t;switch(e??(e=[]),Dve(e)&&(e=[e]),(o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length){case 4:r??(r=!0),i??(i=!0);break;case 3:r??(r=i!==!0),i??(i=!r);break;default:r??(r=!1),i??(i=!1)}return n??(n=le.WGS84),{...t,hasM:i,hasZ:r,paths:e,spatialReference:n}}let Fh=LR=class extends _p{constructor(t){super(Vve(t)),this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=wK(this);if(!e)return null;const i=new at(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=R(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(Nve(t)){const r=[];for(let n=0,s=t.length;n<s;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new LR;return t.spatialReference=this.spatialReference,t.paths=R(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new we(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new we(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new we(i[0],i[1],i[2],i[3],this.spatialReference):new we(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Eb(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new we(n,i));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new we(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(Eb(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};l([c({readOnly:!0})],Fh.prototype,"cache",null),l([c({readOnly:!0})],Fh.prototype,"extent",null),l([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],Fh.prototype,"paths",void 0),l([te("paths")],Fh.prototype,"writePaths",null),Fh=LR=l([$("esri.geometry.Polyline")],Fh);const hn=Fh;Fh.prototype.toJSON.isDefaultToJSON=!0;const Uve=Me()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),WG=Me()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function SK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function $K(t){return t.points!==void 0}function EK(t){return t.x!==void 0&&t.y!==void 0}function XV(t){return t.paths!==void 0}function Sy(t){return t.rings!==void 0}function dp(t){return t==null?null:t instanceof _p?t:EK(t)?we.fromJSON(t):XV(t)?hn.fromJSON(t):Sy(t)?os.fromJSON(t):$K(t)?ep.fromJSON(t):SK(t)?at.fromJSON(t):null}function H$(t){return t?EK(t)?"esriGeometryPoint":XV(t)?"esriGeometryPolyline":Sy(t)?"esriGeometryPolygon":SK(t)?"esriGeometryEnvelope":$K(t)?"esriGeometryMultipoint":null:null}const jve={esriGeometryPoint:we,esriGeometryPolyline:hn,esriGeometryPolygon:os,esriGeometryEnvelope:at,esriGeometryMultipoint:ep,esriGeometryMultiPatch:os};function Gve(t){return t&&jve[t]||null}const rg={base:_p,key:"type",typeMap:{extent:at,multipoint:ep,point:we,polyline:hn,polygon:os}};Qa(rg);let TK=0;const vu=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+TK++})}};return e=l([$("esri.core.Identifiable")],e),e},QV=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:TK++})}};return e=l([$("esri.core.Identifiable.NumericIdentifiable")],e),e};let ZG=class extends vu(class{}){};ZG=l([$("esri.core.Identifiable")],ZG);async function zve(t){var r;const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await k(async()=>{const{fromItem:n}=await import("./portalLayers-CZ_qkpre.js").then(s=>s.p);return{fromItem:n}},__vite__mapDeps([8,9,10]));try{return await i(e)}catch(n){const s=e==null?void 0:e.portalItem,o=(s==null?void 0:s.id)||"unset",a=((r=s==null?void 0:s.portal)==null?void 0:r.url)||et.portalUrl;throw U.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+a+"', id: '"+o+"')",n),n}}const JG=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class ng extends Error{}class Bve extends ng{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Hve extends ng{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class qve extends ng{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class _0 extends ng{}class IK extends ng{constructor(e){super(`Invalid unit ${e}`)}}class Kn extends ng{}class Op extends ng{constructor(){super("Zone is an abstract class")}}const ae="numeric",yu="short",qo="long",l2={year:ae,month:ae,day:ae},xK={year:ae,month:yu,day:ae},Wve={year:ae,month:yu,day:ae,weekday:yu},MK={year:ae,month:qo,day:ae},CK={year:ae,month:qo,day:ae,weekday:qo},kK={hour:ae,minute:ae},LK={hour:ae,minute:ae,second:ae},AK={hour:ae,minute:ae,second:ae,timeZoneName:yu},OK={hour:ae,minute:ae,second:ae,timeZoneName:qo},RK={hour:ae,minute:ae,hourCycle:"h23"},PK={hour:ae,minute:ae,second:ae,hourCycle:"h23"},FK={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:yu},NK={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:qo},DK={year:ae,month:ae,day:ae,hour:ae,minute:ae},VK={year:ae,month:ae,day:ae,hour:ae,minute:ae,second:ae},UK={year:ae,month:yu,day:ae,hour:ae,minute:ae},jK={year:ae,month:yu,day:ae,hour:ae,minute:ae,second:ae},Zve={year:ae,month:yu,day:ae,weekday:yu,hour:ae,minute:ae},GK={year:ae,month:qo,day:ae,hour:ae,minute:ae,timeZoneName:yu},zK={year:ae,month:qo,day:ae,hour:ae,minute:ae,second:ae,timeZoneName:yu},BK={year:ae,month:qo,day:ae,weekday:qo,hour:ae,minute:ae,timeZoneName:qo},HK={year:ae,month:qo,day:ae,weekday:qo,hour:ae,minute:ae,second:ae,timeZoneName:qo};class sg{get type(){throw new Op}get name(){throw new Op}get ianaName(){return this.name}get isUniversal(){throw new Op}offsetName(e,i){throw new Op}formatOffset(e,i){throw new Op}offset(e){throw new Op}equals(e){throw new Op}get isValid(){throw new Op}}let OL=null;class KC extends sg{static get instance(){return OL===null&&(OL=new KC),OL}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return eX(e,i,r)}formatOffset(e,i){return aS(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let KI={};function Jve(t){return KI[t]||(KI[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),KI[t]}const Yve={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Kve(t,e){const i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,n,s,o,a,u,d,p]=r;return[o,n,s,a,u,d,p]}function Xve(t,e){const i=t.formatToParts(e),r=[];for(let n=0;n<i.length;n++){const{type:s,value:o}=i[n],a=Yve[s];s==="era"?r[a]=o:Ge(a)||(r[a]=parseInt(o,10))}return r}let oT={};class co extends sg{static create(e){return oT[e]||(oT[e]=new co(e)),oT[e]}static resetCache(){oT={},KI={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=co.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return eX(e,i,r,this.name)}formatOffset(e,i){return aS(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const r=Jve(this.name);let[n,s,o,a,u,d,p]=r.formatToParts?Xve(r,i):Kve(r,i);a==="BC"&&(n=-Math.abs(n)+1);const m=QC({year:n,month:s,day:o,hour:u===24?0:u,minute:d,second:p,millisecond:0});let y=+i;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let YG={};function Qve(t,e={}){const i=JSON.stringify([t,e]);let r=YG[i];return r||(r=new Intl.ListFormat(t,e),YG[i]=r),r}let AR={};function OR(t,e={}){const i=JSON.stringify([t,e]);let r=AR[i];return r||(r=new Intl.DateTimeFormat(t,e),AR[i]=r),r}let RR={};function e0e(t,e={}){const i=JSON.stringify([t,e]);let r=RR[i];return r||(r=new Intl.NumberFormat(t,e),RR[i]=r),r}let PR={};function t0e(t,e={}){const{base:i,...r}=e,n=JSON.stringify([t,r]);let s=PR[n];return s||(s=new Intl.RelativeTimeFormat(t,e),PR[n]=s),s}let Pw=null;function i0e(){return Pw||(Pw=new Intl.DateTimeFormat().resolvedOptions().locale,Pw)}let KG={};function r0e(t){let e=KG[t];if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,KG[t]=e}return e}function n0e(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let r,n;try{r=OR(t).resolvedOptions(),n=t}catch{const u=t.substring(0,i);r=OR(u).resolvedOptions(),n=u}const{numberingSystem:s,calendar:o}=r;return[n,s,o]}}function s0e(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function o0e(t){const e=[];for(let i=1;i<=12;i++){const r=se.utc(2009,i,1);e.push(t(r))}return e}function a0e(t){const e=[];for(let i=1;i<=7;i++){const r=se.utc(2016,11,13+i);e.push(t(r))}return e}function aT(t,e,i,r){const n=t.listingMode();return n==="error"?null:n==="en"?i(e):r(e)}function l0e(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class u0e{constructor(e,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:s,...o}=r;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=e0e(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):n5(e,3);return Er(i,this.padTo)}}}class c0e{constructor(e,i,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&co.create(a).valid?(n=a,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=OR(i,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class d0e{constructor(e,i,r){this.opts={style:"long",...r},!i&&XK()&&(this.rtf=t0e(e,r))}format(e,i){return this.rtf?this.rtf.format(e,i):R0e(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const p0e={firstDay:1,minimalDays:4,weekend:[6,7]};class Ut{static fromOpts(e){return Ut.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,r,n,s=!1){const o=e||ir.defaultLocale,a=o||(s?"en-US":i0e()),u=i||ir.defaultNumberingSystem,d=r||ir.defaultOutputCalendar,p=FR(n)||ir.defaultWeekSettings;return new Ut(a,u,d,p,o)}static resetCache(){Pw=null,AR={},RR={},PR={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:r,weekSettings:n}={}){return Ut.create(e,i,r,n)}constructor(e,i,r,n,s){const[o,a,u]=n0e(e);this.locale=o,this.numberingSystem=i||a||null,this.outputCalendar=r||u||null,this.weekSettings=n,this.intl=s0e(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=l0e(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Ut.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,FR(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return aT(this,e,rX,()=>{const r=i?{month:e,day:"numeric"}:{month:e},n=i?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=o0e(s=>this.extract(s,r,"month"))),this.monthsCache[n][e]})}weekdays(e,i=!1){return aT(this,e,oX,()=>{const r=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=i?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=a0e(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[n][e]})}meridiems(){return aT(this,void 0,()=>aX,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[se.utc(2016,11,13,9),se.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return aT(this,e,lX,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[se.utc(-40,1,1),se.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[e]})}extract(e,i,r){const n=this.dtFormatter(e,i),s=n.formatToParts(),o=s.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new u0e(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new c0e(e,this.intl,i)}relFormatter(e={}){return new d0e(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Qve(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:QK()?r0e(this.locale):p0e}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let RL=null;class pr extends sg{static get utcInstance(){return RL===null&&(RL=new pr(0)),RL}static instance(e){return e===0?pr.utcInstance:new pr(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new pr(ek(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${aS(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${aS(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return aS(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class h0e extends sg{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Bh(t,e){if(Ge(t)||t===null)return e;if(t instanceof sg)return t;if(b0e(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?KC.instance:i==="utc"||i==="gmt"?pr.utcInstance:pr.parseSpecifier(i)||co.create(t)}else return sm(t)?pr.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new h0e(t)}const e5={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},XG={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},m0e=e5.hanidec.replace(/[\[|\]]/g,"").split("");function f0e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);if(t[i].search(e5.hanidec)!==-1)e+=m0e.indexOf(t[i]);else for(const n in XG){const[s,o]=XG[n];r>=s&&r<=o&&(e+=r-s)}}return parseInt(e,10)}else return e}let sv={};function y0e(){sv={}}function ul({numberingSystem:t},e=""){const i=t||"latn";return sv[i]||(sv[i]={}),sv[i][e]||(sv[i][e]=new RegExp(`${e5[i]}${e}`)),sv[i][e]}let QG=()=>Date.now(),e6="system",t6=null,i6=null,r6=null,n6=60,s6,o6=null;class ir{static get now(){return QG}static set now(e){QG=e}static set defaultZone(e){e6=e}static get defaultZone(){return Bh(e6,KC.instance)}static get defaultLocale(){return t6}static set defaultLocale(e){t6=e}static get defaultNumberingSystem(){return i6}static set defaultNumberingSystem(e){i6=e}static get defaultOutputCalendar(){return r6}static set defaultOutputCalendar(e){r6=e}static get defaultWeekSettings(){return o6}static set defaultWeekSettings(e){o6=FR(e)}static get twoDigitCutoffYear(){return n6}static set twoDigitCutoffYear(e){n6=e%100}static get throwOnInvalid(){return s6}static set throwOnInvalid(e){s6=e}static resetCaches(){Ut.resetCache(),co.resetCache(),se.resetCache(),y0e()}}class ru{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const qK=[0,31,59,90,120,151,181,212,243,273,304,334],WK=[0,31,60,91,121,152,182,213,244,274,305,335];function za(t,e){return new ru("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function t5(t,e,i){const r=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const n=r.getUTCDay();return n===0?7:n}function ZK(t,e,i){return i+(q$(t)?WK:qK)[e-1]}function JK(t,e){const i=q$(t)?WK:qK,r=i.findIndex(s=>s<e),n=e-i[r];return{month:r+1,day:n}}function i5(t,e){return(t-e+7)%7+1}function u2(t,e=4,i=1){const{year:r,month:n,day:s}=t,o=ZK(r,n,s),a=i5(t5(r,n,s),i);let u=Math.floor((o-a+14-e)/7),d;return u<1?(d=r-1,u=XS(d,e,i)):u>XS(r,e,i)?(d=r+1,u=1):d=r,{weekYear:d,weekNumber:u,weekday:a,...tk(t)}}function a6(t,e=4,i=1){const{weekYear:r,weekNumber:n,weekday:s}=t,o=i5(t5(r,1,e),i),a=D0(r);let u=n*7+s-o-7+e,d;u<1?(d=r-1,u+=D0(d)):u>a?(d=r+1,u-=D0(r)):d=r;const{month:p,day:h}=JK(d,u);return{year:d,month:p,day:h,...tk(t)}}function PL(t){const{year:e,month:i,day:r}=t,n=ZK(e,i,r);return{year:e,ordinal:n,...tk(t)}}function l6(t){const{year:e,ordinal:i}=t,{month:r,day:n}=JK(e,i);return{year:e,month:r,day:n,...tk(t)}}function u6(t,e){if(!Ge(t.localWeekday)||!Ge(t.localWeekNumber)||!Ge(t.localWeekYear)){if(!Ge(t.weekday)||!Ge(t.weekNumber)||!Ge(t.weekYear))throw new _0("Cannot mix locale-based week fields with ISO-based week fields");return Ge(t.localWeekday)||(t.weekday=t.localWeekday),Ge(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Ge(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function g0e(t,e=4,i=1){const r=XC(t.weekYear),n=Ba(t.weekNumber,1,XS(t.weekYear,e,i)),s=Ba(t.weekday,1,7);return r?n?s?!1:za("weekday",t.weekday):za("week",t.weekNumber):za("weekYear",t.weekYear)}function v0e(t){const e=XC(t.year),i=Ba(t.ordinal,1,D0(t.year));return e?i?!1:za("ordinal",t.ordinal):za("year",t.year)}function YK(t){const e=XC(t.year),i=Ba(t.month,1,12),r=Ba(t.day,1,c2(t.year,t.month));return e?i?r?!1:za("day",t.day):za("month",t.month):za("year",t.year)}function KK(t){const{hour:e,minute:i,second:r,millisecond:n}=t,s=Ba(e,0,23)||e===24&&i===0&&r===0&&n===0,o=Ba(i,0,59),a=Ba(r,0,59),u=Ba(n,0,999);return s?o?a?u?!1:za("millisecond",n):za("second",r):za("minute",i):za("hour",e)}function Ge(t){return typeof t>"u"}function sm(t){return typeof t=="number"}function XC(t){return typeof t=="number"&&t%1===0}function b0e(t){return typeof t=="string"}function _0e(t){return Object.prototype.toString.call(t)==="[object Date]"}function XK(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function QK(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function w0e(t){return Array.isArray(t)?t:[t]}function c6(t,e,i){if(t.length!==0)return t.reduce((r,n)=>{const s=[e(n),n];return r&&i(r[0],s[0])===r[0]?r:s},null)[1]}function S0e(t,e){return e.reduce((i,r)=>(i[r]=t[r],i),{})}function Ib(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function FR(t){if(t==null)return null;if(typeof t!="object")throw new Kn("Week settings must be an object");if(!Ba(t.firstDay,1,7)||!Ba(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Ba(e,1,7)))throw new Kn("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Ba(t,e,i){return XC(t)&&t>=e&&t<=i}function $0e(t,e){return t-e*Math.floor(t/e)}function Er(t,e=2){const i=t<0;let r;return i?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function Nh(t){if(!(Ge(t)||t===null||t===""))return parseInt(t,10)}function Rm(t){if(!(Ge(t)||t===null||t===""))return parseFloat(t)}function r5(t){if(!(Ge(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function n5(t,e,i=!1){const r=10**e;return(i?Math.trunc:Math.round)(t*r)/r}function q$(t){return t%4===0&&(t%100!==0||t%400===0)}function D0(t){return q$(t)?366:365}function c2(t,e){const i=$0e(e-1,12)+1,r=t+(e-i)/12;return i===2?q$(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function QC(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function d6(t,e,i){return-i5(t5(t,1,e),i)+e-1}function XS(t,e=4,i=1){const r=d6(t,e,i),n=d6(t+1,e,i);return(D0(t)-r+n)/7}function NR(t){return t>99?t:t>ir.twoDigitCutoffYear?1900+t:2e3+t}function eX(t,e,i,r=null){const n=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(i,o).formatToParts(n).find(u=>u.type.toLowerCase()==="timezonename");return a?a.value:null}function ek(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const r=parseInt(e,10)||0,n=i<0||Object.is(i,-0)?-r:r;return i*60+n}function tX(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new Kn(`Invalid unit value ${t}`);return e}function d2(t,e){const i={};for(const r in t)if(Ib(t,r)){const n=t[r];if(n==null)continue;i[e(r)]=tX(n)}return i}function aS(t,e){const i=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),n=t>=0?"+":"-";switch(e){case"short":return`${n}${Er(i,2)}:${Er(r,2)}`;case"narrow":return`${n}${i}${r>0?`:${r}`:""}`;case"techie":return`${n}${Er(i,2)}${Er(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function tk(t){return S0e(t,["hour","minute","second","millisecond"])}const E0e=["January","February","March","April","May","June","July","August","September","October","November","December"],iX=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T0e=["J","F","M","A","M","J","J","A","S","O","N","D"];function rX(t){switch(t){case"narrow":return[...T0e];case"short":return[...iX];case"long":return[...E0e];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const nX=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],sX=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],I0e=["M","T","W","T","F","S","S"];function oX(t){switch(t){case"narrow":return[...I0e];case"short":return[...sX];case"long":return[...nX];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const aX=["AM","PM"],x0e=["Before Christ","Anno Domini"],M0e=["BC","AD"],C0e=["B","A"];function lX(t){switch(t){case"narrow":return[...C0e];case"short":return[...M0e];case"long":return[...x0e];default:return null}}function k0e(t){return aX[t.hour<12?0:1]}function L0e(t,e){return oX(e)[t.weekday-1]}function A0e(t,e){return rX(e)[t.month-1]}function O0e(t,e){return lX(e)[t.year<0?0:1]}function R0e(t,e,i="always",r=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${n[t][0]}`;case-1:return h?"yesterday":`last ${n[t][0]}`;case 0:return h?"today":`this ${n[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),u=a===1,d=n[t],p=r?u?d[1]:d[2]||d[1]:u?n[t][0]:t;return o?`${a} ${p} ago`:`in ${a} ${p}`}function p6(t,e){let i="";for(const r of t)r.literal?i+=r.val:i+=e(r.val);return i}const P0e={D:l2,DD:xK,DDD:MK,DDDD:CK,t:kK,tt:LK,ttt:AK,tttt:OK,T:RK,TT:PK,TTT:FK,TTTT:NK,f:DK,ff:UK,fff:GK,ffff:BK,F:VK,FF:jK,FFF:zK,FFFF:HK};class ts{static create(e,i={}){return new ts(e,i)}static parseFormat(e){let i=null,r="",n=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),i=null,r="",n=!n):n||a===i?r+=a:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=a,i=a)}return r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return P0e[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return Er(e,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,i){const r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(y,g)=>this.loc.extract(e,y,g),o=y=>e.isOffsetFixed&&e.offset===0&&y.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,y.format):"",a=()=>r?k0e(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(y,g)=>r?A0e(e,y):s(g?{month:y}:{month:y,day:"numeric"},"month"),d=(y,g)=>r?L0e(e,y):s(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),p=y=>{const g=ts.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(e,g):y},h=y=>r?O0e(e,y):s({era:y},"era"),m=y=>{switch(y){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return n?s({day:"numeric"},"day"):this.num(e.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return d("short",!0);case"cccc":return d("long",!0);case"ccccc":return d("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return d("short",!1);case"EEEE":return d("long",!1);case"EEEEE":return d("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(e.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(e.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return p(y)}};return p6(ts.parseFormat(i),m)}formatDurationFromString(e,i){const r=u=>{switch(u[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=u=>d=>{const p=r(d);return p?this.num(u.get(p),d.length):d},s=ts.parseFormat(i),o=s.reduce((u,{literal:d,val:p})=>d?u:u.concat(p),[]),a=e.shiftTo(...o.map(r).filter(u=>u));return p6(s,n(a))}}const uX=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function c_(...t){const e=t.reduce((i,r)=>i+r.source,"");return RegExp(`^${e}$`)}function d_(...t){return e=>t.reduce(([i,r,n],s)=>{const[o,a,u]=s(e,n);return[{...i,...o},a||r,u]},[{},null,1]).slice(0,2)}function p_(t,...e){if(t==null)return[null,null];for(const[i,r]of e){const n=i.exec(t);if(n)return r(n)}return[null,null]}function cX(...t){return(e,i)=>{const r={};let n;for(n=0;n<t.length;n++)r[t[n]]=Nh(e[i+n]);return[r,null,i+n]}}const dX=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,F0e=`(?:${dX.source}?(?:\\[(${uX.source})\\])?)?`,s5=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,pX=RegExp(`${s5.source}${F0e}`),o5=RegExp(`(?:T${pX.source})?`),N0e=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,D0e=/(\d{4})-?W(\d\d)(?:-?(\d))?/,V0e=/(\d{4})-?(\d{3})/,U0e=cX("weekYear","weekNumber","weekDay"),j0e=cX("year","ordinal"),G0e=/(\d{4})-(\d\d)-(\d\d)/,hX=RegExp(`${s5.source} ?(?:${dX.source}|(${uX.source}))?`),z0e=RegExp(`(?: ${hX.source})?`);function V0(t,e,i){const r=t[e];return Ge(r)?i:Nh(r)}function B0e(t,e){return[{year:V0(t,e),month:V0(t,e+1,1),day:V0(t,e+2,1)},null,e+3]}function h_(t,e){return[{hours:V0(t,e,0),minutes:V0(t,e+1,0),seconds:V0(t,e+2,0),milliseconds:r5(t[e+3])},null,e+4]}function W$(t,e){const i=!t[e]&&!t[e+1],r=ek(t[e+1],t[e+2]),n=i?null:pr.instance(r);return[{},n,e+3]}function Z$(t,e){const i=t[e]?co.create(t[e]):null;return[{},i,e+1]}const H0e=RegExp(`^T?${s5.source}$`),q0e=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function W0e(t){const[e,i,r,n,s,o,a,u,d]=t,p=e[0]==="-",h=u&&u[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&p)?-y:y;return[{years:m(Rm(i)),months:m(Rm(r)),weeks:m(Rm(n)),days:m(Rm(s)),hours:m(Rm(o)),minutes:m(Rm(a)),seconds:m(Rm(u),u==="-0"),milliseconds:m(r5(d),h)}]}const Z0e={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function a5(t,e,i,r,n,s,o){const a={year:e.length===2?NR(Nh(e)):Nh(e),month:iX.indexOf(i)+1,day:Nh(r),hour:Nh(n),minute:Nh(s)};return o&&(a.second=Nh(o)),t&&(a.weekday=t.length>3?nX.indexOf(t)+1:sX.indexOf(t)+1),a}const J0e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Y0e(t){const[,e,i,r,n,s,o,a,u,d,p,h]=t,m=a5(e,n,r,i,s,o,a);let y;return u?y=Z0e[u]:d?y=0:y=ek(p,h),[m,new pr(y)]}function K0e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const X0e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Q0e=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ebe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function h6(t){const[,e,i,r,n,s,o,a]=t;return[a5(e,n,r,i,s,o,a),pr.utcInstance]}function tbe(t){const[,e,i,r,n,s,o,a]=t;return[a5(e,a,i,r,n,s,o),pr.utcInstance]}const ibe=c_(N0e,o5),rbe=c_(D0e,o5),nbe=c_(V0e,o5),sbe=c_(pX),mX=d_(B0e,h_,W$,Z$),obe=d_(U0e,h_,W$,Z$),abe=d_(j0e,h_,W$,Z$),lbe=d_(h_,W$,Z$);function ube(t){return p_(t,[ibe,mX],[rbe,obe],[nbe,abe],[sbe,lbe])}function cbe(t){return p_(K0e(t),[J0e,Y0e])}function dbe(t){return p_(t,[X0e,h6],[Q0e,h6],[ebe,tbe])}function pbe(t){return p_(t,[q0e,W0e])}const hbe=d_(h_);function mbe(t){return p_(t,[H0e,hbe])}const fbe=c_(G0e,z0e),ybe=c_(hX),gbe=d_(h_,W$,Z$);function vbe(t){return p_(t,[fbe,mX],[ybe,gbe])}const m6="Invalid Duration",fX={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},bbe={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...fX},ia=146097/400,bg=146097/4800,_be={years:{quarters:4,months:12,weeks:ia/7,days:ia,hours:ia*24,minutes:ia*24*60,seconds:ia*24*60*60,milliseconds:ia*24*60*60*1e3},quarters:{months:3,weeks:ia/28,days:ia/4,hours:ia*24/4,minutes:ia*24*60/4,seconds:ia*24*60*60/4,milliseconds:ia*24*60*60*1e3/4},months:{weeks:bg/7,days:bg,hours:bg*24,minutes:bg*24*60,seconds:bg*24*60*60,milliseconds:bg*24*60*60*1e3},...fX},my=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],wbe=my.slice(0).reverse();function Rp(t,e,i=!1){const r={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new wt(r)}function yX(t,e){let i=e.milliseconds??0;for(const r of wbe.slice(1))e[r]&&(i+=e[r]*t[r].milliseconds);return i}function f6(t,e){const i=yX(t,e)<0?-1:1;my.reduceRight((r,n)=>{if(Ge(e[n]))return r;if(r){const s=e[r]*i,o=t[n][r],a=Math.floor(s/o);e[n]+=a*i,e[r]-=a*o*i}return n},null),my.reduce((r,n)=>{if(Ge(e[n]))return r;if(r){const s=e[r]%1;e[r]-=s,e[n]+=s*t[r][n]}return n},null)}function Sbe(t){const e={};for(const[i,r]of Object.entries(t))r!==0&&(e[i]=r);return e}class wt{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let r=i?_be:bbe;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Ut.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,i){return wt.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Kn(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new wt({values:d2(e,wt.normalizeUnit),loc:Ut.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(sm(e))return wt.fromMillis(e);if(wt.isDuration(e))return e;if(typeof e=="object")return wt.fromObject(e);throw new Kn(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[r]=pbe(e);return r?wt.fromObject(r,i):wt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[r]=mbe(e);return r?wt.fromObject(r,i):wt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Kn("need to specify a reason the Duration is invalid");const r=e instanceof ru?e:new ru(e,i);if(ir.throwOnInvalid)throw new qve(r);return new wt({invalid:r})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new IK(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?ts.create(this.loc,r).formatDurationFromString(this,e):m6}toHuman(e={}){if(!this.isValid)return m6;const i=my.map(r=>{const n=this.values[r];return Ge(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=n5(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},se.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?yX(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=wt.fromDurationLike(e),r={};for(const n of my)(Ib(i.values,n)||Ib(this.values,n))&&(r[n]=i.get(n)+this.get(n));return Rp(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const i=wt.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=tX(e(this.values[r],r));return Rp(this,{values:i},!0)}get(e){return this[wt.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...d2(e,wt.normalizeUnit)};return Rp(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:r,matrix:n}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:n,conversionAccuracy:r};return Rp(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return f6(this.matrix,e),Rp(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=Sbe(this.normalize().shiftToAll().toObject());return Rp(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>wt.normalizeUnit(o));const i={},r={},n=this.toObject();let s;for(const o of my)if(e.indexOf(o)>=0){s=o;let a=0;for(const d in r)a+=this.matrix[d][o]*r[d],r[d]=0;sm(n[o])&&(a+=n[o]);const u=Math.trunc(a);i[o]=u,r[o]=(a*1e3-u*1e3)/1e3}else sm(n[o])&&(r[o]=n[o]);for(const o in r)r[o]!==0&&(i[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return f6(this.matrix,i),Rp(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Rp(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(const r of my)if(!i(this.values[r],e.values[r]))return!1;return!0}}const _g="Invalid Interval";function $be(t,e){return!t||!t.isValid?tr.invalid("missing or invalid start"):!e||!e.isValid?tr.invalid("missing or invalid end"):e<t?tr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class tr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Kn("need to specify a reason the Interval is invalid");const r=e instanceof ru?e:new ru(e,i);if(ir.throwOnInvalid)throw new Hve(r);return new tr({invalid:r})}static fromDateTimes(e,i){const r=V_(e),n=V_(i),s=$be(r,n);return s??new tr({start:r,end:n})}static after(e,i){const r=wt.fromDurationLike(i),n=V_(e);return tr.fromDateTimes(n,n.plus(r))}static before(e,i){const r=wt.fromDurationLike(i),n=V_(e);return tr.fromDateTimes(n.minus(r),n)}static fromISO(e,i){const[r,n]=(e||"").split("/",2);if(r&&n){let s,o;try{s=se.fromISO(r,i),o=s.isValid}catch{o=!1}let a,u;try{a=se.fromISO(n,i),u=a.isValid}catch{u=!1}if(o&&u)return tr.fromDateTimes(s,a);if(o){const d=wt.fromISO(n,i);if(d.isValid)return tr.after(s,d)}else if(u){const d=wt.fromISO(r,i);if(d.isValid)return tr.before(a,d)}}return tr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(e,i);let n;return i!=null&&i.useLocaleWeeks?n=this.end.reconfigure({locale:r.locale}):n=this.end,n=n.startOf(e,i),Math.floor(n.diff(r,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?tr.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(V_).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s:n}=this,s=0;for(;n<this.e;){const o=i[s]||this.e,a=+o>+this.e?this.e:o;r.push(tr.fromDateTimes(n,a)),n=a,s+=1}return r}splitBy(e){const i=wt.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,n=1,s;const o=[];for(;r<this.e;){const a=this.start.plus(i.mapUnits(u=>u*n));s=+a>+this.e?this.e:a,o.push(tr.fromDateTimes(r,s)),r=s,n+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return i>=r?null:tr.fromDateTimes(i,r)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return tr.fromDateTimes(i,r)}static merge(e){const[i,r]=e.sort((n,s)=>n.s-s.s).reduce(([n,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[n,s.union(o)]:[n.concat([s]),o]:[n,o],[[],null]);return r&&i.push(r),i}static xor(e){let i=null,r=0;const n=[],s=e.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((u,d)=>u.time-d.time);for(const u of a)r+=u.type==="s"?1:-1,r===1?i=u.time:(i&&+i!=+u.time&&n.push(tr.fromDateTimes(i,u.time)),i=null);return tr.merge(n)}difference(...e){return tr.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:_g}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=l2,i={}){return this.isValid?ts.create(this.s.loc.clone(i),e).formatInterval(this):_g}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:_g}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:_g}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:_g}toFormat(e,{separator:i=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:_g}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):wt.invalid(this.invalidReason)}mapEndpoints(e){return tr.fromDateTimes(e(this.s),e(this.e))}}class lT{static hasDST(e=ir.defaultZone){const i=se.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return co.isValidZone(e)}static normalizeZone(e){return Bh(e,ir.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||Ut.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||Ut.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||Ut.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||Ut.create(i,r,s)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||Ut.create(i,r,s)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||Ut.create(i,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||Ut.create(i,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Ut.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return Ut.create(i,null,"gregory").eras(e)}static features(){return{relative:XK(),localeWeek:QK()}}}function y6(t,e){const i=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(e)-i(t);return Math.floor(wt.fromMillis(r).as("days"))}function Ebe(t,e,i){const r=[["years",(u,d)=>d.year-u.year],["quarters",(u,d)=>d.quarter-u.quarter+(d.year-u.year)*4],["months",(u,d)=>d.month-u.month+(d.year-u.year)*12],["weeks",(u,d)=>{const p=y6(u,d);return(p-p%7)/7}],["days",y6]],n={},s=t;let o,a;for(const[u,d]of r)i.indexOf(u)>=0&&(o=u,n[u]=d(t,e),a=s.plus(n),a>e?(n[u]--,t=s.plus(n),t>e&&(a=t,n[u]--,t=s.plus(n))):t=a);return[t,n,a,o]}function Tbe(t,e,i,r){let[n,s,o,a]=Ebe(t,e,i);const u=e-n,d=i.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);d.length===0&&(o<e&&(o=n.plus({[a]:1})),o!==n&&(s[a]=(s[a]||0)+u/(o-n)));const p=wt.fromObject(s,r);return d.length>0?wt.fromMillis(u,r).shiftTo(...d).plus(p):p}const Ibe="missing Intl.DateTimeFormat.formatToParts support";function kt(t,e=i=>i){return{regex:t,deser:([i])=>e(f0e(i))}}const xbe=" ",gX=`[ ${xbe}]`,vX=new RegExp(gX,"g");function Mbe(t){return t.replace(/\./g,"\\.?").replace(vX,gX)}function g6(t){return t.replace(/\./g,"").replace(vX," ").toLowerCase()}function cl(t,e){return t===null?null:{regex:RegExp(t.map(Mbe).join("|")),deser:([i])=>t.findIndex(r=>g6(i)===g6(r))+e}}function v6(t,e){return{regex:t,deser:([,i,r])=>ek(i,r),groups:e}}function uT(t){return{regex:t,deser:([e])=>e}}function Cbe(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function kbe(t,e){const i=ul(e),r=ul(e,"{2}"),n=ul(e,"{3}"),s=ul(e,"{4}"),o=ul(e,"{6}"),a=ul(e,"{1,2}"),u=ul(e,"{1,3}"),d=ul(e,"{1,6}"),p=ul(e,"{1,9}"),h=ul(e,"{2,4}"),m=ul(e,"{4,6}"),y=_=>({regex:RegExp(Cbe(_.val)),deser:([w])=>w,literal:!0}),v=(_=>{if(t.literal)return y(_);switch(_.val){case"G":return cl(e.eras("short"),0);case"GG":return cl(e.eras("long"),0);case"y":return kt(d);case"yy":return kt(h,NR);case"yyyy":return kt(s);case"yyyyy":return kt(m);case"yyyyyy":return kt(o);case"M":return kt(a);case"MM":return kt(r);case"MMM":return cl(e.months("short",!0),1);case"MMMM":return cl(e.months("long",!0),1);case"L":return kt(a);case"LL":return kt(r);case"LLL":return cl(e.months("short",!1),1);case"LLLL":return cl(e.months("long",!1),1);case"d":return kt(a);case"dd":return kt(r);case"o":return kt(u);case"ooo":return kt(n);case"HH":return kt(r);case"H":return kt(a);case"hh":return kt(r);case"h":return kt(a);case"mm":return kt(r);case"m":return kt(a);case"q":return kt(a);case"qq":return kt(r);case"s":return kt(a);case"ss":return kt(r);case"S":return kt(u);case"SSS":return kt(n);case"u":return uT(p);case"uu":return uT(a);case"uuu":return kt(i);case"a":return cl(e.meridiems(),0);case"kkkk":return kt(s);case"kk":return kt(h,NR);case"W":return kt(a);case"WW":return kt(r);case"E":case"c":return kt(i);case"EEE":return cl(e.weekdays("short",!1),1);case"EEEE":return cl(e.weekdays("long",!1),1);case"ccc":return cl(e.weekdays("short",!0),1);case"cccc":return cl(e.weekdays("long",!0),1);case"Z":case"ZZ":return v6(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return v6(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return uT(/[a-z_+-/]{1,256}?/i);case" ":return uT(/[^\S\n\r]/);default:return y(_)}})(t)||{invalidReason:Ibe};return v.token=t,v}const Lbe={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Abe(t,e,i){const{type:r,value:n}=t;if(r==="literal"){const u=/^\s+$/.test(n);return{literal:!u,val:u?" ":n}}const s=e[r];let o=r;r==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=i.hour12?"hour12":"hour24");let a=Lbe[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function Obe(t){return[`^${t.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,t]}function Rbe(t,e,i){const r=t.match(e);if(r){const n={};let s=1;for(const o in i)if(Ib(i,o)){const a=i[o],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(n[a.token.val[0]]=a.deser(r.slice(s,s+u))),s+=u}return[r,n]}else return[r,{}]}function Pbe(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return Ge(t.z)||(i=co.create(t.z)),Ge(t.Z)||(i||(i=new pr(t.Z)),r=t.Z),Ge(t.q)||(t.M=(t.q-1)*3+1),Ge(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Ge(t.u)||(t.S=r5(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),i,r]}let FL=null;function Fbe(){return FL||(FL=se.fromMillis(1555555555555)),FL}function Nbe(t,e){if(t.literal)return t;const i=ts.macroTokenToFormatOpts(t.val),r=SX(i,e);return r==null||r.includes(void 0)?t:r}function bX(t,e){return Array.prototype.concat(...t.map(i=>Nbe(i,e)))}class _X{constructor(e,i){if(this.locale=e,this.format=i,this.tokens=bX(ts.parseFormat(i),e),this.units=this.tokens.map(r=>kbe(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,n]=Obe(this.units);this.regex=RegExp(r,"i"),this.handlers=n}}explainFromTokens(e){if(this.isValid){const[i,r]=Rbe(e,this.regex,this.handlers),[n,s,o]=r?Pbe(r):[null,null,void 0];if(Ib(r,"a")&&Ib(r,"H"))throw new _0("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:r,result:n,zone:s,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function wX(t,e,i){return new _X(t,i).explainFromTokens(e)}function Dbe(t,e,i){const{result:r,zone:n,specificOffset:s,invalidReason:o}=wX(t,e,i);return[r,n,s,o]}function SX(t,e){if(!t)return null;const r=ts.create(e,t).dtFormatter(Fbe()),n=r.formatToParts(),s=r.resolvedOptions();return n.map(o=>Abe(o,t,s))}const NL="Invalid DateTime",b6=864e13;function Fw(t){return new ru("unsupported zone",`the zone "${t.name}" is not supported`)}function DL(t){return t.weekData===null&&(t.weekData=u2(t.c)),t.weekData}function VL(t){return t.localWeekData===null&&(t.localWeekData=u2(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Pm(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new se({...i,...e,old:i})}function $X(t,e,i){let r=t-e*60*1e3;const n=i.offset(r);if(e===n)return[r,e];r-=(n-e)*60*1e3;const s=i.offset(r);return n===s?[r,n]:[t-Math.min(n,s)*60*1e3,Math.max(n,s)]}function cT(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function XI(t,e,i){return $X(QC(t),e,i)}function _6(t,e){const i=t.o,r=t.c.year+Math.trunc(e.years),n=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:r,month:n,day:Math.min(t.c.day,c2(r,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=wt.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=QC(s);let[u,d]=$X(a,i,t.zone);return o!==0&&(u+=o,d=t.zone.offset(u)),{ts:u,o:d}}function wg(t,e,i,r,n,s){const{setZone:o,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const u=e||a,d=se.fromObject(t,{...i,zone:u,specificOffset:s});return o?d:d.setZone(a)}else return se.invalid(new ru("unparsable",`the input "${n}" can't be parsed as ${r}`))}function dT(t,e,i=!0){return t.isValid?ts.create(Ut.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function UL(t,e){const i=t.c.year>9999||t.c.year<0;let r="";return i&&t.c.year>=0&&(r+="+"),r+=Er(t.c.year,i?6:4),e?(r+="-",r+=Er(t.c.month),r+="-",r+=Er(t.c.day)):(r+=Er(t.c.month),r+=Er(t.c.day)),r}function w6(t,e,i,r,n,s){let o=Er(t.c.hour);return e?(o+=":",o+=Er(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=":")):o+=Er(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=Er(t.c.second),(t.c.millisecond!==0||!r)&&(o+=".",o+=Er(t.c.millisecond,3))),n&&(t.isOffsetFixed&&t.offset===0&&!s?o+="Z":t.o<0?(o+="-",o+=Er(Math.trunc(-t.o/60)),o+=":",o+=Er(Math.trunc(-t.o%60))):(o+="+",o+=Er(Math.trunc(t.o/60)),o+=":",o+=Er(Math.trunc(t.o%60)))),s&&(o+="["+t.zone.ianaName+"]"),o}const EX={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Vbe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ube={ordinal:1,hour:0,minute:0,second:0,millisecond:0},TX=["year","month","day","hour","minute","second","millisecond"],jbe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Gbe=["year","ordinal","hour","minute","second","millisecond"];function zbe(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new IK(t);return e}function S6(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return zbe(t)}}function Bbe(t){return ex[t]||(QI===void 0&&(QI=ir.now()),ex[t]=t.offset(QI)),ex[t]}function $6(t,e){const i=Bh(e.zone,ir.defaultZone);if(!i.isValid)return se.invalid(Fw(i));const r=Ut.fromObject(e);let n,s;if(Ge(t.year))n=ir.now();else{for(const u of TX)Ge(t[u])&&(t[u]=EX[u]);const o=YK(t)||KK(t);if(o)return se.invalid(o);const a=Bbe(i);[n,s]=XI(t,a,i)}return new se({ts:n,zone:i,loc:r,o:s})}function E6(t,e,i){const r=Ge(i.round)?!0:i.round,n=(o,a)=>(o=n5(o,r||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(o,a)),s=o=>i.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(i.unit)return n(s(i.unit),i.unit);for(const o of i.units){const a=s(o);if(Math.abs(a)>=1)return n(a,o)}return n(t>e?-0:0,i.units[i.units.length-1])}function T6(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}let QI,ex={};class se{constructor(e){const i=e.zone||ir.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new ru("invalid input"):null)||(i.isValid?null:Fw(i));this.ts=Ge(e.ts)?ir.now():e.ts;let n=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[n,s]=[e.old.c,e.old.o];else{const a=sm(e.o)&&!e.old?e.o:i.offset(this.ts);n=cT(this.ts,a),r=Number.isNaN(n.year)?new ru("invalid input"):null,n=r?null:n,s=r?null:a}this._zone=i,this.loc=e.loc||Ut.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new se({})}static local(){const[e,i]=T6(arguments),[r,n,s,o,a,u,d]=i;return $6({year:r,month:n,day:s,hour:o,minute:a,second:u,millisecond:d},e)}static utc(){const[e,i]=T6(arguments),[r,n,s,o,a,u,d]=i;return e.zone=pr.utcInstance,$6({year:r,month:n,day:s,hour:o,minute:a,second:u,millisecond:d},e)}static fromJSDate(e,i={}){const r=_0e(e)?e.valueOf():NaN;if(Number.isNaN(r))return se.invalid("invalid input");const n=Bh(i.zone,ir.defaultZone);return n.isValid?new se({ts:r,zone:n,loc:Ut.fromObject(i)}):se.invalid(Fw(n))}static fromMillis(e,i={}){if(sm(e))return e<-b6||e>b6?se.invalid("Timestamp out of range"):new se({ts:e,zone:Bh(i.zone,ir.defaultZone),loc:Ut.fromObject(i)});throw new Kn(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(sm(e))return new se({ts:e*1e3,zone:Bh(i.zone,ir.defaultZone),loc:Ut.fromObject(i)});throw new Kn("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const r=Bh(i.zone,ir.defaultZone);if(!r.isValid)return se.invalid(Fw(r));const n=Ut.fromObject(i),s=d2(e,S6),{minDaysInFirstWeek:o,startOfWeek:a}=u6(s,n),u=ir.now(),d=Ge(i.specificOffset)?r.offset(u):i.specificOffset,p=!Ge(s.ordinal),h=!Ge(s.year),m=!Ge(s.month)||!Ge(s.day),y=h||m,g=s.weekYear||s.weekNumber;if((y||p)&&g)throw new _0("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&p)throw new _0("Can't mix ordinal dates with month/day");const v=g||s.weekday&&!y;let _,w,S=cT(u,d);v?(_=jbe,w=Vbe,S=u2(S,o,a)):p?(_=Gbe,w=Ube,S=PL(S)):(_=TX,w=EX);let E=!1;for(const V of _){const z=s[V];Ge(z)?E?s[V]=w[V]:s[V]=S[V]:E=!0}const T=v?g0e(s,o,a):p?v0e(s):YK(s),M=T||KK(s);if(M)return se.invalid(M);const x=v?a6(s,o,a):p?l6(s):s,[C,O]=XI(x,d,r),F=new se({ts:C,zone:r,o:O,loc:n});return s.weekday&&y&&e.weekday!==F.weekday?se.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${F.toISO()}`):F.isValid?F:se.invalid(F.invalid)}static fromISO(e,i={}){const[r,n]=ube(e);return wg(r,n,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[r,n]=cbe(e);return wg(r,n,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[r,n]=dbe(e);return wg(r,n,i,"HTTP",i)}static fromFormat(e,i,r={}){if(Ge(e)||Ge(i))throw new Kn("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:s=null}=r,o=Ut.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[a,u,d,p]=Dbe(o,e,i);return p?se.invalid(p):wg(a,u,r,`format ${i}`,e,d)}static fromString(e,i,r={}){return se.fromFormat(e,i,r)}static fromSQL(e,i={}){const[r,n]=vbe(e);return wg(r,n,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Kn("need to specify a reason the DateTime is invalid");const r=e instanceof ru?e:new ru(e,i);if(ir.throwOnInvalid)throw new Bve(r);return new se({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const r=SX(e,Ut.fromObject(i));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(e,i={}){return bX(ts.parseFormat(e),Ut.fromObject(i)).map(n=>n.val).join("")}static resetCache(){QI=void 0,ex={}}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?DL(this).weekYear:NaN}get weekNumber(){return this.isValid?DL(this).weekNumber:NaN}get weekday(){return this.isValid?DL(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?VL(this).weekday:NaN}get localWeekNumber(){return this.isValid?VL(this).weekNumber:NaN}get localWeekYear(){return this.isValid?VL(this).weekYear:NaN}get ordinal(){return this.isValid?PL(this.c).ordinal:NaN}get monthShort(){return this.isValid?lT.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?lT.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?lT.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?lT.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,r=QC(this.c),n=this.zone.offset(r-e),s=this.zone.offset(r+e),o=this.zone.offset(r-n*i),a=this.zone.offset(r-s*i);if(o===a)return[this];const u=r-o*i,d=r-a*i,p=cT(u,o),h=cT(d,a);return p.hour===h.hour&&p.minute===h.minute&&p.second===h.second&&p.millisecond===h.millisecond?[Pm(this,{ts:u}),Pm(this,{ts:d})]:[this]}get isInLeapYear(){return q$(this.year)}get daysInMonth(){return c2(this.year,this.month)}get daysInYear(){return this.isValid?D0(this.year):NaN}get weeksInWeekYear(){return this.isValid?XS(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?XS(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:r,calendar:n}=ts.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:n}}toUTC(e=0,i={}){return this.setZone(pr.instance(e),i)}toLocal(){return this.setZone(ir.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(e=Bh(e,ir.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(i||r){const s=e.offset(this.ts),o=this.toObject();[n]=XI(o,s,e)}return Pm(this,{ts:n,zone:e})}else return se.invalid(Fw(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:r}={}){const n=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:r});return Pm(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=d2(e,S6),{minDaysInFirstWeek:r,startOfWeek:n}=u6(i,this.loc),s=!Ge(i.weekYear)||!Ge(i.weekNumber)||!Ge(i.weekday),o=!Ge(i.ordinal),a=!Ge(i.year),u=!Ge(i.month)||!Ge(i.day),d=a||u,p=i.weekYear||i.weekNumber;if((d||o)&&p)throw new _0("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new _0("Can't mix ordinal dates with month/day");let h;s?h=a6({...u2(this.c,r,n),...i},r,n):Ge(i.ordinal)?(h={...this.toObject(),...i},Ge(i.day)&&(h.day=Math.min(c2(h.year,h.month),h.day))):h=l6({...PL(this.c),...i});const[m,y]=XI(h,this.o,this.zone);return Pm(this,{ts:m,o:y})}plus(e){if(!this.isValid)return this;const i=wt.fromDurationLike(e);return Pm(this,_6(this,i))}minus(e){if(!this.isValid)return this;const i=wt.fromDurationLike(e).negate();return Pm(this,_6(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},n=wt.normalizeUnit(e);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(n==="weeks")if(i){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(n==="quarters"){const s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?ts.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):NL}toLocaleString(e=l2,i={}){return this.isValid?ts.create(this.loc.clone(i),e).formatDateTime(this):NL}toLocaleParts(e={}){return this.isValid?ts.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=UL(this,o);return a+="T",a+=w6(this,o,i,r,n,s),a}toISODate({format:e="extended"}={}){return this.isValid?UL(this,e==="extended"):null}toISOWeekDate(){return dT(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+w6(this,o==="extended",i,e,r,s):null}toRFC2822(){return dT(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return dT(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?UL(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(i||e)&&(r&&(n+=" "),i?n+="z":e&&(n+="ZZ")),dT(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():NL}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",r={}){if(!this.isValid||!e.isValid)return wt.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=w0e(i).map(wt.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,u=o?e:this,d=Tbe(a,u,s,n);return o?d.negate():d}diffNow(e="milliseconds",i={}){return this.diff(se.now(),e,i)}until(e){return this.isValid?tr.fromDateTimes(this,e):this}hasSame(e,i,r){if(!this.isValid)return!1;const n=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(i,r)<=n&&n<=s.endOf(i,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||se.fromObject({},{zone:this.zone}),r=e.padding?this<i?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(n=e.unit,s=void 0),E6(i,this.plus(r),{...e,numeric:"always",units:n,unit:s})}toRelativeCalendar(e={}){return this.isValid?E6(e.base||se.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(se.isDateTime))throw new Kn("min requires all arguments be DateTimes");return c6(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(se.isDateTime))throw new Kn("max requires all arguments be DateTimes");return c6(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,r={}){const{locale:n=null,numberingSystem:s=null}=r,o=Ut.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});return wX(o,e,i)}static fromStringExplain(e,i,r={}){return se.fromFormatExplain(e,i,r)}static buildFormatParser(e,i={}){const{locale:r=null,numberingSystem:n=null}=i,s=Ut.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0});return new _X(s,e)}static fromFormatParser(e,i,r={}){if(Ge(e)||Ge(i))throw new Kn("fromFormatParser requires an input string and a format parser");const{locale:n=null,numberingSystem:s=null}=r,o=Ut.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});if(!o.equals(i.locale))throw new Kn(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${i.locale}`);const{result:a,zone:u,specificOffset:d,invalidReason:p}=i.explainFromTokens(e);return p?se.invalid(p):wg(a,u,r,`format ${i.format}`,e,d)}static get DATE_SHORT(){return l2}static get DATE_MED(){return xK}static get DATE_MED_WITH_WEEKDAY(){return Wve}static get DATE_FULL(){return MK}static get DATE_HUGE(){return CK}static get TIME_SIMPLE(){return kK}static get TIME_WITH_SECONDS(){return LK}static get TIME_WITH_SHORT_OFFSET(){return AK}static get TIME_WITH_LONG_OFFSET(){return OK}static get TIME_24_SIMPLE(){return RK}static get TIME_24_WITH_SECONDS(){return PK}static get TIME_24_WITH_SHORT_OFFSET(){return FK}static get TIME_24_WITH_LONG_OFFSET(){return NK}static get DATETIME_SHORT(){return DK}static get DATETIME_SHORT_WITH_SECONDS(){return VK}static get DATETIME_MED(){return UK}static get DATETIME_MED_WITH_SECONDS(){return jK}static get DATETIME_MED_WITH_WEEKDAY(){return Zve}static get DATETIME_FULL(){return GK}static get DATETIME_FULL_WITH_SECONDS(){return zK}static get DATETIME_HUGE(){return BK}static get DATETIME_HUGE_WITH_SECONDS(){return HK}}function V_(t){if(se.isDateTime(t))return t;if(t&&t.valueOf&&sm(t.valueOf()))return se.fromJSDate(t);if(t&&typeof t=="object")return se.fromObject(t);throw new Kn(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const Os="system",pp="unknown",po="UTC",Hbe=Intl.DateTimeFormat().resolvedOptions().timeZone,qbe="shortOffset";function Wbe(t){return"timeZoneIANA"in t}function Zbe(t){return t.startsWith("UTC")}function p2(t,e=!1){return{json:{read:{source:t,reader:(i,r)=>r[t]?tx(r[t]):null},write:!!e&&{allowNull:!0,writer(i,r){r[t]=i?Jbe(i):null}}}}}function tx(t,e=Os){return t?Wbe(t)?t.timeZoneIANA:Ybe(t,e):e}function Jbe(t){return{timeZoneIANA:t}}function Ybe(t,e=Os){if(!t||!JG.has(t.timeZone))return e;const i=JG.get(t.timeZone);return Zbe(t.timeZone)||t.respectsDaylightSaving?i:Kbe(i)}function Kbe(t){const e=se.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${pr.instance(-i).formatOffset(0,"narrow")}`}function IX(t,e,i,r,n){if(e&&n==="date")return{timeZone:po,timeZoneName:void 0};const s=r.timeStyle||r.hour,o=i===pp;return{timeZone:o?n==="timestamp-offset"?void 0:t??po:i,timeZoneName:o&&s?qbe:void 0}}function Xbe(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));return t===Os||t===pp||e.has(t.toLowerCase())||i.has(t.toLowerCase())}const Qbe={year:void 0,month:void 0,day:void 0,weekday:void 0},e_e={hour:void 0,minute:void 0,second:void 0},xX={timeZone:po},Eu={year:"numeric",month:"numeric",day:"numeric"},U_={year:"numeric",month:"long",day:"numeric"},j_={year:"numeric",month:"short",day:"numeric"},G_={year:"numeric",month:"long",weekday:"long",day:"numeric"},Dh={hour:"numeric",minute:"numeric"},tf={...Dh,second:"numeric"},MX={hourCycle:"h23"},z_={...Dh,...MX},B_={...tf,...MX},CX={"short-date":Eu,"short-date-short-time":{...Eu,...Dh},"short-date-short-time-24":{...Eu,...z_},"short-date-long-time":{...Eu,...tf},"short-date-long-time-24":{...Eu,...B_},"short-date-le":Eu,"short-date-le-short-time":{...Eu,...Dh},"short-date-le-short-time-24":{...Eu,...z_},"short-date-le-long-time":{...Eu,...tf},"short-date-le-long-time-24":{...Eu,...B_},"long-month-day-year":U_,"long-month-day-year-short-time":{...U_,...Dh},"long-month-day-year-short-time-24":{...U_,...z_},"long-month-day-year-long-time":{...U_,...tf},"long-month-day-year-long-time-24":{...U_,...B_},"day-short-month-year":j_,"day-short-month-year-short-time":{...j_,...Dh},"day-short-month-year-short-time-24":{...j_,...z_},"day-short-month-year-long-time":{...j_,...tf},"day-short-month-year-long-time-24":{...j_,...B_},"long-date":G_,"long-date-short-time":{...G_,...Dh},"long-date-short-time-24":{...G_,...z_},"long-date-long-time":{...G_,...tf},"long-date-long-time-24":{...G_,...B_},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Dh,"long-time":tf},t_e=Me()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),kX={ar:"ar-u-nu-latn-ca-gregory"};let DR=new WeakMap;const ik=CX["short-date-short-time"];function i_e(t){let e=DR.get(t);if(!e){const i=An(),r=kX[i]||i,n=l5(t.timeZone??Os),s={...t,timeZone:n};e=new Intl.DateTimeFormat(r,s),DR.set(t,e)}return e}function Ms(t){return CX[t]}function hr(t,e=ik){return i_e(e).format(t)}function LX(t,e=ik){return hr(new Date(t),{...e,...xX,...e_e})}function AX(t,e=ik){return hr(new Date(`1970-01-01T${t}Z`),{...e,...xX,...Qbe})}function OX(t,e=ik){if(e.timeZone)return hr(new Date(t),e);const i=se.fromISO(t,{setZone:!0}),r=An(),n=kX[r]??r,s=i.offset===0?po:e.timeZone,o={...e,timeZone:s};return i.toLocaleString(o,{locale:n})}function l5(t){switch(t){case Os:return Hbe;case pp:return po;default:return t}}RV(()=>{DR=new WeakMap});const VR={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function lS(t,e,i,r=Os){const n=new co(l5(r)),s=se.fromJSDate(t,{zone:n}),o=i==="decades"||i==="centuries"?"year":PX(i);return i==="decades"&&(e*=10),i==="centuries"&&(e*=100),s.plus({[o]:e}).toJSDate()}function SYe(t,e,i="milliseconds"){const r=t.getTime(),n=RX(e,i,"milliseconds");return new Date(r+n)}function UR(t,e,i=Os){const r=new co(l5(i)),n=se.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const o=n.startOf("year"),{year:a}=o,u=a-a%(e==="decades"?10:100);return o.set({year:u}).toJSDate()}const s=PX(e);return n.startOf(s).toJSDate()}function RX(t,e,i){return t===0?0:t*VR[e]/VR[i]}function r_e(t,e){return t&&e?t.intersection(e):t||e}function PX(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var da;let Po=da=class extends j{static get allTime(){return I6}static get empty(){return n_e}static fromArray(t){return new da({start:t[0]!=null?new Date(t[0]):t[0],end:t[1]!=null?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=(t==null?void 0:t.getTime())??null}get isAllTime(){return this.equals(da.allTime)}get isEmpty(){return this.equals(da.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=(t==null?void 0:t.getTime())??null}clone(){return new da({end:this.end,start:this.start})}equals(t){var s,o,a,u;if(!t)return!1;const e=((s=this.start)==null?void 0:s.getTime())??this.start,i=((o=this.end)==null?void 0:o.getTime())??this.end,r=((a=t.start)==null?void 0:a.getTime())??t.start,n=((u=t.end)==null?void 0:u.getTime())??t.end;return e===r&&i===n}expandTo(t,e=Os){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=UR(i,t,e));let r=this.end;if(r){const n=UR(r,t,e);r=r.getTime()===n.getTime()?n:lS(n,1,t,e)}return new da({start:i,end:r})}intersection(t){var a,u,d,p;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return da.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((a=this.start)==null?void 0:a.getTime())??-1/0,i=((u=this.end)==null?void 0:u.getTime())??1/0,r=((d=t.start)==null?void 0:d.getTime())??-1/0,n=((p=t.end)==null?void 0:p.getTime())??1/0;let s,o;return r>=e&&r<=i?s=r:e>=r&&e<=n&&(s=e),i>=r&&i<=n?o=i:n>=e&&n<=i&&(o=n),s==null||o==null||isNaN(s)||isNaN(o)?da.empty:new da({start:s===-1/0?null:new Date(s),end:o===1/0?null:new Date(o)})}offset(t,e,i=Os){if(this.isEmpty||this.isAllTime)return this.clone();const r=new da,{start:n,end:s}=this;return n!=null&&(r.start=lS(n,t,e,i)),s!=null&&(r.end=lS(s,t,e,i)),r}toArray(){var t,e;return this.isEmpty?[void 0,void 0]:[((t=this.start)==null?void 0:t.getTime())??null,((e=this.end)==null?void 0:e.getTime())??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return I6.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new da({start:e,end:i})}};l([c({type:Date,json:{write:{allowNull:!0}}})],Po.prototype,"end",void 0),l([X("end")],Po.prototype,"readEnd",null),l([te("end")],Po.prototype,"writeEnd",null),l([c({readOnly:!0,json:{read:!1}})],Po.prototype,"isAllTime",null),l([c({readOnly:!0,json:{read:!1}})],Po.prototype,"isEmpty",null),l([c({type:Date,json:{write:{allowNull:!0}}})],Po.prototype,"start",void 0),l([X("start")],Po.prototype,"readStart",null),l([te("start")],Po.prototype,"writeStart",null),Po=da=l([$("esri.time.TimeExtent")],Po);const Pt=Po,I6=new Po,n_e=new Po({start:void 0,end:void 0});let s_e=0,Ki=class extends ji.EventedMixin(vu(uo)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new at(-180,-90,180,90,le.WGS84),this.id=Date.now().toString(16)+"-layer-"+s_e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=le.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await k(async()=>{const{fromUrl:r}=await import("./arcgisLayers-Nhlf3lr2.js");return{fromUrl:r}},__vite__mapDeps([11,9,10]))).fromUrl(i)}static fromPortalItem(e){return zve(e)}initialize(){this.when().catch(e=>{rr(e)||U.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const e=this.parent;if(e){const i=this;"layers"in e&&e.layers.includes(i)?e.layers.remove(i):"tables"in e&&e.tables.includes(i)?e.tables.remove(i):"baseLayers"in e&&e.baseLayers.includes(i)?e.baseLayers.remove(i):"referenceLayers"in e&&e.referenceLayers.includes(i)&&e.referenceLayers.remove(i),this._set("parent",null)}}get effectiveVisible(){let e=this.visible;const i=this.parent;return e&&i&&"effectiveVisible"in i&&e&&(e=i.effectiveVisible),e}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return nr(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Ee(e,{query:{f:"json"},responseType:"json"})).data;throw new L("layer:no-attribution-data","Layer does not have attribution data")}};l([c({type:String})],Ki.prototype,"attributionDataUrl",void 0),l([c({readOnly:!0})],Ki.prototype,"effectiveVisible",null),l([c({type:at})],Ki.prototype,"fullExtent",void 0),l([c({readOnly:!0})],Ki.prototype,"hasAttributionData",null),l([c({type:String,clonable:!1})],Ki.prototype,"id",void 0),l([c({type:Boolean,nonNullable:!0})],Ki.prototype,"legendEnabled",void 0),l([c({type:["show","hide","hide-children"]})],Ki.prototype,"listMode",void 0),l([c({type:Number,range:{min:0,max:1},nonNullable:!0})],Ki.prototype,"opacity",void 0),l([c({clonable:!1})],Ki.prototype,"parent",void 0),l([c({readOnly:!0})],Ki.prototype,"parsedUrl",null),l([c({type:Boolean,readOnly:!0})],Ki.prototype,"persistenceEnabled",void 0),l([c({type:Boolean})],Ki.prototype,"popupEnabled",void 0),l([c({type:Boolean})],Ki.prototype,"attributionVisible",void 0),l([c({type:le})],Ki.prototype,"spatialReference",void 0),l([c({type:String})],Ki.prototype,"title",void 0),l([c({readOnly:!0,json:{read:!1}})],Ki.prototype,"type",void 0),l([c()],Ki.prototype,"url",void 0),l([c({type:Pt})],Ki.prototype,"visibilityTimeExtent",void 0),l([c({type:Boolean,nonNullable:!0})],Ki.prototype,"visible",void 0),Ki=l([$("esri.layers.Layer")],Ki);const u5=Ki;function jR(t,e,i){let r,n;if(t)for(let s=0,o=t.length;s<o;s++){if(r=t.at(s),(r==null?void 0:r[e])===i)return r;if((r==null?void 0:r.type)==="group"&&(n=jR(r.layers,e,i),n))return n}}const o_e=t=>{let e=class extends t{constructor(...i){super(...i),this.layers=new Y;const r=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},n=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||U.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},s=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>{if(o.item===this)return o.preventDefault(),void U.getLogger(this).error("#add()","Cannot add layer to itself.");r(o.item)}),this.layers.on("after-add",o=>n(o.item)),this.layers.on("after-remove",o=>s(o.item))])}destroy(){const i=this.layers.toArray();for(const r of i)r.destroy();this.layers.destroy()}set layers(i){this._set("layers",up(i,this._get("layers")))}add(i,r){const n=this.layers;if(r=n.getNextIndex(r),i instanceof u5){const s=i;s.parent===this?this.reorder(s,r):n.add(s,r)}else kc(i)?i.then(s=>{this.destroyed||this.add(s,r)}):U.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const n=this.layers;let s=n.getNextIndex(r);i.slice().forEach(o=>{o.parent!==this?(n.add(o,s),s+=1):this.reorder(o,s)})}findLayerById(i){return jR(this.layers,"id",i)}findLayerByUid(i){return jR(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return l([c()],e.prototype,"layers",null),e=l([$("esri.support.LayersMixin")],e),e};function GR(t,e,i){if(t)for(let r=0,n=t.length;r<n;r++){const s=t.at(r);if(s[e]===i)return s;if((s==null?void 0:s.type)==="group"){const o=GR(s.tables,e,i);if(o)return o}}}const a_e=t=>{let e=class extends t{constructor(...i){super(...i),this.tables=new Y,this.addHandles([this.tables.on("after-add",r=>{const n=r.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,n.type!=="feature"&&U.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",up(i,this._get("tables")))}findTableById(i){return GR(this.tables,"id",i)}findTableByUid(i){return GR(this.tables,"uid",i)}};return l([c()],e.prototype,"tables",null),e=l([$("esri.support.TablesMixin")],e),e};let _l=class extends a_e(o_e(ji.EventedMixin(q))){constructor(e){super(e),this.allLayers=new JS({getCollections:()=>{var i,r,n;return[(i=this.basemap)==null?void 0:i.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=ave(this),this.basemap=null,this.editableLayers=new JS({getCollections:()=>[this.allLayers],itemFilterFunction:YS}),this.ground=new ZS,this._basemapCache=Yge()}destroy(){ZY(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=xe(this.basemap),xe(this.ground),this._set("ground",null)}castBasemap(e){return JI(e,this._basemapCache)}castGround(e){return lve(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};l([c({readOnly:!0,dependsOn:[]})],_l.prototype,"allLayers",void 0),l([c({readOnly:!0})],_l.prototype,"allTables",void 0),l([c({type:sS,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],_l.prototype,"basemap",void 0),l([We("basemap")],_l.prototype,"castBasemap",null),l([c({readOnly:!0})],_l.prototype,"editableLayers",void 0),l([c({type:ZS,nonNullable:!0})],_l.prototype,"ground",void 0),l([We("ground")],_l.prototype,"castGround",null),l([c()],_l.prototype,"undoRedo",void 0),_l=l([$("esri.Map")],_l);const FX=_l,Ze=t=>{let e=class extends t{clone(){var u;const i=ao(this);$m(i,"unable to clone instance of non-accessor class");const r=i.metadata,n=i.store,s={},o=new Map;for(const d in r){const p=r[d],h=n==null?void 0:n.originOf(d),m=p.clonable;if(p.readOnly||m===!1||h!==Le.USER&&h!==Le.DEFAULTS&&h!==Le.WEB_MAP&&h!==Le.WEB_SCENE)continue;const y=this[d];let g=null;g=typeof m=="function"?m(y):m==="reference"?y:FO(y),y!=null&&g==null||(h===Le.DEFAULTS?o.set(d,g):s[d]=g)}const a=new(Object.getPrototypeOf(this)).constructor(s);if(o.size){const d=(u=ao(a))==null?void 0:u.store;if(d)for(const[p,h]of o)d.set(p,h,Le.DEFAULTS)}return a}};return e=l([$("esri.core.Clonable")],e),e};let zR=class extends Ze(q){};zR=l([$("esri.core.Clonable")],zR);let rf=class extends zR{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};l([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],rf.prototype,"row",void 0),l([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],rf.prototype,"column",void 0),l([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],rf.prototype,"rows",void 0),l([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],rf.prototype,"columns",void 0),rf=l([$("esri.CameraLayout")],rf);const NX=rf;let rk=class{constructor(e,i){this.min=e,this.max=i,this.range=i-e}normalize(e,i=0,r=!1){return x6(this.range,this.min,this.max,e,i,r)}clamp(e,i=0){return fr(e-i,this.min,this.max)+i}monotonic(e,i,r){return e<i?i:i+BR(this.range,e-i,r)}minimalMonotonic(e,i,r){return x6(this.range,e,e+this.range,i,r)}center(e,i,r){return i=this.monotonic(e,i,r),this.normalize((e+i)/2,r)}diff(e,i,r){return this.monotonic(e,i,r)-e}shortestSignedDiff(e,i){e=this.normalize(e);const r=(i=this.normalize(i))-e,n=i<e?this.minimalMonotonic(e,i)-e:i-this.minimalMonotonic(i,e);return Math.abs(r)<Math.abs(n)?r:n}contains(e,i,r){return i=this.minimalMonotonic(e,i),(r=this.minimalMonotonic(e,r))>e&&r<i}};function x6(t,e,i,r,n=0,s=!1){return(r-=n)<e?r+=BR(t,e-r):r>i&&(r-=BR(t,r-i)),s&&r===i&&(r=e),r+n}function BR(t,e,i=0){return Math.ceil((e-i)/t)*t+i}const MYe=new rk(0,2*Math.PI),CYe=new rk(-Math.PI,Math.PI),c5=new rk(0,360);let Lu=class extends Ze(j){constructor(...e){super(...e),this.position=new we([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new NX}normalizeCtorArgs(e,i,r,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return i!=null&&(s.heading=i),r!=null&&(s.tilt=r),n!=null&&(s.fov=n),s}return e}writePosition(e,i,r,n){const s=e.clone();s.x=xs(e.x||0),s.y=xs(e.y||0),s.z=e.hasZ?xs(e.z||0):e.z,i[r]=s.write({},n)}readPosition(e,i){const r=new we;return r.read(e,i),r.x=xs(r.x||0),r.y=xs(r.y||0),r.z=r.hasZ?xs(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};l([c({type:we,json:{write:{isRequired:!0}}})],Lu.prototype,"position",void 0),l([te("position")],Lu.prototype,"writePosition",null),l([X("position")],Lu.prototype,"readPosition",null),l([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),We(t=>c5.normalize(xs(t)))],Lu.prototype,"heading",void 0),l([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),We(t=>fr(xs(t),-180,180))],Lu.prototype,"tilt",void 0),l([c({type:Number,nonNullable:!0,json:{default:55,write:!0}}),We(t=>fr(xs(t,55),1,170))],Lu.prototype,"fov",void 0),l([c({type:NX,nonNullable:!0,json:{read:!1,write:!1}})],Lu.prototype,"layout",void 0),Lu=l([$("esri.Camera")],Lu);const l_e=Lu;var HR;let Zp=HR=class extends j{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new HR({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};l([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:jL}}}}})],Zp.prototype,"rotation",void 0),l([We("rotation")],Zp.prototype,"castRotation",null),l([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:jL}}}}})],Zp.prototype,"scale",void 0),l([c({types:rg,json:{read:dp,write:!0,origins:{"web-scene":{read:dp,write:{overridePolicy:jL}}}}})],Zp.prototype,"targetGeometry",void 0),l([c({type:l_e,json:{write:!0}})],Zp.prototype,"camera",void 0),Zp=HR=l([$("esri.Viewpoint")],Zp);const Ar=Zp;function jL(){return{enabled:!this.camera}}let u_e=class DX{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(DO),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new DX,r=this._originStores[Le.DEFAULTS];r&&r.forEach((n,s)=>{i.set(s,R(n),Le.DEFAULTS)});for(let n=Le.SERVICE;n<DO;n++){const s=this._originStores[n];s&&s.forEach((o,a)=>{e&&e.has(a)||i.set(a,R(o),n)})}return i}get(e,i){const r=i===void 0?this._values:this._originStores[i];return r?r.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,r=Le.USER){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,i),!this._values.has(e)||this._propertyOriginMap.get(e)<=r){const s=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,r),s!==i}return!1}delete(e,i=Le.USER){const r=this._originStores[i];if(!r)return;const n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let s=i-1;s>=0;s--){const o=this._originStores[s];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,s);break}}}return n}has(e,i){const r=i===void 0?this._values:this._originStores[i];return!!r&&r.has(e)}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const r=this._originStores[i],n=r==null?void 0:r.get(e),s=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,i),s!==n}originOf(e){return this._propertyOriginMap.get(e)||Le.DEFAULTS}forEach(e){this._values.forEach(e)}};const VX=t=>{let e=class extends t{constructor(...i){super(...i);const r=ao(this),n=r.store,s=new u_e;r.store=s,cJ(r,n,s)}read(i,r){pJ(this,i,r)}getAtOrigin(i,r){const n=GL(this),s=qh(r);if(typeof i=="string")return n.get(i,s);const o={};return i.forEach(a=>{o[a]=n.get(a,s)}),o}originOf(i){return RM(this.originIdOf(i))}originIdOf(i){return GL(this).originOf(i)}revert(i,r){const n=GL(this),s=qh(r),o=ao(this);let a;a=typeof i=="string"?i==="*"?n.keys(s):[i]:i,a.forEach(u=>{o.invalidate(u),n.revert(u,s),o.commit(u)})}};return e=l([$("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function GL(t){return ao(t).store}let M6=class extends VX(q){};M6=l([$("esri.core.ReadOnlyMultiOriginJSONSupport")],M6);const c_e=t=>{let e=class extends t{constructor(...i){super(...i)}clear(i,r="user"){return zL(this).delete(i,qh(r))}write(i,r){return fJ(this,i=i||{},r),i}setAtOrigin(i,r,n){ao(this).setAtOrigin(i,r,qh(n))}removeOrigin(i){const r=zL(this),n=qh(i),s=r.keys(n);for(const o of s)r.originOf(o)===n&&r.set(o,r.get(o,n),Le.USER)}updateOrigin(i,r){const n=zL(this),s=qh(r),o=rs(this,i);for(let a=s+1;a<DO;++a)n.delete(i,a);n.set(i,o,s)}toJSON(i){return this.write({},i)}};return e=l([$("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function zL(t){return ao(t).store}const nk=t=>{let e=class extends c_e(VX(t)){constructor(...i){super(...i)}};return e=l([$("esri.core.MultiOriginJSONSupport")],e),e};let qR=class extends nk(q){};qR=l([$("esri.core.MultiOriginJSONSupport")],qR);const Ts=Math.PI/180,d_e=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,Pp=Wi.radius,dl=Wi.eccentricitySquared,p_e={a1:Pp*dl,a2:Pp*dl*Pp*dl,a3:Pp*dl*dl/2,a4:Pp*dl*Pp*dl*2.5,a5:Pp*dl+Pp*dl*dl/2,a6:1-dl},h_e={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Wi.radius,f:Wi.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:pm.radius,f:pm.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:_c.radius,f:_c.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:_c.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var D;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"})(D||(D={}));const Nw={[D.WGS84]:{[D.CGCS2000]:xi,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:xi,[D.SPHERICAL_ECEF]:cS,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:U0,[D.PLATE_CARREE]:j0,[D.WGS84]:xi,[D.WGS84_ECEF]:B0},[D.CGCS2000]:{[D.CGCS2000]:xi,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:xi,[D.SPHERICAL_ECEF]:cS,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:U0,[D.PLATE_CARREE]:j0,[D.WGS84]:xi,[D.WGS84_ECEF]:B0},[D.GCSMARS2000]:{[D.CGCS2000]:null,[D.GCSMARS2000]:xi,[D.GCSMOON2000]:null,[D.LON_LAT]:xi,[D.SPHERICAL_ECEF]:null,[D.SPHERICAL_MARS_PCPF]:k6,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:null,[D.PLATE_CARREE]:null,[D.WGS84]:null,[D.WGS84_ECEF]:null},[D.GCSMOON2000]:{[D.CGCS2000]:null,[D.GCSMARS2000]:null,[D.GCSMOON2000]:xi,[D.LON_LAT]:xi,[D.SPHERICAL_ECEF]:null,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:C6,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:null,[D.PLATE_CARREE]:null,[D.WGS84]:null,[D.WGS84_ECEF]:null},[D.WEB_MERCATOR]:{[D.CGCS2000]:uS,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:uS,[D.SPHERICAL_ECEF]:m_e,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:xi,[D.PLATE_CARREE]:g_e,[D.WGS84]:uS,[D.WGS84_ECEF]:f_e},[D.WGS84_ECEF]:{[D.CGCS2000]:H0,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:H0,[D.SPHERICAL_ECEF]:I_e,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:x_e,[D.PLATE_CARREE]:v_e,[D.WGS84]:H0,[D.WGS84_ECEF]:xi},[D.SPHERICAL_ECEF]:{[D.CGCS2000]:z0,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:z0,[D.SPHERICAL_ECEF]:xi,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:$_e,[D.PLATE_CARREE]:b_e,[D.WGS84]:z0,[D.WGS84_ECEF]:E_e},[D.SPHERICAL_MARS_PCPF]:{[D.CGCS2000]:null,[D.GCSMARS2000]:A6,[D.GCSMOON2000]:null,[D.LON_LAT]:A6,[D.SPHERICAL_ECEF]:null,[D.SPHERICAL_MARS_PCPF]:xi,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:null,[D.PLATE_CARREE]:null,[D.WGS84]:null,[D.WGS84_ECEF]:null},[D.SPHERICAL_MOON_PCPF]:{[D.CGCS2000]:null,[D.GCSMARS2000]:null,[D.GCSMOON2000]:L6,[D.LON_LAT]:L6,[D.SPHERICAL_ECEF]:null,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:xi,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:null,[D.PLATE_CARREE]:null,[D.WGS84]:null,[D.WGS84_ECEF]:null},[D.UNKNOWN]:{[D.CGCS2000]:null,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:null,[D.SPHERICAL_ECEF]:null,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:xi,[D.WEB_MERCATOR]:null,[D.PLATE_CARREE]:null,[D.WGS84]:null,[D.WGS84_ECEF]:null},[D.LON_LAT]:{[D.CGCS2000]:xi,[D.GCSMARS2000]:xi,[D.GCSMOON2000]:xi,[D.LON_LAT]:xi,[D.SPHERICAL_ECEF]:cS,[D.SPHERICAL_MARS_PCPF]:k6,[D.SPHERICAL_MOON_PCPF]:C6,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:U0,[D.PLATE_CARREE]:j0,[D.WGS84]:xi,[D.WGS84_ECEF]:B0},[D.PLATE_CARREE]:{[D.CGCS2000]:G0,[D.GCSMARS2000]:null,[D.GCSMOON2000]:null,[D.LON_LAT]:G0,[D.SPHERICAL_ECEF]:__e,[D.SPHERICAL_MARS_PCPF]:null,[D.SPHERICAL_MOON_PCPF]:null,[D.UNKNOWN]:null,[D.WEB_MERCATOR]:w_e,[D.PLATE_CARREE]:xi,[D.WGS84]:G0,[D.WGS84_ECEF]:S_e}};function sk(t,e,i=UX()){return t==null||e==null?null:M_e(t,e,i).projector}function h2(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Ci(t,1)),r2(t)?e.spatialReferenceId=D.SPHERICAL_ECEF:hm(t)?e.spatialReferenceId=D.WGS84:el(t)?e.spatialReferenceId=D.WEB_MERCATOR:mR(t)?e.spatialReferenceId=D.PLATE_CARREE:t.wkt===qJ.wkt?e.spatialReferenceId=D.WGS84_ECEF:t.wkid===Ry.CGCS2000?e.spatialReferenceId=D.CGCS2000:t.wkt===NC.wkt?e.spatialReferenceId=D.SPHERICAL_MARS_PCPF:t.wkt===DC.wkt?e.spatialReferenceId=D.SPHERICAL_MOON_PCPF:jJ(t)?e.spatialReferenceId=D.GCSMARS2000:GJ(t)?e.spatialReferenceId=D.GCSMOON2000:e.spatialReferenceId=D.UNKNOWN):D.UNKNOWN}function xi(t,e,i,r){t!==i&&(i[r++]=t[e++],i[r++]=t[e++],i[r]=t[e])}function uS(t,e,i,r){i[r]=Mb*(t[e]/$y),i[r+1]=Mb*(GX-2*Math.atan(Math.exp(-t[e+1]/$y))),i[r+2]=t[e+2]}function m_e(t,e,i,r){const n=t[e]/$y,s=GX-2*Math.atan(Math.exp(-t[e+1]/$y)),o=$y+t[e+2],a=Math.cos(s)*o;i[r]=Math.cos(n)*a,i[r+1]=Math.sin(n)*a,i[r+2]=Math.sin(s)*o}function f_e(t,e,i,r){uS(t,e,i,r),B0(i,r,i,r)}function y_e(t,e,i,r,n){const s=.4999999*ok,o=fr(xb*t[e+1],-s,s),a=Math.sin(o);i[r++]=xb*t[e]*n.radius,i[r++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[r]=t[e+2]}function U0(t,e,i,r){y_e(t,e,i,r,Wi)}function j0(t,e,i,r){i[r]=t[e]*O6,i[r+1]=t[e+1]*O6,i[r+2]=t[e+2]}function G0(t,e,i,r){i[r]=t[e]*R6,i[r+1]=t[e+1]*R6,i[r+2]=t[e+2]}function g_e(t,e,i,r){uS(t,e,i,r),j0(i,r,i,r)}function v_e(t,e,i,r){H0(t,e,i,r),j0(i,r,i,r)}function b_e(t,e,i,r){z0(t,e,i,r),j0(i,r,i,r)}function __e(t,e,i,r){G0(t,e,i,r),cS(i,r,i,r)}function w_e(t,e,i,r){G0(t,e,i,r),U0(i,r,i,r)}function S_e(t,e,i,r){G0(t,e,i,r),B0(i,r,i,r)}function d5(t,e,i,r,n){const s=n+t[e+2],o=xb*t[e+1],a=xb*t[e],u=Math.cos(o)*s;i[r]=Math.cos(a)*u,i[r+1]=Math.sin(a)*u,i[r+2]=Math.sin(o)*s}function C6(t,e,i,r){d5(t,e,i,r,pm.radius)}function k6(t,e,i,r){d5(t,e,i,r,_c.radius)}function cS(t,e,i,r){d5(t,e,i,r,Wi.radius)}function p5(t,e,i,r,n){const s=t[e],o=t[e+1],a=t[e+2],u=Math.sqrt(s*s+o*o+a*a),d=jV(a/(u===0?1:u)),p=Math.atan2(o,s);i[r++]=Mb*p,i[r++]=Mb*d,i[r]=u-n}function L6(t,e,i,r){p5(t,e,i,r,pm.radius)}function A6(t,e,i,r){p5(t,e,i,r,_c.radius)}function z0(t,e,i,r){p5(t,e,i,r,Wi.radius)}function $_e(t,e,i,r){z0(t,e,i,r),U0(i,r,i,r)}function E_e(t,e,i,r){z0(t,e,i,r),B0(i,r,i,r)}function T_e(t,e,i,r,n){const s=xb*t[e],o=xb*t[e+1],a=t[e+2],u=Math.sin(o),d=Math.cos(o),p=n.radius/Math.sqrt(1-n.eccentricitySquared*u*u);i[r++]=(p+a)*d*Math.cos(s),i[r++]=(p+a)*d*Math.sin(s),i[r++]=(p*(1-n.eccentricitySquared)+a)*u}function B0(t,e,i,r){T_e(t,e,i,r,Wi)}function H0(t,e,i,r){const n=p_e,s=t[e],o=t[e+1],a=t[e+2];let u,d,p,h,m,y,g,v,_,w,S,E,T,M,x,C,O,F,V,z,H;u=Math.abs(a),d=s*s+o*o,p=Math.sqrt(d),h=d+a*a,m=Math.sqrt(h),z=Math.atan2(o,s),y=a*a/h,g=d/h,M=n.a2/m,x=n.a3-n.a4/m,g>.3?(v=u/m*(1+g*(n.a1+M+y*x)/m),V=Math.asin(v),w=v*v,_=Math.sqrt(1-w)):(_=p/m*(1-y*(n.a5-M-g*x)/m),V=Math.acos(_),w=1-_*_,v=Math.sqrt(w)),S=1-Wi.eccentricitySquared*w,E=Wi.radius/Math.sqrt(S),T=n.a6*E,M=p-E*_,x=u-T*v,O=_*M+v*x,C=_*x-v*M,F=C/(T/S+O),V+=F,H=O+C*F/2,a<0&&(V=-V),i[r++]=Mb*z,i[r++]=Mb*V,i[r]=H}function I_e(t,e,i,r){H0(t,e,i,r),cS(i,r,i,r)}function x_e(t,e,i,r){H0(t,e,i,r),U0(i,r,i,r)}function M_e(t,e,i){if(t==null||e==null||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const r=h2(t,i.source),n=h2(e,i.dest);return r===D.UNKNOWN&&n===D.UNKNOWN?ci(t,e)?i.projector=xi:i.projector=null:i.projector=Nw[r][n],i}function UX(){return{source:{spatialReference:null,spatialReferenceId:D.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:D.UNKNOWN,metersPerUnit:1},projector:xi}}const C_e={spatialReference:null,spatialReferenceId:D.UNKNOWN},k_e={spatialReference:null,spatialReferenceId:D.UNKNOWN},jX=UX(),xb=G$(1),Mb=vY(1),ok=Math.PI,GX=.5*ok,$y=Wi.radius,O6=$y*ok/180,R6=180/($y*ok);function Lc(t,e,i,r,n,s,o=Math.floor(t.length/3)){const a=sk(e,n,jX);if(a==null)return!1;if(a===xi){if(t===r&&i===s)return!0;const d=i+3*o;for(let p=i,h=s;p<d;p++,h++)r[h]=t[p];return!0}const u=i+3*o;for(let d=i,p=s;d<u;d+=3,p+=3)a(t,d,r,p);return!0}const OYe=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:Lc},Symbol.toStringTag,{value:"Module"}));function P6(t,e,i,r,n,s){return pT[0]=t,pT[1]=e,pT[2]=i,Lc(pT,r,0,n,s,0)}const pT=W();let hT=0,BL=class WR{static fromGE(e){const i=new WR;return i._wkt=e.wkt,i._wkid=e.wkid,i._isInverse=e.isInverse,i}constructor(e){this.uid=hT++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=hT++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=hT++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=hT++}getInverse(){const e=new WR;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},m2=class Dw{static cacheKey(e,i){var r,n,s,o,a,u;return[((r=e.wkid)==null?void 0:r.toString())??"-1",((n=e.wkt)==null?void 0:n.toString())??"",((s=e.wkt2)==null?void 0:s.toString())??"",((o=i.wkid)==null?void 0:o.toString())??"-1",((a=i.wkt)==null?void 0:a.toString())??"",((u=i.wkt2)==null?void 0:u.toString())??""].join()}static fromGE(e){const i=new Dw;let r="";for(const n of e.steps){const s=BL.fromGE(n);i.steps.push(s),r+=s.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e==null?void 0:e.steps)for(const i of e.steps)i instanceof BL?this.steps.push(i):this.steps.push(new BL({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const e=new Dw;e.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];e.steps.push(r.getInverse())}return e}getGTListEntry(){let e="";for(const i of this.steps)e+=i.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,i,r){this._cachedProjection[Dw.cacheKey(e,i)]=r}getCachedGeTransformation(e,i){let r="";for(const s of this.steps)r+=s.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const n=this._cachedProjection[Dw.cacheKey(e,i)];return n===void 0?null:n}};function zX(t,e,i){if(e==null||i==null||i.vcsWkid||ci(e,i)||mm(e)||mm(i))return null;const r=fu(e)/fu(i);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return n=>L_e(n,r);case"polyline":case"esriGeometryPolyline":return n=>O_e(n,r);case"polygon":case"esriGeometryPolygon":return n=>A_e(n,r);case"multipoint":case"esriGeometryMultipoint":return n=>R_e(n,r);case"extent":case"esriGeometryEnvelope":return n=>P_e(n,r);default:return null}}function L_e(t,e){(t==null?void 0:t.z)!=null&&(t.z*=e)}function A_e(t,e){if(t)for(const i of t.rings)for(const r of i)r.length>2&&(r[2]*=e)}function O_e(t,e){if(t)for(const i of t.paths)for(const r of i)r.length>2&&(r[2]*=e)}function R_e(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function P_e(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let cu=null,ym=null,dS=null,ix={};const h5=new a_;function Ac(){return!!cu&&FC()}function BX(){return!!Ac()||(he(h5),$c(),!1)}function HX(t,e){return!t||!e||Yo(t,e)||BX()}function F_e(t,e){return!Yo(t,e)&&!Ac()}function $c(t){return dS==null&&(dS=Promise.all([IV(),k(()=>import("./geometryEngineBase-yFIvKOkM.js"),__vite__mapDeps([12,1])).then(e=>e.g),k(()=>import("./hydrated-9-RWfdv1.js"),[])])),dS.then(([,e,{hydratedAdapter:i}])=>{qe(t),ym=i,cu=e.default,cu._enableProjection(Yme),h5.notify()})}function On(t,e,i=null,r=null){return Array.isArray(t)?t.length===0?[]:ZR(ym,t,t[0].spatialReference,e,i,r):ZR(ym,[t],t.spatialReference,e,i,r)[0]}function ZR(t,e,i,r,n=null,s=null){if(i==null||r==null)return e;if(Yo(i,r,n))return e.map(o=>rx(o,i,r));if(n==null&&r2(i))return e.map(o=>rx(o,i,le.WGS84)).map(o=>Cb(o,r));if(n==null&&r2(r))return e.map(o=>Cb(o,le.WGS84)).map(o=>rx(o,le.WGS84,r));if(n==null){const o=m2.cacheKey(i,r);ix[o]!==void 0?n=ix[o]:((n=ZX(i,r,void 0))==null&&(n=new m2),ix[o]=n)}if(cu==null||t==null)throw new ak;return s!=null?cu._project(t,e,i,r,n,s):cu._project(t,e,i,r,n)}function qX(t,e){const i=WX([t],e);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function WX(t,e){if(!Ac()){for(const i of t)if(i!=null&&!ci(i.spatialReference,e)&&Cs(i.spatialReference)&&Cs(e)&&!Yo(i.spatialReference,e))return he(h5),{pending:$c(),geometries:null}}return{pending:null,geometries:t.map(i=>i==null?null:ci(i.spatialReference,e)?i:Cs(i.spatialReference)&&Cs(e)?Cb(i,e):null)}}function ZX(t,e,i=null){if(t==null||e==null)return null;if(cu==null||ym==null)throw new ak;const r=cu._getTransformation(ym,t,e,i,i==null?void 0:i.spatialReference);return r!==null?m2.fromGE(r):null}function N_e(t,e,i=null){if(cu==null||ym==null)throw new ak;const r=cu._getTransformationBySuitability(ym,t,e,i,i==null?void 0:i.spatialReference);if(r!==null){const n=[];for(const s of r)n.push(m2.fromGE(s));return n}return[]}let ak=class extends L{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function D_e(){cu=null,ym=null,dS=null,ix={}}const V_e={get loadPromise(){return dS}};function Cb(t,e){try{const i=On(t,e);if(i==null)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const r=zX(i.type,t.spatialReference,e);return r!=null&&r(i),i}catch(i){if(!(i instanceof ak))throw i;return null}}async function U_e(t,e,i){const r=t.spatialReference;return r!=null&&e!=null&&await Ec(r,e,null,i),Cb(t,e)}function Yo(t,e,i){return!i&&(!!ci(t,e)||Cs(t)&&Cs(e)&&!!sk(t,e,jX))}function j_e(t,e){if(ci(t,e))return!0;if(!Cs(t)||!Cs(e))return!1;const i=hm(t)||el(t)||_G(t),r=hm(e)||el(e)||_G(e);return i&&r}async function Ec(t,e,i,r){if(Ac())return Kj(r);if(Array.isArray(t)){for(const{source:n,dest:s,geographicTransformation:o}of t)if(n&&s&&!Yo(n,s,o))return $c(r)}else if(t&&e&&!Yo(t,e,i))return $c(r);return Kj(r)}function rx(t,e,i){return t?"x"in t?JX(t,e,new we,i,0):"xmin"in t?QX(t,e,new at,i,0):"rings"in t?XX(t,e,new os,i,0):"paths"in t?KX(t,e,new hn,i,0):"points"in t?YX(t,e,new ep,i,0):null:null}function G_e(t,e,i=e.spatialReference,r=0){return i!=null&&t.spatialReference!=null&&JX(t,t.spatialReference,e,i,r)!=null}function JX(t,e,i,r,n){Xn[0]=t.x,Xn[1]=t.y;const s=t.z;return Xn[2]=s!==void 0?s:n,Lc(Xn,e,0,Xn,r,0)?(i.x=Xn[0],i.y=Xn[1],i.spatialReference=r,s!==void 0||mm(r)?(i.z=Xn[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),t.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function z_e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&YX(t,t.spatialReference,e,i,r)!=null}function YX(t,e,i,r,n){const{points:s,hasZ:o,hasM:a}=t,u=[],d=s.length,p=[];for(const m of s)p.push(m[0],m[1],o?m[2]:n);if(!Lc(p,e,0,p,r,0,d))return null;const h=o||mm(r);for(let m=0;m<d;++m){const y=3*m,g=p[y],v=p[y+1];h&&a?u.push([g,v,p[y+2],s[m][3]]):h?u.push([g,v,p[y+2]]):a?u.push([g,v,s[m][2]]):u.push([g,v])}return i.points=u,i.spatialReference=r,i.hasZ=o,i.hasM=a,i}function B_e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&KX(t,t.spatialReference,e,i,r)!=null}function KX(t,e,i,r,n){const{paths:s,hasZ:o,hasM:a}=t,u=[];if(!eQ(s,o??!1,a??!1,e,u,r,n))return null;const d=o||mm(r);return i.paths=u,i.spatialReference=r,i.hasZ=d,i.hasM=a,i}function H_e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&XX(t,t.spatialReference,e,i,r)!=null}function XX(t,e,i,r,n){const{rings:s,hasZ:o,hasM:a}=t,u=[];if(!eQ(s,o??!1,a??!1,e,u,r,n))return null;const d=o||mm(r);return i.rings=u,i.spatialReference=r,i.hasZ=d,i.hasM=a,i}function q_e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&QX(t,t.spatialReference,e,i,r)!=null}function QX(t,e,i,r,n){const{xmin:s,ymin:o,xmax:a,ymax:u,hasZ:d,hasM:p}=t,h=d?t.zmin:n;if(!P6(s,o,h,e,Xn,r))return null;const m=d||mm(r);i.xmin=Xn[0],i.ymin=Xn[1],m&&(i.zmin=Xn[2]);const y=d?t.zmax:n;return P6(a,u,y,e,Xn,r)?(i.xmax=Xn[0],i.ymax=Xn[1],m&&(i.zmax=Xn[2]),p&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=r,i):null}function eQ(t,e,i,r,n,s,o=0){const a=new Array;for(const p of t)for(const h of p)a.push(h[0],h[1],e?h[2]:o);if(!Lc(a,r,0,a,s,0))return!1;let u=0;n.length=0;const d=e||mm(s);for(const p of t){const h=new Array;for(const m of p)d&&i?h.push([a[u++],a[u++],a[u++],m[3]]):d?h.push([a[u++],a[u++],a[u++]]):i?(h.push([a[u++],a[u++],m[2]]),u++):(h.push([a[u++],a[u++]]),u++);n.push(h)}return!0}const Xn=W(),PYe=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:Yo,getTransformation:ZX,getTransformations:N_e,initializeProjection:Ec,isEqualBaseGCS:j_e,isLoaded:Ac,isLoadedOrLoad:BX,isLoadedOrLoadFor:HX,load:$c,project:On,projectExtent:q_e,projectMany:ZR,projectMultipoint:z_e,projectOrLoad:qX,projectOrLoadMany:WX,projectPoint:G_e,projectPolygon:H_e,projectPolyline:B_e,projectWithZConversion:U_e,projectWithoutEngine:rx,requiresLoad:F_e,test:V_e,tryProjectWithZConversion:Cb,unload:D_e},Symbol.toStringTag,{value:"Module"}));async function W_e(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return hy(t);const i=le.WGS84;return await Ec(e,i),On(t,i)}function Z_e(t,e){if(!tQ(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function tQ(t,e){var i;return!!((i=t.typeKeywords)!=null&&i.includes(e))}function FYe(t){return tQ(t,iQ.HOSTED_SERVICE)}function J_e(t,e){const i=t.typeKeywords;if(i){const r=i.indexOf(e);r>-1&&i.splice(r,1)}}function NYe(t,e,i){i?Z_e(t,e):J_e(t,e)}async function DYe(t){const e=t.clone().normalize();let i;if(e.length>1)for(const r of e)i?r.width>i.width&&(i=r):i=r;else i=e[0];return W_e(i)}const iQ={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer"};function F6(t){var u;const{portal:e,isOrgItem:i,itemControl:r}=t,n=(u=e.user)==null?void 0:u.privileges;let s=!n||n.includes("features:user:edit"),o=!!i&&!!(n!=null&&n.includes("features:user:fullEdit"));const a=r==="update"||r==="admin";return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}let Jp=class extends j{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};l([c({type:String,json:{write:!0}})],Jp.prototype,"facilityIdField",void 0),l([c({type:String,json:{write:!0}})],Jp.prototype,"layerId",void 0),l([c({type:String,json:{write:!0}})],Jp.prototype,"nameField",void 0),l([c({type:String,json:{write:!0}})],Jp.prototype,"siteIdField",void 0),l([c({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],Jp.prototype,"sublayerId",void 0),Jp=l([$("esri.layers.support.FacilityLayerInfo")],Jp);const Y_e=Jp;let wl=class extends j{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};l([c({type:String,json:{write:!0}})],wl.prototype,"facilityIdField",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"layerId",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"levelIdField",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"levelNumberField",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"longNameField",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"shortNameField",void 0),l([c({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],wl.prototype,"sublayerId",void 0),l([c({type:String,json:{write:!0}})],wl.prototype,"verticalOrderField",void 0),wl=l([$("esri.layers.support.LevelLayerInfo")],wl);const K_e=wl;let nf=class extends j{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};l([c({type:String,json:{write:!0}})],nf.prototype,"layerId",void 0),l([c({type:String,json:{write:!0}})],nf.prototype,"nameField",void 0),l([c({type:String,json:{write:!0}})],nf.prototype,"siteIdField",void 0),l([c({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],nf.prototype,"sublayerId",void 0),nf=l([$("esri.layers.support.SiteLayerInfo")],nf);const X_e=nf;let ov=class extends j{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};l([c({type:K_e,json:{write:!0}})],ov.prototype,"levelLayer",void 0),l([c({type:Y_e,json:{write:!0}})],ov.prototype,"facilityLayer",void 0),l([c({type:X_e,json:{write:!0}})],ov.prototype,"siteLayer",void 0),ov=l([$("esri.support.MapFloorInfo")],ov);const Q_e=ov;var gc;(function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"})(gc||(gc={}));var JR;let av=JR=class extends j{constructor(t){super(t),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new JR(R({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};l([c({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],av.prototype,"activeRange",void 0),l([c({type:[Number],json:{write:!0}})],av.prototype,"currentRangeExtent",void 0),l([c({type:[Number],json:{write:!0}})],av.prototype,"fullRangeExtent",void 0),av=JR=l([$("esri.webdoc.RangeInfo")],av);const m5=av;var YR;let Au=YR=class extends j{constructor(t){super(t),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new YR(R({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};l([c({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Au.prototype,"enabled",void 0),l([c({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Au.prototype,"longNames",void 0),l([c({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Au.prototype,"minimized",void 0),l([c({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Au.prototype,"pinnedLevels",void 0),l([c({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Au.prototype,"site",void 0),l([c({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Au.prototype,"facility",void 0),l([c({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Au.prototype,"level",void 0),Au=YR=l([$("esri.webdoc.widgets.FloorFilter")],Au);const ewe=Au;var KR;const mT=new $e({slider:"slider",picker:"picker"});let lv=KR=class extends j{constructor(t){super(t),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new KR({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};l([c({type:mT.apiValues,nonNullable:!0,json:{type:mT.jsonValues,default:null,read:{reader:mT.read},write:{isRequired:!0,writer:mT.write}}})],lv.prototype,"interactionMode",void 0),l([c({type:Xe,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const t=this.stopInterval!=null;return{enabled:!t,isRequired:!t}}}}})],lv.prototype,"numStops",void 0),l([c({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],lv.prototype,"stopInterval",void 0),lv=KR=l([$("esri.webdoc.widgets.Range")],lv);const twe=lv,f5=Me()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Vw=class extends Ze(j){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return RX(this.value,this.unit,"milliseconds")}};l([oe(f5,{nonNullable:!0})],Vw.prototype,"unit",void 0),l([c({type:Number,json:{write:!0},nonNullable:!0})],Vw.prototype,"value",void 0),Vw=l([$("esri.time.TimeInterval")],Vw);const hp=Vw;var XR;let Ur=XR=class extends j{constructor(t){super(t),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(t){return t?Pt.fromArray(t):void 0}writeCurrentTimeExtent(t,e,i){t&&Zr(i,t.toArray(),e)}readFullTimeExtent(t,e){const i=e.properties;if(!i)return;const r=i.endTime!=null?new Date(i.endTime):null,n=i.startTime!=null?new Date(i.startTime):null;return new Pt({start:n,end:r})}writeFullTimeExtent(t,e){if(!t)return;const i=e.properties=e.properties||{},r=t.end,n=t.start;r&&(i.endTime=r!=null?r.getTime():null),n&&(i.startTime=n!=null?n.getTime():null)}readStopInterval(t,e,i){return t?hp.fromJSON({value:t.interval,unit:t.units},i):null}writeStopInterval(t,e,i,r){if(!t)return;const n=t.toJSON(r);Zr("properties.timeStopInterval",{interval:n.value,units:n.unit},e)}readStops(t){return t!=null&&t.length?t.map(e=>new Date(e)):null}writeStops(t,e,i){t!=null&&t.length&&Zr(i,t.map(r=>r.getTime()),e)}clone(){return new XR(R({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};l([c({type:Pt,json:{type:[[Xe,n_]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],Ur.prototype,"currentTimeExtent",void 0),l([X("currentTimeExtent")],Ur.prototype,"readCurrentTimeExtent",null),l([te("currentTimeExtent")],Ur.prototype,"writeCurrentTimeExtent",null),l([c({type:Pt,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],Ur.prototype,"fullTimeExtent",void 0),l([X("fullTimeExtent")],Ur.prototype,"readFullTimeExtent",null),l([te("fullTimeExtent")],Ur.prototype,"writeFullTimeExtent",null),l([c({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],Ur.prototype,"loop",void 0),l([c({type:Xe,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var r;const t=!!this.stopInterval,e=!!((r=this.stops)!=null&&r.length),i=!(t||e);return{enabled:i,isRequired:i}}}}})],Ur.prototype,"numStops",void 0),l([c({type:[1,2],nonNullable:!0,json:{type:Xe,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],Ur.prototype,"numThumbs",void 0),l([c({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],Ur.prototype,"stopDelay",void 0),l([c({type:hp,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:f5.jsonValues.filter(t=>t!=="esriTimeUnitsUnknown")}},overridePolicy(){var i;const t=this.numStops!=null,e=!!((i=this.stops)!=null&&i.length);return{enabled:!e,isRequired:!(t||e)}}}}})],Ur.prototype,"stopInterval",void 0),l([X("stopInterval")],Ur.prototype,"readStopInterval",null),l([te("stopInterval")],Ur.prototype,"writeStopInterval",null),l([c({type:[Date],json:{type:[Xe],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],Ur.prototype,"stops",void 0),l([X("stops")],Ur.prototype,"readStops",null),l([te("stops")],Ur.prototype,"writeStops",null),Ur=XR=l([$("esri.webdoc.widgets.TimeSlider")],Ur);const rQ=Ur;var QR;let uv=QR=class extends j{constructor(t){super(t),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new QR(R({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};l([c({type:twe,json:{write:!0}})],uv.prototype,"range",void 0),l([c({type:rQ,json:{write:!0}})],uv.prototype,"timeSlider",void 0),l([c({type:ewe,json:{write:!0}})],uv.prototype,"floorFilter",void 0),uv=QR=l([$("esri.webdoc.Widgets")],uv);const nQ=uv,iwe={width:600,height:400},fT=1.5;function rwe(t,e){e=e||iwe;let{width:i,height:r}=e;const n=i/r;return n<fT?r=i/fT:n>fT&&(i=r*fT),i>t.width&&(r*=t.width/i,i=t.width),r>t.height&&(i*=t.height/r,r=t.height),{width:Math.round(i),height:Math.round(r)}}function nwe(t,e){return{...sQ(t,e),readResourcePaths:[]}}function BYe(t,e,i){const r=nr(t.itemUrl);return{...sQ(t,e),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:r?{rootPath:r.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function sQ(t,e){return{origin:e,url:nr(t.itemUrl),portal:t.portal||ki.getDefault(),portalItem:t}}function J$(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function eu(t){return typeof t=="string"?nr(t):R(t)}function Y$(t,e,i){const r={};for(const n in t){if(n==="declaredClass")continue;const s=t[n];if(s!=null&&typeof s!="function")if(Array.isArray(s))r[n]=s.map(o=>Y$(o));else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(i==null?void 0:i[n]);r[n]=e?o:JSON.stringify(o)}else r[n]=e?s:JSON.stringify(s);else r[n]=s}return r}function f2(t,e){var i;return t?wV(t)&&(e||et.apiKey)?e||et.apiKey:(i=Te==null?void 0:Te.findCredential(t))==null?void 0:i.token:null}function swe(t){return{geometryType:H$(t[0]),geometries:t.map(e=>e.toJSON())}}function oQ(t,e,i){const r=Gve(e);return t.map(n=>{const s=r.fromJSON(n);return s.spatialReference=i,s})}let sf=class extends j{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),i=this.geometries[0],r={};return r.outSR=i2(this.outSpatialReference),r.inSR=i2(i.spatialReference),r.geometries=JSON.stringify({geometryType:H$(i),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};l([c()],sf.prototype,"geometries",void 0),l([c({json:{read:{source:"outSR"}}})],sf.prototype,"outSpatialReference",void 0),l([c()],sf.prototype,"transformation",void 0),l([c()],sf.prototype,"transformForward",void 0),sf=l([$("esri.rest.support.ProjectParameters")],sf);const y5=sf,owe=pi(y5);async function aQ(t,e,i){e=owe(e);const r=eu(t),n={...r.query,f:"json",...e.toJSON()},s=e.outSpatialReference,o=H$(e.geometries[0]),a=J$(n,i);return Ee(r.path+"/project",a).then(({data:{geometries:u}})=>oQ(u,o,s))}function awe(t,e){var i;return e.resourceInfo?lQ(e,e.resourceInfo,{origin:t.origin}):(i=e.portalItem)!=null&&i.id?lwe(t,e,e.portalItem):Promise.resolve()}function lQ(t,e,i){const r={context:{...i,layerContainerType:"operational-layers"}};return t.portalItem&&(r.context.portal=t.portalItem.portal||ki.getDefault()),k(()=>import("./layersCreator-BBOzKftP.js"),__vite__mapDeps([7,8,9,10])).then(({populateOperationalLayers:n})=>{const s=[],o=e.operationalLayers;o!=null&&o.length&&s.push(n(t.layers,o,r));const a={...r,context:{...r.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},u=e.tables;return u!=null&&u.length&&s.push(n(t.tables,u,a)),Promise.allSettled(s).then(()=>{})})}async function lwe(t,e,i){var o;if(await i.load().catch(a=>{throw new L(`${t.name}:load-portal-item`,"Failed to load portal item",{error:a})}),i.type!==t.itemType)throw new L(`${t.name}:invalid-portal-item`,`Invalid portal item type '${i.type}', expected '${t.itemType}'`,{type:i.type});const r=await i.fetchData();e.resourceInfo=r;const n=nwe(i,t.origin);await uwe(t,e,r,n),e.resourceReferences={portalItem:i,paths:n.readResourcePaths};const s=await dwe(e.initialViewProperties,i,U.getLogger(e));if(s){const a=((o=e.initialViewProperties)==null?void 0:o.clone())??t.createInitialViewProperties();a.viewpoint=s,e.initialViewProperties=a}}function uwe(t,e,i,r){const n=cwe(t,i);return e.read(n,r),lQ(e,n,r)}function cwe(t,e){const i=t.parseVersion(e.version||"",t.name);return t.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}async function dwe(t,e,i){var s;if((s=t==null?void 0:t.viewpoint)==null?void 0:s.targetGeometry)return null;const n=await pwe(t,e,i);return n?new Ar({targetGeometry:n}):null}async function pwe(t,e,i){const r=t==null?void 0:t.spatialReference,n=e==null?void 0:e.extent;if(!r||!n)return null;if(r.isWGS84)return n.clone();if(r.isWebMercator)return Qd(n);const{getGeometryServiceURL:s}=await k(()=>import("./geometryServiceUtils-CXXR2rKW.js"),[]);try{const o=await s(e),a=new y5({geometries:[n],outSpatialReference:r});return(await aQ(o,a))[0]}catch(o){i.error("Error projecting item's extent:",o)}return null}function N6(t){return{enabled:!!(t!=null&&t.length)}}const g5=new $e({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var eP;let cv=eP=class extends j{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new eP({exactMatch:this.exactMatch,type:this.type,name:this.name})}};l([c({type:Boolean,json:{write:!0}})],cv.prototype,"exactMatch",void 0),l([c({type:String,json:{write:!0}})],cv.prototype,"name",void 0),l([oe(g5)],cv.prototype,"type",void 0),cv=eP=l([$("esri.webdoc.applicationProperties.SearchLayerField")],cv);const hwe=cv;var tP;let dv=tP=class extends j{constructor(t){super(t),this.field=null,this.id=null,this.subLayer=null}clone(){return new tP(R({field:this.field,id:this.id,subLayer:this.subLayer}))}};l([c({type:hwe,json:{write:{isRequired:!0}}})],dv.prototype,"field",void 0),l([c({type:String,json:{write:{isRequired:!0}}})],dv.prototype,"id",void 0),l([c({type:Xe,json:{write:!0}})],dv.prototype,"subLayer",void 0),dv=tP=l([$("esri.webdoc.applicationProperties.SearchLayer")],dv);const mwe=dv;var iP;let pv=iP=class extends j{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new iP({exactMatch:this.exactMatch,type:this.type,name:this.name})}};l([c({type:Boolean,json:{write:!0}})],pv.prototype,"exactMatch",void 0),l([c({type:String,json:{write:!0}})],pv.prototype,"name",void 0),l([oe(g5)],pv.prototype,"type",void 0),pv=iP=l([$("esri.webdoc.applicationProperties.SearchTableField")],pv);const fwe=pv;var rP;let Uw=rP=class extends j{constructor(t){super(t),this.field=null,this.id=null}clone(){return new rP(R({field:this.field,id:this.id}))}};l([c({type:fwe,json:{write:{isRequired:!0}}})],Uw.prototype,"field",void 0),l([c({type:String,json:{write:{isRequired:!0}}})],Uw.prototype,"id",void 0),Uw=rP=l([$("esri.webdoc.applicationProperties.SearchTable")],Uw);const ywe=Uw;var nP;const uQ=Y.ofType(mwe),cQ=Y.ofType(ywe);let Ou=nP=class extends j{constructor(t){super(t),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new uQ,this.tables=new cQ}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,e,i){e[i]=!t}clone(){return new nP(R({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};l([c({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],Ou.prototype,"addressSearchEnabled",void 0),l([X("addressSearchEnabled")],Ou.prototype,"readAddressSearchEnabled",null),l([te("addressSearchEnabled")],Ou.prototype,"writeAddressSearchEnabled",null),l([c({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],Ou.prototype,"enabled",void 0),l([c({type:String,json:{write:!0}})],Ou.prototype,"hintText",void 0),l([c({type:uQ,json:{write:{overridePolicy:N6},origins:{"web-scene":{write:{isRequired:!0}}}}})],Ou.prototype,"layers",void 0),l([c({type:cQ,json:{read:!0,write:{overridePolicy:N6}}})],Ou.prototype,"tables",void 0),Ou=nP=l([$("esri.webdoc.applicationProperties.Search")],Ou);const gwe=Ou;var sP;let nx=sP=class extends j{constructor(t){super(t),this.search=null}clone(){return new sP(R({search:this.search}))}};l([c({type:gwe,json:{write:!0}})],nx.prototype,"search",void 0),nx=sP=l([$("esri.webdoc.applicationProperties.Viewing")],nx);const vwe=nx;var oP;let hv=oP=class extends j{constructor(t){super(t),this.editing=null,this.offline=null,this.viewing=null}clone(){return new oP(R({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};l([c({json:{write:!0}})],hv.prototype,"editing",void 0),l([c({json:{write:!0}})],hv.prototype,"offline",void 0),l([c({type:vwe,json:{write:!0}})],hv.prototype,"viewing",void 0),hv=oP=l([$("esri.webmap.ApplicationProperties")],hv);const bwe=hv;var aP;let jo=aP=class extends j{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return EJ(this.url)}get isDataURI(){return bp(this.url)}clone(){return new aP({url:this.url})}};l([c({type:String,json:{write:{isRequired:!0}}})],jo.prototype,"url",void 0),l([c()],jo.prototype,"isSecureUrl",null),l([c()],jo.prototype,"isDataURI",null),jo=aP=l([$("esri.webdoc.support.SlideThumbnail")],jo);const _we={type:Pt,json:{read:{source:"timeExtent",reader:t=>t?Array.isArray(t)?Pt.fromArray(t):Pt.fromJSON(t):null},write:{writer:(t,e,i,r)=>{t&&(t.isEmpty?r!=null&&r.messages&&r.messages.push(new L("invalid-timeExtent","TimeExtent cannot be empty")):e[i]=t.toArray())},target:{timeExtent:{type:[[Xe,n_]]}}}}};var lP;let Ru=lP=class extends vu(j){constructor(t){super(t),this.name=null,this.thumbnail=new jo,this.timeExtent=null}castThumbnail(t){return typeof t=="string"?new jo({url:t}):pi(jo,t)}set viewpoint(t){const{targetGeometry:e,scale:i}=t;e!=null&&e.type==="point"&&i==null&&U.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t),this._set("viewpoint",t)}readViewpoint(t,e){const{extent:i,viewpoint:r}=e;return Ar.fromJSON(r||{targetGeometry:i})}writeViewpoint(t,e,i,r){if(!t)return;const{targetGeometry:n}=t;if(n==null||n.type==="extent")n!=null&&(e.extent=n.toJSON()),e[i]=t.toJSON();else{const s="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";r!=null&&r.messages?r.messages.push(new L("property:unsupported",s)):U.getLogger(this).error(s)}}clone(){return new lP(R({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};l([c({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Ru.prototype,"name",void 0),l([c({type:jo,json:{write:{overridePolicy:t=>({enabled:!(!t||!t.url)})}}})],Ru.prototype,"thumbnail",void 0),l([We("thumbnail")],Ru.prototype,"castThumbnail",null),l([c(_we)],Ru.prototype,"timeExtent",void 0),l([c({type:Ar,nonNullable:!0,json:{write:!0}})],Ru.prototype,"viewpoint",null),l([X("viewpoint",["extent","viewpoint"])],Ru.prototype,"readViewpoint",null),l([te("viewpoint")],Ru.prototype,"writeViewpoint",null),Ru=lP=l([$("esri.webmap.Bookmark")],Ru);const v5=Ru;var uP;let sx=uP=class extends j{constructor(t){super(t),this.color=new ee([0,0,0,1])}clone(){return new uP(R({color:this.color}))}};l([c({type:ee,json:{write:!0}})],sx.prototype,"color",void 0),sx=uP=l([$("esri.webmap.background.ColorBackground")],sx);const lk=sx;let Qc=class extends Ze(q){constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeExtent=null,this.timeZone=Os,this.viewpoint=null}};l([c({type:lk})],Qc.prototype,"background",void 0),l([c({type:m5})],Qc.prototype,"rangeInfo",void 0),l([c({type:le})],Qc.prototype,"spatialReference",void 0),l([c({type:Pt})],Qc.prototype,"timeExtent",void 0),l([c({nonNullable:!0})],Qc.prototype,"timeZone",void 0),l([c({type:Ar})],Qc.prototype,"viewpoint",void 0),Qc=l([$("esri.webmap.InitialViewProperties")],Qc);const y2=Qc;let dQ=class cP{constructor(e,i,r=""){this.major=e,this.minor=i,this._context=r}lessThan(e,i){return this.major<e||e===this.major&&this.minor<i}greaterEqual(e,i){return!this.lessThan(e,i)}validate(e){if(this.major!==e.major){const i=this._context&&this._context+":",r=this._context&&this._context+" ";throw new L(i+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new cP(this.major,this.minor,this._context)}static parse(e,i=""){const[r,n]=e.split("."),s=/^\s*\d+\s*$/;if(!(r!=null&&r.match)||!s.test(r))throw new L((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!(n!=null&&n.match)||!s.test(n))throw new L((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(r,10),a=parseInt(n,10);return new cP(o,a,i)}},q0=class extends dQ{constructor(e,i){super(e,i,"webmap")}};const pQ=Y.ofType(v5),wwe=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),Swe="ArcGIS Pro",$we=iQ.JSAPI;let fi=class extends nk(uo.LoadableMixin(l_(FX))){constructor(e){super(e),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new pQ,this.floorInfo=null,this.initialViewProperties=new y2,this.portalItem=null,this.sourceVersion=null,this.widgets=null,this._debouncedSaveOperations=Bo(async(i,r,n)=>{const{save:s,saveAs:o}=await k(()=>import("./webdocSaveUtils-CgoUfAOU.js"),__vite__mapDeps([13,14,15,16,17,18,19]));switch(i){case gc.SAVE:return s(this.context,this,r);case gc.SAVE_AS:return o(this.context,this,n,r)}}),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=xe(this.portalItem)}initialize(){if(this.when().catch(e=>{U.getLogger(this).error("#load()","Failed to load web map",e)}),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(i){return void this.addResolvingPromise(Promise.reject(i))}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,i){e&&this._isAuthoringAppSetByUser?i.authoringApp=e:i.authoringApp=$we}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,i){e&&this._isAuthoringAppVersionSetByUser?i.authoringAppVersion=e:i.authoringAppVersion=xr}readInitialViewProperties(e,i){var o,a;const r=new y2;i.background&&(r.background=lk.fromJSON(i.background));const n=(o=i.initialState)==null?void 0:o.timeExtent;n&&(r.timeExtent=Pt.fromArray(n));const s=(a=i.initialState)==null?void 0:a.viewpoint;return s&&(s.rotation&&q0.parse(i.version||"","webmap").lessThan(2,20)&&i.authoringApp===Swe&&(s.rotation*=-1),r.viewpoint=Ar.fromJSON(s)),i.mapRangeInfo&&(r.rangeInfo=m5.fromJSON(i.mapRangeInfo)),i.spatialReference&&(r.spatialReference=le.fromJSON(i.spatialReference)),i.timeZone&&(r.timeZone=i.timeZone),r}writeInitialViewProperties(e,i,r,n){var a;if(!e)return;(a=e.background)!=null&&a.color&&(i.background=e.background.write({},n));const{timeExtent:s,viewpoint:o}=e;if(o||s){const u={};o&&(u.viewpoint=o.write({},n)),s&&(u.timeExtent=s.toArray()),i.initialState=u}e.rangeInfo&&(i.mapRangeInfo=e.rangeInfo.toJSON(n)),e.spatialReference&&(i.spatialReference=e.spatialReference.write({},n)),i.timeZone=e.timeZone}writeLayers(e,i,r,n){i[r]=this._writeLayers(e,n,"operational-layers")}readSourceVersion(e,i){const[r,n]=i.version.split(".");return new q0(parseInt(r,10),parseInt(n,10))}writeSourceVersion(e,i,r){i[r]=`${this.context.currentVersion.major}.${this.context.currentVersion.minor}`}writeTables(e,i,r,n){const s=this._writeLayers(e,n,"tables");s.length&&(i[r]=s)}get thumbnailUrl(){var e;return((e=this.portalItem)==null?void 0:e.thumbnailUrl)||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(e){return this.addResolvingPromise(awe(this.context,this)),Promise.resolve(this)}loadAll(){return PC(this,e=>{e(this.ground,this.basemap,this.layers,this.tables)})}read(e,i){i={...i,origin:this.context.origin};const r=this._getAuthoringPropsState();hJ(this,e,n=>super.read(e,n),i),this._restoreAuthoringPropsFromState(r)}write(e,i){if(this.loadStatus!=="loaded"){const r=new L("webmap:not-loaded","Web map must be loaded before it can be serialized");throw U.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),r}return this._removeDanglingLayerRefs(),i={...i,origin:this.context.origin,restrictedWebMapWriting:!0,webmap:this},super.write(e,i)}async save(e){return this._debouncedSaveOperations(gc.SAVE,e)}async saveAs(e,i){return this._debouncedSaveOperations(gc.SAVE_AS,i,e)}async updateFrom(e,i){const r=this._updateFromInternal(e,i);this._updateFromPromise=r,await r,r===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){var r,n,s,o;const i=this.resourceInfo;return this._collectAllLayersJSON([...((r=i==null?void 0:i.baseMap)==null?void 0:r.baseMapLayers)||[],...(i==null?void 0:i.operationalLayers)||[],...((o=(s=(n=this.basemap)==null?void 0:n.resourceInfo)==null?void 0:s.data)==null?void 0:o.baseMapLayers)||[]]).find(a=>a.id===e.id)}async updateItemThumbnail(){var e;this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await((e=this.portalItem)==null?void 0:e.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename})),this._clearThumbnailOverride())}getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:xJ(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_collectAllLayersJSON(e){return e.reduce((i,r)=>(i.push(r),r.layerType==="GroupLayer"&&(i=i.concat(this._collectAllLayersJSON(r.layers||[]))),i),[])}_writeLayers(e,i,r){return i={...i,layerContainerType:r},e.map(n=>ER(n,r==="tables"?null:this.getLayerJSONFromResourceInfo(n),i)).filter(ot).toArray()}_validateJSON(e){const i=q0.parse(e.version||"","webmap");return this.context.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}_removeDanglingLayerRefs(){var o,a;const e=this.applicationProperties,i=(o=e==null?void 0:e.viewing)==null?void 0:o.search,r=u=>this.allLayers.some(d=>d.id===u);if(i!=null&&i.layers&&(i.layers=i.layers.filter(u=>r(u.id))),i!=null&&i.tables&&(i.tables=i.tables.filter(u=>this.tables.some(d=>d.id===u.id))),e){const u=(a=e.editing)==null?void 0:a.locationTracking;u!=null&&u.info&&!r(u.info.layerId)&&(e.editing=null)}const n="presentation"in this?this.presentation:null,s=n==null?void 0:n.slides;s&&s.forEach(u=>{u.visibleLayers&&(u.visibleLayers=u.visibleLayers.filter(d=>r(d.id)))})}async _updateFromInternal(e,i){if(i??(i={}),await wi(()=>e.ready),this._updateInitialViewProperties(e,i),e.map===this)for(const r of e.allLayerViews)"visible"in r&&"visible"in r.layer&&r._isOverridden("visible")&&(r.layer.visible=r.visible),"featureEffect"in r&&"featureEffect"in r.layer&&r._isOverridden("featureEffect")&&(r.layer.featureEffect=r.featureEffect);await this._updateThumbnailUrl(e,i)}_updateInitialViewProperties(e,i){var r,n;if(i.backgroundExcluded||(this.initialViewProperties.background=(r=e.background)==null?void 0:r.clone()),this.initialViewProperties.spatialReference=(n=e.spatialReference)==null?void 0:n.clone(),this.initialViewProperties.timeZone=e.timeZone,i.viewpointExcluded||(this.initialViewProperties.viewpoint=new Ar({rotation:e.rotation,scale:i.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!i.widgetsExcluded)for(const s of e.persistableViewModels)s.updateWebDocument(this)}_getViewExtent(e){const i=e.center.clone().normalize(),r=e.extent.clone(),n=r.width/2;return r.xmin=i.x-n,r.xmax=i.x+n,r}async _updateThumbnailUrl(e,i){if(i.thumbnailExcluded)return;const r=rwe(e,i.thumbnailSize),n=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(n.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(bp(e)){const i=dm(e),r=i==null?void 0:i.mediaType,n=r&&wwe.get(r.toLowerCase())||null,s=`thumbnail${Date.now()}`;return n?`${s}.${n}`:s}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}};l([c()],fi.prototype,"_updateFromPromise",void 0),l([c({type:bwe,json:{write:!0}})],fi.prototype,"applicationProperties",void 0),l([c({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],fi.prototype,"authoringApp",null),l([te("authoringApp")],fi.prototype,"writeAuthoringApp",null),l([c({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],fi.prototype,"authoringAppVersion",null),l([te("authoringAppVersion")],fi.prototype,"writeAuthoringAppVersion",null),l([c({type:pQ,json:{write:{overridePolicy:t=>({enabled:!!(t&&t.length>0),ignoreOrigin:!0})}}})],fi.prototype,"bookmarks",void 0),l([c({type:Q_e,json:{name:"mapFloorInfo",write:!0}})],fi.prototype,"floorInfo",void 0),l([c({type:y2,nonNullable:!0,json:{read:{source:["background","initialState.timeExtent","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:lk},"initialState.timeExtent":{type:Pt},"initialState.viewpoint":{type:Ar},mapRangeInfo:{type:m5},spatialReference:{type:le},"timeZone:":{type:String}}}}})],fi.prototype,"initialViewProperties",void 0),l([X("initialViewProperties")],fi.prototype,"readInitialViewProperties",null),l([te("initialViewProperties")],fi.prototype,"writeInitialViewProperties",null),l([c({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],fi.prototype,"layers",void 0),l([te("layers")],fi.prototype,"writeLayers",null),l([c({type:so})],fi.prototype,"portalItem",void 0),l([c()],fi.prototype,"resourceInfo",void 0),l([c({readOnly:!0,type:q0,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],fi.prototype,"sourceVersion",void 0),l([X("sourceVersion")],fi.prototype,"readSourceVersion",null),l([te("sourceVersion")],fi.prototype,"writeSourceVersion",null),l([c({json:{read:!1,write:{ignoreOrigin:!0}}})],fi.prototype,"tables",void 0),l([te("tables")],fi.prototype,"writeTables",null),l([c()],fi.prototype,"thumbnailUrl",null),l([c()],fi.prototype,"updatingFromView",null),l([c({type:nQ,json:{write:!0}})],fi.prototype,"widgets",void 0),fi=l([$("esri.WebDocument2D")],fi);const Ewe=fi;async function b5(t,e){const{WhereClause:i}=await k(()=>import("./WhereClause-DLw-__iv.js").then(r=>r.W),[]);return i.create(t,{fieldsIndex:e})}function _5(t,e){return t==="1=1"?e??t:e==="1=1"?t??e:t!=null&&t!==""?e!=null&&e!==""?`(${t}) AND (${e})`:t:e}const Twe={ar:"ar-u-nu-latn"};let ox=new WeakMap,hQ={};function dP(t){const e=t||hQ;if(!ox.has(e)){const i=An(),r=Twe[An()]||i;ox.set(e,new Intl.NumberFormat(r,t))}return ox.get(e)}function g2(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Rn(t,e){return Object.is(t,-0)&&(t=0),dP(e).format(t)}function JYe(t,e=An()){var r,n;if(!t)return null;let i=D6.get(e);if(!i){const s=dP().formatToParts(12345.6),o=[...dP({useGrouping:!1}).format(9876543210)].reverse(),a=new Map(o.map((y,g)=>[y,g])),u=new RegExp(`[${(r=s.find(y=>y.type==="group"))==null?void 0:r.value}]`,"g"),d=new RegExp(`[${(n=s.find(y=>y.type==="decimal"))==null?void 0:n.value}]`),p=new RegExp(`[${o.join("")}]`,"g"),h=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,m=/[-\u2212\u2013\u2014\u2015]/g;i=y=>{if((y=y.trim().replaceAll(u,"").replace(d,".").replace(p,v=>String(a.get(v))).replaceAll(h,"").replaceAll(m,"-"))==="")return null;const g=Number(y);return isNaN(g)?null:g},D6.set(e,i)}return i(t)}RV(()=>{ox=new WeakMap,hQ={}});const D6=new Map,mQ=()=>U.getLogger("esri.intl.substitute");function Wr(t,e,i={}){const{format:r={}}=i;return mu(t,n=>Iwe(n,e,r))}function Iwe(t,e,i){let r,n;const s=t.indexOf(":");if(s===-1?r=t.trim():(r=t.slice(0,s).trim(),n=t.slice(s+1).trim()),!r)return"";const o=k$(r,e);if(o==null)return"";const a=(n?i==null?void 0:i[n]:null)??(i==null?void 0:i[r]);return a?xwe(o,a):n?Mwe(o,n):w5(o)}function xwe(t,e){switch(e.type){case"date":return hr(t,e.intlOptions);case"number":return Rn(t,e.intlOptions);default:return mQ().warn("missing format descriptor for key {key}"),w5(t)}}function Mwe(t,e){switch(e.toLowerCase()){case"dateformat":return hr(t);case"numberformat":return Rn(t);default:return mQ().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?hr(t):/^numberformat/i.test(e)?Rn(t):w5(t)}}function w5(t){switch(typeof t){case"string":return t;case"number":return Rn(t);case"boolean":return""+t;default:return t instanceof Date?hr(t):""}}async function Cwe(t,e,i,r){const n=e.exec(i);if(!n)throw new L("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const s=n[1]?`${n[1]}/`:"",o=n[2],a=cye(r),u=`${s}${o}.json`,d=a?`${s}${o}_${a}.json`:u;let p;try{p=await V6(t(d))}catch(h){if(d===u)throw new L("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:h});try{p=await V6(t(u))}catch(m){throw new L("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:m})}}return p}async function V6(t){if(U6.fetchBundleAsset!=null)return U6.fetchBundleAsset(t);const e=await Ee(t,{responseType:"text"});return JSON.parse(e.data)}let kwe=class{constructor({base:e="",pattern:i,location:r=new URL(window.location.href)}){let n;n=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=n,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,i){return Cwe(this.getAssetUrl,this.matcher,e,i)}};function Lwe(t){return new kwe(t)}const U6={};uye(Lwe({pattern:"esri/",location:ut}));function of(t){return typeof t=="number"}function kb(t){return typeof t=="string"||t instanceof String}const Awe=po,pP={date:null,time:null,timeZoneOffset:null},Owe=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]),K$="yyyy-MM-dd",fQ="TT";var W0;(function(t){t.HM="HH:mm",t.HMS="HH:mm:ss",t.HMS_MS="HH:mm:ss.SSS"})(W0||(W0={}));const Rwe=[W0.HMS_MS,W0.HMS,W0.HM,fQ],jw="latn",Pwe=t=>"valueAsDate"in t;function jy(t){return{locale:An(),numberingSystem:jw,zone:t??Awe}}function yQ(t,e){return t===null?null:se.fromMillis(t,jy(e))}function Gw(t,e){if(t==null||!kb(t)||t===""){if(e){const r=se.local({zone:e});return{date:null,time:null,timeZoneOffset:r.isValid?r.offset.toString():null}}return pP}const i=se.fromISO(t,{setZone:!0});return{date:i.toFormat(K$,jy()),time:i.toFormat(W0.HMS_MS,jy()),timeZoneOffset:i.offset.toString()}}function yT(t,e){if(t==null||!of(t)||isNaN(t))return pP;const i=yQ(t,e);return i?{date:i.toFormat(K$,jy(e)),time:i.toFormat(fQ,jy(e))}:pP}function S5(t){switch(t.type){case"date":default:return Ms("short-date-short-time");case"date-only":return Ms("short-date");case"time-only":return Ms("short-time");case"timestamp-offset":return{...Ms("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function gQ(t,e,i){if(!t||e==null)return null;switch(t.type){case"date":return hr(e,i);case"date-only":return LX(e,i);case"time-only":return AX(e,i);case"timestamp-offset":return OX(e,i);default:return null}}function Fwe(t){const{dateComponent:e,defaultTimeZone:i,timeComponent:r,timeZoneComponent:n,oldValue:s}=t;if(!(e!=null&&e.value)||!(r!=null&&r.value))return null;const{year:o,month:a,day:u}=se.fromFormat(e.value,K$),{hour:d,minute:p,second:h,millisecond:m}=hP(r,po)??se.now(),y=Gw(s,i),g=(n==null?void 0:n.value)!=null?parseInt(n.value,10):y.timeZoneOffset!=null?parseInt(y.timeZoneOffset,10):new Date().getTimezoneOffset(),v=pr.instance(g),_=se.fromObject({year:o,month:a,day:u,hour:d,minute:p,second:h,millisecond:m},{zone:v});return _.isValid?_.toISO({includeOffset:!0}):null}function Nwe(t){const{dateComponent:e,timeComponent:i,timeZone:r,max:n,min:s,oldValue:o}=t,a=hP(e,r);let u=!!t.applyRange;if(!a)return null;let d=null;if((i==null?void 0:i.value)!=null){const h=hP(i,r),m=Date.now(),y=n!=null&&n<m?n:m,g=se.fromMillis(y,jy(r)),v=a||g,{year:_,month:w,day:S}=v,{hour:E,minute:T,second:M,millisecond:x}=h||g;d=v.set({year:_,month:w,day:S,hour:E,minute:T,second:M,millisecond:x})}else{const h=yQ(G6({value:o??Date.now(),max:n,min:s}),r),{year:m,month:y,day:g}=a,{hour:v,minute:_,second:w,millisecond:S}=h;u=!0,d=a.set({year:m,month:y,day:g,hour:v,minute:_,second:w,millisecond:S})}if(!d.isValid)return null;const p=d.toMillis();return u?G6({value:p,max:n,min:s}):p}function hP(t,e){if((t==null?void 0:t.value)==null||Array.isArray(t.value))return null;let i=null;return i=Pwe(t)?se.fromFormat(t.value,K$,jy(e)):Z0(t.value),i!=null&&i.isValid?i:null}function j6(t){const{max:e,min:i,value:r}=t;return!isNaN(r)&&!(e!=null&&r>e)&&!(i!=null&&r<i)}function G6(t){const{max:e,min:i,value:r}=t;return e!=null&&i!=null?fr(r,i,e):e!=null&&r>e?e:i!=null&&r<i?i:r}function mP(t){if(!t)return"";const e=t.split(".").at(0);if(!e||e.length<1)throw new L("invalid time-only field",`Cannot parse valid time-only field value from ${t}`);const i=e.split(":"),r=new Array(3);for(let n=0;n<3;n++){const s=i.at(n)??"";r[n]=s.padStart(2,"0")}return r.join(":")}function Dwe(t,e){switch(e){case"date":return t.getTime();case"date-only":return t.toISODate();case"time-only":return mP(t.toISOTime(!0,!1));case"timestamp-offset":return t.toISOString(!1);default:return null}}function Vwe(t){return!!t&&typeof t=="object"&&"getTime"in t&&"toISOString"in t&&"timeZone"in t}function pS(t){if(!t||!kb(t))return null;const e=se.fromFormat(t,K$);return e.isValid?e:null}function Z0(t){return t&&kb(t)?mb(Rwe,e=>{const i=se.fromFormat(t,e);return i.isValid?i:null})??null:null}function hS(t){if(!t||!kb(t))return null;const e=se.fromISO(t);return e.isValid?e:null}function Uwe(t){const{type:e,range:i,value:r}=t;if(r==null||!i||r===i.min||r===i.max)return!0;if(e==="date")return j6({value:r,min:i.min,max:i.max});const{rawMax:n,rawMin:s}=i;let o=null,a=null,u=null;switch(e){case"date-only":o=pS(n),a=pS(s),u=pS(r);break;case"time-only":o=Z0(n),a=Z0(s),u=Z0(r);break;case"timestamp-offset":o=hS(n),a=hS(s),u=hS(r)}return!u||j6({value:u.valueOf(),min:a==null?void 0:a.valueOf(),max:o==null?void 0:o.valueOf()})}var gm;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(gm||(gm={}));const jwe=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function Gwe(t){return t!=null&&jwe.has(t.type)}function vQ(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function bQ(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function _Q(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function fP(t,e,i){const r=i??(t==null?void 0:t.domain);if(!r)return null;switch(r.type){case"range":{const{min:n,max:s}=w0(t,i);if(n!=null&&+e<n||s!=null&&+e>s)return gm.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(r.codedValues==null||r.codedValues.every(n=>n==null||n.code!==e))return gm.INVALID_CODED_VALUE}return null}function w0(t,e){const i=e??(t==null?void 0:t.domain);if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,n="range"in i?i.range[1]:i.maxValue,s=Gwe(t);return vQ(t)||_Q(t)||bQ(t)?{...wQ(t,n,r),isInteger:s}:{min:r!=null&&typeof r=="number"?r:null,max:n!=null&&typeof n=="number"?n:null,rawMin:r,rawMax:n,isInteger:s}}function wQ(t,e,i){var r,n,s,o,a,u;return vQ(t)?{min:(r=pS(i))==null?void 0:r.toMillis(),max:(n=pS(e))==null?void 0:n.toMillis(),rawMin:i,rawMax:e}:_Q(t)?{min:(s=Z0(i))==null?void 0:s.toMillis(),max:(o=Z0(e))==null?void 0:o.toMillis(),rawMin:i,rawMax:e}:bQ(t)?{min:(a=hS(i))==null?void 0:a.toMillis(),max:(u=hS(e))==null?void 0:u.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}const zwe=()=>U.getLogger("esri.support.arcadeOnDemand");let HL;function Tc(){return HL||(HL=(async()=>{const t=await k(()=>import("./arcadeUtils-BfdEM_4F.js").then(e=>e.i),__vite__mapDeps([20,21,22,23,24,25,26,27]));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),HL}const Bwe=(t,e,i)=>SQ.create(t,e,i,null,["$feature","$view"],[]),Hwe=(t,e,i,r)=>SQ.create(t,e,i,r,["$feature","$view"],[]);let SQ=class $Q{constructor(e,i,r,n,s,o,a){this.services=null,this.script=e,this.evaluate=n;const u=Array.isArray(o)?o:o==null?void 0:o.fields;this.fields=u??[],this._syntaxTree=r,this._arcade=i,this._arcadeFeature=s,this._spatialReference=a,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(e,i,r,n,s,o){const{arcade:a,Feature:u,Dictionary:d}=await Tc(),p=i instanceof le?i:le.fromJSON(i);let h;try{h=a.parseScript(e,o)}catch(O){return zwe().error(new L("arcade-bad-expression","Failed to parse arcade script",{script:e,error:O})),null}const m=s.reduce((O,F)=>({...O,[F]:null}),{});let y=null;n!=null&&(y=new d(n),y.immutable=!0,m.$config=null);const g=a.scriptUsesGeometryEngine(h),v=g&&a.enableGeometrySupport(),_=a.scriptUsesFeatureSet(h)&&a.enableFeatureSetSupport(),w=a.scriptIsAsync(h),S=w&&a.enableAsyncSupport(),E={vars:m,spatialReference:p,useAsync:!!S};await Promise.all([v,_,S]);const T=new Set;await a.loadDependentModules(T,h,null,w,g);const M=new d;M.immutable=!1,M.setField("scale",0);const x=a.compileScript(h,E),C=(O,F)=>{var z;const V=(z=O.$view)==null?void 0:z.timeZone;return"$view"in O&&O.$view&&(M.setField("scale",typeof O.$view=="object"&&"scale"in O.$view?O.$view.scale:void 0),O.$view=M),y&&(O.$config=y),x({vars:O,spatialReference:p,services:F,timeZone:V})};return new $Q(e,a,h,C,new u,r,p)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const qwe=/^([0-9_])/,Wwe=/[^a-z0-9_\u0080-\uffff]+/gi;function Zwe(t){return t==null?null:t.trim().replaceAll(Wwe,"_").replace(qwe,"F$1")||null}const Jwe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Ywe=["field","normalizationField"];function z6(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(B6(Jwe,i,e),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)B6(Ywe,r,e)}}function B6(t,e,i){if(t)for(const r of t){const n=k$(r,e),s=n&&typeof n!="function"&&i.get(n);s&&Zr(r,s.name,e)}}function EQ(t,e){var i;if(t!=null&&((i=e==null?void 0:e.fields)!=null&&i.length))if("startField"in t){const r=e.get(t.startField),n=e.get(t.endField);t.startField=(r==null?void 0:r.name)??null,t.endField=(n==null?void 0:n.name)??null}else{const r=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=(r==null?void 0:r.name)??null,t.endTimeField=(n==null?void 0:n.name)??null}}const qL=new Set;function og(t,e){return t&&e?(qL.clear(),Gy(qL,t,e),Array.from(qL).sort()):[]}function Gy(t,e,i){var r;if(i)if((r=e==null?void 0:e.fields)!=null&&r.length)if(i.includes("*"))for(const{name:n}of e.fields)t.add(n);else for(const n of i)Ls(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const n of i)n!=null&&t.add(n)}}function Ls(t,e,i){if(typeof i=="string")if(e){const r=e.get(i);r&&t.add(r.name)}else t.add(i)}function KYe(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}function XYe(t,e,i=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const r=og(t,e);return r.length/t.fields.length>=i?["*"]:r}async function as(t,e,i){var s;if(!i)return;const{arcadeUtils:r}=await Tc(),n=r.extractFieldNames(i,(s=e==null?void 0:e.fields)==null?void 0:s.map(o=>o.name));for(const o of n)Ls(t,e,o)}async function TQ(t,e,i){if(i&&i!=="1=1"){const r=await b5(i,e);if(!r.isStandardized)throw new L("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});Gy(t,e,r.fieldNames)}}function $5({displayField:t,fields:e}){return t||(e!=null&&e.length?WL(e,"name-or-title")||WL(e,"unique-identifier")||WL(e,"type-or-category")||Kwe(e):null)}function Kwe(t){for(const e of t){if(!(e!=null&&e.name))continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function WL(t,e){for(const i of t)if(i!=null&&i.valueType&&i.valueType===e)return i.name;return null}async function QYe(t,e){var r;if(!e)return;const i=(r=e.elevationInfo)==null?void 0:r.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function Xwe(t,e,i){i.onStatisticExpression?as(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function eKe(t,e,i){if(!e||!i||!("fields"in i))return;const r=[],n=i.popupTemplate;r.push(Qwe(t,e,n)),i.fields&&r.push(...i.fields.map(async s=>Xwe(t,e.fieldsIndex,s))),await Promise.all(r)}async function Qwe(t,e,i){const r=[];i!=null&&i.expressionInfos&&r.push(...i.expressionInfos.map(s=>as(t,e.fieldsIndex,s.expression)));const n=i==null?void 0:i.content;if(Array.isArray(n))for(const s of n)s.type==="expression"&&s.expressionInfo&&r.push(as(t,e.fieldsIndex,s.expressionInfo.expression));await Promise.all(r)}async function tKe(t,e,i){e&&(e.timeInfo&&(i!=null&&i.timeExtent)&&Gy(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Gy(t,e.fieldsIndex,[e.floorInfo.floorField]),(i==null?void 0:i.where)!=null&&await TQ(t,e.fieldsIndex,i.where))}async function iKe(t,e,i){e&&i&&await Promise.all(i.map(r=>e1e(t,e,r)))}async function e1e(t,e,i){e&&i&&(i.valueExpression?await as(t,e.fieldsIndex,i.valueExpression):i.field&&Ls(t,e.fieldsIndex,i.field))}function rKe(t){return t?og(t.fieldsIndex,IQ(t)):[]}function t1e(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?og(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const i1e=new Set(["oid","global-id","guid"]),r1e=new Set(["oid","global-id"]),n1e=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function s1e(t){const e=new Set;E5(t).forEach(r=>e.add(r)),t1e(t).forEach(r=>e.add(r.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function IQ(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:r,editDateField:n,editorField:s}=e;return[i,r,n,s].filter(Boolean)}function E5(t){return IQ(t).map(e=>e.toLowerCase())}function o1e(t,e){var i;return t.editable&&!i1e.has(t.type)&&!E5(e).includes(((i=t.name)==null?void 0:i.toLowerCase())??"")}function xQ(t,e){var r;const i=((r=t.name)==null?void 0:r.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&i===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&i===e.globalIdField.toLowerCase()||s1e(e).includes(i)||r1e.has(t.type)||n1e.some(n=>n.test(i)))}async function a1e(t,e){const{labelingInfo:i,fieldsIndex:r}=e;i!=null&&i.length&&await Promise.all(i.map(n=>l1e(t,r,n)))}async function l1e(t,e,i){if(!i)return;const r=i.getLabelExpression(),n=i.where;if(r.type==="arcade")await as(t,e,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{Ls(t,e,o.slice(1,-1))})}await TQ(t,e,n)}function u1e(t){const e=t.defaultValue;return e!==void 0&&kQ(t,e)?e:t.nullable?null:void 0}function nKe(t){const e=typeof t=="string"?{type:t}:t;return v2(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function MQ(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function c1e(t){return t===null||MQ(t)}function d1e(t){return t===null||Number.isInteger(t)}function CQ(t){return t!=null&&typeof t=="string"}function p1e(t){return t===null||CQ(t)}function h1e(){return!0}function kQ(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?d1e:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?c1e:MQ;break;case"string":case"esriFieldTypeString":i=t.nullable?p1e:CQ;break;default:i=h1e}return arguments.length===1?i:i(e)}const m1e=["integer","small-integer","big-integer"],f1e=["single","double"],y1e=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],g1e=["esriFieldTypeSingle","esriFieldTypeDouble"],LQ=new Set([...m1e,...y1e]),v1e=new Set([...f1e,...g1e]),b1e=oV(LQ,v1e);function _1e(t){return t!=null&&LQ.has(t.type)}function J0(t){return t!=null&&b1e.has(t.type)}function v2(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function T5(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function w1e(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function S1e(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Lb(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function H6(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function q6(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function sKe(t,e){return AQ(t,e)===null}var Ab,Ob;function oKe(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function AQ(t,e){return t==null||t.nullable&&e===null?null:J0(t)&&!$1e(t.type,Number(e))?Ab.OUT_OF_RANGE:kQ(t,e)?t.domain?fP(t,e):null:Ob.INVALID_TYPE}function $1e(t,e){const i=typeof t=="string"?I5(t):t;if(!i)return!1;const r=i.min,n=i.max;return i.isInteger?Number.isInteger(e)&&e>=r&&e<=n:e>=r&&e<=n}function E1e(t,e){return w0(t,e)||(J0(t)?I5(t.type):void 0)}function I5(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return T1e;case"esriFieldTypeInteger":case"integer":return I1e;case"esriFieldTypeBigInteger":case"big-integer":return x1e;case"esriFieldTypeSingle":case"single":return M1e;case"esriFieldTypeDouble":case"double":return C1e}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(Ab||(Ab={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(Ob||(Ob={}));const T1e={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},I1e={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},x1e={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},M1e={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},C1e={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function aKe(t,e,i){switch(t){case gm.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case gm.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case Ob.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case Ab.OUT_OF_RANGE:{const{min:r,max:n}=I5(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${n}`}}}function OQ(t,e){return!k1e(t,e,null)}function k1e(t,e,i){if(!(e!=null&&e.attributes)||!t)return!0;const r=new Set(Object.keys(e.attributes));let n=!1;for(const s of t)if(!r.has(s)&&(n=!0,i==null))break;return n}function yP(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}async function L1e(t,e){const i=new Set;return t!=null&&t.collectRequiredFields&&await t.collectRequiredFields(i,e),Array.from(i).sort()}function x5(t){const e=t==null?void 0:t.match(/{[^}]+}/g);return e?e.map(i=>i.slice(1,-1).split(":")[0].trim()):[]}let ax=class extends j{constructor(e){super(e),this.type=null}};l([c({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],ax.prototype,"type",void 0),ax=l([$("esri.popup.content.Content")],ax);const wp=ax;var gP;let af=gP=class extends wp{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new gP({description:this.description,displayType:this.displayType,title:this.title})}};l([c({type:String,json:{write:!0}})],af.prototype,"description",void 0),l([c({type:["auto","preview","list"],json:{write:!0}})],af.prototype,"displayType",void 0),l([c({type:String,json:{write:!0}})],af.prototype,"title",void 0),l([c({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],af.prototype,"type",void 0),af=gP=l([$("esri.popup.content.AttachmentsContent")],af);const Rb=af;var vP;let lf=vP=class extends wp{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new vP({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?R(this.outFields):null})}};l([c()],lf.prototype,"creator",void 0),l([c()],lf.prototype,"destroyer",void 0),l([c()],lf.prototype,"outFields",void 0),l([c({type:["custom"],readOnly:!0})],lf.prototype,"type",void 0),lf=vP=l([$("esri.popup.content.CustomContent")],lf);const A1e=lf;var bP;let mv=bP=class extends j{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new bP({title:this.title,expression:this.expression})}};l([c({type:String,json:{write:!0}})],mv.prototype,"title",void 0),l([c({type:String,json:{write:!0}})],mv.prototype,"expression",void 0),l([c({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],mv.prototype,"returnType",void 0),mv=bP=l([$("esri.popup.ElementExpressionInfo")],mv);const O1e=mv;var _P;let zw=_P=class extends wp{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new _P({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};l([c({type:O1e,json:{write:!0}})],zw.prototype,"expressionInfo",void 0),l([c({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],zw.prototype,"type",void 0),zw=_P=l([$("esri.popup.content.ExpressionContent")],zw);const uk=zw;let fv=class extends Ze(j){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};l([oe(t_e)],fv.prototype,"dateFormat",void 0),l([c({type:Boolean,json:{write:!0}})],fv.prototype,"digitSeparator",void 0),l([c({type:Xe,json:{write:!0}})],fv.prototype,"places",void 0),fv=l([$("esri.popup.support.FieldInfoFormat")],fv);const lx=fv;var wP;let Sl=wP=class extends j{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){var t;return new wP({fieldName:this.fieldName,format:(t=this.format)==null?void 0:t.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};l([c({type:String,json:{write:!0}})],Sl.prototype,"fieldName",void 0),l([c({type:lx,json:{write:!0}})],Sl.prototype,"format",void 0),l([c({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Sl.prototype,"isEditable",void 0),l([c({type:String,json:{write:!0}})],Sl.prototype,"label",void 0),l([oe(new $e({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Sl.prototype,"stringFieldOption",void 0),l([c({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Sl.prototype,"statisticType",void 0),l([c({type:String,json:{write:!0}})],Sl.prototype,"tooltip",void 0),l([c({type:Boolean,json:{write:!0}})],Sl.prototype,"visible",void 0),Sl=wP=l([$("esri.popup.FieldInfo")],Sl);const M5=Sl;var SP;let ed=SP=class extends wp{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(i=>i.toJSON())}clone(){return new SP(R({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};l([c({type:Object,json:{write:!0}})],ed.prototype,"attributes",void 0),l([c({type:String,json:{write:!0}})],ed.prototype,"description",void 0),l([c({type:[M5]})],ed.prototype,"fieldInfos",void 0),l([te("fieldInfos")],ed.prototype,"writeFieldInfos",null),l([c({type:String,json:{write:!0}})],ed.prototype,"title",void 0),l([c({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],ed.prototype,"type",void 0),ed=SP=l([$("esri.popup.content.FieldsContent")],ed);const Pb=ed;let uf=class extends j{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};l([c({type:String,json:{write:!0}})],uf.prototype,"altText",void 0),l([c({type:String,json:{write:!0}})],uf.prototype,"caption",void 0),l([c({type:String,json:{write:!0}})],uf.prototype,"title",void 0),l([c({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],uf.prototype,"type",void 0),uf=l([$("esri.popup.content.mixins.MediaInfo")],uf);const C5=uf;var $P;let cf=$P=class extends q{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){var t;return new $P({color:(t=this.color)==null?void 0:t.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};l([c()],cf.prototype,"color",void 0),l([c()],cf.prototype,"fieldName",void 0),l([c()],cf.prototype,"tooltip",void 0),l([c()],cf.prototype,"value",void 0),cf=$P=l([$("esri.popup.content.support.ChartMediaInfoValueSeries")],cf);const R1e=cf;var EP;let Yp=EP=class extends j{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new EP({colors:R(this.colors),fields:R(this.fields),normalizeField:this.normalizeField,series:R(this.series),tooltipField:this.tooltipField})}};l([c({type:[ee],json:{type:[[Xe]],write:!0}})],Yp.prototype,"colors",void 0),l([c({type:[String],json:{write:!0}})],Yp.prototype,"fields",void 0),l([c({type:String,json:{write:!0}})],Yp.prototype,"normalizeField",void 0),l([c({type:[R1e],json:{read:!1}})],Yp.prototype,"series",void 0),l([c({type:String,json:{write:!0}})],Yp.prototype,"tooltipField",void 0),Yp=EP=l([$("esri.popup.content.support.ChartMediaInfoValue")],Yp);const P1e=Yp;let Bw=class extends C5{constructor(e){super(e),this.type=null,this.value=void 0}};l([c({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Bw.prototype,"type",void 0),l([c({type:P1e,json:{write:!0}})],Bw.prototype,"value",void 0),Bw=l([$("esri.popup.content.mixins.ChartMediaInfo")],Bw);const ck=Bw,dk=Me()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var TP;let ux=TP=class extends ck{constructor(t){super(t),this.type="bar-chart"}clone(){var t;return new TP({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};l([c({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:dk.write}})],ux.prototype,"type",void 0),ux=TP=l([$("esri.popup.content.BarChartMediaInfo")],ux);const RQ=ux;var IP;let cx=IP=class extends ck{constructor(t){super(t),this.type="column-chart"}clone(){var t;return new IP({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};l([c({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:dk.write}})],cx.prototype,"type",void 0),cx=IP=l([$("esri.popup.content.ColumnChartMediaInfo")],cx);const PQ=cx;var xP;let Hw=xP=class extends j{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new xP({linkURL:this.linkURL,sourceURL:this.sourceURL})}};l([c({type:String,json:{write:!0}})],Hw.prototype,"linkURL",void 0),l([c({type:String,json:{write:!0}})],Hw.prototype,"sourceURL",void 0),Hw=xP=l([$("esri.popup.content.support.ImageMediaInfoValue")],Hw);const F1e=Hw;var MP;let yv=MP=class extends C5{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){var t;return new MP({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:(t=this.value)==null?void 0:t.clone()})}};l([c({type:Number,json:{write:!0}})],yv.prototype,"refreshInterval",void 0),l([c({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],yv.prototype,"type",void 0),l([c({type:F1e,json:{write:!0}})],yv.prototype,"value",void 0),yv=MP=l([$("esri.popup.content.ImageMediaInfo")],yv);const FQ=yv;var CP;let dx=CP=class extends ck{constructor(t){super(t),this.type="line-chart"}clone(){var t;return new CP({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};l([c({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:dk.write}})],dx.prototype,"type",void 0),dx=CP=l([$("esri.popup.content.LineChartMediaInfo")],dx);const NQ=dx;var kP;let px=kP=class extends ck{constructor(t){super(t),this.type="pie-chart"}clone(){var t;return new kP({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};l([c({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:dk.write}})],px.prototype,"type",void 0),px=kP=l([$("esri.popup.content.PieChartMediaInfo")],px);const DQ=px,LP={base:C5,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":RQ,"column-chart":PQ,"line-chart":NQ,"pie-chart":DQ,image:FQ}};var AP;let $l=AP=class extends wp{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?FQ.fromJSON(e):e.type==="barchart"?RQ.fromJSON(e):e.type==="columnchart"?PQ.fromJSON(e):e.type==="linechart"?NQ.fromJSON(e):e.type==="piechart"?DQ.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new AP(R({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};l([c()],$l.prototype,"activeMediaInfoIndex",void 0),l([c({type:Object,json:{write:!0}})],$l.prototype,"attributes",void 0),l([c({type:String,json:{write:!0}})],$l.prototype,"description",void 0),l([c({types:[LP]})],$l.prototype,"mediaInfos",void 0),l([X("mediaInfos")],$l.prototype,"readMediaInfos",null),l([te("mediaInfos")],$l.prototype,"writeMediaInfos",null),l([c({type:String,json:{write:!0}})],$l.prototype,"title",void 0),l([c({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],$l.prototype,"type",void 0),$l=AP=l([$("esri.popup.content.MediaContent")],$l);const QS=$l;var OP;let qw=OP=class extends j{constructor(t){super(t),this.field=null,this.order=null}clone(){return new OP({field:this.field,order:this.order})}};l([c({type:String,json:{write:!0}})],qw.prototype,"field",void 0),l([c({type:["asc","desc"],json:{write:!0}})],qw.prototype,"order",void 0),qw=OP=l([$("esri.popup.support.RelatedRecordsInfoFieldOrder")],qw);const k5=qw;let Pu=class extends Ze(wp){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};l([c({type:String,json:{write:!0}})],Pu.prototype,"description",void 0),l([c({type:Number,json:{type:Xe,write:!0}})],Pu.prototype,"displayCount",void 0),l([c({type:["list"],json:{write:!0}})],Pu.prototype,"displayType",void 0),l([c({type:[k5],json:{write:!0}})],Pu.prototype,"orderByFields",void 0),l([c({type:Number,json:{type:Xe,write:!0}})],Pu.prototype,"relationshipId",void 0),l([c({type:String,json:{write:!0}})],Pu.prototype,"title",void 0),l([c({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],Pu.prototype,"type",void 0),Pu=l([$("esri.popup.content.RelationshipContent")],Pu);const e$=Pu;var RP;let Ww=RP=class extends wp{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new RP({text:this.text})}};l([c({type:String,json:{write:!0}})],Ww.prototype,"text",void 0),l([c({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Ww.prototype,"type",void 0),Ww=RP=l([$("esri.popup.content.TextContent")],Ww);const t$=Ww;let Fu=class extends Ze(j){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.open=!1,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};l([c({type:String,json:{write:!0}})],Fu.prototype,"title",void 0),l([c({type:String,json:{write:!0}})],Fu.prototype,"description",void 0),l([c({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Fu.prototype,"type",void 0),l([c({type:Boolean,json:{read:!1}})],Fu.prototype,"open",void 0),l([c({type:Number,json:{type:Xe,write:!0}})],Fu.prototype,"associatedNetworkSourceId",void 0),l([c({type:Number,json:{type:Xe,write:!0}})],Fu.prototype,"associatedAssetGroup",void 0),l([c({type:Number,json:{type:Xe,write:!0}})],Fu.prototype,"associatedAssetType",void 0),Fu=l([$("esri.popup.support.UtilityNetworkAssociationType")],Fu);const N1e=Fu;let df=class extends Ze(wp){constructor(e){super(e),this.description=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};l([c({type:String,json:{write:!0}})],df.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],df.prototype,"title",void 0),l([c({type:[N1e],json:{write:!0}})],df.prototype,"associationTypes",void 0),l([oe({utilityNetworkAssociations:"utility-network-associations"})],df.prototype,"type",void 0),df=l([$("esri.popup.content.UtilityNetworkAssociationsContent")],df);const L5=df,D1e={base:null,key:"type",typeMap:{attachment:Rb,media:QS,text:t$,expression:uk,field:Pb,relationship:e$,utilityNetworkAssociations:L5}},V1e={base:null,key:"type",typeMap:{attachment:Rb,media:QS,text:t$,expression:uk,field:Pb,relationship:e$}};var PP;let pf=PP=class extends j{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new PP({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};l([c({type:String,json:{write:!0}})],pf.prototype,"name",void 0),l([c({type:String,json:{write:!0}})],pf.prototype,"title",void 0),l([c({type:String,json:{write:!0}})],pf.prototype,"expression",void 0),l([c({type:["string","number"],json:{write:!0}})],pf.prototype,"returnType",void 0),pf=PP=l([$("esri.popup.ExpressionInfo")],pf);const U1e=pf;var FP;let Zw=FP=class extends j{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new FP({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};l([c({type:Boolean,json:{write:!0}})],Zw.prototype,"returnTopmostRaster",void 0),l([c({type:Boolean,json:{write:!0}})],Zw.prototype,"showNoDataRecords",void 0),Zw=FP=l([$("esri.popup.LayerOptions")],Zw);const j1e=Zw;var NP;let Jw=NP=class extends j{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new NP({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?R(this.orderByFields):null})}};l([c({type:Boolean,json:{write:!0}})],Jw.prototype,"showRelatedRecords",void 0),l([c({type:[k5],json:{write:!0}})],Jw.prototype,"orderByFields",void 0),Jw=NP=l([$("esri.popup.RelatedRecordsInfo")],Jw);const W6=Jw;var DP;let pa=DP=class extends vu(q){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new DP({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};l([c()],pa.prototype,"active",void 0),l([c()],pa.prototype,"className",void 0),l([c()],pa.prototype,"disabled",void 0),l([c()],pa.prototype,"icon",void 0),l([c()],pa.prototype,"id",void 0),l([c()],pa.prototype,"indicator",void 0),l([c()],pa.prototype,"title",void 0),l([c()],pa.prototype,"type",void 0),l([c()],pa.prototype,"visible",void 0),pa=DP=l([$("esri.support.actions.ActionBase")],pa);const X$=pa;var VP;let hx=VP=class extends X${constructor(t){super(t),this.image=null,this.type="button"}clone(){return new VP({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};l([c()],hx.prototype,"image",void 0),hx=VP=l([$("esri.support.actions.ActionButton")],hx);const VQ=hx;var UP;let Yw=UP=class extends X${constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new UP({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};l([c()],Yw.prototype,"image",void 0),l([c()],Yw.prototype,"value",void 0),Yw=UP=l([$("esri.support.actions.ActionToggle")],Yw);const UQ=Yw,H_="relationships/",Z6="expression/",G1e=Y.ofType({key:"type",defaultKeyValue:"button",base:X$,typeMap:{button:VQ,toggle:UQ}}),z1e={base:wp,key:"type",typeMap:{media:QS,custom:A1e,text:t$,attachments:Rb,fields:Pb,expression:uk,relationship:e$,utilityNetworkAssociations:L5}},jQ=new Set(["attachments","fields","media","text","expression","relationship"]),B1e=new Set([...jQ,"utility-network-associations"]);let br=class extends Ze(j){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>Qa(z1e,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||kc(e)?e:(U.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeWebSceneContent(e,i,r,n){this._writePopupTemplateContent(e,i,n)}writeWebMapContent(e,i,r,n){this._writePopupTemplateContent(e,i,n)}writeFieldInfos(e,i,r,n){const{content:s}=this,o=Array.isArray(s)?s:null;if(e){const a=o?o.filter(d=>d.type==="fields"):[],u=a.length&&a.every(d=>{var p;return(p=d.fieldInfos)==null?void 0:p.length});i.fieldInfos=e.filter(Boolean).map(d=>{const p=d.toJSON(n);return u&&(p.visible=!1),p})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,i)}writeLayerOptions(e,i,r,n){i[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(n)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i){const r=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,[...r,...this._getContentExpressionInfos(this.content,r)]),Gy(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const i=new Set;return await this.collectRequiredFields(i,e),[...i].sort()}_writePopupTemplateContent(e,i,r){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(n=>(r==null?void 0:r.origin)==="web-scene"?jQ.has(n.type):B1e.has(n.type)).map(n=>n==null?void 0:n.toJSON(r)),i.popupElements.forEach(n=>{n.type==="attachments"?this._writeAttachmentContent(i):n.type==="media"?this._writeMediaContent(n,i):n.type==="text"?this._writeTextContent(n,i):n.type==="relationship"&&this._writeRelationshipContent(n,i)})):i.description=e}_writeFieldsContent(e,i){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const r=R(e.fieldInfos);Array.isArray(i.fieldInfos)?r.forEach(n=>{const s=i.fieldInfos.find(o=>{var a,u;return((a=o.fieldName)==null?void 0:a.toLowerCase())===((u=n.fieldName)==null?void 0:u.toLowerCase())});s?s.visible=!0:i.fieldInfos.push(n)}):i.fieldInfos=r}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){var s,o;const r=((s=e.orderByFields)==null?void 0:s.map(a=>this._toFieldOrderJSON(a,e.relationshipId)))||[],n=[...((o=i.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...(n==null?void 0:n.length)&&{orderByFields:n}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=R(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(e,i,r){const n={description:!1,mediaInfos:!1};return r.map(s=>s.type==="media"?(s.mediaInfos||!i||n.mediaInfos||(s.mediaInfos=i,n.mediaInfos=!0),QS.fromJSON(s)):s.type==="text"?(s.text||!e||n.description||(s.text=e,n.description=!0),t$.fromJSON(s)):s.type==="attachments"?Rb.fromJSON(s):s.type==="fields"?Pb.fromJSON(s):s.type==="expression"?uk.fromJSON(s):s.type==="relationship"?e$.fromJSON(s):s.type==="utilityNetworkAssociations"?L5.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:r}=e;if(!(i!=null&&i.startsWith(H_)))return null;const n=i.replace(H_,"").split("/");if(n.length!==2)return null;const s=parseInt(n[0],10),o=n[1];return typeof s=="number"&&o?e$.fromJSON({relationshipId:s,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(e,i){const{order:r,field:n}=e;return{field:`${H_}${i}/${n}`,order:r}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:r,relatedRecordsInfo:n={showRelatedRecords:!1}}){const s=[];e?s.push(new t$({text:e})):s.push(new Pb),Array.isArray(i)&&i.length&&s.push(QS.fromJSON({mediaInfos:i})),r&&s.push(Rb.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=n;return o&&(a!=null&&a.length)&&a.forEach(u=>{const d=this._toRelationshipContent(u);d&&s.push(d)}),s.length?s:e}_getContentElementFields(e){const i=e==null?void 0:e.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((n,s)=>[...n,...this._getMediaInfoFields(s)],[])]}return i==="text"?this._extractFieldNames(e.text):i==="relationship"||i==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:i,title:r,value:n}=e,s=n||{},{fields:o,normalizeField:a,tooltipField:u,sourceURL:d,linkURL:p}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(d),...this._extractFieldNames(p),...o??[]];return a&&h.push(a),u&&h.push(u),h}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((r,n)=>[...r,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,i,r){r&&await Promise.all(r.map(n=>as(e,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:i,visible:r})=>!(r!==void 0&&!r||!i||i.startsWith(H_)||i.startsWith(Z6))).map(i=>i.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:i,title:r,type:n}=e,s=n==="button"||n==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return x5(e).filter(i=>!(i.indexOf(H_)===0||i.indexOf(Z6)===0))}};l([c({type:G1e})],br.prototype,"actions",void 0),l([c()],br.prototype,"content",void 0),l([We("content")],br.prototype,"castContent",null),l([X("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],br.prototype,"readContent",null),l([te("web-scene","content",{popupElements:{type:Y.ofType(V1e)},showAttachments:{type:Boolean},mediaInfos:{type:Y.ofType(LP)},description:{type:String},relatedRecordsInfo:{type:W6}})],br.prototype,"writeWebSceneContent",null),l([te("content",{popupElements:{type:Y.ofType(D1e)},showAttachments:{type:Boolean},mediaInfos:{type:Y.ofType(LP)},description:{type:String},relatedRecordsInfo:{type:W6}})],br.prototype,"writeWebMapContent",null),l([c({type:[U1e],json:{write:!0}})],br.prototype,"expressionInfos",void 0),l([c({type:[M5]})],br.prototype,"fieldInfos",void 0),l([te("fieldInfos")],br.prototype,"writeFieldInfos",null),l([c({type:j1e})],br.prototype,"layerOptions",void 0),l([te("layerOptions")],br.prototype,"writeLayerOptions",null),l([c({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],br.prototype,"lastEditInfoEnabled",void 0),l([c()],br.prototype,"outFields",void 0),l([c()],br.prototype,"overwriteActions",void 0),l([c()],br.prototype,"returnGeometry",void 0),l([c({json:{type:String}})],br.prototype,"title",void 0),l([te("title")],br.prototype,"writeTitle",null),br=l([$("esri.PopupTemplate")],br);const ag=br,J6=new $e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let H1e=0,gv=class extends j{constructor(e){super(e),this.id="sym"+H1e++,this.type=null,this.color=new ee([0,0,0,1])}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};l([c({type:J6.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:J6.write}}})],gv.prototype,"type",void 0),l([c({type:ee,json:{write:{allowNull:!0}}})],gv.prototype,"color",void 0),l([X("color")],gv.prototype,"readColor",null),gv=l([$("esri.symbols.Symbol")],gv);const Pn=gv;var jP;let Kp=jP=class extends Pn{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const n=r.map(s=>{const o=s.valueExpressionInfo;return o?as(t,e,o.expression):null});await Promise.all(n)}}}clone(){return new jP({data:R(this.data)})}hash(){return bZ(JSON.stringify(this.data)).toString()}};l([c({json:{write:!1}})],Kp.prototype,"color",void 0),l([c({json:{write:!0}})],Kp.prototype,"data",void 0),l([X("data",["symbol"])],Kp.prototype,"readData",null),l([te("data",{})],Kp.prototype,"writeData",null),l([oe({CIMSymbolReference:"cim"},{readOnly:!0})],Kp.prototype,"type",void 0),Kp=jP=l([$("esri.symbols.CIMSymbol")],Kp);const Sp=Kp;let vv=class extends j{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,r){e||(i[r]=e)}};l([c({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],vv.prototype,"enabled",void 0),l([te("enabled")],vv.prototype,"writeEnabled",null),l([c({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],vv.prototype,"type",void 0),vv=l([$("esri.symbols.Symbol3DLayer")],vv);const Oc=vv;function q1e(t,e){const i=e.transparency!=null?WS(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new ee([r[0]||0,r[1]||0,r[2]||0,i]):null}function W1e(t,e){e.color=t.toJSON().slice(0,3);const i=WC(t.a);i!==0&&(e.transparency=i)}const Tm={type:ee,json:{type:[Xe],default:null,read:{source:["color","transparency"],reader:q1e},write:{target:{color:{type:[Xe]},transparency:{type:Xe}},writer:W1e}}},Ic={type:Number,cast:dt,json:{write:!0}};let hf=class extends j{constructor(e){super(e),this.color=new ee([0,0,0,1]),this.extensionLength=0,this.size=Jr(1)}clone(){}cloneProperties(){return{color:R(this.color),size:this.size,extensionLength:this.extensionLength}}};l([c({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],hf.prototype,"type",void 0),l([c(Tm)],hf.prototype,"color",void 0),l([c({...Ic,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],hf.prototype,"extensionLength",void 0),l([c(Ic)],hf.prototype,"size",void 0),hf=l([$("esri.symbols.edges.Edges3D")],hf);const A5=hf;var GP;let mx=GP=class extends A5{constructor(t){super(t),this.type="sketch"}clone(){return new GP(this.cloneProperties())}};l([oe({sketch:"sketch"},{readOnly:!0})],mx.prototype,"type",void 0),mx=GP=l([$("esri.symbols.edges.SketchEdges3D")],mx);const Z1e=mx;var zP;let fx=zP=class extends A5{constructor(t){super(t),this.type="solid"}clone(){return new zP(this.cloneProperties())}};l([oe({solid:"solid"},{readOnly:!0})],fx.prototype,"type",void 0),fx=zP=l([$("esri.symbols.edges.SolidEdges3D")],fx);const GQ=fx,zQ={types:{key:"type",base:A5,typeMap:{solid:GQ,sketch:Z1e}},json:{write:!0}};var BP;let no=BP=class extends j{constructor(t){super(t),this.color=null,this.emissiveFactor=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?Yr(this.emissiveFactor):null};return new BP(t)}};l([c(Tm)],no.prototype,"color",void 0),l([c({type:[Number],json:{write:!1}})],no.prototype,"emissiveFactor",void 0),no=BP=l([$("esri.symbols.support.Symbol3DMaterial")],no);var HP;let Xp=HP=class extends Oc{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){var t,e;return new HP({edges:(t=this.edges)==null?void 0:t.clone(),enabled:this.enabled,material:(e=this.material)==null?void 0:e.clone(),castShadows:this.castShadows,size:this.size})}};l([oe({Extrude:"extrude"},{readOnly:!0})],Xp.prototype,"type",void 0),l([c({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Xp.prototype,"size",void 0),l([c({type:no,json:{write:!0}})],Xp.prototype,"material",void 0),l([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Xp.prototype,"castShadows",void 0),l([c(zQ)],Xp.prototype,"edges",void 0),Xp=HP=l([$("esri.symbols.ExtrudeSymbol3DLayer")],Xp);const BQ=Xp;let Kw=class extends Pn{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};l([oe({esriSLS:"simple-line"},{readOnly:!0})],Kw.prototype,"type",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],Kw.prototype,"width",void 0),Kw=l([$("esri.symbols.LineSymbol")],Kw);const J1e=Kw,Y1e=["begin","end","begin-end"],HQ=["arrow","circle","square","diamond","cross","x"];var qP;let Nu=qP=class extends j{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,r){e[i]=(r==null?void 0:r.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,r){(r==null?void 0:r.origin)==="web-map"||(e[i]=t)}clone(){return new qP({color:R(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};l([c({type:["begin","end","begin-end"],json:{write:!0}})],Nu.prototype,"placement",void 0),l([oe({"line-marker":"line-marker"},{readOnly:!0}),c({json:{origins:{"web-map":{write:!1}}}})],Nu.prototype,"type",void 0),l([c({type:HQ})],Nu.prototype,"style",void 0),l([te("style")],Nu.prototype,"writeStyle",null),l([c({type:ee,value:null,json:{write:{allowNull:!0}}})],Nu.prototype,"color",null),l([X("color")],Nu.prototype,"readColor",null),l([te("color")],Nu.prototype,"writeColor",null),Nu=qP=l([$("esri.symbols.LineSymbolMarker")],Nu);const K1e=Nu;var WP;const ZL=new $e({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let td=WP=class extends J1e{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,r,n,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),i!=null&&(o.width=dt(i)),r!=null&&(o.cap=r),n!=null&&(o.join=n),s!=null&&(o.miterLimit=dt(s)),o}clone(){var t;return new WP({color:R(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};l([oe({esriSLS:"simple-line"},{readOnly:!0})],td.prototype,"type",void 0),l([c({type:ZL.apiValues,json:{read:ZL.read,write:ZL.write}})],td.prototype,"style",void 0),l([c({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],td.prototype,"cap",void 0),l([c({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],td.prototype,"join",void 0),l([c({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":K1e}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],td.prototype,"marker",void 0),l([c({type:Number,json:{read:!1,write:!1}})],td.prototype,"miterLimit",void 0),td=WP=l([$("esri.symbols.SimpleLineSymbol")],td);const yr=td,X1e=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"}));let Xw=class extends Pn{constructor(e){super(e),this.outline=null,this.type=null}hash(){var e;return`${this.type}.${(e=this.outline)==null?void 0:e.hash()}`}};l([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":yr}},json:{default:null,write:!0}})],Xw.prototype,"outline",void 0),l([c({type:["simple-fill","picture-fill"],readOnly:!0})],Xw.prototype,"type",void 0),Xw=l([$("esri.symbols.FillSymbol")],Xw);const qQ=Xw;let yx=class extends j{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};l([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],yx.prototype,"type",void 0),yx=l([$("esri.symbols.patterns.LinePattern3D")],yx);const WQ=yx,Q1e=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var ZP;const eSe=Me()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Qw=ZP=class extends WQ{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new ZP(t)}};l([c({type:["style"]})],Qw.prototype,"type",void 0),l([oe(eSe),c({type:Q1e})],Qw.prototype,"style",void 0),Qw=ZP=l([$("esri.symbols.patterns.LineStylePattern3D")],Qw);const O5=Qw;let gx=class extends j{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};l([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],gx.prototype,"type",void 0),gx=l([$("esri.symbols.patterns.Pattern3D")],gx);const ZQ=gx,tSe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var JP;let e1=JP=class extends ZQ{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new JP({style:this.style})}};l([c({type:["style"]})],e1.prototype,"type",void 0),l([c({type:tSe,json:{read:!0,write:!0}})],e1.prototype,"style",void 0),e1=JP=l([$("esri.symbols.patterns.StylePattern3D")],e1);const JQ=e1,iSe={types:{key:"type",base:ZQ,typeMap:{style:JQ}},json:{write:!0}},YQ={types:{key:"type",base:WQ,typeMap:{style:O5}},json:{write:!0}},mS=new ee("white");new ee("black");const rSe=new ee([255,255,255,0]);function nSe(t){return t.r===0&&t.g===0&&t.b===0}var YP;let fS=YP=class extends no{constructor(t){super(t),this.colorMixMode=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?Yr(this.emissiveFactor):null,colorMixMode:this.colorMixMode};return new YP(t)}};l([oe({multiply:"multiply",replace:"replace",tint:"tint"})],fS.prototype,"colorMixMode",void 0),fS=YP=l([$("esri.symbols.support.Symbol3DFillMaterial")],fS);function sSe(t,e=!1){return t<=pZ?e?new Array(t).fill(0):new Array(t):new Float64Array(t)}function $Ke(t){return(dZ(t)?t.length:t.byteLength/8)<=pZ?Array.from(t):new Float64Array(t)}function EKe(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}function Q$(t=uSe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function R5(t,e,i,r,n,s,o=Q$()){return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o[4]=n,o[5]=s,o}function TKe(t,e=Q$()){return oSe(t,0,t.length/3,e)}function oSe(t,e,i,r=Q$()){return KQ(r,KP),aSe(r,t,e,i),r}function IKe(t,e=sSe(24)){const[i,r,n,s,o,a]=t;return e[0]=i,e[1]=r,e[2]=n,e[3]=i,e[4]=r,e[5]=a,e[6]=i,e[7]=o,e[8]=n,e[9]=i,e[10]=o,e[11]=a,e[12]=s,e[13]=r,e[14]=n,e[15]=s,e[16]=r,e[17]=a,e[18]=s,e[19]=o,e[20]=n,e[21]=s,e[22]=o,e[23]=a,e}function xKe(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new at(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function MKe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function CKe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function kKe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function aSe(t,e,i=0,r=e.length/3){let n=t[0],s=t[1],o=t[2],a=t[3],u=t[4],d=t[5];for(let p=0;p<r;p++)n=Math.min(n,e[i+3*p]),s=Math.min(s,e[i+3*p+1]),o=Math.min(o,e[i+3*p+2]),a=Math.max(a,e[i+3*p]),u=Math.max(u,e[i+3*p+1]),d=Math.max(d,e[i+3*p+2]);t[0]=n,t[1]=s,t[2]=o,t[3]=a,t[4]=u,t[5]=d}function LKe(t,e,i){const r=e.length;let n=t[0],s=t[1],o=t[2],a=t[3],u=t[4],d=t[5];if(i)for(let p=0;p<r;p++){const h=e[p];n=Math.min(n,h[0]),s=Math.min(s,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),u=Math.max(u,h[1]),d=Math.max(d,h[2])}else for(let p=0;p<r;p++){const h=e[p];n=Math.min(n,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[0]),u=Math.max(u,h[1])}t[0]=n,t[1]=s,t[2]=o,t[3]=a,t[4]=u,t[5]=d}function AKe(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function eE(t){return t[0]>=t[3]?0:t[3]-t[0]}function tE(t){return t[1]>=t[4]?0:t[4]-t[1]}function iE(t){return t[2]>=t[5]?0:t[5]-t[2]}function OKe(t){const e=eE(t),i=iE(t),r=tE(t);return Math.sqrt(e*e+i*i+r*r)}function RKe(t,e=[0,0,0]){return e[0]=t[0]+eE(t)/2,e[1]=t[1]+tE(t)/2,e[2]=t[2]+iE(t)/2,e}function PKe(t,e=[0,0,0]){return e[0]=eE(t),e[1]=tE(t),e[2]=iE(t),e}function FKe(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function lSe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function NKe(t,e){return e==null||lSe(t,e)}function DKe(t,e,i,r,n=t){return n[0]=t[0]+e,n[1]=t[1]+i,n[2]=t[2]+r,n[3]=t[3]+e,n[4]=t[4]+i,n[5]=t[5]+r,n}function VKe(t,e,i=t){const r=t[0]+eE(t)/2,n=t[1]+tE(t)/2,s=t[2]+iE(t)/2;return i[0]=r+(t[0]-r)*e,i[1]=n+(t[1]-n)*e,i[2]=s+(t[2]-s)*e,i[3]=r+(t[3]-r)*e,i[4]=n+(t[4]-n)*e,i[5]=s+(t[5]-s)*e,i}function UKe(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jKe(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function GKe(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function KQ(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function zKe(t){return t?KQ(t,KP):Q$(KP)}function BKe(t,e){return e||(e=Cn()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function HKe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function qKe(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=n,t[5]=Number.POSITIVE_INFINITY,t}function Y6(t){return t.length===6}function WKe(t){return eE(t)===0&&tE(t)===0&&iE(t)===0}function ZKe(t,e,i){if(t==null||e==null)return t===e;if(!Y6(t)||!Y6(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const KP=[1/0,1/0,1/0,-1/0,-1/0,-1/0],uSe=[0,0,0,0,0,0];Q$();function JKe(t,{isPrimitive:e,width:i,depth:r,height:n}){const s=e?10:1;if(i==null&&n==null&&r==null)return[s*t[0],s*t[1],s*t[2]];const o=Lr(i,r,n);let a;for(let u=0;u<3;u++){const d=o[u];if(d!=null){a=d/t[u];break}}for(let u=0;u<3;u++)o[u]==null&&(o[u]=t[u]*a);return o}const cSe=R5(-.5,-.5,-.5,.5,.5,.5),dSe=R5(-.5,-.5,0,.5,.5,1),pSe=R5(-.5,-.5,0,.5,.5,.5);function YKe(t){switch(t){case"sphere":case"cube":case"diamond":return cSe;case"cylinder":case"cone":case"inverted-cone":return dSe;case"tetrahedron":return pSe;default:return}}const P5=["butt","square","round"],hSe=[...P5,"none"],XQ=["miter","bevel","round"];var XP;let mf=XP=class extends j{constructor(t){super(t),this.color=new ee([0,0,0,1]),this.size=Jr(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new XP(t)}};l([c(Tm)],mf.prototype,"color",void 0),l([c(Ic)],mf.prototype,"size",void 0),l([c(YQ)],mf.prototype,"pattern",void 0),l([c({type:P5,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],mf.prototype,"patternCap",void 0),mf=XP=l([$("esri.symbols.support.Symbol3DOutline")],mf);var vx;let id=vx=class extends Oc{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new vx(t)}static fromSimpleFillSymbol(t){var r,n,s;const e=t.outline&&t.outline.style&&t.outline.style!=="solid"?new O5({style:t.outline.style}):null,i={size:((r=t.outline)==null?void 0:r.width)??0,color:(((n=t.outline)==null?void 0:n.color)??mS).clone(),pattern:e};return e&&((s=t.outline)!=null&&s.cap)&&(i.patternCap=t.outline.cap),new vx({material:new fS({color:(t.color??rSe).clone()}),pattern:t.style&&t.style!=="solid"?new JQ({style:t.style}):null,outline:i})}};l([oe({Fill:"fill"},{readOnly:!0})],id.prototype,"type",void 0),l([c({type:fS,json:{write:!0}})],id.prototype,"material",void 0),l([c(iSe)],id.prototype,"pattern",void 0),l([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],id.prototype,"castShadows",void 0),l([c({type:mf,json:{write:!0}})],id.prototype,"outline",void 0),l([c(zQ)],id.prototype,"edges",void 0),id=vx=l([$("esri.symbols.FillSymbol3DLayer")],id);const Im=id,mSe=["none","underline","line-through"],fSe=["normal","italic","oblique"],ySe=["normal","lighter","bold","bolder"],QQ={type:Number,cast:t=>{const e=xs(t);return e===0?1:fr(e,.1,4)},nonNullable:!0},gSe=["left","right","center"],vSe=["baseline","top","middle","bottom"],eee={type:gSe,nonNullable:!0},tee={type:vSe,nonNullable:!0},KKe=8;var QP;let rd=QP=class extends j{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return dt(t)}clone(){return new QP({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};l([c({type:mSe,json:{default:"none",write:!0}})],rd.prototype,"decoration",void 0),l([c({type:String,json:{write:!0}})],rd.prototype,"family",void 0),l([c({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],rd.prototype,"size",void 0),l([We("size")],rd.prototype,"castSize",null),l([c({type:fSe,json:{default:"normal",write:!0}})],rd.prototype,"style",void 0),l([c({type:ySe,json:{default:"normal",write:!0}})],rd.prototype,"weight",void 0),rd=QP=l([$("esri.symbols.Font")],rd);const pk=rd;var e3;const bSe=Me()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let ff=e3=class extends j{constructor(t){super(t)}readHref(t,e,i){return t?fm(t,i):e.dataURI}writeHref(t,e,i,r){t&&(bp(t)?e.dataURI=t:(e.href=j$(t,r),Ho(e.href)&&(e.href=kn(e.href))))}clone(){return new e3({href:this.href,primitive:this.primitive})}};l([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],ff.prototype,"href",void 0),l([X("href")],ff.prototype,"readHref",null),l([te("href",{href:{type:String},dataURI:{type:String}})],ff.prototype,"writeHref",null),l([oe(bSe)],ff.prototype,"primitive",void 0),ff=e3=l([$("esri.symbols.support.IconSymbol3DLayerResource")],ff);const _Se="circle";var t3;let S0=t3=class extends q{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new t3({x:this.x,y:this.y})}};l([c({type:Number})],S0.prototype,"x",void 0),l([c({type:Number})],S0.prototype,"y",void 0),S0=t3=l([$("esri.symbols.support.Symbol3DAnchorPosition2D")],S0);var i3;let t1=i3=class extends j{constructor(t){super(t),this.color=new ee([0,0,0,1]),this.size=Jr(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new i3(t)}};l([c(Tm)],t1.prototype,"color",void 0),l([c(Ic)],t1.prototype,"size",void 0),t1=i3=l([$("esri.symbols.support.Symbol3DIconOutline")],t1);var bv;const iee="esri.symbols.IconSymbol3DLayer";let El=bv=class extends Oc{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new bv({anchor:this.anchor,anchorPosition:R(this.anchorPosition),enabled:this.enabled,material:R(this.material),outline:R(this.outline),resource:R(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||mS,i=K6(t),r=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||mS).clone()}:null;return new bv({size:t.size,angle:t.angle,resource:{primitive:SSe(t.style)},material:{color:e},outline:r,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||nSe(t.color)?mS:t.color,i=K6(t);return new bv({size:t.width<=t.height?t.height:t.width,angle:t.angle,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new bv({resource:{href:$J({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};l([c({type:no,json:{write:!0}})],El.prototype,"material",void 0),l([c({type:ff,json:{write:!0}})],El.prototype,"resource",void 0),l([oe({Icon:"icon"},{readOnly:!0})],El.prototype,"type",void 0),l([c(Ic)],El.prototype,"size",void 0),l([oe({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],El.prototype,"anchor",void 0),l([c({type:S0,json:{type:[Number],read:{reader:t=>new S0({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],El.prototype,"anchorPosition",void 0),l([c({type:t1,json:{write:!0}})],El.prototype,"outline",void 0),l([c({type:Number,json:{write:!0,default:0}})],El.prototype,"angle",void 0),El=bv=l([$(iee)],El);const fy=El;function K6(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,r=X6(t.xoffset),n=X6(t.yoffset);return(r||n)&&e&&i?{x:-r/e,y:n/i}:null}function X6(t){return isFinite(t)?t:0}const wSe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function SSe(t){return wSe[t]||(U.getLogger(iee).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}let yf=class extends Ze(j){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};l([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],yf.prototype,"type",void 0),l([c({type:Y1e,json:{default:"begin-end",write:!0}})],yf.prototype,"placement",void 0),l([c({type:HQ,json:{default:"arrow",write:!0}})],yf.prototype,"style",void 0),l([c({type:ee,json:{type:[Xe],default:null,write:!0}})],yf.prototype,"color",void 0),yf=l([$("esri.symbols.LineStyleMarker3D")],yf);const r3=yf;var bx;let Du=bx=class extends Oc{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Jr(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new bx(t)}static fromSimpleLineSymbol(t){var i;const e={enabled:!0,size:t.width??Jr(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new O5({style:t.style}):null,material:new no({color:(t.color||mS).clone()}),marker:t.marker?new r3({placement:t.marker.placement,style:t.marker.style,color:((i=t.marker.color)==null?void 0:i.clone())??null}):null};return new bx(e)}};l([c({type:no,json:{write:!0}})],Du.prototype,"material",void 0),l([oe({Line:"line"},{readOnly:!0})],Du.prototype,"type",void 0),l([c({type:XQ,json:{write:!0,default:"miter"}})],Du.prototype,"join",void 0),l([c({type:P5,json:{write:!0,default:"butt"}})],Du.prototype,"cap",void 0),l([c(Ic)],Du.prototype,"size",void 0),l([c(YQ)],Du.prototype,"pattern",void 0),l([c({types:{key:"type",base:r3,typeMap:{style:r3}},json:{write:!0}})],Du.prototype,"marker",void 0),Du=bx=l([$("esri.symbols.LineSymbol3DLayer")],Du);const m_=Du;var n3;const $Se=Me()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let i1=n3=class extends j{clone(){return new n3({href:this.href,primitive:this.primitive})}};l([c({type:String,json:{read:FV,write:Vy}})],i1.prototype,"href",void 0),l([oe($Se)],i1.prototype,"primitive",void 0),i1=n3=l([$("esri.symbols.support.ObjectSymbol3DLayerResource")],i1);const ESe="sphere";var s3;let ry=s3=class extends q{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new s3({x:this.x,y:this.y,z:this.z})}};l([c({type:Number})],ry.prototype,"x",void 0),l([c({type:Number})],ry.prototype,"y",void 0),l([c({type:Number})],ry.prototype,"z",void 0),ry=s3=l([$("esri.symbols.support.Symbol3DAnchorPosition3D")],ry);var o3;let Gn=o3=class extends Oc{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var t,e,i;return new o3({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(t=this.anchorPosition)==null?void 0:t.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((e=this.material)==null?void 0:e.clone())??null,castShadows:this.castShadows,resource:(i=this.resource)==null?void 0:i.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};l([c({type:no,json:{write:!0}})],Gn.prototype,"material",void 0),l([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Gn.prototype,"castShadows",void 0),l([c({type:i1,json:{write:!0}})],Gn.prototype,"resource",void 0),l([oe({Object:"object"},{readOnly:!0})],Gn.prototype,"type",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"width",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"height",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"depth",void 0),l([oe({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Gn.prototype,"anchor",void 0),l([c({type:ry,json:{type:[Number],read:{reader:t=>new ry({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Gn.prototype,"anchorPosition",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"heading",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"tilt",void 0),l([c({type:Number,json:{write:!0}})],Gn.prototype,"roll",void 0),l([c({readOnly:!0})],Gn.prototype,"isPrimitive",null),Gn=o3=l([$("esri.symbols.ObjectSymbol3DLayer")],Gn);const F5=Gn;var a3;let fs=a3=class extends Oc{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new a3({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};l([c({type:no,json:{write:!0}})],fs.prototype,"material",void 0),l([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],fs.prototype,"castShadows",void 0),l([oe({Path:"path"},{readOnly:!0})],fs.prototype,"type",void 0),l([c({type:["circle","quad"],json:{write:!0,default:"circle"}})],fs.prototype,"profile",void 0),l([c({type:XQ,json:{write:!0,default:"miter"}})],fs.prototype,"join",void 0),l([c({type:hSe,json:{write:!0,default:"butt"}})],fs.prototype,"cap",void 0),l([c({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],fs.prototype,"width",void 0),l([X("width",["width","size","height"])],fs.prototype,"readWidth",null),l([c({type:Number,json:{write:!0}})],fs.prototype,"height",void 0),l([X("height",["height","size","width"])],fs.prototype,"readHeight",null),l([c({type:["center","bottom","top"],json:{write:!0,default:"center"}})],fs.prototype,"anchor",void 0),l([c({type:["heading","all"],json:{write:!0,default:"all"}})],fs.prototype,"profileRotation",void 0),fs=a3=l([$("esri.symbols.PathSymbol3DLayer")],fs);const N5=fs;var l3;let $0=l3=class extends j{constructor(){super(...arguments),this.color=new ee([0,0,0,1]),this.size=0}clone(){const t={color:R(this.color),size:this.size};return new l3(t)}};l([c(Tm)],$0.prototype,"color",void 0),l([c(Ic)],$0.prototype,"size",void 0),$0=l3=l([$("esri.symbols.support.Symbol3DHalo")],$0);let yS=class extends Ze(j){constructor(e){super(e),this.color=null}};l([c(Tm)],yS.prototype,"color",void 0),yS=l([$("esri.symbols.support.Symbol3DTextBackground")],yS);var _x;let Us=_x=class extends Oc{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,r){const n={...r,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){var t;return this._userSize!=null?this._userSize:((t=this.font)==null?void 0:t.size)!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new _x({enabled:this.enabled,font:this.font&&R(this.font),halo:this.halo&&R(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:R(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new _x({font:t.font!=null?t.font.clone():new pk,halo:TSe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new no({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new yS({color:t.backgroundColor.clone()}):null})}};function TSe(t,e){return t&&e!=null&&e>0?new $0({color:R(t),size:e}):null}l([c({type:pk,json:{write:!0}})],Us.prototype,"font",null),l([te("font")],Us.prototype,"writeFont",null),l([c({type:$0,json:{write:!0}})],Us.prototype,"halo",void 0),l([c({...eee,json:{default:"center",write:!0}})],Us.prototype,"horizontalAlignment",void 0),l([c({...QQ,json:{default:1,write:!0}})],Us.prototype,"lineHeight",void 0),l([c({type:no,json:{write:!0}})],Us.prototype,"material",void 0),l([c({type:yS,json:{write:!0}})],Us.prototype,"background",void 0),l([c(Ic)],Us.prototype,"size",null),l([c({type:String,json:{write:!0}})],Us.prototype,"text",void 0),l([oe({Text:"text"},{readOnly:!0})],Us.prototype,"type",void 0),l([c({...tee,json:{default:"baseline",write:!0}})],Us.prototype,"verticalAlignment",void 0),Us=_x=l([$("esri.symbols.TextSymbol3DLayer")],Us);const f_=Us;var u3;let Qp=u3=class extends Oc{constructor(t){super(t),this.color=c3.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new u3({color:R(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};l([c({type:ee,nonNullable:!0,json:{type:[Xe],write:(t,e,i)=>e[i]=t.toArray(ee.AlphaMode.UNLESS_OPAQUE),default:()=>c3.clone(),defaultEquals:t=>t.toCss(!0)===c3.toCss(!0)}})],Qp.prototype,"color",void 0),l([oe({Water:"water"},{readOnly:!0})],Qp.prototype,"type",void 0),l([c({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Qp.prototype,"waterbodySize",void 0),l([c({type:Number,json:{write:!0,default:null}})],Qp.prototype,"waveDirection",void 0),l([c({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Qp.prototype,"waveStrength",void 0),Qp=u3=l([$("esri.symbols.WaterSymbol3DLayer")],Qp);const ree=Qp,c3=new ee([0,119,190]);var d3;let gf=d3=class extends q{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new d3({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};l([c({type:String})],gf.prototype,"name",void 0),l([c({type:String})],gf.prototype,"styleUrl",void 0),l([c({type:String})],gf.prototype,"styleName",void 0),l([c({type:ki})],gf.prototype,"portal",void 0),gf=d3=l([$("esri.symbols.support.StyleOrigin")],gf);const i$=gf;var p3;let Ey=p3=class extends q{constructor(){super(...arguments),this.url=""}clone(){return new p3({url:this.url})}};l([c({type:String})],Ey.prototype,"url",void 0),Ey=p3=l([$("esri.symbols.support.Thumbnail")],Ey);const nee={icon:fy,object:F5,line:m_,path:N5,fill:Im,extrude:BQ,text:f_,water:ree},ISe=Y.ofType({base:Oc,key:"type",typeMap:nee,errorContext:"symbol-layer"});let Vu=class extends Pn{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i==null?void 0:i.type,n=r||Y;this._set("symbolLayers",new n)}get color(){return null}set color(e){this.constructed&&U.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){up(e,this._get("symbolLayers"))}readStyleOrigin(e,i,r){if(e.styleUrl&&e.name){const n=fm(e.styleUrl,r);return new i$({styleUrl:n,name:e.name})}if(e.styleName&&e.name)return new i$({portal:(r==null?void 0:r.portal)||ki.getDefault(),styleName:e.styleName,name:e.name});r!=null&&r.messages&&r.messages.push(new Jo("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,i,r,n){if(e.styleUrl&&e.name){let s=j$(e.styleUrl,n);Ho(s)&&(s=kn(s)),i.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&(n!=null&&n.portal)&&!SJ(e.portal.restUrl,n.portal.restUrl)?n!=null&&n.messages&&n.messages.push(new Jo("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Oc||e&&nee[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};l([c({json:{read:!1,write:!1}})],Vu.prototype,"color",null),l([c({type:ISe,nonNullable:!0,json:{write:!0}}),We(RJ)],Vu.prototype,"symbolLayers",null),l([c({type:i$})],Vu.prototype,"styleOrigin",void 0),l([X("styleOrigin")],Vu.prototype,"readStyleOrigin",null),l([te("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Vu.prototype,"writeStyleOrigin",null),l([c({type:Ey,json:{read:!1}})],Vu.prototype,"thumbnail",void 0),l([c({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Vu.prototype,"type",void 0),Vu=l([$("esri.symbols.Symbol3D")],Vu);const lg=Vu;let r1=class extends j{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};l([c({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],r1.prototype,"type",void 0),l([c({readOnly:!0})],r1.prototype,"visible",void 0),r1=l([$("esri.symbols.callouts.Callout3D")],r1);const see=r1;var h3;let wx=h3=class extends j{constructor(t){super(t),this.color=new ee("white")}clone(){return new h3({color:R(this.color)})}};l([c(Tm)],wx.prototype,"color",void 0),wx=h3=l([$("esri.symbols.callouts.LineCallout3DBorder")],wx);const xSe=wx;var m3;let eh=m3=class extends see{constructor(t){super(t),this.type="line",this.color=new ee([0,0,0,1]),this.size=Jr(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new m3({color:R(this.color),size:this.size,border:R(this.border)})}};l([oe({line:"line"})],eh.prototype,"type",void 0),l([c(Tm)],eh.prototype,"color",void 0),l([c(Ic)],eh.prototype,"size",void 0),l([c({type:xSe,json:{write:!0}})],eh.prototype,"border",void 0),l([c({readOnly:!0})],eh.prototype,"visible",null),eh=m3=l([$("esri.symbols.callouts.LineCallout3D")],eh);const oee=eh;function D5(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function aee(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!D5(t)}function iXe(t){return t.type==="point-3d"||t.type==="label-3d"}function rXe(t){return t.horizontalAlignment==="center"}const lee={types:{key:"type",base:see,typeMap:{line:oee}},json:{write:!0}};var f3;let _v=f3=class extends j{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new f3({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};l([c(Ic)],_v.prototype,"screenLength",void 0),l([c({type:Number,nonNullable:!0,json:{write:!0,default:0}})],_v.prototype,"minWorldLength",void 0),l([c({type:Number,json:{write:!0}})],_v.prototype,"maxWorldLength",void 0),_v=f3=l([$("esri.symbols.support.Symbol3DVerticalOffset")],_v);const V5=_v;var Sx;const uee=Y.ofType({base:null,key:"type",typeMap:{text:f_}});let th=Sx=class extends lg{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new uee,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return aee(this)}hasVisibleVerticalOffset(){return D5(this)}clone(){return new Sx({styleOrigin:R(this.styleOrigin),symbolLayers:R(this.symbolLayers),thumbnail:R(this.thumbnail),callout:R(this.callout),verticalOffset:R(this.verticalOffset)})}static fromTextSymbol(t){return new Sx({symbolLayers:new Y([f_.fromTextSymbol(t)])})}};l([c({type:V5,json:{write:!0}})],th.prototype,"verticalOffset",void 0),l([c(lee)],th.prototype,"callout",void 0),l([c({json:{read:!1,write:!1}})],th.prototype,"styleOrigin",void 0),l([c({type:uee})],th.prototype,"symbolLayers",void 0),l([oe({LabelSymbol3D:"label-3d"},{readOnly:!0})],th.prototype,"type",void 0),th=Sx=l([$("esri.symbols.LabelSymbol3D")],th);const hk=th;var $x;const cee=Y.ofType({base:null,key:"type",typeMap:{line:m_,path:N5}}),MSe=Y.ofType({base:null,key:"type",typeMap:{line:m_,path:N5}});let n1=$x=class extends lg{constructor(t){super(t),this.symbolLayers=new cee,this.type="line-3d"}clone(){return new $x({styleOrigin:R(this.styleOrigin),symbolLayers:R(this.symbolLayers),thumbnail:R(this.thumbnail)})}static fromSimpleLineSymbol(t){return new $x({symbolLayers:new Y([m_.fromSimpleLineSymbol(t)])})}};l([c({type:cee,json:{type:MSe}})],n1.prototype,"symbolLayers",void 0),l([oe({LineSymbol3D:"line-3d"},{readOnly:!0})],n1.prototype,"type",void 0),n1=$x=l([$("esri.symbols.LineSymbol3D")],n1);const ug=n1;let ih=class extends Pn{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};l([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],ih.prototype,"angle",void 0),l([c({type:["simple-marker","picture-marker"],readOnly:!0})],ih.prototype,"type",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ih.prototype,"xoffset",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ih.prototype,"yoffset",void 0),l([c({cast:t=>t==="auto"?t:xs(dt(t)),json:{write:!0}})],ih.prototype,"size",void 0),ih=l([$("esri.symbols.MarkerSymbol")],ih);const dee=ih;var Ex;const pee=Y.ofType({base:null,key:"type",typeMap:{fill:Im}});let s1=Ex=class extends lg{constructor(t){super(t),this.symbolLayers=new pee,this.type="mesh-3d"}clone(){return new Ex({styleOrigin:R(this.styleOrigin),symbolLayers:R(this.symbolLayers),thumbnail:R(this.thumbnail)})}static fromSimpleFillSymbol(t){return new Ex({symbolLayers:new Y([Im.fromSimpleFillSymbol(t)])})}};l([c({type:pee})],s1.prototype,"symbolLayers",void 0),l([oe({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],s1.prototype,"type",void 0),s1=Ex=l([$("esri.symbols.MeshSymbol3D")],s1);const y_=s1;function CSe(t,e,i){return e.imageData?$J({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):hee(e.url,i)}function hee(t,e){if(!Ho(t)){const i=LSe(e);if(i)return gb(i,"images",t)}return fm(t,e)}function kSe(t,e,i,r){if(bp(t)){const n=dm(t);if(!n)return;e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&Vy(i.url,e,"url",r)}else Vy(t,e,"url",r)}const mee={json:{read:{source:["imageData","url"],reader:CSe},write:{writer(t,e,i,r){kSe(t,e,this.source,r)}}}},fee={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=hee(e.url,i)),r}}}};function LSe(t){var n,s;if(!t)return null;const{origin:e,layer:i}=t;if(e!=="service"&&e!=="portal-item")return null;const r=i==null?void 0:i.type;return r==="feature"||r==="stream"?(n=i.parsedUrl)==null?void 0:n.path:r==="map-image"||r==="tile"?(s=t.url)==null?void 0:s.path:null}var y3;let ha=y3=class extends qQ{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),i!=null&&(n.width=dt(i)),r!=null&&(n.height=dt(r)),n}clone(){const t=new y3({color:R(this.color),height:this.height,outline:R(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",R(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};l([oe({esriPFS:"picture-fill"},{readOnly:!0})],ha.prototype,"type",void 0),l([c(mee)],ha.prototype,"url",void 0),l([c({type:Number,json:{write:!0}})],ha.prototype,"xscale",void 0),l([c({type:Number,json:{write:!0}})],ha.prototype,"yscale",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ha.prototype,"width",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ha.prototype,"height",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ha.prototype,"xoffset",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],ha.prototype,"yoffset",void 0),l([c(fee)],ha.prototype,"source",void 0),ha=y3=l([$("esri.symbols.PictureFillSymbol")],ha);const U5=ha;var g3;let Tl=g3=class extends dee{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=dt(e)),i!=null&&(r.height=dt(i)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new g3({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",R(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};l([c({json:{write:!1}})],Tl.prototype,"color",void 0),l([oe({esriPMS:"picture-marker"},{readOnly:!0})],Tl.prototype,"type",void 0),l([c(mee)],Tl.prototype,"url",void 0),l([c(fee)],Tl.prototype,"source",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],Tl.prototype,"height",void 0),l([X("height",["height","size"])],Tl.prototype,"readHeight",null),l([c({type:Number,cast:dt,json:{write:!0}})],Tl.prototype,"width",void 0),l([c({json:{write:!1}})],Tl.prototype,"size",void 0),Tl=g3=l([$("esri.symbols.PictureMarkerSymbol")],Tl);const g_=Tl;var vf;const yee=Y.ofType({base:null,key:"type",typeMap:{icon:fy,object:F5,text:f_}});let bf=vf=class extends lg{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new yee,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return aee(this)}hasVisibleVerticalOffset(){return D5(this)}clone(){return new vf({verticalOffset:R(this.verticalOffset),callout:R(this.callout),styleOrigin:R(this.styleOrigin),symbolLayers:R(this.symbolLayers),thumbnail:R(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new vf({symbolLayers:new Y([fy.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new vf({symbolLayers:new Y([fy.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){var r,n;if(((n=(r=t.data)==null?void 0:r.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const i=t.data.symbol;return new vf(i!=null&&i.callout?{symbolLayers:new Y([fy.fromCIMSymbol(t)]),callout:new oee({size:.5,color:new ee([0,0,0])}),verticalOffset:new V5({screenLength:40})}:{symbolLayers:new Y([fy.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new vf({symbolLayers:new Y([f_.fromTextSymbol(t)])})}};l([c({type:V5,json:{write:!0}})],bf.prototype,"verticalOffset",void 0),l([c(lee)],bf.prototype,"callout",void 0),l([c({type:yee,json:{origins:{"web-scene":{write:!0}}}})],bf.prototype,"symbolLayers",void 0),l([oe({PointSymbol3D:"point-3d"},{readOnly:!0})],bf.prototype,"type",void 0),bf=vf=l([$("esri.symbols.PointSymbol3D")],bf);const Zd=bf;var o1;const gee=Y.ofType({base:null,key:"type",typeMap:{extrude:BQ,fill:Im,icon:fy,line:m_,object:F5,text:f_,water:ree}});let a1=o1=class extends lg{constructor(t){super(t),this.symbolLayers=new gee,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&FS(U.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&FS(U.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(St(()=>this.symbolLayers,"after-add",({item:e})=>t(e),yn))}clone(){return new o1({styleOrigin:R(this.styleOrigin),symbolLayers:R(this.symbolLayers),thumbnail:R(this.thumbnail)})}static fromJSON(t){var i;const e=new o1;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||(i=t.symbolLayers)!=null&&i[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:n.size,color:n.material!=null?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new o1({symbolLayers:new Y([Im.fromSimpleFillSymbol(t)])})}};l([c({type:gee,json:{write:!0}})],a1.prototype,"symbolLayers",void 0),l([oe({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],a1.prototype,"type",void 0),a1=o1=l([$("esri.symbols.PolygonSymbol3D")],a1);const xm=a1;var v3;const JL=new $e({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let _f=v3=class extends qQ{constructor(...t){super(...t),this.color=new ee([0,0,0,.25]),this.outline=new yr,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),i&&(r.color=i),r}clone(){return new v3({color:R(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};l([c()],_f.prototype,"color",void 0),l([c()],_f.prototype,"outline",void 0),l([oe({esriSFS:"simple-fill"},{readOnly:!0})],_f.prototype,"type",void 0),l([c({type:JL.apiValues,json:{read:JL.read,write:JL.write}})],_f.prototype,"style",void 0),_f=v3=l([$("esri.symbols.SimpleFillSymbol")],_f);const Qo=_f,ASe=Object.freeze(Object.defineProperty({__proto__:null,default:Qo},Symbol.toStringTag,{value:"Module"}));var b3;const YL=new $e({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Uu=b3=class extends dee{constructor(...t){super(...t),this.color=new ee([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new yr}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string")return t;const n={};return t&&(n.style=t),e!=null&&(n.size=dt(e)),i&&(n.outline=i),r&&(n.color=r),n}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new b3({angle:this.angle,color:R(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};l([c()],Uu.prototype,"color",void 0),l([te("color")],Uu.prototype,"writeColor",null),l([oe({esriSMS:"simple-marker"},{readOnly:!0})],Uu.prototype,"type",void 0),l([c()],Uu.prototype,"size",void 0),l([c({type:YL.apiValues,json:{read:YL.read,write:YL.write}})],Uu.prototype,"style",void 0),l([c({type:String,json:{write:!0}})],Uu.prototype,"path",null),l([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":yr}},json:{default:null,write:!0}})],Uu.prototype,"outline",void 0),Uu=b3=l([$("esri.symbols.SimpleMarkerSymbol")],Uu);const Or=Uu,OSe=Object.freeze(Object.defineProperty({__proto__:null,default:Or},Symbol.toStringTag,{value:"Module"}));var _3;let Ei=_3=class extends Pn{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new pk,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),i&&(r.color=i),r}writeLineWidth(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}castLineWidth(t){return dt(t)}writeLineHeight(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}clone(){return new _3({angle:this.angle,backgroundColor:R(this.backgroundColor),borderLineColor:R(this.borderLineColor),borderLineSize:this.borderLineSize,color:R(this.color),font:this.font&&this.font.clone(),haloColor:R(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t,e,i;return`${(t=this.backgroundColor)==null?void 0:t.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(e=this.color)==null?void 0:e.hash()}.${this.font&&this.font.hash()}.${(i=this.haloColor)==null?void 0:i.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};l([c({type:ee,json:{write:!0}})],Ei.prototype,"backgroundColor",void 0),l([c({type:ee,json:{write:!0}})],Ei.prototype,"borderLineColor",void 0),l([c({type:Number,json:{write:!0},cast:dt})],Ei.prototype,"borderLineSize",void 0),l([c({type:pk,json:{write:!0}})],Ei.prototype,"font",void 0),l([c({...eee,json:{write:!0}})],Ei.prototype,"horizontalAlignment",void 0),l([c({type:Boolean,json:{write:!0}})],Ei.prototype,"kerning",void 0),l([c({type:ee,json:{write:!0}})],Ei.prototype,"haloColor",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],Ei.prototype,"haloSize",void 0),l([c({type:Boolean,json:{write:!0}})],Ei.prototype,"rightToLeft",void 0),l([c({type:Boolean,json:{write:!0}})],Ei.prototype,"rotated",void 0),l([c({type:String,json:{write:!0}})],Ei.prototype,"text",void 0),l([oe({esriTS:"text"},{readOnly:!0})],Ei.prototype,"type",void 0),l([c({...tee,json:{write:!0}})],Ei.prototype,"verticalAlignment",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],Ei.prototype,"xoffset",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],Ei.prototype,"yoffset",void 0),l([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Ei.prototype,"angle",void 0),l([c({type:Number,json:{write:!0}})],Ei.prototype,"width",void 0),l([c({type:Number})],Ei.prototype,"lineWidth",void 0),l([te("lineWidth")],Ei.prototype,"writeLineWidth",null),l([We("lineWidth")],Ei.prototype,"castLineWidth",null),l([c(QQ)],Ei.prototype,"lineHeight",void 0),l([te("lineHeight")],Ei.prototype,"writeLineHeight",null),Ei=_3=l([$("esri.symbols.TextSymbol")],Ei);const cg=Ei;var w3;let Il=w3=class extends Pn{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:ki.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new w3({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=e!=null?e.cache:null,r=i?this._fetchCacheKey:null;if(i!=null){const a=r&&i.get(r);if(a)return a.clone()}const{resolveWebStyleSymbol:n}=await k(()=>Promise.resolve().then(()=>r4e),void 0);qe(e);const s=n(this,{portal:this.portal},t,e);s.catch(a=>{U.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",a)});const o=await s;return t==="webRef"&&o.type==="point-3d"||t==="cimRef"&&o.type==="cim"?(i!=null&&i.set(r,o.clone()),o):null}};l([c({json:{write:!1}})],Il.prototype,"color",void 0),l([c({type:String,json:{write:!0}})],Il.prototype,"styleName",void 0),l([c({type:ki,json:{write:!1}})],Il.prototype,"portal",void 0),l([c({type:String,json:{read:FV,write:Vy}})],Il.prototype,"styleUrl",void 0),l([c({type:Ey,json:{read:!1}})],Il.prototype,"thumbnail",void 0),l([c({type:String,json:{write:!0}})],Il.prototype,"name",void 0),l([oe({styleSymbolReference:"web-style"},{readOnly:!0})],Il.prototype,"type",void 0),l([c()],Il.prototype,"_fetchCacheKey",null),Il=w3=l([$("esri.symbols.WebStyleSymbol")],Il);const dg=Il;function mk(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function xc(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Ha={base:Pn,key:"type",typeMap:{"simple-fill":Qo,"picture-fill":U5,"picture-marker":g_,"simple-line":yr,"simple-marker":Or,text:cg,"label-3d":hk,"line-3d":ug,"mesh-3d":y_,"point-3d":Zd,"polygon-3d":xm,"web-style":dg,cim:Sp},errorContext:"symbol"},sXe={base:Pn,key:"type",typeMap:{"picture-marker":g_,"simple-marker":Or,"point-3d":Zd,cim:Sp},errorContext:"symbol"},oXe={base:Pn,key:"type",typeMap:{"simple-line":yr,"line-3d":ug,cim:Sp},errorContext:"symbol"},aXe={base:Pn,key:"type",typeMap:{"simple-fill":Qo,"picture-fill":U5,"polygon-3d":xm,cim:Sp},errorContext:"symbol"},RSe={base:Pn,key:"type",typeMap:{"picture-marker":g_,"simple-marker":Or,text:cg,"web-style":dg,cim:Sp},errorContext:"symbol"},PSe=s_({types:Ha}),vee={base:Pn,key:"type",typeMap:{"simple-fill":Qo,"picture-fill":U5,"picture-marker":g_,"simple-line":yr,"simple-marker":Or,text:cg,"line-3d":ug,"mesh-3d":y_,"point-3d":Zd,"polygon-3d":xm,"web-style":dg,cim:Sp},errorContext:"symbol"},FSe={base:Pn,key:"type",typeMap:{text:cg,"label-3d":hk},errorContext:"symbol"},Q6={base:Pn,key:"type",typeMap:{"line-3d":ug,"mesh-3d":y_,"point-3d":Zd,"polygon-3d":xm,"web-style":dg,cim:Sp},errorContext:"symbol"},NSe={base:Pn,key:"type",typeMap:{"label-3d":hk},errorContext:"symbol"},bee=Qa(Ha);var S3;function DSe(t){if(!t)return null;const e={};for(const i in t){const r=dp(t[i]);r&&(e[i]=r)}return Object.keys(e).length!==0?e:null}function VSe(t){if(t==null)return null;const e={};for(const i in t){const r=t[i];r&&(e[i]=r.toJSON())}return Object.keys(e).length!==0?e:null}let js=S3=class extends Ze(j){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:rm(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&Hde(U.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),(t==null?void 0:t.type)!=="mesh"&&this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}get version(){return this._version}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new S3({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[e,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(t&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var t;return{aggregateGeometries:VSe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:qM(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((t=this.popupTemplate)==null?void 0:t.toJSON())??null}}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,r){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};t==="origin-transform"&&(n.action=r),t==="attributes"&&(n.attributeName=r),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([Hi(()=>{var t,e;return((t=this.geometry)==null?void 0:t.type)==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:(e=this.geometry.transform)==null?void 0:e.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0},({localMatrix:t,origin:e})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===e||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=e,this.notifyMeshTransformChanged())}),Hi(()=>{var t;return((t=this.geometry)==null?void 0:t.type)==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0},()=>{var e;const t=this.geometry;(t==null?void 0:t.type)==="mesh"&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=(e=t.transform)==null?void 0:e.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(t,e)=>t===e,sync:!0})])}};l([c({value:null,json:{read:DSe}})],js.prototype,"aggregateGeometries",null),l([c({value:null})],js.prototype,"attributes",null),l([c({value:null,types:rg,json:{read:dp}})],js.prototype,"geometry",null),l([c({type:Boolean})],js.prototype,"isAggregate",void 0),l([c({clonable:"reference"})],js.prototype,"layer",void 0),l([c({clonable:"reference"})],js.prototype,"origin",void 0),l([c({type:ag})],js.prototype,"popupTemplate",void 0),l([c({clonable:"reference"})],js.prototype,"sourceLayer",void 0),l([c({value:null,types:Ha})],js.prototype,"symbol",null),l([c({clonable:!1,json:{read:!1,write:!1}})],js.prototype,"_version",void 0),l([c({type:Boolean,value:!0})],js.prototype,"visible",null),js=S3=l([$("esri.Graphic")],js);const Li=js;var $3;let l1=$3=class extends j{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new $3({minValue:this.minValue,maxValue:this.maxValue})}};l([c({type:Number,json:{write:!0}})],l1.prototype,"minValue",void 0),l([c({type:Number,json:{write:!0}})],l1.prototype,"maxValue",void 0),l1=$3=l([$("esri.renderers.support.AuthoringInfoClassBreakInfo")],l1);var E3;let Vh=E3=class extends j{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new E3({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:R(this.classBreakInfos)})}};l([c({type:String,json:{write:!0}})],Vh.prototype,"field",void 0),l([c({type:String,json:{write:!0}})],Vh.prototype,"normalizationField",void 0),l([c({type:String,json:{write:!0}})],Vh.prototype,"label",void 0),l([c({type:[l1],json:{write:!0}})],Vh.prototype,"classBreakInfos",void 0),Vh=E3=l([$("esri.renderers.support.AuthoringInfoFieldInfo")],Vh);var T3;let wv=T3=class extends j{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new T3({label:this.label,value:this.value,size:this.size})}};l([c({type:String,json:{write:!0}})],wv.prototype,"label",void 0),l([c({type:Number,json:{write:!0}})],wv.prototype,"size",void 0),l([c({type:Number,json:{write:!0}})],wv.prototype,"value",void 0),wv=T3=l([$("esri.renderers.support.AuthoringInfoSizeStop")],wv);const USe=wv;var I3;const gT=new $e({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),vT=new $e({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),ez={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},tz=["high-to-low","above-and-below","centered-on","extremes"],iz=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size"])],rz=["seconds","minutes","hours","days","months","years"],jSe=["circle","diamond","hexagon-flat","hexagon-pointy","square"];let rn=I3=class extends j{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new I3({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:R(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};l([c({types:ez,json:{write:!0}})],rn.prototype,"endTime",void 0),l([We("endTime")],rn.prototype,"castEndTime",null),l([c({type:String,json:{write:!0}})],rn.prototype,"field",void 0),l([c({type:Number,json:{write:!0}})],rn.prototype,"maxSliderValue",void 0),l([c({type:Number,json:{write:!0}})],rn.prototype,"minSliderValue",void 0),l([c({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],rn.prototype,"normalizationField",null),l([c({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],rn.prototype,"referenceSizeScale",null),l([c({type:jSe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],rn.prototype,"referenceSizeSymbolStyle",null),l([c({types:ez,json:{write:!0}})],rn.prototype,"startTime",void 0),l([We("startTime")],rn.prototype,"castStartTime",null),l([c({type:[USe],json:{origins:{"web-scene":{write:!1}},write:!0}})],rn.prototype,"sizeStops",null),l([c({type:gT.apiValues,value:null,json:{type:gT.jsonValues,read:gT.read,write:gT.write}})],rn.prototype,"style",null),l([c({type:iz,value:null,json:{type:iz,origins:{"web-scene":{type:tz,write:{writer:(t,e)=>{tz.includes(t)&&(e.theme=t)}}}},write:!0}})],rn.prototype,"theme",null),l([c({type:vT.apiValues,json:{type:vT.jsonValues,read:vT.read,write:vT.write}})],rn.prototype,"type",void 0),l([c({type:rz,json:{type:rz,write:!0}})],rn.prototype,"units",void 0),rn=I3=l([$("esri.renderers.support.AuthoringInfoVisualVariable")],rn);const GSe=rn;let Tx=class extends j{constructor(e){super(e),this.type=null}};l([c({readOnly:!0,json:{read:!1,write:!0}})],Tx.prototype,"type",void 0),Tx=l([$("esri.rest.support.ColorRamp")],Tx);const j5=Tx;var x3;let wf=x3=class extends j5{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new x3({fromColor:R(this.fromColor),toColor:R(this.toColor),algorithm:this.algorithm})}};l([oe({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],wf.prototype,"algorithm",void 0),l([c({type:ee,json:{type:[Xe],write:!0}})],wf.prototype,"fromColor",void 0),l([c({type:ee,json:{type:[Xe],write:!0}})],wf.prototype,"toColor",void 0),l([c({type:["algorithmic"]})],wf.prototype,"type",void 0),wf=x3=l([$("esri.rest.support.AlgorithmicColorRamp")],wf);const G5=wf;var M3;let u1=M3=class extends j5{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new M3({colorRamps:R(this.colorRamps)})}};l([c({type:[G5],json:{write:!0}})],u1.prototype,"colorRamps",void 0),l([c({type:["multipart"]})],u1.prototype,"type",void 0),u1=M3=l([$("esri.rest.support.MultipartColorRamp")],u1);const _ee=u1,zSe={key:"type",base:j5,typeMap:{algorithmic:G5,multipart:_ee}};function BSe(t){return t!=null&&t.type?t.type==="algorithmic"?G5.fromJSON(t):t.type==="multipart"?_ee.fromJSON(t):null:null}var C3;const Fm=new $e({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),bT=new $e({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),nz=new $e({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),sz=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],HSe=["high-to-low","above-and-below","above","below"],qSe=["flow-line","wave-front"],WSe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Gi=C3=class extends j{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?BSe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){var t;return new C3({classificationMethod:this.classificationMethod,colorRamp:R(this.colorRamp),fadeRatio:R(this.fadeRatio),fields:(t=this.fields)==null?void 0:t.slice(),field1:R(this.field1),field2:R(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(e=>e.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};l([c({type:Fm.apiValues,value:null,json:{type:Fm.jsonValues,read:Fm.read,write:Fm.write,origins:{"web-document":{default:"manual",type:Fm.jsonValues,read:Fm.read,write:Fm.write}}}})],Gi.prototype,"classificationMethod",null),l([c({types:zSe,json:{write:!0}})],Gi.prototype,"colorRamp",void 0),l([X("colorRamp")],Gi.prototype,"readColorRamp",null),l([c({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Gi.prototype,"fadeRatio",void 0),l([c({type:[String],value:null,json:{write:!0}})],Gi.prototype,"fields",null),l([c({type:Vh,value:null,json:{write:!0}})],Gi.prototype,"field1",null),l([c({type:Vh,value:null,json:{write:!0}})],Gi.prototype,"field2",null),l([c({type:qSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Gi.prototype,"flowTheme",null),l([c({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Gi.prototype,"focus",null),l([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Gi.prototype,"isAutoGenerated",void 0),l([c({type:Number,value:null,json:{type:Xe,write:!0}})],Gi.prototype,"numClasses",null),l([c({type:sz,json:{type:sz,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Gi.prototype,"lengthUnit",void 0),l([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Gi.prototype,"maxSliderValue",void 0),l([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Gi.prototype,"minSliderValue",void 0),l([c({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Gi.prototype,"statistics",null),l([c({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Gi.prototype,"standardDeviationInterval",null),l([c({type:bT.apiValues,value:null,json:{type:bT.jsonValues,read:bT.read,write:bT.write,origins:{"web-scene":{type:nz.jsonValues,write:{writer:nz.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],Gi.prototype,"type",null),l([c({type:[GSe],json:{write:!0}})],Gi.prototype,"visualVariables",void 0),l([c({type:WSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Gi.prototype,"univariateSymbolStyle",null),l([c({type:HSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Gi.prototype,"univariateTheme",null),Gi=C3=l([$("esri.renderers.support.AuthoringInfo")],Gi);const z5=Gi,KL=new $e({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let c1=class extends j{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,e),Array.from(i).sort()}getSymbol(e,i){}async getSymbolAsync(e,i){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};l([c({type:z5,json:{write:!0}})],c1.prototype,"authoringInfo",void 0),l([c({type:KL.apiValues,readOnly:!0,json:{type:KL.jsonValues,read:!1,write:{writer:KL.write,ignoreOrigin:!0}}})],c1.prototype,"type",void 0),c1=l([$("esri.renderers.Renderer")],c1);const $p=c1;function ZSe(t){var e,i;return((i=(e=t.match(JSe))==null?void 0:e[1])==null?void 0:i.replace(/\\'/g,"'"))??null}const JSe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let d1=class extends Ze(j){constructor(){super(...arguments),this.showLegend=null,this.title=null}};l([c({type:Boolean,json:{write:!0}})],d1.prototype,"showLegend",void 0),l([c({type:String,json:{write:!0}})],d1.prototype,"title",void 0),d1=l([$("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],d1);const wee=d1,XL=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let xl=class extends j{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):F$(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};l([c()],xl.prototype,"index",void 0),l([c({type:XL.apiValues,readOnly:!0,json:{read:XL.read,write:XL.write}})],xl.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],xl.prototype,"field",void 0),l([We("field")],xl.prototype,"castField",null),l([c({type:String,json:{write:!0}})],xl.prototype,"valueExpression",void 0),l([c({type:String,json:{write:!0}})],xl.prototype,"valueExpressionTitle",void 0),l([c({readOnly:!0})],xl.prototype,"arcadeRequired",null),l([c({type:wee,json:{write:!0}})],xl.prototype,"legendOptions",void 0),xl=l([$("esri.renderers.visualVariables.VisualVariable")],xl);const v_=xl;var k3;let Sf=k3=class extends j{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new k3({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};l([c({type:ee,json:{type:[Xe],write:!0}})],Sf.prototype,"color",void 0),l([c({type:String,json:{write:!0}})],Sf.prototype,"label",void 0),l([c({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],Sf.prototype,"value",void 0),l([te("value")],Sf.prototype,"writeValue",null),Sf=k3=l([$("esri.renderers.visualVariables.support.ColorStop")],Sf);const YSe=Sf;var L3;let $f=L3=class extends v_{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new L3({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};l([c({readOnly:!0})],$f.prototype,"cache",null),l([c({type:["color"],json:{type:["colorInfo"]}})],$f.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],$f.prototype,"normalizationField",void 0),l([c({type:[YSe],json:{write:!0}})],$f.prototype,"stops",null),$f=L3=l([$("esri.renderers.visualVariables.ColorVariable")],$f);const See=$f;var A3;let rh=A3=class extends j{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return WS(e.transparency)}writeOpacity(t,e,i){e[i]=WC(t)}clone(){return new A3({label:this.label,opacity:this.opacity,value:this.value})}};l([c({type:String,json:{write:!0}})],rh.prototype,"label",void 0),l([c({type:Number,json:{type:Xe,write:{target:"transparency"}}})],rh.prototype,"opacity",void 0),l([X("opacity",["transparency"])],rh.prototype,"readOpacity",null),l([te("opacity")],rh.prototype,"writeOpacity",null),l([c({type:Number,json:{write:!0}})],rh.prototype,"value",void 0),rh=A3=l([$("esri.renderers.visualVariables.support.OpacityStop")],rh);const KSe=rh;var O3;let Ef=O3=class extends v_{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new O3({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};l([c({readOnly:!0})],Ef.prototype,"cache",null),l([c({type:["opacity"],json:{type:["transparencyInfo"]}})],Ef.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],Ef.prototype,"normalizationField",void 0),l([c({type:[KSe],json:{write:!0}})],Ef.prototype,"stops",null),Ef=O3=l([$("esri.renderers.visualVariables.OpacityVariable")],Ef);const B5=Ef;var R3;let nd=R3=class extends v_{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,r){if(r!=null&&r.messages){const n=`visualVariables[${this.index}]`;r.messages.push(new L("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpressionTitle",context:r}))}}clone(){var t;return new R3({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}};l([c({readOnly:!0})],nd.prototype,"cache",null),l([c({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],nd.prototype,"axis",void 0),l([c({type:["rotation"],json:{type:["rotationInfo"]}})],nd.prototype,"type",void 0),l([c({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],nd.prototype,"rotationType",void 0),l([c({type:String,json:{write:!0}})],nd.prototype,"valueExpressionTitle",void 0),l([te("web-scene","valueExpressionTitle")],nd.prototype,"writeValueExpressionTitleWebScene",null),nd=R3=l([$("esri.renderers.visualVariables.RotationVariable")],nd);const $ee=nd;function XSe(t){return dt(t)}var P3;let nh=P3=class extends j{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new P3({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};l([c({type:String,json:{write:!0}})],nh.prototype,"label",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],nh.prototype,"size",void 0),l([c({type:Number,json:{write:!0}})],nh.prototype,"value",void 0),l([c({type:Boolean,json:{write:!1}})],nh.prototype,"useMinValue",void 0),l([c({type:Boolean,json:{write:!1}})],nh.prototype,"useMaxValue",void 0),nh=P3=l([$("esri.renderers.visualVariables.support.SizeStop")],nh);const Ix=nh;let xx=class extends wee{constructor(){super(...arguments),this.customValues=null}};l([c({type:[Number],json:{write:!0}})],xx.prototype,"customValues",void 0),xx=l([$("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],xx);const Eee=xx;var tp,Mr;function E0(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function r$(t){return t!=null&&!isNaN(t)&&isFinite(t)}function Tee(t){return t.valueExpression?tp.Expression:t.field&&typeof t.field=="string"?tp.Field:tp.Unknown}function Iee(t,e){const i=e||Tee(t),r=t.valueUnit||"unknown";return i===tp.Unknown?Mr.Constant:t.stops?Mr.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?Mr.ClampedLinear:r==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?Mr.Proportional:Mr.Additive:Mr.Identity:Mr.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(tp||(tp={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(Mr||(Mr={}));const rE={unknown:1,inches:Oe(1,"meters","inches"),feet:Oe(1,"meters","feet"),"us-feet":Oe(1,"meters","us-feet"),yards:Oe(1,"meters","yards"),miles:Oe(1,"meters","miles"),"nautical-miles":Oe(1,"meters","nautical-miles"),millimeters:Oe(1,"meters","millimeters"),centimeters:Oe(1,"meters","centimeters"),decimeters:Oe(1,"meters","decimeters"),meters:Oe(1,"meters","meters"),kilometers:Oe(1,"meters","kilometers"),"decimal-degrees":1/gfe(1,"meters",Wi.radius)},xee=()=>U.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),fk=t=>xee().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),yk=()=>xee().error("Use of arcade expressions requires an arcade context"),oz=new Li,Mx=Math.PI,Mee=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function Cee(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="color"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void fk("ColorVariable");const n=typeof e=="number",s=n?null:e,o=s==null?void 0:s.attributes;let a=n?e:null;const u=r.field,{ipData:d,hasExpression:p}=r.cache;let h=r.cache.compiledFunc;if(!u&&!p){const g=r.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(p){if((i==null?void 0:i.arcade)==null)return void yk();const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},v=i.arcade.arcadeUtils,_=v.getViewInfo(g),w=v.createExecContext(s,_,i.timeZone);if(!h){const S=v.createSyntaxTree(r.valueExpression);h=v.createFunction(S),r.cache.compiledFunc=h}a=v.executeFunction(h,w)}else o&&(a=o[u]);const m=r.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||n||!isNaN(y)&&y!==0)){isNaN(y)||n||(a/=y);const g=q5(a,d);if(g){const v=g[0],_=g[1],w=v===_?r.stops[v].color:ee.blendColors(r.stops[v].color,r.stops[_].color,g[2],i!=null?i.color:void 0);return new ee(w)}}}function kee(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="opacity"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void fk("OpacityVariable");const n=typeof e=="number",s=n?null:e,o=s==null?void 0:s.attributes;let a=n?e:null;const u=r.field,{ipData:d,hasExpression:p}=r.cache;let h=r.cache.compiledFunc;if(!u&&!p){const g=r.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(p){if((i==null?void 0:i.arcade)==null)return void yk();const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},v=i.arcade.arcadeUtils,_=v.getViewInfo(g),w=v.createExecContext(s,_,i.timeZone);if(!h){const S=v.createSyntaxTree(r.valueExpression);h=v.createFunction(S),r.cache.compiledFunc=h}a=v.executeFunction(h,w)}else o&&(a=o[u]);const m=r.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||n||!isNaN(y)&&y!==0)){isNaN(y)||n||(a/=y);const g=q5(a,d);if(g){const v=g[0],_=g[1];if(v===_)return r.stops[v].opacity;{const w=r.stops[v].opacity;return w+(r.stops[_].opacity-w)*g[2]}}}}function H5(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(y=>y.type==="rotation"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void fk("RotationVariable");const n=r.axis||"heading",s=n==="heading"&&r.rotationType==="arithmetic"?90:0,o=n==="heading"&&r.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,u=a==null?void 0:a.attributes,d=r.field,{hasExpression:p}=r.cache;let h=r.cache.compiledFunc,m=0;if(!d&&!p)return m;if(p){if((i==null?void 0:i.arcade)==null)return void yk();const y={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},g=i.arcade.arcadeUtils,v=g.getViewInfo(y),_=g.createExecContext(a,v,i.timeZone);if(!h){const w=g.createSyntaxTree(r.valueExpression);h=g.createFunction(w),r.cache.compiledFunc=h}m=g.executeFunction(h,_)}else u&&(m=u[d]||0);return m=typeof m!="number"||isNaN(m)?null:s+o*m,m}function QSe(t,e,i){const r=typeof e=="number",n=r?null:e,s=n==null?void 0:n.attributes;let o=r?e:null;const{isScaleDriven:a}=t.cache;let u=t.cache.compiledFunc;if(a){const p=i!=null?i.scale:void 0,h=i!=null?i.view:void 0;o=p==null||h==="3d"?e$e(t):p}else if(!r)switch(t.inputValueType){case tp.Expression:{if((i==null?void 0:i.arcade)==null)return void yk();const p={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},h=i.arcade.arcadeUtils,m=h.getViewInfo(p),y=h.createExecContext(n,m,i.timeZone);if(!u){const g=h.createSyntaxTree(t.valueExpression);u=h.createFunction(g),t.cache.compiledFunc=u}o=h.executeFunction(u,y);break}case tp.Field:s&&(o=s[t.field]);break;case tp.Unknown:o=null}if(!r$(o))return null;if(r||!t.normalizationField)return o;const d=s?parseFloat(s[t.normalizationField]):null;return r$(d)&&d!==0?o/d:null}function e$e(t){let e=null,i=null;const r=t.stops;return r?(e=r[0].value,i=r[r.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function nE(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(s=>s.type==="size"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void fk("SizeVariable");const n=Aee(QSe(r,e,i),r,e,i,r.cache.ipData);return n==null||isNaN(n)?0:n}function oo(t,e,i){return t==null?null:E0(t)?nE(t,e,i):r$(t)?t:null}function Lee(t,e,i){return r$(i)&&t>i?i:r$(e)&&t<e?e:t}function t$e(t,e,i,r){return t+((oo(e.minSize,i,r)||e.minDataValue)??0)}function i$e(t,e,i){const r=t.stops;let n=(r==null?void 0:r.length)&&r[0].size;return n==null&&(n=t.minSize),oo(n,e,i)}function r$e(t,e,i,r){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),s=oo(e.minSize,i,r),o=oo(e.maxSize,i,r),a=r!=null?r.shape:void 0;if(t<=e.minDataValue)return s;if(t>=e.maxDataValue)return o;if(s==null||o==null)return null;if(e.scaleBy==="area"&&a){const u=a==="circle",d=u?Mx*(s/2)**2:s*s,p=d+n*((u?Mx*(o/2)**2:o*o)-d);return u?2*Math.sqrt(p/Mx):Math.sqrt(p)}return s+n*(o-s)}function n$e(t,e,i,r){const n=r!=null?r.shape:void 0,s=t/e.minDataValue,o=oo(e.minSize,i,r),a=oo(e.maxSize,i,r);let u=null;return u=n==="circle"?2*Math.sqrt(s*(o/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(s*o**2):s*o,Lee(u,o,a)}function s$e(t,e,i,r,n){var u,d,p;const[s,o,a]=q5(t,n);if(s===o)return oo((u=e.stops)==null?void 0:u[s].size,i,r);{const h=oo((d=e.stops)==null?void 0:d[s].size,i,r);return h+(oo((p=e.stops)==null?void 0:p[o].size,i,r)-h)*a}}function o$e(t,e,i,r){const n=((r==null?void 0:r.resolution)??1)*rE[e.valueUnit],s=oo(e.minSize,i,r),o=oo(e.maxSize,i,r),{valueRepresentation:a}=e;let u=null;return u=a==="area"?2*Math.sqrt(t/Mx)/n:a==="radius"||a==="distance"?2*t/n:t/n,Lee(u,s,o)}function Aee(t,e,i,r,n){switch(e.transformationType){case Mr.Additive:return t$e(t,e,i,r);case Mr.Constant:return i$e(e,i,r);case Mr.ClampedLinear:return r$e(t,e,i,r);case Mr.Proportional:return n$e(t,e,i,r);case Mr.Stops:return s$e(t,e,i,r,n);case Mr.RealWorldSize:return o$e(t,e,i,r);case Mr.Identity:return t;case Mr.Unknown:return null}}function Oee(t,e,i){const{isScaleDriven:r}=t.cache;if(!(r&&i==="3d"||e))return null;const n={scale:e,view:i};let s=oo(t.minSize,oz,n),o=oo(t.maxSize,oz,n);if(s!=null||o!=null){if(s>o){const a=o;o=s,s=a}return{minSize:s,maxSize:o}}}function a$e(t,e,i){if(!t.visualVariables)return;const r=[],n=[],s=[],o=[],a=[];for(const u of t.visualVariables)switch(u.type){case"color":n.push(u);break;case"opacity":s.push(u);break;case"rotation":a.push(u);break;case"size":o.push(u)}return n.forEach(u=>{const d=Cee(u,e,i);r.push({variable:u,value:d})}),s.forEach(u=>{const d=kee(u,e,i);r.push({variable:u,value:d})}),a.forEach(u=>{const d=H5(u,e,i);r.push({variable:u,value:d})}),o.forEach(u=>{const d=nE(u,e,i);r.push({variable:u,value:d})}),r.filter(u=>u.value!=null)}function q5(t,e){if(!e)return;let i=0,r=e.length-1;return e.some((n,s)=>t<n?(r=s,!0):(i=s,!1)),[i,r,(t-e[i])/(e[r]-e[i])]}function l$e(t,e,i){const r=["proportional","proportional","proportional"];for(const n of t){const s=n.useSymbolValue?"symbol-value":nE(n,e,i);switch(n.axis){case"width":r[0]=s;break;case"depth":r[1]=s;break;case"height":r[2]=s;break;case"width-and-depth":r[0]=s,r[1]=s;break;case"all":case void 0:case null:r[0]=s,r[1]=s,r[2]=s;break;default:n.axis}}return r}const pg=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:l$e,getColor:Cee,getOpacity:kee,getRotationAngle:H5,getSize:nE,getSizeForValue:Aee,getSizeFromNumberOrVariable:oo,getSizeRangeAtScale:Oee,getVisualVariableValues:a$e,viewScaleRE:Mee},Symbol.toStringTag,{value:"Module"}));var F3;const _T=new $e({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),N3=new $e({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function az(t){if(t!=null)return typeof t=="string"||typeof t=="number"?XSe(t):t.type==="size"?E0(t)?t:(delete(t={...t}).type,new Mt(t)):void 0}function lz(t,e,i){if(typeof t!="object")return t;const r=new Mt;return r.read(t,i),r}let Mt=F3=class extends v_{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&Mee.test(this.valueExpression)}}set index(t){E0(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),E0(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return Tee(this)}set maxDataValue(t){t&&this.stops&&(U.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(U.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return az(t)}readMaxSize(t,e,i){return lz(t,e,i)}set minDataValue(t){t&&this.stops&&(U.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(U.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return az(t)}readMinSize(t,e,i){return lz(t,e,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value):t&&(U.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Iee(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,r){if(t==="$view.scale"){if(r!=null&&r.messages){const n=this.index,s=typeof n=="string"?n:`visualVariables[${n}]`;r.messages.push(new L("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:s+".valueExpression",context:r}))}}else e[i]=t}readValueUnit(t){return t?N3.read(t):null}clone(){var t,e;return new F3({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:E0(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:E0(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(t=this.stops)==null?void 0:t.map(i=>i.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}flipSizes(){if(this.transformationType===Mr.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===Mr.Stops){const t=this.stops;if(!t)return this;const e=t.map(r=>r.size).reverse(),i=t.length;for(let r=0;r<i;r++)t[r].size=e[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var t;return(t=this.stops)==null?void 0:t.map(e=>e.value||0)}};l([c({readOnly:!0})],Mt.prototype,"cache",null),l([c({type:_T.apiValues,json:{type:_T.jsonValues,origins:{"web-map":{read:!1}},read:_T.read,write:_T.write}})],Mt.prototype,"axis",void 0),l([c()],Mt.prototype,"index",null),l([c({type:String,readOnly:!0})],Mt.prototype,"inputValueType",null),l([c({type:Eee,json:{write:!0}})],Mt.prototype,"legendOptions",void 0),l([c({type:Number,value:null,json:{write:!0}})],Mt.prototype,"maxDataValue",null),l([c({type:Number,value:null,json:{write:!0}})],Mt.prototype,"maxSize",null),l([We("maxSize")],Mt.prototype,"castMaxSize",null),l([X("maxSize")],Mt.prototype,"readMaxSize",null),l([c({type:Number,value:null,json:{write:!0}})],Mt.prototype,"minDataValue",null),l([c({type:Number,value:null,json:{write:!0}})],Mt.prototype,"minSize",null),l([We("minSize")],Mt.prototype,"castMinSize",null),l([X("minSize")],Mt.prototype,"readMinSize",null),l([c({type:String,json:{write:!0}})],Mt.prototype,"normalizationField",void 0),l([c({readOnly:!0})],Mt.prototype,"arcadeRequired",null),l([c({type:String})],Mt.prototype,"scaleBy",void 0),l([c({type:[Ix],value:null,json:{write:!0}})],Mt.prototype,"stops",null),l([c({type:["outline"],json:{write:!0}})],Mt.prototype,"target",void 0),l([c({type:String,readOnly:!0})],Mt.prototype,"transformationType",null),l([c({type:["size"],json:{type:["sizeInfo"]}})],Mt.prototype,"type",void 0),l([c({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Mt.prototype,"useSymbolValue",void 0),l([c({type:String,json:{write:!0}})],Mt.prototype,"valueExpression",void 0),l([X("valueExpression",["valueExpression","expression"])],Mt.prototype,"readValueExpression",null),l([te("web-scene","valueExpression")],Mt.prototype,"writeValueExpressionWebScene",null),l([c({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Mt.prototype,"valueRepresentation",void 0),l([c({type:N3.apiValues,json:{write:N3.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Mt.prototype,"valueUnit",void 0),l([X("valueUnit")],Mt.prototype,"readValueUnit",null),Mt=F3=l([$("esri.renderers.visualVariables.SizeVariable")],Mt);const b_=Mt,u$e={color:See,size:b_,opacity:B5,rotation:$ee},c$e=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),d$e=/^\[([^\]]+)\]$/i;let Cx=class extends q{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e==null?void 0:e.filter(i=>!!i),e==null?void 0:e.length){for(const i of e)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some(i=>!!i.target)&&e.sort((i,r)=>{let n=null;return n=i.target===r.target?0:i.target?1:-1,n});for(let i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,i,r){const{rotationExpression:n,rotationType:s}=i,o=n==null?void 0:n.match(d$e),a=o==null?void 0:o[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:s,field:a})),e)return e.map(u=>{const d=c$e.read(u.type),p=u$e[d];p||(U.getLogger(this).warn(`Unknown variable type: ${d}`),r!=null&&r.messages&&r.messages.push(new Jo("visual-variable:unsupported",`visualVariable of type '${d}' is not supported`,{definition:u,context:r})));const h=new p;return h.read(u,r),h})}writeVariables(e,i){const r=[];for(const n of e){const s=n.toJSON(i);s&&r.push(s)}return r}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};l([c()],Cx.prototype,"visualVariables",null),Cx=l([$("esri.renderers.visualVariables.VisualVariableFactory")],Cx);const p$e=Cx,h$e={base:v_,key:"type",typeMap:{opacity:B5,color:See,rotation:$ee,size:b_}},__=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new p$e}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,r,n){return this._vvFactory.readVariables(i,r,n)}writeVisualVariables(i,r,n,s){r[n]=this._vvFactory.writeVariables(i,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const i of this.visualVariables)if(i.arcadeRequired)return!0;return!1}hasVisualVariables(i,r){return i?this.getVisualVariablesForType(i,r).length>0:this.getVisualVariablesForType("size",r).length>0||this.getVisualVariablesForType("color",r).length>0||this.getVisualVariablesForType("opacity",r).length>0||this.getVisualVariablesForType("rotation",r).length>0}getVisualVariablesForType(i,r){const n=this.visualVariables;return n?n.filter(s=>s.type===i&&(typeof r=="string"?s.target===r:r!==!1||!s.target)):[]}async collectVVRequiredFields(i,r){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const s of n)s&&(s.field&&Ls(i,r,s.field),s.normalizationField&&Ls(i,r,s.normalizationField),s.valueExpression&&(m$e(s.valueExpression,i,r)||await as(i,r,s.valueExpression)))}};return l([c({types:[h$e],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),l([X("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),l([te("visualVariables")],e.prototype,"writeVisualVariables",null),e=l([$("esri.renderers.mixins.VisualVariablesMixin")],e),e};function m$e(t,e,i){const r=ZSe(t);return r!=null&&(Ls(e,i,r),!0)}const W5=[252,146,31,255],f$e=[153,153,153,255],y$e={type:"esriSMS",style:"esriSMSCircle",size:6,color:W5,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},g$e={type:"esriSLS",style:"esriSLSSolid",width:.75,color:W5},v$e={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},b$e={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},_$e={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},w$e={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},S$e={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},Ree=Or.fromJSON(y$e),Pee=yr.fromJSON(g$e),Fee=Qo.fromJSON(v$e),$$e=cg.fromJSON(b$e);function mXe(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return Ree;case"polyline":return Pee;case"polygon":case"extent":return Fee}return null}const fXe=Or.fromJSON(_$e),yXe=yr.fromJSON(w$e),gXe=Qo.fromJSON(S$e),E$e=Zd.fromSimpleMarkerSymbol(Ree),T$e=ug.fromSimpleLineSymbol(Pee),I$e=xm.fromSimpleFillSymbol(Fee),x$e=new y_({symbolLayers:new Y([new Im({material:{color:W5},edges:new GQ({size:Jr(1),color:new ee(f$e)})})])}),M$e=new ug({symbolLayers:new Y([new m_({material:{color:new ee([0,0,0])},size:Jr(1)})])}),C$e=new xm({symbolLayers:new Y([new Im({outline:{color:new ee([0,0,0]),size:Jr(1)}})])});function vXe(t){if(t==null)return null;switch(t.type){case"mesh":return x$e;case"point":case"multipoint":return E$e;case"polyline":return T$e;case"polygon":case"extent":return I$e}return null}const uz="#useCIMFallbackSymbology()",Gd={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function zy(t,e=Gd){var u,d,p,h;if(!t)return{symbol:null};const{retainId:i=Gd.retainId,ignoreDrivers:r=Gd.ignoreDrivers,hasLabelingContext:n=Gd.hasLabelingContext,retainCIM:s=Gd.retainCIM,cimFallbackEnabled:o=Gd.cimFallbackEnabled}=e;let a=null;if(xc(t)||t instanceof dg)a=t.clone();else if(t.type==="cim"){const m=(d=(u=t.data)==null?void 0:u.symbol)==null?void 0:d.type;switch(m){case"CIMPointSymbol":a=s?t.clone():Zd.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=M$e.clone(),(p=e==null?void 0:e.logWarning)==null||p.call(e,uz,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=C$e.clone(),(h=e==null?void 0:e.logWarning)==null||h.call(e,uz,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new L("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${m||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof yr)a=ug.fromSimpleLineSymbol(t);else if(t instanceof Or)a=Zd.fromSimpleMarkerSymbol(t);else if(t instanceof g_)a=Zd.fromPictureMarkerSymbol(t);else if(t instanceof Qo)a=e.geometryType&&e.geometryType==="mesh"?y_.fromSimpleFillSymbol(t):xm.fromSimpleFillSymbol(t);else{if(!(t instanceof cg))return{error:new L("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=n?hk.fromTextSymbol(t):Zd.fromTextSymbol(t)}return i&&a&&a.type!=="cim"&&(a.id=t.id),r&&xc(a)&&a.symbolLayers.forEach(m=>m.ignoreDrivers=!0),{symbol:a}}function b2(t,e,i,r){const n=Nee(t,{},{context:r,isLabelSymbol:!1});n!=null&&(e[i]=n)}function cz(t,e,i,r){const n=Nee(t,{},{context:r,isLabelSymbol:!0});n!=null&&(e[i]=n)}function dz(t){return t instanceof lg||t instanceof dg}function k$e(t){return t instanceof lg&&(t.type==="polygon-3d"||t.type==="line-3d")}function Nee(t,e,i){var a;if(t==null)return null;const{context:r,isLabelSymbol:n}=i,s=r==null?void 0:r.origin,o=r==null?void 0:r.messages;if(s==="web-scene"&&!dz(t)){const u=zy(t,{retainCIM:!0,hasLabelingContext:n});return u.symbol!=null?u.symbol.write(e,r):(o==null||o.push(new L("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:r,error:u.error})),null)}return $R(r==null?void 0:r.layer)&&k$e(t)?(o==null||o.push(new L("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${(a=r==null?void 0:r.layer)==null?void 0:a.declaredClass}'.`,{symbol:t,context:r})),null):(s==="web-map"||s==="portal-item"&&!$R(r==null?void 0:r.layer))&&dz(t)?(o==null||o.push(new L("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:r})),null):t.write(e,r)}function Dee(t,e){return PSe(t,null,e)}const gk={types:vee,json:{write:{writer:b2},origins:{"web-scene":{types:Q6,write:{writer:b2},read:{reader:s_({types:Q6})}}}}},Z5=iV({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},gk),J5={types:{base:Pn,key:"type",typeMap:{"simple-fill":Ha.typeMap["simple-fill"],"picture-fill":Ha.typeMap["picture-fill"],"polygon-3d":Ha.typeMap["polygon-3d"],cim:Ha.typeMap.cim}},json:{write:{writer:b2},origins:{"web-scene":{type:xm,write:{writer:b2}}}}},kx={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var D3;let sh=D3=class extends j{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){var t;return new D3({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:((t=this.symbol)==null?void 0:t.clone())??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};l([c({type:String,json:{write:!0}})],sh.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],sh.prototype,"label",void 0),l([c({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],sh.prototype,"minValue",void 0),l([c({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],sh.prototype,"maxValue",void 0),l([c(Z5)],sh.prototype,"symbol",void 0),sh=D3=l([$("esri.renderers.support.ClassBreakInfo")],sh);const _2=sh,L$e=Me()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let p1=class extends Ze(j){constructor(e){super(e),this.title=null,this.order=null}};l([c({type:String,json:{write:!0}})],p1.prototype,"title",void 0),l([oe(L$e)],p1.prototype,"order",void 0),p1=l([$("esri.renderers.support.RendererLegendOptions")],p1);const Y5=p1;var V3;const Vee="log",Lx="percent-of-total",Ax="field",wT=new $e({esriNormalizeByLog:Vee,esriNormalizeByPercentOfTotal:Lx,esriNormalizeByField:Ax}),A$e=pi(_2);let _r=V3=class extends __($p){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let r=e.minValue;return t.map(n=>{const s=new _2;return s.read(n,i),s.minValue==null&&(s.minValue=r),s.maxValue==null&&(s.maxValue=s.minValue),r=s.maxValue,s})}writeClassBreakInfos(t,e,i,r){const n=t.map(s=>s.write({},r));this._areClassBreaksConsecutive()&&n.forEach(s=>delete s.classMinValue),e[i]=n}castField(t){return t==null?t:typeof t=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):F$(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=this.normalizationTotal!=null;return e||i?(t=e&&Ax||i&&Lx||null,e&&i&&U.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==Ax&&t!==Lx||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let r=null;r=typeof t=="number"?new _2({minValue:t,maxValue:e,symbol:bee(i)}):A$e(R(t)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]===t&&n[1]===e){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(e==null?void 0:e.arcade)==null&&U.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await Tc()});const r=this.getBreakIndex(t,i);return r!==-1?this.classBreakInfos[r]:null}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void U.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(e==null?void 0:e.arcade)==null){const n=await Tc(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:n}}const r=this.getBreakIndex(t,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((r,n)=>r+n.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var t,e;return new V3({field:this.field,backgroundFillSymbol:(t=this.backgroundFillSymbol)==null?void 0:t.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(e=this.defaultSymbol)==null?void 0:e.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:R(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:R(this.visualVariables),legendOptions:R(this.legendOptions),authoringInfo:R(this.authoringInfo)})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),as(t,e,this.valueExpression)];Ls(t,e,this.field),Ls(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:s,timeZone:o}=e??{},{valueExpression:a}=this;let u=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const d=s.arcadeUtils;if(!u){const h=d.createSyntaxTree(a);u=d.createFunction(h),this._compiledValueExpression.compiledFunction=u}this._compiledValueExpression.valueExpression=a;const p=d.executeFunction(u,d.createExecContext(t,d.getViewInfo({viewingMode:i,scale:r,spatialReference:n}),o));return this._getBreakIndexfromInfos(p)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,r=this.normalizationType;let n=parseFloat(i[e]);if(r){const s=this.normalizationTotal,o=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(r===Vee)n=Math.log(n)*Math.LOG10E;else if(r!==Lx||s==null||isNaN(s)){if(r===Ax&&!isNaN(o)){if(isNaN(n)||isNaN(o))return-1;n/=o}}else n=n/s*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=t&&(e?t<=r[1]:t<r[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};l([c(J5)],_r.prototype,"backgroundFillSymbol",void 0),l([c({type:[_2]})],_r.prototype,"classBreakInfos",void 0),l([X("classBreakInfos")],_r.prototype,"readClassBreakInfos",null),l([te("classBreakInfos")],_r.prototype,"writeClassBreakInfos",null),l([c({type:String,json:{write:!0}})],_r.prototype,"defaultLabel",void 0),l([c(gk)],_r.prototype,"defaultSymbol",void 0),l([c({type:String,json:{write:!0}})],_r.prototype,"field",void 0),l([We("field")],_r.prototype,"castField",null),l([c({type:Boolean})],_r.prototype,"isMaxInclusive",void 0),l([c({type:Y5,json:{write:!0}})],_r.prototype,"legendOptions",void 0),l([c({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],_r.prototype,"minValue",null),l([c({type:String,json:{write:!0}})],_r.prototype,"normalizationField",void 0),l([c({type:Number,json:{write:!0}})],_r.prototype,"normalizationTotal",void 0),l([c({type:wT.apiValues,value:null,json:{type:wT.jsonValues,read:wT.read,write:wT.write}})],_r.prototype,"normalizationType",null),l([oe({classBreaks:"class-breaks"})],_r.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],_r.prototype,"valueExpression",void 0),l([c({type:String,json:{write:!0}})],_r.prototype,"valueExpressionTitle",void 0),_r=V3=l([$("esri.renderers.ClassBreaksRenderer")],_r);const Uee=_r,U3=-3,O$e=U3-1;var Pd;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(Pd||(Pd={}));let R$e=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new vy,this._users=new vy}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,i){this._removeFuncs.push([e,i])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(i=>i[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,i){const r=this._db.get(e.id+i);return(r==null?void 0:r.size)??0}put(e,i,r,n,s){i=e.id+i;const o=this._db.get(i);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(i),o.entry!==r&&this._notifyRemove(i,o.entry,o.size,Pd.ALL)),n>this._maxSize)return void this._notifyRemove(i,r,n,Pd.ALL);if(r===void 0)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${i}`),void this._notifyRemove(i,r,0,Pd.ALL);const a=1+Math.max(s,O$e)-U3;this._db.set(i,new P$e(r,n,a)),this._size+=n,e.size+=n,this._checkSize()}updateSize(e,i,r,n){i=e.id+i;const s=this._db.get(i);if(s&&s.entry===r){for(this._size-=s.size,e.size-=s.size;n>this._maxSize;){const o=this._notifyRemove(i,r,n,Pd.SOME);if(!(o!=null&&o>0))return void this._db.delete(i);n=o}s.size=n,this._size+=n,e.size+=n,this._checkSize()}}pop(e,i){i=e.id+i;const r=this._db.get(i);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(i),++this._hit,r.entry;++this._miss}get(e,i){i=e.id+i;const r=this._db.get(i);if(r!==void 0)return this._db.delete(i),r.lives=r.lifetime,this._db.set(i,r),++this._hit,r.entry;++this._miss}peek(e,i){const r=this._db.get(e.id+i);return r?++this._hit:++this._miss,r==null?void 0:r.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach((o,a)=>{const u=o.lifetime;r[u]=(r[u]||0)+o.size,this._users.forAll(d=>{const{id:p,name:h}=d;if(a.startsWith(p)){const m=i[h]||0;i[h]=m+o.size}})});const n={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const u=i[a]||0;i[a]=u,n[a]=Math.round(100*o.hitRate)+"%"}else n[a]="0%"});const s=Object.keys(i);s.sort((o,a)=>i[a]-i[o]),s.forEach(o=>e[o]=Math.round(i[o]/2**20)+"MB / "+n[o]);for(let o=r.length-1;o>=0;--o){const a=r[o];a&&(e["Priority "+(o+U3-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const i=e.id;this._db.forEach((r,n)=>{n.startsWith(i)&&(this._size-=r.size,this._db.delete(n),this._notifyRemove(n,r.entry,r.size,Pd.ALL))}),e.size=0}clearAll(){this._db.forEach((e,i)=>this._notifyRemove(i,e.entry,e.size,Pd.ALL)),this._users.forAll(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,i,r,n){let s;return this._removeFuncs.some(o=>{if(e.startsWith(o[0])){const a=o[1](i,n,r);return typeof a=="number"&&(s=a),!0}return!1}),s}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e)),this._checkSizeLimits()}_checkSizeLimits(e){const i=e??this;if(i.maxSize<0||i.size<=i.maxSize)return;const r=e==null?void 0:e.id;let n=!0;for(;n;){n=!1;for(const[s,o]of this._db)if(o.lifetime===0&&(!r||s.startsWith(r))){if(this._purgeItem(s,o,e),i.size<=.9*i.maxSize)return;n||(n=this._db.has(s))}}for(const[s,o]of this._db)if((!r||s.startsWith(r))&&(this._purgeItem(s,o,e),i.size<=.9*i.maxSize))return}_purgeItem(e,i,r=this._users.find(n=>e.startsWith(n.id))){if(this._db.delete(e),i.lives<=1){this._size-=i.size,r&&(r.size-=i.size);const n=this._notifyRemove(e,i.entry,i.size,Pd.SOME);n!=null&&n>0&&(this._size+=n,r&&(r.size+=n),i.lives=i.lifetime,i.size=n,this._db.set(e,i))}else--i.lives,this._db.set(e,i)}},P$e=class{constructor(e,i,r){this.entry=e,this.size=i,this.lifetime=r,this.lives=r}},K5=class{constructor(e,i){this._storage=new R$e,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,i,r=1){this._storage.put(this,e,i,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},Ql=class{};function F$e(t){return t instanceof sg?t===Ql.instance:(t==null?void 0:t.toString().toLowerCase())==="unknown"}function EXe(t){return F$e(t)?Ql.instance:t}Ql.instance=new co("Etc/UTC");function N$e(t){return"timeZone"in t}function D$e(t){return"timeZone"in t}function V$e(t){return"dateFieldsTimeZone"in t}const U$e=new Map;let jee=class Ox{static fromJSON(e){return new Ox(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Ox(e.fields??[],hz(e))}static fromLayerJSON(e){return new Ox(e.fields??[],hz(e))}constructor(e=[],i){var n;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const r=[];for(const s of this.fields){const o=s==null?void 0:s.name,a=pz(o);if(o&&a){const u=ny(o);this._fieldsMap.set(o,s),this._fieldsMap.set(u,s),this._normalizedFieldsMap.set(a,s),r.push(`${u}:${s.type}:${(n=this._timeZoneByFieldName)==null?void 0:n.get(o)}`),T5(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):J0(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),H6(s)||q6(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)H6(e)||q6(e)||e.nullable||u1e(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(e==null?void 0:e.uid)}has(e){return this.get(e)!=null}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(ny(e))??this._normalizedFieldsMap.get(pz(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(e){const i=this.get(e&&typeof e!="string"?e.name:e);return i?this._timeZoneByFieldName?this._timeZoneByFieldName.get(i.name):i.type==="date"||i.type==="esriFieldTypeDate"?(U.getLogger("esri.layers.support.FieldsIndex").error(new L("getTimeZone:no-timezone-information",`no time zone information for field '${i.name}'`)),po):Gee.has(i.type)?pp:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===pp?Ql.instance:i===po?pr.utcInstance:Xd(U$e,i,()=>co.create(i)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return Lb(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var i;return((i=this.get(e))==null?void 0:i.name)??void 0}toJSON(){return{fields:this.fields.map(e=>qM(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function ny(t){return t.trim().toLowerCase()}function pz(t){var e;return((e=Zwe(t))==null?void 0:e.toLowerCase())??""}const Gee=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function hz(t){const e=new Map;if(!t.fields)return e;const i=t.datesInUnknownTimezone===!0,{timeInfo:r,editFieldsInfo:n}=t,s=(r?"startField"in r?r.startField:r.startTimeField:"")??"",o=(r?"endField"in r?r.endField:r.endTimeField:"")??"",a=V$e(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?tx(t.dateFieldsTimeReference):null,u=n?N$e(n)?n.timeZone??a:n.dateFieldsTimeReference?tx(n.dateFieldsTimeReference):a??po:null,d=r?D$e(r)?r.timeZone??a:r.timeReference?tx(r.timeReference):a:null,p=new Map([[ny((n==null?void 0:n.creationDateField)??""),u],[ny((n==null?void 0:n.editDateField)??""),u],[ny(s),d],[ny(o),d]]);for(const{name:h,type:m}of t.fields)if(Gee.has(m))e.set(h,pp);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(h,null);else if(i)e.set(h,pp);else{const y=p.get(ny(h??""))??a;e.set(h,y)}return e}function n$(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function j$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function X5(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}function zee(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function Bee(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Hee(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function qee(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function G$e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function z$e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function B$e(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function H$e(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function q$e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Wee(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function W$e(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t}function Zee(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(i*i+r*r+n*n+s*s)}function Jee(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],s=e[3]-t[3];return i*i+r*r+n*n+s*s}function Q5(t){const e=t[0],i=t[1],r=t[2],n=t[3];return Math.sqrt(e*e+i*i+r*r+n*n)}function e4(t){const e=t[0],i=t[1],r=t[2],n=t[3];return e*e+i*i+r*r+n*n}function Z$e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function J$e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Yee(t,e){const i=e[0],r=e[1],n=e[2],s=e[3];let o=i*i+r*r+n*n+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=r*o,t[2]=n*o,t[3]=s*o),t}function t4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function i4(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t[2]=o+r*(i[2]-o),t[3]=a+r*(i[3]-a),t}function Y$e(t,e=1){const i=z$;let r,n,s,o,a,u;do r=2*i()-1,n=2*i()-1,a=r*r+n*n;while(a>=1);do s=2*i()-1,o=2*i()-1,u=s*s+o*o;while(u>=1);const d=Math.sqrt((1-a)/u);return t[0]=e*r,t[1]=e*n,t[2]=e*s*d,t[3]=e*o*d,t}function r4(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*s+i[12]*o,t[1]=i[1]*r+i[5]*n+i[9]*s+i[13]*o,t[2]=i[2]*r+i[6]*n+i[10]*s+i[14]*o,t[3]=i[3]*r+i[7]*n+i[11]*s+i[15]*o,t}function K$e(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],u=i[2],d=i[3],p=d*r+a*s-u*n,h=d*n+u*r-o*s,m=d*s+o*n-a*r,y=-o*r-a*n-u*s;return t[0]=p*d+y*-o+h*-u-m*-a,t[1]=h*d+y*-a+m*-o-p*-u,t[2]=m*d+y*-u+p*-a-h*-o,t[3]=e[3],t}function X$e(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Kee(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function vk(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=e[0],a=e[1],u=e[2],d=e[3],p=qi();return Math.abs(i-o)<=p*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=p*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-u)<=p*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-d)<=p*Math.max(1,Math.abs(s),Math.abs(d))}const Q$e=Bee,eEe=Hee,tEe=qee,iEe=Zee,rEe=Jee,nEe=Q5,sEe=e4;Object.freeze(Object.defineProperty({__proto__:null,add:zee,ceil:G$e,copy:n$,copyVec3:j$e,dist:iEe,distance:Zee,div:tEe,divide:qee,dot:t4,equals:vk,exactEquals:Kee,floor:z$e,inverse:J$e,len:nEe,length:Q5,lerp:i4,max:H$e,min:B$e,mul:eEe,multiply:Hee,negate:Z$e,normalize:Yee,random:Y$e,round:q$e,scale:Wee,scaleAndAdd:W$e,set:X5,sqrDist:rEe,sqrLen:sEe,squaredDistance:Jee,squaredLength:e4,str:X$e,sub:Q$e,subtract:Bee,transformMat4:r4,transformQuat:K$e},Symbol.toStringTag,{value:"Module"}));function Rc(){return[0,0,0,0]}function oEe(t){return[t[0],t[1],t[2],t[3]]}function Pc(t,e,i,r){return[t,e,i,r]}function aEe(t,e,i,r){return[t,e,i,r]}function lEe(t,e=Rc()){const i=Math.min(4,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function uEe(t,e){return new Float64Array(t,e,4)}function Xee(){return Rc()}function Qee(){return Pc(1,1,1,1)}function ete(){return Pc(1,0,0,0)}function tte(){return Pc(0,1,0,0)}function ite(){return Pc(0,0,1,0)}function rte(){return Pc(0,0,0,1)}const cEe=Xee(),dEe=Qee(),pEe=ete(),hEe=tte(),mEe=ite(),fEe=rte();Object.freeze(Object.defineProperty({__proto__:null,ONES:dEe,UNIT_W:fEe,UNIT_X:pEe,UNIT_Y:hEe,UNIT_Z:mEe,ZEROS:cEe,clone:oEe,create:Rc,createView:uEe,freeze:aEe,fromArray:lEe,fromValues:Pc,ones:Qee,unitW:rte,unitX:ete,unitY:tte,unitZ:ite,zeros:Xee},Symbol.toStringTag,{value:"Module"}));function nte(t){return"r"in t&&"g"in t&&"b"in t}function ste(t){return"h"in t&&"s"in t&&"v"in t}function ote(t){return"l"in t&&"a"in t&&"b"in t}function ate(t){return"l"in t&&"c"in t&&"h"in t}function yEe(t){return"x"in t&&"y"in t&&"z"in t}const gEe=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],vEe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function lte(t,e){const i=[];let r,n;if(t[0].length!==e.length)throw new Error("dimensions do not match");const s=t.length,o=t[0].length;let a=0;for(r=0;r<s;r++){for(a=0,n=0;n<o;n++)a+=t[r][n]*e[n];i.push(a)}return i}function ute(t){const e=[t.r/255,t.g/255,t.b/255].map(r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4),i=lte(gEe,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function n4(t){const e=lte(vEe,[t.x/100,t.y/100,t.z/100]).map(i=>{const r=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(r,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function cte(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function dte(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function bEe(t){const e=t.l,i=t.a,r=t.b,n=Math.sqrt(i*i+r*r);let s=Math.atan2(r,i);return s=s>0?s:s+2*Math.PI,{l:e,c:n,h:s}}function _Ee(t){const e=t.l,i=t.c,r=t.h;return{l:e,a:i*Math.cos(r),b:i*Math.sin(r)}}function wEe(t){return cte(ute(t))}function SEe(t){return n4(dte(t))}function $Ee(t){return bEe(cte(ute(t)))}function EEe(t){return n4(dte(_Ee(t)))}function TEe(t){const e=t.r,i=t.g,r=t.b,n=Math.max(e,i,r),s=n-Math.min(e,i,r);let o=n,a=s===0?0:n===e?(i-r)/s%6:n===i?(r-e)/s+2:(e-i)/s+4,u=s===0?0:s/o;return a<0&&(a+=6),a*=60,u*=100,o*=100/255,{h:a,s:u,v:o}}function IEe(t){const e=(t.h+360)%360/60,i=t.s/100,r=t.v/100*255,n=r*i,s=n*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:n,g:s,b:0};break;case 1:o={r:s,g:n,b:0};break;case 2:o={r:0,g:n,b:s};break;case 3:o={r:0,g:s,b:n};break;case 4:o={r:s,g:0,b:n};break;case 5:case 6:o={r:n,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+r-n),o.g=Math.round(o.g+r-n),o.b=Math.round(o.b+r-n),o}function hg(t){return nte(t)?t:ate(t)?EEe(t):ote(t)?SEe(t):yEe(t)?n4(t):ste(t)?IEe(t):t}function bk(t){return ste(t)?t:TEe(hg(t))}function xEe(t){return ote(t)?t:wEe(hg(t))}function TXe(t){return ate(t)?t:$Ee(hg(t))}function MEe(t){let{r:e,g:i,b:r,a:n}=t;return n<1&&(e=Math.round(n*e+255*(1-n)),i=Math.round(n*i+255*(1-n)),r=Math.round(n*r+255*(1-n))),new ee({r:e,g:i,b:r})}function CEe(t,e){const{r:i,g:r,b:n}=e!=null&&e.ignoreAlpha?t:MEe(t);return .2126*i+.7152*r+.0722*n}var j3;function IXe(t,e=j3.High){return CEe(t,{ignoreAlpha:!0})>e?new ee([0,0,0,t.a]):new ee([255,255,255,t.a])}function xXe(t,e){const i=xEe(t);i.l*=1-e;const r=hg(i),n=t.clone();return n.setColor(r),n.a=t.a,n}function MXe(t,e){const i=t.clone();return i.a*=e,i}function CXe(t,e){const i=bk(t);i.s*=e;const r=hg(i),n=t.clone();return n.setColor(r),n.a=t.a,n}function kXe(t){return ee.toUnitRGBA(t)}function LXe(t){return Pc(t[0],t[1],t[2],t.length>3?t[3]:1)}function AXe(t,e){const i=ee.toUnitRGBA(t);return i[3]*=e,i}(function(t){t[t.Low=160]="Low",t[t.High=225]="High"})(j3||(j3={}));var mz,fz,yz,gz,vz,bz,_z,wz,Sz,$z,G3,z3,Ez,Tz,Iz,xz,Mz,Cz,kz,Lz,Az,Oz,Rz,Pz,Fz,Nz,Dz,Vz,Uz,jz,Gz,zz,Bz,Hz,qz,Wz,Zz,Jz,Yz,Kz,Xz,Qz,eB,tB,iB,rB,nB,sB,oB,aB,lB,uB,cB,dB,pB,hB,mB,fB,yB,gB,vB,bB;(function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"})(mz||(mz={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(fz||(fz={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(yz||(yz={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(gz||(gz={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(vz||(vz={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(bz||(bz={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(_z||(_z={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(wz||(wz={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(Sz||(Sz={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}($z||($z={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(G3||(G3={})),function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"}(z3||(z3={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(Ez||(Ez={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(Tz||(Tz={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(Iz||(Iz={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(xz||(xz={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(Mz||(Mz={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(Cz||(Cz={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(kz||(kz={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(Lz||(Lz={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(Az||(Az={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(Oz||(Oz={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(Rz||(Rz={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(Pz||(Pz={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(Fz||(Fz={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(Nz||(Nz={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(Dz||(Dz={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(Vz||(Vz={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(Uz||(Uz={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(jz||(jz={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(Gz||(Gz={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(zz||(zz={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(Bz||(Bz={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(Hz||(Hz={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(qz||(qz={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(Wz||(Wz={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(Zz||(Zz={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(Jz||(Jz={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(Yz||(Yz={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(Kz||(Kz={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(Xz||(Xz={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(Qz||(Qz={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(eB||(eB={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(tB||(tB={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(iB||(iB={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(rB||(rB={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(nB||(nB={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(sB||(sB={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(oB||(oB={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(aB||(aB={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(lB||(lB={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(uB||(uB={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(cB||(cB={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(dB||(dB={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(pB||(pB={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(hB||(hB={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(mB||(mB={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(fB||(fB={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(yB||(yB={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(gB||(gB={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(vB||(vB={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(bB||(bB={}));const kEe={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},B3={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:G3.Loop,repeatdelay:0,easing:z3.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}};function LEe(t){return typeof t=="function"}function OXe(t,e,i,r){return LEe(t)?t(e,i,r):t}function RXe(t){return[t.r,t.g,t.b,t.a]}const AEe=` /-,
`;function _B(t){let e=t.length;for(;e--;)if(!AEe.includes(t.charAt(e)))return!1;return!0}function OEe(t,e){const i=[];let r=0,n=-1;do if(n=t.indexOf("[",r),n>=r){if(n>r){const s=t.slice(r,n);i.push([s,null,_B(s)])}if(r=n+1,n=t.indexOf("]",r),n>=r){if(n>r){const s=e[t.slice(r,n)];s&&i.push([null,s,!1])}r=n+1}}while(n!==-1);if(r<t.length){const s=t.slice(r);i.push([s,null,_B(s)])}return i}function REe(t,e,i,r){let n="",s=null;for(const o of e){const[a,u,d]=o;if(a)d?s=a:(s&&(n+=s,s=null),n+=a);else{let p=u;i!=null&&(p=yte(u,i));const h=t.attributes[p];h&&(s&&(n+=s,s=null),n+=h)}}return PEe(n,r)}function PEe(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function PXe(t,e,i,r,n,s,o=!0){const a=e/n,u=i/s,d=Math.ceil(a/2),p=Math.ceil(u/2);for(let h=0;h<s;h++)for(let m=0;m<n;m++){const y=4*(m+(o?s-h-1:h)*n);let g=0,v=0,_=0,w=0,S=0,E=0,T=0;const M=(h+.5)*u;for(let x=Math.floor(h*u);x<(h+1)*u;x++){const C=Math.abs(M-(x+.5))/p,O=(m+.5)*a,F=C*C;for(let V=Math.floor(m*a);V<(m+1)*a;V++){let z=Math.abs(O-(V+.5))/d;const H=Math.sqrt(F+z*z);H>=-1&&H<=1&&(g=2*H*H*H-3*H*H+1,g>0&&(z=4*(V+x*e),T+=g*t[z+3],_+=g,t[z+3]<255&&(g=g*t[z+3]/250),w+=g*t[z],S+=g*t[z+1],E+=g*t[z+2],v+=g))}}r[y]=w/v,r[y+1]=S/v,r[y+2]=E/v,r[y+3]=T/_}}function pte(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function hte(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function mte(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function fte(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function FXe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function _k(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const NXe=(t,e=0)=>t==null||isNaN(t)?e:t,DXe=(t,e)=>t??e,VXe=(t,e)=>t??e,UXe=t=>t.tintColor?pte(t.tintColor):[255,255,255,1],jXe=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function GXe(){return k(()=>import("./geometryEngineJSON-BwrklJA_.js").then(t=>t.g),__vite__mapDeps([28,12,1,29]))}function zXe(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function BXe(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function HXe(t){let e="normal",i="normal";if(t){const r=t.toLowerCase();r.includes("italic")?e="italic":r.includes("oblique")&&(e="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:e,weight:i}}function qXe(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function wB(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=wB(e);if(i!=null)return i}break;case"CIMTextSymbol":return wB(t.symbol);case"CIMSolidFill":return t.color}return null}function SB(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const i of e){const r=SB(i);if(r!=null)return r}break}case"CIMTextSymbol":return SB(t.symbol);case"CIMSolidStroke":return t.color}}function $B(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=$B(e);if(i!==void 0)return i}break;case"CIMTextSymbol":return $B(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function WXe(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function ZXe(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function FEe(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const JXe=t=>t.includes("data:image/svg+xml");function YXe(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function wk(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function KXe(t,e,i,r,n,s,o=!0){const{infos:a}=s;let u=1,d=0,p=0,h=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:_,offsetY:w,rotation:S,size:E,frameHeight:T,rotateClockWise:M,scaleSymbolsProportionally:x}of a)m=v?1:u,p=IB(_,w,d,m,p),h=TB(_,w,d,m,h),T&&(x||o)&&(u*=E/T),d=xB(S,M,d);const y=IB(r,n,d,m,p),g=TB(r,n,d,m,h);return{size:t*u,rotation:xB(e,i,d),offsetX:y,offsetY:g}}function NEe(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>NEe(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function DEe(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...kEe[e]];const i=B3[t];if(!i)throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function VEe(t){return t.split(" ").map(e=>Number(e))}function UEe(t){return typeof t=="string"?VEe(t):t}function jEe(t){return t!=null&&t.dashTemplate&&(t.dashTemplate=UEe(t.dashTemplate)),t}function H3(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const i of e)if(i.type==="CIMVectorMarker")return H3(i)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const i of e)if(i.symbol)return H3(i.symbol)}}return"Normal"}function XXe(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const r=i.size??B3.CIMVectorMarker.size;r>e&&(e=r);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const r=i.width;r!=null&&r>e&&(e=r);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&_k(i.markerPlacement)){const r=i.size??B3.CIMVectorMarker.size;r>e&&(e=r)}break;case"CIMPictureFill":{const r=i.height;r!=null&&r>e&&(e=r)}}}return e}}}function yte(t,e){if(e!==null){const i=e.get(t);return i?i.name:t}return t}function GEe(t){return t.map(e=>({...e,propertyName:wk(e.propertyName)}))}function EB(t){const e={};for(const i in t){const r=t[i];e[wk(i)]=r}return e}function TB(t,e,i,r,n){const s=i*Math.PI/180;if(s){const o=Math.cos(s);return(Math.sin(s)*t+o*e)*r+n}return e*r+n}function IB(t,e,i,r,n){const s=i*Math.PI/180;return s?(Math.cos(s)*t-Math.sin(s)*e)*r+n:t*r+n}function xB(t,e,i){return e?i-t:i+t}function QXe(t,e,i){const r=i==="Color"||i==="TintColor"||i==="ToColor",n=i==="Rotation"||i==="Angle"||i==="ToRotation";let s=e[wk(i)];if(s!=null&&(r?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:n&&(s*=Math.PI/180)),s==null&&(s=DEe(e.type,i.toLowerCase()),s!=null&&(r?s=[s[0]/255,s[1]/255,s[2]/255,s[3]]:n&&(s*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const a=o[i];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(s=a,s!=null&&(r?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:n&&(s*=Math.PI/180))):(s={valueExpressionInfo:a,defaultValue:s},s!=null&&(r?s={type:"Process",op:"ArcadeColor",value:s}:n&&(s={type:"Process",op:"Divide",left:s,right:180/Math.PI}))))}}if(s==null)throw new Error(`Failed to derive a value or an expression for "${i}".`);return s}function eQe(t){return t?{originPosition:t.originPosition==="upper-left"?"upperLeft":t.originPosition==="lower-left"?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:t.extent!=null?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}:null}function zEe(t){return t.originPosition==="lowerLeft"&&t.scale.length===4&&t.translate.length===4}function sE(t){if(zEe(t))return t;const{originPosition:e,scale:i,translate:r}=t,n=i[0]??1,s=i[1]??1;return{originPosition:"lowerLeft",scale:[n,e==="lowerLeft"?s:-s,i[2]??1,i[3]??1],translate:[r[0]??0,r[1]??0,r[2]??0,r[3]??0]}}function BEe({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function HEe({scale:t,translate:e},i){return Math.round((i-e[1])/t[1])}function qEe({scale:t,translate:e},i){return Math.round(((i??0)-e[2])/t[2])}function WEe({scale:t,translate:e},i){return i?Math.round((i-e[3])/t[3]):0}function oE({scale:t,translate:e},i){return i*t[0]+e[0]}function aE({scale:t,translate:e},i){return i*t[1]+e[1]}function s$({scale:t,translate:e},i){return(i??0)*t[2]+e[2]}function o$({scale:t,translate:e},i){return i?i*t[3]+e[3]:0}function s4(t,e){return t&&e?KEe:t&&!e?JEe:!t&&e?YEe:ZEe}const ZEe=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=oE(t,r[0]),s=aE(t,r[1]);i[0]=[n,s];const{scale:o,originPosition:a}=t,u=o[0],d=a==="lowerLeft"?o[1]:-o[1];for(let p=1;p<e.length;p++){const[h,m]=e[p];n+=u*h,s+=d*m,i[p]=[n,s]}return i},JEe=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=oE(t,r[0]),s=aE(t,r[1]);i[0]=[n,s,s$(t,r[2])];const{scale:o,originPosition:a}=t,u=o[0],d=a==="lowerLeft"?o[1]:-o[1];for(let p=1;p<e.length;p++){const[h,m,y]=e[p];n+=u*h,s+=d*m,i[p]=[n,s,s$(t,y)]}return i},YEe=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=oE(t,r[0]),s=aE(t,r[1]);i[0]=[n,s,o$(t,r[2])];const{scale:o,originPosition:a}=t,u=o[0],d=a==="lowerLeft"?o[1]:-o[1];for(let p=1;p<e.length;p++){const[h,m,y]=e[p];n+=u*h,s+=d*m,i[p]=[n,s,o$(t,y)]}return i},KEe=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=oE(t,r[0]),s=aE(t,r[1]);i[0]=[n,s,s$(t,r[2]),o$(t,r[3])];const{scale:o,originPosition:a}=t,u=o[0],d=a==="lowerLeft"?o[1]:-o[1];for(let p=1;p<e.length;p++){const[h,m,y,g]=e[p];n+=u*h,s+=d*m,i[p]=[n,s,s$(t,y),o$(t,g)]}return i};function gte(t,e,i){const r=new Array(i.length);for(let n=0;n<i.length;n++)r[n]=e(t,i[n]);return r}function tQe(t,e,i){const r=sE(t);return e.x=BEe(r,i.x),e.y=HEe(r,i.y),i.z!=null&&(e.z=qEe(r,i.z)),i.m!=null&&(e.m=WEe(r,i.m)),e}function XEe(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const s=sE(t);e.points=s4(r,n)(s,i.points),e.hasZ=r,e.hasM=n}return e}function QEe(t,e,i,r=(i==null?void 0:i.z)!=null,n=(i==null?void 0:i.m)!=null){if(i==null)return e;const s=sE(t);return e.x=oE(s,i.x),e.y=aE(s,i.y),r&&(e.z=s$(s,i.z)),n&&(e.m=o$(s,i.m)),e}function eTe(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const s=sE(t);e.rings=gte(s,s4(r,n),i.rings),e.hasZ=r,e.hasM=n}return e}function tTe(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const s=sE(t);e.paths=gte(s,s4(r,n),i.paths),e.hasZ=r,e.hasM=n}return e}function iTe(t,e,i,r,n){if(t==null)return null;const s=t.referencesGeometry()&&n?rTe(e,r,n):e,o=t.repurposeFeature(s);try{return t.evaluate({...i,$feature:o},t.services)}catch(a){return U.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}const QL=new Map;function rTe(t,e,i){const{transform:r,hasZ:n,hasM:s}=i;QL.has(e)||QL.set(e,nTe(e));const o=QL.get(e)(t.geometry,r,n,s);return{...t,geometry:o}}function nTe(t){const e={};switch(t){case"esriGeometryPoint":return(i,r,n,s)=>QEe(r,e,i,n,s);case"esriGeometryPolygon":return(i,r,n,s)=>eTe(r,e,i,n,s);case"esriGeometryPolyline":return(i,r,n,s)=>tTe(r,e,i,n,s);case"esriGeometryMultipoint":return(i,r,n,s)=>XEe(r,e,i,n,s);default:return U.getLogger("esri.views.2d.support.arcadeOnDemand").error(new L("mapview-arcade",`Unable to handle geometryType: ${t}`)),i=>i}}const sTe=t=>{if(!t)return[0,0,0,0];const{r:e,g:i,b:r,a:n}=t;return[e,i,r,255*n]};let vte=class Oi{static findApplicableOverrides(e,i,r){if(e&&i){if(e.primitiveName){let n=!1;for(const s of r)if(s.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const s of i)s.primitiveName===e.primitiveName&&r.push(s)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)Oi.findApplicableOverrides(n,i,r);if(e.symbolLayers)for(const n of e.symbolLayers)Oi.findApplicableOverrides(n,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)Oi.findApplicableOverrides(n,i,r);if(e.markerPlacement&&Oi.findApplicableOverrides(e.markerPlacement,i,r),e.type==="CIMVectorMarker"){if(e.markerGraphics)for(const n of e.markerGraphics)Oi.findApplicableOverrides(n,i,r),Oi.findApplicableOverrides(n.symbol,i,r)}else e.type==="CIMCharacterMarker"?Oi.findApplicableOverrides(e.symbol,i,r):e.type==="CIMHatchFill"?Oi.findApplicableOverrides(e.lineSymbol,i,r):e.type==="CIMPictureMarker"&&Oi.findApplicableOverrides(e.animatedSymbolProperties,i,r)}}}static findEffectOverrides(e,i){if(!e)return null;if(e.type==="CIMGeometricEffectDashes"&&jEe(e),!i||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=EB(e),n=e.primitiveName,s=[];for(const o of i)o.primitiveName===n&&s.push(EB(o));return{type:"cim-effect-param",effect:r,overrides:GEe(s)}}static async resolveSymbolOverrides(e,i,r,n,s,o,a){if(!(e!=null&&e.symbol))return null;let{symbol:u,primitiveOverrides:d}=e;const p=!!d;if(!p&&!n)return u;u=R(u),d=R(d);let h=!0;if(i||(i={attributes:{}},h=!1),p){if(h||(d=d.filter(m=>{var y;return!((y=m.valueExpressionInfo)!=null&&y.expression.includes("$feature"))})),a||(d=d.filter(m=>{var y;return!((y=m.valueExpressionInfo)!=null&&y.expression.includes("$view"))})),d.length>0){const m={spatialReference:r,fields:FEe(i.attributes),geometryType:s};await Oi.createRenderExpressions(d,m),Oi.evaluateOverrides(d,i,s??"esriGeometryPoint",o,a)}Oi.applyOverrides(u,d)}return n&&Oi.applyDictionaryTextOverrides(u,i,n,null),u}static async createRenderExpressions(e,i){const r=[];for(const n of e){const s=n.valueExpressionInfo;if(!s||Oi._expressionToRenderExpression.has(s.expression))continue;const o=Bwe(s.expression,i.spatialReference,i.fields);r.push(o),o.then(a=>Oi._expressionToRenderExpression.set(s.expression,a))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,i,r,n,s){const o={$view:{scale:s==null?void 0:s.scale}};for(const a of e){a.value&&typeof a.value=="object"&&nte(a.value)&&(a.propertyName==="Color"||a.propertyName==="StrokeColor")&&(a.value=sTe(a.value));const u=a.valueExpressionInfo;if(!u)continue;const d=Oi._expressionToRenderExpression.get(u.expression);d&&(a.value=iTe(d,i,o,r,n))}}static applyDictionaryTextOverrides(e,i,r,n,s="Normal"){if(e!=null&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=e.symbolLayers;if(!o)return;for(const a of o)a&&a.type==="CIMVectorMarker"&&Oi.applyDictionaryTextOverrides(a,i,r,n,e.type==="CIMTextSymbol"?e.textCase:s)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const a of o)a&&Oi.applyDictionaryTextOverrides(a,i,r,n)}break;case"CIMMarkerGraphic":{const o=e.textString;if(o&&o.includes("[")){const a=OEe(o,r);e.textString=REe(i,a,n,s)}}}}static applyOverrides(e,i,r,n){if(e.primitiveName){for(const s of i)if(s.primitiveName===e.primitiveName){const o=wk(s.propertyName);if(n&&n.push({cim:e,nocapPropertyName:o,value:e[o]}),r){let a=!1;for(const u of r)u.primitiveName===e.primitiveName&&(a=!0);a||r.push(s)}s.value!=null&&(e[o]=s.value)}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const s of e.effects)Oi.applyOverrides(s,i,r,n);if(e.symbolLayers)for(const s of e.symbolLayers)Oi.applyOverrides(s,i,r,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const s of e.effects)Oi.applyOverrides(s,i,r,n);if(e.type==="CIMVectorMarker"&&e.markerGraphics)for(const s of e.markerGraphics)Oi.applyOverrides(s,i,r,n),Oi.applyOverrides(s.symbol,i,r,n)}}static restoreOverrides(e){for(const i of e)i.cim[i.nocapPropertyName]=i.value}static buildOverrideKey(e){let i="";for(const r of e)r.value!==void 0&&(i+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return i}static toValue(e,i){if(e==="DashTemplate")return i.split(" ").map(r=>Number(r));if(e==="Color"){const r=new ee(i).toRgba();return r[3]*=255,r}return i}};vte._expressionToRenderExpression=new Map;const MB="esri.renderers.support.DictionaryLoader",oTe={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let bte=class{constructor(e,i,r){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new K5(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=i,this.fieldMap=r}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,i){var h;let r;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{r=await this._dictionaryPromise}catch(m){if(rr(m))return this._dictionaryPromise=null,null}const n=(h=this._dictionaryVersion)==null?void 0:h.greaterEqual(4,0),s={};if(this.fieldMap)for(const m of this._symbolFields){const y=yte(this.fieldMap[m],this._fieldIndex);if(y){const g=e.attributes[y];s[m]=n?g:g!=null?""+e.attributes[y]:""}else s[m]=""}let o=null;try{o=r==null?void 0:r(s,i)}catch{return null}if(!o||typeof o!="string"||o==="invalid")return null;const a=o.split(";"),u=[],d=[];for(let m=0;m<a.length;m++){const y=a[m];if(y){if(y.includes("po:")){const g=y.slice(3).split("|");if(g.length===3){const v=g[0],_=g[1];let w=g[2];const S="countrylabel";if(v===S&&_==="TextString"){if(this.fieldMap!=null){let E=this.fieldMap[S];E==null&&(E=S,this.fieldMap[E]=E),e.attributes[E]=w}continue}if(_==="DashTemplate")w=w.split(" ").map(E=>Number(E));else if(_==="Color"){const E=new ee(w).toRgba();w=[E[0],E[1],E[2],255*E[3]]}else w=Number(w);d.push({primitiveName:v,propertyName:_,value:w,defaultValue:null})}}else if(y.includes("|")){for(const g of y.split("|"))if(this._itemNames.has(g)){u.push(g);break}}else if(this._itemNames.has(y))u.push(y);else if(m===0){u.length=0;let g="Invalid_P";e.geometry!=null&&(Sy(e.geometry)?g="Invalid_A":XV(e.geometry)&&(g="Invalid_L")),u.push(g);break}}}const p=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point";return this._cimPartsToCIMSymbol(e,u,d,p,i)}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void U.getLogger(MB).error("no valid URL!");const i=Ee(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:r}]=await Promise.all([i,Tc()]);if(!r)throw this._dictionaryPromise=null,new L("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:s,expression:o,itemsNames:a}=r,u=o;let d=!1;s&&(this._dictionaryVersion=dQ.parse(s),d=this._dictionaryVersion.greaterEqual(4,0)),this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=n.symbol;const p={};if(this.config){const y=this.config;for(const g in y)p[g]=y[g]}if(n.configuration)for(const y of n.configuration)p.hasOwnProperty(y.name)||(p[y.name]=y.value);const h=[];if(e!=null&&e.fields&&this.fieldMap)for(const y in this.fieldMap){const g=this.fieldMap[y],v=e.fields.filter(_=>_.name.toLowerCase()===(g==null?void 0:g.toLowerCase()));v.length>0&&h.push({...v[0],type:d?v[0].type:"esriFieldTypeString"})}h.length>0&&(this._fieldIndex=new jee(h));const m=Hwe(u,e!=null?e.spatialReference:null,h,p).then(y=>{const g={scale:0};return(v,_)=>{if(y==null)return null;const w=y.repurposeFeature({geometry:null,attributes:v});return g.scale=_!=null?_.scale??void 0:void 0,y.evaluate({$feature:w,$view:g},y.services)}}).catch(y=>(U.getLogger(MB).error("Creating dictionary expression failed:",y),null));return this._dictionaryPromise=m,m}async _cimPartsToCIMSymbol(e,i,r,n,s){const o=new Array(i.length);for(let d=0;d<i.length;d++)o[d]=this._getSymbolPart(i[d],s);let a=await Promise.all(o);const u=this.fieldMap;if(u){a=R(a);for(const d of a)vte.applyDictionaryTextOverrides(d,e,u,this._fieldIndex,H3(d))}return new Sp({data:aTe(a,r,n)})}async _getSymbolPart(e,i){const r=this._symbolCache.get(e);if(r)return r;if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(o=>o.data);const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),s=Ee(n,{responseType:"json",query:{f:"json"},...i});this._ongoingRequests.set(e,s),s.finally(()=>this._ongoingRequests.delete(e));try{const o=await s;return this._symbolCache.put(e,o.data),o.data}catch(o){throw o}}};function aTe(t,e,i){if(!t||t.length===0)return null;const r={...t[0]};if(t.length>1){r.effects=null,r.symbolLayers=[];for(const n of t){const s=n;if(s.effects!=null)for(const o of s.symbolLayers)o.effects==null?o.effects=s.effects:o.effects.unshift(...s.effects);r.symbolLayers.unshift(...s.symbolLayers)}}return i&&(r.callout=oTe),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:e}}var q3;let Ml=q3=class extends __($p){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new bte(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,r){r!=null&&r.origin||super.writeVisualVariables(t,e,i,r)}clone(){return new q3({config:R(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:R(this.fieldMap),url:R(this.url),visualVariables:R(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await as(t,e,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];e.has(r)&&t.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};l([c({type:bte})],Ml.prototype,"_loader",null),l([c({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Ml.prototype,"config",void 0),l([c({type:Object,json:{write:!0}})],Ml.prototype,"fieldMap",void 0),l([c({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Ml.prototype,"scaleExpression",void 0),l([te("scaleExpression")],Ml.prototype,"writeData",null),l([c({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Ml.prototype,"scaleExpressionTitle",void 0),l([c({type:String,json:{write:!0}})],Ml.prototype,"url",void 0),l([te("visualVariables")],Ml.prototype,"writeVisualVariables",null),Ml=q3=l([$("esri.renderers.DictionaryRenderer")],Ml);const lTe=Ml;var W3;let sd=W3=class extends j{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):F$(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){var t;return new W3({color:(t=this.color)==null?void 0:t.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};l([c({type:ee,json:{type:[Number],write:!0}})],sd.prototype,"color",void 0),l([c({type:String,json:{write:!0}})],sd.prototype,"field",void 0),l([We("field")],sd.prototype,"castField",null),l([c({type:String,json:{write:!0}})],sd.prototype,"label",void 0),l([c({type:String,json:{write:!0}})],sd.prototype,"valueExpression",void 0),l([c({type:String,json:{write:!0}})],sd.prototype,"valueExpressionTitle",void 0),sd=W3=l([$("esri.renderers.support.AttributeColorInfo")],sd);const _te=sd;var Z3;let Rx=Z3=class extends j{constructor(){super(...arguments),this.unit=null}clone(){return new Z3({unit:this.unit})}};l([c({type:String,json:{write:!0}})],Rx.prototype,"unit",void 0),Rx=Z3=l([$("esri.renderers.support.DotDensityLegendOptions")],Rx);const uTe=Rx;var J3;let Gs=J3=class extends __($p){constructor(t){super(t),this.attributes=null,this.backgroundColor=new ee([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new yr,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new Qo({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new J3({attributes:R(this.attributes),backgroundColor:R(this.backgroundColor),dotBlendingEnabled:R(this.dotBlendingEnabled),dotShape:R(this.dotShape),dotSize:R(this.dotSize),dotValue:R(this.dotValue),legendOptions:R(this.legendOptions),outline:R(this.outline),referenceScale:R(this.referenceScale),seed:R(this.seed),visualVariables:R(this.visualVariables),authoringInfo:R(this.authoringInfo)})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await as(t,e,i.valueExpression),i.field&&t.add(i.field)}};l([c({type:[_te],json:{write:!0}})],Gs.prototype,"attributes",void 0),l([c({type:ee,json:{write:!0}})],Gs.prototype,"backgroundColor",void 0),l([c({type:Boolean,json:{write:!0}})],Gs.prototype,"dotBlendingEnabled",void 0),l([c({type:String,json:{write:!1}})],Gs.prototype,"dotShape",void 0),l([c({type:Number,json:{write:!0}})],Gs.prototype,"dotSize",void 0),l([c({type:uTe,json:{write:!0}})],Gs.prototype,"legendOptions",void 0),l([c({type:yr,json:{default:null,write:!0}})],Gs.prototype,"outline",void 0),l([c({type:Number,json:{write:!0}})],Gs.prototype,"dotValue",void 0),l([c({type:Number,json:{write:!0}})],Gs.prototype,"referenceScale",void 0),l([c({type:Number,json:{write:!0}})],Gs.prototype,"seed",void 0),l([oe({dotDensity:"dot-density"})],Gs.prototype,"type",void 0),Gs=J3=l([$("esri.renderers.DotDensityRenderer")],Gs);const cTe=Gs;var Y3;let h1=Y3=class extends j{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new Y3({color:this.color&&this.color.clone(),ratio:this.ratio})}};l([c({type:ee,json:{type:[Xe],default:null,write:!0}})],h1.prototype,"color",void 0),l([c({type:Number,json:{write:!0}})],h1.prototype,"ratio",void 0),h1=Y3=l([$("esri.renderers.support.HeatmapColorStop")],h1);const gS=h1;let Sv=class extends Ze(j){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};l([c({type:String,json:{write:!0}})],Sv.prototype,"minLabel",void 0),l([c({type:String,json:{write:!0}})],Sv.prototype,"maxLabel",void 0),l([c({type:String,json:{write:!0}})],Sv.prototype,"title",void 0),Sv=l([$("esri.renderers.support.HeatmapLegendOptions")],Sv);const o4=2.4;function dTe(t){return Jr(t*o4)}function pTe(t){return si(t)/o4}function hTe(t,e,i,r){let{color:n,ratio:s}=e,{color:o,ratio:a}=i;a===s&&(a===1?s-=1e-6:a+=1e-6);const u=fr((r-s)/(a-s),0,1);i4(t,n.toArray(),o.toArray(),u)}function nQe(t){const i=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,u)=>a.ratio-u.ratio).map(({color:a,ratio:u})=>({color:a,ratio:Math.max(u,.001)})),t.length<1)return i;let r=t[0],n=t[0],s=1;const o=Rc();for(let a=0;a<512;a++){const u=(a+.5)/512;for(;u>n.ratio&&s<t.length;)r=n,n=t[s++];hTe(o,r,n,u),i.set(o,4*a)}return i}function sQe(t,e,i){const r=Math.sqrt(t**2+e**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function oQe(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var K3;function CB(t){if(t!=null){const{maxDensity:e,minDensity:i,radius:r}=t;if(e!=null||i!=null||r!=null){const{blurRadius:n,maxPixelIntensity:s,minPixelIntensity:o,...a}=t;return a}}return t}let nn=K3=class extends $p{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new gS({ratio:0,color:new ee("rgba(255, 140, 0, 0)")}),new gS({ratio:.75,color:new ee("rgba(255, 140, 0, 1)")}),new gS({ratio:.9,color:new ee("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return CB(t)}get blurRadius(){return pTe(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",dTe(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(o4**2*this.blurRadius**4)}read(t,e){t=CB(t),super.read(t,e)}getSymbol(){return new Or}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,r=this.valueExpression;i&&typeof i=="string"&&Ls(t,e,i),r&&typeof r=="string"&&await as(t,e,r)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new K3({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:R(this.colorStops),field:this.field,legendOptions:R(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};l([c({type:z5,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],nn.prototype,"authoringInfo",void 0),l([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],nn.prototype,"blurRadius",null),l([c({type:[gS],json:{write:!0}})],nn.prototype,"colorStops",void 0),l([c({type:String,json:{write:!0}})],nn.prototype,"field",void 0),l([c({type:Sv,json:{write:!0}})],nn.prototype,"legendOptions",void 0),l([c({type:Number,json:{write:!0}})],nn.prototype,"maxDensity",void 0),l([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],nn.prototype,"maxPixelIntensity",null),l([c({type:Number,json:{write:!0}})],nn.prototype,"minDensity",void 0),l([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],nn.prototype,"minPixelIntensity",null),l([c({type:Number,cast:dt,json:{write:!0}})],nn.prototype,"radius",void 0),l([c({type:Number,range:{min:0},json:{default:0,write:!0}})],nn.prototype,"referenceScale",void 0),l([oe({heatmap:"heatmap"})],nn.prototype,"type",void 0),l([c({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],nn.prototype,"valueExpression",void 0),l([c({type:String})],nn.prototype,"valueExpressionTitle",void 0),l([c({readOnly:!0})],nn.prototype,"_pixelIntensityToDensity",null),nn=K3=l([$("esri.renderers.HeatmapRenderer")],nn);const wte=nn;let sy=class extends Ze(j){constructor(){super(...arguments),this.color=new ee([0,0,0,0]),this.label=null,this.threshold=0}};l([c({type:ee,json:{write:!0}})],sy.prototype,"color",void 0),l([c({type:String,json:{write:!0}})],sy.prototype,"label",void 0),l([c({type:Number,range:{min:0,max:1},json:{write:!0}})],sy.prototype,"threshold",void 0),sy=l([$("esri.renderers.support.OthersCategory")],sy);const mTe={base:v_,key:"type",typeMap:{size:b_,opacity:B5}};let zs=class extends __(Ze($p)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ee([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new sy,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){var e;return new Or({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(ot)}getAttributeHash(){var e;return((e=this.visualVariables)==null?void 0:e.reduce((i,r)=>i+r.getAttributeHash(),""))??""}getMeshHash(){return this.getSymbols().reduce((e,i)=>e+JSON.stringify(i),"")}async collectRequiredFields(e,i){await this.collectVVRequiredFields(e,i);for(const r of this.attributes)r.valueExpression&&await as(e,i,r.valueExpression),r.field&&e.add(r.field)}};l([c({type:[_te],json:{write:!0}})],zs.prototype,"attributes",void 0),l([c(J5)],zs.prototype,"backgroundFillSymbol",void 0),l([c({type:ee,json:{write:!0}})],zs.prototype,"defaultColor",void 0),l([c({type:String,json:{write:!0}})],zs.prototype,"defaultLabel",void 0),l([c({type:Number,range:{min:0,max:1},json:{write:!0}})],zs.prototype,"holePercentage",void 0),l([c({type:sy,json:{write:!0}})],zs.prototype,"othersCategory",void 0),l([c({type:Y5,json:{write:!0}})],zs.prototype,"legendOptions",void 0),l([c({type:yr,json:{default:null,write:!0}})],zs.prototype,"outline",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],zs.prototype,"size",void 0),l([oe({pieChart:"pie-chart"})],zs.prototype,"type",void 0),l([c({types:[mTe]})],zs.prototype,"visualVariables",void 0),zs=l([$("esri.renderers.PieChartRenderer")],zs);const fTe=zs;var X3;let Tf=X3=class extends __($p){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map(i=>i.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return this.getSymbols().reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new X3({description:this.description,label:this.label,symbol:R(this.symbol),visualVariables:R(this.visualVariables),authoringInfo:R(this.authoringInfo)})}};l([c({type:String,json:{write:!0}})],Tf.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],Tf.prototype,"label",void 0),l([c(Z5)],Tf.prototype,"symbol",void 0),l([oe({simple:"simple"})],Tf.prototype,"type",void 0),Tf=X3=l([$("esri.renderers.SimpleRenderer")],Tf);const w_=Tf,yTe=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function Q3(t){return t instanceof q}function kB(t){return t instanceof Y?Object.keys(t.items):Q3(t)?ao(t).keys():t?Object.keys(t):[]}function ST(t,e){return t instanceof Y?t.items[e]:t[e]}function gTe(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function vS(t){return t?t.declaredClass:null}function Ste(t,e){var h;const i=t.diff;if(i&&typeof i=="function")return i(t,e);const r=kB(t),n=kB(e);if(r.length===0&&n.length===0)return;if(!r.length||!n.length||gTe(t,e))return{type:"complete",oldValue:t,newValue:e};const s=n.filter(m=>!r.includes(m)),o=r.filter(m=>!n.includes(m)),a=r.filter(m=>n.includes(m)&&ST(t,m)!==ST(e,m)).concat(s,o).sort(),u=vS(t);if(u&&yTe.has(u)&&a.length)return{type:"complete",oldValue:t,newValue:e};let d;const p=Q3(t)&&Q3(e);for(const m of a){const y=ST(t,m),g=ST(e,m);let v;if((p||typeof y!="function"&&typeof g!="function")&&y!==g&&(y!=null||g!=null)){if(i&&i[m]&&typeof i[m]=="function")v=(h=i[m])==null?void 0:h.call(i,y,g);else if(y instanceof Date&&g instanceof Date){if(y.getTime()===g.getTime())continue;v={type:"complete",oldValue:y,newValue:g}}else v=typeof y=="object"&&typeof g=="object"&&vS(y)===vS(g)?Ste(y,g):{type:"complete",oldValue:y,newValue:g};v!=null&&(d!=null?d.diff[m]=v:d={type:"partial",diff:{[m]:v}})}}return d}function uQe(t,e){return vTe(t,e)}function vTe(t,e){if(t==null)return!1;const i=e.split(".");let r=t;for(const n of i){if(r.type==="complete")return!0;if(r.type!=="partial")return!1;{const s=r.diff[n];if(!s)return!1;r=s}}return!0}function cQe(t,e){if(!t)return!1;if(t.type==="partial"){const i=Object.keys(t.diff);return i.length===1&&i[0]===e}return!1}function $te(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&vS(t)!==vS(e)?{type:"complete",oldValue:t,newValue:e}:Ste(t,e)}function $T(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const i of e.added)if(!$T(i))return!1;for(const i of e.removed)if(!$T(i))return!1;for(const i of e.changed)if(!$T(i))return!1;return!0}case"partial":for(const e in t.diff)if(!$T(t.diff[e]))return!1;return!0}}let $v=class extends Ze(j){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};l([c(kx)],$v.prototype,"value",void 0),l([c(kx)],$v.prototype,"value2",void 0),l([c(kx)],$v.prototype,"value3",void 0),$v=l([$("esri.renderers.support.UniqueValue")],$v);const Y0=$v;let oh=class extends Ze(j){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const i=typeof(e=Array.isArray(e)?e:[e])[0];return i==="string"||i==="number"?e.map(r=>new Y0({value:r})):i==="object"?e[0]instanceof Y0?e:e.map(r=>new Y0(r)):null}};l([c({type:String,json:{write:!0}})],oh.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],oh.prototype,"label",void 0),l([c(gk)],oh.prototype,"symbol",void 0),l([c({type:[Y0],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new Y0({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const i=[];for(const r of t){const n=[r.value,r.value2,r.value3].filter(ot).map(s=>s.toString());i.push(n)}e.values=i}}}})],oh.prototype,"values",void 0),l([We("values")],oh.prototype,"castValues",null),oh=l([$("esri.renderers.support.UniqueValueClass")],oh);const Ete=oh;let m1=class extends Ze(j){constructor(e){super(e),this.heading=null,this.classes=null}};l([c({type:String,json:{write:!0}})],m1.prototype,"heading",void 0),l([c({type:[Ete],json:{write:!0}})],m1.prototype,"classes",void 0),m1=l([$("esri.renderers.support.UniqueValueGroup")],m1);const eF=m1;var tF;let If=tF=class extends j{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new tF({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var e;const t=JSON.stringify((e=this.symbol)==null?void 0:e.toJSON());return`${this.value}.${t}`}};l([c({type:String,json:{write:!0}})],If.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],If.prototype,"label",void 0),l([c(Z5)],If.prototype,"symbol",void 0),l([c(kx)],If.prototype,"value",void 0),If=tF=l([$("esri.renderers.support.UniqueValueInfo")],If);const bS=If,LB=new Map;async function bTe(t,e){try{return{data:(await a4(t,e)).data,baseUrl:bV(t),styleUrl:t}}catch(i){return Vo(i),null}}function _Te(t,e,i){var u;const r=e.portal!=null?e.portal:ki.getDefault();let n;const s=`${r.url} - ${(u=r.user)==null?void 0:u.username} - ${t}`,o=LB.get(s);if(o)return o;const a=wTe(t,r,i).then(d=>(n=d,d.fetchData())).then(d=>({data:d,baseUrl:n.itemUrl??"",styleName:t}));return LB.set(s,a),a}function wTe(t,e,i){return e.load(i).then(()=>{const r=new Uo({disableExtraQuery:!0,query:`owner:${AB} AND type:${OB} AND typekeywords:"${t}"`});return e.queryItems(r,i)}).then(({results:r})=>{var o;let n=null;const s=t.toLowerCase();if(r&&Array.isArray(r)){for(const a of r)if(((o=a.typeKeywords)==null?void 0:o.some(d=>d.toLowerCase()===s))&&a.type===OB&&a.owner===AB){n=a;break}}if(!n)throw new L("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)})}function Tte(t,e,i){return(t==null?void 0:t.styleUrl)!=null?bTe(t.styleUrl,i):(t==null?void 0:t.styleName)!=null?_Te(t.styleName,e,i):Promise.reject(new L("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function Ite(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function STe(t,e,i=["gltf"]){if(e==="cimRef")return encodeURI(t.cimRef);if(t.formatInfos&&!G("enable-feature:force-wosr"))for(const r of i){const n=t.formatInfos.find(s=>s.type===r);if(n)return n.href}return encodeURI(t.webRef)}function a4(t,e){const i={responseType:"json",query:{f:"json"},...e};return Ee(kn(t),i)}const AB="esri_en",OB="Style",$Te="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var f1;const xte="esri.renderers.UniqueValueRenderer",Fp=()=>U.getLogger(xte),RB="uvInfos-watcher",PB="uvGroups-watcher",ETe=",",TTe=pi(bS);function ITe(t){const{field1:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueInfos:s,valueExpression:o}=t,a=!(!e||!i);return[{classes:(s??[]).map(u=>{var w;const{symbol:d,label:p,value:h,description:m}=u,[y,g,v]=a?((w=h==null?void 0:h.toString())==null?void 0:w.split(n||""))||[]:[h],_=[];return(e||o)&&_.push(y),i&&_.push(g),r&&_.push(v),{symbol:d,label:p,values:[_],description:m}})}]}function Sg(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let Ti=f1=class extends __($p){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,i){if(!e&&!i)return;if(!e||!i)return{type:"complete",oldValue:e,newValue:i};let r=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<i.length;s++){const o=e.find(a=>a.value===i[s].value);o?$te(o,i[s])?(n.changed.push({type:"complete",oldValue:o,newValue:i[s]}),r=!0):n.unchanged.push({oldValue:o,newValue:i[s]}):(n.added.push(i[s]),r=!0)}for(let s=0;s<e.length;s++)i.find(o=>o.value===e[s].value)||(n.removed.push(e[s]),r=!0);return r?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:F$(t)}writeField(t,e,i,r){typeof t=="string"?e[i]=t:r!=null&&r.messages?r.messages.push(new L("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):Fp().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||ki.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const r=fm(e.styleUrl,i);return Object.freeze({styleUrl:r})}}writeStyleOrigin(t,e,i,r){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=j$(t.styleUrl,r))}set uniqueValueGroups(t){this.styleOrigin?Fp().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?Fp().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var r;if(this.styleOrigin)return void Fp().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof t=="object"?TTe(t):new bS({value:t,symbol:bee(e)}),(r=this.uniqueValueInfos)==null||r.push(i),this._valueInfoMap[Sg(i.value)]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void Fp().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let i=0;i<e.length;i++){const r=e[i];if(String(r.value)===String(t)){delete this._valueInfoMap[Sg(t)],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await Tc()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void Fp().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return(i==null?void 0:i.symbol)||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(i==null?void 0:i.arcade)==null){const n=await Tc(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:n}}const r=this._getUniqueValueInfo(t,i);return(r==null?void 0:r.symbol)||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){var r;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=(r=this.uniqueValueInfos)==null?void 0:r.reduce((n,s)=>n+s.getMeshHash(),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new f1({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:R(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:R(this.visualVariables),legendOptions:R(this.legendOptions),authoringInfo:R(this.authoringInfo),backgroundFillSymbol:R(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=R(this.uniqueValueInfos),i=R(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(R(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),as(t,e,this.valueExpression)];Ls(t,e,this.field),Ls(t,e,this.field2),Ls(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return Tte(this.styleOrigin,{portal:this.portal}).then(t=>{var i;const e=[];return this._valueInfoMap={},t!=null&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const n=new dg({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const s=new bS({value:r.name,symbol:n});e.push(s),this._valueInfoMap[Sg(r.name)]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)!=null&&i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",ETe)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[Sg(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(RB);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(N(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(r,n)=>{r!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,RB)}}_watchUniqueValueGroups(){this.removeHandles(PB);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(N(()=>({classes:i.classes}),(r,n)=>{r!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const r of i.classes??[])e.push(N(()=>({symbol:r.symbol,values:r.values,label:r.label,description:r.description}),(n,s)=>{n!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,PB)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueGroups:s,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const u of s)for(const d of u.classes??[]){const{symbol:p,label:h,values:m,description:y}=d;for(const g of m??[]){const{value:v,value2:_,value3:w}=g,S=[v];i&&S.push(_),r&&S.push(w);const E=a?S.join(n||""):S[0]??void 0;t.push(new bS({symbol:p,label:h,value:E,description:y}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:r,fieldDelimiter:n,uniqueValueInfos:s}=this;if(!e&&!r||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=s.map(d=>{var w;const{symbol:p,label:h,value:m,description:y}=d,[g,v,_]=o?((w=m==null?void 0:m.toString())==null?void 0:w.split(n||""))||[]:[m];return new Ete({symbol:p,label:h,description:y,values:[new Y0({value:g,value2:v,value3:_})]})}),u=[new eF({classes:a})];t&&Object.freeze(u),this._set("uniqueValueGroups",u),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:s,timeZone:o}=e??{};let a=this._cache.compiledFunc;const u=s.arcadeUtils;if(!a){const p=u.createSyntaxTree(this.valueExpression);a=u.createFunction(p),this._cache.compiledFunc=a}const d=u.executeFunction(a,u.createExecContext(t,u.getViewInfo({viewingMode:i,scale:r,spatialReference:n}),o));return this._valueInfoMap[Sg(d)]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let r;if(this.field2){const n=this.field2,s=this.field3,o=[];e&&o.push(i[e]),n&&o.push(i[n]),s&&o.push(i[s]),r=o.join(this.fieldDelimiter||"")}else e&&(r=i[e]);return this._valueInfoMap[Sg(r)]}static fromPortalStyle(t,e){const i=new f1(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",(e==null?void 0:e.portal)||ki.getDefault());const r=i.populateFromStyle();return r.catch(n=>{Fp().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",n)}),r}static fromStyleUrl(t,e){const i=new f1(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const r=i.populateFromStyle();return r.catch(n=>{Fp().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),r}};l([c({readOnly:!0})],Ti.prototype,"_cache",null),l([oe({uniqueValue:"unique-value"})],Ti.prototype,"type",void 0),l([c(J5)],Ti.prototype,"backgroundFillSymbol",void 0),l([c({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Ti.prototype,"field",null),l([We("field")],Ti.prototype,"castField",null),l([te("field")],Ti.prototype,"writeField",null),l([c({type:String,value:null,json:{write:!0}})],Ti.prototype,"field2",null),l([c({type:String,value:null,json:{write:!0}})],Ti.prototype,"field3",null),l([c({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Ti.prototype,"orderByClassesEnabled",void 0),l([c({type:String,value:null,json:{write:!0}})],Ti.prototype,"valueExpression",null),l([c({type:String,json:{write:!0}})],Ti.prototype,"valueExpressionTitle",void 0),l([c({type:Y5,json:{write:!0}})],Ti.prototype,"legendOptions",void 0),l([c({type:String,json:{write:!0}})],Ti.prototype,"defaultLabel",void 0),l([c(iV({...gk},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Ti.prototype,"defaultSymbol",null),l([c({type:String,value:null,json:{write:!0}})],Ti.prototype,"fieldDelimiter",null),l([c({type:ki,readOnly:!0})],Ti.prototype,"portal",void 0),l([X("portal",["styleName"])],Ti.prototype,"readPortal",null),l([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Ti.prototype,"styleOrigin",void 0),l([X("styleOrigin",["styleName","styleUrl"])],Ti.prototype,"readStyleOrigin",null),l([te("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Ti.prototype,"writeStyleOrigin",null),l([c({type:[eF],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||ITe(e)).map(r=>eF.fromJSON(r,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Ti.prototype,"uniqueValueGroups",null),l([c({type:[bS],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Ti.prototype,"uniqueValueInfos",null),Ti=f1=l([$(xte)],Ti);const l4=Ti,Sk={key:"type",base:$p,typeMap:{heatmap:wte,simple:w_,"unique-value":l4,"class-breaks":Uee,"dot-density":cTe,dictionary:lTe,"pie-chart":fTe},errorContext:"renderer"},xTe={key:"type",base:$p,typeMap:{simple:w_,"unique-value":l4,"class-breaks":Uee,heatmap:wte},errorContext:"renderer",validate:MTe};function MTe(t){switch(t.type){case"simple":return CTe(t);case"unique-value":return kTe(t);case"class-breaks":return LTe(t);case"heatmap":return t}}function CTe(t){if(t.symbol)return t;U.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function kTe(t){const e=t.uniqueValueInfos,i=e==null?void 0:e.filter(({symbol:r,label:n},s)=>(r||U.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${s}] ${n}) without a symbol from web scene.`),!!r));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.uniqueValueInfos=i),t}function LTe(t){const e=t.classBreakInfos,i=e==null?void 0:e.filter(({symbol:r,label:n},s)=>(r||U.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${s}] ${n}) without a symbol from web scene.`),!!r));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.classBreakInfos=i),t}function ATe(t,e){return a$(t,null,e)}const OTe=s_({types:Sk});function a$(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(i!=null&&i.messages&&i.messages.push(new Jo("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):OTe(t,e,i):null}const mn=(t=>t)(["operational-layers","basemap","ground"]);var iF;let xf=iF=class extends j{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new iF({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};l([c({type:String,json:{write:!0}})],xf.prototype,"expression",void 0),l([c({type:String,json:{write:!0}})],xf.prototype,"name",void 0),l([c({type:["boolean","date","number","string"],json:{write:!0}})],xf.prototype,"returnType",void 0),l([c({type:String,json:{write:!0}})],xf.prototype,"title",void 0),xf=iF=l([$("esri.form.ExpressionInfo")],xf);const RTe=xf;let Mf=class extends j{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};l([c({type:String,json:{write:!0}})],Mf.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],Mf.prototype,"label",void 0),l([c()],Mf.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],Mf.prototype,"visibilityExpression",void 0),Mf=l([$("esri.form.elements.Element")],Mf);const By=Mf;let Px=class extends Ze(j){constructor(e){super(e),this.type=null}};l([c()],Px.prototype,"type",void 0),Px=l([$("esri.form.elements.inputs.attachments.Input")],Px);const vm=Px,$k=["any","capture","upload"];let Ev=class extends vm{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};l([c({type:["audio"],readOnly:!0,json:{write:!0}})],Ev.prototype,"type",void 0),l([c({type:$k,json:{write:!0}})],Ev.prototype,"inputMethod",void 0),l([c({type:Number,json:{write:!0}})],Ev.prototype,"maxDuration",void 0),Ev=l([$("esri.form.elements.inputs.attachments.AudioInput")],Ev);const FB=Ev;let y1=class extends vm{constructor(e){super(e),this.type="document",this.maxFileSize=null}};l([c({type:["document"],readOnly:!0,json:{write:!0}})],y1.prototype,"type",void 0),l([c({type:Number,json:{write:!0}})],y1.prototype,"maxFileSize",void 0),y1=l([$("esri.form.elements.inputs.attachments.DocumentInput")],y1);const NB=y1;let Tv=class extends vm{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};l([c({type:["image"],readOnly:!0,json:{write:!0}})],Tv.prototype,"type",void 0),l([c({type:$k,json:{write:!0}})],Tv.prototype,"inputMethod",void 0),l([c({type:Number,json:{write:!0}})],Tv.prototype,"maxImageSize",void 0),Tv=l([$("esri.form.elements.inputs.attachments.ImageInput")],Tv);const DB=Tv;let g1=class extends vm{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};l([c({type:["signature"],readOnly:!0,json:{write:!0}})],g1.prototype,"type",void 0),l([c({type:$k,json:{write:!0}})],g1.prototype,"inputMethod",void 0),g1=l([$("esri.form.elements.inputs.attachments.SignatureInput")],g1);const VB=g1;let Iv=class extends vm{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};l([c({type:["video"],readOnly:!0,json:{write:!0}})],Iv.prototype,"type",void 0),l([c({type:$k,json:{write:!0}})],Iv.prototype,"inputMethod",void 0),l([c({type:Number,json:{write:!0}})],Iv.prototype,"maxDuration",void 0),Iv=l([$("esri.form.elements.inputs.attachments.VideoInput")],Iv);const UB=Iv;function Mte(t){return{nestableTypes:{base:vm,key:"type",typeMap:{audio:FB,document:NB,image:DB,signature:VB,video:UB}},allTypes:{base:vm,key:"type",typeMap:{attachment:t,audio:FB,document:NB,image:DB,signature:VB,video:UB}}}}function PTe(t,e,i){return t?t.map(r=>Qa(e.nestableTypes,r)):null}function FTe(t,e,i){if(!t)return null;const r=e.nestableTypes.typeMap;return t.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function NTe(t,e,i){if(!t)return null;const r=e.nestableTypes.typeMap;return t.filter(n=>r[n.type]).map(n=>n.toJSON())}let rc=class extends vm{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return PTe(e,eA)}readInputs(e,i){return FTe(i.inputTypes,eA)}writeInputs(e,i){i.inputTypes=NTe(e,eA)}};l([c({type:["attachment"],readOnly:!0,json:{write:!0}})],rc.prototype,"type",void 0),l([c({type:["any","exact","exactOrNone"],json:{write:!0}})],rc.prototype,"attachmentAssociationType",void 0),l([c({json:{write:{isRequired:!0}}})],rc.prototype,"inputTypes",void 0),l([We("inputTypes")],rc.prototype,"castInputs",null),l([X("inputTypes")],rc.prototype,"readInputs",null),l([te("inputTypes")],rc.prototype,"writeInputs",null),rc=l([$("esri.form.elements.inputs.attachments.AttachmentInput")],rc);const eA=Mte(rc),DTe=rc;var rF;const VTe=Mte(DTe);let Eo=rF=class extends By{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){var t;return new rF({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:(t=this.input)==null?void 0:t.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};l([c({type:Boolean,json:{write:!0}})],Eo.prototype,"allowUserRename",void 0),l([c({type:String,json:{write:{isRequired:!0}}})],Eo.prototype,"attachmentKeyword",void 0),l([c({type:Boolean,json:{write:!0}})],Eo.prototype,"displayFilename",void 0),l([c({type:String,json:{write:!0}})],Eo.prototype,"editableExpression",void 0),l([c({type:String,json:{write:!0}})],Eo.prototype,"filenameExpression",void 0),l([c({types:VTe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Eo.prototype,"input",void 0),l([c({type:Number,json:{write:!0}})],Eo.prototype,"maxAttachmentCount",void 0),l([c({type:Number,json:{write:!0}})],Eo.prototype,"minAttachmentCount",void 0),l([c({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Eo.prototype,"type",void 0),l([c({type:Boolean,json:{write:!0}})],Eo.prototype,"useOriginalFilename",void 0),Eo=rF=l([$("esri.form.elements.AttachmentElement")],Eo);const jB=Eo;let Fx=class extends j{constructor(e){super(e),this.type=null}};l([c()],Fx.prototype,"type",void 0),Fx=l([$("esri.form.elements.inputs.Input")],Fx);const Ep=Fx;let v1=class extends Ep{constructor(e){super(e),this.maxLength=null,this.minLength=0}};l([c({type:Number,json:{write:!0}})],v1.prototype,"maxLength",void 0),l([c({type:Number,json:{write:!0}})],v1.prototype,"minLength",void 0),v1=l([$("esri.form.elements.inputs.TextInput")],v1);const u4=v1;var nF;let Nx=nF=class extends u4{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new nF({maxLength:this.maxLength,minLength:this.minLength})}};l([c({type:["barcode-scanner"],json:{read:!1,write:!0}})],Nx.prototype,"type",void 0),Nx=nF=l([$("esri.form.elements.inputs.BarcodeScannerInput")],Nx);const UTe=Nx;var sF;let xv=sF=class extends Ep{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new sF({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};l([c({type:String,json:{write:!0}})],xv.prototype,"noValueOptionLabel",void 0),l([c({type:Boolean,json:{write:!0}})],xv.prototype,"showNoValueOption",void 0),l([c({type:["combo-box"],json:{read:!1,write:!0}})],xv.prototype,"type",void 0),xv=sF=l([$("esri.form.elements.inputs.ComboBoxInput")],xv);const jTe=xv;var oF;function GB(t){return t??null}function zB(t){return t??null}let ju=oF=class extends Ep{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return GB(e.max)}writeMax(t,e){e.max=zB(t)}readMin(t,e){return GB(e.min)}writeMin(t,e){e.min=zB(t)}clone(){return new oF({max:this.max,min:this.min})}};l([c({type:String,json:{type:String,write:!0}})],ju.prototype,"max",void 0),l([X("max")],ju.prototype,"readMax",null),l([te("max")],ju.prototype,"writeMax",null),l([c({type:String,json:{type:String,write:!0}})],ju.prototype,"min",void 0),l([X("min")],ju.prototype,"readMin",null),l([te("min")],ju.prototype,"writeMin",null),l([c({type:["date-picker"],json:{read:!1,write:!0}})],ju.prototype,"type",void 0),ju=oF=l([$("esri.form.elements.inputs.DatePickerInput")],ju);const GTe=ju;var aF;function tA(t){return t??null}function iA(t){return t??null}let Bs=aF=class extends Ep{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return tA(e.max)}writeMax(t,e){e.max=iA(t)}readMin(t,e){return tA(e.min)}writeMin(t,e){e.min=iA(t)}readTimeResolution(t,e){return tA(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=iA(t)}clone(){return new aF({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};l([c({type:Boolean,json:{write:!0}})],Bs.prototype,"includeTimeOffset",void 0),l([c({type:String,json:{type:String,write:!0}})],Bs.prototype,"max",void 0),l([X("max")],Bs.prototype,"readMax",null),l([te("max")],Bs.prototype,"writeMax",null),l([c({type:String,json:{type:String,write:!0}})],Bs.prototype,"min",void 0),l([X("min")],Bs.prototype,"readMin",null),l([te("min")],Bs.prototype,"writeMin",null),l([c({type:String,json:{type:String,write:!0}})],Bs.prototype,"timeResolution",void 0),l([X("timeResolution")],Bs.prototype,"readTimeResolution",null),l([te("timeResolution")],Bs.prototype,"writeTimeResolution",null),l([c({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],Bs.prototype,"type",void 0),Bs=aF=l([$("esri.form.elements.inputs.DateTimeOffsetPickerInput")],Bs);const zTe=Bs;var lF;function BB(t){return t!=null?new Date(t):null}function HB(t){return t?t.getTime():null}let Cl=lF=class extends Ep{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return BB(e.max)}writeMax(t,e){e.max=HB(t)}readMin(t,e){return BB(e.min)}writeMin(t,e){e.min=HB(t)}clone(){return new lF({includeTime:this.includeTime,max:this.max,min:this.min})}};l([c({type:Boolean,json:{write:!0}})],Cl.prototype,"includeTime",void 0),l([c({type:Date,json:{type:Number,write:!0}})],Cl.prototype,"max",void 0),l([X("max")],Cl.prototype,"readMax",null),l([te("max")],Cl.prototype,"writeMax",null),l([c({type:Date,json:{type:Number,write:!0}})],Cl.prototype,"min",void 0),l([X("min")],Cl.prototype,"readMin",null),l([te("min")],Cl.prototype,"writeMin",null),l([c({type:["datetime-picker"],json:{read:!1,write:!0}})],Cl.prototype,"type",void 0),Cl=lF=l([$("esri.form.elements.inputs.DateTimePickerInput")],Cl);const BTe=Cl;var uF;let Mv=uF=class extends Ep{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new uF({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};l([c({type:String,json:{write:!0}})],Mv.prototype,"noValueOptionLabel",void 0),l([c({type:Boolean,json:{write:!0}})],Mv.prototype,"showNoValueOption",void 0),l([c({type:["radio-buttons"],json:{read:!1,write:!0}})],Mv.prototype,"type",void 0),Mv=uF=l([$("esri.form.elements.inputs.RadioButtonsInput")],Mv);const HTe=Mv;var cF;let Cv=cF=class extends Ep{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new cF({offValue:this.offValue,onValue:this.onValue})}};l([c({type:[String,Number],json:{write:!0}})],Cv.prototype,"offValue",void 0),l([c({type:[String,Number],json:{write:!0}})],Cv.prototype,"onValue",void 0),l([c({type:["switch"],json:{read:!1,write:!0}})],Cv.prototype,"type",void 0),Cv=cF=l([$("esri.form.elements.inputs.SwitchInput")],Cv);const qTe=Cv;var dF;let Dx=dF=class extends u4{constructor(t){super(t),this.type="text-area"}clone(){return new dF({maxLength:this.maxLength,minLength:this.minLength})}};l([c({type:["text-area"],json:{read:!1,write:!0}})],Dx.prototype,"type",void 0),Dx=dF=l([$("esri.form.elements.inputs.TextAreaInput")],Dx);const WTe=Dx;var pF;let Vx=pF=class extends u4{constructor(t){super(t),this.type="text-box"}clone(){return new pF({maxLength:this.maxLength,minLength:this.minLength})}};l([c({type:["text-box"],json:{read:!1,write:!0}})],Vx.prototype,"type",void 0),Vx=pF=l([$("esri.form.elements.inputs.TextBoxInput")],Vx);const ZTe=Vx;var hF;function rA(t){return t??null}function nA(t){return t??null}let To=hF=class extends Ep{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return rA(e.max)}writeMax(t,e){e.max=nA(t)}readMin(t,e){return rA(e.min)}writeMin(t,e){e.min=nA(t)}readTimeResolution(t,e){return rA(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=nA(t)}clone(){return new hF({max:this.max,min:this.min,timeResolution:this.timeResolution})}};l([c({type:String,json:{type:String,write:!0}})],To.prototype,"max",void 0),l([X("max")],To.prototype,"readMax",null),l([te("max")],To.prototype,"writeMax",null),l([c({type:String,json:{type:String,write:!0}})],To.prototype,"min",void 0),l([X("min")],To.prototype,"readMin",null),l([te("min")],To.prototype,"writeMin",null),l([c({type:String,json:{type:String,write:!0}})],To.prototype,"timeResolution",void 0),l([X("timeResolution")],To.prototype,"readTimeResolution",null),l([te("timeResolution")],To.prototype,"writeTimeResolution",null),l([c({type:["time-picker"],json:{read:!1,write:!0}})],To.prototype,"type",void 0),To=hF=l([$("esri.form.elements.inputs.TimePickerInput")],To);const JTe=To,YTe={base:Ep,key:"type",typeMap:{"barcode-scanner":UTe,"combo-box":jTe,"date-picker":GTe,"datetime-picker":BTe,"datetimeoffset-picker":zTe,"radio-buttons":HTe,switch:qTe,"text-area":WTe,"text-box":ZTe,"time-picker":JTe}};var mF;let Jd=mF=class extends j{constructor(t){super(t),this.name=null,this.code=null}clone(){return new mF({name:this.name,code:this.code})}};l([c({type:String,json:{write:!0}})],Jd.prototype,"name",void 0),l([c({type:[String,Number],json:{write:!0}})],Jd.prototype,"code",void 0),Jd=mF=l([$("esri.layers.support.CodedValue")],Jd);const KTe=new $e({inherited:"inherited",codedValue:"coded-value",range:"range"});let b1=class extends j{constructor(e){super(e),this.name=null,this.type=null}};l([c({type:String,json:{write:!0}})],b1.prototype,"name",void 0),l([oe(KTe)],b1.prototype,"type",void 0),b1=l([$("esri.layers.support.Domain")],b1);const Ek=b1;var fF;let _1=fF=class extends Ek{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some(r=>(String(r.code)===i&&(e=r.name),!!e))}return e}clone(){return new fF({codedValues:R(this.codedValues),name:this.name})}};l([c({type:[Jd],json:{write:!0}})],_1.prototype,"codedValues",void 0),l([oe({codedValue:"coded-value"})],_1.prototype,"type",void 0),_1=fF=l([$("esri.layers.support.CodedValueDomain")],_1);const Fb=_1;var yF;let Ux=yF=class extends Ek{constructor(t){super(t),this.type="inherited"}clone(){return new yF}};l([oe({inherited:"inherited"})],Ux.prototype,"type",void 0),Ux=yF=l([$("esri.layers.support.InheritedDomain")],Ux);const Cte=Ux;var gF;let kv=gF=class extends Ek{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new gF({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};l([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],kv.prototype,"maxValue",void 0),l([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[0]}},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],kv.prototype,"minValue",void 0),l([oe({range:"range"})],kv.prototype,"type",void 0),kv=gF=l([$("esri.layers.support.RangeDomain")],kv);const kte=kv,Lte={key:"type",base:Ek,typeMap:{range:kte,"coded-value":Fb,inherited:Cte}};function Tk(t){if(!(t!=null&&t.type))return null;switch(t.type){case"range":return kte.fromJSON(t);case"codedValue":return Fb.fromJSON(t);case"inherited":return Cte.fromJSON(t)}return null}var vF;let ma=vF=class extends By{constructor(t){super(t),this.domain=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}get editable(){return this._get("editable")??!0}set editable(t){this._set("editable",t)}clone(){return new vF({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};l([c({types:Lte,json:{read:{reader:Tk},write:!0}})],ma.prototype,"domain",void 0),l([c({type:Boolean,json:{write:!0}})],ma.prototype,"editable",null),l([c({type:String,json:{write:!0}})],ma.prototype,"editableExpression",void 0),l([c({type:String,json:{write:!0}})],ma.prototype,"fieldName",void 0),l([c({type:String,json:{write:!0}})],ma.prototype,"hint",void 0),l([c({types:YTe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],ma.prototype,"input",void 0),l([c({type:String,json:{write:!0}})],ma.prototype,"requiredExpression",void 0),l([c({type:String,json:{read:!1,write:!0}})],ma.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],ma.prototype,"valueExpression",void 0),ma=vF=l([$("esri.form.elements.FieldElement")],ma);const qB=ma;var bF;let od=bF=class extends By{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new bF({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:R(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};l([c({type:Number,json:{write:!0}})],od.prototype,"displayCount",void 0),l([c({type:["list"],json:{write:!0}})],od.prototype,"displayType",void 0),l([c({type:String,json:{write:!0}})],od.prototype,"editableExpression",void 0),l([c({type:[k5],json:{write:!0}})],od.prototype,"orderByFields",void 0),l([c({type:Number,json:{write:!0}})],od.prototype,"relationshipId",void 0),l([c({type:["relationship"],json:{read:!1,write:!0}})],od.prototype,"type",void 0),od=bF=l([$("esri.form.elements.RelationshipElement")],od);const WB=od;var _F;let Lv=_F=class extends By{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new _F({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};l([c({type:String,json:{write:!0}})],Lv.prototype,"text",void 0),l([c({type:String,json:{write:!0}})],Lv.prototype,"textFormat",void 0),l([c({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Lv.prototype,"type",void 0),Lv=_F=l([$("esri.form.elements.TextElement")],Lv);const ZB=Lv;function Ate(t){return{typesWithGroup:{base:By,key:"type",typeMap:{attachment:jB,field:qB,group:t,relationship:WB,text:ZB}},typesWithoutGroup:{base:By,key:"type",typeMap:{attachment:jB,field:qB,relationship:WB,text:ZB}}}}function Ote(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function Rte(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>n.toJSON())}function Pte(t,e,i=!0){return t?t.map(r=>Qa(i?e.typesWithGroup:e.typesWithoutGroup,r)):null}var wF;let nc=wF=class extends By{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return Pte(t,sA,!1)}readElements(t,e){return Ote(e.formElements,sA,!1)}writeElements(t,e){e.formElements=Rte(t,sA,!1)}clone(){return new wF({description:this.description,elements:R(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};l([c({json:{write:!0}})],nc.prototype,"elements",void 0),l([We("elements")],nc.prototype,"castElements",null),l([X("elements",["formElements"])],nc.prototype,"readElements",null),l([te("elements")],nc.prototype,"writeElements",null),l([c({type:["collapsed","expanded"],json:{write:!0}})],nc.prototype,"initialState",void 0),l([c({type:String,json:{read:!1,write:!0}})],nc.prototype,"type",void 0),nc=wF=l([$("esri.form.elements.GroupElement")],nc);const sA=Ate(nc),XTe=nc,c4=t=>t.type==="field",SF=t=>t.type==="group",Fte=t=>t.type==="text",QTe=t=>t.type==="relationship";var $F;const oA=Ate(XTe);let kl=$F=class extends j{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return Pte(t,oA)}readElements(t,e){return Ote(e.formElements,oA)}writeElements(t,e){e.formElements=Rte(t,oA)}clone(){return new $F({description:this.description,expressionInfos:R(this.expressionInfos),elements:R(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const i=new Set,{description:r,elements:n,expressionInfos:s,title:o}=this;if(_S(i,t,r),_S(i,t,o),!n)return[];const a=eIe(n,s).map(u=>as(i,t,u));await Promise.all(a);for(const u of n)Nte(i,{fieldsIndex:t,relationships:e},u);return Array.from(i).sort()}};function Nte(t,e,i){var n;const{fieldsIndex:r}=e;if(!r||r.fields.length!==t.size)switch(_S(t,r,i.label),_S(t,r,i.description),i.type){case"field":Ls(t,r,i.fieldName);break;case"group":i.elements.forEach(s=>Nte(t,e,s));break;case"relationship":if(e.relationships){const s=e.relationships.find(o=>o.id===i.relationshipId);s&&Ls(t,r,s.keyField)}Gy(t,r,(n=i.orderByFields)==null?void 0:n.map(s=>s.field));break;case"text":_S(t,r,i.text)}}function eIe(t,e){if(!e||e.length===0)return[];const i=Dte(t),r=[];for(const n of e)i.has(n.name)&&r.push(n.expression);return r}function Dte(t){const e=new Set;for(const i of t)if(Xj(e,i.visibilityExpression),!Fte(i)){if(SF(i))DS(e,Dte(i.elements));else if(Xj(e,i.editableExpression),c4(i)){const{requiredExpression:r,valueExpression:n}=i;DS(e,[r,n])}}return e}function _S(t,e,i){Gy(t,e,x5(i))}l([c({type:String,json:{write:!0}})],kl.prototype,"description",void 0),l([c({json:{write:!0}})],kl.prototype,"elements",void 0),l([We("elements")],kl.prototype,"castElements",null),l([X("elements",["formElements"])],kl.prototype,"readElements",null),l([te("elements")],kl.prototype,"writeElements",null),l([c({type:[RTe],json:{write:!0}})],kl.prototype,"expressionInfos",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],kl.prototype,"preserveFieldValuesWhenHidden",void 0),l([c({type:String,json:{write:!0}})],kl.prototype,"title",void 0),kl=$F=l([$("esri.form.FormTemplate")],kl);const Vte=kl;let Nb=class{constructor(e=i=>i.values().next().value){this._peeker=e,this._observable=new a_,this._items=new Set}get length(){return he(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return he(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const i=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){he(this._observable),yield*this._items}};const Ute=new FinalizationRegistry(t=>{t.close()});function tIe(t,e){Ute.register(t,e,e)}function iIe(t){Ute.unregister(t)}function jte(t,e){return new Proxy({},{get:(i,r,n)=>(...s)=>{let o,a;const u=s[s.length-1];return rIe(u)&&(o=u.signal,a=u.transferList,s.pop()),t.apply(e?`${e}.${r.toString()}`:r.toString(),s,{transferList:a,signal:o})}})}function rIe(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const nIe={statsWorker:()=>k(()=>import("./statsWorker-COAYQ8tm.js"),__vite__mapDeps([30,31,32,33])),geometryEngineWorker:()=>k(()=>import("./geometryEngineWorker-BiqU-FdE.js"),__vite__mapDeps([34,28,12,1,29])),CSVSourceWorker:()=>k(()=>import("./CSVSourceWorker-DGb3EZM6.js"),__vite__mapDeps([35,36,29,25,26,37,24,27,38,39,40,41,42,43,44,45,46,31,32,33,47,23,48,49])),EdgeProcessingWorker:()=>k(()=>import("./EdgeProcessingWorker-exssg-OL.js"),__vite__mapDeps([50,51,52,53,54,55,56,57,58,59,60,61])),ElevationSamplerWorker:()=>k(()=>import("./ElevationSamplerWorker-CzVShatr.js"),__vite__mapDeps([62,39,63,64,65,66,53,67])),FeatureServiceSnappingSourceWorker:()=>k(()=>import("./FeatureServiceSnappingSourceWorker-BU2pHsc6.js"),__vite__mapDeps([68,37,24,25,26,27,38,39,40,41,29,42,43,44,45,46,31,32,33,47,69,70,71,72])),GeoJSONSourceWorker:()=>k(()=>import("./GeoJSONSourceWorker-BHaa3qp-.js"),__vite__mapDeps([73,24,25,26,27,37,38,39,40,41,29,42,43,44,45,46,31,32,33,47,74,36,48,49,75])),LercWorker:()=>k(()=>import("./LercWorker-938DIqBj.js"),[]),MemorySourceWorker:()=>k(()=>import("./MemorySourceWorker-1Bx-cNSg.js"),__vite__mapDeps([76,24,25,26,27,77,37,38,39,40,41,29,42,43,44,45,46,31,32,33,47,48,49,75,36])),PBFDecoderWorker:()=>k(()=>import("./PBFDecoderWorker-Dt9Fmnlu.js"),__vite__mapDeps([78,79,24,25,26,27,70,71])),FeaturePipelineWorker:()=>k(()=>import("./FeaturePipelineWorker-C1a4izQ9.js"),__vite__mapDeps([80,81,82,83,84,60,85,86,87,88,26,89,90,43,24,25,27,91,92,55,41,29,40,93,94,95,96,97,98,42,44,45,46,31,32,33,47,72,70,71,99,74,36,48,49,75,100,101])),PointCloudWorker:()=>k(()=>import("./PointCloudWorker-BGLJ6ntk.js"),__vite__mapDeps([102,103,104,105])),RasterWorker:()=>k(()=>import("./RasterWorker-Bug7ziTw.js"),__vite__mapDeps([106,107,108,1,109,110])),SceneLayerSnappingSourceWorker:()=>k(()=>import("./SceneLayerSnappingSourceWorker-CPCxEXP7.js"),__vite__mapDeps([111,112,55,56,57,58,52,53,54,59,60,61])),SceneLayerWorker:()=>k(()=>import("./SceneLayerWorker-Dba2M2rZ.js"),__vite__mapDeps([113,63,66,114,105,115,116,117,118,92])),WFSSourceWorker:()=>k(()=>import("./WFSSourceWorker-C8k5xmyP.js"),__vite__mapDeps([119,24,25,26,27,37,38,39,40,41,29,42,43,44,45,46,31,32,33,47,74,36,75,120,121])),WorkerTileHandler:()=>k(()=>import("./WorkerTileHandler-Dt0ZK55H.js"),__vite__mapDeps([122,123,89,90,124,125,71,95,126,127,60,96,87])),Lyr3DWorker:()=>k(()=>import("./Lyr3DWorker-CjrFZ1QG.js"),[]),Feature3DPipelineWorker:()=>k(()=>import("./Feature3DPipelineWorker-Be3E7Zj-.js"),__vite__mapDeps([128,44,24,25,26,27,45,40,41,29,46,31,32,33,47,39,43,72,70,71,58,129,59,60,52,53,54,55,130,131,118,132,133,92,134,135,136,112,137,84,138,139,103,140,141,117,142,143,116,144,65,63,145]))},Gte="worker:port-closed";var pn;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(pn||(pn={}));let sIe=0;function zte(){return sIe++}function oIe(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function l$(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function d4(t,e,i,r){if(e.type===pn.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==pn.INVOKE&&e.type!==pn.RESPONSE)return void t.postMessage(e);let n;if(oIe(i)?(n=JB(i.transferList),e.data=i.result):(n=JB(r),e.data=i),n){if(G("ff")){for(const s of n)if("byteLength"in s&&s.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case pn.INVOKE:throw o;case pn.RESPONSE:return void d4(t,{type:pn.RESPONSE,jobId:e.jobId,error:l$(o)})}}}t.postMessage(e,n)}else t.postMessage(e)}function u$(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function JB(t){if(!(t!=null&&t.length))return null;if(G("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(i=>!aIe(i));return e.length?e:null}function aIe(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}async function IQe(t){try{return await t}catch(e){const i=(e==null?void 0:e.name)===Gte;if(!(rr(e)||i))throw e;return}}const{CLOSE:YB,ABORT:KB,INVOKE:XB,RESPONSE:q_,OPEN_PORT:QB,ON:lIe}=pn,uIe=2;let cIe=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===pn.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},bm=class Av{static connect(e,i){const r=new MessageChannel;let n;n=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const s=new Av(r.port1,{channel:r,client:n,schedule:i});return typeof n=="object"&&"remoteClient"in n&&(n.remoteClient=s),Av.clients.set(s,n),r.port2}static loadWorker(e){const i=nIe[e];return i?i():Promise.resolve(null)}constructor(e,i,r){this._port=e,this._jobQueue=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new cIe(n=>this._onInvokeMessage(n)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:YB}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,i,r){return this.apply(e,[i],r)}apply(e,i,r){const n=r==null?void 0:r.signal,s=r==null?void 0:r.transferList;if(!this._port)return Promise.reject(new L(Gte,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:i}));const o=zte();return new Promise((a,u)=>{if(lo(n))return this._processWork(),void u(mt());const d=ks(n,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),Kt(h.abortHandle),this._post({type:KB,jobId:o}),u(mt()))}),p={resolve:a,reject:u,abortHandle:d,debugInfo:e};this._outJobs.set(o,p),this._post({type:XB,jobId:o,methodName:e,abortable:n!=null},i,s)})}createInvokeProxy(e){return jte(this,e)}on(e,i){const r=new MessageChannel;function n(s){i(s.data)}return this._port.postMessage({type:pn.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),ye(()=>{r.port1.postMessage({type:pn.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:QB,port:e.port2}),e.port1}_processWork(){var o;if(this._outJobs.size>=uIe)return;const e=(o=this._jobQueue)==null?void 0:o.pop();if(!e)return;const{methodName:i,data:r,invokeOptions:n,resolver:s}=e;this.apply(i,r,n).then(a=>s.resolve(a)).catch(a=>s.reject(a))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{Kt(e.abortHandle),e.reject(mt(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,i){const r=u$(e);if(r)switch(r.type){case q_:this._onResponseMessage(r);break;case XB:i?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case KB:this._onAbortMessage(r);break;case YB:this._onCloseMessage();break;case QB:this._onOpenPortMessage(r);break;case lIe:this._onOnMessage(r)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),i.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&Av.clients.get(this)===e&&e.destroy(),Av.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n=[],abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let u,d=this._client,p=d[i];try{if(!p&&i&&i.includes(".")){const h=i.split(".");for(let m=0;m<h.length-1;m++)d=d[h[m]],p=d[h[m+1]]}if(typeof p!="function")throw new TypeError(`${i} is not a function`);n.push({client:this,signal:o?o.signal:null}),u=p.apply(d,n)}catch(h){return void this._post({type:q_,jobId:r,error:l$(h)})}kc(u)?(a.set(r,{controller:o,promise:u}),u.then(h=>{a.has(r)&&(a.delete(r),this._post({type:q_,jobId:r},h))},h=>{a.has(r)&&(a.delete(r),rr(h)||this._post({type:q_,jobId:r,error:l$(h||{message:`Error encountered at method ${i}`})}))})):this._post({type:q_,jobId:r},u)}_onOpenPortMessage(e){new Av(e.port,{client:this._client})}_onOnMessage(e){const{port:i}=e,r=this._client.on(e.eventType,s=>{i.postMessage(s)}),n=O$(e.port,"message",s=>{const o=u$(s);(o==null?void 0:o.type)===pn.CLOSE&&(n.remove(),r.remove(),i.close())})}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,s=this._outJobs;if(!s.has(i))return;const o=s.get(i);s.delete(i),this._processWork(),Kt(o.abortHandle),r?o.reject(L.fromJSON(JSON.parse(r))):o.resolve(n)}_post(e,i,r){return d4(this._port,e,i,r)}};bm.kernelInfo={buildDate:TC,fullVersion:_V,revision:vZ},bm.clients=new Map;let dIe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Nb}destroy(){this.close()}get closed(){var e;return!((e=this._clients)!=null&&e.length)}open(e,i){return new Promise((r,n)=>{let s=!0;const o=a=>{qe(i.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const u=e[a];kc(u)?this._clientPromises[a]=u.then(d=>(this._clients[a]=new bm(d,i,this._ongoingJobsQueue),o(r),this._clients[a]),()=>(o(n),null)):(this._clients[a]=new bm(u,i,this._ongoingJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}})}broadcast(e,i,r){const n=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];n[s]=o.then(a=>a==null?void 0:a.invoke(e,i,r))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(mt(`Worker closing, aborting job calling '${e.methodName}'`));for(const i of this._clientPromises)i.then(r=>r==null?void 0:r.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,iIe(this)}invoke(e,i,r){return this.apply(e,[i],r)}apply(e,i,r){const n=fn();this._ongoingJobsQueue.push({methodName:e,data:i,invokeOptions:r,resolver:n});for(let s=0;s<this._clientPromises.length;s++){const o=this._clients[s];o?o.jobAdded():this._clientPromises[s].then(a=>a==null?void 0:a.jobAdded())}return n.promise}createInvokeProxy(e){return jte(this,e)}on(e,i){return Promise.all(this._clientPromises).then(()=>kr(this._clients.map(r=>r.on(e,i))))}openPorts(){return new Promise(e=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(s=>{s&&(i[n]=s.openPort()),--r==0&&e(i)})})}get test(){}};const pIe={async request(t,e){var o,a;const i=t.options,r=i.responseType;i.signal=e==null?void 0:e.signal,i.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&((o=eR(t.url))!=null&&o.after)?r:"array-buffer";const n=await Ee(t.url,i),s={data:n.data,httpStatus:n.httpStatus,ssl:n.ssl};switch((a=n.requestOptions)==null?void 0:a.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=new TextEncoder().encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=new TextEncoder().encode(s.data).buffer}return{result:s,transferList:[s.data]}}},e8={};function hIe(t){var i;const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:((i=t.packages)==null?void 0:i.slice())||[],paths:{...e8.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=e8.baseUrl),e}let mIe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...r)=>e[i](...r)})}},jx=class{constructor(){this._dispatcher=new mIe,this._workerPostMessage({type:pn.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){fb(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,i,r){this._dispatcher.addEventListener(e,i,r)}removeEventListener(e,i,r){this._dispatcher.removeEventListener(e,i,r)}_workerPostMessage(e){fb(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const i=u$(e);if(i&&i.type===pn.OPEN){const{modulePath:r,jobId:n}=i;let s=await bm.loadWorker(r);s||(s=await import(r));const o=bm.connect(s);this._workerPostMessage({type:pn.OPENED,jobId:n,data:o})}}};const EF=()=>U.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:fIe}=pn,yIe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let ET,TT;const t8="Failed to create Worker. Fallback to execute module in main thread";async function gIe(){if(!G("esri-workers"))return i8(new jx);if(!ET&&!TT)try{const e=yIe.split("{CONFIGURATION}").join(vIe());ET=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){TT=e||{}}let t;if(ET)try{t=new Worker(ET,{name:"esri-worker-"+bIe++})}catch{EF().warn(t8,TT),t=new jx}else EF().warn(t8,TT),t=new jx;return i8(t)}async function i8(t){return new Promise(e=>{function i(n){const s=u$(n);s&&s.type===fIe&&(t.removeEventListener("message",i),t.removeEventListener("error",r),e(t))}function r(n){n.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",r),EF().warn("Failed to create Worker. Fallback to execute module in main thread",n),(t=new jx).addEventListener("message",i),t.addEventListener("error",r)}t.addEventListener("message",i),t.addEventListener("error",r)})}function vIe(){let t;if(et.default!=null){const n={...et};delete n.default,t=JSON.parse(JSON.stringify(n))}else t=JSON.parse(JSON.stringify(et));t.assetsPath=ro(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?ro(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=An(),t.has={"esri-csp-restrictions":G("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":G("esri-2d-update-debug"),"esri-2d-log-updating":G("esri-2d-log-updating"),"featurelayer-pbf":G("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":G("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":G("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":G("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":G("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":G("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":G("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":G("featurelayer-snapshot-enabled"),"esri-atomics":G("esri-atomics"),"esri-shared-array-buffer":G("esri-shared-array-buffer"),"esri-tiles-debug":G("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":G("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":G("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=ro(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=ro(t.workers.workerPath):t.workers.workerPath=ro(ut("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=et.workers.loaderConfig,i=hIe({baseUrl:e==null?void 0:e.baseUrl,locale:An(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{buildDate:TC,fullVersion:_V,revision:vZ}})}let bIe=0;const{ABORT:r8,INVOKE:_Ie,OPEN:wIe,OPENED:SIe,RESPONSE:W_}=pn;let $Ie=class Bte{static async create(e){const i=await gIe();return new Bte(i,e)}constructor(e,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=i,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),U.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,i={}){const{signal:r}=i,n=zte();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:nV(r,()=>{this._outJobs.delete(n),this._post({type:r8,jobId:n})})};this._outJobs.set(n,a),this._post({type:wIe,jobId:n,modulePath:e})})}_onMessage(e){const i=u$(e);if(i)switch(i.type){case SIe:this._onOpenedMessage(i);break;case W_:this._onResponseMessage(i);break;case r8:this._onAbortMessage(i);break;case _Ie:this._onInvokeMessage(i)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);n&&(n.controller&&n.controller.abort(),i.delete(r))}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,u=pIe[i];let d;try{if(typeof u!="function")throw new TypeError(`${i} is not a function`);d=u.call(null,n,{signal:o?o.signal:null})}catch(p){return void this._post({type:W_,jobId:r,error:l$(p)})}kc(d)?(a.set(r,{controller:o,promise:d}),d.then(p=>{a.has(r)&&(a.delete(r),this._post({type:W_,jobId:r},p))},p=>{a.has(r)&&(a.delete(r),p||(p={message:"Error encountered at method"+i}),rr(p)||this._post({type:W_,jobId:r,error:l$(p||{message:`Error encountered at method ${i}`})}))})):this._post({type:W_,jobId:r},d)}_onOpenedMessage(e){const{jobId:i,data:r}=e,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),Kt(n.abortHandle),n.resolve(r))}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,s=this._outJobs.get(i);s&&(this._outJobs.delete(i),Kt(s.abortHandle),r?s.reject(L.fromJSON(JSON.parse(r))):s.resolve(n))}_post(e,i,r){return d4(this.worker,e,i,r)}};const n8=G("host-browser")?Math.min(navigator.hardwareConcurrency-1,G("workers-pool-size")??8):0;let yy=G("esri-mobile")?Math.min(n8,3):n8;yy||(yy=G("safari")&&G("mac")?7:2);let s8=0;const Gx=[];function EIe(){Hte()}async function IT(t,e){const i=new dIe,{registryTarget:r,...n}=e;return await i.open(t,n),r&&tIe(r,i),i}async function TIe(t,e={}){if(typeof t!="string")throw new L("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(G("host-webworker")&&!G("esri-workers")&&(i="local"),i==="local"){let r=await bm.loadWorker(t);r||(r=await import(t)),qe(e.signal);const n=e.client||r;return IT([bm.connect(r,e.schedule)],{...e,client:n})}if(await Hte(),qe(e.signal),i==="dedicated"){const r=s8++%yy;return IT([await Gx[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,yy);if(r<yy){const n=new Array(r);for(let s=0;s<r;++s){const o=s8++%yy;n[s]=Gx[o].open(t,e)}return IT(n,e)}}return IT(Gx.map(r=>r.open(t,e)),e)}let xT=null;async function Hte(){if(xT)return xT;new AbortController;const t=[];for(let e=0;e<yy;e++){const i=$Ie.create(e).then(r=>(Gx[e]=r,r));t.push(i)}return xT=Promise.all(t),xT}function o8(t,e,i){if(t.hasM==null||t.hasZ)for(const r of e)for(const n of r)n.length>2&&(n[2]*=i)}function IIe(t,e,i){if(!t&&!e||!i)return;const r=fu(i);a8(t,i,r),a8(e,i,r)}function a8(t,e,i){if(t)for(const r of t)xIe(r.geometry,e,i)}function xIe(t,e,i){if(!(t!=null&&t.spatialReference)||ci(t.spatialReference,e))return;const r=fu(t.spatialReference)/i;if(r!==1){if("x"in t)t.z!=null&&(t.z*=r);else if("rings"in t)o8(t,t.rings,r);else if("paths"in t)o8(t,t.paths,r);else if("points"in t&&(t.hasM==null||t.hasZ))for(const n of t.points)n.length>2&&(n[2]*=r)}}function l8(t,e,i){if(!(i!=null&&i.features)||!i.hasZ)return;const r=zX(i.geometryType,e,t.outSpatialReference);if(r!=null)for(const n of i.features)r(n.geometry)}var TF;const MIe=new $e({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let zn=TF=class extends j{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return(i==null?void 0:i.value)??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return i?MIe.fromJSON(i.fieldValueType):null}clone(){var t;return new TF({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((t=this.domain)==null?void 0:t.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};l([c({type:String,json:{write:!0}})],zn.prototype,"alias",void 0),l([c({type:[String,Number],json:{write:{allowNull:!0}}})],zn.prototype,"defaultValue",void 0),l([c()],zn.prototype,"description",void 0),l([X("description")],zn.prototype,"readDescription",null),l([c({types:Lte,json:{read:{reader:Tk},write:!0}})],zn.prototype,"domain",void 0),l([c({type:Boolean,json:{write:!0}})],zn.prototype,"editable",void 0),l([c({type:Xe,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],zn.prototype,"length",void 0),l([c({type:String,json:{write:!0}})],zn.prototype,"name",void 0),l([c({type:Boolean,json:{write:!0}})],zn.prototype,"nullable",void 0),l([oe(g5)],zn.prototype,"type",void 0),l([c()],zn.prototype,"valueType",void 0),l([X("valueType",["description"])],zn.prototype,"readValueType",null),l([c({type:Boolean,json:{read:!1}})],zn.prototype,"visible",void 0),zn=TF=l([$("esri.layers.support.Field")],zn);const Ik=zn;var IF;const xF=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let sn=IF=class extends j{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){var n;const i=le.fromJSON(e.spatialReference),r=[];for(let s=0;s<t.length;s++){const o=t[s],a=Li.fromJSON(o),u=(n=o.geometry)==null?void 0:n.spatialReference;a.geometry==null||u||(a.geometry.spatialReference=i);const d=o.aggregateGeometries,p=a.aggregateGeometries;if(d&&p!=null)for(const h in p){const m=p[h],y=d[h],g=y==null?void 0:y.spatialReference;m==null||g||(m.spatialReference=i)}r.push(a)}return r}writeGeometryType(t,e,i,r){if(t)return void xF.write(t,e,i,r);const{features:n}=this;if(n){for(const s of n)if((s==null?void 0:s.geometry)!=null)return void xF.write(s.geometry.type,e,i,r)}}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,r=dp(t);return r&&!i&&e.spatialReference&&(r.spatialReference=le.fromJSON(e.spatialReference)),r}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i){for(const r of i)if(r&&r.geometry!=null&&r.geometry.spatialReference)return void(e.spatialReference=r.geometry.spatialReference.toJSON())}}clone(){return new IF(this.cloneProperties())}cloneProperties(){return R({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const r=e.features[i];if(r.geometry){const n=t==null?void 0:t[i];r.geometry=(n==null?void 0:n.toJSON())||r.geometry}}return e}quantize(t){const{scale:[e,i],translate:[r,n]}=t,s=d=>Math.round((d-r)/e),o=d=>Math.round((n-d)/i),a=this.features,u=this._getQuantizationFunction(this.geometryType,s,o);for(let d=0,p=a.length;d<p;d++)u!=null&&u(a[d].geometry)||(a.splice(d,1),d--,p--);return this.transform=t,this}unquantize(){var m,y;const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[r,n],scale:[s,o]}=i,a=g=>g*s+r,u=g=>n-g*o;let d=null,p=null;if(this.hasZ&&((m=i==null?void 0:i.scale)==null?void 0:m[2])!=null){const{translate:[,,g],scale:[,,v]}=i;d=_=>_*v+g}if(this.hasM&&((y=i==null?void 0:i.scale)==null?void 0:y[3])!=null){const{translate:[,,,g],scale:[,,,v]}=i;p=_=>_==null?_:_*v+g}const h=this._getHydrationFunction(t,a,u,d,p);for(const{geometry:g}of e)g!=null&&h&&h(g);return this.transform=null,this}_quantizePoints(t,e,i){let r,n;const s=[];for(let o=0,a=t.length;o<a;o++){const u=t[o];if(o>0){const d=e(u[0]),p=i(u[1]);d===r&&p===n||(s.push([d-r,p-n]),r=d,n=p)}else r=e(u[0]),n=i(u[1]),s.push([r,n])}return s.length>0?s:null}_getQuantizationFunction(t,e,i){return t==="point"?r=>(r.x=e(r.x),r.y=i(r.y),r):t==="polyline"||t==="polygon"?r=>{const n=Sy(r)?r.rings:r.paths,s=[];for(let o=0,a=n.length;o<a;o++){const u=n[o],d=this._quantizePoints(u,e,i);d&&s.push(d)}return s.length>0?(Sy(r)?r.rings=s:r.paths=s,r):null}:t==="multipoint"?r=>{const n=this._quantizePoints(r.points,e,i);return n&&n.length>0?(r.points=n,r):null}:t==="extent"?r=>r:null}_getHydrationFunction(t,e,i,r,n){return t==="point"?s=>{s.x=e(s.x),s.y=i(s.y),r&&(s.z=r(s.z))}:t==="polyline"||t==="polygon"?s=>{const o=Sy(s)?s.rings:s.paths;let a,u;for(let d=0,p=o.length;d<p;d++){const h=o[d];for(let m=0,y=h.length;m<y;m++){const g=h[m];m>0?(a+=g[0],u+=g[1]):(a=g[0],u=g[1]),g[0]=e(a),g[1]=i(u)}}if(r&&n)for(let d=0,p=o.length;d<p;d++){const h=o[d];for(let m=0,y=h.length;m<y;m++){const g=h[m];g[2]=r(g[2]),g[3]=n(g[3])}}else if(r)for(let d=0,p=o.length;d<p;d++){const h=o[d];for(let m=0,y=h.length;m<y;m++){const g=h[m];g[2]=r(g[2])}}else if(n)for(let d=0,p=o.length;d<p;d++){const h=o[d];for(let m=0,y=h.length;m<y;m++){const g=h[m];g[2]=n(g[2])}}}:t==="extent"?s=>{s.xmin=e(s.xmin),s.ymin=i(s.ymin),s.xmax=e(s.xmax),s.ymax=i(s.ymax),r&&s.zmax!=null&&s.zmin!=null&&(s.zmax=r(s.zmax),s.zmin=r(s.zmin)),n&&s.mmax!=null&&s.mmin!=null&&(s.mmax=n(s.mmax),s.mmin=n(s.mmin))}:t==="multipoint"?s=>{const o=s.points;let a,u;for(let d=0,p=o.length;d<p;d++){const h=o[d];d>0?(a+=h[0],u+=h[1]):(a=h[0],u=h[1]),h[0]=e(a),h[1]=i(u)}if(r&&n)for(let d=0,p=o.length;d<p;d++){const h=o[d];h[2]=r(h[2]),h[3]=n(h[3])}else if(r)for(let d=0,p=o.length;d<p;d++){const h=o[d];h[2]=r(h[2])}else if(n)for(let d=0,p=o.length;d<p;d++){const h=o[d];h[2]=n(h[2])}}:null}};l([c({type:String,json:{write:!0}})],sn.prototype,"displayFieldName",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],sn.prototype,"exceededTransferLimit",void 0),l([c({type:[Li],json:{write:!0}})],sn.prototype,"features",void 0),l([X("features")],sn.prototype,"readFeatures",null),l([c({type:[Ik],json:{write:!0}})],sn.prototype,"fields",void 0),l([c({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:xF.read}}})],sn.prototype,"geometryType",void 0),l([te("geometryType")],sn.prototype,"writeGeometryType",null),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],sn.prototype,"hasM",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],sn.prototype,"hasZ",void 0),l([c({types:rg,json:{write:!0}})],sn.prototype,"queryGeometry",void 0),l([X("queryGeometry")],sn.prototype,"readQueryGeometry",null),l([c({type:le,json:{write:!0}})],sn.prototype,"spatialReference",void 0),l([te("spatialReference")],sn.prototype,"writeSpatialReference",null),l([c({json:{write:!0}})],sn.prototype,"transform",void 0),sn=IF=l([$("esri.rest.support.FeatureSet")],sn),sn.prototype.toJSON.isDefaultToJSON=!0;const Db=sn;let CIe=0,Fd=class extends uo.LoadableMixin(l_(Y)){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var i;const e=(i=this.layer)==null?void 0:i.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,i={}){await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);l8(e,this.layer.spatialReference,r);const n=Db.fromJSON(r);if(!this._requiresClientGraphicMapping())return n;const s=this.layer.objectIdField;for(const o of n.features){const a=o.attributes[s],u=this._idToClientGraphic.get(a);u&&(o.geometry=u.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(e,i={}){if(this._requiresClientGraphicMapping())throw new L("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);return l8(e,this.layer.spatialReference,r),r}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(r=>({count:r.count,extent:at.fromJSON(r.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}async _applyEdits(e){if(!this._connection)throw new L("feature-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField;let r=null;const n=[],s=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=p=>"objectId"in p&&p.objectId!=null?p.objectId:"attributes"in p&&p.attributes[i]!=null?p.attributes[i]:null;if(e.addFeatures&&(r=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const p of e.deleteFeatures){const h=o(p);h!=null&&n.push(h)}const a=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const p of e.updateFeatures)if(s.push(this._serializeFeature(p)),a){const h=o(p);h!=null&&a.set(h,p)}}IIe(r?r.features:null,s,this.layer.spatialReference);const{fullExtent:u,featureEditResults:d}=await this._connection.invoke("applyEdits",{adds:r?r.features:[],updates:s,deletes:n});return this.fullExtent=u,r&&r.finish(d.uidToObjectId),this._updateClientGraphicIds(a,d),this._createEditsResult(d)}async _prepareClientMapping(e,i){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const r=[];for(const{geometry:n}of e)n==null||n.type!=="mesh"||n.hasExtent||n.loaded||r.push(n.load({signal:i}));r.length&&await Promise.all(r)}_updateClientGraphicIds(e,i){if(this._idToClientGraphic){if(e)for(const r of i.updateResults){if(!r.success)continue;const n=e.get(r.objectId);n!=null&&this._addIdToClientGraphic(n)}for(const r of i.deleteResults)r.success&&this._idToClientGraphic.delete(r.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new L("feature-layer-source:edit-failure",i.description,{code:i.code}):null}}_prepareAddFeatures(e){const i=new Map,r=new Array(e.length);let n=null;for(let o=0;o<e.length;o++){const a=e[o],u=this._serializeFeature(a);n||a.geometry==null||(n=a.geometry.type),r[o]=u,i.set(`${u.uid}`,a)}const s=this;return{features:r,inferredGeometryType:n,finish(o){const a=s.sourceJSON.objectIdField;for(const u in o){const d=o[u],p=i.get(u);p&&(p.attributes||(p.attributes={}),d===-1?delete p.attributes[a]:p.attributes[a]=d,s._addIdToClientGraphic(p))}}}}_addIdToClientGraphic(e){var n;if(!this._idToClientGraphic)return;const i=this.sourceJSON.objectIdField,r=(n=e.attributes)==null?void 0:n[i];r!=null&&this._idToClientGraphic.set(r,e)}get _layerOrSourceGeometryType(){var e,i;return((e=this.layer)==null?void 0:e.geometryType)??((i=this.sourceJSON)==null?void 0:i.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:i}=e,r=this._geometryForSerialization(e),n=(CIe++).toString();return r?{uid:n,geometry:r.toJSON(),attributes:i}:{uid:n,attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:this._geometryRequiresClientGraphicMapping(i)?i.extent?os.fromExtent(i.extent):null:i}async _startWorker(e){this._connection=await TIe("MemorySourceWorker",{strategy:G("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:i,spatialReference:r,objectIdField:n,hasM:s,hasZ:o,timeInfo:a,dateFieldsTimeZone:u}=this.layer,d=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const p=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",g=>{U.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()}));const h={features:p.features,fields:i==null?void 0:i.map(g=>g.toJSON()),geometryType:WG.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&s,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:n,spatialReference:d?null:r&&r.toJSON(),timeInfo:(a==null?void 0:a.toJSON())??null,dateFieldsTimeZone:u},m=await this._connection.invoke("load",h,{signal:e});for(const g of m.warnings)U.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&U.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const y=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(p.inferredGeometryType)&&(y.geometryType=WG.toJSON(p.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),p.finish(m.assignedObjectIds)}};l([SV({Type:Li,ensureType:pi(Li)})],Fd.prototype,"itemType",void 0),l([c()],Fd.prototype,"type",void 0),l([c({constructOnly:!0})],Fd.prototype,"layer",void 0),l([c({readOnly:!0})],Fd.prototype,"_workerGeometryType",null),l([c()],Fd.prototype,"sourceJSON",void 0),Fd=l([$("esri.layers.graphics.sources.MemorySource")],Fd);function kIe(t){return"portalItem"in t}const LIe=t=>{let e=class extends t{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):kIe(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return l([c({type:String})],e.prototype,"apiKey",null),e=l([$("esri.layers.mixins.APIKeyMixin")],e),e},qte={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Wte=Object.values(qte),Zte=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Wte.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),AIe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Wte.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),OIe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function AQe(t){return Zte.test(t)}function du(t){if(t==null)return null;const e=nr(t),i=(e==null?void 0:e.path.match(Zte))||(e==null?void 0:e.path.match(AIe));if(!i)return null;const[,r,n,s,o]=i,a=n.indexOf("/");return{title:p4(a!==-1?n.slice(a+1):n),serverType:qte[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function RIe(t){const e=nr(t).path.match(OIe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function p4(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function PIe(t,e){const i=[];if(t){const r=du(t);r!=null&&r.title&&i.push(r.title)}if(e){const r=p4(e);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function Jte(t){let e=Ja(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function FIe(t,e){return t&&TJ(IJ(t,e))}function NIe(t){let{url:e}=t;if(!e)return{url:e};e=IJ(e,t.logger);const i=nr(e),r=du(i.path);let n;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(n=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const s=RIe(i.path);s!=null&&(e=s.serviceUrl,n=s.sublayerId)}return{url:TJ(e),layerId:n}}function DIe(t,e,i,r,n){Vy(e,r,"url",n),r.url&&t.layerId!=null&&(r.url=gb(r.url,i,t.layerId.toString()))}function OQe(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return i&&(r||n||s)}function RQe(t){var r;if(!t)return!1;const e=new nm(ro(t)),i=(r=e.authority)==null?void 0:r.toLowerCase();return i==="server.arcgisonline.com"||i==="services.arcgisonline.com"}const VIe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=du(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",FIe(i,U.getLogger(this)))}};return l([c()],e.prototype,"title",null),l([c({type:String})],e.prototype,"url",null),e=l([$("esri.layers.mixins.ArcGISService")],e),e};function UIe(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}function K0(t,e,i,r){var n=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(n,K0.prototype),n.expected=e,n.found=i,n.location=r,n.name="SyntaxError",n}function aA(t,e,i){return i=i||" ",t.length>e?t:(e-=t.length,t+(i+=i.repeat(e)).slice(0,e))}function jIe(t,e){var i,r={},n=(e=e!==void 0?e:{}).grammarSource,s={start:Aj},o=Aj,a="none",u=")",d=",",p="(",h="%",m="px",y="cm",g="mm",v="in",_="pt",w="pc",S="deg",E="rad",T="grad",M="turn",x="#",C=".",O="e",F=/^[ \t\n\r]/,V=/^[a-z\-]/,z=/^[0-9a-fA-F]/,H=/^[+\-]/,Q=/^[0-9]/,J=Dc("none"),ne=Qr("none",!1),Pe=Qr(")",!1),_e=Qr(",",!1),ue=Dc("whitespace"),it=P_([" ","	",`
`,"\r"],!1,!1),Xr=Dc("function"),us=Qr("(",!1),ho=Dc("identifier"),nl=P_([["a","z"],"-"],!1,!1),Fn=Dc("percentage"),mo=Qr("%",!1),cs=Dc("length"),Fc=Qr("px",!1),sl=Qr("cm",!1),ds=Qr("mm",!1),_u=Qr("in",!1),Nc=Qr("pt",!1),PE=Qr("pc",!1),FE=Dc("angle"),NE=Qr("deg",!1),DE=Qr("rad",!1),VE=Qr("grad",!1),UE=Qr("turn",!1),jE=Dc("number"),GE=Dc("color"),zE=Qr("#",!1),O_=P_([["0","9"],["a","f"],["A","F"]],!1,!1),R_=P_(["+","-"],!1,!1),ol=P_([["0","9"]],!1,!1),BE=Qr(".",!1),HE=Qr("e",!1),qE=function(){return[]},Ps=function(A,Z){return{type:"function",name:A,parameters:Z||[]}},wu=function(A,Z){return Z.length>0?_de(A,Z,3):[A]},pL=function(A){return{type:"quantity",value:A.value,unit:A.unit}},zce=function(A){return{type:"color",colorType:A.type,value:A.value}},Bce=function(A){return A},Hce=function(){return ZE()},qce=function(A){return{value:A,unit:"%"}},Wce=function(A){return{value:A,unit:"px"}},Zce=function(A){return{value:A,unit:"cm"}},Jce=function(A){return{value:A,unit:"mm"}},Yce=function(A){return{value:A,unit:"in"}},Kce=function(A){return{value:A,unit:"pt"}},Xce=function(A){return{value:A,unit:"pc"}},Qce=function(A){return{value:A,unit:"deg"}},ede=function(A){return{value:A,unit:"rad"}},tde=function(A){return{value:A,unit:"grad"}},ide=function(A){return{value:A,unit:"turn"}},rde=function(A){return{value:A,unit:null}},nde=function(){return{type:"hex",value:ZE()}},sde=function(A){return{type:"function",value:A}},ode=function(){return{type:"named",value:ZE()}},ade=function(){return parseFloat(ZE())},B=0|e.peg$currPos,Ai=B,vg=[{line:1,column:1}],al=B,WE=e.peg$maxFailExpected||[],ge=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');o=s[e.startRule]}function ZE(){return t.substring(Ai,B)}function Qr(A,Z){return{type:"literal",text:A,ignoreCase:Z}}function P_(A,Z,ie){return{type:"class",parts:A,inverted:Z,ignoreCase:ie}}function lde(){return{type:"end"}}function Dc(A){return{type:"other",description:A}}function kj(A){var Z,ie=vg[A];if(ie)return ie;if(A>=vg.length)Z=vg.length-1;else for(Z=A;!vg[--Z];);for(ie={line:(ie=vg[Z]).line,column:ie.column};Z<A;)t.charCodeAt(Z)===10?(ie.line++,ie.column=1):ie.column++,Z++;return vg[A]=ie,ie}function Lj(A,Z,ie){var Ae=kj(A),oi=kj(Z);return{source:n,start:{offset:A,line:Ae.line,column:Ae.column},end:{offset:Z,line:oi.line,column:oi.column}}}function ze(A){B<al||(B>al&&(al=B,WE=[]),WE.push(A))}function ude(A,Z,ie){return new K0(K0.buildMessage(A,Z),A,Z,ie)}function Aj(){var A;return(A=cde())===r&&(A=dde()),A}function cde(){var A,Z;return ge++,A=B,en(),t.substr(B,4)===a?(Z=a,B+=4):(Z=r,ge===0&&ze(ne)),Z!==r?(en(),Ai=A,A=qE()):(B=A,A=r),ge--,A===r&&ge===0&&ze(J),A}function dde(){var A,Z;if(A=[],(Z=hL())!==r)for(;Z!==r;)A.push(Z),Z=hL();else A=r;return A}function hL(){var A,Z,ie,Ae;return A=B,en(),(Z=hde())!==r?(en(),(ie=pde())===r&&(ie=null),en(),t.charCodeAt(B)===41?(Ae=u,B++):(Ae=r,ge===0&&ze(Pe)),Ae!==r?(en(),Ai=A,A=Ps(Z,ie)):(B=A,A=r)):(B=A,A=r),A}function pde(){var A,Z,ie,Ae,oi,Ji,Fr,Fs;if(A=B,(Z=mL())!==r){for(ie=[],Ae=B,oi=en(),t.charCodeAt(B)===44?(Ji=d,B++):(Ji=r,ge===0&&ze(_e)),Ji===r&&(Ji=null),Fr=en(),(Fs=mL())!==r?Ae=oi=[oi,Ji,Fr,Fs]:(B=Ae,Ae=r);Ae!==r;)ie.push(Ae),Ae=B,oi=en(),t.charCodeAt(B)===44?(Ji=d,B++):(Ji=r,ge===0&&ze(_e)),Ji===r&&(Ji=null),Fr=en(),(Fs=mL())!==r?Ae=oi=[oi,Ji,Fr,Fs]:(B=Ae,Ae=r);Ai=A,A=wu(Z,ie)}else B=A,A=r;return A}function mL(){var A,Z;return A=B,(Z=mde())===r&&(Z=fde())===r&&(Z=yde())===r&&(Z=gde()),Z!==r&&(Ai=A,Z=pL(Z)),(A=Z)===r&&(A=B,(Z=vde())!==r&&(Ai=A,Z=zce(Z)),A=Z),A}function en(){var A,Z;for(ge++,A=[],Z=t.charAt(B),F.test(Z)?B++:(Z=r,ge===0&&ze(it));Z!==r;)A.push(Z),Z=t.charAt(B),F.test(Z)?B++:(Z=r,ge===0&&ze(it));return ge--,Z=r,ge===0&&ze(ue),A}function hde(){var A,Z,ie;return ge++,A=B,(Z=Oj())!==r?(t.charCodeAt(B)===40?(ie=p,B++):(ie=r,ge===0&&ze(us)),ie!==r?(Ai=A,A=Bce(Z)):(B=A,A=r)):(B=A,A=r),ge--,A===r&&(Z=r,ge===0&&ze(Xr)),A}function Oj(){var A,Z,ie;if(ge++,A=B,Z=[],ie=t.charAt(B),V.test(ie)?B++:(ie=r,ge===0&&ze(nl)),ie!==r)for(;ie!==r;)Z.push(ie),ie=t.charAt(B),V.test(ie)?B++:(ie=r,ge===0&&ze(nl));else Z=r;return Z!==r&&(Ai=A,Z=Hce()),ge--,(A=Z)===r&&(Z=r,ge===0&&ze(ho)),A}function mde(){var A,Z,ie;return ge++,A=B,en(),(Z=ea())!==r?(t.charCodeAt(B)===37?(ie=h,B++):(ie=r,ge===0&&ze(mo)),ie!==r?(Ai=A,A=qce(Z)):(B=A,A=r)):(B=A,A=r),ge--,A===r&&ge===0&&ze(Fn),A}function fde(){var A,Z,ie;return ge++,A=B,en(),(Z=ea())!==r?(t.substr(B,2)===m?(ie=m,B+=2):(ie=r,ge===0&&ze(Fc)),ie!==r?(Ai=A,A=Wce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,en(),(Z=ea())!==r?(t.substr(B,2)===y?(ie=y,B+=2):(ie=r,ge===0&&ze(sl)),ie!==r?(Ai=A,A=Zce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,en(),(Z=ea())!==r?(t.substr(B,2)===g?(ie=g,B+=2):(ie=r,ge===0&&ze(ds)),ie!==r?(Ai=A,A=Jce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,en(),(Z=ea())!==r?(t.substr(B,2)===v?(ie=v,B+=2):(ie=r,ge===0&&ze(_u)),ie!==r?(Ai=A,A=Yce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,en(),(Z=ea())!==r?(t.substr(B,2)===_?(ie=_,B+=2):(ie=r,ge===0&&ze(Nc)),ie!==r?(Ai=A,A=Kce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,en(),(Z=ea())!==r?(t.substr(B,2)===w?(ie=w,B+=2):(ie=r,ge===0&&ze(PE)),ie!==r?(Ai=A,A=Xce(Z)):(B=A,A=r)):(B=A,A=r)))))),ge--,A===r&&ge===0&&ze(cs),A}function yde(){var A,Z,ie;return ge++,A=B,(Z=ea())!==r?(t.substr(B,3)===S?(ie=S,B+=3):(ie=r,ge===0&&ze(NE)),ie!==r?(Ai=A,A=Qce(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,(Z=ea())!==r?(t.substr(B,3)===E?(ie=E,B+=3):(ie=r,ge===0&&ze(DE)),ie!==r?(Ai=A,A=ede(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,(Z=ea())!==r?(t.substr(B,4)===T?(ie=T,B+=4):(ie=r,ge===0&&ze(VE)),ie!==r?(Ai=A,A=tde(Z)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,(Z=ea())!==r?(t.substr(B,4)===M?(ie=M,B+=4):(ie=r,ge===0&&ze(UE)),ie!==r?(Ai=A,A=ide(Z)):(B=A,A=r)):(B=A,A=r)))),ge--,A===r&&(Z=r,ge===0&&ze(FE)),A}function gde(){var A,Z;return ge++,A=B,en(),(Z=ea())!==r?(Ai=A,A=rde(Z)):(B=A,A=r),ge--,A===r&&ge===0&&ze(jE),A}function vde(){var A,Z,ie,Ae;if(ge++,A=B,t.charCodeAt(B)===35?(Z=x,B++):(Z=r,ge===0&&ze(zE)),Z!==r){if(ie=[],Ae=t.charAt(B),z.test(Ae)?B++:(Ae=r,ge===0&&ze(O_)),Ae!==r)for(;Ae!==r;)ie.push(Ae),Ae=t.charAt(B),z.test(Ae)?B++:(Ae=r,ge===0&&ze(O_));else ie=r;ie!==r?(Ai=A,A=nde()):(B=A,A=r)}else B=A,A=r;return A===r&&(A=B,(Z=hL())!==r&&(Ai=A,Z=sde(Z)),(A=Z)===r&&(A=B,(Z=Oj())!==r&&(Ai=A,Z=ode()),A=Z)),ge--,A===r&&(Z=r,ge===0&&ze(GE)),A}function ea(){var A,Z,ie,Ae,oi,Ji,Fr,Fs;for(A=B,Z=t.charAt(B),H.test(Z)?B++:(Z=r,ge===0&&ze(R_)),Z===r&&(Z=null),ie=B,Ae=[],oi=t.charAt(B),Q.test(oi)?B++:(oi=r,ge===0&&ze(ol));oi!==r;)Ae.push(oi),oi=t.charAt(B),Q.test(oi)?B++:(oi=r,ge===0&&ze(ol));if(t.charCodeAt(B)===46?(oi=C,B++):(oi=r,ge===0&&ze(BE)),oi!==r){if(Ji=[],Fr=t.charAt(B),Q.test(Fr)?B++:(Fr=r,ge===0&&ze(ol)),Fr!==r)for(;Fr!==r;)Ji.push(Fr),Fr=t.charAt(B),Q.test(Fr)?B++:(Fr=r,ge===0&&ze(ol));else Ji=r;Ji!==r?ie=Ae=[Ae,oi,Ji]:(B=ie,ie=r)}else B=ie,ie=r;if(ie===r)if(ie=[],Ae=t.charAt(B),Q.test(Ae)?B++:(Ae=r,ge===0&&ze(ol)),Ae!==r)for(;Ae!==r;)ie.push(Ae),Ae=t.charAt(B),Q.test(Ae)?B++:(Ae=r,ge===0&&ze(ol));else ie=r;if(ie!==r){if(Ae=B,t.charCodeAt(B)===101?(oi=O,B++):(oi=r,ge===0&&ze(HE)),oi!==r){if(Ji=t.charAt(B),H.test(Ji)?B++:(Ji=r,ge===0&&ze(R_)),Ji===r&&(Ji=null),Fr=[],Fs=t.charAt(B),Q.test(Fs)?B++:(Fs=r,ge===0&&ze(ol)),Fs!==r)for(;Fs!==r;)Fr.push(Fs),Fs=t.charAt(B),Q.test(Fs)?B++:(Fs=r,ge===0&&ze(ol));else Fr=r;Fr!==r?Ae=oi=[oi,Ji,Fr]:(B=Ae,Ae=r)}else B=Ae,Ae=r;Ae===r&&(Ae=null),Ai=A,A=ade()}else B=A,A=r;return A}function bde(A,Z){return A.map(function(ie){return ie[Z]})}function _de(A,Z,ie){return[A].concat(bde(Z,ie))}if(i=o(),e.peg$library)return{peg$result:i,peg$currPos:B,peg$FAILED:r,peg$maxFailExpected:WE,peg$maxFailPos:al};if(i!==r&&B===t.length)return i;throw i!==r&&B<t.length&&ze(lde()),ude(WE,al<t.length?t.charAt(al):null,al<t.length?Lj(al,al+1):Lj(al,al))}function h4(t){if(!t||t.length===0)return null;if(typeof t=="string"){const i=u8(t);return i&&i.length!==0?i:null}const e=t.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new L("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:u8(i.value)}});e.sort((i,r)=>r.effects.length-i.effects.length);for(let i=0;i<e.length-1;i++){if(!qY(e[i].effects,e[i+1].effects))throw new L("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[i].effects,b:e[i+1].effects});WY(e[i].effects,e[i+1].effects)}return e.sort((i,r)=>r.scale-i.scale),e}function u8(t){let e;if(!t)return[];try{e=jIe(t)}catch(i){throw new L("effect:invalid-syntax","Invalid effect syntax",{value:t,error:i})}return e.map(i=>GIe(i))}function GIe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return zIe(t);case"opacity":return BIe(t);case"hue-rotate":return HIe(t);case"blur":return qIe(t);case"drop-shadow":return WIe(t);case"bloom":return ZIe(t)}}catch(e){throw e.details.filter=t,e}throw new L("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function zIe(t){let e=1;return S_(t.parameters,1),t.parameters.length===1&&(e=Yl(t.parameters[0])),new MR(t.name,e)}function BIe(t){let e=1;return S_(t.parameters,1),t.parameters.length===1&&(e=Yl(t.parameters[0])),new BY(e)}function HIe(t){let e=0;return S_(t.parameters,1),t.parameters.length===1&&(e=exe(t.parameters[0])),new GY(e)}function qIe(t){let e=0;return S_(t.parameters,1),t.parameters.length===1&&(e=y4(t.parameters[0]),lE(e,t.parameters[0])),new NY(e)}function WIe(t){const e=[];let i=null;for(const r of t.parameters)if(r.type==="color"){if(e.length&&Object.freeze(e),i)throw new L("effect:type-error","Accepts only one color",{});i=txe(r)}else{const n=y4(r);if(Object.isFrozen(e))throw new L("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(n),e.length===3&&lE(n,r)}if(e.length<2||e.length>3)throw new L("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new UY(e[0],e[1],e[2]||0,i||Yte("black"))}function ZIe(t){let e=1,i=0,r=0;return S_(t.parameters,3),t.parameters[0]&&(e=Yl(t.parameters[0])),t.parameters[1]&&(i=y4(t.parameters[1]),lE(i,t.parameters[1])),t.parameters[2]&&(r=Yl(t.parameters[2])),new PY(e,i,r)}function S_(t,e){if(t.length>e)throw new L("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function xk(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in f4)return"<length>";if(t.unit in m4)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function lE(t,e){if(t<0)throw new L("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function JIe(t){if(t.type!=="quantity"||t.unit!==null)throw new L("effect:type-error",`Expected <double>, Actual: ${xk(t)}`,{term:t})}function YIe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new L("effect:type-error",`Expected <double> or <percentage>, Actual: ${xk(t)}`,{term:t})}UIe(K0,Error),K0.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var i,r=null;for(i=0;i<t.length;i++)if(t[i].source===this.location.source){r=t[i].text.split(/\r\n|\n|\r/g);break}var n=this.location.start,s=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,o=this.location.source+":"+s.line+":"+s.column;if(r){var a=this.location.end,u=aA("",s.line.toString().length," "),d=r[n.line-1],p=(n.line===a.line?a.column:d.length+1)-n.column||1;e+=`
 --> `+o+`
`+u+` |
`+s.line+" | "+d+`
`+u+" | "+aA("",n.column-1," ")+aA("",p,"^")}else e+=`
 at `+o}return e},K0.buildMessage=function(t,e){var i={literal:function(d){return'"'+n(d.text)+'"'},class:function(d){var p=d.parts.map(function(h){return Array.isArray(h)?s(h[0])+"-"+s(h[1]):s(h)});return"["+(d.inverted?"^":"")+p.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(d){return d.description}};function r(d){return d.charCodeAt(0).toString(16).toUpperCase()}function n(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(p){return"\\x0"+r(p)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(p){return"\\x"+r(p)})}function s(d){return d.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(p){return"\\x0"+r(p)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(p){return"\\x"+r(p)})}function o(d){return i[d.type](d)}function a(d){var p,h,m=d.map(o);if(m.sort(),m.length>0){for(p=1,h=1;p<m.length;p++)m[p-1]!==m[p]&&(m[h]=m[p],h++);m.length=h}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function u(d){return d?'"'+n(d)+'"':"end of input"}return"Expected "+a(t)+" but "+u(e)+" found."};const m4={deg:1,grad:.9,rad:180/Math.PI,turn:360};function KIe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&m4[t.unit]!=null))throw new L("effect:type-error",`Expected <angle>, Actual: ${xk(t)}`,{term:t})}const f4={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function XIe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&f4[t.unit]!=null))throw new L("effect:type-error",`Expected <length>, Actual: ${xk(t)}`,{term:t})}function Yl(t){YIe(t);const e=t.value;return lE(e,t),t.unit==="%"?.01*e:e}function QIe(t){return JIe(t),lE(t.value,t),t.value}function exe(t){return KIe(t),t.value*m4[t.unit]||0}function y4(t){return XIe(t),t.value*f4[t.unit]||0}function txe(t){switch(t.colorType){case"hex":return kye(t.value);case"named":return Yte(t.value);case"function":return nxe(t.value)}}function Yte(t){if(!yY(t))throw new L("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return Cye(t)}const ixe=/^rgba?/i,rxe=/^hsla?/i;function nxe(t){if(S_(t.parameters,4),ixe.test(t.name))return[Yl(t.parameters[0]),Yl(t.parameters[1]),Yl(t.parameters[2]),t.parameters[3]?Yl(t.parameters[3]):1];if(rxe.test(t.name))return gY(QIe(t.parameters[0]),Yl(t.parameters[1]),Yl(t.parameters[2]),t.parameters[3]?Yl(t.parameters[3]):1);throw new L("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function c$(t,e,i){var r;try{return oxe(t)}catch(n){(r=i==null?void 0:i.messages)==null||r.push(n)}return null}function d$(t,e,i,r){try{const n=sxe(t);Zr(i,n,e)}catch(n){r.messages&&r.messages.push(n)}}function sxe(t){const e=h4(t);return e?Zge(e)?e.map(i=>i.toJSON()):e.map(({scale:i,effects:r})=>({scale:i,value:r.map(n=>n.toJSON())})):null}function oxe(t){if(!t||t.length===0)return null;if(axe(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:w2(i.value)});return e}return w2(t)}function axe(t){const e=t[0];return!!e&&"scale"in e}function w2(t){if(!(t!=null&&t.length))return"";const e=[];for(const i of t){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[Vc(i,"amount")];break;case"blur":r=[Vc(i,"radius","pt")];break;case"hue-rotate":r=[Vc(i,"angle","deg")];break;case"drop-shadow":r=[Vc(i,"xoffset","pt"),Vc(i,"yoffset","pt"),Vc(i,"blurRadius","pt"),lxe(i,"color")];break;case"bloom":r=[Vc(i,"strength"),Vc(i,"radius","pt"),Vc(i,"threshold")]}const n=`${i.type}(${r.filter(Boolean).join(" ")})`;h4(n),e.push(n)}return e.join(" ")}function Vc(t,e,i){if(t[e]==null)throw new L("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function lxe(t,e){if(t[e]==null)throw new L("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const uxe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},c8={read:{reader:c$},write:{allowNull:!0,writer:d$}},cxe={json:{read:!1,write:!1,origins:{"web-map":c8,"portal-item":c8}}},Kte=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return l([c(uxe)],e.prototype,"blendMode",void 0),l([c(cxe)],e.prototype,"effect",void 0),e=l([$("esri.layers.mixins.BlendLayer")],e),e},dxe=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return l([c({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],e.prototype,"customParameters",void 0),e=l([$("esri.layers.mixins.CustomParametersMixin")],e),e},pxe="randomUUID"in crypto;function Mk(){if(pxe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=i=>t[i].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function d8(){return`{${Mk().toUpperCase()}}`}function hxe(){return`{${Mk()}}`}const MF=hxe(),Xte=new Map,Qte=new Map;async function PQe(t,e,i){if(!t||!i)return!1;if(!e)return!0;const r=new URL(t).host;let n=Xte.get(r);if(!n){const s=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");n=(await Ee(s,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return n===e}async function p8(t,e,i=!1){var s,o,a;if(!t||!e)return!0;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=(s=Qte.get(r))==null?void 0:s.entries();if(n){for(const[u,d]of n)if(d.name===e){const p=!((o=d.stack)!=null&&o.hasForwardEdits());if(!p&&i){const[{deleteForwardEdits:h},{default:m}]=await Promise.all([k(()=>import("./deleteForwardEdits-YglNHP3P.js"),[]),k(()=>import("./DeleteForwardEditsParameters-BfOHSozD.js"),[])]),y=await h(r,u,new m({sessionId:MF,moment:d.moment}));return y.success&&((a=d.stack)==null||a.clearForwardEdits()),y.success}return p}}return!0}function zx(t,e){var n;if(!t)return!1;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),r=(n=Qte.get(i))==null?void 0:n.entries();if(r){for(const[s,o]of r)if(o.name===e)return o.lockType==="edit"}return!1}const g4=new ji.EventEmitter;function eie(t){return g4.on("apply-edits",new WeakRef(t))}function tie(t){return g4.on("update-moment",new WeakRef(t))}function h8(t,e,i=null,r=!1){const n=fn();return r=e==null||r,g4.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:i,mayReceiveServiceEdits:r,result:n.promise}),n}const iie=Symbol();function FQe(t){return t!=null&&typeof t=="object"&&iie in t}function Z_(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function wS(t,e,i){const r=new URL(t).host,n=Xte.get(r),s=o=>!o||o===n;return s(e)&&s(i)||e===i}const mxe=t=>{var e;let i=class extends t{constructor(...r){super(...r),this[e]=!0,this._applyEditsHandler=n=>{const{serviceUrl:s,layerId:o,gdbVersion:a,mayReceiveServiceEdits:u,result:d}=n,p=s===this.url,h=o!=null&&this.layerId!=null&&o===this.layerId,m=Z_(this),y=Z_(this)&&wS(s,a,this.gdbVersion);if(!p||m&&!y||!h&&!u)return;const g=d.then(v=>{var S;if(this.lastEditsEventDate=new Date,h&&(v.addedFeatures.length||v.updatedFeatures.length||v.deletedFeatures.length||v.addedAttachments.length||v.updatedAttachments.length||v.deletedAttachments.length))return this.emit("edits",R(v)),v;const _=(S=v.editedFeatures)==null?void 0:S.find(({layerId:E})=>E===this.layerId);if(_){const{adds:E,updates:T,deletes:M}=_.editedFeatures,x={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:E?E.map(({attributes:C})=>({objectId:this.objectIdField&&C[this.objectIdField],globalId:this.globalIdField&&C[this.globalIdField]})):[],deletedFeatures:M?M.map(({attributes:C})=>({objectId:this.objectIdField&&C[this.objectIdField],globalId:this.globalIdField&&C[this.globalIdField]})):[],updatedFeatures:T?T.map(({current:{attributes:C}})=>({objectId:this.objectIdField&&C[this.objectIdField],globalId:this.globalIdField&&C[this.globalIdField]})):[],editedFeatures:R(v.editedFeatures),exceededTransferLimit:!1,historicMoment:R(v.historicMoment)};return this.emit("edits",x),x}const w={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:R(v.editedFeatures),exceededTransferLimit:!1,historicMoment:R(v.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(s,a,w.historicMoment)&&this.emit("edits",w),w}).then(v=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(s,a,v.historicMoment)&&(this.historicMoment=v.historicMoment),v));this.emit("apply-edits",{result:g})},this._updateMomentHandler=n=>{const{serviceUrl:s,gdbVersion:o,moment:a}=n,u=s===this.url,d=Z_(this),p=Z_(this)&&wS(s,o,this.gdbVersion),h=Z_(this)&&!wS(s,this.gdbVersion,null);u&&d&&p&&h&&"historicMoment"in this&&this.historicMoment!==a&&(this.historicMoment=a)},this.when().then(()=>{this.addHandles(eie(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(tie(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(r,n,s){return"historicMoment"in this&&this.historicMoment!==s&&zx(r,n)}};return e=iie,l([c()],i.prototype,"lastEditsEventDate",void 0),i=l([$("esri.layers.mixins.EditBusLayer")],i),i};var CF;let Ov=CF=class extends j{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new CF({mapLayerId:t,gdbVersion:e})}};l([oe({mapLayer:"map-layer"})],Ov.prototype,"type",void 0),l([c({type:Xe,json:{write:!0}})],Ov.prototype,"mapLayerId",void 0),l([c({type:String,json:{write:!0}})],Ov.prototype,"gdbVersion",void 0),Ov=CF=l([$("esri.layers.support.source.MapLayerSource")],Ov);var kF;let ad=kF=class extends j{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:r,geometryType:n}=this,s={workspaceId:t,query:e,oidFields:i,spatialReference:(r==null?void 0:r.clone())??void 0,geometryType:n};return new kF(s)}};l([oe({queryTable:"query-table"})],ad.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],ad.prototype,"workspaceId",void 0),l([c({type:String,json:{write:!0}})],ad.prototype,"query",void 0),l([c({type:String,json:{write:!0}})],ad.prototype,"oidFields",void 0),l([c({type:le,json:{write:!0}})],ad.prototype,"spatialReference",void 0),l([oe(Uve)],ad.prototype,"geometryType",void 0),ad=kF=l([$("esri.layers.support.source.QueryTableDataSource")],ad);var LF;let Rv=LF=class extends j{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new LF({workspaceId:t,dataSourceName:e})}};l([oe({raster:"raster"})],Rv.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],Rv.prototype,"dataSourceName",void 0),l([c({type:String,json:{write:!0}})],Rv.prototype,"workspaceId",void 0),Rv=LF=l([$("esri.layers.support.source.RasterDataSource")],Rv);var AF;let Cf=AF=class extends j{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new AF({workspaceId:t,gdbVersion:e,dataSourceName:i})}};l([oe({table:"table"})],Cf.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],Cf.prototype,"workspaceId",void 0),l([c({type:String,json:{write:!0}})],Cf.prototype,"gdbVersion",void 0),l([c({type:String,json:{write:!0}})],Cf.prototype,"dataSourceName",void 0),Cf=AF=l([$("esri.layers.support.source.TableDataSource")],Cf);var OF,RF;const fxe=Me()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Io=OF=class extends j{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return m8()(t,e,i)}castLeftTableSource(t){return Qa(PF(),t)}readRightTableSource(t,e,i){return m8()(t,e,i)}castRightTableSource(t){return Qa(PF(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:r,joinType:n}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(r==null?void 0:r.clone())??void 0,joinType:n};return new OF(s)}};l([oe({joinTable:"join-table"})],Io.prototype,"type",void 0),l([c({type:String,json:{write:!0}})],Io.prototype,"leftTableKey",void 0),l([c({type:String,json:{write:!0}})],Io.prototype,"rightTableKey",void 0),l([c({json:{write:!0}})],Io.prototype,"leftTableSource",void 0),l([X("leftTableSource")],Io.prototype,"readLeftTableSource",null),l([We("leftTableSource")],Io.prototype,"castLeftTableSource",null),l([c({json:{write:!0}})],Io.prototype,"rightTableSource",void 0),l([X("rightTableSource")],Io.prototype,"readRightTableSource",null),l([We("rightTableSource")],Io.prototype,"castRightTableSource",null),l([oe(fxe)],Io.prototype,"joinType",void 0),Io=OF=l([$("esri.layers.support.source.JoinTableDataSource")],Io);let lA=null;function m8(){return lA||(lA=s_({types:PF()})),lA}let uA=null;function PF(){return uA||(uA={key:"type",base:null,typeMap:{"data-layer":Kl,"map-layer":Ov}}),uA}const yxe={key:"type",base:null,typeMap:{"join-table":Io,"query-table":ad,raster:Rv,table:Cf}};let Kl=RF=class extends j{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new RF({fields:t,dataSource:e})}};l([oe({dataLayer:"data-layer"})],Kl.prototype,"type",void 0),l([c({type:[Ik],json:{write:!0}})],Kl.prototype,"fields",void 0),l([c({types:yxe,json:{write:!0}})],Kl.prototype,"dataSource",void 0),Kl=RF=l([$("esri.layers.support.source.DataLayerSource")],Kl),Kl.from=pi(Kl);let kf=class extends Ze(j){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};l([c({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],kf.prototype,"onFields",void 0),l([c({type:String,json:{write:!0}})],kf.prototype,"operator",void 0),l([c({type:String,json:{write:!0}})],kf.prototype,"searchTerm",void 0),l([c({type:String,json:{write:!0}})],kf.prototype,"searchType",void 0),kf=l([$("esri.rest.support.FullTextSearch")],kf);const rie=kf;var FF;const f8=new $e({upperLeft:"upper-left",lowerLeft:"lower-left"});let Lf=FF=class extends j{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new FF(R({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};l([c({type:at,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Lf.prototype,"extent",void 0),l([c({type:["view","edit"],json:{write:!0}})],Lf.prototype,"mode",void 0),l([c({type:String,json:{read:f8.read,write:f8.write}})],Lf.prototype,"originPosition",void 0),l([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Lf.prototype,"tolerance",void 0),Lf=FF=l([$("esri.rest.support.QuantizationParameters")],Lf);const nie=Lf,gxe=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var NF;const y8=new $e({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Ll=NF=class extends j{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=R(t))}clone(){return new NF({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:R(this.statisticParameters)})}};l([c({type:Number,json:{write:!0}})],Ll.prototype,"maxPointCount",void 0),l([c({type:Number,json:{write:!0}})],Ll.prototype,"maxRecordCount",void 0),l([c({type:Number,json:{write:!0}})],Ll.prototype,"maxVertexCount",void 0),l([c({type:String,json:{write:!0}})],Ll.prototype,"onStatisticField",void 0),l([c({type:String,json:{write:!0}})],Ll.prototype,"outStatisticFieldName",void 0),l([c({type:String,json:{read:{source:"statisticType",reader:y8.read},write:{target:"statisticType",writer:y8.write}}})],Ll.prototype,"statisticType",void 0),l([c({type:Object})],Ll.prototype,"statisticParameters",void 0),l([te("statisticParameters")],Ll.prototype,"writeStatisticParameters",null),Ll=NF=l([$("esri.rest.support.StatisticDefinition")],Ll);const vxe=Ll;var Bx;const bxe=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Se=Bx=class extends j{static from(t){return r_(Bx,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const r in t){const n=t[r];Array.isArray(n)?i[r]=n.map(s=>s instanceof Date?s.getTime():s):n instanceof Date?i[r]=n.getTime():i[r]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new Bx(R({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};Se.MAX_MAX_RECORD_COUNT_FACTOR=5,l([c({json:{write:!0}})],Se.prototype,"aggregateIds",void 0),l([c({type:Boolean,json:{write:!0}})],Se.prototype,"cacheHint",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"compactGeometryEnabled",void 0),l([c({json:{write:!0}})],Se.prototype,"datumTransformation",void 0),l([We("datumTransformation")],Se.prototype,"castDatumTransformation",null),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"defaultSpatialReferenceEnabled",void 0),l([c({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],Se.prototype,"distance",void 0),l([c({type:Kl,json:{write:!0}})],Se.prototype,"dynamicDataSource",void 0),l([c({type:String,json:{write:!0}})],Se.prototype,"formatOf3DObjects",void 0),l([c({type:[rie],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],Se.prototype,"fullText",void 0),l([c({type:String,json:{write:!0}})],Se.prototype,"gdbVersion",void 0),l([c({types:rg,json:{read:dp,write:!0}})],Se.prototype,"geometry",void 0),l([c({type:Number,json:{write:!0}})],Se.prototype,"geometryPrecision",void 0),l([c({type:[String],json:{write:!0}})],Se.prototype,"groupByFieldsForStatistics",void 0),l([c({type:String,json:{write:!0}})],Se.prototype,"having",void 0),l([c({type:Date})],Se.prototype,"historicMoment",void 0),l([te("historicMoment")],Se.prototype,"writeHistoricMoment",null),l([c({type:Number,json:{write:!0}})],Se.prototype,"maxAllowableOffset",void 0),l([c({type:Number,cast:t=>t<1?1:t>Se.MAX_MAX_RECORD_COUNT_FACTOR?Se.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],Se.prototype,"maxRecordCountFactor",void 0),l([c({type:["xyFootprint"],json:{write:!0}})],Se.prototype,"multipatchOption",void 0),l([c({type:Number,json:{read:{source:"resultRecordCount"}}})],Se.prototype,"num",void 0),l([c({json:{write:!0}})],Se.prototype,"objectIds",void 0),l([c({type:[String],json:{write:!0}})],Se.prototype,"orderByFields",void 0),l([c({type:[String],json:{write:!0}})],Se.prototype,"outFields",void 0),l([c({type:le,json:{name:"outSR",write:!0}})],Se.prototype,"outSpatialReference",void 0),l([c({type:[vxe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],Se.prototype,"outStatistics",void 0),l([c({json:{write:!0}})],Se.prototype,"parameterValues",void 0),l([te("parameterValues")],Se.prototype,"writeParameterValues",null),l([c({type:we,json:{write:!0}})],Se.prototype,"pixelSize",void 0),l([c({type:nie,json:{write:!0}})],Se.prototype,"quantizationParameters",void 0),l([c({type:[Object],json:{write:!0}})],Se.prototype,"rangeValues",void 0),l([c({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],Se.prototype,"relationParameter",void 0),l([c({type:String,json:{write:!0}})],Se.prototype,"resultType",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"returnCentroid",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"returnDistinctValues",void 0),l([c({type:Boolean,json:{default:!0,write:!0}})],Se.prototype,"returnExceededLimitFeatures",void 0),l([c({type:Boolean,json:{write:!0}})],Se.prototype,"returnGeometry",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"returnQueryGeometry",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"returnM",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Se.prototype,"returnZ",void 0),l([c({type:le,json:{write:!0}})],Se.prototype,"sourceSpatialReference",void 0),l([oe(gxe,{ignoreUnknown:!1,name:"spatialRel"})],Se.prototype,"spatialRelationship",void 0),l([c({type:Number,json:{read:{source:"resultOffset"}}})],Se.prototype,"start",void 0),l([te("start"),te("num")],Se.prototype,"writeStart",null),l([c({type:String,json:{write:!0}})],Se.prototype,"sqlFormat",void 0),l([c({type:String,json:{write:!0}})],Se.prototype,"text",void 0),l([c({type:Pt,json:{write:!0}})],Se.prototype,"timeExtent",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],Se.prototype,"timeReferenceUnknownClient",void 0),l([oe(bxe,{ignoreUnknown:!1}),c({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null&&this.distance>0}}}}})],Se.prototype,"units",void 0),l([c({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],Se.prototype,"where",void 0),l([te("where")],Se.prototype,"writeWhere",null),Se=Bx=l([$("esri.rest.support.Query")],Se);const gu=Se;var DF;const cA=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),dA=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Gu=DF=class extends j{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:r,timeExtent:n,objectIds:s,units:o,distance:a}=this;return new gu({geometry:R(i),objectIds:R(s),spatialRelationship:r,timeExtent:R(n),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:r,objectIds:n,units:s,distance:o}=this;return new DF({geometry:R(e),objectIds:R(n),spatialRelationship:i,timeExtent:R(r),where:t,units:s,distance:o})}};l([c({type:String,json:{write:!0}})],Gu.prototype,"where",void 0),l([c({types:rg,json:{write:!0}})],Gu.prototype,"geometry",void 0),l([c({type:cA.apiValues,json:{name:"spatialRel",read:{reader:cA.read},write:{allowNull:!1,writer:cA.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],Gu.prototype,"spatialRelationship",void 0),l([c({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Gu.prototype,"distance",void 0),l([c({type:[Number],json:{write:!0}})],Gu.prototype,"objectIds",void 0),l([c({type:dA.apiValues,json:{read:dA.read,write:{writer:dA.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Gu.prototype,"units",void 0),l([c({type:Pt,json:{write:!0}})],Gu.prototype,"timeExtent",void 0),Gu=DF=l([$("esri.layers.support.FeatureFilter")],Gu);const _xe=Gu;var VF;const g8={read:{reader:c$},write:{writer:d$,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},v8={read:{reader:c$},write:{writer:d$,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},b8={name:"showExcludedLabels",default:!0};let Af=VF=class extends j{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var r,n;const i=super.write(t,e);if(e!=null&&e.origin){if(i.filter){const s=Object.keys(i.filter);if(s.length>1||s[0]!=="where")return(r=e.messages)==null||r.push(new L("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return(n=e.messages)==null||n.push(new L("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new VF({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};l([c({type:_xe,json:{write:{allowNull:!0,writer(t,e,i,r){const n=t==null?void 0:t.write({},r);n&&Object.keys(n).length!==0?Zr(i,n,e):Zr(i,null,e)}}}})],Af.prototype,"filter",void 0),l([c({json:{read:c$,write:{writer:d$,allowNull:!0},origins:{"web-map":g8,"portal-item":g8}}})],Af.prototype,"includedEffect",void 0),l([c({json:{read:c$,write:{writer:d$,allowNull:!0},origins:{"web-map":v8,"portal-item":v8}}})],Af.prototype,"excludedEffect",void 0),l([c({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":b8,"portal-item":b8}}})],Af.prototype,"excludedLabelsVisible",void 0),Af=VF=l([$("esri.layers.support.FeatureEffect")],Af);const wxe=Af,_8={write:{allowNull:!0}},Sxe={type:wxe,json:{origins:{"web-map":_8,"portal-item":_8}}},$xe=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return l([c(Sxe)],e.prototype,"featureEffect",void 0),e=l([$("esri.layers.mixins.FeatureEffectLayer")],e),e};var w1;const S2=Me()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),sie=S2.jsonValues.slice();Mde(sie,"orthometric");const SS=Me()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Al=w1=class extends j{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return S2.write(t,e,i)}readHeightModel(t,e,i){return S2.read(t)||(i!=null&&i.messages&&i.messages.push(Exe(t,{context:i})),null)}readHeightUnit(t,e,i){return SS.read(t)||(i!=null&&i.messages&&i.messages.push(w8(t,{context:i})),null)}readHeightUnitService(t,e,i){return JJ(t)||SS.read(t)||(i!=null&&i.messages&&i.messages.push(w8(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new w1({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=YJ(e);return new w1({heightModel:t.heightModel,heightUnit:i??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new w1;return e.read(t,{origin:"web-scene"}),e}};function w8(t,e){return new Jo("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function Exe(t,e){return new Jo("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}l([c({type:S2.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:sie,default:"ellipsoidal"}}}})],Al.prototype,"heightModel",void 0),l([te("web-scene","heightModel")],Al.prototype,"writeHeightModel",null),l([X(["web-scene","service"],"heightModel")],Al.prototype,"readHeightModel",null),l([c({type:SS.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:SS.jsonValues,write:SS.write}}}})],Al.prototype,"heightUnit",void 0),l([X("web-scene","heightUnit")],Al.prototype,"readHeightUnit",null),l([X("service","heightUnit")],Al.prototype,"readHeightUnitService",null),l([c({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Al.prototype,"vertCRS",void 0),l([X("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Al.prototype,"readVertCRS",null),Al=w1=l([$("esri.geometry.HeightModelInfo")],Al);const uE=Al;var UF;let S1=UF=class extends j{constructor(t){super(t)}async collectRequiredFields(t,e){return as(t,e,this.expression)}clone(){return new UF({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};l([c({type:String,json:{write:!0}})],S1.prototype,"expression",void 0),l([c({type:String,json:{write:!0}})],S1.prototype,"title",void 0),S1=UF=l([$("esri.symbols.support.FeatureExpressionInfo")],S1);const S8=S1;function DQe(t){return!!t&&rE[t]!=null}function Txe(t){return 1/(rE[t]||1)}function Ixe(){const t=Object.keys(rE);return RS(t,"decimal-degrees"),t.sort(),t}const xxe=Ixe();var jF;const MT=Me()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),$8=new $e({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let ld=jF=class extends j{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,i,r){e[i]=t.write({},r),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new jF({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&Wde(this.featureExpressionInfo,t.featureExpressionInfo)}};l([c({type:S8,json:{write:!0}})],ld.prototype,"featureExpressionInfo",void 0),l([X("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],ld.prototype,"readFeatureExpressionInfo",null),l([te("featureExpressionInfo",{featureExpressionInfo:{type:S8},"featureExpression.value":{type:[0]}})],ld.prototype,"writeFeatureExpressionInfo",null),l([c({type:MT.apiValues,nonNullable:!0,json:{type:MT.jsonValues,read:MT.read,write:{writer:MT.write,isRequired:!0}}})],ld.prototype,"mode",null),l([c({type:Number,json:{write:!0}})],ld.prototype,"offset",void 0),l([c({type:xxe,json:{type:String,read:$8.read,write:$8.write}})],ld.prototype,"unit",null),ld=jF=l([$("esri.symbols.support.ElevationInfo")],ld);const oie=ld;let Pv=class extends j{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};l([c({type:String,json:{write:!0}})],Pv.prototype,"description",void 0),l([c({type:String,json:{write:!0}})],Pv.prototype,"label",void 0),l([c()],Pv.prototype,"type",void 0),Pv=l([$("esri.tables.elements.AttributeTableElement")],Pv);const Vb=Pv;var GF;let $1=GF=class extends Vb{constructor(t){super(t),this.displayType="auto",this.type="attachment"}clone(){return new GF({description:this.description,displayType:this.displayType,label:this.label})}};l([c({type:["auto"],json:{write:!0}})],$1.prototype,"displayType",void 0),l([c({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],$1.prototype,"type",void 0),$1=GF=l([$("esri.tables.elements.AttributeTableAttachmentElement")],$1);const E8=$1;var zF;let E1=zF=class extends Vb{constructor(t){super(t),this.fieldName=null,this.type="field"}clone(){return new zF({description:this.description,fieldName:this.fieldName,label:this.label})}};l([c({type:String,json:{write:!0}})],E1.prototype,"fieldName",void 0),l([c({type:String,json:{read:!1,write:!0}})],E1.prototype,"type",void 0),E1=zF=l([$("esri.tables.elements.AttributeTableFieldElement")],E1);const T8=E1;var BF;let T1=BF=class extends Vb{constructor(t){super(t),this.relationshipId=null,this.type="relationship"}clone(){return new BF({description:this.description,label:this.label,relationshipId:this.relationshipId})}};l([c({type:Number,json:{write:!0}})],T1.prototype,"relationshipId",void 0),l([c({type:["relationship"],json:{read:!1,write:!0}})],T1.prototype,"type",void 0),T1=BF=l([$("esri.tables.elements.AttributeTableRelationshipElement")],T1);const I8=T1;function aie(t){return{typesWithGroup:{base:Vb,key:"type",typeMap:{attachment:E8,field:T8,group:t,relationship:I8}},typesWithoutGroup:{base:Vb,key:"type",typeMap:{attachment:E8,field:T8,relationship:I8}}}}function lie(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function uie(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>n.toJSON())}function cie(t,e,i=!0){return t?t.map(r=>Qa(i?e.typesWithGroup:e.typesWithoutGroup,r)):null}var HF;let Nd=HF=class extends Vb{constructor(t){super(t),this.elements=null,this.type="group"}castElements(t){return cie(t,pA,!1)}readElements(t,e){return lie(e.attributeTableElements,pA,!1)}writeElements(t,e){e.attributeTableElements=uie(t,pA,!1)}clone(){return new HF({description:this.description,elements:R(this.elements),label:this.label})}};l([c({json:{write:!0}})],Nd.prototype,"elements",void 0),l([We("elements")],Nd.prototype,"castElements",null),l([X("elements",["attributeTableElements"])],Nd.prototype,"readElements",null),l([te("elements")],Nd.prototype,"writeElements",null),l([c({type:String,json:{read:!1,write:!0}})],Nd.prototype,"type",void 0),Nd=HF=l([$("esri.tables.elements.AttributeTableGroupElement")],Nd);const pA=aie(Nd),Mxe=Nd;var qF;const hA=aie(Mxe);let ah=qF=class extends j{constructor(t){super(t),this.elements=null,this.orderByFields=null}castElements(t){return cie(t,hA)}readElements(t,e){return lie(e.attributeTableElements,hA)}writeElements(t,e){e.attributeTableElements=uie(t,hA)}clone(){return new qF({elements:R(this.elements),orderByFields:this.orderByFields})}};l([c({json:{write:!0}})],ah.prototype,"elements",void 0),l([We("elements")],ah.prototype,"castElements",null),l([X("elements",["attributeTableElements"])],ah.prototype,"readElements",null),l([te("elements")],ah.prototype,"writeElements",null),l([c({type:[Object],json:{write:!0}})],ah.prototype,"orderByFields",void 0),ah=qF=l([$("esri.tables.AttributeTableTemplate")],ah);const Cxe=ah,kxe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:mn}}},v4={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},b4={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:mn}}},Lxe={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Vy}}},Axe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:mn}}},Oxe={value:null,type:oie,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:mn}}};function UQe(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const die={write:{enabled:!0,layerContainerTypes:mn},read:!0},WF={type:Number,json:{origins:{"web-document":die,"portal-item":{write:!0}}}},Rxe={...WF,json:{...WF.json,origins:{"web-document":{...die,write:{enabled:!0,layerContainerTypes:mn,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>{var r;return i&&i.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?(r=e.layerDefinition)!=null&&r.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?WS(e.layerDefinition.drawingInfo.transparency):void 0:WS(e.drawingInfo.transparency)}}}},jQe={type:at,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=at.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(i.spatialReference=le.fromJSON(e.spatialReference)),i}}}},read:!1}},Pxe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},Fxe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:mn}}},name:"layerDefinition.minScale",write:!0}},Nxe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:mn}}},name:"layerDefinition.maxScale",write:!0}},pie={json:{write:{ignoreOrigin:!0,layerContainerTypes:mn},origins:{"web-map":{read:!1,write:!1}}}},Dxe={type:Cxe,json:{name:"attributeTableInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}};let ud=class extends Ze(j){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};l([c()],ud.prototype,"creatorField",void 0),l([c()],ud.prototype,"creationDateField",void 0),l([c()],ud.prototype,"editorField",void 0),l([c()],ud.prototype,"editDateField",void 0),l([c()],ud.prototype,"realm",void 0),l([c(p2("dateFieldsTimeReference",!0))],ud.prototype,"timeZone",void 0),ud=l([$("esri.layers.support.EditFieldsInfo")],ud);const Vxe=ud;let sc=class extends Ze(j){constructor(e){super(e)}};l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"name",void 0),l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"fields",void 0),l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"isAscending",void 0),l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"indexType",void 0),l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"isUnique",void 0),l([c({constructOnly:!0,json:{write:!0}})],sc.prototype,"description",void 0),sc=l([$("esri.layers.support.FeatureIndex")],sc);async function hie(t,e,i){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=mie(t));const r=Uxe(t),n=t.capabilities.query.supportsPagination;e.start=0,e.num=r;let s=null;for(;;){const o=await t.source.queryFeaturesJSON(e,i);if(s==null?s=o:s.features=s.features.concat(o.features),s.exceededTransferLimit=o.exceededTransferLimit,!n||!o.exceededTransferLimit)break;e.start+=r}return s}function Uxe(t){return mie(t)*jxe(t)}function jxe(t){return t.capabilities.query.maxRecordCount||2e3}function mie(t){return t.capabilities.query.supportsMaxRecordCountFactor?gu.MAX_MAX_RECORD_COUNT_FACTOR:1}var ZF;let on=ZF=class extends j{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new ZF(R({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};l([c({type:[String],json:{write:!0}})],on.prototype,"attachmentTypes",void 0),l([c({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],on.prototype,"attachmentsWhere",void 0),l([c({type:Boolean,json:{write:!0}})],on.prototype,"cacheHint",void 0),l([c({type:[String],json:{write:!0}})],on.prototype,"keywords",void 0),l([c({type:[String],json:{write:!0}})],on.prototype,"globalIds",void 0),l([c({json:{write:!0}})],on.prototype,"name",void 0),l([c({type:Number,json:{read:{source:"resultRecordCount"}}})],on.prototype,"num",void 0),l([c({type:[Number],json:{write:!0}})],on.prototype,"objectIds",void 0),l([c({type:Boolean,json:{default:!1,write:!0}})],on.prototype,"returnMetadata",void 0),l([c({type:[Number],json:{write:!0}})],on.prototype,"size",void 0),l([c({type:Number,json:{read:{source:"resultOffset"}}})],on.prototype,"start",void 0),l([te("start"),te("num")],on.prototype,"writeStart",null),l([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],on.prototype,"where",void 0),on=ZF=l([$("esri.rest.support.AttachmentQuery")],on),on.from=pi(on);const JF=on;var YF;let Ri=YF=class extends j{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new YF(R({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};l([c({type:Boolean,json:{write:!0}})],Ri.prototype,"cacheHint",void 0),l([c({type:Kl,json:{write:!0}})],Ri.prototype,"dynamicDataSource",void 0),l([c({type:String,json:{write:!0}})],Ri.prototype,"gdbVersion",void 0),l([c({type:Number,json:{write:!0}})],Ri.prototype,"geometryPrecision",void 0),l([c({type:Date})],Ri.prototype,"historicMoment",void 0),l([te("historicMoment")],Ri.prototype,"_writeHistoricMoment",null),l([c({type:Number,json:{write:!0}})],Ri.prototype,"maxAllowableOffset",void 0),l([c({json:{write:!0}})],Ri.prototype,"objectIds",void 0),l([c({type:[String],json:{write:!0}})],Ri.prototype,"orderByFields",void 0),l([c({type:[String],json:{write:!0}})],Ri.prototype,"outFields",void 0),l([c({type:le,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ri.prototype,"outSpatialReference",void 0),l([c({json:{write:!0}})],Ri.prototype,"relationshipId",void 0),l([c({type:Number,json:{read:{source:"resultOffset"}}})],Ri.prototype,"start",void 0),l([te("start"),te("num")],Ri.prototype,"writeStart",null),l([c({type:Number,json:{read:{source:"resultRecordCount"}}})],Ri.prototype,"num",void 0),l([c({json:{write:!0}})],Ri.prototype,"returnGeometry",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ri.prototype,"returnM",void 0),l([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ri.prototype,"returnZ",void 0),l([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Ri.prototype,"where",void 0),Ri=YF=l([$("esri.rest.support.RelationshipQuery")],Ri),Ri.from=pi(Ri);const p$=Ri,BQe=Object.freeze(Object.defineProperty({__proto__:null,default:p$},Symbol.toStringTag,{value:"Module"})),KF=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function Gxe(t,e,i,r){const n=await Mm(t);if(await _4(t,e,r),!n.addAttachment)throw new L(r,"Layer source does not support addAttachment capability");return n.addAttachment(e,i)}function _4(t,e,i){var s,o;const{attributes:r}=e,{objectIdField:n}=t;return(o=(s=t.capabilities)==null?void 0:s.data)!=null&&o.supportsAttachment?e?r?n&&r[n]?Promise.resolve():Promise.reject(new L(i,`feature is missing the identifying attribute ${n}`)):Promise.reject(new L(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new L(i,"A feature is required to add/delete/update attachments")):Promise.reject(new L(i,"this layer doesn't support attachments"))}async function zxe(t,e,i,r,n){const s=await Mm(t);if(await _4(t,e,n),!s.updateAttachment)throw new L(n,"Layer source does not support updateAttachment capability");return s.updateAttachment(e,i,r)}async function Bxe(t,e,i){const{applyEdits:r}=await k(()=>import("./editingSupport-6f_hxNS7.js"),[]),n=await t.load();let s=i;return n.type==="feature"&&n.infoFor3D&&e.deleteFeatures!=null&&n.globalIdField!=null&&(s={...s,globalIdToObjectId:await uMe(n,e.deleteFeatures,n.globalIdField)}),r(n,n.source,e,i)}async function Hxe(t,e,i){const{uploadAssets:r}=await k(()=>import("./editingSupport-6f_hxNS7.js"),[]),n=await t.load();return r(n,n.source,e,i)}async function qxe(t,e,i,r){const n=await Mm(t);if(await _4(t,e,r),!n.deleteAttachments)throw new L(r,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(e,i)}async function Wxe(t,e,i){const r=(await t.load({signal:e==null?void 0:e.signal})).source;if(!r.fetchRecomputedExtents)throw new L(i,"Layer source does not support fetchUpdates capability");return r.fetchRecomputedExtents(e)}async function Zxe(t,e,i,r){var y,g;e=JF.from(e),await t.load();const n=t.source,s=t.capabilities;if(!((y=s==null?void 0:s.data)!=null&&y.supportsAttachment))throw new L(r,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:u,num:d,size:p,start:h,where:m}=e;if(!((g=s==null?void 0:s.operations)!=null&&g.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(u==null?void 0:u.length)>0||(p==null?void 0:p.length)>0||d||h||m))throw new L(r,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a!=null&&a.length||u!=null&&u.length||m))throw new L(r,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!n.queryAttachments)throw new L(r,"Layer source does not support queryAttachments capability",e);return n.queryAttachments(e)}async function Jxe(t,e,i,r){const n=await Mm(t);if(!n.queryObjectIds)throw new L(r,"Layer source does not support queryObjectIds capability");return n.queryObjectIds(gu.from(e)??t.createQuery(),i)}async function Yxe(t,e,i,r){const n=await Mm(t);if(!n.queryFeatureCount)throw new L(r,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount(gu.from(e)??t.createQuery(),i)}async function Kxe(t,e,i,r){const n=await Mm(t);if(!n.queryExtent)throw new L(r,"Layer source does not support queryExtent capability");return n.queryExtent(gu.from(e)??t.createQuery(),i)}async function Xxe(t,e,i,r){const n=await Mm(t);if(!n.queryRelatedFeatures)throw new L(r,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(p$.from(e),i)}async function Qxe(t,e,i,r){const n=await Mm(t);if(!n.queryRelatedFeaturesCount)throw new L(r,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(p$.from(e),i)}async function eMe(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:i,updates:r}=await e.refresh();if(r!=null&&(t.sourceJSON={...t.sourceJSON,...r},t.read(r,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await b5(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function tMe(t){var o,a;const e=new gu,i=(o=t.capabilities)==null?void 0:o.data,r=(a=t.capabilities)==null?void 0:a.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference),i&&(i.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:n,timeExtent:s}=t;return e.timeExtent=n!=null&&s!=null?s.offset(-n.value,n.unit):s||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function fie(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeGlobalID")return r.name}}function yie(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeOID")return r.name}}function iMe(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function rMe(t,e){const{subtypes:i,subtypeField:r}=t;if(!(e!=null&&e.attributes)||!(i!=null&&i.length)||!r)return null;const n=e.attributes[r];return n==null?null:i.find(s=>s.code===n)}function nMe(t,e){var s,o,a,u,d;const{fieldsIndex:i,subtypeField:r}=t,n=(s=i.get(e))==null?void 0:s.name;if(!n)return null;if((r&&((o=i.get(r))==null?void 0:o.name))===n&&((a=t.subtypes)!=null&&a.length)){const p=t.subtypes.map(h=>new Jd({code:h.code,name:h.name}));if(p!=null&&p.length)return new Fb({codedValues:p})}if(("typeIdField"in t?(u=i.get(t.typeIdField))==null?void 0:u.name:null)===n&&"types"in t&&((d=t.types)!=null&&d.length)){const p=t.types.map(h=>new Jd({code:h.id,name:h.name}));return new Fb({codedValues:p})}return null}async function Mm(t){return(await t.load()).source}async function sMe(t,e){if(!Te||Te.findCredential(t))return;let i;try{const r=await VV(t,e);r&&(i=await Te.checkSignInStatus(`${r}/sharing`))}catch{}if(i)try{const r=e!=null?e.signal:null;await Te.getCredential(t,{signal:r})}catch{}}async function oMe(t,e,i){var n;const r=(n=t.parsedUrl)==null?void 0:n.path;r&&t.authenticationTriggerEvent===e&&await sMe(r,i)}function aMe(t){return!Hx(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const mA=s_({types:vee});function w4(t,e){var i;if(t.defaultSymbol)return(i=t.types)!=null&&i.length?new l4({defaultSymbol:mA(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:mA(r.symbol,r,e)}))}):new w_({symbol:mA(t.defaultSymbol,t,e)})}function lMe(t){var r,n,s;let e=(r=t.sourceJSON)==null?void 0:r.cacheMaxAge;if(!e)return!1;const i=(s=(n=t.editingInfo)==null?void 0:n.lastEditDate)==null?void 0:s.getTime();return i==null||(e*=1e3,Date.now()-i<e)}async function uMe(t,e,i){if(e==null)return null;const r=[],{objectIdField:n}=t;if(e.forEach(d=>{let p=null;if("attributes"in d){const{attributes:h}=d;p={globalId:h[i],objectId:h[n]!=null&&h[n]!==-1?h[n]:null}}else p={globalId:d.globalId,objectId:d.objectId!=null&&d.objectId!==-1?d.objectId:null};p.globalId!=null&&(p.objectId!=null&&p.objectId!==-1||r.push(p.globalId))}),r.length===0)return null;const s=t.createQuery();s.where=r.map(d=>`${i}='${d}'`).join(" OR "),s.returnGeometry=!1,s.outFields=[n,i],s.cacheHint=!1;const o=await Hme(hie(t,s));if(!o.ok)return null;const a=new Map,u=o.value.features;for(const d of u){const p=d.attributes[i],h=d.attributes[n];p!=null&&h!=null&&h!==-1&&a.set(p,h)}return a}function cMe(t,e,i){if(!e||!i||!t)return null;const r=i.getAttribute(e);return r==null?null:t.find(n=>{const{id:s}=n;return s!=null&&s.toString()===r.toString()})??null}function Hx(t){var e;return((e=t.sourceJSON)==null?void 0:e.isMultiServicesView)||dMe(t)}function dMe(t){var e,i;return!!((i=(e=t.sourceJSON)==null?void 0:e.capabilities)!=null&&i.toLowerCase().split(",").map(r=>r.trim()).includes("map"))}function pMe(t,e,i){const r=e==null?void 0:e.queryBins;if(!r)throw new L(i,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!r.supportsAutoInterval)throw new L(i,"Layer source does not support auto-interval binning");break;case"date":if(!r.supportsDate)throw new L(i,"Layer source does not support date binning");break;case"fixed-boundaries":if(!r.supportsFixedBoundaries)throw new L(i,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!r.supportsFixedInterval)throw new L(i,"Layer source does not support fixed-interval binning")}const n=r==null?void 0:r.supportedStatistics;if(t.outStatistics&&n){const s=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const a=s.get(o);if(a&&!n[a])throw new L(i,`Layer source does not support ${o} statistic type`)}}}let Fv=class extends Ze(j){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};l([c({type:String,json:{read:{source:"shapeAreaFieldName"}}})],Fv.prototype,"shapeAreaField",void 0),l([c({type:String,json:{read:{source:"shapeLengthFieldName"}}})],Fv.prototype,"shapeLengthField",void 0),l([c({type:String,json:{read:t=>Tfe.read(t)||Ife.read(t)}})],Fv.prototype,"units",void 0),Fv=l([$("esri.layers.support.GeometryFieldsInfo")],Fv);const hMe=Fv;var XF;let Nv=XF=class extends j{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Y}clone(){return new XF({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};l([c({type:String,json:{write:!0}})],Nv.prototype,"floorField",void 0),l([c({json:{read:!1,write:!1}})],Nv.prototype,"viewAllMode",void 0),l([c({json:{read:!1,write:!1}})],Nv.prototype,"viewAllLevelIds",void 0),Nv=XF=l([$("esri.layers.support.LayerFloorInfo")],Nv);const mMe=Nv,x8=new $e({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),M8=new $e({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let fa=class extends Ze(j){constructor(e){super(e),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};l([c({json:{read:x8.read,write:x8.write}})],fa.prototype,"cardinality",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"composite",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"id",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"keyField",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"keyFieldInRelationshipTable",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"name",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"relatedTableId",void 0),l([c({json:{read:!0,write:!0}})],fa.prototype,"relationshipTableId",void 0),l([c({json:{read:M8.read,write:M8.write}})],fa.prototype,"role",void 0),fa=l([$("esri.layers.support.Relationship")],fa);const fMe=fa;function me(t,e,i){return!!gie(t,e,i)}function I1(t,e,i){return gie(t,e,i)}function gie(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const yMe={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function gMe(t){var i;const e=(i=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:i.map(r=>r.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function cE(t,e){var r;const i=(r=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:r.map(n=>n.toLowerCase());return!!(i!=null&&i.includes(e.toLowerCase()))}function vMe(t){var i;const e=(i=t==null?void 0:t.supportedStatisticTypes)==null?void 0:i.map(r=>r.toLowerCase());return{count:!!(e!=null&&e.includes("count")),sum:!!(e!=null&&e.includes("sum")),min:!!(e!=null&&e.includes("min")),max:!!(e!=null&&e.includes("max")),avg:!!(e!=null&&e.includes("avg")),var:!!(e!=null&&e.includes("var")),stddev:!!(e!=null&&e.includes("stddev")),percentileContinuous:!!(e!=null&&e.includes("percentile_continuous")),percentileDiscrete:!!(e!=null&&e.includes("percentile_discrete")),envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function vie(t,e){return{analytics:bMe(t),attachment:_Me(t),data:wMe(t),metadata:SMe(t),operations:$Me(t.capabilities,t,e),query:EMe(t,e),queryBins:xMe(t),queryRelated:TMe(t),queryTopFeatures:IMe(t),editing:MMe(t)}}function bMe(t){return{supportsCacheHint:cE(t.advancedQueryCapabilities,"queryAnalytics")}}function _Me(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:cE(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:me(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(r=>{const n=yMe[r.name];n&&(i[n]=!!r.isEnabled)}),i}function wMe(t){return{isVersioned:me(t,"isDataVersioned",!1),isBranchVersioned:me(t,"isDataBranchVersioned",!1),supportsAttachment:me(t,"hasAttachments",!1),supportsM:me(t,"hasM",!1),supportsZ:me(t,"hasZ",!1)}}function SMe(t){return{supportsAdvancedFieldProperties:me(t,"supportsFieldDescriptionProperty",!1)}}function $Me(t,e,i){const r=t?t.toLowerCase().split(",").map(m=>m.trim()):[],n=i?du(i):null,s=r.includes(n!=null&&n.serverType==="MapServer"?"data":"query"),o=r.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&r.includes("create"),u=o&&r.includes("delete"),d=o&&r.includes("update");const p=r.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||u||d)&&(a=u=d=!0),{supportsCalculate:me(e,"supportsCalculate",!1),supportsTruncate:me(e,"supportsTruncate",!1),supportsValidateSql:me(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:u,supportsEditing:o,supportsChangeTracking:p,supportsQuery:s,supportsQueryAnalytics:me(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:me(h,"supportsQueryAttachments",!1),supportsQueryBins:me(h,"supportsQueryBins",!1),supportsQueryTopFeatures:me(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:me(e,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:d,supportsExceedsLimitStatistics:me(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:me(e,"supportsAsyncConvert3D",!1)}}function EMe(t,e){const i=t.advancedQueryCapabilities,r=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,s=t.currentVersion,o=e==null?void 0:e.includes("MapServer"),a=!o||s>=G("mapserver-pbf-version-support"),u=Jte(e),d=new Set((t.supportedQueryFormats??"").split(",").map(p=>p.toLowerCase().trim()));return{maxRecordCount:I1(t,"maxRecordCount",void 0),maxRecordCountFactor:I1(t,"maxRecordCountFactor",void 0),standardMaxRecordCount:I1(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:gMe(i),supportsCacheHint:me(i,"supportsQueryWithCacheHint",!1)||cE(i,"query"),supportsCentroid:me(i,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:u,supportsDefaultSpatialReference:me(i,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:me(i,"supportsDisjointSpatialRel",!1),supportsDistance:me(i,"supportsQueryWithDistance",!1),supportsDistinct:me(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:me(i,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&d.has("pbf"),supportsFullTextSearch:me(i,"supportsFullTextSearch",!1),supportsGeometryProperties:me(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:me(i,"supportsHavingClause",!1),supportsHistoricMoment:me(n,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:me(i,"supportsMaxRecordCountFactor",!1),supportsOrderBy:me(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:me(i,"supportsPagination",!1),supportsPercentileStatistics:me(i,"supportsPercentileStatistics",!1),supportsQuantization:me(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:me(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:me(r,"allowAnonymousToQuery",!0),supportsQueryByOthers:me(r,"allowOthersToQuery",!0),supportsQueryGeometry:me(t,"supportsReturningQueryGeometry",!1),supportsResultType:me(i,"supportsQueryWithResultType",!1),supportsSpatialAggregationStatistics:me(i,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:me(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:me(t,"useStandardizedQueries",!1),supportsStatistics:me(i,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:me(i,"supportsTopFeaturesQuery",!1),tileMaxRecordCount:I1(t,"tileMaxRecordCount",void 0)}}function TMe(t){const e=t.advancedQueryCapabilities,i=me(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:me(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:cE(e,"queryRelated")}}function IMe(t){return{supportsCacheHint:cE(t.advancedQueryCapabilities,"queryTopFilter")}}function xMe(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:me(e,"supportsDateBin",!1),supportsFixedInterval:me(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:me(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:me(e,"supportsFixedBoundariesBin",!1),supportedStatistics:vMe(e)}}function MMe(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:me(t,"allowGeometryUpdates",!0),supportsGlobalId:me(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:me(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:me(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:me(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:me(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:me(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:me(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:me(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:me(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:me(i,"supportsAsyncApplyEdits",!1),zDefault:I1(t,"zDefault",void 0)}}function WQe(t){var e;return{operations:{supportsAppend:me(t,"supportsAppend",!1),supportsCoverageQuery:((e=t==null?void 0:t.playbackInfo)==null?void 0:e.klv["0601"])??!1,supportsExportClip:me(t,"supportsExportClip",!1),supportsExportFrameset:me(t,"supportsExportFrameset",!1),supportsMensuration:me(t,"supportsMensuration",!1),supportsUpdate:me(t,"supportsUpdate",!1)}}}let cd=class extends Ze(j){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const i={};for(const r of Object.keys(e))i[r]=Tk(e[r]);return i}writeDomains(e,i){var n;if(!e)return;const r={};for(const s of Object.keys(e))e[s]&&(r[s]=(n=e[s])==null?void 0:n.toJSON());i.domains=r}};l([c({type:Number,json:{write:!0}})],cd.prototype,"code",void 0),l([c({type:Object,json:{write:!0}})],cd.prototype,"defaultValues",void 0),l([c({json:{write:!0}})],cd.prototype,"domains",void 0),l([X("domains")],cd.prototype,"readDomains",null),l([te("domains")],cd.prototype,"writeDomains",null),l([c({type:String,json:{write:!0}})],cd.prototype,"name",void 0),cd=l([$("esri.layers.support.Subtype")],cd);const QF=cd,CMe=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(Y.ofType(sc)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=le.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}get authenticationTriggerEvent(){var n;if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:s,operations:o,editing:a}=i;if(!s.supportsQueryByOthers||!s.supportsQueryByAnonymous||o.supportsEditing&&!(a.supportsUpdateByOthers&&a.supportsUpdateByAnonymous&&a.supportsDeleteByOthers&&a.supportsDeleteByAnonymous))return"load"}if((n=this.serviceDefinitionExpression)!=null&&n.toLowerCase().includes("current_user"))return"load";if(this.userHasUpdateItemPrivileges){if(lMe(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const r=this.editFieldsInfo;return(r!=null&&r.creatorField||r!=null&&r.editorField)&&(i!=null&&i.operations.supportsEditing)?"editing":null}readCapabilitiesFromService(i,r){return vie(r,this.url)}readEditingInfo(i,r){const{editingInfo:n}=r;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const r=R(i),{operations:n,editing:s}=r;return Hx(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),r):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=s.supportsDeleteByOthers=s.supportsGeometryUpdate=s.supportsUpdateByOthers=!0,r):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=s.supportsGeometryUpdate=!0),r)}readGlobalIdFieldFromService(i,r){return fie(r)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||Hx(this))return!1;const{operations:r,editing:n}=i;return r.supportsEditing&&!(r.supportsAdd&&r.supportsDelete&&r.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:r,editing:n}=i;return Hx(this)?!r.supportsQuery:!(r.supportsAdd&&r.supportsDelete&&r.supportsEditing&&r.supportsQuery&&r.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,r){return r.type==="Table"}readMaxScale(i,r){return r.effectiveMaxScale||i||0}readMinScale(i,r){return r.effectiveMinScale||i||0}readObjectIdFieldFromService(i,r){return yie(r)}readServiceDefinitionExpression(i,r){return r.definitionQuery||r.definitionExpression}set url(i){if(i==null)return void this._set("url",i);const r=NIe({layer:this,url:i,nonStandardUrlAllowed:!0,logger:U.getLogger(this)});this._set("url",r.url),r.layerId!=null&&this._set("layerId",r.layerId)}writeUrl(i,r,n,s){DIe(this,i,null,r,s)}readVersion(i,r){return iMe(r)}};return l([c({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),l([c({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),l([c({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),l([X("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),l([c(p2("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),l([c({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),l([c({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),l([c({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),l([c({readOnly:!0,type:Vxe})],e.prototype,"editFieldsInfo",void 0),l([c({readOnly:!0})],e.prototype,"editingInfo",void 0),l([X("editingInfo")],e.prototype,"readEditingInfo",null),l([c({readOnly:!0})],e.prototype,"effectiveCapabilities",null),l([c((()=>{const i=R(Oxe),r=i.json.origins;return r["web-map"]={read:!1,write:!1},r["portal-item"]={read:!1,write:!1},i})())],e.prototype,"elevationInfo",void 0),l([c({type:mMe,json:{name:"layerDefinition.floorInfo",write:!0,origins:{"web-scene":{name:"layerDefinition.floorInfo",write:{enabled:!0,layerContainerTypes:mn}}}}})],e.prototype,"floorInfo",void 0),l([c({type:at,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),l([c()],e.prototype,"gdbVersion",void 0),l([c({readOnly:!0,type:hMe,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),l([c({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:KF.read}}}})],e.prototype,"geometryType",void 0),l([c({type:String})],e.prototype,"globalIdField",void 0),l([X("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),l([c({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),l([c({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),l([c({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),l([c({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),l([c({readOnly:!0,type:uE})],e.prototype,"heightModelInfo",void 0),l([c({type:Date})],e.prototype,"historicMoment",void 0),l([c({type:Y.ofType(sc),readOnly:!0})],e.prototype,"indexes",void 0),l([c({readOnly:!0})],e.prototype,"isTable",void 0),l([X("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),l([c({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),l([c(Nxe)],e.prototype,"maxScale",void 0),l([X("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),l([c(Fxe)],e.prototype,"minScale",void 0),l([X("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),l([c({type:String})],e.prototype,"objectIdField",void 0),l([X("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),l([c(p2("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),l([c({type:[fMe],readOnly:!0})],e.prototype,"relationships",void 0),l([c({type:Boolean})],e.prototype,"returnM",void 0),l([c({type:Boolean})],e.prototype,"returnZ",void 0),l([c({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),l([c({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),l([X("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),l([c({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),l([c()],e.prototype,"sourceJSON",void 0),l([c({type:le,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),l([c({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),l([c({type:[QF],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),l([c({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),l([c(Lxe)],e.prototype,"url",null),l([te("url")],e.prototype,"writeUrl",null),l([c({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),l([X("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=l([$("esri.layers.mixins.FeatureLayerBase")],e),e};let Dv=class extends Ze(j){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};l([c({type:String,json:{write:!0}})],Dv.prototype,"expression",void 0),l([c({type:String,json:{write:!0}})],Dv.prototype,"title",void 0),l([c({type:String,json:{write:!0}})],Dv.prototype,"returnType",void 0),Dv=l([$("esri.layers.support.ExpressionInfo")],Dv);const S4=Dv;var eN;let dd=eN=class extends j{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new eN({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:R(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};l([c({type:Boolean,json:{write:!0}})],dd.prototype,"isAutoGenerated",void 0),l([c({type:String,json:{write:!0}})],dd.prototype,"name",void 0),l([c({type:String,json:{write:!0}})],dd.prototype,"alias",void 0),l([c({type:String,json:{write:!0}})],dd.prototype,"onStatisticField",void 0),l([c({type:S4,json:{write:!0}})],dd.prototype,"onStatisticExpression",void 0),l([c({type:String,json:{write:!0}})],dd.prototype,"statisticType",void 0),dd=eN=l([$("esri.layers.support.AggregateField")],dd);const Hy=dd;let om=class extends j{constructor(){super(...arguments),this.type=null}};l([c({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],om.prototype,"type",void 0),om=l([$("esri.layers.support.FeatureReduction")],om);const $4="__begin__",E4="__end__",kMe=new RegExp($4,"ig"),LMe=new RegExp(E4,"ig"),C8=new RegExp("^"+$4,"i"),k8=new RegExp(E4+"$","i"),$2='"',AMe=$2+" + ",OMe=" + "+$2;function RMe(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function PMe(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function T4(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=RMe(t.labelExpression),e.type="conventional"),e}function FMe(t){const e=T4(t);if(!e)return null;switch(e.type){case"conventional":return tN(e.expression);case"arcade":return e.expression}return null}function NMe(t){const e=T4(t);if(!e)return null;switch(e.type){case"conventional":return VMe(e.expression);case"arcade":return bie(e.expression)}return null}function tN(t){let e;return t?(e=mu(t,i=>$4+'$feature["'+i+'"]'+E4),e=C8.test(e)?e.replace(C8,""):$2+e,e=k8.test(e)?e.replace(k8,""):e+$2,e=e.replaceAll(kMe,AMe).replaceAll(LMe,OMe)):e='""',e}const DMe=/^\s*\{([^}]+)\}\s*$/i;function VMe(t){const e=t==null?void 0:t.match(DMe);return(e==null?void 0:e[1].trim())||null}const UMe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,jMe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,GMe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function bie(t){if(!t)return null;let e=UMe.exec(t)||jMe.exec(t);return e?e[1]||e[3]:(e=GMe.exec(t),e?e[2]:null)}var iN;let lh=iN=class extends j{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?tN(e.value):t}writeExpression(t,e,i){this.value!=null&&(t=tN(this.value)),t!=null&&(e[i]=t)}clone(){return new iN({expression:this.expression,title:this.title,value:this.value})}};l([c({type:String,json:{write:{writerEnsuresNonNull:!0}}})],lh.prototype,"expression",void 0),l([X("expression",["expression","value"])],lh.prototype,"readExpression",null),l([te("expression")],lh.prototype,"writeExpression",null),l([c({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],lh.prototype,"title",void 0),l([c({json:{read:!1,write:!1}})],lh.prototype,"value",void 0),lh=iN=l([$("esri.layers.support.LabelExpressionInfo")],lh);const _ie=lh;var rN;const CT=new $e({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function kT(t,e,i){return{enabled:!$R(i==null?void 0:i.layer)}}function wie(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function zMe(t){return(t==null?void 0:t.type)==="map-image"}function Sie(t){var e,i;return!!zMe(t)&&!!((i=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&i.supportsArcadeExpressionForLabeling)}function BMe(t){return wie(t)||Sie(t==null?void 0:t.layer)}let Xi=rN=class extends j{static evaluateWhere(t,e){const i=(r,n,s)=>{switch(n){case"=":return r==s;case"<>":return r!=s;case">":return r>s;case">=":return r>=s;case"<":return r<s;case"<=":return r<=s}return!1};try{if(t==null)return!0;const r=t.split(" ");if(r.length===3)return i(e[r[0]],r[1],r[2]);if(r.length===7){const n=i(e[r[0]],r[1],r[2]),s=r[3],o=i(e[r[4]],r[5],r[6]);switch(s){case"AND":return n&&o;case"OR":return n||o}}return!1}catch{}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=$$e,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=PMe(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const r=bie(this.labelExpressionInfo.expression);r&&(t="["+r+"]")}}t!=null&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,r){if(t==null&&this.labelExpression!=null&&wie(r))t=new _ie({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(r);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return T4(this)}getLabelExpressionArcade(){return FMe(this)}getLabelExpressionSingleField(){return NMe(this)}hash(){return JSON.stringify(this)}clone(){return new rN({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:R(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:R(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};l([c({type:String,json:{write:!0}})],Xi.prototype,"name",void 0),l([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:kT}}}}})],Xi.prototype,"allowOverrun",void 0),l([c({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:kT}}}}})],Xi.prototype,"deconflictionStrategy",void 0),l([c({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&Sie(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],Xi.prototype,"labelExpression",void 0),l([X("labelExpression")],Xi.prototype,"readLabelExpression",null),l([te("labelExpression")],Xi.prototype,"writeLabelExpression",null),l([c({type:_ie,json:{write:{overridePolicy:(t,e,i)=>BMe(i)?{allowNull:!0}:{enabled:!1}}}})],Xi.prototype,"labelExpressionInfo",void 0),l([te("labelExpressionInfo")],Xi.prototype,"writeLabelExpressionInfo",null),l([c({type:CT.apiValues,json:{type:CT.jsonValues,read:CT.read,write:CT.write}})],Xi.prototype,"labelPlacement",void 0),l([c({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],Xi.prototype,"labelPosition",void 0),l([c({type:Number})],Xi.prototype,"maxScale",void 0),l([te("maxScale")],Xi.prototype,"writeMaxScale",null),l([c({type:Number})],Xi.prototype,"minScale",void 0),l([te("minScale")],Xi.prototype,"writeMinScale",null),l([c({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:kT}}}}})],Xi.prototype,"repeatLabel",void 0),l([c({type:Number,cast:dt,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:kT}}}}})],Xi.prototype,"repeatLabelDistance",void 0),l([c({types:FSe,json:{origins:{"web-scene":{types:NSe,write:cz,default:null}},write:cz,default:null}})],Xi.prototype,"symbol",void 0),l([c({type:Boolean,json:{write:!0}})],Xi.prototype,"useCodedValues",void 0),l([c({type:String,json:{write:!0}})],Xi.prototype,"where",void 0),Xi=rN=l([$("esri.layers.support.LabelClass")],Xi);const Ck=Xi;var nN;let Bn=nN=class extends om{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=dt("12px"),this.fields=[],this.renderer=null}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Zr(i,r,e)}readRenderer(t,e,i){var n;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return r?a$(r,e,i)??void 0:w4(e,i)}clone(){return new nN({fields:R(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:R(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:R(this.popupTemplate),renderer:R(this.renderer),binType:R(this.binType),size:this.size})}};l([oe({binning:"binning"})],Bn.prototype,"type",void 0),l([oe({geohash:"geohash",square:"square"}),c({type:["geohash","square"]})],Bn.prototype,"binType",void 0),l([c({type:Number,json:{write:!0}})],Bn.prototype,"fixedBinLevel",void 0),l([c({type:[Ck],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Bn.prototype,"labelingInfo",void 0),l([c(b4)],Bn.prototype,"labelsVisible",void 0),l([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Bn.prototype,"maxScale",void 0),l([c(v4)],Bn.prototype,"popupEnabled",void 0),l([c({type:ag,json:{name:"popupInfo",write:!0}})],Bn.prototype,"popupTemplate",void 0),l([c({cast:t=>t==="auto"?t:xs(dt(t))})],Bn.prototype,"size",void 0),l([c({type:[Hy],json:{write:!0}})],Bn.prototype,"fields",void 0),l([te("fields")],Bn.prototype,"writeFields",null),l([c({types:Sk,json:{write:{target:"drawingInfo.renderer"}}})],Bn.prototype,"renderer",void 0),l([X("renderer",["drawingInfo.renderer"])],Bn.prototype,"readRenderer",null),Bn=nN=l([$("esri.layers.support.FeatureReductionBinning")],Bn);const $ie=Bn;var sN;function L8(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let wr=sN=class extends j{constructor(t){super(t),this.type="cluster",this.clusterRadius=dt("80px"),this.clusterMinSize=dt("12px"),this.clusterMaxSize=dt("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,i){var n,s;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return(s=r==null?void 0:r.authoringInfo)!=null&&s.isAutoGenerated?null:r?L8(r)?null:a$(r,e,i)??void 0:w4(e,i)}readSymbol(t,e,i){var n,s;const r=(n=e.drawingInfo)==null?void 0:n.renderer;if((s=r==null?void 0:r.authoringInfo)!=null&&s.isAutoGenerated)return null;if(r&&L8(r)){const o=a$(r,e,i);return o==null?void 0:o.symbol}return null}writeSymbol(t,e,i,r){var s,o;const n=(o=(s=this.renderer)==null?void 0:s.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||n){const a=new w_({symbol:t});e.drawingInfo={renderer:a.write({},r)}}}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Zr(i,r,e)}readFields(t,e,i){return t.filter(r=>!r.isAutoGenerated).map(r=>Hy.fromJSON(r))}clone(){return new sN({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:R(this.labelingInfo),labelsVisible:this.labelsVisible,fields:R(this.fields),maxScale:this.maxScale,renderer:R(this.renderer),symbol:R(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:R(this.popupTemplate)})}};l([c({type:["cluster"],readOnly:!0,json:{write:!0}})],wr.prototype,"type",void 0),l([c({cast:t=>t==="auto"?t:xs(dt(t)),json:{write:!0}})],wr.prototype,"clusterRadius",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],wr.prototype,"clusterMinSize",void 0),l([c({type:Number,cast:dt,json:{write:!0}})],wr.prototype,"clusterMaxSize",void 0),l([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],wr.prototype,"maxScale",void 0),l([c(v4)],wr.prototype,"popupEnabled",void 0),l([c({type:ag,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],wr.prototype,"popupTemplate",void 0),l([c({types:Sk,json:{write:{target:"drawingInfo.renderer"}}})],wr.prototype,"renderer",void 0),l([X("renderer",["drawingInfo.renderer"])],wr.prototype,"readRenderer",null),l([c({types:RSe})],wr.prototype,"symbol",void 0),l([X("symbol",["drawingInfo.renderer"])],wr.prototype,"readSymbol",null),l([te("symbol")],wr.prototype,"writeSymbol",null),l([c({type:[Ck],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],wr.prototype,"labelingInfo",void 0),l([c(b4)],wr.prototype,"labelsVisible",void 0),l([c({type:[Hy],json:{write:!0}})],wr.prototype,"fields",void 0),l([te("fields")],wr.prototype,"writeFields",null),l([X("fields")],wr.prototype,"readFields",null),wr=sN=l([$("esri.layers.support.FeatureReductionCluster")],wr);const Eie=wr;var oN;let qx=oN=class extends om{constructor(t){super(t),this.type="selection"}clone(){return new oN}};l([c({type:["selection"]})],qx.prototype,"type",void 0),qx=oN=l([$("esri.layers.support.FeatureReductionSelection")],qx);const A8=qx,O8={key:"type",base:om,typeMap:{cluster:Eie,binning:$ie}},HMe={types:{key:"type",base:om,typeMap:{selection:A8,cluster:Eie,binning:$ie}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:O8},"portal-item":{types:O8},"web-scene":{types:{key:"type",base:om,typeMap:{selection:A8}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:mn}}}}},$g={Base64:0,Hex:1,String:2,Raw:3},X0=8,Tie=(1<<X0)-1;function Yh(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function qMe(t){const e=[];for(let i=0,r=t.length*X0;i<r;i+=X0)e[i>>5]|=(t.charCodeAt(i/X0)&Tie)<<i%32;return e}function WMe(t){const e=[];for(let i=0,r=32*t.length;i<r;i+=X0)e.push(String.fromCharCode(t[i>>5]>>>i%32&Tie));return e.join("")}function ZMe(t){const e="0123456789abcdef",i=[];for(let r=0,n=4*t.length;r<n;r++)i.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return i.join("")}function JMe(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let n=0,s=4*t.length;n<s;n+=3){const o=(t[n>>2]>>n%4*8&255)<<16|(t[n+1>>2]>>(n+1)%4*8&255)<<8|t[n+2>>2]>>(n+2)%4*8&255;for(let a=0;a<4;a++)8*n+6*a>32*t.length?r.push(e):r.push(i.charAt(o>>6*(3-a)&63))}return r.join("")}function YMe(t,e){return t<<e|t>>>32-e}function kk(t,e,i,r,n,s){return Yh(YMe(Yh(Yh(e,t),Yh(r,s)),n),i)}function Nn(t,e,i,r,n,s,o){return kk(e&i|~e&r,t,e,n,s,o)}function Dn(t,e,i,r,n,s,o){return kk(e&r|i&~r,t,e,n,s,o)}function Vn(t,e,i,r,n,s,o){return kk(e^i^r,t,e,n,s,o)}function Un(t,e,i,r,n,s,o){return kk(i^(e|~r),t,e,n,s,o)}function KMe(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,r=-271733879,n=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=i,u=r,d=n,p=s;i=Nn(i,r,n,s,t[o],7,-680876936),s=Nn(s,i,r,n,t[o+1],12,-389564586),n=Nn(n,s,i,r,t[o+2],17,606105819),r=Nn(r,n,s,i,t[o+3],22,-1044525330),i=Nn(i,r,n,s,t[o+4],7,-176418897),s=Nn(s,i,r,n,t[o+5],12,1200080426),n=Nn(n,s,i,r,t[o+6],17,-1473231341),r=Nn(r,n,s,i,t[o+7],22,-45705983),i=Nn(i,r,n,s,t[o+8],7,1770035416),s=Nn(s,i,r,n,t[o+9],12,-1958414417),n=Nn(n,s,i,r,t[o+10],17,-42063),r=Nn(r,n,s,i,t[o+11],22,-1990404162),i=Nn(i,r,n,s,t[o+12],7,1804603682),s=Nn(s,i,r,n,t[o+13],12,-40341101),n=Nn(n,s,i,r,t[o+14],17,-1502002290),r=Nn(r,n,s,i,t[o+15],22,1236535329),i=Dn(i,r,n,s,t[o+1],5,-165796510),s=Dn(s,i,r,n,t[o+6],9,-1069501632),n=Dn(n,s,i,r,t[o+11],14,643717713),r=Dn(r,n,s,i,t[o],20,-373897302),i=Dn(i,r,n,s,t[o+5],5,-701558691),s=Dn(s,i,r,n,t[o+10],9,38016083),n=Dn(n,s,i,r,t[o+15],14,-660478335),r=Dn(r,n,s,i,t[o+4],20,-405537848),i=Dn(i,r,n,s,t[o+9],5,568446438),s=Dn(s,i,r,n,t[o+14],9,-1019803690),n=Dn(n,s,i,r,t[o+3],14,-187363961),r=Dn(r,n,s,i,t[o+8],20,1163531501),i=Dn(i,r,n,s,t[o+13],5,-1444681467),s=Dn(s,i,r,n,t[o+2],9,-51403784),n=Dn(n,s,i,r,t[o+7],14,1735328473),r=Dn(r,n,s,i,t[o+12],20,-1926607734),i=Vn(i,r,n,s,t[o+5],4,-378558),s=Vn(s,i,r,n,t[o+8],11,-2022574463),n=Vn(n,s,i,r,t[o+11],16,1839030562),r=Vn(r,n,s,i,t[o+14],23,-35309556),i=Vn(i,r,n,s,t[o+1],4,-1530992060),s=Vn(s,i,r,n,t[o+4],11,1272893353),n=Vn(n,s,i,r,t[o+7],16,-155497632),r=Vn(r,n,s,i,t[o+10],23,-1094730640),i=Vn(i,r,n,s,t[o+13],4,681279174),s=Vn(s,i,r,n,t[o],11,-358537222),n=Vn(n,s,i,r,t[o+3],16,-722521979),r=Vn(r,n,s,i,t[o+6],23,76029189),i=Vn(i,r,n,s,t[o+9],4,-640364487),s=Vn(s,i,r,n,t[o+12],11,-421815835),n=Vn(n,s,i,r,t[o+15],16,530742520),r=Vn(r,n,s,i,t[o+2],23,-995338651),i=Un(i,r,n,s,t[o],6,-198630844),s=Un(s,i,r,n,t[o+7],10,1126891415),n=Un(n,s,i,r,t[o+14],15,-1416354905),r=Un(r,n,s,i,t[o+5],21,-57434055),i=Un(i,r,n,s,t[o+12],6,1700485571),s=Un(s,i,r,n,t[o+3],10,-1894986606),n=Un(n,s,i,r,t[o+10],15,-1051523),r=Un(r,n,s,i,t[o+1],21,-2054922799),i=Un(i,r,n,s,t[o+8],6,1873313359),s=Un(s,i,r,n,t[o+15],10,-30611744),n=Un(n,s,i,r,t[o+6],15,-1560198380),r=Un(r,n,s,i,t[o+13],21,1309151649),i=Un(i,r,n,s,t[o+4],6,-145523070),s=Un(s,i,r,n,t[o+11],10,-1120210379),n=Un(n,s,i,r,t[o+2],15,718787259),r=Un(r,n,s,i,t[o+9],21,-343485551),i=Yh(i,a),r=Yh(r,u),n=Yh(n,d),s=Yh(s,p)}return[i,r,n,s]}function I4(t,e=$g.Hex){const i=e||$g.Base64,r=KMe(qMe(t),t.length*X0);switch(i){case $g.Raw:return r;case $g.Hex:return ZMe(r);case $g.String:return WMe(r);case $g.Base64:return JMe(r)}}const XMe=()=>U.getLogger("esri.views.2d.layers.support.clusterUtils");G.add("esri-cluster-arcade-enabled",!0);const QMe=G("esri-cluster-arcade-enabled"),e2e=new Set(["simple-line","simple-fill","picture-fill"]);function R8(t,e){let i=e.clone();if(!t2e(i))return i;if(e.getSymbols().some(r=>e2e.has(r.type))&&(i=new w_({symbol:new Or})),i.authoringInfo||(i.authoringInfo=new z5),i.authoringInfo.isAutoGenerated=!0,"visualVariables"in i){const r=(i.visualVariables||[]).filter(n=>n.valueExpression!=="$view.scale");r.forEach(n=>{n.type==="rotation"?n.field?n.field=Nm(t,n.field,"avg_angle","number"):n.valueExpression&&(n.field=J_(t,n.valueExpression,"avg_angle","number"),n.valueExpression=null):n.normalizationField?(n.field=Nm(t,n.field,"avg_norm","number",n.normalizationField),n.normalizationField=null):n.field?n.field=Nm(t,n.field,"avg","number"):n.valueExpression&&(n.field=J_(t,n.valueExpression,"avg","number"),n.valueExpression=null)}),i.visualVariables=r}switch(i.type){case"simple":break;case"pie-chart":for(const r of i.attributes)r.field?r.field=Nm(t,r.field,"sum","number"):r.valueExpression&&(r.field=J_(t,r.valueExpression,"sum","number"),r.valueExpression=null);break;case"unique-value":i.field?i.field=Nm(t,i.field,"mode","string"):i.valueExpression&&(i.field=J_(t,i.valueExpression,"mode","string"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=Nm(t,i.field,"avg_norm","number",i.normalizationField),i.normalizationField=null):i.field?i.field=Nm(t,i.field,"avg","number"):i.valueExpression&&(i.field=J_(t,i.valueExpression,"avg","number"),i.valueExpression=null)}return i}const t2e=t=>{const e=i=>XMe().error(new L("Unsupported-renderer",i,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if(i!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!QMe){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function i2e(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const r=i,n="field",s=e.toLowerCase()+",norm:"+n+","+r.toLowerCase();return"cluster_avg_"+I4(s)}}}function J_(t,e,i,r){const n=I4(e),s=i==="mode"?`cluster_type_${n}`:i==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return t.some(o=>o.name===s)||t.push(new Hy({name:s,isAutoGenerated:!0,onStatisticExpression:new S4({expression:e,returnType:r}),statisticType:i})),s}function Nm(t,e,i,r,n){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const s=i2e(i,e,n);return t.some(o=>o.name===s)||(i==="avg_norm"?t.push(new Hy({name:s,isAutoGenerated:!0,onStatisticExpression:new S4({expression:`$feature.${e} / $feature.${n}`,returnType:r}),statisticType:"avg"})):t.push(new Hy({name:s,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),s}const r2e=t=>{let e=class extends t{constructor(...i){super(...i),this.addHandles(N(()=>this.renderer,()=>{if(this.featureReduction){const r=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",r)}},yn))}set featureReduction(i){const r=this._normalizeFeatureReduction(i);this._set("featureReduction",r)}set renderer(i){}_withClusterVariable(i,r,n){const s=i.clone();return"visualVariables"in s&&(s.visualVariables||(s.visualVariables=[]),s.visualVariables.some(o=>o.type==="size")||s.visualVariables.push(new b_({field:"cluster_count",stops:[new Ix({value:1}),new Ix({useMinValue:!0,size:r}),new Ix({useMaxValue:!0,size:n})]}))),s}_normalizeFeatureReduction(i){var h;if((i==null?void 0:i.type)!=="cluster")return i;const r=i.clone(),n=[new Hy({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],s=(r.fields??[]).filter(m=>!m.isAutoGenerated),o=i.renderer&&!((h=i.renderer.authoringInfo)!=null&&h.isAutoGenerated),{clusterMinSize:a,clusterMaxSize:u}=r;if(o){r.fields=[...n,...s];const m=this._withClusterVariable(r.renderer,a,u);return r.effectiveFeatureRenderer=m,r.effectiveClusterRenderer=m,r}if(i.symbol){if(r.fields=[...n,...s],r.renderer=null,!this.renderer)return r.effectiveFeatureRenderer=null,r.effectiveClusterRenderer=null,r;const m=R8(n,this.renderer),y=this._withClusterVariable(m,a,u),g="visualVariables"in y&&y.visualVariables?y.visualVariables:[],v=new w_({symbol:i.symbol,visualVariables:g});return r.fields=[...n,...s],r.effectiveFeatureRenderer=y,r.effectiveClusterRenderer=v,r}if(!this.renderer)return i;const d=R8(n,this.renderer);r.fields=[...n,...s],r.renderer=d;const p=this._withClusterVariable(d,a,u);return r.effectiveFeatureRenderer=p,r.effectiveClusterRenderer=p,r}};return l([c(HMe)],e.prototype,"featureReduction",null),e=l([$("esri.layers.mixins.FeatureReductionLayer")],e),e},P8={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},F8={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},N8={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},n2e={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":P8,"web-map/basemap":F8,"web-map/tables":N8,"link-chart/operational-layers":{...P8,LinkChartLayer:!0},"link-chart/basemap":F8,"link-chart/tables":N8,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0}},s2e=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,r,n){var s;return((s=n==null?void 0:n.portalItem)==null?void 0:s.type)==="Group Layer"?void 0:i}writeListMode(i,r,n,s){(s&&s.layerContainerType==="ground"||i&&Vhe(this,n,{},s))&&(r[n]=i)}writeOperationalLayerType(i,r,n,s){i&&(s==null?void 0:s.layerContainerType)!=="tables"&&(r.layerType=i)}writeTitle(i,r){r.title=i??"Layer"}readTimeExtent(i){return i?Pt.fromArray(i):null}writeTimeExtent(i,r,n,s){i&&s.layerContainerType!=="tables"&&(i.isEmpty?s!=null&&s.messages&&s.messages.push(new L("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):r[n]=i.toArray())}read(i,r){r&&(r.layer=this),hJ(this,i,n=>super.read(i,n),r)}write(i,r){var o,a;if(!this.persistenceEnabled&&!(r!=null&&r.ignorePersistenceEnabled))return null;if(r!=null&&r.origin){const u=`${r.origin}/${r.layerContainerType||"operational-layers"}`,d=n2e[u];let p=!!(d!=null&&d[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&u==="web-scene/operational-layers"&&(p=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&u==="web-map/operational-layers"&&(p=!1),!p)return(o=r.messages)==null||o.push(new L("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${u}'`,{layer:this})),null}const n=super.write(i,{...r,layer:this}),s=!!r&&!!r.messages&&!!r.messages.filter(u=>u instanceof L&&u.name==="web-document-write:property-required").length;return RC(n==null?void 0:n.url)?((a=r==null?void 0:r.messages)==null||a.push(new L("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&s?null:n}beforeSave(){}};return l([c({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),l([X("id",["id"])],e.prototype,"readId",null),l([c(pie)],e.prototype,"listMode",void 0),l([te("listMode")],e.prototype,"writeListMode",null),l([c({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:mn}}}}})],e.prototype,"operationalLayerType",void 0),l([te("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),l([c(WF)],e.prototype,"opacity",void 0),l([c({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),l([c({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),l([te("title"),te(["web-scene"],"title")],e.prototype,"writeTitle",null),l([c({type:Pt,json:{origins:{"web-scene":{write:{layerContainerTypes:mn}}}}})],e.prototype,"visibilityTimeExtent",void 0),l([X("visibilityTimeExtent")],e.prototype,"readTimeExtent",null),l([te(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[Xe,n_]]}})],e.prototype,"writeTimeExtent",null),l([c({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:mn}}},name:"visibility",write:!0}})],e.prototype,"visible",void 0),e=l([$("esri.layers.mixins.OperationalLayer")],e),e};var aN;const LT=new $e({asc:"ascending",desc:"descending"});let Vv=aN=class extends j{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new aN({field:this.field,valueExpression:this.valueExpression,order:this.order})}};l([c({type:String,json:{write:!0}})],Vv.prototype,"field",void 0),l([c({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Vv.prototype,"valueExpression",void 0),l([c({type:LT.apiValues,json:{type:LT.jsonValues,read:LT.read,write:LT.write}})],Vv.prototype,"order",void 0),Vv=aN=l([$("esri.layers.support.OrderByInfo")],Vv);const Iie=Vv;function o2e(t,e,i){if(!t)return null;const r=t.find(s=>!!s.field);if(!r)return null;const n=new Iie;return n.read(r,i),[n]}function a2e(t,e,i,r){const n=t.find(s=>!!s.field);n&&Zr(i,[n.toJSON()],e)}const l2e={type:[Iie],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:o2e},write:{writer:a2e}}},u2e=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return l([c(l2e)],e.prototype,"orderBy",void 0),e=l([$("esri.layers.mixins.OrderedLayer")],e),e},c2e=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=xe(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,r,n){if(r.itemId)return new so({id:r.itemId,portal:n==null?void 0:n.portal})}writePortalItem(i,r){i!=null&&i.id&&(r.itemId=i.id)}async loadFromPortal(i,r){var n;if((n=this.portalItem)!=null&&n.id)try{const{load:s}=await k(()=>import("./layersLoader-DqJx-HNP.js"),__vite__mapDeps([146,10,8,9,7]));return qe(r),await s({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},r)}catch(s){throw rr(s)||U.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${s}`),s}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(r=>(Vo(r),!0)))}async setUserPrivileges(i,r){if(!et.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(r);if(this.url)try{const{features:{edit:n,fullEdit:s},content:{updateItem:o}}=await this._fetchUserPrivileges(i,r);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",s),this._set("userHasUpdateItemPrivileges",o)}catch(n){Vo(n)}}async _fetchUserPrivileges(i,r){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(r);const s=i===n.id;if(s&&n.portal.user)return F6(n);let o,a;if(s)o=n.portal.url;else try{o=await VV(this.url,r)}catch(h){Vo(h)}if(!o||!ime(o,n.portal.url))return this._fetchFallbackUserPrivileges(r);try{const h=r!=null?r.signal:null;a=await(Te==null?void 0:Te.getCredential(`${o}/sharing`,{prompt:!1,signal:h}))}catch(h){Vo(h)}const u=!0,d=!1,p=!1;if(!a)return{features:{edit:u,fullEdit:d},content:{updateItem:p}};try{if(s?await n.reload():(n=new so({id:i,portal:{url:o}}),await n.load(r)),n.portal.user)return F6(n)}catch(h){Vo(h)}return{features:{edit:u,fullEdit:d},content:{updateItem:p}}}async _fetchFallbackUserPrivileges(i){let r=!0;try{r=await this._fetchUserHasEditingPrivileges(i)}catch(n){Vo(n)}return{features:{edit:r,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const r=this.url?Te==null?void 0:Te.findCredential(this.url):null;if(!r)return!0;const n=AT.credential===r?AT.user:await this._fetchEditingUser(i);return AT.credential=r,AT.user=n,(n==null?void 0:n.privileges)==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var p,h;const r=(h=(p=this.portalItem)==null?void 0:p.portal)==null?void 0:h.user;if(r)return r;const n=Te==null?void 0:Te.findServerInfo(this.url??"");if(!(n!=null&&n.owningSystemUrl))return null;const s=`${n.owningSystemUrl}/sharing/rest`,o=ki.getDefault();if(o&&o.loaded&&kn(o.restUrl)===kn(s))return o.user;const a=`${s}/community/self`,u=i!=null?i.signal:null,d=await N$(Ee(a,{authMode:"no-prompt",query:{f:"json"},signal:u}));return d.ok?PV.fromJSON(d.value.data):null}read(i,r){r&&(r.layer=this),super.read(i,r)}write(i,r){var o;const n=r==null?void 0:r.portal,s=((o=this.portalItem)==null?void 0:o.id)&&(this.portalItem.portal||ki.getDefault());return n&&s&&!SJ(s.restUrl,n.restUrl)?(r.messages&&r.messages.push(new L("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...r,layer:this})}};return l([c({type:so})],e.prototype,"portalItem",null),l([X("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),l([te("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),l([c({clonable:!1})],e.prototype,"resourceReferences",void 0),l([c({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),l([c({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),l([c({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=l([$("esri.layers.mixins.PortalLayer")],e),e},AT={credential:null,user:null};let x1=class extends q{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};l([c()],x1.prototype,"updating",void 0),l([c()],x1.prototype,"status",void 0),x1=l([$("esri.layers.support.PublishingInfo")],x1);const d2e=x1,p2e=Symbol(),h2e=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const r=this._get("publishingInfo");if(r)return r;const n=new d2e;return this._checkPublishingStatus(n),n}_checkPublishingStatus(r){let o=0;const a=async d=>{let p;r.updating=!0;try{p=await this.fetchPublishingStatus()}catch{p="unavailable"}p!=="published"&&p!=="unavailable"||(r.status==="publishing"&&this.refresh(),u.remove()),r.status=p,r.updating=!1,u.removed||(o=setTimeout(a,d,d+125))},u={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>u.remove()),a(250),this.addHandles(u)}};return e=p2e,l([c({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=l([$("esri.layers.mixins.PublishableLayer")],i),i},Kh=new Y,$S=new WeakMap;function m2e(t){y2e(t)&&Kh.push(new WeakRef(t))}function f2e(t){const e=Kh.find(i=>i.deref()===t);e&&Kh.remove(e)}function y2e(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function xie(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:xie(e,t%e):0}let fA=0,OT=0;function g2e(){const t=Date.now();let e=!1;for(const i of Kh){const r=i.deref();r?r.refreshInterval&&t-($S.get(r)??0)+5>=6e4*r.refreshInterval&&($S.set(r,t),r.refresh(t)):e=!0}if(e)for(let i=Kh.length-1;i>=0;i--)Kh.at(i).deref()||Kh.removeAt(i)}BZ(()=>{const t=Date.now();let e=0;for(const i of Kh){const r=i.deref();r&&(e=xie(Math.round(6e4*r.refreshInterval),e),r.refreshInterval?$S.get(r)||$S.set(r,t):$S.delete(r))}if(e!==OT){if(OT=e,clearInterval(fA),OT===0)return void(fA=0);fA=setInterval(g2e,OT)}},yn);const D8=.1,v2e=t=>{let e=class extends t{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=Bo(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||m2e(this)},()=>{})}destroy(){f2e(this)}castRefreshInterval(i){return i>=D8?i:i<=0?0:D8}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){zo(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:r})},r=>{U.getLogger(this).error(r),this.emit("refresh",{dataChanged:!1,error:r})})}async hasDataChanged(){return!0}get test(){}};return l([c({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:mn}}}}})],e.prototype,"refreshInterval",void 0),l([We("refreshInterval")],e.prototype,"castRefreshInterval",null),l([c({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),l([c({readOnly:!0})],e.prototype,"refreshParameters",null),e=l([$("esri.layers.mixins.RefreshableLayer")],e),e},Mie=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&b2e(i,r.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return l([c({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),l([c({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),l([c({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=l([$("esri.layers.mixins.ScaleRangeLayer")],e),e};function b2e(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}function V8(t,e){return hp.fromJSON({value:t,unit:e})}let _n=class extends Ze(j){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,i){return i.timeExtent&&Array.isArray(i.timeExtent)&&i.timeExtent.length===2?Pt.fromArray(i.timeExtent):null}writeFullTimeExtent(e,i){(e==null?void 0:e.start)!=null&&e.end!=null?i.timeExtent=e.toArray():i.timeExtent=null}readInterval(e,i){return i.timeInterval&&i.timeIntervalUnits?V8(i.timeInterval,i.timeIntervalUnits):i.defaultTimeInterval&&i.defaultTimeIntervalUnits?V8(i.defaultTimeInterval,i.defaultTimeIntervalUnits):null}writeInterval(e,i){i.timeInterval=(e==null?void 0:e.toJSON().value)??null,i.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};l([c({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],_n.prototype,"cumulative",void 0),l([c({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],_n.prototype,"endField",void 0),l([c({type:Pt,json:{write:{enabled:!0,allowNull:!0}}})],_n.prototype,"fullTimeExtent",void 0),l([X("fullTimeExtent",["timeExtent"])],_n.prototype,"readFullTimeExtent",null),l([te("fullTimeExtent")],_n.prototype,"writeFullTimeExtent",null),l([c({type:Boolean,json:{write:!0}})],_n.prototype,"hasLiveData",void 0),l([c({type:hp,json:{write:{enabled:!0,allowNull:!0}}})],_n.prototype,"interval",void 0),l([X("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],_n.prototype,"readInterval",null),l([te("interval")],_n.prototype,"writeInterval",null),l([c({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],_n.prototype,"startField",void 0),l([c(p2("timeReference",!0))],_n.prototype,"timeZone",void 0),l([c({type:String,json:{write:{enabled:!0,allowNull:!0}}})],_n.prototype,"trackIdField",void 0),l([c({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],_n.prototype,"useTime",void 0),l([c({type:[Date],json:{read:!1}})],_n.prototype,"stops",void 0),_n=l([$("esri.layers.support.TimeInfo")],_n);const Cie=_n,_2e={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:mn}}},w2e=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,r){const n=r.timeInfo.exportOptions;if(!n)return null;const s=n.timeOffset,o=f5.fromJSON(n.timeOffsetUnits);return s&&o?new hp({value:s,unit:o}):null}set timeInfo(i){EQ(i,this.fieldsIndex),this._set("timeInfo",i)}};return l([c({type:Pt,json:{write:!1}})],e.prototype,"timeExtent",void 0),l([c({type:hp})],e.prototype,"timeOffset",void 0),l([X("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),l([c({value:null,type:Cie,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),l([c(_2e)],e.prototype,"useViewTime",void 0),e=l([$("esri.layers.mixins.TemporalLayer")],e),e},U8=new $e({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let uh=class extends Ze(j){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};l([c({json:{write:!0}})],uh.prototype,"name",void 0),l([c({json:{write:!0}})],uh.prototype,"description",void 0),l([c({json:{read:U8.read,write:U8.write}})],uh.prototype,"drawingTool",void 0),l([c({json:{write:!0}})],uh.prototype,"prototype",void 0),l([c({json:{write:!0}})],uh.prototype,"thumbnail",void 0),uh=l([$("esri.layers.support.FeatureTemplate")],uh);const x4=uh;let pd=class extends Ze(j){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const i={};for(const r of Object.keys(e))i[r]=Tk(e[r]);return i}writeDomains(e,i){var n;const r={};for(const s of Object.keys(e))e[s]&&(r[s]=(n=e[s])==null?void 0:n.toJSON());i.domains=r}};l([c({json:{write:!0}})],pd.prototype,"id",void 0),l([c({json:{write:!0}})],pd.prototype,"name",void 0),l([c({json:{write:!0}})],pd.prototype,"domains",void 0),l([X("domains")],pd.prototype,"readDomains",null),l([te("domains")],pd.prototype,"writeDomains",null),l([c({type:[x4],json:{write:!0}})],pd.prototype,"templates",void 0),pd=l([$("esri.layers.support.FeatureType")],pd);const kie=pd;function S2e(){return{fields:{type:[Ik],value:null,set:function(t){if(t&&G("big-integer-warning-enabled")){const e=t.filter(i=>i.type==="big-integer"||i.type==="oid"&&(i.length||0)>=8);if(e.length){const i=e.map(r=>`'${r.name}'`).join(", ");U.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${i}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return jee.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!(t!=null&&t.length))return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const i of t)((e=this.fieldsIndex)==null?void 0:e.has(i))||U.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:t});return og(this.fieldsIndex,t)}}}}const yA=()=>U.getLogger("esri.layers.support.labelingInfo"),$2e=/\[([^[\]]+)\]/gi;function gA(t,e,i){return t?t.map(r=>{var s;const n=new Ck;if(n.read(r,i),n.labelExpression){const o=e.fields||((s=e.layerDefinition)==null?void 0:s.fields)||this.fields;n.labelExpression=n.labelExpression.replaceAll($2e,(a,u)=>`[${E2e(u,o)}]`)}return n}):null}function E2e(t,e){if(!e)return t;const i=t.toLowerCase();for(let r=0;r<e.length;r++){const n=e[r].name;if(n.toLowerCase()===i)return n}return t}const T2e={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function tet(t,e){const i=[];for(const r of t){const n=r.labelPlacement,s=T2e[e];if(!r.symbol)return yA().warn("No ILabelClass symbol specified."),[];if(!s)return yA().error(new L("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(s.includes(n))i.push(r);else{const o=s[0];n&&yA().warn(`Found invalid label placement type ${n} for ${e}. Defaulting to ${o}`);const a=r.clone();a.labelPlacement=o,i.push(a)}}return i}const Uv=[];function I2e(t,e){if(Jte(t.url??""))return!0;const{wkid:i}=e;for(const r of Uv){if((t.version??0)>=r[0])return!0;if(typeof r[1]=="function"&&(r[1]=r[1]()),r[1].has(i))return!1}return!0}Uv.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),Uv.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),Uv.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),Uv.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),Uv.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function x2e(t,e,i){const r=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(r&&r.type==="unique-value"&&r.styleOrigin){const n=await N$(r.populateFromStyle());if(qe(i),n.ok===!1){const s=n.error;e!=null&&e.messages&&e.messages.push(new Jo("renderer:style-reference",`Failed to create unique value renderer from style reference: ${s.message}`,{error:s,context:e})),t.clear("renderer",e==null?void 0:e.origin)}}}function M2e({displayField:t,editFieldsInfo:e,fields:i,objectIdField:r,title:n},s){if(!i)return null;const o=A2e({editFieldsInfo:e,fields:i,objectIdField:r},s);if(!o.length)return null;const a=P2e({titleBase:n,fields:i,displayField:t}),u=R2e();return new ag({title:a,content:u,fieldInfos:o})}function iet(t){var o;const{attributes:e,sourceLayer:i}=t??{},r=i&&"displayField"in i?i.displayField:null,n=r?e==null?void 0:e[r]:null,s=(o=t==null?void 0:t.getObjectId())==null?void 0:o.toString();return n||s||""}const C2e=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):xQ(t,e);function k2e(t,e){const i=t;return e&&(t=t.filter(r=>!e.includes(r.type))),t===i&&(t=t.slice()),t.sort(L2e),t}function L2e(t,e){return t.type==="oid"?-1:e.type==="oid"?1:j8(t)?-1:j8(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function A2e(t,e){const i=e==null?void 0:e.visibleFieldNames;return k2e(t.fields??[],(e==null?void 0:e.ignoreFieldTypes)||F2e).map(r=>new M5({fieldName:r.name,isEditable:o1e(r,t),label:r.alias,format:O2e(r),visible:C2e(r,{...t,visibleFieldNames:i})}))}function O2e(t){switch(t.type){case"small-integer":case"integer":case"single":return new lx({digitSeparator:!0,places:0});case"double":return new lx({digitSeparator:!0,places:2});case"string":return yP(t.name)?new lx({digitSeparator:!0,places:0}):void 0;default:return}}function R2e(){return[new Pb,new Rb]}function P2e(t){const e=$5(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function j8(t){var i;return(t.name&&t.name.toLowerCase())==="name"?!0:((i=t.alias)==null?void 0:i.toLowerCase())==="name"}const F2e=["geometry","blob","raster","guid","xml"],N2e=1/255.5,bn="FeatureLayer";function RT(t,e){return new L("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function G8(t){return t&&t instanceof Y}const vA=S2e();function bA(t,e,i){const r=!!(i!=null&&i.writeLayerSchema);return{enabled:r,ignoreOrigin:r}}let de=class extends CMe(r2e($xe(h2e(mxe(Kte(u2e(w2e(Mie(v2e(VIe(s2e(c2e(nk(dxe(LIe(Ze(u5))))))))))))))))){constructor(...e){super(...e),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=le.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=Bo(async(i,r,n)=>{const{save:s,saveAs:o}=await k(()=>import("./featureLayerUtils-BgwHzo8-.js"),__vite__mapDeps([147,14,15,148,18,19,10]));switch(i){case gc.SAVE:return s(this,r);case gc.SAVE_AS:return o(this,n,r)}})}destroy(){var e;(e=this.source)==null||e.destroy()}normalizeCtorArgs(e,i){return typeof e=="string"?{url:e,...i}:e}load(e){var n;const i=e!=null?e.signal:null;if((n=this.portalItem)!=null&&n.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(i).then(s=>this.initLayerProperties(s))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},e).catch(Vo).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const s=await this._fetchFirstValidLayerId(i);s!=null&&(this.layerId=s)}if(!this.url&&!this._hasMemorySource())throw new L("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(i))}).then(()=>oMe(this,"load",e));return this.addResolvingPromise(r),Promise.resolve(this)}warnInvisibleDrapedSymbols(){var e,i,r;((e=this.elevationInfo)==null?void 0:e.mode)==="on-the-ground"&&((i=this.renderer)==null?void 0:i.type)==="simple"&&((r=this.renderer.symbol)==null?void 0:r.type)==="polygon-3d"&&this.renderer.symbol.symbolLayers.some(n=>n.type==="fill"&&n.material!=null&&(!n.material.color||n.material.color.a*this.opacity<N2e)&&(this.loadWarnings.push(new Jo("feature-layer:invisible-draped-symbols","FeatureLayer has fully transparent symbols which will no longer render or highlight",{layer:this})),!0))}readCapabilities(e,i){return i=i.layerDefinition||i,vie(i,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var e;return!(this.loaded&&!((e=this.capabilities)!=null&&e.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,i){return this._readEditingEnabled(i,!1)}readEditingEnabledFromWebMap(e,i,r){return this._readEditingEnabled(i,!0,r)}writeEditingEnabled(e,i){this._writeEditingEnabled(e,i,!1)}writeEditingEnabledToWebMap(e,i,r,n){this._writeEditingEnabled(e,i,!0,n)}get effectiveEditingEnabled(){return aMe(this)}readIsTable(e,i){return(i=(i==null?void 0:i.layerDefinition)??i).type==="Table"||!i.geometryType}writeIsTable(e,i,r,n){n!=null&&n.writeLayerSchema&&Zr(r,e?"Table":"Feature Layer",i)}readGlobalIdField(e,i){return fie(i.layerDefinition||i)}readObjectIdField(e,i){return yie(i.layerDefinition||i)}get parsedUrl(){const e=nr(this.url);return e!=null&&(this.dynamicDataSource!=null?e.path=gb(e.path,"dynamicLayer"):this.layerId!=null&&(e.path=gb(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){z6(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,i,r){var s;i=i.layerDefinition||i;const n=(s=i.drawingInfo)==null?void 0:s.renderer;if(n){const o=a$(n,i,r)??void 0;return o||U.getLogger(this).error("Failed to create renderer",{rendererDefinition:i.drawingInfo.renderer,layer:this,context:r}),o}return w4(i,r)}set source(e){const i=this._get("source");i!==e&&(G8(i)&&this._resetMemorySource(i),G8(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof Y?new Fd({layer:this,items:e}):e:null}readSource(e,i){const r=Db.fromJSON(i.featureSet);return new Fd({layer:this,items:(r==null?void 0:r.features)??[]})}readTemplates(e,i){const r=i.editFieldsInfo,n=r==null?void 0:r.creatorField,s=r==null?void 0:r.editorField;return e=e==null?void 0:e.map(o=>x4.fromJSON(o)),this._fixTemplates(e,n),this._fixTemplates(e,s),e}readTitle(e,i){var s,o,a;const r=((s=i.layerDefinition)==null?void 0:s.name)??i.name,n=i.title||((o=i.layerDefinition)==null?void 0:o.title);if(r){const u=(a=this.portalItem)==null?void 0:a.title;if(this.sublayerTitleMode==="item-title")return this.url?PIe(this.url,r):r;let d=r;if(!d&&this.url){const p=du(this.url);p!=null&&(d=p.title)}return d?(this.sublayerTitleMode==="item-title-and-service-name"&&u&&u!==d&&(d=u+" - "+d),p4(d)):void 0}if(this.sublayerTitleMode==="item-title"&&n)return n}readTitleFromWebMap(e,i){var r;return i.title||((r=i.layerDefinition)==null?void 0:r.name)}readTypeIdField(e,i){let r=(i=i.layerDefinition||i).typeIdField;if(r&&i.fields){r=r.toLowerCase();const n=i.fields.find(s=>s.name.toLowerCase()===r);n&&(r=n.name)}return r}readTypes(e,i){e=(i=i.layerDefinition||i).types;const r=i.editFieldsInfo,n=r==null?void 0:r.creatorField,s=r==null?void 0:r.editorField;return e==null?void 0:e.map(o=>(o=kie.fromJSON(o),this._fixTemplates(o.templates,n),this._fixTemplates(o.templates,s),o))}readVisible(e,i){var r;return((r=i.layerDefinition)==null?void 0:r.defaultVisibility)!=null?!!i.layerDefinition.defaultVisibility:i.visibility!=null?!!i.visibility:void 0}async addAttachment(e,i){return Gxe(this,e,i,bn)}async updateAttachment(e,i,r){return zxe(this,e,i,r,bn)}async applyEdits(e,i){return Bxe(this,e,i)}async uploadAssets(e,i){return Hxe(this,e,i)}on(e,i){return super.on(e,i)}createPopupTemplate(e){return M2e(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:i}=await Xa(k(()=>import("./FeatureLayerSource-BDTcG7cw.js"),__vite__mapDeps([149,63,65,150,151,152,153,48,46,49,154,155,72,70,71,26,25,27,156,24])),e);return new i({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:e})}createQuery(){const e=tMe(this);e.dynamicDataSource=this.dynamicDataSource;const i=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=_5(this.definitionExpression,i);return e.where=r||"1=1",e}async deleteAttachments(e,i){return qxe(this,e,i,bn)}async fetchRecomputedExtents(e){return Wxe(this,e,bn)}getFeatureType(e){return cMe(this.types,this.typeIdField,e)}getFieldDomain(e,i){var o;if(i!=null&&i.includeImpliedDomains){const a=nMe(this,e);if(a)return a}const r=i==null?void 0:i.feature,n=rMe(this,r);if(n){const a=(o=n.domains)==null?void 0:o[e];return(a==null?void 0:a.type)==="inherited"?this._getLayerDomain(e):a}const s=this.getFeatureType(r);if(s){const a=s.domains&&s.domains[e];if(a&&a.type!=="inherited")return a}return this._getLayerDomain(e)}getField(e){return this.fieldsIndex.get(e)}async queryAttachments(e,i){return Zxe(this,e,i,bn)}async queryFeatures(e,i){const r=await this.load(),n=await r.source.queryFeatures(gu.from(e)??r.createQuery(),i);if(n!=null&&n.features)for(const s of n.features)s.layer=s.sourceLayer=r;return n}async queryObjectIds(e,i){return Jxe(this,e,i,bn)}async queryFeatureCount(e,i){return Yxe(this,e,i,bn)}async queryExtent(e,i){return Kxe(this,e,i,bn)}async queryRelatedFeatures(e,i){return Xxe(this,e,i,bn)}async queryRelatedFeaturesCount(e,i){return Qxe(this,e,i,bn)}async queryTopFeatures(e,i){var a;const{source:r,capabilities:n}=await this.load();if(!r.queryTopFeatures||!((a=n==null?void 0:n.query)!=null&&a.supportsTopFeaturesQuery))throw new L(bn,"Layer source does not support queryTopFeatures capability");const s=await k(()=>import("./TopFeaturesQuery-B_oCSDEc.js"),[]),o=await r.queryTopFeatures(s.default.from(e),i);if(o!=null&&o.features)for(const u of o.features)u.layer=u.sourceLayer=this;return o}async queryBins(e,i){var a;const{source:r,capabilities:n}=await this.load();if(!r.queryBins||!((a=n==null?void 0:n.operations)!=null&&a.supportsQueryBins))throw new L(bn,"Layer source does not support queryBins capability");pMe(e,n,bn);const s=await k(()=>import("./BinsQuery-BQg-EC0B.js"),__vite__mapDeps([157,41,29])),o=await r.queryBins(s.default.from(e),i);if(o.features)for(const u of o.features)u.layer=u.sourceLayer=this;return o}async queryTopObjectIds(e,i){const{source:r,capabilities:n}=await this.load();if(!r.queryTopObjectIds||!(n!=null&&n.query.supportsTopFeaturesQuery))throw new L(bn,"Layer source does not support queryTopObjectIds capability");const s=await k(()=>import("./TopFeaturesQuery-B_oCSDEc.js"),[]);return r.queryTopObjectIds(s.default.from(e),i)}async queryTopFeaturesExtent(e,i){var o;const{source:r,capabilities:n}=await this.load();if(!r.queryTopExtents||!((o=n==null?void 0:n.query)!=null&&o.supportsTopFeaturesQuery))throw new L(bn,"Layer source does not support queryTopExtents capability");const s=await k(()=>import("./TopFeaturesQuery-B_oCSDEc.js"),[]);return r.queryTopExtents(s.default.from(e),i)}async queryTopFeatureCount(e,i){var o;const{source:r,capabilities:n}=await this.load();if(!r.queryTopCount||!((o=n==null?void 0:n.query)!=null&&o.supportsTopFeaturesQuery))throw new L(bn,"Layer source does not support queryFeatureCount capability");const s=await k(()=>import("./TopFeaturesQuery-B_oCSDEc.js"),[]);return r.queryTopCount(s.default.from(e),i)}read(e,i){const r=e.featureCollection;if((r||e.type==="Feature Collection")&&(this.resourceInfo=e),r){const n=r.layers;n&&n.length===1&&(super.read(n[0],i),r.showLegend!=null&&super.read({showLegend:r.showLegend},i))}super.read(e,i),i&&i.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(e,i){i={...i,origin:(i==null?void 0:i.origin)??void 0,writeLayerSchema:(i==null?void 0:i.writeLayerSchema)??this._hasMemorySource()};const{origin:r,layerContainerType:n,messages:s}=i;if(this.dynamicDataSource)return s==null||s.push(RT(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&n!=="tables")return s==null||s.push(RT(this,`a table source can only be written to tables, not ${n}`)),null;if(this._hasMemorySource())return s==null||s.push(RT(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&n==="tables")return s==null||s.push(RT(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(e,i)}clone(){if(this._hasMemorySource())throw new L(bn,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){var i;return!!this.loaded&&(((i=this.source)==null?void 0:i.type)==="memory"||I2e(this,e))}async save(e){return this._debouncedSaveOperations(gc.SAVE,e)}async saveAs(e,i){return this._debouncedSaveOperations(gc.SAVE_AS,i,e)}_readEditingEnabled(e,i,r){var s;let n=(s=e.layerDefinition)==null?void 0:s.capabilities;return n?this._hasEditingCapability(n):(n=e.capabilities,i&&(r==null?void 0:r.origin)==="web-map"&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(i=>i.trim()).includes("editing")}_writeEditingEnabled(e,i,r,n){var s,o;if(!e){const a=(o=(s=this.capabilities)==null?void 0:s.operations)!=null&&o.supportsSync?"Query,Sync":"Query";Zr("layerDefinition.capabilities",a,i),r&&!(n!=null&&n.writeLayerSchema)&&(i.capabilities=a)}}_getLayerDomain(e){const i=this.fieldsIndex.get(e);return i?i.domain:null}_fetchFirstValidLayerId(e){return Ee(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(i=>{const r=i.data;if(r)return this.findFirstValidLayerId(r)})}async initLayerProperties(e){var i;return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(i=this.portalItem)==null?void 0:i.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),z6(this.renderer,this.fieldsIndex),EQ(this.timeInfo,this.fieldsIndex),x2e(this,{origin:"service"})}async hasDataChanged(){return eMe(this)}async fetchPublishingStatus(){const e=this.source;return e!=null&&e.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}_verifyFields(){var i,r;const e=((i=this.parsedUrl)==null?void 0:i.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||(r=this.fields)!=null&&r.some(n=>n.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,i){e&&e.forEach(r=>{var s;const n=(s=r.prototype)==null?void 0:s.attributes;n&&i&&delete n[i]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new L("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new L("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(i=>{i.layer=this,i.sourceLayer=this}),this.addHandles([e.on("after-add",i=>{i.item.layer=this,i.item.sourceLayer=this}),e.on("after-remove",i=>{i.item.layer=null,i.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(i=>{i.layer=null,i.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(e){return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}};l([c(Dxe)],de.prototype,"attributeTableTemplate",void 0),l([X("service","capabilities")],de.prototype,"readCapabilities",null),l([c({json:{origins:{"web-scene":{write:!1}},write:!0}})],de.prototype,"charts",void 0),l([c({readOnly:!0})],de.prototype,"createQueryVersion",null),l([c({json:{read:{source:"layerDefinition.copyrightText"}}})],de.prototype,"copyright",void 0),l([c({json:{read:{source:"layerDefinition.displayField"}}})],de.prototype,"displayField",void 0),l([c({types:Ha,readOnly:!0})],de.prototype,"defaultSymbol",void 0),l([c({type:Kl})],de.prototype,"dynamicDataSource",void 0),l([c({type:Boolean})],de.prototype,"editingEnabled",null),l([X(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],de.prototype,"readEditingEnabled",null),l([X("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],de.prototype,"readEditingEnabledFromWebMap",null),l([te(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],de.prototype,"writeEditingEnabled",null),l([te("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],de.prototype,"writeEditingEnabledToWebMap",null),l([c({readOnly:!0})],de.prototype,"effectiveEditingEnabled",null),l([c({...vA.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:bA}}}}})],de.prototype,"fields",void 0),l([c(vA.fieldsIndex)],de.prototype,"fieldsIndex",void 0),l([c({type:Vte,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],de.prototype,"formTemplate",void 0),l([c({json:{read:{source:"layerDefinition.extent"}}})],de.prototype,"fullExtent",void 0),l([c({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:bA,writer(t,e,i){const r=t?KF.toJSON(t):null;r&&Zr(i,r,e)}}}},read:{source:"layerDefinition.geometryType",reader:KF.read}}})],de.prototype,"geometryType",void 0),l([c({json:{read:{source:"layerDefinition.hasM"}}})],de.prototype,"hasM",void 0),l([c({json:{read:{source:"layerDefinition.hasZ"}}})],de.prototype,"hasZ",void 0),l([c(Pxe)],de.prototype,"id",void 0),l([c({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],de.prototype,"infoFor3D",void 0),l([c({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],de.prototype,"isTable",void 0),l([X("service","isTable",["type","geometryType"]),X("isTable",["layerDefinition.type","layerDefinition.geometryType"])],de.prototype,"readIsTable",null),l([te("web-map","isTable")],de.prototype,"writeIsTable",null),l([c(b4)],de.prototype,"labelsVisible",void 0),l([c({type:[Ck],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:gA,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:gA,write:{enabled:!0,layerContainerTypes:mn}}},name:"layerDefinition.drawingInfo.labelingInfo",read:gA,write:!0}})],de.prototype,"labelingInfo",void 0),l([c((()=>{const t=R(Rxe);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,i,r){Zr(r,WC(e),i)}}},t})())],de.prototype,"opacity",void 0),l([c(Axe)],de.prototype,"legendEnabled",void 0),l([c({type:["show","hide"],json:(()=>{const t=R(pie.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],de.prototype,"listMode",void 0),l([X("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],de.prototype,"readGlobalIdField",null),l([c({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:bA}}}}})],de.prototype,"objectIdField",void 0),l([X("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],de.prototype,"readObjectIdField",null),l([c({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],de.prototype,"operationalLayerType",void 0),l([c(vA.outFields)],de.prototype,"outFields",void 0),l([c({readOnly:!0})],de.prototype,"parsedUrl",null),l([c({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],de.prototype,"path",void 0),l([c(v4)],de.prototype,"popupEnabled",void 0),l([c({type:ag,json:{name:"popupInfo",write:!0}})],de.prototype,"popupTemplate",void 0),l([c({readOnly:!0})],de.prototype,"defaultPopupTemplate",null),l([c({types:Sk,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:xTe,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:mn,overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}})],de.prototype,"renderer",null),l([X("service","renderer",["drawingInfo.renderer","defaultSymbol"]),X("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],de.prototype,"readRenderer",null),l([c()],de.prototype,"resourceInfo",void 0),l([c((()=>{const t=R(kxe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],de.prototype,"screenSizePerspectiveEnabled",void 0),l([c({clonable:!1})],de.prototype,"source",null),l([We("source")],de.prototype,"castSource",null),l([X("portal-item","source",["featureSet"]),X("web-map","source",["featureSet"])],de.prototype,"readSource",null),l([c({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],de.prototype,"spatialReference",void 0),l([c({type:Number})],de.prototype,"subtypeCode",void 0),l([c({type:[x4]})],de.prototype,"templates",void 0),l([X("templates",["editFieldsInfo","creatorField","editorField","templates"])],de.prototype,"readTemplates",null),l([c({type:Cie})],de.prototype,"timeInfo",void 0),l([c()],de.prototype,"title",void 0),l([X("service","title",["name"]),X("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],de.prototype,"readTitle",null),l([X("web-map","title",["layerDefinition.name","title"])],de.prototype,"readTitleFromWebMap",null),l([c({type:String})],de.prototype,"sublayerTitleMode",void 0),l([c({json:{read:!1}})],de.prototype,"type",void 0),l([c({type:String})],de.prototype,"typeIdField",void 0),l([X("service","typeIdField"),X("typeIdField",["layerDefinition.typeIdField"])],de.prototype,"readTypeIdField",null),l([c({type:[kie]})],de.prototype,"types",void 0),l([X("service","types",["types"]),X("types",["layerDefinition.types"])],de.prototype,"readTypes",null),l([c({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],de.prototype,"visible",void 0),l([X("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],de.prototype,"readVisible",null),de=l([$("esri.layers.FeatureLayer")],de);const M4=de,D2e=Object.freeze(Object.defineProperty({__proto__:null,default:M4},Symbol.toStringTag,{value:"Module"}));let zu=class extends j{constructor(e){super(e),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};l([c({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.moment=t?t.getTime():null}}}})],zu.prototype,"moment",void 0),l([c({type:Boolean,json:{write:!0}})],zu.prototype,"fullUpdate",void 0),l([c({type:Boolean,json:{write:!0}})],zu.prototype,"validateErrorsCreated",void 0),l([c({type:Number,json:{write:!0}})],zu.prototype,"dirtyAreaCount",void 0),l([c({type:Boolean,json:{write:!0}})],zu.prototype,"exceededTransferLimit",void 0),l([c({type:[Object],json:{write:!0}})],zu.prototype,"serviceEdits",void 0),l([c({type:[Object],json:{write:!0}})],zu.prototype,"discoveredSubnetworks",void 0),zu=l([$("esri.rest.networks.support.ValidateNetworkTopologyResult")],zu);const V2e=zu,U2e=Me()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let ch=class extends V2e{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:r}=await Ee(this.statusUrl,i);return this.read(r),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:r}=e;return new Promise((n,s)=>{this._clearTimer();const o=setInterval(()=>{this._timer||s(mt()),this.checkJobStatus().then(a=>{const{status:u}=a;switch(this.status=u,u){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":r&&r(this)}},a=>{this._clearTimer(),s(a)})},i);this._timer=o})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};l([c()],ch.prototype,"editsResolver",void 0),l([c({type:String,json:{write:!0}})],ch.prototype,"statusUrl",void 0),l([oe(U2e)],ch.prototype,"status",void 0),l([c({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],ch.prototype,"submissionTime",void 0),l([c({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],ch.prototype,"lastUpdatedTime",void 0),ch=l([$("esri.networks.support.TopologyValidationJobInfo")],ch);const j2e=ch;async function z8(t,e){if(t==="Utility Network Layer"){const{default:i}=await k(()=>Promise.resolve().then(()=>rCe),void 0);return new i({layerUrl:e})}return null}async function G2e(t){var o;let e="portalItem"in t?t:{portalItem:t};!e.portalItem||e.portalItem instanceof so||(e={...e,portalItem:new so(e.portalItem)});const i=e.portalItem;if(await i.load(),i.type!=="Feature Service")throw new L("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const r=i.url,n=await Ee(r,{responseType:"json",query:{f:"json"}}),s="Network Layer";if((o=n.data.type)!=null&&o.includes(s))return z8(n.data.type,r);if(n.data.layers){const a=n.data.layers.find(u=>u.type.includes(s));if(a){const u=`${r}/${a.id}`;return z8(a.type,u)}}return null}let ar=class extends nk(uo){static fromPortalItem(e){return G2e(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=i=>{const{serviceUrl:r,gdbVersion:n,result:s}=i,o=r===this.featureServiceUrl,a=wS(r,n,this.gdbVersion);o&&a&&s.then(u=>{zx(r,n)&&(this.historicMoment=u.historicMoment)})},this._updateMomentHandler=i=>{const{serviceUrl:r,gdbVersion:n,moment:s}=i,o=r===this.featureServiceUrl,a=wS(r,n,this.gdbVersion);o&&a&&(this.historicMoment=s)},this.when().then(()=>{this.addHandles([eie(this._applyEditsHandler),tie(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{rr(e)||U.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get datasetName(){var e;return((e=this.dataElement)==null?void 0:e.name)??null}get owner(){var e;return((e=this.dataElement)==null?void 0:e.userIdentity)??null}get schemaGeneration(){var e;return((e=this.dataElement)==null?void 0:e.schemaGeneration)??null}get parsedUrl(){return nr(this.layerUrl)}get featureServiceUrl(){return du(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return du(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(!this.dataElement)return null;const i=this._layerIdBySourceId.get(e);if(i!=null)return i;const r=this.dataElement.domainNetworks,n=this._traverseNetworkSources(r,this._layerIdBySourceId,"sourceId","layerId",e);return n>=0?n:null}getSourceIdByLayerId(e){if(!this.dataElement)return null;const i=this._sourceIdByLayerId.get(e);if(i!=null)return i;const r=this.dataElement.domainNetworks,n=this._traverseNetworkSources(r,this._sourceIdByLayerId,"layerId","sourceId",e);return n>=0?n:null}getObjectIdsFromElements(e){const i=[],r=new Map;for(const s of e){const o=this.getLayerIdBySourceId(s.networkSourceId);if(o==null)continue;let a=r.get(o);a===void 0&&(a=[]),a.push(s.objectId),r.set(o,a)}const n=this.featureServiceUrl;return r.forEach((s,o)=>i.push({layerUrl:`${n}/${o}`,objectIds:s})),i}async queryNamedTraceConfigurations(e,i){var a;const[{queryNamedTraceConfigurations:r},{default:n}]=await Promise.all([k(()=>import("./queryNamedTraceConfigurations-jyKWXa4C.js"),[]),k(()=>import("./QueryNamedTraceConfigurationsParameters-Cd2Szz2v.js"),[])]),s=this.networkServiceUrl,o=n.from(e);return(a=await r(s,o,{...i}))==null?void 0:a.namedTraceConfigurations}async validateTopology(e,i){var p,h,m;if(!e.validateArea)throw new L("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:r},{default:n}]=await Promise.all([k(()=>import("./validateNetworkTopology-XrE8GaZu.js"),[]),k(()=>import("./ValidateNetworkTopologyParameters-B-RBKNyd.js"),[])]),s=n.from(e);zx(this.featureServiceUrl,this.gdbVersion||null)?(s.sessionID=MF,await p8(this.featureServiceUrl,this.gdbVersion,!0)):s.sessionID=null,s.gdbVersion=this.gdbVersion;const o=this.networkServiceUrl,a=this.featureServiceUrl,u=h8(a,null,this.gdbVersion,!0),d=await r(o,s,{...i});if(d!=null&&d.serviceEdits){const y=[];for(const g of d.serviceEdits){const{editedFeatures:v}=g,_=v!=null&&v.spatialReference?new le(v.spatialReference):null;y.push({layerId:g.layerId,editedFeatures:{adds:((p=v==null?void 0:v.adds)==null?void 0:p.map(w=>PT(w,_)))||[],updates:((h=v==null?void 0:v.updates)==null?void 0:h.map(w=>({original:PT(w[0],_),current:PT(w[1],_)})))||[],deletes:((m=v==null?void 0:v.deletes)==null?void 0:m.map(w=>PT(w,_)))||[],spatialReference:_}})}u.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:y,exceededTransferLimit:!1,historicMoment:d.moment})}return d}async submitTopologyValidationJob(e,i){let r=null;if(!e.validateArea)throw new L("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const p=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await Ee(p,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:n},{default:s}]=await Promise.all([k(()=>import("./validateNetworkTopology-XrE8GaZu.js"),[]),k(()=>import("./ValidateNetworkTopologyParameters-B-RBKNyd.js"),[])]),o=s.from(e);zx(this.featureServiceUrl,this.gdbVersion||null)?(o.sessionID=MF,await p8(this.featureServiceUrl,this.gdbVersion,!0)):o.sessionID=null,o.gdbVersion=this.gdbVersion||r;const a=this.networkServiceUrl,u=this.featureServiceUrl?h8(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,d=await n(a,o,{...i});return new j2e({statusUrl:d,editsResolver:u})}_traverseNetworkSources(e,i,r,n,s){for(const o of e)for(const a of[o.edgeSources??[],o.junctionSources??[]])for(const u of a)if(u[r]===s)return i.set(s,u[n]),u[n];return-1}async _fetchLayerMetaData(e,i){const r=await Ee(e,{responseType:"json",query:{f:"json"},...i});this.sourceJSON=r.data,this.read(r.data,{origin:"service"})}async _fetchDataElement(e,i,r){if(this.dataElement)return;const n=await Ee(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([i]),f:"json"},...r}).then(s=>{var o;return(o=s.data.layerDataElements)==null?void 0:o[0]});n&&this.read(n,{origin:"service"})}};function PT(t,e){return new Li({attributes:t.attributes,geometry:dp({...t.geometry,spatialReference:e})})}l([c({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],ar.prototype,"id",void 0),l([c({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],ar.prototype,"title",void 0),l([c({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],ar.prototype,"layerUrl",void 0),l([c({type:Object,json:{origins:{service:{read:!0}},read:!1}})],ar.prototype,"dataElement",void 0),l([c({type:at,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],ar.prototype,"fullExtent",void 0),l([c({type:le,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],ar.prototype,"spatialReference",void 0),l([c({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],ar.prototype,"type",void 0),l([c({readOnly:!0})],ar.prototype,"datasetName",null),l([c({readOnly:!0})],ar.prototype,"owner",null),l([c({readOnly:!0})],ar.prototype,"schemaGeneration",null),l([c({readOnly:!0})],ar.prototype,"parsedUrl",null),l([c({readOnly:!0})],ar.prototype,"featureServiceUrl",null),l([c({readOnly:!0})],ar.prototype,"networkServiceUrl",null),l([c({readOnly:!0})],ar.prototype,"layerId",null),l([c()],ar.prototype,"sourceJSON",void 0),l([c({readOnly:!0})],ar.prototype,"networkSystemLayers",null),l([c()],ar.prototype,"gdbVersion",void 0),l([c({type:Date})],ar.prototype,"historicMoment",void 0),ar=l([$("esri.networks.Network")],ar);const z2e=ar;var zd;(function(t){t[t.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",t[t.RTAttachment=2]="RTAttachment",t[t.RTContainment=3]="RTContainment",t[t.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",t[t.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(zd||(zd={}));const FT=new $e({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),aet=new $e({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),B2e={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},uet=Array.from({length:33},(t,e)=>2*e),cet=new Map([[1,"connectivity"],[2,"containment"],[3,"attachment"],[4,"junction-edge-from-connectivity"],[5,"junction-midspan-connectivity"],[6,"junction-edge-to-connectivity"]]),det=new $e({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let dh=class extends ig(uo){constructor(e){super(e),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=Ee}initialize(){}async load(e){const i=this.layer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(i),this}getFeatureSQL(e,i){var d,p;const r=e.layerId.toString(),n=(d=e.fieldsIndex)==null?void 0:d.normalizeFieldName("assetGroup"),s=(p=e.fieldsIndex)==null?void 0:p.normalizeFieldName("assetType"),o=n?i.attributes[n]:null,a=s?i.attributes[s]:null,u=this.rulesHash[r];if(u){const h=u.assetGroupHash[o];if(h)return h.assetTypeHash[a]||null}return null}async _initializeRulesTable(){var n,s,o,a,u,d,p,h,m,y,g;const e={};let i;(function(v){v[v.from=0]="from",v[v.to=1]="to",v[v.via=2]="via"})(i||(i={}));const r=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const v of this.rules){if(v.ruleType===zd.RTAttachment){this.rulesCategorized.attachment.push(v);continue}if(v.ruleType===zd.RTContainment){this.rulesCategorized.containment.push(v);continue}if(v.ruleType===zd.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(v);continue}this.rulesCategorized.connectivity.push(v);let _=[[i.from,i.to],[i.to,i.from]];v.ruleType===zd.RTEdgeJunctionEdgeConnectivity&&(_=[[i.from,i.via],[i.via,i.from],[i.to,i.via],[i.via,i.to]]);for(const w of _){const S=w.shift(),E=w.shift();let T=!1;switch(v.ruleType){case zd.RTEdgeJunctionEdgeConnectivity:T=S===i.from||S===i.to;break;case zd.RTJunctionEdgeConnectivity:T=S===i.to}const M=r[S],x=((n=v[M.networkSourceId])==null?void 0:n.layerId.toString())??"",C=(o=(s=v[M.assetGroupId])==null?void 0:s.assetGroupCode)==null?void 0:o.toString(),O=v[M.assetTypeId],F=(a=O==null?void 0:O.assetTypeCode)==null?void 0:a.toString(),V=r[E],z=((u=v[V.networkSourceId])==null?void 0:u.layerId.toString())??"",H=(p=(d=v[V.assetGroupId])==null?void 0:d.assetGroupCode)==null?void 0:p.toString(),Q=v[V.assetTypeId],J=(h=Q==null?void 0:Q.assetTypeCode)==null?void 0:h.toString(),ne=e[x]??{assetGroupHash:{}};if(!(C&&F&&H&&J))continue;const Pe=ne.assetGroupHash[C]??{assetTypeHash:{}},_e=Pe.assetTypeHash[F]??{};if(_e[z]=_e[z]??{},T){_e[x]=_e[x]??{};const it=`(assetgroup = ${C} AND assettype = ${F})`;(Q==null?void 0:Q.connectivityPolicy)==="esriNECPEndVertex"?_e[x].endVertex=(m=_e[x])!=null&&m.endVertex?`${_e[x].endVertex}`:`${it}`:_e[x].anyVertex=_e[x].anyVertex?`${_e[x].anyVertex}`:`${it}`}const ue=`(assetgroup = ${H} AND assettype = ${J})`;(Q==null?void 0:Q.connectivityPolicy)==="esriNECPEndVertex"?_e[z].endVertex=(y=_e[z])!=null&&y.endVertex?`${_e[z].endVertex} OR ${ue}`:`${ue}`:_e[z].anyVertex=(g=_e[z])!=null&&g.anyVertex?`${_e[z].anyVertex} OR ${ue}`:`${ue}`,Pe.assetTypeHash[F]=_e,ne.assetGroupHash[C]=Pe,e[x]=ne}}this.rulesHash=e}};l([c({constructOnly:!0})],dh.prototype,"layer",void 0),l([c({constructOnly:!0})],dh.prototype,"rules",void 0),l([c()],dh.prototype,"rulesHash",void 0),l([c()],dh.prototype,"rulesCategorized",void 0),l([c({constructOnly:!0})],dh.prototype,"request",void 0),dh=l([$("esri.networks.RulesTable")],dh);const H2e=dh;let ya=class extends j{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};l([c({type:[Object],json:{write:!0}})],ya.prototype,"conditionBarriers",void 0),l([c({type:[Object],json:{write:!0}})],ya.prototype,"outputConditions",void 0),l([c({type:[Object],json:{write:!0}})],ya.prototype,"functions",void 0),l([c({type:[Object],json:{write:!0}})],ya.prototype,"functionBarriers",void 0),l([c({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],ya.prototype,"traversabilityScope",void 0),l([c({type:String,json:{write:!0}})],ya.prototype,"shortestPathNetworkAttributeName",void 0),l([c({type:Boolean,json:{write:!0}})],ya.prototype,"includeBarriers",void 0),l([c({type:Boolean,json:{write:!0}})],ya.prototype,"validateConsistency",void 0),l([c({type:Boolean,json:{write:!0}})],ya.prototype,"ignoreBarriersAtStartingPoints",void 0),ya=l([$("esri.networks.support.TraceConfiguration")],ya);const C4=ya;let Pi=class extends C4{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};l([c({type:[Object],json:{write:!0}})],Pi.prototype,"filterBarriers",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"arcadeExpressionBarrier",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"domainNetworkName",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"filterBitsetNetworkAttributeName",void 0),l([c({type:[Object],json:{write:!0}})],Pi.prototype,"filterFunctionBarriers",void 0),l([c({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],Pi.prototype,"filterScope",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"includeContainers",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"includeContent",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"includeIsolated",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"includeStructures",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"allowIndeterminateFlow",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"includeUpToFirstSpatialContainer",void 0),l([c({type:Object,json:{write:!0}})],Pi.prototype,"nearestNeighbor",void 0),l([c({type:[Object],json:{write:!0}})],Pi.prototype,"outputFilterCategories",void 0),l([c({type:[Object],json:{write:!0}})],Pi.prototype,"outputFilters",void 0),l([c({type:[Object],json:{write:!0}})],Pi.prototype,"propagators",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"subnetworkName",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"targetTierName",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"diagramTemplateName",void 0),l([c({type:String,json:{write:!0}})],Pi.prototype,"tierName",void 0),l([c({type:Boolean,json:{write:!0}})],Pi.prototype,"validateLocatability",void 0),Pi=l([$("esri.networks.support.UNTraceConfiguration")],Pi);const q2e=Pi;let Hs=class extends qR{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,i){return e.tierName!==void 0?q2e.fromJSON(e):C4.fromJSON(e)}};l([c({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Hs.prototype,"globalId",void 0),l([c({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Hs.prototype,"title",void 0),l([c({type:C4,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"traceConfiguration",void 0),l([X("service","traceConfiguration")],Hs.prototype,"readTraceConfiguration",null),l([c({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"creationDate",void 0),l([c({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"creator",void 0),l([c({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"description",void 0),l([c({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Hs.prototype,"minStartingPoints",void 0),l([c({json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"resultTypes",void 0),l([c({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Hs.prototype,"tags",void 0),l([c({type:FT.apiValues,json:{type:FT.jsonValues,origins:{service:{read:FT.read,write:FT.write}},read:!1}})],Hs.prototype,"traceType",void 0),Hs=l([$("esri.networks.support.NamedTraceConfiguration")],Hs);const W2e=Hs;let Ol=class extends q{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};l([c({constructOnly:!0})],Ol.prototype,"rulesTableId",void 0),l([c({constructOnly:!0})],Ol.prototype,"rulesTableUrl",void 0),l([c({constructOnly:!0})],Ol.prototype,"subnetworksTableId",void 0),l([c({constructOnly:!0})],Ol.prototype,"subnetworksTableUrl",void 0),l([c({constructOnly:!0})],Ol.prototype,"dirtyAreasLayerId",void 0),l([c({constructOnly:!0})],Ol.prototype,"dirtyAreasLayerUrl",void 0),l([c({constructOnly:!0})],Ol.prototype,"associationsTableId",void 0),l([c({constructOnly:!0})],Ol.prototype,"associationsTableUrl",void 0),Ol=l([$("esri.networks.support.NetworkSystemLayers")],Ol);const Z2e=Ol;let jv=class extends j{constructor(e){super(e),this.id=null,this.name=null}};l([c({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],jv.prototype,"id",void 0),l([c({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],jv.prototype,"name",void 0),l([c({type:Boolean,json:{write:!0}})],jv.prototype,"isUpstreamTerminal",void 0),jv=l([$("esri.networks.support.Terminal")],jv);const J2e=jv,NT=new $e({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let ph=class extends j{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};l([c({type:String,json:{write:!0}})],ph.prototype,"defaultConfiguration",void 0),l([c({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],ph.prototype,"id",void 0),l([c({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],ph.prototype,"name",void 0),l([c({type:[J2e],json:{write:!0}})],ph.prototype,"terminals",void 0),l([c({type:NT.apiValues,json:{type:NT.jsonValues,read:NT.read,write:NT.write}})],ph.prototype,"traversabilityModel",void 0),ph=l([$("esri.networks.support.TerminalConfiguration")],ph);const B8=ph;let Gv=class extends j{constructor(e){super(e),this.line=null,this.multipoint=null,this.polygon=null}};l([c({type:hn,json:{write:!0},readOnly:!0})],Gv.prototype,"line",void 0),l([c({type:ep,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],Gv.prototype,"multipoint",void 0),l([c({type:os,json:{write:!0},readOnly:!0})],Gv.prototype,"polygon",void 0),Gv=l([$("esri.rest.networks.support.AggregatedGeometry")],Gv);const Y2e=Gv;let zv=class extends j{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};l([c({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],zv.prototype,"functionType",void 0),l([c({type:String,json:{write:!0},readOnly:!0})],zv.prototype,"networkAttributeName",void 0),l([c({type:Number,json:{write:!0},readOnly:!0})],zv.prototype,"result",void 0),zv=l([$("esri.rest.networks.support.FunctionResult")],zv);const K2e=zv;let Rl=class extends j{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};l([c({type:Number,json:{write:!0}})],Rl.prototype,"assetGroupCode",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"assetTypeCode",void 0),l([c({type:String,json:{write:!0}})],Rl.prototype,"globalId",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"networkSourceId",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"objectId",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"positionFrom",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"positionTo",void 0),l([c({type:Number,json:{write:!0}})],Rl.prototype,"terminalId",void 0),Rl=l([$("esri.rest.networks.support.NetworkElement")],Rl);const X2e=Rl;let hd=class extends j{constructor(e){super(e),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};l([c({type:Y2e,json:{write:!0},readOnly:!0})],hd.prototype,"aggregatedGeometry",void 0),l([c({type:[X2e],json:{write:!0},readOnly:!0})],hd.prototype,"elements",void 0),l([c({type:[K2e],json:{write:!0},readOnly:!0})],hd.prototype,"globalFunctionResults",void 0),l([c({type:Boolean,json:{write:!0},readOnly:!0})],hd.prototype,"kFeaturesForKNNFound",void 0),l([c({type:Boolean,json:{write:!0},readOnly:!0})],hd.prototype,"startingPointsIgnored",void 0),l([c({type:[String],json:{write:!0},readOnly:!0})],hd.prototype,"warnings",void 0),hd=l([$("esri.rest.networks.support.TraceResult")],hd);const Q2e=hd,eCe=Me()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let Of=class extends Q2e{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:r}=await Ee(this.statusUrl,i),n=r.traceResults?{...r.traceResults,...r}:r;return this.read(n),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:r}=e;return new Promise((n,s)=>{this._clearTimer();const o=setInterval(()=>{this._timer||s(mt()),this.checkJobStatus().then(a=>{const{status:u}=a;switch(this.status=u,u){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":r&&r(this)}},a=>{this._clearTimer(),s(a)})},i);this._timer=o})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};l([c({type:String,json:{write:!0}})],Of.prototype,"statusUrl",void 0),l([oe(eCe)],Of.prototype,"status",void 0),l([c({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],Of.prototype,"submissionTime",void 0),l([c({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],Of.prototype,"lastUpdatedTime",void 0),Of=l([$("esri.networks.support.TraceJobInfo")],Of);const tCe=Of;let md=class extends z2e{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility",this._terminalById=new Map}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,i,r,n,s,o,a,u;return new Z2e({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(i=this.sourceJSON)==null?void 0:i.systemLayers.rulesTableId}`:null,subnetworksTableId:(r=this.sourceJSON)==null?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(n=this.sourceJSON)==null?void 0:n.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(s=this.sourceJSON)==null?void 0:s.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(o=this.sourceJSON)==null?void 0:o.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:(a=this.sourceJSON)==null?void 0:a.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(u=this.sourceJSON)==null?void 0:u.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(i=>B8.fromJSON(i)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(i=>i.domainNetworkName))||[]}get _utilityLayerList(){var i,r;const e=new Set;return(r=(i=this.dataElement)==null?void 0:i.domainNetworks)==null||r.map(n=>{n.edgeSources.map(s=>{e.add(s.layerId)}),n.junctionSources.map(s=>{e.add(s.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var d,p,h,m;let i=null,r=null;const n=e.layer;let s=null;if((n==null?void 0:n.type)==="feature"){if(s=n.layerId,s===null)return null}else if((n==null?void 0:n.type)!=="subtype-sublayer"||(s=((d=n==null?void 0:n.parent)==null?void 0:d.layerId)??null,s===null))return null;const o=e.attributes;if(o==null)return null;for(const y of Object.keys(o))y.toUpperCase()==="ASSETGROUP"&&(i=e.getAttribute(y)),y.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(y));if(!this.dataElement)return null;let a=null;const u=this.dataElement.domainNetworks;for(const y of u){const g=(p=y.junctionSources)==null?void 0:p.find(v=>v.layerId===s);if(g){const v=(h=g.assetGroups)==null?void 0:h.find(_=>_.assetGroupCode===i);if(v){const _=(m=v.assetTypes)==null?void 0:m.find(w=>w.assetTypeCode===r);if(_){a=_.terminalConfigurationId;break}}}}if(a!=null){const y=this.dataElement.terminalConfigurations,g=y==null?void 0:y.find(v=>v.terminalConfigurationId===a);return g?B8.fromJSON(g):null}return null}getTierNames(e){var r;const i=(r=this.dataElement)==null?void 0:r.domainNetworks.find(n=>n.domainNetworkName===e);return(i==null?void 0:i.tiers.map(n=>n.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}getTerminalById(e){if(!this.dataElement||e==null)return null;const i=this._terminalById.get(e);return i??(this.terminalConfigurations.forEach(r=>{r.terminals.forEach(n=>{this._terminalById.set(n.id,n)})}),this._terminalById.get(e))}isUtilityLayer(e){var i;return"layerId"in e&&this._utilityLayerList.has(e.layerId)&&(((i=e.url)==null?void 0:i.startsWith(this.featureServiceUrl))??!1)}async queryAssociations(e){const[{queryAssociations:i},{default:r}]=await Promise.all([k(()=>import("./queryAssociations-CKoXt7GN.js"),__vite__mapDeps([158,159])),k(()=>import("./QueryAssociationsParameters-CkFZ6ae8.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,(await i(this.networkServiceUrl,n)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:i},{default:r}]=await Promise.all([k(()=>import("./synthesizeAssociationGeometries-RJLXwCIA.js"),__vite__mapDeps([160,159])),k(()=>import("./SynthesizeAssociationGeometriesParameters-CLJhrbaB.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,i(this.networkServiceUrl,n)}async trace(e){const[{trace:i},{default:r}]=await Promise.all([k(()=>import("./trace-CKm2ruj1.js"),[]),k(()=>import("./TraceParameters-D7LykIqx.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,i(this.networkServiceUrl,n)}async submitTraceJob(e){const[{submitTraceJob:i},{default:r}]=await Promise.all([k(()=>import("./trace-CKm2ruj1.js"),[]),k(()=>import("./TraceParameters-D7LykIqx.js"),[])]),n=r.from(e);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;const s=await i(this.networkServiceUrl,n);return new tCe({statusUrl:s})}async canAddAssociation(e){const i=await this.getRulesTable();if(!i)return!1;await i.load();const r=(s,o)=>s?s.terminalId===1?!(o!=null&&o.terminalId)||(o==null?void 0:o.terminalId)===s.terminalId:s.terminalId===(o==null?void 0:o.terminalId):!(o!=null&&o.terminalId),n=(s,o)=>{var a,u,d,p,h,m,y,g,v,_,w,S;return((a=s.fromNetworkSource)==null?void 0:a.sourceId)===((u=o.fromNetworkElement)==null?void 0:u.networkSourceId)&&((d=s.toNetworkSource)==null?void 0:d.sourceId)===((p=o.toNetworkElement)==null?void 0:p.networkSourceId)&&((h=s.fromAssetGroup)==null?void 0:h.assetGroupCode)===((m=o.fromNetworkElement)==null?void 0:m.assetGroupCode)&&((y=s.fromAssetType)==null?void 0:y.assetTypeCode)===((g=o.fromNetworkElement)==null?void 0:g.assetTypeCode)&&((v=s.toAssetGroup)==null?void 0:v.assetGroupCode)===((_=o.toNetworkElement)==null?void 0:_.assetGroupCode)&&((w=s.toAssetType)==null?void 0:w.assetTypeCode)===((S=o.toNetworkElement)==null?void 0:S.assetTypeCode)&&r(s.fromTerminal,o.fromNetworkElement)&&r(s.toTerminal,o.toNetworkElement)};return e.associationType==="containment"?i.rulesCategorized.containment.some(s=>n(s,e)):e.associationType==="attachment"?i.rulesCategorized.attachment.some(s=>n(s,e)):i.rulesCategorized.connectivity.some(s=>{var o,a,u,d,p,h,m,y,g,v,_,w,S,E,T,M,x,C,O,F,V,z,H,Q;return s.viaNetworkSource?((o=s.fromNetworkSource)==null?void 0:o.sourceId)===((a=e.fromNetworkElement)==null?void 0:a.networkSourceId)&&((u=s.viaNetworkSource)==null?void 0:u.sourceId)===((d=e.toNetworkElement)==null?void 0:d.networkSourceId)&&((p=s.fromAssetGroup)==null?void 0:p.assetGroupCode)===((h=e.fromNetworkElement)==null?void 0:h.assetGroupCode)&&((m=s.fromAssetType)==null?void 0:m.assetTypeCode)===((y=e.fromNetworkElement)==null?void 0:y.assetTypeCode)&&((g=s.viaAssetGroup)==null?void 0:g.assetGroupCode)===((v=e.toNetworkElement)==null?void 0:v.assetGroupCode)&&((_=s.viaAssetType)==null?void 0:_.assetTypeCode)===((w=e.toNetworkElement)==null?void 0:w.assetTypeCode)&&r(s.fromTerminal,e.fromNetworkElement)&&r(s.viaTerminal,e.toNetworkElement)||((S=s.viaNetworkSource)==null?void 0:S.sourceId)===((E=e.fromNetworkElement)==null?void 0:E.networkSourceId)&&((T=s.toNetworkSource)==null?void 0:T.sourceId)===((M=e.toNetworkElement)==null?void 0:M.networkSourceId)&&((x=s.viaAssetGroup)==null?void 0:x.assetGroupCode)===((C=e.fromNetworkElement)==null?void 0:C.assetGroupCode)&&((O=s.viaAssetType)==null?void 0:O.assetTypeCode)===((F=e.fromNetworkElement)==null?void 0:F.assetTypeCode)&&((V=s.toAssetGroup)==null?void 0:V.assetGroupCode)===((z=e.toNetworkElement)==null?void 0:z.assetGroupCode)&&((H=s.toAssetType)==null?void 0:H.assetTypeCode)===((Q=e.toNetworkElement)==null?void 0:Q.assetTypeCode)&&r(s.viaTerminal,e.fromNetworkElement)&&r(s.toTerminal,e.toNetworkElement):n(s,e)})}generateAddAssociations(e){return{addFeatures:e.map(i=>{var r,n,s,o,a,u;return new Li({attributes:{fromnetworksourceid:(r=i.fromNetworkElement)==null?void 0:r.networkSourceId,fromglobalid:(n=i.fromNetworkElement)==null?void 0:n.globalId,fromterminalid:(s=i.fromNetworkElement)==null?void 0:s.terminalId,tonetworksourceid:(o=i.toNetworkElement)==null?void 0:o.networkSourceId,toglobalid:(a=i.toNetworkElement)==null?void 0:a.globalId,toterminalid:(u=i.toNetworkElement)==null?void 0:u.terminalId,associationtype:B2e[i.associationType],iscontentvisible:i.isContentVisible?1:0,percentalong:i.percentAlong,globalid:i.globalId}})}),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(e){return{deleteFeatures:e.map(i=>({globalId:i.globalId})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(e){var n;if(((n=this.sharedNamedTraceConfigurations)==null?void 0:n.length)===0)return;const i=this.sharedNamedTraceConfigurations.map(s=>s.globalId),r=await this.queryNamedTraceConfigurations({globalIds:i},e);for(const s of this.sharedNamedTraceConfigurations){const o=r==null?void 0:r.find(a=>a.globalId===s.globalId);if(o){const a=o.write({},{origin:"service"});s.read(a,{origin:"service"})}}}async _createRulesTable(){var o;const e=this.networkSystemLayers.rulesTableUrl,i=new M4({url:e});await i.load();const r=(o=this.dataElement)==null?void 0:o.domainNetworks;if(!r)return null;const n=r.flatMap(a=>[...a.edgeSources||[],...a.junctionSources||[]]),s=(await iCe(i)).map(a=>this._hydrateRuleInfo(i,n,a));return new H2e({layer:i,rules:s})}_hydrateRuleInfo(e,i,r){const n=e.fieldsIndex,s=n.get("RULETYPE"),o=n.get("CREATIONDATE"),a=n.get("FROMNETWORKSOURCEID"),u=n.get("FROMASSETGROUP"),d=n.get("FROMASSETTYPE"),p=n.get("FROMTERMINALID"),h=n.get("TONETWORKSOURCEID"),m=n.get("TOASSETGROUP"),y=n.get("TOASSETTYPE"),g=n.get("TOTERMINALID"),v=n.get("VIANETWORKSOURCEID"),_=n.get("VIAASSETGROUP"),w=n.get("VIAASSETTYPE"),S=n.get("VIATERMINALID"),E=r.attributes[s.name],T=new Date(r.attributes[o.name]),M=[{networkSourceId:r.attributes[a.name],assetGroupId:r.attributes[u.name],assetTypeId:r.attributes[d.name],terminalId:r.attributes[p.name]},{networkSourceId:r.attributes[h.name],assetGroupId:r.attributes[m.name],assetTypeId:r.attributes[y.name],terminalId:r.attributes[g.name]},{networkSourceId:r.attributes[v.name],assetGroupId:r.attributes[_.name],assetTypeId:r.attributes[w.name],terminalId:r.attributes[S.name]}];let x;(function(O){O[O.from=0]="from",O[O.to=1]="to",O[O.via=2]="via"})(x||(x={}));const C={ruleType:E,creationDate:T};for(const O of[x.from,x.to,x.via]){if(E!==zd.RTEdgeJunctionEdgeConnectivity&&O===x.via)continue;const F=M[O],V=i.find(ne=>ne.sourceId===F.networkSourceId),z=V==null?void 0:V.assetGroups.find(ne=>ne.assetGroupCode===F.assetGroupId),H=z==null?void 0:z.assetTypes.find(ne=>ne.assetTypeCode===F.assetTypeId),Q=this._getTerminal(H,F);let J="";switch(O){case x.from:J="from";break;case x.to:J="to";break;case x.via:J="via"}C[`${J}NetworkSource`]=V,C[`${J}AssetGroup`]=z,C[`${J}AssetType`]=H,C[`${J}Terminal`]=Q==null?void 0:Q.toJSON()}return C}_getTerminal(e,i){var s,o;const r=e==null?void 0:e.terminalConfigurationId,n=(s=this.terminalConfigurations)==null?void 0:s.find(a=>a.id===r);return((o=n==null?void 0:n.terminals)==null?void 0:o.find(a=>a.id===i.terminalId))??null}};async function iCe(t){const e=new gu({where:"1=1",outFields:["*"]});return(await hie(t,e)).features}l([c({type:[W2e],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],md.prototype,"sharedNamedTraceConfigurations",void 0),l([c({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],md.prototype,"type",void 0),l([c({readOnly:!0})],md.prototype,"serviceTerritoryFeatureLayerId",null),l([c({readOnly:!0})],md.prototype,"networkSystemLayers",null),l([c({readOnly:!0})],md.prototype,"terminalConfigurations",null),l([c({readOnly:!0})],md.prototype,"domainNetworkNames",null),md=l([$("esri.networks.UtilityNetwork")],md);const Lie=md,rCe=Object.freeze(Object.defineProperty({__proto__:null,default:Lie},Symbol.toStringTag,{value:"Module"}));let Bv=class extends Ze(j){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};l([c({type:String,json:{write:{isRequired:!0}}})],Bv.prototype,"expression",void 0),l([c({type:["number","string"],json:{write:!0}})],Bv.prototype,"returnType",void 0),l([c({type:String,json:{write:!0}})],Bv.prototype,"title",void 0),Bv=l([$("esri.webdoc.geotriggersInfo.ExpressionInfo")],Bv);const Aie=Bv,DT=new $e({deviceLocation:"device-location"});let M1=class extends Ze(j){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};l([c({type:Aie,json:{write:!0}})],M1.prototype,"filterExpression",void 0),l([c({type:DT.apiValues,readOnly:!0,json:{type:DT.jsonValues,read:DT.read,write:DT.write}})],M1.prototype,"type",void 0),M1=l([$("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],M1);const nCe=M1;let C1=class extends Ze(j){constructor(e){super(e),this.geometry=null,this.where=null}};l([c({types:rg,json:{read:dp,write:!0}})],C1.prototype,"geometry",void 0),l([c({type:String,json:{write:!0}})],C1.prototype,"where",void 0),C1=l([$("esri.webdoc.geotriggersInfo.FeatureFilter")],C1);const sCe=C1;let Hv=class extends Ze(j){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};l([c({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],Hv.prototype,"layerId",void 0),l([c({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],Hv.prototype,"layerUrl",void 0),l([oe({featureLayer:"feature-layer"},{readOnly:!0})],Hv.prototype,"type",void 0),Hv=l([$("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Hv);const oCe=Hv;let Rf=class extends Ze(j){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};l([c({type:oCe,json:{write:{isRequired:!0}}})],Rf.prototype,"fenceSource",void 0),l([c({type:sCe,json:{write:!0}})],Rf.prototype,"filter",void 0),l([c({type:Number,json:{write:!0}})],Rf.prototype,"bufferDistance",void 0),l([oe({features:"features"},{readOnly:!0})],Rf.prototype,"type",void 0),Rf=l([$("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],Rf);const aCe=Rf;let Wx=class extends Ze(j){constructor(e){super(e),this.type="fence"}};l([oe({fence:"fence"},{readOnly:!0})],Wx.prototype,"type",void 0),Wx=l([$("esri.webdoc.geotriggersInfo.Geotrigger")],Wx);const Oie=Wx;let k1=class extends Ze(j){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};l([c({type:Aie,json:{write:!0}})],k1.prototype,"expressionInfo",void 0),l([c({type:[String],json:{write:!0}})],k1.prototype,"requestedActions",void 0),k1=l([$("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],k1);const lCe=k1,uCe=new $e({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),cCe=new $e({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),VT=new $e({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let Pl=class extends Oie{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};l([oe(uCe)],Pl.prototype,"enterExitRule",void 0),l([c({type:nCe,json:{write:{isRequired:!0}}})],Pl.prototype,"feed",void 0),l([oe(cCe)],Pl.prototype,"feedAccuracyMode",void 0),l([c({type:VT.apiValues,json:{type:VT.jsonValues,read:VT.read,write:{writer:VT.write,isRequired:!0}}})],Pl.prototype,"fenceNotificationRule",void 0),l([c({type:aCe,json:{write:{isRequired:!0}}})],Pl.prototype,"fenceParameters",void 0),l([c({type:String,json:{write:!0}})],Pl.prototype,"name",void 0),l([c({type:lCe,json:{write:!0}})],Pl.prototype,"notificationOptions",void 0),l([oe({fence:"fence"},{readOnly:!0})],Pl.prototype,"type",void 0),Pl=l([$("esri.webdoc.geotriggersInfo.FenceGeotrigger")],Pl);const dCe=Pl,pCe={base:Oie,key:"type",typeMap:{fence:dCe}};let Zx=class extends Ze(j){constructor(e){super(e),this.geotriggers=null}};l([c({types:[pCe],json:{write:{isRequired:!0}}})],Zx.prototype,"geotriggers",void 0),Zx=l([$("esri.webdoc.GeotriggersInfo")],Zx);const hCe=Zx;let qv=class extends Ze(j){constructor(e){super(e),this.portalItem=null}readPortalItem(e,i,r){const{itemId:n}=i;if(n)return new so({id:n,portal:r==null?void 0:r.portal})}writePortalItem(e,i){e!=null&&e.id&&(i.itemId=e.id)}};l([c({type:so,json:{write:{isRequired:!0}}})],qv.prototype,"portalItem",void 0),l([X("portalItem",["itemId"])],qv.prototype,"readPortalItem",null),l([te("portalItem",{itemId:{type:String}})],qv.prototype,"writePortalItem",null),qv=l([$("esri.webdoc.ips.PositioningService")],qv);const mCe=qv;let Jx=class extends Ze(j){constructor(e){super(e),this.positioningService=null}};l([c({type:mCe,json:{write:{isRequired:!0}}})],Jx.prototype,"positioningService",void 0),Jx=l([$("esri.webdoc.IPSInfo")],Jx);const fCe=Jx;function Yx(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}const Rie=new q0(2,32),yCe={currentVersion:Rie,createInitialViewProperties:()=>new y2,parseVersion:q0.parse,itemType:"Web Map",name:"webmap",origin:"web-map"},gCe=Y.ofType(Lie);let hh=class extends Ewe{constructor(e){super(e),this.geotriggersInfo=null,this.ipsInfo=null,this.presentation=null,this.utilityNetworks=null}destroy(){if(this.utilityNetworks){const e=this.utilityNetworks.removeAll();for(const i of e)i.destroy();this.utilityNetworks.destroy()}}get context(){return yCe}loadAll(){return PC(this,e=>{var i,r;e(this.ground,this.basemap,this.layers,this.tables,(r=(i=this.ipsInfo)==null?void 0:i.positioningService)==null?void 0:r.portalItem)})}static fromJSON(e){if(e)return new this({resourceInfo:e});throw new L("webmap:empty-resource","Expected a JSON resource but got nothing")}};hh.VERSION=Rie,l([c({type:hCe,json:{write:!0}})],hh.prototype,"geotriggersInfo",void 0),l([c({type:fCe,json:{write:!0,name:"mapIPSInfo"}})],hh.prototype,"ipsInfo",void 0),l([c({json:{write:!0}})],hh.prototype,"presentation",void 0),l([c({type:gCe,json:{read:!0,write:!0}})],hh.prototype,"utilityNetworks",void 0),hh=l([$("esri.WebMap")],hh);const vCe=hh;var lN;let Bu=lN=class extends j{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new lN({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};l([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Bu.prototype,"cols",void 0),l([c({type:Xe,json:{write:!0}})],Bu.prototype,"level",void 0),l([c({type:String,json:{write:!0}})],Bu.prototype,"levelValue",void 0),l([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Bu.prototype,"origin",void 0),l([c({type:Number,json:{write:!0}})],Bu.prototype,"resolution",void 0),l([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Bu.prototype,"rows",void 0),l([c({type:Number,json:{write:!0}})],Bu.prototype,"scale",void 0),Bu=lN=l([$("esri.layers.support.LOD")],Bu);const Uh=Bu;let k4=class{constructor(e,i,r,n,s=void 0){this.id=e,this.level=i,this.row=r,this.col=n,this.extent=s}};var mh;const H8=new $e({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let wn=mh=class extends j{static create(t={}){const{resolutionFactor:e=1,scales:i,size:r=256,spatialReference:n=le.WebMercator,numLODs:s=24}=t;if(!Cs(n)){const h=[];if(i)for(let m=0;m<i.length;m++){const y=i[m];h.push(new Uh({level:m,scale:y,resolution:y}))}else{let m=5e-4;for(let y=s-1;y>=0;y--)h.unshift(new Uh({level:y,scale:m,resolution:m})),m*=2}return new mh({dpi:96,lods:h,origin:new we(0,0,n),size:[r,r],spatialReference:n})}const o=Ln(n),a=t.origin?new we({x:t.origin.x,y:t.origin.y,spatialReference:n}):new we(o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),u=96,d=1/(Ci(n)*39.37*u),p=[];if(i)for(let h=0;h<i.length;h++){const m=i[h],y=m*d;p.push(new Uh({level:h,scale:m,resolution:y}))}else{let h=u_(n)?512/r*5916575275917094e-7:256/r*591657527591555e-6;const m=Math.ceil(s/e);p.push(new Uh({level:0,scale:h,resolution:h*d}));for(let y=1;y<m;y++){const g=h/2**e,v=g*d;p.push(new Uh({level:y,scale:g,resolution:v})),h=g}}return new mh({dpi:u,lods:p,origin:a,size:[r,r],spatialReference:n})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Ln(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return we.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const r=[],n=this._levelToLOD={};t&&(e=-1/0,i=1/0,t.forEach(s=>{r.push(s.scale),e=s.scale>e?s.scale:e,i=s.scale<i?s.scale:i,n[s.level]=s})),this._set("scales",r),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),r=i+1;return e[i]/(e[i]/e[r])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let r=0;for(;r<i;r++){const n=e[r],s=e[r+1];if(n<=t)return r;if(s===t)return r+1;if(n>t&&s<t)return r+Math.log(n/t)/Math.log(n/s)}return r}tileAt(t,e,i,r){const n=this.lodAt(t);if(!n)return null;let s,o;if(typeof e=="number")s=e,o=i;else if(ci(e.spatialReference,this.spatialReference))s=e.x,o=e.y,r=i;else{const d=V$(e,this.spatialReference);if(d==null)return null;s=d.x,o=d.y,r=i}const a=n.resolution*this.size[0],u=n.resolution*this.size[1];return r||(r=new k4(null,0,0,0,Cn())),r.level=t,r.row=Math.floor((this.origin.y-o)/u+.001),r.col=Math.floor((s-this.origin.x)/a+.001),this.updateTileInfo(r),r}updateTileInfo(t,e=mh.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===mh.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<t.level&&(i=o)}if(!i)return;const r=t.level-i.level,n=i.resolution*this.size[0]/2**r,s=i.resolution*this.size[1]/2**r;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=Cn()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*s,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+s}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(i==null)return null;const{resolution:r}=i,n=r*this.size[0],s=r*this.size[1];return t[0]=this.origin.x+e.col*n,t[1]=this.origin.y-(e.row+1)*s,t[2]=t[0]+n,t[3]=t[1]+s,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return mh.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||this.size[0]===256&&t===512)return null;const e=(this.size[0]===512&&t===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&e===0)return this;const i=[],r=this.lods.length-e;for(let n=0;n<r;n++){const s=n+e,{scale:o,resolution:a}=s>=0?this.lods[s]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new Uh({level:n,scale:o,resolution:a}))}return new mh({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const r=t[i];this._upsampleLevels[r.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/r.resolution:0},e=r}}};l([c({type:Number,json:{write:!0}})],wn.prototype,"compressionQuality",void 0),l([c({type:Number,json:{write:!0}})],wn.prototype,"dpi",void 0),l([c({type:String,json:{read:H8.read,write:H8.write,origins:{"web-scene":{read:!1,write:!1}}}})],wn.prototype,"format",void 0),l([c({readOnly:!0})],wn.prototype,"isWrappable",null),l([c({type:we,json:{write:!0}})],wn.prototype,"origin",void 0),l([X("origin")],wn.prototype,"readOrigin",null),l([c({type:[Uh],value:null,json:{write:!0}})],wn.prototype,"lods",null),l([c({readOnly:!0})],wn.prototype,"scales",void 0),l([c({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],wn.prototype,"size",void 0),l([X("size",["rows","cols"])],wn.prototype,"readSize",null),l([te("size",{cols:{type:Xe},rows:{type:Xe}})],wn.prototype,"writeSize",null),l([c({type:le,json:{write:!0}})],wn.prototype,"spatialReference",void 0),wn=mh=l([$("esri.layers.support.TileInfo")],wn),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(wn||(wn={}));const bCe=wn,Kx={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],r=e[1],n=this.values;return r>=i?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},_A={xsmall:544,small:768,medium:992,large:1200};function _Ce(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function wA(t,e){return e?Kx[t].valueToClassName[e].split(" "):[]}const wCe=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=_A}initialize(){this.addHandles(N(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),be))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!_Ce(i)){const r=JSON.stringify(_A,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r),i=_A}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Is.acquire(),r=Is.acquire();let n,s=!1;for(n in Kx){const o=this[n],a=Kx[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(s=!0,this[n]=a,wA(n,o).forEach(u=>r.push(u)),wA(n,a).forEach(u=>i.push(u)))}s&&(this._applyClassNameChanges(i,r),Is.release(i),Is.release(r))}_applyClassNameChanges(i,r){const n=this.container;n&&(r.forEach(s=>n.classList.remove(s)),i.forEach(s=>n.classList.add(s)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in Kx)wA(r,this[r]).forEach(n=>i.classList.remove(n))}};return l([c()],e.prototype,"breakpoints",null),l([c()],e.prototype,"orientation",void 0),l([c()],e.prototype,"widthBreakpoint",void 0),l([c()],e.prototype,"heightBreakpoint",void 0),e=l([$("esri.views.BreakpointsOwner")],e),e};function L4(t){return typeof t=="string"?document.getElementById(t):t??null}function q8(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}let Wo=class extends q{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,i,r={}){return this._installWatch(e,i,r,N)}addWhen(e,i,r={}){return this._installWatch(e,i,r,Hi)}addOnCollectionChange(e,i,{initial:r=!1,final:n=!1}={}){const s=++this._handleId;return this.addHandles([St(e,"after-changes",this._createSyncUpdatingCallback(),yn),St(e,"change",i,{onListenerAdd:r?o=>i({added:o.toArray(),removed:[]}):void 0,onListenerRemove:n?o=>i({added:[],removed:o.toArray()}):void 0})],s),ye(()=>this.removeHandles(s))}addPromise(e){if(e==null)return e;const i=++this._handleId;this.addHandles(ye(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(UT)||this._set("updating",!1))}),i),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this.removeHandles(i);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,i,r={},n){const s=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,s);const o=n(e,i,r);return this.addHandles(o,s),ye(()=>this.removeHandles(s))}_installSyncUpdatingWatch(e,i){const r=this._createSyncUpdatingCallback(),n=N(e,r,{sync:!0,equals:()=>!1});return this.addHandles(n,i),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(UT),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(P$(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(UT))}),UT)}}};l([c({readOnly:!0})],Wo.prototype,"updating",void 0),Wo=l([$("esri.core.support.UpdatingHandles")],Wo);const UT=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.1.0-next.3 - Wed Sep 25 2024 10:04:57 GMT-0400 (Eastern Daylight Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var E2=function(){return E2=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},E2.apply(this,arguments)},uN={exports:{}},Zi={},cN={exports:{}},mg={};function Pie(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function SCe(t,e,i){}function $Ce(t,e,i){}var ECe=/javascript\s*\:/img;function TCe(t,e){return ECe.test(e)?"":e}mg.whiteList=Pie();mg.getDefaultWhiteList=Pie;mg.onAttr=SCe;mg.onIgnoreAttr=$Ce;mg.safeAttrValue=TCe;var ICe={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Y_=ICe;function xCe(t,e){t=Y_.trimRight(t),t[t.length-1]!==";"&&(t+=";");var i=t.length,r=!1,n=0,s=0,o="";function a(){if(!r){var p=Y_.trim(t.slice(n,s)),h=p.indexOf(":");if(h!==-1){var m=Y_.trim(p.slice(0,h)),y=Y_.trim(p.slice(h+1));if(m){var g=e(n,o.length,m,y,p);g&&(o+=g+"; ")}}}n=s+1}for(;s<i;s++){var u=t[s];if(u==="/"&&t[s+1]==="*"){var d=t.indexOf("*/",s+2);if(d===-1)break;s=d+1,n=s+1,r=!1}else u==="("?r=!0:u===")"?r=!1:u===";"?r||a():u===`
`&&a()}return Y_.trim(o)}var MCe=xCe,jT=mg,CCe=MCe;function W8(t){return t==null}function kCe(t){var e={};for(var i in t)e[i]=t[i];return e}function Fie(t){t=kCe(t||{}),t.whiteList=t.whiteList||jT.whiteList,t.onAttr=t.onAttr||jT.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||jT.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||jT.safeAttrValue,this.options=t}Fie.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onAttr,s=i.onIgnoreAttr,o=i.safeAttrValue,a=CCe(t,function(u,d,p,h,m){var y=r[p],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(h):y instanceof RegExp&&(g=y.test(h)),g!==!0&&(g=!1),h=o(p,h),!!h){var v={position:d,sourcePosition:u,source:m,isWhite:g};if(g){var _=n(p,h,v);return W8(_)?p+":"+h:_}else{var _=s(p,h,v);if(!W8(_))return _}}});return a};var LCe=Fie;(function(t,e){var i=mg,r=LCe;function n(o,a){var u=new r(a);return u.process(o)}e=t.exports=n,e.FilterCSS=r;for(var s in i)e[s]=i[s]})(cN,cN.exports);var A4=cN.exports,O4={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,i=e.exec(t);return i?i.index:-1}},ACe=A4.FilterCSS,OCe=A4.getDefaultWhiteList,T2=O4;function Nie(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Die=new ACe;function RCe(t,e,i){}function PCe(t,e,i){}function FCe(t,e,i){}function NCe(t,e,i){}function Vie(t){return t.replace(VCe,"&lt;").replace(UCe,"&gt;")}function DCe(t,e,i,r){if(i=Hie(i),e==="href"||e==="src"){if(i=T2.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(e==="background"){if(GT.lastIndex=0,GT.test(i))return""}else if(e==="style"){if(Z8.lastIndex=0,Z8.test(i)||(J8.lastIndex=0,J8.test(i)&&(GT.lastIndex=0,GT.test(i))))return"";r!==!1&&(r=r||Die,i=r.process(i))}return i=qie(i),i}var VCe=/</g,UCe=/>/g,jCe=/"/g,GCe=/&quot;/g,zCe=/&#([a-zA-Z0-9]*);?/gim,BCe=/&colon;?/gim,HCe=/&newline;?/gim,GT=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Z8=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,J8=/u\s*r\s*l\s*\(.*/gi;function Uie(t){return t.replace(jCe,"&quot;")}function jie(t){return t.replace(GCe,'"')}function Gie(t){return t.replace(zCe,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function zie(t){return t.replace(BCe,":").replace(HCe," ")}function Bie(t){for(var e="",i=0,r=t.length;i<r;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return T2.trim(e)}function Hie(t){return t=jie(t),t=Gie(t),t=zie(t),t=Bie(t),t}function qie(t){return t=Uie(t),t=Vie(t),t}function qCe(){return""}function WCe(t,e){typeof e!="function"&&(e=function(){});var i=!Array.isArray(t);function r(o){return i?!0:T2.indexOf(t,o)!==-1}var n=[],s=!1;return{onIgnoreTag:function(o,a,u){if(r(o))if(u.isClosing){var d="[/removed]",p=u.position+d.length;return n.push([s!==!1?s:u.position,p]),s=!1,d}else return s||(s=u.position),"[removed]";else return e(o,a,u)},remove:function(o){var a="",u=0;return T2.forEach(n,function(d){a+=o.slice(u,d[0]),u=d[1]}),a+=o.slice(u),a}}}function ZCe(t){for(var e="",i=0;i<t.length;){var r=t.indexOf("<!--",i);if(r===-1){e+=t.slice(i);break}e+=t.slice(i,r);var n=t.indexOf("-->",r);if(n===-1)break;i=n+3}return e}function JCe(t){var e=t.split("");return e=e.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}Zi.whiteList=Nie();Zi.getDefaultWhiteList=Nie;Zi.onTag=RCe;Zi.onIgnoreTag=PCe;Zi.onTagAttr=FCe;Zi.onIgnoreTagAttr=NCe;Zi.safeAttrValue=DCe;Zi.escapeHtml=Vie;Zi.escapeQuote=Uie;Zi.unescapeQuote=jie;Zi.escapeHtmlEntities=Gie;Zi.escapeDangerHtml5Entities=zie;Zi.clearNonPrintableCharacter=Bie;Zi.friendlyAttrValue=Hie;Zi.escapeAttrValue=qie;Zi.onIgnoreTagStripAll=qCe;Zi.StripTagBody=WCe;Zi.stripCommentTag=ZCe;Zi.stripBlankChar=JCe;Zi.cssFilter=Die;Zi.getDefaultCSSWhiteList=OCe;var Lk={},jh=O4;function YCe(t){var e=jh.spaceIndex(t),i;return e===-1?i=t.slice(1,-1):i=t.slice(1,e+1),i=jh.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function KCe(t){return t.slice(0,2)==="</"}function XCe(t,e,i){var r="",n=0,s=!1,o=!1,a=0,u=t.length,d="",p="";e:for(a=0;a<u;a++){var h=t.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){r+=i(t.slice(n,a)),s=a,n=a;continue}if(h===">"){r+=i(t.slice(n,s)),p=t.slice(s,a+1),d=YCe(p),r+=e(s,r.length,d,p,KCe(p)),n=a+1,s=!1;continue}if(h==='"'||h==="'")for(var m=1,y=t.charAt(a-m);y.trim()===""||y==="=";){if(y==="="){o=h;continue e}y=t.charAt(a-++m)}}else if(h===o){o=!1;continue}}return n<t.length&&(r+=i(t.substr(n))),r}var QCe=/[^a-zA-Z0-9\\_:.-]/gim;function eke(t,e){var i=0,r=0,n=[],s=!1,o=t.length;function a(m,y){if(m=jh.trim(m),m=m.replace(QCe,"").toLowerCase(),!(m.length<1)){var g=e(m,y||"");g&&n.push(g)}}for(var u=0;u<o;u++){var d=t.charAt(u),p,h;if(s===!1&&d==="="){s=t.slice(i,u),i=u+1,r=t.charAt(i)==='"'||t.charAt(i)==="'"?i:ike(t,u+1);continue}if(s!==!1&&u===r){if(h=t.indexOf(d,u+1),h===-1)break;p=jh.trim(t.slice(r+1,h)),a(s,p),s=!1,u=h,i=u+1;continue}if(/\s|\n|\t/.test(d))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(h=tke(t,u),h===-1){p=jh.trim(t.slice(i,u)),a(p),s=!1,i=u+1;continue}else{u=h-1;continue}else if(h=rke(t,u-1),h===-1){p=jh.trim(t.slice(i,u)),p=Y8(p),a(s,p),s=!1,i=u+1;continue}else continue}return i<t.length&&(s===!1?a(t.slice(i)):a(s,Y8(jh.trim(t.slice(i))))),jh.trim(n.join(" "))}function tke(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="="?e:-1}}function ike(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="'"||i==='"'?e:-1}}function rke(t,e){for(;e>0;e--){var i=t[e];if(i!==" ")return i==="="?e:-1}}function nke(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function Y8(t){return nke(t)?t.substr(1,t.length-2):t}Lk.parseTag=XCe;Lk.parseAttr=eke;var ske=A4.FilterCSS,Jl=Zi,Wie=Lk,oke=Wie.parseTag,ake=Wie.parseAttr,Xx=O4;function zT(t){return t==null}function lke(t){var e=Xx.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=Xx.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";return i&&(t=Xx.trim(t.slice(0,-1))),{html:t,closing:i}}function uke(t){var e={};for(var i in t)e[i]=t[i];return e}function cke(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map(function(r){return r.toLowerCase()}):e[i.toLowerCase()]=t[i];return e}function Zie(t){t=uke(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Jl.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=cke(t.whiteList||t.allowList):t.whiteList=Jl.whiteList,t.onTag=t.onTag||Jl.onTag,t.onTagAttr=t.onTagAttr||Jl.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Jl.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Jl.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Jl.safeAttrValue,t.escapeHtml=t.escapeHtml||Jl.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new ske(t.css))}Zie.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onTag,s=i.onIgnoreTag,o=i.onTagAttr,a=i.onIgnoreTagAttr,u=i.safeAttrValue,d=i.escapeHtml,p=e.cssFilter;i.stripBlankChar&&(t=Jl.stripBlankChar(t)),i.allowCommentTag||(t=Jl.stripCommentTag(t));var h=!1;i.stripIgnoreTagBody&&(h=Jl.StripTagBody(i.stripIgnoreTagBody,s),s=h.onIgnoreTag);var m=oke(t,function(y,g,v,_,w){var S={sourcePosition:y,position:g,isClosing:w,isWhite:Object.prototype.hasOwnProperty.call(r,v)},E=n(v,_,S);if(!zT(E))return E;if(S.isWhite){if(S.isClosing)return"</"+v+">";var T=lke(_),M=r[v],x=ake(T.html,function(C,O){var F=Xx.indexOf(M,C)!==-1,V=o(v,C,O,F);return zT(V)?F?(O=u(v,C,O,p),O?C+'="'+O+'"':C):(V=a(v,C,O,F),zT(V)?void 0:V):V});return _="<"+v,x&&(_+=" "+x),T.closing&&(_+=" /"),_+=">",_}else return E=s(v,_,S),zT(E)?d(_):E},d);return h&&(m=h.remove(m)),m};var dke=Zie;(function(t,e){var i=Zi,r=Lk,n=dke;function s(a,u){var d=new n(u);return d.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=n,function(){for(var a in i)e[a]=i[a];for(var u in r)e[u]=r[u]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(uN,uN.exports);var Eg=uN.exports,pke=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},hke=function(){function t(e,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=E2(E2({},Eg.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,u){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?r.sanitizeUrl(a):Eg.safeAttrValue(s,o,a,u)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;e&&!i?n=e:e&&i?(n=Object.create(this.arcgisFilterOptions),n.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(s){if(s==="whiteList")n.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if(s==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return n.css.whiteList[a]=o[a]})}else n[s]=e[s]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList,n.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=n,this._xssFilter=new Eg.FilterXSS(n)}return t.prototype.sanitize=function(e,i){switch(i===void 0&&(i={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,i);default:return i.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,i){var r=(i??{}).isProtocolRequired,n=r===void 0?!0:r,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),u=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||u?Eg.escapeAttrValue(e):!s&&!n?Eg.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,i,r,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,i,r,n):Eg.safeAttrValue(e,i,r,n)},t.prototype.validate=function(e,i){i===void 0&&(i={});var r=this.sanitize(e,i);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var i=this;return String(e).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var i=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,n){return i.test(r)?r:"&#x".concat(Number(e.charCodeAt(n)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var i={};return e.forEach(function(r){Object.keys(r).forEach(function(n){Array.isArray(r[n])&&Array.isArray(i[n])?i[n]=i[n].concat(r[n]):i[n]=r[n]})}),i},t.prototype._iterateOverObject=function(e,i){var r=this;i===void 0&&(i={});try{var n=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,u){var d=r.validate(u,i);return d.isValid?a.concat([u]):(n=!0,a.concat([d.sanitized]))},[]);else if(pke(e)){var o=Object.keys(e);s=o.reduce(function(a,u){var d=e[u],p=r.validate(d,i);return p.isValid?a[u]=d:(n=!0,a[u]=p.sanitized),a},{})}else return i.allowUndefined&&typeof e>"u"?void 0:null;return n?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const Ak=new Map;function Jie(){Ak.clear()}function mke(t){return Ak.get(t)}function fke(t,e){Ak.set(t,e)}function SA(t){Ak.delete(t)}function nu(...t){const e=Is.acquire();for(let r=0;r<t.length;r++){const n=t[r],s=typeof n;if(s==="string")e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if(s==="object")for(const o in n)n[o]&&e.push(o)}const i=e.join(" ");return Is.release(e),i}const R4=(()=>{const t=new Map,e=new ResizeObserver(r=>{var n;Jie();for(const s of r)(n=t.get(s.target))==null||n(s)}),i=(r,n,s)=>(t.set(r,n),e.observe(r,s),ye(()=>{e.unobserve(r),t.delete(r)}));return(r,n,s)=>{let o=null;return kr([N(()=>typeof r=="function"?r():r,a=>{o==null||o.remove(),a&&(o=i(a,n,s))},gt),ye(()=>o==null?void 0:o.remove())])}})();function qy(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function K8(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function T0(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const yke=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],gke=yke.reduce((t,e)=>(t[e]=[],t),{}),vke=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],P4=new hke({whiteList:gke,onTagAttr:(t,e,i)=>{const r=`${e}="${i}"`;if(vke.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function F4(t){return t==="Enter"||t===" "}async function qa(t,e){await VZ(R$(e));const i=typeof t=="function"?t():t;i&&("setFocus"in i&&typeof i.setFocus=="function"?await i.setFocus():i instanceof HTMLElement&&i.focus())}const Yie="http://www.w3.org/",Ok=`${Yie}2000/svg`,Kie=`${Yie}1999/xlink`;let X8=[],N4=(t,e)=>{let i={};return Object.keys(t).forEach(r=>{i[r]=t[r]}),e&&Object.keys(e).forEach(r=>{i[r]=e[r]}),i},D4=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),Xie=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},bke=(t,e,i)=>{if(e.vnodeSelector!==""){for(let r=i;r<t.length;r++)if(D4(t[r],e))return r}return-1},$A=(t,e,i,r)=>{let n=t[e];if(n.vnodeSelector==="")return;let s=n.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(D4(a,n))throw new Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},_ke=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},dN=[],pN=!1,Qie=t=>{(t.children||[]).forEach(Qie),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},Q8=()=>{pN=!1,dN.forEach(Qie),dN.length=0},e9=t=>{dN.push(t),pN||(pN=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(Q8,{timeout:16}):setTimeout(Q8,16))},t9=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i)return e.style.pointerEvents="none",void i(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),e9(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),e9(t))},wke=(t,e,i)=>{if(!e)return;let r=i.eventHandlerInterceptor,n=Object.keys(e),s=n.length;for(let o=0;o<s;o++){let a=n[o],u=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")mN(t,u,!0);else if(a==="classes"){let d=Object.keys(u),p=d.length;for(let h=0;h<p;h++){let m=d[h];u[m]&&t.classList.add(m)}}else if(a==="styles"){let d=Object.keys(u),p=d.length;for(let h=0;h<p;h++){let m=d[h],y=u[m];y&&(Xie(y),i.styleApplyer(t,m,y))}}else if(a!=="key"&&u!=null){let d=typeof u;d==="function"?(a.lastIndexOf("on",0)===0&&(r&&(u=r(a,u,t,e)),a==="oninput"&&function(){let p=u;u=function(h){p.apply(this,[h]),h.target["oninput-value"]=h.target.value}}()),t[a]=u):i.namespace===Ok?a==="href"?t.setAttributeNS(Kie,a,u):t.setAttribute(a,u):d==="string"&&a!=="value"?a==="innerHTML"?t[a]=P4.sanitize(u):hN(t)&&a in t?t[a]=u:t.setAttribute(a,u):t[a]=u}}};function hN(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let I2,Ske=(t,e,i)=>{if(e)for(let r of e)I0(r,t,void 0,i)},ere=(t,e,i)=>{Ske(t,e.children,i),e.text&&(t.textContent=e.text),wke(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},I0=(t,e,i,r)=>{let n,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")n=t.domNode=a.createTextNode(t.text),i!==void 0?e.insertBefore(n,i):e.appendChild(n);else{for(let u=0;u<=o.length;++u){let d=o.charAt(u);if(u===o.length||d==="."||d==="#"){let p=o.charAt(s-1),h=o.slice(s,u);p==="."?n.classList.add(h):p==="#"?n.id=h:(h==="svg"&&(r=N4(r,{namespace:Ok})),r.namespace!==void 0?n=t.domNode=a.createElementNS(r.namespace,h):(n=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&n.setAttribute("type",t.properties.type)),i!==void 0?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),s=u+1}}ere(n,t,r)}},mN=(t,e,i)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,i)})},$ke=(t,e,i,r)=>{if(!i)return;let n=!1,s=Object.keys(i),o=s.length;for(let a=0;a<o;a++){let u=s[a],d=i[u],p=e[u];if(u==="class")p!==d&&(mN(t,p,!1),mN(t,d,!0));else if(u==="classes"){let h=t.classList,m=Object.keys(d),y=m.length;for(let g=0;g<y;g++){let v=m[g],_=!!d[v];_!==!!p[v]&&(n=!0,_?h.add(v):h.remove(v))}}else if(u==="styles"){let h=Object.keys(d),m=h.length;for(let y=0;y<m;y++){let g=h[y],v=d[g];v!==p[g]&&(n=!0,v?(Xie(v),r.styleApplyer(t,g,v)):r.styleApplyer(t,g,""))}}else if(d||typeof p!="string"||(d=""),u!=="value"||hN(t)){if(d!==p){let h=typeof d;h==="function"&&r.eventHandlerInterceptor||(r.namespace===Ok?u==="href"?t.setAttributeNS(Kie,u,d):t.setAttribute(u,d):h==="string"?u==="innerHTML"?t[u]=P4.sanitize(d):u==="role"&&d===""?t.removeAttribute(u):hN(t)&&u in t?t[u]=d:t.setAttribute(u,d):t[u]!==d&&(t[u]=d),n=!0)}}else{let h=t[u];h!==d&&(t["oninput-value"]?h===t["oninput-value"]:d!==p)&&(t[u]=d,t["oninput-value"]=void 0),d!==p&&(n=!0)}}return n},Eke=(t,e,i,r,n)=>{if(i===r)return!1;r=r||X8;let s,o=(i=i||X8).length,a=r.length,u=0,d=0,p=!1;for(;d<a;){let h=u<o?i[u]:void 0,m=r[d];if(h!==void 0&&D4(h,m))p=I2(h,m,n)||p,u++;else{let y=bke(i,m,u+1);if(y>=0){for(s=u;s<y;s++)t9(i[s]),$A(i,s,t,"removed");p=I2(i[y],m,n)||p,u=y+1}else I0(m,e,u<o?i[u].domNode:void 0,n),_ke(m),$A(r,d,t,"added")}d++}if(o>u)for(s=u;s<o;s++)t9(i[s]),$A(i,s,t,"removed");return p};I2=(t,e,i)=>{let r=t.domNode,n=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(o,r),e.domNode=o,n=!0,n}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(i=N4(i,{namespace:Ok})),t.text!==e.text&&(s=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,s=Eke(e,r,t.children,e.children,i)||s,s=$ke(r,t.properties,e.properties,i)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,i,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),n};let K_=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=i,I2(r,i,e)},domNode:t.domNode});const Tke={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}};let Wv=t=>N4(Tke,t),Xh={create:(t,e)=>(e=Wv(e),I0(t,document.createElement("div"),void 0,e),K_(t,e)),append:(t,e,i)=>(i=Wv(i),I0(e,t,void 0,i),K_(e,i)),insertBefore:(t,e,i)=>(i=Wv(i),I0(e,t.parentNode,t,i),K_(e,i)),merge:(t,e,i)=>(i=Wv(i),e.domNode=t,ere(t,e,i),K_(e,i)),replace:(t,e,i)=>(i=Wv(i),I0(e,t.parentNode,t,i),t.parentNode.removeChild(t),K_(e,i))},tre,Ike=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};tre=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let xke=(t,e)=>{let i=t;return e.forEach(r=>{i=i&&i.children?tre(i.children,n=>n.domNode===r):void 0}),i},Mke=(t,e,i)=>{let r=function(n){i("domEvent",n);let s=e(),o=Ike(n.currentTarget,s.domNode);o.reverse();let a,u=xke(s.getLastRender(),o);return t.scheduleRender(),u&&(a=u.properties[`on${n.type}`].apply(u.properties.bind||this,arguments)),i("domEventProcessed",n),a};return(n,s,o,a)=>r},x2=t=>{let e,i,r=Wv(t),n=r.performanceLogger,s=!0,o=!1,a=[],u=[],d=(h,m,y)=>{let g,v=()=>g;r.eventHandlerInterceptor=Mke(e,v,n),g=h(m,y(),r),a.push(g),u.push(y)},p=()=>{if(i=void 0,s){s=!1,n("renderStart",void 0);for(let h=0;h<a.length;h++){let m=u[h]();n("rendered",void 0),a[h].update(m),n("patched",void 0)}n("renderDone",void 0),s=!0}};return e={renderNow:p,scheduleRender:()=>{i||o||(i=requestAnimationFrame(p))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(h,m)=>{d(Xh.append,h,m)},insertBefore:(h,m)=>{d(Xh.insertBefore,h,m)},merge:(h,m)=>{d(Xh.merge,h,m)},replace:(h,m)=>{d(Xh.replace,h,m)},detach:h=>{for(let m=0;m<u.length;m++)if(u[m]===h)return u.splice(m,1),a.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},fh=class extends q{constructor(){super(...arguments),this.items=new Y,this._watchUpdatingTracking=new Wo,this._callbacks=new Map,this._projector=x2(),this._hiddenProjector=x2()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const r of i.added){const n=()=>r.render();this._callbacks.set(r,n),this._projector.append(this.surface,n)}for(const r of i.removed){const n=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(n.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,r=this._hiddenProjector;let n;const s=()=>(n=e.render(),n);r.append(i,s),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(n!=null&&n.domNode){const a=n.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(s);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(e,i){const r=this.computeBoundingRect(e),n=this.computeBoundingRect(i);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,i){const r=!!(i!=null&&i.disableDecorations);if(!this.items.some(s=>s.visible&&!(r&&s.isDecoration)))return;const n=e.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach(s=>{r&&s.isDecoration||(n.save(),s.renderCanvas(n),n.restore())}),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};l([c({readOnly:!0})],fh.prototype,"surface",void 0),l([c({readOnly:!0})],fh.prototype,"items",void 0),l([c({readOnly:!0})],fh.prototype,"needsRender",null),l([c({readOnly:!0})],fh.prototype,"_watchUpdatingTracking",void 0),l([c({readOnly:!0})],fh.prototype,"updating",null),fh=l([$("esri.views.overlay.ViewOverlay")],fh);const i9=fh,EA=[0,0];function Cke(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return EA[0]=i.left+((e==null?void 0:e.pageXOffset)??0),EA[1]=i.top+((e==null?void 0:e.pageYOffset)??0),EA}function r9(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function kke(t){const e=document.createElement("div");return t.appendChild(e),e}const X_=16,BT=750,Lke=512,Ake=2,Oke=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:X_,time:BT},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([N(()=>this.cursor,r=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",r)}),N(()=>this.navigating,r=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",r.toString())})])}initialize(){this.addHandles([N(()=>this.ui,(i,r)=>this._handleUIChange(i,r),be),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=xe(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const r=this._get("container"),n=L4(i);if(n||typeof i!="string"||U.getLogger(this).error("#container",`element with id '${i}' not found`),r===n)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(r9(this.root),this._set("root",null)),this.userContent&&(q8(this.userContent,r),r9(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",q8(n,s),n.appendChild(s),this._set("userContent",s);const o=document.createElement("div");o.className="esri-view-root",n.insertBefore(o,n.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const u=new i9;o.appendChild(u.surface),this._set("overlay",u),this.addHandles(N(()=>u.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=yb({render:()=>{var p;return(p=this.overlay)==null?void 0:p.render()}}):this._overlayRenderTaskHandle=Kt(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,r,n){const s=this.position;return i-=s?s[0]:0,r-=s?s[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}containerToPage(i,r,n){const s=this.position;return i+=s?s[0]:0,r+=s?s[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(N(()=>this.root,n=>{i.container=n?kke(n):null},be),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=X_,i.time=BT,this.addHandles([O$(window,"resize",()=>{i.freq=X_,i.time=BT}),yb({prepare:r=>{const n=this._measure(),s=this._freqInfo;if(s.time+=r.deltaTime,n&&(s.freq=X_,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const o=this._position();s.freq=o||n?X_:Math.min(BT,s.freq*Ake),!n&&s.freq>=Lke&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,n=i?i.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,o=this.height;return r===s&&n===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:o,width:r,height:n}),!0)}_position(){const i=this.container,r=this.position,n=i&&Cke(i);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return l([c()],e.prototype,"container",null),l([c({readOnly:!0})],e.prototype,"focused",null),l([c({readOnly:!0})],e.prototype,"height",void 0),l([c()],e.prototype,"messagesCommon",void 0),l([c({type:i9})],e.prototype,"overlay",void 0),l([c({readOnly:!0})],e.prototype,"position",void 0),l([c({readOnly:!0})],e.prototype,"resizing",void 0),l([c({readOnly:!0})],e.prototype,"root",void 0),l([c({value:null,readOnly:!0})],e.prototype,"size",null),l([c({readOnly:!0})],e.prototype,"surface",void 0),l([c({readOnly:!0})],e.prototype,"suspended",void 0),l([c()],e.prototype,"ui",void 0),l([c({readOnly:!0})],e.prototype,"userContent",void 0),l([c({readOnly:!0})],e.prototype,"width",void 0),l([c()],e.prototype,"widthBreakpoint",void 0),e=l([$("esri.views.DOMContainer")],e),e},ire=G("mac")?"Meta":"Control",Rke=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),Pke=t=>Rke.has(t);let Fke=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}},Kr=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,r){let n;typeof i=="function"?(r=i,n=[]):n=i||[];const s=typeof e=="string"?new Fke(e,n):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=p=>{const h=this._incoming[p.match.eventType];if(h){const m=h.indexOf(p);h.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},u=new Nke(s,r,{onPause:a,onRemove:a,onResume:p=>{const h=this._incoming[p.match.eventType];h&&!h.includes(p)&&(h.push(p),o(),this._manager&&this._manager.updateDependencies())}});let d=this._incoming[s.eventType];return d||(d=[],this._incoming[s.eventType]=d),d.push(u),o(),this._manager&&this._manager.updateDependencies(),u}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new Dke(e,{onEmit:(r,n,s,o)=>{var a;(a=this._manager)==null||a.emit(r.eventType,n,s,o)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){var r;const i=this._incoming[e.type];if(i){for(const n of i)if(n.match.matches(e)&&((r=n.callback)==null||r.call(n,e),e.shouldStopPropagation()))break}}},Nke=class{constructor(e,i,r){this.match=e,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Dke=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,r){this._removed||this._handler.onEmit(this,e,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},Vke=class extends Kr{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>this._update(i.data))}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=e;i===this._value&&this._x===r&&this._y===n||(this._value=i,this._x=r,this._y=n,this._onChange(i,r,n))}},Uke=class{constructor(e,i){this._observable=new a_,this._value=e,this._equalityFunction=i}get value(){return he(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function h$(t,e=tV){return new Uke(t,e)}let jke=class extends Kr{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=h$(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Gke=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in e){const n=e[r],s=new RZ(n,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=Hpe(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const r of i.acquired)tG(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),r=this._properties[e];let n=r.pool.acquire();for(r.acquired.push(n);n===i;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const e in this._properties){const i=this._properties[e];let r=0;for(const n of i.acquired)tG(n)?i.acquired[r++]=n:i.pool.release(n);i.acquired.length=r}}},ga=class extends q{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=ire,this._latestPointerType="mouse",this._propertiesPool=new Gke({latestPointerLocation:Hke},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,r=yt.INTERNAL){if(this._nameToGroup[e]||i.length===0)return;const n={name:e,handlers:i.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let s=n.handlers.length-1;s>=0;s--){const o=n.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,u,d,p,h)=>{this._emitInputEvent(o.priorityIndex+1,a,u,d,h,p)},setPointerCapture:(a,u)=>{this._setPointerCapture(n,o,a,u)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(r=>{var n;r.removed=!0,(n=r.uninstallCallback)==null||n.call(r)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):U.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const n=this._handlersPriority[r];n.priorityIndex=r;let s=n.handler.hasSideEffects;if(!s){for(const o of n.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of n.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)Pke(a)||i.add(a)}n.active=s}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,r){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(n==null||n.x!==i||n.y!==r){const s=this._propertiesPool.get("latestPointerLocation");s.x=i,s.y=r,this._set("latestPointerLocation",s)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const s=i;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,i);const r=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,n=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,r,n)}_updateKeyModifiers(e,i){if(!i)return;let r=!1;const n=()=>{r||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),r=!0)},s=(a,u)=>{u&&!this._activeKeyModifiers.has(a)?(n(),this._activeKeyModifiers.add(a)):!u&&this._activeKeyModifiers.has(a)&&(n(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=i.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=i.native;s("Alt",!!(o!=null&&o.altKey)),s("Control",!!(o!=null&&o.ctrlKey)),s("Ctrl",!!(o!=null&&o.ctrlKey)),s("Shift",!!(o!=null&&o.shiftKey)),s("Meta",!!(o!=null&&o.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Vke((e,i,r)=>this._setLatestPointer(e,i,r)),this._multiTouchHandler=new jke,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],yt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,yt.INTERNAL)}_setPointerCapture(e,i,r,n){const s=e.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),n?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,r,n){this._emitInputEvent(0,e,i,r,n)}_emitInputEvent(e,i,r,n,s,o){const a=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),u=s!==void 0&&s,d={event:new zke(i,r,a,o||this._activeKeyModifiers,u),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(d):this._doNewPropagation(d)}_doNewPropagation(e){this._currentPropagation={events:new Nb,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,r,n;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:s,priorityIndex:o}=e.events.pop(),a=(i=s.data)==null?void 0:i.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!s.shouldStopPropagation()&&((n=(r=e.currentHandler).eventCallback)==null||n.call(r,s)),s.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(s.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:s,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new Nb;i.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)i.push(r.events.pop());r.events=i,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const n of i.handler.incomingEventMatches){if(r.eventType!==n.eventType)continue;const s=r.keyModifiers.filter(o=>n.keyModifiers.includes(o));if(s.length===r.keyModifiers.length!=(s.length===n.keyModifiers.length))return r.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const r of e){let n=0;for(;n<i.length&&this._compareHandlerPriority(r,i[n])>=0;)n++;i.splice(n,0,r)}return i}get debug(){const e=i=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=r};return{injectEvent:(i,r)=>{e(()=>this._onEventReceived(i,r))},disablePointerCapture:e}}};l([c({readOnly:!0})],ga.prototype,"hasPendingInputs",null),l([c({constructOnly:!0})],ga.prototype,"eventSource",void 0),l([c({constructOnly:!0})],ga.prototype,"recognizers",void 0),l([c()],ga.prototype,"_latestPointerType",void 0),l([c()],ga.prototype,"latestPointerType",null),l([c()],ga.prototype,"multiTouchActive",null),l([c({readOnly:!0})],ga.prototype,"latestPointerLocation",void 0),l([c()],ga.prototype,"_paused",void 0),l([c({readOnly:!0})],ga.prototype,"updating",null),ga=l([$("esri.views.input.InputManager")],ga);let zke=class{constructor(e,i,r,n,s){this.type=e,this.data=i,this.timestamp=r,this.modifiers=n,this.cancelable=s,this._propagationState=Gh.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Gh.STOPPED}shouldStopPropagation(){return!!(this._propagationState&Gh.STOPPED)}async(e){this._propagationState|=Gh.PAUSED;const i=(r,n)=>{this._propagationState&=~Gh.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),n)throw r;return r};return(typeof e=="function"?e():e).then(r=>i(r,!1),r=>i(r,!0))}shouldPausePropagation(e){return!!(this._propagationState&Gh.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Gh;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Gh||(Gh={}));const yt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Bke=class{};const Hke=Bke;function Np(t){return t!=null&&"open"in t&&"declaredClass"in t}function n9(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const qke=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([N(()=>[this.ui,this.popup],([i,r],n)=>{const s="popup",o="manual";if(n){const[a,u]=n;a&&Np(u)&&(u.view=null,n9(u)&&a.remove(u,s))}i&&Np(r)&&(r.view=this,n9(r)&&i.add(r,{key:s,position:o,internal:!0}))},be),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Np(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),Np(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)}))},yt.WIDGET)]),wi(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{k(()=>import("./Popup-Dve3xjU3.js"),__vite__mapDeps([161,156,72,70,71,26,25,27,22,159]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Np(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void U.getLogger(this).error(new L("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),Np(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,r){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,r),r)}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!Np(this.popup))return this._popupSetupTask=Xo(async r=>{const{default:n}=await k(()=>import("./Popup-Dve3xjU3.js"),__vite__mapDeps([161,156,72,70,71,26,25,27,22,159]));if(qe(r),!this.popup||Np(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new n(s)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:r},n){const s=[],o=[];let a=!1;const u=Epe(n,G("popup-view-fetch-timeout")??Zke),d=m=>{const y=new Wke(m);return o.push(y),s.push(y.promise),y},p=m=>{const y=o.at(-1);return y&&y.layerView===m&&!a?y:d(m)};for(const m of r)"graphic"in m?(p(m.layerView).graphics.push(m.graphic),a=!1):(s.push(m.layerView.fetchPopupFeaturesAtLocation(m.mapPoint,u)),a=!0);o.map(m=>m.resolve(u));const h=$pe(s).then(m=>m.filter(y=>!!y).flat());return{pendingFeatures:s,allGraphicsPromise:h,location:i}}async _getPopupHits(i,r){const{hits:n,location:s}=await this.popupHitTest(i);qe(r);const o=[];for(const a of n)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,r)){const u=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:u})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:s}}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r==null?void 0:r.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return l([c()],e.prototype,"popup",void 0),l([c()],e.prototype,"popupEnabled",void 0),e=l([$("esri.views.PopupView")],e),e};let Wke=class{constructor(e){this.layerView=e,this._resolver=fn(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:i,graphics:r,_resolver:n}=this;if(!i)return n.resolve(r),n.promise;let s;return i.fetchPopupFeaturesFromGraphics(r,e).catch(o=>(s=o,null)).then(o=>{o?n.resolve(o):n.reject(s)}),n.promise}};const Zke=5e3;let ES=class extends Y{constructor(e){super(e),this.addHandles([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Y.ofType(this.itemType.Type))(e):new Y(e)}};function fN(t,e){return{type:t,cast:RJ,set(i){const r=up(i,this._get(e),t);r.owner=this,this._set(e,r)}}}l([c()],ES.prototype,"owner",null),ES=l([$("esri.core.support.OwningCollection")],ES);let M2=class extends ES{constructor(e){super(e),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(U.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};M2=l([$("esri.support.AnalysesCollection")],M2);let Ty=class extends ES{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};l([SV({Type:Li,ensureType:pi(Li)})],Ty.prototype,"itemType",void 0),Ty=l([$("esri.support.GraphicsCollection")],Ty);let yh=class extends q{constructor(e){super(e),this.view=null,this.baseLayerViews=new Y,this.referenceLayerViews=new Y,this._loadingHandle=N(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap},i=>{i&&i.load().catch(()=>{})},be)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,r,n;if((i=this.view)!=null&&i.suspended)return!1;const e=(n=(r=this.view)==null?void 0:r.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};l([c({constructOnly:!0})],yh.prototype,"view",void 0),l([c({readOnly:!0})],yh.prototype,"baseLayerViews",void 0),l([c({readOnly:!0})],yh.prototype,"referenceLayerViews",void 0),l([c({readOnly:!0})],yh.prototype,"suspended",null),l([c({type:Boolean,readOnly:!0})],yh.prototype,"updating",null),yh=l([$("esri.views.BasemapView")],yh);const Jke=yh;function Yke(t){return"tryRecycleWith"in t}function Kke(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Xke=class{constructor(e,i,r){this.layer=e,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=fn(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,ks(this._controller.signal,()=>{const n=new L("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}tryRecycle(e){if(!this.done||!this.layerView||!Yke(this.layerView))return null;const i=this.layer.type,r=this._controller.signal;for(let n=0;n<e.length;n++){const s=e[n];if(s.type!==i)continue;const o=this.layerView.tryRecycleWith(s,{signal:r});if(o){e.splice(n,1),this.layer=s;const a=this.layerView,u=a.view;return this.promise=Promise.race([o.then(()=>(qe(this._controller.signal),s.emit("layerview-destroy",{view:u,layerView:a}),u.emit("layerview-destroy",{view:u,layerView:a}),s.emit("layerview-create",{view:u,layerView:a}),u.emit("layerview-create",{view:u,layerView:a}),a)),new Promise((d,p)=>ks(this._controller.signal,()=>p(mt())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var n,s;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:r}=this;this._map=r.map;try{let o,a;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),eLe(i))o=await i.createLayerView(r,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new L("layer:view-not-supported","No layerview implementation was found");const p=await this.layerViewImporter.importLayerView(i);qe(e),o="default"in p?new p.default({layer:i,view:r}):new p({layer:i,view:r})}const u=()=>{a=Kt(a),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};a=ks(e,u),qe(e);try{await o.when()}catch(p){throw u(),p}if(!((s=(n=this._map)==null?void 0:n.allLayers)==null?void 0:s.includes(i)))return u(),void this._deferred.reject(new L("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=o,i.emit("layerview-create",{view:r,layerView:o}),r.emit("layerview-create",{layer:i,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){i.emit("layerview-create-error",{view:r,error:o}),r.emit("layerview-create-error",{layer:i,error:o}),this.done=!0,this._deferred.reject(new L("layerview:create-error","layerview creation failed",{layer:i,error:o}))}}},va=class extends q{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Wo,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const i=(r=this.view.map)==null?void 0:r.allLayers;if(i)for(const n of i)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=fn(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(P$(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var u,d,p;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,n=[],s=this.view.ready,o=h=>{if(h!=null){for(const m of h)if(m){r.add(m);const y=this._layerLayerViewInfoMap.get(m);y&&s?y.start():y||this._recyclingInfoMap.has(m)||n.push(m),"layers"in m&&m.layers&&o(m.layers)}}};for(const h of this._rootCollectionNames)o(rs(this,h));for(const[h,m]of this._layerLayerViewInfoMap)if(!r.has(h)){this._layerLayerViewInfoMap.delete(m.layer);const y=m.tryRecycle(n);y?(this.notifyChange("updating"),this._recyclingInfoMap.set(m.layer,m),y.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),this._layerLayerViewInfoMap.set(m.layer,m),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),m.destroy(),this._reschedule()})):m.destroy()}for(const[h,m]of this._recyclingInfoMap)r.has(h)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),m.destroy());for(const h of n)this._createLayerView(h);this._refreshCollections();const a=[(u=i==null?void 0:i.ground)==null?void 0:u.layers,(d=i==null?void 0:i.basemap)==null?void 0:d.baseLayers,(p=i==null?void 0:i.basemap)==null?void 0:p.referenceLayers,i==null?void 0:i.layers].filter(h=>!!h);r.forEach(h=>"layers"in h&&a.push(h.layers)),this.addHandles(a.map(h=>this._watchUpdatingTracking.addOnCollectionChange(()=>h,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([St(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),N(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),gt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),AL(this._recyclingInfoMap),AL(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(mt()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||Xpe(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(AL(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new L("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,i){var s;this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(e);if(!(r!=null&&r.done))return!0;const n=r.layerView;return!(!n||!i||n.parent===i)||!!(r.done&&n&&"layers"in e&&((s=e.layers)!=null&&s.length))&&e.layers.some(o=>this.isCreatingLayerViewsForLayer(o,n))}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(rs(this,e),rs(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,r){if(!e||!i)return void(i&&i.removeAll());let n=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!(o!=null&&o.layerView))continue;const a=o.layerView;a.layer=s,a.parent=r,i.at(n)!==a&&i.splice(n,0,a),"layers"in s&&Kke(a)&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),n+=1}n<i.length&&i.splice(n,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new Xke(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),r=>{r&&(rr(r)||r.name==="cancelled:layerview-create")||U.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};l([c()],va.prototype,"_workPromise",void 0),l([c({readOnly:!0})],va.prototype,"_watchUpdatingTracking",void 0),l([c({readOnly:!0})],va.prototype,"_layersToLayerViews",null),l([c({readOnly:!0})],va.prototype,"_rootCollectionNames",null),l([c()],va.prototype,"layerViewImporter",void 0),l([c()],va.prototype,"supportsGround",void 0),l([c({readOnly:!0})],va.prototype,"updating",null),l([c({readOnly:!0})],va.prototype,"updatingRemaining",null),l([c({constructOnly:!0})],va.prototype,"view",void 0),va=l([$("esri.views.LayerViewManager")],va);const Qke=va;function eLe(t){return"createLayerView"in t&&t.createLayerView!=null}let xo=class extends q{constructor(e){super(e),this.factor=1.5,this.offset=Mi(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};l([c({type:Number})],xo.prototype,"factor",void 0),l([c({nonNullable:!0})],xo.prototype,"offset",void 0),l([c()],xo.prototype,"position",void 0),l([c({type:Number,range:{min:0}})],xo.prototype,"size",void 0),l([c()],xo.prototype,"maskUrl",void 0),l([c()],xo.prototype,"maskEnabled",void 0),l([c()],xo.prototype,"overlayUrl",void 0),l([c()],xo.prototype,"overlayEnabled",void 0),l([c({readOnly:!0})],xo.prototype,"version",null),l([c({type:Boolean})],xo.prototype,"visible",void 0),xo=l([$("esri.views.Magnifier")],xo);const rre=xo;let ip=class{constructor(e){this._observable=new a_,this._map=new Map(e)}get size(){return he(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const i=this._map.delete(e);return i&&this._observable.notify(),i}entries(){return he(this._observable),this._map.entries()}forEach(e,i){he(this._observable),this._map.forEach((r,n)=>e.call(i,r,n,this),i)}get(e){return he(this._observable),this._map.get(e)}has(e){return he(this._observable),this._map.has(e)}keys(){return he(this._observable),this._map.keys()}set(e,i){return this._map.set(e,i),this._observable.notify(),this}values(){return he(this._observable),this._map.values()}[Symbol.iterator](){return he(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};function HT(t){return!!(t!=null&&typeof t=="object"&&"createQuery"in t&&t.createQuery&&"on"in t&&t.on)}let fd=class extends ji.EventedAccessor{constructor(e){super(e),this._selectionMap=new ip,this._sources=new Y,this._trashCan=[],this._layerEditHandles=new Y,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([N(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),St(()=>this.sources,"change",i=>{const r=this._selectionMap;for(const n of i.removed)r.delete(n);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new Y;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(i=>"sublayers"in i&&i.sublayers?i.sublayers:null).forEach(i=>{(HT(i)&&!DV(i)||ef(i))&&e.add(i)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(Kt)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[i,r]=e;return{layer:i,selection:[...r.selection]}})}get count(){let e=0;for(const i of this._selectionMap.values())e+=i.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){up(e,this._sources)}async getSelectedFeatures(e,i={},r="layerView"){const{view:n,selections:s}=this,o=(e!==void 0?s.filter(a=>e.includes(a.layer)):s).filter(a=>a.selection.length>0).map(async a=>{const{layer:u,selection:d}=a,p=ef(u)?u.parent:u;if(p==null||!o9(p))return null;if(r==="layer")return a9(p,d,i);if(s9(p))return null;const h=await n.whenLayerView(p).catch(()=>null);return h?a9(h,d,i):null});return(await Promise.all(o)).filter(a=>a!=null)}updateSelection(e){const i=new Map;for(const[s,o]of this._selectionMap)i.set(s,[...o.selection]);let r=!1;const n=e.current.concat(e.added);for(const s of n){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(HT(o)||ef(o))&&a!==null){const u=Xd(i,o,()=>[]);u.includes(a)||(u.push(a),r=!0)}}for(const s of e.removed){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(HT(o)||ef(o))&&a!==null){const u=i.get(o),d=u==null?void 0:u.indexOf(a);d!==void 0&&d>=0&&(u==null||u.splice(d,1),r=!0)}}if(r){const{_selectionMap:s,_trashCan:o}=this,a=[];for(const[u,d]of i){const p=s.get(u);p!==void 0&&o.push(p),s.set(u,{selection:d}),a.push({layer:u,selection:d,...RO(p!==void 0?p.selection:[],d)})}this._onSelectionChange(a)}}setSelection(e,i){this._setSelection(e,i)}getSelection(e){const i=this._selectionMap.get(e);return i==null?void 0:i.selection}appendToSelection(e,i){const r=this._selectionMap.get(e),n=r!==void 0?[...r.selection]:[];for(const s of i)n.includes(s)||n.push(s);this._setSelection(e,n)}removeFromSelection(e,i){const r=this._selectionMap.get(e);if(!r)return;const n=[];for(const s of r.selection)i.includes(s)||n.push(s);this._setSelection(e,n)}toggleInSelection(e,i){const r=this._selectionMap.get(e);if(!r||r.selection.length===0)return void this._setSelection(e,i);const n=new Set(r.selection),s=new Set(i),o=Npe(n,s);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const i=[];for(const[r,n]of this._selectionMap.entries())i.push({layer:r,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var o;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const a=this._trashCan.pop();(o=a==null?void 0:a.highlightHandle)==null||o.remove()}const{sources:e,view:i,_selectionMap:r,showHighlight:n}=this,s=this._vizTaskId;for(const a of e){const u=r.get(a),d=ef(a)?a.parent:a;if(d!=null&&o9(d)){if(s9(d))continue;i.whenLayerView(d).then(p=>{var h;(h=u==null?void 0:u.highlightHandle)==null||h.remove(),u!=null&&n&&s===this._vizTaskId&&"highlight"in p&&typeof p.highlight=="function"&&u.selection.length>0&&(u.highlightHandle=p.highlight(u.selection,"selection"))}).catch(()=>{var p;(p=u==null?void 0:u.highlightHandle)==null||p.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(Kt);for(const e of this.sources){const i=ef(e)?e.parent:e;if(i!=null&&HT(i)){const r=i.on("edits",n=>{this._handleEditChanges(n,e)});this._layerEditHandles.push(r)}}}_handleEditChanges(e,i){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(i)){const r=e.deletedFeatures.filter(n=>n.error==null).map(n=>n.objectId).filter(ot);this.removeFromSelection(i,r)}}_setSelection(e,i){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const r=this._selectionMap.get(e);if(r===void 0||!iLe(r,{selection:i})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(e,{selection:[...i]});const n={layer:e,selection:[...i],...RO(r!==void 0?r.selection:[],i)};this._onSelectionChange([n])}}};l([c({readOnly:!0,nonNullable:!0})],fd.prototype,"selections",null),l([c({readOnly:!0,nonNullable:!0})],fd.prototype,"count",null),l([c({constructOnly:!0,nonNullable:!0})],fd.prototype,"view",void 0),l([c({readOnly:!0,nonNullable:!0})],fd.prototype,"hasSelection",null),l([c()],fd.prototype,"showHighlight",void 0),l([c()],fd.prototype,"sources",null),fd=l([$("esri.views.SelectionManager")],fd);const s9=t=>{var e;return ef(t)?((e=t.parent)==null?void 0:e.isTable)===!0:t.isTable},tLe=t=>t.layer!==void 0,o9=t=>(t==null?void 0:t.when)!==void 0,iLe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],r=[...e.selection];if(i.length!==r.length)return!1;i.sort(),r.sort();for(let n=0;n<i.length;n++)if(i[n]!==r[n])return!1}return!0},a9=async(t,e,i={})=>{let r;if(tLe(t)){const n=t;r=n===void 0?null:await n.queryFeatures(new gu({...i,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const n=t;r=n===void 0?null:await n.queryFeatures(new gu({...i,objectIds:e})).then(s=>({data:s,layer:n}))}return r},rLe=fd;let L1=class extends Ze(q){constructor(e){super(e),this.accentColor=new ee([255,127,0]),this.textColor=new ee([255,255,255])}};l([c({type:ee,nonNullable:!0})],L1.prototype,"accentColor",void 0),l([c({type:ee,nonNullable:!0})],L1.prototype,"textColor",void 0),L1=l([$("esri.views.Theme")],L1);const yN=L1;var l9;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(l9||(l9={}));const nre=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],sre={};function ore(t){return!!sre[t]}function nLe(t){for(const e of t)if(!ore(e))return!1;return!0}nre.forEach(t=>{sre[t]=!0});let sLe=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:r},n)=>{var s;return(s=this.inputManager)==null?void 0:s.installHandlers(n,[i],r)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var r;return(r=this.inputManager)==null?void 0:r.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,r,n){const s=Array.isArray(e)?e:e.split(",");if(!nLe(s))return s.some(ore)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(i)?a=i:(o=i,a=[]),typeof r=="function"?o=r:n=r,n=n??yt.DEFAULT;const u=this._createUniqueGroupName(),d=new oLe(this.view,s,a,o);this._handlers.set(u,{handler:d,priority:n});for(const p of s){const h=this._handlerCounts.get(p)||0;this._handlerCounts.set(p,h+1)}return this.inputManager&&this.inputManager.installHandlers(u,[d],n),ye(()=>this._removeHandler(u,s))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of i){const n=this._handlerCounts.get(r);n===void 0||(n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},oLe=class extends Kr{constructor(e,i,r,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of i)switch(s){case"click":this.registerIncoming("click",r,o=>n(uLe(e,o)));break;case"double-click":this.registerIncoming("double-click",r,o=>n(cLe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",r,o=>n(dLe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,o=>n(pLe(e,o)));break;case"hold":this.registerIncoming("hold",r,o=>n(hLe(e,o)));break;case"drag":this.registerIncoming("drag",r,o=>{const a=this._wrapDrag(o);a&&n(a)});break;case"key-down":this.registerIncoming("key-down",r,o=>n(mLe(o)));break;case"key-up":this.registerIncoming("key-up",r,o=>n(fLe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",r,o=>n(Q_(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,o=>n(Q_(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,o=>n(Q_(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,o=>n(yLe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,o=>n(gLe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,o=>n(Q_(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,o=>n(Q_(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,o=>{n(vLe(o))});break;case"focus":this.registerIncoming("focus",r,o=>{n(aLe(o))});break;case"blur":this.registerIncoming("blur",r,o=>{n(lLe(o))})}}_wrapDrag(e){const i=e.data,{x:r,y:n}=i.center,{action:s,pointerType:o,button:a}=i;if(s==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const u=i.pointer.native,d=i.buttons,{cancelable:p,timestamp:h}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:n,origin:m,pointerType:o,button:a,buttons:d,radius:i.radius,angle:vY(i.angle),native:u,timestamp:h,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:y=>e.async(y),preventDefault:()=>e.preventDefault()}}};function aLe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function lLe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function uLe(t,e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"click",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:p,screenPoint:Mi(s,o),mapPoint:dE(t,s,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function cLe(t,e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"double-click",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:p,mapPoint:dE(t,s,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function dLe(t,e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:u}=e.data,d=a.pointerId,{cancelable:p,timestamp:h}=e;return{type:"immediate-click",pointerId:d,pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:h,mapPoint:dE(t,s,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}function pLe(t,e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:u}=e.data,d=a.pointerId,{cancelable:p,timestamp:h}=e;return{type:"immediate-double-click",pointerId:d,pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:h,mapPoint:dE(t,s,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}function hLe(t,e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a}=e.data,{cancelable:u,timestamp:d}=e;return{type:"hold",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:d,mapPoint:dE(t,s,o),cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}function dE(t,e,i){return t.toMap(Mi(e,i),{exclude:[]})}function mLe(t){const{key:e,repeat:i,native:r}=t.data,{cancelable:n,timestamp:s}=t;return{type:"key-down",key:e,repeat:i,native:r,timestamp:s,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}function fLe(t){const{key:e,native:i}=t.data,{cancelable:r,timestamp:n}=t;return{type:"key-up",key:e,native:i,timestamp:n,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:s=>t.async(s),preventDefault:()=>t.preventDefault()}}function Q_(t,e){const{x:i,y:r,button:n,buttons:s,native:o,eventId:a}=t.data,u=o.pointerId,d=o.pointerType,{cancelable:p,timestamp:h}=t;return{type:e,x:i,y:r,pointerId:u,pointerType:d,button:n,buttons:s,native:o,timestamp:h,eventId:a,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:m=>t.async(m),preventDefault:()=>t.preventDefault()}}function yLe(t){const{x:e,y:i,buttons:r,native:n,eventId:s}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,u=t.data.startEvent.native.pointerType,d=t.data.action,p={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:m}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:u,button:o,buttons:r,action:d,origin:p,native:n,timestamp:m,eventId:s,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:y=>t.async(y),preventDefault:()=>t.preventDefault()}}function gLe(t){const{cancelable:e,data:i,timestamp:r}=t,{x:n,y:s,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:n,y:s,deltaY:o,native:a,timestamp:r,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:u=>t.async(u),preventDefault:()=>t.preventDefault()}}function vLe(t){const{action:e,state:i,device:r}=t.data,{cancelable:n,timestamp:s}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:r,timestamp:s,action:e,buttons:o,axes:a,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:u=>t.async(u),preventDefault:()=>t.preventDefault()}}var m$,u9,c9;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(m$||(m$={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(u9||(u9={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(c9||(c9={}));function bLe(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return U.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function gN(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(m$.USER)&&t.getEditableFlag(m$.MANAGER)}function Oa(t){return Mi(t.x,t.y)}function are(t,e){var r;const i=(r=t instanceof HTMLElement?t:t.surface)==null?void 0:r.getBoundingClientRect();return i?Mi(e.clientX-i.left,e.clientY-i.top):Mi(0,0)}function lre(t,e){return e instanceof Event?are(t,e):Oa(e)}function ure(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let _Le=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":p9(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!h9(e))break;const n=Oa(e),s=Tg(n,e.pointerType,i.forEachTool);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,i),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!h9(e))break;const n=this._grabbedManipulators.get(e.pointerId),s=n==null?void 0:n.manipulator,o=n==null?void 0:n.tool;if(s==null||o==null)break;const a=Oa(e);a.x=fr(a.x,0,i.view.width),a.y=fr(a.y,0,i.view.height);const u=n.start,d=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,d?s.events.emit("drag",{action:"update",start:u,screenPoint:a}):s.events.emit("drag",{action:"start",start:u,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:u}));break;case"end":s.dragging=!1,d&&s.events.emit("drag",{action:"end",start:u,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}r();break}case"immediate-click":{const n=Oa(e),s=Tg(n,e.pointerType,i.forEachTool);if(wLe(e)||i.forEachTool(d=>{if((s==null||s.tool!==d||d.automaticManipulatorSelection)&&d.manipulators){let p=!1;d.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,p=!0)}),p&&d.onManipulatorSelectionChanged&&d.onManipulatorSelectionChanged()}}),s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const u=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:u,stopPropagation:r}),TA(o,r);break}case"click":{const n=Oa(e),s=Tg(n,e.pointerType,i.forEachTool),o=s==null?void 0:s.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a}),r();break}case"double-click":{const n=Oa(e),s=Tg(n,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),TA(o,r);break}case"immediate-double-click":{const n=Oa(e),s=Tg(n,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),e.pointerType==="mouse"&&TA(o,r);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(e,i,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:Oa(i)}),this._grabbedManipulators.forEach(({manipulator:n},s)=>{n===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(e,i){var n;const r=(n=this._grabbedManipulators.get(e.pointerId))==null?void 0:n.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Oa(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=d9(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=d9(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{i.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),e(n=>{n.hasGrabbedManipulators=i.has(n),n.hasHoveredManipulators=r.has(n);const s=this._grabbedManipulators.values(),o=qde(s,({tool:a})=>a===n);n.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:r},n=!0,s){const o=(a,u)=>a===e&&(s==null||s===u);this._grabbedManipulators.forEach(({tool:a,manipulator:u,pointerType:d},p)=>{o(a,u)&&(this._grabbedManipulators.delete(p),u.grabbing=!1,u.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:d}))}),this._draggedManipulators.forEach(({tool:a,manipulator:u},d)=>{o(a,u)&&(this._draggedManipulators.delete(d),u.dragging=!1,u.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:a,manipulator:u},d)=>{o(a,u)&&(this._hoveredManipulators.delete(d),u.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Mi(i.x,i.y),r,i.pointerType,e)})}handleHoverEvent(e,i){const r=e.type;r!=="pointer-up"&&r!=="immediate-click"&&r!=="pointer-move"||!p9(e.pointerType)||(r!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Oa(e),e.pointerId,e.pointerType,i))}_updateHoveredStateForPointerAtScreenPosition(e,i,r,n){var a;let s=Tg(e,r,n);const o=(a=this._hoveredManipulators.get(i))==null?void 0:a.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(i,s)):this._hoveredManipulators.delete(i),this._onFocusChange(n))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:i},r)=>{e===r&&(this._hoveredManipulators.delete(e),i.hovering=!1)})}};function d9(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function Tg(t,e,i){let r=null;return i(n=>{if(n.manipulators==null||!gN(n))return!1;const s=n.manipulators.intersect(t,e);return s!=null&&(r={tool:n,manipulator:s},!0)}),r}function p9(t){return t==="mouse"}function h9(t){return t.pointerType!=="mouse"||t.button===0}function wLe(t){return!!t.native.shiftKey}function TA(t,e){t!=null&&t.consumesClicks&&e()}const m9="attached",IA="tools",SLe=1e3;let Hu=class extends q{constructor(e){super(e),this._updatingHandles=new Wo,this._clock=t_,this._manipulatorState=new _Le,this.tools=new Y,this.cursor=null,this._interacting=!1,this._interactingTimeout=SLe,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const r of this.tools.items)if(i(r))return}}initialize(){this.addHandles([this.view.on(nre,e=>{this._handleInputEvent(e)},yt.TOOL),...bLe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void U.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const n=gN(r);this.activeTool!=null&&n||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Kt(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([N(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(r=>r.onElevationChange(i)))],m9):this.addHandles(N(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(m9),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:r})=>e(r,i))})}_handleInputEvent(e){let i=!1;const r={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(n=>{!i&&n.visible&&n.handleInputEvent(r)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(IA),this._forEachTool(e=>{if(e instanceof q){const i=N(()=>[e.cursor,e.visible,e.editable],()=>{gN(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,IA)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],IA)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,m$.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){}};l([c({constructOnly:!0,nonNullable:!0})],Hu.prototype,"view",void 0),l([c({value:null})],Hu.prototype,"activeTool",null),l([c({readOnly:!0,type:Y})],Hu.prototype,"tools",void 0),l([c({readOnly:!0})],Hu.prototype,"cursor",void 0),l([c({readOnly:!0})],Hu.prototype,"updating",null),l([c()],Hu.prototype,"_interacting",void 0),l([c({readOnly:!0})],Hu.prototype,"interacting",null),Hu=l([$("esri.views.ToolViewManager")],Hu);let Zv=class extends q{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":$Le.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return ELe[this.deviceType]}};l([c({nonNullable:!0,readOnly:!0})],Zv.prototype,"nativeIndex",void 0),l([c({type:String,readOnly:!0})],Zv.prototype,"deviceType",null),l([c({type:Number,readOnly:!0})],Zv.prototype,"axisThreshold",null),Zv=l([$("esri.views.input.gamepad.GamepadInputDevice")],Zv);const V4=Zv,$Le=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),ELe={standard:.15,spacemouse:.025,unknown:0};let A1=class extends q{constructor(...e){super(...e),this.devices=new Y,this.enabledFocusMode="document"}};l([c({type:Y.ofType(V4),readOnly:!0})],A1.prototype,"devices",void 0),l([c({type:["document","view","none"]})],A1.prototype,"enabledFocusMode",void 0),A1=l([$("esri.views.input.gamepad.GamepadSettings")],A1);const TLe=A1;let Qx=class extends q{constructor(){super(...arguments),this.gamepad=new TLe}};l([c({readOnly:!0})],Qx.prototype,"gamepad",void 0),Qx=l([$("esri.views.input.Input")],Qx);const ILe=Qx,cre=()=>et.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;let gh=class extends q{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};l([c({type:Boolean,nonNullable:!0})],gh.prototype,"enabled",void 0),l([c({type:V4})],gh.prototype,"device",void 0),l([c({type:["pan","zoom"],nonNullable:!0})],gh.prototype,"mode",void 0),l([c({type:["forward-down","forward-up"],nonNullable:!0})],gh.prototype,"tiltDirection",void 0),l([c({type:Number,nonNullable:!0})],gh.prototype,"velocityFactor",void 0),gh=l([$("esri.views.navigation.gamepad.GamepadSettings")],gh);const dre=gh;let Pf=class extends q{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new dre,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!cre()}};l([c({type:Boolean})],Pf.prototype,"browserTouchPanEnabled",void 0),l([c({type:dre,nonNullable:!0})],Pf.prototype,"gamepad",void 0),l([c({type:Boolean})],Pf.prototype,"momentumEnabled",void 0),l([c({type:Boolean})],Pf.prototype,"mouseWheelZoomEnabled",void 0),Pf=l([$("esri.views.navigation.Navigation")],Pf);const pre=Pf;function vtt(t,e,i){const r=hre(t),n=e,s=xLe(r,n,i);if(r){const o=uE.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!i&&o!==r.heightUnit){const a=new L("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new L("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!MLe(t)||s===Xs.Unsupported)return new L("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case Xs.Units:{const o=(r==null?void 0:r.heightUnit)||"unknown",a=(n==null?void 0:n.heightUnit)||"unknown",u=new L("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new L("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:u})}case Xs.HeightModel:{const o=(r==null?void 0:r.heightModel)||"unknown",a=(n==null?void 0:n.heightModel)||"unknown",u=new L("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new L("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:u})}case Xs.CRS:{const o=(r==null?void 0:r.vertCRS)||"unknown",a=(n==null?void 0:n.vertCRS)||"unknown",u=new L("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new L("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:u})}}return null}function xLe(t,e,i){if(!f9(t)||!f9(e))return Xs.Unsupported;if(t==null||e==null)return Xs.Ok;if(!i&&t.heightUnit!==e.heightUnit)return Xs.Units;if(t.heightModel!==e.heightModel)return Xs.HeightModel;switch(t.heightModel){case"gravity-related-height":return Xs.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?Xs.Ok:Xs.CRS;default:return Xs.Unsupported}}var Xs;function f9(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function MLe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!yre(t)}function hre(t){var r;if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?du(t.url):void 0;return!(((r=t.spatialReference)==null?void 0:r.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&mre(t)&&t.heightModelInfo?t.heightModelInfo:yre(t)?uE.deriveUnitFromSR(kLe,t.spatialReference):null}function mre(t){return"heightModelInfo"in t}function fre(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function yre(t){return fre(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):gre(t)}function CLe(t){return t.layers!=null||gre(t)||fre(t)||mre(t)}function gre(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"focusArea":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(Xs||(Xs={}));const kLe=new uE({heightModel:"gravity-related-height"});var mp;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(mp||(mp={}));let vN,xA=null;async function LLe(t){xA||(xA=k(()=>import("./geometryServiceUtils-CXXR2rKW.js"),[]).then(e=>vN=e)),await xA,qe(t)}async function vre(t,e,i,r){if(!t)return null;const n=t.spatialReference;return Ac()||Yo(n,e)?On(t,e):vN?vN.projectGeometry(t,e,i,r):(await Promise.race([LLe(r),$c(r)]),vre(t,e,i,r))}let Qt=class extends q{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=mr(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var r,n,s,o;const e=(r=this.map)==null?void 0:r.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),i}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,r=>{const n=this._getSupportedSpatialReferences(r);if(n.length>0){const s=this._narrowDownSpatialReferenceCandidates(e,n);s!=null&&(e=s)}return(e==null?void 0:e.length)===1})&&(e==null?void 0:e.length)!==1)return{updating:!0};const i=this._pickSpatialReferenceCandidate(e);return{spatialReference:(i==null?void 0:i.spatialReference)??null,viewingMode:(i==null?void 0:i.viewingMode)??null,updating:!1}}get _tileInfoTask(){var s,o;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=(s=this.map)==null?void 0:s.call(this),i=this.spatialReference;if(!i)return{updating:this._spatialReferenceTask.updating};let r;const n=this._collectLayers([{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.baseLayers},{layers:e==null?void 0:e.layers}],a=>{var u;return!(!("tileInfo"in a)||!((u=a.tileInfo)!=null&&u.spatialReference.equals(i)))&&(r=a,!0)},a=>"tileInfo"in a);return r?{tileInfo:r.tileInfo,updating:!1}:{updating:n}}get _heightModelInfoTask(){var r;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};let e={};const i=this._collectLayers(this.mapCollections,n=>{var o,a;const s=hre(n);return!!s&&(e={heightModelInfo:s,vcsWkid:(o=n.spatialReference)==null?void 0:o.vcsWkid,latestVcsWkid:(a=n.spatialReference)==null?void 0:a.latestVcsWkid},!0)},n=>CLe(n));return{...e,updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],i=this._collectLayers(this.mapCollections,r=>{const n="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),s=this.requiresExtentInSpatialReference?null:n[0],o=n.find(a=>a.spatialReference.equals(this.spatialReference))??s;if(o)return e.push({extent:o,layer:r}),!0;if(this._getSupportedSpatialReferences(r).length>0)for(const a of n)e.push({extent:a,layer:r});return!1});return{candidates:e,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),n=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=mr(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:n.clone(),task:Xo(async s=>{try{const o=await vre(r.extent,n,"portalItem"in r.layer?r.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(lo(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const r=new Array;for(const n of e)for(const s of i){if(!n.spatialReference.equals(s.spatialReference))continue;const o=OLe(n.viewingMode,s.viewingMode);if(o!==!1){r.push({spatialReference:n.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(i))&&(e=e.filter(({spatialReference:r})=>r.equals(i))),e.length>1&&e.some(({viewingMode:r})=>r!==mp.Local)&&(e=e.filter(({viewingMode:r})=>r!==mp.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const r=[];for(const n of i){const s=this.getSpatialReferenceSupport(n,e);if(s!=null){const o=s.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:a,viewingMode:u}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:u})}}return r}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:r})=>i.equals(r.spatialReference))||e[0]}_collectLayers(e,i,r=()=>!0){var s;if(this._loadMaybe((s=this.map)==null?void 0:s.call(this))!=="loaded")return!0;const n=new ALe(r,i);for(const o of e)if(this._collectCollection(o,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const r of e.layers)if(i.layerFilter(r)){switch(this._loadMaybe(r)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":if(i.updating||(i.done=i.pushLayer(r)),i.done||i.preloading===this.sourcePreloadCount)break;"layers"in r&&this._collectCollection({layers:r.layers},i)}if(i.done||i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{rr(i)}),"loading"):e.loadStatus:"loaded"}};l([c()],Qt.prototype,"required",void 0),l([c({constructOnly:!0})],Qt.prototype,"map",void 0),l([c({constructOnly:!0})],Qt.prototype,"getSpatialReferenceSupport",void 0),l([c()],Qt.prototype,"defaultSpatialReference",void 0),l([c()],Qt.prototype,"userSpatialReference",void 0),l([c()],Qt.prototype,"sourcePreloadCount",void 0),l([c()],Qt.prototype,"priorityCollection",void 0),l([c()],Qt.prototype,"requiresExtentInSpatialReference",void 0),l([c()],Qt.prototype,"suspended",void 0),l([c({readOnly:!0})],Qt.prototype,"ready",null),l([c({readOnly:!0})],Qt.prototype,"heightModelInfoReady",null),l([c({readOnly:!0})],Qt.prototype,"spatialReference",null),l([c({readOnly:!0})],Qt.prototype,"extent",null),l([c({readOnly:!0})],Qt.prototype,"heightModelInfo",null),l([c({readOnly:!0})],Qt.prototype,"vcsWkid",null),l([c({readOnly:!0})],Qt.prototype,"latestVcsWkid",null),l([c({readOnly:!0})],Qt.prototype,"viewingMode",null),l([c({readOnly:!0})],Qt.prototype,"tileInfo",null),l([c({readOnly:!0})],Qt.prototype,"mapCollections",null),l([c({readOnly:!0})],Qt.prototype,"_spatialReferenceTask",null),l([c({readOnly:!0})],Qt.prototype,"_tileInfoTask",null),l([c({readOnly:!0})],Qt.prototype,"_heightModelInfoTask",null),l([c({readOnly:!0})],Qt.prototype,"_extentCandidatesTask",null),l([c()],Qt.prototype,"_extentTask",null),l([c()],Qt.prototype,"_projectExtentTask",void 0),Qt=l([$("esri.views.support.DefaultsFromMap")],Qt);let ALe=class{constructor(e,i){this.layerFilter=e,this.pushLayer=i,this.preloading=-1,this.updating=!1,this.done=!1}};function OLe(t,e){return t!=null?e!=null?t===e&&t:t:e}var O1;let fe=O1=class extends ji.EventedMixin(l_(q)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new e_,this.updatingHandles=new Wo,this.allLayerViews=new JS({getCollections:()=>{var e,i,r;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:PLe}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Ty,this.analyses=new M2,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Y,this.magnifier=new rre,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new ILe,this.navigation=new pre,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new sLe(this),this.persistableViewModels=new Y,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(N(()=>this.preconditionsReady,e=>{var r,n;const i=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,O1.views.add(this)):(this._lockedSpatialReference=null,O1.views.remove(this)),this.notifyChange("spatialReference"),!e&&i)(r=this.toolViewManager)==null||r.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown();else if(e&&!i){try{this._startup()}catch(s){return void queueMicrotask(()=>{this.fatalError=new L("startup-error",null,s)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},yn))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,wi(()=>this.ready)))),this.basemapView=new Jke({view:this}),this.layerViewManager=new Qke({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Hu({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new rLe({view:this}),this.addHandles([N(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},gt),N(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},yn),N(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},gt)])}_setupSpatialReferenceLogger(){let t=null;this.addHandles([N(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var r;const i=((r=this.map)==null?void 0:r.allLayers.length)>0;if(e&&!this.spatialReference&&i){if(t!=null)return;const n=ye(()=>t=mr(t));t=Xo(async s=>{try{await i_(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{t=null}U.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(n,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var t,e;this.destroyed||(O1.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=xe(this.graphics),this.analyses=xe(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),xe(this.analysisViewManager),this.toolViewManager=xe(this.toolViewManager),this.layerViewManager=xe(this.layerViewManager),this.selectionManager=xe(this.selectionManager),this.basemapView=xe(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=xe(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return U.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Qt({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||uo.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(U.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),uo.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get spatialReference(){var e,i;const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)){const r=t.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return t}set spatialReference(t){const e=!ci(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Os}set timeZone(t){this._userTimeZone=t,Xbe(t)||U.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new yN}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new L("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&U.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(Hi(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};fe.views=new Y,l([c()],fe.prototype,"_userSpatialReference",void 0),l([c()],fe.prototype,"activeTool",null),l([c({readOnly:!0})],fe.prototype,"allLayerViews",void 0),l([c()],fe.prototype,"groundView",void 0),l([c()],fe.prototype,"animation",null),l([c()],fe.prototype,"basemapView",void 0),l([c()],fe.prototype,"center",null),l([c()],fe.prototype,"defaultsFromMapSettings",null),l([c()],fe.prototype,"defaultsFromMap",null),l([c()],fe.prototype,"fatalError",void 0),l([c({type:at})],fe.prototype,"extent",null),l([c(fN(Ty,"graphics"))],fe.prototype,"graphics",void 0),l([c(fN(M2,"analyses"))],fe.prototype,"analyses",void 0),l([c({readOnly:!0,type:uE})],fe.prototype,"heightModelInfo",null),l([c({readOnly:!0})],fe.prototype,"interacting",null),l([c({readOnly:!0})],fe.prototype,"navigating",null),l([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],fe.prototype,"preconditionsReady",null),l([c({readOnly:!0})],fe.prototype,"typeSpecificPreconditionsReady",void 0),l([c({type:Y,readOnly:!0})],fe.prototype,"layerViews",void 0),l([c()],fe.prototype,"resolution",null),l([c({type:rre})],fe.prototype,"magnifier",void 0),l([c({value:null,type:FX})],fe.prototype,"map",null),l([c()],fe.prototype,"padding",void 0),l([c({readOnly:!0})],fe.prototype,"ready",void 0),l([c({type:le})],fe.prototype,"spatialReference",null),l([c()],fe.prototype,"spatialReferenceWarningDelay",void 0),l([c()],fe.prototype,"stationary",null),l([c({readOnly:!0})],fe.prototype,"supportsGround",void 0),l([c({type:Pt})],fe.prototype,"timeExtent",null),l([c({type:String,nonNullable:!0})],fe.prototype,"timeZone",null),l([c()],fe.prototype,"tools",null),l([c()],fe.prototype,"toolViewManager",void 0),l([c({readOnly:!0})],fe.prototype,"type",void 0),l([c({type:Number})],fe.prototype,"scale",void 0),l([c({readOnly:!0})],fe.prototype,"updating",void 0),l([c({readOnly:!0})],fe.prototype,"initialExtentRequired",void 0),l([c({readOnly:!0})],fe.prototype,"initialExtent",null),l([c()],fe.prototype,"cursor",null),l([c({readOnly:!0})],fe.prototype,"input",void 0),l([c({type:pre,nonNullable:!0})],fe.prototype,"navigation",void 0),l([c()],fe.prototype,"layerViewManager",void 0),l([c()],fe.prototype,"analysisViewManager",void 0),l([c()],fe.prototype,"selectionManager",void 0),l([c()],fe.prototype,"width",void 0),l([c()],fe.prototype,"height",void 0),l([c({readOnly:!0})],fe.prototype,"resizing",void 0),l([c({value:null,readOnly:!0})],fe.prototype,"size",null),l([c({readOnly:!0})],fe.prototype,"suspended",void 0),l([c({readOnly:!0})],fe.prototype,"viewEvents",void 0),l([c({readOnly:!0})],fe.prototype,"persistableViewModels",void 0),l([c()],fe.prototype,"_isValid",void 0),l([c()],fe.prototype,"_readyCycleForced",void 0),l([c()],fe.prototype,"_lockedSpatialReference",void 0),l([c()],fe.prototype,"_userTimeZone",void 0),l([c()],fe.prototype,"_lockedTimeZone",void 0),l([c()],fe.prototype,"_userTimeExtent",void 0),l([c()],fe.prototype,"_lockedTimeExtent",void 0),l([c({type:yN})],fe.prototype,"theme",void 0),l([c({readOnly:!0,type:yN})],fe.prototype,"effectiveTheme",null),fe=O1=l([$("esri.views.View")],fe);const MA=globalThis.$arcgis;MA&&!MA.views&&Object.defineProperty(MA,"views",{configurable:!1,enumerable:!0,writable:!1,value:fe.views});const RLe=fe;function PLe(t){return t.layerViews}function pt(){return[0,0]}function FLe(t){return[t[0],t[1]]}function rp(t,e){return[t,e]}function NLe(t,e=pt()){const i=Math.min(2,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function DLe(t,e){return new Float64Array(t,e,2)}function bre(){return pt()}function _re(){return rp(1,1)}function wre(){return rp(1,0)}function Sre(){return rp(0,1)}const $re=bre(),VLe=_re(),ULe=wre(),Ere=Sre();Object.freeze(Object.defineProperty({__proto__:null,ONES:VLe,UNIT_X:ULe,UNIT_Y:Ere,ZEROS:$re,clone:FLe,create:pt,createView:DLe,fromArray:NLe,fromValues:rp,ones:_re,unitX:wre,unitY:Sre,zeros:bre},Symbol.toStringTag,{value:"Module"}));let vh=class extends KM{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=fn(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new L("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=kc(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};l([c({readOnly:!0})],vh.prototype,"done",null),l([c({readOnly:!0,type:String})],vh.prototype,"state",void 0),l([c()],vh.prototype,"target",void 0),vh=l([$("esri.views.ViewAnimation")],vh),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(vh||(vh={}));const bN=vh;function Q0(t,e){return t[0]=e[0],t[1]=e[1],t}function Tr(t,e,i){return t[0]=e,t[1]=i,t}function U4(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function Rr(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function Tre(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function Ire(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function jLe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function GLe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function zLe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function BLe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function HLe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function $_(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function pu(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t}function E_(t,e){const i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}function Ub(t,e){const i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}function jb(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function fp(t){const e=t[0],i=t[1];return e*e+i*i}function xre(t,e){return t[0]=-e[0],t[1]=-e[1],t}function qLe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function _N(t,e){const i=e[0],r=e[1];let n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function Cm(t,e){return t[0]*e[0]+t[1]*e[1]}function Mre(t,e,i){const r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t}function j4(t,e,i,r){const n=e[0],s=e[1];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t}function WLe(t,e=1){const i=2*z$()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function ZLe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n,t[1]=i[1]*r+i[3]*n,t}function hc(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n+i[4],t[1]=i[1]*r+i[3]*n+i[5],t}function JLe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[3]*n+i[6],t[1]=i[1]*r+i[4]*n+i[7],t}function YLe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}function KLe(t,e,i,r){const n=e[0]-i[0],s=e[1]-i[1],o=Math.sin(r),a=Math.cos(r);return t[0]=n*a-s*o+i[0],t[1]=n*o+s*a+i[1],t}function Cre(t,e){const i=t[0],r=t[1],n=e[0],s=e[1];let o=i*i+r*r;o>0&&(o=1/Math.sqrt(o));let a=n*n+s*s;a>0&&(a=1/Math.sqrt(a));const u=(i*n+r*s)*o*a;return u>1?0:u<-1?Math.PI:Math.acos(u)}function XLe(t){return"vec2("+t[0]+", "+t[1]+")"}function wN(t,e){return t[0]===e[0]&&t[1]===e[1]}function QLe(t,e){const i=t[0],r=t[1],n=e[0],s=e[1],o=qi();return Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))}function eAe(t,e,i,r,n){let s=e[0]-i[0],o=e[1]-i[1];const a=(r[0]*s+r[1]*o)*(n-1);return s=r[0]*a,o=r[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const tAe=jb,Rk=Rr,iAe=Tre,rAe=Ire,nAe=E_,sAe=Ub,oAe=fp;Object.freeze(Object.defineProperty({__proto__:null,add:U4,angle:Cre,ceil:jLe,copy:Q0,cross:Mre,dist:nAe,distance:E_,div:rAe,divide:Ire,dot:Cm,equals:QLe,exactEquals:wN,floor:GLe,inverse:qLe,len:tAe,length:jb,lerp:j4,max:BLe,min:zLe,mul:iAe,multiply:Tre,negate:xre,normalize:_N,projectAndScale:eAe,random:WLe,rotate:KLe,round:HLe,scale:$_,scaleAndAdd:pu,set:Tr,sqrDist:sAe,sqrLen:oAe,squaredDistance:Ub,squaredLength:fp,str:XLe,sub:Rk,subtract:Rr,transformMat2:ZLe,transformMat2d:hc,transformMat3:JLe,transformMat4:YLe},Symbol.toStringTag,{value:"Module"}));function aAe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Pk(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function lAe(t,e,i,r,n,s,o){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t}function G4(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5];let u=i*s-r*n;return u?(u=1/u,t[0]=s*u,t[1]=-r*u,t[2]=-n*u,t[3]=i*u,t[4]=(n*a-s*o)*u,t[5]=(r*o-i*a)*u,t):null}function uAe(t){return t[0]*t[3]-t[1]*t[2]}function oy(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=i[0],p=i[1],h=i[2],m=i[3],y=i[4],g=i[5];return t[0]=r*d+s*p,t[1]=n*d+o*p,t[2]=r*h+s*m,t[3]=n*h+o*m,t[4]=r*y+s*g+a,t[5]=n*y+o*g+u,t}function pE(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=Math.sin(i),p=Math.cos(i);return t[0]=r*p+s*d,t[1]=n*p+o*d,t[2]=r*-d+s*p,t[3]=n*-d+o*p,t[4]=a,t[5]=u,t}function Fk(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=i[0],p=i[1];return t[0]=r*d,t[1]=n*d,t[2]=s*p,t[3]=o*p,t[4]=a,t[5]=u,t}function Gb(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=i[0],p=i[1];return t[0]=r,t[1]=n,t[2]=s,t[3]=o,t[4]=r*d+s*p+a,t[5]=n*d+o*p+u,t}function kre(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t[4]=0,t[5]=0,t}function Lre(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function z4(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function cAe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function dAe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function pAe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function Are(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function hAe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function mAe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t}function fAe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function yAe(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=e[0],d=e[1],p=e[2],h=e[3],m=e[4],y=e[5],g=qi();return Math.abs(i-u)<=g*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-d)<=g*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-p)<=g*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(s-h)<=g*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=g*Math.max(1,Math.abs(a),Math.abs(y))}const gAe=oy,vAe=Are;Object.freeze(Object.defineProperty({__proto__:null,add:pAe,copy:aAe,determinant:uAe,equals:yAe,exactEquals:fAe,frob:dAe,fromRotation:kre,fromScaling:Lre,fromTranslation:z4,identity:Pk,invert:G4,mul:gAe,multiply:oy,multiplyScalar:hAe,multiplyScalarAndAdd:mAe,rotate:pE,scale:Fk,set:lAe,str:cAe,sub:vAe,subtract:Are,translate:Gb},Symbol.toStringTag,{value:"Module"}));function np(){return[1,0,0,1,0,0]}function bAe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function _Ae(t,e,i,r,n,s){return[t,e,i,r,n,s]}function wAe(t,e){return new Float64Array(t,e,6)}const SAe=np();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:SAe,clone:bAe,create:np,createView:wAe,fromValues:_Ae},Symbol.toStringTag,{value:"Module"}));const qT={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new hn({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:le.WebMercator}),minus180Line:new hn({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:le.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new hn({paths:[[[180,-180],[180,180]]],spatialReference:le.WGS84}),minus180Line:new hn({paths:[[[-180,-180],[-180,180]]],spatialReference:le.WGS84})}};function gy(t,e){return Math.ceil((t-e)/(2*e))}function Ore(t,e){const i=TS(t);for(const r of i)for(const n of r)n[0]+=e;return t}function TS(t){return Sy(t)?t.rings:t.paths}async function $Ae(t,e,i,r){const n=eu(t),s=e[0].spatialReference,o={...r,responseType:"json",query:{...n.query,f:"json",sr:i2(s),target:JSON.stringify({geometryType:H$(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await Ee(n.path+"/cut",o),{cutIndexes:u,geometries:d=[]}=a.data;return{cutIndexes:u,geometries:d.map(p=>{const h=dp(p);return h.spatialReference=s,h})}}async function EAe(t,e,i){const r=typeof t=="string"?nr(t):t,n=e[0].spatialReference,s=H$(e[0]),o={...i,query:{...r.query,f:"json",sr:i2(n),geometries:JSON.stringify(swe(e))}},{data:a}=await Ee(r.path+"/simplify",o);return oQ(a.geometries,s,n)}const Rre=()=>U.getLogger("esri.geometry.support.normalizeUtils");function TAe(t){return t.type==="polygon"}function IAe(t){return t[0].type==="polygon"}function xAe(t){return t[0].type==="polyline"}function y9(t){const e=[];let i=0,r=0;for(let n=0;n<t.length;n++){const s=t[n];let o=null;for(let a=0;a<s.length;a++)o=s[a],e.push(o),a===0?(i=o[0],r=i):(i=Math.min(i,o[0]),r=Math.max(r,o[0]));o&&e.push([(i+r)/2,0])}return e}function Pre(t,e){if(!(t instanceof hn||t instanceof os)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw Rre().error(n),new L(n)}const i=TS(t),r=[];for(const n of i){const s=[];r.push(s),s.push([n[0][0],n[0][1]]);for(let o=0;o<n.length-1;o++){const a=n[o][0],u=n[o][1],d=n[o+1][0],p=n[o+1][1],h=Math.sqrt((d-a)*(d-a)+(p-u)*(p-u)),m=(p-u)/h,y=(d-a)/h,g=h/e;if(g>1){for(let S=1;S<=g-1;S++){const E=S*e,T=y*E+a,M=m*E+u;s.push([T,M])}const v=(h+Math.floor(g-1)*e)/2,_=y*v+a,w=m*v+u;s.push([_,w])}s.push([d,p])}}return TAe(t)?new os({rings:r,spatialReference:t.spatialReference}):new hn({paths:r,spatialReference:t.spatialReference})}function g9(t,e,i){if(e){const r=Pre(t,1e6);t=hy(r,!0)}return i&&(t=Ore(t,i)),t}function v9(t,e,i){if(Array.isArray(t)){const r=t[0];if(r>e){const n=gy(r,e);t[0]=r+n*(-2*e)}else if(r<i){const n=gy(r,i);t[0]=r+n*(-2*i)}}else{const r=t.x;if(r>e){const n=gy(r,e);t=t.clone().offset(n*(-2*e),0)}else if(r<i){const n=gy(r,i);t=t.clone().offset(n*(-2*i),0)}}return t}function MAe(t,e){let i=-1;for(let r=0;r<e.cutIndexes.length;r++){const n=e.cutIndexes[r],s=e.geometries[r],o=TS(s);for(let a=0;a<o.length;a++){const u=o[a];u.some(d=>{if(d[0]<180)return!0;{let p=0;for(let m=0;m<u.length;m++){const y=u[m][0];p=y>p?y:p}p=Number(p.toFixed(9));const h=-360*gy(p,180);for(let m=0;m<u.length;m++){const y=s.getPoint(a,m);s.setPoint(a,m,y.clone().offset(h,0))}return!0}})}if(n===i){if(IAe(t))for(const a of TS(s))t[n]=t[n].addRing(a);else if(xAe(t))for(const a of TS(s))t[n]=t[n].addPath(a)}else i=n,t[n]=s}return t}async function Fre(t,e,i){if(!Array.isArray(t))return Fre([t],e);e&&typeof e!="string"&&Rre().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:(e==null?void 0:e.url)??et.geometryServiceUrl;let n,s,o,a,u,d,p,h,m=0;const y=[],g=[];for(const T of t)if(T!=null)if(n||(n=T.spatialReference,s=Ln(n),o=n.isWebMercator,d=o?102100:4326,a=qT[d].maxX,u=qT[d].minX,p=qT[d].plus180Line,h=qT[d].minus180Line),s)if(T.type==="mesh")g.push(T);else if(T.type==="point")g.push(v9(T.clone(),a,u));else if(T.type==="multipoint"){const M=T.clone();M.points=M.points.map(x=>v9(x,a,u)),g.push(M)}else if(T.type==="extent"){const M=T.clone()._normalize(!1,!1,s);g.push(M.rings?new os(M):M)}else if(T.extent){const M=T.extent,x=gy(M.xmin,u)*(2*a);let C=x===0?T.clone():Ore(T.clone(),x);M.offset(x,0);let{xmin:O,xmax:F}=M;O=Number(O.toFixed(9)),F=Number(F.toFixed(9)),M.intersects(p)&&F!==a?(m=F>m?F:m,C=g9(C,o),y.push(C),g.push("cut")):M.intersects(h)&&O!==u?(m=F*(2*a)>m?F*(2*a):m,C=g9(C,o,360),y.push(C),g.push("cut")):g.push(C)}else g.push(T.clone());else g.push(T);else g.push(T);let v=gy(m,a),_=-90;const w=v,S=new hn;for(;v>0;){const T=360*v-180;S.addPath([[T,_],[T,-1*_]]),_*=-1,v--}if(y.length>0&&w>0){const T=MAe(y,await $Ae(r,y,S,i)),M=[],x=[];for(let F=0;F<g.length;F++){const V=g[F];if(V!=="cut")x.push(V);else{const z=T.shift(),H=t[F];H!=null&&H.type==="polygon"&&H.rings&&H.rings.length>1&&z.rings.length>=H.rings.length?(M.push(z),x.push("simplify")):x.push(o?Qd(z):z)}}if(!M.length)return x;const C=await EAe(r,M,i),O=[];for(let F=0;F<x.length;F++){const V=x[F];V!=="simplify"?O.push(V):O.push(o?Qd(C.shift()):C.shift())}return O}const E=[];for(let T=0;T<g.length;T++){const M=g[T];if(M!=="cut")E.push(M);else{const x=y.shift();E.push(o===!0?Qd(x):x)}}return E}function CAe(t){if(!t)return null;const e=t.extent;if(!e)return null;const i=t.spatialReference&&Ln(t.spatialReference);if(!i)return e;const[r,n]=i.valid,s=2*n,{width:o}=e;let a,{xmin:u,xmax:d}=e;if([u,d]=[d,u],t.type==="extent"||o===0||o<=n||o>s||u<r||d>n)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=y9(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=y9(t.paths);break;case"multipoint":a=t.points}const p=e.clone();for(let h=0;h<a.length;h++){let m=a[h][0];m<0?(m+=n,d=Math.max(m,d)):(m-=n,u=Math.min(m,u))}return p.xmin=u,p.xmax=d,p.width<o?(p.xmin-=n,p.xmax-=n,p):e}function B4(t,e,i){const r=Ln(i);if(r==null)return t;const[n,s]=r.valid,o=2*s;let a=0,u=0;e>s?a=Math.ceil(Math.abs(e-s)/o):e<n&&(a=-Math.ceil(Math.abs(e-n)/o)),t>s?u=Math.ceil(Math.abs(t-s)/o):t<n&&(u=-Math.ceil(Math.abs(t-n)/o));let d=t+(a-u)*o;const p=d-e;return p>s?d-=o:p<n&&(d+=o),d}function Stt(t,e){const i=Ln(e);if(i){const[r,n]=i.valid,s=n-r;if(t<r)for(;t<r;)t+=s;if(t>n)for(;t>n;)t-=s}return t}const Nre=96,Dre=39.37,kAe=180/Math.PI;function Vre(t){return t.wkid?t:t.spatialReference||le.WGS84}function H4(t,e){return e.type?Tr(t,e.x,e.y):Q0(t,e)}function Ure(t){return Ci(t)}function Nk(t,e,i=0){let r=t.width,n=t.height;if(i!==0){const a=G$(i),u=Math.abs(Math.cos(a)),d=Math.abs(Math.sin(a));r=t.width*u+t.height*d,n=t.width*d+t.height*u}const s=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(r/s,n/o)*NAe(t.spatialReference)}async function R1(t,e,i,r){var a,u;let n,s;if(!t||Array.isArray(t)&&!t.length)return null;if(Y.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const d=t.every(m=>"attributes"in m),p=t.some(m=>!m.geometry);let h=t;if(d&&p&&e&&e.allLayerViews){const m=new Map;for(const _ of t){const w=_.layer,S=m.get(w)||[],E=_.attributes[w.objectIdField];E!=null&&S.push(E),m.set(w,S)}const y=[];m.forEach((_,w)=>{const S=e.allLayerViews.find(E=>E.layer.id===w.id);if(S&&"queryFeatures"in S){const E=w.createQuery();E.objectIds=_,E.returnGeometry=!0,y.push(S.queryFeatures(E))}});const g=await Promise.all(y),v=[];for(const _ of g)if(_&&_.features&&_.features.length)for(const w of _.features)w.geometry!=null&&v.push(w.geometry);h=v}for(const m of h)r=await R1(m,e,i,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new we(t);else if(t instanceof _p)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){const d=t.layer,p=e.allLayerViews.find(h=>h.layer.id===d.id);if(p&&"queryFeatures"in p){const h=d.createQuery();h.objectIds=[t.attributes[d.objectIdField]],h.returnGeometry=!0;const m=await p.queryFeatures(h);n=(u=(a=m==null?void 0:m.features)==null?void 0:a[0])==null?void 0:u.geometry}}}if(n==null)return null;switch(n.type){case"point":s=new at({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=CAe(n);break;default:s=n.extent}if(!s)return null;Ac()||Yo(s.spatialReference,i)||await $c();const o=On(s,i);if(!o)return null;if(r){const d=o.center,p=d.clone();p.x=B4(d.x,r.center.x,i),p.x!==d.x&&o.centerAt(p),r=r.union(o)}else r=o;return r}function LAe(t){var e;if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&((e=t.layer)==null?void 0:e.minScale)!=null&&t.layer.maxScale!=null){const i=t.layer;return{min:i.minScale,max:i.maxScale}}if(Array.isArray(t)&&t.length&&t.every(i=>"layer"in i)){let i=0,r=0;for(const n of t){const s=n.layer;s!=null&&s.minScale&&s.maxScale&&(i=s.minScale<i?s.minScale:i,r=s.maxScale>r?s.maxScale:r)}return i&&r?{min:i,max:r}:null}}}function b9(t,e){const i=Vre(t);return ci(i,e)||i.imageCoordinateSystem||e.imageCoordinateSystem?t:On(t,e)}async function AAe(t,e){var _;if(!t||!e)return new Ar({targetGeometry:new we,scale:0,rotation:0});let i=e.spatialReference;const{constraints:r,padding:n,viewpoint:s,size:o}=e,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let u=null;t instanceof Ar?u=t:t.viewpoint?u=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(u=t.target);let d=null;u!=null&&u.targetGeometry?d=u.targetGeometry:t instanceof at?d=t:t instanceof _p?d=await R1(t,e,i):t&&(d=await R1(t.center,e,i)||await R1(t.target,e,i)||await R1(t,e,i)),!d&&(s!=null&&s.targetGeometry)?d=s.targetGeometry:!d&&e.extent&&(d=e.extent),i||(i=Vre(e.spatialReference||e.extent||d)),Ac()||ci(d.spatialReference,i)||Yo(d.spatialReference,i)||await $c();const p=b9(d,i),h="center"in p?p.center:p;e.pickClosestTarget!==!1&&h.type==="point"&&((_=s.targetGeometry)==null?void 0:_.type)==="point"&&(h.x=B4(h.x,s.targetGeometry.x,h.spatialReference));let m=0;u?m=u.rotation:t.hasOwnProperty("rotation")?m=t.rotation:s&&(m=s.rotation);let y=0;y=(u==null?void 0:u.targetGeometry)!=null&&u.targetGeometry.type==="point"?u.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(t.zoom):Array.isArray(d)||d.type==="point"||d.type==="extent"&&d.width===0&&d.height===0?s.scale:Nk(b9(d.extent,i),a,m);const g=LAe(t.target??t);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let v=new Ar({targetGeometry:h,scale:y,rotation:m});return r&&(v=r.fit(v),r.constrainByGeometry(v),r.rotationEnabled||(v.rotation=s.rotation)),v}function ns(t,e){const i=t.targetGeometry,r=e.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function OAe(t,e,i){return i?Tr(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):$_(t,e,.5)}const jre=function(){const t=pt();return function(e,i,r){const n=i.targetGeometry;H4(t,n);const s=.5*T_(i);return e.xmin=t[0]-s*r[0],e.ymin=t[1]-s*r[1],e.xmax=t[0]+s*r[0],e.ymax=t[1]+s*r[1],e.spatialReference=n.spatialReference,e}}();function RAe(t,e,i,r,n){var s;return SN(t,e,i.center),t.scale=Nk(i,r),(s=n==null?void 0:n.constraints)==null||s.constrain(t),t}function PAe(t,e,i,r){return Z4(t,e,i,r),G4(t,t)}const Gre=function(){const t=pt();return function(e,i,r){return Rk(e,DAe(e,i),OAe(t,i,r))}}(),FAe=function(){const t=np(),e=pt();return function(i,r,n,s){const o=T_(r),a=q4(r);return Tr(e,o,o),Lre(t,e),pE(t,t,a),Gb(t,t,Gre(e,n,s)),Gb(t,t,[0,s.top-s.bottom]),Tr(i,t[4],t[5])}}();function T_(t){var e;return t.scale*zre((e=t.targetGeometry)==null?void 0:e.spatialReference)}function zre(t){return t!=null&&Cs(t)?1/(Ure(t)*Dre*Nre):1}function q4(t){return HV(t.rotation)||0}function NAe(t){return Cs(t)?Ure(t)*Dre*Nre:1}function DAe(t,e){return $_(t,e,.5)}const W4=function(){const t=pt(),e=pt(),i=pt();return function(r,n,s,o,a,u){return xre(t,n),$_(e,s,.5*u),Tr(i,1/o*u,-1/o*u),z4(r,e),a&&pE(r,r,a),Fk(r,r,i),Gb(r,r,t),r}}(),Z4=function(){const t=pt();return function(e,i,r,n){const s=T_(i),o=q4(i);return H4(t,i.targetGeometry),W4(e,t,r,s,o,n)}}(),VAe=function(){const t=pt();return function(e,i,r,n){const s=T_(i);return H4(t,i.targetGeometry),W4(e,t,r,s,0,n)}}();function Bre(t){const e=Ln(t);return e?e.valid[1]-e.valid[0]:0}function UAe(t,e){return Math.round(Bre(t)/e)}const jAe=function(){const t=pt(),e=pt(),i=[0,0,0];return function(r,n,s){Rr(t,r,n),_N(t,t),Rr(e,r,s),_N(e,e),Mre(i,t,e);let o=Math.acos(Cm(t,e)/(jb(t)*jb(e)))*kAe;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),GAe=function(){const t=pt();return function(e,i,r,n){const s=e.targetGeometry;return ns(e,i),FAe(t,i,r,n),s.x+=t[0],s.y+=t[1],e}}(),SN=function(t,e,i){ns(t,e);const r=t.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t},zAe=function(){const t=pt();return function(e,i,r,n,s){s||(s="center"),Rk(t,r,n),$_(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":Tr(t,0,0);break;case"left":Tr(t,-o,0);break;case"top":Tr(t,0,a);break;case"right":Tr(t,o,0);break;case"bottom":Tr(t,0,-a);break;case"top-left":Tr(t,-o,a);break;case"bottom-left":Tr(t,-o,-a);break;case"top-right":Tr(t,o,a);break;case"bottom-right":Tr(t,o,-a)}return Dk(e,i,t),e}}();function $tt(t,e,i){return ns(t,e),t.rotation+=i,t}function BAe(t,e,i){return ns(t,e),t.rotation=i,t}const HAe=function(){const t=pt();return function(e,i,r,n,s){return ns(e,i),isNaN(r)||r===0||(qre(t,n,i,s),e.scale=i.scale*r,Wre(t,t,e,s),Dk(e,e,Tr(t,t[0]-n[0],n[1]-t[1]))),e}}();function _9(t,e,i){return ns(t,e),t.scale=i,t}const Hre=function(){const t=pt();return function(e,i,r,n,s,o){return ns(e,i),isNaN(r)||r===0||(qre(t,s,i,o),e.scale=i.scale*r,e.rotation+=n,Wre(t,t,e,o),Dk(e,e,Tr(t,t[0]-s[0],s[1]-t[1]))),e}}(),Ett=function(){const t=pt(),e=pt();return function(i,r,n,s,o,a,u){return Gre(e,a,u),U4(t,o,e),s?Hre(i,r,n,s,t,a):HAe(i,r,n,t,a)}}(),qre=function(){const t=np();return function(e,i,r,n){return hc(e,i,PAe(t,r,n,1))}}(),Wre=function(){const t=np();return function(e,i,r,n){return hc(e,i,Z4(t,r,n,1))}}(),Dk=function(){const t=pt(),e=np();return function(i,r,n){ns(i,r);const s=T_(r),o=i.targetGeometry;return kre(e,q4(r)),Fk(e,e,rp(s,s)),hc(t,n,e),o.x+=t[0],o.y+=t[1],i}}();function C2(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function qAe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function WAe(t,e,i,r,n,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o[4]=n,o[5]=s,o}function ZAe(t,e){return new Float32Array(t,e,6)}function Zre(t,e,i,r){const n=e[r],s=e[r+1];t[r]=i[0]*n+i[2]*s+i[4],t[r+1]=i[1]*n+i[3]*s+i[5]}function JAe(t,e,i,r=0,n=0,s=2){const o=n||e.length/s;for(let a=r;a<o;a++)Zre(t,e,i,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:qAe,create:C2,createView:ZAe,fromValues:WAe,transform:Zre,transformMany:JAe},Symbol.toStringTag,{value:"Module"}));function YAe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function KAe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Jre(t,e,i,r,n,s,o,a,u,d){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t[6]=a,t[7]=u,t[8]=d,t}function Yre(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function XAe(t,e){if(t===e){const i=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function QAe(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],d=e[7],p=e[8],h=p*o-a*d,m=-p*s+a*u,y=d*s-o*u;let g=i*h+r*m+n*y;return g?(g=1/g,t[0]=h*g,t[1]=(-p*r+n*d)*g,t[2]=(a*r-n*o)*g,t[3]=m*g,t[4]=(p*i-n*u)*g,t[5]=(-a*i+n*s)*g,t[6]=y*g,t[7]=(-d*i+r*u)*g,t[8]=(o*i-r*s)*g,t):null}function eOe(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],d=e[7],p=e[8];return t[0]=o*p-a*d,t[1]=n*d-r*p,t[2]=r*a-n*o,t[3]=a*u-s*p,t[4]=i*p-n*u,t[5]=n*s-i*a,t[6]=s*d-o*u,t[7]=r*u-i*d,t[8]=i*o-r*s,t}function tOe(t){const e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],u=t[7],d=t[8];return e*(d*s-o*u)+i*(-d*n+o*a)+r*(u*n-s*a)}function J4(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=e[6],p=e[7],h=e[8],m=i[0],y=i[1],g=i[2],v=i[3],_=i[4],w=i[5],S=i[6],E=i[7],T=i[8];return t[0]=m*r+y*o+g*d,t[1]=m*n+y*a+g*p,t[2]=m*s+y*u+g*h,t[3]=v*r+_*o+w*d,t[4]=v*n+_*a+w*p,t[5]=v*s+_*u+w*h,t[6]=S*r+E*o+T*d,t[7]=S*n+E*a+T*p,t[8]=S*s+E*u+T*h,t}function $N(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=e[6],p=e[7],h=e[8],m=i[0],y=i[1];return t[0]=r,t[1]=n,t[2]=s,t[3]=o,t[4]=a,t[5]=u,t[6]=m*r+y*o+d,t[7]=m*n+y*a+p,t[8]=m*s+y*u+h,t}function Kre(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],u=e[5],d=e[6],p=e[7],h=e[8],m=Math.sin(i),y=Math.cos(i);return t[0]=y*r+m*o,t[1]=y*n+m*a,t[2]=y*s+m*u,t[3]=y*o-m*r,t[4]=y*a-m*n,t[5]=y*u-m*s,t[6]=d,t[7]=p,t[8]=h,t}function Xre(t,e,i){const r=i[0],n=i[1],s=i[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function iOe(t,e,i){const r=i[0],n=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function rOe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function nOe(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function sOe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function oOe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function k2(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i+i,a=r+r,u=n+n,d=i*o,p=r*o,h=r*a,m=n*o,y=n*a,g=n*u,v=s*o,_=s*a,w=s*u;return t[0]=1-h-g,t[3]=p-w,t[6]=m+_,t[1]=p+w,t[4]=1-d-g,t[7]=y-v,t[2]=m-_,t[5]=y+v,t[8]=1-d-h,t}function Qre(t,e){const i=e[0],r=e[1],n=e[2],s=e[4],o=e[5],a=e[6],u=e[8],d=e[9],p=e[10],h=p*o-a*d,m=-p*s+a*u,y=d*s-o*u,g=i*h+r*m+n*y;if(!g)return null;const v=1/g;return t[0]=h*v,t[1]=(-p*r+n*d)*v,t[2]=(a*r-n*o)*v,t[3]=m*v,t[4]=(p*i-n*u)*v,t[5]=(-a*i+n*s)*v,t[6]=y*v,t[7]=(-d*i+r*u)*v,t[8]=(o*i-r*s)*v,t}function aOe(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],d=e[7],p=e[8],h=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],w=e[15],S=i*a-r*o,E=i*u-n*o,T=i*d-s*o,M=r*u-n*a,x=r*d-s*a,C=n*d-s*u,O=p*v-h*g,F=p*_-m*g,V=p*w-y*g,z=h*_-m*v,H=h*w-y*v,Q=m*w-y*_;let J=S*Q-E*H+T*z+M*V-x*F+C*O;return J?(J=1/J,t[0]=(a*Q-u*H+d*z)*J,t[1]=(u*V-o*Q-d*F)*J,t[2]=(o*H-a*V+d*O)*J,t[3]=(n*H-r*Q-s*z)*J,t[4]=(i*Q-n*V+s*F)*J,t[5]=(r*V-i*H-s*O)*J,t[6]=(v*C-_*x+w*M)*J,t[7]=(_*T-g*C-w*E)*J,t[8]=(g*x-v*T+w*S)*J,t):null}function lOe(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function uOe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function cOe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function dOe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function ene(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function pOe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function hOe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t}function mOe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function fOe(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],d=t[7],p=t[8],h=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],w=e[6],S=e[7],E=e[8],T=qi();return Math.abs(i-h)<=T*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-m)<=T*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-y)<=T*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(s-g)<=T*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-v)<=T*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-_)<=T*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-w)<=T*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(d-S)<=T*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-E)<=T*Math.max(1,Math.abs(p),Math.abs(E))}function yOe(t){const e=qi(),i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],d=t[7],p=t[8];return Math.abs(1-(i*i+s*s+u*u))<=e&&Math.abs(1-(r*r+o*o+d*d))<=e&&Math.abs(1-(n*n+a*a+p*p))<=e}const gOe=J4,vOe=ene;Object.freeze(Object.defineProperty({__proto__:null,add:dOe,adjoint:eOe,copy:KAe,determinant:tOe,equals:fOe,exactEquals:mOe,frob:cOe,fromMat2d:oOe,fromMat4:YAe,fromQuat:k2,fromRotation:nOe,fromScaling:sOe,fromTranslation:rOe,identity:Yre,invert:QAe,isOrthoNormal:yOe,mul:gOe,multiply:J4,multiplyScalar:pOe,multiplyScalarAndAdd:hOe,normalFromMat4:aOe,normalFromMat4Legacy:Qre,projection:lOe,rotate:Kre,scale:Xre,scaleByVec2:iOe,set:Jre,str:uOe,sub:vOe,subtract:ene,translate:$N,transpose:XAe},Symbol.toStringTag,{value:"Module"}));function eM(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function bOe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function _Oe(t,e,i,r,n,s,o,a,u){const d=new Float32Array(9);return d[0]=t,d[1]=e,d[2]=i,d[3]=r,d[4]=n,d[5]=s,d[6]=o,d[7]=a,d[8]=u,d}function wOe(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:bOe,create:eM,createView:wOe,fromValues:_Oe},Symbol.toStringTag,{value:"Module"}));function tne(){return new Float32Array(2)}function SOe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function zb(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function $Oe(t,e){return new Float32Array(t,e,2)}function ine(){return tne()}function rne(){return zb(1,1)}function nne(){return zb(1,0)}function sne(){return zb(0,1)}const EOe=ine(),TOe=rne(),IOe=nne(),xOe=sne();Object.freeze(Object.defineProperty({__proto__:null,ONES:TOe,UNIT_X:IOe,UNIT_Y:xOe,ZEROS:EOe,clone:SOe,create:tne,createView:$Oe,fromValues:zb,ones:rne,unitX:nne,unitY:sne,zeros:ine},Symbol.toStringTag,{value:"Module"}));function MOe(t){return t instanceof Float32Array&&t.length>=2}function COe(t){return Array.isArray(t)&&t.length>=2}function CA(t){return MOe(t)||COe(t)}var EN;const Uc=[0,0];let yd=EN=class extends j{constructor(t){super(t),this._viewpoint2D={center:pt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new at,this.id=0,this.inverseTransform=np(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=np(),this.transformNoRotation=np(),this.displayMat3=eM(),this.displayViewMat3=eM(),this.viewMat3=eM(),this.viewMat2d=C2(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=ns(i,t.viewpoint),this._set("size",Q0(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new EN({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return CA(e)?hc(t,e,this.inverseTransform):(Uc[0]=e,Uc[1]=i,hc(t,Uc,this.inverseTransform))}toScreen(t,e,i){return CA(e)?hc(t,e,this.transform):(Uc[0]=e,Uc[1]=i,hc(t,Uc,this.transform))}toScreenNoRotation(t,e,i){return CA(e)?hc(t,e,this.transformNoRotation):(Uc[0]=e,Uc[1]=i,hc(t,Uc,this.transformNoRotation))}wrapMapCoordinate(t,e){Q0(t,e);const[i]=e,[r]=this.center,{extent:n,spatialReference:s}=this;let{xmin:o,xmax:a}=n;if(s.isWrappable){const u=Bre(s)/2;o=Math.max(o,r-u),a=Math.min(a,r+u)}return(i<o||i>a)&&(t[0]=B4(i,r,s)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return W4(t,i,n,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),o=new Ar({targetGeometry:new we(t[0],t[1],e),scale:i,rotation:r});if(this._set("viewpoint",o),!s||!e||!i)return;this.resolution=T_(o),this.rotation=r,this.scale=i,this.spatialReference=e,Q0(this.center,t);const a=s[0]!==0?2/s[0]:0,u=s[1]!==0?-2/s[1]:0;Jre(this.displayMat3,a,0,0,0,u,0,-1,1,1);const d=Yre(this.viewMat3),p=zb(s[0]/2,s[1]/2),h=zb(-s[0]/2,-s[1]/2),m=HV(r);$N(d,d,p),Kre(d,d,m),$N(d,d,h),J4(this.displayViewMat3,this.displayMat3,d);const y=z4(this.viewMat2d,p);return pE(y,y,m),Gb(y,y,h),jre(this.extent,o,s),Z4(this.transform,o,s,n),G4(this.inverseTransform,this.transform),VAe(this.transformNoRotation,o,s,n),this.worldScreenWidth=UAe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};l([c({readOnly:!0})],yd.prototype,"id",void 0),l([c({value:1,json:{write:!0}})],yd.prototype,"pixelRatio",null),l([c({json:{write:!0}})],yd.prototype,"size",null),l([c()],yd.prototype,"spatialReference",void 0),l([c({type:Ar,json:{write:!0}})],yd.prototype,"viewpoint",null),l([c({readOnly:!0})],yd.prototype,"visibleArea",null),yd=EN=l([$("esri.views.2d.ViewState")],yd);const w9=yd;var TN,IN;let Bd=TN=class extends q{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new TN({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};l([c()],Bd.prototype,"left",void 0),l([c()],Bd.prototype,"top",void 0),l([c()],Bd.prototype,"right",void 0),l([c()],Bd.prototype,"bottom",void 0),Bd=TN=l([$("esri.views.2d.PaddedViewState.Padding")],Bd);let Jv=IN=class extends w9{constructor(...t){super(...t),this.paddedViewState=new w9,this._updateContent=(()=>{const e=pt();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const n=this.paddedViewState;Tr(e,r.left+r.right,r.top+r.bottom),Rr(e,i,e),Q0(n.size,e);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(N(()=>[this.size,this.padding],()=>this._updateContent(),yn)),this.padding=new Bd,this.size=[0,0]}set padding(t){this._set("padding",t||new Bd)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const i=this._get("padding");i&&(e=GAe(t.clone(),t,this._get("size"),i));const{targetGeometry:r,rotation:n,scale:s}=e,{x:o,y:a,spatialReference:u}=r,d=this._viewpoint2D;d.center[0]=o,d.center[1]=a,d.rotation=n,d.scale=s,d.spatialReference=u,this._update()}}clone(){return new IN({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};l([c()],Jv.prototype,"paddedViewState",void 0),l([c({type:Bd})],Jv.prototype,"padding",null),l([c()],Jv.prototype,"viewpoint",null),Jv=IN=l([$("esri.views.2d.PaddedViewState")],Jv);const Y4=Jv;function ay(t,e,i,r){const n=3*t,s=3*(i-t)-n,o=1-n-s,a=3*e,u=3*(r-e)-a,d=1-a-u;function p(g){return((o*g+s)*g+n)*g}function h(g){return((d*g+u)*g+a)*g}function m(g){return(3*o*g+2*s)*g+n}function y(g,v){let _,w,S,E,T,M;for(S=g,M=0;M<8;M++){if(E=p(S)-g,Math.abs(E)<v)return S;if(T=m(S),Math.abs(T)<1e-6)break;S-=E/T}if(_=0,w=1,S=g,S<_)return _;if(S>w)return w;for(;_<w;){if(E=p(S),Math.abs(E-g)<v)return S;g>E?_=S:w=S,S=.5*(w-_)+_}return S}return function(g,v=1e-6){return h(y(g,v))}}const kOe=/^cubic-bezier\((.*)\)/,oc={};function LOe(t){let e=oc[t]||null;if(!e){const i=kOe.exec(t);if(i){const r=i[1].split(",").map(n=>parseFloat(n.trim()));r.length!==4||r.some(n=>isNaN(n))||(e=ay.apply(ay,r))}}return e}oc.ease=ay(.25,.1,.25,1),oc.linear=ay(0,0,1,1),oc.easeIn=oc["ease-in"]=ay(.42,0,1,1),oc.easeOut=oc["ease-out"]=ay(0,0,.58,1),oc.easeInOut=oc["ease-in-out"]=ay(.42,0,.58,1);let S9=class{constructor(e){this._view=e,this.viewpoint=new Ar({targetGeometry:new we,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,i]=this._view.size;return Math.sqrt(e*e+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return zre(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,i){i.pan=tY(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,i.rotate=G$(r),i.sourceZoom=this.scale,i.targetZoom=e.scale}interpolate(e,i,r){const{pan:n,rotate:s,zoom:o,zoomOffset:a}=r,{center:u}=this;u.spatialReference=e.center.spatialReference,u.x=Wh(e.center.x,i.center.x,n),u.y=Wh(e.center.y,i.center.y,n),this.viewpoint.scale=Wh(e.scale,i.scale+a,o);let d=e.rotation;const p=i.rotation;Math.abs(p-d)>=180&&(d+=360*(d<p?1:-1)),this.viewpoint.rotation=Wh(d,p,s)}copyFrom(e){ns(this.viewpoint,e.viewpoint),this._view=e.view}};const one=t=>t*t,AOe=t=>1-one(1-t),OOe=t=>2**(10*(t-1)),ROe=t=>1-OOe(1-t);function POe(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return r=>r<i?t*r*r:e*r-e+1}function FOe(t,e){return(i,r)=>i<e?e*t(i/e,r):1-t((1-i)/(1-e),r)*(1-e)}const $9=FOe(POe(1),.5);let NOe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const f$={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},ane={...f$,maxDuration:4e3};let DOe=class lne{constructor(e){this._createCamera=e,this.compared=new NOe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:f$.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new lne(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,r){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow??f$.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>qi()}get hasFov(){return Math.abs(this.compared.fov)>qi()}get hasRotate(){return this.compared.rotate>qi()}},VOe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},UOe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,i)=>e+i.time,0)}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,n=0;const s=this.definition,o=this.segments.reduce((a,u)=>a||u.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const u=this.segments[a],d=u.definition;if(e<=u.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(u,u.time===0?0:e/u.time,i),s.hasPan&&!isNaN(i.pan)&&isFinite(s.compared.pan)?i.pan=(r+d.compared.pan*i.pan)/s.compared.pan:i.pan=1,s.hasRotate&&!isNaN(i.rotate)&&isFinite(s.compared.rotate)?i.rotate=(n+d.compared.rotate*i.rotate)/s.compared.rotate:i.rotate=1,o&&!isNaN(i.zoom)&&isFinite(d.compared.targetZoom)){const{sourceZoom:p,targetZoom:h}=d.compared,m=i.zoom*(h-p)+p,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(h-y)>Math.abs(p-y)?h:p;i.zoomOffset=v-g,i.zoom=(m-y)/(v-y)}else i.zoom=1;return i}e-=u.time,r+=d.compared.pan,n+=d.compared.rotate}}segmentInterpolateComponentsAt(e,i,r){e.interpolateComponentsAt(i,r)}},kA=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,i=e.compared,r=i.sourceZoom,n=i.targetZoom;this._zoomSign=r>n?1:-1,this._panPixelsAtSource=i.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=i.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:r,hasPan:n,hasRotate:s}=this.definition;let o=0,a=0;r&&(n&&(o=(i/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(a=this._zoomSign*(Math.log(e/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const u=this.definition.desiredPixelFlow;if(r&&n&&s){const d=o+a+o*a;this._zoomPixelFlow=o*a/d*u,this._panPixelFlow=a/d*u,this._rotatePixelFlow=o/d*u}else if(r&&n){const d=1+o;this._zoomPixelFlow=o/d*u,this._panPixelFlow=1/d*u}else if(r&&s){const d=1+a;this._zoomPixelFlow=a/d*u,this._rotatePixelFlow=1/d*u}else if(n&&s){const d=this._panPixelsAtSource/this._rotatePixels,p=1+d;this._panPixelFlow=d/p*u,this._rotatePixelFlow=1/p*u}else n?this._panPixelFlow=u:r?this._zoomPixelFlow=u:s&&(this._rotatePixelFlow=u);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const d=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=d,this._panPixelFlow/=d,this._rotatePixelFlow/=d}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/jOe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=e*this._panPixelsAtSource;return Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(i*(i/r)**-e-i)/(r-i)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:r}=this.definition;return i+e*(r-i)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*e*this._time)-1))/(i*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),i.zoom=this._interpolateComponentsZoom(e),i.pan=this._interpolateComponentsPan(e),i.rotate=this._interpolateComponentsRotate(e),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(e)}};const jOe=G$(45);function GOe(t,e,i){const r=e-t.compared.sourceZoom,n=t.halfWindowPanAtZoom(r);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+n)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*n)}function zOe(t,e,i){const r=1/e,n=Math.log(t.compared.sourceZoom*r),s=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,u=1/a,d=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*s*o*u*d-t.halfWindowSize*n*s*o*u+t.halfWindowSize*n*s*o*d/(a*a)}function BOe(t,e,i){const r=e-t.compared.sourceZoom,n=1/r,s=1/e,o=Math.log(t.compared.sourceZoom*s),a=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(r))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*s*a+2*n*o+2*s-2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function HOe(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function qOe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function WOe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function ZOe(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function JOe(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function YOe(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function KOe(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function XOe(t,e,i){const r=Math.log(e/t.compared.targetZoom),n=1/t.desiredPixelFlow,s=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,u=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*r*n*s*a+t.halfWindowSize*r*n*s*u/(o*o)+t.halfWindowSize*n*s*a*u/e}function QOe(t,e,i){const r=e-t.compared.targetZoom,n=1/r,s=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*s*a-2*n*o+2*s+2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function eRe(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function tRe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function iRe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function rRe(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,r=e,n=t.halfWindowPanAtZoom(r),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*n);return t.compared.sourceZoom<=t.compared.targetZoom?s*(i-n):s*(i+n)}function nRe(t,e){let i=sRe(t,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},n=r.ascensionFactor===0,s=r.descensionFactor===0,o=n?HOe:GOe,a=n?qOe:zOe,u=n?WOe:BOe,d=s?eRe:KOe,p=s?tRe:XOe,h=s?iRe:QOe,m=T=>o(t,T,r)+ZOe(t,T,r)+d(t,T,r),y=T=>a(t,T,r)+JOe(t,T,r)+p(t,T,r),g=T=>u(t,T,r)+YOe(t,T,r)+h(t,T,r);let v=m(i);const _=rRe(t);let w;const S=e.maximumIterations||20,E=e.maximumDistance!=null?e.maximumDistance:1/0;for(w=0;w<S;w++){const T=e.desiredSlope??1e-6;let M=y(i);Math.abs(M)>T&&(M+=T);const x=M/g(i);if(isNaN(x)||i>=E&&x<0){if(!isFinite(E))return null;i=E,v=m(i);break}if(i-=x,i<t.compared.sourceZoom||i<t.compared.targetZoom)return null;const C=m(i);if(Math.abs(C-v)/v<=.005)break;v=C}return v>_*(1-.3)||i<t.compared.sourceZoom||i<t.compared.targetZoom?null:i}function sRe(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),r=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return r<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,r):r}let oRe=class extends UOe{constructor(e,i){super(),this._preallocSegments=[new kA,new kA,new kA],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,i)}update(e,i){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const r=i!=null&&i.apex?nRe(e,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,i==null?void 0:i.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,r){e.interpolateComponentsAt(i,r),e===this._ascensionSegment?r.zoom=AOe(r.zoom):e===this._descensionSegment&&(r.zoom=one(r.zoom))}_updateWithApex(e,i){const[r,n,s]=this._preallocSegments,o=(i==null?void 0:i.ascensionFactor)??.5,a=Math.min(1-o,(i==null?void 0:i.ascensionFactor)!=null&&i.descensionFactor!=null?i.descensionFactor:.5),u=1-o-a;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*o,r.definition.compared.rotate=this.definition.compared.rotate*o,r.definition.segmentEnd=o,r.update(),this._ascensionSegment=r,this.segments.push(r),u>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*u,n.definition.compared.rotate=this.definition.compared.rotate*u,n.definition.segmentStart=r.definition.segmentEnd,n.definition.segmentEnd=r.definition.segmentEnd+u,n.update(),this.segments.push(n)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*a,s.definition.compared.rotate=this.definition.compared.rotate*a,s.definition.segmentStart=o+u,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const aRe=new VOe;let lRe=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=$9,this.definition=new DOe(e),this.path=new oRe}update(e,i,r){this.definition.update(e,i,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(Tpe(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?$9:ROe)}cameraAt(e,i){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,aRe);i.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(e){const i=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-i)/(r-i)}_applyTimeSettings(e,i){const r=i.speedFactor!=null?i.speedFactor:1,n=i.minDuration??f$.minDuration/r,s=i.maxDuration??f$.maxDuration/r;return e=i.duration!=null?i.duration:Math.min(Math.max(e/r,n),s)}};const E9=2e3,uRe=64;let cRe=class{constructor(e){this._view=e,this._animation=new lRe(()=>new S9(this._view)),this._current=new S9(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,i,r={}){ns(this._current.viewpoint,e),ns(this._source.viewpoint,e),ns(this._target.viewpoint,i),this._animation.update(this._source,this._target,r)}applyRatio(e,i){this._animation.cameraAt(i,this._current),ns(e,this._current.viewpoint)}},Yv=class extends q{constructor(e){super(e),this._animation=null,this._destinationViewState=new Y4,this.updateFunction=null,this.easing=oc.ease,this.viewpoint=new Ar({targetGeometry:new we,scale:0,rotation:0}),this._updateTask=yb({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new cRe(e.view)}destroy(){this._updateTask=Kt(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,i,r){this.stop();const n=this.viewpoint;ns(n,i);const s=(typeof(r==null?void 0:r.easing)=="string"?LOe(r.easing):r==null?void 0:r.easing)||this.easing,o=e.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(Math.min(i.scale,o.scale)*uRe,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r==null?void 0:r.duration,maxDuration:(r==null?void 0:r.animationMode)==="auto"?1/0:(r==null?void 0:r.maxDuration)??ane.maxDuration,speedFactor:r==null?void 0:r.speedFactor,easing:typeof s=="function"?u=>s(u):void 0}),(r==null?void 0:r.animationMode)==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,dRe(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:0}));const a=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const r=new bN({target:e.clone()}),n=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var r,n;const i=this.animation;if(i&&i.state!==bN.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),(r=this.animation)==null||r.update(this.viewpoint);else{const s=performance.now()-this._startTime,o=this._transition.duration,a=o>0?s/o:1,u=a>=1;this._transition.applyRatio(this.viewpoint,a),u&&((n=this.animation)==null||n.finish())}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function dRe(t,e,i,r){if((e==null?void 0:e.duration)!=null)return!0;const{time:n,isLinear:s}=t,o=(e==null?void 0:e.speedFactor)||1,a=(e==null?void 0:e.maxDuration)??ane.maxDuration/o;if(G("esri-goto-debug")&&(console.log("speed factor:",o),console.log("adjusted duration:		",n),console.log("adjusted max duration:	",a),console.log("is linear:",s)),n>a)return G("esri-goto-debug")&&console.warn(`failed "auto" heuristic: animations must be shorter than ${a/1e3}s`),!1;if(s){const d=pt(),p=Mi(...r.toScreen(d,...i.center)),h=Mi(...i.toScreen(d,...r.center)),m=h!=null&&h.x>-(1.5-.5)*i.size[0]&&h.x<(1.5+.5)*i.size[0]&&h.y>-(1.5-.5)*i.size[1]&&h.y<(1.5+.5)*i.size[1],y=p!=null&&p.x>-(1.5-.5)*r.size[0]&&p.x<(1.5+.5)*r.size[0]&&p.y>-(1.5-.5)*r.size[1]&&p.y<(1.5+.5)*r.size[1];if(G("esri-goto-debug")&&(console.log(`dest is within ${1.5} screens at start view:`,m),console.log(`start is within ${1.5} screens at dest view:`,y)),n>E9/o&&!m&&!y)return G("esri-goto-debug")&&console.warn(`failed "auto" heuristic: linear animations must be...
  - shorter than ${E9/1e3/o}s, or
  - shorter than ${a/1e3}s and the destination is close enough to the starting screen, or
  - shorter than ${a/1e3}s and the start point is close enough to the destination screen`),!1}return!0}l([c()],Yv.prototype,"easing",void 0),l([c()],Yv.prototype,"view",void 0),l([c()],Yv.prototype,"viewpoint",void 0),Yv=l([$("esri.views.2d.AnimationManager")],Yv);const pRe=Yv;var Yn;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(Yn||(Yn={}));const une=Symbol("Yield");let hRe=class{constructor(){this._tasks=new Array,this._runningTasks=h$(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return une;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,i,r){return++this._runningTasks.value,new Promise((n,s)=>this._tasks.push(new T9(n,s,e,i,r))).finally(()=>--this._runningTasks.value)}unshift(e,i,r){return++this._runningTasks.value,new Promise((n,s)=>this._tasks.unshift(new T9(n,s,e,i,r))).finally(()=>--this._runningTasks.value)}_process(e){var r;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const n=lo(i.signal);if(n&&!i.abortCallback)i.reject(mt());else{const s=n?(r=i.abortCallback)==null?void 0:r.call(i,mt()):i.callback(e);kc(s)?s.then(i.resolve,i.reject):i.resolve(s)}}catch(n){i.reject(n)}return!0}cancelAll(){const e=mt();for(const i of this._tasks)if(i.abortCallback){const r=i.abortCallback(e);i.resolve(r)}else i.reject(e);this._tasks.length=0}},T9=class{constructor(e,i,r,n=void 0,s=void 0){this.resolve=e,this.reject=i,this.callback=r,this.signal=n,this.abortCallback=s}},P1=class extends q{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};l([c()],P1.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),l([c()],P1.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),P1=l([$("esri.views.support.debugFlags")],P1);const mRe=new P1;function fRe(){return new L2.Scheduler}var He;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t.MAPVIEW_FETCH_QUEUE="mapview fetch queue",t.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",t.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"})(He||(He={}));const Ra=0,I9=new Map([[He.RESOURCE_CONTROLLER_IMMEDIATE,Ra],[He.RESOURCE_CONTROLLER,4],[He.SLIDE,Ra],[He.STREAM_DATA_LOADER,Ra],[He.ELEVATION_QUERY,Ra],[He.TERRAIN_SURFACE,1],[He.SURFACE_GEOMETRY_UPDATES,1],[He.LOD_RENDERER,2],[He.GRAPHICS_CORE,2],[He.I3S_CONTROLLER,2],[He.POINT_CLOUD_LAYER,2],[He.FEATURE_TILE_FETCHER,2],[He.CLOUDS_GENERATOR,2],[He.OVERLAY,4],[He.STAGE,4],[He.GRAPHICS_DECONFLICTOR,4],[He.FILTER_VISIBILITY,4],[He.SCALE_VISIBILITY,4],[He.FRUSTUM_VISIBILITY,4],[He.POINT_OF_INTEREST_FREQUENT,6],[He.POINT_OF_INTEREST_INFREQUENT,30],[He.LABELER,8],[He.FEATURE_QUERY_ENGINE,8],[He.FEATURE_TILE_TREE,16],[He.FEATURE_TILE_TREE_ACTIVE,Ra],[He.ELEVATION_ALIGNMENT,12],[He.ELEVATION_ALIGNMENT_SCENE,14],[He.TEXT_TEXTURE_ATLAS,12],[He.TEXTURE_UNLOAD,12],[He.LINE_OF_SIGHT_TOOL,16],[He.LINE_OF_SIGHT_TOOL_INTERACTIVE,Ra],[He.SNAPPING,Ra],[He.SHADOW_ACCUMULATOR,30],[He.MAPVIEW_FETCH_QUEUE,Ra],[He.MAPVIEW_LAYERVIEW_UPDATE,2],[He.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Ra]]);function x9(t){return I9.has(t)?I9.get(t):typeof t=="number"?t:1}const yRe=6.5,M9=1,gRe=30,vRe=1e3/30,bRe=100,C9=.9;var L2,Dm;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(s=>s.needsUpdate)}constructor(){this._updating=h$(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new tS("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=Yn.INTERACTING,this._tasks=new vy,this._runQueue=new vy,this._load=0,this._idleStateCallbacks=new vy,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=N(()=>mRe.SCHEDULER_LOG_SLOW_TASKS,s=>this._debug=s,be);for(const s of Object.keys(He))this.performanceInfo.tasks.set(He[s],new tS(He[s]))}destroy(){this._tasks.toArray().forEach(s=>s.remove()),this._tasks.clear(),Kt(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(s){this._updatingChanged(),s&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())}))}registerTask(s,o){const a=new i(this,s,o);return this._tasks.push(a),this._updatingChanged(),this.performanceInfo.tasks.has(s)||this.performanceInfo.tasks.set(s,new tS(s)),a}registerIdleStateCallbacks(s,o){const a={idleBegin:s,idleEnd:o};this._idleStateCallbacks.push(a),this.state===Yn.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const u=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(d){u._idleUpdatesStartFired&&(a.idleEnd(),u._state===Yn.IDLE&&d()),a.idleBegin=d},set idleEnd(d){a.idleEnd=d}}}get load(){return this._load}set state(s){this._state!==s&&(this._state=s,this.state!==Yn.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(o=>o.idleEnd())))}get state(){return this._state}updateBudget(s){this._test&&(this._test.usedBudget=0),++this._frameNumber;let o=yRe,a=s.frameDuration,u=M9;switch(this.state){case Yn.IDLE:o=0,a=Math.max(bRe,s.frameDuration),u=gRe;break;case Yn.INTERACTING:a=Math.max(vRe,s.frameDuration);case Yn.ANIMATING:}return a=a-s.elapsedFrameTime-o,this.state!==Yn.IDLE&&a<M9&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,u),this._budget.reset(a,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case Yn.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(s=>s.idleBegin())),this._runIdle();break;case Yn.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(s){this._idleUpdatesStartFired&&s.idleEnd(),this._idleStateCallbacks.removeUnordered(s)}removeTask(s){this._tasks.removeUnordered(s),this._runQueue.removeUnordered(s),this._updatingChanged()}_updateTask(s){this._tasks.forAll(o=>{o.name===s&&o.setPriority(s)})}_getState(s){if(this._runQueue.some(a=>a.name===s))return Dm.SCHEDULED;let o=Dm.IDLE;return this._tasks.forAll(a=>{a.name===s&&a.needsUpdate&&(a.schedulePriority<=1?o=Dm.READY:o!==Dm.READY&&(o=Dm.WAITING))}),o}_getRuntime(s){let o=0;return this._tasks.forAll(a=>{a.name===s&&(o+=a.runtime)}),o}_resetRuntimes(){this._tasks.forAll(s=>s.runtime=0)}_getRunning(){const s=new Map;if(this._tasks.forAll(a=>{a.needsUpdate&&s.set(a.name,(s.get(a.name)||0)+1)}),s.size===0)return null;let o="";return s.forEach((a,u)=>{o+=a>1?` ${a}x ${u}`:` ${u}`}),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const s=this._tasks.reduce((o,a)=>a.needsUpdate?++o:o,0);this._load=this._load*C9+s*(1-C9)}_schedule(){for(this._runQueue.filterInPlace(s=>!!s.needsUpdate||(s.schedulePriority=s.basePriority,!1)),this._tasks.forAll(s=>{s.basePriority===Ra&&s.needsUpdate&&!this._runQueue.includes(s)&&s.blockFrame!==this._frameNumber&&this._runQueue.unshift(s)});this._runQueue.length===0;){let s=!1,o=0;if(this._tasks.forAll(a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==Ra&&a.blockFrame!==this._frameNumber&&(s=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)}),!s)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const s=this._budget.now();this._startFrameTaskTimes();do for(;this._runQueue.length>0;){const o=this._budget.now(),a=this._runQueue.pop();this._budget.resetProgress();try{a.task.runTask(this._budget)===une&&(a.blockFrame=this._frameNumber)}catch(d){U.getLogger("esri.views.support.Scheduler").error(`Exception in task "${a.name}"`,d),a.blockFrame=this._frameNumber}!this._budget.hasProgressed&&a.blockFrame!==this._frameNumber&&a.needsUpdate&&(a.name,He.I3S_CONTROLLER,a.blockFrame=this._frameNumber),a.schedulePriority=a.basePriority;const u=this._budget.now()-o;if(a.runtime+=u,this._frameTaskTimes.set(a.priority,this._frameTaskTimes.get(a.priority)+u),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-s)}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-s)}_startFrameTaskTimes(){for(const s of Object.keys(He))this._frameTaskTimes.set(He[s],0)}_recordFrameTaskTimes(s){this._frameTaskTimes.forEach((o,a)=>this.performanceInfo.tasks.get(a).push(o)),this.performanceInfo.total.push(s)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(s,o,a){this._scheduler=s,this.name=o,this.blockFrame=0,this.runtime=0,this._queue=new hRe,this._handles=new e_,this._basePriority=x9(o),this.schedulePriority=this._basePriority,this._task=h$(a??this._queue),this._handles.add(Hi(()=>this.task.running,u=>s.taskRunningChanged(u)))}remove(){this.processQueue(cne),this._scheduler.removeTask(this),this.schedule=k9.schedule,this.reschedule=k9.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(s){if(this.name===s)return;this.name=s;const o=x9(s);this._basePriority!==Ra&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(s){this.setPriority(s)}get needsUpdate(){return this.updating||this.task.running}schedule(s,o,a){return this._queue.push(s,o,a)}reschedule(s,o,a){return this._queue.unshift(s,o,a)}processQueue(s){return this._queue.runTask(s)}}class r{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=Yn.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(s){return!this.done&&(s()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(s){this._enabled=s}reset(s,o){this._begin=this.now(),this._budget=s,this._state=o,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=r})(L2||(L2={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(Dm||(Dm={}));const cne=(()=>{const t=new L2.Budget;return t.enabled=!1,t})();let _Re=class{remove(){}processQueue(){}schedule(e,i,r){try{if(lo(i)){const n=mt();return r?Promise.resolve(r(n)):Promise.reject(n)}return UO(e(cne))}catch(n){return Promise.reject(n)}}reschedule(e,i,r){return this.schedule(e,i,r)}};const k9=new _Re;let wRe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=fRe(),this.stationary=!0,this.prepare=()=>{var i;this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),((i=this.view.animation)==null?void 0:i.target)==null||kc(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=i=>{var a;if(this._updateRequested=!1,(a=this.view)==null?void 0:a.destroyed)return;const{allLayerViews:r,graphicsView:n,labelManager:s,state:{id:o}}=this.view;r.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Yn.ANIMATING:this.view.interacting?this._scheduler.state=Yn.INTERACTING:this._scheduler.state=Yn.IDLE,this._scheduler.updateBudget(i)&&this._scheduler.frame()}}destroy(){this.stop(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new Y4,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=N(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=yb(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var n;if(!e.attached)return void this.requestUpdate();const i=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0),r!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((n=e.layerViews)==null||n.forEach(this._updateLayerView,this))}},tM=class extends q{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,i){if(!e)return void U.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new bN;this.view.animation=r,await wi(()=>this.view.ready,i);const n={...i,animate:(i==null?void 0:i.animate)??!cre(),animationMode:(i==null?void 0:i.animationMode)??"auto"},{extent:s,spatialReference:o,size:a,viewpoint:u,constraints:d,padding:p,allLayerViews:h}=this.view,m=AAe(e,{extent:s,spatialReference:o,size:a,viewpoint:u,constraints:d,padding:p,allLayerViews:h,pickClosestTarget:(i==null?void 0:i.pickClosestTarget)??!0});return r==null||r.update(m),this._gotoTask={},n.animate?this._gotoAnimated(m,n):this._gotoImmediate(m,n)}_gotoImmediate(e,i){const r=this._gotoTask,n=this.view.animation,s=e.then(o=>{if(qe(i),r!==this._gotoTask)throw new L("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=o,n.finish()});return this._cancellableGoTo(r,n,s,i)}_gotoAnimated(e,i){const r=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const s=e.then(o=>{if(qe(i),r!==this._gotoTask)throw new L("view:goto-interrupted","Goto was interrupted");return n.update(o),this.view.animationManager.animate(n,this.view.viewpoint,i),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,n,s,i)}_cancellableGoTo(e,i,r,n){const s=()=>e===this._gotoTask;return Xa(r,n).finally(()=>{s()&&(i.done||i.stop())})}};l([c({constructOnly:!0})],tM.prototype,"view",void 0),tM=l([$("esri.views.2d.GoToManager")],tM);function vi(){return Promise.all([k(()=>import("./webglDeps-Cx2-yDpC.js"),__vite__mapDeps([162,84,83,131,163,137])),k(()=>import("./mapViewDeps-Cg6sVZZq.js"),__vite__mapDeps([164,88,165,86,87,26,89,90,85,91,92,55,83,84,82,60,137,97,166,163,103,167,125,124,96,24,25,27,168,116,94,95,123,162,131,169,100,170,81,43,41,29,40,171,134,132,139,172,173,71,174,98,93,175,176,177,178,179,180,135,181]))])}const ew=()=>vi().then(()=>k(()=>import("./TileLayerView2D-HliUoVdT.js"),__vite__mapDeps([182,91,92,55,83,84,82,60,85,89,86,87,88,26,90,116,166,137,163,103,167,125,124,96,24,25,27,123,169,100,170,81,43,41,29,40,71,165,97,94,95,134,132,175,176,183,184,180,185,186,178,179,187,188,189,21,22,23,190,191]))),Vm=()=>vi().then(()=>k(()=>import("./FeatureLayerView2D-wuTb12dR.js").then(t=>t.F),__vite__mapDeps([192,24,25,26,27,193,194,195,185,167,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,165,86,87,88,89,90,97,100,168,116,196,191,187,188]))),L9={"base-dynamic":()=>vi().then(()=>k(()=>import("./BaseDynamicLayerView2D-B_6Jyw7Z.js"),__vite__mapDeps([197,198,166,82,83,84,60,85,137,163,103,167,125,124,96,24,25,26,27,185,199,184,187,188]))),"base-tile":ew,"bing-maps":ew,catalog:()=>vi().then(()=>k(()=>import("./CatalogLayerView2D-BZ4ozt3h.js"),__vite__mapDeps([200,185,167,187]))),"catalog-dynamic-group":()=>vi().then(()=>k(()=>import("./CatalogDynamicGroupLayerView2D-DsJUM7_I.js"),__vite__mapDeps([201,185,167,187]))),"catalog-footprint":()=>vi().then(()=>k(()=>import("./CatalogFootprintLayerView2D-B5nFyL6K.js"),__vite__mapDeps([202,192,24,25,26,27,193,194,195,185,167,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,165,86,87,88,89,90,97,100,168,116,196,191,187,188]))),csv:Vm,"geo-rss":()=>vi().then(()=>k(()=>import("./GeoRSSLayerView2D-BfkmbDIb.js"),__vite__mapDeps([203,185,167,177,178,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,24,25,26,27,165,86,87,88,89,90,97,175,81,43,41,29,40,176,187]))),feature:Vm,geojson:Vm,parquet:Vm,graphics:()=>vi().then(()=>k(()=>import("./GraphicsLayerView2D-C0Uj0YQC.js"),__vite__mapDeps([204,185,167,177,178,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,24,25,26,27,165,86,87,88,89,90,97,175,81,43,41,29,40,176,196,187]))),group:()=>vi().then(()=>k(()=>import("./GroupLayerView2D-DYcP1vls.js"),__vite__mapDeps([205,185,167,187]))),imagery:()=>vi().then(()=>k(()=>import("./ImageryLayerView2D-YKylDrtJ.js"),__vite__mapDeps([206,207,84,137,60,107,166,82,83,85,163,103,167,125,124,96,24,25,26,27,185,175,86,87,88,89,90,81,43,91,92,55,41,29,40,165,97,176,186,178,179,180,198,184,199,110,193,194,195,191,187,188]))),"imagery-tile":()=>vi().then(()=>k(()=>import("./ImageryTileLayerView2D-BdaPCeX_.js"),__vite__mapDeps([208,209,207,84,137,60,107,166,82,83,85,163,103,167,125,124,96,24,25,26,27,185,210,180,211,110,193,194,195,191,187,188]))),kml:()=>vi().then(()=>k(()=>import("./KMLLayerView2D-C7wb6Sqd.js"),__vite__mapDeps([212,213,184,167,198,166,82,83,84,60,85,137,163,103,125,124,96,24,25,26,27,185,177,178,179,91,92,55,180,165,86,87,88,89,90,97,175,81,43,41,29,40,176,187,110,171,162,131,134,132,170,116,139,210]))),"knowledge-graph":()=>vi().then(()=>k(()=>import("./KnowledgeGraphLayerView2D-D6NFrRen.js"),__vite__mapDeps([214,185,167,187]))),"link-chart":()=>vi().then(()=>k(()=>import("./KnowledgeGraphLayerView2D-D6NFrRen.js"),__vite__mapDeps([214,185,167,187]))),"knowledge-graph-sublayer":Vm,"map-image":()=>vi().then(()=>k(()=>import("./MapImageLayerView2D-BM350LoS.js"),__vite__mapDeps([215,198,166,82,83,84,60,85,137,163,103,167,125,124,96,24,25,26,27,185,175,86,87,88,89,90,81,43,91,92,55,41,29,40,165,97,176,186,178,179,180,199,184,187,193,194,195,188,189,21,22,23,190,191]))),"map-notes":()=>vi().then(()=>k(()=>import("./MapNotesLayerView2D-DyFmh6XI.js"),__vite__mapDeps([216,185,167,177,178,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,24,25,26,27,165,86,87,88,89,90,97,175,81,43,41,29,40,176,187]))),media:()=>vi().then(()=>k(()=>import("./MediaLayerView2D-BAtGYMKQ.js"),__vite__mapDeps([217,218,176,91,92,55,83,84,82,60,85,89,86,87,88,26,90,116,166,137,163,103,167,125,124,96,24,25,27,123,169,100,170,81,43,41,29,40,71,165,97,94,95,134,132,175,174,98,219,185,187]))),"ogc-feature":()=>vi().then(()=>k(()=>import("./OGCFeatureLayerView2D-9ZZCZjIg.js"),__vite__mapDeps([220,192,24,25,26,27,193,194,195,185,167,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,165,86,87,88,89,90,97,100,168,116,196,191,187,188]))),"open-street-map":ew,"oriented-imagery":Vm,route:()=>vi().then(()=>k(()=>import("./RouteLayerView2D-DW52tYf8.js"),__vite__mapDeps([221,222,185,167,177,178,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,24,25,26,27,165,86,87,88,89,90,97,175,81,43,41,29,40,176,187]))),stream:()=>vi().then(()=>k(()=>import("./StreamLayerView2D-B-uY2FXG.js"),__vite__mapDeps([223,192,24,25,26,27,193,194,195,185,167,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,165,86,87,88,89,90,97,100,168,116,196,191,187,188]))),"subtype-group":()=>vi().then(()=>k(()=>import("./SubtypeGroupLayerView2D-tuKDo99u.js"),__vite__mapDeps([224,192,24,25,26,27,193,194,195,185,167,179,91,92,55,83,84,82,60,85,180,166,137,163,103,125,124,96,165,86,87,88,89,90,97,100,168,116,196,191,187,188]))),tile:ew,"vector-tile":()=>vi().then(()=>k(()=>import("./VectorTileLayerView2D-CJn3lf8l.js"),__vite__mapDeps([225,123,90,71,173,116,97,89,84,137,124,166,82,83,60,85,163,103,167,125,96,24,25,26,27,180,39,126,127,185,187,188]))),video:()=>vi().then(()=>k(()=>import("./VideoLayerView2D-CXgJUcM3.js"),__vite__mapDeps([226,227,219,103,166,82,83,84,60,85,137,163,167,125,124,96,24,25,26,27,165,86,87,88,89,90,91,92,55,97,185,177,178,179,180,175,81,43,41,29,40,176,187]))),wcs:()=>vi().then(()=>k(()=>import("./ImageryTileLayerView2D-BdaPCeX_.js"),__vite__mapDeps([208,209,207,84,137,60,107,166,82,83,85,163,103,167,125,124,96,24,25,26,27,185,210,180,211,110,193,194,195,191,187,188]))),"web-tile":ew,wfs:Vm,wms:()=>vi().then(()=>k(()=>import("./WMSLayerView2D-C_Fy7c0C.js"),__vite__mapDeps([228,198,166,82,83,84,60,85,137,163,103,167,125,124,96,24,25,26,27,185,199,184,187,188,229,193,194,195]))),wmts:()=>vi().then(()=>k(()=>import("./WMTSLayerView2D-C81nWJGw.js"),__vite__mapDeps([230,183,184,167,166,82,83,84,60,85,137,163,103,125,124,96,24,25,26,27,180,185,187,188]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,focusArea:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function SRe(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new L(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const A9={hasLayerViewModule:t=>L9[t.type]!=null,importLayerView:t=>{const e=L9[t.type];if(e==null)throw SRe(t);return e(t)}};function $Re(t,e){const{spatialReference:i}=e,r=[e.x,e.y];let n=Number.POSITIVE_INFINITY,s=0,o=0;const a=[0,0],u=t.type==="extent"?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const d of u)for(let p=0;p<d.length-1;p++){dve(a,r,d,p);const h=E_(r,a);h<n&&(n=h,s=a[0],o=a[1])}return{coordinate:new we({x:s,y:o,spatialReference:i}),distance:n}}var xN;let ly=xN=class extends QV(q){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return On(this.geometry,this.spatialReference)}catch(t){return U.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?U$(this.normalizedGeometry,i):AV(this.normalizedGeometry,i))return t;const{coordinate:r}=$Re(this.normalizedGeometry,i);return r&&(t.targetGeometry=r),t}clone(){var t,e;return new xN({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};l([c({constructOnly:!0})],ly.prototype,"geometry",void 0),l([c({readOnly:!0})],ly.prototype,"normalizedGeometry",null),l([c({constructOnly:!0})],ly.prototype,"spatialReference",void 0),ly=xN=l([$("esri.views.2d.constraints.GeometryConstraint")],ly);var MN;let F1=MN=class extends QV(q){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new MN({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};l([c()],F1.prototype,"enabled",void 0),l([c()],F1.prototype,"rotationEnabled",void 0),F1=MN=l([$("esri.views.2d.constraints.RotationConstraint")],F1);const dne=F1;var CN;let qs=CN=class extends QV(q){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:r,minZoom:n,maxZoom:s}=this,o=-1,a=-1,u=!1,d=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!(e!=null&&e.length))return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);e=e.map(p=>p.clone()),e.sort((p,h)=>h.scale-p.scale),e.forEach((p,h)=>p.level=h);for(const p of e)!u&&i>0&&i>=p.scale&&(o=p.level,u=!0),!d&&r>0&&r>=p.scale&&(a=t?t.level:-1,d=!0),t=p;n===-1&&(n=i===0?0:o),s===-1&&(s=r===0?e.length-1:a),n=Math.max(n,0),n=Math.min(n,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),n>s&&([n,s]=[s,n]),i=e[n].scale,r=e[s].scale,e.splice(0,n),e.splice(s-n+1,e.length),e.forEach((p,h)=>{this._lodByScale[p.scale]=p,this._scales[h]=p.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,r=this.effectiveMaxScale,n=t.targetGeometry,s=e&&e.targetGeometry,o=r!==0&&t.scale<r,a=i!==0&&t.scale>i;if(o||a){const u=a?i:r;if(e&&s){const d=(u-e.scale)/(t.scale-e.scale);n.x=s.x+(n.x-s.x)*d,n.y=s.y+(n.y-s.y)*d}t.scale=u}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),r=Math.ceil(t);return e[i]+(t-i)*(e[r]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],r=e[n+1],r===t)return n+this.effectiveMinZoom+1;if(i>t&&r<t)return n+this.effectiveMinZoom+1-(t-r)/(i-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new CN({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};l([c({readOnly:!0})],qs.prototype,"effectiveLODs",void 0),l([c({readOnly:!0})],qs.prototype,"effectiveMinZoom",void 0),l([c({readOnly:!0})],qs.prototype,"effectiveMaxZoom",void 0),l([c({readOnly:!0})],qs.prototype,"effectiveMinScale",void 0),l([c({readOnly:!0})],qs.prototype,"effectiveMaxScale",void 0),l([c()],qs.prototype,"lods",void 0),l([c()],qs.prototype,"minZoom",void 0),l([c()],qs.prototype,"maxZoom",void 0),l([c()],qs.prototype,"minScale",void 0),l([c()],qs.prototype,"maxScale",void 0),l([c()],qs.prototype,"snapToZoom",void 0),qs=CN=l([$("esri.views.2d.constraints.ZoomConstraint")],qs);const pne=qs,ERe={base:null,key:"type",typeMap:{extent:at,polygon:os}};let Qi=class extends q{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Y}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,r;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _geometry(){var i,r;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new ly({geometry:this.geometry,spatialReference:(r=this.view)==null?void 0:r.constraintsInfo.spatialReference})}get _rotation(){return new dne({rotationEnabled:this.rotationEnabled})}get _zoom(){var u;const e=this._get("_zoom"),i=this.lods||((u=this.view)==null?void 0:u.constraintsInfo.lods),r=this.minZoom,n=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===i&&e.minZoom===r&&e.maxZoom===n&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new pne({lods:i,minZoom:r,maxZoom:n,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(r=>r.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(i=>{var r;return(r=i.applyPanConstraint)==null?void 0:r.call(i,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};l([c({readOnly:!0})],Qi.prototype,"effectiveLODs",null),l([c({readOnly:!0})],Qi.prototype,"effectiveMinScale",null),l([c({readOnly:!0})],Qi.prototype,"effectiveMaxScale",null),l([c({readOnly:!0})],Qi.prototype,"effectiveMinZoom",null),l([c({readOnly:!0})],Qi.prototype,"effectiveMaxZoom",null),l([c({types:ERe,value:null})],Qi.prototype,"geometry",null),l([c({type:[Uh]})],Qi.prototype,"lods",void 0),l([c()],Qi.prototype,"minScale",void 0),l([c()],Qi.prototype,"maxScale",void 0),l([c()],Qi.prototype,"minZoom",void 0),l([c()],Qi.prototype,"maxZoom",void 0),l([c()],Qi.prototype,"rotationEnabled",void 0),l([c()],Qi.prototype,"snapToZoom",void 0),l([c({type:Y})],Qi.prototype,"customConstraints",void 0),l([c()],Qi.prototype,"view",void 0),l([c({readOnly:!0})],Qi.prototype,"version",null),l([c({type:ly,readOnly:!0})],Qi.prototype,"_geometry",null),l([c({type:dne})],Qi.prototype,"_rotation",null),l([c({readOnly:!0,type:pne})],Qi.prototype,"_zoom",null),Qi=l([$("esri.views.2d.MapViewConstraints")],Qi);const hne=Qi;let _m=class Ff{static getId(e,i,r,n){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${i}/${r}/${n}`}constructor(e,i,r,n){this.set(e,i,r,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|e<<8|r}acquire(e,i,r,n){this.set(e,i,r,n)}contains(e){const i=e.level-this.level;return i>=0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}containsChild(e){const i=e.level-this.level;return i>0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Ff(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,i,r,n){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,u]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(u)}else this.level=+e,this.row=+i,this.col=+r,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Ff(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,i,r){const n=this.clone();return n.col+=e,n.row+=i,r.normalizeKey(n),n}getChildKeys(){const e=this.level+1,i=this.row<<1,r=this.col<<1,n=this.world;return[new Ff(e,i,r,n),new Ff(e,i,r+1,n),new Ff(e,i+1,r,n),new Ff(e,i+1,r+1,n)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};_m.pool=new tg(_m,null,null,25,50);function Ig(t,e){return[t,e]}function Um(t,e,i){return t[0]=e,t[1]=i,t}function TRe(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}const pl=new _m("0/0/0/0");let IRe=class mne{static create(e,i,r=null){const n=Ln(e.spatialReference),s=i.origin||Ig(e.origin.x,e.origin.y),o=Ig(e.size[0]*i.resolution,e.size[1]*i.resolution),a=Ig(-1/0,-1/0),u=Ig(1/0,1/0),d=Ig(1/0,1/0);r!=null&&(Um(a,Math.max(0,Math.floor((r.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymax)/o[1]))),Um(u,Math.max(0,Math.floor((r.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymin)/o[1]))),Um(d,u[0]-a[0]+1,u[1]-a[1]+1));const{cols:p,rows:h}=i;let m,y,g,v;return!r&&p&&h&&(Um(a,p[0],h[0]),Um(u,p[1],h[1]),Um(d,p[1]-p[0]+1,h[1]-h[0]+1)),e.isWrappable?(m=Ig(Math.ceil(Math.round((n.valid[1]-n.valid[0])/i.resolution)/e.size[0]),d[1]),y=!0,g=n.origin,v=n.valid):(m=d,y=!1),new mne(i.level,i.resolution,i.scale,s,a,u,d,o,m,y,g,v)}constructor(e,i,r,n,s,o,a,u,d,p,h,m){this.level=e,this.resolution=i,this.scale=r,this.origin=n,this.first=s,this.last=o,this.size=a,this.norm=u,this.worldSize=d,this.wrap=p,this._spatialReferenceOrigin=h,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const i=this.worldSize[0];return e<0?i-1-Math.abs((e+1)%i):e%i}normalizeKey(e){if(!this.wrap)return;const i=this.worldSize[0],r=e.col;r<0?(e.col=r+i,e.world-=1):r>=i&&(e.col=r-i,e.world+=1)}denormalizeCol(e,i){return this.wrap?this.worldSize[0]*i+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const i=this.origin[0]+e*this.norm[0],r=this._spatialReferenceOrigin,n=this._spatialReferenceValid;return this.wrap&&r&&n?i===r[0]?n[0]:this.origin[0]===r[0]&&e===this.worldSize[0]?n[1]:i:i}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,i,r=!1){pl.set(i);const n=r?pl.col:this.denormalizeCol(pl.col,pl.world),s=pl.row;return TRe(e,this.getXForColumn(n),this.getYForRow(s+1),this.getXForColumn(n+1),this.getYForRow(s)),e}getTileCoords(e,i,r=!1){pl.set(i);const n=r?pl.col:this.denormalizeCol(pl.col,pl.world);return Array.isArray(e)?Um(e,this.getXForColumn(n),this.getYForRow(pl.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(pl.row)),e}},y$=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:i,colFrom:r,colTo:n}of this.spans)for(let s=r;s<=n;s++){const o=e.getWorldForColumn(s);yield new _m(e.level,i,e.normalizeCol(s),o)}}forEach(e,i){const{spans:r,lodInfo:n}=this,{level:s}=n;if(r.length!==0)for(const{row:o,colFrom:a,colTo:u}of r)for(let d=a;d<=u;d++)e.call(i,s,o,n.normalizeCol(d),n.getWorldForColumn(d))}};y$.pool=new tg(y$);let LA=class{constructor(e,i,r){this.row=e,this.colFrom=i,this.colTo=r}};const $i=new _m("0/0/0/0");let xRe=class fne{static create(e,i){e[1]>i[1]&&([e,i]=[i,e]);const[r,n]=e,[s,o]=i,a=s-r,u=o-n,d=u!==0?a/u:0,p=(Math.ceil(n)-n)*d,h=(Math.floor(n)-n)*d;return new fne(r,Math.floor(n),Math.ceil(o),d,a<0?p:h,a<0?h:p,a<0?s:r,a<0?r:s)}constructor(e,i,r,n,s,o,a,u){this.x=e,this.ymin=i,this.ymax=r,this.invM=n,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=u}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const fo=[[0,0],[0,0],[0,0],[0,0]],MRe=1e-6;let CRe=class{constructor(e,i=null,r=e.lods[0].level,n=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=r&&a.level<=n);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>IRe.create(e,a,i));s.forEach((a,u)=>{this._infoByLevel[a.level]=o[u],this._infoByScale[a.scale]=o[u],this.scales[u]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,i,r=!1){$i.set(i);const n=this._infoByLevel[$i.level];return n?n.getTileBounds(e,$i,r):e}getTileCoords(e,i,r=!1){$i.set(i);const n=this._infoByLevel[$i.level];return n?n.getTileCoords(e,$i,r):e}getTileCoverage(e,i=192,r=!0,n="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=n==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=y$.pool.acquire(s),a=this._wrap;let u,d,p,h=1/0,m=-1/0;const y=o.spans;fo[0][0]=fo[0][1]=fo[1][1]=fo[3][0]=-i,fo[1][0]=fo[2][0]=e.size[0]+i,fo[2][1]=fo[3][1]=e.size[1]+i;for(const w of fo)e.toMap(w,w),w[0]=s.getColumnForX(w[0]),w[1]=s.getRowForY(w[1]);const g=[];let v=3;for(let w=0;w<4;w++){if(fo[w][1]===fo[v][1]){v=w;continue}const S=xRe.create(fo[w],fo[v]);h=Math.min(S.ymin,h),m=Math.max(S.ymax,m),g[S.ymin]===void 0&&(g[S.ymin]=[]),g[S.ymin].push(S),v=w}if(h==null||m==null||m-h>100)return null;let _=[];for(u=h;u<m;){g[u]!=null&&(_=_.concat(g[u])),d=1/0,p=-1/0;for(let w=_.length-1;w>=0;w--){const S=_[w];d=Math.min(d,S.getLeftCol()),p=Math.max(p,S.getRightCol())}if(d=Math.floor(d),p=Math.floor(p),u>=s.first[1]&&u<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const w=Math.floor(p/s.worldSize[0]);for(let S=Math.floor(d/s.worldSize[0]);S<=w;S++)y.push(new LA(u,Math.max(s.getFirstColumnForWorld(S),d),Math.min(s.getLastColumnForWorld(S),p)))}else y.push(new LA(u,d,p));else d>s.last[0]||p<s.first[0]||(d=Math.max(d,s.first[0]),p=Math.min(p,s.last[0]),y.push(new LA(u,d,p)));u+=1;for(let w=_.length-1;w>=0;w--){const S=_[w];S.ymax>=u?S.incrRow():_.splice(w,1)}}return o}getTileParentId(e){$i.set(e);const i=this._infoByLevel[$i.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD($i,this._lodInfos[r],$i),$i.id)}getTileResolution(e){const i=this._infoByLevel[typeof e=="object"?e.level:e];return i?i.resolution:-1}getTileScale(e){const i=this._infoByLevel[e.level];return i?i.scale:-1}intersects(e,i){$i.set(i);const r=this._infoByLevel[$i.level],n=e.lodInfo;if(n.resolution>r.resolution){this._getTileIdAtLOD($i,n,$i);const o=n.denormalizeCol($i.col,$i.world);for(const a of e.spans)if(a.row===$i.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(n.resolution<r.resolution){const[o,a,u,d]=e.spans.reduce((v,_)=>(v[0]=Math.min(v[0],_.row),v[1]=Math.max(v[1],_.row),v[2]=Math.min(v[2],_.colFrom),v[3]=Math.max(v[3],_.colTo),v),[1/0,-1/0,1/0,-1/0]),p=r.denormalizeCol($i.col,$i.world),h=n.getColumnForX(r.getXForColumn(p)),m=n.getRowForY(r.getYForRow($i.row)),y=n.getColumnForX(r.getXForColumn(p+1))-1,g=n.getRowForY(r.getYForRow($i.row+1))-1;return!(h>d||y<u||m>a||g<o)}const s=n.denormalizeCol($i.col,$i.world);return e.spans.some(o=>o.row===$i.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,i,r){if(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],this._wrap){const n=Ln(this.tileInfo.spatialReference),s=-r*(n.valid[1]-n.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(e>i[r]+MRe)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(e){const i=this.scales;return this._infoByScale[e]||(e=i.reduce((r,n)=>Math.abs(n-e)<Math.abs(r-e)?n:r,i[0])),this._infoByScale[e]}scaleToLevel(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=i.length-1;r>=0;r--)if(e<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-e)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,i,r){const n=this._infoByLevel[r.level];return e.set(r),i.resolution<n.resolution?null:(i.resolution===n.resolution||(e.level=i.level,e.col=Math.floor(r.col*n.resolution/i.resolution+.01),e.row=Math.floor(r.row*n.resolution/i.resolution+.01)),e)}},kRe=class{constructor(e,i){this.item=e,this.controller=i,this.promise=null}},yne=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new ip,this._controllers=new ip,this._processingItems=new ip,this._pausedSignal=h$(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Nb(e.peeker),this.process=e.process;const i=e.scheduler;e.priority&&i&&(this._task=i.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Kt(this._schedule),this._task=Kt(this._task)}get updating(){var e;return!!((e=this._task)!=null&&e.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const i=this._controllers.get(e);i&&i.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(i=>e.push(i)),this._controllers.clear(),e.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((i,r)=>e(r))}get(e){const i=this._deferreds.get(e);return i?i.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,i){const r=this.get(e);if(r)return r;const n=new AbortController;let s=null;i&&(s=ks(i,()=>n.abort()));const o=()=>{const p=this._processingItems.get(e);p&&p.controller.abort(),a(),d.reject(mt())},a=()=>{u.remove(),s!=null&&s.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},u=nV(n.signal,o),d=fn();return this._deferreds.set(e,d),this._controllers.set(e,n),d.promise.then(a,a),this._queue.push(e),this._scheduleNext(),d.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){var i;const e=this._queue.popLast();return e&&((i=this._deferreds.get(e))==null||i.reject(mt()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const i of e)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=P$(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(i))}_processError(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(i))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let i;const r=new AbortController,n=new kRe(e,r);this._processingItems.set(e,n);try{i=this.process(e,r.signal)}catch(s){this._processError(n,s)}kc(i)?(n.promise=i,i.then(s=>this._processResult(n,s),s=>this._processError(n,s))):this._processResult(n,i)}get test(){}};const O9=[0,0];let gd=class extends q{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:i,scheduler:r,priority:n}=this;this._queue=new yne({concurrency:e,scheduler:r,priority:n,process:(s,o)=>{const a=this._keyToItem.get(s);return i(a,{signal:o})},peeker:s=>this._peek(s)})}destroy(){this.clear(),this._queue=xe(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const i=e.key.id;if(this._queue.has(i))return this._queue.get(i);const r=this._queue.push(i),n=this.tileInfoView.getTileScale(e.key),s=Xd(this._tilesByScale,n,()=>new Set),o=()=>{s.delete(e.key),s.size===0&&this._tilesByScale.delete(n),this._keyToItem.delete(i)};return s.add(e.key),this._keyToItem.set(i,e),r.then(o,o),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const i=new Set;for(const o of e)i.add(this._keyToItem.get(o).key);const r=this.state.scale;let n,s=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(UZ(a,u=>i.has(u))){const u=Math.abs(o-r);u<s&&(n=a,s=u)}return this._getClosestTileKey(n,e).id}_getClosestTileKey(e,i){const r=this.tileInfoView,n=this.state.center;let s,o=Number.POSITIVE_INFINITY;for(const a of e)if(i.has(a.id)){r.getTileCoords(O9,a);const u=E_(O9,n);u<o&&(o=u,s=a)}return s}};l([c({constructOnly:!0})],gd.prototype,"concurrency",void 0),l([c({constructOnly:!0})],gd.prototype,"priority",void 0),l([c({constructOnly:!0})],gd.prototype,"process",void 0),l([c({constructOnly:!0})],gd.prototype,"scheduler",void 0),l([c()],gd.prototype,"state",void 0),l([c({constructOnly:!0})],gd.prototype,"tileInfoView",void 0),gd=l([$("esri.views.2d.tiling.TileQueue")],gd);const Wtt=gd;let LRe=class{constructor(e,i,r){this.maxSize=e,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const r=i.key.level,n=this._tileKeysPerLevel[r];R9(this._tilePerId,e);for(let s=0;s<n.length;s++)if(n[s].id===e){n.splice(s,1);break}return i.visible=!0,i}add(e){e.visible=!1;const i=e.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const n=i.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(i)}prune(e,i,r){let n=this._tilePerId.size;if(n<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&s>=0;)s!==e&&(n=this._pruneAroundCenterTile(n,i,r,s)),s--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,i,r,e))}_pruneAroundCenterTile(e,i,r,n){const s=this._tileKeysPerLevel[n];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,u=r*o[0],d=r*o[1],p=[0,0],h=[0,0];for(s.sort((m,y)=>(p[0]=a.x+u*(m.col+.5),p[1]=a.y-d*(m.row+.5),h[0]=a.x+u*(y.col+.5),h[1]=a.y-d*(y.row+.5),Ub(p,i)-Ub(h,i)));s.length>0;){const m=s.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),R9(this._tilePerId,e)}};function R9(t,e){t.delete(e)}const jm=new _m(0,0,0,0),jc=new Map,tw=[],AA=[];let Jtt=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new LRe(e.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(e){var w,S;const{resampling:i,tileIndex:r}=this,{scale:n,center:s,resolution:o}=e.state,{minScale:a,maxScale:u}=this.tileInfoView,d=!e.stationary&&n>this._previousScale;if(this._previousScale=n,!i&&(n>a||n<u))return this.tiles.length=0,void this.clear();const p=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!p)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:m}=p,{level:y}=m;this.tiles.length=0,r.forEach(E=>E.visible=!0);let g=0,v=0;if(h.length>0)for(const{row:E,colFrom:T,colTo:M}of h)for(let x=T;x<=M;x++){g++;const C=jm.set(y,E,m.normalizeCol(x),m.getWorldForColumn(x)).id;let O=r.get(C);if(O)O.isReady?(jc.set(C,O),v++):d||this._addParentTile(C,jc);else{if((w=this._tileCache)!=null&&w.has(C)){if(O=this._tileCache.pop(C),this.tileIndex.set(C,O),O.isReady){jc.set(C,O),v++;continue}}else O=this.acquireTile(jm),this.tileIndex.set(C,O);d||this._addParentTile(C,jc)}}const _=v===g;for(const[E,T]of r){if(jc.has(E))continue;jm.set(E);const M=this.tileInfoView.intersects(p,jm),x=this.cachePolicy==="purge"?jm.level!==y:jm.level>y;!M||!d&&_?!x&&M||tw.push(T):T.isReady?x&&this.cachePolicy==="purge"&&this._hasReadyAncestor(jm,y)?tw.push(T):AA.push(T):x&&tw.push(T)}for(const E of AA)E.isReady&&jc.set(E.key.id,E);for(const E of tw)this._tileCache?this._tileCache.add(E):this.releaseTile(E),r.delete(E.key.id);for(const E of jc.values())this.tiles.push(E);for(const E of r.values())jc.has(E.key.id)||(E.visible=!1);(S=this._tileCache)==null||S.prune(y,s,o),y$.pool.release(p),AA.length=0,tw.length=0,jc.clear()}clear(){const{tileIndex:e}=this;for(const i of e.values())this.releaseTile(i);e.clear()}refresh(e){var i;for(const r of this.tileIndex.values())e(r);(i=this._tileCache)==null||i.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,i){var s;let r=e,n=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(n=this.tileIndex.get(r),n==null?void 0:n.isReady){i.has(n.key.id)||i.set(n.key.id,n);break}}else if((s=this._tileCache)!=null&&s.has(r)&&(n=this._tileCache.pop(r),this.tileIndex.set(r,n),n==null?void 0:n.isReady)){i.has(n.key.id)||i.set(n.key.id,n);break}}_hasReadyAncestor(e,i){const r=Cn();this.tileInfoView.getTileBounds(r,e,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=i&&n.key.level<e.level){const s=Cn();if(this.tileInfoView.getTileBounds(s,n.key,!0),ZV(s,r))return!0}return!1}},Hn=class extends q{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([N(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},yn)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new we({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void U.getLogger(this).error(new L("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const r=this.viewpoint;SN(r,r,i),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void U.getLogger(this).error(new L("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void U.getLogger(this).error(new L("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const r=this.viewpoint;RAe(r,r,i,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;BAe(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const i=this.viewpoint;_9(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var s;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,r;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new L("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new L("mapview:invalid-viewpoint","geometry not defined"))}catch(o){r=new L("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(r)return void U.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new Ar({targetGeometry:new we,scale:0,rotation:0});ns(n,i),(s=this.constraints)==null||s.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var n,s;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const i=((n=this.constraints)==null?void 0:n.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const r=this.viewpoint;_9(r,r,i),this.viewpoint=r,this._set("zoom",((s=this.constraints)==null?void 0:s.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:r}=this,n=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),u=this._get("viewpoint"),d=this._get("zoom"),p=d!=null&&r!=null&&r.zoomToScale(d)||void 0;let h,m,y;const g=u==null?void 0:u.rotation,v=u==null?void 0:u.targetGeometry;(v==null?void 0:v.type)==="extent"?h=v:(v==null?void 0:v.type)==="point"&&(m=v,y=u==null?void 0:u.scale);const _=s??h;return{center:n??m??(_==null?void 0:_.center),rotation:a??g,scale:(o??p??y??(_&&Nk(_,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,r,n){var o;const s=e.targetGeometry;try{this._project(e,r)}catch(a){U.getLogger(this).warn(new Jo("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:r,error:a})),e.targetGeometry=n||new we({x:0,y:0,spatialReference:r})}(o=this.constraints)==null||o.fit(e),this._set("state",new Y4({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:r,rotation:n,scale:s}=this.state.paddedViewState,o=new we({x:e,y:i,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){var u;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const d=i.viewpoint.clone();d.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=d}const r=i.clone(),[n,s]=i.center;let o=null;try{o=this._project(new we({x:n,y:s,spatialReference:i.spatialReference}),e)}catch(d){FC()||U.getLogger(this).warn(new Jo("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:d}))}o||(o=new we({x:0,y:0,spatialReference:e}));const a=SN(new Ar({targetGeometry:new we,scale:0,rotation:0}),i.viewpoint,o);r.viewpoint=a;try{const p=[i.size[0]/2,i.size[1]/2],h=[p[0]+20,p[1]],m=i.toMap([0,0],h),{x:y,y:g}=this._project(new we({x:m[0],y:m[1],spatialReference:i.spatialReference}),e);m[0]=y,m[1]=g,r.toScreen(m,m);const v=jAe(p,m,h),_=Math.hypot(m[0]-p[0],m[1]-p[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(a.rotation=0,a.targetGeometry=new we({x:0,y:0,spatialReference:e})):(a.scale*=_,a.scale>G("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(v)?v:0)}catch{}(u=this._get("constraints"))==null||u.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,i){var o;if(!this.ready)return;const r=this.state;let n=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.slice();r.size=[e,i],zAe(n,n,s,this.state.paddedViewState.size,this.resizeAlign),n=((o=this.constraints)==null?void 0:o.constrain(n,void 0))??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const i=[0,0],[r,n]=this.state.toMap(i,[e.x,e.y]),s=this.state.spatialReference;return new we({x:r,y:n,spatialReference:s})}toScreen(e,i){if(!this.ready)return null;const r=this._project(e,this.state.spatialReference),n=[r.x,r.y];return(i==null?void 0:i.pickClosestTarget)===!1||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),Mi(n[0],n[1])}_project(e,i){var s;const r=(e==null?void 0:e.targetGeometry)||e;if(!i)return e;if(!r)return null;if(i.imageCoordinateSystem||(s=r.spatialReference)!=null&&s.imageCoordinateSystem||ci(i,r.spatialReference))return e;const n=On(r,i);if(!n)throw new L("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:i});return ARe(e)?(e.targetGeometry=n,e):n}};function ARe(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}l([c({type:we})],Hn.prototype,"center",null),l([c()],Hn.prototype,"constraints",void 0),l([c({type:at})],Hn.prototype,"extent",null),l([c({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Hn.prototype,"padding",null),l([c()],Hn.prototype,"ready",void 0),l([c()],Hn.prototype,"resizeAlign",void 0),l([c({readOnly:!0})],Hn.prototype,"resolution",null),l([c({type:Number})],Hn.prototype,"rotation",null),l([c({type:Number})],Hn.prototype,"scale",null),l([c({readOnly:!0})],Hn.prototype,"state",void 0),l([c({type:Ar})],Hn.prototype,"viewpoint",null),l([c({readOnly:!0})],Hn.prototype,"visibleArea",null),l([c()],Hn.prototype,"zoom",null),Hn=l([$("esri.views.2d.ViewStateManager")],Hn);function K4(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}let P9=class extends Kr{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(e,i){K4(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},ORe=class extends Kr{constructor(e,i,r){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:r}=i;if(r!==this.pointerType)return;e.stopPropagation();const{action:n,delta:s}=i,{view:o}=this,{mapViewNavigation:a}=o;switch(n){case"begin":{const{scale:u}=o;this._startScale=u,this._currentScale=u,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const u=1.015**s.y,d=this._startScale*u,p=d/this._currentScale;a.setViewpointImmediate(p),this._currentScale=d;break}case"end":{const{constraints:u}=o,{effectiveLODs:d,snapToZoom:p}=u;if(!p||!d)return void a.end();const h=u.snapScale(this._currentScale),m=(s.y>0?Math.max(h,u.snapToPreviousScale(this._startScale)):Math.min(h,u.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(m).then(()=>{a.end()});break}}}},Vk=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,r;this._startEvent=e,(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},RRe=class extends Kr{constructor(e,i,r){super(!0),this.view=e,this.pointerAction=i,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Vk({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&K4(r.data,this.pointerAction)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},PRe=class extends Kr{constructor(e,i,r){super(!0),this._view=e,this.pointerAction=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Vk({start:(s,o)=>{n.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{n.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{n.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&K4(o.data,this.pointerAction)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function Si(t){const e=t[0],i=t[1],r=t[2];return Math.sqrt(e*e+i*i+r*r)}function Yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function vt(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t}function di(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function hi(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function X4(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function gne(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function FRe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function NRe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Bb(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function vne(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function bne(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function _ne(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function DRe(t,e=0,i=1){return t[0]=Math.min(Math.max(t[0],e),i),t[1]=Math.min(Math.max(t[1],e),i),t[2]=Math.min(Math.max(t[2],e),i),t}function VRe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function jt(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function ni(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t}function fg(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+r*r+n*n)}function yp(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n}function Wy(t){const e=t[0],i=t[1],r=t[2];return e*e+i*i+r*r}function URe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function jRe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ls(t,e){const i=e[0],r=e[1],n=e[2];let s=i*i+r*r+n*n;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function tt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function As(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],u=i[2];return t[0]=n*u-s*a,t[1]=s*o-r*u,t[2]=r*a-n*o,t}function GRe(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],u=i[2],d=n*u-s*a,p=s*o-r*u,h=r*a-n*o,m=Math.sqrt(d*d+p*p+h*h);return t[0]=d/m,t[1]=p/m,t[2]=h/m,t}function Uk(t,e,i,r){const n=e[0],s=e[1],o=e[2];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t[2]=o+r*(i[2]-o),t}function zRe(t,e,i,r,n,s){const o=s*s,a=o*(2*s-3)+1,u=o*(s-2)+s,d=o*(s-1),p=o*(3-2*s);return t[0]=e[0]*a+i[0]*u+r[0]*d+n[0]*p,t[1]=e[1]*a+i[1]*u+r[1]*d+n[1]*p,t[2]=e[2]*a+i[2]*u+r[2]*d+n[2]*p,t}function BRe(t,e,i,r,n,s){const o=1-s,a=o*o,u=s*s,d=a*o,p=3*s*a,h=3*u*o,m=u*s;return t[0]=e[0]*d+i[0]*p+r[0]*h+n[0]*m,t[1]=e[1]*d+i[1]*p+r[1]*h+n[1]*m,t[2]=e[2]*d+i[2]*p+r[2]*h+n[2]*m,t}function HRe(t,e=1){const i=z$,r=2*i()*Math.PI,n=2*i()-1,s=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=n*e,t}function Wa(t,e,i){const r=e[0],n=e[1],s=e[2];return t[0]=i[0]*r+i[4]*n+i[8]*s+i[12],t[1]=i[1]*r+i[5]*n+i[9]*s+i[13],t[2]=i[2]*r+i[6]*n+i[10]*s+i[14],t}function wne(t,e,i){const r=e[0],n=e[1],s=e[2];return t[0]=r*i[0]+n*i[3]+s*i[6],t[1]=r*i[1]+n*i[4]+s*i[7],t[2]=r*i[2]+n*i[5]+s*i[8],t}function Do(t,e,i){const r=i[0],n=i[1],s=i[2],o=i[3],a=e[0],u=e[1],d=e[2],p=n*d-s*u,h=s*a-r*d,m=r*u-n*a,y=n*m-s*h,g=s*p-r*m,v=r*h-n*p,_=2*o;return t[0]=a+p*_+2*y,t[1]=u+h*_+2*g,t[2]=d+m*_+2*v,t}function qRe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[0],s[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),s[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function WRe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),s[1]=n[1],s[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function ZRe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),s[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),s[2]=n[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function JRe(t,e){ls(F9,t),ls(N9,e);const i=tt(F9,N9);return i>1?0:i<-1?Math.PI:Math.acos(i)}const F9=W(),N9=W();function YRe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ft(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Sne(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],s=e[0],o=e[1],a=e[2],u=qi();return Math.abs(i-s)<=u*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-o)<=u*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=u*Math.max(1,Math.abs(n),Math.abs(a))}function $ne(t,e,i){const r=i[0]-e[0],n=i[1]-e[1],s=i[2]-e[2];let o=r*r+n*n+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const is=hi,KRe=X4,XRe=gne,QRe=fg,kN=yp,Ene=Si,g$=Wy;Object.freeze(Object.defineProperty({__proto__:null,abs:Bb,add:di,angle:JRe,bezier:BRe,ceil:FRe,clamp:DRe,copy:Yt,cross:As,crossAndNormalize:GRe,direction:$ne,dist:QRe,distance:fg,div:XRe,divide:gne,dot:tt,equals:Sne,exactEquals:Ft,floor:NRe,hermite:zRe,inverse:jRe,len:Ene,length:Si,lerp:Uk,max:_ne,min:bne,mul:KRe,multiply:X4,negate:URe,normalize:ls,random:HRe,rotateX:qRe,rotateY:WRe,rotateZ:ZRe,round:VRe,scale:jt,scaleAndAdd:ni,set:vt,sign:vne,sqrDist:kN,sqrLen:g$,squaredDistance:yp,squaredLength:Wy,str:YRe,sub:is,subtract:hi,transformMat3:wne,transformMat4:Wa,transformQuat:Do},Symbol.toStringTag,{value:"Module"}));function hl(t){let e=t*t;return t<0&&(e*=-1),e}function ePe(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function tPe(t,e,i){const r=i,n=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(r.translation[0]=hl(n.axes[0]),r.translation[1]=hl(n.axes[1]),r.translation[2]=hl(n.buttons[7])-hl(n.buttons[6]),r.heading=hl(n.axes[2]),r.tilt=hl(n.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*hl(n.axes[0]),r.translation[1]=1.2*hl(n.axes[1]),r.translation[2]=2*-hl(n.axes[2]),r.heading=1.2*hl(n.axes[5]),r.tilt=1.2*hl(n.axes[3])),r.tilt*=o,jt(r.translation,r.translation,a),r}function iPe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let rPe=class extends Kr{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new e_,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([N(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=yb({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},be)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,ePe(this._transformation)):(this._currentDevice=e.data.device,tPe(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const i=this._transformation;if(iPe(i))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=sPe*n*e;Dk(r,r,[i.translation[0]*s,-i.translation[1]*s]);const o=1+i.translation[2]*oPe*e,a=this._view.constraints.rotationEnabled?-i.heading*nPe*e:0,u=this._view.size,d=[u[0]/2,u[1]];Hre(r,r,o,a,d,u);const p=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=p}};const nPe=.06,sPe=.7,oPe=6e-4;function Tne(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),ye(()=>document.removeEventListener("visibilitychange",e))}let aPe=class extends Kr{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=n=>{const s=this._keyMap[n.data.key];if(n.modifiers.has("Meta")||n.modifiers.has("Control"))return void this._stopMovement();if(s==null)return;n.stopPropagation(),n.preventDefault();const o=n.type==="key-down";if(this._pressedKeys[o?"add":"delete"](s),o){if(this._direction===s)return;this._direction=s,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,u=this._pressedKeys.size>0;a||u?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=Tne(n=>n?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const i=this._currentDirection!=null;if(e!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},lPe=class extends Kr{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=Tne(n=>n?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(e.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var x0;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(x0||(x0={}));let uPe=class extends Kr{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),i.zoomIn.forEach(n=>this._keysToZoomAction[n]=x0.IN),i.zoomOut.forEach(n=>this._keysToZoomAction[n]=x0.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let o=null;switch(n){case x0.IN:o=s.zoomIn();break;case x0.OUT:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const cPe=.6;let dPe=class extends Kr{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:n,deltaY:s}=e.data,o=1/cPe**(1/60*s),a=i.zoom(o,[r,n]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},pPe=class extends Kr{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new Vk({start:(r,n)=>{i.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{i.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{i.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function D9(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>fPe(i,t.axisThreshold))}:{buttons:[],axes:[]}}function hPe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function mPe(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function fPe(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let yPe=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,u=this._inputDevices[a];u&&(this._emitGamepadEvent(o,D9(u),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(u),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(V9(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new V4(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=yb({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;V9(n=>{const s=this._inputDevices[n.index];if(!s)return;const o=this._latestUpdate[n.index],a=D9(s),u=r||mPe(a);o&&(o.timestamp===n.timestamp||!o.active&&u||hPe(o.state,a))||this._emitGamepadEvent(n,a,!u)})}_emitGamepadEvent(e,i,r){const n=this._latestUpdate[e.index],s=n&&n.active;if(!s&&!r)return;const o=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:o})}};function gPe(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function V9(t){for(const e of navigator.getGamepads())gPe(e)&&t(e)}const U9=G("edge"),vPe=G("chrome"),bPe=G("ff"),_Pe=G("safari"),j9="esri-view-surface",xg={touchNone:`${j9}--touch-none`,touchPan:`${j9}--touch-pan`};let Ine=class xne{constructor(e,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new yPe(e,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=xe(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const r=this._active[i];this._element.removeEventListener(OA[i],r),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&OA[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(OA[i],r),this._active[i]=r}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,i){i?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?xg.touchNone:xg.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?xg.touchPan:xg.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(xg.touchNone),this._element.classList.remove(xg.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const r=are(this._element,e);return xne.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(e,i){const{key:r}=i;r&&e==="key-up"&&this._keyDownState.delete(r);const n={native:i,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,r)}_handleMouseWheel(e,i){let r=i.shiftKey&&G("mac")?i.deltaX:i.deltaY;switch(i.deltaMode){case 0:U9&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}U9?r*=.7:vPe||_Pe?r*=.6:bPe&&(r*=1.375);const n=100,s=Math.abs(r);s>n&&(r=r/s*200/(1+Math.exp(-.02*(s-n))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(e,o)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const r={native:i};i.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Ine.test={disableSubpixelCoordinates:!1};const OA={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let wPe=class extends Kr{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const Mn={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function A2(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function SPe(t,e){const i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)}function $Pe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Mi()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[E,T]=t,[M,x]=[T.x-E.x,T.y-E.y];return e.radius=Math.sqrt(M*M+x*x)/2,e.center.x=(E.x+T.x)/2,e.center.y=(E.y+T.y)/2,e}let i=0,r=0;for(let E=0;E<t.length;E++)i+=t[E].x,r+=t[E].y;i/=t.length,r/=t.length;const n=t.map(E=>E.x-i),s=t.map(E=>E.y-r);let o=0,a=0,u=0,d=0,p=0,h=0,m=0;for(let E=0;E<n.length;E++){const T=n[E],M=s[E],x=T*T,C=M*M;o+=x,a+=C,u+=T*M,d+=x*T,p+=C*M,h+=T*C,m+=M*x}const y=.5*(d+h),g=.5*(p+m),v=o*a-u*u,_=(y*a-g*u)/v,w=(o*g-u*y)/v,S=Mi(_+i,w+r);return{radius:Math.sqrt(_*_+w*w+(o+a)/t.length),center:S}}function Iy(t){const{native:e}=t,{pointerId:i,button:r,pointerType:n}=e;return n==="mouse"?`${i}:${r}`:`${n}`}let EPe=class extends Kr{constructor(e=Mn.maximumDoubleClickDelay,i=Mn.maximumDoubleClickDistance,r=Mn.maximumDoubleTouchDelay,n=Mn.maximumDoubleTouchDistance,s=t_){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Mi(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Vk({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Kt(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=Kt(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=i,{center:s}=r;this._dragStartCenter=s;const o=RA("begin",Mi(0,0),r);this._doubleTapDrag.emit(o,void 0,n),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,s=RA("update",Mi(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(s,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,s=RA("end",Mi(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(s,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,r=Iy(i),n=this._pointerState.get(r),{pointerType:s}=i.native;if(n){const o=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),A2(n.event.data,i)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:r}=i.native,n=Iy(i),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(n),s);this._pointerState.set(n,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function RA(t,e,i){const{button:r,buttons:n,pointer:s,pointers:o,pointerType:a,timestamp:u}=i;return{action:t,delta:e,button:r,buttons:n,pointer:s,pointers:o,pointerType:a,timestamp:u}}let TPe=class extends Kr{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,r,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:n,pointers:IPe(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const i=e.native.pointerId,r=WT(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,n);const s=iM(n,Mne(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,r=this._activePointerMap.get(i);r?r.event=e:this._addPointer(e)}_removePointer(e){const i=WT(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=WT(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=iM(r,i)-e,r.lastAngle=iM(r,i)-e})}_emitEvent(e,i,r){const n=WT(this._activePointerMap);this._drag.emit(this._createPayload(e,i,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const i=e.data,r=i.currentEvent,n=e.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Mne(t){const e=[];return t.forEach(i=>{e.push(Mi(i.event.x,i.event.y))}),$Pe(e)}function WT(t){const e=Mne(t);let i=0;return t.forEach(r=>{let n=iM(r,e),s=n-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=r.lastAngle+s,r.lastAngle=n;const o=n-r.initialAngle;i+=o}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function IPe(t){const e=new Map;return t.forEach((i,r)=>e.set(r,i.event)),e}function iM(t,e){const i=t.event,r=i.x-e.center.x,n=i.y-e.center.y;return Math.atan2(n,r)}var G9;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(G9||(G9={}));let xPe=class extends Kr{constructor(e=Mn.maximumDoubleClickDelay,i=Mn.maximumDoubleClickDistance,r=Mn.maximumDoubleTouchDelay,n=Mn.maximumDoubleTouchDistance,s=t_){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=Iy(i);if(!this._pointerState.has(r)){const n={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,r=Iy(i),n=this._pointerState.get(r);if(n&&n.downButton===i.native.button){const s=n.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),A2(s,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(i))):A2(n,e.data)>o?this._removeState(i):this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,i){const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const i=Iy(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},MPe=class extends Kr{constructor(e=Mn.maximumClickDelay,i=Mn.movementUntilMouseDrag,r=Mn.movementUntilPenDrag,n=Mn.movementUntilTouchDrag,s=Mn.holdDelay,o=t_){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",a=>this._handlePointerLoss(a,"pointer-up")),this.registerIncoming("pointer-capture-lost",a=>this._handlePointerLoss(a,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",a=>this._handlePointerLoss(a,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",a=>this._handlePointerMove(a)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Kt(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=i.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const s={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const i=e.data,r=i.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(ZT("update",n,i),void 0,n.modifiers):SPe(i,n.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),n.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,r=i.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(ZT("start",n,i)):this._pointerDrag.emit(ZT("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const r=e.data,n=r.native.pointerId,s=this._pointerState.get(n);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(ZT("end",s,i==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):i==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function ZT(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let CPe=class extends Kr{constructor(e=Mn.maximumDoubleClickDelay,i=Mn.maximumDoubleClickDistance,r=Mn.maximumDoubleTouchDelay,n=Mn.maximumDoubleTouchDistance,s=t_){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",o=>this._handleImmediateClick(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Kt(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,i){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Kt(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const i=e.data,{pointerType:r}=i.native,n=kPe(i);if(!this._pointerState.has(n))return void this._startClick(e);const s=this._pointerState.get(n),{data:o,modifiers:a}=s.event,u=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;A2(o,i)>u?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const i=Iy(e.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:r}}=i,n=Iy(i),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),s);this._pointerState.set(n,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function kPe(t){const{pointerId:e,pointerType:i,button:r}=t.native;return i==="mouse"?`${e}:${r}`:`${i}`}const JT={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Nf=class extends q{initialize(){const e=()=>{var i;return(i=this.view)==null?void 0:i.ready};this.addHandles([Hi(()=>!e(),()=>this._disconnect()),Hi(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}isModifierKeyDown(e){var i;return((i=this._inputManager)==null?void 0:i.isModifierKeyDown(e))??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=xe(this._inputManager)}_connect(){const e=this.view.surface,i=new Ine(e,this.view.input),r=[new xPe,new MPe,new CPe,new TPe(this.view.navigation),new EPe],n=new ga({eventSource:i,recognizers:r});n.installHandlers("prevent-context-menu",[new wPe],yt.INTERNAL),n.installHandlers("navigation",[new pPe(this.view),new rPe(this.view),new dPe(this.view),new P9(this.view),new P9(this.view,[JT.counter]),new RRe(this.view,"primary"),new aPe(this.view,JT.pan),new uPe(this.view,JT.zoom),new lPe(this.view,JT.rotate),new PRe(this.view,"secondary"),new ORe(this.view,"touch")],yt.INTERNAL),this.view.viewEvents.connect(n),this._source=i,this._inputManager=n,N(()=>{var s,o;return(o=(s=this.view)==null?void 0:s.navigation)==null?void 0:o.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},be)}get test(){}};l([c()],Nf.prototype,"view",void 0),l([c()],Nf.prototype,"latestPointerType",null),l([c()],Nf.prototype,"latestPointerLocation",null),l([c()],Nf.prototype,"multiTouchActive",null),Nf=l([$("esri.views.2d.input.MapViewInputManager")],Nf);const LPe=Nf;function APe(t,e,i,r,n){Cne(t,e,i||0,r||t.length-1,n||OPe)}function Cne(t,e,i,r,n){for(;r>i;){if(r-i>600){var s=r-i+1,o=e-i+1,a=Math.log(s),u=.5*Math.exp(2*a/3),d=.5*Math.sqrt(a*u*(s-u)/s)*(o-s/2<0?-1:1);Cne(t,e,Math.max(i,Math.floor(e-o*u/s+d)),Math.min(r,Math.floor(e+(s-o)*u/s+d)),n)}var p=t[e],h=i,m=r;for(iw(t,i,e),n(t[r],p)>0&&iw(t,i,r);h<m;){for(iw(t,h,m),h++,m--;n(t[h],p)<0;)h++;for(;n(t[m],p)>0;)m--}n(t[i],p)===0?iw(t,i,m):iw(t,++m,r),m<=e&&(i=m+1),e<=m&&(r=m-1)}}function iw(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function OPe(t,e){return t<e?-1:t>e?1:0}function O2(t,e){if(!(this instanceof O2))return new O2(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function RPe(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function Mg(t,e){N1(t,0,t.children.length,e,t)}function N1(t,e,i,r,n){n||(n=Kv(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s,o=e;o<i;o++)s=t.children[o],D1(n,t.leaf?r(s):s);return n}function D1(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function z9(t,e){return t.minX-e.minX}function B9(t,e){return t.minY-e.minY}function PA(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function YT(t){return t.maxX-t.minX+(t.maxY-t.minY)}function PPe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function FPe(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,s-r)}function FA(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function KT(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Kv(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function H9(t,e,i,r,n){for(var s,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,APe(t,s,e,i,n),o.push(e,s,s,i))}O2.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!KT(t,e))return i;for(var n,s,o,a,u=[];e;){for(n=0,s=e.children.length;n<s;n++)o=e.children[n],KT(t,a=e.leaf?r(o):o)&&(e.leaf?i.push(o):FA(t,a)?this._all(o,i):u.push(o));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!KT(t,e))return!1;for(var r,n,s,o,a=[];e;){for(r=0,n=e.children.length;r<n;r++)if(s=e.children[r],KT(t,o=e.leaf?i(s):s)){if(e.leaf||FA(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Kv([]),this},remove:function(t,e){if(t==null)return this;for(var i,r,n,s,o=this.data,a=this.toBBox(t),u=[],d=[];o||u.length;){if(o||(o=u.pop(),r=u[u.length-1],i=d.pop(),s=!0),o.leaf&&(n=RPe(t,o.children,e))!==-1)return o.children.splice(n,1),u.push(o),this._condense(u),this;s||o.leaf||!FA(o,a)?r?(i++,o=r.children[i],s=!1):o=null:(u.push(o),d.push(i),i=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:z9,compareMinY:B9,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var n,s=i-e+1,o=this._maxEntries;if(s<=o)return Mg(n=Kv(t.slice(e,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(n=Kv([])).leaf=!1,n.height=r;var a,u,d,p,h=Math.ceil(s/o),m=h*Math.ceil(Math.sqrt(o));for(H9(t,e,i,m,this.compareMinX),a=e;a<=i;a+=m)for(H9(t,a,d=Math.min(a+m-1,i),h,this.compareMinY),u=a;u<=d;u+=h)p=Math.min(u+h-1,d),n.children.push(this._build(t,u,p,r-1));return Mg(n,this.toBBox),n},_chooseSubtree:function(t,e,i,r){for(var n,s,o,a,u,d,p,h;r.push(e),!e.leaf&&r.length-1!==i;){for(p=h=1/0,n=0,s=e.children.length;n<s;n++)u=PA(o=e.children[n]),(d=PPe(t,o)-u)<h?(h=d,p=u<p?u:p,a=o):d===h&&u<p&&(p=u,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),s=[],o=this._chooseSubtree(n,this.data,e,s);for(o.children.push(t),D1(o,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)},_split:function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var s=this._chooseSplitIndex(i,n,r),o=Kv(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,Mg(i,this.toBBox),Mg(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=Kv([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Mg(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,n,s,o,a,u,d,p;for(u=d=1/0,r=e;r<=i-e;r++)o=FPe(n=N1(t,0,r,this.toBBox),s=N1(t,r,i,this.toBBox)),a=PA(n)+PA(s),o<u?(u=o,p=r,d=a<d?a:d):o===u&&a<d&&(d=a,p=r);return p},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:z9,n=t.leaf?this.compareMinY:B9;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var n,s,o=this.toBBox,a=N1(t,0,e,o),u=N1(t,i-e,i,o),d=YT(a)+YT(u);for(n=e;n<i-e;n++)s=t.children[n],D1(a,t.leaf?o(s):s),d+=YT(a);for(n=i-e-1;n>=e;n--)s=t.children[n],D1(u,t.leaf?o(s):s),d+=YT(u);return d},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)D1(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():Mg(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};let q9=class kne{constructor(e,i){this.key=new _m(0,0,0,0),this.bounds=Cn(),this.objectIds=new Set,this.key.set(i);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return at.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return{$view:{scale:this.scale,timeZone:e}}}createChildTiles(){const e=this.key.getChildKeys(),i=Is.acquire();for(let r=0;r<e.length;r++)i[r]=new kne(this.tileInfoView,e[r]);return i}getQuantizationParameters(){return nie.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Gm={added:[],removed:[]},NA=new Set,NPe=new _m(0,0,0,0);function DPe(t,e){const i=Ln(e);if(!i)return null;const[r,n]=i.valid;return t[2]>n?[Cn([t[0],t[1],n,t[3]]),Cn([r,t[1],r+t[2]-n,t[3]])]:t[0]<r?[Cn([r,t[1],t[2],t[3]]),Cn([n-(r-t[0]),t[1],n,t[3]])]:null}let VPe=class extends ji{constructor(e){super(),this._tiles=new Map,this._index=O2(9,G("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||oK(e)===0||aK(e)===0)return[];const i=DPe(e,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const n=new q9(this.tileScheme,r);this._tiles.set(r,n),this._index.insert(n),i.added.push(n)}for(const r of e.removed)if(this.has(r)){const n=this.get(r);this._tiles.delete(r),this._index.remove(n),i.removed.push(n)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:r,lodInfo:n}=i,{level:s}=n;if(r.length>0)for(const{row:o,colFrom:a,colTo:u}of r)for(let d=a;d<=u;d++){const p=NPe.set(s,o,n.normalizeCol(d),n.getWorldForColumn(d)).id;if(NA.add(p),!this.has(p)){const h=new q9(this.tileScheme,p);this._tiles.set(p,h),this._index.insert(h),this.tiles.push(h),Gm.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];NA.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Gm.removed.push(a))}(Gm.added.length||Gm.removed.length)&&this.emit("update",Gm),y$.pool.release(i),NA.clear(),Gm.added.length=0,Gm.removed.length=0}};const vit=1e-30,W9=512,XT=16777216,bit=8,_it=29,wit=24,Sit=4,$it=0,Eit=0,Tit=0,Iit=1,xit=2,Mit=3,Cit=4,kit=5,Lit=6,Ait=12,Oit=13,Rit=5,UPe=6,Pit=5,Fit=6;var Z9;(function(t){t[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin"})(Z9||(Z9={}));const Lne=6,jPe=1<<Lne,Nit=jPe<<1,Dit=1.05,Vit=3,Uit=1,jit=3,Git=3,zit=5,Bit=6,Hit=1.15,GPe=2,qit=128,zPe=256,Wit=zPe-2*GPe,Zit=2,Jit=128,Yit=10,Kit=1024,Xit=128,Qit=4,ert=1,trt=1<<20,irt=.75,rrt=10,nrt=.75,srt=256,ort=32,art=512,lrt=0,urt=1,BPe=1,crt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],drt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],rw=256,HPe=new ee("cyan"),qPe=1,WPe=.25;new ee("black");const prt=.25,ZPe="default",JPe="temporary",YPe=new ee("yellow"),hrt=8;let Df=class extends q{constructor(e){super(e),this.color=HPe.clone(),this.haloOpacity=qPe,this.fillOpacity=WPe}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};l([c({type:ee})],Df.prototype,"color",void 0),l([c({type:ee})],Df.prototype,"haloColor",void 0),l([c()],Df.prototype,"haloOpacity",void 0),l([c()],Df.prototype,"fillOpacity",void 0),Df=l([$("esri.views.support.HighlightOptions")],Df);const KPe=Df;var LN;let V1=LN=class extends KPe{constructor(t){super(t),this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return super.equals(t)&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur}get optionsKey(){return`${this.color};${this.haloColor};${this.haloOpacity};${this.fillOpacity};${this.haloWidth};${this.haloBlur}`}clone(){var t;return new LN({color:this.color.clone(),haloColor:(t=this.haloColor)==null?void 0:t.clone(),haloOpacity:this.haloOpacity,fillOpacity:this.fillOpacity,haloWidth:this.haloWidth,haloBlur:this.haloBlur})}};l([c()],V1.prototype,"haloWidth",void 0),l([c()],V1.prototype,"haloBlur",void 0),V1=LN=l([$("esri.views.2d.support.HighlightOptions")],V1);const Zy=V1;var J9,Y9,K9,X9,AN,Q9,eH,ac,ON,IS,qr,R2,tu,bi,pe,v$,Dd,tH,iH,rH;(function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"})(J9||(J9={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Y9||(Y9={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(K9||(K9={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(X9||(X9={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(AN||(AN={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(Q9||(Q9={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(eH||(eH={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"}(ac||(ac={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(ON||(ON={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(IS||(IS={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(qr||(qr={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(R2||(R2={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(tu||(tu={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(bi||(bi={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(pe||(pe={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(v$||(v$={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(Dd||(Dd={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(tH||(tH={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(iH||(iH={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(rH||(rH={}));const frt=33984;var P2,nH,sH;(function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.TransformFeedback=7]="TransformFeedback",t[t.Sync=8]="Sync",t[t.UNCOUNTED=9]="UNCOUNTED",t[t.LinesOfCode=9]="LinesOfCode",t[t.Uniform=10]="Uniform",t[t.COUNT=11]="COUNT"})(P2||(P2={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(nH||(nH={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(sH||(sH={}));const yrt=33306;var xn,oH,aH,lH,uH,cH,dH;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(xn||(xn={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(oH||(oH={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}(aH||(aH={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(lH||(lH={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(uH||(uH={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(cH||(cH={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(dH||(dH={}));const XPe=()=>U.getLogger("esri.views.webgl.checkWebGLError");function QPe(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const Ane=!!G("enable-feature:webgl-debug");function One(){return Ane}function grt(){return Ane}function Cg(t){if(One()){const e=t.getError();if(e){const i=QPe(t,e),r=new Error().stack;XPe().error(new L("webgl-error","WebGL error occurred",{message:i,stack:r}))}}}var RN;(function(t){t[t.Texture=0]="Texture",t[t.RenderBuffer=1]="RenderBuffer"})(RN||(RN={}));function e3e(t){switch(t){case ac.BYTE:case ac.UNSIGNED_BYTE:return 1;case ac.SHORT:case ac.UNSIGNED_SHORT:case ac.HALF_FLOAT:return 2;case ac.FLOAT:case ac.INT:case ac.UNSIGNED_INT:return 4}}function t3e(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function vrt(t,e,i,r,n=0){var o;const s=t.gl;t.bindBuffer(i);for(const a of r){const u=e.get(a.name);if(u==null){console.warn(`There is no location for vertex attribute '${a.name}' defined.`);continue}const d=n*a.stride;if(a.count<=4)s.vertexAttribPointer(u,a.count,a.type,a.normalized,a.stride,a.offset+d),s.enableVertexAttribArray(u),a.divisor>0&&t.gl.vertexAttribDivisor(u,a.divisor);else if(a.count===9)for(let p=0;p<3;p++)s.vertexAttribPointer(u+p,3,a.type,a.normalized,a.stride,a.offset+12*p+d),s.enableVertexAttribArray(u+p),a.divisor>0&&t.gl.vertexAttribDivisor(u+p,a.divisor);else if(a.count===16)for(let p=0;p<4;p++)s.vertexAttribPointer(u+p,4,a.type,a.normalized,a.stride,a.offset+16*p+d),s.enableVertexAttribArray(u+p),a.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(u+p,a.divisor));else console.error("Unsupported vertex attribute element count: "+a.count);if(One()){const p=t3e(t),h=e3e(a.type),m=a.offset,y=Math.round(h/m)!==h/m?`. Offset not a multiple of stride. DataType requires ${h} bytes, but descriptor has an offset of ${m}`:"";p&&console.error(`Unable to bind vertex attribute "${a.name}" with baseInstanceOffset ${d}${y}:`,p,a)}}}function brt(t,e,i,r){var s,o,a;const n=t.gl;t.bindBuffer(i);for(const u of r){const d=e.get(u.name);if(u.count<=4)n.disableVertexAttribArray(d),u.divisor&&u.divisor>0&&((s=t.gl)==null||s.vertexAttribDivisor(d,0));else if(u.count===9)for(let p=0;p<3;p++)n.disableVertexAttribArray(d+p),u.divisor&&u.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(d+p,0));else if(u.count===16)for(let p=0;p<4;p++)n.disableVertexAttribArray(d+p),u.divisor&&u.divisor>0&&((a=t.gl)==null||a.vertexAttribDivisor(d+p,0));else console.error("Unsupported vertex attribute element count: "+u.count)}t.unbindBuffer(AN.ARRAY_BUFFER)}function i3e(t){switch(t){case bi.ALPHA:case bi.LUMINANCE:case bi.RED:case bi.RED_INTEGER:case pe.R8:case pe.R8I:case pe.R8UI:case pe.R8_SNORM:case Dd.STENCIL_INDEX8:return 1;case bi.LUMINANCE_ALPHA:case bi.RG:case bi.RG_INTEGER:case pe.RGBA4:case pe.R16F:case pe.R16I:case pe.R16UI:case pe.RG8:case pe.RG8I:case pe.RG8UI:case pe.RG8_SNORM:case pe.RGB565:case pe.RGB5_A1:case Dd.DEPTH_COMPONENT16:return 2;case bi.DEPTH_COMPONENT:case bi.RGB:case bi.RGB_INTEGER:case pe.RGB8:case pe.RGB8I:case pe.RGB8UI:case pe.RGB8_SNORM:case pe.SRGB8:case Dd.DEPTH_COMPONENT24:return 3;case bi.DEPTH_STENCIL:case bi.DEPTH24_STENCIL8:case bi.RGBA:case bi.RGBA_INTEGER:case pe.RGBA8:case pe.R32F:case pe.R11F_G11F_B10F:case pe.RG16F:case pe.R32I:case pe.R32UI:case pe.RG16I:case pe.RG16UI:case pe.RGBA8I:case pe.RGBA8UI:case pe.RGBA8_SNORM:case pe.SRGB8_ALPHA8:case pe.RGB9_E5:case pe.RGB10_A2UI:case pe.RGB10_A2:case Dd.DEPTH_STENCIL:case Dd.DEPTH_COMPONENT32F:case Dd.DEPTH24_STENCIL8:return 4;case Dd.DEPTH32F_STENCIL8:return 5;case pe.RGB16F:case pe.RGB16I:case pe.RGB16UI:return 6;case pe.RG32F:case pe.RG32I:case pe.RG32UI:case pe.RGBA16F:case pe.RGBA16I:case pe.RGBA16UI:return 8;case pe.RGB32F:case pe.RGB32I:case pe.RGB32UI:return 12;case pe.RGBA32F:case pe.RGBA32I:case pe.RGBA32UI:return 16;case xn.COMPRESSED_RGB_S3TC_DXT1_EXT:case xn.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case xn.COMPRESSED_RGBA_S3TC_DXT3_EXT:case xn.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case xn.COMPRESSED_R11_EAC:case xn.COMPRESSED_SIGNED_R11_EAC:case xn.COMPRESSED_RGB8_ETC2:case xn.COMPRESSED_SRGB8_ETC2:case xn.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case xn.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case xn.COMPRESSED_RG11_EAC:case xn.COMPRESSED_SIGNED_RG11_EAC:case xn.COMPRESSED_RGBA8_ETC2_EAC:case xn.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let Rne=class{constructor(e=0,i=e){this.width=e,this.height=i,this.target=tu.TEXTURE_2D,this.pixelFormat=bi.RGBA,this.dataType=v$.UNSIGNED_BYTE,this.samplingMode=qr.LINEAR,this.wrapMode=R2.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}};function r3e(t){return t.width<=0||t.height<=0?0:Math.round(t.width*t.height*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:i3e(t.internalFormat)))}let n3e=class Pne extends Rne{constructor(e,i){switch(super(),this.context=e,Object.assign(this,i),this.internalFormat){case pe.R16F:case pe.R16I:case pe.R16UI:case pe.R32F:case pe.R32I:case pe.R32UI:case pe.R8_SNORM:case pe.R8:case pe.R8I:case pe.R8UI:this.pixelFormat=bi.RED}}static validate(e,i){return new Pne(e,i)}},Fne=class ba{constructor(e,i=null,r=null){if(this.type=RN.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,r=i;else{const n=n3e.validate(e,i);if(!n)throw new L("Texture descriptor invalid");this._descriptor=n}this._descriptor.target===tu.TEXTURE_CUBE_MAP?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return r3e(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(P2.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,i){const r=this._descriptor;if(r.width!==e||r.height!==i){if(this._wasImmutablyAllocated)throw new L("Immutable textures can't be resized!");r.width=e,r.height=i,this._descriptor.target===tu.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(e=null){for(let i=tu.TEXTURE_CUBE_MAP_POSITIVE_X;i<=tu.TEXTURE_CUBE_MAP_NEGATIVE_Z;i++)this._setData(e,i)}setData(e){this._setData(e)}_setData(e,i){var d;const r=(d=this._descriptor.context)==null?void 0:d.gl;if(!r)return;Cg(r),this._glName||(this._glName=r.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(P2.Texture,this));const n=this._descriptor,s=i??n.target,o=nw(s),a=this._descriptor.context.bindTexture(this,ba.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ba.TEXTURE_UNIT_FOR_UPDATES),QT(n),this._configurePixelStorage(),Cg(r);const u=this._deriveInternalFormat();if(mH(e)){let p="width"in e?e.width:e.codedWidth,h="height"in e?e.height:e.codedHeight;const m=1;e instanceof HTMLVideoElement&&(p=e.videoWidth,h=e.videoHeight),n.width&&n.height,o&&n.depth,n.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(s,u,n.hasMipmap,p,h,m),this._texImage(s,0,u,p,h,m,e),Cg(r),n.hasMipmap&&(this.generateMipmap(),Cg(r)),n.width||(n.width=p),n.height||(n.height=h),o&&!n.depth&&(n.depth=m)}else{const{width:p,height:h,depth:m}=n;if(p==null||h==null)throw new L("Width and height must be specified!");if(o&&m==null)throw new L("Depth must be specified!");if(n.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(s,u,n.hasMipmap,p,h,m),rM(e)){const y=e.levels,g=fH(s,p,h,m),v=Math.min(g-1,y.length-1);r.texParameteri(n.target,this._descriptor.context.gl.TEXTURE_MAX_LEVEL,v);const _=u;if(!a3e(_))throw new L("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel((w,S,E,T)=>{const M=y[Math.min(w,y.length-1)];this._compressedTexImage(s,w,_,S,E,T,M)},v)}else this._texImage(s,0,u,p,h,m,e),Cg(r),n.hasMipmap&&this.generateMipmap()}pH(r,this._descriptor),hH(r,this._descriptor),s3e(this._descriptor.context,this._descriptor),Cg(r),this._descriptor.context.bindTexture(a,ba.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,i,r,n,s,o,a=0){o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const u=this._descriptor,d=this._deriveInternalFormat(),{context:p,pixelFormat:h,dataType:m,target:y,isImmutable:g}=u;if(g&&!this._wasImmutablyAllocated)throw new L("Cannot update immutable texture before allocation!");const v=p.bindTexture(this,ba.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||r<0||i+n>u.width||r+s>u.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=p;a&&_.pixelStorei(_.UNPACK_SKIP_ROWS,a),mH(o)?_.texSubImage2D(y,e,i,r,n,s,h,m,o):rM(o)?_.compressedTexSubImage2D(y,e,i,r,n,s,d,o.levels[e]):_.texSubImage2D(y,e,i,r,n,s,h,m,o),a&&_.pixelStorei(_.UNPACK_SKIP_ROWS,0),p.bindTexture(v,ba.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,i,r,n,s,o,a,u){u||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const d=this._descriptor,p=this._deriveInternalFormat(),{context:h,pixelFormat:m,dataType:y,isImmutable:g,target:v}=d;if(g&&!this._wasImmutablyAllocated)throw new L("Cannot update immutable texture before allocation!");nw(v)||console.warn("Attempting to set 3D texture data on a non-3D texture");const _=h.bindTexture(this,ba.TEXTURE_UNIT_FOR_UPDATES);h.setActiveTexture(ba.TEXTURE_UNIT_FOR_UPDATES),(i<0||r<0||n<0||i+s>d.width||r+o>d.height||n+a>d.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:w}=h;if(rM(u))u=u.levels[e],w.compressedTexSubImage3D(v,e,i,r,n,s,o,a,p,u);else{const S=u;w.texSubImage3D(v,e,i,r,n,s,o,a,m,y,S)}h.bindTexture(_,ba.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new L("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,QT(e)}e.samplingMode===qr.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=qr.LINEAR_MIPMAP_NEAREST):e.samplingMode===qr.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=qr.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,ba.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ba.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(i,ba.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new L("Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,QT(e)}e.samplingMode===qr.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=qr.LINEAR):e.samplingMode===qr.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=qr.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,QT(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const e=this._descriptor,i=e.context.gl;this._samplingModeDirty&&(pH(i,e),this._samplingModeDirty=!1),this._wrapModeDirty&&(hH(i,e),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(this._descriptor.internalFormat!=null)return this._descriptor.internalFormat===bi.DEPTH_STENCIL&&(this._descriptor.internalFormat=bi.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case v$.FLOAT:switch(this._descriptor.pixelFormat){case bi.RGBA:return this._descriptor.internalFormat=pe.RGBA32F;case bi.RGB:return this._descriptor.internalFormat=pe.RGB32F;default:throw new L("Unable to derive format")}case v$.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case bi.RGBA:return this._descriptor.internalFormat=pe.RGBA8;case bi.RGB:return this._descriptor.internalFormat=pe.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===bi.DEPTH_STENCIL?bi.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:i,flipped:r,preMultiplyAlpha:n}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,i),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n?1:0)}_texStorage(e,i,r,n,s,o){const{gl:a}=this._descriptor.context;if(!o3e(i))throw new L("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const u=r?fH(e,n,s,o):1;if(nw(e)){if(o==null)throw new L("Missing depth dimension for 3D texture upload");a.texStorage3D(e,u,i,n,s,o)}else a.texStorage2D(e,u,i,n,s);this._wasImmutablyAllocated=!0}_texImage(e,i,r,n,s,o,a){const u=this._descriptor.context.gl,d=nw(e),{isImmutable:p,pixelFormat:h,dataType:m}=this._descriptor;if(p){if(a!=null){const y=a;if(d){if(o==null)throw new L("Missing depth dimension for 3D texture upload");u.texSubImage3D(e,i,0,0,0,n,s,o,h,m,y)}else u.texSubImage2D(e,i,0,0,n,s,h,m,y)}}else{const y=a;if(d){if(o==null)throw new L("Missing depth dimension for 3D texture upload");u.texImage3D(e,i,r,n,s,o,0,h,m,y)}else u.texImage2D(e,i,r,n,s,0,h,m,y)}}_compressedTexImage(e,i,r,n,s,o,a){const u=this._descriptor.context.gl,d=nw(e);if(this._descriptor.isImmutable){if(a!=null)if(d){if(o==null)throw new L("Missing depth dimension for 3D texture upload");u.compressedTexSubImage3D(e,i,0,0,0,n,s,o,r,a)}else u.compressedTexSubImage2D(e,i,0,0,n,s,r,a)}else if(d){if(o==null)throw new L("Missing depth dimension for 3D texture upload");u.compressedTexImage3D(e,i,r,n,s,o,0,a)}else u.compressedTexImage2D(e,i,r,n,s,0,a)}_forEachMipmapLevel(e,i=1/0){let{width:r,height:n,depth:s,hasMipmap:o,target:a}=this._descriptor;const u=a===tu.TEXTURE_3D;if(r==null||n==null||u&&s==null)throw new L("Missing texture dimensions for mipmap calculation");for(let d=0;e(d,r,n,s),o&&(r!==1||n!==1||u&&s!==1)&&!(d>=i);++d)r=Math.max(1,r>>1),n=Math.max(1,n>>1),u&&(s=Math.max(1,s>>1))}};function QT(t){(t.width!=null&&t.width<0||t.height!=null&&t.height<0||t.depth!=null&&t.depth<0)&&console.error("Negative dimension parameters are not allowed!")}function pH(t,e){let i=e.samplingMode,r=e.samplingMode;i===qr.LINEAR_MIPMAP_NEAREST||i===qr.LINEAR_MIPMAP_LINEAR?(i=qr.LINEAR,e.hasMipmap||(r=qr.LINEAR)):i!==qr.NEAREST_MIPMAP_NEAREST&&i!==qr.NEAREST_MIPMAP_LINEAR||(i=qr.NEAREST,e.hasMipmap||(r=qr.NEAREST)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,i),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,r)}function hH(t,e){typeof e.wrapMode=="number"?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}function s3e(t,e){const i=t.capabilities.textureFilterAnisotropic;i&&t.gl.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}function o3e(t){return t in pe}function a3e(t){return t in xn}function rM(t){return t!=null&&"type"in t&&t.type==="compressed"}function l3e(t){return t!=null&&"byteLength"in t}function mH(t){return t!=null&&!rM(t)&&!l3e(t)}function nw(t){return t===tu.TEXTURE_3D||t===tu.TEXTURE_2D_ARRAY}function fH(t,e,i,r=1){let n=Math.max(e,i);return t===tu.TEXTURE_3D&&(n=Math.max(n,r)),Math.round(Math.log(n)/Math.LN2)+1}Fne.TEXTURE_UNIT_FOR_UPDATES=0;const DA=()=>U.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function u3e(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const c3e=[0,0,0,0];let Nne=class{constructor(){this.type="single",this._highlightOptions=new Zy,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*rw),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,i){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,UPe),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){var e;(e=this._shadeTex)==null||e.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<Lne)-1,activeGradient:this}]}_updateGradientTexture(e){const{optionsKey:i}=this._highlightOptions;if(i===this._optionsShadeTexKey)return;this._optionsShadeTexKey=i,u3e(this._highlightOptions,this._convertedHighlightOptions);const r=this._convertedHighlightOptions,n=r.outlinePosition-r.outlineWidth/2-r.outerHaloWidth,s=r.outlinePosition-r.outlineWidth/2,o=r.outlinePosition+r.outlineWidth/2,a=r.outlinePosition+r.outlineWidth/2+r.innerHaloWidth,u=Math.sqrt(Math.PI/2)*BPe,d=Math.abs(n)>u?Math.round(10*(Math.abs(n)-u))/10:0,p=Math.abs(a)>u?Math.round(10*(Math.abs(a)-u))/10:0;let h;d&&!p?DA().error("The outer rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!d&&p?DA().error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):d&&p&&DA().error("The highlight is "+Math.max(d,p)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(v,_,w){m[0]=(1-w)*v[0]+w*_[0],m[1]=(1-w)*v[1]+w*_[1],m[2]=(1-w)*v[2]+w*_[2],m[3]=(1-w)*v[3]+w*_[3]}const{_texelData:g}=this;for(let v=0;v<rw;++v)h=n+v/(rw-1)*(a-n),h<n?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):h<s?y(c3e,r.outlineColor,(h-n)/(s-n)):h<o?[m[0],m[1],m[2],m[3]]=r.outlineColor:h<a?y(r.outlineColor,r.fillColor,(h-o)/(a-o)):[m[0],m[1],m[2],m[3]]=r.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=a,!this._shadeTex){const v=new Rne;v.wrapMode=R2.CLAMP_TO_EDGE,v.width=rw,v.height=1,this._shadeTex=new Fne(e,v)}this._shadeTex.updateData(0,0,0,rw,1,this._texelData)}},d3e=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let i=0;i<e.length;i++)this.gradients[i]||(this.gradients[i]=new Nne),this.gradients[i].setHighlightOptions(e[i].options);for(let i=e.length+1;i<this.gradients.length;i++)this.gradients[i].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const i=[];for(let r=0;r<this.gradients.length;r++){const n=this.gradients[r];i.push({activeReasons:e,activeGradient:n}),e<<=1}return i}};var yH,gH,vH,bH,_H,wH,F2,SH,$H;(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"})(yH||(yH={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(gH||(gH={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(vH||(vH={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(bH||(bH={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(_H||(_H={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"}(wH||(wH={})),function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"}(F2||(F2={})),function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(SH||(SH={})),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"}($H||($H={}));const Dne={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:ON.EQUAL,mask:255,op:{fail:IS.KEEP,zFail:IS.KEEP,zPass:IS.REPLACE}}}},p3e={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},h3e={...Dne,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function m3e({pixelRatio:t,state:e,displayLevel:i,requiredLevel:r},n){const s=1/2**(i-n.key.level),o=1/2**(r-n.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:n.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:n.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:o,tileOffset:[n.x,n.y],currentScale:e.scale,currentZoom:i,metersPerSRUnit:Ci(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function Vne(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="highlight"}function Une(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="hittest"}function f3e(t){if(!Une(t))return null;const{position:e,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:n}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:n}}function y3e(t){if(!Vne(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function $rt(t,e,i){const r={};for(const n in i)i[n]instanceof Function?r[n]=i[n](t,e):r[n]=i[n];return r}function Ert(t,e){const{attributeView:i,context:r}=t;return{storage:i.getUniforms(r),view:m3e(t,e),hittestRequest:f3e(t),highlight:y3e(t)}}function Trt(t){return{inside:t.selection===F2.InsideEffect,outside:t.selection===F2.OutsideEffect}}function g3e(t){return Une(t)?p3e:Vne(t)&&t.passOptions.stepType==="clear"?h3e:Dne}function Irt(t){const{row:e,col:i}=t.key,r=i*W9,n=e*W9;return{tileOffsetFromLocalOrigin:[r%XT,n%XT],maxIntsToLocalOrigin:[Math.floor(r/XT),Math.floor(n/XT)]}}const v3e=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function xrt(t){return v3e.toJSON(t)}function Mrt(t){const{bandCount:e,attributeTable:i,colormap:r,pixelType:n}=t.raster.rasterInfo;return e===1&&(i!=null||r!=null||n==="u8"||n==="s8")}function b3e(t,e){return e==null?(t==null||t.destroy(),null):((t==null?void 0:t.type)==="single"&&Array.isArray(e)&&(t.destroy(),t=null),(t==null?void 0:t.type)!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new d3e:new Nne),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function Crt(t,e,i,r){const{painter:n,highlightGradient:s}=t,{highlight:o}=n.effects;if(!s)return;const a=t.passOptions,u=s.getReasonsWithGradients();for(let d=0;d<u.length;d++){const p={...t,passOptions:{type:"highlight",activeGradient:r!=null?u[r].activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(p),i(p),d<u.length-1){let m=0;for(let y=d+1;y<u.length;y++)m|=u[y].activeReasons;i({...t,passOptions:{type:"highlight",activeGradient:r!=null?u[r].activeGradient:u[d].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:r!=null?u[r].activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"draw",highlightAll:e}};n.setPipelineState(g3e(t)),n.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}const eI=t=>parseFloat(t)/100;function _3e(t,e,i){const r=typeof t.left=="string"?eI(t.left)*e:t.left,n=typeof t.right=="string"?eI(t.right)*e:t.right,s=typeof t.top=="string"?eI(t.top)*i:t.top,o=typeof t.bottom=="string"?eI(t.bottom)*i:t.bottom,a=s;return{xmin:r,xmax:Math.max(e-n,r),ymin:a,ymax:Math.max(i-o,s)}}function jne(t,e,i,r){switch(e.type){case"rect":{const{width:n,height:s}=t,{xmin:o,xmax:a,ymin:u,ymax:d}=_3e(e,n,s),{x:p,y:h}=i;return p>o&&p<a&&h>u&&h<d}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||OV(e.path,[i.x,i.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?AV(e.geometry,r):U$(e.geometry,r))}}var PN;let M0=PN=class extends q{constructor(...t){super(...t),this.name="default",this.options=new Zy}clone(){return new PN({name:this.name,options:this.options.clone()})}};l([c({type:String})],M0.prototype,"name",void 0),l([c({type:Zy})],M0.prototype,"options",void 0),M0=PN=l([$("esri.views.2d.support.HighlightGroup")],M0);const Gne=Y.ofType(M0);function zne(){return new Gne([{name:ZPe,options:new Zy},{name:JPe,options:new Zy({color:YPe})}])}zne().items.map(t=>t.name);function w3e(t){if(!t.highlights)return null;const e=t.highlights.findIndex(i=>i.name==="default");return e===-1?null:t.highlights.items[e].options}function S3e(t,e){if(!t.highlights){if(!e)return;t.highlights=new Gne([{name:"default",options:new Zy}])}const i=t.highlights.findIndex(r=>r.name==="default");e?t.highlights.items[i].options=e:t.highlights.removeAt(i)}async function $3e(t,e,i){const r=ure(e)?lre(t,e):e;if(!t.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let n=new Set;const s=new Set;let o=!1,a=null,u=null;i!=null&&i.include?TH(i.include,EH(t,m=>{n.add(m),VA(m,y=>s.add(y))},(m,y)=>{s.add(m),n.add(y)},m=>{a||(a=new Set),a.add(m)},m=>n.add(m),()=>o=!0)):(o=!0,n=new Set(t.allLayerViews),n.forEach(m=>{VA(m,y=>s.add(y))})),i!=null&&i.exclude&&TH(i.exclude,EH(t,m=>{n.delete(m),VA(m,y=>s.delete(y))},m=>s.delete(m),m=>{u||(u=new Set),u.add(m)}));const d=t.toMap(r),p=t.allLayerViews.filter(m=>!m.suspended&&n.has(m)&&m.clips.every(y=>jne(t,y,r,d))).reverse();let h=[...o?t.graphicsView.hitTest(d).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:d})):[],...await Promise.all(p.map(m=>m.hitTest(d,r)).toArray())].filter(ot).flat().filter(ot);return h=h.filter(m=>{var y;return m.type!=="graphic"||((y=m.layer)==null?void 0:y.type)!=="subtype-group"||s.has(m.graphic.layer)}),a&&(h=h.filter(m=>!("graphic"in m)||!m.graphic||(a==null?void 0:a.has(FN(m.graphic))))),u&&(h=h.filter(m=>!("graphic"in m)||!m.graphic||!(u!=null&&u.has(FN(m.graphic))))),{screenPoint:r,results:h}}function EH(t,e,i,r,n,s){return o=>{if(o instanceof Li){if(o.layer===t)s==null||s();else{const a=t.allLayerViews.find(u=>u.layer===o.layer);a&&(n==null||n(a))}r(FN(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(u=>u.layer===o.parent);a&&i(o,a)}else{const a=t.allLayerViews.find(u=>u.layer===o);a&&e(a)}}}function TH(t,e){if(t)if(NS(t))for(const i of t)if(NS(i))for(const r of i)e(r);else e(i);else e(t)}function FN(t){var i,r;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((r=t.sourceLayer)==null?void 0:r.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function VA({layer:t},e){(t==null?void 0:t.type)==="subtype-group"&&t.sublayers.forEach(i=>{e(i)})}let sw=null,N2=!0;function E3e(t,e,i){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(N2)try{return new ImageData(t,e)}catch{N2=!1}return Bne(t,e,i)}function krt(t,e,i,r){if(!e||!i)throw new Error("Cannot construct image data without dimensions");if(N2)try{return new ImageData(t,e,i)}catch{N2=!1}const n=Bne(e,i,r);return n.data.set(t,0),n}function T3e(){return sw||(sw=document.createElement("canvas"),sw.width=1,sw.height=1),sw}function Bne(t,e,i){return i||(i=T3e()),i.getContext("2d").createImageData(t,e)}async function I3e(t,e){const i=window.URL.createObjectURL(t);try{const{data:r}=await Ee(i,{...e,responseType:"image"});return r}catch(r){throw rr(r)?r:new L("invalid-image",`Could not fetch requested image at ${i}`)}finally{window.URL.revokeObjectURL(i)}}async function Lrt(t,e){const{arrayBuffer:i,mediaType:r}=await x3e(t,e),n=r==="image/png";if(r==="image/gif"){const{isAnimatedGIF:s,parseGif:o}=await k(()=>import("./gif-B6MmvnCn.js"),[]);if(s(i))return o(i,e)}if(n){const{isAnimatedPNG:s,parseApng:o}=await k(()=>import("./apng-BPXwicFc.js"),__vite__mapDeps([231,1]));if(s(i))return o(i,e)}return I3e(new Blob([i],{type:r}),e)}async function x3e(t,e){var n;const i=dm(t);if(i!=null&&i.isBase64)return{arrayBuffer:gJ(i.data),mediaType:i.mediaType};const r=await Ee(t,{responseType:"array-buffer",...e});return{arrayBuffer:r.data,mediaType:((n=r.getHeader)==null?void 0:n.call(r,"Content-Type"))??""}}function Hne(t,e,i){const{ctx:r,canvas:n}=Wne(t,i),s=r.getImageData(0,0,t.width,t.height),o=Jne(n,e);return Zne(n),{dataUrl:o,data:s}}function qne(t,e){const{ctx:i,canvas:r}=Wne(t,e),n=i.getImageData(0,0,t.width,t.height);return Zne(r),n}function Wne(t,e){const i=M3e();e.premultipliedAlpha&&A3e(t),i.width=t.width,i.height=t.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&L3e(r),{ctx:r,canvas:i}}function Zne(t){t.width=0,t.height=0}function M3e(){return UA==null&&(UA=document.createElement("canvas")),UA}let UA=null;function Jne(t,e){const i=O3e[e.format],r=e.quality/100;return t.toDataURL(i,r)}function Yne(t,e){const i=k3e(t),r=P3e[i];return{format:i,quality:fr(e??r,0,100)}}function Kne(t,e){return e/Math.max(t[0],t[1])}function C3e(t,e,i,r=0,n=0,s=t.width-r,o=t.height-n,a=!1){const{data:u}=t,{width:d,height:p,data:h}=e,m=s/d,y=o/p,g=Math.ceil(m/2),v=Math.ceil(y/2),_=t.width;for(let w=0;w<p;w++)for(let S=0;S<d;S++){const E=4*(S+(a?p-w-1:w)*d);let T=0,M=0,x=0,C=0,O=0,F=0;const V=(w+.5)*y;for(let z=Math.floor(w*y);z<(w+1)*y;z++){const H=Math.abs(V-(z+.5))/v,Q=(S+.5)*m,J=H*H;for(let ne=Math.floor(S*m);ne<(S+1)*m;ne++){const Pe=Math.abs(Q-(ne+.5))/g,_e=Math.sqrt(J+Pe*Pe);if(_e>=1)continue;let ue=2*_e*_e*_e-3*_e*_e+1;const it=4*(r+ne+(n+z)*_);F+=ue*u[it+3],M+=ue,!i&&u[it+3]<255&&(ue=ue*u[it+3]/255),x+=ue*u[it],C+=ue*u[it+1],O+=ue*u[it+2],T+=ue}}h[E]=x/T,h[E+1]=C/T,h[E+2]=O/T,h[E+3]=F/M}return e}function k3e(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return R3e}}function L3e(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function A3e(t){const e=t.data,i=e.length;for(let r=0;r<i;r+=4){const n=e[r+3];if(n!==255&&n>0){const s=255/n;e[r]=e[r]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const O3e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},IH=98,R3e="png",P3e={png:100,jpg:IH,jpeg:IH},Art=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:E3e,encode:Hne,encodeData:qne,getFormatAndQuality:Yne,getMaximumResolutionScale:Kne,resampleHermite:C3e,toDataUrl:Jne},Symbol.toStringTag,{value:"Module"})),Xne={flipY:!0,premultipliedAlpha:!0};async function F3e(t,e){const i=await Qne(t,e),{format:r,quality:n}=Yne(e==null?void 0:e.format,e==null?void 0:e.quality);return Hne(i,{format:r,quality:n},Xne)}async function N3e(t,e){const i=await Qne(t,e);return qne(i,Xne)}function Qne(t,e){const i=U3e(e||{},V3e(t.stage,t.size),t.size,t.padding),r=D3e(e,t.allLayerViews);return t.stage.takeScreenshot(i,r,t.backgroundColor,e==null?void 0:e.rotation)}function D3e(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(r=>{const n=e.find(s=>s.layer.id===r.id);n!=null&&n.container&&i.push(n.container)}),i}function V3e(t,e){return Math.min(4,Kne(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function U3e(t,e,i,r){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let n=null;t.width!=null&&t.height!=null?n=[t.width,t.height]:t.width==null&&t.height!=null?n=[t.height,t.height]:t.width!=null&&t.height==null?n=[t.width,t.width]:t.width==null&&t.height==null&&(n=null);const s=i[0]-(r.left+r.right),o=i[1]-(r.top+r.bottom);let a,u,d=t.area||{x:0,y:0,width:s,height:o};if(n){const p=s/o,h=n[0]/n[1];if(h>p){const m=d.width/h;d={x:d.x,y:Math.round(d.y+(d.height-m)/2),width:d.width,height:Math.round(m)}}else{const m=d.height*h;d={x:Math.round(d.x+(d.width-m)/2),y:d.y,width:Math.round(m),height:d.height}}}else n=[d.width,d.height];return n[0]>d.width?(a=Math.min(n[0]/d.width,e),u=n[0]/d.width/a):(a=1,u=n[0]/d.width),{cropArea:{x:Math.round((d.x+r.left)*a),y:Math.round((d.y+r.top)*a),width:Math.round(d.width*a),height:Math.round(d.height*a)},outputScale:u,resolutionScale:a}}const xH=160;let U1=class extends q{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=xH&&this.clear()},xH))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};l([c()],U1.prototype,"_timer",void 0),l([c()],U1.prototype,"stationary",null),U1=l([$("esri.views.2d.support.StationaryManager")],U1);const j3e=t=>t.includes("Brush");let ese=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),j3e(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}},jA;function G3e(){return jA||(jA=H3e()),jA}let z3e=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}};function B3e(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let i=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(i==null&&(i=e.getContext("webgl2"),i!=null&&(t.majorPerformanceCaveat=!0)),i==null)return i;t.available=!0,t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return r&&(t.supportsHighPrecisionFragment=r.precision>0),i}function H3e(){const t=new z3e,e=B3e(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function q3e(t){const e=G3e();return e.available?t==="3d"&&e.majorPerformanceCaveat?new L("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new L("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new L("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new L("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function W3e(t){return t&&"nodeType"in t}function Z3e(t){return t&&typeof t.render=="function"}const MH={component:"esri-component"};let Vf=class extends q{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,i;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((i=this.node)==null?void 0:i.id)}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(MH.component),i&&i.classList.remove(MH.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||W3e(e)?(this._set("widget",null),L4(e)):(Z3e(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};l([c()],Vf.prototype,"id",null),l([c()],Vf.prototype,"node",null),l([We("node")],Vf.prototype,"castNode",null),l([c({readOnly:!0})],Vf.prototype,"widget",void 0),Vf=l([$("esri.views.ui.Component")],Vf);const nM=Vf,tse="calcite-mode-";function J3e(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function ise(){return J3e().startsWith("dark")}function rse(){return`${tse}${ise()?"dark":"light"}`}function Y3e(t){K3e(t),t.classList.add(rse())}function K3e(t){Array.from(t.classList).forEach(e=>{e.startsWith(tse)&&t.classList.remove(e)})}const X3e={left:0,top:0,bottom:0,right:0},nse={bottom:30,top:15,right:15,left:15},Gc="esri-ui",Ns={ui:Gc,corner:`${Gc}-corner`,innerContainer:`${Gc}-inner-container`,manualContainer:`${Gc}-manual-container`,cornerContainer:`${Gc}-corner-container`,topLeft:`${Gc}-top-left`,topRight:`${Gc}-top-right`,bottomLeft:`${Gc}-bottom-left`,bottomRight:`${Gc}-bottom-right`};function Q3e(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function tI(t){return t===0?"0":`${t}px`}function GA(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function zA(t,{top:e,bottom:i,left:r,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=r,t.style.right=n}let qu=class extends ji.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=An(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&zA(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&zA(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([N(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,be),N(()=>this.padding,this._applyUIPadding,be),N(()=>[this.container,this._locale],([e,i])=>{e&&e.setAttribute("lang",i)},be),GC(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const i=this._get("container");e!==i&&(e&&(e.classList.add(Ns.ui),Y3e(e),this._attachContainers(e)),i&&(i.classList.remove(Ns.ui),zA(i,{top:"",bottom:"",left:"",right:""}),i.textContent=""),this._set("container",e))}get height(){var s;const e=((s=this.view)==null?void 0:s.height)??0;if(e===0)return e;const i=this._getViewPadding(),{top:r,bottom:n}=i;return Math.max(e-r-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...nse,...e}}get width(){var s;const e=((s=this.view)==null?void 0:s.width)??0;if(e===0)return e;const i=this._getViewPadding(),{left:r,right:n}=i;return Math.max(e-r-n,0)}add(e,i){let r,n,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,i));const o=GA(e);o&&({index:r,position:i,component:e,key:n}=o),i&&typeof i=="object"&&({index:r,key:n,position:i,internal:s}=i),!e||i&&!this._isValidPosition(i)||this._add(e,i,r,n,s)}remove(e,i){var n,s;if(!e)return;if(Array.isArray(e))return e.map(o=>this.remove(o,i));const r=this._find(e);if(r){if(this._componentMap.has(r)&&((n=this._componentMap.get(r))==null?void 0:n.key)!==i)return;const o=this._components.indexOf(r),a=r.node.parentNode;return a==null||a.removeChild(r.node),this._componentMap.delete(r),(s=r.widget)==null||s.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(o,1)[0]}}empty(e,i={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,i);return}const r=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(s=>{var o;return s==null?!1:!(((o=this._componentMap.get(s))==null?void 0:o.internal)??!1)||i.removeInternal});for(const s of n)this.remove(s)}move(e,i){if(Array.isArray(e)&&e.forEach(o=>this.move(o,i)),!e)return;let r;const n=GA(e)||GA(i);if(n&&(r=n.index,i=n.position,e=n.component||e),i&&!this._isValidPosition(i))return;const s=this.remove(e);s&&this.add(s,{position:i,index:r})}find(e){if(!e)return null;const i=this._findById(e);return i&&(i.widget||i.node)}getComponents(e,i={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,i)):this._getComponentsAtPosition(e,i):this._components.filter(r=>{var n;return i.includeInternal||!((n=this._componentMap.get(r))!=null&&n.internal)}).map(({widget:r,node:n})=>r??n)}getPosition(e){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(e))return i;return null}_add(e,i,r,n,s){e instanceof nM||(e=new nM({node:e}));const{widget:o}=e;o!=null&&o instanceof q&&o.addHandles(ye(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey),this._place({component:e,position:i,index:r}),this._components.push(e),this._componentMap.set(e,{key:n,internal:s})}_find(e){return e?e instanceof nM?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??X3e}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ns.innerContainer,Ns.cornerContainer);const i=document.createElement("div");i.classList.add(Ns.innerContainer,Ns.manualContainer);const r=document.createElement("div");r.classList.add(Ns.topLeft,Ns.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(Ns.topRight,Ns.corner),e.appendChild(n);const s=document.createElement("div");s.classList.add(Ns.bottomLeft,Ns.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(Ns.bottomRight,Ns.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=i;const a=qy();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":s,"bottom-right":o,"top-leading":a?n:r,"top-trailing":a?r:n,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){var d,p;const i=e.position??"manual",{component:r,index:n}=e,s=this._positionNameToContainerLookup[i],o=n!=null&&n>-1;if(Q3e(r.widget)&&r.widget.startup(),!o)return void s.appendChild(r.node);const a=Array.from(s.children);if(n===0){const{firstChild:h}=s;return void(h?(d=h.parentNode)==null?void 0:d.insertBefore(r.node,h):s.appendChild(r.node))}if(n>=a.length)return void s.appendChild(r.node);const u=a[n];(p=u.parentNode)==null||p.insertBefore(r.node,u)}_toPixelPosition(e){return{top:tI(e.top),left:tI(e.left),right:tI(e.right),bottom:tI(e.bottom)}}_findByComponent(e){return this._components.find(i=>i===e)??null}_findById(e){return this._components.find(({id:i})=>i===e)??null}_findByNode(e){return this._components.find(({node:i})=>i===e)??null}_getComponentsAtPosition(e,i){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(n=>this._findByNode(n)).filter(ot).filter(n=>{var s;return i.includeInternal||!((s=this._componentMap.get(n))!=null&&s.internal)}).map(({widget:n,node:s})=>n??s)}};l([c()],qu.prototype,"_locale",void 0),l([c()],qu.prototype,"container",null),l([c()],qu.prototype,"height",null),l([c({value:nse})],qu.prototype,"padding",null),l([We("padding")],qu.prototype,"castPadding",null),l([c()],qu.prototype,"view",void 0),l([c()],qu.prototype,"width",null),qu=l([$("esri.views.ui.UI")],qu);const eFe=qu,tFe={handleInterceptedEvent:(t,e,i,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||i,[r]))},iFe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}},rFe=t=>({...iFe,...t}),nFe=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},sFe=(t,e)=>t.find(e),CH=(t,e,i=!1)=>{let r=t;return e.forEach((n,s)=>{const o=r!=null&&r.children?sFe(r.children,a=>a.domNode===n):void 0;i&&!o&&s!==e.length-1||(r=o)}),r},oFe=t=>{let e;const i={...tFe,...t},r=rFe(i),n=r.performanceLogger;let s,o=!0,a=!1;const u=[],d=[],p=(m,y,g)=>{var w;let v;r.eventHandlerInterceptor=(S,E,T,M)=>function(x){let C;n("domEvent",x);const O=nFe(x.currentTarget,v.domNode),F=O.some(z=>{var H;return customElements.get((H=z==null?void 0:z.tagName)==null?void 0:H.toLowerCase())});if(x.eventPhase===Event.CAPTURING_PHASE||!F)O.reverse(),C=CH(v.getLastRender(),O);else{const z=x.composedPath(),H=z.slice(z.indexOf(x.currentTarget),z.indexOf(v.domNode)).reverse();C=CH(v.getLastRender(),H,!0)}let V;return C&&(V=i.handleInterceptedEvent(e,C,this,x)),n("domEventProcessed",x),V},(w=i.postProcessProjectionOptions)==null||w.call(i,r);const _=g();v=m(y,_,r),r.eventHandlerInterceptor=void 0,u.push(v),d.push(g),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(v,_)};let h=()=>{if(s=void 0,o){o=!1,n("renderStart",void 0);for(let m=0;m<u.length;m++){const y=d[m]();n("rendered",void 0);try{u[m].update(y)}catch(g){console.error(g)}n("patched",void 0)}n("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,u,d)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(m,y)=>{p(Xh.append,m,y)},insertBefore:(m,y)=>{p(Xh.insertBefore,m,y)},merge:(m,y)=>{p(Xh.merge,m,y)},replace:(m,y)=>{p(Xh.replace,m,y)},detach:m=>{for(let y=0;y<d.length;y++)if(d[y]===m)return d.splice(y,1),u.splice(y,1)[0];throw new Error("renderFunction was not found")}},e};/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const sse="calcite-mode-auto",ose="calcite-mode-dark",aFe="calcite-mode-light",Drt={autoMode:sse,darkMode:ose,lightMode:aFe,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"},Vrt={filter:250,nextTick:0,resize:150,reposition:100};var Va={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},lFe=Object.defineProperty,uFe=(t,e)=>{for(var i in e)lFe(t,i,{get:e[i],enumerable:!0})},ase=new WeakMap,yg=t=>ase.get(t),cFe=(t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return ase.set(t,i)},kH=(t,e)=>e in t,hE=(t,e)=>(0,console.error)(t,e),D2=new Map,dFe=[],pFe="slot-fb{display:contents}slot-fb[hidden]{display:none}",LH="http://www.w3.org/1999/xlink",mE=typeof window<"u"?window:{},hu=mE.document||{head:{}},Urt=mE.HTMLElement||class{},gn={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,r)=>t.addEventListener(e,i,r),rel:(t,e,i,r)=>t.removeEventListener(e,i,r),ce:(t,e)=>new CustomEvent(t,e)},hFe=(()=>{let t=!1;try{hu.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),mFe=t=>Promise.resolve(t),fFe=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),NN=!1,DN=[],lse=[],use=(t,e)=>i=>{t.push(i),NN||(NN=!0,e&&gn.$flags$&4?yFe(VN):gn.raf(VN))},AH=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(i){hE(i)}t.length=0},VN=()=>{AH(DN),AH(lse),(NN=DN.length>0)&&gn.raf(VN)},yFe=t=>mFe().then(t),jrt=use(DN,!1),gFe=use(lse,!0),vFe=t=>{const e=new URL(t,gn.$resourcesUrl$);return e.origin!==mE.location.origin?e.href:e.pathname},bFe=t=>gn.$resourcesUrl$=t,OH={},_Fe="http://www.w3.org/2000/svg",wFe="http://www.w3.org/1999/xhtml",SFe=t=>t!=null,Q4=t=>(t=typeof t,t==="object"||t==="function");function $Fe(t){var e,i,r;return(r=(i=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:i.getAttribute("content"))!=null?r:void 0}var EFe={};uFe(EFe,{err:()=>cse,map:()=>TFe,ok:()=>UN,unwrap:()=>IFe,unwrapErr:()=>xFe});var UN=t=>({isOk:!0,isErr:!1,value:t}),cse=t=>({isOk:!1,isErr:!0,value:t});function TFe(t,e){if(t.isOk){const i=e(t.value);return i instanceof Promise?i.then(r=>UN(r)):UN(i)}if(t.isErr){const i=t.value;return cse(i)}throw"should never get here"}var IFe=t=>{if(t.isOk)return t.value;throw t.value},xFe=t=>{if(t.isErr)return t.value;throw t.value},Jy=(t,e="")=>()=>{},dse=(t,e,...i)=>{let r=null,n=null,s=null,o=!1,a=!1;const u=[],d=h=>{for(let m=0;m<h.length;m++)r=h[m],Array.isArray(r)?d(r):r!=null&&typeof r!="boolean"&&((o=typeof t!="function"&&!Q4(r))&&(r=String(r)),o&&a?u[u.length-1].$text$+=r:u.push(o?V2(null,r):r),a=o)};if(d(i),e){e.key&&(n=e.key),e.name&&(s=e.name);{const h=e.className||e.class;h&&(e.class=typeof h!="object"?h:Object.keys(h).filter(m=>h[m]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,u,kFe);const p=V2(t,null);return p.$attrs$=e,u.length>0&&(p.$children$=u),p.$key$=n,p.$name$=s,p},V2=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},MFe={},CFe=t=>t&&t.$tag$===MFe,kFe={forEach:(t,e)=>t.map(RH).forEach(e),map:(t,e)=>t.map(RH).map(e).map(LFe)},RH=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),LFe=t=>{if(typeof t.vtag=="function"){const i={...t.vattrs};return t.vkey&&(i.key=t.vkey),t.vname&&(i.name=t.vname),dse(t.vtag,i,...t.vchildren||[])}const e=V2(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},AFe=t=>dFe.map(e=>e(t)).find(e=>!!e),OFe=(t,e)=>t!=null&&!Q4(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,RFe=t=>t,Grt=(t,e,i)=>{const r=RFe(t);return{emit:n=>PFe(r,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:n})}},PFe=(t,e,i)=>{const r=gn.ce(e,i);return t.dispatchEvent(r),r},PH=new WeakMap,FFe=(t,e,i)=>{let r=D2.get(t);fFe&&i?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,D2.set(t,r)},NFe=(t,e,i)=>{var r;const n=pse(e,i),s=D2.get(n);if(t=t.nodeType===11?t:hu,s)if(typeof s=="string"){t=t.head||t;let o=PH.get(t),a;if(o||PH.set(t,o=new Set),!o.has(n)){{a=hu.createElement("style"),a.innerHTML=s;const u=(r=gn.$nonce$)!=null?r:$Fe(hu);u!=null&&a.setAttribute("nonce",u),(!(e.$flags$&1)||e.$flags$&1&&t.nodeName!=="HEAD")&&t.insertBefore(a,t.querySelector("link"))}e.$flags$&4&&(a.innerHTML+=pFe),o&&o.add(n)}}else t.adoptedStyleSheets.includes(s)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,s]);return n},DFe=t=>{const e=t.$cmpMeta$,i=t.$hostElement$,r=e.$flags$,n=Jy("attachStyles",e.$tagName$),s=NFe(i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);r&10&&r&2&&(i["s-sc"]=s,i.classList.add(s+"-h"),r&2&&i.classList.add(s+"-s")),n()},pse=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),FH=(t,e,i,r,n,s)=>{if(i!==r){let o=kH(t,e),a=e.toLowerCase();if(e==="class"){const u=t.classList,d=NH(i),p=NH(r);u.remove(...d.filter(h=>h&&!p.includes(h))),u.add(...p.filter(h=>h&&!d.includes(h)))}else if(e==="style"){for(const u in i)(!r||r[u]==null)&&(u.includes("-")?t.style.removeProperty(u):t.style[u]="");for(const u in r)(!i||r[u]!==i[u])&&(u.includes("-")?t.style.setProperty(u,r[u]):t.style[u]=r[u])}else if(e!=="key")if(e==="ref")r&&r(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):kH(mE,a)?e=a.slice(2):e=a[2]+e.slice(3),i||r){const u=e.endsWith(hse);e=e.replace(UFe,""),i&&gn.rel(t,e,i,u),r&&gn.ael(t,e,r,u)}}else{const u=Q4(r);if((o||u&&r!==null)&&!n)try{if(t.tagName.includes("-"))t[e]=r;else{const p=r??"";e==="list"?o=!1:(i==null||t[e]!=p)&&(t[e]=p)}}catch{}let d=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(e=a,d=!0),r==null||r===!1?(r!==!1||t.getAttribute(e)==="")&&(d?t.removeAttributeNS(LH,e):t.removeAttribute(e)):(!o||s&4||n)&&!u&&(r=r===!0?"":r,d?t.setAttributeNS(LH,e,r):t.setAttribute(e,r))}}},VFe=/\s/,NH=t=>t?t.split(VFe):[],hse="Capture",UFe=new RegExp(hse+"$"),mse=(t,e,i)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,n=t&&t.$attrs$||OH,s=e.$attrs$||OH;for(const o of DH(Object.keys(n)))o in s||FH(r,o,n[o],void 0,i,e.$flags$);for(const o of DH(Object.keys(s)))FH(r,o,n[o],s[o],i,e.$flags$)};function DH(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Xv,jN,Hb,U2=!1,j2=!1,eU=!1,No=!1,G2=(t,e,i,r)=>{var n;const s=e.$children$[i];let o=0,a,u,d;if(U2||(eU=!0,s.$tag$==="slot"&&(Xv&&r.classList.add(Xv+"-s"),s.$flags$|=s.$children$?2:1)),s.$text$!==null)a=s.$elm$=hu.createTextNode(s.$text$);else if(s.$flags$&1)a=s.$elm$=hu.createTextNode("");else{if(No||(No=s.$tag$==="svg"),a=s.$elm$=hu.createElementNS(No?_Fe:wFe,!U2&&Va.slotRelocation&&s.$flags$&2?"slot-fb":s.$tag$),No&&s.$tag$==="foreignObject"&&(No=!1),mse(null,s,No),!!a.getRootNode().querySelector("body")&&Va.scoped&&SFe(Xv)&&a["s-si"]!==Xv&&a.classList.add(a["s-si"]=Xv),iU(a,r),s.$children$)for(o=0;o<s.$children$.length;++o)u=G2(t,s,o,a),u&&a.appendChild(u);s.$tag$==="svg"?No=!1:a.tagName==="foreignObject"&&(No=!0)}return a["s-hn"]=Hb,s.$flags$&3&&(a["s-sr"]=!0,a["s-cr"]=jN,a["s-sn"]=s.$name$||"",a["s-rf"]=(n=s.$attrs$)==null?void 0:n.ref,d=t&&t.$children$&&t.$children$[i],d&&d.$tag$===s.$tag$&&t.$elm$&&b$(t.$elm$,!1)),a},b$=(t,e)=>{gn.$flags$|=1;const i=Array.from(t.childNodes);if(t["s-sr"]&&Va.experimentalSlotFixes){let r=t;for(;r=r.nextSibling;)r&&r["s-sn"]===t["s-sn"]&&r["s-sh"]===Hb&&i.push(r)}for(let r=i.length-1;r>=0;r--){const n=i[r];n["s-hn"]!==Hb&&n["s-ol"]&&(am(gse(n),n,tU(n)),n["s-ol"].remove(),n["s-ol"]=void 0,n["s-sh"]=void 0,eU=!0),e&&b$(n,e)}gn.$flags$&=-2},fse=(t,e,i,r,n,s)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t,a;for(o.shadowRoot&&o.tagName===Hb&&(o=o.shadowRoot);n<=s;++n)r[n]&&(a=G2(null,i,n,t),a&&(r[n].$elm$=a,am(o,a,tU(e))))},yse=(t,e,i)=>{for(let r=e;r<=i;++r){const n=t[r];if(n){const s=n.$elm$;_se(n),s&&(j2=!0,s["s-ol"]?s["s-ol"].remove():b$(s,!0),s.remove())}}},jFe=(t,e,i,r,n=!1)=>{let s=0,o=0,a=0,u=0,d=e.length-1,p=e[0],h=e[d],m=r.length-1,y=r[0],g=r[m],v,_;for(;s<=d&&o<=m;)if(p==null)p=e[++s];else if(h==null)h=e[--d];else if(y==null)y=r[++o];else if(g==null)g=r[--m];else if(iI(p,y,n))Qv(p,y,n),p=e[++s],y=r[++o];else if(iI(h,g,n))Qv(h,g,n),h=e[--d],g=r[--m];else if(iI(p,g,n))(p.$tag$==="slot"||g.$tag$==="slot")&&b$(p.$elm$.parentNode,!1),Qv(p,g,n),am(t,p.$elm$,h.$elm$.nextSibling),p=e[++s],g=r[--m];else if(iI(h,y,n))(p.$tag$==="slot"||g.$tag$==="slot")&&b$(h.$elm$.parentNode,!1),Qv(h,y,n),am(t,h.$elm$,p.$elm$),h=e[--d],y=r[++o];else{for(a=-1,u=s;u<=d;++u)if(e[u]&&e[u].$key$!==null&&e[u].$key$===y.$key$){a=u;break}a>=0?(_=e[a],_.$tag$!==y.$tag$?v=G2(e&&e[o],i,a,t):(Qv(_,y,n),e[a]=void 0,v=_.$elm$),y=r[++o]):(v=G2(e&&e[o],i,o,t),y=r[++o]),v&&am(gse(p.$elm$),v,tU(p.$elm$))}s>d?fse(t,r[m+1]==null?null:r[m+1].$elm$,i,r,o,m):o>m&&yse(e,s,d)},iI=(t,e,i=!1)=>t.$tag$===e.$tag$?t.$tag$==="slot"?"$nodeId$"in t&&i&&t.$elm$.nodeType!==8?!1:t.$name$===e.$name$:i?!0:t.$key$===e.$key$:!1,tU=t=>t&&t["s-ol"]||t,gse=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,Qv=(t,e,i=!1)=>{const r=e.$elm$=t.$elm$,n=t.$children$,s=e.$children$,o=e.$tag$,a=e.$text$;let u;a===null?(No=o==="svg"?!0:o==="foreignObject"?!1:No,o==="slot"&&!U2||mse(t,e,No),n!==null&&s!==null?jFe(r,n,e,s,i):s!==null?(t.$text$!==null&&(r.textContent=""),fse(r,null,e,s,0,s.length-1)):!i&&Va.updatable&&n!==null&&yse(n,0,n.length-1),No&&o==="svg"&&(No=!1)):(u=r["s-cr"])?u.parentNode.textContent=a:t.$text$!==a&&(r.data=a)},vse=t=>{const e=t.childNodes;for(const i of e)if(i.nodeType===1){if(i["s-sr"]){const r=i["s-sn"];i.hidden=!1;for(const n of e)if(n!==i){if(n["s-hn"]!==i["s-hn"]||r!==""){if(n.nodeType===1&&(r===n.getAttribute("slot")||r===n["s-sn"])||n.nodeType===3&&r===n["s-sn"]){i.hidden=!0;break}}else if(n.nodeType===1||n.nodeType===3&&n.textContent.trim()!==""){i.hidden=!0;break}}}vse(i)}},Hd=[],bse=t=>{let e,i,r;for(const n of t.childNodes){if(n["s-sr"]&&(e=n["s-cr"])&&e.parentNode){i=e.parentNode.childNodes;const s=n["s-sn"];for(r=i.length-1;r>=0;r--)if(e=i[r],!e["s-cn"]&&!e["s-nr"]&&e["s-hn"]!==n["s-hn"]&&!Va.experimentalSlotFixes)if(VH(e,s)){let o=Hd.find(a=>a.$nodeToRelocate$===e);j2=!0,e["s-sn"]=e["s-sn"]||s,o?(o.$nodeToRelocate$["s-sh"]=n["s-hn"],o.$slotRefNode$=n):(e["s-sh"]=n["s-hn"],Hd.push({$slotRefNode$:n,$nodeToRelocate$:e})),e["s-sr"]&&Hd.map(a=>{VH(a.$nodeToRelocate$,e["s-sn"])&&(o=Hd.find(u=>u.$nodeToRelocate$===e),o&&!a.$slotRefNode$&&(a.$slotRefNode$=o.$slotRefNode$))})}else Hd.some(o=>o.$nodeToRelocate$===e)||Hd.push({$nodeToRelocate$:e})}n.nodeType===1&&bse(n)}},VH=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",_se=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(_se)},am=(t,e,i)=>{const r=t==null?void 0:t.insertBefore(e,i);return iU(e,t),r},wse=t=>{const e=[];return t&&e.push(...t["s-scs"]||[],t["s-si"],t["s-sc"],...wse(t.parentElement)),e},iU=(t,e,i=!1)=>{var r;if(t&&e&&t.nodeType===1){const n=new Set(wse(e).filter(Boolean));if(n.size&&((r=t.classList)==null||r.add(...t["s-scs"]=[...n]),t["s-ol"]||i))for(const s of Array.from(t.childNodes))iU(s,t,!0)}},GFe=(t,e,i=!1)=>{var r,n,s,o,a;const u=t.$hostElement$,d=t.$cmpMeta$,p=t.$vnode$||V2(null,null),h=CFe(e)?e:dse(null,null,e);if(Hb=u.tagName,d.$attrsToReflect$&&(h.$attrs$=h.$attrs$||{},d.$attrsToReflect$.map(([m,y])=>h.$attrs$[y]=u[m])),i&&h.$attrs$)for(const m of Object.keys(h.$attrs$))u.hasAttribute(m)&&!["key","ref","style","class"].includes(m)&&(h.$attrs$[m]=u[m]);h.$tag$=null,h.$flags$|=4,t.$vnode$=h,h.$elm$=p.$elm$=u.shadowRoot||u,Xv=u["s-sc"],U2=(d.$flags$&1)!==0,jN=u["s-cr"],j2=!1,Qv(p,h,i);{if(gn.$flags$|=1,eU){bse(h.$elm$);for(const m of Hd){const y=m.$nodeToRelocate$;if(!y["s-ol"]){const g=hu.createTextNode("");g["s-nr"]=y,am(y.parentNode,y["s-ol"]=g,y)}}for(const m of Hd){const y=m.$nodeToRelocate$,g=m.$slotRefNode$;if(g){const v=g.parentNode;let _=g.nextSibling;{let w=(r=y["s-ol"])==null?void 0:r.previousSibling;for(;w;){let S=(n=w["s-nr"])!=null?n:null;if(S&&S["s-sn"]===y["s-sn"]&&v===S.parentNode){for(S=S.nextSibling;S===y||S!=null&&S["s-sr"];)S=S==null?void 0:S.nextSibling;if(!S||!S["s-nr"]){_=S;break}}w=w.previousSibling}}(!_&&v!==y.parentNode||y.nextSibling!==_)&&y!==_&&(!y["s-hn"]&&y["s-ol"]&&(y["s-hn"]=y["s-ol"].parentNode.nodeName),am(v,y,_),y.nodeType===1&&(y.hidden=(s=y["s-ih"])!=null?s:!1)),y&&typeof g["s-rf"]=="function"&&g["s-rf"](y)}else y.nodeType===1&&(i&&(y["s-ih"]=(o=y.hidden)!=null?o:!1),y.hidden=!0)}}j2&&vse(h.$elm$),gn.$flags$&=-2,Hd.length=0}if(Va.experimentalScopedSlotChanges&&d.$flags$&2)for(const m of h.$elm$.childNodes)m["s-hn"]!==Hb&&!m["s-sh"]&&(i&&m["s-ih"]==null&&(m["s-ih"]=(a=m.hidden)!=null?a:!1),m.hidden=!0);jN=void 0},zFe=(t,e)=>{},rU=(t,e)=>(t.$flags$|=16,zFe(t,t.$ancestorComponent$),gFe(()=>BFe(t,e))),BFe=(t,e)=>{const i=t.$hostElement$,r=Jy("scheduleUpdate",t.$cmpMeta$.$tagName$),n=i;if(!n)throw new Error(`Can't render component <${i.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let s;return e?s=eb(n,"componentWillLoad"):s=eb(n,"componentWillUpdate"),s=UH(s,()=>eb(n,"componentWillRender")),r(),UH(s,()=>qFe(t,n,e))},UH=(t,e)=>HFe(t)?t.then(e).catch(i=>{console.error(i),e()}):e(),HFe=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",qFe=async(t,e,i)=>{const r=t.$hostElement$,n=Jy("update",t.$cmpMeta$.$tagName$);r["s-rc"],i&&DFe(t);const s=Jy("render",t.$cmpMeta$.$tagName$);WFe(t,e,r,i),s(),n(),ZFe(t)},jH=null,WFe=(t,e,i,r)=>{try{jH=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Va.hasRenderFn||Va.reflect)&&(Va.vdomRender||Va.reflect)&&(Va.hydrateServerSide||GFe(t,e,r))}catch(u){hE(u,t.$hostElement$)}return jH=null,null},ZFe=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,r=Jy("postUpdate",e),n=i;t.$ancestorComponent$,eb(n,"componentDidRender"),t.$flags$&64?(eb(n,"componentDidUpdate"),r()):(t.$flags$|=64,eb(n,"componentDidLoad"),r())},zrt=t=>{{const e=yg(t),i=e.$hostElement$.isConnected;return i&&(e.$flags$&18)===2&&rU(e,!1),i}},eb=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(r){hE(r)}},JFe=(t,e)=>yg(t).$instanceValues$.get(e),YFe=(t,e,i,r)=>{const n=yg(t),s=t,o=n.$instanceValues$.get(e),a=n.$flags$,u=s;i=OFe(i,r.$members$[e][0]);const d=Number.isNaN(o)&&Number.isNaN(i);if(i!==o&&!d){n.$instanceValues$.set(e,i);{if(r.$watchers$&&a&128){const h=r.$watchers$[e];h&&h.map(m=>{try{u[m](i,o,e)}catch(y){hE(y,s)}})}if((a&18)===2){if(u.componentShouldUpdate&&u.componentShouldUpdate(i,o,e)===!1)return;rU(n,!1)}}}},KFe=(t,e,i)=>{var r,n;const s=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const o=Object.entries((r=e.$members$)!=null?r:{});o.map(([a,[u]])=>{(u&31||u&32)&&Object.defineProperty(s,a,{get(){return JFe(this,a)},set(d){YFe(this,a,d,e)},configurable:!0,enumerable:!0})});{const a=new Map;s.attributeChangedCallback=function(u,d,p){gn.jmp(()=>{var h;const m=a.get(u);if(this.hasOwnProperty(m))p=this[m],delete this[m];else{if(s.hasOwnProperty(m)&&typeof this[m]=="number"&&this[m]==p)return;if(m==null){const y=yg(this),g=y==null?void 0:y.$flags$;if(g&&!(g&8)&&g&128&&p!==d){const _=this,w=(h=e.$watchers$)==null?void 0:h[u];w==null||w.forEach(S=>{_[S]!=null&&_[S].call(_,p,d,u)})}return}}this[m]=p===null&&typeof this[m]=="boolean"?!1:p})},t.observedAttributes=Array.from(new Set([...Object.keys((n=e.$watchers$)!=null?n:{}),...o.filter(([u,d])=>d[0]&15).map(([u,d])=>{var p;const h=d[1]||u;return a.set(h,u),d[0]&512&&((p=e.$attrsToReflect$)==null||p.push([u,h])),h})]))}}return t},XFe=async(t,e,i,r)=>{let n;if(!(e.$flags$&32)){e.$flags$|=32,i.$lazyBundleId$;{n=t.constructor;const o=t.localName;customElements.whenDefined(o).then(()=>e.$flags$|=128)}if(n&&n.style){let o;typeof n.style=="string"?o=n.style:typeof n.style!="string"&&(e.$modeName$=AFe(t),e.$modeName$&&(o=n.style[e.$modeName$]));const a=pse(i,e.$modeName$);if(!D2.has(a)){const u=Jy("registerStyles",i.$tagName$);FFe(a,o,!!(i.$flags$&1)),u()}}}e.$ancestorComponent$,rU(e,!0)},GH=t=>{},QFe=t=>{if(!(gn.$flags$&1)){const e=yg(t),i=e.$cmpMeta$,r=Jy("connectedCallback",i.$tagName$);e.$flags$&1?(Sse(t,e,i.$listeners$),e!=null&&e.$lazyInstance$?GH(e.$lazyInstance$):e!=null&&e.$onReadyPromise$&&e.$onReadyPromise$.then(()=>GH(e.$lazyInstance$))):(e.$flags$|=1,i.$flags$&12&&eNe(t),i.$members$&&Object.entries(i.$members$).map(([n,[s]])=>{if(s&31&&t.hasOwnProperty(n)){const o=t[n];delete t[n],t[n]=o}}),XFe(t,e,i)),r()}},eNe=t=>{const e=t["s-cr"]=hu.createComment("");e["s-cn"]=!0,am(t,e,t.firstChild)},tNe=async t=>{if(!(gn.$flags$&1)){const e=yg(t);e.$rmListeners$&&(e.$rmListeners$.map(i=>i()),e.$rmListeners$=void 0)}},Brt=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};i.$members$=e[2],i.$listeners$=e[3],i.$watchers$=t.$watchers$,i.$attrsToReflect$=[];const r=t.prototype.connectedCallback,n=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){cFe(this,i)},connectedCallback(){const s=yg(this);Sse(this,s,i.$listeners$),QFe(this),r&&r.call(this)},disconnectedCallback(){tNe(this),n&&n.call(this)},__attachShadow(){if(!this.shadowRoot)this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)});else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${i.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=i.$tagName$,KFe(t,i)},Hrt=(t,e)=>e,Sse=(t,e,i,r)=>{i&&i.map(([n,s,o])=>{const a=rNe(t,n),u=iNe(e,o),d=nNe(n);gn.ael(a,s,u,d),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>gn.rel(a,s,u,d))})},iNe=(t,e)=>i=>{var r;try{Va.lazyLoad||t.$hostElement$[e](i)}catch(n){hE(n)}},rNe=(t,e)=>e&4?hu:e&8?mE:e&16?hu.body:t,nNe=t=>hFe?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0;/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const sp=globalThis.calciteConfig,qrt=(sp==null?void 0:sp.focusTrapStack)||[];sp!=null&&sp.logLevel;const zH="2.13.1",sNe="2024-10-11",oNe="6704555f8";function aNe(){if(sp&&sp.version)return;console.info(`Using Calcite Components ${zH} [Date: ${sNe}, Revision: ${oNe}]`);const t=sp||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:zH,writable:!1}),globalThis.calciteConfig=t}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const $se=()=>typeof navigator<"u"&&typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;function lNe(){return navigator.userAgentData}function Wrt(){if(!$se())return"";const t=lNe();return t!=null&&t.brands?t.brands.map(({brand:e,version:i})=>`${e}/${i}`).join(" "):navigator.userAgent}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */function BH(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(ose)||t.contains(sse)&&e?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),n=o=>{s!==o&&r(o),s=o};let s=i();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>n(o.matches?"dark":"light")),new MutationObserver(()=>n(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function uNe(){$se()&&(document.readyState==="interactive"?BH():document.addEventListener("DOMContentLoaded",()=>BH(),{once:!0})),aNe()}const cNe=uNe;cNe();let Ese;function dNe(){try{vFe(".")}catch{bFe(ro(ut(Ese)))}}function Gt(t){var i;const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push((i=t[r])==null?void 0:i.call(t));return e.length>0?Promise.all(e):null}Ese="components/assets";const Tse=Symbol("widget"),Ise=Symbol("widget-test-data"),pNe=[],hNe={},z2=new WeakMap;function xse(t,e){let i=e.children;if(i!=null&&i.length)for(let n=0;n<i.length;++n)i[n]=xse(t,i[n]);else i=pNe;const r=e.vnodeSelector;if(B2(r)){const n=e.properties||hNe,s=n.key||r,o={key:s,afterCreate:mNe,afterUpdate:fNe,afterRemoved:Mse,parentWidget:t,widgetConstructor:r,widgetProperties:{...n,key:s,children:i}};return{vnodeSelector:r.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function mNe(t,e,i,{parentWidget:r,widgetConstructor:n,widgetProperties:s}){var a;const o=new n(s);o.container=t,z2.set(t,o),(a=o.afterCreate)==null||a.call(o,o,t),r.addHandles(ye(()=>Mse(t))),queueMicrotask(()=>{o[Ise].projector.renderNow()})}function fNe(t,e,i,{widgetProperties:r}){var s;const n=z2.get(t);n&&(n.set(r),(s=n.afterUpdate)==null||s.call(n,n,t))}function Mse(t){var i;const e=z2.get(t);e&&((i=e.afterRemoved)==null||i.call(e,e,t),e.destroy(),z2.delete(t))}function B2(t){return typeof t=="function"&&t[Tse]}const HH=new Set;function yNe(t){HH.add(t),t.finally(()=>HH.delete(t))}var Cse;const gNe="esri.widgets.Widget";let vNe=0;function kse(t,e){const i=Object.prototype.hasOwnProperty;for(const r in e)i.call(e,r)&&i.call(t,r)&&(t[r]!=null&&e[r]!=null&&typeof t[r]=="object"&&typeof e[r]=="object"?kse(t[r],e[r]):t[r]=e[r]);return t}const bNe=oFe({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(r,n,s,o)=>{const a=e==null?void 0:e(r,n,s,o),u=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in s)||u){const d=r[2].toLowerCase()+r.slice(3),p=y=>a==null?void 0:a.call(s,y);s.addEventListener(d,p,u);const h=()=>s.removeEventListener(d,p,u),m=o.afterRemoved;o.afterRemoved=y=>{m==null||m(y),h()}}return a}},handleInterceptedEvent(t,e,i,r){const{eventPhase:n,type:s}=r,o=n===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const u=e.properties;(u&&a in u||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,u&&a in u))&&(Jie(),t.scheduleRender(),u[a].call(u.bind||i,r))}});let BA=!1,Sr=class extends l_(ji.EventedAccessor){constructor(e,i){super(e,i),this._attached=!1,this._projector=bNe,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=Bo(async()=>{var u;if((u=this._messageBundleProps)!=null&&u.length){const d=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:p,propertyName:h})=>{if(this.destroyed)return;let m=await BC(p);this.uiStrings&&Object.keys(this.uiStrings)&&(m=kse(R(m),this.uiStrings)),this[h]=m}));if(this.destroyed)return;for(const p of d)p.status==="rejected"&&U.getLogger(this).error("widget-intl:locale-error",this.declaredClass,p.reason)}await this.loadLocale()}),dNe();const r="esri-widget-uid-"+Mk(),n=this.render.bind(this);this._trackingTarget=new kC(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const s=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{var h,m;if(!this._readyForTrueRender||this.destroyed)return null;const u=n()??s(),d=u.properties??(u.properties={});if(d.key??(d.key=r),B2(u.vnodeSelector)){if(!this.visible)return s()}else this.visible?d.styles||(d.styles={}):(d.class="",d.styles={display:"none"}),(h=d.styles).display??(h.display="");let p=0;return(m=u.children)==null||m.forEach(y=>{var g;B2(y.vnodeSelector)||(y.properties??(y.properties={}),(g=y.properties).key??(g.key=`${this.id}--${p++}`))}),xse(this,u)};this.render=()=>{if(BA)return o();let u=mke(this)??null;if(u)return u;this._trackingTarget.clear(),BA=!0;try{u=lp(this._trackingTarget,o)}catch(d){throw U.getLogger(this).error(d),d}finally{BA=!1}return u&&fke(this,u),u};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),yNe(this._resourcesFetch)}normalizeCtorArgs(e,i){const r={...e};return i&&(r.container=i),r}postInitialize(){}beforeFirstRender(){var i;const e=this.loadDependencies();return(i=this._messageBundleProps)!=null&&i.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(NM):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(xe(this._trackingTarget),xe(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,SA(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return L4(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){var e;return this._get("id")||((e=this.container)==null?void 0:e.id)||Date.now().toString(16)+"-widget-"+vNe++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Cse=Tse,Ise)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(SA(this),this._projector.scheduleRender())}own(e){IC(U.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(e)}classes(...e){return nu.apply(this,e)}renderNow(){SA(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this.addHandles(N(()=>this.viewModel,(r,n)=>{n&&this.removeHandles("delegated-events"),r&&CC(r)&&this.addHandles(this._delegatedEventNames.map(s=>O$(r,s,o=>{this.emit(s,o)})),"delegated-events")},gt)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(NM),this.scheduleRender()};this.addHandles([GC(e),N(()=>this.uiStrings,e),Hi(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=e==null?void 0:e.parentNode)==null||i.removeChild(e)}};Sr[Cse]=!0,Sr.vnodeSelector="div",l([c()],Sr.prototype,"_readyForTrueRender",void 0),l([c({value:null})],Sr.prototype,"container",null),l([We("container")],Sr.prototype,"castContainer",null),l([c()],Sr.prototype,"icon",null),l([c()],Sr.prototype,"id",null),l([c()],Sr.prototype,"label",null),l([c()],Sr.prototype,"renderable",null),l([c()],Sr.prototype,"uiStrings",void 0),l([c()],Sr.prototype,"viewModel",void 0),l([c({value:!0})],Sr.prototype,"visible",null),l([c()],Sr.prototype,"key",void 0),l([c()],Sr.prototype,"children",void 0),l([c()],Sr.prototype,"afterCreate",void 0),l([c()],Sr.prototype,"afterUpdate",void 0),l([c()],Sr.prototype,"afterRemoved",void 0),Sr=l([$(gNe)],Sr);const $t=Sr,_Ne=new Map;function wNe(t){return _Ne.get(t)}function qH(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function SNe(t,e){return t.length!==e.length||t.some((i,r)=>i.text!==e[r].text)}function ow(t,e,i){!i||!e||t.find(r=>r.layerView===e&&r.text===i)||t.push({text:i,layerView:e})}function $Ne(t){return t.type==="bing-maps"}const zc=[];let e0=class extends q{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Y,this.view=null,this._allLayerViewsChange=i=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const r=(n=this.view)==null?void 0:n.allLayerViews;r&&(this.addHandles(r.map(s=>N(()=>{var o;return[s.suspended,(o=s.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),r.forEach(s=>{s.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),i!=null&&i.removed&&i.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([St(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Hi(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var e;return(e=this.view)!=null&&e.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,i=e==null?void 0:e.allLayerViews;if(zc.length=0,!e||!i)return void this._clear();i.forEach(n=>{var a,u;if(n.suspended||!((a=n.layer)!=null&&a.attributionVisible))return;const s=n.layer;if(qH(s,"user"))return void ow(zc,n,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(n)){const d=this._fetchedAttributionData.get(n);return void(d?ow(zc,n,this._getDynamicAttribution(d,e,s)):qH(s)&&ow(zc,n,s.copyright))}return void this._fetchAttributionData(n)}const o="portalItem"in s?(u=s.portalItem)==null?void 0:u.accessInformation:void 0;ow(zc,n,o||s.copyright)});const r=i.find(n=>{var s;return((s=n.layer)==null?void 0:s.type)==="integrated-mesh-3dtiles"});if(this.view&&r){const n=wNe(this.view);if(n){const s=n.getAttributionText();for(let o=0;o<s.length;++o)ow(zc,r,s[o])}}SNe(this.items,zc)&&(this.items.removeAll(),this.items.addMany(zc)),zc.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const i=await N$(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const r=i.ok?this._createContributionIndex(i.value,$Ne(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,r)}this._updateAttributionItems()}_createContributionIndex(e,i){const r=e.contributors,n={};if(!r)return n;for(let s=0;s<r.length;s++){const o=r[s],a=o.coverageAreas;if(!a)return;for(const u of a){const d=u.bbox,p=u.zoomMin-(i&&u.zoomMin?1:0),h=u.zoomMax-(i&&u.zoomMax?1:0),m=new at({xmin:d[1],ymin:d[0],xmax:d[3],ymax:d[2],spatialReference:le.WGS84}),y={extent:Qd(m),attribution:o.attribution||"",score:u.score!=null?u.score:100,id:s};for(let g=p;g<=h;g++)n[g]??(n[g]=[]),n[g].push(y)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,i,r){var p;const{extent:n,scale:s}=i;let o=((p=r.tileInfo)==null?void 0:p.scaleToZoom(s))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=e[o],u=V$(n.center.clone().normalize(),i.spatialReference),d=new Set;return a?a.filter(h=>{const m=h.id,y=!d.has(m)&&u&&h.extent&&U$(h.extent,u);return y&&d.add(m),y}).sort((h,m)=>m.score-h.score||h.objectId-m.objectId).map(h=>h.attribution).join(", "):""}};l([c({readOnly:!0,type:Y})],e0.prototype,"items",void 0),l([c({readOnly:!0})],e0.prototype,"state",null),l([c()],e0.prototype,"view",void 0),e0=l([$("esri.widgets.Attribution.AttributionViewModel")],e0);const Lse=e0,K={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function xy(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:TNe(t[e])}}}function ENe(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function TNe(t){return function(e,...i){ENe(e)?F4(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function Ue(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var INe=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},Ase=function(t,e){for(var i=0,r=t.length;i<r;i++){var n=t[i];Array.isArray(n)?Ase(n,e):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=INe(n)),e.push(n))}},xNe=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return Ase(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}};function b(t,e,...i){return typeof t!="function"||B2(t)?xNe(t,e,...i):t(e,...i)}function lm(...t){return t}const kg="esri-attribution",Lg={base:kg,poweredBy:`${kg}__powered-by`,sources:`${kg}__sources`,open:`${kg}--open`,sourcesOpen:`${kg}__sources--open`,link:`${kg}__link`};let ys=class extends $t{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Lse}initialize(){this.addHandles(St(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Lg.open]:this._isOpen};return b("div",{bind:this,class:this.classes(Lg.base,K.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return b("div",{class:Lg.poweredBy},"Powered by"," ",b("a",{class:Lg.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,r=i?0:void 0,{attributionText:n}=this,s={[Lg.sourcesOpen]:e,[K.interactive]:i};return b("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Lg.sources,s),innerHTML:n,tabIndex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:r,clientWidth:n,scrollWidth:s}=e,o=s>n,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(i=!0),this._isOpen){const u=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,u&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};l([c()],ys.prototype,"_isOpen",void 0),l([c()],ys.prototype,"_isInteractive",null),l([c()],ys.prototype,"_attributionTextOverflowed",void 0),l([c()],ys.prototype,"_prevSourceNodeHeight",void 0),l([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ys.prototype,"attributionText",null),l([c()],ys.prototype,"icon",null),l([c()],ys.prototype,"itemDelimiter",void 0),l([c()],ys.prototype,"label",null),l([c(),Ue("esri/widgets/Attribution/t9n/Attribution")],ys.prototype,"messages",void 0),l([c()],ys.prototype,"view",null),l([c({type:Lse})],ys.prototype,"viewModel",void 0),l([xy()],ys.prototype,"_toggleState",null),ys=l([$("esri.widgets.Attribution")],ys);const MNe=ys;function CNe(){const t=G("mapview-essential-goto-duration");return t==null?t:t}function kNe(t){var e,i;return((e=t==null?void 0:t.spatialReference)==null?void 0:e.isWebMercator)||((i=t==null?void 0:t.spatialReference)==null?void 0:i.isGeographic)||!1}const jk=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return $m(r),this.goToOverride?this.goToOverride(r,i):r.goTo(i.target,i.options)}};return l([c()],e.prototype,"goToOverride",void 0),l([c()],e.prototype,"view",void 0),e=l([$("esri.widgets.support.GoTo")],e),e};let Uf=class extends jk(q){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(N(()=>this.view,this._updateRotationWatcher,be))}destroy(){this.view=null}get canShowNorth(){return kNe(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var e,i;(e=this.view)!=null&&e.ready&&(((i=this.view)==null?void 0:i.type)==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:CNe()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this._set("orientation",{x:0,y:0,z:i})}_updateRotationWatcher(e){this.removeAllHandles(),e&&this.addHandles(e.type==="2d"?N(()=>e==null?void 0:e.rotation,this._updateForRotation,be):N(()=>e==null?void 0:e.camera,this._updateForCamera,be))}};l([c({readOnly:!0})],Uf.prototype,"canShowNorth",null),l([c({readOnly:!0})],Uf.prototype,"orientation",void 0),l([c({readOnly:!0})],Uf.prototype,"state",null),l([c()],Uf.prototype,"view",void 0),Uf=l([$("esri.widgets.Compass.CompassViewModel")],Uf);const Ose=Uf,WH="esri-compass",ZH={base:WH,iconContainer:`${WH}__icon-container`};let vd=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Ose,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,{messages:r}=this;return b("div",{class:this.classes(ZH.base,K.widget)},b("calcite-button",{class:K.widgetButton,disabled:i==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},b("div",{"aria-hidden":"true",class:ZH.iconContainer,title:r.reset},b("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};l([c()],vd.prototype,"goToOverride",null),l([c()],vd.prototype,"icon",null),l([c()],vd.prototype,"label",null),l([c(),Ue("esri/widgets/Compass/t9n/Compass")],vd.prototype,"messages",void 0),l([c()],vd.prototype,"view",null),l([c({type:Ose})],vd.prototype,"viewModel",void 0),vd=l([$("esri.widgets.Compass")],vd);const Rse=vd,JH="esri-navigation-toggle",YH={base:JH,isLayoutHorizontal:`${JH}--horizontal`};let t0=class extends q{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(Hi(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var e,i;return(e=this.view)!=null&&e.ready&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._setNavigationMode()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_setNavigationMode(){var i;const e=(i=this.view)==null?void 0:i.inputManager;e&&(e.primaryDragAction=this._navigationMode==="pan"?"pan":"rotate")}};l([c({readOnly:!0})],t0.prototype,"state",null),l([c()],t0.prototype,"_navigationMode",void 0),l([c()],t0.prototype,"view",void 0),t0=l([$("esri.widgets.NavigationToggle.NavigationToggleViewModel")],t0);const Pse=t0;let bd=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Pse,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var n;const r=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan"?this._rotateButton:this._panButton;qa(r),this.toggle()}}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var n,s;const e=((n=this.viewModel)==null?void 0:n.state)==="disabled",i=((s=this.viewModel)==null?void 0:s.navigationMode)==="pan",r=this.messages.toggle;return b("div",{class:this.classes(YH.base,K.widget,{[YH.isLayoutHorizontal]:this.layout==="horizontal"})},b("calcite-button",{afterCreate:o=>{this._panButton=o},appearance:i?"outline-fill":"solid",class:K.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?void 0:-1,title:r}),b("calcite-button",{afterCreate:o=>{this._rotateButton=o},appearance:i?"solid":"outline-fill",class:K.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?-1:void 0,title:r}))}};l([c()],bd.prototype,"icon",null),l([c()],bd.prototype,"label",null),l([c({value:"vertical"})],bd.prototype,"layout",null),l([c(),Ue("esri/widgets/NavigationToggle/t9n/NavigationToggle")],bd.prototype,"messages",void 0),l([c()],bd.prototype,"view",null),l([c({type:Pse})],bd.prototype,"viewModel",void 0),bd=l([$("esri.widgets.NavigationToggle")],bd);const LNe=bd;let jf=class extends q{get canZoomIn(){var r,n,s;if(!((r=this.view)==null?void 0:r.ready))return!1;const i=(s=(n=this.view)==null?void 0:n.constraints)==null?void 0:s.effectiveMaxScale;return i===0||this._scale>i}get canZoomOut(){var n;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const r=(n=e.constraints)==null?void 0:n.effectiveMinScale;return r===0||this._scale<r}get _scale(){var i,r,n;const e=(r=(i=this.view)==null?void 0:i.animation)==null?void 0:r.target;return(e&&"then"in e||e==null?void 0:e.scale)??((n=this.view)==null?void 0:n.scale)??0}};l([c({readOnly:!0})],jf.prototype,"canZoomIn",null),l([c({readOnly:!0})],jf.prototype,"canZoomOut",null),l([c()],jf.prototype,"view",void 0),l([c()],jf.prototype,"_scale",null),jf=l([$("esri.widgets.Zoom.ZoomConditions2D")],jf);const ANe=jf;let i0=class extends q{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};l([c({readOnly:!0})],i0.prototype,"canZoomIn",null),l([c({readOnly:!0})],i0.prototype,"canZoomOut",null),l([c()],i0.prototype,"view",void 0),i0=l([$("esri.widgets.Zoom.ZoomConditions3D")],i0);const ONe=i0;let bh=class extends q{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new ANe({view:e}):e.type==="3d"&&(this._zoomConditions=new ONe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():zo(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():zo(e.goTo({zoomFactor:.5}))}};l([c()],bh.prototype,"_zoomConditions",void 0),l([c()],bh.prototype,"canZoomIn",null),l([c()],bh.prototype,"canZoomOut",null),l([c({readOnly:!0})],bh.prototype,"state",null),l([c()],bh.prototype,"view",null),bh=l([$("esri.widgets.Zoom.ZoomViewModel")],bh);const Fse=bh,KH={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let _d=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Fse,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[KH.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:r}=this.viewModel,{zoomIn:n,zoomOut:s}=this.messages;return b("div",{class:this.classes(KH.base,K.widget,e)},b("calcite-button",{class:K.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),b("calcite-button",{class:K.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};l([c()],_d.prototype,"icon",null),l([c()],_d.prototype,"label",null),l([c({value:"vertical"})],_d.prototype,"layout",null),l([c(),Ue("esri/widgets/Zoom/t9n/Zoom")],_d.prototype,"messages",void 0),l([c()],_d.prototype,"view",null),l([c({type:Fse})],_d.prototype,"viewModel",void 0),_d=l([$("esri.widgets.Zoom")],_d);const RNe=_d;function PNe(t){return(t==null?void 0:t.view)!==void 0}let sM=class extends eFe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(r=>{const n=this._find(r),s=n==null?void 0:n.widget;PNe(s)&&(s.view=i)})},this._componentsWatcher=(i,r)=>{this._removeComponents(r),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([N(()=>this.components,this._componentsWatcher,be),N(()=>this.view,this._updateViewAwareWidgets,be)])}_add(e,i,r,n,s){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,i,r,n,s)}_removeComponents(e){e.forEach(i=>{const r=this._find(i);r&&(this.remove(r),r.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(e){this.constructed&&e.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(e){const i=this._createWidget(e);return new nM({id:e,node:i})}_createWidget(e){const i=this.view;switch(e){case"attribution":return new MNe({view:i});case"compass":return new Rse({view:i});case"navigation-toggle":return new LNe({view:i});case"zoom":return new RNe({view:i})}}};l([c()],sM.prototype,"components",void 0),sM=l([$("esri.views.ui.DefaultUI")],sM);const Nse=sM;let oM=class extends Nse{constructor(e){super(e),this.components=["attribution","zoom"]}};l([c()],oM.prototype,"components",void 0),oM=l([$("esri.views.ui.2d.DefaultUI2D")],oM);const Dse=oM;let Vse,Use,jse,Gse,zse,Bse,Hse;async function FNe(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:r,MagnifierView2D:n,GridView2D:s,Stage:o}]=await Promise.all([k(()=>import("./webglDeps-Cx2-yDpC.js"),__vite__mapDeps([162,84,83,131,163,137])),k(()=>import("./mapViewDeps-Cg6sVZZq.js"),__vite__mapDeps([164,88,165,86,87,26,89,90,85,91,92,55,83,84,82,60,137,97,166,163,103,167,125,124,96,24,25,27,168,116,94,95,123,162,131,169,100,170,81,43,41,29,40,171,134,132,139,172,173,71,174,98,93,175,176,177,178,179,180,135,181]))]);Use=t,jse=e,Gse=i,zse=r,Bse=n,Hse=s,Vse=o}let Ie=class extends wCe(qke(Oke(RLe))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new JS({getCollections:()=>{var i,r;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new tM({view:this}),this.graphicsView=null,this.stateManager=new Hn({constraints:new hne({view:this})}),this.stationaryManager=new U1,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new wRe(this),this.floors=new Y,this.grid=null,this.highlights=zne(),this.inputManager=new LPe({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new ese,this.type="2d",this.view2dType=null,this.ui=new Dse,this.test={takeScreenshot:async i=>N3e(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([N(()=>this.viewpoint,()=>this.stationaryManager.flip(),yn),this.on("resize",i=>this.stateManager.resize(i.width,i.height))]),EIe()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=xe(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new VPe(this.featuresTilingScheme)}get constraintsInfo(){var r,n;const e=(r=this.defaultsFromMap)==null?void 0:r.tileInfo,i=this.spatialReference;return{lods:(n=e==null?void 0:e.spatialReference)!=null&&n.equals(i)?e.lods:null,spatialReference:i}}get state(){return this.stateManager.state}get initialExtentRequired(){var a;if(!this.stateManager)return!1;const{scale:e,constraints:i,center:r,viewpoint:n,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((a=this.map.initialViewProperties)!=null&&a.viewpoint))&&!s&&(i!=null&&i.effectiveLODs||(o=-1),(!r||e===0&&o===-1)&&((n==null?void 0:n.targetGeometry)==null||n.targetGeometry.type!=="extent"&&!n.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=e.targetGeometry,r=this.spatialReference;return HX(i.spatialReference,r)}set animation(e){const i=this._get("animation");if(e===i)return;if(i&&i.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e);const r=()=>{var n;this.destroyed||e===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame())};e.when(r,r)}get background(){return Yx(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get constraints(){var e;return(e=this.stateManager)==null?void 0:e.constraints}set constraints(e){e.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=e,i==null||i.destroy()}get extent(){var e;return((e=this.stateManager)==null?void 0:e.extent)??null}set extent(e){this.stateManager.extent=e}get highlightOptions(){return w3e(this)}set highlightOptions(e){S3e(this,e)}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=i}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get tileInfo(){var e;return(e=this.featuresTilingScheme)==null?void 0:e.tileInfo}get updating(){var r,n,s,o;const e=!(!this.magnifier.visible||this.magnifier.position===null||!((r=this._magnifierView)!=null&&r.updatingHandles.updating)),i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(a=>!a.destroyed&&!("layerViews"in a)&&a.updating===!0)||e);if(G("esri-2d-log-updating")){const a=this.allLayerViews.reduce((u,d)=>({...u,[`${d.layer.id}(${d.layer.type})`]:!d.destroyed&&!("layerViews"in d)&&d.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(n=this.layerViewManager)==null?void 0:n.updating}
-> labelManager.updating: ${(s=this.labelManager)==null?void 0:s.updating}
-> graphicsView.updating: ${(o=this.graphicsView)==null?void 0:o.updating}
-> allLayerViews: ${JSON.stringify(a)}
-> updatingMagnifier: ${e}
`)}return i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new os({rings:[e.map(i=>[i[0],i[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}goTo(e,i){return this.goToManager.goTo(e,i)}async hitTest(e,i){return $3e(this,e,i)}async takeScreenshot(e){return F3e(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const i=ure(e)?lre(this,e):e;return this.stateManager.toMap(i)}toScreen(e,i){return this.stateManager.toScreen(e,i)}on(e,i,r,n){return this.inputManager&&this.viewEvents.on(e,i,r,n)||super.on(e,i)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e;return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||((e=this.defaultsFromMap)==null?void 0:e.spatialReference)||null}getDefaultTimeZone(){return Yx(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Yx(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return A9.hasLayerViewModule(e)}importLayerView(e){return A9.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(U.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var d;const i=this.toMap(e),r=await this.hitTest(e),n=this.allLayerViews.toArray().filter(p=>p.clips.every(h=>jne(this,h,e,i))).reverse(),s=new globalThis.Map(n.map(p=>[p.layer.uid,p])),o=[];let a=0,u=0;for(;a<r.results.length||u<n.length;){const p=r.results.at(a);if(p&&p.type!=="graphic"){++a;continue}const h=s.get((d=(p==null?void 0:p.layer)??(p==null?void 0:p.graphic.layer))==null?void 0:d.uid);if((!p||h)&&u<n.length&&n.at(u)!==h){const m=n.at(u);"fetchPopupFeaturesAtLocation"in m&&o.push({mapPoint:i,layerView:m}),++u}else p&&(o.push({graphic:p.graphic,layerView:h}),++a)}return{hits:o,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=q3e(this.type);if(G("safari")&&G("safari")<9&&(e=new L("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:G("safari")})),e!=null)throw U.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return FNe()}_getDefaultViewpoint(){var _;const{constraints:e,initialExtent:i,map:r,padding:n,size:s}=this;if(!e)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),u=o==null?void 0:o.viewpoint,d=((_=u==null?void 0:u.targetGeometry)==null?void 0:_.extent)??i,p=d==null?void 0:d.center,h=(u==null?void 0:u.rotation)??0,m=(u==null?void 0:u.scale)||d&&Nk(d,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),y=a.center??p,g=a.rotation??h,v=a.scale??m;return y&&v?new Ar({targetGeometry:y,scale:v,rotation:g}):null}_startup(){var a;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(a=this.defaultsFromMap.extent)==null?void 0:a.center),this.graphics.owner=this;const i=new Vse(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=i,this._magnifierView=new Bse,this._magnifierView.magnifier=this.magnifier,this._gridView=new Hse;const r=new Gse({view:this});this._set("labelManager",r);const n=new pRe({view:this});this._set("animationManager",n);const s=new zse({view:this,animationManager:n});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",u=>this.fatalError=u.error),N(()=>this.stationary,u=>i.stationary=u,gt),N(()=>this.background,u=>{i.backgroundColor=u==null?void 0:u.color,this._magnifierView.backgroundColor=u==null?void 0:u.color},gt),N(()=>this.magnifier,u=>this._magnifierView.magnifier=u,gt),N(()=>this.grid,u=>this._gridView.grid=u,gt),N(()=>this.renderingOptions,u=>i.renderingOptions=u,gt),N(()=>this.highlights.items.map(u=>({name:u.name,options:{fillColor:u.options.color,haloColor:u.options.haloColor,fillOpacity:u.options.fillOpacity,haloOpacity:u.options.haloOpacity,haloWidth:u.options.haloWidth,haloBlur:u.options.haloBlur}})),()=>{i.highlightGradient=b3e(i.highlightGradient,this.highlights.items)},gt),N(()=>this.state.id,()=>i.state=this.state,gt)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this.stage.addChild(i.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new CRe(bCe.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new Use({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new jse(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var o;const{allLayerViews:i,padding:r,size:n,stage:s}=this;return{allLayerViews:i,backgroundColor:e!=null&&e.ignoreBackground?null:(o=this.background)==null?void 0:o.color,padding:r,size:n,stage:s}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Ie.type="2d",l([c({readOnly:!0})],Ie.prototype,"animationManager",void 0),l([c({constructOnly:!0})],Ie.prototype,"deactivatedWebGLExtensions",void 0),l([c({constructOnly:!0})],Ie.prototype,"debugWebGLExtensions",void 0),l([c({readOnly:!0})],Ie.prototype,"featuresTilingScheme",void 0),l([c({readOnly:!0})],Ie.prototype,"fullOpacity",void 0),l([c()],Ie.prototype,"goToManager",void 0),l([c({readOnly:!0})],Ie.prototype,"graphicsTileStore",null),l([c()],Ie.prototype,"graphicsView",void 0),l([c()],Ie.prototype,"stateManager",void 0),l([c()],Ie.prototype,"constraintsInfo",null),l([c({readOnly:!0})],Ie.prototype,"state",null),l([c()],Ie.prototype,"initialExtentRequired",null),l([c()],Ie.prototype,"labelManager",void 0),l([c({readOnly:!0})],Ie.prototype,"mapViewNavigation",void 0),l([c({constructOnly:!0})],Ie.prototype,"renderCanvas",void 0),l([c()],Ie.prototype,"renderingOptions",void 0),l([c({constructOnly:!0})],Ie.prototype,"supersampleScreenshotsEnabled",void 0),l([c({readOnly:!0})],Ie.prototype,"supportsGround",void 0),l([c()],Ie.prototype,"defaultsFromMapSettings",null),l([c({readOnly:!0})],Ie.prototype,"typeSpecificPreconditionsReady",null),l([c()],Ie.prototype,"animation",null),l([c({type:lk})],Ie.prototype,"background",null),l([c()],Ie.prototype,"center",null),l([c({type:hne})],Ie.prototype,"constraints",null),l([c()],Ie.prototype,"extent",null),l([c()],Ie.prototype,"floors",void 0),l([c()],Ie.prototype,"grid",void 0),l([c({type:Zy})],Ie.prototype,"highlightOptions",null),l([c({type:Y.ofType(M0)})],Ie.prototype,"highlights",void 0),l([c({readOnly:!0})],Ie.prototype,"inputManager",void 0),l([c()],Ie.prototype,"map",void 0),l([c()],Ie.prototype,"padding",null),l([c({readOnly:!0})],Ie.prototype,"rendering",null),l([c()],Ie.prototype,"resizeAlign",null),l([c({readOnly:!0})],Ie.prototype,"resolution",null),l([c()],Ie.prototype,"rotation",null),l([c()],Ie.prototype,"scale",null),l([c({constructOnly:!0})],Ie.prototype,"spatialReferenceLocked",void 0),l([c()],Ie.prototype,"stationary",null),l([c({readOnly:!0})],Ie.prototype,"tileInfo",null),l([c({type:ese,readOnly:!0})],Ie.prototype,"timeline",void 0),l([c({readOnly:!0})],Ie.prototype,"type",void 0),l([c({readOnly:!0})],Ie.prototype,"updating",null),l([c({readOnly:!0})],Ie.prototype,"view2dType",void 0),l([c()],Ie.prototype,"viewpoint",null),l([c({readOnly:!0})],Ie.prototype,"visibleArea",null),l([c()],Ie.prototype,"zoom",null),l([c({readOnly:!0})],Ie.prototype,"navigating",null),l([c(),We(t=>t instanceof Nse?t:r_(Dse,t))],Ie.prototype,"ui",void 0),Ie=l([$("esri.views.View2D")],Ie);const NNe=Ie;let aM=class extends NNe{constructor(e){super(e),this.view2dType="map"}};l([c({readOnly:!0})],aM.prototype,"view2dType",void 0),aM=l([$("esri.views.MapView")],aM);const DNe=aM;let Fl=class extends q{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,i;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.isSecureUrl?this.editedBookmark.thumbnail.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,i;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.isDataURI?this.editedBookmark.thumbnail.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,i,r,n;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.url?(n=(r=this.editedBookmark)==null?void 0:r.thumbnail)!=null&&n.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};l([c()],Fl.prototype,"bookmark",void 0),l([c({readOnly:!0})],Fl.prototype,"editedBookmark",null),l([c()],Fl.prototype,"customUrl",null),l([c()],Fl.prototype,"screenshotUrl",null),l([c()],Fl.prototype,"state",null),l([c()],Fl.prototype,"thumbnailState",null),l([c()],Fl.prototype,"validationState",void 0),l([c()],Fl.prototype,"loading",void 0),Fl=l([$("esri.widgets.Bookmarks.BookmarksUserState")],Fl);const GN=Fl,qse=Y.ofType(v5),VNe={width:128,height:128,format:"png"},rI={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},XH={time:!0};let Nl=class extends jk(ji.EventedAccessor){constructor(e){super(e),this.capabilities={...XH},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castCapabilities(e){return{...XH,...e}}get bookmarks(){var e,i;return((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.bookmarks)??new qse}set bookmarks(e){this._overrideIfSome("bookmarks",e)}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...rI,...e})}get defaultCreateOptions(){return rI}set defaultEditOptions(e){this._set("defaultEditOptions",{...rI,...e})}get defaultEditOptions(){return rI}get state(){const{view:e}=this;return e&&!e.ready?"loading":"ready"}async createBookmark(e){const{view:i,defaultCreateOptions:r,capabilities:n}=this;if(!i)throw new L("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:o,captureViewpoint:a,captureRotation:u,captureScale:d,captureTimeExtent:p}={...r,...e},h=s?await this._createThumbnail(o):void 0,m=n.time&&p&&i.timeExtent!=null?i.timeExtent.clone():void 0;return new v5({...h&&{thumbnail:h},...p&&{timeExtent:m},...a&&{viewpoint:this._createViewpoint({view:i,captureScale:d,captureRotation:u})}})}async editBookmark(e,i){if(!e)return e;const{view:r,defaultEditOptions:n}=this;if(!r)throw new L("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:o,captureViewpoint:a,captureRotation:u,captureScale:d,captureTimeExtent:p}={...n,...i},h=s?await this._createThumbnail(o):void 0;return h&&(e.thumbnail=h),a&&(e.viewpoint=this._createViewpoint({view:r,captureScale:d,captureRotation:u})),p&&r.timeExtent!=null&&(e.timeExtent=r.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{capabilities:i,view:r}=this;if(!r)throw new L("go-to:invalid-view","Cannot go to a bookmark without a view");const n=e==null?void 0:e.viewpoint;if(!n)throw new L("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});this._set("activeBookmark",e);const s={target:n},o=this.callGoTo(s),a=e==null?void 0:e.timeExtent;return i.time&&a&&(r.timeExtent=a),this.emit("bookmark-select",{bookmark:e}),o.catch(()=>{}).then(()=>this._set("activeBookmark",null)),o}async _createThumbnail(e){const{view:i}=this;if(!i)throw new L("bookmark:invalid-view","Cannot create slide thumbnail without a view");const r=await i.takeScreenshot({...VNe,...e});return new jo({url:r.dataUrl})}_createViewpoint({view:e,captureRotation:i,captureScale:r}){var s,o;const n=(s=e.viewpoint)==null?void 0:s.clone();return new Ar({targetGeometry:(o=e.extent)==null?void 0:o.clone(),rotation:(i?n==null?void 0:n.rotation:null)??0,scale:(r?n==null?void 0:n.scale:null)??0})}};l([c()],Nl.prototype,"capabilities",void 0),l([We("capabilities")],Nl.prototype,"castCapabilities",null),l([c({readOnly:!0})],Nl.prototype,"activeBookmark",void 0),l([c({type:qse})],Nl.prototype,"bookmarks",null),l([c()],Nl.prototype,"defaultCreateOptions",null),l([c()],Nl.prototype,"defaultEditOptions",null),l([c({readOnly:!0})],Nl.prototype,"state",null),l([c()],Nl.prototype,"view",void 0),Nl=l([$("esri.widgets.Bookmarks.BookmarksViewModel")],Nl);const Wse=Nl;let Mo=class extends q{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}get addBookmark(){return Ga(U.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton}set addBookmark(e){Ga(U.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton=e}};l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"addBookmark",null),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"addBookmarkButton",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"closeButton",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"collapseButton",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"editBookmarkButton",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"filter",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"flow",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"heading",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"thumbnail",void 0),l([c({type:Boolean,nonNullable:!0})],Mo.prototype,"time",void 0),Mo=l([$("esri.widgets.Bookmarks.BookmarksVisibleElements")],Mo);const zN=Mo,Ss="esri-bookmarks",HA=`${Ss}__authoring`,qA=`${Ss}__bookmark`,sr={base:Ss,noBookmarksHeader:`${Ss}__no-bookmarks-heading`,noBookmarksDescription:`${Ss}__no-bookmarks-description`,form:`${Ss}__form`,list:`${Ss}__list`,loader:`${Ss}__loader`,filterNoResults:`${Ss}__filter-no-results`,formContent:`${Ss}__form-content`,addBookmarkButton:`${Ss}__add-bookmark-button`,editBookmarkInput:`${Ss}__edit-bookmark-input`,addBookmarkInput:`${Ss}__add-bookmark-input`,dragEnabled:`${Ss}--drag-enabled`,bookmarkImage:`${Ss}__image`,bookmarkImageContainer:`${qA}-image-container`,bookmarkContent:`${qA}-content`,bookmarkContentLabel:`${qA}-content-label`,authoring:HA,authoringImageContainer:`${HA}-image-container`,authoringRefreshThumbnailButton:`${HA}-refresh-thumbnail-button`};function Ya({level:t,class:e,...i},r){const n=Zse(t);return b(`h${n}`,{...i,"aria-level":String(n),class:nu(K.heading,e),role:"heading"},r)}function Zse(t){return fr(Math.ceil(t),1,6)}function tb(t,e=1){return Zse(t+e)}const Jse=["label","description","metadata"];function km(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,r=Array.isArray(t)?t:UNe(t);i.push(...r)}}function UNe(t){return t.split(",").map(e=>e.trim())}let ei=class extends vu($t){constructor(e,i){super(e,i),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new Wse,this.visibleElements=new zN,this._onCalciteListOrderChange=r=>{const{_lastDragDetail:n,bookmarks:s}=this,{toEl:o,fromEl:a,dragEl:u,newIndex:d}=r;if(!s.length||!a||!o||(n==null?void 0:n.newIndex)===d&&(n==null?void 0:n.dragEl)===u&&(n==null?void 0:n.toEl)===o&&(n==null?void 0:n.fromEl)===a)return;this._lastDragDetail=r;const p=Array.from(a.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);s.sort((h,m)=>{const y=p.indexOf(h.uid),g=p.indexOf(m.uid);return y>g?1:y<g?-1:0})}}normalizeCtorArgs(e){return(e==null?void 0:e.editingEnabled)!=null&&e.visibleElements!=null?{...e,visibleElements:new zN({...e.visibleElements,addBookmarkButton:e.editingEnabled,editBookmarkButton:e.editingEnabled})}:e}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),"chip-group":()=>k(()=>import("./calcite-chip-group-zGCgRG2Y.js"),__vite__mapDeps([249,235,236,239])),chip:()=>k(()=>import("./calcite-chip-DfTljyqc.js"),__vite__mapDeps([250,251,235,239,243,240,241,242,236,238,244])),fab:()=>k(()=>import("./calcite-fab-p72cyu3Z.js"),__vite__mapDeps([252,235,236,239,233,234,237,238,240,241,242,243,244,245])),flow:()=>k(()=>import("./calcite-flow-pVqs_qJ1.js"),__vite__mapDeps([253,242,239])),"flow-item":()=>k(()=>import("./calcite-flow-item-Dp3v--sg.js"),__vite__mapDeps([254,235,236,239,240,241,242,243,255,256,257,248,238,244,245,258,259,260,261,262,263,264,265])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),input:()=>k(()=>import("./calcite-input-Dp8TE27V.js"),__vite__mapDeps([266,267,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),"input-message":()=>k(()=>import("./calcite-input-message-DSO14iRF.js"),__vite__mapDeps([272,270,235,244,242])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242])),notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244])),scrim:()=>k(()=>import("./calcite-scrim-BZKfzama.js"),__vite__mapDeps([283,265,240,235,241,242,243,245])),switch:()=>k(()=>import("./calcite-switch-CIQH1lYU.js"),__vite__mapDeps([284,235,234,236,241,237,238,239])),table:()=>k(()=>import("./calcite-table-P_rK2SuP.js"),__vite__mapDeps([285,239,243,240,235,241,242,233,234,236,237,238,244,245,251])),"table-cell":()=>k(()=>import("./calcite-table-cell-CgfU6GWf.js"),__vite__mapDeps([286,287,239,243,240,235,241,242,236])),"table-header":()=>k(()=>import("./calcite-table-header-B4ldu6J4.js"),__vite__mapDeps([288,289,239,243,240,235,241,242,238,244])),"table-row":()=>k(()=>import("./calcite-table-row-CqQ6Olw-.js"),__vite__mapDeps([290,235,241,236,238,244,242,287,239,243,240,289]))})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(e){this.viewModel.defaultEditOptions=e}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(e){this.viewModel.bookmarks=e}get editingEnabled(){return Ga(U.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled&&this.visibleElements.editBookmarkButton&&this.visibleElements.addBookmarkButton}set editingEnabled(e){Ga(U.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.visibleElements.editBookmarkButton=e,this.visibleElements.addBookmarkButton=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"bookmark"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){return b("div",{class:this.classes(sr.base,K.widget,K.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new GN({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(e){const{messages:i,viewModel:{state:r}}=this;return e.length||r==="loading"?null:b("div",{class:K.empty,key:"no-bookmarks"},b("calcite-icon",{icon:"bookmark",scale:"l"}),b(Ya,{class:this.classes(K.heading,sr.noBookmarksHeader),level:this.headingLevel},i==null?void 0:i.noBookmarksHeading),b("p",{class:sr.noBookmarksDescription},i.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:e}=this,i=e==null?void 0:e.editedBookmark;return i&&(e==null?void 0:e.state)==="edit"?this._renderEditingBookmark(i):[]}_renderBookmarkItems(e){return e?e.toArray().map(i=>this._renderBookmark(i)):[]}_handleCalciteListDragEnd(e){const{fromEl:i,dragEl:r,oldIndex:n}=e;i.insertBefore(r,i.children[n])}_renderBookmarksContainer(){const{viewModel:{state:e,bookmarks:i},dragEnabled:r,messages:n,disabled:s,filterPlaceholder:o,filterText:a,visible:u,headingLevel:d,visibleElements:{closeButton:p,collapseButton:h,filter:m,heading:y,flow:g},uid:v}=this,_=i.filter(ot),w=_.length?b("calcite-list",{class:sr.list,dragEnabled:r,filterEnabled:m,filterPlaceholder:o,filterProps:Jse,filterText:a,group:`bookmarks-${v}`,key:"bookmark-list",label:n.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:E=>this._handleCalciteListDragEnd(E.detail),onCalciteListFilter:E=>{var T;return this.filterText=((T=E.target)==null?void 0:T.filterText)??""},onCalciteListOrderChange:E=>this._onCalciteListOrderChange(E.detail)},this._renderBookmarkItems(_),m?b("div",{class:sr.filterNoResults,slot:"filter-no-results"},b("calcite-notice",{kind:"info",open:!0,width:"full"},b("div",{slot:"message"},n.noBookmarksHeading),";")):null):null,S=[b("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:p,closed:!u,collapsible:h,disabled:s,heading:y?n.widgetLabel:void 0,headingLevel:d,loading:e==="loading",onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(_),w,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return u?g?b("calcite-flow",{key:"root-flow"},S):S:null}_renderAddBookmarkButton(){const{messages:e,_userState:i,disabled:r,viewModel:{view:n,state:s},visibleElements:{addBookmarkButton:o}}=this,a=(i==null?void 0:i.loading)??!1;return n&&s!=="loading"&&o?b("calcite-fab",{appearance:"outline-fill",bind:this,class:sr.addBookmarkButton,disabled:r||a,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:a,onclick:this.startAddBookmark,slot:"fab",text:e.addBookmark,textEnabled:!0,title:e.addBookmark,type:"button"}):null}_renderEditContainer(e){const{messagesCommon:i,visibleElements:{editBookmarkButton:r}}=this,n=`${i.edit} ${this._getBookmarkTitle(e)}`;return r?b("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(e),slot:"actions-end",text:n,title:n}):null}_renderBookmarkImage(e,i){var r;return i?b("img",{alt:"",class:sr.bookmarkImage,key:"bookmark-image",src:(r=e.thumbnail)==null?void 0:r.url}):null}_renderBookmarkTimeSwitch(e){const{messages:i,viewModel:{view:r}}=this,{timeExtent:n}=e;return(r==null?void 0:r.timeExtent)??n?b("calcite-label",{layout:"inline-space-between"},i.includeTimeExtent,b("calcite-switch",{checked:!!n,onCalciteSwitchChange:s=>{this._editIncludeTimeExtent=!!s.target.checked}})):null}_renderEditBookmarkTimeExtent(e){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(e):null}_getTimeExtentStrings(e){const{visibleElements:i}=this,{timeExtent:r}=e;if(!r)return{};const{start:n,end:s}=r,o=s!=null&&(n==null||n.getTime()!==s.getTime()),a=n?this._formatDate(n):"",u=n&&i.time?this._formatTime(n):"";return o?{startDate:a,startTime:u,endDate:this._formatDate(s),endTime:i.time?this._formatTime(s):""}:{startDate:a,startTime:u}}_renderTimeExtentDescription(e){const{startDate:i,startTime:r,endDate:n,endTime:s}=this._getTimeExtentStrings(e);if(!i)return"";const o=`${i} ${r}`;return n?`${o} - ${`${n} ${s}`}`:o}_renderBookmarkTimeExtent(e,i=!1){const{messages:r}=this,{startDate:n,startTime:s,endDate:o,endTime:a}=this._getTimeExtentStrings(e),u=i?null:b("calcite-table-row",{slot:"table-header"},b("calcite-table-header",{heading:r.startDate}),o?b("calcite-table-header",{heading:r.endDate}):null);return n?b("calcite-table",{caption:r.timeExtent,scale:"s"},u,b("calcite-table-row",null,b("calcite-table-cell",null,n," ",s?[b("br",null),s]:null),o?b("calcite-table-cell",null,o,a?[b("br",null),a]:null):null)):null}_renderBookmarkActiveScrim(e,i){return this.viewModel.activeBookmark===e&&i?b("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(e,i){return this.viewModel.activeBookmark!==e||i?null:b("calcite-loader",{class:sr.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(e,i){return this.viewModel.activeBookmark===e||i?null:b("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(e){var r;const i=this.visibleElements.thumbnail&&!!((r=e.thumbnail)!=null&&r.url);return b("div",{class:sr.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(e,i),this._renderBookmarkImage(e,i),this._renderBookmarkActiveLoader(e,i),this._renderBookmarkImageIcon(e,i))}_focusSelectedDragEl(e,i){this._selectedDragBookmarkUid===i.uid&&qa(e)}_handleCalciteListItemDragHandleChange(e,i){e.stopPropagation();const r=e.target.dragSelected;this._selectedDragBookmarkUid=r?i.uid:null}_renderBookmark(e){return b("calcite-list-item",{afterCreate:i=>this._focusSelectedDragEl(i,e),afterUpdate:i=>this._focusSelectedDragEl(i,e),class:this.classes({[sr.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(e),dragSelected:e.uid===this._selectedDragBookmarkUid,key:e.uid,label:this._getBookmarkTitle(e),value:e.uid,onCalciteListItemDragHandleChange:i=>this._handleCalciteListItemDragHandleChange(i,e),onCalciteListItemSelect:()=>this._goToBookmark(e)},this._renderBookmarkThumbnail(e),this._renderBookmarkContent(e),this._renderEditContainer(e))}_renderBookmarkContent(e){return b("div",{class:sr.bookmarkContent,slot:"content"},b("span",{class:sr.bookmarkContentLabel},this._getBookmarkTitle(e)),this._renderBookmarkTimeExtent(e,!0))}_renderEditingBookmarkName(e){const{messages:i,_userState:r}=this,n=(r==null?void 0:r.validationState)==="name-required";return b("calcite-label",null,i.title,b("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:sr.editBookmarkInput,name:"bookmark-name",placeholder:i.titlePlaceholder,required:!0,type:"text",value:e.name}),n?b("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:e,_userState:i}=this,r=i==null?void 0:i.bookmark;return[b("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(r),slot:"footer",type:"button",width:"full"},e.delete),b("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},e.cancel),b("calcite-button",{slot:"footer",type:"submit",width:"full"},e.save)]}_handleUrlEditInputChange(){var s,o;const{_userState:e,_urlEditInputNode:i}=this,r=i==null?void 0:i.value;if(!(e!=null&&e.editedBookmark)||!r)return;e.validationState=void 0,(s=e.editedBookmark.thumbnail)!=null&&s.isDataURI&&(e.screenshotUrl=(o=e.editedBookmark.thumbnail)==null?void 0:o.url);const n=new jo({url:r});n.isSecureUrl&&(e.customUrl=r,e.editedBookmark.thumbnail=n)}_renderEditingTimeExtent(e){const{capabilities:i,view:r}=this.viewModel,{timeExtent:n}=e;return i.time&&((r==null?void 0:r.timeExtent)??n)?b("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(e),this._renderEditBookmarkTimeExtent(e)):null}_renderEditingBookmarkImage(e){var s,o;const{_userState:i}=this,r=i==null?void 0:i.thumbnailState,n=(s=e.thumbnail)!=null&&s.isSecureUrl?r==="url":(o=e.thumbnail)!=null&&o.isDataURI?r==="screenshot":null;if(n)return this._renderBookmarkImage(e,n)}_renderEditingThumbnail(e){const{_userState:i,visibleElements:r}=this,n=i==null?void 0:i.thumbnailState;return r.thumbnail&&n!=="none"?b("div",{class:sr.authoringImageContainer},this._renderEditingBookmarkImage(e)):null}_renderUpdateThumbnailButton(){const{visibleElements:e,messages:i,_userState:r}=this,n=r==null?void 0:r.thumbnailState;return e.thumbnail&&n==="screenshot"?b("calcite-button",{appearance:"outline",class:sr.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"half"},i.updateThumbnail):null}_renderEditingBookmarkUrlInput(e){var u,d;const{messages:i,_userState:r}=this,n=(u=e.thumbnail)==null?void 0:u.url,s=(d=e.thumbnail)!=null&&d.isSecureUrl?n:void 0,o=n&&(r==null?void 0:r.validationState)==="absolute-url-required";return(r==null?void 0:r.thumbnailState)==="url"?b("calcite-label",{key:"thumbnail-url-input"},b("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:"https://.*",placeholder:i?`https://<${i.imageUrlPlaceholder}>`:void 0,required:!0,title:i.imageUrlTooltip,type:"text",value:s,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),o?b("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:e,messages:i,_userState:r}=this,n=r==null?void 0:r.thumbnailState;return e.thumbnail?b("calcite-label",{key:"thumbnail-chip-group"},i.thumbnail,b("calcite-chip-group",{label:i.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:s=>this._handleThumbnailTypeSelect(s.target.selectedItems[0].value)},b("calcite-chip",{selected:n==="screenshot",value:"screenshot"},i.screenshot),b("calcite-chip",{selected:n==="url",value:"url"},i.url),b("calcite-chip",{selected:n==="none",value:"none"},i.none))):null}_renderEditingBookmark(e){const{disabled:i,messagesCommon:r,headingLevel:n}=this;return e?b("form",{bind:this,class:sr.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},b("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:i,heading:r.edit,headingLevel:n,key:"edit-bookmark-form",onCalciteFlowItemBack:s=>{s.preventDefault(),this._closeEditBookmarkForm()}},b("div",{class:sr.formContent},b("div",{class:sr.authoring},this._renderEditingBookmarkName(e),this._renderThumbnailSelector(),this._renderEditingThumbnail(e),this._renderEditingBookmarkUrlInput(e),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(e))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:e,messages:i}=this,r=(e==null?void 0:e.validationState)==="name-required";return b("calcite-label",null,i.title,b("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:sr.addBookmarkInput,name:"bookmark-name",placeholder:i.titlePlaceholder,required:!0,type:"text",value:""}),r?b("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:e}=this;return[b("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"half"},e.cancel),b("calcite-button",{slot:"footer",type:"submit",width:"half"},e.add)]}_renderAddingBookmark(){const{disabled:e,messages:i,headingLevel:r,_userState:n}=this;return(n==null?void 0:n.state)==="add"?b("form",{bind:this,class:sr.form,disabled:e,onsubmit:this._addBookmarkSubmitClick},b("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:e,heading:i.addBookmark,headingLevel:r,key:"add-bookmark-form",onCalciteFlowItemBack:s=>{s.preventDefault(),this._endAddBookmark()}},b("div",{class:sr.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(e){return(e==null?void 0:e.name)||this.messagesCommon.untitled}_formatDate(e){var i;return e?hr(e,{...Ms("short-date"),timeZone:((i=this.viewModel.view)==null?void 0:i.timeZone)??Os}):""}_formatTime(e){var i;return e?hr(e,{...Ms("long-time"),timeZone:((i=this.viewModel.view)==null?void 0:i.timeZone)??Os}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(e){e&&(this._editIncludeTimeExtent=!!e.timeExtent,this._userState=new GN({bookmark:e,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(e))}async _createNewScreenshotUrl(){var i;return((i=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:i.url)??null}_storeCurrentUrl(){var r,n,s,o,a,u;const{_userState:e}=this,i=(n=(r=e==null?void 0:e.editedBookmark)==null?void 0:r.thumbnail)==null?void 0:n.url;i&&((o=(s=e==null?void 0:e.editedBookmark)==null?void 0:s.thumbnail)!=null&&o.isSecureUrl?e.customUrl=i:(u=(a=e==null?void 0:e.editedBookmark)==null?void 0:a.thumbnail)!=null&&u.isDataURI&&(e.screenshotUrl=i))}async _handleThumbnailTypeSelect(e){const{_userState:i}=this;if(!i)return;const{screenshotUrl:r,customUrl:n,editedBookmark:s}=i,o=e==="screenshot"?r??await this._createNewScreenshotUrl():e==="url"&&n?n:null;this._storeCurrentUrl(),s&&o&&(s.thumbnail=new jo({url:o})),i.validationState=void 0,i.thumbnailState=e}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(e){e.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:e,_userState:i,viewModel:r,viewModel:{bookmarks:n}}=this;if(!i)return;const s=e?e.value.trim():null;if(!s)return void(i.validationState="name-required");i.loading=!0;const o=await r.createBookmark();o.name=s,n.add(o),this._endAddBookmark()}async _editBookmarkAndClose(e,i){const{viewModel:r,viewModel:{defaultEditOptions:n}}=this;await r.editBookmark(e,{...n,...i}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:i,_userState:r,_editIncludeTimeExtent:n,_urlEditInputNode:s}=this;if(!(r!=null&&r.bookmark)||!r.editedBookmark)return;r.validationState=void 0,r.customUrl=void 0,r.screenshotUrl=void 0;const o=i==null?void 0:i.value.trim();if(!o)return void(r.validationState="name-required");r.bookmark.name=o,r.bookmark.thumbnail=r.editedBookmark.thumbnail,n||(r.bookmark.timeExtent=null);const a=r.thumbnailState;if(a==="url"&&s){const u=s.value,d=new jo({url:u});if(!d.isSecureUrl)return void(r.validationState="absolute-url-required");r.bookmark.thumbnail=d}else a==="none"&&(r.bookmark.thumbnail=null);this._editBookmarkAndClose(r.bookmark,{takeScreenshot:!1,captureTimeExtent:n})}_storeEditInput(e){this._editInputNode=e}_storeAddInput(e){this._addInputNode=e}_storeUrlEditInput(e){this._urlEditInputNode=e}_deleteBookmark(e){this._closeEditBookmarkForm(),e&&(this.viewModel.bookmarks.remove(e),e.destroy())}_goToBookmark(e){this.endAddBookmark(),this.viewModel.goTo(e)}async _updateThumbnail(){const{_userState:e,viewModel:i}=this;e&&(e.validationState=void 0,await i.editBookmark(e.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,qa(e))}_focusEditFlowItemNode(e){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,qa(e))}_focusAddFlowItemNode(e){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,qa(e))}};l([c()],ei.prototype,"_editIncludeTimeExtent",void 0),l([c({type:GN})],ei.prototype,"_userState",void 0),l([c()],ei.prototype,"_focusRootFlowItem",void 0),l([c()],ei.prototype,"_focusAddFlowItem",void 0),l([c()],ei.prototype,"_focusEditFlowItem",void 0),l([c()],ei.prototype,"defaultCreateOptions",null),l([c()],ei.prototype,"defaultEditOptions",null),l([c()],ei.prototype,"bookmarks",null),l([c()],ei.prototype,"disabled",void 0),l([c()],ei.prototype,"dragEnabled",void 0),l([c()],ei.prototype,"editingEnabled",null),l([c()],ei.prototype,"filterPlaceholder",void 0),l([c()],ei.prototype,"filterText",void 0),l([c()],ei.prototype,"headingLevel",void 0),l([c()],ei.prototype,"goToOverride",null),l([c()],ei.prototype,"icon",null),l([c()],ei.prototype,"label",null),l([c(),Ue("esri/widgets/Bookmarks/t9n/Bookmarks")],ei.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],ei.prototype,"messagesCommon",void 0),l([c()],ei.prototype,"uiStrings",void 0),l([c()],ei.prototype,"view",null),l([c({type:Wse}),km(["select-bookmark","bookmark-edit","bookmark-select"])],ei.prototype,"viewModel",void 0),l([c({type:zN,nonNullable:!0})],ei.prototype,"visibleElements",void 0),l([c()],ei.prototype,"endAddBookmark",null),l([c()],ei.prototype,"startAddBookmark",null),ei=l([$("esri.widgets.Bookmarks")],ei);const jNe=ei;let _h=class extends q{constructor(e){super(e),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(St(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:i}=e;i&&i!==this&&i.expanded&&i.group&&i.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){var n;const i=!!e;this._set("expanded",i);const r=(n=this.view)==null?void 0:n.ui;r&&r.emit("expand",{target:this}),this._viewpointHandleChange(i)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&Hi(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?Hi(()=>{var i;return(i=this.view)==null?void 0:i.stationary},()=>{var i;return(i=this._viewpointHandle)==null?void 0:i.resume()},{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this.removeHandles(e),this._viewpointHandle=null;const{autoCollapse:i,view:r}=this;if(!r||!i)return;const n=Nye(()=>r.type==="3d"?r.camera:r.viewpoint,()=>this._collapse());this.addHandles(n,e),this._viewpointHandle=n}_collapse(){this.expanded=!1}};l([c({value:!1})],_h.prototype,"autoCollapse",null),l([c({value:!1})],_h.prototype,"expanded",null),l([c()],_h.prototype,"group",void 0),l([c({readOnly:!0})],_h.prototype,"state",null),l([c({value:null})],_h.prototype,"view",null),_h=l([$("esri.widgets.Expand.ExpandViewModel")],_h);const Yse=_h;function xS(t){return t&&typeof t.render=="function"}function GNe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}const ra="esri-expand",yo={base:ra,toggle:`${ra}__toggle`,popoverContent:`${ra}__popover-content`,panel:`${ra}__panel`,panelContent:`${ra}__panel-content`,sheet:`${ra}__sheet`,panelIconNumber:`${ra}__panel-icon-number`,contentContainer:`${ra}__content-container`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconExpanded:`${ra}__icon--expanded`,iconNumber:`${ra}__icon-number`,content:`${ra}__content`,contentExpanded:`${ra}__content--expanded`},QH="chevrons-left",eq="chevrons-right";let Fi=class extends $t{constructor(e,i){super(e,i),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.placement=null,this.viewModel=new Yse,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handlePopoverClose=r=>{r.target===this._popoverEl&&(this.viewModel.expanded=r.target.open)},this._handleSheetClose=r=>{this.viewModel.expanded=r.target.open},this._handlePanelClose=r=>{this.viewModel.expanded=!r.target.closed},this._handleKeyDown=r=>{this.viewModel.expanded&&r.key==="Escape"&&!this._willCloseOnEsc(r)&&r.preventDefault()},this._storeToggleButtonEl=r=>{this._toggleButtonEl=r},this._storePopoverEl=r=>{this._popoverEl=r}}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),panel:()=>k(()=>import("./calcite-panel-Cs9RGIrt.js"),__vite__mapDeps([291,255,235,236,239,242,256,257,241,248,240,238,243,244,245,258,259,260,261,262,263,264,265])),popover:()=>k(()=>import("./calcite-popover-Bvialn6r.js"),__vite__mapDeps([292,258,259,235,260,261,262,263,240,241,242,243,239,264,238,248,236,244,245])),sheet:()=>k(()=>import("./calcite-sheet-BJ9NcUIr.js"),__vite__mapDeps([293,235,261,239,242,262,245,240,241,265,243]))})}get expandTitle(){const{expanded:e,messagesCommon:i,collapseTooltip:r,expandTooltip:n}=this;return(e?r||(i==null?void 0:i.collapse):n||(i==null?void 0:i.expand))??""}get _displaySheet(){var e;switch(this.mode){case"drawer":return!0;case"auto":return((e=this.viewModel.view)==null?void 0:e.widthBreakpoint)==="xsmall";default:return!1}}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIcon(){return eq}set collapseIcon(e){this._overrideIfSome("collapseIcon",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIcon(){return xS(this.content)?this.content.icon:QH}set expandIcon(e){this._overrideIfSome("expandIcon",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get icon(){return null}get label(){var e;return(xS(this.content)?this.content.label:null)??((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{_displaySheet:e,_toggleButtonEl:i,viewModel:{expanded:r},label:n,placement:s}=this;return b("div",{class:this.classes(yo.base,K.widget)},this._renderToggle(),e?b("calcite-sheet",{class:yo.sheet,heightScale:"l",label:n,onkeydown:this._handleKeyDown,open:r,position:"block-end",onCalciteSheetClose:this._handleSheetClose},b("calcite-panel",{class:yo.panel,closable:!0,closed:!r,heading:n,onkeydown:this._handleKeyDown,onCalcitePanelClose:this._handlePanelClose},b("div",{class:yo.panelContent},this._renderContent()))):i?b("calcite-popover",{afterCreate:this._storePopoverEl,afterUpdate:this._storePopoverEl,label:n,onkeydown:this._handleKeyDown,open:r,overlayPositioning:"fixed",placement:s??this._getPlacement(),referenceElement:i,onCalcitePopoverClose:this._handlePopoverClose},b("div",{class:yo.popoverContent},this._renderContent())):null)}_getPlacement(){const{container:e,view:i}=this,r=e&&i?i.ui.getPosition(e):null;if(!r||r==="manual")return"auto";const[n,s]=r.split("-");return`${s==="right"?"left":"right"}-${n==="bottom"?"end":"start"}`}_willCloseOnEsc(e){const{closeOnEsc:i}=this;return typeof i=="function"?i(e):i}_renderBadgeNumber(){const{expanded:e,iconNumber:i}=this;return i&&!e?b("span",{class:yo.iconNumber,key:"expand__icon-number"},i):null}_renderToggleButton(){const{expanded:e,expandTitle:i,expandIcon:r,collapseIcon:n}=this,s=e?n:r,o=s===QH||s===eq;return b("calcite-button",{afterCreate:this._storeToggleButtonEl,afterUpdate:this._storeToggleButtonEl,class:K.widgetButton,kind:"neutral",label:i,onclick:this.toggle,scale:"s",title:i},s?b("calcite-icon",{class:this.classes(yo.icon,o&&yo.iconFlip),icon:s,scale:"s"}):null)}_renderToggle(){return b("div",{class:yo.toggle},this._renderToggleButton(),this._renderBadgeNumber())}_renderContent(){const{content:e}=this;return typeof e=="string"?b("div",{class:yo.contentContainer,innerHTML:e,key:"content__string"}):xS(e)?b("div",{class:yo.contentContainer,key:"content__widget"},e.render()):e instanceof HTMLElement?b("div",{afterCreate:this._attachToNode,bind:e,class:yo.contentContainer,key:"content__html-element"}):GNe(e)?b("div",{afterCreate:this._attachToNode,bind:e.domNode,class:yo.contentContainer,key:"content__node"}):null}_attachToNode(e){const i=this;e.appendChild(i)}};l([c({readOnly:!0})],Fi.prototype,"expandTitle",null),l([c()],Fi.prototype,"_toggleButtonEl",void 0),l([c()],Fi.prototype,"_displaySheet",null),l([c()],Fi.prototype,"autoCollapse",null),l([c()],Fi.prototype,"closeOnEsc",void 0),l([c()],Fi.prototype,"collapseIcon",null),l([c()],Fi.prototype,"collapseTooltip",void 0),l([c()],Fi.prototype,"content",void 0),l([c()],Fi.prototype,"expanded",null),l([c()],Fi.prototype,"expandIcon",null),l([c()],Fi.prototype,"expandTooltip",void 0),l([c()],Fi.prototype,"group",null),l([c()],Fi.prototype,"icon",null),l([c()],Fi.prototype,"iconNumber",void 0),l([c()],Fi.prototype,"label",null),l([c(),Ue("esri/widgets/Expand/t9n/Expand")],Fi.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Fi.prototype,"messagesCommon",void 0),l([c()],Fi.prototype,"mode",void 0),l([c()],Fi.prototype,"placement",void 0),l([c()],Fi.prototype,"view",null),l([c({type:Yse})],Fi.prototype,"viewModel",void 0),Fi=l([$("esri.widgets.Expand")],Fi);const uy=Fi;let wd=class extends jk(ji.EventedAccessor){constructor(e){super(e),this._initialViewpoint=null,this._goingHomeController=null,this.go=this.go.bind(this)}destroy(){this._cancelGo(),this.view=null}get state(){var e;return(e=this.view)!=null&&e.ready?this._goingHomeController?"going-home":"ready":"disabled"}set view(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then(()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))})}get viewpoint(){return this._get("viewpoint")||this._initialViewpoint}set viewpoint(e){this._set("viewpoint",e)}async go(){var i,r;if(!((i=this.view)!=null&&i.ready))throw new L("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=new AbortController;this._goingHomeController=e;try{await((r=this.view)==null?void 0:r.when()),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch{}this._goingHomeController=null}cancelGo(){this._cancelGo()}_cancelGo(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null}};l([c()],wd.prototype,"_goingHomeController",void 0),l([c({readOnly:!0})],wd.prototype,"state",null),l([c()],wd.prototype,"view",null),l([c({type:Ar})],wd.prototype,"viewpoint",null),l([c()],wd.prototype,"go",null),l([c()],wd.prototype,"cancelGo",null),wd=l([$("esri.widgets.Home.HomeViewModel")],wd);const Kse=wd,zNe={base:"esri-home"};let _a=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.messagesCommon=null,this.uiStrings=void 0,this.viewModel=new Kse,this._go=()=>{const{viewModel:r}=this;r.state==="going-home"?r.cancelGo():r.go()}}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"home"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewpoint(){return this.viewModel.viewpoint}set viewpoint(e){this.viewModel.viewpoint=e}cancelGo(){this.viewModel.cancelGo()}go(){return this.viewModel.go()}render(){var o;const{messagesCommon:e,messages:i,icon:r}=this,n=(o=this.viewModel)==null?void 0:o.state,s=n==="going-home";return b("div",{class:this.classes(zNe.base,K.widget)},b("calcite-button",{class:K.widgetButton,disabled:n==="disabled",iconStart:s?void 0:r,kind:"neutral",label:i.widgetLabel,onclick:this._go,scale:s?"s":"m",title:n==="going-home"?e.cancel:i.title},s?b("calcite-loader",{inline:!0,label:""}):null))}};l([c()],_a.prototype,"goToOverride",null),l([c()],_a.prototype,"icon",null),l([c()],_a.prototype,"label",null),l([c(),Ue("esri/widgets/Home/t9n/Home")],_a.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],_a.prototype,"messagesCommon",void 0),l([c()],_a.prototype,"uiStrings",void 0),l([c()],_a.prototype,"view",null),l([c({type:Kse}),km("go")],_a.prototype,"viewModel",void 0),l([c()],_a.prototype,"viewpoint",null),_a=l([$("esri.widgets.Home")],_a);const BNe=_a;let r0=class extends q{constructor(e){super(e),this.length=null,this.verticalLength=null,this.area=null}};l([c()],r0.prototype,"length",void 0),l([c()],r0.prototype,"verticalLength",void 0),l([c()],r0.prototype,"area",void 0),r0=l([$("esri.views.interactive.sketch.Units")],r0);const H2=r0;function HNe(t,e){return{type:cp(e),value:t,unit:e}}function vnt(t){return{value:t}}function qNe(t,e){return{type:cp(e),value:t,unit:e}}function WNe(t,e){return{type:cp(e),value:t,unit:e}}function gp(t,e,i="arithmetic"){return{type:cp(e),value:t,unit:e,rotationType:i}}function bnt(t,e){const i=ZNe(t,e);return t.type==="angle"?gp(i,e,t.rotationType):HNe(i,e)}function ZNe(t,e){return Oe(t.value,t.unit,e)}function _nt(t,e){return t==null?e:e==null||t.value>Oe(e.value,e.unit,t.unit)?t:e}function wnt(t,e){return t==null?null:{...t,value:t.value*e}}function Gk(t,e,i){if(e===i)return t;switch(i){case"arithmetic":case"geographic":return 90-t}}const Snt=qNe(0,"meters"),$nt=WNe(0,"square-meters");gp(0,"radians");const Ent=gp(0,"degrees"),Tnt=gp(0,"degrees","geographic");function Xse(t,e,i,r){if(Yo(t.spatialReference,i)){nI[0]=t.x,nI[1]=t.y;const s=t.z;return nI[2]=s??r??0,Lc(nI,t.spatialReference,0,e,i,0)}const n=Cb(t,i);return!!n&&(e[0]=n==null?void 0:n.x,e[1]=n==null?void 0:n.y,e[2]=(n==null?void 0:n.z)??r??0,!0)}async function Int(t,e,i,r,n){return await Ec(t.spatialReference,i,null,n),Xse(t,e,i,r)}const nI=W();function I_(t,e,i,r){return{x:t,y:e,z:i,hasZ:i!=null,hasM:!1,spatialReference:r,type:"point"}}function Qse(t,e,i,r,n){t.x=e,t.y=i,t.z=r,t.hasZ=r!=null,t.spatialReference=n}function q2(t,e,i,r,n){return!(e==null||r==null||t.length<2)&&(aw.x=t[0],aw.y=t[1],aw.z=t[2],aw.spatialReference=e,Xse(aw,i,r,n))}const aw=I_(0,0,0,le.WGS84);function eoe(t){if(!t)return null;const e=t.wkid;if(e)return h_e[e];const i=t.wkt2??t.wkt;return i?JNe(i):null}function JNe(t){const e=d_e.exec(t);if(!e||e.length!==2)return null;const i=e[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),n=parseFloat(i[2]);return isNaN(r)||isNaN(n)?null:{a:r,f:n===0?0:1/n}}function zk(t){const e=eoe(t);if(YNe(e))return e;const i=e.a*(1-e.f);return Object.assign(e,{b:i,eSq:1-(i/e.a)**2,radius:(2*e.a+i)/3,densificationRatio:1e4/((2*e.a+i)/3)})}function YNe(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function sI(t,e,i){const{a:r,eSq:n}=zk(i),s=Math.sqrt(n),o=Math.sin(e[1]*Ts),a=r*e[0]*Ts;let u;return n>0?u=r*((1-n)*(o/(1-n*(o*o))-1/(2*s)*Math.log((1-s*o)/(1+s*o))))*.5:u=r*o,t[0]=a,t[1]=u,t}function x_(t){return u_(t)&&!!eoe(t)}function xnt(t,e="square-meters"){if(t.some(o=>!x_(o.spatialReference)))throw new L("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let o=0;o<t.length;o++){const a=t[o],u=a.spatialReference,{radius:d,densificationRatio:p}=zk(u),h=d*p;i.push(KNe(a,h))}const r=[],n=[0,0],s=[0,0];for(let o=0;o<i.length;o++){const{rings:a,spatialReference:u}=i[o];let d=0;for(let p=0;p<a.length;p++){const h=a[p];sI(n,h[0],u),sI(s,h[h.length-1],u);let m=s[0]*n[1]-n[0]*s[1];for(let y=0;y<h.length-1;y++)sI(n,h[y+1],u),sI(s,h[y],u),m+=s[0]*n[1]-n[0]*s[1];d+=m}d=Oe(d,"square-meters",e),r.push(d/-2)}return r}function toe(t,e="meters"){if(!t)throw new L("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(r=>!x_(r.spatialReference)))throw new L("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<t.length;r++){const n=t[r],{spatialReference:s}=n,o=n.type==="polyline"?n.paths:n.rings;let a=0;for(let u=0;u<o.length;u++){const d=o[u];let p=0;for(let h=1;h<d.length;h++){const m=d[h-1][0],y=d[h][0],g=d[h-1][1],v=d[h][1];if(g!==v||m!==y){const _=new fE;M_(_,[m,g],[y,v],s),p+=_.distance}}a+=p}a=Oe(a,"meters",e),i.push(a)}return i}function KNe(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new L("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=t;if(!x_(i))throw new L("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r=t.type==="polyline"?t.paths:t.rings,n=[],s=[0,0],o=new fE;for(const u of r){const d=[];n.push(d),d.push([u[0][0],u[0][1]]);let p,h,m=u[0][0],y=u[0][1];for(let g=0;g<u.length-1;g++){if(p=u[g+1][0],h=u[g+1][1],m===p&&y===h)continue;const v=[m,y];M_(o,[m,y],[p,h],i);const{azimuth:_,distance:w}=o,S=w/e;if(S>1){for(let E=1;E<=S-1;E++)op(s,v,_,E*e,i),d.push(s.slice());op(s,v,_,(w+Math.floor(S-1)*e)/2,i),d.push(s.slice())}op(s,v,_,w,i),d.push(s.slice()),m=s[0],y=s[1]}}const a=r_(le,i);return t.type==="polyline"?new hn({paths:n,spatialReference:a}):new os({rings:n,spatialReference:a})}let fE=class{constructor(e=0,i=void 0,r=void 0){this.distance=e,this.azimuth=i,this.reverseAzimuth=r}};function op(t,e,i,r,n){const s=e[0],o=e[1],a=s*Ts,u=o*Ts,d=(i??0)*Ts,{a:p,b:h,f:m}=zk(n),y=Math.sin(d),g=Math.cos(d),v=(1-m)*Math.tan(u),_=1/Math.sqrt(1+v*v),w=v*_,S=Math.atan2(v,g),E=_*y,T=E*E,M=1-T,x=M*(p*p-h*h)/(h*h),C=1+x/16384*(4096+x*(x*(320-175*x)-768)),O=x/1024*(256+x*(x*(74-47*x)-128));let F,V,z,H,Q=r/(h*C),J=2*Math.PI;for(;Math.abs(Q-J)>1e-12;)z=Math.cos(2*S+Q),F=Math.sin(Q),V=Math.cos(Q),H=O*F*(z+O/4*(V*(2*z*z-1)-O/6*z*(4*F*F-3)*(4*z*z-3))),J=Q,Q=r/(h*C)+H;const ne=w*F-_*V*g,Pe=Math.atan2(w*V+_*F*g,(1-m)*Math.sqrt(T+ne*ne)),_e=Math.atan2(F*y,_*V-w*F*g),ue=m/16*M*(4+m*(4-3*M)),it=Pe/Ts,Xr=(a+(_e-(1-ue)*m*E*(Q+ue*F*(z+ue*V*(2*z*z-1)))))/Ts;return t[0]=Xr,t[1]=it,t}function M_(t,e,i,r){const n=e[0]*Ts,s=e[1]*Ts,o=i[0]*Ts,a=i[1]*Ts,{a:u,b:d,f:p,radius:h}=zk(r),m=o-n,y=Math.atan((1-p)*Math.tan(s)),g=Math.atan((1-p)*Math.tan(a)),v=Math.sin(y),_=Math.cos(y),w=Math.sin(g),S=Math.cos(g);let E,T,M,x,C,O,F,V,z,H,Q=1e3,J=m;do{if(F=Math.sin(J),V=Math.cos(J),M=Math.sqrt(S*F*(S*F)+(_*w-v*S*V)*(_*w-v*S*V)),M===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;C=v*w+_*S*V,O=Math.atan2(M,C),z=_*S*F/M,T=1-z*z,x=C-2*v*w/T,isNaN(x)&&(x=0),H=p/16*T*(4+p*(4-3*T)),E=J,J=m+(1-H)*p*z*(O+H*M*(x+H*C*(2*x*x-1)))}while(Math.abs(J-E)>1e-12&&--Q>0);if(Q===0){const Xr=h,us=Math.acos(Math.sin(s)*Math.sin(a)+Math.cos(s)*Math.cos(a)*Math.cos(o-n))*Xr,ho=o-n,nl=Math.sin(ho)*Math.cos(a),Fn=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(ho),mo=Math.atan2(nl,Fn);return t.azimuth=mo/Ts,t.distance=us,t.reverseAzimuth=void 0,t}const ne=T*(u*u-d*d)/(d*d),Pe=ne/1024*(256+ne*(ne*(74-47*ne)-128)),_e=d*(1+ne/16384*(4096+ne*(ne*(320-175*ne)-768)))*(O-Pe*M*(x+Pe/4*(C*(2*x*x-1)-Pe/6*x*(4*M*M-3)*(4*x*x-3)))),ue=Math.atan2(S*Math.sin(J),_*w-v*S*Math.cos(J)),it=Math.atan2(_*Math.sin(J),_*w*Math.cos(J)-v*S);return t.azimuth=ue/Ts,t.distance=_e,t.reverseAzimuth=it/Ts,t}function BN(t){return x_(t)?t:el(t)?le.WGS84:null}var to;function XNe(t,e){if(t==null||e==null)return;const i=HN(t,e);return i!=null?gp(i,"radians","geographic"):void 0}(function(t){t.Absolute="absolute",t.Relative="relative",t.RelativeBilateral="relative-bilateral"})(to||(to={}));const HN=(()=>{const t=W(),e=W();return(i,r)=>(vt(t,i.x,i.y,i.z??0),vt(e,r.x,r.y,r.z??0),QNe(t,e,i.spatialReference,r.spatialReference))})(),QNe=(()=>{const t=pt(),e=W(),i=W();return(r,n,s,o)=>{if(Ft(r,n))return;const a=BN(s),u=BN(o);if(a&&u&&ci(a,u)&&q2(r,s,e,a)&&q2(n,o,i,u)){const{azimuth:p}=M_(tDe,e,i,a);return p!=null?Oe(p,"degrees","radians"):void 0}t[0]=n[0]-r[0],t[1]=n[1]-r[1];let d=Cre(Ere,t);return t[0]<0&&(d=iDe-d),d}})();function Cnt(t,e,i,r=to.Absolute){if(e&&i)switch(r){case to.Absolute:return XNe(e,i);case to.Relative:return iq(tq(t,e,i),to.Relative);case to.RelativeBilateral:return iq(tq(t,e,i),to.RelativeBilateral)}}function tq(t,e,i){if(!t||!e||!i)return;const r=HN(t,e),n=HN(e,i);return r!=null&&n!=null?gp(n-r,"radians","geographic"):void 0}function iq(t,e){if(t!=null)switch(e){case to.Absolute:return eDe(t);case to.Relative:{const i=W2(t);let r=rq.normalize(i,0,!0);return r===-180&&(r=180),gp(r,"degrees","geographic")}case to.RelativeBilateral:{const i=W2(t),r=Math.abs(rq.normalize(i,0,!0));return gp(r,"degrees","geographic")}}}function eDe(t){const e=W2(t),i=rDe.normalize(e,0,!0);return gp(i,"degrees","geographic")}const knt=(()=>{const t=W();return(e,i,r,n,s,o="geodesic")=>{Yt(t,i);const a=W2(s);if(o==="geodesic"){const y=BN(r);if(y&&q2(t,r,t,y))return op(e,t,a,n,y),e[2]=i[2],!!q2(e,y,e,r)}const u=Gk(a,"geographic","arithmetic"),d=Oe(u,"degrees","radians"),p=i[0]+n*Math.cos(d),h=i[1]+n*Math.sin(d),m=i[2];return vt(e,p,h,m),!0}})();function W2(t){if(t!=null)return Gk(ioe(t),t.rotationType,"geographic")}function Lnt(t){if(t!=null)return Gk(ioe(t),t.rotationType,"arithmetic")}function ioe(t){return Oe(t.value,t.unit,"degrees")}const tDe=new fE,iDe=2*Math.PI,rDe=c5,rq=new rk(-180,180);let wh=class extends q{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?to.RelativeBilateral:to.Relative;case"absolute":return to.Absolute}}get displayUnits(){return this._get("displayUnits")??new H2}set displayUnits(e){this._set("displayUnits",e)}get inputUnits(){return this._get("inputUnits")??new H2}set inputUnits(e){this._set("inputUnits",e)}};l([c({type:String,nonNullable:!0})],wh.prototype,"directionMode",void 0),l([c({type:Boolean,nonNullable:!0})],wh.prototype,"relativeDirectionIsBilateral",void 0),l([c()],wh.prototype,"effectiveDirectionMode",null),l([c({type:H2,nonNullable:!0})],wh.prototype,"displayUnits",null),l([c({type:H2,nonNullable:!0})],wh.prototype,"inputUnits",null),wh=l([$("esri.views.interactive.sketch.SketchValueOptions")],wh);const Bk=wh;var _$;(function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"})(_$||(_$={}));function nU(t,e,i){return t.units[e][i]}function wm(t,e,i,r=2,n="abbr"){return`${Rn(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:e>0?"never":"exceptZero"})} ${nU(t,i,n)}`}function Hk(t,e,i,r=2,n="abbr"){return`${Rn(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:"exceptZero"})} ${nU(t,i,n)}`}function Ont(t,e,i,r=2,n="abbr"){const s=MV(e,i);return wm(t,Oe(e,i,s),s,r,n)}function Rnt(t,e,i,r=2,n="abbr"){const s=MV(e,i);return Hk(t,Oe(e,i,s),s,r,n)}function Pnt(t,e,i,r=2,n="abbr"){const s=CV(e,i);return wm(t,Oe(e,i,s),s,r,n)}function Fnt(t,e,i,r=2,n="abbr"){const s=CV(e,i);return Hk(t,Oe(e,i,s),s,r,n)}function Nnt(t,e,i,r=2,n="abbr"){const s=kV(e,i);return wm(t,Oe(e,i,s),s,r,n)}function Dnt(t,e,i,r=2,n="abbr"){const s=kV(e,i);return Hk(t,Oe(e,i,s),s,r,n)}function Vnt(t,e,i,r=2,n="abbr"){const s=LV(e,i);return wm(t,Oe(e,i,s),s,r,n)}function Unt(t,e,i,r=2,n="abbr"){const s=LV(e,i);return Hk(t,Oe(e,i,s),s,r,n)}function jnt(t,e,i,r=2,n="abbr"){const s=ffe(e,i);return wm(t,Oe(e,i,s),s,r,n)}function Gnt(t,e,i,r=2,n="abbr"){const s=yfe(e,i);return wm(t,Oe(e,i,s),s,r,n)}const nDe=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function nq(t,e,i,r,n,s=c5,o=!0){let a=s.normalize(Gk(Oe(t,e,"degrees"),i,r),0,o);const u=nDe(a,n??2);return a=sDe(a,u),Rn(a,u)}const sq=new Map;function sDe(t,e){const i=JSON.stringify(e);let r=sq.get(i);return r||(r=new Intl.NumberFormat("en-US",e),sq.set(i,r)),/^[-+]?360\.?0*°?$/.test(r.format(t))?0:t}const oq=["B","kB","MB","GB","TB"];function oDe(t,e){let i=(e=Math.round(e))===0?0:Math.floor(Math.log(e)/Math.log(_$.KILOBYTES));i=fr(i,0,oq.length-1);const r=Rn(e/_$.KILOBYTES**i,{maximumFractionDigits:2});return mu(t.units.bytes[oq[i]],{fileSize:r})}function aDe(t){const{exifInfo:e,exifName:i,tagName:r}=t;if(!e||!i||!r)return null;const n=e.find(s=>s.name===i);return n?lDe({tagName:r,tags:n.tags}):null}function lDe(t){const{tagName:e,tags:i}=t;if(!i||!e)return null;const r=i.find(n=>n.name===e);return(r==null?void 0:r.value)||null}var qN;const uDe={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let Ws=qN=class extends j{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=aDe({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return uDe[e]||null}clone(){return new qN({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};l([c({type:String})],Ws.prototype,"contentType",void 0),l([c()],Ws.prototype,"exifInfo",void 0),l([c({readOnly:!0})],Ws.prototype,"orientationInfo",null),l([c({type:Xe})],Ws.prototype,"id",void 0),l([c({type:String})],Ws.prototype,"globalId",void 0),l([c({type:String})],Ws.prototype,"keywords",void 0),l([c({type:String})],Ws.prototype,"name",void 0),l([c({json:{read:!1}})],Ws.prototype,"parentGlobalId",void 0),l([c({json:{read:!1}})],Ws.prototype,"parentObjectId",void 0),l([c({type:Xe})],Ws.prototype,"size",void 0),l([c({json:{read:!1}})],Ws.prototype,"url",void 0),Ws=qN=l([$("esri.rest.query.support.AttachmentInfo")],Ws);const cDe=Ws;function w$(t){return T5(t)||w1e(t)||S1e(t)}function sU(t,e){const{format:i,timeZoneOptions:r,fieldType:n}=e??{};let s,o;if(r&&({timeZone:s,timeZoneName:o}=IX(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,Ms(i||"short-date-short-time"),n)),typeof t=="string"&&isNaN(Date.parse(n==="time-only"?`1970-01-01T${t}Z`:t)))return t;switch(n){case"date-only":{const a=Ms(i||"short-date");return typeof t=="string"?LX(t,{...a}):hr(t,{...a,timeZone:po})}case"time-only":{const a=Ms(i||"short-time");return typeof t=="string"?AX(t,a):hr(t,{...a,timeZone:po})}case"timestamp-offset":{if(!s&&typeof t=="string"&&new Date(t).toISOString()!==t)return t;const a=i||r?Ms(i||"short-date-short-time"):void 0,u=a?{...a,timeZone:s,timeZoneName:o}:void 0;return typeof t=="string"?OX(t,u):hr(t,u)}default:{const a=i||r?Ms(i||"short-date-short-time"):void 0;return hr(typeof t=="string"?new Date(t):t,a?{...a,timeZone:s,timeZoneName:o}:void 0)}}}const dDe="esri.widgets.Feature.support.featureUtils",WN=()=>U.getLogger(dDe),pDe=/href=(""|'')/gi,hDe=/(\{([^{\r\n]+)\})/g,mDe=/'/g,roe=/^\s*expression\//i,fDe=/(\n)/gi,yDe=/[\u00A0-\u9999<>&]/gim,gDe=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,vDe=/^(?:mailto:|tel:)/,noe="relationships/",aq=Ms("short-date-short-time");function bDe(t){if(t!=null)return(t.sourceLayer||t.layer)??void 0}async function znt({type:t,value:e,event:i}){try{return typeof e=="function"?e(i):await e}catch(r){return void WN().error("error",`An error occurred when calling the "${t}" function`,{error:r,graphic:i.graphic,value:e})}}function Bnt(t=""){if(t)return!vDe.test(t.trim().toLowerCase())}function _De(t){return!!t&&roe.test(t)}function wDe(t,e){if(!e||!_De(e)||!t)return;const i=e.replace(roe,"").toLowerCase();return t.find(({name:r})=>r.toLowerCase()===i)}function Hnt(t,e){const i=wDe(e,t==null?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function SDe(t,e){const i=e.get(t.toLowerCase());return`{${(i==null?void 0:i.fieldName)||t}}`}function $De(t){return t.replaceAll(pDe,"")}function oU(t,e){const i=aU(e,t);return i?i.name:t}function qnt(t,e){return t&&t.map(i=>oU(i,e))}function aU(t,e){return t&&typeof t.getField=="function"&&e?t.getField(e)??null:null}function soe(t){return`${t}`.trim()}function Wnt({attributes:t,globalAttributes:e,layer:i,text:r,expressionAttributes:n,fieldInfoMap:s}){return r?EDe({formattedAttributes:e,template:CDe(r,{...e,...n,...t},i),fieldInfoMap:s}):""}function EDe({formattedAttributes:t,template:e,fieldInfoMap:i}){return soe($De(mu(mu(e,r=>SDe(r,i)),t)))}function TDe(t,e,i=!1){const r=e[t];if(typeof r=="string"){const n="%27",s=(i?encodeURIComponent(r):r).replaceAll(mDe,n);e[t]=s}}function IDe(t,e=!1){const i={...t};return Object.keys(i).forEach(r=>TDe(r,i,e)),i}function xDe(t,e,i){const r=(e=soe(e))&&e[0]!=="{";return mu(t,IDe(i,r||!1))}function MDe(t,e){return t.replaceAll(hDe,(i,r,n)=>{const s=aU(e,n);return s?`{${s.name}}`:r})}function CDe(t,e,i){const r=MDe(t,i);return r&&r.replaceAll(gDe,(n,s,o)=>xDe(n,s||o,e))}function kDe(t,e){if(typeof t=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const i=Number(t);if(!isNaN(i))return i}return t}function ooe(t){return t!=null&&typeof t=="object"&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&(t.type==="feature"||t.type==="scene"||t.type==="subtype-sublayer"||t.type==="sublayer")&&"when"in t}function LDe(t){return t!=null&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function ADe(t){return!!(t&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"type"in t)&&(t.type==="subtype-sublayer"&&"parent"in t&&t.parent&&typeof t.parent=="object"?"globalIdField"in t.parent:"globalIdField"in t)}function yE(t){return ooe(t)&&LDe(t)}function Znt(t){return ooe(t)&&ADe(t)}function ODe(t){return!!t&&typeof t=="object"&&"sourceLayer"in t&&yE(t.sourceLayer)}function RDe(t,e){var p;const{fieldInfos:i,fieldName:r,preventPlacesFormatting:n,layer:s,timeZone:o}=e,a=FDe(i,r),u=aU(s,r);if(a&&!yP(r)){const h=u==null?void 0:u.type,m=(p=a.format)==null?void 0:p.dateFormat;if(h==="date"||h==="date-only"||h==="time-only"||h==="timestamp-offset"||m)return sU(t,{format:m,fieldType:h,timeZoneOptions:{layerTimeZone:s&&"preferredTimeZone"in s?s.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!s||!("datesInUnknownTimezone"in s))&&!!s.datesInUnknownTimezone}})}const d=a==null?void 0:a.format;return typeof t=="string"&&yP(r)&&d?PDe(t,d):typeof(t=kDe(t,d))=="string"||t==null||d==null?aoe(t):Rn(t,n?{...g2(d),minimumFractionDigits:0,maximumFractionDigits:20}:g2(d))}function PDe(t,e){return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?WA(t,",",", ",e):t.includes(";")?WA(t,";","; ",e):t.includes(" ")?WA(t," "," ",e):Rn(Number(t),g2(e))}function WA(t,e,i,r){return t.trim().split(e).map(n=>Rn(Number(n),g2(r))).join(i)}function FDe(t,e){if(t!=null&&t.length&&e)return t.find(i=>{var r;return((r=i.fieldName)==null?void 0:r.toLowerCase())===e.toLowerCase()})}function NDe({fieldName:t,graphic:e,layer:i}){if(uoe(t)||!i||typeof i.getFeatureType!="function")return null;const{typeIdField:r}=i;if(!r||t!==r)return null;const n=i.getFeatureType(e);return n?n.name:null}function DDe({fieldName:t,value:e,graphic:i,layer:r}){if(uoe(t)||!r||typeof r.getFieldDomain!="function")return null;const n=i&&r.getFieldDomain(t,{feature:i});return n&&n.type==="coded-value"?n.getName(e):null}function Jnt(t,e,i,r){const{creatorField:n,creationDateField:s,editorField:o,editDateField:a}=t;if(!e)return;const u=IX(r&&"preferredTimeZone"in r?r.preferredTimeZone:null,!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone,i,aq,"date"),d={...aq,...u},p=e[a];if(typeof p=="number"){const m=e[o];return{type:"edit",date:hr(p,d),user:m}}const h=e[s];if(typeof h=="number"){const m=e[n];return{type:"create",date:hr(h,d),user:m}}return null}function Ynt(t,e){const i=new Map;if(!t)return i;for(const r of t){if(!r.fieldName)continue;const n=oU(r.fieldName,e);r.fieldName=n,i.set(n.toLowerCase(),r)}return i}function Knt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:r}=t;return i&&e.push(...i),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const s=n==null?void 0:n.fieldInfos;s&&e.push(...s)}}),e}function Xnt(t){return t.replaceAll(yDe,e=>`&#${e.charCodeAt(0)};`)}function aoe(t){return typeof t=="string"?t.replaceAll(fDe,'<br class="esri-text-new-line" />'):t}function loe(t){var h;const{value:e,fieldName:i,fieldInfos:r,fieldInfoMap:n,layer:s,graphic:o,timeZone:a}=t;if(e==null)return"";const u=DDe({fieldName:i,value:e,graphic:o,layer:s});if(u)return u;const d=NDe({fieldName:i,graphic:o,layer:s});if(d)return d;if(n.get(i.toLowerCase()))return RDe(e,{fieldInfos:r||Array.from(n.values()),fieldName:i,layer:s,timeZone:a});const p=(h=s==null?void 0:s.fieldsIndex)==null?void 0:h.get(i);return p&&(w$(p)||Lb(p))?sU(e,{fieldType:p.type,timeZoneOptions:{layerTimeZone:s&&"preferredTimeZone"in s?s.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:!(!s||!("datesInUnknownTimezone"in s))&&!!s.datesInUnknownTimezone}}):aoe(e)}function Qnt({fieldInfos:t,attributes:e,layer:i,graphic:r,fieldInfoMap:n,relatedInfos:s,timeZone:o}){const a={};return s==null||s.forEach(u=>GDe({attributes:a,relatedInfo:u,fieldInfoMap:n,fieldInfos:t,layer:i,timeZone:o})),e&&Object.keys(e).forEach(u=>{const d=e[u];a[u]=loe({fieldName:u,fieldInfos:t,fieldInfoMap:n,layer:i,value:d,graphic:r,timeZone:o})}),a}async function VDe(t,e){var p,h;const{layer:i,graphic:r,outFields:n,objectIds:s,returnGeometry:o,spatialReference:a}=t,u=s[0];if(typeof u!="number"&&typeof u!="string"){const m="Could not query required fields for the specified feature. The feature's ID is invalid.",y={layer:i,graphic:r,objectId:u,requiredFields:n};return WN().warn(m,y),null}if(!((h=(p=Uy(i))==null?void 0:p.operations)!=null&&h.supportsQuery)){const m="The specified layer cannot be queried. The following fields will not be available.",y={layer:i,graphic:r,requiredFields:n,returnGeometry:o};return WN().warn(m,y),null}const d=i.createQuery();return d.objectIds=s,d.outFields=n!=null&&n.length?n:[i.objectIdField],d.returnGeometry=!!o,d.returnZ=!!o,d.returnM=!!o,d.outSpatialReference=a,(await i.queryFeatures(d,e)).features[0]}async function UDe(t){var r;if(!((r=t.expressionInfos)!=null&&r.length))return!1;const e=await Tc(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function est({graphic:t,popupTemplate:e,layer:i,spatialReference:r},n){if(!i||!e||(typeof i.load=="function"&&await i.load(n),!t.attributes))return;const s=i.objectIdField,o=t.attributes[s];if(o==null)return;const a=[o],u=await e.getRequiredFields(i.fieldsIndex),d=OQ(u,t),p=d?[]:u.includes(s)?u:[...u,s],h=e.returnGeometry||await UDe(e);if(d&&!h)return;const m=await VDe({layer:i,graphic:t,outFields:p,objectIds:a,returnGeometry:h,spatialReference:r},n);m&&(m.geometry&&(t.geometry=m.geometry),m.attributes&&(t.attributes={...t.attributes,...m.attributes}))}function uoe(t=""){return!!t&&t.includes(noe)}function jDe(t){return t?`${noe}${t.layerId}/${t.fieldName}`:""}function lq({attributes:t,graphic:e,relatedInfo:i,fieldInfos:r,fieldInfoMap:n,layer:s,timeZone:o}){t&&e&&i&&Object.keys(e.attributes).forEach(a=>{const u=jDe({layerId:i.relation.id.toString(),fieldName:a}),d=e.attributes[a];t[u]=loe({fieldName:u,fieldInfos:r,fieldInfoMap:n,layer:s,value:d,graphic:e,timeZone:o})})}function GDe({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:s}){var o,a;t&&e&&((o=e.relatedFeatures)==null||o.forEach(u=>lq({attributes:t,graphic:u,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:s})),(a=e.relatedStatsFeatures)==null||a.forEach(u=>lq({attributes:t,graphic:u,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:s})))}const uq=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},coe=({layer:t,method:e,query:i,definitionExpression:r})=>{var o,a;if(!((a=(o=t.capabilities)==null?void 0:o.query)!=null&&a.supportsCacheHint)||e==="attachments")return;const n=i.where!=null?i.where:null,s=i.geometry!=null?i.geometry:null;uq(r)||uq(n)||(s==null?void 0:s.type)==="extent"||i.resultType==="tile"||(i.cacheHint=!0)},tst=({query:t,layer:e,method:i})=>{coe({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})},ist=({queryPayload:t,layer:e,method:i})=>{coe({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})};function zDe(t,e,i){var r,n;return t&&e&&i?e.type==="sublayer"?C0({layers:(r=e.layer)==null?void 0:r.sublayers,map:t,relatedLayer:e,relationship:i})||C0({layers:(n=e.layer)==null?void 0:n.subtables,map:t,relatedLayer:e,relationship:i}):C0({layers:t.allLayers,map:t,relatedLayer:e,relationship:i})||C0({layers:t.allTables,map:t,relatedLayer:e,relationship:i}):null}function rst(t,e){var i;return t&&"utilityNetworks"in t&&e?(i=t.utilityNetworks)==null?void 0:i.find(r=>r.isUtilityLayer(e)):null}function cq(t,e){return t==null?void 0:t.allTables.find(i=>{var r;return i.type==="feature"&&i.layerId===e.id&&i.url===((r=e.layer)==null?void 0:r.url)})}function C0({map:t,relationship:e,relationship:{relatedTableId:i},relatedLayer:r,layers:n}){var s;if(!n)return null;for(const o of n){if(o.type==="map-image"){const u=C0({layers:o.sublayers,map:t,relatedLayer:r,relationship:e})||C0({layers:o.subtables,map:t,relatedLayer:r,relationship:e});if(u)return u;continue}if(!yE(o))continue;if(r.type==="sublayer"){if(o!==r&&o.id===i)return o.isTable?cq(t,o):o;continue}const a=r.type==="scene"&&r.associatedLayer?r.associatedLayer.url:r.url;if(!a)return null;if(o.type!=="sublayer"){if(o!==r&&o.url===a&&o.layerId===i)return o}else if(o!==r&&((s=o.layer)==null?void 0:s.url)===a&&o.id===i)return o.isTable?cq(t,o):o}return null}function dq(t){const e=t.getObjectId();return e!=null?`oid:${e}`:`uid:${t.uid}`}const pq={editing:!1,operations:{add:!0,update:!0,delete:!0}},doe=Y.ofType(cDe);let Zs=class extends q{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.capabilities={...pq},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new doe,this.fileInfos=new Y,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(N(()=>this.graphic,()=>this._graphicChanged(),be))}destroy(){this._attachmentLayer=null,this.graphic=null}castCapabilities(e){return{...pq,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const i=e.layer||e.sourceLayer;return(i==null?void 0:i.loaded)&&"capabilities"in i&&i.capabilities&&"operations"in i.capabilities&&"supportsResizeAttachments"in i.capabilities.operations&&i.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:i}=this;if(!e||typeof e.queryAttachments!="function")throw new L("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId();if(typeof r!="number")throw new L("invalid-object-id","getAttachments(): Numeric object id is required");const n=new JF({objectIds:[r],returnMetadata:!0}),s=[],o=e.queryAttachments(n).then(u=>u[r]||s).catch(()=>s);this._getAttachmentsPromise=o,this.notifyChange("state");const a=await o;return i.destroyAll(),a.length&&i.addMany(a),this._getAttachmentsPromise=null,this.notifyChange("state"),a}async addAttachment(e,i=this.graphic){var u;const{_attachmentLayer:r,attachmentInfos:n,capabilities:s}=this;if(!i)throw new L("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:i});if(!e)throw new L("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!((u=s.operations)!=null&&u.add))throw new L("invalid-capabilities","addAttachment(): add capabilities are required.");if(!r||typeof r.addAttachment!="function")throw new L("invalid-layer","addAttachment(): A valid layer is required.");const o=r.addAttachment(i,e).then(d=>this._queryAttachment(d.objectId,i)),a=await o;return n.add(a),a}async deleteAttachment(e){var u;const{_attachmentLayer:i,attachmentInfos:r,graphic:n,capabilities:s}=this;if(!e)throw new L("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!((u=s.operations)!=null&&u.delete))throw new L("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!i||typeof i.deleteAttachments!="function")throw new L("invalid-layer","deleteAttachment(): A valid layer is required.");if(!n)throw new L("invalid-graphic","deleteAttachment(): A graphic is required.");const o=i.deleteAttachments(n,[e.id]).then(()=>e),a=await o;return r.remove(a),a.destroy(),a}async updateAttachment(e,i=this.activeAttachmentInfo){var p;const{_attachmentLayer:r,attachmentInfos:n,graphic:s,capabilities:o}=this;if(!e)throw new L("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!i)throw new L("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:i});if(!((p=o.operations)!=null&&p.update))throw new L("invalid-capabilities","updateAttachment(): Update capabilities are required.");const a=n.indexOf(i);if(!r||typeof r.updateAttachment!="function")throw new L("invalid-layer","updateAttachment(): A valid layer is required.");if(!s)throw new L("invalid-graphic","updateAttachment(): A graphic is required.");const u=r.updateAttachment(s,i.id,e).then(h=>this._queryAttachment(h.objectId)),d=await u;return n.splice(a,1,d),d}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,i){if(!e||!i)return null;const r={file:e,form:i};return this.fileInfos.add(r),r}updateFile(e,i,r=this.activeFileInfo){if(!e||!i||!r)return null;const n=this.fileInfos.indexOf(r);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:i}),this.fileInfos.items[n]}deleteFile(e){const i=this.fileInfos.find(r=>r.file===e);return i?(this.fileInfos.remove(i),i):null}async _queryAttachment(e,i){const{_attachmentLayer:r}=this;if(!e||!(r!=null&&r.queryAttachments))throw new L("invalid-attachment-id","Could not query attachment.");const n=this._getObjectId(i);if(typeof n!="number")throw new L("invalid-object-id","getAttachments(): Numeric object id is required");const s=new JF({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return r.queryAttachments(s).then(o=>o[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>this.attachmentInfos.destroyAll()))}_setAttachmentLayer(){const{graphic:e}=this,i=bDe(e);this._attachmentLayer=i?i.type==="scene"&&i.associatedLayer!=null?i.associatedLayer:i:null}};l([c()],Zs.prototype,"capabilities",void 0),l([We("capabilities")],Zs.prototype,"castCapabilities",null),l([c()],Zs.prototype,"activeAttachmentInfo",void 0),l([c()],Zs.prototype,"activeFileInfo",void 0),l([c({readOnly:!0,type:doe})],Zs.prototype,"attachmentInfos",void 0),l([c()],Zs.prototype,"fileInfos",void 0),l([c({type:Li})],Zs.prototype,"graphic",void 0),l([c()],Zs.prototype,"mode",void 0),l([c({readOnly:!0})],Zs.prototype,"state",null),l([c()],Zs.prototype,"filesEnabled",void 0),l([c({readOnly:!0})],Zs.prototype,"supportsResizeAttachments",null),Zs=l([$("esri.widgets.Attachments.AttachmentsViewModel")],Zs);const lU=Zs;function hq(t){const e=t.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function BDe(t){const e=ut("esri/themes/base/images/files/");return t?t==="text/plain"?`${e}text-32.svg`:t==="application/pdf"?`${e}pdf-32.svg`:t==="text/csv"?`${e}csv-32.svg`:t==="application/gpx+xml"?`${e}gpx-32.svg`:t==="application/x-dwf"?`${e}cad-32.svg`:t==="application/postscript"||t==="application/json"||t==="text/xml"||t==="model/vrml"?`${e}code-32.svg`:t==="application/x-zip-compressed"||t==="application/x-7z-compressed"||t==="application/x-gzip"||t==="application/x-tar"||t==="application/x-gtar"||t==="application/x-bzip2"||t==="application/gzip"||t==="application/x-compress"||t==="application/x-apple-diskimage"||t==="application/x-rar-compressed"||t==="application/zip"?`${e}zip-32.svg`:t.includes("image/")?`${e}image-32.svg`:t.includes("audio/")?`${e}sound-32.svg`:t.includes("video/")?`${e}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${e}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${e}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const Cr={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"},mq={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},ft="esri-attachments",Fe={base:ft,loaderContainer:`${ft}__loader-container`,loader:`${ft}__loader`,fadeIn:`${ft}--fade-in`,container:`${ft}__container`,containerList:`${ft}__container--list`,containerPreview:`${ft}__container--preview`,actions:`${ft}__actions`,deleteButton:`${ft}__delete-button`,addAttachmentButton:`${ft}__add-attachment-button`,errorMessage:`${ft}__error-message`,items:`${ft}__items`,item:`${ft}__item`,itemButton:`${ft}__item-button`,itemMask:`${ft}__item-mask`,itemMaskIcon:`${ft}__item-mask--icon`,itemImage:`${ft}__image`,itemImageResizable:`${ft}__image--resizable`,itemLabel:`${ft}__label`,itemFilename:`${ft}__filename`,itemChevronIcon:`${ft}__item-chevron-icon`,itemLink:`${ft}__item-link`,itemLinkOverlay:`${ft}__item-link-overlay`,itemLinkOverlayIcon:`${ft}__item-link-overlay-icon`,itemEditIcon:`${ft}__item-edit-icon`,itemAddIcon:`${ft}__item-add-icon`,itemAddButton:`${ft}__item-add-button`,formNode:`${ft}__form-node`,fileFieldset:`${ft}__file-fieldset`,fileLabel:`${ft}__file-label`,fileName:`${ft}__file-name`,fileInput:`${ft}__file-input`,metadata:`${ft}__metadata`,metadataFieldset:`${ft}__metadata-fieldset`,progressBar:`${ft}__progress-bar`},ZA=window.CSS;let Sn=class extends $t{constructor(e,i){super(e,i),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=null,this.visibleElements={...mq},this._supportsImageOrientation=ZA&&ZA.supports&&ZA.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}normalizeCtorArgs(e){return e!=null&&e.viewModel||(e={viewModel:new lU,...e}),e}initialize(){this.addHandles([St(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),St(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),N(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),be)])}loadDependencies(){return Gt({icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242]))})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get icon(){return"attachment"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...mq,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.addAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new L("attachments:add-attachment",this.messages.addErrorMessage,r)),r})}deleteAttachment(e){const{viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.deleteAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new L("attachments:delete-attachment",this.messages.deleteErrorMessage,r)),r})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:i}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(i).then(r=>(this._set("submitting",!1),this._set("error",null),e.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new L("attachments:update-attachment",this.messages.updateErrorMessage,r)),r})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,i=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",i}deleteFile(e){var r;const i=this.viewModel.deleteFile(e||((r=this.viewModel.activeFileInfo)==null?void 0:r.file));return this.viewModel.mode="view",i}render(){const{submitting:e,viewModel:i}=this,{state:r}=i;return b("div",{class:this.classes(Fe.base,K.widget)},e?this._renderProgressBar():null,r==="loading"?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const{error:e,visibleElements:i}=this;return e&&i.errorMessage?b("div",{class:Fe.errorMessage,key:"error-message"},e.message):null}_renderAttachments(){const{activeFileInfo:e,mode:i,activeAttachmentInfo:r}=this.viewModel;return i==="add"?this._renderAddForm():i==="edit"?this._renderDetailsForm(r||e):this._renderAttachmentContainer()}_renderLoading(){return b("div",{class:Fe.loaderContainer,key:"loader"},b("div",{class:Fe.loader}))}_renderProgressBar(){return this.visibleElements.progressBar?b("div",{class:Fe.progressBar,key:"progress-bar"}):null}_renderAddForm(){const{submitting:e,selectedFile:i}=this,r=e||!i,n=this.visibleElements.cancelAddButton?b("button",{bind:this,class:this.classes(K.button,K.buttonTertiary,K.buttonSmall,K.buttonHalf,e&&K.buttonDisabled),disabled:e,onclick:this._cancelForm,type:"button"},this.messages.cancel):null,s=this.visibleElements.addSubmitButton?b("button",{class:this.classes(K.button,K.buttonSecondary,K.buttonSmall,K.buttonHalf,{[K.buttonDisabled]:r}),disabled:r,type:"submit"},this.messages.add):null,o=i?b("span",{class:Fe.fileName,key:"file-name"},i.name):null,a=b("form",{afterCreate:T0,afterRemoved:K8,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},b("fieldset",{class:Fe.fileFieldset},o,b("label",{class:this.classes(Fe.fileLabel,K.button,K.buttonSecondary)},i?this.messages.changeFile:this.messages.selectFile,b("input",{bind:this,class:Fe.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),s,n);return b("div",{class:Fe.formNode,key:"add-form-container"},a)}_renderDetailsForm(e){var T,M,x;const{visibleElements:i,viewModel:r,selectedFile:n,submitting:s}=this,{capabilities:o}=r,a=s||!n;let u,d,p,h;n?(u=n.type,d=n.name,p=n.size):e&&"file"in e?(u=e.file.type,d=e.file.name,p=e.file.size):e&&"contentType"in e&&(u=e.contentType,d=e.name,p=e.size,h=e.url);const m=o.editing&&((T=o.operations)!=null&&T.delete)&&i.deleteButton?b("button",{bind:this,class:this.classes(K.button,K.buttonSmall,K.buttonTertiary,Fe.deleteButton,{[K.buttonDisabled]:s}),disabled:s,key:"delete-button",onclick:C=>this._submitDeleteAttachment(C,e),type:"button"},this.messages.delete):void 0,y=o.editing&&((M=o.operations)!=null&&M.update)&&i.updateButton?b("button",{class:this.classes(K.button,K.buttonSmall,K.buttonThird,{[K.buttonDisabled]:a}),disabled:a,key:"update-button",type:"submit"},this.messages.update):void 0,g=this.visibleElements.cancelUpdateButton?b("button",{bind:this,class:this.classes(K.button,K.buttonSmall,K.buttonTertiary,K.buttonThird,{[K.buttonDisabled]:s}),disabled:s,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0,v=o.editing&&((x=o.operations)!=null&&x.update)?b("fieldset",{class:Fe.fileFieldset,key:"file"},b("span",{class:Fe.fileName,key:"file-name"},d),b("label",{class:this.classes(Fe.fileLabel,K.button,K.buttonSecondary)},this.messages.changeFile,b("input",{bind:this,class:Fe.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0,_=b("fieldset",{class:Fe.metadataFieldset,key:"size"},b("label",null,oDe(this.messagesUnits,p??0))),w=b("fieldset",{class:Fe.metadataFieldset,key:"content-type"},b("label",null,u)),S=h!=null?b("a",{class:Fe.itemLink,href:h,rel:"noreferrer",target:"_blank"},this._renderImageMask(e,400),b("div",{class:Fe.itemLinkOverlay},b("span",{class:Fe.itemLinkOverlayIcon},b("calcite-icon",{icon:"launch"})))):this._renderImageMask(e,400),E=b("form",{afterCreate:T0,afterRemoved:K8,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:C=>this._submitUpdateAttachment(C,e)},b("div",{class:Fe.metadata},_,w),v,b("div",{class:Fe.actions},m,g,y));return b("div",{class:Fe.formNode,key:"edit-form-container"},S,E)}_renderImageMask(e,i){return e?"file"in e?this._renderGenericImageMask(e.file.name,e.file.type):this._renderImageMaskForAttachment(e,i):null}_renderGenericImageMask(e,i){const{supportsResizeAttachments:r}=this.viewModel,n=BDe(i),s={[Fe.itemImageResizable]:r};return b("div",{class:this.classes(Fe.itemMaskIcon,Fe.itemMask),key:n},b("img",{alt:e,class:this.classes(s,Fe.itemImage),src:n,title:e}))}_renderImageMaskForAttachment(e,i){const{supportsResizeAttachments:r}=this.viewModel;if(!e)return null;const{contentType:n,name:s,url:o}=e;if(!r||!hq(n))return this._renderGenericImageMask(s,n);const a=this._getCSSTransform(e),u=a?{transform:a,"image-orientation":"none"}:{},d=`${o}${o!=null&&o.includes("?")?"&":"?"}w=${i}`,p={[Fe.itemImageResizable]:r};return b("div",{class:this.classes(Fe.itemMask),key:d},b("img",{alt:s,class:this.classes(p,Fe.itemImage),src:d,styles:u,title:s}))}_renderFile(e){const{file:i}=e;return b("li",{class:Fe.item,key:i},b("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:Fe.itemButton,key:"details-button",onclick:()=>this._startEditFile(e),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(e),b("label",{class:Fe.itemLabel},b("span",{class:Fe.itemFilename},i.name||this.messages.noTitle),b("span",{"aria-hidden":"true",class:this.classes(Fe.itemChevronIcon,qy(this.container)?Cr.left:Cr.right)}))))}_renderAttachmentInfo({attachmentInfo:e,displayType:i}){const{viewModel:r,effectiveDisplayType:n}=this,{capabilities:s,supportsResizeAttachments:o}=r,{contentType:a,name:u,url:d}=e,p=this._renderImageMask(e,i==="list"?48:400),h=s.editing?b("span",{"aria-hidden":"true",class:this.classes(Fe.itemChevronIcon,qy(this.container)?Cr.left:Cr.right)}):null,m=[p,n==="preview"&&o&&hq(a)?null:b("label",{class:Fe.itemLabel},b("span",{class:Fe.itemFilename},u||this.messages.noTitle),h)],y=s.editing?b("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:Fe.itemButton,"data-attachment-info-id":e.id,key:"details-button",onclick:()=>this._startEditAttachment(e),title:this.messages.attachmentDetails,type:"button"},m):b("a",{class:Fe.itemButton,href:d??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},m);return b("li",{class:Fe.item,key:e},y)}_renderAttachmentContainer(){var g;const{effectiveDisplayType:e,viewModel:i,visibleElements:r}=this,{attachmentInfos:n,capabilities:s,fileInfos:o}=i,a=!!(n!=null&&n.length),u=!!(o!=null&&o.length),d={[Fe.containerList]:e!=="preview",[Fe.containerPreview]:e==="preview"},p=s.editing&&((g=s.operations)!=null&&g.add)&&r.addButton?b("button",{bind:this,class:this.classes(K.button,K.buttonTertiary,Fe.addAttachmentButton),onclick:()=>this._startAddAttachment(),type:"button"},b("span",{"aria-hidden":"true",class:this.classes(Fe.itemAddIcon,Cr.plus)}),this.messages.add):void 0,h=a?b("ul",{class:Fe.items,key:"attachments-list"},n.toArray().map(v=>this._renderAttachmentInfo({attachmentInfo:v,displayType:e}))):void 0,m=u?b("ul",{class:Fe.items,key:"file-list"},o.toArray().map(v=>this._renderFile(v))):void 0,y=u||a?void 0:b("div",{class:K.empty},this.messages.noAttachments);return b("div",{class:this.classes(Fe.container,d),key:"attachments-container"},h,m,y,p)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){var n;const i=e.target,r=(n=i.files)==null?void 0:n.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,i){e.preventDefault(),i&&("file"in i?this.deleteFile(i.file):i&&this.deleteAttachment(i))}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,i){e.preventDefault(),i&&"file"in i?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:i}=this;i.activeFileInfo=null,i.activeAttachmentInfo=e,i.mode="edit"}_startEditFile(e){const{viewModel:i}=this;i.activeAttachmentInfo=null,i.activeFileInfo=e,i.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:i}=e;return!this._supportsImageOrientation&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};l([c()],Sn.prototype,"capabilities",null),l([c()],Sn.prototype,"displayType",void 0),l([c({readOnly:!0})],Sn.prototype,"effectiveDisplayType",null),l([c()],Sn.prototype,"graphic",null),l([c()],Sn.prototype,"icon",null),l([c()],Sn.prototype,"label",null),l([c(),Ue("esri/widgets/Attachments/t9n/Attachments")],Sn.prototype,"messages",void 0),l([c(),Ue("esri/core/t9n/Units")],Sn.prototype,"messagesUnits",void 0),l([c({readOnly:!0})],Sn.prototype,"selectedFile",void 0),l([c({readOnly:!0})],Sn.prototype,"submitting",void 0),l([c({readOnly:!0})],Sn.prototype,"error",void 0),l([c({type:lU})],Sn.prototype,"viewModel",void 0),l([c()],Sn.prototype,"visibleElements",void 0),l([We("visibleElements")],Sn.prototype,"castVisibleElements",null),Sn=l([$("esri.widgets.Attachments")],Sn);const HDe=Sn,poe={danger:"exclamation-mark-circle",info:"information",success:"check",warning:"exclamation-mark-triangle",brand:void 0,neutral:void 0,inverse:void 0},Ag="esri-editor__prompt",Og={base:Ag,header:`${Ag}__header`,heading:`${Ag}__header__heading`,message:`${Ag}__message`,divider:`${Ag}__divider`,actions:`${Ag}__actions`},qDe=()=>Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),scrim:()=>k(()=>import("./calcite-scrim-BZKfzama.js"),__vite__mapDeps([283,265,240,235,241,242,243,245])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),"radio-button":()=>k(()=>import("./calcite-radio-button-B5bB2U0E.js"),__vite__mapDeps([294,257,235,234,236,237,238,239])),"radio-button-group":()=>k(()=>import("./calcite-radio-button-group-BBdDVhdp.js"),__vite__mapDeps([295,242,235,239,268,244,270]))});function hoe({actions:t,context:e,headingLevel:i,message:r,title:n,...s}){const{primary:o,secondary:a}=t;let u;switch(e){case"danger":u="danger";break;case"info":u="brand";break;default:u="neutral"}const d=b("calcite-button",{afterCreate:h=>qa(h),appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:u,onclick:o.action,width:a?"half":"full"},o.label),p=a&&b("calcite-button",{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:u,onclick:a.action,width:"half"},a.label);return b("calcite-scrim",{"data-testid":"prompt",key:"prompt"},b("div",{class:`${Og.base}--${e}`},b("div",{class:Og.header},b("calcite-icon",{icon:poe.warning}),b(Ya,{class:Og.heading,level:i},n)),b("div",{class:Og.message},r),WDe(s)??b("div",{class:Og.divider}),b("div",{class:Og.actions},p,d)))}function WDe({radios:t,onRadioSelection:e,defaultRadioSelection:i}){return t!=null&&t.length?b("calcite-radio-button-group",{name:"PromptChoiceList"},t.map(r=>b("calcite-label",{layout:"inline"},b("calcite-radio-button",{checked:r.value===i,value:r.value,onCalciteRadioButtonChange:()=>e==null?void 0:e(r.value)}),r.label))):void 0}const Fo="esri-feature-form",JA=`${Fo}__group`,Rg=`${Fo}__input`,YA=`${Fo}__related-records`,Xt={base:Fo,form:`${Fo}__form`,formHeader:`${Fo}__form-header`,label:`${Fo}__label`,labelTextContent:`${Fo}__label-text-content`,fieldInput:`${Rg}`,inputRadio:`${Rg}--radio`,inputRadioGroup:`${Rg}--radio-group`,inputRadioLabel:`${Rg}--radio-label`,inputDisabled:`${Rg}--disabled`,inputSwitch:`${Rg}--switch`,centeredButton:`${Fo}__centered-button`,description:`${Fo}__description-text`,listObserver:`${Fo}__list-observer`,relatedRecordsHeader:`${YA}_header`,relatedRecordsLabel:`${YA}_label`,relatedRecordsList:`${YA}_list`,dateInputContainer:`${`${Fo}__date`}-input-container`,textElement:`${Fo}__text-element`,group:JA,groupSequential:`${JA}--sequential`,groupActive:`${JA}--active`},ib=t=>(t==null?void 0:t.type)==="field",Qh=t=>(t==null?void 0:t.type)==="group",Z2=t=>(t==null?void 0:t.type)==="relationship",moe=t=>t.type==="text",KA=t=>!Qh(t)&&t.group!=null,uU=t=>t.reduce((e,i)=>Qh(i)?[...e,...i.inputs]:[...e,i],[]),ZDe=t=>uU(t).filter(ib),JDe=t=>uU(t).filter(Z2),fq=t=>t!=null&&(Yy(t,"combo-box")||Yy(t,"radio-buttons")),Yy=(t,e)=>{var i;return t!=null&&((i=t.input)==null?void 0:i.type)===e},yq=t=>t!=null&&(Yy(t,"text-box")||Yy(t,"text-area")),YDe=({domain:t,inputType:e="text-box",dataType:i})=>i==="number"&&e==="text-box"&&(!t||t.type!=="coded-value");function J2(t){const{attributes:e,fieldsIndex:i,label:r,timeZone:n}=t;if(!e||typeof e!="object")return r;const s=Object.keys(e).filter(u=>PS(r,u)),o=s.map(u=>e[u]),a=s.map(u=>i.get(u)).filter(ot);return iVe(r,foe({values:o,fields:a,timeZone:n}))}const Y2="expression/",KDe="expr/",XDe="field/";function QDe(t){const[e,i]=t.split(Y2);return e===""&&i?i:(U.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${t} is not a valid expression reference of the form '${Y2}/expressionName'`),"")}function gq(t){return`${Y2}${t}`}function vq(t){return`${XDe}${t}`}function eVe(t){return t.startsWith(Y2)}function tVe(t){return t.startsWith(KDe)}function foe(t){const{fields:e,values:i}=t,r=t.timeZone??void 0,n=e.map((s,o)=>{let a=i[o];if(s.domain&&s.domain.type==="coded-value"){const u=s.domain.codedValues.find(d=>d.code===a);u!=null&&u.name&&(a=u.name)}return(w$(s)||Lb(s))&&(a=gQ(s,a,{timeZone:r,...S5(s)})),[s.name,a]});return Object.fromEntries(n)}function iVe(t,e){return mu(mu(t,i=>`{${i.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([i,r])=>[i.toLowerCase(),r])))}const K2=t=>{var i,r,n,s;const e={typeFieldName:null,types:[]};return t&&(t.type==="subtype-sublayer"?(e.typeFieldName=(i=t.parent)==null?void 0:i.subtypeField,e.types=((r=t.parent)==null?void 0:r.subtypes)??[]):t.type==="subtype-group"||t.type==="feature"&&((n=t.subtypes)!=null&&n.length)?(e.typeFieldName=t.subtypeField,e.types=t.subtypes??[]):"types"in t&&t.types&&(e.typeFieldName=t.typeIdField,e.types=t.types.map(({id:o,name:a,domains:u})=>({code:o,name:a,domains:u}))),e.typeFieldName!=null&&(e.typeFieldName=((s=t.getField(e.typeFieldName))==null?void 0:s.name)??e.typeFieldName)),e},rVe=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};var qb;(function(t){t.TOO_SHORT="length-validation-error::too-short",t.TOO_LONG="length-validation-error::too-long"})(qb||(qb={}));const bq={type:"number"},_q={type:"number",intlOptions:{notation:"scientific"}};function wq(t){return t>=1e7||t<=-1e7}function nVe(t,{validationErrors:e}){return t.max!=null&&t.min!=null?e.outsideRange:t.max!=null?e.outsideRangeMax:e.outsideRangeMin}const sVe=(t,e,i)=>{const{dataType:r,error:n,minLength:s,value:o,required:a}=t,u=e==null?void 0:e.validationErrors;if(!u||!n)return null;if(a&&o===null)return u.cannotBeNull;if(n===gm.VALUE_OUT_OF_RANGE||n===Ab.OUT_OF_RANGE){const{field:d,range:p}=t,h={type:"date",intlOptions:{timeZone:d.type==="date"&&i?i:void 0,...S5(d)}},m=nVe(p,e);return Wr(m,p,{format:{max:r==="date"?h:p.max!=null&&wq(p.max)?_q:bq,min:r==="date"?h:p.min!=null&&wq(p.min)?_q:bq}})}return n===gm.INVALID_CODED_VALUE?u.invalidCodedValue:n===Ob.INVALID_TYPE?u.invalidType:n===qb.TOO_SHORT?Wr(u.tooShort,{min:s}):(qb.TOO_LONG,null)},oVe=t=>{var n;if(!t)return;const e=t.layer,i=e&&"geometryType"in e?e.geometryType:void 0,r=(n=t.geometry)==null?void 0:n.type;return r==="polyline"||i==="polyline"?"line":r==="mesh"||i==="mesh"||i==="multipatch"?"cube":r==="multipoint"||i==="multipoint"?"point":r||i||"table"},aVe=t=>{var i;const e=[];if(t.formTemplate){const{description:r,title:n}=t.formTemplate;(i=t.fields)==null||i.forEach(s=>{const o=n&&PS(n,s.name),a=r&&PS(r,s.name);(o||a)&&e.push(s.name)})}return e};function lVe(t,e){var r;const i=e??("formTemplate"in t&&t.formTemplate);return i?(((r=i.elements)==null?void 0:r.filter(c4))??[]).some(({fieldName:n})=>!t.fieldsIndex.get(n)):!1}function uVe(t,e){return t==null||e.onValue!==t&&e.offValue!==t}function cVe(t,e){var i;switch(e.objectType){case"any":return!0;case"null":return t==null;case"code":return t===((i=e.codedValue)==null?void 0:i.code);case"range":return t!=null&&e.minValue!=null&&e.maxValue!=null&&+t>=e.minValue&&+t<=e.maxValue;default:return e.objectType,!1}}function dVe(t,e,i){const r=fY(t),n=r==null?void 0:r.find(o=>o.code===i);if(!n)return!1;const s=r==null?void 0:r.find(o=>o.code===e);return!tV(n.defaultValues,s==null?void 0:s.defaultValues)&&Object.values(n.defaultValues).some(o=>o!=null)}let Gf=class extends q{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.codedValue=null}};l([c()],Gf.prototype,"objectType",void 0),l([c()],Gf.prototype,"maxValue",void 0),l([c()],Gf.prototype,"minValue",void 0),l([c()],Gf.prototype,"codedValue",void 0),Gf=l([$("esri.layers.support.ContingentValue")],Gf);const dn=Gf;let zf=class extends q{constructor(e){super(e),this.isRetired=!1}};l([c()],zf.prototype,"id",void 0),l([c()],zf.prototype,"isRetired",void 0),l([c()],zf.prototype,"subtype",void 0),l([c()],zf.prototype,"values",void 0),zf=l([$("esri.layers.support.Contingency")],zf);const Sq=zf;let j1=class extends q{constructor(e){super(e)}};l([c()],j1.prototype,"fieldGroup",void 0),l([c()],j1.prototype,"type",void 0),j1=l([$("esri.layers.support.ContingencyConstraintViolation")],j1);const $q=j1;let G1=class extends q{constructor(e){super(e)}};l([c()],G1.prototype,"contingentValuesAllGroups",void 0),l([c()],G1.prototype,"contingentValuesByFieldGroup",void 0),G1=l([$("esri.layers.support.ContingentValuesResult")],G1);const pVe=G1;let Bf=class extends q{constructor(e){super(e),this.fields=null,this.isEditingRestrictive=!1}};l([c()],Bf.prototype,"name",void 0),l([c()],Bf.prototype,"fields",void 0),l([c()],Bf.prototype,"isEditingRestrictive",void 0),l([c()],Bf.prototype,"contingencies",void 0),Bf=l([$("esri.layers.support.FieldGroup")],Bf);const ZN=Bf;var lM;let Sh=lM=class extends ig(uo){constructor(t){super(t),this.request=Ee,this.fieldGroups=null,this.fieldGroupDefinitions=null}initialize(){}get subtypeFieldName(){return K2(this.layer).typeFieldName}static async createLoadedLayerContingentValuesCache(t){await t.load();const e=t.sourceJSON;if(t.layerId===void 0)return null;const i=e.hasContingentValuesDefinition;if(i)return new lM({layer:t}).load();if(i===void 0){const r=du(t.url);if(r==null)return null;const n=r.url.path;if((await Tq(n)).supportsQueryDataElements){const s=t.layerId.toString(),o=await Eq(n,s);if(o){const a=o.map(u=>({name:u.name,isEditingRestrictive:u.isEditingRestrictive,fields:u.fieldNames.names.map(d=>t.fieldsIndex.normalizeFieldName(d))}));return new lM({layer:t,fieldGroupDefinitions:a}).load()}}}return null}async load(t){const e=this.layer.load(t).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,t));return this.addResolvingPromise(e),this}validateContingencyConstraints(t,e){const i=Object.keys(t),r=[],n=[];for(const s of this.fieldGroups){const o=s.isEditingRestrictive?"error":"warning";if(e&&!s.fields.some(p=>e.includes(p)))continue;if(!s.fields.every(p=>i.includes(p))){n.push(new $q({fieldGroup:s,type:o}));continue}let a=!1;const u=t[this.subtypeFieldName],d=s.contingencies.filter(p=>!(!p.isRetired&&p.subtype)||p.subtype.code===u);if(d.length!==0){for(const p of d){let h=!0;for(const m in p.values){const y=p.values[m];if(y.objectType!=="any"){if(y.objectType==="null"){if(t[m]!=null){h=!1;break}}else if(y.objectType==="code"){if(t[m]!==y.codedValue.code){h=!1;break}}else if(y.objectType==="range"){const g=t[m];if(g<y.minValue||g>y.maxValue){h=!1;break}}}}if(h){a=!0;break}}a||r.push(new $q({fieldGroup:s,type:o}))}}return{invalid:r,incomplete:n}}getContingentValues(t,e,i=!1){const r=t[this.subtypeFieldName],n=r!=null,s={};let o=[];const a=this.fieldGroups.filter(u=>u.fields.includes(e));o.push(new dn({objectType:"any"}));for(const u of a){let d=[];const p=u.contingencies.filter(y=>!(y.isRetired||y.subtype&&n&&y.subtype.code!==r));let h=!1;const m={};for(const y of p){let g,v=!0;for(const _ in y.values){const w=y.values[_];if(e!==_){if(t[_]!==void 0&&w.objectType!=="any"){if(w.objectType==="null")t[_]!==null&&(v=!1);else if(w.objectType==="code")t[_]!==w.codedValue.code&&(v=!1);else if(w.objectType==="range"){const S=t[_];(S<w.minValue||S>w.maxValue)&&(v=!1)}}}else g=w,h=h||w.objectType==="range"}if(g&&v){if(g.objectType==="any"){d.length=0,d.push(g);break}const _=hVe(g);m[_]||d.push(g),m[_]=!0}}h&&(d=mVe(d)),s[u.name]=d,o=i?gVe(o,d):[]}return a.length===1&&i&&(o=[]),new pVe({contingentValuesAllGroups:o,contingentValuesByFieldGroup:s})}async _initializeContingentValues(t,e){const i=t??await this._fetchFieldGroupDefs(e);if(i.length===0)return void(this.fieldGroups=[]);const r=await this._fetchContingentValues(i,e);this.fieldGroups=r}async _fetchFieldGroupDefs(t){if(this.layer.layerId===void 0)return[];const e=this.layer.sourceJSON,i=this.layer.layerId.toString(),r=du(this.layer.url).url.path;return e.hasContingentValuesDefinition?(await vVe(r,i,t)).map(n=>({name:n.name,isEditingRestrictive:n.restrictive,fields:n.fields.map(s=>this.layer.fieldsIndex.normalizeFieldName(s))})):e.hasContingentValuesDefinition!==void 0?[]:Tq(r,t).then(async n=>n.supportsQueryDataElements?(await Eq(r,i,t)).map(s=>({name:s.name,isEditingRestrictive:s.isEditingRestrictive,fields:s.fieldNames.names.map(o=>this.layer.fieldsIndex.normalizeFieldName(o))})):[])}async _fetchContingentValues(t,e){if(this.layer.layerId===void 0)return[];const i=this.layer.sourceJSON,r=this.layer.layerId.toString(),n=du(this.layer.url).url.path;if(i.hasContingentValuesDefinition){const o=await _Ve(n,r,e);return this._constructFieldGroupsAGOL(t,o)}const s=await bVe(n,r,e);return this._constructFieldGroupsEnterprise(t,s)}_constructFieldGroupsAGOL(t,e){return t.map(i=>{const r=e.contingentValuesDefinition.fieldGroups.find(n=>n.name===i.name);if(r){let n=[];return n=e.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(i,e,r.subTypes):this._parseAGOLFieldGroup(i,e,r.contingentValues),new ZN({name:i.name,isEditingRestrictive:i.isEditingRestrictive,fields:i.fields,contingencies:n})}return null}).filter(ot)}_parseAGOLFieldGroupSubtype(t,e,i){let r=[];return i==null||i.forEach(n=>{const s=this._getSubtypeAGOL(n.name);r=r.concat(this._parseAGOLFieldGroup(t,e,n.contingentValues,s))}),r}_parseAGOLFieldGroup(t,e,i,r=null){const n=[];for(const s of i??[]){const o=this._parseAGOLContingency(s,t,e,r);n.push(o)}return n}_parseAGOLContingency(t,e,i,r){const n=t.id,s=!!t.retired&&t.retired===1,o={};for(let a=0,u=0;a<e.fields.length;a++){const d=e.fields[a],p=i.typeCodes[t.types[a]];if(p==="Code"){let h=t.values[u];u++;const m=this._getDomain(r,d),y=this.layer.getField(d);if((y==null?void 0:y.type)==="string"){const _=i.stringDicts.find(w=>w.domain===(m==null?void 0:m.name));_&&(h=_.entries[h])}const g=m==null?void 0:m.codedValues.find(_=>_.code===h),v=new dn({codedValue:g,objectType:"code"});o[d]=v}else if(p==="Range"){const h=t.values[u];u++;const m=h.range[0],y=h.range[1],g=new dn({minValue:m,maxValue:y,objectType:"range"});o[d]=g}else if(p==="Any"){const h=new dn({objectType:"any"});o[d]=h}else{const h=new dn({objectType:"null"});o[d]=h}}return new Sq({id:n,isRetired:s,subtype:r,values:o})}_constructFieldGroupsEnterprise(t,e){const i=e.fieldGroups;return t.map(r=>{const n=i.find(s=>s.name===r.name);if(n){const s=n.contingencies.map(o=>{const a=o.id,u=o.isRetired||!1,d=this._getSubtypeEnterprise(o.subtypeCode),p={};for(let h=0;h<r.fields.length;h++){const m=r.fields[h];let y=o.values[h];if(typeof y=="number"||typeof y=="string"){const g=this._getDomain(d,m),v=this.layer.getField(m);v2(v)?y=e.stringDictionary[y]:T5(v)&&(y=new Date(`${y}+00:00`).getTime());const _=g==null?void 0:g.codedValues.find(S=>S.code===y),w=new dn({codedValue:_,objectType:"code"});p[m]=w}else if(typeof y=="object"){const g=y.minValue,v=y.maxValue,_=new dn({minValue:g,maxValue:v,objectType:"range"});p[m]=_}else if(y){const g=new dn({objectType:"any"});p[m]=g}else{const g=new dn({objectType:"null"});p[m]=g}}return new Sq({id:a,isRetired:u,subtype:d,values:p})});return new ZN({name:r.name,isEditingRestrictive:r.isEditingRestrictive,fields:r.fields,contingencies:s})}return null}).filter(ot)}_getSubtypeEnterprise(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.code===t);i=QF.fromJSON(r)}return i||null}_getSubtypeAGOL(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.name===t);i=QF.fromJSON(r)}return i||null}_getDomain(t,e){const i=t?wVe(t,e):this.layer.getFieldDomain(e);return(i==null?void 0:i.type)==="inherited"?this.layer.getFieldDomain(e):i}};function hVe(t){switch(t.objectType){case"any":return"@any@";case"null":return"@null@";case"code":return t.codedValue.name+t.codedValue.code.toString();case"range":return t.minValue.toString()+"-"+t.maxValue.toString()}}function mVe(t){let e,i;t.sort((n,s)=>n.objectType==="null"?-1:s.objectType==="null"?1:n.minValue-s.minValue);const r=[];for(const n of t)n.objectType!=="null"?e!=null&&i!=null?i<n.minValue?(r.push(new dn({objectType:"range",minValue:e,maxValue:i})),e=n.minValue,i=n.maxValue):i<n.maxValue&&(i=n.maxValue):(e=n.minValue,i=n.maxValue):r.push(n);return r.push(new dn({objectType:"range",minValue:e,maxValue:i})),r}function fVe(t,e){const i=[];let r,n=0;for(const s of t)for(;n<e.length;n++){const o=e[n];if(s.objectType==="null"&&o.objectType==="null")i.push(new dn({objectType:"null"}));else{if(s.objectType==="null")break;if(o.objectType==="null")continue}if(s.maxValue<o.minValue)break;if(s.maxValue===o.minValue){i.push(new dn({objectType:"range",minValue:s.maxValue,maxValue:o.minValue}));break}if(!(s.minValue>o.maxValue))if(s.minValue!==o.maxValue){if(r=s.minValue>o.minValue?s.minValue:o.minValue,s.maxValue<o.maxValue){i.push(new dn({objectType:"range",minValue:r,maxValue:s.maxValue}));break}i.push(new dn({objectType:"range",minValue:r,maxValue:o.maxValue}))}else i.push(new dn({objectType:"range",minValue:s.minValue,maxValue:o.maxValue}))}return i}function yVe(t,e){const i=[];for(const r of t)e.some(n=>{if(r.objectType===n.objectType)switch(r.objectType){case"any":case"null":return!0;case"code":return r.codedValue.code===n.codedValue.code&&r.codedValue.name===n.codedValue.name}return!1})&&i.push(r);return i}function gVe(t,e){var n,s;if(t.length===0||e.length===0)return[];if(t[0].objectType==="any")return e;if(e[0].objectType==="any")return t;const i=t[0].objectType==="range"||((n=t[1])==null?void 0:n.objectType)==="range",r=e[0].objectType==="range"||((s=e[1])==null?void 0:s.objectType)==="range";return i||r?fVe(t,e):yVe(t,e)}async function vVe(t,e,i){return Ee(`${t}/${e}/fieldgroups`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data.fieldGroups??[])}async function Eq(t,e,i){return Ee(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return((n=r.data.layerDataElements)==null?void 0:n[0].dataElement.fieldGroups)??[]})}async function Tq(t,e){return Ee(t,{responseType:"json",query:{f:"json"},...e}).then(i=>i.data)}async function bVe(t,e,i){return Ee(`${t}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return(n=r.data.contingentValueSets)==null?void 0:n[0]})}async function _Ve(t,e,i){return Ee(`${t}/${e}/contingentValues`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data)}function wVe(t,e){const i=t.domains;if(i){const[r,n]=Object.entries(i).find(([s])=>s.trim().toLowerCase()===e.trim().toLowerCase())||[];return n||null}return null}l([c({constructOnly:!0})],Sh.prototype,"layer",void 0),l([c({constructOnly:!0})],Sh.prototype,"request",void 0),l([c({type:[ZN]})],Sh.prototype,"fieldGroups",void 0),l([c({constructOnly:!0})],Sh.prototype,"fieldGroupDefinitions",void 0),l([c()],Sh.prototype,"subtypeFieldName",null),Sh=lM=l([$("esri.layers.support.LayerContingentValuesCache")],Sh);const SVe=Sh;let Js=class extends q{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return this.getFormattedLabel((e=this.element)==null?void 0:e.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get label(){var e;return this.getFormattedLabel((e=this.element)==null?void 0:e.label)}get updating(){return!1}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}getFormattedLabel(e){const{feature:i,layer:r,timeZone:n}=this;return r==null||e==null?e:J2({label:e,attributes:i.attributes,fieldsIndex:r.fieldsIndex,timeZone:n})}};l([c({readOnly:!0})],Js.prototype,"description",null),l([c({constructOnly:!0})],Js.prototype,"element",void 0),l([c()],Js.prototype,"evaluatedVisibilityExpression",null),l([c()],Js.prototype,"feature",void 0),l([c()],Js.prototype,"label",null),l([c()],Js.prototype,"layer",void 0),l([c()],Js.prototype,"timeZone",void 0),l([c()],Js.prototype,"type",void 0),l([c()],Js.prototype,"updating",null),l([c()],Js.prototype,"visible",null),l([c()],Js.prototype,"visibilityExpressionExecutor",void 0),Js=l([$("esri.widgets.FeatureForm.InputBase")],Js);const cU=Js;let $h=class extends cU{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const i=Uy(e),r=i==null?void 0:i.operations.supportsEditing,n=rVe(i,this.arcadeEditType);return!(!r||!n)}};l([c()],$h.prototype,"arcadeEditType",void 0),l([c()],$h.prototype,"editable",null),l([c()],$h.prototype,"editableExpressionExecutor",void 0),l([c()],$h.prototype,"evaluatedEditableExpression",null),l([c()],$h.prototype,"layerAllowsEdits",null),$h=l([$("esri.widgets.FeatureForm.EditableInput")],$h);const yoe=$h;var Aa;(function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"})(Aa||(Aa={}));const Iq="__internal-type-based-coded-value-domain__";let Ne=class extends yoe{constructor(e){super(e),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(N(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=!1,yn))}get _dateFormRange(){const{element:e,field:i}=this;if(this.dataType!=="date")return{};const r=e!=null&&e.domain?w0(i,e.domain):null;if(!(e!=null&&e.input))return r??{};const n=e.input,{type:s}=n;let o={};if(s!=="date-picker"&&s!=="time-picker"&&s!=="datetimeoffset-picker"||(o=wQ(i,n.max,n.min)),s==="datetime-picker"){const{max:d,min:p}=n;o={max:d!=null&&xq(d)?d.getTime():null,min:p!=null&&xq(p)?p.getTime():null}}const{max:a,min:u}=o;if(r){const{max:d,min:p}=r,h=of(d)&&(a==null||a!=null&&d<a),m=of(p)&&(u==null||u!=null&&p>u);return{max:h?d:a??null,min:m?p:u??null,rawMax:h?r.rawMax:(o==null?void 0:o.rawMax)??null,rawMin:m?r.rawMin:(o==null?void 0:o.rawMin)??null}}return{min:u,max:a,rawMax:(o==null?void 0:o.rawMax)??null,rawMin:(o==null?void 0:o.rawMin)??null}}get _dateRange(){const{_dateFormRange:e,field:i}=this;if(this.dataType!=="date")return{};const r=w0(i);if(!r)return e;const{max:n,min:s,rawMax:o,rawMin:a}=e;if(i.type==="date"){const{max:u,min:d}=r;return{max:of(n)&&(u===null||u!=null&&n<u)?n:u??null,min:of(s)&&(d===null||d!=null&&s>d)?s:d??null}}if(i.type==="date-only"||i.type==="time-only"||i.type==="timestamp-offset"){const{max:u,min:d,rawMax:p,rawMin:h}=r,m=of(n)&&o&&(u==null||n<u);return{max:m?n:u,min:of(s)&&a&&(d==null||s>d)?s:d,rawMax:m?o:p,rawMin:m?a:h}}return{max:null,min:null}}get _configAllowsEdits(){var s,o;const{element:e,layer:i,name:r}=this;if(e!=null)return e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1;if(i!=null&&i.userHasUpdateItemPrivileges)return!0;const n=i&&"popupTemplate"in i?(o=(s=i==null?void 0:i.popupTemplate)==null?void 0:s.fieldInfos)==null?void 0:o.find(({fieldName:a})=>a===r):null;return(n==null?void 0:n.isEditable)??!0}get _layerAndFieldAllowEdits(){var e;return this.layerAllowsEdits&&((e=this.field)==null?void 0:e.editable)}get _isVisibleByDefault(){const{field:e,layer:i}=this;return!!(e!=null&&e.visible)&&xQ(e,i)}get _isEditTrackingField(){var e;return E5(this.layer).includes((e=this.name)==null?void 0:e.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null}get isSubtypeField(){var i;const{layer:e}=this;if(e&&"subtypeField"in e){const{subtypeField:r,fieldsIndex:n}=e;return(((i=n.get(r))==null?void 0:i.name)??r)===this.name}return!1}get valueIsOutOfDomain(){const{domain:e,value:i,field:r}=this;return!(!e||i==null)&&fP(r,i,e)!==null}get dataType(){const{field:e}=this;return J0(e)?Aa.Number:v2(e)?Aa.Text:w$(e)||Lb(e)?Aa.Date:Aa.Unsupported}get dateDataType(){if(this.dataType===Aa.Date)return this.field.type!=="date"?"string":"number"}get domain(){var a;const{layer:e}=this,{typeFieldName:i,types:r}=K2(e);if(this.isSubtypeField&&"subtypes"in e&&e.subtypes)return new Fb({name:Iq,codedValues:e.subtypes.map(({code:u,name:d})=>new Jd({code:u,name:d}))});if(i===this.name&&this.field.domain==null)return new Fb({name:Iq,codedValues:r.map(({code:u,name:d})=>new Jd({code:u,name:d}))});const{feature:n}=this,s=e==null?void 0:e.getFieldDomain(this.name,{feature:n}),o=(a=this.element)==null?void 0:a.domain;return o!=null&&this._isDomainCompatible(o)?o:s}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){var e;return(e=this.element)==null?void 0:e.hint}get includeDate(){return!(this.dataType!==Aa.Date||this.field.type==="time-only")}get includeTime(){var n;const{element:e,field:i}=this;if(this.dataType!==Aa.Date)return!1;if(i.type==="time-only")return!0;if(i.type==="date-only")return!1;const r=((n=e==null?void 0:e.input)==null?void 0:n.type)==="datetime-picker"?e.input.includeTime:void 0;return r===void 0||r}get includeTimeOffset(){var i;if(this.field.type!=="timestamp-offset")return!1;const e=(i=this.element)==null?void 0:i.input;return!e||e.type==="datetimeoffset-picker"&&e.includeTimeOffset}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){var e,i;return(i=(e=this.element)==null?void 0:e.input)==null?void 0:i.type}get hasInvalidSwitchValue(){const{element:e}=this,i=Yy(e,"switch")?e.input:null;return!i||uVe(this.value,i)}get isRelationshipKeyField(){var r;const{field:e,layer:i}=this;return yE(i)&&!!((r=i.relationships)!=null&&r.some(n=>n.keyField===e.name))}get label(){var i;const{field:e}=this;return this.getFormattedLabel((i=this.element)==null?void 0:i.label)??e.alias??e.name}get maxLength(){if(this.dataType===Aa.Date)return-1;const{field:i,element:r}=this,n=(i==null?void 0:i.length)??-1,s=yq(r)?r.input.maxLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(n===-1||s<=n)?s:n}get minLength(){if(this.dataType===Aa.Date)return-1;const{field:i,element:r}=this,n=(i==null?void 0:i.length)??-1,s=yq(r)?r.input.minLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(n===-1||s<=n)?s:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get range(){const{domain:e,element:i,field:r}=this;if(this.dataType==="date")return this._dateRange;const n=w0(r,e)||E1e(r,e),s=(n==null?void 0:n.max)===Number.MAX_VALUE?null:(n==null?void 0:n.max)??null,o=(n==null?void 0:n.min)===-Number.MAX_VALUE?null:(n==null?void 0:n.min)??null;if(!(i!=null&&i.domain)||i.domain.type!=="range")return{max:s,min:o};const{max:a,min:u}=w0(r)||{};return{max:a!=null&&(s===null||s!=null&&a<s)?a:s,min:u!=null&&(o===null||o!=null&&u>o)?u:o}}get required(){var o;const{editable:e,evaluatedRequiredExpression:i,field:r,visible:n,isSubtypeField:s}=this;return e?(r==null?void 0:r.nullable)===!1||s?!0:!(!n||((o=this.group)==null?void 0:o.visible)===!1||i==null)&&i:!1}set required(e){this._overrideIfSome("required",e)}get showNoValueOptionEnabled(){const{element:e}=this;return!this.required&&(!fq(e)||e.input.showNoValueOption)}get showNoValueLabel(){const{element:e}=this;return fq(e)?e.input.noValueOptionLabel:null}get submittable(){const{field:e,required:i,valid:r,value:n}=this;return(!i||n!=null)&&(!!r||this.initialFeature.getAttribute(e.name)===n)}get timeResolution(){var i;const e=(i=this.element)==null?void 0:i.input;if(e&&(e.type==="datetimeoffset-picker"||e.type==="time-picker"))return e.timeResolution??"minutes"}get timeStep(){return this.timeResolution!=null?Owe.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:i,visibilityExpressionExecutor:r,preservesValueWhenHidden:n}=this;return i!=null&&i.updating||e!=null&&e.updating||n===!1&&r!=null&&r.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){var e,i,r,n;if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&((e=this.group)==null?void 0:e.visible)!==!1,this.preservesValueWhenHidden===!1&&this._fieldInputWasVisibleDuringLifetime&&(((i=this.visibilityExpressionExecutor)==null?void 0:i.lastEvaluatedValue)===!1||((n=(r=this.group)==null?void 0:r.visibilityExpressionExecutor)==null?void 0:n.lastEvaluatedValue)===!1))return this._storedValue!==null&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const s=this.evaluatedValueExpression;return this.dataType===Aa.Date?this._arcadeOutputToDateFieldValue(s):s!=null&&typeof s=="object"?s.toString():s}return this._storedValue}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){var e;return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null&&((e=this.field)==null?void 0:e.visible)!==!1||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(e){const i=this.field.type;try{if(typeof e=="object"){if(e===null)throw new L("feature-form:invalid-date-value");if(Vwe(e))return Dwe(e,i);if("getTime"in e&&typeof e.getTime=="function"&&i==="date")return parseInt(e.getTime(),10);if(i==="date-only"||i==="time-only"||i==="timestamp-offset")return e.toString()}else{if(typeof e=="string")return i==="date"?parseInt(e,10):e;if(typeof e=="number"&&i==="date")return e}throw new L("feature-form:invalid-date-value")}catch{return i==="date"?NaN:""}}_isDomainCompatible(e){const{field:i}=this;if((e==null?void 0:e.type)==="coded-value"){const r=typeof e.codedValues[0].code;if(r==="string"&&v2(i)||r==="number"&&J0(i))return!0}return!!((e==null?void 0:e.type)==="range"&&J0(i)||w$(i)||Lb(i))}_validate(){const{dataType:e,domain:i,field:r,initialFeature:n,minLength:s,range:o,required:a,valid:u,value:d,maxLength:p}=this,h=a&&d==null,m=u!==void 0;if(!h&&n.getAttribute(r.name)===d&&m)return null;if(h)return Ob.INVALID_TYPE;if(e==="text"&&typeof d=="string"){if(s>-1&&d.length<s)return qb.TOO_SHORT;if(p>-1&&d.length>p)return qb.TOO_LONG}return e!=="date"||d==null||Uwe({type:r.type,range:o,value:d})?i?d!==null||a?fP(r,d,i):null:AQ(r,d):Ab.OUT_OF_RANGE}};l([c()],Ne.prototype,"_dateFormRange",null),l([c()],Ne.prototype,"_dateRange",null),l([c()],Ne.prototype,"_storedValue",void 0),l([c()],Ne.prototype,"_configAllowsEdits",null),l([c()],Ne.prototype,"_layerAndFieldAllowEdits",null),l([c()],Ne.prototype,"_isVisibleByDefault",null),l([c()],Ne.prototype,"_isEditTrackingField",null),l([c()],Ne.prototype,"_shouldUseValueExpression",null),l([c()],Ne.prototype,"isSubtypeField",null),l([c()],Ne.prototype,"valueIsOutOfDomain",null),l([c()],Ne.prototype,"dataType",null),l([c()],Ne.prototype,"dateDataType",null),l([c()],Ne.prototype,"domain",null),l([c()],Ne.prototype,"editable",null),l([c({readOnly:!0})],Ne.prototype,"error",void 0),l([c({constructOnly:!0})],Ne.prototype,"preservesValueWhenHidden",void 0),l([c()],Ne.prototype,"evaluatedRequiredExpression",null),l([c()],Ne.prototype,"evaluatedValueExpression",null),l([c()],Ne.prototype,"field",void 0),l([c()],Ne.prototype,"group",void 0),l([c({readOnly:!0})],Ne.prototype,"hint",null),l([c()],Ne.prototype,"includeDate",null),l([c()],Ne.prototype,"includeTime",null),l([c()],Ne.prototype,"includeTimeOffset",null),l([c()],Ne.prototype,"initialFeature",null),l([c({readOnly:!0})],Ne.prototype,"inputType",null),l([c()],Ne.prototype,"hasInvalidSwitchValue",null),l([c()],Ne.prototype,"isRelationshipKeyField",null),l([c()],Ne.prototype,"label",null),l([c()],Ne.prototype,"maxLength",null),l([c()],Ne.prototype,"minLength",null),l([c({readOnly:!0})],Ne.prototype,"name",null),l([c()],Ne.prototype,"range",null),l([c()],Ne.prototype,"required",null),l([c()],Ne.prototype,"requiredExpressionExecutor",void 0),l([c()],Ne.prototype,"showNoValueOptionEnabled",null),l([c()],Ne.prototype,"submittable",null),l([c()],Ne.prototype,"timeResolution",null),l([c()],Ne.prototype,"timeStep",null),l([c({readOnly:!0})],Ne.prototype,"type",void 0),l([c()],Ne.prototype,"updating",null),l([c()],Ne.prototype,"valid",null),l([c({value:null})],Ne.prototype,"value",null),l([c()],Ne.prototype,"valueExpressionExecutor",void 0),l([c()],Ne.prototype,"visible",null),Ne=l([$("esri.widgets.FeatureForm.FieldInput")],Ne);const xq=t=>t&&!Number.isNaN(t.valueOf()),Mq=Ne;var X2;(function(t){t.TimeZoneNotRecognized="TimeZoneNotRecognized"})(X2||(X2={}));const $Ve={[X2.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let EVe=class goe extends Error{constructor(e,i){super(mu($Ve[e],i)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,goe)}};function Pg(t,e,i){return t<e?t-e:t>i?t-i:0}function Fg(t,e,i){return t<e?e:t>i?i:t}let MS=class lr{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,i=1,r=1,n=0,s=0,o=0,a=0,u){if(isNaN(e)||isNaN(i)||isNaN(r)||isNaN(n)||isNaN(s)||isNaN(o)||isNaN(a))return null;const d=se.local(e,i).daysInMonth;let p=se.fromObject({day:Fg(r,1,d),year:e,month:Fg(i,1,12),hour:Fg(n,0,23),minute:Fg(s,0,59),second:Fg(o,0,59),millisecond:Fg(a,0,999)},{zone:pc(u)});return p=p.plus({months:Pg(i,1,12),days:Pg(r,1,d),hours:Pg(n,0,23),minutes:Pg(s,0,59),seconds:Pg(o,0,59),milliseconds:Pg(a,0,999)}),new lr(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,i){const r=pc(i);return e.isUnknownTimeZone||r===Ql.instance?lr.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new lr(e._date.setZone(r))}static dateJSToArcadeDate(e){return new lr(se.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,i="system"){const r=pc(i);return new lr(se.fromJSDate(e,{zone:r}))}static unknownEpochToArcadeDate(e){return new lr(se.fromMillis(e,{zone:Ql.instance}))}static unknownDateJSToArcadeDate(e){return new lr(se.fromMillis(e.getTime(),{zone:Ql.instance}))}static epochToArcadeDate(e,i="system"){const r=pc(i);return new lr(se.fromMillis(e,{zone:r}))}static dateTimeToArcadeDate(e){return new lr(e)}clone(){return new lr(this._date)}changeTimeZone(e){const i=pc(e);return lr.dateTimeToArcadeDate(this._date.setZone(i))}static dateTimeAndZoneToArcadeDate(e,i){const r=pc(i);return e.zone===Ql.instance||r===Ql.instance?lr.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new lr(e.setZone(r))}static nowToArcadeDate(e){const i=pc(e);return new lr(se.fromJSDate(new Date,{zone:i}))}static nowUTCToArcadeDate(){return new lr(se.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===lr.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===Ql.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new lr(this._date.plus(e))}diff(e,i="milliseconds"){return this._date.diff(e._date,i)[i]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,i){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:i&&!this.isUnknownTimeZone})}toFormat(e,i){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,i)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new lr(this._date.toUTC())}toLocal(){return new lr(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const i=se.fromISO(e,{setZone:!0});return new lr(i)}};function pc(t,e=!0){if(t instanceof sg)return t;if(t.toLowerCase()==="system")return"system";if(t.toLowerCase()==="utc")return"UTC";if(t.toLowerCase()==="unknown")return Ql.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const r=pr.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(r)return r}const i=co.create(t);if(!i.isValid){if(e)throw new EVe(X2.TimeZoneNotRecognized);return null}return i}let TVe=class{constructor(e=[]){this._elements=e}length(){return this._elements.length}get(e){return this._elements[e]}toArray(){return this.slice()}slice(e=0,i=this.length()){const r=[];for(let n=e;n<i;n++)r.push(this.get(n));return r}};function Cq(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const i=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const r of t.match(i)||[])switch(r){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=r;break;default:r.length>=2&&r.slice(0,1)==="["&&r.slice(-1)==="]"?e+=`'${r.slice(1,-1)}'`:e+=`'${r}'`}return e}let kq=class Co{constructor(e,i,r){this._year=e,this._month=i,this._day=r,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof Co&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Co(this._year,this._month,this._day)}toDateTime(e){return se.fromObject({day:this.day,month:this.month,year:this.year},{zone:pc(e)})}toDateTimeLuxon(e){return se.fromObject({day:this.day,month:this.month,year:this.year},{zone:pc(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,i=!0){if(e===null||e==="")return this.toString();if(i&&(e=Cq(e)),!e)return"";const r=this.toDateTime("unknown");return MS.dateTimeToArcadeDate(r).toFormat(e,{locale:An(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return MS.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,i){return Co.fromDateTime(this.toUTCDateTime().plus({[e]:i}))}toUTCDateTime(){return se.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const i=se.fromMillis(e,{zone:pr.utcInstance});return i.isValid?Co.fromParts(i.year,i.month,i.day):null}static fromSeconds(e){const i=se.fromSeconds(e,{zone:pr.utcInstance});return i.isValid?Co.fromParts(i.year,i.month,i.day):null}static fromReader(e){if(!e)return null;const i=e.split("-");return i.length!==3?null:new Co(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10))}static fromParts(e,i,r){const n=new Co(e,i,r);return n.isValid===!1?null:n}static fromDateJS(e){return Co.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Co.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,i=null){if(e===""||e===null)return null;const r=[];if(i)(i=Cq(i))&&r.push(i);else if(i===null||i===""){const n=se.fromISO(e,{setZone:!0});return n.isValid?Co.fromParts(n.year,n.month,n.day):null}for(const n of r){const s=se.fromFormat(e,i??n);if(s.isValid)return new Co(s.year,s.month,s.day)}return null}static fromNow(e="system"){const i=se.fromJSDate(new Date).setZone(pc(e));return new Co(i.year,i.month,i.day)}};function fst(t){if(t==null)return null;if(typeof t=="number")return t;let e=t.toLowerCase();switch(e=e.replaceAll(/\s/g,""),e=e.replaceAll("-",""),e){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function yst(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new at({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function gst(t){if(t==null)return null;if(typeof t=="number")return t;let e=t.toLowerCase();switch(e=e.replaceAll(/\s/g,""),e=e.replaceAll("-",""),e){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function vst(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function oI(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function Lq(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let i="";for(const r of t.match(e)||[])switch(r){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":i+=r;break;case"A":case"a":i+="a";break;default:i+=`'${r}'`}return i}let Aq=class Wu{constructor(e,i,r,n){this._hour=e,this._minute=i,this._second=r,this._millisecond=n,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof Wu&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new Wu(this.hour,this.minute,this.second,this.millisecond)}isValid(){return oI(this.hour)&&oI(this.minute)&&oI(this.second)&&oI(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=Lq(e))?se.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:An(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,i,r,n){const s=new Wu(e,i,r,n);return s.isValid()?s:null}static fromReader(e){if(!e)return null;const i=e.split(":");return i.length!==3?null:new Wu(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const i=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),s=Math.floor(e%1e3);return new Wu(n,r,i,s)}static fromDateJS(e){return new Wu(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new Wu(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,i=null){if(e===""||e===null)return null;const r=[];i?(i=Lq(i))&&r.push(i):i!==null&&i!==""||(r.push("HH:mm:ss"),r.push("HH:mm:ss.SSS"),r.push("hh:mm:ss a"),r.push("hh:mm:ss.SSS a"),r.push("HH:mm"),r.push("hh:mm a"),r.push("H:mm"),r.push("h:mm a"),r.push("H:mm:ss"),r.push("h:mm:ss a"),r.push("H:mm:ss.SSS"),r.push("h:mm:ss.SSS a"));for(const n of r){const s=se.fromFormat(e,n);if(s.isValid)return new Wu(s.hour,s.minute,s.second,s.millisecond)}return null}plus(e,i){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return Wu.fromDateTime(this.toUTCDateTime().plus({[e]:i}))}return null}toUTCDateTime(){return se.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}},CS=null;function IVe(t,e,i,r={}){const n=e.elementType,s="value",o=n.type==="array"?[{name:s,type:n.type,elementType:n.elementType}]:n.type==="dictionary"?[{name:s,type:n.type,properties:n.properties}]:[{name:s,type:n.type}];return new TVe(t.map(a=>{const u={};return dU(u,o,{[s]:a},i,r),u[s]}))}function xVe(t,e,i={}){const r=t instanceof Db?new M4({source:t.features,geometryType:t.geometryType,fields:t.fields,spatialReference:t.spatialReference}):t;return e.constructFeatureSet(r,i.spatialReference,null,!0,i.lruCache,i.interceptor)}function MVe(t,e,i={}){const{spatialReference:r,interceptor:n,lruCache:s}=i;return typeof t=="string"?e.createFeatureSetCollectionFromService(t,r,s,n):e.createFeatureSetCollectionFromMap(t,r,s,n)}function CVe(t,e,i,r={}){const n={};return dU(n,e.properties,t,i,r),new CS.Dictionary(n)}function dU(t,e,i,r,n={}){const s={};for(const o of Object.keys(i))s[o.toLowerCase()]=i[o];for(const o of e){const a=o.name.toLowerCase();if(n.variablesPreProcessed)t[a]=s[a];else switch(o.type){case"array":{const u=s[a];t[a]=u==null?null:IVe(u,o,r,n);break}case"feature":{const u=s[a];t[a]=u==null?null:CS.Feature.createFromGraphic(u,n==null?void 0:n.timeZone);break}case"featureSet":{const u=s[a];t[a]=u==null?null:r?xVe(u,r,n):null;break}case"featureSetCollection":{const u=s[a];t[a]=u==null?null:r?MVe(u,r,n):null;break}case"dictionary":{const u=s[a];t[a]=u==null?null:CVe(u,o,r,n);break}case"date":{const u=s[a];t[a]=u?u instanceof MS?u:n!=null&&n.timeZone?MS.dateJSAndZoneToArcadeDate(u,n==null?void 0:n.timeZone):MS.dateJSToArcadeDate(u):null;break}case"dateOnly":{const u=s[a];t[a]=u?u instanceof kq?u:kq.fromReader(u):null;break}case"time":{const u=s[a];t[a]=u?u instanceof Aq?u:Aq.fromReader(u):null;break}case"knowledgeGraph":case"geometry":case"boolean":case"text":case"number":t[a]=s[a]}}}function voe(t,e){for(const i of t)e.push(i),i.type==="dictionary"&&voe(i.properties,e);return e}function Oq(t,e,i,r,n){const{spatialReference:s,interceptor:o,lruCache:a,console:u,abortSignal:d,timeZone:p,services:h={portal:ki.getDefault()}}=i,m={vars:{},spatialReference:s,interceptor:o,timeZone:p,lrucache:a,useAsync:n,services:h,console:u,abortSignal:d};return e&&dU(m.vars,t.variables,e,r,i),m}function Q2(t,e){switch(e.getArcadeType(t)){case"number":case"text":case"boolean":case"point":case"polygon":case"polyline":case"multipoint":case"extent":return t;case"date":return t.toJSDate();case"time":case"dateOnly":return t.toString();case"feature":{const i=(t.type,t),r="geometry"in i?i.geometry():null,n="readAttributes"in i?i.readAttributes():i.attributes;return new Li({geometry:r,attributes:n})}case"dictionary":{const i=t,r=i.attributes,n={};for(const s of Object.keys(r))n[s]=Q2(i.field(s),e);return n}case"array":return("toArray"in t?t.toArray():t).map(i=>Q2(i,e))}return t}const Rq={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$userInput",type:"geometry"},{name:"$graph",type:"knowledgeGraph"}]},Pq={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},Fq=new Map([["aggregate-field",{variables:[{name:"$feature",type:"feature"}]}],["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",Rq],["popup-element",Rq],["feature-reduction-popup",Pq],["feature-reduction-popup-element",Pq],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);function boe(t){const e=Fq.get(t);if(!e){const i=Array.from(Fq.keys()).map(r=>`'${r}'`).join(", ");throw new L("createArcadeProfile:invalid-profile-name",`Invalid profile name '${t}'. You must specify one of the following values: ${i}`)}return R(e)}async function _oe(t,e,i={}){CS||(CS=await Tc());const{arcade:r,arcadeUtils:n}=CS,{loadScriptDependencies:s,referencesMember:o,scriptIsAsync:a}=r,u=voe(e.variables,[]),d=u.filter(T=>T.type==="featureSet"||T.type==="featureSetCollection").map(T=>T.name.toLowerCase()),p=r.parseScript(t,d);if(!p)throw new L("arcade:invalid-script","Unable to create SyntaxTree");const h=n.extractFieldNames(p),m=r.scriptTouchesGeometry(p),y=u.map(T=>T.name.toLowerCase()).filter(T=>o(p,T)),g=a(p,d);await s(p,g,d);const v={vars:{},spatialReference:null,useAsync:g};for(const T of y)v.vars[T]="any";const{lruCache:_}=i,w=r.compileScript(p,v),S=r.featureSetUtils(),{services:E}=i;return{execute:(T,M={})=>{if(g)throw new L("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");const x=w(Oq(e,T,{lruCache:_,...M},S,g));return M.rawOutput?x:Q2(x,n)},executeAsync:async(T,M={})=>{const x=await w(Oq(e,T,{lruCache:_,services:E,...M},S,g));return M.rawOutput?x:Q2(x,n)},isAsync:g,variablesUsed:y,fieldsUsed:h,geometryUsed:m,syntaxTree:p}}const bst=Object.freeze(Object.defineProperty({__proto__:null,createArcadeExecutor:_oe,createArcadeProfile:boe},Symbol.toStringTag,{value:"Module"}));var woe;const kVe=Symbol("FormExpressionArcadeExecutor");let gs=class extends q{constructor(e){super(e),this[woe]=!0,this._lastEvaluatedValue=null,this._abortController=new AbortController,this._stale=!1,this._updatingTracking=new Wo,this._executeAsyncDebounced=Bo(async(i,r,n)=>{const s=await this.executor.executeAsync(i,{...r,abortSignal:n});return n.aborted?this._lastEvaluatedValue:(this._lastEvaluatedValue=s,this._stale=!1,s)})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(e,i){this._abortController=new AbortController;const r=this.executor.execute(e,{...i,abortSignal:this._abortController.signal});return this._lastEvaluatedValue=r,r}async executeAsync(e,i){return this._abortController=new AbortController,this._updatingTracking.addPromise(this._executeAsyncDebounced(e,i??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort(),this._lastEvaluatedValue=null,this._stale=!1}};woe=kVe,l([c()],gs.prototype,"_lastEvaluatedValue",void 0),l([c()],gs.prototype,"_stale",void 0),l([c()],gs.prototype,"_updatingTracking",void 0),l([c({constructOnly:!0})],gs.prototype,"executor",void 0),l([c()],gs.prototype,"isAsync",null),l([c()],gs.prototype,"fieldsUsed",null),l([c()],gs.prototype,"syntaxTree",null),l([c()],gs.prototype,"updating",null),l([c()],gs.prototype,"stale",null),l([c()],gs.prototype,"geometryUsed",null),l([c()],gs.prototype,"variablesUsed",null),l([c()],gs.prototype,"lastEvaluatedValue",null),gs=l([$("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],gs);const LVe=async(t,e)=>{const i=boe("form-calculation"),r=await _oe(t,i,{});return e!=null&&e.fieldsIndex&&(r.fieldsUsed=og(e.fieldsIndex,r.fieldsUsed)),new gs({executor:r})},XA="#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY";let Zu=class extends q{constructor(e){super(e),this._fieldReferencesLookup=new Map,this._fieldsAffectedLookup=new Map,this.preserveFieldValuesWhenHidden=!0,this._latestFieldValues={...e.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}destroy(){this.resetExecutors()}get _asyncExecutors(){return this.executors.filter(e=>e.isAsync)}get _baseContext(){const{editType:e,layer:i,map:r,originalFeature:n,spatialReference:s,timeZone:o}=this.arcadeContextInfo,a=(i==null?void 0:i.type)==="scene"&&i.associatedLayer!=null?i.associatedLayer:i;return[{$originalfeature:n,$editcontext:{editType:e},$layer:a,$featureset:a,$datastore:i==null?void 0:i.url,$map:r},{rawOutput:!0,spatialReference:s??void 0,timeZone:o}]}set feature(e){this._latestFieldValues={...e==null?void 0:e.attributes},this._set("feature",e)}evaluateAll(){return this._evaluate(this.executors)}evaluateAsyncExpressions(){return this._evaluate(this._asyncExecutors)}evaluateExpressions(e){return this._evaluate(e)}evaluateInvalidated(e){const{_fieldReferencesLookup:i,_latestFieldValues:r,feature:n}=this,s=new Set;for(const o of e)if(r[o]=n.getAttribute(o),i.has(o))for(const a of i.get(o))s.add(a);return this._evaluate([...s])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has(XA))return this._evaluate([...this._fieldReferencesLookup.get(XA)])}resetExecutors(){for(const e of this.executors)e.reset()}_buildDependencyGraph(){var u;const{_fieldReferencesLookup:e,_fieldsAffectedLookup:i,executors:r,preserveFieldValuesWhenHidden:n}=this,s=new Map(this.fieldInputs.map(d=>[d.name,d])),o=n===!1,a=new Map(r.map(d=>[d,new Array]));for(const d of r){for(const p of d.fieldsUsed){Xd(e,p,()=>new Set).add(d);const h=s.get(p);[h==null?void 0:h.valueExpressionExecutor,h==null?void 0:h.editableExpressionExecutor,o?(u=h==null?void 0:h.group)==null?void 0:u.visibilityExpressionExecutor:null,o?h==null?void 0:h.visibilityExpressionExecutor:null].filter(m=>m!=null&&m!==d).forEach(m=>{a.get(m).push(d),Xd(i,m,()=>new Set).add(h)})}d.geometryUsed&&Xd(e,XA,()=>new Set).add(d)}return a}async _evaluate(e){const i=new Map,{_dependencyGraph:r,_fieldsAffectedLookup:n,_latestFieldValues:s}=this;for(const a of e)Soe(a,i,r);for(const[a,{resolver:u,dependencyPromises:d}]of i)Promise.all(d).then(async()=>{const[p,h]=this._makeContext(s);return a.executeAsync(p,h)}).then(()=>{if(n.has(a))for(const p of n.get(a))this._latestFieldValues[p.name]=p.value;u.resolve()},p=>{!p||rr(p)||Nq(p)||a.markStale(),u.reject(p)});const o=(await Promise.allSettled(Array.from(i.values(),({resolver:a})=>a.promise))).filter(a=>a.status==="rejected"&&!(rr(a.reason)||Nq(a.reason)));if(o.length>0){const a=new AggregateError(o,`One or more expression executions failed. First error message: ${o[0].reason}`);throw U.getLogger(this).error(a),a}}_makeContext(e){const[i,r]=this._baseContext,n=this.feature.clone();return n.attributes=e,[{...i,$feature:n},r]}get test(){}};l([c()],Zu.prototype,"_asyncExecutors",null),l([c()],Zu.prototype,"_baseContext",null),l([c()],Zu.prototype,"feature",null),l([c({constructOnly:!0})],Zu.prototype,"preserveFieldValuesWhenHidden",void 0),l([c()],Zu.prototype,"executors",void 0),l([c()],Zu.prototype,"fieldInputs",void 0),l([c()],Zu.prototype,"arcadeContextInfo",void 0),Zu=l([$("esri.widgets.FeatureForm.FormExpressionsManager")],Zu);const Soe=(t,e,i)=>{if(e.has(t))return;const r=fn();e.set(t,{resolver:r,dependencyPromises:[]}),t.abort();const n=i.get(t);for(const s of n)Soe(s,e,i),e.get(s).dependencyPromises.push(r.promise)},Nq=t=>t&&typeof t=="object"&&"message"in t&&t.message==="Cancelled";let Sd=class extends cU{constructor(e){super(e),this._expressionTrackingHandles=new Map,this.id=rm().toString(),this.type="group"}initialize(){this.addHandles([N(()=>[this.visible,this.inputs],([e])=>{const{inputs:i}=this,r=!!e&&void 0;for(const n of i)ib(n)&&(n.required=r)},{initial:!0,equals:(e,i)=>i[0]===e[0]&&i[1]===e[1]})])}destroy(){for(const e of this._expressionTrackingHandles.values())e.remove()}get initialState(){return this.element.initialState||"expanded"}get inputs(){return this._get("inputs")}set inputs(e){this.removeAllHandles(),e&&this.addHandles(e.map(i=>N(()=>i.visible,()=>this._dirtyEvaluatedVisibilityExpression()))),this._set("inputs",e)}get open(){return this.initialState==="expanded"}set open(e){this._override("open",e)}get visible(){return this.evaluatedVisibilityExpression!==!1&&this.inputs&&this.inputs.some(e=>e.visible)}_dirtyEvaluatedVisibilityExpression(){const{element:e}=this;e.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};l([c()],Sd.prototype,"id",void 0),l([c()],Sd.prototype,"initialState",null),l([c()],Sd.prototype,"inputs",null),l([c()],Sd.prototype,"open",null),l([c()],Sd.prototype,"type",void 0),l([c()],Sd.prototype,"visible",null),Sd=l([$("esri.widgets.FeatureForm.GroupInput")],Sd);const AVe=Sd,QA=100;let Lt=class extends Ze(vu(q)){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:i}=this;i&&i.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:i}=this;i&&i.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:i}=this;i&&i.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const i=new AbortController;this._queryAbortController=i,await zo(this._query()),this._queryAbortController===i&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const i=new AbortController;this._queryFeatureCountAbortController=i,await zo(this._queryFeatureCount()),this._queryFeatureCountAbortController===i&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryPageController=async()=>{const i=new AbortController;this._queryPageAbortController=i,await zo(this._queryPage()),this._queryPageAbortController===i&&(this._queryPageAbortController=null)},this._queryDebounced=Bo(this._queryController,QA),this._queryFeatureCountDebounced=Bo(this._queryFeatureCountController,QA),this._queryPageDebounced=Bo(this._queryPageController,QA),this._query=async()=>{const{_queryAbortController:i,relatedFeatures:r}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.destroyAll(),this.destroyed||r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:i==null?void 0:i.signal}))))},this.addHandles([N(()=>{var i;return[this.displayCount,this.graphic,this.layer,(i=this.layer)==null?void 0:i.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount]},()=>this._queryDebounced(),be),N(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),N(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.destroyAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:i,featureCount:r}=this,n=1,s=Math.ceil(r/i)||1;this._set("featurePage",Math.min(Math.max(e,n),s))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:i}=this;return e&&(i!=null&&i.loaded)?e.map(r=>{const n=r.clone();return n.field=oU(r.field,i),n}):e??[]}get supportsCacheHint(){var e,i,r;return!!((r=(i=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:i.queryRelated)!=null&&r.supportsCacheHint)}get canLoad(){return!!this.map&&this.relationshipId!=null&&typeof this.objectId=="number"}get canQuery(){var i,r;const e=(r=(i=this.layer)==null?void 0:i.capabilities)==null?void 0:r.queryRelated;return!!(this.relatedLayer&&this.relationship&&this.relationshipId!=null&&this.objectId!=null&&(e!=null&&e.supportsCount)&&(e!=null&&e.supportsPagination))}get itemDescriptionFieldName(){var e;return((e=this.orderByFieldsFixedCasing[0])==null?void 0:e.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,i;return(this.objectIdField&&((i=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:i[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new Y}get relatedLayer(){const{layer:e,map:i,relationship:r}=this;return e!=null&&e.loaded&&i&&r?zDe(i,e,r)??null:null}get relationship(){var r;const{relationshipId:e,layer:i}=this;return e!=null?((r=i==null?void 0:i.relationships)==null?void 0:r.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new Y}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:i,_queryPageAbortController:r,canQuery:n,_loaded:s,canLoad:o}=this;return i||o&&!s?"loading":e||r?"querying":n?"ready":"disabled"}getRelatedFeatureByObjectId(e){return this.relatedFeatures.find(i=>i.getObjectId()===e)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.destroyAll()}async _queryFeatureCount(){const{layer:e,relatedLayer:i,relationshipId:r,objectId:n,_queryFeatureCountAbortController:s,canQuery:o,supportsCacheHint:a}=this;if(await(e==null?void 0:e.load()),await(i==null?void 0:i.load()),!o||!e||!i||n==null)return void this._set("featureCount",0);const u=i.createQuery(),{historicMoment:d,gdbVersion:p}=e,h=new p$({cacheHint:a,gdbVersion:p,historicMoment:d,relationshipId:r,returnGeometry:!1,objectIds:[n],where:u.where??void 0}),m=await e.queryRelatedFeaturesCount(h,{signal:s==null?void 0:s.signal});this._set("featureCount",m[n]||0)}_sliceFeatures(e){const{showAllEnabled:i,displayCount:r}=this;return i?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:i,showAllEnabled:r,_queryPageAbortController:n,featureCount:s}=this;!r||i<2||!s||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var F;const{orderByFieldsFixedCasing:i,showAllEnabled:r,featuresPerPage:n,displayCount:s,layer:o,relationshipId:a,featurePage:u,featureCount:d,relatedLayer:p,supportsCacheHint:h}=this,{canQuery:m,objectId:y}=this;if(!m||!o||!p||y==null)return[];const g=r?((u-1)*n+d)%d:0,v=r?n:s,_=p.objectIdField,w=[...i.map(V=>V.field),...aVe(p),_].filter(ot),S=i.map(V=>`${V.field} ${V.order}`),E=p.createQuery(),{historicMoment:T,gdbVersion:M}=o,x=new p$({orderByFields:S,start:g,num:v,outFields:w,cacheHint:h,historicMoment:T,gdbVersion:M,relationshipId:a,returnGeometry:!1,objectIds:[y],where:E.where??void 0}),C=await o.queryRelatedFeatures(x,{signal:e==null?void 0:e.signal}),O=((F=C[y])==null?void 0:F.features)||[];return O.forEach(V=>{V.sourceLayer=p,V.layer=p}),O}};l([c()],Lt.prototype,"_loaded",void 0),l([c()],Lt.prototype,"_queryAbortController",void 0),l([c()],Lt.prototype,"_queryPageAbortController",void 0),l([c()],Lt.prototype,"_queryFeatureCountAbortController",void 0),l([c({value:1})],Lt.prototype,"featurePage",null),l([c()],Lt.prototype,"featuresPerPage",void 0),l([c({readOnly:!0})],Lt.prototype,"orderByFieldsFixedCasing",null),l([c({readOnly:!0})],Lt.prototype,"supportsCacheHint",null),l([c({readOnly:!0})],Lt.prototype,"canLoad",null),l([c({readOnly:!0})],Lt.prototype,"canQuery",null),l([c()],Lt.prototype,"description",void 0),l([c({readOnly:!0})],Lt.prototype,"itemDescriptionFieldName",null),l([c({value:3})],Lt.prototype,"displayCount",null),l([c({type:Li})],Lt.prototype,"graphic",void 0),l([c()],Lt.prototype,"layer",void 0),l([c()],Lt.prototype,"map",void 0),l([c({readOnly:!0})],Lt.prototype,"objectId",null),l([c({readOnly:!0})],Lt.prototype,"objectIdField",null),l([c()],Lt.prototype,"orderByFields",void 0),l([c({readOnly:!0})],Lt.prototype,"relatedFeatures",null),l([c({readOnly:!0})],Lt.prototype,"relatedLayer",null),l([c({readOnly:!0})],Lt.prototype,"relationship",null),l([c()],Lt.prototype,"featureCount",void 0),l([c({readOnly:!0})],Lt.prototype,"relatedFeatureViewModels",null),l([c()],Lt.prototype,"relationshipId",void 0),l([c()],Lt.prototype,"showAllEnabled",void 0),l([c()],Lt.prototype,"state",null),l([c()],Lt.prototype,"title",void 0),Lt=l([$("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],Lt);const OVe=Lt,RVe=3;let yi=class extends yoe{constructor(e){super(e),this._relationshipVM=null,this.group=null,this.type="relationship",this.addHandles([N(()=>({feature:this.feature,element:this.element,layer:this.layer}),i=>this._createRelationshipVM(i),be),St(()=>this.relatedLayer,"edits",()=>{var i;return(i=this._relationshipVM)==null?void 0:i.refresh()})])}destroy(){var e;(e=this._relationshipVM)==null||e.destroy()}get canAddRelatedFeature(){const{editable:e,featureCount:i,relationship:r}=this;if(!r||!this.loaded||!this.relatedLayerAllowsAdds)return!1;const{cardinality:n,role:s}=r;return!(n==="one-to-one"&&i>0)&&n!=="many-to-many"&&!(n==="one-to-many"&&s==="destination"&&i>0)&&e}get displayCount(){return this.element.displayCount??RVe}get displayType(){return this.element.displayType}get editable(){return!!this.relatedLayerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get featureCount(){var e;return((e=this._relationshipVM)==null?void 0:e.featureCount)??0}get loaded(){var e;return((e=this._relationshipVM)==null?void 0:e.state)!=="loading"}get map(){return this._get("map")}set map(e){var i;e&&((i=this._relationshipVM)==null||i.set("map",e)),this._set("map",e)}get orderByFields(){return this.element.orderByFields}get originHasValidKey(){return!(!this.relationship||!this.feature.getAttribute(this.relationship.keyField))}get relationship(){var e;return(e=this._relationshipVM)==null?void 0:e.relationship}get relationshipId(){return this.element.relationshipId}get relatedFeatureInfos(){var a;const{_relationshipVM:e,timeZone:i}=this;if(!((a=e==null?void 0:e.relatedFeatures)!=null&&a.length)||!(e!=null&&e.relatedLayer))return[];const{itemDescriptionFieldName:r,relatedFeatures:n,relatedLayer:s}=e,o=s&&"formTemplate"in s&&s.formTemplate?s.formTemplate.title:void 0;return n.map(u=>{let d;if(r){const p=u.getAttribute(r),h=s.fieldsIndex.get(r);if(h){const m=foe({values:[p],fields:[h],timeZone:i??void 0})[r];m!=null&&(d=m.toString())}}return{feature:u,description:d,title:o?J2({label:o,attributes:u.attributes,fieldsIndex:s.fieldsIndex,timeZone:i}):void 0}}).toArray()}get relatedLayer(){var e;return(e=this._relationshipVM)==null?void 0:e.relatedLayer}get relatedLayerIsTable(){var e;return!!((e=this.relatedLayer)!=null&&e.isTable)}get relatedLayerAllowsAdds(){var r;const{relatedLayer:e}=this;if(!e||!this.relatedLayerAllowsEdits)return!1;const i=Uy(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsAdd)}get relatedLayerAllowsEdits(){var r;const{relatedLayer:e}=this;if(!e)return!1;const i=Uy(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsEditing)}get showAllEnabled(){return this._get("showAllEnabled")}set showAllEnabled(e){var i;(i=this._relationshipVM)==null||i.set("showAllEnabled",e),this._set("showAllEnabled",e)}get showAllActionVisible(){return!this.showAllEnabled&&this.featureCount>0&&this.featureCount>this.displayCount}get visible(){const{relationship:e}=this;if(!e)return!1;const{cardinality:i}=e;return i!=="many-to-many"&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null)}get updating(){var e,i;return((e=this._relationshipVM)==null?void 0:e.state)==="loading"||((i=this._relationshipVM)==null?void 0:i.state)==="querying"}incrementPage(){this._relationshipVM&&this._relationshipVM.featurePage++}getRelatedFeatureByObjectId(e){var i;return(i=this._relationshipVM)==null?void 0:i.getRelatedFeatureByObjectId(e)}_createRelationshipVM(e){var p;const{feature:i,element:r,layer:n}=e;if((p=this._relationshipVM)==null||p.destroy(),!i||!r||!n)return;const{displayCount:s,map:o,orderByFields:a,relationshipId:u,showAllEnabled:d}=this;yE(n)&&(this._relationshipVM=new OVe({graphic:i,displayCount:s,layer:n,map:o,orderByFields:a,relationshipId:u,showAllEnabled:d}))}};l([c()],yi.prototype,"_relationshipVM",void 0),l([c()],yi.prototype,"canAddRelatedFeature",null),l([c()],yi.prototype,"displayCount",null),l([c()],yi.prototype,"displayType",null),l([c()],yi.prototype,"editable",null),l([c()],yi.prototype,"featureCount",null),l([c()],yi.prototype,"group",void 0),l([c()],yi.prototype,"loaded",null),l([c()],yi.prototype,"map",null),l([c()],yi.prototype,"orderByFields",null),l([c()],yi.prototype,"originHasValidKey",null),l([c()],yi.prototype,"relationship",null),l([c()],yi.prototype,"relationshipId",null),l([c()],yi.prototype,"relatedFeatureInfos",null),l([c()],yi.prototype,"relatedLayer",null),l([c()],yi.prototype,"relatedLayerIsTable",null),l([c()],yi.prototype,"relatedLayerAllowsAdds",null),l([c()],yi.prototype,"relatedLayerAllowsEdits",null),l([c()],yi.prototype,"showAllEnabled",null),l([c()],yi.prototype,"showAllActionVisible",null),l([c({readOnly:!0})],yi.prototype,"type",void 0),l([c()],yi.prototype,"visible",null),l([c()],yi.prototype,"updating",null),yi=l([$("esri.widgets.FeatureForm.RelationshipInput")],yi);const PVe=yi;let Dq=class{constructor(e){this._observable=new a_,this._set=new Set(e)}get size(){return he(this._observable),this._set.size}add(e){const i=this._set.size;return this._set.add(e),this._set.size!==i&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const i=this._set.delete(e);return i&&this._observable.notify(),i}entries(){return he(this._observable),this._set.entries()}forEach(e,i){he(this._observable),this._set.forEach((r,n)=>e.call(i,r,n,this),i)}has(e){return he(this._observable),this._set.has(e)}keys(){return he(this._observable),this._set.keys()}values(){return he(this._observable),this._set.values()}[Symbol.iterator](){return he(this._observable),this._set[Symbol.iterator]()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}},JN;const FVe=["blockquote","html","hr","checkbox","table","tablerow","tablecell","image"];async function NVe(t){return JN||await DVe(),JN.parse(t)}async function DVe(){const{Marked:t}=await k(()=>import("./marked.esm-DrK359eT.js"),[]),e=function({text:s}){return`<span style="text-decoration:line-through;">${s}</span>`},i=function({href:s,text:o,title:a}){return`<a${s!=null?` href="${s}"`:""}${a!=null?` title="${a}"`:""} target="_blank">${o??""}</a>`},r=()=>"",n={};for(const s of FVe)n[s]=r;JN=new t({renderer:{del:e,link:i,...n}})}let ko=class extends cU{constructor(e){super(e),this.group=null,this.id=`TextElementInput-${rm()}`,this.type="text",this._expressionReferences=new ip,this._expressionsUsed=new Dq,this._fieldsUsed=new Dq,this._literalParts=new Y,this._templateParts=new Y,this._updatingHandles=new Wo}initialize(){const{rawText:e}=this;e?this.textFormat==="markdown"?this._updatingHandles.addPromise(NVe(e).then(i=>this._initializeTextParts(i))):this._initializeTextParts(e):this._literalParts.push("")}get expressionsUsed(){return Array.from(this._expressionsUsed)}get fieldsIndex(){return this.layer.fieldsIndex}set fieldsIndex(e){this._overrideIfSome("fieldsIndex",e)}get fieldsUsed(){return Array.from(this._fieldsUsed)}get rawText(){return this.element.text}get text(){const e=this._templateParts.map(i=>{var r;return`${((r=this._expressionReferences.get(i))==null?void 0:r.lastEvaluatedValue)??""}`});return P4.sanitize(UVe(this._literalParts,e))}get textFormat(){return this.element.textFormat}get updating(){return this._updatingHandles.updating||Array.from(this._expressionReferences.values()).some(e=>e==null?void 0:e.updating)}setExpressionExecutor(e,i){this._expressionReferences.set(gq(e),i)}setFieldExecutor(e,i){this._expressionReferences.set(vq(e),i)}_initializeTextParts(e){const{fieldsIndex:i}=this,{literals:r,templates:n}=VVe(e),s=[],o=[];for(let a=0;a<n.length;a++){const u=r[a],d=x5(n[a])[0];if(eVe(d))this._expressionsUsed.add(QDe(d)),this._expressionReferences.set(d,null),s.push(u),o.push(d);else if(tVe(d)){this._expressionsUsed.add(d);const p=gq(d);this._expressionReferences.set(p,null),s.push(u),o.push(p)}else if(i!=null&&i.has(d)){const p=i.normalizeFieldName(d);this._fieldsUsed.add(p);const h=vq(p);this._expressionReferences.set(h,null),s.push(u),o.push(h)}else r[a+1]=u.concat(d,r[a+1])}s.push(r.at(-1)),this._literalParts.addMany(s),this._templateParts.addMany(o)}};function VVe(t){const e=/{[^{]+?}/g,i=[...t.matchAll(e)];let r=0;const n=[],s=[];for(const o of i){const a=o[0];n.push(t.slice(r,o.index)),s.push(a),r=o.index+a.length}return n.push(t.slice(r)),{literals:n,templates:s}}function UVe(t,e){return e.reduce((i,r,n)=>i.concat(t.at(n),r),"").concat(t.at(-1))}l([c()],ko.prototype,"expressionsUsed",null),l([c()],ko.prototype,"fieldsIndex",null),l([c()],ko.prototype,"fieldsUsed",null),l([c()],ko.prototype,"group",void 0),l([c()],ko.prototype,"id",void 0),l([c()],ko.prototype,"rawText",null),l([c()],ko.prototype,"text",null),l([c()],ko.prototype,"textFormat",null),l([c()],ko.prototype,"type",void 0),l([c()],ko.prototype,"updating",null),ko=l([$("esri.widgets.FeatureForm.TextElementInput")],ko);const eO=new Li({attributes:{}}),jVe={field:["editableExpression","requiredExpression","valueExpression","visibilityExpression"],group:["visibilityExpression"],relationship:["editableExpression","visibilityExpression"],text:["visibilityExpression"]},GVe="#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",Ng="#JSAPI_CONTINGENT_VALUE_ANY_HASH",zVe="#JSAPI_CONTINGENT_VALUE_NULL_HASH",$oe="esri.widgets.FeatureForm.FeatureFormViewModel",Eoe=()=>U.getLogger($oe);let nt=class extends l_(ji.EventedAccessor){constructor(e){super(e),this._expressionExecutorsInUse=new Set,this._expressionExecutorLookup=new Map,this._expressionsManager=null,this._contingentValuesCache=null,this._featureClone=eO.clone(),this._initialFeature=eO.clone(),this._timeZone=null,this._updatingHandles=new Wo,this.arcadeEditType="NA",this.contingencyConstraintViolations=new Map,this.disabled=!1,this.highlightHelper=null,this.inputs=[],this.map=null,this.relatedRecordCallbacks=null,this.strict=!1,this.hasPendingSubtypeChoice=!1}initialize(){const e=N(()=>{var n;return[this.layer,!!((n=this.layer)!=null&&n.loaded),this.formTemplate,this.feature,this.timeZone,this.arcadeEditType]},async([n,s])=>{n!=null&&(s?this._updatingHandles.addPromise(this._updateInputs()):n.load().catch(()=>{}))},{equals:([n,s,o,a,u,d],[p,h,m,y,g,v])=>n===p&&s===h&&o===m&&a===y&&u===g&&d===v,initial:!0}),i=N(()=>this._arcadeContextInfo,n=>{this._expressionsManager!=null&&(this._expressionsManager.arcadeContextInfo=n,this._updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())))}),r=N(()=>this.layer,n=>{const s=(n==null?void 0:n.type)==="subtype-sublayer"?n.parent:(n==null?void 0:n.type)==="feature"?n:null;s&&this.addResolvingPromise(SVe.createLoadedLayerContingentValuesCache(s).then(o=>{this._contingentValuesCache=o,this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.addHandles([e,i,r])}destroy(){var e;this.feature=null,this.layer=null,this._contingentValuesCache=xe(this._contingentValuesCache),(e=this.highlightHelper)==null||e.removeAll(),this._updatingHandles.destroy()}get _expressionInfosLookup(){var e,i;return new Map((i=(e=this.formTemplate)==null?void 0:e.expressionInfos)==null?void 0:i.map(r=>[r.name,r]))}get activeRelationshipInput(){return this.allRelationshipInputs.find(e=>e.relationshipId===this.relationshipId)}get _arcadeContextInfo(){const{_initialFeature:e,arcadeEditType:i,layer:r,map:n,spatialReference:s,timeZone:o}=this;return{layer:YS(r)?r:null,originalFeature:e,editType:i,map:n,spatialReference:s,timeZone:o}}get allFieldInputs(){return ZDe(this.inputs)}get allGroupInputs(){return this.inputs.filter(Qh)}get allRelationshipInputs(){return JDe(this.inputs)}get _layerFieldsByName(){var e;return new Map((e=this.layer)==null?void 0:e.fields.map(i=>[i.name,i]))}get feature(){return this._get("feature")}set feature(e){const i=this._get("feature");this._featureClone=e?e.clone():eO.clone(),this._initialFeature=this._featureClone.clone(),this._expressionsManager&&(this._expressionsManager.feature=this._featureClone),e?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(r=>r.feature=e)):(this.inputs.forEach(r=>r.destroy()),this.inputs.length=0),i!==e&&(this.hasPendingSubtypeChoice=!1),this.contingencyConstraintViolations.clear(),this._set("feature",e)}get fieldsWithContingentValues(){if(this._contingentValuesCache==null)return new Set;const e=this._contingentValuesCache.fieldGroups.flatMap(i=>i.fields);return new Set(e)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(e){e===void 0?this._clearOverride("formTemplate"):this._override("formTemplate",e)}get formDescription(){const{formTemplate:e,layer:i}=this;return e!=null&&e.description&&i?J2({label:e.description,attributes:this.getValues(),fieldsIndex:i.fieldsIndex,timeZone:this.timeZone}):null}get formTitle(){const{formTemplate:e,layer:i}=this;return e!=null&&e.title&&i?J2({label:e.title,attributes:this.getValues(),fieldsIndex:i.fieldsIndex,timeZone:this.timeZone}):null}get formHeaderVisible(){const{activeRelationshipInput:e,formDescription:i,formTitle:r}=this;return!(e||!i&&!r)}get joinedContingentValues(){return this._joinContingentValues()}get layer(){var e;return(e=this.feature)!=null&&e.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(e){this._override("layer",e)}get relationshipId(){return this._get("relationshipId")}set relationshipId(e){const i=this.allRelationshipInputs;if(e!=null&&e===this.relationshipId||i.forEach(r=>r.showAllEnabled=!1),e!=null){const r=i.find(n=>n.relationshipId===e);r&&(r.showAllEnabled=!0)}this._set("relationshipId",e)}get spatialReference(){var e;return((e=this.layer)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){var e;return(e=this.layer)!=null&&e.loaded?"ready":"disabled"}get submittable(){return!!this.valid||this.allFieldInputs.filter(e=>!e.valid).every(({submittable:e})=>e)}get timeZone(){const{layer:e}=this;if(e&&"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone)return po;const i=e&&"preferredTimeZone"in e&&e.preferredTimeZone;return this._timeZone===pp?i||po:this._timeZone||Os}set timeZone(e){this._timeZone=e}get updating(){return this._updatingHandles.updating}get valid(){const e=this.allFieldInputs;return e.length>0&&e.every(({valid:i})=>i)}findField(e){return this.allFieldInputs.find(i=>i.name===e)}getFieldValueOptionsForField(e,i){var a;const r=this.findField(e);if(!r)return[[],[],[]];const n=((a=r.domain)==null?void 0:a.type)==="coded-value"?r.domain.codedValues.map(({name:u,code:d})=>({name:u,value:d})):[],s=r.value==null||n.some(u=>u.value===r.value)?[]:[{name:`${r.value}`,value:r.value}],o=this.fieldsWithContingentValues.has(e)?this._getContingentValueOptionsForField(e,i):[];if(o.length>0){const u=new Set(o.map(d=>d.value));return[o,n.filter(d=>!u.has(d.value)),s]}return[n,[],s]}getValue(e){var r;const i=(r=this.layer)==null?void 0:r.getField(e);if(i!=null)return this._featureClone.getAttribute(i.name)??null}setValue(e,i){const{_featureClone:r,strict:n}=this,s=this.findField(e);i=i===""?null:i,s&&r.getAttribute(e)!==i&&(s.value=i,n&&!s.valid||(this._afterValueChange(s),this._expressionsManager!=null&&this._updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([s.name]).finally(()=>this._afterExpressionsEvaluated()))))}getValues(){return{...this._featureClone.attributes}}overrideInitialFeature(e){this._initialFeature=e}submit(){const e=this.allFieldInputs,i=new Set(e.filter(s=>s.valid).map(({name:s})=>s)),r=e.filter(s=>!s.valid).map(({name:s})=>s),n=this.getValues();if(this.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length>0)for(const[s,o]of this.contingencyConstraintViolations.entries())o.type==="error"&&(i.delete(s),r.push(s));this.emit("submit",{valid:[...i],invalid:r,values:n})}validateContingencyConstraints(e,i){const{_contingentValuesCache:r}=this,n=new Map;if(this.contingencyConstraintViolations=n,r==null)return[];const{invalid:s,incomplete:o}=r.validateContingencyConstraints(e),a=[...s,...i!=null&&i.includeIncompleteViolations?o:[]];for(const u of a)for(const d of u.fieldGroup.fields)n.set(d,u);return a}notifyFeatureGeometryChanged(){const{_expressionsManager:e,feature:i,_featureClone:r}=this;i&&(r.geometry=i.geometry,e!=null&&this._updatingHandles.addPromise(e.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated())))}applySubtypeDefaults(e){const{defaultValues:i}=e,{allFieldInputs:r}=this;for(const{name:n}of r){const s=i[n];s!=null&&this.setValue(n,s)}}_emitChangeEvent({name:e,valid:i,value:r}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:e,value:r,valid:i})}async _updateInputs(){this._stopExpressions();const{_featureClone:e,_initialFeature:i,arcadeEditType:r,formTemplate:n,inputs:s,layer:o,timeZone:a}=this;if(!o)return;const u={arcadeEditType:r,feature:e,initialFeature:i,layer:o,timeZone:a},d=s.slice(),p=n!=null&&n.elements&&n.elements.length>0?await this._updateInputsUsingFormElements(d,n.elements,u):this._updateInputsUsingLayerFields(d,o==null?void 0:o.fields,u);this.inputs=p,await this._startExpressions()}async _updateInputsUsingFormElements(e,i,r){const n=new Map;for(const a of e)if(Qh(a)){n.set(a.element,a);for(const u of a.inputs)u.element&&n.set(u.element,u)}else a.element&&n.set(a.element,a);const s=new Map,o=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:n,updatedElements:i.filter(Vq),sharedInitializationProperties:r,group:null,newExpressionExecutorPromises:s});for(const[a,u]of n.entries())n.delete(a),u.destroy();return await Promise.all(Array.from(s.values())),o}async _updateInputsUsingFormElementsRecursive(e){const{existingInputsByElement:i,updatedElements:r,sharedInitializationProperties:n,group:s,newExpressionExecutorPromises:o}=e,a=[];for(const u of r){const d=i.has(u),p=d?i.get(u):this._makeInputFromElement(u,n,s);if(p){if(a.push(p),await wi(()=>!p.updating),this._assignExpressionExecutors(p,u,o),d)if(i.delete(u),Qh(p)){const{feature:h,timeZone:m}=n;p.set({feature:h,timeZone:m})}else if(Z2(p)){const h=this.relationshipId===u.relationshipId;p.set(n),p.set({map:this.map,showAllEnabled:h})}else p.set(n);if(SF(u)){const h=u.elements.filter(m=>Vq(m));p.inputs=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:i,updatedElements:h,sharedInitializationProperties:n,group:p,newExpressionExecutorPromises:o})}}}return a}_updateInputsUsingLayerFields(e,i,r){var o,a;if(!Array.isArray(i))return Eoe().warn(this.declaredClass,"No attribute fields found."),[];const n=new Map;for(const u of e)if(Qh(u)){for(const d of u.inputs)d.destroy();u.inputs.length=0,u.destroy()}else Z2(u)?u.destroy():ib(u)&&(u.element!==null?u.destroy():n.set(u.field,u));const s=[];for(const u of i){const d=((o=r.feature)==null?void 0:o.getAttribute(u.name))??null,p=n.get(u)??new Mq({field:u,preservesValueWhenHidden:(a=this.formTemplate)==null?void 0:a.preserveFieldValuesWhenHidden});s.push(p.set({...r,value:d})),n.delete(u)}for(const[u,d]of n.entries())n.delete(u),d.destroy();return s}_resetFieldInputValues(e){for(const i of this.allFieldInputs)i.value=e.getAttribute(i.name)}_makeInputFromElement(e,i,r){return SF(e)?BVe(e,i):c4(e)?this._makeFieldInputFromElement(e,i,r):QTe(e)?this._makeRelationshipInputFromElement(e,i,r):Fte(e)?HVe(e,i):void 0}_makeFieldInputFromElement(e,i,r){var h;const{arcadeEditType:n,feature:s,initialFeature:o,layer:a,timeZone:u}=i,{fieldName:d}=e,p=d&&this._layerFieldsByName.get(d);return p?new Mq({arcadeEditType:n,element:e,field:p,value:(s==null?void 0:s.getAttribute(e.fieldName))??null,feature:s,initialFeature:o,layer:a,group:r,preservesValueWhenHidden:(h=this.formTemplate)==null?void 0:h.preserveFieldValuesWhenHidden,timeZone:u}):null}_makeRelationshipInputFromElement(e,i,r=null){const{map:n}=this,{feature:s,layer:o,timeZone:a}=i,u=new PVe({element:e,feature:s,group:r,layer:o,map:n,timeZone:a});return u.addHandles(St(()=>u.relatedLayer,"edits",()=>{var d;return(d=this._expressionsManager)==null?void 0:d.evaluateAsyncExpressions()})),u}_assignExpressionExecutors(e,i,r){var o;const n=jVe[i.type],s=[];for(const a of n){const u=`${a}Executor`;if(e[u]){this._useExecutor(e[u]);continue}const d=i[a];if(d!=null&&d!==""){const p=((o=this._expressionInfosLookup.get(d))==null?void 0:o.expression)??d;s.push(this._getOrCreateExecutorForExpression(p,r).then(h=>{e[u]=this._useExecutor(h)}))}}return moe(e)&&s.push(...this._assignTextElementExpressionExecutors(e,r)),s}_assignTextElementExpressionExecutors(e,i){const{_expressionInfosLookup:r}=this,n=[];for(const s of e.expressionsUsed){const o=r.get(s);o!=null?n.push(this._getOrCreateExecutorForExpression(o.expression,i).then(a=>e.setExpressionExecutor(s,this._useExecutor(a)))):U.getLogger(this).error("feature-form:expression-not-found",`Could not find expressionInfo object with name '${s}'`)}for(const s of e.fieldsUsed){const o=`return $feature['${s}'];`;n.push(this._getOrCreateExecutorForExpression(o,i).then(a=>e.setFieldExecutor(s,this._useExecutor(a))))}return n}async _getOrCreateExecutorForExpression(e,i){const{_expressionExecutorLookup:r}=this;if(r.has(e))return r.get(e);if(i.has(e))return i.get(e);const n=LVe(e,this.layer);i.set(e,n);const s=await n;return r.set(e,s),s}_createExpressionsManager(e){const{_arcadeContextInfo:i,_featureClone:r,allFieldInputs:n,formTemplate:s}=this;this._expressionsManager=new Zu({executors:e,feature:r,arcadeContextInfo:i,fieldInputs:n,preserveFieldValuesWhenHidden:(s==null?void 0:s.preserveFieldValuesWhenHidden)===!0})}async _startExpressions(){if(this._expressionExecutorsInUse.size===0)return;const e=Array.from(this._expressionExecutorsInUse);this._createExpressionsManager(e),await this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}_stopExpressions(){this._expressionsManager=xe(this._expressionsManager),this._expressionExecutorsInUse.clear()}_useExecutor(e){return this._expressionExecutorsInUse.add(e),e}_afterValueChange(e){var p;const{name:i,value:r}=e,{_featureClone:n,formTemplate:s,layer:o}=this;if(!o)return;const a=n.getAttribute(i);n.setAttribute(i,r);const{typeFieldName:u,types:d}=K2(o);if((e.isSubtypeField||i===u)&&r!==a){if(o.type==="subtype-sublayer"){const m=(p=o.parent)==null?void 0:p.findSublayerForFeature(n);this.feature&&(this.feature.sourceLayer=m),n.sourceLayer=m}const h=new Set;for(const m of d)if(m.domains&&typeof m.domains=="object")for(const y of Object.keys(m.domains))h.add(y);for(const m of h){const y=this.findField(m);y&&y.notifyChange("domain")}this.notifyChange("joinedContingentValues")}if(s!=null){const{description:h,title:m}=s;m&&PS(m,i)&&this.notifyChange("formTitle"),h&&PS(h,i)&&this.notifyChange("formDescription")}this._emitChangeEvent(e)}_afterExpressionsEvaluated(){const{_featureClone:e}=this;for(const i of this.allFieldInputs)i.value!==e.getAttribute(i.name)&&this._afterValueChange(i)}_joinContingentValues(){const e=this._contingentValuesCache;if(e==null)return[];const{typeFieldName:i}=K2(this.layer),r=i?this.getValue(i):null,n=[];for(const a of e.fieldGroups){const{contingencies:u,fields:d,name:p}=a,h=[];for(const m of u)m.isRetired||m.subtype!=null&&m.subtype.code!==r||h.push({values:m.values});h.length>0&&n.push({name:p,fields:d,contingencies:h})}const[s,o]=this._generateJoinPlan(n);return[...s.flatMap(a=>this._joinFieldGroupContingencies(a)),...o.flatMap(a=>a.contingencies)]}_generateJoinPlan(e){const i=new Map,r=[],n=new Set;for(const d of e)for(const p of d.fields)if(i.has(p)){const h=i.get(p),m=d,y=[h.name,m.name].sort().join("|");if(n.has(y))continue;r.push([h,m]),n.add(y),i.set(p,m)}else i.set(p,d);const s=new Set(r.flat()),o=new Set(e);for(const d of s)o.delete(d);const a=new Map,u=new Map;for(const d of new Set(r.flat())){const p=Symbol(d.name);a.set(p,new Set([d])),u.set(d,p)}for(const[d,p]of r){const h=u.get(d),m=u.get(p);if(h===m)continue;const y=a.get(h),g=a.get(m);for(const v of g)y.add(v),u.set(v,h);a.delete(m)}return[[...a.values()].map(d=>[...d]),[...o]]}_joinFieldGroupContingencies(e){var d,p;const i=e.slice(),r=i.shift();let n=i.shift(),s=this._generateJoinKey(r.fields,n.fields),o=new Set([...r.fields,...n.fields]),a=new Map;for(const h of r.contingencies){const[m]=this._hashContingency(h,s.codedValueFields,!0);a.has(m)?(d=a.get(m))==null||d.push(h):a.set(m,[h])}for(;i.length>0;){const h=new Map,m=i.shift(),y=this._generateJoinKey(o,m.fields);for(const g of n.contingencies){const[v,_]=this._hashContingency(g,s.codedValueFields),w=_?this._findMatchingContingenciesWithAnyHashMask(a,v):a.get(v);if(a.has(Ng)&&(w==null||w.push(...this._findMatchingContingenciesContainingAny(g,a.get(Ng),s.codedValueFields))),w!=null)for(const S of w){const E=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(S,g,s.rangeFields):this._joinContingencies(S,g);if(E==null)break;const[T]=this._hashContingency(E,y.codedValueFields,!0);h.has(T)?(p=h.get(T))==null||p.push(E):h.set(T,[E])}}a=h,n=m,s=y,o=new Set([...o,...n.fields])}const u=[];for(const h of n.contingencies){const[m,y]=this._hashContingency(h,s.codedValueFields),g=y?this._findMatchingContingenciesWithAnyHashMask(a,m):a.get(m);if(a.has(Ng)&&g.push(...this._findMatchingContingenciesContainingAny(h,a.get(Ng),s.codedValueFields)),g!=null)for(const v of g){const _=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(v,h,s.rangeFields):this._joinContingencies(v,h);_!=null&&u.push(_)}}return u}_joinContingencies(e,i){const r={values:{...e.values,...i.values}};for(const[n,s]of Object.entries(r.values))s.objectType==="any"&&e.values[n]!=null&&(r.values[n]=e.values[n]);return r}_joinContingenciesWithRangeDomains(e,i,r){const n=this._joinContingencies(e,i);for(const s of r){const o=e.values[s],a=i.values[s],{leftIsNull:u,rightIsNull:d,bothAreNull:p,leftIsAny:h,rightIsAny:m,bothAreAny:y,leftIsRange:g,rightIsRange:v}=this._compareObjectTypes(o.objectType,a.objectType);if(p||y)continue;if(u&&m||d&&h){n.values[s]=new dn({objectType:"null"});continue}if(u&&v||d&&g)return null;h?(o.minValue=-1/0,o.maxValue=1/0):m&&(a.minValue=-1/0,a.maxValue=1/0);const _=Math.max(o.minValue,a.minValue),w=Math.min(o.maxValue,a.maxValue);if(_>w)return null;n.values[s]=new dn({objectType:"range",minValue:_,maxValue:w})}return n}_findMatchingContingenciesContainingAny(e,i,r){return i.filter(n=>r.every(s=>{var u,d;const o=n.values[s],a=e.values[s];return o.objectType==="any"||a.objectType==="any"||((u=o.codedValue)==null?void 0:u.code)===((d=a.codedValue)==null?void 0:d.code)}))}_findMatchingContingenciesWithAnyHashMask(e,i){const r=RegExp(`${i}$`),n=[];for(const[s,o]of e){if(s===Ng)break;r.test(s)&&n.push(...o)}return n}_generateJoinKey(e,i){var p;const r=Array.isArray(e)?new Set(e):e,n=Array.isArray(i)?new Set(i):i,s=r.size<n.size?r:n,o=s===r?n:r,{feature:a}=this,u=new Set,d=new Set;for(const h of s)if(o.has(h)){const m=(p=this.layer)==null?void 0:p.getFieldDomain(h,a?{feature:a}:void 0);if(m==null)continue;switch(m.type){case"coded-value":u.add(h);break;case"range":d.add(h)}}return{codedValueFields:[...u],rangeFields:[...d]}}_contingencyIsValid(e,i){const r={};for(const{name:n,value:s}of this.allFieldInputs)this.fieldsWithContingentValues.has(n)&&s!=null&&n!==e&&(r[n]=s);return Object.entries(r).every(([n,s])=>!i.values.hasOwnProperty(n)||cVe(s,i.values[n]))}_getContingentValueOptionsForField(e,i){const r=this.joinedContingentValues.slice(),n=new Map,s={code:"",name:i??"No value"};for(const o of r){const a=o.values[e];if((a==null?void 0:a.objectType)==="code"||(a==null?void 0:a.objectType)==="null"){const{code:u,name:d}=a.codedValue&&a.objectType!=="null"?a.codedValue:s;!n.has(u)&&this._contingencyIsValid(e,o)&&n.set(u,{name:d,value:u})}}return[...n.values()]}_hashContingency(e,i,r=!1){var o;if(i.length<1)return[GVe,!1];const n=[];let s=!1;for(const a of i){const u=e.values[a];if(u.objectType==="any"){if(r)return[Ng,!0];s=!0,n.push(`${a}:.*`)}else u.objectType==="null"?n.push(`${a}:${zVe}`):n.push(`${a}:${(o=u.codedValue)==null?void 0:o.code}`)}return[n.sort().join("&"),s]}_compareObjectTypes(e,i){return{leftIsNull:e==="null",rightIsNull:i==="null",bothAreNull:e==="null"&&i==="null",leftIsAny:e==="any",rightIsAny:i==="any",bothAreAny:e==="any"&&i==="any",leftIsRange:e==="range",rightIsRange:i==="range"}}get test(){return{featureClone:this._featureClone}}};function Vq(t){return t.type==="field"||t.type==="group"||t.type==="relationship"||t.type==="text"||(Eoe().warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${t.label} has unsupported type '${t.type}'`),!1)}function BVe(t,e){const{feature:i,layer:r}=e;return new AVe({element:t,inputs:[],feature:i,layer:r})}function HVe(t,e,i=null){const{feature:r,layer:n,timeZone:s}=e;return new ko({element:t,feature:r,group:i,layer:n,timeZone:s})}l([c()],nt.prototype,"_expressionInfosLookup",null),l([c()],nt.prototype,"_featureClone",void 0),l([c()],nt.prototype,"_timeZone",void 0),l([c()],nt.prototype,"activeRelationshipInput",null),l([c()],nt.prototype,"_arcadeContextInfo",null),l([c()],nt.prototype,"allFieldInputs",null),l([c()],nt.prototype,"allGroupInputs",null),l([c()],nt.prototype,"allRelationshipInputs",null),l([c()],nt.prototype,"_layerFieldsByName",null),l([c()],nt.prototype,"arcadeEditType",void 0),l([c()],nt.prototype,"contingencyConstraintViolations",void 0),l([c()],nt.prototype,"disabled",void 0),l([c()],nt.prototype,"feature",null),l([c()],nt.prototype,"fieldsWithContingentValues",null),l([c({type:Vte})],nt.prototype,"formTemplate",null),l([c()],nt.prototype,"formDescription",null),l([c()],nt.prototype,"formTitle",null),l([c()],nt.prototype,"formHeaderVisible",null),l([c()],nt.prototype,"highlightHelper",void 0),l([c()],nt.prototype,"inputs",void 0),l([c()],nt.prototype,"joinedContingentValues",null),l([c()],nt.prototype,"layer",null),l([c()],nt.prototype,"map",void 0),l([c()],nt.prototype,"relatedRecordCallbacks",void 0),l([c()],nt.prototype,"relationshipId",null),l([c()],nt.prototype,"spatialReference",null),l([c()],nt.prototype,"state",null),l([c()],nt.prototype,"strict",void 0),l([c()],nt.prototype,"submittable",null),l([c()],nt.prototype,"timeZone",null),l([c()],nt.prototype,"updating",null),l([c()],nt.prototype,"valid",null),l([c()],nt.prototype,"hasPendingSubtypeChoice",void 0),l([c()],nt.prototype,"getValues",null),l([c()],nt.prototype,"submit",null),l([c()],nt.prototype,"test",null),nt=l([$($oe)],nt);const pU=nt,zm="data-field-name";let Ht=class extends $t{constructor(e,i){super(e,i),this._attemptFocusOnNextRender=!1,this._dateComponentMap=new Map,this._inputsWithChanges=new Set,this._focusedFieldName=null,this._pendingSubtypeChoice=null,this._listObserverNode=null,this._listObserver=new IntersectionObserver(r=>{r.length&&r[0].isIntersecting&&this._incrementRelatedRecordPage()},{root:window.document}),this._prompt=null,this.groupDisplay="all",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesFeature=null,this.messagesTemplates=null,this.viewModel=new pU,this._onShowAllRelatedRecordsClick=r=>{const{feature:n,relatedRecordCallbacks:s}=this;n&&(s!=null&&s.showAllRelatedRecords)&&s.showAllRelatedRecords({parentFeature:n,relationshipId:r})},this._onAddRelatedRecordsClick=(r,n)=>{const{feature:s,relatedRecordCallbacks:o}=this;s&&(o!=null&&o.addRelatedRecord)&&o.addRelatedRecord({parentFeature:s,relatedLayer:n,relationshipId:r})},this._onFormKeyDown=this._onFormKeyDown.bind(this),this._onFormSubmit=this._onFormSubmit.bind(this),this._onGroupToggle=this._onGroupToggle.bind(this),this._onComponentBlur=this._onComponentBlur.bind(this),this._onComponentFocus=this._onComponentFocus.bind(this),this._onComponentKeyDown=this._onComponentKeyDown.bind(this),this._afterComponentCreate=this._afterComponentCreate.bind(this),this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this),this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this),this._afterDateComponentCreateOrUpdate=this._afterDateComponentCreateOrUpdate.bind(this),this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([N(()=>this.feature,()=>{this._inputsWithChanges.clear(),this._dateComponentMap.clear(),wi(()=>!this.viewModel.updating).then(()=>{const e=this._getFocusableInput("forward");this._syncGroupInputStates(),this._focusedFieldName=(e==null?void 0:e.name)||null,this._attemptFocusOnNextRender=!0})}),N(()=>this.groupDisplay,()=>this._syncGroupInputStates()),this.on("submit",e=>{if(e.invalid.length>0){const[i]=e.invalid;e.invalid.forEach(r=>this._inputsWithChanges.add(r)),this._focusedFieldName=i,this._attemptFocusOnNextRender=!0,this.scheduleRender()}}),N(()=>[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])}loadDependencies(){return Gt({block:()=>k(()=>import("./calcite-block-aUGSXHTV.js"),__vite__mapDeps([296,282,242,235,236,240,241,243,263,239,262,259,260,248,238,244,245,256,257,258,261,264,279,265])),button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),combobox:()=>k(()=>import("./calcite-combobox-BGpwkbPG.js"),__vite__mapDeps([297,298,299,277,260,235,259,234,236,237,238,239,240,241,242,262,243,268,300,251,244,301,282,270])),"combobox-item":()=>k(()=>import("./calcite-combobox-item-Cvy0gMR5.js"),__vite__mapDeps([302,301,282,242,235,236,300,238,244])),"combobox-item-group":()=>k(()=>import("./calcite-combobox-item-group-BD_XbU7X.js"),__vite__mapDeps([303,304,235,300])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),input:()=>k(()=>import("./calcite-input-Dp8TE27V.js"),__vite__mapDeps([266,267,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),"input-date-picker":()=>k(()=>import("./calcite-input-date-picker-CoOgUF4I.js"),__vite__mapDeps([305,240,235,241,242,259,260,234,236,237,238,239,262,243,263,244,261,268,269,270,306,271])),"input-message":()=>k(()=>import("./calcite-input-message-DSO14iRF.js"),__vite__mapDeps([272,270,235,244,242])),"input-number":()=>k(()=>import("./calcite-input-number-C2RkDlhZ.js"),__vite__mapDeps([307,308,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),"input-time-picker":()=>k(()=>import("./calcite-input-time-picker--hO1r-3P.js"),__vite__mapDeps([309,234,235,236,241,237,238,239,240,242,261,243,310,244,268,269,248,245,270,306,271,258,259,260,262,263,264])),"input-time-zone":()=>k(()=>import("./calcite-input-time-zone-D42iDMYS.js"),__vite__mapDeps([311,237,235,238,236,240,241,242,243,239,234,251,244,298,299,277,260,259,262,268,300,301,282,270,304])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242])),notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244])),"radio-button":()=>k(()=>import("./calcite-radio-button-B5bB2U0E.js"),__vite__mapDeps([294,257,235,234,236,237,238,239])),"radio-button-group":()=>k(()=>import("./calcite-radio-button-group-BBdDVhdp.js"),__vite__mapDeps([295,242,235,239,268,244,270])),switch:()=>k(()=>import("./calcite-switch-CIQH1lYU.js"),__vite__mapDeps([284,235,234,236,241,237,238,239])),"text-area":()=>k(()=>import("./calcite-text-area-CsEUbODU.js"),__vite__mapDeps([312,234,235,237,238,240,241,242,239,243,236,268,269,244,270,313,260]))})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const e=this.relatedRecordCallbacks;return!(!e||!(e.addRelatedRecord||e.editRelatedRecord||e.showAllRelatedRecords))}get _subtypes(){return fY(this.layer)}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get feature(){return this.viewModel.feature}set feature(e){this.viewModel.feature=e}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(e){this.viewModel.formTemplate=e}get icon(){return"form-field"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(e){this.viewModel.relatedRecordCallbacks=e}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(e){this.viewModel.relationshipId=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get strict(){return this.viewModel.strict}set strict(e){this.viewModel.strict=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get showPrompt(){return e=>{var i,r;(r=(i=this._prompt)==null?void 0:i.cancel)==null||r.call(i),this._prompt=e}}set showPrompt(e){this._overrideIfSome("showPrompt",e)}get clearPrompt(){return()=>this._prompt=null}set clearPrompt(e){this._overrideIfSome("clearPrompt",e)}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const{state:e}=this.viewModel;return b("div",{class:this.classes(Xt.base,K.widget,K.panel)},e==="ready"?this._renderForm():null)}_renderForm(){return b("div",null,b("form",{class:Xt.form,novalidate:!0,onkeydown:this._onFormKeyDown,onsubmit:this._onFormSubmit},this._renderHeader(),this._renderContent()),this._prompt?b(hoe,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderHeader(){const e=this.viewModel;if(!e.formHeaderVisible)return;const i=e.formTitle!=null&&b(Ya,{key:"title",level:this.headingLevel},e.formTitle),r=e.formDescription!=null&&b("p",{class:Xt.description,key:"description"},e.formDescription);return b("div",{class:Xt.formHeader},i,r)}_renderContent(){const{viewModel:e}=this;return e.activeRelationshipInput?this._renderRelationshipInput(e.activeRelationshipInput):e.inputs.filter(ot).filter(i=>i.visible).map(i=>this._renderInput(i))}_renderInput(e){return Qh(e)?this._renderGroup(e):ib(e)?this._renderLabeledField(e):Z2(e)?this._renderRelationshipInput(e):moe(e)?this._renderTextElementInput(e):void 0}_renderDescriptionOrEmpty(e,i){return e==null?null:b("div",{class:this.classes(Xt.description),id:i},e)}_renderGroup(e){const{disabled:i,formTemplate:r,headingLevel:n}=this,{description:s,id:o,inputs:a,label:u,open:d}=e,p=a.filter(g=>g.visible),h=this.viewModel.findField(this._focusedFieldName),m=(h==null?void 0:h.group)===e,y=this.groupDisplay==="sequential";return b("calcite-block",{class:this.classes(Xt.group,y?Xt.groupSequential:null,m?Xt.groupActive:null,i?Xt.inputDisabled:null),collapsible:!0,"data-group":e,description:s||void 0,disabled:i,heading:`${u}`,headingLevel:r!=null&&r.title?tb(n):n,id:o,key:o,open:d,onCalciteBlockToggle:({target:g})=>this._onGroupToggle(g,e)},p.map(g=>this._renderInput(g)))}_getFocusableInput(e,i){const r=uU(this.viewModel.inputs);let n;if(e==="backward"&&r.reverse(),i)if(Qh(i)){const s=i.inputs.find(o=>o.visible);n=s?r.indexOf(s):0}else{let s;if(KA(i)&&!i.group.open){const o=i.group.inputs.filter(ib);s=e==="forward"?o[o.length-1]:o[0]}else s=i;n=r.indexOf(s)+1}else n=0;for(let s=n;s<r.length;s++){const o=r[s];if(o.visible&&ib(o))return o}return null}_renderLabeledField(e){var d;const{dataType:i,feature:r,label:n,layer:s,required:o}=e,a={"aria-label":o?Wr(this.messages.requiredFieldLabel,{name:n}):n,class:Xt.label,key:`${s.id}-${r.uid}-${e.name}`},u=[b("div",{class:Xt.labelTextContent,key:"labelTextContainer"},n,o?b("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),i!=="unsupported"?this._renderFieldInput(e):this._renderReadOnlyComponent(e),this._renderAuxiliaryText(e)];return i==="date"&&((d=e.domain)==null?void 0:d.type)!=="coded-value"?b("label",{...a},u):b("calcite-label",{...a},u)}_renderFieldInput(e){const{dataType:i,domain:r,inputType:n,name:s}=e,o=this.getCommonInputProps(e);if((r==null?void 0:r.type)==="coded-value"){const a=this.viewModel.getFieldValueOptionsForField(s,this.messages.empty);return n!=="switch"||e.hasInvalidSwitchValue?n==="radio-buttons"?this._renderRadioButtonComponents(e,a.flat(),o):this._renderComboBoxComponent(e,a,o):this._renderSwitchComponent(e,o)}return n==="datetime-picker"||i==="date"?this._renderDateComponents(e,o):i==="number"?this._renderNumberComponent(e,o):this._renderStringComponent(e,o)}_renderStringComponent(e,i){return e.inputType==="text-area"?i.readOnly?b("calcite-input",{...i,loading:e.updating,type:"textarea",onCalciteInputInput:r=>this._saveValueFromComponent(r.target)}):b("calcite-text-area",{...i,resize:"vertical",onCalciteTextAreaInput:r=>this._saveValueFromComponent(r.target)}):b("calcite-input",{...i,loading:e.updating,type:"text",onCalciteInputInput:r=>this._saveValueFromComponent(r.target)})}_renderNumberComponent(e,i){return b("calcite-input-number",{...i,integer:_1e(e.field),loading:e.updating,type:"number",onCalciteInputNumberInput:r=>this._saveValueFromComponent(r.target)})}_renderDateComponents(e,i){const{field:r}=e;switch(r.type){case"date":return this._renderDateFieldComponents(e,i);case"date-only":return this._renderDateOnlyFieldComponent(e,i);case"time-only":return this._renderTimeOnlyFieldComponent(e,i);case"timestamp-offset":return this._renderTimestampOffsetFieldComponents(e,i);default:return this._renderReadOnlyComponent(e,gQ(r,i.value,{timeZone:this.timeZone,...S5(r)}))}}_renderDateOnlyFieldComponent(e,i){const{range:r,valid:n,value:s}=e,{class:o,key:a,readOnly:u}=i,{rawMax:d,rawMin:p}=r;return b("calcite-input-date-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!n,class:o,"data-date-part":"date","data-field-name":i[zm],key:`${a}-date-input`,max:kb(d)?d:void 0,min:kb(p)?p:void 0,numberingSystem:jw,onblur:h=>{this._focusedFieldName=null,this._saveValueFromDateComponent(h.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:u,value:s!=null?`${s}`:void 0,onCalciteInputDatePickerChange:h=>this._saveValueFromDateComponent(h.target)})}_renderTimeOnlyFieldComponent(e,i){const{valid:r,value:n}=e,{class:s,key:o,readOnly:a}=i;return b("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!r,class:s,"data-date-part":"time","data-field-name":i[zm],key:`${o}-time-input`,numberingSystem:jw,onblur:u=>{this._focusedFieldName=null,this._saveValueFromDateComponent(u.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,step:e.timeStep,value:n!=null?`${n}`:void 0,onCalciteInputTimePickerChange:u=>this._saveValueFromDateComponent(u.target)})}_renderTimestampOffsetFieldComponents(e,i){const{name:r,range:n,timeZone:s,valid:o,value:a}=e,{class:u,key:d,readOnly:p}=i,{rawMax:h,rawMin:m}=n,y={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!o,numberingSystem:jw,overlayPositioning:"fixed",readOnly:p,[zm]:r,onfocus:this._onComponentFocus},g=Gw(h,s),v=Gw(m,s),_=Gw(a,s);return b("div",{class:Xt.dateInputContainer,key:`${d}-date-time-container`},b("calcite-input-date-picker",{...y,class:u,"data-date-part":"date",key:`${d}-date-input`,max:(g==null?void 0:g.date)??void 0,min:(v==null?void 0:v.date)??void 0,onblur:w=>{this._focusedFieldName=null,this._saveValueFromDateComponent(w.target)},value:_.date??void 0,onCalciteInputDatePickerChange:w=>this._saveValueFromDateComponent(w.target)}),b("calcite-input-time-picker",{...y,class:u,"data-date-part":"time",key:`${d}-time-input`,onblur:w=>{this._focusedFieldName=null,this._saveValueFromDateComponent(w.target)},step:e.timeStep,value:_.time??void 0,onCalciteInputTimePickerChange:w=>this._saveValueFromDateComponent(w.target)}),e.includeTimeOffset?b("calcite-input-time-zone",{...y,class:u,"data-date-part":"timeZone",disabled:p,key:`${d}-timezone-input`,onblur:w=>{this._focusedFieldName=null,this._saveValueFromDateComponent(w.target)},value:_.timeZoneOffset??"0",onCalciteInputTimeZoneChange:w=>this._saveValueFromDateComponent(w.target)}):null)}_renderDateFieldComponents(e,i){const{includeTime:r,name:n,valid:s,value:o}=e,{class:a,key:u,max:d,min:p,readOnly:h}=i,{timeZone:m}=this,y={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!s,numberingSystem:jw,overlayPositioning:"fixed",readOnly:h,[zm]:n,onfocus:this._onComponentFocus},g=yT(o,m),v=yT(d,m),_=yT(p,m);return b("div",{class:Xt.dateInputContainer,key:`${u}-date-time-container`},b("calcite-input-date-picker",{...y,class:a,"data-date-part":"date",key:`${u}-date-input`,max:(v==null?void 0:v.date)??void 0,min:(_==null?void 0:_.date)??void 0,onblur:w=>{this._focusedFieldName=null,this._saveValueFromDateComponent(w.target)},value:g.date??void 0,onCalciteInputDatePickerChange:w=>this._saveValueFromDateComponent(w.target)}),r?b("calcite-input-time-picker",{...y,class:a,"data-date-part":"time",key:`${u}-time-input`,onblur:w=>{this._focusedFieldName=null,this._saveValueFromDateComponent(w.target)},step:1,value:g.time??void 0,onCalciteInputTimePickerChange:w=>this._saveValueFromDateComponent(w.target)}):null)}_renderReadOnlyComponent(e,i){const r=this.getCommonInputProps(e);return b("calcite-input",{...r,class:this.classes(Xt.fieldInput,Xt.inputDisabled),readOnly:!0,type:"text",value:i!=null?`${i}`:r.value})}_renderComboBoxComponent(e,i,r){const{value:n,name:s}=e,{viewModel:o,_inputsWithChanges:a}=this,u=o.arcadeEditType==="INSERT",d=a.has(s),p=n==null&&(!u||d),h=u&&e.showNoValueOptionEnabled&&!d?()=>{}:r.onblur;return b("calcite-combobox",{...r,allowCustomValues:!1,clearDisabled:!0,disabled:r.readOnly,onblur:h,overlayPositioning:"fixed",selectionMode:"single",onCalciteComboboxChange:({target:m})=>{p&&m.selectedItems.length===0?this._ignoreDeselectionOfNoValueOption(m):e.isSubtypeField&&m.selectedItems.length===0?m.value=`${e.value}`:this._saveValueFromComponent(m)}},this.renderComboboxOptionsList(e,i))}renderComboboxOptionsList(e,i){const{value:r,name:n}=e,{messages:s,messagesTemplates:o,viewModel:a,_inputsWithChanges:u}=this,[d,p,h]=i.map(_=>_.map(({name:w,value:S})=>b("calcite-combobox-item",{key:`#${S}`,selected:r===S,textLabel:w,value:`${S}`}))),m=[];p.length>0&&m.push(b("calcite-combobox-item-group",{key:"other",label:o.other},p)),h.length>0&&m.push(b("calcite-combobox-item-group",{key:"unsupported",label:s.subtypes.unsupportedDomainGroupTitle},h)),m.length>0?m.unshift(b("calcite-combobox-item-group",{key:"recommended",label:s.recommended},d)):m.push(...d);const y=a.arcadeEditType==="INSERT",g=u.has(n),v=r==null&&(!y||g);return e.showNoValueOptionEnabled&&m.unshift(b("calcite-combobox-item",{key:"empty-option",selected:v,textLabel:e.showNoValueLabel||s.empty,value:""})),m}_renderRadioButtonComponents(e,i,r){const{name:n,value:s}=e,o=i.map(({name:a,value:u})=>this._renderRadioButtonComponent({key:a,label:a,name:n,value:u,selected:u===s,props:r}));if(e.showNoValueOptionEnabled){const a="",u=e.showNoValueLabel||this.messages.empty,d=s===a||s===null;o.unshift(this._renderRadioButtonComponent({key:"empty-option",label:u,name:n,value:a,selected:d,props:r}))}return b("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:Xt.inputRadioGroup,"data-field-name":r[zm],key:`${r.key}-radio-group`,layout:"vertical",name:r.key,required:r.required},o)}_renderSwitchComponent(e,i){const{value:r}=e,n=!!Yy(e.element,"switch")&&r===e.element.input.onValue;return b("calcite-switch",{...i,checked:n,class:Xt.inputSwitch,disabled:i.readOnly,onblur:()=>{this._focusedFieldName=null},onCalciteSwitchChange:s=>this._saveValueFromComponent(s.target)})}_renderRadioButtonComponent({key:e,name:i,value:r,selected:n,label:s,props:o}){return b("calcite-label",{class:Xt.inputRadioLabel,key:e,layout:"inline"},b("calcite-radio-button",{...o,afterCreate:void 0,afterUpdate:void 0,checked:n,class:Xt.inputRadio,disabled:o.readOnly,name:i,onblur:()=>{this._focusedFieldName=null},value:r,onCalciteRadioButtonChange:({target:a})=>{a.checked&&this._saveValueFromComponent(a)}}),s)}_renderAuxiliaryText(e){const i=e.name,r=this._inputsWithChanges.has(i)&&!e.valid?sVe(e,this.messages,this.timeZone):this.viewModel.contingencyConstraintViolations.get(i)!=null?this.messages.validationErrors.valuesIncompatible:e.valueExpressionExecutor!=null&&e.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return r!=null?b("calcite-input-message",{icon:!0,status:"invalid"},r):this._inputsWithChanges.has(i)&&e.valueIsOutOfDomain?b("calcite-input-message",{icon:!0,status:"idle"},this.messages.subtypes.fieldOutOfSubtypeDomainWarning):this._renderDescriptionOrEmpty(e.description)}_renderShowAllRelatedRecordsListItem(e){const{featureCount:i,relationshipId:r,showAllActionVisible:n}=e,{relatedRecordCallbacks:s}=this;if(!n||!(s!=null&&s.showAllRelatedRecords))return;const o=this.messages;return b("calcite-list-item",{description:Wr(o.totalCount,{count:i}),label:o.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(r)},b("calcite-icon",{icon:"list",scale:"s",slot:"content-end"}))}_renderAddRelatedRecordButton(e){const{canAddRelatedFeature:i,relationshipId:r,relatedLayer:n}=e,{messages:s,relatedRecordCallbacks:o}=this;if(i&&(o!=null&&o.addRelatedRecord)&&n)return b("calcite-button",{alignment:"center",appearance:"outline-fill",class:Xt.centeredButton,disabled:e.updating||!e.originHasValidKey,iconStart:"plus",key:`${r}-add-button`,onclick:()=>{!e.updating&&e.originHasValidKey&&this._onAddRelatedRecordsClick(r,n)},round:!0,scale:"s",width:"half"},e.relatedLayerIsTable?s.addRecord:s.addFeature)}_renderRelatedRecordListItem(e,i){const{feature:r,description:n,title:s}=e,{feature:o,relatedRecordCallbacks:a}=this,{highlightHelper:u}=this.viewModel,d=()=>{u==null||u.removeAll(),a!=null&&a.editRelatedRecord&&o&&a.editRelatedRecord({parentFeature:o,relationshipId:i,relatedFeature:r})},p=u?()=>u.add(r):void 0,h=u?()=>u.remove(r):void 0;return b("calcite-list-item",{bind:this,description:n,key:`${i}-${r.uid}`,label:s,onclick:d,onmouseenter:p,onmouseleave:h,value:s},b("calcite-icon",{icon:oVe(r),slot:"content-start"}),b("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderRelationshipInput(e){if(!this._relatedRecordsEnabled||!e.editable)return;const{featureCount:i,relationshipId:r,showAllEnabled:n}=e,s=n?null:this._renderDescriptionOrEmpty(e.description),o=i>0?this._renderRelatedRecordsList(e):e.loaded?e.originHasValidKey?this._renderNoRelatedRecordsNotice():this._renderNoValidOriginKeyNotice(e):void 0;return b("calcite-label",{class:this.classes(Xt.label,Xt.relatedRecordsLabel),key:`relationship-${r}-container`},b("div",null,this._renderRelatedRecordsHeaderContainer(e),s,o),this._renderAddRelatedRecordButton(e))}_renderRelatedRecordsHeaderContainer(e){var r;const i=e.updating||!e.loaded;return b("div",{class:Xt.relatedRecordsHeader,key:`relationship-${e.relationshipId}-header`},b("span",null,e.label),i?b("calcite-loader",{inline:!0,key:"loader",label:(r=this.messagesCommon)==null?void 0:r.loading,scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(e){const{relationshipId:i}=e;return b("calcite-list",{class:Xt.relatedRecordsList},e.relatedFeatureInfos.map(r=>this._renderRelatedRecordListItem(r,i)),this._renderShowAllRelatedRecordsListItem(e),this._renderObserverNode())}_renderNoValidOriginKeyNotice(e){var d,p,h;const{messages:i}=this,r=e.relatedLayerIsTable?i.noOriginKeyRecord:i.noOriginKeyFeature,n=(d=e.relationship)==null?void 0:d.keyField,s=this.viewModel.findField(n),o=(p=e.layer)==null?void 0:p.fieldsIndex.get(n),a=(s==null?void 0:s.label)||(o==null?void 0:o.alias)||n,u=Wr(r,{relatedLayerName:(h=e.relatedLayer)==null?void 0:h.title,originKeyField:a});return b("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},b("div",{slot:"message"},u))}_renderNoRelatedRecordsNotice(){return b("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},b("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){var e;if((e=this.viewModel.activeRelationshipInput)!=null&&e.showAllEnabled)return b("div",{afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved,bind:this,class:Xt.listObserver,key:"feature-observer"})}_renderTextElementInput(e){return b("div",{class:Xt.textElement,innerHTML:e.text,key:e.id})}getCommonInputProps(e){const{disabled:i}=this,{editable:r,hint:n,label:s,maxLength:o,minLength:a,name:u,range:{max:d,min:p},required:h,valid:m,value:y}=e,g=this._inputsWithChanges.has(u),v=!r||i;return{afterCreate:this._afterComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":m?"false":"true",class:this.classes(Xt.fieldInput,v?Xt.inputDisabled:null),status:g&&!m?"invalid":"idle",key:u,label:s,max:d??void 0,min:p??void 0,maxLength:o>-1?o:void 0,minLength:a>-1?a:void 0,placeholder:n??void 0,readOnly:v,required:h,value:y==null?"":`${y}`,onblur:this._onComponentBlur,onfocus:this._onComponentFocus,onkeydown:this._onComponentKeyDown,[zm]:u}}_getFieldInputFromHTMLElement(e){return this.viewModel.findField(e.getAttribute(zm))}_afterDateComponentCreate(e){const i=this._getFieldInputFromHTMLElement(e),r=e.dataset.datePart,n=this._dateComponentMap.get(i.name);if("valueAsDate"in e&&e.value!=null){const s=new ResizeObserver(()=>{switch(e.value=void 0,i.field.type){case"date":e.value=yT(i.value,this.timeZone).date??"";break;case"timestamp-offset":e.value=Gw(i.value,this.timeZone).date??"";break;default:e.value=`${i.value}`}s.unobserve(e)});s.observe(e)}if(n!=null)switch(r){case"date":n.date=e;break;case"time":n.time=e;break;case"timeZone":n.timeZone=e}else this._dateComponentMap.set(i.name,{[r]:e});this._afterDateComponentCreateOrUpdate(e)}_afterDateComponentCreateOrUpdate(e){this._afterComponentCreateOrUpdate(e)}_afterComponentCreate(e){const i=this._getFieldInputFromHTMLElement(e);YDe(i)&&e.value!=null&&"setNumberValue"in e&&e.setNumberValue({committing:!1,value:e.value,origin:"direct"}),this._afterComponentCreateOrUpdate(e)}_afterRadioGroupCreateOrUpdate(e){const i=e.selectedItem,r=e.querySelector("calcite-radio-button"),n=i||r;n&&this._afterComponentCreateOrUpdate(n)}_afterComponentCreateOrUpdate(e){const{viewModel:i}=this,r=this._getFieldInputFromHTMLElement(e),n=i.findField(this._focusedFieldName);this._attemptFocusOnNextRender&&n===r&&(this._attemptFocusOnNextRender=!1,KA(r)&&(r.group.open=!0),qa(e))}_onComponentFocus(e){const i=e.target,r=this._getFieldInputFromHTMLElement(i);this._focusedFieldName=r.name}_onComponentBlur(e){const i=e.target;this._focusedFieldName=null,this._saveValueFromComponent(i)}_saveValueFromDateComponent(e){const{timeZone:i}=this,r=this._getFieldInputFromHTMLElement(e),n=r.field.type,{name:s,range:o}=r,a=this._dateComponentMap.get(s);if(!a)return;let u=this.viewModel.getValue(s),d=null;n==="date-only"?d=Array.isArray(e.value)?e.value[0]:e.value:n==="time-only"?(u=mP(u),d=mP(e.value)):d=n==="timestamp-offset"?e.value!=null?Fwe({dateComponent:a.date,timeComponent:a.time,timeZoneComponent:a.timeZone,oldValue:u,defaultTimeZone:i}):null:e.value!=null?Nwe({oldValue:u,dateComponent:a.date,timeComponent:a.time,timeZone:i,max:o.max,min:o.min}):null,d!==null&&e.value?u!==d&&this._updateFieldValue(s,d):this._updateFieldValue(s,null)}_saveValueFromComponent(e){const i=this._getFieldInputFromHTMLElement(e),r=this._parseValue(e),n=i.value;i.isSubtypeField&&dVe(this.layer,n,r)?this._pendingSubtypeChoice||r===n||(this._pendingSubtypeChoice=this._handleSubtypeChoice(i,r)):this._updateFieldValue(i.name,r)}async _handleSubtypeChoice(e,i){var v;const{value:r,name:n}=e,{messages:s,viewModel:o,messagesCommon:a,_subtypes:u}=this;if(this._updateFieldValue(n,i),!(u!=null&&u.length))return;const d=u.find(_=>_.code===i),p=((v=u.find(_=>_.code===r))==null?void 0:v.name)??`${r}`;if(!d)return;o.hasPendingSubtypeChoice=!0;const h=fn();let m="update-fields";const y=[{label:s.subtypes.useDefaultValuesOption,value:"update-fields"},{label:s.subtypes.keepCurrentValuesOption,value:"keep-existing"}],g={context:"info",title:s.subtypes.changeWarningTitle,message:Wr(s.subtypes.changeWarning,{originalType:p,newType:d.name}),radios:y,defaultRadioSelection:"update-fields",onRadioSelection:_=>m=_,actions:{primary:{label:a.apply,action:()=>h.resolve(m),type:"positive"},secondary:{label:a.cancel,type:"neutral",action:()=>h.resolve("undo")}},cancel:()=>h.reject()};try{switch(this.showPrompt(g),await h.promise){case"update-fields":o.applySubtypeDefaults(d),this._validateContingenciesForNonNullFields();break;case"keep-existing":this._validateContingenciesForNonNullFields();break;case"undo":this._updateFieldValue(e.name,r)}}finally{o.hasPendingSubtypeChoice=!1,this.clearPrompt(),this._pendingSubtypeChoice=null}}_onComponentKeyDown({key:e,target:i}){const r=this._getFieldInputFromHTMLElement(i);e==="Enter"&&KA(r)&&!r.group.open&&(r.group.open=!0)}_updateFieldValue(e,i){const r=this.viewModel.getValue(e);this.viewModel.setValue(e,i),this._inputsWithChanges.add(e),r!==i&&this.viewModel.fieldsWithContingentValues.has(e)&&this._validateContingenciesForNonNullFields()}_validateContingenciesForNonNullFields(){const e=Object.fromEntries(Object.entries(this.getValues()).filter(([i,r])=>r!=null));this.viewModel.validateContingencyConstraints(e)}_parseValue(e){const i=this._getFieldInputFromHTMLElement(e),r=e.value;return Yy(i.element,"switch")?e.checked?i.element.input.onValue:i.element.input.offValue:r==null||r===""?null:i.dataType==="number"?r==="-0"||r==="-0."||r==="-0,"?r:parseFloat(r):i.field.type==="date"?parseFloat(r):r}_ignoreDeselectionOfNoValueOption(e){const{firstChild:i,selectedItems:r}=e;r.length===0&&i&&"selected"in i?i.selected=!0:U.getLogger(this).warnOnce("Failed to override user attempt to deselect 'No value' option.")}_onGroupToggle(e,i){var r;e.open?(i.open=!0,this._focusedFieldName=((r=this._getFocusableInput("forward",i))==null?void 0:r.name)||null,this._attemptFocusOnNextRender=!0,this.groupDisplay==="sequential"&&this.viewModel.allGroupInputs.forEach(n=>{n!==i&&(n.open=!1)})):i.open=!1,this.scheduleRender()}_onFormSubmit(e){e.preventDefault()}_onFormKeyDown(e){e.key==="Enter"&&this.viewModel.submit()}_afterListObserverCreated(e){this.viewModel.activeRelationshipInput&&(this._listObserverNode=e)}_afterListObserverRemoved(){this._listObserverNode=null}_onObserverChange(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode);const e=this.viewModel.activeRelationshipInput;e&&this._listObserverNode&&e.showAllEnabled&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){const e=this.viewModel.activeRelationshipInput;e==null||e.incrementPage()}_syncGroupInputStates(){if(this.groupDisplay!=="sequential")return;const e=this.viewModel.allGroupInputs;if(!e.length)return;const i=e.filter(r=>r.open);i.length===0?e[0].open=!0:i.length>1&&i.slice(1).forEach(r=>r.open=!1)}get test(){return{inputsWithChanges:this._inputsWithChanges,updateValue:this._saveValueFromComponent.bind(this)}}};l([c()],Ht.prototype,"_listObserverNode",void 0),l([c()],Ht.prototype,"_relatedRecordsEnabled",null),l([c()],Ht.prototype,"_prompt",void 0),l([c()],Ht.prototype,"_subtypes",null),l([c()],Ht.prototype,"disabled",null),l([c()],Ht.prototype,"feature",null),l([c()],Ht.prototype,"formTemplate",null),l([c()],Ht.prototype,"groupDisplay",void 0),l([c()],Ht.prototype,"headingLevel",void 0),l([c()],Ht.prototype,"icon",null),l([c()],Ht.prototype,"label",null),l([c()],Ht.prototype,"layer",null),l([c()],Ht.prototype,"map",null),l([c(),Ue("esri/widgets/FeatureForm/t9n/FeatureForm")],Ht.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Ht.prototype,"messagesCommon",void 0),l([c(),Ue("esri/widgets/Feature/t9n/Feature")],Ht.prototype,"messagesFeature",void 0),l([c(),Ue("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Ht.prototype,"messagesTemplates",void 0),l([c()],Ht.prototype,"relatedRecordCallbacks",null),l([c()],Ht.prototype,"relationshipId",null),l([c()],Ht.prototype,"spatialReference",null),l([c()],Ht.prototype,"strict",null),l([c()],Ht.prototype,"timeZone",null),l([c()],Ht.prototype,"showPrompt",null),l([c()],Ht.prototype,"clearPrompt",null),l([c(),km(["value-change","submit"])],Ht.prototype,"viewModel",void 0),l([c()],Ht.prototype,"test",null),Ht=l([$("esri.widgets.FeatureForm")],Ht);const qVe=Ht;async function WVe(t,e){var i;return t.type==="subtype-sublayer"?await((i=t.parent)==null?void 0:i.load(e)):await t.load(e),t}function ZVe(t){const e=new Map,i=[];for(const r of t)if(My(r)){i.push(r);for(const n of r.items)e.set(n.template,n)}else e.set(r.template,r);return[e,i]}const My=t=>"items"in t;function Toe(t,e,i,r){if(t)if(t.type!=="CIMTextSymbol"){if(t.effects)for(const n of t.effects)KVe(n,e);if(t.symbolLayers)for(const n of t.symbolLayers)switch(n.type){case"CIMPictureMarker":case"CIMVectorMarker":JVe(n,e,r);break;case"CIMPictureStroke":case"CIMSolidStroke":!(r!=null&&r.preserveOutlineWidth)&&n.width&&(n.width*=e);break;case"CIMPictureFill":n.height&&(n.height*=e),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e);break;case"CIMHatchFill":Toe(n.lineSymbol,e,!0,{...r,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e),n.separation&&(n.separation*=e)}}else t.height!=null&&(t.height*=e)}function JVe(t,e,i){if(t&&(t.markerPlacement&&YVe(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const r of t.markerGraphics)t.scaleSymbolsProportionally||Toe(r.symbol,e,!0,i)}function YVe(t,e){switch(_k(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function KVe(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map(r=>r*e);t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function Ioe(t){const e=[];return YN(hte(t),e),e.length?new ee(pte(e[0])):null}function YN(t,e){var n;if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const r=t.type==="CIMPolygonSymbol";if(i!=null&&i.symbolLayers){for(const s of i.symbolLayers)if(!(s.colorLocked||r&&(fte(s)||mte(s)&&s.markerPlacement&&_k(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&Uq(e,s.tintColor);break;case"CIMVectorMarker":(n=s.markerGraphics)==null||n.forEach(o=>{YN(o.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":Uq(e,s.color);break;case"CIMHatchFill":YN(s.lineSymbol,e)}}}function Uq(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function xoe(t,e,i){e instanceof ee||(e=new ee(e));const r=hte(t);r&&KN(r,e)}function KN(t,e,i){var s;if(!t)return;let r;r=t.type==="CIMTextSymbol"?t.symbol:t;const n=(r==null?void 0:r.type)==="CIMPolygonSymbol";if(r!=null&&r.symbolLayers)for(const o of r.symbolLayers){if(o.colorLocked||n&&(fte(o)||mte(o)&&o.markerPlacement&&_k(o.markerPlacement)))continue;const a=e.toArray();switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor=a;break;case"CIMVectorMarker":(s=o.markerGraphics)==null||s.forEach(u=>{KN(u.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":o.color=a;break;case"CIMHatchFill":KN(o.lineSymbol,e)}}}const Moe="picture-fill",Coe="simple-fill",XVe="simple-line",koe="simple-marker",QVe="text",e5e="cim",jq=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),tO=new K5(1e3);function t5e(t){const e=t.style;let i=null;if(t)switch(t.type){case koe:e!=="cross"&&e!=="x"&&(i=t.color);break;case Coe:e&&e!=="solid"?e!=="none"&&(i={type:"pattern",x:0,y:0,src:ut(`esri/symbols/patterns/${e}.png`),width:5,height:5}):i=t.color;break;case Moe:i={type:"pattern",src:t.url,width:si(t.width)*t.xscale,height:si(t.height)*t.yscale,x:si(t.xoffset),y:si(t.yoffset)};break;case QVe:i=t.color;break;case e5e:i=Ioe(t)}return i}function i5e(t,e){const i=t+"-"+e;return tO.get(i)!==void 0?Promise.resolve(tO.get(i)):Ee(t,{responseType:"image"}).then(r=>{const n=r.data,s=n.naturalWidth,o=n.naturalHeight,a=document.createElement("canvas");a.width=s,a.height=o;const u=a.getContext("2d");u.fillStyle=e,u.fillRect(0,0,s,o),u.globalCompositeOperation="destination-in",u.drawImage(n,0,0);const d=a.toDataURL();return tO.put(i,d),d})}function S$(t){if(!t)return null;let e=null;switch(t.type){case Coe:case Moe:case koe:e=S$(t.outline);break;case XVe:{const i=si(t.width);t.style!=null&&t.style!=="none"&&i!==0&&(e={color:t.color,style:hU(t.style),width:i,cap:t.cap,join:t.join==="miter"?si(t.miterLimit):t.join},e.dashArray=Loe(e).join(",")||"none");break}default:e=null}return e}function Loe(t){if(!(t!=null&&t.style))return[];const{dashArray:e,style:i,width:r}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map(o=>Number(o));const n=r??0,s=jq.has(i)?jq.get(i).map(o=>o*n):[];if(t.cap!=="butt")for(const[o,a]of s.entries())s[o]=o%2==1?a+n:Math.max(a-n,1);return s}const hU=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),r5e=new ee([128,128,128]);var Pr;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(Pr||(Pr={}));const kS={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function n5e(t,e,i){const r=Pr.size;let n=r,s=r;t<1?n*=.75:t>1&&(s*=1.25);const o=0,a=0;let u=r,d=r;return e&&i&&(n=s=u=d=0),[{type:"path",path:[{command:"M",values:[u,o]},{command:"L",values:[i?u:.875*u,o]},{command:"L",values:[i?n-.5*u:a,s-.5*d]},{command:"L",values:[n-.5*u,s-.5*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[u,o]},{command:"L",values:[u,e?o:.125*d]},{command:"L",values:[n-.5*u,e?s-.5*d:d]},{command:"L",values:[n-.5*u,s-.5*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n-.5*u,s-.5*d]},{command:"L",values:[i?n-.5*u:a,s-.5*d]},{command:"L",values:[i?n-.5*u:a,e?s-.5*d:d]},{command:"L",values:[n-.5*u,e?s-.5*d:d]},{command:"Z",values:[]}]}]}function s5e(t){const e=Pr.size,i=.5*t,r=0,n=0;return[{type:"path",path:[{command:"M",values:[n,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[n,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,r]},{command:"L",values:[e,r]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[n,.7*e*.5]},{command:"Z",values:[]}]}]}function o5e(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function a5e(t,e){let i=e?Pr.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Pr.size?i-=.5*n:i-=n;const s=0,o=0,a=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,s]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[o,r-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[i,r-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function l5e(t,e){let i=e?Pr.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Pr.size?i-=.5*n:i-=n;const s=.5*i,o=.15*i,a=0,u=r-o;return[{type:"ellipse",cx:.5*i,cy:u,rx:s,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,u]},{command:"L",values:[i,u]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:s,ry:o}]}function u5e(t,e){let i=e?Pr.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Pr.size?i-=.5*n:i-=n;const s=.15*i,o=r-s;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:s},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function c5e(t){let e=t;const i=t,r=6;e<Pr.size?e-=.5*r:e-=r;const n=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,i-n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:n}]}function d5e(t){let e=t;const i=t,r=4;e<Pr.size?e-=.5*r:e-=r;const n=0,s=0,o=e,a=i,u=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,n]},{command:"L",values:[o,.5*a-u]},{command:"L",values:[.45*o-u,.5*a+u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,n]},{command:"L",values:[.45*o-u,.5*a+u]},{command:"L",values:[s,.5*a-u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a-u]},{command:"L",values:[.45*o-u,.5*a+u]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-u]},{command:"L",values:[.45*o-u,.5*a+u]},{command:"Z",values:[]}]}]}function p5e(t){const e=t,i=2;let r=t;r<Pr.size?r-=.5*i:r-=i;const n=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[e,r]},{command:"L",values:[.45*e,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[s,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,r]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[e,r]},{command:"Z",values:[]}]}]}function um(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function Cst(t,e){if(t==null)return new ee;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const i=new ee(t);return new ee([um(i.r,e),um(i.g,e),um(i.b,e),i.a])}let h5e=0;function m5e(){return h5e++}let f5e=0;function y5e(){return f5e++}let g5e=0;function v5e(){return g5e++}const b5e="http://www.w3.org/2000/svg",Gq=G("android"),_5e=G("chrome")||Gq&&Gq>=4?"auto":"optimizeLegibility",w5e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},S5e=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Vi={},Tt={};const $5e=Math.PI;function em(t,e){const i=t*($5e/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function Aoe(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function mU(t,e,i,r,n){if(t){if(t.type==="circle")return b("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(t.type==="ellipse")return b("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(t.type==="rect")return b("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return b("image",{alt:n||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const s=typeof t.path!="string"?Aoe(t.path):t.path;return b("path",{d:s,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width})}if(t.type==="text")return $m(r),b("text",{"dominant-baseline":r.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":r.font.family,"font-size":r.font.size,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,kerning:r.kerning,rotate:r.rotate,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,"text-anchor":r.align,"text-decoration":r.decoration,"text-rendering":_5e,x:t.x,y:t.y},t.text)}return null}function fU(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new ee(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const i=`patternId-${m5e()}`;return{fill:`url(#${i})`,pattern:{id:i,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${y5e()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(i=>({offset:i.offset,color:i.color&&new ee(i.color).toString()}))}}}function yU(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new ee(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=Loe(t).join(",")||"none")),e}function Ooe(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const r=t.alignBaseline,n=r==="baseline"?"auto":r==="top"?"text-top":r==="bottom"?"hanging":r;i.align=t.align,i.dominantBaseline=n,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",$m(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function Roe(t){const{pattern:e,linearGradient:i}=t;if(e)return b("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},b("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(i){const r=i.stops.map((n,s)=>b("stop",{key:`${s}-stop`,offset:n.offset,"stop-color":n.color}));return b("linearGradient",{gradientUnits:"userSpaceOnUse",id:i.id,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2},r)}return null}function E5e(t,e){if(!t||t.length===0)return null;const i=[];for(const r of t){const{shape:n,fill:s,stroke:o,font:a}=r,u=fU(s),d=yU(o),p=n.type==="text"?Ooe(n,a):null,h=mU(n,u.fill,d,p);h&&i.push(h)}return b("mask",{id:e,maskUnits:"userSpaceOnUse"},b("g",null,i))}function zq(t,e,i){return Gb(t,Pk(t),[e,i])}function Bq(t,e,i,r,n){return Fk(t,Pk(t),[e,i]),t[4]=t[4]*e-r*e+r,t[5]=t[5]*i-n*i+n,t}function T5e(t,e,i,r){const n=e%360*Math.PI/180;pE(t,Pk(t),n);const s=Math.cos(n),o=Math.sin(n),a=t[4],u=t[5];return t[4]=a*s-u*o+r*o-i*s+i,t[5]=u*s+a*o-i*o-r*s+r,t}function ps(t,e){Vi&&"left"in Vi?(Vi.left!=null&&Vi.left>t&&(Vi.left=t),(Vi.right==null||Vi.right<t)&&(Vi.right=t),(Vi.top==null||Vi.top>e)&&(Vi.top=e),(Vi.bottom==null||Vi.bottom<e)&&(Vi.bottom=e)):Vi={left:t,bottom:e,right:t,top:e}}function Hq(t){const e=t.args,i=e.length;let r;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<i;r+=2)ps(e[r],e[r+1]);Tt.x=e[i-2],Tt.y=e[i-1];break;case"H":for(r=0;r<i;++r)ps(e[r],Tt.y);Tt.x=e[i-1];break;case"V":for(r=0;r<i;++r)ps(Tt.x,e[r]);Tt.y=e[i-1];break;case"m":{let n=0;for(("x"in Tt)||(ps(Tt.x=e[0],Tt.y=e[1]),n=2),r=n;r<i;r+=2)ps(Tt.x+=e[r],Tt.y+=e[r+1]);break}case"l":case"t":for(r=0;r<i;r+=2)ps(Tt.x+=e[r],Tt.y+=e[r+1]);break;case"h":for(r=0;r<i;++r)ps(Tt.x+=e[r],Tt.y);break;case"v":for(r=0;r<i;++r)ps(Tt.x,Tt.y+=e[r]);break;case"c":for(r=0;r<i;r+=6)ps(Tt.x+e[r],Tt.y+e[r+1]),ps(Tt.x+e[r+2],Tt.y+e[r+3]),ps(Tt.x+=e[r+4],Tt.y+=e[r+5]);break;case"s":case"q":for(r=0;r<i;r+=4)ps(Tt.x+e[r],Tt.y+e[r+1]),ps(Tt.x+=e[r+2],Tt.y+=e[r+3]);break;case"A":for(r=0;r<i;r+=7)ps(e[r+5],e[r+6]);Tt.x=e[i-2],Tt.y=e[i-1];break;case"a":for(r=0;r<i;r+=7)ps(Tt.x+=e[r+5],Tt.y+=e[r+6])}}function qq(t,e,i){const r=w5e[t.toLowerCase()];let n;typeof r=="number"&&(r?e.length>=r&&(n={action:t,args:e.slice(0,e.length-e.length%r)},i.push(n),Hq(n)):(n={action:t,args:[]},i.push(n),Hq(n)))}function I5e(t){const e=(typeof t.path!="string"?Aoe(t.path):t.path).match(S5e),i=[];if(Vi={},Tt={},!e)return null;let r="",n=[];const s=e.length;for(let a=0;a<s;++a){const u=e[a],d=parseFloat(u);isNaN(d)?(r&&qq(r,n,i),n=[],r=u):n.push(d)}qq(r,n,i);const o={x:0,y:0,width:0,height:0};return Vi&&"left"in Vi&&(o.x=Vi.left,o.y=Vi.top,o.width=Vi.right-Vi.left,o.height=Vi.bottom-Vi.top),o}function Poe(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const i=I5e(t);e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function Foe(t){const e={x:0,y:0,width:0,height:0};let i=null,r=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(const s of t)i?(i.x=Math.min(i.x,s.x),i.y=Math.min(i.y,s.y),r=Math.max(r,s.x+s.width),n=Math.max(n,s.y+s.height)):(i=e,i.x=s.x,i.y=s.y,r=s.x+s.width,n=s.y+s.height);return i&&(i.width=r-i.x,i.height=n-i.y),i}function XN(t,e,i,r,n,s,o,a,u){let d=(o&&s?em(s,e):e)/2,p=(o&&s?em(s,i):i)/2;if(u){const S=u[0],E=u[1];d=(o&&s?em(s,S):S)/2,p=(o&&s?em(s,E):E)/2}const h=t.width+r,m=t.height+r,y=C2(),g=C2();let v=!1;if(n&&h!==0&&m!==0){const S=e!==i?e/i:h/m,E=e>i?e:i;let T=1,M=1;isNaN(E)||(S>1?(T=E/h,M=E/S/m):(M=E/m,T=E*S/h)),oy(g,g,Bq(y,T,M,d,p)),v=!0}const _=t.x+(h-r)/2,w=t.y+(m-r)/2;if(oy(g,g,zq(y,d-_,p-w)),!v&&(h>e||m>i)){const S=h/e>m/i,E=(S?e:i)/(S?h:m);oy(g,g,Bq(y,E,E,_,w))}return a&&oy(g,g,zq(y,a[0],a[1])),s&&oy(g,g,T5e(y,s,_,w)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function x5e(t,e,i){const r=t==null?void 0:t.effects.find(d=>d.type==="bloom");if(!r)return null;const{strength:n,radius:s}=r,o=n>0?s:0,a=(n+o)*e,u=4*n+1;return b("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${i}`,width:"300%",x:"-100%",y:"-100%"},b("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(n+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),b("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),b("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),b("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},b("feFuncR",{slope:u,type:"linear"}),b("feFuncG",{slope:u,type:"linear"}),b("feFuncB",{slope:u,type:"linear"})),b("feMerge",null,b("feMergeNode",{in:"intensityBlur"}),b("feMergeNode",{in:"intensityBrightness"}),b("feGaussianBlur",{stdDeviation:n/10})))}function Noe(t,e,i,r={}){var m,y,g;const n=[],s=[],o=v5e(),a=x5e(r.effectView,e,o);let u=null;if(a){const v=(m=r.effectView)==null?void 0:m.effects.find(E=>E.type==="bloom"),_=(v.strength?v.strength+v.radius/2:0)/3,w=e+e*_,S=i+i*_;u=[Math.max(w,10),Math.max(S,10)]}let d=e,p=i;if(r.useRotationSize)for(let v=0;v<t.length;v++){const _=((y=r.rotations)==null?void 0:y[v])??0;d=Math.max(em(_,e),d),p=Math.max(em(_,i),p)}for(let v=0;v<t.length;v++){const _=t[v],w=[],S=[];let E=0,T=0,M=0;for(const F of _){const{shape:V,fill:z,stroke:H,font:Q,offset:J}=F;r.ignoreStrokeWidth||V.type==="text"||(E+=(H==null?void 0:H.width)||0);const ne=fU(z),Pe=yU(H),_e=V.type==="text"?Ooe(V,Q):null;n.push(Roe(ne)),w.push(mU(V,ne.fill,Pe,_e,r.ariaLabel)),S.push(Poe(V)),J&&(T+=J[0],M+=J[1])}const x=((g=r.rotations)==null?void 0:g[v])??0;r.useRotationSize&&(T+=(d-em(x,e))/2,M+=(p-em(x,i))/2);const C=XN(Foe(S),e,i,E,r.scale??!1,x,r.useRotationSize??!1,[T,M],u);let O=null;if(r.masking){const F=`mask-${v}`,V=r.masking[v];n.push(E5e(V,F)),O=`url(#${F})`}s.push(O?b("g",{mask:O},b("g",{transform:C},w)):b("g",{transform:C},w))}return a&&($m(u),d=u[0],p=u[1]),b("svg",{"aria-label":r.ariaLabel,focusable:!1,height:p,role:"img",style:"display: block;",width:d,xmlns:b5e},a,b("defs",null,n),a?b("g",{filter:`url(#bloom${o})`},s):s)}const M5e=new ee("white");function C5e(t){var i,r;const e=(i=t.symbolLayers)==null?void 0:i.at(-1);if(e&&"outline"in e)return(r=e==null?void 0:e.outline)==null?void 0:r.size}function k5e(t){var e;if(!t)return 0;if(xc(t)){const i=C5e(t);return i??0}return Jr((e=S$(t))==null?void 0:e.width)}function qk(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function L5e(t){var e;return((e=t.resource)==null?void 0:e.href)??""}function Dg(t,e){if(!t)return null;let i=null;return xc(t)?i=A5e(t):mk(t)&&(i=t.type==="cim"?Ioe(t):t.color?new ee(t.color):null),i?$$(i,e):null}function A5e(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach(r=>{var n;r.type==="object"&&((n=r.resource)!=null&&n.href)||(i=r.type==="water"?r.color:r.material?r.material.color:null)}),i?new ee(i):null}function $$(t,e){if(e==null||t==null)return t;const i=t.toRgba();return i[3]=i[3]*e,new ee(i)}function O5e(t,e,i){const r=t.symbolLayers;if(!r)return;const n=s=>$$(e=e??s??(i!=null?M5e:null),i);r.forEach(s=>{var o,a;if(s.type!=="object"||!((o=s.resource)!=null&&o.href)||e)if(s.type==="water")s.color=n(s.color);else{const u=s.material!=null?s.material.color:null,d=n(u);s.material==null?s.material=new no({color:d}):s.material.color=d,i!=null&&"outline"in s&&((a=s.outline)==null?void 0:a.color)!=null&&(s.outline.color=$$(s.outline.color,i))}})}function R5e(t,e,i){var r;(e=e??t.color)&&(t.color=$$(e,i)),i!=null&&"outline"in t&&((r=t.outline)!=null&&r.color)&&(t.outline.color=$$(t.outline.color,i))}function iO(t,e,i){t&&(e||i!=null)&&(e&&(e=new ee(e)),xc(t)?O5e(t,e,i):mk(t)&&R5e(t,e,i))}async function P5e(t,e){const i=t.symbolLayers;i&&await jme(i,async r=>F5e(r,e))}async function F5e(t,e){switch(t.type){case"extrude":D5e(t,e);break;case"icon":case"line":case"text":N5e(t,e);break;case"path":U5e(t,e);break;case"object":await V5e(t,e)}}function N5e(t,e){const i=Doe(e);i!=null&&(t.size=i)}function Doe(t){for(const e of t)if(typeof e=="number")return e;return null}function D5e(t,e){t.size=typeof e[2]=="number"?e[2]:0}async function V5e(t,e){const{resourceSize:i,symbolSize:r}=await j5e(t),n=Voe(e,i,r);t.width=LS(e[0],r[0],i[0],n),t.depth=LS(e[1],r[1],i[1],n),t.height=LS(e[2],r[2],i[2],n)}function U5e(t,e){const i=Voe(e,LY,[t.width,void 0,t.height]);t.width=LS(e[0],t.width,1,i),t.height=LS(e[2],t.height,1,i)}function Voe(t,e,i){for(let r=0;r<3;r++){const n=t[r];switch(n){case"symbol-value":{const s=i[r];return s!=null?s/e[r]:1}case"proportional":break;default:if(n&&e[r])return n/e[r]}}return 1}async function j5e(t){const{computeObjectLayerResourceSize:e}=await k(()=>import("./symbolLayerUtils-yWF4Yu-u.js"),[]),i=await e(t,10),{width:r,height:n,depth:s}=t,o=[r,s,n];let a=1;for(let u=0;u<3;u++){const d=o[u];if(d!=null){a=d/i[u];break}}for(let u=0;u<3;u++)o[u]==null&&(o[u]=i[u]*a);return{resourceSize:i,symbolSize:o}}function LS(t,e,i,r){switch(t){case"proportional":return i*r;case"symbol-value":return e??i;default:return t}}function G5e(t,e){const i=Doe(e);if(i!=null)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const r=t.width/t.height;r>1?(t.width=i,t.height=i*r):(t.width=i*r,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function z5e(t,e){if(t&&e)return xc(t)?P5e(t,e):void(mk(t)&&G5e(t,e))}function B5e(t,e,i){if(t&&e!=null)if(xc(t)){const r=t.symbolLayers;r&&r.forEach(n=>{if(n.type==="object")switch(i){case"tilt":n.tilt=(n.tilt??0)+e;break;case"roll":n.roll=(n.roll??0)+e;break;default:n.heading=(n.heading??0)+e}n.type==="icon"&&(n.angle+=e)})}else mk(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=e))}function E$(t){if(!t)return null;const e=t.effects.filter(i=>i.type!=="bloom").map(i=>i.toJSON());return w2(e)}function kst(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}async function H5e(t,e){return await t.fetchSymbol(e)||t.fetchCIMSymbol(e)}const Wq=x2();function q5e(t,e){Wq.append(t,e),Wq.detach(e)}function gE(t,e,i){const r=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const s=(i==null?void 0:i.node)||document.createElement("div");return i.opacity!=null&&(s.style.opacity=i.opacity.toString()),i.effectView!=null&&(s.style.filter=E$(i.effectView)),q5e(s,()=>Noe(t,r,n,i)),s}function W5e(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const r=i.getContext("2d");return r.clearRect(0,0,t,e),r}function Z5e(t,e,i){return t?Ee(t,{responseType:"image"}).then(r=>{const n=r.data,s=n.width,o=n.height,a=s/o;let u=e;if(i){const d=Math.max(s,o);u=Math.min(u,d)}return{image:n,width:a<=1?Math.ceil(u*a):u,height:a<=1?u:Math.ceil(u/a)}}):Promise.reject(new L("renderUtils: imageDataSize","href not provided."))}function J5e(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function Y5e(t,e,i,r,n){switch(n){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const s=bk({r:t[e],g:t[e+1],b:t[e+2]});s.h=r.h,s.s=r.s,s.v=s.v/100*r.v;const o=hg(s);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=i[3];break}}}function K5e(t,e,i,r,n){return Z5e(t,e,n).then(s=>{const o=s.width??e,a=s.height??e;if(s.image&&J5e(i,r)){let u=s.image.width,d=s.image.height;G("edge")&&/\.svg$/i.test(t)&&(u-=1,d-=1);const p=W5e(o,a);p.drawImage(s.image,0,0,u,d,0,0,o,a);const h=p.getImageData(0,0,o,a),m=[i.r/255,i.g/255,i.b/255,i.a],y=bk(i);for(let g=0;g<h.data.length;g+=4)Y5e(h.data,g,m,y,r);p.putImageData(h,0,0),t=p.canvas.toDataURL("image/png")}else{const u=Te==null?void 0:Te.findCredential(t);if(u!=null&&u.token){const d=t.includes("?")?"&":"?";t=`${t}${d}token=${u.token}`}}return{url:t,width:o,height:a}}).catch(()=>({url:t,width:e,height:e}))}const Uoe="esri-relationship-ramp",Vg=`${Uoe}--diamond`,Dp=`${Uoe}--square`,X5e="http://www.w3.org/2000/svg",ii={diamondContainer:`${Vg}__container`,diamondLeftCol:`${Vg}__left-column`,diamondRightCol:`${Vg}__right-column`,diamondMidCol:`${Vg}__middle-column`,diamondMidColLabel:`${Vg}__middle-column--label`,diamondMidColRamp:`${Vg}__middle-column--ramp`,squareTable:`${Dp}__table`,squareTableRow:`${Dp}__table-row`,squareTableCell:`${Dp}__table-cell`,squareTableLabel:`${Dp}__table-label`,squareTableLabelLeftBottom:`${Dp}__table-label--left-bottom`,squareTableLabelRightBottom:`${Dp}__table-label--right-bottom`,squareTableLabelLeftTop:`${Dp}__table-label--left-top`,squareTableLabelRightTop:`${Dp}__table-label--right-top`};function joe(t,e,i={}){const{focus:r,labels:n}=t,s=!!r,o=Q5e(t,e,i),a={justifyContent:"center"},u=qy(),d=i.key??e;return s?b("div",{class:ii.diamondContainer,key:`${d}-container`,styles:a},b("div",{class:ii.diamondLeftCol},u?n.right:n.left),b("div",{class:ii.diamondMidCol},b("div",{class:ii.diamondMidColLabel},n.top),o,b("div",{class:ii.diamondMidColLabel},n.bottom)),b("div",{class:ii.diamondRightCol},u?n.left:n.right)):b("div",{class:ii.squareTable,key:`${d}-container`},b("div",{class:ii.squareTableRow},b("div",{class:nu(ii.squareTableCell,ii.squareTableLabel,ii.squareTableLabelRightBottom)},u?n.top:n.left),b("div",{class:ii.squareTableCell}),b("div",{class:nu(ii.squareTableCell,ii.squareTableLabel,ii.squareTableLabelLeftBottom)},u?n.left:n.top)),b("div",{class:ii.squareTableRow},b("div",{class:ii.squareTableCell}),o,b("div",{class:ii.squareTableCell})),b("div",{class:ii.squareTableRow},b("div",{class:nu(ii.squareTableCell,ii.squareTableLabel,ii.squareTableLabelRightTop)},u?n.right:n.bottom),b("div",{class:ii.squareTableCell}),b("div",{class:nu(ii.squareTableCell,ii.squareTableLabel,ii.squareTableLabelLeftTop)},u?n.bottom:n.right)))}function Zq(t,e,i){const r=`${i}_arrowStart`,n=`${i}_arrowEnd`,s=t==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":s?o.markerStart=`url(#${n})`:o.markerEnd=`url(#${r})`;break;case"LL":o.markerStart=`url(#${n})`;break;case"LH":s?o.markerEnd=`url(#${r})`:o.markerStart=`url(#${n})`;break;default:o.markerEnd=`url(#${r})`}return o}function Q5e(t,e,i={}){const{focus:r,numClasses:n,colors:s,rotation:o}=t,{opacity:a,effectList:u,ariaLabel:d}=i,p=i.size??60,h=!!r,m=Math.sqrt(p**2+p**2)+(h?0:5),y=[],g=[],v=[],_=(p||75)/n;for(let H=0;H<n;H++){const Q=H*_;for(let J=0;J<n;J++){const ne=J*_,Pe=fU(s[H][J]),_e=yU(null),ue={type:"rect",x:ne,y:Q,width:_,height:_},it=Roe(Pe);it&&y.push(it);const Xr=mU(ue,Pe.fill,_e,null);Xr&&g.push(Xr),v.push(Poe(ue))}}const w=10,S=15,E=15,T=10;let M=null;h||(M="margin: -15px -15px -18px -15px");const x=Zq("left",r,e),C=Zq("right",r,e),O=Foe(v),F=XN(O,m,m,0,!1,o,!1),V=XN(O,m,m,0,!1,h?-45:null,!1),z={filter:E$(u)??void 0,opacity:a==null?"":`${a}`};return b("div",{class:h?ii.diamondMidColRamp:ii.squareTableCell,styles:z},b("svg",{"aria-label":d,focusable:!1,height:m,role:"image",style:M,width:m,xmlns:X5e},b("defs",null,b("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},b("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),b("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},b("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),y),b("g",{transform:F},g),b("g",{transform:V},b("line",{fill:"none","marker-end":x.markerEnd,"marker-start":x.markerStart,stroke:"#555555","stroke-width":"1",x1:-w,x2:-w,y1:p-S,y2:S}),b("line",{fill:"none","marker-end":C.markerEnd,"marker-start":C.markerStart,stroke:"#555555","stroke-width":"1",x1:E,x2:p-E,y1:p+T,y2:p+T}))))}function e4e(t){return t=t||globalThis.location.hostname,t4e.some(e=>(t==null?void 0:t.match(e))!=null)}function Jq(t,e){return t?(e=e||globalThis.location.hostname)?e.match(Goe)!=null||e.match(Boe)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(zoe)!=null||e.match(Hoe)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const Goe=/^devext\.arcgis\.com$/,zoe=/^qaext\.arcgis\.com$/,Boe=/^[\w-]*\.mapsdevext\.arcgis\.com$/,Hoe=/^[\w-]*\.mapsqa\.arcgis\.com$/,t4e=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,Goe,zoe,/^jsapps\.esri\.com$/,Boe,Hoe];function qoe(t,e,i,r){const n=t.name;return n==null?Promise.reject(new L("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?i4e(n,e,r):Tte(t,e,r).then(s=>Zoe(s,n,e,i,STe,r))}function Woe(t,e){return e.items.find(i=>i.name===t)}function Zoe(t,e,i,r,n,s){var y,g;const o=(i==null?void 0:i.portal)!=null?i.portal:ki.getDefault(),a={portal:o,url:nr(t.baseUrl),origin:"portal-item"},u=Woe(e,t.data);if(!u){const v=`The symbol name '${e}' could not be found`;return Promise.reject(new L("symbolstyleutils:symbol-name-not-found",v,{symbolName:e}))}let d=fm(n(u,r),a),p=((y=u.thumbnail)==null?void 0:y.href)??null;const h=(g=u.thumbnail)==null?void 0:g.imageData;e4e()&&(d=Jq(d)??"",p=Jq(p));const m={portal:o,url:nr(bV(d)),origin:"portal-item"};return a4(d,s).then(v=>{const _=r==="cimRef"?Ite(v.data):v.data,w=Dee(_,m);if(w&&xc(w)){if(p){const S=fm(p,a);w.thumbnail=new Ey({url:S})}else h&&(w.thumbnail=new Ey({url:`data:image/png;base64,${h}`}));t.styleUrl?w.styleOrigin=new i$({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(w.styleOrigin=new i$({portal:i.portal,styleName:t.styleName,name:e}))}return w})}function i4e(t,e,i){const r=$Te.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:ki.getDefault();return a4(r,i).then(s=>{const o=Ite(s.data);return Dee(o,{portal:n,url:nr(bV(r)),origin:"portal-item"})})}const r4e=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:Zoe,getStyleItemFromStyle:Woe,resolveWebStyleSymbol:qoe},Symbol.toStringTag,{value:"Module"})),cy=Pr.size,uM=Pr.maxSize,gU=Pr.maxOutlineSize,Yq=Pr.lineWidth,QN=Pr.tallSymbolWidth;function k0(t){const e=t.outline,i=t.material!=null?t.material.color:null,r=i!=null?i.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&r==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const n=si(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(n,gU),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?hU(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function n4e(t,e){var r,n,s;if((r=t.thumbnail)!=null&&r.url)return t.thumbnail.url;if(e.type==="icon"&&((n=e==null?void 0:e.resource)==null?void 0:n.href))return L5e(e);const i=ut("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const o=await qoe(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch(()=>null);if(o&&"thumbnail"in o&&((s=o.thumbnail)!=null&&s.url))return o.thumbnail.url}return i}function rO(t,e=1){const i=t.a,r=bk(t),n=r.h,s=r.s/e,o=100-(100-r.v)/e,{r:a,g:u,b:d}=hg({h:n,s,v:o});return[a,u,d,i]}function eC(t){var e;return t.type==="water"?t.color==null?null:t.color:((e=t.material)==null?void 0:e.color)==null?null:t.material.color}function _t(t,e=0){const i=eC(t);if(!i){if(t.type==="fill")return null;const n=r5e.r,s=um(n,e);return[s,s,s,100]}const r=i.toRgba();for(let n=0;n<3;n++)r[n]=um(r[n],e);return r}async function Joe(t,e){const i=t.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await i5e(ut(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function Kq(t){return t.outline?k0(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function vU(t,e){const i=eC(t);if(!i)return null;let r="rgba(";return r+=um(i.r,e)+",",r+=um(i.g,e)+",",r+=um(i.b,e)+",",r+i.a+");"}function eD(t,e){const i=vU(t,e);return i?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:i,width:Math.min(t.size?si(t.size):.75,gU),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?hU(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?si(2):t.join:null}:{}}function aI(t,e,i){const r=i!=null?.75*i:0;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function s4e(t){const e=t.depth,i=t.height,r=t.width;return r!==0&&e!==0&&i!==0&&r===e&&r!=null&&i!=null&&r<i}function o4e(t,e,i){var n,s;const r=[];if(!t)return r;switch(t.type){case"icon":{const u=e,d=e;switch(((n=t.resource)==null?void 0:n.primitive)??_Se){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:_t(t,0),stroke:k0(t)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[0,d]},{command:"L",values:[0,0]},{command:"L",values:[u,0]},{command:"L",values:[u,d]},{command:"Z",values:[]}]},fill:_t(t,0),stroke:k0(t)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[0,d]},{command:"L",values:[.5*u,0]},{command:"L",values:[u,d]},{command:"Z",values:[]}]},fill:_t(t,0),stroke:k0(t)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*u,0]},{command:"L",values:[.5*u,d]},{command:"M",values:[0,.5*d]},{command:"L",values:[u,.5*d]}]},stroke:Kq(t)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[u,d]},{command:"M",values:[u,0]},{command:"L",values:[0,d]}]},stroke:Kq(t)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[.5*u,0]},{command:"L",values:[u,.5*d]},{command:"L",values:[.5*u,d]},{command:"Z",values:[]}]},fill:_t(t,0),stroke:k0(t)})}break}case"object":switch(((s=t.resource)==null?void 0:s.primitive)??ESe){case"cone":{const o=aI(_t(t,0),_t(t,-.6),i?QN:e),a=u5e(e,i);r.push({shape:a[0],fill:o},{shape:a[1],fill:o});break}case"inverted-cone":{const o=_t(t,0),a=aI(o,_t(t,-.6),e),u=c5e(e);r.push({shape:u[0],fill:a},{shape:u[1],fill:o});break}case"cube":{const o=a5e(e,i);r.push({shape:o[0],fill:_t(t,0)},{shape:o[1],fill:_t(t,-.3)},{shape:o[2],fill:_t(t,-.5)});break}case"cylinder":{const o=aI(_t(t,0),_t(t,-.6),i?QN:e),a=l5e(e,i);r.push({shape:a[0],fill:o},{shape:a[1],fill:o},{shape:a[2],fill:_t(t,0)});break}case"diamond":{const o=d5e(e);r.push({shape:o[0],fill:_t(t,-.3)},{shape:o[1],fill:_t(t,0)},{shape:o[2],fill:_t(t,-.3)},{shape:o[3],fill:_t(t,-.7)});break}case"sphere":{const o=aI(_t(t,0),_t(t,-.6));o.x1=0,o.y1=0,o.x2=.25*e,o.y2=.25*e,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:o});break}case"tetrahedron":{const o=p5e(e);r.push({shape:o[0],fill:_t(t,-.3)},{shape:o[1],fill:_t(t,0)},{shape:o[2],fill:_t(t,-.6)});break}}break}return r}function Wk(t){const e=typeof(t==null?void 0:t.size)=="number"?t==null?void 0:t.size:null;return e?si(e):null}function a4e(t){return t.type==="icon"?"multiply":"tint"}async function l4e(t,e){const i=Wk(e),r=e!=null&&e.maxSize?si(e.maxSize):null,n=(e==null?void 0:e.disableUpsampling)??!1,s=t.symbolLayers,o=[],a=[];let u=!1,d=0,p=0,h=0;s.forEach(g=>{var S,E,T,M;if(g.type!=="icon"&&g.type!=="object")return;g&&g.type==="icon"&&(h=Math.max(g.size&&si(g.size),h));const v=g.type==="icon"?g.size&&si(g.size):0,_=i||v?Math.ceil(Math.min(i||v,r||uM)):cy;let w=g.type==="icon"?g.angle:null;if((e==null?void 0:e.rotation)!=null&&(w=(w??0)+e.rotation),a.push(w),(S=g==null?void 0:g.resource)==null?void 0:S.href){const x=n4e(t,g).then(C=>{var V;const O=(V=g==null?void 0:g.material)==null?void 0:V.color,F=a4e(g);return K5e(C,_,O,F,n)}).then(C=>{const O=C.width,F=C.height;return d=Math.max(d,O),p=Math.max(p,F),w&&(u=!0),[{shape:{type:"image",x:0,y:0,width:O,height:F,src:C.url},fill:null,stroke:null}]});o.push(x)}else{let x=_;g.type==="icon"&&i&&(x=_*(v/h));const C=(e==null?void 0:e.symbolConfig)==="tall"||((E=e==null?void 0:e.symbolConfig)==null?void 0:E.isTall)||g.type==="object"&&s4e(g);d=Math.max(d,C?QN:x),p=Math.max(p,x),w&&((T=g.resource)!=null&&T.primitive)&&["square","triangle","x"].includes((M=g.resource)==null?void 0:M.primitive)&&(u=!0),o.push(Promise.resolve(o4e(g,x,C)))}});const m=await Promise.allSettled(o),y=[];return m.forEach(g=>{g.status==="fulfilled"?y.push(g.value):g.reason&&U.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",g.reason)}),gE(y,[d,p],{node:e==null?void 0:e.node,scale:!1,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel,rotations:a,useRotationSize:u})}function u4e(t,e){const i=t.symbolLayers,r=[],n=qk(t),s=Wk(e),o=(e!=null&&e.maxSize?si(e.maxSize):null)||gU;let a,u=0,d=0;return i.forEach((p,h)=>{if(!p||p.type!=="line"&&p.type!=="path")return;const m=[];switch(p.type){case"line":{const y=eD(p,0);if(y==null)break;const g=(y==null?void 0:y.width)||0;h===0&&(a=g);const v=Math.min(s||g,o),_=h===0?v:s?v*(g/a):v,w=_>Yq/2?2*_:Yq;d=Math.max(d,_),u=Math.max(u,w),y.width=_,m.push({shape:{type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[u,.5*d]}]},stroke:y});break}case"path":{const y=Math.min(s||cy,o),g=_t(p,0),v=_t(p,-.2),_=vU(p,-.4),w=_?{color:_,width:1}:{};if(p.profile==="quad"){const S=p.width,E=p.height,T=n5e(S&&E?S/E:1,E===0,S===0),M={...w,join:"bevel"};m.push({shape:T[0],fill:v,stroke:M},{shape:T[1],fill:v,stroke:M},{shape:T[2],fill:g,stroke:M})}else m.push({shape:kS.pathSymbol3DLayer[0],fill:v,stroke:w},{shape:kS.pathSymbol3DLayer[1],fill:g,stroke:w});d=Math.max(d,y),u=d}}r.push(m)}),Promise.resolve(gE(r,[u,d],{node:e==null?void 0:e.node,scale:n,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel}))}async function c4e(t,e){const i=t.type==="mesh-3d",r=t.symbolLayers,n=Wk(e),s=e!=null&&e.maxSize?si(e.maxSize):null,o=n||cy,a=[];let u=0,d=0,p=!1;for(let h=0;h<r.length;h++){const m=r.at(h),y=[];if(!i||m.type==="fill"){switch(m.type){case"fill":{const g=Math.min(o,s||uM);if(u=Math.max(u,g),d=Math.max(d,g),p=!0,i){const v=kS.meshSymbol3DFill,_=vU(m,-.4),w=_?{color:_,width:1,join:"round"}:{};y.push({shape:v[0],fill:_t(m,0),stroke:w},{shape:v[1],fill:_t(m,-.2),stroke:w},{shape:v[2],fill:_t(m,-.6),stroke:w})}else{let v=_t(m,0);const _="pattern"in m?m.pattern:null,w=k0(m),S=eC(m);_!=null&&_.type==="style"&&_.style!=="solid"&&S&&(v=await Joe(_,S)),y.push({shape:kS.fill[0],fill:v,stroke:w})}break}case"line":{const g=eD(m,0);if(g==null)break;const v={stroke:g,shape:kS.fill[0]};u=Math.max(u,cy),d=Math.max(d,cy),y.push(v);break}case"extrude":{const g={join:"round",width:1,...eD(m,-.4)},v=_t(m,0),_=_t(m,-.2),w=Math.min(o,s||uM),S=s5e(w);g.width=1,y.push({shape:S[0],fill:_,stroke:g},{shape:S[1],fill:_,stroke:g},{shape:S[2],fill:v,stroke:g});const E=cy,T=.7*cy+.5*w;u=Math.max(u,E),d=Math.max(d,T);break}case"water":{const g=eC(m),v=rO(g),_=rO(g,2),w=rO(g,3),S=o5e();p=!0,y.push({shape:S[0],fill:v},{shape:S[1],fill:_},{shape:S[2],fill:w});const E=Math.min(o,s||uM);u=Math.max(u,E),d=Math.max(d,E);break}}a.push(y)}}return gE(a,[u,d],{node:e==null?void 0:e.node,scale:p,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function d4e(t,e){if(t.symbolLayers.length===0)return Promise.reject(new L("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return l4e(t,e);case"line-3d":return u4e(t,e);case"polygon-3d":case"mesh-3d":return c4e(t,e)}return Promise.reject(new L("symbolPreview: swatchInfo3D","symbol not supported."))}const p4e=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:Joe,getSizeFromOptions:Wk,getSymbolLayerFill:_t,previewSymbol3D:d4e},Symbol.toStringTag,{value:"Module"})),Xq={HH:315,HL:45,LL:135,LH:225},h4e={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function m4e(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return _t(t.symbolLayers.at(0));if(e==="simple-line"){const i=S$(t);return i&&i.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const i=S$(t);return i&&i.color}return t5e(t)}function f4e(t,e){const i=e.HH.label,r=e.LL.label,n=e.HL.label,s=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:r,left:n,right:s};case"HL":return{top:n,bottom:s,left:r,right:i};case"LL":return{top:r,bottom:i,left:s,right:n};case"LH":return{top:s,bottom:n,left:i,right:r}}}function y4e(t){const{focus:e,infos:i,numClasses:r}=t,n=h4e[r],s={};i.forEach(a=>{s[a.value]={label:a.label,fill:m4e(a.symbol)}});const o=[];for(let a=0;a<r;a++){const u=[];for(let d=0;d<r;d++){const p=s[n[a][d]];u.push(p.fill)}o.push(u)}return{type:"relationship-ramp",numClasses:r,focus:e,colors:o,labels:f4e(e,s),rotation:Yoe(e)}}function Yoe(t){let e=Xq[t];return t&&e==null&&(e=Xq.HH),e||0}let Ug=null;const Qq=[255,255,255];function e7(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function g4e(t,e,i){const{backgroundColor:r,outline:n,dotSize:s}=t,o=(i==null?void 0:i.swatchSize)||Pr.size,a=.8,u=Math.round(o*o/Math.max(s,.5)**2*a),d=window.devicePixelRatio,p=document.createElement("canvas"),h=o*d;p.width=h,p.height=h,p.style.width=p.width/d+"px",p.style.height=p.height/d+"px";const m=p.getContext("2d");if(r&&(m.fillStyle=r.toCss(!0),m.fillRect(0,0,h,h),m.fill()),m.fillStyle=(e==null?void 0:e.toCss(!0))??"",Ug&&Ug.length/2===u)for(let g=0;g<2*u;g+=2){const v=Ug[g],_=Ug[g+1];m.fillRect(v,_,s*d,s*d),m.fill()}else{Ug=[];for(let g=0;g<2*u;g+=2){const v=e7(0,h),_=e7(0,h);Ug.push(v,_),m.fillRect(v,_,s*d,s*d),m.fill()}}n&&(n.color&&(m.strokeStyle=n.color.toCss(!0)),m.lineWidth=n.width,m.strokeRect(0,0,h,h));const y=new Image(o,o);return y.src=p.toDataURL(),y.ariaLabel=(i==null?void 0:i.ariaLabel)??null,y.alt=(i==null?void 0:i.ariaLabel)??"",y}function v4e(t,e={}){const i=e.radius||40,r=2*Math.PI*i,n=t.length,s=r/n,o=[],a=S$(e.outline);(a==null?void 0:a.width)!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:a,offset:[0,0]});const u=e.values,d=u&&u.length===n&&u.reduce((g,v)=>g+v,0)===100,p=[0];for(let g=0;g<n;g++){let v=null;d&&(v=u[g]*r/100,p.push(v+p[g])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(v??s)/2} ${r}`,dashoffset:"-"+(d?p[g]/2:g*(s/2)),color:t[g]},offset:[0,0]})}let h=null;const m=2*i+((a==null?void 0:a.width)||0),y=e.holePercentage;if(y){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*y},fill:null,stroke:a,offset:[0,0]});const g=m/2;h=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:Qq,stroke:a?{...a,color:Qq}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:i*y},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return gE([o],[m,m],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:h,rotations:[-90],ariaLabel:e.ariaLabel})}function Hf(t,e={}){const n=e.align==="horizontal",s=n?75:24,o=n?24:75,a=e.width??s,u=e.height??o,d=e.gradient??!0,p=window.devicePixelRatio,h=a*p,m=u*p,y=document.createElement("canvas");y.width=h,y.height=m,y.ariaLabel=e.ariaLabel??null,y.style.width=`${a}px`,y.style.height=`${u}px`;const g=y.getContext("2d"),v=n?h:0,_=n?0:m;if(d){const S=g.createLinearGradient(0,0,v,_),E=t.length,T=E===1?0:1/(E-1);t.forEach((M,x)=>S.addColorStop(x*T,M.toString())),g.fillStyle=S,g.fillRect(0,0,h,m)}else{const S=n?h/t.length:h,E=n?m:m/t.length;let T=0,M=0;for(const x of t)g.fillStyle=x.toString(),g.fillRect(T,M,S,E),T=n?T+S:0,M=n?0:M+E}const w=document.createElement("div");return w.style.width=`${a}px`,w.style.height=`${u}px`,b4e(w,e==null?void 0:e.effectList),w.appendChild(y),w}function b4e(t,e){if(!e)return;t.style.filter=E$(e);const i=e.effects;if(i){for(const r of i)if((r==null?void 0:r.type)==="drop-shadow"){r.offsetX<0?t.style.marginLeft=`${Math.abs(r.offsetX)}px`:t.style.marginRight=`${r.offsetX}px`;break}}}async function bU(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await k(()=>import("./previewWebStyleSymbol-ov90t3o4.js"),[]);return i(t,bU,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await k(()=>Promise.resolve().then(()=>p4e),void 0);return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await k(()=>import("./previewSymbol2D-CazLRysr.js"),__vite__mapDeps([314,88]));return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await k(()=>import("./previewCIMSymbol-BQBea4d8.js"),__vite__mapDeps([315,86,87,88,26,89,90,85,316,172]));return i(t,e)}default:return}}function Koe(t){return t&&"opacity"in t?t.opacity*Koe(t.parent):1}async function tD(t,e){var E;if(!t)return;const i=t.sourceLayer,r=(e!=null&&e.useSourceLayer?i:t.layer)??i,n=Koe(r);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const T=t.symbol.type==="web-style"?await H5e(t.symbol,{...e,cache:e!=null?e.webStyleCache:null}):t.symbol.clone();return iO(T,null,n),T}const s=(e==null?void 0:e.renderer)??_4e(r);let o=s&&"getSymbolAsync"in s?await s.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,cache:e!=null?e.webStyleCache:null}):o.clone(),!s||!("visualVariables"in s)||!((E=s.visualVariables)!=null&&E.length))return iO(o,null,n),o;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(e==null?void 0:e.arcade)==null){const T={...e};T.arcade=await Tc(),e=T}const{getColor:a,getOpacity:u,getAllSizes:d,getRotationAngle:p}=await k(()=>Promise.resolve().then(()=>pg),void 0),h=[],m=[],y=[],g=[];for(const T of s.visualVariables)switch(T.type){case"color":h.push(T);break;case"opacity":m.push(T);break;case"rotation":g.push(T);break;case"size":T.target||y.push(T)}const v=!!h.length&&h[h.length-1],_=v?a(v,t,e):null,w=!!m.length&&m[m.length-1];let S=w?u(w,t,e):null;if(n!=null&&(S=S!=null?S*n:n),iO(o,_,S),y.length){const T=d(y,t,e);await z5e(o,T)}for(const T of g)B5e(o,p(T,t,e),T.axis);return o}function _4e(t){if(t)return"renderer"in t?t.renderer:void 0}var iD;let wa=iD=class extends q{constructor(t){super(t),this._activeFetchInfo={id:null,request:null},this.disabledFunction=null,this.layer=null,this.template=null,this.thumbnail=null}initialize(){this.addHandles(N(()=>{const{layer:t}=this;return[t&&"renderer"in t?t.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null,this._activeFetchInfo.request=null,this._set("thumbnail",null)},be))}get description(){var t;return(t=this.template)==null?void 0:t.description}set description(t){this.template&&(this.template.description=t)}get disabled(){var t;return((t=this.disabledFunction)==null?void 0:t.call(this,this))??!1}get label(){var t;return(t=this.template)==null?void 0:t.name}set label(t){this.template&&(this.template.name=t)}get id(){var t;return`${this.label??""}–${(t=this.layer)==null?void 0:t.id}`}get supportsUpload(){var t;return((t=this.layer)==null?void 0:t.type)==="scene"}clone(){const t=this.thumbnail!=null?this.thumbnail.cloneNode(!0):null,e=new iD({layer:this.layer,template:this.template});return e._set("thumbnail",t),e}static async fetchThumbnail(t,e){var n;const i=await w4e(t,e);if(i==null)return null;const r={maxSize:36};return((n=t.renderer)==null?void 0:n.type)==="dictionary"&&(r.fieldMap=t.renderer.fieldMap??void 0,r.feature={attributes:e.prototype.attributes??{}}),await bU(i,r)}};l([c()],wa.prototype,"description",null),l([c()],wa.prototype,"disabled",null),l([c()],wa.prototype,"disabledFunction",void 0),l([c()],wa.prototype,"label",null),l([c()],wa.prototype,"layer",void 0),l([c()],wa.prototype,"template",void 0),l([c()],wa.prototype,"thumbnail",void 0),l([c()],wa.prototype,"id",null),l([c()],wa.prototype,"supportsUpload",null),wa=iD=l([$("esri.widgets.FeatureTemplates.TemplateItem")],wa);const Xoe=wa;async function w4e(t,e){const{renderer:i}=t;if(i){const r=new Li({attributes:e.prototype.attributes}),n=await i.getSymbolAsync(r);if(n)return n}return S4e(t)}async function S4e(t){const{geometryType:e}=t,i=e==="point"||e==="multipoint"?await k(()=>Promise.resolve().then(()=>OSe),void 0):e==="polyline"?await k(()=>Promise.resolve().then(()=>X1e),void 0):e==="polygon"||e==="mesh"||e==="multipatch"?await k(()=>Promise.resolve().then(()=>ASe),void 0):null;return i?new i.default:null}let Eh=class extends vu(q){constructor(e){super(e),this.allItems=[],this.filterFunction=null,this.label=null}get items(){const{filterFunction:e}=this;return e==null||e(this)?this.allItems:this.allItems.filter(e)}get id(){return this.label}reapplyFilter(){this.notifyChange("filterFunction")}findByTemplate(e){return this.items.find(i=>i.template===e)}};l([c()],Eh.prototype,"allItems",void 0),l([c()],Eh.prototype,"filterFunction",void 0),l([c()],Eh.prototype,"items",null),l([c()],Eh.prototype,"label",void 0),l([c()],Eh.prototype,"id",null),Eh=l([$("esri.widgets.FeatureTemplates.TemplateItemGroup")],Eh);const $4e=Eh,tC=t=>t==null||typeof t!="object"?[]:[..."templates"in t&&Array.isArray(t.templates)?t.templates:[],..."types"in t&&Array.isArray(t.types)?t.types.flatMap(e=>e.templates):[]];var cM;const E4e=({layer:t})=>({key:t,label:t.title??""}),T4e=({layer:t})=>({key:t.geometryType,label:t.geometryType??""});let an=cM=class extends ji.EventedAccessor{constructor(t){super(t),this._allItems=[],this._updatingHandles=new Wo,this._updateAllItemsTask=null,this.disabled=!1,this.disabledItemFunction=null,this.filterFunction=null,this.selectedItem=null}initialize(){this._get("groupBy")||(this.groupBy="layer"),this.addHandles([N(()=>[this._featureTemplatesByLayer,this._groupByFunction],()=>{this._updateAllItemsTask=mr(this._updateAllItemsTask);const t=Xo(e=>this._updateAllItems(e));this._updateAllItemsTask=t,this._updatingHandles.addPromise(t.promise)},gt),N(()=>this.filterFunction,t=>{for(const e of this._allItems)My(e)&&(e.filterFunction=t)},yn)])}get _featureTemplatesByLayer(){const t=new Map;if(!this.layers)return t;for(const e of this.layers)if(e.type==="subtype-group")for(const i of e.sublayers)t.set(i,tC(i));else t.set(e,tC(e));return t}set groupBy(t){if(this._set("groupBy",t),typeof t!="function")switch(t){case"layer":this._groupByFunction=E4e;break;case"geometry":this._groupByFunction=T4e;break;default:this._groupByFunction=null}else this._groupByFunction=e=>this._ensureGroupByObject(t(e))}get layers(){return this._get("layers")}set layers(t){const e="layers";if(this.removeHandles(e),t){const i=()=>this.notifyChange("state");this.addHandles(t.map(r=>Hi(()=>r.loadStatus,i)),e)}this._set("layers",t)}get state(){return this.updating?"loading":this.layers.length===0?"disabled":"ready"}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((t,e)=>t+e.length,0)}get items(){const{filterFunction:t}=this;return t==null?this._allItems:this._allItems.filter(e=>My(e)?e.items.length>0:t(e))}get updating(){return this._updatingHandles.updating}refresh(){this.notifyChange("filterFunction");for(const t of this._allItems)My(t)&&t.reapplyFilter()}select(t,{emit:e=!0}={}){const i=this.selectedItem,r=(t==null?void 0:t.clone())||null;this._set("selectedItem",r),e&&this.emit("select",{item:r,oldItem:i,template:(r==null?void 0:r.template)??null})}_createItem(t,e){return new Xoe({disabledFunction:this.disabledItemFunction,layer:e,template:t})}_ensureGroupByObject(t){return typeof t=="string"?{key:t,label:t}:t}async _updateAllItems(t){var p,h;const e=this._allItems;if(this.numberOfFeatureTemplates===0)return I4e(e),void(this._allItems=[]);const[i,r]=ZVe(e),n={signal:t},s=this._featureTemplatesByLayer,o=[];for(const[m,y]of s){await WVe(m,n),qe(t);const g=(p=Uy(m))==null?void 0:p.operations;if(g!=null&&g.supportsEditing&&(g!=null&&g.supportsAdd))for(const v of y)i.has(v)?(o.push(i.get(v)),i.delete(v)):o.push(this._createItem(v,m))}for(const m of[...i.values(),...r])m.destroy();if(this._groupByFunction==null)return qe(t),void(this._allItems=o);const a=new Map;for(const m of o){const y=this._groupByFunction(m),{key:g,label:v}=y.key!=null?y:cM.nullGroupBy;a.has(g)||a.set(g,{label:v,items:[]}),(h=a.get(g))==null||h.items.push(m)}const{filterFunction:u}=this,d=Array.from(a.values()).map(({label:m,items:y})=>new $4e({allItems:y,filterFunction:u,label:m}));qe(t),d.length===1&&d[0].label===cM.nullGroupBy.label?this._allItems=d[0].allItems:this._allItems=d}};function I4e(t){for(const e of t){if(My(e))for(const i of e.items)i.destroy();e.destroy()}}an.nullGroupBy={key:Symbol(),label:"Other​"},l([c()],an.prototype,"_allItems",void 0),l([c()],an.prototype,"_featureTemplatesByLayer",null),l([c()],an.prototype,"_groupByFunction",void 0),l([c()],an.prototype,"_updatingHandles",void 0),l([c()],an.prototype,"disabled",void 0),l([c()],an.prototype,"disabledItemFunction",void 0),l([c({value:null})],an.prototype,"filterFunction",void 0),l([c()],an.prototype,"groupBy",null),l([c({value:[]})],an.prototype,"layers",null),l([c()],an.prototype,"state",null),l([c({readOnly:!0})],an.prototype,"numberOfFeatureTemplates",null),l([c({readOnly:!0})],an.prototype,"items",null),l([c({readOnly:!0})],an.prototype,"selectedItem",void 0),l([c()],an.prototype,"updating",null),an=cM=l([$("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],an);const rD=an,Th="esri-item-list",lI=`${Th}__list-item`,vc={base:Th,filterContainerSticky:`${Th}__filter-container--sticky`,group:`${Th}__group`,groupHeader:`${Th}__group__header`,item:lI,itemDisabled:`${lI}--disabled`,itemIcon:`${lI}-icon`,itemContentEnd:`${lI}-content-end`,noMatchesMessage:`${Th}__no-matches-message`,scroller:`${Th}__scroller`,scrollerEnabled:`${Th}__scroller--enabled`},x4e=4;function Qoe(t){const{disabled:e,filterText:i="",id:r,messages:n,onFilterChange:s,...o}=t;return b("div",{key:r},t.filterEnabled??1?k4e({disabled:e,filterText:i,id:r,messages:n,onFilterChange:s}):null,C4e({...o,disabled:e,enableListScroll:t.enableListScroll??!0,filterText:i,messages:n}))}function M4e(t){return!!t.items}function C4e(t){const{headingLevel:e,items:i,...r}=t;return i.length===0?b("div",{class:vc.noMatchesMessage,key:"no-matches"},t.messages.noMatches):b("div",{class:nu({[vc.scroller]:!0,[vc.scrollerEnabled]:!!t.enableListScroll}),key:"item-container"},i.map(n=>M4e(n)?L4e({...r,group:n,headingLevel:e}):_U({...r,grouped:!0,item:n})))}function k4e(t){const{disabled:e,messages:i,filterText:r,enableListScroll:n}=t;return b("div",{class:n?void 0:vc.filterContainerSticky,key:"filter"},b("calcite-input",{disabled:e,placeholder:i.filterPlaceholder,type:"search",value:r,onCalciteInputInput:s=>{const o=s.currentTarget;t.onFilterChange&&t.onFilterChange(o.value)}}))}function _U(t){const{disabled:e,grouped:i,identify:r,item:n,onItemMouseEnter:s,onItemMouseLeave:o,onItemSelect:a,renderIcon:u,renderCustomItem:d,renderItemContent:p,renderItemContentEnd:h,renderItemLabel:m,renderItemDescription:y,selectedItem:g}=t,v=t7(n,r),_=v===t7(g,r),w=d==null?void 0:d(t);if(w)return w;const S=p==null?void 0:p(n),E=h==null?void 0:h(n),T=!(!n.disabled&&!e);return b("calcite-list-item",{afterUpdate:M=>{M.selected=_},"aria-level":i?"2":"",class:nu({[vc.item]:!0,[vc.itemDisabled]:T}),"data-item":n,description:S?void 0:(y==null?void 0:y(n))??void 0,disabled:T,key:v,label:S?void 0:(m==null?void 0:m(n))??n.label??void 0,onmouseenter:M=>s==null?void 0:s(nO(M)),onmouseleave:M=>o==null?void 0:o(nO(M)),selected:_,tabIndex:T?-1:0,onCalciteListItemSelect:M=>{M.preventDefault(),a==null||a(nO(M))}},b("div",{class:vc.itemIcon,key:"content-start",slot:"content-start"},u==null?void 0:u(n)),S?b("div",{key:"content",slot:"content"},S):null,E?b("div",{class:vc.itemContentEnd,key:"content-end",slot:"content-end"},E):null)}function t7(t,e){return t?`${(e==null?void 0:e(t))||t.id}__${t.label}`:""}function nO(t){return t.currentTarget["data-item"]}function L4e(t){const{disabled:e,group:i,headingLevel:r=x4e,selectionMode:n="none",renderCustomGroupContent:s,...o}=t,a=s==null?void 0:s(t);return b("div",{class:vc.group,key:i.label??void 0},b(Ya,{class:vc.groupHeader,level:r},i.label),a||b("calcite-list",{disabled:e,selectionAppearance:"border",selectionMode:n},i.items.map(u=>_U({...o,disabled:e,item:u,grouped:!0}))))}let dM=class extends q{constructor(e){super(e),this.filter=!0}};l([c({type:Boolean,nonNullable:!0})],dM.prototype,"filter",void 0),dM=l([$("esri.widgets.FeatureTemplates.VisibleElements")],dM);const eae=dM,A4e={base:"esri-feature-templates"};function O4e(t){return t.length>0&&My(t[0])}function R4e(t){return t.id}let Ni=class extends $t{constructor(e,i){super(e,i),this.enableListScroll=!0,this.filterText="",this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.selectionMode="none",this.viewModel=new rD,this.visibleElements=new eae,this.renderCustomItem=r=>null,this.renderCustomGroupContent=r=>null,this.renderItemLabel=()=>null,this.renderItemDescription=()=>null,this.renderItemContent=r=>null,this.renderItemContentEnd=r=>null,this._iconIntersectionObserver=new IntersectionObserver((r,n)=>{r.forEach(async s=>{if(s.isIntersecting){const o=s.target;if(F4e(o))return void n.unobserve(o);const a=P4e(o),{layer:u,template:d}=a;i7(o,!0);const p=await Xoe.fetchThumbnail(u,d).catch(()=>(i7(o,!1),null));if(p==null)return;o.appendChild(p)}})}),this._renderItemIcon=r=>wy(r.layer)?b("span",{"data-has-icon":!0,"data-item":r,key:"icon"},b("calcite-icon",{icon:"table"})):b("span",{afterCreate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":r,key:"icon"}),this._afterItemCreateOrUpdate=r=>{var n;(n=this._iconIntersectionObserver)==null||n.observe(r)},this._afterItemRemoved=r=>{var n;(n=this._iconIntersectionObserver)==null||n.unobserve(r)}}initialize(){const e=({label:i})=>!this.filterText||!!(i!=null&&i.toLowerCase().includes(this.filterText.toLowerCase()));this.addHandles(N(()=>this.viewModel,(i,r)=>{i&&!i.filterFunction&&(this.filterFunction=e),r&&r!==i&&r.filterFunction===e&&(r.filterFunction=null)},be))}destroy(){var e;(e=this._iconIntersectionObserver)==null||e.disconnect(),this._iconIntersectionObserver=null}loadDependencies(){return Gt({icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242])),input:()=>k(()=>import("./calcite-input-Dp8TE27V.js"),__vite__mapDeps([266,267,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244]))})}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(e){this.viewModel.filterFunction=e}get groupBy(){return this.viewModel.groupBy}set groupBy(e){this.viewModel.groupBy=e}get icon(){return"list-rectangle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}get selectedItem(){return this.viewModel.selectedItem}select(e,i){return this.viewModel.select(e,i)}render(){const{disabled:e,enableListScroll:i,filterText:r,headingLevel:n,messages:s,viewModel:{items:o,numberOfFeatureTemplates:a,selectedItem:u,state:d}}=this,p=this.visibleElements.filter&&a>1;if(O4e(o)){const h=o.find(m=>m.label===rD.nullGroupBy.label);h&&(h.label=s.other)}return b("div",{"aria-label":s.widgetLabel,class:this.classes(A4e.base,K.widget)},d==="loading"?b("calcite-loader",{key:"loader",label:this.messagesCommon.loading,type:"indeterminate"}):d==="ready"?b(Qoe,{disabled:e,enableListScroll:i,filterEnabled:p,filterText:r,headingLevel:n,id:this.id,identify:R4e,items:o,messages:{filterPlaceholder:s.filterPlaceholder,noItems:s.noItems,noMatches:s.noMatches},renderCustomGroupContent:this.renderCustomGroupContent,renderCustomItem:this.renderCustomItem,renderIcon:this._renderItemIcon,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,selectedItem:u??void 0,selectionMode:this.selectionMode??void 0,onFilterChange:h=>{this.filterText=h},onItemSelect:h=>!My(h)&&this.viewModel.select(h)}):null)}};function P4e(t){return t==null?void 0:t["data-item"]}function F4e(t){return!!(t!=null&&t["data-has-icon"])}function i7(t,e){t&&(t["data-has-icon"]=e)}l([c()],Ni.prototype,"disabled",null),l([c()],Ni.prototype,"enableListScroll",void 0),l([c()],Ni.prototype,"filterFunction",null),l([c()],Ni.prototype,"filterText",void 0),l([c()],Ni.prototype,"groupBy",null),l([c()],Ni.prototype,"headingLevel",void 0),l([c()],Ni.prototype,"icon",null),l([c()],Ni.prototype,"label",null),l([c()],Ni.prototype,"layers",null),l([c(),Ue("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Ni.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Ni.prototype,"messagesCommon",void 0),l([c({readOnly:!0})],Ni.prototype,"selectedItem",null),l([c()],Ni.prototype,"selectionMode",void 0),l([c(),km("select")],Ni.prototype,"viewModel",void 0),l([c({type:eae,nonNullable:!0})],Ni.prototype,"visibleElements",void 0),l([c()],Ni.prototype,"renderCustomItem",void 0),l([c()],Ni.prototype,"renderCustomGroupContent",void 0),l([c()],Ni.prototype,"renderItemLabel",void 0),l([c()],Ni.prototype,"renderItemDescription",void 0),l([c()],Ni.prototype,"renderItemContent",void 0),l([c()],Ni.prototype,"renderItemContentEnd",void 0),Ni=l([$("esri.widgets.FeatureTemplates")],Ni);const N4e=Ni;let qf=class extends ji.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([Hi(()=>{const i=this.screenLocationEnabled?this.view:null;return i?[i.size,i.type==="3d"?i.camera:i.viewpoint]:null},()=>this.notifyChange("screenLocation")),N(()=>this.screenLocation,(i,r)=>{i!=null&&r!=null&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const{location:e,view:i,screenLocationEnabled:r}=this,n=i==null?void 0:i.spatialReference,s=n?qX(e,n).geometry:null;return r&&s&&(i!=null&&i.ready)?i.toScreen(s):null}};l([c()],qf.prototype,"location",void 0),l([c()],qf.prototype,"screenLocation",null),l([c()],qf.prototype,"screenLocationEnabled",void 0),l([c()],qf.prototype,"view",void 0),qf=l([$("esri.widgets.support.AnchorElementViewModel")],qf);const D4e=qf;let pM=class extends D4e{constructor(e){super(e),this.visible=!1}};l([c()],pM.prototype,"visible",void 0),pM=l([$("esri.widgets.Spinner.SpinnerViewModel")],pM);const wU=pM,sO="esri-spinner",oO={base:sO,spinnerStart:`${sO}--start`,spinnerFinish:`${sO}--finish`};let Wf=class extends $t{constructor(e,i){super(e,i),this._animationDelay=500,this._animationPromise=null,this.viewModel=new wU}initialize(){this.addHandles(N(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:i,promise:r}=e??{};i&&(this.viewModel.location=i),this.visible=!0;const n=()=>this.hide();r&&r.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:i}=this.viewModel,r=!!i,n=e&&r,s=!e&&r,o={[oO.spinnerStart]:n,[oO.spinnerFinish]:s},a=this._getPositionStyles();return b("div",{class:this.classes(oO.base,o),styles:a})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const i=i_(this._animationDelay);this._animationPromise=i,i.catch(()=>{}).then(()=>{this._animationPromise===i&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:i}=this.viewModel;if(i==null||e==null)return{};const{padding:r}=i;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};l([c()],Wf.prototype,"location",null),l([c()],Wf.prototype,"view",null),l([c({type:wU})],Wf.prototype,"viewModel",void 0),l([c()],Wf.prototype,"visible",null),Wf=l([$("esri.widgets.Spinner")],Wf);const V4e=Wf,jg="esri-editor",Gg={base:jg,helpMessage:`${jg}__help-message`,updateActions:`${jg}__update-actions`,updateActionsList:`${jg}__update-actions-list`,featureTemplatesContainer:`${jg}__feature-templates-container`,templateItemContentEnd:`${jg}__template-item-content-end`};let $d=class extends Kte(Mie(u5)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new Ty,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,i){return super.on(e,i)}graphicChanged(e){this.emit("graphic-update",e)}};l([c({type:oie})],$d.prototype,"elevationInfo",void 0),l([c(fN(Ty,"graphics"))],$d.prototype,"graphics",void 0),l([c({type:["show","hide"]})],$d.prototype,"listMode",void 0),l([c()],$d.prototype,"screenSizePerspectiveEnabled",void 0),l([c({readOnly:!0})],$d.prototype,"type",void 0),l([c({constructOnly:!0})],$d.prototype,"internal",void 0),$d=l([$("esri.layers.GraphicsLayer")],$d);const vE=$d;let hM=class extends q{constructor(e){super(e),this.enabled=!1}};l([c({type:Boolean,nonNullable:!0})],hM.prototype,"enabled",void 0),hM=l([$("esri.views.interactive.sketch.SketchLabelOptions")],hM);const SU=hM;let AS=class extends q{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};l([c({type:String,nonNullable:!0})],AS.prototype,"mode",void 0),AS=l([$("esri.views.interactive.sketch.SketchTooltipElevationOptions")],AS);let qn=class extends q{constructor(e){super(e),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};l([c({type:Boolean,nonNullable:!0})],qn.prototype,"area",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"coordinates",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"direction",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"distance",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"elevation",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"header",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"helpMessage",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"orientation",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"radius",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"rotation",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"scale",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"size",void 0),l([c({type:Boolean,nonNullable:!0})],qn.prototype,"totalLength",void 0),qn=l([$("esri.views.interactive.sketch.SketchTooltipVisibleElements")],qn);const tae=qn;let vs=class extends q{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new AS,this.placement="auto",this.offset=null,this.visibleElements=new tae,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};l([c({type:Boolean,nonNullable:!0})],vs.prototype,"enabled",void 0),l([c()],vs.prototype,"forceEnabled",void 0),l([c()],vs.prototype,"effectiveEnabled",null),l([c()],vs.prototype,"helpMessage",void 0),l([c()],vs.prototype,"helpMessageIcon",void 0),l([c({type:Boolean,nonNullable:!0})],vs.prototype,"inputEnabled",void 0),l([c({type:AS,nonNullable:!0})],vs.prototype,"elevation",void 0),l([c()],vs.prototype,"placement",void 0),l([c()],vs.prototype,"offset",void 0),l([c({type:tae,nonNullable:!0})],vs.prototype,"visibleElements",void 0),l([c()],vs.prototype,"visualVariables",void 0),l([c()],vs.prototype,"xyMode",void 0),vs=l([$("esri.views.interactive.sketch.SketchTooltipOptions")],vs);const $U=vs;let n0=class extends q{constructor(e){super(e),this.labels=new SU,this.tooltips=new $U,this.values=new Bk}};l([c({nonNullable:!0,type:SU})],n0.prototype,"labels",void 0),l([c({nonNullable:!0,type:$U})],n0.prototype,"tooltips",void 0),l([c({nonNullable:!0,type:Bk})],n0.prototype,"values",void 0),n0=l([$("esri.views.interactive.sketch.SketchOptions")],n0);const Lm=n0;function iae(t){return t?Ky:Z4e}function U4e(t,e){return e!=null&&e.mode?e.mode:iae(t).mode}function j4e(t,e){return e??iae(t)}function rae(t,e){return U4e(t==null||(t.hasZ??!1),e)}function zst(t,e){return j4e(t==null||(t.hasZ??!1),e)}function G4e(t){const e=sae(t);return rae(t.geometry,e)}function EU(t){const e=sae(t),i=rae(t.geometry,e),r=e!=null&&i!=="on-the-ground"?W4e(e):0,n=e==null?void 0:e.featureExpressionInfo;return{mode:i,offset:r,featureExpressionInfo:n}}function nae(t){return bE(EU(t))}function Bst(t){return bE(t)||z4e(t)}function z4e(t){var e;return((e=t==null?void 0:t.featureExpressionInfo)==null?void 0:e.expression)==="0"}function bE(t){if(!t||t.mode==="on-the-ground")return!1;const e=t!=null&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!e||e==="0")}function sae(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function Zk(t,e){if(!(t!=null&&t.offset))return 0;const{offset:i,unit:r}=t;if(r==="decimal-degrees")return 0;const n=r!=="unknown"&&r?r:"meters",s=vfe(e);return s?Oe(i,n,s):0}function Hst(t,e,i){if(!(i!=null&&i.mode))return;const r=t.hasZ?t.z:0,n=Zk(i,t.spatialReference);switch(i.mode){case"absolute-height":return r-n;case"on-the-ground":return 0;case"relative-to-ground":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"ground")??0)+n);case"relative-to-scene":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"scene")??0)+n)}}function B4e(t,e,i,r=null){return TU(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,i,r)}function oae(t,e,i,r,n=null){return TU(t,e[0],e[1],e.length>2?e[2]:0,i,r,n)}function TU(t,e,i,r,n,s,o=null){if(s==null)return;const a=o!=null?o.mode:"absolute-height";if(a==="on-the-ground")return 0;const{absoluteZ:u}=H4e(e,i,r,n,t,s);return q4e(u,e,i,r,n,t,o,a)}function H4e(t,e,i,r,n,s){const o=Zk(s,r);switch(s.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const a=n.elevationProvider.getElevation(t,e,0,r,"ground")??0;return{absoluteZ:a,elevation:a}}case"relative-to-ground":{const a=n.elevationProvider.getElevation(t,e,i,r,"ground")??0;return{absoluteZ:i+a+o,elevation:a}}case"relative-to-scene":{const a=n.elevationProvider.getElevation(t,e,i,r,"scene")??0;return{absoluteZ:i+a+o,elevation:a}}}}function q4e(t,e,i,r,n,s,o,a){const u=Zk(o,n);switch(a){case"absolute-height":return t-u;case"relative-to-ground":return t-((s.elevationProvider.getElevation(e,i,r,n,"ground")??0)+u);case"relative-to-scene":return t-((s.elevationProvider.getElevation(e,i,r,n,"scene")??0)+u)}}function qst(t,e){if(e==null)return!1;const{mode:i}=e;return i!=null&&(t==="scene"&&i==="relative-to-scene"||t==="ground"&&i!=="absolute-height")}function Wst(t,e,i){return i&&i.mode!==e?`${t} only support ${e} elevation mode`:null}function Zst(t,e,i){return(i==null?void 0:i.mode)===e?`${t} do not support ${e} elevation mode`:null}function Jst(t,e){return(e==null?void 0:e.featureExpressionInfo)!=null&&e.featureExpressionInfo.expression!=="0"?`${t} do not support featureExpressionInfo`:null}function Yst(t,e){e&&t.warn(".elevationInfo=",e)}function W4e(t){return((t==null?void 0:t.offset)??0)*Txe(t==null?void 0:t.unit)}const Ky={mode:"absolute-height",offset:0},Z4e={mode:"on-the-ground",offset:null};var Xy;function aae(t,e,i){return Ko(t,e,i)}function Ko(t=0,e=0,i=0){return Lr(t,e,i)}function Kst(t){return t}function Xst(t){return t}function Sm(t,e,i){return Lr(t,e,i)}function Wb(t){const[e,i,r]=t;return t.length>3?[e,i,r,t[3]]:[e,i,r]}function aO(t){return t[3]=((t.length>3?t[3]:void 0)??Xy.NONE)|Xy.TARGET,t}function Qst(t){return!!(((t.length>3?t[3]:void 0)??Xy.NONE)&Xy.TARGET)}function r7(t,e,{coordinateHelper:i,elevationInfo:r},n){return t?z1(i.vectorToDehydratedPoint(t,J4e),e,r,n):null}function z1(t,e,i,r=Ko()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=B4e(e,t,i,Ky)??0),r}function eot(t,e,i){return i?(Qse(i,t[0],t[1],t[2],e),i):I_(t[0],t[1],t[2],e)}function n7(t,e,{z:i,m:r},n,s){const{spatialReference:o,elevationInfo:a}=n;let u;i==null&&r==null?u=void 0:e==null||e.type==="2d"?u=i??void 0:u=oae(e,t,o,Ky,a)??0;const[d,p]=t;return s?Qse(s,d,p,u,o):s=I_(d,p,u,o),r!=null&&(s.m=r,s.hasM=!0),s}function tot(t,e,i,r,n=Ko()){const[s,o]=t;return n[0]=s,n[1]=o,t.length>3&&(n[3]=t[3]??Xy.NONE),(i==null?void 0:i.type)!=="3d"?(n[2]=e.value,n):(n[2]=TU(i,s,o,e.value,r,e.elevationInfo,Ky)??0,n)}(function(t){t[t.NONE=0]="NONE",t[t.TARGET=1]="TARGET"})(Xy||(Xy={}));const J4e=I_(0,0,0,null);let su=class extends j{constructor(){super(...arguments),this.enabled=!0}};l([c({type:Boolean})],su.prototype,"enabled",void 0),su=l([$("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],su);let gi=class extends j{constructor(e){super(e),this.lineSnapper=new su,this.parallelLineSnapper=new su,this.rightAngleSnapper=new su,this.rightAngleTriangleSnapper=new su,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ee([255,127,0]),this.orangeTransparent=new ee([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};l([c({type:su,constructOnly:!0,nonNullable:!0,json:{write:!0}})],gi.prototype,"lineSnapper",void 0),l([c({type:su,constructOnly:!0,nonNullable:!0,json:{write:!0}})],gi.prototype,"parallelLineSnapper",void 0),l([c({type:su,constructOnly:!0,nonNullable:!0,json:{write:!0}})],gi.prototype,"rightAngleSnapper",void 0),l([c({type:su,constructOnly:!0,nonNullable:!0,json:{write:!0}})],gi.prototype,"rightAngleTriangleSnapper",void 0),l([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],gi.prototype,"shortLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],gi.prototype,"distance",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],gi.prototype,"pointThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],gi.prototype,"intersectionParallelLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],gi.prototype,"parallelLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],gi.prototype,"verticalLineThresholdMeters",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],gi.prototype,"touchSensitivityMultiplier",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],gi.prototype,"pointOnLineThreshold",void 0),l([c({type:ee,nonNullable:!0})],gi.prototype,"orange",void 0),l([c({type:ee,nonNullable:!0})],gi.prototype,"orangeTransparent",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],gi.prototype,"lineHintWidthReference",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],gi.prototype,"lineHintWidthTarget",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],gi.prototype,"lineHintFadedExtensions",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],gi.prototype,"parallelLineHintWidth",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],gi.prototype,"parallelLineHintLength",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],gi.prototype,"parallelLineHintOffset",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],gi.prototype,"rightAngleHintSize",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],gi.prototype,"rightAngleHintOutlineSize",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],gi.prototype,"satisfiesConstraintScreenThreshold",void 0),gi=l([$("esri.views.interactive.snapping.Settings.Defaults")],gi);const iC=new gi;var ss;(function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"})(ss||(ss={}));let Ih=class extends q{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new Y}};l([c({constructOnly:!0})],Ih.prototype,"layer",void 0),l([c()],Ih.prototype,"enabled",void 0),l([c()],Ih.prototype,"updating",void 0),l([c()],Ih.prototype,"availability",void 0),l([c()],Ih.prototype,"sublayerSources",void 0),Ih=l([$("esri.views.interactive.snapping.FeatureSnappingLayerSource")],Ih);const Jk=Ih;let ln=class extends q{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new Y,this.distance=iC.distance,this.touchSensitivityMultiplier=iC.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var u;const e=this.featureSources;e.some(s7)&&U.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const i=e.filter(K4e),r=((u=this._get("_effectiveFeatureSources"))==null?void 0:u.filter(s7))??new Y;for(const d of i){const p=r.find(h=>h.layer===d.layer.parent);if(p)p.sublayerSources.includes(d)||p.sublayerSources.add(d);else if(d.layer.parent){const h=new Jk({layer:d.layer.parent});h.sublayerSources.add(d),r.add(h)}}for(const d of r){const p=d.sublayerSources.filter(h=>!i.includes(h));d.sublayerSources.removeMany(p)}r.removeMany(r.filter(d=>d.sublayerSources.length===0));const n=e.filter(Y4e),s=this._get("_effectiveFeatureSources")??new Y,{added:o,removed:a}=RO(s.toArray(),[...n,...r]);return s.removeMany(a),s.addMany(o),s}};l([c()],ln.prototype,"enabled",void 0),l([c()],ln.prototype,"enabledToggled",void 0),l([c()],ln.prototype,"forceDisabled",void 0),l([c()],ln.prototype,"selfEnabled",void 0),l([c()],ln.prototype,"featureEnabled",void 0),l([c()],ln.prototype,"gridEnabled",void 0),l([c()],ln.prototype,"attributeRulesEnabled",void 0),l([c({type:Y.ofType(Jk)})],ln.prototype,"featureSources",void 0),l([c()],ln.prototype,"distance",void 0),l([c()],ln.prototype,"touchSensitivityMultiplier",void 0),l([c({readOnly:!0})],ln.prototype,"effectiveEnabled",null),l([c({readOnly:!0})],ln.prototype,"effectiveGridEnabled",null),l([c({readOnly:!0})],ln.prototype,"effectiveSelfEnabled",null),l([c({readOnly:!0})],ln.prototype,"effectiveFeatureEnabled",null),l([c({readOnly:!0})],ln.prototype,"_effectiveFeatureSources",null),ln=l([$("esri.views.interactive.snapping.SnappingOptions")],ln);const gg=ln;function s7(t){return t.layer.type==="subtype-group"}function Y4e(t){return t.layer.type!=="subtype-group"}function K4e(t){return t.layer.type==="subtype-sublayer"}const lae="z",uae="r",Yi={redo:uae,undo:lae,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},o7={toggle:"Control"},oot={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},aot={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:ire,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:lae,redo:uae};let lot=class{constructor(){this._bindings=new Map}add(e,i){return this.addToggle(e,r=>{r.type==="key-down"&&i(r)})}addToggle(e,i){const r=X4e.fromDefinition(e,i),n=Xd(this._bindings,r.key,()=>[]);return n.push(r),ye(()=>RS(n,r))}register(e,i=yt.WIDGET){return kr([e.on("key-down",r=>this.dispatch(e.inputManager,r),i),e.on("key-up",r=>this.dispatch(e.inputManager,r),i)])}dispatch(e,i){const r=i.key,n=this._bindings.get(r);if(n)for(const s of n)s.process(e,i)}},X4e=class nD{constructor(e,i,r,n,s){this.key=e,this.modifiers=i,this.repeats=r,this.continuePropagation=n,this.callback=s}process(e,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(e,i){if(typeof e=="string")return new nD(e,[],!1,!1,i);const{key:r,modifier:n,repeats:s,continuePropagation:o}=e;return new nD(r,n?Array.isArray(n)?n:[n]:[],!!s,!!o,i)}};const cot=Symbol("grid-placement-graphic");function cae(t,e){const i=t.x-e.x,r=t.y-e.y;return i*i+r*r}function dot(t,e){return Math.sqrt(cae(t,e))}function Q4e(t,e){e.sort((i,r)=>yp(i.targetPoint,t)-yp(r.targetPoint,t))}var il;function pot({point:t,distance:e,returnEdge:i,vertexMode:r,coordinateHelper:{spatialReference:n},filter:s},o,a){return a=a!=null?a.clone():new gu({where:"1=1"}),s&&(a.geometry=s.geometry,a.distance=s.distance,a.spatialRelationship=s.spatialRelationship,a.where=_5(a.where,s.where),a.timeExtent=r_e(a.timeExtent,s.timeExtent),a.objectIds=eUe(a.objectIds,s.objectIds)),{point:I_(t[0],t[1],t[2],n.toJSON()),mode:o,distance:e,returnEdge:i,vertexMode:r,query:a.toJSON()}}function eUe(t,e){return t||e?e?t?Array.from(jZ(new Set(t),new Set(e))):e:t:null}function hot(t,e,i){return{left:r7(t.leftVertex.pos,e,i),right:r7(t.rightVertex.pos,e,i)}}function mot(t){return t.createQuery()}(function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(il||(il={}));const a7=Symbol("snapping-toggle");function tUe(t,e=()=>{}){const i=N(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:n})=>{if(t.removeHandles(a7),!r||!n)return;const s=yt.TOOL,o=[r.on("key-down",a=>{a.key!==o7.toggle||a.repeat||(n.enabledToggled=!0,e())},s),r.on("key-up",a=>{a.key===o7.toggle&&(n.enabledToggled=!1,e())},s),r.on("pointer-move",a=>{const u=a.native.ctrlKey;n.enabledToggled!==u&&(n.enabledToggled=u,e())},s)];t.addHandles(o,a7)},gt);t.addHandles(i)}function fot(t){var e;return Yx(t)&&"utilityNetworks"in t&&!!((e=t.utilityNetworks)!=null&&e.length)}function yot(t,e,i){const r=tt(t,e)/tt(t,t);return jt(i,t,r)}function Cy(t,e){return tt(t,e)/Si(t)}function iUe(t,e){const i=tt(t,e)/(Si(t)*Si(e));return-qC(i)}function got(t,e,i){ls(uI,t),ls(lO,e);const r=tt(uI,lO),n=qC(r),s=As(uI,uI,lO);return tt(s,i)<0?2*Math.PI-n:n}const uI=W(),lO=W();function C_(){return[1,0,0,0,1,0,0,0,1]}function rUe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function dae(t,e,i,r,n,s,o,a,u){return[t,e,i,r,n,s,o,a,u]}function nUe(t,e){return new Float64Array(t,e,9)}const sUe=C_();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:sUe,clone:rUe,create:C_,createView:nUe,fromValues:dae},Symbol.toStringTag,{value:"Module"}));function ou(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function oUe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function aUe(t,e,i,r,n,s,o,a,u,d,p,h,m,y,g,v){return[t,e,i,r,n,s,o,a,u,d,p,h,m,y,g,v]}function lUe(t,e){return new Float64Array(t,e,16)}const IU=ou();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:IU,clone:oUe,create:ou,createView:lUe,fromValues:aUe},Symbol.toStringTag,{value:"Module"}));function Tp(){return[0,0,0,1]}function uUe(t){return[t[0],t[1],t[2],t[3]]}function cUe(t,e,i,r){return[t,e,i,r]}const xU=Tp();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:xU,clone:uUe,create:Tp,fromValues:cUe},Symbol.toStringTag,{value:"Module"}));let k_=class Zf{constructor(e){this._create=e,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&fb(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const e=2*this._itemsPtr;this._items.length>e&&(this._items.length=e),this._itemsPtr=0}static createVec2f64(){return new Zf(pt)}static createVec3f64(){return new Zf(W)}static createVec4f64(){return new Zf(Rc)}static createMat3f64(){return new Zf(C_)}static createMat4f64(){return new Zf(ou)}static createQuatf64(){return new Zf(Tp)}get test(){}};const vot=k_.createVec2f64(),Re=k_.createVec3f64(),dUe=k_.createVec4f64();k_.createMat3f64();const pUe=k_.createMat4f64(),hUe=k_.createQuatf64();function bot(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],i=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],r=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))}function _ot(t,e){const i=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),r=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),n=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return vt(t,i,r,n),t}function MU(t,e,i){Math.abs(t[0])>Math.abs(t[1])?vt(e,0,1,0):vt(e,1,0,0),As(i,t,e),As(e,i,t),ls(i,i),ls(e,e)}function vn(t=B1){return[t[0],t[1],t[2],t[3]]}function mUe(t=B1[0],e=B1[1],i=B1[2],r=B1[3]){return CU(t,e,i,r,dUe.get())}function pae(t,e){return CU(e[0],e[1],e[2],e[3],t)}function wot(t){return t}function CU(t,e,i,r,n=vn()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function _E(t,e,i){const r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=-(i[0]*t[0]+i[1]*t[1]+i[2]*t[2]),i}function hae(t,e,i,r=vn()){const n=i[0]-e[0],s=i[1]-e[1],o=i[2]-e[2],a=t[0]-e[0],u=t[1]-e[1],d=t[2]-e[2],p=s*d-o*u,h=o*a-n*d,m=n*u-s*a,y=p*p+h*h+m*m,g=Math.abs(y-1)>1e-5&&y>1e-12?1/Math.sqrt(y):1;return r[0]=p*g,r[1]=h*g,r[2]=m*g,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function mae(t,e,i,r=0,n=Math.floor(i*(1/3)),s=Math.floor(i*(2/3))){if(i<3)return!1;e(lw,r);let o=n,a=!1;for(;o<i-1&&!a;)e(zg,o),o++,a=!Ft(lw,zg);if(!a)return!1;for(o=Math.max(o,s),a=!1;o<i&&!a;)e(dy,o),o++,hi(cI,lw,zg),ls(cI,cI),hi(dI,zg,dy),ls(dI,dI),a=!Ft(lw,dy)&&!Ft(zg,dy)&&Math.abs(tt(cI,dI))<fUe;return a?(hae(lw,zg,dy,t),!0):(r!==0||n!==1||s!==2)&&mae(t,e,i,0,1,2)}function Sot(t,e,i=!0){const r=e.length/3;return mae(t,(n,s)=>vt(n,e[3*s+0],e[3*s+1],e[3*s+2]),i?r-1:r)}const fUe=.99619469809,lw=W(),zg=W(),dy=W(),cI=W(),dI=W();function yUe(t,e,i){return e!==t&&pae(t,e),t[3]=-tt(t,i),t}function $ot(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function sD(t,e,i,r){return As(dy,e,t),_E(i,dy,r)}function fae(t,e,i,r){return Yk(Kk(t,e,hi(Re.get(),i,e),wUe,r))}function gUe(t,e,i){return e!=null&&Yk(Kk(t,e.origin,e.direction,SUe,i))}function vUe(t,e,i){return Yk(Kk(t,e.origin,e.vector,wc.NONE,i))}function bUe(t,e,i){return Yk(Kk(t,e.origin,e.vector,wc.CLAMP,i))}function kU(t,e){return wE(t,e)>=0}function Eot(t,e){const i=tt(t,e.ray.direction),r=-wE(t,e.ray.origin);if(i>-1e-6&&i<1e-6)return r>0;const n=r/i;return i>0?n<e.c1&&(e.c1=n):n>e.c0&&(e.c0=n),e.c0<=e.c1}function LU(t,e,i){const r=jt(Re.get(),t,-t[3]),n=_Ue(t,hi(Re.get(),e,r),Re.get());return di(i,n,r),i}function Tot(t,e,i,r){const n=t,s=Re.get(),o=Re.get();MU(n,s,o);const a=hi(Re.get(),i,e),u=Cy(s,a),d=Cy(o,a),p=Cy(n,a);return vt(r,u,d,p)}function _Ue(t,e,i){const r=jt(Re.get(),t,tt(t,e));return hi(i,e,r),i}function oD(t,e){return Math.abs(wE(t,e))}function wE(t,e){return tt(t,e)+t[3]}var mc;function Yk(t){return t===mc.INTERSECTS_INSIDE_OUT||t===mc.INTERSECTS_OUTSIDE_IN}function Kk(t,e,i,r,n){const s=tt(t,i),o=wE(t,e);if(s===0)return o>=0?mc.INSIDE:mc.OUTSIDE;let a=-o/s;return r&wc.CLAMP&&(a=fr(a,0,1)),!(r&wc.INFINITE_MIN)&&a<0||!(r&wc.INFINITE_MAX)&&a>1?o>=0?mc.INSIDE:mc.OUTSIDE:(di(n,e,jt(n,i,a)),o>=0?mc.INTERSECTS_INSIDE_OUT:mc.INTERSECTS_OUTSIDE_IN)}(function(t){t[t.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",t[t.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE"})(mc||(mc={}));const B1=[0,0,1,0];var wc;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(wc||(wc={}));const wUe=wc.INFINITE_MIN|wc.INFINITE_MAX,SUe=wc.INFINITE_MAX;let SE=class{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&fb(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*l7);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,l7));e++)this._items.push(this._allocator())}};const l7=1024;function Ua(t){return t?u7(Yr(t.origin),Yr(t.direction)):u7(W(),W())}function u7(t,e){return{origin:t,direction:e}}function xot(t,e){const i=IUe.get();return i.origin=t,i.direction=e,i}function aD(t,e=Ua()){return $Ue(t.origin,t.direction,e)}function AU(t,e,i=Ua()){return Yt(i.origin,t),hi(i.direction,e,t),i}function $Ue(t,e,i=Ua()){return Yt(i.origin,t),Yt(i.direction,e),i}function EUe(t,e){const i=As(Re.get(),ls(Re.get(),t.direction),hi(Re.get(),e,t.origin));return tt(i,i)}function TUe(t,e,i){const r=tt(t.direction,hi(i,e,t.origin));return di(i,t.origin,jt(i,t.direction,r)),i}const IUe=new SE(()=>Ua());function c7(t,e){const i=Si(t),r=jV(t[2]/i),n=Math.atan2(t[1]/i,t[0]/i);return vt(e,i,r,n),e}const xUe=$E();function $E(){return Rc()}const yae=vk,MUe=vk;function gae(t,e){return n$(e,t)}function vae(t,e){return Pc(t[0],t[1],t[2],e)}function CUe(t){return t}function kUe(t){t[0]=t[1]=t[2]=t[3]=0}function LUe(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function EE(t){return t[3]}function AUe(t){return t}function OUe(t,e,i,r){return Pc(t,e,i,r)}function RUe(t,e,i){return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=t[3]+e,i}function PUe(t,e,i){return t!==i&&gae(t,i),i}function FUe(t,e){return e}function Xk(t,e,i){if(e==null||!_ae(t,e,rC))return!1;let{t0:r,t1:n}=rC;if((r<0||n<r&&n>0)&&(r=n),r<0)return!1;if(i){const{origin:s,direction:o}=e;i[0]=s[0]+o[0]*r,i[1]=s[1]+o[1]*r,i[2]=s[2]+o[2]*r}return!0}function bae(t,e,i){const r=AU(e,i);if(!_ae(t,r,rC))return[];const{origin:n,direction:s}=r,{t0:o,t1:a}=rC,u=d=>{const p=W();return ni(p,n,s,d),Qk(t,p,p)};return Math.abs(o-a)<qi()?[u(o)]:[u(o),u(a)]}const rC={t0:0,t1:0};function _ae(t,e,i){const{origin:r,direction:n}=e,s=NUe;s[0]=r[0]-t[0],s[1]=r[1]-t[1],s[2]=r[2]-t[2];const o=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];if(o===0)return!1;const a=2*(n[0]*s[0]+n[1]*s[1]+n[2]*s[2]),u=a*a-4*o*(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]-t[3]*t[3]);if(u<0)return!1;const d=Math.sqrt(u);return i.t0=(-a-d)/(2*o),i.t1=(-a+d)/(2*o),!0}const NUe=W();function DUe(t,e){return Xk(t,e,null)}function VUe(t,e,i){if(Xk(t,e,i))return i;const r=wae(t,e,Re.get());return di(i,e.origin,jt(Re.get(),e.direction,fg(e.origin,r)/Si(e.direction))),i}function wae(t,e,i){const r=Re.get(),n=pUe.get();As(r,e.origin,e.direction);const s=EE(t);As(i,r,e.origin),jt(i,i,1/Si(i)*s);const o=Sae(t,e.origin),a=iUe(e.origin,i);return WV(n,a+o,r),Wa(i,i,n),i}function UUe(t,e,i,r){const n=EE(t),s=n*n,o=e+.5*Math.PI,a=i*i+s-2*Math.cos(o)*i*n,u=Math.sqrt(a),d=a-s;if(d<=0)return .5;const p=Math.sqrt(d),h=Math.acos(p/u)-Math.asin(n/(u/Math.sin(o)));return Math.min(1,(h+.5*r)/r)}function jUe(t,e,i){return Xk(t,e,i)?i:(TUe(e,t,i),Qk(t,i,i))}function Qk(t,e,i){const r=hi(Re.get(),e,t),n=jt(Re.get(),r,t[3]/Si(r));return di(i,n,t)}function GUe(t,e){const i=hi(Re.get(),e,t),r=Wy(i),n=t[3]*t[3];return Math.sqrt(Math.abs(r-n))}function Sae(t,e){const i=hi(Re.get(),e,t),r=Si(i),n=EE(t),s=n+Math.abs(n-r);return qC(n/s)}const uO=W();function $ae(t,e,i,r){const n=hi(uO,e,t);switch(i){case uu.X:{const s=c7(n,uO)[2];return vt(r,-Math.sin(s),Math.cos(s),0)}case uu.Y:{const s=c7(n,uO),o=s[1],a=s[2],u=Math.sin(o);return vt(r,-u*Math.cos(a),-u*Math.sin(a),Math.cos(o))}case uu.Z:return ls(r,n);default:return}}function Eae(t,e){const i=hi(lD,e,t);return Si(i)-t[3]}function zUe(t,e,i,r){const n=Eae(t,e),s=$ae(t,e,uu.Z,lD),o=jt(lD,s,i-n);return di(r,e,o)}function BUe(t,e){const i=yp(t,e),r=EE(t);return i<=r*r}function HUe(t,e,i=Rc()){const r=fg(t,e),n=t[3],s=e[3];return r+s<n?(n$(i,t),i):r+n<s?(n$(i,e),i):(Uk(i,t,e,(r+s-n)/(2*r)),i[3]=(r+n+s)/2,i)}const lD=W(),qUe=$E(),Mot=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:xUe,altitudeAt:Eae,angleToSilhouette:Sae,axisAt:$ae,cameraFrustumCoverage:UUe,clear:kUe,closestPoint:jUe,closestPointOnSilhouette:wae,containsPoint:BUe,copy:gae,create:$E,distanceToSilhouette:GUe,elevate:RUe,equals:MUe,exactEquals:yae,fromCenterAndRadius:vae,fromRadius:LUe,fromValues:OUe,getCenter:AUe,getExtent:FUe,getRadius:EE,intersectLine:bae,intersectRay:Xk,intersectRayClosestSilhouette:VUe,intersectsRay:DUe,projectPoint:Qk,setAltitudeAt:zUe,setExtent:PUe,tmpSphere:qUe,union:HUe,wrap:CUe},Symbol.toStringTag,{value:"Module"}));function cO(t,e){return t[0]*e[1]-t[1]*e[0]}function WUe(t,e,i){const r=Cm(i,e)/fp(i);return $_(t,i,r)}function Cot(t,e,i,r,n=i){return Rr(ky,r,i),Rr(nC,e,n),WUe(Zb,nC,ky),U4(t,n,Zb)}function kot(t,e,i,r){Rr(ky,e,i);const n=r/jb(ky);return pu(t,i,ky,n)}function Lot(t,e){const i=t.start,r=t.end,n=e.start,s=e.end,o=Rr(ky,r,i),a=Rr(Tae,s,n),u=cO(o,a);if(Math.abs(u)<=JUe)return[];const d=Rr(nC,i,n),p=cO(a,d)/u,h=cO(o,d)/u;if(p>=0){if(h>=0||e.type===Ui.LINE)return[pu(Zb,i,o,p)]}else if(t.type===Ui.LINE&&(h>=0||e.type===Ui.LINE))return[pu(Zb,i,o,p)];return[]}function ZUe(t,e,i){const r=[],n=Rr(ky,t.end,t.start),s=Rr(Tae,t.start,e),o=fp(n),a=2*Cm(n,s),u=a*a-4*o*(fp(s)-i*i);if(u===0){const d=-a/(2*o);(t.type===Ui.LINE||d>=0)&&r.push(pu(Zb,t.start,n,d))}else if(u>0){const d=Math.sqrt(u),p=(-a+d)/(2*o);(t.type===Ui.LINE||p>=0)&&r.push(pu(Zb,t.start,n,p));const h=(-a-d)/(2*o);(t.type===Ui.LINE||h>=0)&&r.push(pu(nC,t.start,n,h))}return r}var Ui;(function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"})(Ui||(Ui={}));const JUe=1e-6,ky=pt(),Tae=pt(),nC=pt(),Zb=pt();function OU({start:t,end:e,type:i},r,n){const s=[],o=Rr(TE,e,t),a=Rr(eL,t,r),u=fp(o),d=2*Cm(o,a),p=d*d-4*u*(fp(a)-n*n);if(p===0){const h=-d/(2*u);(i===Zo.PLANE||h>=0)&&s.push(pu(pt(),t,o,h))}else if(p>0){const h=Math.sqrt(p),m=(-d+h)/(2*u);(i===Zo.PLANE||m>=0)&&s.push(pu(pt(),t,o,m));const y=(-d-h)/(2*u);(i===Zo.PLANE||y>=0)&&s.push(pu(pt(),t,o,y))}return s}function Iae(t,e){const i=t.start,r=t.end,n=Rr(TE,r,i),s=vt(iL,-n[1],n[0],0),o=e.start,a=e.end,u=is(PU,a,o),d=tt(u,s),p=vt(Rae,i[0],i[1],0),h=is(Pae,p,o),m=tt(h,s),y=qi();if(Math.abs(d)<y)return[];const g=ni(Fae,o,u,m/d);if(e.type===Ui.RAY){const v=is(uD,g,o);if(tt(v,u)<-y)return[]}if(t.type===Zo.HALF_PLANE){const v=Rk(eL,g,i);if(Cm(v,n)<-y)return[]}return[Yr(g)]}function YUe(t,e){return XUe(sC(FU,e[2],t),e)}function xae(t,e){return Aae(sC(FU,0,t),sC(ije,0,e)).map(([r,n])=>rp(r,n))}function Mae(t,e,i){return kae(t,sC(FU,t[2],e),i)}function Cae(t,e,i,r=W()){const n=Rr(TE,t,e),s=jb(n);return pu(r,e,n,s===0?1:i/s),r[2]=t[2],r}function kae(t,{start:e,end:i,type:r},n=W()){const s=is(tL,t,e),o=is(iL,i,e),a=tt(s,o)/tt(o,o);return ni(n,e,o,r===Ui.RAY?Math.max(a,0):a)}const KUe=(()=>{const t=W(),e=W(),i=W();return({start:r,end:n},{center:s,radius:o,normal:a,slicePlane:u})=>{const d=_E(s,a,tje);if(ui(oD(d,r),0)&&ui(oD(d,n),0)){MU(a,t,e);const h=(g,v)=>(hi(i,v,s),Tr(g,tt(i,t),tt(i,e)),g),m=ZUe({start:h(TE,r),end:h(eL,n),type:Ui.LINE},$re,o),y=[];for(const[g,v]of m){const _=Yt(W(),s);ni(_,_,t,g),ni(_,_,e,v),u&&!cm(u,_)||y.push(_)}return y}const p=W();return fae(d,r,n,p)?!ui(fg(p,s),o)||u&&!cm(u,p)?[]:[p]:[]}})();function Lae({start:t,end:e,type:i},r,n){const s=[],o=hi(tL,e,t),a=Rr(eL,t,r),u=fp(o),d=2*Cm(o,a),p=d*d-4*u*(fp(a)-n*n);if(p===0){const h=-d/(2*u);(i===Ui.LINE||h>=0)&&s.push(ni(W(),t,o,h))}else if(p>0){const h=Math.sqrt(p),m=(-d+h)/(2*u);(i===Ui.LINE||m>=0)&&s.push(ni(W(),t,o,m));const y=(-d-h)/(2*u);(i===Ui.LINE||y>=0)&&s.push(ni(W(),t,o,y))}return s}function Aae(t,e){const i=t.start,r=t.end,n=e.start,s=e.end,o=is(tL,r,i),a=is(iL,s,n),u=is(PU,n,i),d=As(Rae,o,a);if(!ui(tt(u,d),0))return[];const p=g$(d);if(ui(p,0))return[];const h=As(Pae,u,a),m=tt(h,d)/p,y=ni(Fae,i,o,m);if(t.type===Ui.RAY){const g=is(uD,y,i);if(tt(o,g)<-qi())return[]}if(e.type===Ui.RAY){const g=is(uD,y,n);if(tt(a,g)<-qi())return[]}return[Yr(y)]}function XUe({start:t,end:e,type:i},r){const n=is(tL,r,t),s=is(iL,e,t),o=As(PU,s,n),a=g$(o)/g$(s),u=qi();if(a<u)switch(i){case Ui.LINE:return[Yr(r)];case Ui.RAY:return tt(s,n)<-u?[]:[Yr(r)]}return[]}function RU(t,e,i,r){const[n,s]=t,[o,a]=i,u=o-n,d=a-s,p=u*u+d*d,h=Math.sqrt(p);if(h>e+r)return[];if(h<Math.abs(e-r))return[];if(ui(h,0)&&ui(e,r))return[];const m=(e*e-r*r+p)/(2*h),y=Math.sqrt(e*e-m*m),g=y*d/h,v=y*u/h,[_,w]=j4(TE,t,i,m/h);return ui(g,v)?[rp(_,w)]:[rp(_+g,w-v),rp(_-g,w+v)]}function sC(t,e,{start:i,end:r,type:n}){return vt(t.start,i[0],i[1],e),vt(t.end,r[0],r[1],e),t.type=eje[n],t}function Oae(t,e){return ui(t[2],e[2])}function ui(t,e){return N0(Math.abs(t-e),0,qi())}function QUe(t,e){return e.filter(i=>cm(t,i))}function cm(t,e){return kU(t,e)}var Zo;(function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"})(Zo||(Zo={}));const eje={[Zo.PLANE]:Ui.LINE,[Zo.HALF_PLANE]:Ui.RAY},TE=pt(),eL=pt(),tL=W(),iL=W(),PU=W(),Rae=W(),Pae=W(),Fae=W(),uD=W(),tje=vn(),FU={start:W(),end:W(),type:Ui.LINE},ije={start:W(),end:W(),type:Ui.LINE};let rl=class{intersect(e){return Ed(this,e)}closestPoints(e){return[this.closestTo(e)]}},L_=class extends rl{constructor(e){super(),this.point=e}equals(e){return this===e||Zl(e)&&Ft(this.point,e.point)}closestTo(){return Wb(this.point)}},NU=class extends rl{constructor(e,i,r){super(),this.start=e,this.end=i,this.lineLike={start:e,end:i,type:r}}equals(e){return this===e||lc(e)&&this.lineLike.type===e.lineLike.type&&Ft(this.start,e.start)&&Ft(this.end,e.end)}closestTo(e){const i=Ko();return kae(e,this.lineLike,i),i}};class DU extends NU{constructor(e,i){super(e,i,Ui.LINE)}}class rje extends NU{constructor(e,i){super(e,i,Ui.RAY)}}class Nae extends rl{constructor(e){super(),this.constraints=e}equals(e){return this===e||cD(e)&&eg(this.constraints,e.constraints,(i,r)=>i.equals(r))}closestTo(e){let i,r=1/0;for(const n of this.constraints){const s=n.closestTo(e),o=yp(e,s);o<r&&(r=o,i=s)}return Wb(i??e)}closestPoints(e){return this.constraints.flatMap(i=>i===this?[]:i.closestPoints(e))}}class Dae extends rl{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||cc(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const i=Ko();return Cae(e,this.center,this.radius,i),i}}class VU extends rl{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||Id(e)&&Ft(this.center,e.center)&&this.radius===e.radius}closestTo(e){const i=Ko();return Cae(e,this.center,this.radius,i),i[2]=this.center[2],i}asCircle(){return new UU(Wb(this.center),this.radius,Sm(0,0,1))}}class UU extends rl{constructor(e,i,r,n=void 0){super(),this.center=e,this.radius=i,this.normal=r,this.slicePlane=n}equals(e){return this===e||xh(e)&&Ft(this.center,e.center)&&Ft(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:i,radius:r}=this;LU(this.getPlane(nje),e,dO);const n=is(dO,dO,i),s=Wy(n);if(ui(s,0))return Wb(e);const o=r/Math.sqrt(s),a=Ko();ni(a,i,n,o);const{slicePlane:u}=this;if(u&&!cm(u,a)){const d=GU(u,this);return(d==null?void 0:d.closestTo(e))??Wb(e)}return a}getPlane(e=vn()){return _E(this.center,this.normal,e)}}const dO=W(),nje=vn();class sje extends rl{constructor(e){super(),this.z=e}equals(e){return this===e||Td(e)&&this.z===e.z}closestTo(e){return Sm(e[0],e[1],this.z)}getPlane(e=vn()){return vt(d7,0,0,this.z),_E(d7,KS,e)}}const d7=W();class jU extends rl{constructor(e,i,r){super(),this.start=e,this.end=i,this.planeLike={start:e,end:i,type:r}}equals(e){return this===e||uc(e)&&this.planeLike.type===e.planeLike.type&&Ft(this.start,e.start)&&Ft(this.end,e.end)}closestTo(e){const i=Ko();return Mae(e,this.planeLike,i),i}closestEndTo(e){const{start:i,end:r}=this.planeLike;return Math.sign(Cm(Rr(oje,r,i),Rr(aje,e,i)))>0?this.end:this.start}getPlane(e=vn()){const i=Yt(p7,this.end);return i[2]+=1,hae(this.start,this.end,i,e)}getSlicePlane(e=vn()){const{start:i,end:r,type:n}=this.planeLike;if(n===Zo.PLANE)return;const s=vt(p7,i[0],i[1],0),o=vt(h7,r[0],r[1],0),a=hi(h7,o,s);return _E(s,a,e),e}}const oje=pt(),aje=pt(),p7=W(),h7=W();class Pot extends jU{constructor(e,i){super(e,i,Zo.HALF_PLANE)}}class Vae extends jU{constructor(e,i){super(e,i,Zo.PLANE)}}class lje extends rl{constructor(e,i){super(),this.sphere=vae(e,i)}equals(e){return this===e||xd(e)&&yae(this.sphere,e.sphere)}closestTo(e){const i=Ko();return Qk(this.sphere,e,i),i}get center(){return this.sphere}get radius(){return this.sphere[3]}}class Uae extends rl{constructor(e,i,r){super(),this.start=e,this.end=i,this.getZ=r,this.planeLike={start:e,end:i,type:Zo.PLANE}}equals(e){return this===e||oC(e)&&Ft(this.start,e.start)&&Ft(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return mje(this,e)}addIfOnTheGround(e,i){for(const r of i){const n=this.getZ(r[0],r[1])??0;ui(r[2],n)&&(r[2]=n,e.push(r))}}}class uje extends rl{constructor(e,i,r){super(),this._x=e,this._y=i,this._z=r}equals(e){return this===e||kje(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,i,r]){return aae(this._x??e,this._y??i,this._z??r)}}class cje extends rl{constructor(e,i,r,n,s){super(),this._origin=e,this._spatialReference=i,this._distanceMeters=r,this._z=n,this._directionDegrees=s}equals(e){return this===e||Cje(e)&&wN(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,i,r]){return Tr(uw,e,i),wN(uw,this._origin)||this._applyDirectionAndDistance(uw),aae(uw[0],uw[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)op(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)pje(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:i}=M_(dje,this._origin,e,this._spatialReference);op(e,this._origin,i??0,this._distanceMeters,this._spatialReference)}}}const uw=[0,0],dje=new fE;function pje(t,e,i,r,n){let{azimuth:s,distance:o}=M_(hje,e,r,n);s??(s=0);let a=o*Math.cos((s-i)*Ts);a=Math.max(0,a),op(t,e,i,a,n)}const hje=new fE;function mje(t,e){const i=Ko();return Mae(e,t.planeLike,i),i[2]=t.getZ(i[0],i[1])??Gae,i}function Ed(t,e){if(cD(t)){const i=[];for(const r of t.constraints){const n=r.intersect(e);n&&i.push(n)}return zU(i)}if(cD(e))return Ed(e,t);if(oC(t))return m7(t,e);if(oC(e))return m7(e,t);if(Zl(t)){const{point:i}=t;if(Zl(e))return Ft(i,e.point)?t:void 0;const r=e.closestTo(i);return Sne(r,i)?t:void 0}if(lc(t)){if(Zl(e))return Ed(e,t);if(lc(e))return au(Aae(t.lineLike,e.lineLike));if(Td(e))return fje(t,e);if(uc(e))return au(Iae(e.planeLike,t.lineLike));if(cc(e))return au(Lae(t.lineLike,e.center,e.radius));if(xh(e))return au(KUe(t.lineLike,e));if(Id(e))return yje(t,e);if(xd(e))return gje(t,e)}else if(Td(t)){if(Zl(e)||lc(e))return Ed(e,t);if(Td(e))return vje(t,e);if(uc(e))return bje(t,e);if(cc(e))return _je(t,e);if(xh(e))return Sje(t,e);if(Id(e))return wje(t,e);if(xd(e))return $je(t,e)}else if(uc(t)){if(Zl(e)||lc(e)||Td(e))return Ed(e,t);if(uc(e))return pO(xae(t.planeLike,e.planeLike));if(cc(e))return pO(OU(t.planeLike,e.center,e.radius));if(xh(e))return Tje(t,e);if(Id(e))return Eje(t,e);if(xd(e))return Ije(t,e)}else if(cc(t)){if(Zl(e)||lc(e)||Td(e)||uc(e))return Ed(e,t);if(cc(e))return pO(RU(t.center,t.radius,e.center,e.radius));if(xh(e))return void 0;if(Id(e))return xje(t,e);if(xd(e))return void 0}else if(xh(t)){if(Zl(e)||lc(e)||Td(e)||uc(e)||cc(e))return Ed(e,t);if(xh(e))return void 0;if(Id(e))return e.asCircle(),void 0;if(xd(e))return void 0}else if(Id(t)){if(Zl(e)||lc(e)||Td(e)||uc(e)||cc(e)||xh(e))return Ed(e,t);if(Id(e))return Mje(e,t);if(xd(e))return void 0}else if(xd(t)){if(Zl(e)||lc(e)||Td(e)||uc(e)||cc(e)||Id(e))return Ed(e,t);if(xd(e))return void 0}}const fje=(()=>{const t=vn();return(e,i)=>{const{start:r,end:n}=e;if(Oae(r,n)&&ui(r[2],i.z))return e;const s=Ko();return fae(i.getPlane(t),r,n,s)?new L_(s):void 0}})();function yje({lineLike:t},{center:e,radius:i}){const r=e[2];return au(Lae(t,e,i).filter(n=>ui(n[2],r)))}function gje({lineLike:t},{sphere:e}){return au(bae(e,t.start,t.end))}const GU=(()=>{const t=Rc(),e=W(),i=W();return(r,n,s)=>{const{normal:o,center:a,radius:u}=n;MU(o,e,i);const d=r,p=u*tt(d,e),h=u*tt(d,i);X5(t,a[0],a[1],a[2],1);const m=t4(r,t),y=Math.hypot(p,h),g=ui(y,0);if(ui(oD(r,a),0)){if(g)return n;if(ui(u,0))return!s||cm(s,a)?new L_(Wb(a)):void 0;As(e,d,o),ls(e,e);const x=new Array,C=Yr(a);ni(C,C,e,u),s&&!cm(s,C)||x.push(C);const O=Yr(a);return ni(O,O,e,-u),s&&!cm(s,O)||x.push(O),au(x)}if(g)return;const v=-m/y;if(Math.abs(v)>1||ui(v,1))return;const _=Math.atan(p/h),w=jV(v)-_,S=Math.PI-w,E=new Array,T=W();ni(T,a,e,u*Math.cos(w)),ni(T,T,i,u*Math.sin(w)),E.push(T);const M=W();return ni(M,a,e,u*Math.cos(S)),ni(M,M,i,u*Math.sin(S)),E.push(M),au(s?QUe(s,E):E)}})();function vje(t,e){return ui(t.z,e.z)?t:void 0}function bje({z:t},{planeLike:e}){const[i,r]=e.start,[n,s]=e.end,o=Sm(i,r,t),a=Sm(n,s,t);return e.type===Zo.PLANE?new DU(o,a):new rje(o,a)}function _je(t,e){const[i,r]=e.center;return new VU(Sm(i,r,t.z),e.radius)}function wje(t,e){return ui(e.center[2],t.z)?e:void 0}const Sje=(()=>{const t=vn();return(e,i)=>GU(e.getPlane(t),i,i.slicePlane)})();function $je(t,{center:e,radius:i}){const r=Math.abs(e[2]-t.z);if(r>i&&!ui(r,i))return;const n=Sm(e[0],e[1],t.z),s=Math.sqrt(i**2-r**2);return ui(s,0)?void 0:new VU(n,s)}const Eje=(()=>{const t=vn();return(e,{center:i,radius:r})=>{const n=OU(e.planeLike,i,r),s=i[2];e.getSlicePlane(t);const o=new Array;for(const[a,u]of n){const d=[a,u,s];cm(t,d)&&o.push(d)}return au(o)}})(),Tje=(()=>{const t=vn(),e=vn();return(i,r)=>GU(i.getPlane(t),r,i.getSlicePlane(e))})(),Ije=(()=>{const t=vn();return(e,{center:i,radius:r})=>{const n=e.getPlane(t),s=wE(n,i),o=Math.abs(s);if(o>r&&!ui(o,r))return;const a=Math.sqrt(r**2-s**2);if(ui(a,0)){const p=Ko();return LU(n,i,p),new L_(p)}const u=Ko(),d=Yr(n);return ni(u,i,d,s),new UU(u,a,d,e.getSlicePlane())}})();function xje(t,e){const i=Ub(t.center,e.center);return ui(i,0)&&ui(t.radius,e.radius)?e:jae(RU(t.center,t.radius,e.center,e.radius),e.center[2])}function Mje(t,e){if(!Oae(t.center,e.center))return;const i=Ub(t.center,e.center);return ui(i,0)&&ui(t.radius,e.radius)?t:jae(RU(t.center,t.radius,e.center,e.radius),t.center[2])}function m7(t,e){const{planeLike:i,getZ:r}=t,n=new Array;if(Zl(e))t.addIfOnTheGround(n,YUe(i,e.point));else if(lc(e))t.addIfOnTheGround(n,Iae(i,e.lineLike));else if(cc(e))for(const[s,o]of OU(i,e.center,e.radius)){const a=r(s,o);a!=null&&n.push(Lr(s,o,a))}else if(uc(e)||oC(e))for(const[s,o]of xae(i,e.planeLike)){const a=r(s,o)??Gae;n.push(Lr(s,o,a))}return au(n)}function pO(t){return zU(t.map(([e,i])=>{const r=Sm(e,i,0),n=Sm(e,i,1);return new DU(r,n)}))}function au(t){return zU(t.map(e=>e?new L_(e):void 0))}function jae(t,e){return au(t.map(([i,r])=>[i,r,e]))}function zU(t){if(t.length!==0)return t.length===1?t[0]??void 0:new Nae(t.filter(ot))}function cD(t){return t instanceof Nae}function Zl(t){return t instanceof L_}function lc(t){return t instanceof NU}function Td(t){return t instanceof sje}function uc(t){return t instanceof jU}function cc(t){return t instanceof Dae}function Id(t){return t instanceof VU}function xh(t){return t instanceof UU}function xd(t){return t instanceof lje}function oC(t){return t instanceof Uae}function Cje(t){return t instanceof cje}function kje(t){return t instanceof uje}const Gae=0;let A_=class{constructor(e,i,r,n){this.targetPoint=e,this.constraint=i,this.isDraped=r,this.domain=n}},zae=class extends A_{constructor({targetPoint:e,objectId:i,constraint:r,isDraped:n}){super(e,r,n,ss.FEATURE),this.objectId=i}},rL=class{constructor(e,i){this.isDraped=e,this.domain=i}},Mc=class Bae extends rL{constructor(e,i,r,n,s=ss.ALL,o=!0,a=!0){super(n,s),this.type=e,this.lineStart=i,this.lineEnd=r,this.fadeLeft=o,this.fadeRight=a}equals(e){return e instanceof Bae&&this.type===e.type&&Ft(this.lineStart,e.lineStart)&&Ft(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return fg(this.lineStart,this.lineEnd)}},Lje=class extends zae{constructor(e){super({...e,isDraped:!0,constraint:new Uae(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new Mc(il.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Aje=class extends zae{constructor(e){super({...e,constraint:new DU(e.edgeStart,e.edgeEnd)})}get hints(){return[new Mc(il.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Oje=class Hae extends rL{constructor(e,i,r=ss.ALL){super(i,r),this.intersectionPoint=e}equals(e){return e instanceof Hae&&Ft(this.intersectionPoint,e.intersectionPoint)}},mM=class extends A_{constructor(e,i,r,n){super(e,new L_(e),n,ss.ALL),this.first=i,this.second=r}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new Oje(this.targetPoint,this.isDraped,this.domain)]}},Rje=class extends A_{constructor({lineStart:e,lineEnd:i,targetPoint:r,isDraped:n}){super(r,new Vae(e,i),n,ss.SELF),this._referenceLineHint=new Mc(il.REFERENCE_EXTENSION,e,i,n,this.domain)}get hints(){return[this._referenceLineHint,new Mc(il.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},Pje=class qae extends rL{constructor(e,i,r,n=ss.ALL){super(r,n),this.lineStart=e,this.lineEnd=i}equals(e){return e instanceof qae&&Ft(this.lineStart,e.lineStart)&&Ft(this.lineEnd,e.lineEnd)}},Fje=class extends A_{constructor({referenceLine:e,lineStart:i,targetPoint:r,isDraped:n}){const s=Yr(i),{left:o,right:a}=e;hi(s,di(s,s,a),o),super(r,new Vae(i,s),n,ss.SELF),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new Mc(il.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new Pje(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new Mc(il.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const i={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(r=>{Ft(e.right,r.edge.left)&&(r.fadeLeft=!1,i.fadeRight=!1),Ft(e.right,r.edge.right)&&(r.fadeRight=!1,i.fadeRight=!1),Ft(e.left,r.edge.right)&&(r.fadeRight=!1,i.fadeLeft=!1),Ft(e.left,r.edge.left)&&(r.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},Wae=class Zae extends rL{constructor(e,i,r,n,s=ss.ALL){super(n,s),this.previousVertex=e,this.centerVertex=i,this.nextVertex=r}equals(e){return e instanceof Zae&&Ft(this.previousVertex,e.previousVertex)&&Ft(this.centerVertex,e.centerVertex)&&Ft(this.nextVertex,e.nextVertex)}},Nje=class extends A_{constructor({targetPoint:e,constraint:i,previousVertex:r,otherVertex:n,otherVertexType:s,isDraped:o,selfSnappingType:a,objectId:u,domain:d}){super(e,i,o,d??ss.SELF),this.previousVertex=r,this.otherVertex=n,this.otherVertexType=s,this.selfSnappingType=a??lC.None,this.objectId=u??null}get hints(){const e=this.previousVertex,i=this.otherVertexType===aC.CENTER?this.otherVertex:this.targetPoint,r=this.otherVertexType===aC.CENTER?this.targetPoint:this.otherVertex;return[new Mc(il.TARGET,i,r,this.isDraped,this.domain),new Mc(il.REFERENCE,e,i,this.isDraped,this.domain),new Wae(this.previousVertex,i,r,this.isDraped,this.domain)]}};var aC,lC;(function(t){t[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER"})(aC||(aC={})),function(t){t[t.None=0]="None",t[t.LastVertex=1]="LastVertex",t[t.FirstVertex=2]="FirstVertex",t[t.ExistingEdge=3]="ExistingEdge"}(lC||(lC={}));let Dje=class extends A_{constructor({targetPoint:e,point1:i,point2:r,isDraped:n}){super(e,new Dae(Uk(W(),i,r,.5),.5*E_(i,r)),n,ss.SELF),this._p1=i,this._p2=r}get hints(){return[new Mc(il.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new Mc(il.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new Wae(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}};function Vje(t,e,i,r,n=W()){const s=Yt(Uje,t);return s[2]=oae(r,s,e,i)||0,r.renderCoordsHelper.toRenderCoords(s,e,n),n}const Uje=W();function jje(t,e,i,r){return r.type==="2d"?(pI.x=t[0],pI.y=t[1],pI.spatialReference=e,r.toScreen(pI)):(Vje(t,e,i,r,f7),r.state.camera.projectToScreen(f7,hO),Mi(hO[0],hO[1]))}const pI=I_(0,0,0,null),f7=W(),hO=Gye();let Pa=class extends ji.EventedMixin(q){constructor(e){super(e),this.options=new gg,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Vd.MAIN}initialize(){this.addHandles([N(()=>{const{distance:e,touchSensitivityMultiplier:i,effectiveSelfEnabled:r,effectiveFeatureEnabled:n,effectiveGridEnabled:s}=this.options;return{selfEnabled:r,featureEnabled:n,gridEnabled:this.view.type==="2d"&&s,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:i}},(e,i)=>{var r;i&&(this.doneSnapping(),this.emit("changed")),(r=this._loadTask)==null||r.abort(),this._loadTask=Xo(n=>this._updateEngines(e,i,n))},gt),N(()=>this.options,e=>{for(const i of this._engines)i.options=e},yn)])}destroy(){this._destroyEngines()}get updating(){var e;return this._engines.some(i=>i.updating)||!((e=this._loadTask)!=null&&e.finished)}_destroyEngines(){this._engineCache.forEach(e=>e.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,i,r){if(!e.viewReady)return void this._destroyEngines();(i==null?void 0:i.viewSpatialReference)!==e.viewSpatialReference&&this._destroyEngines();const{_engineCache:n}=this,s=[];e.featureEnabled&&!n.has("feature")&&s.push(this._setupFeatureSnappingEngine(r)),e.selfEnabled&&!n.has("self")&&s.push(this._setupSelfSnappingEngine(r)),e.gridEnabled&&!n.has("grid")&&this.view.type==="2d"&&s.push(this._setupGridSnappingEngine(r)),await Promise.allSettled(s),r.aborted||(this._engines=Array.from(n.values()))}async _setupSelfSnappingEngine(e){const{SelfSnappingEngine:i}=await k(()=>import("./SelfSnappingEngine-oFtQ9oyH.js"),__vite__mapDeps([317,318,319,12,1,320]));qe(e);const r=new i({view:this.view,options:this.options});this._engineCache.set("self",r)}async _setupGridSnappingEngine(e){const{view:i}=this,{GridSnappingEngine:r}=await k(async()=>{const{GridSnappingEngine:n}=await import("./GridSnappingEngine-ESnzrF91.js");return{GridSnappingEngine:n}},__vite__mapDeps([321,181]));if(qe(e),i.type==="2d"){const n=new r({view:i,options:this.options});this._engineCache.set("grid",n)}}async _setupFeatureSnappingEngine(e){const{FeatureSnappingEngine:i}=await k(()=>import("./FeatureSnappingEngine-B0wJcXM4.js"),[]);qe(e);const{view:r,options:n,_engineCache:s}=this,o=new i({view:r,options:n,spatialReference:r.spatialReference});s.set("feature",o)}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,r=e*i;return r*r}snap(e){return Bje(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:i,context:r}=e;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return i;const s=this._selectUpdateInput(e);if(s==null)return i;const{spatialReference:o}=r,a=On(s,o);if(a==null)return i;const{view:u}=this,{elevationInfo:d,visualizer:p}=r,h=[],m=z1(a,u,d),y=n.constraint.closestTo(m);if(!this._arePointsWithinScreenThreshold(m,y,r)||!fO(n,r.drawConstraints))return this._resetSnappingState(),i;n.targetPoint=aO(y),h.push(...n.hints);for(const g of this._currentOtherActiveCandidates)fO(g,r.drawConstraints)&&(g.targetPoint=aO(y),h.push(...g.hints));return p!=null&&this.addHandles(p.draw(h,{spatialReference:o,elevationInfo:Hje(r),view:u,selfSnappingZ:r.selfSnappingZ}),mO),n7(y,u,i,r)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:i}){switch(this._currentSnappedType){case Vd.MAIN:return e;case Vd.SCENE:return i}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Vd.MAIN}_removeVisualization(){this.removeHandles(mO)}async _snapSinglePoint({point:e,context:i,signal:r}){const{view:n}=this,{elevationInfo:s}=i,o=z1(e,n,s),a=await this._fetchCandidates(o,ss.ALL,i,r);return this._createSnapResult(o,Vd.MAIN,a,n,e,i,r)}async _snapMultiPoint({point:e,scenePoint:i,context:r,signal:n}){const{view:s}=this,{coordinateHelper:o,elevationInfo:a,spatialReference:u}=r;await Ec(i.spatialReference,u);const d=On(i,u),p=z1(d,s,a),h=await this._fetchCandidates(p,ss.FEATURE,r,n);if(h.length>0){const g=await this._fetchCandidates(p,ss.SELF,r,n);return this._createSnapResult(p,Vd.SCENE,[...h,...g],s,d,r,n)}const m=z1(e,s,a),y=await this._fetchCandidates(m,ss.SELF,r,n);return this._createSnapResult(m,Vd.MAIN,y,s,{z:o.hasZ()&&e.hasZ?e.z??0:void 0,m:o.hasM()&&e.hasM?e.m??0:void 0},r,n)}async _fetchCandidates(e,i,r,n){return(await Promise.all(this._engines.map(s=>s.fetchCandidates(e,i,r,n)))).flat()}_createSnapResult(e,i,r,n,s,o,a){return{get valid(){return!lo(a)},apply:()=>{const{spatialReference:u}=o,{snappedPoint:d,hints:p}=this._processCandidates(e,i,r,o);return this._removeVisualization(),o.visualizer!=null&&this.addHandles(o.visualizer.draw(p,{spatialReference:u,elevationInfo:Ky,view:n,selfSnappingZ:o.selfSnappingZ}),mO),n7(d,n,s,o)}}}_processCandidates(e,i,r,n){if(r.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==i&&this._resetSnappingState(),Q4e(e,r);const s=this._currentMainCandidate;if(s!=null){const o=zje(s,r);if(o>=0){if(!(r[o]instanceof mM))return this._intersectWithOtherCandidates(o,r,e,i,n);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,n))return this._updateSnappingCandidate(s,i,r,n)}}return this._intersectWithOtherCandidates(0,r,e,i,n)}_intersectWithOtherCandidates(e,i,r,n,s){const{coordinateHelper:o}=s,a=i[e],u=[];for(let d=0;d<i.length;++d){if(d===e)continue;const p=i[d],h=a.constraint.intersect(p.constraint);if(h)for(const m of h.closestPoints(a.targetPoint))u.push([new mM(aO(m),a,p,p.isDraped),this._squaredScreenDistance(r,m,o)])}return u.length>0&&(u.sort((d,p)=>d[1]-p[1]),u[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(u[0][0],n,i,s):fO(a,s.drawConstraints)?this._updateSnappingCandidate(a,n,i,s):{snappedPoint:r,hints:[]}}_updateSnappingCandidate(e,i,r,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=i;const s=this._currentMainCandidate.targetPoint,o=[];o.push(...e.hints);for(const a of r){if(e instanceof mM){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const u=a.constraint.closestTo(s);this._squaredScreenDistance(u,s,n.coordinateHelper)<Gje()&&(a.targetPoint=s,this._currentOtherActiveCandidates.push(a),o.push(...a.hints))}return{snappedPoint:s,hints:o}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,i,r){return this._squaredScreenDistance(e,i,r.coordinateHelper)<this._squaredPointProximityThreshold(r.pointer)}_squaredScreenDistance(e,i,r){return cae(this._toScreen(e,r),this._toScreen(i,r))}_toScreen(e,i){return jje(e,i.spatialReference,Ky,this.view)}get test(){}};var Vd;l([c({constructOnly:!0})],Pa.prototype,"view",void 0),l([c()],Pa.prototype,"options",void 0),l([c({readOnly:!0})],Pa.prototype,"updating",null),l([c()],Pa.prototype,"_loadTask",void 0),l([c()],Pa.prototype,"_engines",void 0),l([c()],Pa.prototype,"_squaredMouseProximityThreshold",null),l([c()],Pa.prototype,"_squaredTouchProximityThreshold",null),Pa=l([$("esri.views.interactive.snapping.SnappingManager")],Pa),function(t){t[t.MAIN=0]="MAIN",t[t.SCENE=1]="SCENE"}(Vd||(Vd={}));const mO="visualization-handle";function Gje(){return iC.satisfiesConstraintScreenThreshold*iC.satisfiesConstraintScreenThreshold}function fO(t,e){return!e||e.direction==null&&e.distance==null||!(t instanceof Lje||t instanceof Aje||t instanceof Rje||t instanceof Fje||t instanceof Dje)&&(!(t instanceof Nje)||e.direction==null&&t.selfSnappingType===lC.LastVertex)}function zje(t,e){return t instanceof mM?yO(e,t.first)>=0&&yO(e,t.second)>=0?0:-1:yO(e,t)}function yO(t,e){let i=-1;for(let r=0;r<t.length;++r)if(e.constraint.equals(t[r].constraint)){i=r;break}return i}function Bje(t){return t.scenePoint!=null}function Hje({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?Ky:e}function qje(t,e){switch(t){case"point":case"multipoint":return Wje();case"polyline":return Zje(e);case"polygon":return Jje(e);default:return}}function Wje(t){return"point"}function Zje(t){return(t!=null&&t.type==="polyline"&&t.paths.length?t.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}function Jje(t){const e=t!=null&&t.type==="polygon"&&t.rings.length?t.rings[0].length:0;return e<3?"polylineZeroVertices":e<4?"polygonOneVertex":"polygonTwoVertices"}function Yje(t){return t==null?null:JSON.stringify(t)}let dc=class extends q{constructor(e){super(e),this._stagedForDelete=!1,this.feature=null,this.initialFeature=null}get attributesModified(){var e,i;return!Kje((e=this.initialFeature)==null?void 0:e.attributes,(i=this.feature)==null?void 0:i.attributes)}get geometryModified(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(e=this.feature){this.initialFeature=e==null?void 0:e.clone()}updateAttributes(e){const{feature:i}=this;i&&(i.attributes=e,this.notifyChange("attributesModified"))}updateGeometry(e){const{feature:i}=this;i&&(i.geometry=e,this.notifyChange("geometryModified"))}_stringifyGeometry(e){const i=e==null?void 0:e.geometry;return Yje((i==null?void 0:i.type)==="mesh"?{transform:i.transform,vertexSpace:i.vertexSpace}:i)}};function Kje(t,e){const i=t??{},r=e??{},n=new Set(Object.keys(i));DS(n,Object.keys(r));for(const s of n)if(!Xje(i[s],r[s]))return!1;return!0}function Xje(t,e){return!(!y7(t)||!y7(e))||t===e}function y7(t){return t==null||t===""}l([c()],dc.prototype,"_stagedForDelete",void 0),l([c()],dc.prototype,"attributesModified",null),l([c()],dc.prototype,"feature",void 0),l([c()],dc.prototype,"geometryModified",null),l([c()],dc.prototype,"initialFeature",void 0),l([c()],dc.prototype,"modified",null),dc=l([$("esri.widgets.Editor.Edits")],dc);let Dl=class extends q{constructor(e){super(e),this.creationInfo=null,this.editorItem=null,this.parent=null,this.sketchOptions=null,this.snappingManager=null,this.viewModel=null,this.upload=null,this._pendingEdits=new ip}get pendingFeatures(){return new Y([...this._pendingEdits.keys()])}addPendingFeature(e,i=e){const{_pendingEdits:r}=this;if(r.has(e))return r.get(e);const n=new dc({feature:e});return n.trackChanges(i),r.set(e,n),n}getEditsForPendingFeature(e){return this._pendingEdits.get(e)}removePendingFeature(e){const{_pendingEdits:i}=this,r=i.get(e);r&&(r.destroy(),i.delete(e))}};l([c()],Dl.prototype,"creationInfo",void 0),l([c()],Dl.prototype,"editorItem",void 0),l([c()],Dl.prototype,"parent",void 0),l([c()],Dl.prototype,"pendingFeatures",null),l([c({constructOnly:!0})],Dl.prototype,"sketchOptions",void 0),l([c()],Dl.prototype,"snappingManager",void 0),l([c()],Dl.prototype,"viewModel",void 0),l([c()],Dl.prototype,"upload",void 0),Dl=l([$("esri.widgets.Editor.CreateFeaturesWorkflowData")],Dl);function gO(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function Qje(t){let e=0,i=0;for(let r=0;r<t.length;r++){const n=t[r].size;typeof n=="number"&&(e+=n,i++)}return e/i}function g7(t,e){var i;return typeof t=="number"?t:(i=t==null?void 0:t.stops)!=null&&i.length?Qje(t.stops):e}function eGe(t,e){if(!e)return t;const i=e.filter(o=>o.type==="size").map(o=>{const{maxSize:a,minSize:u}=o;return(g7(a,t)+g7(u,t))/2});let r=0;const n=i.length;if(n===0)return t;for(let o=0;o<n;o++)r+=i[o];const s=Math.floor(r/n);return Math.max(s,t)}function Jae(t){var s;const e=t==null?void 0:t.renderer,i=t==null?void 0:t.pointerType,r=i==="touch"?9:6;if(!e)return r;const n="visualVariables"in e?eGe(r,e.visualVariables):r;if(e.type==="simple")return gO(n,e.symbol);if(e.type==="unique-value"){let o=n;return(s=e.uniqueValueInfos)==null||s.forEach(a=>{o=gO(o,a.symbol)}),o}if(e.type==="class-breaks"){let o=n;return e.classBreakInfos.forEach(a=>{o=gO(o,a.symbol)}),o}return e.type==="dot-density"||e.type,n}let Ud=class extends ji.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};l([c({constructOnly:!0})],Ud.prototype,"graphic",void 0),l([c()],Ud.prototype,"tracking",void 0),l([c()],Ud.prototype,"displaying",void 0),l([c()],Ud.prototype,"error",void 0),l([c()],Ud.prototype,"isDraped",void 0),Ud=l([$("esri.views.3d.layers.graphics.GraphicState")],Ud);function Yae(t,e,i,r=new at){let n=0;if(i.type==="2d")n=e*(i.resolution??0);else if(i.type==="3d"){const p=i.overlayPixelSizeInMapUnits(t),h=i.basemapSpatialReference;n=h==null||h.equals(i.spatialReference)?e*p:Ci(h)/Ci(i.spatialReference)}const s=t.x-n,o=t.y-n,a=t.x+n,u=t.y+n,{spatialReference:d}=i;return r.xmin=Math.min(s,a),r.ymin=Math.min(o,u),r.xmax=Math.max(s,a),r.ymax=Math.max(o,u),r.spatialReference=d,r}function Yot(t,e,i){const r=i.toMap(t);return r==null?!1:Yae(r,Jae(),i,tGe).intersects(e)}const tGe=new at;async function iGe(t,e){if(t.type==="2d")return t.hitTest(e);const i=await t.hitTest(e);if(i.results.length===0)return i;const r=i.results[0],n=(r.distance??0)*(1+rGe),s=i.results.findIndex(o=>(o.distance??0)>n);return s!==-1&&(i.results=i.results.slice(0,s)),r&&i.ground.distance>n&&(i.ground.mapPoint=null),i}const rGe=.05;function Kae(t){return(t==null?void 0:t.type)==="graphic"}function nGe(t){return t.find(Kae)??null}function Xae(t){return t.filter(Kae)}function sGe(t){return t.type==="update"}function BU(t){const e=t.sourceLayer;if(!e||e.type!=="feature"||!cGe(e.renderer))return{rotation:null,size:null};let i=null,r=null;const n=e.renderer.getVisualVariablesForType("rotation").filter(o=>(!o.axis||o.axis==="heading")&&o.field&&!o.valueExpression&&H5(o,t)!=null);n.length===1&&(i=oGe(n[0],e));const s=e.renderer.getVisualVariablesForType("size").filter(o=>o.field&&!o.useSymbolValue&&!o.valueExpression&&Iee(o)===Mr.RealWorldSize&&nE(o,t)!=null);return s.length===1&&(r=uGe(s[0],e)),{rotation:i,size:r}}function oGe(t,e){const i=(t.axis||"heading")==="heading"&&t.rotationType==="arithmetic"?-1:1,r=t.field,n=e.fields&&e.fields.filter(a=>a.name===r),s=n&&n.length===1?n[0].type:"double",o={initial:0,current:0};return{field:r,fieldType:s,getDefault:()=>Promise.resolve(0),getValue:a=>(o.current=o.initial-i*a,dD((o.current+360)%360,s)),setInitialValue:a=>{o.initial=a,o.current=0},isUpdatingInteractively:!1,rotationType:t.rotationType??"geographic"}}function aGe(t,e){switch(e){case"width":return t[0];case"depth":return t[1];case"height":return t[2];default:return t[2]||t[1]||t[0]}}async function lGe(t,e,i){if(e==null)return 0;const{symbol:r}=zy(e);if(r==null||r.type==="web-style"||r.type==="cim")return 0;const n=r.symbolLayers.at(0);if(!n)return 0;switch(n.type){case"icon":{const{computeIconLayerResourceSize:s}=await k(()=>import("./symbolLayerUtils-yWF4Yu-u.js"),[]);return n.size||Math.min(Vp.icon,(await s(n,Vp.icon))[0])||Vp.icon}case"text":return n.size||Vp.text;case"line":return n.size||Vp.line;case"object":{const{computeObjectLayerResourceSize:s}=await k(()=>import("./symbolLayerUtils-yWF4Yu-u.js"),[]);return aGe(await s(n,t.scale/Vp.viewScaleSizeFactor),i)}case"path":return(n.width!=null?n.width:n.height)||t.scale/Vp.viewScaleSizeFactor;case"extrude":return n.size||t.scale/Vp.viewScaleSizeFactor;default:return 0}}function uGe(t,e){const i=t.field,r=t.axis,n=e.fields&&e.fields.filter(d=>d.name===i),s=n&&n.length===1?n[0].type:"double",o={initial:0,current:0},a=rE[t.valueUnit]??1;let u;return u=t.valueRepresentation==="area"?d=>(d*a/2)**2*Math.PI:t.valueRepresentation==="radius"||t.valueRepresentation==="distance"?d=>d*a/2:d=>d*a,{field:i,fieldType:s,getDefault:async(d,p)=>dD(u(await lGe(p,d,r)),s),getValue:(d,p)=>(o.initial||(o.initial=p.pixelSizeAt(p.center)),o.current=o.initial*d,dD(o.current,s)),setInitialValue:d=>{o.initial=d,o.current=0},isUpdatingInteractively:!1,displayUnit:TGe(t.valueUnit),axis:t.axis}}function dD(t,e){switch(e){case"small-integer":case"integer":case"long":return Math.round(t);case"double":case"single":return t;default:return 0}}function cGe(t){switch(t==null?void 0:t.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}async function ap(t,e,i){const r=await tD(t,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:e,scale:i});$te(t.symbol,r)!=null&&(t.symbol=r)}function dGe(t){if(!t)throw new Error("no geometry type");return t==="multipatch"?"mesh":t}async function pGe(t,e,i){const r=e.layer,n=Qae(e);let s=null;const{view:o}=t,a=(o==null?void 0:o.type)==="2d";if(await v7(t,r,n,i,a?o.scale:null),a){const p=Bo(h=>v7(t,r,n,i,h));s=N(()=>o.scale,h=>p(h))}const{data:u,editing:d}=r.capabilities;return t.layer.elevationInfo=r.elevationInfo,e.geometryToPlace==null?await t.create(dGe(r.geometryType),{graphicProperties:{attributes:n,sourceLayer:r},hasZ:u.supportsZ,defaultZ:(a?d.zDefault:null)??t.defaultCreateOptions.defaultZ}):await t.place(e.geometryToPlace,{graphicProperties:{attributes:n,sourceLayer:r}}),s??ye()}function Qae(t){var e;return{...(e=t.template)==null?void 0:e.prototype.attributes,...t.attributeOverrides}}async function v7(t,e,i,r,n){const s=new Li({sourceLayer:e,attributes:i}),{rotation:o,size:a}=BU(s);let u=await tD(s,{useSourceLayer:!0,webStyleCache:r,scale:n}),d=!1;for(const p of[a,o])p!=null&&i[p.field]==null&&(i[p.field]=await p.getDefault(u,t.view),d=!0);switch(d&&(u=await tD(s,{useSourceLayer:!0,webStyleCache:r,scale:n})),u==null?void 0:u.type){case"simple-fill":case"polygon-3d":t.polygonSymbol=u;break;case"simple-line":case"line-3d":t.polylineSymbol=u;break;case"simple-marker":case"picture-marker":case"point-3d":case"cim":t.pointSymbol=u;break;case"mesh-3d":t.meshSymbol=u}ele(t.tooltipOptions,a,o)}function ele(t,e,i){t.visualVariables=e!=null||i!=null?{size:e!=null?{unit:e.displayUnit,axis:e.axis,valueType:e.fieldType}:null,rotation:i!=null?{valueType:i.fieldType,rotationType:i.rotationType??"geographic"}:null}:null}function hGe(t,e){return t==null?void 0:t.find(i=>i.layer===e)}async function mGe(t,e,i,r){switch(e.type){case"3d":return fGe(t,e,i,r);case"2d":return yGe(t,e,i,r)}}async function fGe(t,e,i,r){if(t.length===0)return[];const{updatable:n,graphicsByLayer:s}=await i.async(async()=>{const{results:o}=await Xa(iGe(e,i),r),a=new Map,u=p=>{const h=p.layer,m=a.get(h);if(!m){const y=new Array;return a.set(h,y),y}return m};Xae(o).forEach(({graphic:p})=>u(p).push(p));const d=t.filter(({capabilities:p,layer:h})=>p.update.enabled&&a.has(h));return d.length!==0&&i.stopPropagation(),{updatable:d,graphicsByLayer:a}});return Xa(Promise.allSettled(n.map(async({layer:o})=>{const a=s.get(o),u=tle(o);if(a.every(h=>OQ(u,h)))return a;const d=[];for(const h of a){d.push(h.getObjectId());const m=Object.keys(h.attributes);Ede(u,m)}const p=o.createQuery();return p.returnGeometry=!1,p.objectIds=d,p.outFields=og(o.fieldsIndex,u),o.queryFeatures(p,{signal:r}).then(({features:h})=>h)})),r)}async function yGe(t,e,i,r){if(t.length===0)return[];const{mapPoint:n}=i;if(n==null)return[];let s=null;const o=await i.async(async()=>{const{results:a}=await Xa(e.hitTest(i),r);if(a.length===0)return[];const u=new Set;s=Xae(a),s.forEach(({graphic:p})=>p&&u.add(p.layer));const d=t.filter(p=>u.has(p.layer)&&p.supportsUpdateWorkflow);return d.length>0&&i.stopPropagation(),d});return Xa(Promise.allSettled(o.map(async({layer:a})=>{const u=a.createQuery();u.returnGeometry=!1,u.outFields=tle(a);const d="renderer"in a?Jae({renderer:a.renderer,pointerType:i.pointerType}):0;u.geometry=Yae(n,d,e),u.outSpatialReference=e.spatialReference;const{features:p}=await a.queryFeatures(u,{signal:r});return s==null||s.forEach(({graphic:h})=>{h.layer!==a||p.some(m=>m.getObjectId()===h.getObjectId())||p.push(h)}),p})),r)}function tle(t){return og(t.fieldsIndex,[t.objectIdField,$5({displayField:"displayField"in t?t.displayField:null,fields:t.fields})])}async function gGe(t,e,i){const{sourceLayer:r}=t,n=r.createQuery();n.objectIds=[t.getAttribute(r.objectIdField)],n.outFields=["*"],n.returnM=r.capabilities.data.supportsM,n.returnZ=r.capabilities.data.supportsZ,r.type==="scene"&&r.infoFor3D!=null||(n.outSpatialReference=e);const s=await r.queryFeatures(n,{signal:i});return qe(i),s.features[0]}async function pD(t){var p;const{graphic:e,sketchViewModel:i,sourceLayer:r,visualVariables:n,webStyleCache:s}=t;let o=!1;const{rotation:a,size:u}=n;if([a,u].forEach(async h=>{if(h==null)return;const m=e.getAttribute(h.field);if(m!=null)h.setInitialValue(m);else{const y=await h.getDefault(e.symbol,i.view);h.setInitialValue(y),e.setAttribute(h.field,y),o=!0}}),o){const h=((p=i.view)==null?void 0:p.type)==="2d"?i.view.scale:null;await ap(e,s,h)}const d={multipleSelectionEnabled:!1};return r.geometryType==="point"&&(d.enableRotation=a!=null,d.enableScaling=u!=null),ele(i.tooltipOptions,u,a),i.layer.elevationInfo=r.elevationInfo,i.update(e,d)}function vGe(t){return t==null||t.type!=="rotate-start"&&t.type!=="rotate"&&t.type!=="rotate-stop"?null:t}function bGe(t){return t==null||t.type!=="scale-start"&&t.type!=="scale"&&t.type!=="scale-stop"?null:t}async function ile(t,e,i,r,n){var d;if(e.geometry==null||((d=e.geometry)==null?void 0:d.type)!=="point")return;const s=r.rotation,o=vGe(i.toolEventInfo);if(s!=null&&o!=null){const{field:p,getValue:h}=s;o.type==="rotate-stop"?(s.isUpdatingInteractively=!1,s.setInitialValue(e.getAttribute(p))):(s.isUpdatingInteractively=!0,e.setAttribute(p,h(o.angle,t)))}const a=r.size,u=bGe(i.toolEventInfo);if(a!=null&&u!=null){const{field:p,getValue:h}=a;u.type==="scale-stop"?(a.isUpdatingInteractively=!1,a.setInitialValue(e.getAttribute(p))):(a.isUpdatingInteractively=!0,e.setAttribute(p,h(u.xScale,t)))}await ap(e,n,t.type==="2d"?t.scale:null)}async function _Ge({feature:t,featureClone:e,visualVariableAttributes:i,sketchViewModel:r,view:n,onUpdate:s,webStyleCache:o}){var _;await ap(e,o,n.type==="2d"?n.scale:null);let a=null;if(((_=r==null?void 0:r.view)==null?void 0:_.type)==="2d"){const w=Bo(S=>ap(e,o,S));a=N(()=>{var S;return(S=r==null?void 0:r.view)==null?void 0:S.scale},S=>w(S))}const u=e.sourceLayer,d=Jb(n,u);await pD({graphic:e,sketchViewModel:r,sourceLayer:u,visualVariables:i,webStyleCache:o});let p=null;d.then(w=>p=w).catch(()=>{});const h=i.size,m=i.rotation,y=N(()=>t.attributes,async w=>{let S=!1;for(const E in w){const T=w[E];T!==e.getAttribute(E)&&(e.setAttribute(E,T),h==null||h.isUpdatingInteractively||h.field!==E||h.setInitialValue(T),m==null||m.isUpdatingInteractively||m.field!==E||m.setInitialValue(T),(p==null||p.requiredFields.includes(E))&&(S=!0))}S&&await ap(e,o,n.type==="2d"?n.scale:null)}),g=r.on("update",async w=>{const S=w.graphics[0];if(w.state==="complete")return pD({graphic:S,sketchViewModel:r,sourceLayer:u,visualVariables:i,webStyleCache:o});await ile(n,S,w,i,o),s(hD(S),w)}),v=r.on(["undo","redo"],async w=>{s(hD(w.graphics[0]),w)});return kr([v,g,ye(()=>r.cancel()),y,a])}async function wGe(t,e,i){const r=t.view;t.layer.add(i);const n=e.sourceLayer,s=e.layer,o=e.getAttribute(s.objectIdField);let a=null;function u(d){a==null||a.abort(),a=Xo(async p=>{var m;const h=await Jb(r,n);qe(p),(m=h.setVisibility)==null||m.call(h,o,d)})}return await $Ge(r,i),u(!1),kr([SGe(r,i,d=>u(!d)),ye(async()=>{u(!0);try{const d=await Jb(r,n);await wi(()=>!d.updating)}finally{t.layer.remove(i)}})])}function SGe(t,e,i){if(t.type==="3d"){const r=new Ud({graphic:e});return kr([t.trackGraphicState(r),N(()=>r.displaying,i)])}return N(()=>e.visible,i)}async function $Ge(t,e){if(t.type==="3d"){const i=new Ud({graphic:e}),r=t.trackGraphicState(i);await wi(()=>i.displaying||i.error),r.remove()}else await wi(()=>e.visible)}const Vp={icon:Jr(24),text:Jr(12),line:Jr(1),viewScaleSizeFactor:100};function rle(t,e,i){let r=!1;return t.filter(n=>!!r||(r=n===e,r)).map(n=>i[n]())}function EGe(t,e){t.viewModel.syncFeatureTemplates();const i=t.creationInfo;if(e[0].id==="awaiting-feature-creation-info"&&i){const r=i.layer,n=tC(r);n.length===1&&r.type!=="scene"&&(i.template=n[0],e.shift())}return e}function TGe(t){return t==="unknown"?null:t}function IGe(t){t.filesEnabled=!0,t.mode="view",t.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}}const nle=t=>/-stop/.test(t)||/vertex-/.test(t),Jb=(t,e)=>{const i=e.type==="subtype-sublayer"?e.parent:e;return t.whenLayerView(i)};function xGe(t){return"createInteractiveEditSession"in t}function hD(t){var i;const e=t.geometry;if((e==null?void 0:e.type)==="mesh"){const r=t.cloneShallow();return r.attributes=R(t.attributes),r.geometry=e.cloneShallow(),r.geometry.transform=((i=e.transform)==null?void 0:i.clone())??null,r}return t.clone()}function mD(t){const e=t.cursor;return t.cursor="progress",ye(()=>t.cursor=e)}async function MGe({view:t,data:e,signal:i,next:r,cancel:n}){const{creationInfo:s}=e;if(!s||!OS(s))return ye();const{layer:o}=s,a=s.geometryToPlace!=null;if(s.geometryToPlace=null,a)return n(),ye();const{Upload:u}=await k(()=>import("./Upload-C27B9pol.js"),__vite__mapDeps([322,323]));qe(i);const d=new u;e.upload=d;let p=null;const h=()=>p==null?void 0:p.remove(),m=kr([N(()=>d.state,y=>{switch(y){case"default":case"error":h();break;case"pending":h(),p=mD(t);break;case"success":{s.maxFeatures=1;const{result:g}=d;(g==null?void 0:g.type)==="georeferenced"||(g==null?void 0:g.type)==="georeferenced-reprojected"?(s.geometryToPlace=g.mesh,s.initialFeature=new Li({attributes:Qae(s),geometry:g.mesh,sourceLayer:o}),t.goTo(s.initialFeature,{animate:!1}).catch(zo)):s.geometryToPlace=g==null?void 0:g.mesh,h(),r();break}}}),ye(()=>{d.cancel(),h()})]);return d.uploadTo(o),m}function OS(t){const e=t==null?void 0:t.layer;return(e==null?void 0:e.type)==="scene"}let jr=class extends ji.EventedAccessor{constructor(e){super(e),this._indexHistory=[],this._lastStepIndex=-1,this._stepIndex=-1,this._updatingHandles=new Wo,this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},this.data=void 0,this.started=!1,this.steps=[],this.type=null,this._pendingOperation=null}destroy(){this._updatingHandles.destroy()}get hasNextStep(){const{steps:e}=this;return!!(e&&this._stepIndex<e.filter(i=>!i.parent).length-1)}get hasPreviousStep(){return this._stepIndex>0}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){const{steps:e}=this,i=e&&e[this._stepIndex];return i&&i.id}get helpMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}get updating(){return this._updatingHandles.updating}async back(e=()=>Promise.resolve(!0)){this.hasPendingEdits&&!await e()||(this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0}))}async cancel(e={force:!0}){return e.force!==!1?this._cancel(e):new Promise((i,r)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...e,force:!0}).then(i)},deny:()=>r(new L("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.removeHandles(this._handleKeys.beforeCommit),this.onCommit&&await this.onCommit(this.data),this.removeHandles(this._handleKeys.afterCommit),this.emit("commit")}async go(e){const{steps:i}=this,r=i.findIndex(n=>n.id===e);this._indexHistory.push(this._stepIndex),await this._go(r)}async next(){this._indexHistory.push(this._stepIndex),await this._go(this._stepIndex+1)}async previous(e={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),e.cancelCurrentStep)}async reset(){await this._cancel({emitCancelEvent:!1}),await this.start()}async save(){await this.commit(),await this.reset()}async start(){this._set("started",!0);const e=this._stepIndex===-1?0:this._stepIndex;await this._go(e)}async _cancel({emitCancelEvent:e=!0,error:i}={}){this.started&&(this._set("started",!1),await this._transaction(()=>{var r;return(r=this.steps[this._stepIndex])==null?void 0:r.tearDown({canceled:!0})})),this.removeHandles([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(e),e&&this.emit("cancel",{error:i})}_go(e=-1,i=!1){return this._transaction(async()=>{const{steps:r}=this;if(!(e<=-1||e>=r.length)){if(!this.started)return this._stepIndex=e,void this._notifyStepProps();this._lastStepIndex>-1&&await r[this._lastStepIndex].tearDown({canceled:i});try{await r[e].setUp()}catch(n){NM(n)}this._lastStepIndex=e,this._stepIndex=e,this._notifyStepProps()}})}async _transaction(e){const i=this._pendingOperation,r=fn(),n=(i??Promise.resolve()).then(()=>r.promise);this._pendingOperation=n,this._updatingHandles.addPromise(n);try{i&&await i,await e()}finally{r.resolve(),n===this._pendingOperation&&(this._pendingOperation=null)}}_resetIndexing(e=!0){this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,e&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}};l([c()],jr.prototype,"data",void 0),l([c()],jr.prototype,"hasNextStep",null),l([c()],jr.prototype,"hasPreviousStep",null),l([c()],jr.prototype,"onCommit",void 0),l([c()],jr.prototype,"reliesOnOwnerAdminPrivileges",null),l([c()],jr.prototype,"hasInvalidFormTemplate",null),l([c()],jr.prototype,"shouldShowAttachments",null),l([c()],jr.prototype,"shouldAllowAttachmentEditing",null),l([c()],jr.prototype,"started",void 0),l([c({readOnly:!0})],jr.prototype,"stepId",null),l([c()],jr.prototype,"steps",void 0),l([c({readOnly:!0})],jr.prototype,"type",void 0),l([c()],jr.prototype,"helpMessage",null),l([c()],jr.prototype,"hasPendingEdits",null),l([c()],jr.prototype,"keyboardCancellationEnabled",null),l([c()],jr.prototype,"updating",null),jr=l([$("esri.widgets.Editor.Workflow")],jr);const HU=jr;function b7(t){switch(t){case ri.SUPPORTED:break;case ri.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case ri.GEOMETRY_MISSING:return"no geometry";case ri.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case ri.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case ri.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var ri;(function(t){t[t.SUPPORTED=0]="SUPPORTED",t[t.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",t[t.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",t[t.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",t[t.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",t[t.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(ri||(ri={}));function CGe(t){var r,n;if(t.graphic&&((r=t.graphic.layer)==null?void 0:r.type)!=="graphics")return ri.GRAPHICS_LAYER_MISSING;const e=(n=t.operations)==null?void 0:n.data.type;if(!e)return ri.GEOMETRY_TYPE_UNSUPPORTED;switch(e){case"polygon":case"point":case"polyline":case"mesh":break;default:return ri.GEOMETRY_TYPE_UNSUPPORTED}const i=t.elevationInfo;return bE(i)?ri.ELEVATION_MODE_UNSUPPORTED:ri.SUPPORTED}function kGe(t){return LGe(t).result}function LGe(t){var r;if(t.graphic&&((r=t.graphic.layer)==null?void 0:r.type)!=="graphics")return{result:ri.GRAPHICS_LAYER_MISSING};if(!t.operations)return{result:ri.GEOMETRY_MISSING};if(bE(t.elevationInfo))return{result:ri.ELEVATION_MODE_UNSUPPORTED};const e=t.operations.data.type,i=t.operations.data.geometry;return e==="point"||e==="mesh"||e==="polyline"||e==="polygon"?{result:ri.SUPPORTED,geometry:i}:{result:ri.GEOMETRY_TYPE_UNSUPPORTED}}function AGe(t){var i;if(((i=t.layer)==null?void 0:i.type)!=="graphics")return ri.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return ri.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return ri.SUPPORTED;default:return ri.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return!e||!e.some(r=>r.type==="object")?ri.SYMBOL_TYPE_UNSUPPORTED:G4e(t)!=="on-the-ground"&&nae(t)?ri.ELEVATION_MODE_UNSUPPORTED:ri.SUPPORTED}function _7(t,e,i){if(!e||!(t!=null&&t.map))return;const{map:r}=t,n=r.layers.find(s=>s===e);n||r.add(e,i),n&&i!=null&&r.layers.reorder(n,i)}function OGe(t,e){const i=(e==null?void 0:e.type)==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(r=>{const n=r.layer;return n===i||"sublayers"in n&&n.sublayers!=null&&n.sublayers.includes(i)})}let In=class extends ji.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:this.activeComponent}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};l([c()],In.prototype,"activeComponent",void 0),l([c()],In.prototype,"cancelled",void 0),l([c()],In.prototype,"history",void 0),l([c()],In.prototype,"tool",null),l([c()],In.prototype,"type",void 0),l([c()],In.prototype,"canUndo",null),l([c()],In.prototype,"canRedo",null),l([c()],In.prototype,"onEnd",void 0),l([c()],In.prototype,"undo",null),l([c()],In.prototype,"redo",null),l([c()],In.prototype,"toggleTool",void 0),l([c()],In.prototype,"addToSelection",void 0),l([c()],In.prototype,"removeFromSelection",void 0),In=l([$("esri.widgets.Sketch.support.OperationHandle")],In);let fM=class extends In{};l([c()],fM.prototype,"activeComponent",void 0),fM=l([$("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],fM);let qd=class extends In{};l([c()],qd.prototype,"activeComponent",void 0),qd=l([$("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],qd);const w7={defaultZ:0},cw={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let At=class extends ji.EventedAccessor{constructor(e){var i;super(e),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new vE({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new Or({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Qo({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new yr({color:[130,130,130,1],width:2}),this.meshSymbol=new y_({symbolLayers:new Y([new Im])}),this.updateGraphics=new Y,this.updateOnGraphicClick=!0,this.vertexSymbol=new Or({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new Lm,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=w7,this.defaultUpdateOptions=cw,this.snappingOptions=((i=e==null?void 0:e.snappingManager)==null?void 0:i.options)??(e==null?void 0:e.snappingOptions)??new gg}initialize(){this.addHandles([St(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),St(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const i of e.removed)this.updateGraphics.includes(i)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(i):this._operationHandle.cancel())}),N(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},gt),N(()=>this.view,e=>{this._defaultSnappingManager=xe(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new Pa({view:e,options:this.snappingOptions})),e.type==="2d"?k(()=>import("./editingTools-Ch1OnvIB.js"),__vite__mapDeps([324,325,326,327,328,151,152,65,63,318,319,12,1,320,96,136,329,330,145,331,332])):e.type==="3d"&&(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(i=>i.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])),k(()=>import("./LineCallout.glsl-DwFUBaWf.js").then(i=>i.G),__vite__mapDeps([345,338,133,118,92,134,132,55,135,58,136,138,139,103,112,52,53,54,145,116,79,142,115,117,140,141,25,26,42,43,144,65,63,24,27,39,191,190,21,22,23,346,187]))))},gt),N(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,i)=>{e&&i&&!e.equals(i)&&this.cancel()})]),tUe(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=xe(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeTooltip(){const{activeComponent:e,destroyed:i}=this,r=!i&&e&&"tooltip"in e?e.tooltip:null;return r!=null&&r.visible?r:null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...w7,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...cw,...e,reshapeOptions:{...cw.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...cw.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=xe(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:i}=this;!this._defaultSnappingManager&&i&&(this._defaultSnappingManager=new Pa({options:this.snappingOptions,view:i})),this._clearOverride("snappingManager")}}get state(){var r;const e=!(!((r=this.view)!=null&&r.ready)||!this.layer),i=this._operationHandle;return e&&i?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const i=this._get("view");if(i){const{container:n,map:s}=i;n&&(i.cursor=null),s==null||s.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const r="view-ready";this.removeHandles(r),e&&this.addHandles(Hi(()=>e.ready,n=>{this.removeHandles(this._viewHandlesKey),n&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},gt),r),this._set("view",e)}cancel(){this._moduleLoaderAbortController=mr(this._moduleLoaderAbortController),this._viewReadyAbortController=mr(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:i}=this;if(e==="active"&&i.length){const{activeTool:r,layer:n}=this,s=i.toArray();n.removeMany(s),this.cancel(),this._emitDeleteEvent({graphics:s,tool:r})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(i=>i.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,i){this.cancel(),await this._waitViewReady();const{view:r,layer:n}=this;if(!r||this.state==="disabled")throw n||this._logMissingLayer(),mt();if(r.activeTool!=null&&(r.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");_7(r,this._internalGraphicsLayer);const s=await this._setupCreateOperation(e,i);if(s==null||this.destroyed)return void r.map.remove(this._internalGraphicsLayer);const o=()=>{var a;if(s===this._operationHandle){const u=this.createGraphic,d=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(a=this.view)!=null&&a.map&&this.view.map.remove(this._internalGraphicsLayer),s.cancelled||u==null||n.add(u),this.emit("create",{graphic:u,state:d?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};s.on("complete",o),this._operationHandle=s,r.ready&&r.focus()}async place(e,i){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...i})}async update(e,i){this.cancel(),await this._waitViewReady();const{layer:r,view:n,state:s}=this;if(!n||s==="disabled")throw r||this._logMissingLayer(),mt();n.activeTool!=null&&(n.activeTool=null);const o=Array.isArray(e)?e:[e];if(e==null||!(o!=null&&o.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(o.some(u=>u.layer!==r?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):u.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const a=await this._setupUpdateOperation(o,i);this.destroyed||a==null||gr(a)||(_7(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(a,i),this.emit("update",{graphics:o,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const i=this.view;if(i){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const r of e)r.geometry==null||r.geometry.type==="mesh"||ci(r.geometry.spatialReference,i.spatialReference)||(Yo(r.geometry.spatialReference,i.spatialReference)||Ac()||await $c(),r.geometry=On(r.geometry,i.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const i=this.view;if(!i)return this._logMissingView(),null;if(i.type==="2d"){const s=[];i.map.allLayers.forEach(a=>{a.type!=="vector-tile"&&a.type!=="imagery"||s.push(a)});const o=await i.hitTest(e,{exclude:s});return nGe(o.results)}const r=[i.map.ground];i.map.allLayers.forEach(s=>{yye(s.type)&&r.push(s)});const n=await i.hitTest(e,{exclude:r});if(n.results.length>0){const s=n.results[0];if(s!=null&&s.type==="graphic"&&s.graphic&&(!n.ground.mapPoint||i.map.ground.opacity<1||n.ground.distance-(s.distance??0)>-Math.min(3*n.ground.distance,i.viewingMode==="global"?VC(i.renderCoordsHelper.spatialReference).radius/i.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return s}return null}_generateViewHandles(e){return[e.on("immediate-click",async i=>{var o;const r=this.state==="active"&&((o=this._operationHandle)==null?void 0:o.type)==="create";if(this.state==="disabled"||r||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const n=await i.async(()=>this._getFirstHit(Oa(i)));let s=null;if(n!=null){const a=n.graphic;this.updateGraphics.includes(a)||a.layer===this.layer?(i.stopPropagation(),s=a):e.type!=="2d"||this._isComponentGraphic(a)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();s==null||this.updateGraphics.includes(s)||await this.update([s],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},yt.WIDGET)]}async _setupCreateOperation(e,i){const r=this.view;if(!r)return this._logMissingView(),null;const n={hasZ:r.type==="3d",...this.defaultCreateOptions,...i},s=await this._setupDrawGraphicTool(e,r,n);return s==null?null:(r.tools.add(s),r.activeTool=s,this._setupCreateOperationHandle(s))}async _setupDrawGraphicTool(e,i,r){if(e==="multipoint"&&i.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!i)return this._logMissingView(),null;const{cursor:n,defaultZ:s,hasZ:o,geometryToPlace:a,graphicProperties:u,mode:d,preserveAspectRatio:p}=r,h=e==="rectangle"||e==="circle"?"hybrid":"click",m=p??e!=="rectangle",y={centered:e!=="rectangle"&&!(e==="circle"&&!m),cursor:n,defaultZ:s,forceUniformSize:m,graphicProperties:u,geometryToPlace:a,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:o,mode:d??h,snappingManager:this.snappingManager,snapToScene:!1,view:i};return i.type==="2d"?this._makeDrawGraphicTool2D(y):this._makeDrawGraphicTool3D(y)}async _makeDrawGraphicTool2D(e){const i=await this._requireModule(k(()=>import("./editingTools-Ch1OnvIB.js"),__vite__mapDeps([324,325,326,327,328,151,152,65,63,318,319,12,1,320,96,136,329,330,145,331,332])));return gr(i)||this.destroyed?null:new i.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:PGe(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const i=await this._requireModule(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(n=>n.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])));if(gr(i)||this.destroyed)return null;const{elevationInfo:r}=this.layer;return new i.module.DrawGraphicTool3D({...e,elevationInfo:r,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const i=this.view;if(!i)return this._logMissingView(),null;let r=null;const n=e.forceUniformSize,s=e.centered,o=[i.on("key-down",u=>{if(u.key===Yi.pan)u.stopPropagation(),u.repeat||(e.enabled=!1);else if(u.key===Yi.complete)u.stopPropagation(),e.completeCreateOperation();else if(u.key!==Yi.vertexAdd||u.repeat)u.key===Yi.undo?(u.stopPropagation(),a.undo()):u.key===Yi.redo?(u.stopPropagation(),a.redo()):u.key!==Yi.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||u.repeat?u.key===Yi.center&&(u.repeat||(e.centered=!s,u.stopPropagation())):(e.forceUniformSize=!n,u.stopPropagation());else{const d=e.drawOperation.geometryType;d!=="polyline"&&d!=="polygon"&&d!=="multipoint"||(u.stopPropagation(),e.drawOperation.commitStagedVertex())}},yt.WIDGET),i.on("key-up",u=>{u.key===Yi.pan?e.enabled=!0:u.key!==Yi.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?u.key===Yi.center&&(e.centered=s,u.stopPropagation()):(e.forceUniformSize=n,u.stopPropagation())},yt.WIDGET),e.on("vertex-add",u=>{switch(r=r==null?"start":"active",u.operation){case"apply":this.emit("create",{graphic:e.graphic,state:r,tool:this.activeTool,toolEventInfo:u,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",u=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:u.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",u=>{switch(u.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:u,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",u=>{this._set("createGraphic",u.graphic),r="complete",u.aborted?a&&a.cancel():a&&a.complete()}),N(()=>this._getGraphicSymbolFromTool(e.geometryType),u=>{e.graphicSymbol=u})],a=new fM({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var u;Su(o),(u=i.tools)==null||u.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,i){var a;const{layer:r,view:n}=this;if(!n)return this._logMissingView(),null;const s={...this.defaultUpdateOptions,...i,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...i==null?void 0:i.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...i==null?void 0:i.highlightOptions}};let o=s.tool??cw.tool;for(const u of e)r.remove(u),r.add(u);if(n.type==="3d"){if(e.length===0)return null;switch(o){case"move":return this._setupMove3DOperation(e,s,n,o);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],s,n);case"transform":return this._setupGraphicTransform3DOperation(e,s,n)}}switch(o){case"move":return this._setupMove2DOperation(e,s,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,o,s,n);case"transform":if(e.length===1){const u=(a=e[0].geometry)==null?void 0:a.type;u!=="point"&&u!=="multipoint"||(o="reshape")}return this._setupTransformOrReshape2DOperation(e,o,s,n)}}async _setupMove3DOperation(e,i,r,n,s=!1){const o=await this._requireModule(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(g=>g.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])));if(gr(o))return o;const{ManipulatedObject3DGraphic:a,MoveTool3D:u}=o.module,d=new Map,p=()=>{d.forEach(g=>g.destroy()),d.clear()};for(const g of e){const v=new a({view:r,graphic:g}),_=CGe(v);if(_!==ri.SUPPORTED)return p(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${b7(_)}).`),null;d.set(g,v)}const h=new u({view:r,enableZ:i.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(h),h.objects.addMany(Array.from(d.values())),s||this.updateGraphics.addMany(e);const m=[],y=new qd({activeComponent:h,tool:n,type:"update",onEnd:()=>{Su(m),fI(r,h),p()},undo:()=>{$7(this.view,h),hI(y,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{mI(y,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:g=>{this.updateGraphics.push(g);const v=new a({view:r,graphic:g});d.set(g,v),h.objects.push(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:g=>{const v=this.updateGraphics.indexOf(g);if(y.history.undo.forEach(w=>w.updates.splice(v,1)),y.history.redo.forEach(w=>w.updates.splice(v,1)),this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void y.complete();const _=d.get(g);_&&(h.objects.remove(_),_.destroy(),d.delete(g))},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1||n!=="transform")return;const g=this.updateGraphics.at(0),v=await this._setupReshape3DOperation(g,i,r,!0);v&&!gr(v)&&(y.onEnd(),y.destroy(),this._setUpdateOperationHandle(v,i))}});return m.push(...this._getHandlesForComponent(y,i),r.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,i),yt.WIDGET),r.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},yt.WIDGET)),y}_setupGraphicTransform3DOperation(e,i,r,n=!1){if(e.length===1&&AGe(e[0])===ri.SUPPORTED){const s=e[0],o=s.geometry;if(o!=null&&(o.type==="point"||o.type==="mesh"))return this._setupPointTransform3DOperation(s,i,r);if(o!=null&&(o.type==="polygon"||o.type==="polyline"))return this._setupPolyTransform3DOperation(s,i,r,n)}return this._setupMove3DOperation(e,i,r,"transform",n)}async _setupPointTransform3DOperation(e,i,r){const n="transform",{enableRotation:s,enableScaling:o,enableZ:a}=i,u=await this._requireModule(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(v=>v.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])));if(gr(u))return u;const{TransformTool3D:d,ManipulatedObject3DGraphic:p}=u.module,h=new p({graphic:e,view:r}),m=new d({object:h,view:r,enableRotation:s,enableScaling:o,enableZ:a,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(m),this.updateGraphics.add(e);const y=[],g=new qd({activeComponent:m,tool:n,type:"update",onEnd:()=>{Su(y),fI(r,m),h.destroy()},undo:()=>{$7(this.view,m),hI(g,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{mI(g,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async v=>{this.updateGraphics.add(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[v],removed:[],type:"selection-change"},type:"update"}),g.onEnd(),g.destroy();const _=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);gr(_)||this._setUpdateOperationHandle(_,i)},removeFromSelection:v=>{this.updateGraphics.remove(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[v],type:"selection-change"},type:"update"}),g.complete()},toggleTool:()=>{}});return y.push(...this._getHandlesForComponent(g,i),r.on("immediate-click",v=>this._getCommonUpdateOperationClickHandlers(g,v,i),yt.WIDGET),r.on("key-down",v=>{this._getCommonUpdateOperationKeyDownHandlers(g,v)},yt.WIDGET)),g}async _setupPolyTransform3DOperation(e,i,r,n=!1){var S,E;const s="transform",{enableRotation:o,enableScaling:a,enableZ:u,preserveAspectRatio:d}=i,p=await this._requireModule(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(T=>T.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])));if(gr(p))return p;const{ManipulatedObject3DGraphic:h,ExtentTransformTool:m}=p.module,y=(E=(S=this.view)==null?void 0:S.inputManager)==null?void 0:E.isModifierKeyDown(Yi.constraint),g=new h({view:r,graphic:e}),v=new m({object:g,view:r,enableRotation:o,enableScaling:a,enableZ:u,preserveAspectRatio:!!d!=!!y,sketchOptions:this.sketchOptions});r.tools.add(v),n||this.updateGraphics.add(e);const _=[],w=new qd({activeComponent:v,tool:s,type:"update",onEnd:()=>{Su(_),fI(r,v),g.destroy()},canUndo:()=>!v.destroyed&&v.canUndo,undo:()=>{v.destroyed||(v.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!v.destroyed&&v.canRedo,redo:()=>{v.destroyed||(v.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async T=>{this.updateGraphics.add(T),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[T],removed:[],type:"selection-change"},type:"update"}),w.onEnd(),w.destroy();const M=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);gr(M)||this._setUpdateOperationHandle(M,i)},removeFromSelection:T=>{this.updateGraphics.remove(T),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[T],type:"selection-change"},type:"update"}),w.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1)return;const T=await this._setupReshape3DOperation(e,i,r,!0);T&&!gr(T)&&(w.onEnd(),w.destroy(),this._setUpdateOperationHandle(T,i))}});return _.push(...this._getHandlesForComponent(w,i),r.on("immediate-click",T=>this._getCommonUpdateOperationClickHandlers(w,T,i),yt.WIDGET),r.on("key-down",T=>this._getCommonUpdateOperationKeyDownHandlers(w,T),yt.WIDGET),r.on("key-down",T=>{T.key!==Yi.constraint||T.repeat||(v.preserveAspectRatio=!v.preserveAspectRatio,T.stopPropagation())},yt.WIDGET),r.on("key-up",T=>{T.key===Yi.constraint&&(v.preserveAspectRatio=!v.preserveAspectRatio,T.stopPropagation())},yt.WIDGET)),w}async _setupMove2DOperation(e,i,r){const n="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=await this._getGraphicMover(e,i,r);if(gr(s))return s;const o=new qd({activeComponent:s,tool:n,type:"update",onEnd:()=>{var p;this._displayDefaultCursor(),Su(d),Su(u),s.destroy(),(p=this._internalGraphicsLayer)==null||p.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const p=this.updateGraphics.toArray();hI(o,p),o.refreshComponent(),this._emitUndoEvent({graphics:p,tool:n})},redo:()=>{const p=this.updateGraphics.toArray();mI(o,p),o.refreshComponent(),this._emitRedoEvent({graphics:p,tool:n})},addToSelection:async p=>{await this._updateSpatialReference(p),this.updateGraphics.push(p),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[p],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:p=>{const h=this.updateGraphics.indexOf(p);o.history.undo.forEach(y=>y.updates.splice(h,1)),o.history.redo.forEach(y=>y.updates.splice(h,1)),this.updateGraphics.remove(p);const m=this.updateGraphics.toArray();this.emit("update",{graphics:m,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[p],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?s.graphics=m:o.complete()}});let a=!1;const u=[r.on("immediate-click",p=>this._getCommonUpdateOperationClickHandlers(o,p,i),yt.WIDGET),r.on("key-down",p=>{this._getCommonUpdateOperationKeyDownHandlers(o,p),p.key!==Yi.constraint||p.repeat||(a=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},yt.WIDGET),r.on("key-up",p=>{p.key===Yi.constraint&&a&&(a=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},yt.WIDGET)],d=this._getHandlesForComponent(o,i);return o}async _setupReshape3DOperation(e,i,r,n=!1){const s="reshape",o=await this._requireModule(k(()=>import("./ImageMaterial.glsl-BPsHBZUt.js").then(v=>v.e),__vite__mapDeps([333,328,151,152,65,63,318,319,12,1,320,334,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,84,143,144,141,339,326,327,329,330,340,341,342,15,343,344,331])));if(gr(o))return o;const{ManipulatedObject3DGraphic:a,ReshapeTool3D:u}=o.module,d=new a({view:r,graphic:e}),p=kGe(d);if(p!==ri.SUPPORTED)return d.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${b7(p)}).`),null;const h=i.reshapeOptions,m=new u({view:r,object:d,enableZVertex:i.enableZ&&(h==null?void 0:h.vertexOperation)==="move",enableZShape:i.enableZ&&(h==null?void 0:h.shapeOperation)==="move",enableMoveObject:(h==null?void 0:h.shapeOperation)==="move"||(h==null?void 0:h.shapeOperation)==="move-xy",enableMidpoints:(h==null?void 0:h.edgeOperation)==="split",enableEdgeOffset:(h==null?void 0:h.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(m),n||this.updateGraphics.add(d.graphic);const y=[],g=new qd({activeComponent:m,tool:s,type:"update",onEnd:()=>{Su(y),fI(r,m),d.destroy()},canUndo:()=>!m.destroyed&&m.canUndo,undo:()=>{m.destroyed||(m.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!m.destroyed&&m.canRedo,redo:()=>{m.destroyed||(m.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async v=>{this.updateGraphics.add(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[v],removed:[],type:"selection-change"},type:"update"}),g.onEnd(),g.destroy();const _=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);gr(_)||this._setUpdateOperationHandle(_,i)},removeFromSelection:v=>{this.updateGraphics.remove(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[v],type:"selection-change"},type:"update"}),g.complete()},toggleTool:async()=>{if(i.toggleToolOnClick===!1)return;g.onEnd(),g.destroy();const v=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),i,r,!0);gr(v)||this._setUpdateOperationHandle(v,i)}});return y.push(...this._getHandlesForComponent(g,i),r.on("immediate-click",v=>this._getCommonUpdateOperationClickHandlers(g,v,i),yt.WIDGET),r.on("key-down",v=>{this._getCommonUpdateOperationKeyDownHandlers(g,v)},yt.WIDGET)),g}async _setupTransformOrReshape2DOperation(e,i,r,n){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=i==="transform"?await this._getBox(e,r,n):await this._getReshape(e,r,n);if(gr(s))return s;const o=new qd({activeComponent:s,type:"update",onEnd:()=>{Su(u),Su(a),o.activeComponent&&!o.activeComponent.destroyed&&o.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{hI(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},redo:()=>{mI(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},addToSelection:async d=>{let p=o.activeComponent;if((p==null?void 0:p.type)==="reshape"){const h=[...this.updateGraphics,d];this.updateGraphics.removeAll(),o.onEnd(),o.destroy();const m=await this._setupTransformOrReshape2DOperation(h,"transform",r,n);if(gr(m))return;this._setUpdateOperationHandle(m,r)}else this.updateGraphics.add(d),p.graphics=this.updateGraphics.toArray(),p.refresh(),o.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async d=>{const p=this.updateGraphics.indexOf(d);o.history.undo.forEach(m=>m.updates.splice(p,1)),o.history.redo.forEach(m=>m.updates.splice(p,1)),this.updateGraphics.remove(d);const h=this.updateGraphics.toArray();if(h.length===0)o.complete();else{const m=h[0].geometry;h.length!==1||m==null||m.type!=="point"&&m.type!=="multipoint"?o.activeComponent.graphics=h:o.toggleTool()}this.emit("update",{graphics:h,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"})},toggleTool:async()=>{var m;if(this.updateGraphics.length>1)return;const d=this.updateGraphics.at(0),p=d.geometry;if(p!=null&&(o.tool==="reshape"&&(p.type==="point"||p.type==="multipoint")||o.tool==="transform"&&p.type==="extent"))return;let h=null;o.tool==="transform"?h=await this._getReshape([d],r,n):o.tool==="reshape"&&(h=await this._getBox([d],r,n)),gr(h)||((m=o.activeComponent)==null||m.destroy(),o.activeComponent=h,o.activeComponent&&(Su(u),u=this._getHandlesForComponent(o,r)))}}),a=[n.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(o,d,r),yt.WIDGET),n.on("key-down",d=>{if(this._getCommonUpdateOperationKeyDownHandlers(o,d),d.key===Yi.constraint&&!d.repeat&&o){const p=o.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},yt.WIDGET),n.on("key-up",d=>{if(d.key===Yi.constraint&&o){const p=o.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},yt.WIDGET)];let u=this._getHandlesForComponent(o,r);return o}async _getGraphicMover(e,i,r){const{enableMoveAllGraphics:n,highlightOptions:s}=i,o=await this._requireModule(k(()=>import("./GraphicMover-C-z_G-S4.js"),__vite__mapDeps([347,332,331])));return gr(o)?o:new o.module.default({enableMoveAllGraphics:n,highlightsEnabled:!!(s!=null&&s.enabled),indicatorsEnabled:!1,graphics:e,view:r,callbacks:{onGraphicMoveStart:({dx:a,dy:u,graphic:d})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:u,mover:d,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:u,graphic:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:u,mover:d,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:u,graphic:d})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:u,mover:d,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,i,r){var p,h;const{enableRotation:n,enableScaling:s,highlightOptions:o,preserveAspectRatio:a}=i,u=await this._requireModule(k(()=>import("./Box-PS3VvIsX.js"),__vite__mapDeps([348,332,347,331,349,328,151,152,65,63,318,319,12,1,320,344,341])));if(gr(u))return u;const d=(h=(p=this.view)==null?void 0:p.inputManager)==null?void 0:h.isModifierKeyDown(Yi.constraint);return new u.module.default({graphics:e,enableRotation:n,enableScaling:s,highlightsEnabled:!!(o!=null&&o.enabled),preserveAspectRatio:!!a!=!!d,layer:this._internalGraphicsLayer,view:r,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onMove:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onMoveStop:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onScaleStart:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onScale:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onScaleStop:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onRotateStart:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onRotate:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"}),onRotateStop:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...m},type:"update"})}})}async _getReshape(e,i,r){var u,d,p;const n=((u=i.reshapeOptions)==null?void 0:u.edgeOperation)==="split",s=((d=i.reshapeOptions)==null?void 0:d.shapeOperation)==="move",o=!!((p=i.highlightOptions)!=null&&p.enabled),a=await this._requireModule(k(()=>import("./Reshape-CaegEi0x.js"),__vite__mapDeps([350,325,326,327,328,151,152,65,63,318,319,12,1,320,96,136,332,347,331,340,341,349])));return gr(a)?a:new a.module.default({enableMidpoints:n,enableMovement:s,graphic:e[0],highlightsEnabled:o,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:r,callbacks:{onReshapeStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshape:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshapeStop:({mover:h,type:m})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:h,type:m},type:"update"}),onMoveStart:({dx:h,dy:m,mover:y,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:m,mover:y,type:g},type:"update"}),onMove:({dx:h,dy:m,mover:y,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:m,mover:y,type:g},type:"update"}),onMoveStop:({dx:h,dy:m,mover:y,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:m,mover:y,type:g},type:"update"}),onVertexAdd:({added:h,type:m,vertices:y})=>{const g=h.map(v=>BG(v.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:g,vertices:y,type:m},type:"update"})},onVertexRemove:({removed:h,type:m,vertices:y})=>{const g=h.map(v=>BG(v.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:g,vertices:y,type:m},type:"update"})}}})}_getHandlesForComponent(e,i){const r=e.activeComponent;if(!r)return[];switch(r.type){case"graphic-mover":return[r.on("graphic-click",({graphic:n,viewEvent:s})=>{var o;(o=s.native)!=null&&o.shiftKey&&(s.stopPropagation(),e.removeFromSelection(n))}),r.on("graphic-move-start",n=>e.addToHistory(Up(n.allGraphics)))];case"box":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(Up(n.graphics))),r.on("rotate-start",n=>e.addToHistory(Up(n.graphics))),r.on("scale-start",n=>e.addToHistory(Up(n.graphics)))];case"reshape":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(Up([n.mover]))),r.on("reshape-start",n=>e.addToHistory(Up([n.graphic]))),r.on("vertex-add",n=>e.addToHistory(Up([n.oldGraphic]))),r.on("vertex-remove",n=>e.addToHistory(Up([n.oldGraphic])))];case"move-3d":return[r.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),r.events.on("move-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-start"},type:"update"})}),r.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n.dx,dy:n.dy,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move"},type:"update"})}),r.events.on("move-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-stop"},type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})];case"transform-3d":return[r.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),r.events.on("translate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-start"},type:"update"})}),r.events.on("translate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-stop"},type:"update"})}),r.events.on("rotate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-start"},type:"update"})}),r.events.on("rotate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-stop"},type:"update"})}),r.events.on("scale-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-start"},type:"update"})}),r.events.on("scale-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-stop"},type:"update"})}),r.events.on("translate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move"},type:"update"})}),r.events.on("rotate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate"},type:"update"})}),r.events.on("scale",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale"},type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})];case"reshape-3d":return[r.events.on("reshape",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),r.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),r.events.on("vertex-add",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.events.on("vertex-remove",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,i,r){var o;const{graphic:n,viewEvent:s}=r;return(o=s.native)!=null&&o.shiftKey&&n.layer===this.layer?(s.stopPropagation(),e.removeFromSelection(n)):i.toggleToolOnClick?(s.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,i){var s;this._operationHandle=e;const r=(s=this.view)==null?void 0:s.map;this._disablePopup(i);const n=()=>{if(e===this._operationHandle){const o=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),r&&r.remove(this._internalGraphicsLayer),this._restorePopup(i),this.emit("update",{graphics:o,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}};e.on("complete",n)}async _getCommonUpdateOperationClickHandlers(e,i,r){const n=Oa(i),s=await i.async(()=>this._getFirstHit(n));if(s==null)return void e.complete();if(i.native.shiftKey&&this._toggleSelection([s.graphic],e,r))return void i.stopPropagation();this.updateGraphics.includes(s.graphic)?i.stopPropagation():e.complete()}_toggleSelection(e,i,r){const n=!!r.multipleSelectionEnabled;return e.some(s=>s!=null&&!(!n||s.layer!==this.layer)&&(this.updateGraphics.includes(s)?i.removeFromSelection(s):i.addToSelection(s),!0))}_getCommonUpdateOperationKeyDownHandlers(e,i){if(!e)return;const r=i.key;r===Yi.undo&&e.canUndo()?(i.stopPropagation(),e.undo()):r===Yi.redo&&e.canRedo()?(i.stopPropagation(),e.redo()):r===Yi.cancel?(i.stopPropagation(),e.cancel()):this.allowDeleteKey&&Yi.delete.includes(r)&&this._onDeleteKey(i)}_onDeleteKey(e){var n;if(!this._operationHandle||this._operationHandle.type!=="update")return;const i=this.activeComponent,r=this.updateGraphics.toArray();i!=null&&(i.type!=="reshape"||r.length===1&&((n=r[0].geometry)==null?void 0:n.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,i;this._internalGraphicsLayer&&((i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=xe(this._internalGraphicsLayer))}_isComponentGraphic(e){var r;const{activeComponent:i}=this;return!(!e||i==null)&&(((r=e.attributes)==null?void 0:r.esriSketchTool)||i.type==="draw-2d"&&i.graphic===e||(i.type==="box"||i.type==="reshape")&&i.isUIGraphic(e))}_displayPointerCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,i,r){U.getLogger(this).error(new L(e,i,r))}async _requireModule(e){const i=new AbortController;this._moduleLoaderAbortController=i;const r=await e;return this._moduleLoaderAbortController!==i||i.signal.aborted?{requireError:"aborted"}:{module:r}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return wi(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var i;return((i=this.view)==null?void 0:i.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(mr(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Xa(wi(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",S7("view"))}_logMissingLayer(){this._logError(RGe,S7("layer"))}};l([c()],At.prototype,"_defaultSnappingManager",void 0),l([c()],At.prototype,"updating",null),l([c()],At.prototype,"_operationHandle",void 0),l([c({readOnly:!0})],At.prototype,"activeTool",null),l([c()],At.prototype,"activeTooltip",null),l([c()],At.prototype,"activeFillSymbol",void 0),l([c()],At.prototype,"activeLineSymbol",void 0),l([c()],At.prototype,"activeVertexSymbol",void 0),l([c()],At.prototype,"allowDeleteKey",void 0),l([c({readOnly:!0})],At.prototype,"createGraphic",null),l([c()],At.prototype,"defaultCreateOptions",null),l([c()],At.prototype,"defaultUpdateOptions",null),l([c({type:SU,nonNullable:!0})],At.prototype,"labelOptions",null),l([c()],At.prototype,"layer",void 0),l([c({types:Ha})],At.prototype,"pointSymbol",void 0),l([c({types:Ha})],At.prototype,"polygonSymbol",void 0),l([c({types:Ha})],At.prototype,"polylineSymbol",void 0),l([c()],At.prototype,"meshSymbol",void 0),l([c({type:gg,nonNullable:!0})],At.prototype,"snappingOptions",null),l([c()],At.prototype,"snappingManager",null),l([c({readOnly:!0})],At.prototype,"state",null),l([c({type:$U,nonNullable:!0})],At.prototype,"tooltipOptions",null),l([c({readOnly:!0})],At.prototype,"updateGraphics",void 0),l([c()],At.prototype,"updateOnGraphicClick",void 0),l([c({type:Bk,nonNullable:!0})],At.prototype,"valueOptions",null),l([c({types:Ha})],At.prototype,"vertexSymbol",void 0),l([c({value:null})],At.prototype,"view",null),l([c({constructOnly:!0,type:Lm})],At.prototype,"sketchOptions",void 0),At=l([$("esri.widgets.Sketch.SketchViewModel")],At);const RGe="sketch:missing-property",S7=t=>`Property '${t}' is missing on SketchViewModel.`;function PGe(t){return t==="polygon"||t==="rectangle"||t==="circle"}function hI(t,e){sle("undo",t.history.undo,t.history.redo,e)}function mI(t,e){sle("redo",t.history.redo,t.history.undo,e)}function sle(t,e,i,r){const n=e.pop();if(!n)return;const s=n.updates,o=[];r.forEach((a,u)=>{const d=s[u];d!=null&&("geometry"in d&&d.geometry!=null&&(o.push({geometry:a.geometry}),a.geometry=d.geometry),"symbol"in d&&d.symbol!=null&&(o.push({symbol:a.symbol}),a.symbol=d.symbol),"undo"in d&&(o.push(d),d[t](a)))}),i.push({updates:o})}function $7(t,e){t!=null&&e.hasGrabbedManipulators&&(t.activeTool=null)}function Up(t){return{updates:t.map(({geometry:e})=>(e==null?void 0:e.type)==="mesh"?{geometry:e.cloneShallow()}:{geometry:e})}}function fI(t,e){var i;(i=t.tools)==null||i.remove(e),e.destroyed||e.destroy()}function gr(t){return"requireError"in t&&t.requireError==="aborted"}const nL=At;var yM;const vO=Symbol(),Bg=Symbol(),yI=Symbol();let un=yM=class extends HU{constructor(t){super(t),this.type="create-features",this.createFeatureState="create-new",this.data=void 0,this.isNested=!1,this._getDrawMeshHelpMessage=void 0,this._featureFormHandle=null,this._visualVariableAttributes={rotation:null,size:null},this._featureFormViewModel=new pU,this._sketchViewModel=null,this._attachmentFileInfos=new Map,this._highlightHandles=new Map,this._preventDefaultActionOnCancel=!1,this._lastActiveGraphics=[],this._isActive=!0,this._updateGraphicDebounced=Bo((e,i,r)=>ap(e,i,r))}initialize(){this.isNested&&(this._isActive=!1),this._initializeSketchViewModel()}destroy(){this._sketchViewModel.destroy()}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){var s,o;if(this.pendingFeatures.some(a=>{var u;return!!((u=this.data.getEditsForPendingFeature(a))!=null&&u.modified)}))return!0;const{creationInfo:t,upload:e}=this.data,i=this._sketchViewModel,{activeComponent:r}=i,n=(o=(s=i.createGraphic)==null?void 0:s.geometry)==null?void 0:o.type;return!(n!=="polyline"&&n!=="polygon"&&n!=="multipoint"||(r==null?void 0:r.type)!=="draw-2d"&&(r==null?void 0:r.type)!=="draw-3d")&&r.drawOperation.committedVertices.length>0||!(!e||e.state!=="pending"&&e.state!=="success")||!!(t!=null&&t.geometryToPlace)}get helpMessage(){var n;const{creationInfo:t,viewModel:e}=this.data;if(this.stepId!=="creating-features"||!t)return;const i=t.layer.geometryType,r=this._sketchViewModel.createGraphic;if(i==="mesh"){this._getDrawMeshHelpMessage||k(()=>import("./helpMessageUtils3d-D44teqP4.js"),[]).then(o=>{this._getDrawMeshHelpMessage=o.getDrawMeshHelpMessage});const{view:s}=e;return(s==null?void 0:s.type)==="3d"?(n=this._getDrawMeshHelpMessage)==null?void 0:n.call(this,r,s):void 0}return qje(i,r==null?void 0:r.geometry)}get layer(){var t;return(t=this.data.creationInfo)==null?void 0:t.layer}get numPendingFeatures(){return this.pendingFeatures.length}get parent(){return this.data.parent}get parentLayer(){var t;return(t=this.parent)==null?void 0:t.data.editorItem.layer}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return this.numPendingFeatures===0}get reliesOnOwnerAdminPrivileges(){var t;return((t=this.data.editorItem)==null?void 0:t.capabilities.create.reliesOnOwnerAdminPrivileges)??!1}get shouldShowAttachments(){var t;return((t=this.data.editorItem)==null?void 0:t.capabilities.create.attachments.enabled)??!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get sketchViewModel(){return this._sketchViewModel}get test(){}async enter(){this._isActive=!0,this.stepId!=="awaiting-feature-creation-info"&&this._setUpCreatingFeaturesStep()}exit(){this._isActive=!1,this.removeHandles([yI])}async updatePendingFeature(t,e){return this._preventDefaultActionOnCancel=!0,this._sketchViewModel.cancel(),RS(this._lastActiveGraphics,t),this._startUpdating({feature:t,webStyleCache:e})}async start(){var t;return await super.start(),wy((t=this.data.creationInfo)==null?void 0:t.layer)?null:{enter:async()=>{},exit:async()=>{},viewModel:this._sketchViewModel}}static create(t){const{addAttachmentsCallback:e,applyEditsCallback:i,isNested:r,creationInfo:n,parent:s,snappingManager:o,startAt:a,viewModel:u}=t,d=t.sketchOptions??new Lm,p=n==null?void 0:n.layer,h=p?u.findEditorItemForLayer(p):void 0,m=new yM({data:new Dl({creationInfo:n,editorItem:h,parent:s,sketchOptions:d,snappingManager:o,viewModel:u}),isNested:r,onCommit:async y=>{var T;const{creationInfo:g}=y;if(!g)return;const v=y.pendingFeatures.toArray(),{layer:_}=g,w=((T=_.capabilities)==null?void 0:T.editing.supportsGlobalId)&&"globalIdField"in _,S=m._attachmentFileInfos;if(w){const M=DGe(v,_,S);return void await i(_,M,{globalIdUsed:!0})}const E=await i(_,{addFeatures:v});if(S.size>0){const M=(E==null?void 0:E.addFeatureResults)??[];await e(_,NGe(v,M,_,S))}}});return m._set("steps",this._createWorkflowSteps(m,a)),m}_fadeExistingFeatures(t){if("effect"in t){const i=t.effect;return t.effect="saturate(0.6) opacity(0.8)",ye(()=>t.effect=i)}const e=t.opacity;return t.opacity=.7,ye(()=>t.opacity=e)}_highlight(t){const e=this.data.viewModel.view;(e==null?void 0:e.type)==="3d"&&this._highlightHandles.set(t,e.highlight(t))}_removeHighlight(t){Kt(this._highlightHandles.get(t)),this._highlightHandles.delete(t)}async _startCreating(t){this.removeHandles(Bg);const{creationInfo:e}=this.data;if(!e)return;this.createFeatureState="create-new";const i=await pGe(this._sketchViewModel,e,t);this.addHandles(i,Bg)}async _startUpdating({feature:t,webStyleCache:e,initialFeature:i=t}){var w;const{data:r,pendingFeatures:n}=this;n.includes(t)||r.addPendingFeature(t,i);const{_featureFormViewModel:s,_sketchViewModel:o}=this,{creationInfo:a,viewModel:u}=r,{attachmentsViewModel:d,layerInfos:p,view:h}=u;if(!h||!a)return;const m=a.layer,y=hGe(p,m),g=y==null?void 0:y.formTemplate,v=h.spatialReference;if(s.set({arcadeEditType:"INSERT",feature:t,formTemplate:g,spatialReference:v,map:h.map}),d.mode!=="add"&&d.mode!=="edit"||((w=u.activeWorkflow)==null||w.previous()),d.graphic=t,d.fileInfos.removeAll(),d.mode="view",(this._attachmentFileInfos.get(t)||[]).forEach(({file:S,form:E})=>d.addFile(S,E)),this._removeHighlight(t),await ap(t,e,h.type==="2d"?h.scale:null),this.removeHandles(Bg),Kt(this._featureFormHandle),h.type==="2d"){const S=N(()=>h.scale,E=>this._updateGraphicDebounced(t,e,E));this.addHandles(S,Bg)}const _=r.getEditsForPendingFeature(t);return this._featureFormHandle=kr([s.on("value-change",async()=>{_==null||_.updateAttributes(s.getValues()),await ap(t,e,h.type==="2d"?h.scale:null)}),o.on(["update","undo","redo"],S=>{(S.type==="undo"||S.type==="redo"||S.type==="update"&&S.toolEventInfo!=null&&nle(S.toolEventInfo.type))&&s.notifyFeatureGeometryChanged()}),N(()=>{var S;return(S=s.feature)==null?void 0:S.sourceLayer},S=>t.sourceLayer=S)]),this.createFeatureState="update-pending",this._visualVariableAttributes=BU(t),wy(m)?void 0:pD({graphic:t,sketchViewModel:o,sourceLayer:m,visualVariables:this._visualVariableAttributes,webStyleCache:e})}static _createWorkflowSteps(t,e="awaiting-feature-creation-info"){const{data:i}=t,r=rle(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){const{creationInfo:n,viewModel:s}=i,{view:o}=s;o&&(OS(n)?t.addHandles(await MGe({view:o,data:i,next:()=>t.next(),cancel:()=>s.cancelWorkflow({warnIfNoWorkflow:!1})}),this.id):(i.parent&&n&&(t.addHandles(s.lockFeatureTemplatesViewModel(),this.id),s.featureTemplatesViewModel.layers=[n.layer]),t.addHandles(s.featureTemplatesViewModel.on("select",({item:a})=>{a&&(i.creationInfo={...i.creationInfo,layer:a.layer,template:a.template},t.next())}),this.id)))},async tearDown(){t.removeHandles([this.id,Bg])}}),"creating-features":()=>({id:"creating-features",async setUp(){t._isActive&&await t._setUpCreatingFeaturesStep()},async tearDown(n){const{viewModel:s}=i;n.canceled&&(t.removeHandles([yI,vO,Bg]),s.attachmentsViewModel.fileInfos.removeAll(),t._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:n}=i.viewModel,{graphic:s,fileInfos:o}=n;t._attachmentFileInfos.set(s,o.toArray()),n.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:n}=i.viewModel,{graphic:s,fileInfos:o}=n;t._attachmentFileInfos.set(s,o.toArray()),n.mode="view"}})});return EGe(i,r)}static _configureSketchViewModel(t,e){const{data:i}=t,{creationInfo:r,viewModel:n}=i,{view:s}=n,o=t._sketchViewModel;let a=null;const u=[];if(!s)return ye();s.type==="2d"&&r&&u.push(t._fadeExistingFeatures(r.layer));const d=async g=>{if(g.state==="cancel"){if(t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);if(t._lastActiveGraphics.length<1)return t._startCreating(e);const v=t._lastActiveGraphics.pop();return t._startUpdating({feature:v,webStyleCache:e})}if(g.state==="complete"&&g.graphic){const v=g.graphic.clone();return v.geometry=null,t._startUpdating({feature:g.graphic,webStyleCache:e,initialFeature:v})}},p=async g=>{var x;const{attachmentsViewModel:v}=n,{_featureFormViewModel:_}=t,w=g.graphics[0];if(g.state==="complete"){w!==a&&(t._lastActiveGraphics.push(w),t._highlight(w)),a=null;const{hasPendingSubtypeChoice:C,submittable:O}=_;if(t.numPendingFeatures===(r==null?void 0:r.maxFeatures)||C||!O){!O&&_.submit();const F=t._lastActiveGraphics.pop();return t._startUpdating({feature:F,webStyleCache:e})}if(v.mode!=="add"&&v.mode!=="edit"||((x=n.activeWorkflow)==null||x.previous()),g.aborted&&t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);t.addHandles([mD(s),s.on("click",F=>F.preventDefault())],vO),await wi(()=>!_.updating),t.removeHandles(vO),t._startCreating(e)}g.state==="start"&&t._removeHighlight(w);const S=t._visualVariableAttributes;await ile(s,w,g,S,e);const E=w.attributes,{rotation:T,size:M}=S;if(T!=null){const{field:C}=T;_.setValue(C,E[C])}if(M!=null){const{field:C}=M;_.setValue(C,E[C])}},h=g=>{const v=g.graphics[0];i.removePendingFeature(v),RS(t._lastActiveGraphics,v),a=v},m=async g=>{if(OS(r))return;const{results:v}=await s.hitTest(g,{include:o.layer}),_=v.find(S=>S.type==="graphic"&&S.graphic.sourceLayer===(r==null?void 0:r.layer));if(!_)return;const w=_.graphic;if(o.activeTool==="transform"||o.activeTool==="reshape"){if(o.updateGraphics.at(0)===w)return;const{submittable:S,hasPendingSubtypeChoice:E}=t._featureFormViewModel;if(!S||E)return;await t.updatePendingFeature(w,e)}};u.push(o.on("create",g=>t._updatingHandles.addPromise(d(g))),o.on("update",g=>t._updatingHandles.addPromise(p(g))),o.on("delete",g=>h(g)),s.on("immediate-click",g=>t._updatingHandles.addPromise(m(g)),yt.TOOL),ye(()=>{t._preventDefaultActionOnCancel=!0,o.cancel()}),FGe(o,i));const y=kr(u);return o.addHandles(y),y}_initializeSketchViewModel(){var n;const{data:t}=this,{view:e}=t.viewModel,i=new vE({elevationInfo:(n=t.creationInfo)==null?void 0:n.layer.elevationInfo,internal:!0,listMode:"hide"}),r=new nL({layer:i,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:e});this._sketchViewModel=r,e==null||e.map.add(i),this.addHandles(ye(()=>{e!=null&&e.destroyed||(e==null||e.map.remove(i)),i.destroy()}))}async _setUpCreatingFeaturesStep(){var v;if(this.hasHandles(yI))return;const{data:t}=this,{creationInfo:e,viewModel:i}=t,{attachmentsViewModel:r,view:n}=i;if(!n||!(e!=null&&e.layer))throw new L("missing-parameters","CreateFeaturesWorkflow requires a view and creationInfo.");const{initialFeature:s,layer:o}=e,a=this._sketchViewModel,u=new Map,d=[];this._lastActiveGraphics=[],this._featureFormHandle=Kt(this._featureFormHandle),this._visualVariableAttributes={rotation:null,size:null},this.data.editorItem=i.findEditorItemForLayer(e.layer),IGe(r),d.push(N(()=>r.mode,_=>{switch(_){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}}));const p=mD(n);d.push(p);const h=wy(e.layer);try{if(h){const _=s??new Li({attributes:{...(v=e.template)==null?void 0:v.prototype.attributes,...e.attributeOverrides},sourceLayer:o});await this._startUpdating({feature:_,webStyleCache:u})}else d.push(yM._configureSketchViewModel(this,u)),s?(a.layer.add(s),await this._startUpdating({feature:s,webStyleCache:u})):await this._startCreating(u)}finally{p.remove()}const m=ye(()=>{for(const _ of t.pendingFeatures)a.layer.remove(_),t.removePendingFeature(_)}),y=N(()=>n==null?void 0:n.timeZone,_=>this._featureFormViewModel.timeZone=_,be),g=ye(()=>{OS(e)&&i.cancelWorkflow({warnIfNoWorkflow:!1})});this._featureFormHandle&&d.push(this._featureFormHandle),this.addHandles(d,this._handleKeys.beforeCommit),this.addHandles([ye(()=>r.fileInfos.removeAll()),kr(d),g,m,y],yI)}};function FGe(t,e){let i=null;const r=()=>t.snappingOptions.featureSources,n=()=>(i=new Jk({layer:t.layer}),r().add(i),i),s=()=>{i!=null&&(r().remove(i),i=xe(i))};return kr([N(()=>{var u;const o=(u=e.creationInfo)==null?void 0:u.layer,a=r().find(d=>d.layer===o);return{hasFeatureLayerSource:!!a,enabled:(a==null?void 0:a.enabled)??!1}},({hasFeatureLayerSource:o,enabled:a})=>{if(!o)return s();i??(i=n()),i.enabled=a},gt),ye(s)])}function NGe(t,e,i,r){const n=[];return e.forEach((s,o)=>{if(!s.error){const a=t[o],u=r.get(a)||[];a.attributes[i.objectIdField]=s.objectId,u.forEach(({form:d})=>n.push({feature:a,attachment:d}))}}),n}function DGe(t,e,i){const r=[],n=e.globalIdField;return t.forEach((s,o)=>{var a;(a=t[o].attributes)[n]??(a[n]=d8()),((i==null?void 0:i.get(s))||[]).forEach(({file:u})=>r.push({feature:s,attachment:{globalId:d8(),data:u}}))}),r.length?{addFeatures:t,addAttachments:r}:{addFeatures:t}}l([c()],un.prototype,"createFeatureState",void 0),l([c()],un.prototype,"data",void 0),l([c({constructOnly:!0})],un.prototype,"isNested",void 0),l([c()],un.prototype,"featureFormViewModel",null),l([c()],un.prototype,"hasPendingEdits",null),l([c()],un.prototype,"_getDrawMeshHelpMessage",void 0),l([c()],un.prototype,"helpMessage",null),l([c()],un.prototype,"layer",null),l([c()],un.prototype,"parent",null),l([c()],un.prototype,"parentLayer",null),l([c()],un.prototype,"keyboardCancellationEnabled",null),l([c()],un.prototype,"reliesOnOwnerAdminPrivileges",null),l([c()],un.prototype,"shouldShowAttachments",null),l([c()],un.prototype,"shouldAllowAttachmentEditing",null),l([c()],un.prototype,"sketchViewModel",null),un=yM=l([$("esri.widgets.Editor.CreateFeaturesWorkflow")],un);const ole=un;function qU(t){return t&&typeof t.highlight=="function"}function VGe(t,e,i){return t==null||t>=i&&(e===0||t<=e)}function UGe(t,e){if(e&&t){const{minScale:i,maxScale:r}=t;if(jGe(i,r))return VGe(e,i,r)}return!0}function jGe(t,e){return t!=null&&t>0||e!=null&&e>0}function iat(t){return!(t!=null&&t.minScale)||!t.maxScale||t.minScale>=t.maxScale}let gM=class extends q{constructor(e){super(e),this.view=null}add(e){const i=!e||Array.isArray(e)?e:[e];i!=null&&i.length&&i.forEach(r=>this._highlight(r))}remove(e){const i=!e||Array.isArray(e)?e:[e];i!=null&&i.length&&i.forEach(r=>this._removeHighlight(r))}removeAll(){this.removeAllHandles()}_highlight(e){const i=OGe(this.view,e.layer);qU(i)&&this.addHandles(i.highlight(e),dq(e))}_removeHighlight(e){e&&this.removeHandles(dq(e))}};l([c()],gM.prototype,"view",void 0),gM=l([$("esri.views.draw.support.HighlightHelper")],gM);const ale=gM;var vM;let Ju=vM=class extends q{constructor(t){super(t),this.editorItem=null,this.edits=null,this.parent=null,this.relatedRecordCallbacks=null,this.viewModel=null}get attachmentsCapabilities(){const t=this.editorItem.capabilities.update.attachments.enabled;return{editing:!0,operations:{add:t,update:t,delete:t}}}get formTemplate(){return this.editorItem.formTemplate}static async create(t){const e=vM._makeConstructorProps(t);return new vM(e)}static _makeConstructorProps(t){const{feature:e,parent:i,relatedRecordCallbacks:r,viewModel:n}=t,s=n.editorItems.find(o=>o.layer===e.layer);if(!s)throw new L("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified Graphic's layer");return{editorItem:s,edits:new dc({feature:e}),parent:i,relatedRecordCallbacks:r,viewModel:n}}};l([c()],Ju.prototype,"attachmentsCapabilities",null),l([c({constructOnly:!0})],Ju.prototype,"editorItem",void 0),l([c()],Ju.prototype,"edits",void 0),l([c()],Ju.prototype,"formTemplate",null),l([c()],Ju.prototype,"parent",void 0),l([c()],Ju.prototype,"relatedRecordCallbacks",void 0),l([c()],Ju.prototype,"viewModel",void 0),Ju=vM=l([$("esri.widgets.Editor.UpdateRecordWorkflowData")],Ju);const lle=Ju;var bM;let s0=bM=class extends lle{constructor(t){super(t),this.sketchOptions=null,this.snappingManager=null}static async create(t){const{feature:e,snappingManager:i,viewModel:r}=t,n=t.sketchOptions??new Lm,{view:s}=r;if(!s)throw new L("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");const o=await Jb(s,e.layer);return new bM({...bM._makeConstructorProps(t),layerView:o,sketchOptions:n,snappingManager:i})}};l([c()],s0.prototype,"layerView",void 0),l([c({constructOnly:!0})],s0.prototype,"sketchOptions",void 0),l([c()],s0.prototype,"snappingManager",void 0),s0=bM=l([$("esri.widgets.Editor.UpdateFeatureWorkflowData")],s0);const GGe=s0;var fD;const yD={exit:Symbol()};let $s=fD=class extends HU{constructor(t){super(t),this._highlightHelper=null,this.fullFeature=null,this.type="update-table-record"}initialize(){const{data:t}=this,{edits:e}=t,{view:i}=t.viewModel,r=e.feature,n=new AbortController;this.addHandles(Jde(n)),this._updatingHandles.addPromise(gGe(r,t.viewModel.view.spatialReference,n.signal).then(s=>{lo(n)||(this._onFullFeatureLoaded(s),this._initializeFeatureFormViewModel())},s=>this.cancel({force:!0,error:new L("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:s}})}))),i&&(this._highlightHelper=new ale({view:i}),this.addHandles(ye(()=>{var s;return(s=this._highlightHelper)==null?void 0:s.removeAll()})))}get editorItem(){return this.data.editorItem}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){return this.data.edits.modified}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get parentLayer(){var t;return(t=this.parent)==null?void 0:t.data.editorItem.layer}get shouldShowAttachments(){return this.editorItem.capabilities.attachments.enabled}get shouldAllowAttachmentEditing(){return this.editorItem.capabilities.update.attachments.enabled}get reliesOnOwnerAdminPrivileges(){const t=this.editorItem.capabilities;return t.update.reliesOnOwnerAdminPrivileges||t.delete.reliesOnOwnerAdminPrivileges}async deleteAndCommit(){return this.data.edits.stageDelete(),this.commit()}async enter(){this._configureAttachmentsViewModel()}exit(t){this.removeHandles(yD.exit)}async start(){return await super.start(),null}_configureAttachmentsViewModel(){const{data:t,fullFeature:e}=this,{attachmentsCapabilities:i,viewModel:r}=t,{attachmentsViewModel:n}=r;n.set({capabilities:i,graphic:e,filesEnabled:!1,mode:"view"}),this.addHandles([ye(()=>n.fileInfos.removeAll()),N(()=>n.mode,s=>{switch(s){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}})],yD.exit)}_initializeFeatureFormViewModel(){const{edits:t,formTemplate:e,viewModel:{view:i}}=this.data,r=this._featureFormViewModel=new pU({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:e,highlightHelper:this._highlightHelper,map:i==null?void 0:i.map,spatialReference:i.spatialReference,timeZone:i==null?void 0:i.timeZone});r.relatedRecordCallbacks={...this.data.relatedRecordCallbacks,showAllRelatedRecords:s=>r.relationshipId=s.relationshipId};const{initialFeature:n}=t;n&&r.overrideInitialFeature(n),this.addHandles([r.on("value-change",()=>{t.updateAttributes(r.getValues()),this.fullFeature.attributes=t.feature.attributes}),N(()=>i==null?void 0:i.timeZone,s=>r.timeZone=s)])}_onFullFeatureLoaded(t){this.fullFeature=t;const{edits:e}=this.data;e.updateAttributes(t.attributes),e.trackChanges()}static async create(t){const e=new fD({data:await lle.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}static _createWorkflowSteps(t){const{attachmentsViewModel:e}=t.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){e.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){e.mode="view"}}]}};$s._onCommitFactory=t=>async e=>{var a;const{edits:i}=e,{feature:r}=i;if(!r)return;const n=r.sourceLayer,s=r.clone();if(!i.attributesModified||i.stagedForDelete){const u=n.objectIdField;if(s.attributes={[u]:r.getAttribute(u)},n.type==="scene"&&n.infoFor3D!=null){const d=(a=n.associatedLayer)==null?void 0:a.globalIdField;d!=null&&s.setAttribute(d,r.getAttribute(d))}}i.geometryModified&&!i.stagedForDelete||(s.geometry=null);const o=i.stagedForDelete?"deleteFeatures":"updateFeatures";await t(n,{[o]:[s]})},l([c()],$s.prototype,"editorItem",null),l([c()],$s.prototype,"featureFormViewModel",null),l([c()],$s.prototype,"fullFeature",void 0),l([c()],$s.prototype,"hasPendingEdits",null),l([c()],$s.prototype,"layer",null),l([c()],$s.prototype,"parent",null),l([c()],$s.prototype,"parentLayer",null),l([c()],$s.prototype,"shouldShowAttachments",null),l([c()],$s.prototype,"shouldAllowAttachmentEditing",null),l([c()],$s.prototype,"reliesOnOwnerAdminPrivileges",null),$s=fD=l([$("esri.widgets.Editor.UpdateRecordWorkflow")],$s);var gD;const ml={...yD,highlights:Symbol(),sketchGraphics:Symbol(),sketchViewModel:Symbol()};let o0=gD=class extends $s{constructor(t){super(t),this.type="update-feature",this._layerViewEditSession=null,this._sketchGraphicClone=null,this._sketchViewModel=null,this._webStyleCache=new Map}destroy(){var t;(t=this._layerViewEditSession)==null||t.rollback()}async commit(){this.removeHandles(ml.sketchGraphics);try{const t=this.data.edits.stagedForDelete;await super.commit();const e=this._layerViewEditSession;t?e==null||e.rollback():e==null||e.commit()}catch(t){throw await this._configureSketchViewModel(),new L("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:t})}}async start(){return await super.start(),await this._initializeSketchViewModel()}_initializeFeatureFormViewModel(){super._initializeFeatureFormViewModel(),this.addHandles([this._featureFormViewModel.on("value-change",t=>{var e;(e=this._layerViewEditSession)==null||e.setAttribute(t.fieldName,t.value)}),N(()=>{var t;return(t=this._featureFormViewModel.feature)==null?void 0:t.sourceLayer},t=>this._sketchGraphicClone.sourceLayer=t)])}_configureHighlight(){const{edits:t,layerView:e}=this.data;qU(e)&&this.addHandles(e.highlight(t.feature),ml.highlights)}async _configureSketchViewModel(){const t=this._sketchViewModel;if(!t)return;const{data:e,_featureFormViewModel:i,_sketchGraphicClone:r}=this,{edits:n,viewModel:s}=e,o=n.feature,{view:a}=s,u=BU(o),d=await _Ge({feature:o,featureClone:r,visualVariableAttributes:u,sketchViewModel:t,view:a,onUpdate:({geometry:p,attributes:h},m)=>{if(n.updateAttributes(h),n.updateGeometry(p),i.feature&&(i.feature.geometry=p),u.rotation!=null){const{field:y}=u.rotation;i.setValue(y,h[y])}if(u.size!=null){const{field:y}=u.size;i.setValue(y,h[y])}(m.type==="undo"||m.type==="redo"||m.type==="update"&&m.toolEventInfo!=null&&nle(m.toolEventInfo.type))&&i.notifyFeatureGeometryChanged()},webStyleCache:this._webStyleCache});this.addHandles(d,ml.sketchGraphics),t.addHandles(d)}async _initializeSketchViewModel(){const{data:t,_sketchGraphicClone:e}=this,i=t.edits.feature,{capabilities:r,layer:n}=t.editorItem,{view:s}=t.viewModel;if(this.removeHandles([ml.highlights,ml.sketchGraphics,ml.sketchViewModel]),!r.update.geometry||(s==null?void 0:s.type)==="3d"&&bE(n.elevationInfo))return{enter:async()=>{this.hasHandles(ml.highlights)||this._configureHighlight()},exit:()=>this.removeHandles([ml.highlights])};const o=new vE({elevationInfo:n.elevationInfo,internal:!0,listMode:"hide"}),a=new nL({allowDeleteKey:!1,layer:o,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:s});return this._sketchViewModel=a,s==null||s.map.add(o),this.addHandles(ye(()=>{s!=null&&s.destroyed||(s==null||s.map.remove(o)),o.destroy(),this._sketchViewModel=xe(a)}),ml.sketchViewModel),await ap(e,this._webStyleCache,(s==null?void 0:s.type)==="2d"?s.scale:null),this.addHandles([await wGe(a,i,e)]),{enter:async()=>{this.hasHandles(ml.sketchGraphics)||await this._configureSketchViewModel()},exit:()=>this.removeHandles([ml.sketchGraphics]),viewModel:a}}_onFullFeatureLoaded(t){super._onFullFeatureLoaded(t);const e=this._sketchGraphicClone=hD(t),{edits:i,layerView:r}=this.data;i.updateGeometry(t.geometry),i.trackChanges(),xGe(r)&&(this._layerViewEditSession=r.createInteractiveEditSession(e))}static async create(t){const e=new gD({data:await GGe.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}get test(){}};l([c()],o0.prototype,"_layerViewEditSession",void 0),l([c()],o0.prototype,"_sketchGraphicClone",void 0),l([c()],o0.prototype,"_sketchViewModel",void 0),o0=gD=l([$("esri.widgets.Editor.UpdateFeatureWorkflow")],o0);let Yu=class extends q{constructor(e){super(e),this.addAttachmentsCallback=null,this.applyEditsCallback=null,this.candidates=null,this.rootFeature=null,this.sketchOptions=null,this.snappingManager=null,this.viewModel=null}};l([c()],Yu.prototype,"addAttachmentsCallback",void 0),l([c()],Yu.prototype,"applyEditsCallback",void 0),l([c()],Yu.prototype,"candidates",void 0),l([c()],Yu.prototype,"rootFeature",void 0),l([c({constructOnly:!0})],Yu.prototype,"sketchOptions",void 0),l([c()],Yu.prototype,"snappingManager",void 0),l([c()],Yu.prototype,"viewModel",void 0),Yu=l([$("esri.widgets.Editor.UpdateWorkflowData")],Yu);const zGe=Yu;var vD;const ule="esri.widgets.Editor.UpdateWorkflow",BGe=()=>U.getLogger(ule);let $n=vD=class extends HU{constructor(t){super(t),this._workflowStack=new Nb(Qj),this._sketchStack=new Nb(Qj),this.data=void 0,this.type="update"}get activeEditorItem(){var t;return((t=this.activeWorkflow)==null?void 0:t.data.editorItem)??void 0}get activeFeatureFormViewModel(){var t;return(t=this.activeWorkflow)==null?void 0:t.featureFormViewModel}get activeSketchViewModel(){var t;return(t=this._sketchStack.peek())==null?void 0:t.viewModel}get activeWorkflow(){return this._workflowStack.last()}get hasPreviousStep(){var t;return this._stepIndex>0||this.nestedWorkflowCount>1||((t=this.activeWorkflow)==null?void 0:t.featureFormViewModel.relationshipId)!=null||this.data.viewModel.attachmentsViewModel.mode!=="view"}get hasUpdatableCandidates(){const{candidates:t,viewModel:e}=this.data;return t.some(({layer:i})=>{var r;return(r=e.findEditorItemForLayer(i))==null?void 0:r.supportsUpdateWorkflow})}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){var t;return!!((t=this.activeEditorItem)!=null&&t.capabilities.attachments.enabled)}get shouldAllowAttachmentEditing(){var t;return!!((t=this.activeEditorItem)!=null&&t.capabilities.update.attachments.enabled)}get hasPendingEdits(){return Array.from(this._workflowStack).some(t=>t.hasPendingEdits)}get helpMessage(){var t;return(t=this.activeWorkflow)!=null&&t.helpMessage?this.activeWorkflow.helpMessage:this.stepId==="awaiting-feature-to-update"?"select":void 0}get reliesOnOwnerAdminPrivileges(){var t;return((t=this.activeWorkflow)==null?void 0:t.reliesOnOwnerAdminPrivileges)??!1}get hasInvalidFormTemplate(){var t;return!!((t=this.activeEditorItem)!=null&&t.hasInvalidFormTemplate)}async back(t=()=>Promise.resolve(!0)){const{activeWorkflow:e}=this;if((e==null?void 0:e.featureFormViewModel.relationshipId)==null)if(e){if(e.hasPendingEdits&&!await t())return;e.hasPreviousStep?await e.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0});else e.featureFormViewModel.relationshipId=null}async cancelActiveWorkflow(t){var e;await((e=this.activeWorkflow)==null?void 0:e.cancel(t)),await this._popWorkflow()}async commit(){await this._drainWorkflowStack(t=>t.commit()),await super.commit()}static create(t){const{viewModel:e,snappingManager:i,startAt:r,addAttachmentsCallback:n,applyEditsCallback:s}=t,o=t.sketchOptions??new Lm,a=new vD({data:new zGe({addAttachmentsCallback:n,applyEditsCallback:s,sketchOptions:o,snappingManager:i,viewModel:e}),onCommit:async()=>{}});return a._set("steps",this._createWorkflowSteps(a,r)),a}async save(){var t;this.nestedWorkflowCount>1?(await((t=this.activeWorkflow)==null?void 0:t.commit()),await this._popWorkflow()):await this.commit()}async startCreatingRelatedRecord(t){try{const e=await this._createNestedCreateFeaturesWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new L("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:e})}}async startUpdating(t){try{const e=await this._createNestedUpdateWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new L("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:e})}}async deleteActiveFeature(){const{activeWorkflow:t}=this;if(!t)throw new L("editor:nothing-to-delete","There is no feature to delete");HGe(t)?await t.deleteAndCommit():await t.cancel(),this.nestedWorkflowCount===1?await this.reset():await this._popWorkflow()}async cancelAll(){await this._drainWorkflowStack(t=>t.cancel({force:!0}))}async _createNestedCreateFeaturesWorkflow(t){var p;const{relatedLayer:e}=t,{addAttachmentsCallback:i,applyEditsCallback:r,sketchOptions:n,snappingManager:s,viewModel:o}=this.data;if(!YS(e))throw new L("editor:unsupported-layer","Editing is not supported on the provided layer");const a=this._getCreationInfoForNestedCreateFeaturesWorkflow(t),u=a.template||a.initialFeature?"creating-features":"awaiting-feature-creation-info",d=((p=this.activeWorkflow)==null?void 0:p.type)!=="create-features"?this.activeWorkflow:void 0;return ole.create({addAttachmentsCallback:i,applyEditsCallback:r,creationInfo:a,isNested:!0,parent:d,sketchOptions:n,snappingManager:s,startAt:u,viewModel:o})}_getCreationInfoForNestedCreateFeaturesWorkflow(t){const{relatedLayer:e}=t;if(!YS(e)||DV(e))throw new L("editor:unsupported-layer","Editing is not supported on the provided layer");const i={layer:e,maxFeatures:1},r=this._makeRelatedRecordAttributes(t),n=tC(e);return(n==null?void 0:n.length)>0?(i.attributeOverrides=r,n.length===1&&(i.template=n[0])):i.initialFeature=new Li({sourceLayer:e,attributes:r}),i}async _createNestedUpdateWorkflow(t){var u;const e=wy(t.sourceLayer)?$s:o0,{applyEditsCallback:i,sketchOptions:r,snappingManager:n,viewModel:s}=this.data,o=((u=this.activeWorkflow)==null?void 0:u.type)!=="create-features"?this.activeWorkflow:void 0,a=await e.create({feature:t,parent:o,sketchOptions:r,snappingManager:n,viewModel:s,applyEdits:i,relatedRecordCallbacks:{addRelatedRecord:async d=>await this.startCreatingRelatedRecord(d),editRelatedRecord:async({relatedFeature:d})=>await this.startUpdating(d)}});return await wi(()=>!a.updating),a}async _drainWorkflowStack(t){const e=this._workflowStack,i=[];for(;e.length>0;){const r=e.pop();this._sketchStack.pop();const n=t(r).then(()=>r.destroy());this._updatingHandles.addPromise(n),i.push(n)}await Promise.all(i)}_makeRelatedRecordAttributes(t){var p,h;const{parentFeature:e,relatedLayer:i,relationshipId:r}=t;if(!ODe(e))return;const n=(p=i.relationships)==null?void 0:p.find(m=>m.id===r);if(!n)return void dw("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.");if(n.role==="origin")return void dw("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");const s=e.sourceLayer;n.relatedTableId!==s.layerId&&dw("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");const o=(h=s.relationships)==null?void 0:h.find(m=>m.id===r);if(!o)return void dw("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.");const a=E7(s,o),u=e.getAttribute(a);return u||dw("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[E7(i,n)]:u}}async _popWorkflow(){var e;(e=this._workflowStack.pop())==null||e.destroy(),this._sketchStack.pop();const t=await this._reconcileWorkflowStack();if(t.failureCount>0)throw new L("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",t)}async _pushWorkflow(t){var o;const e=this._workflowRequiresSketchViewModel(t);(o=this.activeWorkflow)==null||o.exit({removeSketchHandles:e});const i=this._sketchStack,r=await(t==null?void 0:t.start()),n=i.peek();r?(n==null||n.exit(),i.push(r)):i.push(this._cloneSketchController(n)),this._workflowStack.push(t);const s=await this._reconcileWorkflowStack();if(s.failureCount>0)throw new L("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",s)}async _reconcileWorkflowStack(){var i;const t=this._workflowStack,e=this._sketchStack;try{const r=t.peek();return await(r==null?void 0:r.enter()),await((i=e.peek())==null?void 0:i.enter()),{activeWorkflow:r,failureCount:0}}catch{t.pop().destroy(),e.pop();const{activeWorkflow:n,failureCount:s}=await this._reconcileWorkflowStack();return{activeWorkflow:n,failureCount:s+1}}}_cloneSketchController(t){return{enter:(t==null?void 0:t.enter)??(async()=>{}),exit:(t==null?void 0:t.exit)??(async()=>{}),viewModel:t==null?void 0:t.viewModel}}_workflowRequiresSketchViewModel(t){var i;const{type:e}=t;return e==="update-feature"||e==="create-features"&&!wy((i=t.data.creationInfo)==null?void 0:i.layer)}static _createWorkflowSteps(t,e="awaiting-feature-to-update"){const{data:i}=t;return rle(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const{spinnerViewModel:r}=i.viewModel,n=i.viewModel.view;let s=null;t.addHandles(ye(()=>{s=mr(s)}),this.id),i.rootFeature=null,i.candidates=[];const o=n.on("immediate-click",async a=>{r.location=a.mapPoint,r.visible=!0,s==null||s.abort();const{editorItems:u}=i.viewModel;s=new AbortController;const d=await a.async(()=>new Promise((p,h)=>{ks(s==null?void 0:s.signal,()=>h(mt())),p(mGe(u,n,a,s==null?void 0:s.signal))}));qe(s),i.candidates=d.filter(p=>p.status==="fulfilled").flatMap(p=>p.value).filter(p=>!p.isAggregate),r.visible=i.candidates.length===1,i.candidates.length!==0&&(a.stopPropagation(),i.candidates.length===1?(i.rootFeature=i.candidates[0],t.go("editing-existing-feature").catch(()=>{}).then(()=>r.visible=!1)):t.next())},yt.TOOL);n.focus(),t.addHandles(o,this.id)},async tearDown(){i.candidates.length===0&&(i.viewModel.spinnerViewModel.visible=!1),t.removeHandles(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){i.rootFeature=null;const{view:r}=i.viewModel;if(!r)return;const n=new ale({view:r});t.addHandles([N(()=>i.rootFeature,(s,o)=>{n.remove(o),n.add(s)},yn),ye(()=>n.removeAll())],this.id)},async tearDown(){t.removeHandles(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const{rootFeature:r,viewModel:n}=t.data;if(!r)throw new L("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await t.startUpdating(r),n.spinnerViewModel.visible=!1;const s=Bo(async()=>{await wi(()=>!t.updating),t.previous()});t.addHandles([N(()=>t.nestedWorkflowCount,(o,a)=>{o===0&&a!==0&&s()},yn)],this.id)},async tearDown(){await t.cancelAll(),t.removeHandles(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}})})}};function E7(t,{keyField:e}){var i;return((i=t.getField(e))==null?void 0:i.name)??e}l([c()],$n.prototype,"activeEditorItem",null),l([c()],$n.prototype,"activeFeatureFormViewModel",null),l([c()],$n.prototype,"activeSketchViewModel",null),l([c()],$n.prototype,"activeWorkflow",null),l([c()],$n.prototype,"data",void 0),l([c()],$n.prototype,"hasPreviousStep",null),l([c()],$n.prototype,"hasUpdatableCandidates",null),l([c()],$n.prototype,"nestedWorkflowCount",null),l([c()],$n.prototype,"shouldShowAttachments",null),l([c()],$n.prototype,"shouldAllowAttachmentEditing",null),l([c()],$n.prototype,"hasPendingEdits",null),l([c()],$n.prototype,"helpMessage",null),l([c()],$n.prototype,"reliesOnOwnerAdminPrivileges",null),l([c()],$n.prototype,"hasInvalidFormTemplate",null),$n=vD=l([$(ule)],$n);const dw=(t,e)=>BGe().warn(`editor:${t}`,e,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature."),HGe=t=>!!t&&/update-/.test(t.type),qGe=$n;let Ys=class extends q{constructor(e){super(e),this.layer=null}get attachments(){var e;return{enabled:this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.data.supportsAttachment)}}get create(){var a;const{_effectiveCapabilities:e,layer:i}=this,r=this._createEnabled,n=r,s=(a=i.capabilities)==null?void 0:a.operations.supportsAdd,o=!!(e!=null&&e.operations.supportsAdd);return{attachments:{enabled:r&&this.attachments.enabled},attributes:r,enabled:r,geometry:n,reliesOnOwnerAdminPrivileges:!s&&o}}get delete(){var s;const{_effectiveCapabilities:e,layer:i}=this,r=(s=i.capabilities)==null?void 0:s.operations.supportsDelete,n=!!(e!=null&&e.operations.supportsDelete);return{enabled:this._effectiveEnabled&&!!(e!=null&&e.operations.supportsDelete),reliesOnOwnerAdminPrivileges:!r&&n}}get reliesOnOwnerAdminPrivileges(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}get update(){var d;const{_effectiveCapabilities:e,layer:i}=this,r=this._updateEnabled,n=!(!r||!(e!=null&&e.editing.supportsGeometryUpdate)),s=(d=i.capabilities)==null?void 0:d.operations.supportsUpdate,o=!!(e!=null&&e.operations.supportsUpdate),a=this.attachments.enabled,u=a&&this._canCreateOrUpdate;return{attachments:{enabled:a,create:u,update:u},attributes:r,enabled:r,geometry:n,reliesOnOwnerAdminPrivileges:!s&&o}}get _createEnabled(){var e;return this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.operations.supportsAdd)}get _updateEnabled(){var e;return this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.operations.supportsUpdate)}get _canCreateOrUpdate(){return!(!this._createEnabled&&!this._updateEnabled)}get _effectiveEnabled(){return mY(this.layer)}get _effectiveCapabilities(){return Uy(this.layer)}};l([c()],Ys.prototype,"attachments",null),l([c()],Ys.prototype,"create",null),l([c()],Ys.prototype,"delete",null),l([c()],Ys.prototype,"layer",void 0),l([c()],Ys.prototype,"reliesOnOwnerAdminPrivileges",null),l([c()],Ys.prototype,"update",null),l([c()],Ys.prototype,"_createEnabled",null),l([c()],Ys.prototype,"_updateEnabled",null),l([c()],Ys.prototype,"_canCreateOrUpdate",null),l([c()],Ys.prototype,"_effectiveEnabled",null),l([c()],Ys.prototype,"_effectiveCapabilities",null),Ys=l([$("esri.layers.support.EditingCapabilities")],Ys);const T7=Ys,WGe=[["binary","application/octet-stream","bin",""]];function oat(t,e){return hle(e.name,(t==null?void 0:t.supportedFormats)??[])!=null}function aat(t,e){if(!t)return!1;const i=ZGe(e,t.supportedFormats??[]);return i!=null&&t.editFormats.includes(i)}function lat(t){return oL((t==null?void 0:t.supportedFormats)??[]).flatMap(fle).map(e=>`.${e}`)}function cle(t,e){return WU(YGe(t,e))}function dle(t,e){return WU(hle(t,e))}function uat(t,e){return mle(JGe(t,e))}function ZGe(t,e){return dle(t.name,e)??cle(t.type,e)}function sL(t,e,i){return cle(t,i)??dle(e,i)}function ple({supportedFormats:t}){return sL("model/gltf-binary","glb",t)}function cat(t){const e=ple(t);return e!=null&&t.editFormats.includes(e)}function dat({supportedFormats:t}){return sL("model/gltf+json","gltf",t)}function pat({supportedFormats:t}){return sL("application/esri3do-SR_world","wld",t)}function hat({supportedFormats:t}){return sL("application/esri3do-SR_prj","prj",t)}function oL(t){return[...WGe,...t]}function JGe(t,e){return oL(e).find(i=>WU(i)===t)}function YGe(t,e){const i=t.toLowerCase();return oL(e).find(r=>mle(r)===i)}function hle(t,e){const i=t.toLowerCase();return oL(e).find(r=>fle(r).some(n=>i.endsWith(n)))}function WU(t){return t==null?void 0:t[0]}function mle(t){return t==null?void 0:t[1].toLowerCase()}function fle(t){return(t==null?void 0:t[2].split(",").map(e=>e.toLowerCase()))??[]}function mat(t){var e;return(e=t.tables)==null?void 0:e.find(i=>i.role==="assetMaps")}const Hg="esri.views.layers.support.editableLayerViews";function KGe(t,e){const{associatedLayer:i}=t,r=i==null?void 0:i.infoFor3D;if(!r)return!1;const n=ple(r);if(!(n!=null&&r.queryFormats.includes(n)))return U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because it does not support GLB queries.`),!1;const s=t.spatialReference,o=i.spatialReference;if(!ci(s,o))return U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because its spatial reference (wkid:${s.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${o.wkid}).`),!1;const a=i.sourceJSON.sourceSpatialReference;if(!(a==null||ci(a,o)))return U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${o.wkid}) is different from its source spatial reference (wkid:${a.wkid}).`),!1;const{view:u}=e;if(e.destroyed||u==null)return!1;const d=u.spatialReference,{viewingMode:p}=u.state,h=u_(s),m=p===mp.Global;return h&&!m?(U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${s.wkid}) is geographic. Please consider changing the viewing mode to global.`),!1):!h&&m?(U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${s.wkid}) is projected. Please consider changing the viewing mode to local.`),!1):!!(ci(s,d)||m&&el(d)&&hm(s))||(U.getLogger(Hg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because its spatial reference (wkid:${s.wkid}) does not match the view spatial reference (wkid:${d.wkid}).`),!1)}let Sa=class extends T7{constructor(e){super(e),this.layerInfo=null,this.layerView=null}get attachments(){const e=this.defaults.attachments.enabled,i=this.layerInfo;return{enabled:e&&(i==null?void 0:i.enabled)!==!1}}get create(){const{attachments:e,defaults:i,layerInfo:r,layer:n,layerView:s}=this,o=i.create,a=(r==null?void 0:r.enabled)!==!1&&(r==null?void 0:r.addEnabled)!==!1,u=o.enabled&&a;return{attributes:u&&o.attributes,enabled:u,geometry:u&&o.geometry&&I7(n,s),attachments:{enabled:e.enabled&&u&&(r==null?void 0:r.attachmentsOnCreateEnabled)!==!1},reliesOnOwnerAdminPrivileges:o.reliesOnOwnerAdminPrivileges}}get defaults(){return new T7({layer:this.layer})}get delete(){const{defaults:e,layerInfo:i}=this,r=e.delete,n=(i==null?void 0:i.enabled)!==!1&&(i==null?void 0:i.deleteEnabled)!==!1;return{enabled:r.enabled&&n,reliesOnOwnerAdminPrivileges:r.reliesOnOwnerAdminPrivileges}}get formTemplate(){const{layer:e,layerInfo:i}=this;return i!=null&&i.formTemplate?i.formTemplate:e&&"formTemplate"in e?e.formTemplate:null}get relationship(){var n,s,o;const{layer:e}=this,i=!(!yE(e)||!((n=e.relationships)!=null&&n.length)),r=!!((o=(s=this.formTemplate)==null?void 0:s.elements)!=null&&o.some(a=>a.type==="relationship"));return{enabled:i&&r}}get update(){const{attachments:e,defaults:i,layerInfo:r,layer:n,layerView:s}=this,o=i.update,a=(r==null?void 0:r.enabled)!==!1&&(r==null?void 0:r.updateEnabled)!==!1,u=o.enabled&&a,d=u&&o.attributes&&(r==null?void 0:r.attributeUpdatesEnabled)!==!1,p=u&&o.geometry&&(r==null?void 0:r.geometryUpdatesEnabled)!==!1&&I7(n,s),h=e.enabled&&(r==null?void 0:r.attachmentsOnUpdateEnabled)!==!1;return{attributes:d,enabled:u,geometry:p,attachments:{enabled:h,create:h&&o.attachments.create,update:h&&o.attachments.update},reliesOnOwnerAdminPrivileges:o.reliesOnOwnerAdminPrivileges}}};function I7(t,e){return t.type!=="scene"||e!=null&&"type"in e&&e.type==="scene-layer-3d"&&KGe(t,e)}l([c()],Sa.prototype,"attachments",null),l([c()],Sa.prototype,"create",null),l([c()],Sa.prototype,"defaults",null),l([c()],Sa.prototype,"delete",null),l([c()],Sa.prototype,"formTemplate",null),l([c()],Sa.prototype,"layerInfo",void 0),l([c()],Sa.prototype,"layerView",void 0),l([c()],Sa.prototype,"relationship",null),l([c()],Sa.prototype,"update",null),Sa=l([$("esri.widgets.Editor.support.EditorEditingCapabilities")],Sa);const XGe=Sa;let Wn=class extends q{constructor(e){super(e),this.disabled=!1,this.layer=null,this.layerInfo=null,this.layerView=null}get _suspended(){var e;return!!((e=this.layerView)!=null&&e.suspended)}get capabilities(){return new XGe({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}get editable(){const{create:e,relationship:i,update:r,delete:{enabled:n}}=this.capabilities,s=e.attachments.enabled||r.attachments.enabled;return!this.disabled&&(e.enabled||r.enabled||s||n||i.enabled)}get formTemplate(){return this.capabilities.formTemplate}get hasInvalidFormTemplate(){return lVe(this.layer,this.formTemplate)}get isTable(){return wy(this.layer)}get supportsCreateFeaturesWorkflow(){if(this.disabled)return!1;const{enabled:e,geometry:i}=this.capabilities.create;return this.isTable?e:e&&i}get supportsUpdateWorkflow(){const{capabilities:e}=this;return!this.disabled&&(e.update.enabled||e.update.attachments.enabled||e.delete.enabled)}get visible(){const{layer:e}=this,i=e.parent;return!this._suspended&&e.visible&&(!i||!("visible"in i)||i.visible)}};l([c()],Wn.prototype,"_suspended",null),l([c()],Wn.prototype,"capabilities",null),l([c()],Wn.prototype,"disabled",void 0),l([c()],Wn.prototype,"editable",null),l([c()],Wn.prototype,"formTemplate",null),l([c()],Wn.prototype,"hasInvalidFormTemplate",null),l([c()],Wn.prototype,"isTable",null),l([c()],Wn.prototype,"layer",void 0),l([c()],Wn.prototype,"layerInfo",void 0),l([c()],Wn.prototype,"layerView",void 0),l([c()],Wn.prototype,"supportsCreateFeaturesWorkflow",null),l([c()],Wn.prototype,"supportsUpdateWorkflow",null),l([c()],Wn.prototype,"visible",null),Wn=l([$("esri.widgets.Editor.support.EditorItem")],Wn);const QGe=Wn,yle="esri.widgets.Editor.EditorViewModel",e6e=()=>U.getLogger(yle),gle=["create-features","update"];function Bm(t,e,i){e6e().error(new L(t,e,i))}function t6e(t,e){return t==null?void 0:t.find(i=>i.layer===e)}let st=class extends ji.EventedAccessor{constructor(e){super(e),this._sketchEventListenerHandle=null,this._sketchGraphicsLayer=new vE({listMode:"hide",internal:!0}),this._snappingManager=null,this._updateItemsTask=null,this._updatingHandles=new Wo,this._featureTemplatesViewModelLocked=!1,this.activeWorkflow=null,this._activityQueue=new Y,this.editorItems=new Y,this.failures=[],this.hideTemplatesForInactiveLayers=!1,this.attachmentsViewModel=new lU({capabilities:{editing:!0}}),this.featureTemplatesViewModel=new rD({disabledItemFunction:({layer:i})=>this._itemIsSuspended(i)}),this.layerInfos=null,this.ownSketchViewModel=new nL({layer:this._sketchGraphicsLayer}),this.sketchOptions=new Lm,this.snappingOptions=new gg({attributeRulesEnabled:!0}),this.spinnerViewModel=new wU,this.pageStack=[],this.showDiscardEditsPrompt=()=>Promise.resolve(!0),this._candidateCommitted=!1,this.back=async()=>{var i;this.canGoBack&&((i=this.activeWorkflow)!=null&&i.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))},this.saveWorkflow=async()=>{var r;const{featureFormViewModel:i}=this;if(i){if(i.submit(),!i.submittable||i.hasPendingSubtypeChoice)return;const n=i.getValues();if(i.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length>0)return}await((r=this.activeWorkflow)==null?void 0:r.save())},this.selectFeature=(i,r=!1)=>{const n=this.activeWorkflow;this._candidateCommitted||(n==null?void 0:n.type)!=="update"||(n.data.rootFeature=i,r&&(n.next(),this._candidateCommitted=!0))}}initialize(){this.addHandles([N(()=>{var s;const e=this.view,i=(s=e==null?void 0:e.map)==null?void 0:s.editableLayers,r=e==null?void 0:e.allLayerViews,n=r==null?void 0:r.filter(o=>!!(i!=null&&i.includes(o.layer)));return[i,n,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditorItems(),gt),N(()=>this.hideTemplatesForInactiveLayers,()=>this.syncFeatureTemplates()),St(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),St(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),St(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit"),this._set("activeWorkflow",null)}),Hi(()=>{var e;return(e=this.view)==null?void 0:e.map},e=>e.add(this._sketchGraphicsLayer),be),St(()=>this.editorItems,"change",()=>this._afterEditorItemsChange()),N(()=>[this.canCreate,this.canUpdateVisible],()=>this._afterEditorItemsChange()),N(()=>this.page,(e,i)=>{const r=[...this.pageStack];if(r.indexOf(e)===-1)r.push(e);else for(;r.length&&r.at(-1)!==e;)r.pop();this.pageStack=r},gt),Hi(()=>this.state==="awaiting-update-feature-candidate",()=>this._candidateCommitted=!1),St(()=>this.featureTemplatesViewModel,"select",async({item:e,oldItem:i})=>{var s;const{activeWorkflow:r}=this;if(r){if(r.type==="update"&&((s=r.activeWorkflow)==null?void 0:s.stepId)==="awaiting-feature-creation-info")return;try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{return void this.featureTemplatesViewModel.select(i,{emit:!1})}}if(!e)return;const n={layer:e.layer,template:e.template};if(e.supportsUpload)return this.featureTemplatesViewModel.select(i,{emit:!1}),this.startCreateFeaturesWorkflow(n);this.startCreateFeaturesWorkflowAtFeatureCreation(n)}),St(()=>this.view,"key-down",e=>{var i;e.key==="Escape"&&((i=this.activeWorkflow)!=null&&i.keyboardCancellationEnabled)&&(e.stopPropagation(),this.back())}),St(()=>this.sketchViewModel,["create","delete","update"],e=>{var a,u;const{activeWorkflow:i}=this,r=(i==null?void 0:i.type)==="update",n=r?(a=i.activeWorkflow)==null?void 0:a.layer:i==null?void 0:i.layer,s=r?(u=i==null?void 0:i.activeWorkflow)==null?void 0:u.parentLayer:void 0,o=`sketch-${e.type}`;this.emit(o,{type:o,detail:e,layer:n,parentLayer:s})},yn),N(()=>this.view,e=>{if(this._snappingManager=xe(this._snappingManager),!e)return;const i=this.snappingOptions;this._snappingManager=new Pa({view:e,options:i}),this.ownSketchViewModel.snappingManager=this._snappingManager},gt),N(()=>this.snappingOptions,e=>{this._snappingManager&&(this._snappingManager.options=e)},gt)])}destroy(){this._cancelWorkflow({warnIfNoWorkflow:!1}).then(()=>{var e,i;(i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._sketchGraphicsLayer),this.view=null}),this._updateItemsTask=mr(this._updateItemsTask),this._updatingHandles.destroy(),this._sketchEventListenerHandle=Kt(this._sketchEventListenerHandle)}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(e){Ga(U.getLogger(this),"allowedWorkflows",{replacement:"Editor.visibleElements",version:"4.29",warnOnce:!0}),e&&e.length!==0||(e=[...gle]),this._set("allowedWorkflows",e)}get canCreate(){return this.editorItems.some(e=>e.supportsCreateFeaturesWorkflow)}get canCreateVisible(){return!!this.featureTemplatesLayers.length}get canUpdate(){return this.editorItems.some(e=>e.supportsUpdateWorkflow)}get canUpdateVisible(){return this.editorItems.some(e=>e.supportsUpdateWorkflow&&e.visible)}get featureTemplatesLayers(){const e=new Y;for(const i of this.editorItems){const r=i.supportsCreateFeaturesWorkflow&&!i.isTable,n=this.hideTemplatesForInactiveLayers&&!i.visible;r&&!n&&e.push(i.layer)}return e}get editableItems(){return Ga(U.getLogger(this),"editableItems",{replacement:"editorItems",version:"4.29",warnOnce:!0}),this.editorItems.map(e=>{const{capabilities:i,disabled:r,hasInvalidFormTemplate:n,layer:s}=e,o=[],a=i.create,u=i.update,d=i.delete;return a.enabled&&o.push("create"),u.enabled&&o.push("update"),d.enabled&&o.push("delete"),{layer:s,supports:o,suspended:r,attributeUpdatesEnabled:u.attributes,geometryUpdatesEnabled:u.geometry,attachmentsOnCreateEnabled:a.attachments.enabled,attachmentsOnUpdateEnabled:u.attachments.enabled,hasInvalidFormTemplate:n,hasAttachments:i.attachments.enabled}})}get featureFormViewModel(){const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"?e.activeFeatureFormViewModel:(e==null?void 0:e.type)==="create-features"?e.featureFormViewModel:null}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get sketchViewModel(){const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"?e.activeSketchViewModel:(e==null?void 0:e.type)==="create-features"?e.sketchViewModel:this.ownSketchViewModel}get state(){var r,n;if(!((r=this.view)!=null&&r.ready))return"disabled";const e=this.attachmentsViewModel.mode;if(e==="add")return"adding-attachment";if(e==="edit")return"editing-attachment";const{activeWorkflow:i}=this;return i!=null&&i.stepId?i.type==="update"&&((n=i.activeWorkflow)!=null&&n.stepId)?i.activeWorkflow.stepId:i.stepId:"ready"}get syncing(){return this._activityQueue.length>0}get updating(){var e;return this._updatingHandles.updating||((e=this.activeWorkflow)==null?void 0:e.updating)===!0}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}set view(e){this.ownSketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}get page(){const{activeWorkflow:e,state:i}=this;if((e==null?void 0:e.type)==="update"&&e.stepId==="awaiting-feature-to-update")return"ready";if((e==null?void 0:e.type)==="create-features"&&e.numPendingFeatures===0){const r=e.data.upload;if(r)return r.state==="default"?"ready":"creating-features-upload-details"}return i??"disabled"}get featureFormDisabled(){var i;const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"&&((i=e.activeEditorItem)==null?void 0:i.capabilities.update.attributes)===!1}get canGoBack(){return this.activeWorkflow!=null&&!this.syncing}get shouldShowDeleteButton(){var i;const{activeWorkflow:e}=this;return!!e&&e.type==="update"&&!!((i=e.activeEditorItem)!=null&&i.capabilities.delete.enabled)}get hasPendingEdits(){var e;return((e=this.activeWorkflow)==null?void 0:e.hasPendingEdits)??!1}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateFeaturesWorkflowAtFeatureCreation(e){return this.startCreateFeaturesWorkflow(e,"creating-features")}async startCreateFeaturesWorkflow(e,i="awaiting-feature-creation-info"){if(await wi(()=>!this.updating),!this.canCreate)throw new L("editing:unsupported-workflow","Creating features is unsupported or disabled.");const r=this._createUpdatingResolver();try{await this._cancelWorkflow();const n=this._createCreateFeaturesWorkflow(e,i);this._set("activeWorkflow",n),await n.start()}catch(n){this._logErrorAndCancelWorkflow(n)}finally{r.resolve()}}async startCreateFeaturesWorkflowAtFeatureEdit(e){await wi(()=>!this.updating);const i=this._createUpdatingResolver();try{const{initialFeature:r}=e,n=r.sourceLayer=r.layer,s=n?this.findEditorItemForLayer(n):void 0;if(!(s!=null&&s.supportsCreateFeaturesWorkflow))throw new L("editing:unsupported-workflow","Creating features is unsupported or disabled for this layer.");await this._cancelWorkflow();const o=this._createCreateFeaturesWorkflow({initialFeature:r,layer:s.layer,maxFeatures:1},"creating-features");this._set("activeWorkflow",o),await o.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startUpdateWorkflowAtFeatureSelection(){if(await wi(()=>!this.updating),!this.canUpdate)return void Bm("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const e=this._createUpdatingResolver();try{await this._cancelWorkflow();const i=this._createUpdateWorkflow();this._set("activeWorkflow",i),await i.start()}catch(i){this._logErrorAndCancelWorkflow(i)}finally{e.resolve()}}async startUpdateWorkflowAtMultipleFeatureSelection(e){if(await wi(()=>!this.updating),!this.canUpdate)return void Bm("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createUpdateWorkflow("awaiting-update-feature-candidate");r.data.candidates=e,this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startUpdateWorkflowAtFeatureEdit(e){if(await wi(()=>!this.updating),!this.canUpdate)return void Bm("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createUpdateWorkflow("editing-existing-feature");r.data.rootFeature=e,this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async deleteFeatureFromWorkflow(){const{activeWorkflow:e}=this;e&&e.type==="update"?await e.deleteActiveFeature():Bm("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(e){return this._cancelWorkflow({warnIfNoWorkflow:!0,...e})}findEditorItemForLayer(e){return this.editorItems.find(i=>i.layer===e)}itemHasInvalidFormTemplate(e){var i;return e!=null&&((i=this.findEditorItemForLayer(e.layer))==null?void 0:i.hasInvalidFormTemplate)===!0}syncFeatureTemplates(){this._featureTemplatesViewModelLocked||(this.featureTemplatesViewModel.layers=this.featureTemplatesLayers.toArray())}async toggleUpdateWorkflow(){this.canUpdate&&(this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&this.state==="awaiting-feature-to-update"?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection()))}lockFeatureTemplatesViewModel(){return this._featureTemplatesViewModelLocked=!0,ye(()=>{this._featureTemplatesViewModelLocked=!1,this.syncFeatureTemplates()})}async _getEditorItemCandidates(e){const{view:i}=this;if(!(i!=null&&i.map))return[];const{map:r}=i,n=r.editableLayers.toArray()??[],s=r.allTables.toArray().filter(hY)??[];return await Promise.allSettled([...n.map(o=>o.type==="subtype-group"?o.loadAll():Promise.resolve()),...s.map(o=>o.load())]),qe(e),[...n.reverse(),...s.reverse()].filter(o=>YS(o)&&(o.geometryType!=="mesh"||i.type==="3d")).flatMap(o=>o.type==="subtype-group"?o.sublayers.toArray():o)}_drainEditorItems(){this.editorItems.drain(e=>e.destroy())}async _updateEditorItems(){mr(this._updateItemsTask);const{view:e}=this,i=Xo(async r=>{if(!(e!=null&&e.map)||!(e!=null&&e.allLayerViews))return;const n=await this._getEditorItemCandidates(r);if(!n.length)return void this._drainEditorItems();const s=[],o=[],a=[],{layerInfos:u}=this;for(const p of n){const h=t6e(u,p),m=await Jb(e,p).catch(()=>null);(h?s:m?o:a).push(new QGe({layer:p,layerInfo:h,layerView:m}))}u!=null&&u.length&&s.sort((p,h)=>u.findIndex(({layer:m})=>m===p.layer)-u.findIndex(({layer:m})=>m===h.layer));const d=[...s,...o,...a];r.aborted||(this._drainEditorItems(),this.editorItems.addMany(d))});this._updatingHandles.addPromise(i.promise),this._updateItemsTask=i}_afterEditorItemsChange(){const{activeWorkflow:e}=this;if(this.syncFeatureTemplates(),!e)return;const{stepId:i}=e;e.type!=="create-features"?e.type==="update"&&(i==="awaiting-feature-to-update"&&!this.canUpdateVisible||i==="awaiting-update-feature-candidate"&&!e.hasUpdatableCandidates)&&this._cancelWorkflow():i!=="awaiting-feature-creation-info"||this.canCreate||this._cancelWorkflow()}async _cancelWorkflow(e){const i=this.activeWorkflow;if(!i)return void((e==null?void 0:e.warnIfNoWorkflow)&&Bm("editing:no-active-workflow","There is no active workflow to cancel."));if(!e||e.force!==!1)return this.emit("workflow-cancel"),this._set("activeWorkflow",null),void await i.cancel(e);await i.cancel(e),this._set("activeWorkflow",null)}_createCreateFeaturesWorkflow(e,i){return ole.create({viewModel:this,creationInfo:e,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:i,applyEditsCallback:(r,n,s)=>this._applyEdits(r,n,s),addAttachmentsCallback:(r,n)=>this._addAttachments(r,n)})}_createUpdateWorkflow(e){return qGe.create({viewModel:this,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:e,applyEditsCallback:(i,r,n)=>this._applyEdits(i,r,n),addAttachmentsCallback:(i,r)=>this._addAttachments(i,r)})}_addAttachments(e,i){const r=i.map(n=>this._addAttachment(e,n.feature,n.attachment))??[];return Promise.all(r)}async _addAttachment(e,i,r){var s;let n=null;if(!("addAttachment"in e)||((s=e.capabilities)==null?void 0:s.attachment)==null)throw new L("editor:attachments-not-supported","Adding attachments is not supported for this layer type");return await this._queueOperation(async()=>{var o;return n=await((o=e.addAttachment)==null?void 0:o.call(e,i,r).catch(a=>{throw(a==null?void 0:a.error)||a}))??null,n}),n}async _applyEdits(e,i,r){let n=null;const s=e.url?await VV(e.url):null,o={returnServiceEditsOption:(!s||!QO(s))&&!RegExp("/hosted/","i").test(e.url)?"original-and-current-features":void 0,...r};return await this._queueOperation(async()=>{const{view:a}=this;if(!a)return null;const u=await Jb(a,e).catch(()=>null);return n=await e.applyEdits(i,o),u&&await wi(()=>!u.updating),n}),n}_queueOperation(e){this._activityQueue.push(e);const i=(r,n)=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)};return e().then(r=>{if(r!=null&&"error"in r&&r.error!=null)throw r.error;if(r!=null&&"addFeatureResults"in r){const{addFeatureResults:n,deleteFeatureResults:s,updateFeatureResults:o}=r,a=n.find(u=>!!u.error)||o.find(u=>!!u.error)||s.find(u=>!!u.error);if(a)throw a.error}return r}).catch(r=>{Bm("editing:operation-error","An error occurred.",{error:r});const n={error:r,retry:()=>(i(n,this.failures),this._queueOperation(e)),cancel:()=>{i(n,this.failures)}};this._set("failures",[...this.failures,n])}).then(()=>{i(e,this._activityQueue)})}_createUpdatingResolver(){const e=fn();return this._updatingHandles.addPromise(e.promise),e}_logErrorAndCancelWorkflow(e){const{name:i,message:r,details:n}=e;Bm(i??"editing:workflow-start-failed",r??void 0,n??e),this._cancelWorkflow({force:!0})}_itemIsSuspended(e){const i=this.findEditorItemForLayer(e);return i!=null&&(!i.visible||i.disabled)}};l([c({readOnly:!0})],st.prototype,"activeWorkflow",void 0),l([c({readOnly:!0})],st.prototype,"_activityQueue",void 0),l([c({value:[...gle]})],st.prototype,"allowedWorkflows",null),l([c({readOnly:!0})],st.prototype,"canCreate",null),l([c()],st.prototype,"canCreateVisible",null),l([c({readOnly:!0})],st.prototype,"canUpdate",null),l([c()],st.prototype,"canUpdateVisible",null),l([c()],st.prototype,"featureTemplatesLayers",null),l([c()],st.prototype,"editableItems",null),l([c()],st.prototype,"editorItems",void 0),l([c({readOnly:!0})],st.prototype,"failures",void 0),l([c()],st.prototype,"hideTemplatesForInactiveLayers",void 0),l([c()],st.prototype,"attachmentsViewModel",void 0),l([c()],st.prototype,"featureFormViewModel",null),l([c()],st.prototype,"featureTemplatesViewModel",void 0),l([c()],st.prototype,"labelOptions",null),l([c()],st.prototype,"layerInfos",void 0),l([c()],st.prototype,"ownSketchViewModel",void 0),l([c()],st.prototype,"sketchOptions",void 0),l([c()],st.prototype,"sketchViewModel",null),l([c({type:gg,nonNullable:!0})],st.prototype,"snappingOptions",void 0),l([c()],st.prototype,"spinnerViewModel",void 0),l([c()],st.prototype,"state",null),l([c({readOnly:!0})],st.prototype,"syncing",null),l([c()],st.prototype,"updating",null),l([c()],st.prototype,"tooltipOptions",null),l([c()],st.prototype,"valueOptions",null),l([c()],st.prototype,"view",null),l([c()],st.prototype,"pageStack",void 0),l([c()],st.prototype,"showDiscardEditsPrompt",void 0),l([c()],st.prototype,"_candidateCommitted",void 0),l([c()],st.prototype,"page",null),l([c()],st.prototype,"featureFormDisabled",null),l([c()],st.prototype,"canGoBack",null),l([c()],st.prototype,"shouldShowDeleteButton",null),l([c()],st.prototype,"hasPendingEdits",null),st=l([$(yle)],st);const i6e=st;let $a=class extends q{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};l([c({type:Boolean,nonNullable:!0})],$a.prototype,"colorSelection",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"dynamicScaleToggle",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"gridEnabledToggle",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"numericInputs",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"gridSnapEnabledToggle",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"lineIntervalInput",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"outOfScaleWarning",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"placementButtons",void 0),l([c({type:Boolean,nonNullable:!0})],$a.prototype,"rotateWithMapToggle",void 0),$a=l([$("esri.widgets.support.GridControls.VisibleElements")],$a);const vle=$a;let Ea=class extends q{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new vle({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"enabledToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"featureEnabledToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"gridEnabledToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"header",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"layerList",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"gridControls",void 0),l([c({type:vle,nonNullable:!0})],Ea.prototype,"gridControlsElements",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"layerListToggleLayersButton",void 0),l([c({type:Boolean,nonNullable:!0})],Ea.prototype,"selfEnabledToggle",void 0),Ea=l([$("esri.widgets.support.SnappingControls.VisibleElements")],Ea);const IE=Ea;let Ta=class extends q{constructor(e){super(e),this.createFeaturesSection=!0,this.directionModePicker=!1,this.editFeaturesSection=!0,this.labelsToggle=!0,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new IE,this.tooltipsToggle=!0,this.undoRedoButtons=!1}};l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"createFeaturesSection",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"directionModePicker",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"editFeaturesSection",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"labelsToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"settingsMenu",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"snappingControls",void 0),l([c({type:IE,nonNullable:!0})],Ta.prototype,"snappingControlsElements",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"tooltipsToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Ta.prototype,"undoRedoButtons",void 0),Ta=l([$("esri.widgets.Editor.VisibleElements")],Ta);const ble=Ta,pw="esri-editor__panel-content",T$={base:pw,message:`${pw}__message`,section:`${pw}__section`,sectionGroup:`${pw}__section__group`,scrimContainer:`${pw}__scrim-container`},xE=()=>Gt({scrim:()=>k(()=>import("./calcite-scrim-BZKfzama.js"),__vite__mapDeps([283,265,240,235,241,242,243,245]))});function tm(t,...e){return b("div",{class:nu(T$.base,t!=null&&t.showScrimOverlay?T$.scrimContainer:void 0),key:(t==null?void 0:t.key)??"panel-content"},...e,t!=null&&t.showScrimOverlay?b("calcite-scrim",null):void 0)}function ZU(t,...e){return b("div",{class:T$.message,"data-testid":"panel-content-message",key:(t==null?void 0:t.key)??"panel-content-message"},...e)}function rb(t,...e){return b("div",{class:T$.section,key:(t==null?void 0:t.key)??"panel-content-section"},...e)}function r6e(t,...e){return b("div",{class:T$.sectionGroup,key:(t==null?void 0:t.key)??"panel-content-section-group"},...e)}const n6e=()=>xE();function s6e({helpMessage:t}){return b(tm,{key:"creating-features-panel-content"},b(ZU,{key:"content-message"},t))}const o6e=()=>xE();function a6e({editorItems:t,filterText:e,id:i,messagesTemplates:r,onFilterTextChange:n,onSelectFeature:s,workflow:o}){const a=new Map,u=o.data.candidates;let d=0;u.map(m=>({label:l6e(m),id:m.attributes[m.layer.objectIdField],data:m})).filter(({label:m,data:y})=>{const g=e.toLowerCase(),{title:v}=y.layer,_=t.find(w=>w.layer===y.sourceLayer);return _?_.supportsUpdateWorkflow&&(!g||(m==null?void 0:m.toLowerCase().includes(g))||(v==null?void 0:v.toLowerCase().includes(g))):null}).filter(ot).forEach(m=>{var g;d++;const y=m.data.layer;a.has(y)?(g=a.get(y))==null||g.items.push(m):a.set(y,{id:`${y.id}`,label:y.title??"",items:[m]})});const p=t.toArray().map(({layer:m})=>a.get(m)).filter(ot),h=d>10||e.length>0;return b(tm,{key:"feature-list"},b(rb,null,Qoe({enableListScroll:!1,filterEnabled:h,filterText:e,id:i,items:p,messages:{filterPlaceholder:r.filterPlaceholder,noItems:r.noItems,noMatches:r.noMatches},onFilterChange:m=>n(m),onItemMouseEnter:m=>s(m.data),onItemMouseLeave:()=>s(null),onItemSelect:m=>s(m.data,!0)})))}function l6e(t){const e=t.layer;if(!e)return null;const i=e.fieldsIndex.get(e.objectIdField),r=i.alias||i.name,{attributes:n}=t,s=$5(e);return s&&n[s]&&`${n[s]}`||`${r}: ${n[i.name]}`}const u6e={base:"esri-editor__actions"},JU=()=>Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245]))});function uC({buttons:t,key:e}){return b("div",{class:u6e.base,key:e??"footer-actions",slot:"footer"},t.filter(ot).map(({disabled:i,onClick:r,label:n,...s},o)=>b("calcite-button",{disabled:i??!1,key:`action-${o}`,onclick:()=>{i||r()},width:"full",...s},n)))}const c6e={notice:"esri-editor__notice"},_le=()=>Gt({notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244]))});function d6e({workflow:t,messages:e}){var n,s;const i=[],r="content-start";if(t!=null&&t.reliesOnOwnerAdminPrivileges){const o=e.ownerAdminNotice;i.push(b(_M,{key:"owner-admin-notice",message:o,slot:r}))}if(t!=null&&t.hasInvalidFormTemplate){const o=e.formFieldUpdateError;i.push(b(_M,{key:"form-field-error",kind:"warning",message:o,slot:r}))}if((t==null?void 0:t.type)==="create-features"&&((s=(n=t.data.upload)==null?void 0:n.result)==null?void 0:s.type)==="georeferenced-reprojected"){const o=e.helpMessages3d.meshReprojected;i.push(b(_M,{key:"mesh-reprojected",kind:"warning",message:o,slot:r}))}return b(lm,null,i)}function _M(t){const e=t.kind??"brand";return b("calcite-notice",{class:c6e.notice,icon:poe[e],key:t.key,kind:e,open:!0,scale:"s"},t.title?b("div",{slot:"title"},t.title):null,b("div",{slot:"message"},t.message))}const p6e={absolute:"absolute-direction",relative:"relative-direction"},wle=()=>Gt({icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),switch:()=>k(()=>import("./calcite-switch-CIQH1lYU.js"),__vite__mapDeps([284,235,234,236,241,237,238,239])),tooltip:()=>k(()=>import("./calcite-tooltip-DHysjdJv.js"),__vite__mapDeps([351,235,259,260,262,264]))}),hw="esri-labeled-switch",mw={label:`${hw}__label`,labelContent:`${hw}__label-content`,iconInfo:`${hw}__icon_info`,iconWarning:`${hw}__icon_warning`,tooltip:`${hw}__tooltip`};function L0({checked:t,disabled:e,hint:i,key:r,label:n,onChange:s,hintIcon:o,hintKind:a}){return b("calcite-label",{class:mw.label,disabled:e,key:r,layout:"inline-space-between",scale:"s"},b("div",{class:mw.labelContent,key:"label-content"},i?b(lm,null,b("div",null,n),b("calcite-icon",{class:a!=="warning"?mw.iconInfo:mw.iconWarning,icon:o??"information",id:r,scale:"s",tabIndex:0}),b("calcite-tooltip",{class:mw.tooltip,referenceElement:r},i)):n),b("calcite-switch",{checked:t,disabled:e,scale:"s",onCalciteSwitchChange:u=>s(u.target.checked)}))}let Jf=class extends q{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};l([c({type:Boolean,nonNullable:!0})],Jf.prototype,"directionModePicker",void 0),l([c({type:Boolean,nonNullable:!0})],Jf.prototype,"header",void 0),l([c({type:Boolean,nonNullable:!0})],Jf.prototype,"labelsToggle",void 0),l([c({type:Boolean,nonNullable:!0})],Jf.prototype,"tooltipsToggle",void 0),Jf=l([$("esri.widgets.support.SketchTooltipControls.VisibleElements")],Jf);const Sle=Jf,fw="esri-sketch-tooltip-controls",gI={base:fw,block:`${fw}__block`,blockContent:`${fw}__block-content`,hintIcon:`${fw}__hint-icon`,radioButtonLabelWrapper:`${fw}__radio-button-label-wrapper`};let Mh=class extends $t{constructor(e,i){super(e,i),this.viewModel=null,this.visibleElements=new Sle,this.sketchOptions=new Lm,this.viewType=void 0,this._onTooltipsEnabledChange=r=>{this.sketchOptions.tooltips.enabled=r},this._onLabelsEnabledChange=r=>{this.sketchOptions.labels.enabled=r},this._onDirectionModeChange=r=>{this.sketchOptions.values.directionMode=r.target.selectedItem.value}}loadDependencies(){return Promise.all([Gt({block:()=>k(()=>import("./calcite-block-aUGSXHTV.js"),__vite__mapDeps([296,282,242,235,236,240,241,243,263,239,262,259,260,248,238,244,245,256,257,258,261,264,279,265])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),"radio-button":()=>k(()=>import("./calcite-radio-button-B5bB2U0E.js"),__vite__mapDeps([294,257,235,234,236,237,238,239])),"radio-button-group":()=>k(()=>import("./calcite-radio-button-group-BBdDVhdp.js"),__vite__mapDeps([295,242,235,239,268,244,270]))}),wle()])}render(){const{label:e,visibleElements:i}=this,r=this._renderContent();return b("div",{"aria-label":e,class:this.classes(gI.base,K.widget)},r?b("calcite-block",{class:gI.block,heading:i.header?this.label:"",key:"content-block",open:!0},b("div",{class:gI.blockContent,key:"content"},r)):void 0)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:i}=this,r=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&i!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(ot);return r.length===0?null:r}_renderTooltipsToggle(){const{messages:e,sketchOptions:i}=this;return b(L0,{checked:i.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:i}=this;return b(L0,{checked:i.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:i}=this,{directionMode:r}=i.values;return b("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,b("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:r,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",r,e.directionModeRelative),this._renderDirectionModeOption("absolute",r,e.directionModeAbsolute)))}_renderDirectionModeOption(e,i,r){return b("calcite-label",{key:e,layout:"inline",scale:"s"},b("calcite-radio-button",{checked:e===i,scale:"s",value:e}),b("div",{class:gI.radioButtonLabelWrapper,key:"label-wrapper"},b("calcite-icon",{icon:p6e[e],scale:"s"}),r))}};l([c()],Mh.prototype,"label",null),l([c({type:Sle,nonNullable:!0})],Mh.prototype,"visibleElements",void 0),l([c(),Ue("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],Mh.prototype,"messages",void 0),l([c({nonNullable:!0,type:Lm})],Mh.prototype,"sketchOptions",void 0),l([c({type:String})],Mh.prototype,"viewType",void 0),Mh=l([$("esri.widgets.support.SketchTooltipControls")],Mh);const h6e=Mh,$le={hide:"hide",hideChildren:"hide-children"},m6e=10,f6e=2;function y6e({exclusive:t,visible:e,visibilityAppearance:i}){const r=i==="checkbox";return e?t?"circle-f":r?"check-square-f":"view-visible":t?"circle":r?"square":"view-hide"}function g6e({connectionStatus:t,publishing:e}){return t?t==="connected"?"beacon":"offline":e?"square":"bullet-point"}function v6e(t){return(t==null?void 0:t.listMode)===$le.hideChildren}function cC(t){return(t==null?void 0:t.listMode)??void 0}function b6e(t){return t!=null&&"minScale"in t&&t.minScale!=null?t.minScale:void 0}function _6e(t){return t!=null&&"maxScale"in t&&t.maxScale!=null?t.maxScale:void 0}function w6e(t){if(!t)return"inherited";const e=T6e(XU(t)?t.layer:t);return e!=null?e?"independent":"inherited":"visibilityMode"in t&&t.visibilityMode!=null?t.visibilityMode:"independent"}function YU(t){if(t&&(!("type"in t)||t.type!=="wmts"))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function S6e(t){const e=(t!=null&&t.layer&&XU(t.layer)?t.layer.layer:void 0)??(t==null?void 0:t.layer);return!!e&&e.type!=="catalog"&&(I6e(e)??!0)}function KU(t){return cC(t)!==$le.hide}function $6e(t,e){if(!t||e==null||isNaN(e))return!1;const i=b6e(t),r=_6e(t),n=i!=null&&!isNaN(i)&&i>0&&e>i,s=r!=null&&!isNaN(r)&&r>0&&e<r;return n||s}function Ele(t,e){t==null||t.sort((i,r)=>{const n="uid"in i?e.indexOf(i.uid):-1,s="uid"in r?e.indexOf(r.uid):-1;return n>s?-1:n<s?1:0})}function E6e(t,e){const i=t==null?void 0:t.layer;if(!i)return;const r=YU(i);if(!r)return;let n;r==="layers"&&"layers"in i?n=i.layers:r==="sublayers"&&"sublayers"in i&&(n=i.sublayers),Ele(n,e)}function x7(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function XU(t){return t!=null&&"layer"in t&&t.layer!=null}function T6e(t){const e=Tle(t);return e!=null&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function I6e(t){const e=Tle(t);return e!=null&&"supportsDynamicLayers"in e?e.supportsDynamicLayers:void 0}function Tle(t){return t&&"capabilities"in t&&t.capabilities!=null&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}function Ku(t){return t==null?void 0:t["data-item"]}function M7(t){return t==null?void 0:t.getAttribute("data-layer-type")}function x6e({children:t,error:e,incompatible:i}){return!!(t!=null&&t.filter(r=>!r.hidden).length)&&!e&&!i}function M6e(t){for(const e of t)for(const i of e)if(i.type==="button"||i.type==="toggle")return i}function bD(t){return t!=null&&typeof t=="object"&&t.type==="2d"&&t.view2dType==="linkchart"}var _D;let Ch=_D=class extends X${constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new _D({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};l([c()],Ch.prototype,"displayValueEnabled",void 0),l([c()],Ch.prototype,"max",void 0),l([c()],Ch.prototype,"min",void 0),l([c()],Ch.prototype,"step",void 0),l([c()],Ch.prototype,"value",void 0),Ch=_D=l([$("esri.support.actions.ActionSlider")],Ch);const C6e=Ch;let En=class extends vu($t){constructor(e,i){super(e,i),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([N(()=>this._canCreateLegend,()=>this._createLegend(),be),N(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),be)])}destroy(){this._legend=xe(this._legend)}get _canCreateLegend(){const{content:e,listItem:i}=this;if(!i)return!1;const r="legend";return e===r||e!=null&&!!Array.isArray(e)&&e.includes(r)}get _legendOptions(){const{listItem:e,_legendLayerInfo:i}=this,r=e==null?void 0:e.view;return i&&r?{view:r,layerInfos:[i]}:{}}get _legendLayerInfo(){var o;const e=(o=this.listItem)==null?void 0:o.layer;if(!e||e.type==="subtype-sublayer")return null;const i=XU(e)?e:null,r=e==null?void 0:e.parent,n=r!=null&&"type"in r&&r.type==="map-image"?i==null?void 0:i.source:null,s="";return n&&r?{layer:r,title:s,sublayerIds:[n.mapLayerId]}:{layer:e,title:s}}get disabled(){var n;const{listItem:e,_legend:i,content:r}=this;return!e||!(Array.isArray(r)&&r.length>1)&&!!i&&(!((n=i.activeLayerInfos)!=null&&n.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,i=this._getFirstWidget();return this._get("icon")??(!e&&i?i.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){var e;return this._get("title")||(((e=this._getFirstWidget())==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return b("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:i,disabled:r,open:n}=this;return e&&!r&&n?e==="legend"&&i?b("div",{key:"legend-widget"},i.render()):typeof e=="string"?b("div",{innerHTML:e,key:e}):xS(e)?b("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?b("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:i}=this;return i?Array.isArray(e)?e.map(r=>this._renderContent(r)):this._renderContent(e):null}async _createLegend(){if(xe(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await k(()=>Promise.resolve().then(()=>s9e),void 0),i=new e(this._legendOptions);this._legend=i}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:xS(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(i=>this._getWidget(i)).find(i=>i):this._getWidget(e)}};l([c()],En.prototype,"_legend",void 0),l([c()],En.prototype,"_canCreateLegend",null),l([c()],En.prototype,"_legendOptions",null),l([c()],En.prototype,"_legendLayerInfo",null),l([c()],En.prototype,"className",void 0),l([c()],En.prototype,"content",void 0),l([c()],En.prototype,"disabled",null),l([c()],En.prototype,"flowEnabled",void 0),l([c()],En.prototype,"icon",null),l([c()],En.prototype,"image",void 0),l([c()],En.prototype,"listItem",void 0),l([c()],En.prototype,"open",void 0),l([c()],En.prototype,"title",null),l([c()],En.prototype,"visible",void 0),En=l([$("esri.widgets.LayerList.ListItemPanel")],En);const Ile=En;var H1;const k6e=Y.ofType({key:"type",defaultKeyValue:"button",base:X$,typeMap:{button:VQ,toggle:UQ,slider:C6e}}),xle=Y.ofType(k6e),bO="layer",vI="child-list-mode",L6e="hide";let qt=H1=class extends vu(q){constructor(t){super(t),this.actionsSections=new xle,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Y.ofType(H1)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([N(()=>{var t;return[this.layer,(t=this.layer)==null?void 0:t.listMode,this.listModeDisabled]},()=>this._watchLayerProperties(this.layer),be),N(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),be),N(()=>this.view,t=>this._updateChildrenView(t),be),N(()=>this.panel,t=>this._setListItemOnPanel(t),be)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){var t;(t=this.panel)==null||t.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}get layerView(){const{layer:t,view:e}=this;if(!t||!e||t.type==="sublayer")return null;const i=t.type==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(r=>r.layer===i)??null}castPanel(t){var e;return(e=this.panel)!=null&&e.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new Ile(t):null}get sortable(){var t;return((t=this.layer)==null?void 0:t.type)!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(t){this._set("sortable",t)}get title(){const t=rs(this,"layer.layer");return(!t||t&&rs(this,"layer.layer.loaded"))&&rs(this,"layer.title")||rs(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var i;const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&((i=t.publishingInfo)==null?void 0:i.status)==="publishing"}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:r}=this;return!r&&!e&&(t?t.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var t;return(t=this.layer)==null?void 0:t.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){var t,e;return((t=this.layerView)==null?void 0:t.visibleAtCurrentScale)??!$6e(this.layer,(e=this.view)==null?void 0:e.scale)}get visibleAtCurrentTimeExtent(){var t;return((t=this.layerView)==null?void 0:t.visibleAtCurrentTimeExtent)??!0}get visibilityMode(){return w6e(this.layer)}clone(){return new H1({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach(i=>i.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(i=>i.view=t)}_createChildren(t){const{listModeDisabled:e,children:i}=this,r=t.filter(n=>!i.some(s=>s.layer===n));i.addMany(this._createChildItems(r,e))}_destroyChildren(t){const{children:e}=this,i=e.filter(r=>!t.includes(r.layer));e.destroyMany(i)}_sortChildren(t){this.children.sort((e,i)=>t.indexOf(i.layer)-t.indexOf(e.layer))}_destroyAllChildren(){this.removeHandles(vI),this.children.destroyAll()}_watchChildLayerListMode(t){this.removeHandles(vI),this.listModeDisabled||this.addHandles(t.toArray().map(e=>N(()=>e.listMode,()=>this._compileChildren(t))),vI)}_compileChildren(t){const e=this.listModeDisabled?t:t==null?void 0:t.filter(i=>cC(i)!==L6e);e!=null&&e.length?(this._createChildren(e),this._destroyChildren(e),this._sortChildren(e),this._watchChildLayerListMode(t)):this._destroyAllChildren()}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",()=>this._compileChildren(t)),bO)}_initializeChildLayers(t){this._compileChildren(t),this._watchSublayerChanges(t)}_createChildItems(t,e){return t.map(i=>e||KU(i)?new H1({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(ot).reverse()}_watchLayerProperties(t){if(this.removeHandles(bO),this.removeHandles(vI),!t)return;if((!this.listModeDisabled&&cC(t))==="hide-children")return void this.children.destroyAll();const e=YU(t);e&&this.addHandles(N(()=>t[e],i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)},be),bO)}};l([c({type:xle})],qt.prototype,"actionsSections",void 0),l([c()],qt.prototype,"actionsOpen",void 0),l([c()],qt.prototype,"checkPublishStatusEnabled",void 0),l([c({type:Y})],qt.prototype,"children",void 0),l([c()],qt.prototype,"childrenSortable",void 0),l([c({readOnly:!0})],qt.prototype,"connectionStatus",null),l([c({readOnly:!0})],qt.prototype,"error",null),l([c()],qt.prototype,"hidden",void 0),l([c({readOnly:!0})],qt.prototype,"incompatible",null),l([c()],qt.prototype,"layer",void 0),l([c({readOnly:!0})],qt.prototype,"layerView",null),l([c()],qt.prototype,"listItemCreatedFunction",void 0),l([c({nonNullable:!0})],qt.prototype,"listModeDisabled",void 0),l([c()],qt.prototype,"open",void 0),l([c({type:Ile})],qt.prototype,"panel",void 0),l([We("panel")],qt.prototype,"castPanel",null),l([c()],qt.prototype,"parent",void 0),l([c({value:!0})],qt.prototype,"sortable",null),l([c()],qt.prototype,"title",null),l([c({readOnly:!0})],qt.prototype,"publishing",null),l([c({readOnly:!0})],qt.prototype,"updating",null),l([c()],qt.prototype,"view",void 0),l([c()],qt.prototype,"visible",null),l([c({readOnly:!0})],qt.prototype,"visibleAtCurrentScale",null),l([c({readOnly:!0})],qt.prototype,"visibleAtCurrentTimeExtent",null),l([c({readOnly:!0})],qt.prototype,"visibilityMode",null),qt=H1=l([$("esri.widgets.LayerList.ListItem")],qt);const aL=qt,fl={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},A6e="hide",Mle=Y.ofType(aL);let Xu=class extends ji.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new Mle,this.view=null}initialize(){this.addHandles([N(()=>{var e;return((e=this.view)==null?void 0:e.ready)===!0},()=>this._viewHandles(),be),N(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),N(()=>bD(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],fl.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e!=null&&e.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,i){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:i})}moveListItem(e,i,r,n){var y,g;const s=e==null?void 0:e.layer;if(!s||s.type==="subtype-sublayer"||s.type==="sublayer")return;const o=(g=(y=this.view)==null?void 0:y.map)==null?void 0:g.layers,a=i?x7(i):o,u=r?x7(r):o;if(!a||!u)return;const{operationalItems:d}=this,p=(i==null?void 0:i.children)||d,h=(r==null?void 0:r.children)||d,m=u.length-n;e.parent=r||null,p.remove(e),a.remove(s),h.includes(e)||h.add(e,m),u.includes(s)||u.add(s,m),this._compileList()}_createLayerViewHandles(e){this.removeHandles(fl.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),fl.layerViews)}_createMapLayerHandles(e){this.removeHandles(fl.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),fl.mapLayers)}_createListItem(e){const{view:i,listItemCreatedFunction:r,checkPublishStatusEnabled:n,listModeDisabled:s}=this;return new aL({checkPublishStatusEnabled:n,listModeDisabled:s,layer:e,listItemCreatedFunction:r,view:i})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(i=>cC(i)!==A6e):void 0}_watchLayersListMode(e){this.removeHandles(fl.layerListMode),e&&!this.listModeDisabled&&this.addHandles(N(()=>e.filter(i=>"listMode"in i).map(i=>i.listMode).toArray(),()=>this._compileList()),fl.layerListMode)}_compileList(){var n,s;const e=(s=(n=this.view)==null?void 0:n.map)==null?void 0:s.layers,i=bD(this.view)&&!this.view.inGeographicLayout?e==null?void 0:e.filter(({type:o})=>o==="link-chart"):e;this._watchLayersListMode(i);const r=this._getViewableLayers(i);r!=null&&r.length?(this._createNewItems(r),this._removeItems(r),this._sortItems(r)):this._removeAllItems()}_createNewItems(e){const{operationalItems:i}=this;e.forEach(r=>{i.some(n=>n.layer===r)||i.add(this._createListItem(r))})}_removeItems(e){const{operationalItems:i}=this,r=[];i.forEach(n=>{n&&e&&e.includes(n.layer)||r.push(n)}),i.destroyMany(r)}_sortItems(e){const{operationalItems:i}=this;i.sort((r,n)=>{const s=e.indexOf(r.layer),o=e.indexOf(n.layer);return s>o?-1:s<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([fl.mapLayers,fl.layerViews,fl.viewLayers]),e!=null&&e.ready?this.addHandles([N(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.allLayers},i=>this._createMapLayerHandles(i),be),N(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),be)],fl.viewLayers):this._removeAllItems()}};l([c()],Xu.prototype,"checkPublishStatusEnabled",void 0),l([c()],Xu.prototype,"listItemCreatedFunction",void 0),l([c({nonNullable:!0})],Xu.prototype,"listModeDisabled",void 0),l([c({type:Mle})],Xu.prototype,"operationalItems",void 0),l([c({readOnly:!0})],Xu.prototype,"state",null),l([c()],Xu.prototype,"totalItems",null),l([c()],Xu.prototype,"view",void 0),Xu=l([$("esri.widgets.LayerList.LayerListViewModel")],Xu);const QU=Xu,ej=t=>O6e(t)||R6e(t),O6e=t=>{if(!("type"in t))return!1;switch(t.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},R6e=t=>{const e=YU(t);if(e!=null&&t.hasOwnProperty(e)&&t[e]!=null){for(const i of t[e])if(ej(i))return!0}return!1},wM=(t,e)=>e!=null&&t!=null&&(e.test(t.title)?"self":!!t.children.some(i=>wM(i,e)!==!1)&&"children");var wD;let Md=wD=class extends aL{constructor(t){super(t),this.children=new Y,this.parent=null}get enabled(){const{children:t}=this;if(t.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let e=!1,i=!1;for(const r of t){if(r.enabled==="indeterminate")return r.enabled;if(r.enabled==="enabled"?e=!0:r.enabled==="disabled"&&(i=!0),i&&e)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(t=>[t.layer.id,...t.childLayerIds])}get featureSource(){const{layer:t,getFeatureSnappingSources:e}=this;return e().find(i=>i.layer===t)}_initializeChildLayers(t){if(!t)return;const e=t.filter(ej);super._initializeChildLayers(e)}_createChildItems(t){return t.map(e=>KU(e)?new wD({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(ot).reverse()}};l([c()],Md.prototype,"enabled",null),l([c()],Md.prototype,"children",void 0),l([c()],Md.prototype,"childLayerIds",null),l([c()],Md.prototype,"featureSource",null),l([c({constructOnly:!0})],Md.prototype,"getFeatureSnappingSources",void 0),l([c()],Md.prototype,"parent",void 0),Md=wD=l([$("esri.widgets.support.SnappingControls.SnappingListItem")],Md);let Yf=class extends QU{constructor(){super(...arguments),this.featureSnappingSources=new Y}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>{var i;return!((i=e.children)!=null&&i.length)})}_compileList(){var n,s;const e=(s=(n=this.view)==null?void 0:n.map)==null?void 0:s.layers;if(!e)return;const i=e.filter(ej);this._watchLayersListMode(i);const r=this._getViewableLayers(i);r!=null&&r.length?(this._createNewItems(r),this._removeItems(r),this._sortItems(r)):this._removeAllItems()}_createListItem(e){return new Md({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};l([c()],Yf.prototype,"featureSnappingSources",void 0),l([c()],Yf.prototype,"operationalItems",void 0),l([c()],Yf.prototype,"operationalItemsFlat",null),l([c()],Yf.prototype,"selectableItems",null),Yf=l([$("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],Yf);let Qu=class extends q{constructor(e){super(e),this.layerListViewModel=new Yf,this.snappingOptions=new gg,this.view=null}initialize(){this.addHandles([N(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:i})=>{e.view=i},be),N(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:i})=>{e.featureSnappingSources=i},be)])}get allLayersEnabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>i.enabled==="enabled")}get allLayersDisabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>!i.enabled)}get layersEnabledCount(){var e,i;return((i=(e=this.layerListViewModel)==null?void 0:e.selectableItems)==null?void 0:i.filter(r=>r.enabled==="enabled").length)??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,i){e==null||e.forEach(r=>i?this.enableSnappingForLayer(r):this.disableSnappingForLayer(r))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:{id:i}})=>{e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(e){const i=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);i&&(i.enabled=!0)}disableSnappingForLayer(e){const i=this._findSnappingSourceForLayer(e);i&&(i.enabled=!1)}updateEnabledFeatureSources(e){for(const i of this.snappingOptions.featureSources)KU(i.layer)&&(i.enabled=e.includes(i.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(i=>i.layer.id===e)}_makeSnappingSourceForLayer(e){var n;const i=(n=this.layerListViewModel.operationalItemsFlat.find(s=>s.layer.id===e))==null?void 0:n.layer;if(!i)throw new L("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if(i.type==="group")return;const r=new Jk({layer:i});return this.snappingOptions.featureSources.add(r),r}};l([c()],Qu.prototype,"allLayersEnabled",null),l([c()],Qu.prototype,"allLayersDisabled",null),l([c({constructOnly:!0})],Qu.prototype,"layerListViewModel",void 0),l([c()],Qu.prototype,"layersEnabledCount",null),l([c({type:gg,nonNullable:!0})],Qu.prototype,"snappingOptions",void 0),l([c()],Qu.prototype,"state",null),l([c()],Qu.prototype,"view",void 0),Qu=l([$("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],Qu);const P6e=Qu,yl="esri-snapping-controls",gl={base:yl,container:`${yl}__container`,item:`${yl}__item`,toggleBlock:`${yl}__toggle-block`,layerListBlock:`${yl}__layer-list-block`,layerList:`${yl}__layer-list`,layerListFilter:`${yl}__layer-list__filter`,layerListButton:`${yl}__layer-list__button`,layerListItem:`${yl}__layer-list__item`,layerListGroup:`${yl}__layer-list__group`,nestedContainer:`${yl}__nested-container`};let Gr=class extends $t{constructor(e,i){super(e,i),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new IE,this._enableSnappingSwitchChange=o=>{this.snappingOptions.enabled=o},this._featureEnabledSwitchChange=o=>{this.snappingOptions.featureEnabled=o},this._gridEnabledSwitchChange=o=>{this.snappingOptions.gridEnabled=o,o&&this._startLoadGrid()},this._selfEnabledSwitchChange=o=>{this.snappingOptions.selfEnabled=o},this._onToggleLayersButtonClick=o=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),qa(o.target)};const{snappingOptions:r,view:n,viewModel:s}=e;this.viewModel=s??(this._defaultViewModel=new P6e({snappingOptions:r,view:n}))}normalizeCtorArgs(e){const{snappingOptions:i,view:r,viewModel:n,...s}=e;return s}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=xe(this._defaultViewModel))}loadDependencies(){return Promise.all([Gt({block:()=>k(()=>import("./calcite-block-aUGSXHTV.js"),__vite__mapDeps([296,282,242,235,236,240,241,243,263,239,262,259,260,248,238,244,245,256,257,258,261,264,279,265])),button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),input:()=>k(()=>import("./calcite-input-Dp8TE27V.js"),__vite__mapDeps([266,267,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),checkbox:()=>k(()=>import("./calcite-checkbox-D7cySzqb.js"),__vite__mapDeps([352,235,234,236,241,237,238,239])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242]))}),wle()])}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===e||(this._defaultViewModel=xe(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return b("div",{"aria-label":e,class:this.classes(gl.base,K.widget)},b("div",{class:gl.container},this._renderContent()))}_renderContent(){var e;return[this._renderToggles(),this._renderLayerList(),((e=this.view)==null?void 0:e.type)==="2d"&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:i}=this,r=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&(i==null?void 0:i.type)==="2d"?this._renderGridEnabledToggle():null].filter(ot),n=[e.enabledToggle?this._renderEnabledToggle():null,r.length>0?b("div",{class:gl.nestedContainer},r):null].filter(ot);return n.length===0?null:b("calcite-block",{class:gl.toggleBlock,heading:e.header?this.label:"",key:"toggle-block",open:!0},n)}_renderEnabledToggle(){return b(L0,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return b(L0,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return b(L0,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return b(L0,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:i}=this,r=({target:{value:a}})=>{this._layerListFilter=a===""?null:new RegExp(a,"i")},n=i.layerListViewModel.operationalItems.length>9?b("calcite-input",{class:gl.layerListFilter,clearable:!0,placeholder:e==null?void 0:e.searchLayers,onCalciteInputInput:r}):null,s=this._secondaryElementsDisabled,o=this.layerListOpen&&!s;return b("calcite-block",{class:gl.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:e.snappingLayers,key:"list-block",open:o,onCalciteBlockToggle:a=>this.layerListOpen=a.target.open},n,this._renderToggleLayersButton(),b("calcite-list",{class:gl.layerList,selectionMode:"none"},this._renderLayerListItemCollection(i.layerListViewModel.operationalItems)))}_renderGridOptions(){var p;const{view:e,visibleElements:i,snappingManager:r,snappingOptions:n,_openAndReady:s}=this,{gridEnabled:o,enabled:a}=n;s&&this._startLoadGrid();const u=(p=this._gridLoadTask)==null?void 0:p.value,d=u&&(e==null?void 0:e.type)==="2d"&&b(u,{snappingManager:r,snappingOptions:n,view:e,visibleElements:i.gridControlsElements});return b("calcite-block",{class:gl.layerListBlock,collapsible:!0,disabled:!o||!a,heading:this.messages.gridOptionsHeading,key:"grid-block",open:s,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},d??b("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){var e;!this._gridLoadTask&&this.visibleElements.gridControls&&((e=this.view)==null?void 0:e.type)==="2d"&&(this._gridLoadTask=Xo(async()=>(await k(async()=>{const{default:i}=await import("./GridControls-BtoSKwMj.js");return{default:i}},__vite__mapDeps([353,181,324,325,326,327,328,151,152,65,63,318,319,12,1,320,96,136,329,330,145,331,332,334,23]))).default))}_renderLayerListItemCollection(e){const i=this._layerListFilter;return e.map(r=>{switch(i?wM(r,i):null){case"children":{const n=r.children.filter(s=>wM(s,i)!==!1);return this._renderLayerListItemGroup(r,n)}case"self":case null:return this._renderLayerListItemOrGroup(r);case!1:return wM(r.parent,i)==="self"?this._renderLayerListItemOrGroup(r):null}}).toArray().filter(ot)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:i}=this,r=e?i.disableAllLayers:i.enableAllLayers;return b("calcite-button",{appearance:"transparent",class:gl.layerListButton,label:r,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},r)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:i}}=this,r=e.title||i,n=()=>{this.viewModel.toggleSnappingForLayers([e.layer.id],e.enabled!=="enabled")};return b("calcite-list-item",{class:gl.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:r,onCalciteListItemSelect:s=>{s.stopPropagation(),n()}},b("calcite-checkbox",{checked:e.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:n}))}_renderLayerListItemGroup(e,i){const{children:r,title:n}=e,s=n||this.messages.untitledLayer,o=n&&n!==""?n:rm(),a=!!(i!=null&&i.length),u=i??r,d=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,e.enabled!=="enabled")};return b("calcite-list-item",{class:gl.layerListGroup,key:o,label:s,open:a,onCalciteListItemSelect:p=>{p.stopPropagation(),d()}},b("calcite-checkbox",{checked:e.enabled==="enabled",indeterminate:e.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:d}),b("calcite-list",null,this._renderLayerListItemCollection(u)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};l([c()],Gr.prototype,"_defaultViewModel",void 0),l([c()],Gr.prototype,"_layerListFilter",void 0),l([c()],Gr.prototype,"_gridLoadTask",void 0),l([c()],Gr.prototype,"_openAndReady",null),l([c()],Gr.prototype,"label",null),l([c({type:Boolean,nonNullable:!0})],Gr.prototype,"layerListOpen",void 0),l([c({type:Boolean,nonNullable:!0})],Gr.prototype,"gridOptionsOpen",void 0),l([c(),Ue("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Gr.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Gr.prototype,"messagesCommon",void 0),l([c()],Gr.prototype,"snappingOptions",null),l([c()],Gr.prototype,"snappingManager",void 0),l([c()],Gr.prototype,"view",null),l([c()],Gr.prototype,"viewModel",null),l([c({type:IE,nonNullable:!0})],Gr.prototype,"visibleElements",void 0),l([c()],Gr.prototype,"_enabledToggleDisabled",null),l([c()],Gr.prototype,"_secondaryElementsDisabled",null),Gr=l([$("esri.widgets.support.SnappingControls")],Gr);const F6e=Gr,N6e={settingsContainer:"esri-editor__settings"},D6e=()=>Gt({accordion:()=>k(()=>import("./calcite-accordion-yML8vOIh.js"),__vite__mapDeps([354,242])),"accordion-item":()=>k(()=>import("./calcite-accordion-item-BbVSO2ON.js"),__vite__mapDeps([355,282,242,235,238,239,244]))});function V6e({editorViewModel:t,messagesCommon:e,visibleElements:i}){const{snappingOptions:r,sketchOptions:n,view:s,sketchViewModel:o}=t,a=[],u={directionModePicker:i.directionModePicker,labelsToggle:i.labelsToggle,tooltipsToggle:i.tooltipsToggle};return Object.values(u).includes(!0)&&a.push(b(h6e,{sketchOptions:n,viewType:s==null?void 0:s.type,visibleElements:u})),i.snappingControls&&a.push(b(F6e,{afterCreate:d=>d.layerListOpen=!1,snappingManager:o==null?void 0:o.snappingManager,snappingOptions:r,view:s,visibleElements:i.snappingControlsElements??new IE})),a.length===0?null:b("calcite-accordion",{appearance:"transparent",class:N6e.settingsContainer,key:"settings"},b("calcite-accordion-item",{"data-testid":"settings",heading:e.settings,iconStart:"gear"},a))}const U6e={base:"esri-editor__panel-toolbar"},j6e=()=>Promise.all([Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245]))}),D6e()]);function G6e({editorViewModel:t,messagesCommon:e,visibleElements:i}){const{sketchViewModel:r}=t;return b("div",{class:U6e.base,key:"panel-toolbar"},b(V6e,{editorViewModel:t,messagesCommon:e,visibleElements:i}),i.undoRedoButtons?[b("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(r!=null&&r.canUndo()),iconStart:"undo",key:"undo-button",kind:"neutral",label:e.undo,onclick:()=>r==null?void 0:r.undo(),scale:"l"},e.undo),b("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(r!=null&&r.canRedo()),iconStart:"redo",key:"redo-button",kind:"neutral",label:e.redo,onclick:()=>r==null?void 0:r.redo(),scale:"l"},e.redo)]:null)}const z6e=()=>Promise.all([JU(),_le(),xE()]);function C7({editorViewModel:t,headingLevel:e,messages:i,messagesCommon:r,onDelete:n,onSave:s,renderAttachments:o,renderFeatureForm:a}){const{activeWorkflow:u,featureFormViewModel:d,syncing:p}=t;if(!u||!d)return null;const h=sGe(u)?u.activeWorkflow??u:u,m=h.type.includes("update"),y=m&&!h.hasPendingEdits||p||d.updating,g=m?r.update:r.create,v=(h==null?void 0:h.type)==="create-features"&&h.createFeatureState==="create-new",_=(h==null?void 0:h.type)==="create-features"?h.numPendingFeatures:0,w=_>1?Wr(i.createFeaturesTemplate,{numFeatures:_}):g,S=u.shouldShowAttachments&&!d.activeRelationshipInput,E=d.inputs.every(T=>!T.visible)&&!S?b(ZU,{key:"panel-content-message"},Wr(i.clickToFinishTemplate,{button:g})):b(rb,{key:"panel-content-section"},b(d6e,{messages:i,workflow:u}),b(r6e,null,a(),S?b("div",{key:"attachments"},b(Ya,{level:tb(e)},i.attachments),o()):null));return b(lm,null,b(tm,{key:"attribute-panel-content",showScrimOverlay:v},E),b(uC,{buttons:[{onClick:s,disabled:y,label:w},t.shouldShowDeleteButton?{appearance:"outline",onClick:n,disabled:p,kind:"danger",label:r.delete}:void 0]}))}const Ip="upload-assets",Am=()=>new Error;let Mat=class extends L{constructor(){super(`${Ip}:unsupported`,"Layer does not support asset uploads.",Am())}},kat=class extends L{constructor(){super(`${Ip}:no-glb-support`,"Layer does not support glb.",Am())}},Aat=class extends L{constructor(){super(`${Ip}:no-supported-source`,"No supported external source found",Am())}},Rat=class extends L{constructor(){super(`${Ip}:not-base-64`,"Expected gltf data in base64 format after conversion.",Am())}},Fat=class extends L{constructor(){super(`${Ip}:unable-to-prepare-options`,"Unable to prepare uploadAsset request options.",Am())}},Dat=class extends L{constructor(e,i){super(`${Ip}:bad-response`,`Bad response. Uploaded ${e} items and received ${i} results.`,Am())}},Uat=class extends L{constructor(e,i){super(`${Ip}-layer:upload-failed`,`Failed to upload mesh file ${e}. Error code: ${(i==null?void 0:i.code)??"-1"}. Error message: ${(i==null?void 0:i.messages)??"unknown"}`,Am())}},Gat=class extends L{constructor(e){super(`${Ip}-layer:unsupported-format`,`The service allowed us to upload an asset of FormatID ${e}, but it does not list it in its supported formats.`,Am())}},B6e=class extends L{constructor(){super(`${Ip}:convert3D-failed`,"convert3D failed.")}},H6e=class extends L{constructor(){super("invalid-input:no-model","No supported model found")}},q6e=class extends L{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}};const Ds="esri-editor__upload-details",ja={base:Ds,status:`${Ds}__status`,titleWrapper:`${Ds}__title-wrapper`,title:`${Ds}__title`,description:`${Ds}__description`,loader:`${Ds}__loader`,iconSuccess:`${Ds}__icon ${Ds}__icon--success`,iconError:`${Ds}__icon ${Ds}__icon--error`,fileList:`${Ds}__file-list`,file:`${Ds}__file`,fileIcon:`${Ds}__file-icon`,fileName:`${Ds}__file-name`},W6e=()=>Promise.all([Gt({icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242]))}),JU(),xE()]);function Z6e(t){const{messages:e,key:i,upload:r}=t;return b(lm,null,b(tm,{key:i??"upload-details"},b(rb,null,J6e(t))),r.state==="error"?b(uC,{buttons:[{onClick:()=>r.retry(),label:e.modelUploads.error.uploadNew,iconStart:"upload-to"}],key:"upload-details-footer-actions"}):null)}function J6e(t){const e=Y6e(t);return e?b("div",{class:ja.base,"data-testid":"upload-details",key:"upload-details-content"},b("div",{class:ja.status,key:"status"},e.iconContent,b("div",{class:ja.titleWrapper,key:"text"},b("div",{class:ja.title,key:"title"},e.title),b("div",{class:ja.description,key:"description"},e.description))),X6e(t.upload)):null}function Y6e({helpMessage:t,messages:e,upload:i}){switch(i.state){case"pending":{const{title:r,description:n}=e.modelUploads.pending;return{title:r,description:n,iconContent:b("calcite-loader",{"aria-hidden":"true",class:ja.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*i.progress),i.progress===1?100:99)})}}case"success":{const{title:r}=e.modelUploads.success;return{title:r,description:t||e.helpMessages3d.mesh,iconContent:b("calcite-icon",{class:nu(ja.iconSuccess),icon:"check",scale:"l"})}}case"error":{const{title:r}=e.modelUploads.error;return{title:r,description:K6e(i.error,e),iconContent:b("calcite-icon",{class:nu(ja.iconError),icon:"exclamation-mark-circle",scale:"l"})}}default:return null}}function K6e(t,e){if(!t)return null;const i=e.modelUploads.error.messages;switch(t.constructor){case H6e:return i.noModel;case q6e:return i.multipleModels;case B6e:return i.conversionFailed;case L:switch(t.name){case"glt-loader-error":case"gltf-loader-invalid-glb":return i.loadFailed;case"gltf-loader-unsupported-feature":return i.unsupportedFeature;case"glt-loader-request-error":return i.resourceRequestFailed;default:return i.default}default:return i.default}}function X6e(t){return b("div",{class:ja.fileList,key:"file-list"},t.files.map(e=>b("div",{class:ja.file,key:`file-${e.name}`},b("calcite-icon",{class:ja.fileIcon,icon:eze(e),scale:"s"}),b("span",{class:ja.fileName},Q6e(e.name)))))}function Q6e(t){var e;return((e=t.split("/").pop())==null?void 0:e.split("\\").pop())??""}function eze(t){var i;const e=(i=t.name.split(".").pop())==null?void 0:i.toLowerCase();return(e?ize[e]:null)??tze}const tze="file",k7="file-shape",bI="file-image",ize={glb:k7,gltf:k7,jpeg:bI,jpg:bI,png:bI,svg:bI,zip:"file-zip"};let Dt=class extends $t{constructor(e,i){super(e,i),this._featureForm=new qVe,this._attachments=new HDe({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._featureTemplates=new N4e({enableListScroll:!1,renderItemContentEnd:r=>r.supportsUpload?b("calcite-icon",{class:Gg.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):null,renderItemLabel:r=>r.label,renderCustomGroupContent:r=>this._renderCustomTemplateGroupContent(r)}),this._filterText="",this._prompt=null,this._spinner=new V4e,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.messagesTemplates=null,this.supportingWidgetDefaults=null,this.viewModel=new i6e,this.visibleElements=new ble,this._renderAttachments=()=>this._attachments.render(),this._renderFeatureForm=()=>this._featureForm.render(),this._renderFeatureTemplates=()=>this._featureTemplates.render(),this._renderSelectIcon=()=>b("calcite-icon",{icon:"cursor",slot:"content-start"}),this.EditorPanel=({heading:r,key:n},...s)=>{const{visibleElements:o}=this;return b("calcite-flow-item",{closable:!1,heading:r,headingLevel:this.headingLevel,key:n,loading:this._loading,onCalciteFlowItemBack:this._onBack},o.settingsMenu?b(G6e,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:o}):null,...s)},this._showDiscardEditsPrompt=()=>{var s;const{messages:r,activeWorkflow:n}=this;return(n==null?void 0:n.type)==="create-features"&&OS(n.data.creationInfo)?this._showPromptAndWait(((s=n.data.upload)==null?void 0:s.state)==="success"?r.modelUploads.cancelPlacementPrompt:r.modelUploads.cancelUploadPrompt):this._showPromptAndWait({title:r.cancelEditTitle,message:r.cancelEditWarningMessage,yesLabel:r.discardEdits,noLabel:r.continueEditing})},this._showGenericCancelPrompt=()=>{const{messages:r,messagesCommon:n}=this;return this._showPromptAndWait({title:r.cancelRequestTitle,message:r.cancelRequestWarningMessage,yesLabel:n.form.yes,noLabel:n.form.no})},this._showPrompt=r=>{var n,s;(s=(n=this._prompt)==null?void 0:n.cancel)==null||s.call(n),this._prompt=r},this._clearPrompt=()=>{this._prompt=null},this._onSave=()=>{this.viewModel.saveWorkflow()},this._onDelete=()=>{const{messages:r,messagesCommon:n}=this;this._showPrompt({title:r.deleteWarningTitle,message:r.deleteWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:()=>{this.deleteFeatureFromWorkflow(),this._clearPrompt()}},secondary:{label:r.keepFeature,action:this._clearPrompt}}})},this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow(),this._onBack=r=>(r==null||r.stopPropagation(),this.viewModel.back()),this._onAttachmentAdd=()=>{var n;const{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"||r.type==="update"&&((n=r.activeWorkflow)==null?void 0:n.type)==="create-features"?(this._attachments.addFile(),r.back()):this._attachments.addAttachment().then(()=>r.back()))},this._onAttachmentUpdate=()=>{const{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"?(this._attachments.updateFile(),r.back()):this._attachments.updateAttachment().then(()=>r.back()))},this._onAttachmentDelete=()=>{const{messages:r,messagesCommon:n}=this;this._showPrompt({title:r.deleteAttachmentWarningTitle,message:r.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:r.keepAttachment,action:this._clearPrompt}}})},this._onAttachmentDeleteConfirm=async()=>{const r=this._attachments,{activeWorkflow:n}=this.viewModel;n&&(n.type==="create-features"?r.deleteFile():(await r.deleteAttachment(r.viewModel.activeAttachmentInfo),this._clearPrompt()),await n.back(),this._clearPrompt())},this._onAttachmentsError=r=>{this._showPrompt({title:this.messages.errorWarningTitle,message:r.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}})}}initialize(){this._featureForm.showPrompt=this._showPrompt,this._featureForm.clearPrompt=this._clearPrompt,this.addHandles([N(()=>tb(this.headingLevel),e=>{this._featureForm.headingLevel=e,this._featureTemplates.headingLevel=e},be),St(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:e})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(i=>i?e.allow():e.deny())}),Hi(()=>this.viewModel.featureFormViewModel,e=>{this._featureForm.viewModel=e},be),N(()=>this.viewModel,e=>{this._attachments.viewModel=(e==null?void 0:e.attachmentsViewModel)??null,this._featureTemplates.viewModel=(e==null?void 0:e.featureTemplatesViewModel)??null,this._spinner.viewModel=(e==null?void 0:e.spinnerViewModel)??null,e.showDiscardEditsPrompt=this._showDiscardEditsPrompt},be),N(()=>this.view,(e,i)=>{const r=`editor-${this.id}-spinner`;i==null||i.ui.remove(this._spinner,r),e==null||e.ui.add(this._spinner,{key:r,position:"manual"})},be),N(()=>[this.supportingWidgetDefaults,this.viewModel.sketchViewModel],([e])=>{var i;e&&(this._featureForm.set(e.featureForm),this._attachments.set(e.attachments),this._featureTemplates.set(e.featureTemplates),(i=this.viewModel.sketchViewModel)==null||i.set(e.sketch))},be),Hi(()=>{var e;return(e=this._attachments)==null?void 0:e.error},e=>this._onAttachmentsError(e)),Hi(()=>{var e;return(e=this.viewModel)==null?void 0:e.failures},e=>{const{messages:i}=this,[{error:r,retry:n,cancel:s}]=e;this._showPrompt({title:i.errorWarningTitle,message:Wr(i.errorWarningMessageTemplate,{errorMessage:r.message}),context:"warning",actions:{primary:{label:i.retry,action:()=>{n(),this._clearPrompt()}},secondary:{label:i.ignore,action:()=>{s(),this._clearPrompt()}}}})}),N(()=>{var e;return(e=this.viewModel)==null?void 0:e.state},e=>{switch(e){case"awaiting-feature-to-update":case"ready":case"disabled":this._filterText="",this._featureTemplates.filterText=""}}),N(()=>this.viewModel.featureFormDisabled,e=>this._featureForm.disabled=e)])}destroy(){this._attachments.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy()}loadDependencies(){return Promise.all([Gt({"flow-item":()=>k(()=>import("./calcite-flow-item-Dp3v--sg.js"),__vite__mapDeps([254,235,236,239,240,241,242,243,255,256,257,248,238,244,245,258,259,260,261,262,263,264,265])),flow:()=>k(()=>import("./calcite-flow-pVqs_qJ1.js"),__vite__mapDeps([253,242,239])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265]))}),n6e(),o6e(),JU(),_le(),xE(),j6e(),qDe(),z6e(),W6e()])}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}get _loading(){const{viewModel:e}=this;return e.syncing||e.updating||this._attachments.submitting}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(e){Ga(U.getLogger(this),"allowedWorkflows",{replacement:"visibleElements",version:"4.29",warnOnce:!0}),this.viewModel.allowedWorkflows=e}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(e){this.viewModel.hideTemplatesForInactiveLayers=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureCreation(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}startCreateFeaturesWorkflowAtFeatureEdit(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(e)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}startUpdateWorkflowAtFeatureEdit(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(e){return this.viewModel.cancelWorkflow(e)}render(){const{viewModel:e}=this,i=this.classes(Gg.base,K.widget,K.panel);return e?b("div",{class:i,key:"base"},b("calcite-flow",{key:"flow"},e.pageStack.map(r=>this._renderPage(r))),this._prompt?b(hoe,{...this._prompt,headingLevel:this.headingLevel}):void 0):b("div",{class:i,key:"empty"})}_renderPage(e){switch(e){case"disabled":break;case"ready":return this._renderReady();case"awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo();case"creating-features-upload-details":return this._renderUploadDetails();case"creating-features":return this._renderCreatingFeatures();case"editing-existing-feature":case"editing-attributes":return this._renderUpdateFeature();case"awaiting-update-feature-candidate":return this._renderFeatureList();case"adding-attachment":return this._renderAttachmentAdding();case"editing-attachment":return this._renderAttachmentEditing()}return b("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(){const{EditorPanel:e,messages:i}=this;return b(e,{heading:i.selectTemplate,key:"templates-panel"},b(tm,{key:"feature-templates"},b(rb,null,this._renderFeatureTemplates())))}_renderUploadDetails(){const{EditorPanel:e,activeWorkflow:i,messages:r}=this;if((i==null?void 0:i.type)!=="create-features")return null;const n=i.data.upload;return n?b(e,{heading:r.createFeatures,key:"upload-details-panel"},b(Z6e,{helpMessage:this._helpMessage,messages:r,upload:n})):null}_renderCreatingFeatures(){var u,d;const{EditorPanel:e,activeWorkflow:i,messages:r,messagesCommon:n,headingLevel:s,viewModel:o}=this;if(!i)return null;const a=i.type==="create-features"&&i.numPendingFeatures>0||i.type==="update"&&((u=i==null?void 0:i.activeWorkflow)==null?void 0:u.type)==="create-features"&&((d=i.activeWorkflow)==null?void 0:d.numPendingFeatures)>0;return b(e,{heading:r.createFeatures,key:"create-features-panel"},a?b(C7,{editorViewModel:o,headingLevel:s,messages:r,messagesCommon:n,renderAttachments:this._renderAttachments,renderFeatureForm:this._renderFeatureForm,onDelete:this._onDelete,onSave:this._onSave}):b(s6e,{helpMessage:this._helpMessage}))}_renderUpdateFeature(){const{EditorPanel:e,messages:i,messagesCommon:r,headingLevel:n,viewModel:s}=this;return b(e,{heading:i.editFeature,key:"update-feature-panel"},b(C7,{editorViewModel:s,headingLevel:n,messages:i,messagesCommon:r,renderAttachments:this._renderAttachments,renderFeatureForm:this._renderFeatureForm,onDelete:this._onDelete,onSave:this._onSave}))}_renderCustomTemplateGroupContent(e){const{messages:i,viewModel:r}=this,n=mb(e.group.items,s=>r.itemHasInvalidFormTemplate(s)?i.formFieldCreateError:void 0);return n?b(_M,{kind:"warning",message:n}):null}_renderAttachmentAdding(){const{EditorPanel:e,_attachments:i,messages:r,messagesCommon:n}=this;return b(e,{heading:r.addAttachment,key:"attachment-adding-panel"},b(tm,{key:"attachments"},this._renderAttachments()),b(uC,{buttons:[{label:i.submitting?n.cancel:n.add,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentAdd}]}))}_renderAttachmentEditing(){const{EditorPanel:e,_attachments:i,activeWorkflow:r,messages:n,messagesCommon:s}=this;return r?b(e,{heading:n.editAttachment,key:"attachment-editing-panel"},b(tm,{key:"attachments"},this._renderAttachments()),r.shouldAllowAttachmentEditing?b(uC,{buttons:[{label:s.update,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,onClick:this._onAttachmentDelete,disabled:i.submitting,label:s.delete}]}):void 0):null}_renderReady(){const{EditorPanel:e,messages:i,viewModel:r,visibleElements:n}=this,s=this._helpMessage;return b(e,{heading:i.widgetLabel,key:"landing-panel"},b(tm,{key:"landing-content"},r.editorItems.length?[n.editFeaturesSection?b(rb,{key:"edit-actions"},this._renderUpdateActions()):null,n.createFeaturesSection&&r.canCreateVisible?b(rb,{key:"create-actions"},this._renderCreateActions()):null]:b(ZU,{key:"no-content"},i.noEditableLayers)),s?b("div",{class:Gg.helpMessage,key:"footer-actions",slot:"footer"},s):void 0)}get _helpMessage(){var s;const{activeWorkflow:e,messages:i,view:r}=this,n=e==null?void 0:e.helpMessage;return n?(s=i[(r==null?void 0:r.type)==="3d"?"helpMessages3d":"helpMessages2d"])==null?void 0:s[n]:void 0}_renderUpdateActions(){var s;const{messages:e,messagesCommon:i,viewModel:r}=this,n={id:"select",label:i.select};return b("div",{class:Gg.updateActions,key:"update-actions"},b(Ya,{level:tb(this.headingLevel)},e.editFeatures),b("calcite-list",{class:Gg.updateActionsList,selectionAppearance:"border",selectionMode:"single"},_U({disabled:!r.canUpdateVisible,grouped:!1,item:n,selectedItem:((s=r.activeWorkflow)==null?void 0:s.stepId)==="awaiting-feature-to-update"?n:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return b("div",{key:"create-actions"},b(Ya,{level:tb(this.headingLevel)},this.messages.createFeatures),b("div",{class:Gg.featureTemplatesContainer,key:"templates"},this._renderFeatureTemplates()))}_renderFeatureList(){const{EditorPanel:e,viewModel:i}=this,{activeWorkflow:r}=i;if((r==null?void 0:r.type)!=="update")return null;const n=r.data.candidates,s=Wr(this.messages.multipleFeaturesTemplate,{total:n.length});return b(e,{heading:s,key:"feature-list"},b(a6e,{editorItems:i.editorItems,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:r,onFilterTextChange:o=>this._filterText=o,onSelectFeature:(o,a)=>i.selectFeature(o,a)}))}_showPromptAndWait({title:e,message:i,yesLabel:r,noLabel:n}){const s=fn(),{view:o}=this,a=o==null?void 0:o.focused;return this._showPrompt({title:e,message:i,context:"danger",actions:{primary:{label:r,action:()=>s.resolve(!0)},secondary:{label:n,action:()=>s.resolve(!1)}}}),s.promise.finally(()=>{this._clearPrompt(),a&&(o==null||o.focus())})}};l([c()],Dt.prototype,"_featureForm",void 0),l([c()],Dt.prototype,"_attachments",void 0),l([c()],Dt.prototype,"_featureTemplates",void 0),l([c()],Dt.prototype,"_filterText",void 0),l([c()],Dt.prototype,"_prompt",void 0),l([c()],Dt.prototype,"_spinner",void 0),l([c()],Dt.prototype,"_deleteButtonCommonInfo",null),l([c()],Dt.prototype,"_loading",null),l([c({readOnly:!0})],Dt.prototype,"activeWorkflow",null),l([c()],Dt.prototype,"allowedWorkflows",null),l([c()],Dt.prototype,"headingLevel",void 0),l([c()],Dt.prototype,"hideTemplatesForInactiveLayers",null),l([c()],Dt.prototype,"icon",null),l([c()],Dt.prototype,"label",null),l([c()],Dt.prototype,"labelOptions",null),l([c()],Dt.prototype,"layerInfos",null),l([c(),Ue("esri/widgets/Editor/t9n/Editor")],Dt.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Dt.prototype,"messagesCommon",void 0),l([c(),Ue("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Dt.prototype,"messagesTemplates",void 0),l([c()],Dt.prototype,"snappingOptions",null),l([c()],Dt.prototype,"tooltipOptions",null),l([c()],Dt.prototype,"supportingWidgetDefaults",void 0),l([c({type:Bk,nonNullable:!0})],Dt.prototype,"valueOptions",null),l([c()],Dt.prototype,"view",null),l([c(),km(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],Dt.prototype,"viewModel",void 0),l([c({type:ble,nonNullable:!0})],Dt.prototype,"visibleElements",void 0),l([c()],Dt.prototype,"_helpMessage",null),Dt=l([$("esri.widgets.Editor")],Dt);const rze=Dt,I$=Me()({AIX:"aix",EPS:"eps",GIF:"gif",JPG:"jpg",PDF:"pdf",PNG32:"png32",PNG8:"png8",SVG:"svg",SVGZ:"svgz",TIFF:"tiff"});let Vl=class extends q{constructor(e){super(e),this.state="pending",this.url=""}initialize(){this.addHandles(N(()=>[this.extension,this.name],()=>this._setFormattedFileName(),be))}_setFormattedFileName(){this.name&&this.extension&&(this.formattedName=this.count?`${this.name}(${this.count}).${this.extension}`:`${this.name}.${this.extension}`)}};l([c()],Vl.prototype,"count",void 0),l([c()],Vl.prototype,"error",void 0),l([c()],Vl.prototype,"extension",void 0),l([c()],Vl.prototype,"formattedName",void 0),l([c()],Vl.prototype,"name",void 0),l([c()],Vl.prototype,"portalItem",void 0),l([c()],Vl.prototype,"state",void 0),l([c()],Vl.prototype,"url",void 0),Vl=l([$("esri.widgets.Print.FileLink")],Vl);const Cle=Vl;function nze(t){var i;const e=t.layer;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)&&"floors"in t.view?kle(t.view.floors,e.floorInfo.floorField):null}function L7(t,e){var i;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)?kle(t,e.floorInfo.floorField):null}function kle(t,e){if(!(t!=null&&t.length))return null;const i=t.filter(r=>r!=="").map(r=>`'${r}'`);return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}var SD;let ec=SD=class extends q{constructor(t){super(t),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnColumnName=!1,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}static from(t){return r_(SD,t)}};l([c({type:le})],ec.prototype,"outSpatialReference",void 0),l([c({type:at})],ec.prototype,"processExtent",void 0),l([c({type:le})],ec.prototype,"processSpatialReference",void 0),l([c({nonNullable:!0})],ec.prototype,"returnColumnName",void 0),l([c({nonNullable:!0})],ec.prototype,"returnFeatureCollection",void 0),l([c({nonNullable:!0})],ec.prototype,"returnM",void 0),l([c({nonNullable:!0})],ec.prototype,"returnZ",void 0),ec=SD=l([$("esri.rest.geoprocessor.GPOptions")],ec);const tj=ec;let Ul=class extends j{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};l([c({type:at})],Ul.prototype,"extent",void 0),l([c()],Ul.prototype,"height",void 0),l([c()],Ul.prototype,"href",void 0),l([c()],Ul.prototype,"opacity",void 0),l([c()],Ul.prototype,"rotation",void 0),l([c()],Ul.prototype,"scale",void 0),l([c()],Ul.prototype,"visible",void 0),l([c()],Ul.prototype,"width",void 0),Ul=l([$("esri.layers.support.MapImage")],Ul);const sze=Ul,Lle={esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriUnknownUnits:"unknown",esriYards:"yards"},Yat=Me()(Lle),oze=Me()({...Lle,esriIntFeet:"international-feet",esriIntInches:"international-inches",esriIntMiles:"international-miles",esriIntNauticalMiles:"international-nautical-miles",esriIntYards:"international-yards"}),aze=Me()({esriAcres:"international-acres",esriAcresUS:"us-acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-international-feet",esriSquareFeetUS:"square-us-feet",esriSquareInches:"square-international-inches",esriSquareInchesUS:"square-us-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-international-miles",esriSquareMilesUS:"square-us-miles",esriSquareMillimeters:"square-millimeters",esriSquareYards:"square-international-yards",esriSquareYardsUS:"square-us-yards",esriUnknownAreaUnits:"unknown"}),Kat=Me()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"});Me()({esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds"});const Xat=Me()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards",esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds",esriNAUKilometersPerHour:"kilometers-per-hour",esriNAUMilesPerHour:"miles-per-hour",esriNAUUnknown:"unknown"}),Qat=Me()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTFeatureSets:"featuresets",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),elt=Me()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"});Me()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"});const tlt=Me()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"});Me()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"});Me()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"});const ilt=Me()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"}),rlt=Me()({0:"either-side-of-vehicle",1:"right-side-of-vehicle",2:"left-side-of-vehicle",3:"no-u-turn"},{useNumericKeys:!0}),nlt=Me()({0:"stop",1:"waypoint",2:"break"},{useNumericKeys:!0}),slt=Me()({0:"ok",1:"not-located",2:"network-element-not-located",3:"element-not-traversable",4:"invalid-field-values",5:"not-reached",6:"time-window-violation",7:"not-located-on-closest"},{useNumericKeys:!0}),olt=Me()({1:"right",2:"left"},{useNumericKeys:!0}),alt=Me()({0:"restriction",1:"scaled-cost",2:"added-cost"},{useNumericKeys:!0}),llt=Me()({0:"permit",1:"restrict"},{useNumericKeys:!0}),ult=Me()({1:"header",50:"arrive",51:"depart",52:"straight",100:"on-ferry",101:"off-ferry",102:"central-fork",103:"roundabout",104:"u-turn",150:"door",151:"stairs",152:"elevator",153:"escalator",154:"pedestrian-ramp",200:"left-fork",201:"left-ramp",202:"clockwise-roundabout",203:"left-handed-u-turn",204:"bear-left",205:"left-turn",206:"sharp-left",207:"left-turn-and-immediate-left-turn",208:"left-turn-and-immediate-right-turn",300:"right-fork",301:"right-ramp",302:"counter-clockwise-roundabout",303:"right-handed-u-turn",304:"bear-right",305:"right-turn",306:"sharp-right",307:"right-turn-and-immediate-left-turn",308:"right-turn-and-immediate-right-turn",400:"up-elevator",401:"up-escalator",402:"up-stairs",500:"down-elevator",501:"down-escalator",502:"down-stairs",1e3:"general-event",1001:"landmark",1002:"time-zone-change",1003:"traffic-event",1004:"scaled-cost-barrier-event",1005:"boundary-crossing",1006:"restriction-violation",1007:"lane"},{useNumericKeys:!0}),clt=Me()({0:"unknown",1:"segment",2:"maneuver-segment",3:"restriction-violation",4:"scaled-cost-barrier",5:"heavy-traffic",6:"slow-traffic",7:"moderate-traffic"},{useNumericKeys:!0}),dlt=Me()({"NA Campus":"campus","NA Desktop":"desktop","NA Navigation":"navigation"}),plt=Me()({Kilometers:"kilometers",Miles:"miles",Meters:"meters"},{ignoreUnknown:!1}),hlt=Me()({Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),mlt=Me()({Kilometers:"kilometers",Miles:"miles",Meters:"meters",Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),flt=Me()({"Any Hazmat Prohibited":"any-hazmat-prohibited","Avoid Carpool Roads":"avoid-carpool-roads","Avoid Express Lanes":"avoid-express-lanes","Avoid Ferries":"avoid-ferries","Avoid Gates":"avoid-gates","Avoid Limited Access Roads":"avoid-limited-access-roads","Avoid Private Roads":"avoid-private-roads","Avoid Roads Unsuitable for Pedestrians":"avoid-roads-unsuitable-for-pedestrians","Avoid Stairways":"avoid-stairways","Avoid Toll Roads":"avoid-toll-roads","Avoid Toll Roads for Trucks":"avoid-toll-roads-for-trucks","Avoid Truck Restricted Roads":"avoid-truck-restricted-roads","Avoid Unpaved Roads":"avoid-unpaved-roads","Axle Count Restriction":"axle-count-restriction","Driving a Bus":"driving-a-bus","Driving a Taxi":"driving-a-taxi","Driving a Truck":"driving-a-truck","Driving an Automobile":"driving-an-automobile","Driving an Emergency Vehicle":"driving-an-emergency-vehicle","Height Restriction":"height-restriction","Kingpin to Rear Axle Length Restriction":"kingpin-to-rear-axle-length-restriction","Length Restriction":"length-restriction","Preferred for Pedestrians":"preferred-for-pedestrians","Riding a Motorcycle":"riding-a-motorcycle","Roads Under Construction Prohibited":"roads-under-construction-prohibited","Semi or Tractor with One or More Trailers Prohibited":"semi-or-tractor-with-one-or-more-trailers-prohibited","Single Axle Vehicles Prohibited":"single-axle-vehicles-prohibited","Tandem Axle Vehicles Prohibited":"tandem-axle-vehicles-prohibited","Through Traffic Prohibited":"through-traffic-prohibited","Truck with Trailers Restriction":"truck-with-trailers-restriction","Use Preferred Hazmat Routes":"use-preferred-hazmat-routes","Use Preferred Truck Routes":"use-preferred-truck-routes",Walking:"walking","Weight Restriction":"weight-restriction"},{ignoreUnknown:!1}),ylt=Me()({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),glt=Me()({esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"envelope",esriGeometryMultipoint:"multipoint"}),vlt=Me()({esriNAUTCost:"cost",esriNAUTDescriptor:"descriptor",esriNAUTRestriction:"restriction",esriNAUTHierarchy:"hierarchy"}),blt=Me()({esriDSTAltName:"alt-name",esriDSTArrive:"arrive",esriDSTBranch:"branch",esriDSTCrossStreet:"cross-street",esriDSTCumulativeLength:"cumulative-length",esriDSTDepart:"depart",esriDSTEstimatedArrivalTime:"estimated-arrival-time",esriDSTExit:"exit",esriDSTGeneral:"general",esriDSTLength:"length",esriDSTServiceTime:"service-time",esriDSTStreetName:"street-name",esriDSTSummary:"summary",esriDSTTime:"time",esriDSTTimeWindow:"time-window",esriDSTToward:"toward",esriDSTViolationTime:"violation-time",esriDSTWaitTime:"wait-time"});let q1=class extends j{constructor(e){super(e),this.area=0,this.units=null}};l([c({json:{write:!0}})],q1.prototype,"area",void 0),l([oe(aze)],q1.prototype,"units",void 0),q1=l([$("esri.rest.support.ArealUnit")],q1);const lze=q1;let W1=class extends j{constructor(e){super(e),this.itemId=null,this.url=null}};l([c({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],W1.prototype,"itemId",void 0),l([c({type:String,json:{write:!0}})],W1.prototype,"url",void 0),W1=l([$("esri.rest.support.DataFile")],W1);const _O=W1;let Z1=class extends j{constructor(e){super(e),this.distance=0,this.units=null}};l([c({json:{write:!0}})],Z1.prototype,"distance",void 0),l([oe(oze)],Z1.prototype,"units",void 0),Z1=l([$("esri.rest.support.LinearUnit")],Z1);const uze=Z1,Jn="multi-value-",ij=new $e({GPArealUnit:"areal-unit",GPBoolean:"boolean",GPComposite:"composite",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",Field:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string",GPValueTable:"value-table","GPMultiValue:GPArealUnit":`${Jn}areal-unit`,"GPMultiValue:GPBoolean":`${Jn}boolean`,"GPMultiValue:GPComposite":`${Jn}composite`,"GPMultiValue:GPDataFile":`${Jn}data-file`,"GPMultiValue:GPDate":`${Jn}date`,"GPMultiValue:GPDouble":`${Jn}double`,"GPMultiValue:GPFeatureRecordSetLayer":`${Jn}feature-record-set-layer`,"GPMultiValue:Field":`${Jn}field`,"GPMultiValue:GPLinearUnit":`${Jn}linear-unit`,"GPMultiValue:GPLong":`${Jn}long`,"GPMultiValue:GPRasterData":`${Jn}raster-data`,"GPMultiValue:GPRasterDataLayer":`${Jn}raster-data-layer`,"GPMultiValue:GPRecordSet":`${Jn}record-set`,"GPMultiValue:GPString":`${Jn}string`});let a0=class extends j{constructor(e){super(e),this.dataType=null,this.paramName=null,this.value=null}};l([oe(ij,{ignoreUnknown:!1})],a0.prototype,"dataType",void 0),l([c()],a0.prototype,"paramName",void 0),l([c()],a0.prototype,"value",void 0),a0=l([$("esri.rest.support.ParameterValue")],a0);const cze=a0;let l0=class extends j{constructor(e){super(e),this.format=null,this.itemId=null,this.url=null}};l([c()],l0.prototype,"format",void 0),l([c({json:{read:{source:"itemID"},write:{target:"itemID"}}})],l0.prototype,"itemId",void 0),l([c()],l0.prototype,"url",void 0),l0=l([$("esri.rest.support.RasterData")],l0);const dze=l0;async function Ale(t,e,i,r,n){const s={},o={},a=[];return pze(r,a,s),Fre(a).then(u=>{const{outSpatialReference:d,processExtent:p,processSpatialReference:h,returnColumnName:m,returnFeatureCollection:y,returnM:g,returnZ:v}=i,{path:_}=eu(t);for(const x in s){const[C,O]=s[x];o[x]=u.slice(C,O)}const w=d?d.wkid||d:null,S=h?h.wkid||h:null,E=e==="execute"?{returnColumnName:m||void 0,returnFeatureCollection:y||void 0,returnM:g||void 0,returnZ:v||void 0}:null,T=dC({...p?{context:{extent:p,outSR:w,processSR:S}}:{"env:outSR":w,"env:processSR":S},...r,...E,f:"json"},null,o),M={...n,query:T};return Ee(`${_}/${e}`,M)})}function pze(t,e,i){for(const r in t){const n=t[r];if(n&&typeof n=="object"&&n instanceof Db){const{features:s}=n;i[r]=[e.length,e.length+s.length],s.forEach(o=>{e.push(o.geometry)})}}}async function $D(t,e){switch(t){case"areal-unit":return lze.fromJSON(e);case"boolean":case"double":case"long":case"string":case"value-table":return e;case"date":return new Date(e);case"data-file":return _O.fromJSON(e);case"linear-unit":return uze.fromJSON(e);case"feature-record-set-layer":if("url"in e)return _O.fromJSON(e);if("layerDefinition"in e){const i=new(await k(async()=>{const{default:s}=await Promise.resolve().then(()=>D2e);return{default:s}},void 0)).default,{layerDefinition:r,featureSet:n}=e;return i.read({layerDefinition:r,featureSet:n},{origin:"portal-item"}),i.spatialReference=le.fromJSON(n.spatialReference??r.spatialReference??r.extent.spatialReference),i}return Db.fromJSON(e);case"record-set":return"url"in e?_O.fromJSON(e):Db.fromJSON(e);case"raster-data":case"raster-data-layer":return"mapImage"in e?sze.fromJSON(e.mapImage):dze.fromJSON(e);case"field":return Ik.fromJSON(e)}}function hze(t){return t.startsWith(Jn)}function mze(t){return t.replace(Jn,"")}async function fze(t,e){const i=mze(t),r=i==="composite"?e.map(n=>$D(ij.fromJSON(n.dataType),n.value)):e.map(n=>$D(i,n));return Promise.all(r)}async function ED(t){const e=ij.fromJSON(t.dataType),{paramName:i}=t,r=hze(e)?await fze(e,t.value):await $D(e,t.value);return new cze({dataType:e,paramName:i,value:r})}function dC(t,e,i){for(const r in t){const n=t[r];Array.isArray(n)?t[r]=JSON.stringify(n.map(s=>dC({item:s},!0).item)):n instanceof Date&&(t[r]=n.getTime())}return Y$(t,e,i)}const A7=new $e({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let J1=class extends j{constructor(e){super(e),this.description=null,this.type=null}};l([c({type:String,json:{write:!0}})],J1.prototype,"description",void 0),l([c({type:String,json:{read:A7.read,write:A7.write}})],J1.prototype,"type",void 0),J1=l([$("esri.rest.support.GPMessage")],J1);const Ole=J1;async function Rle(t,e,i,r){return i=tj.from(i||{}),Ale(t,"execute",i,e??{},r).then(async({data:n})=>{var s,o;return{results:await Promise.all(((s=n.results)==null?void 0:s.map(ED))??[]),messages:((o=n.messages)==null?void 0:o.map(a=>Ole.fromJSON(a)))??[]}})}var SM;const yze=Me()({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"},{ignoreUnknown:!1}),O7=1e3;let Cd=SM=class extends j{constructor(t){super(t),this.jobId=null,this.jobStatus=null,this.messages=null,this.progress=null,this.requestOptions=null,this.sourceUrl=null,this._cancelJobTimer=void 0,this._jobCompletionTimer=void 0}async cancelJob(t){const{jobId:e,sourceUrl:i}=this,{path:r}=eu(i),n={...this.requestOptions,...t,query:{f:"json"}},s=`${r}/jobs/${e}/cancel`,{data:o}=await Ee(s,n),{messages:a,jobStatus:u,progress:d}=SM.fromJSON(o);return this.set({messages:a,jobStatus:u,progress:d}),u==="job-cancelled"?this:new Promise((p,h)=>{ks(n.signal,()=>{this._clearCancelJobTimer(),h(mt())}),this._clearCancelJobTimer(),this._cancelJobTimer=setInterval(()=>{this._cancelJobTimer||h(mt()),this.checkJobStatus(t).then(({jobStatus:m})=>{switch(m){case"job-cancelling":break;case"job-deleted":case"job-deleting":case"job-executing":case"job-failed":case"job-new":case"job-submitted":case"job-succeeded":case"job-timed-out":case"job-waiting":this._clearCancelJobTimer(),h(this);break;case"job-cancelled":this._clearCancelJobTimer(),p(this)}})},O7)})}destroy(){clearInterval(this._cancelJobTimer),clearInterval(this._jobCompletionTimer)}async checkJobStatus(t){const{path:e}=eu(this.sourceUrl),i={...this.requestOptions,...t,query:{f:"json"}},r=`${e}/jobs/${this.jobId}`,{data:n}=await Ee(r,i),{messages:s,jobStatus:o,progress:a}=SM.fromJSON(n);return this.set({messages:s,jobStatus:o,progress:a}),this}async fetchResultData(t,e,i){e=tj.from(e||{});const{returnColumnName:r,returnFeatureCollection:n,returnM:s,returnZ:o,outSpatialReference:a}=e,{path:u}=eu(this.sourceUrl),d=dC({returnColumnName:r||null,returnFeatureCollection:n||null,returnM:s||null,returnZ:o||null,outSR:a,returnType:"data",f:"json"},null),p={...this.requestOptions,...i,query:d},h=`${u}/jobs/${this.jobId}/results/${t}`,{data:m}=await Ee(h,p);return ED(m)}async fetchResultImage(t,e,i){const{path:r}=eu(this.sourceUrl),n={...e.toJSON(),f:"json"},s=dC(n),o={...this.requestOptions,...i,query:s},a=`${r}/jobs/${this.jobId}/results/${t}`,{data:u}=await Ee(a,o);return ED(u)}async fetchResultMapImageLayer(){const{path:t}=eu(this.sourceUrl),e=t.indexOf("/GPServer/"),i=`${t.slice(0,Math.max(0,e))}/MapServer/jobs/${this.jobId}`;return new(await k(async()=>{const{default:r}=await import("./MapImageLayer-D3RDKDRf.js");return{default:r}},__vite__mapDeps([356,357,154,155,72,70,71,26,25,27,156,24,358]))).default({url:i})}async waitForJobCompletion(t={}){const{interval:e=O7,signal:i,statusCallback:r}=t;return new Promise((n,s)=>{ks(i,()=>{this._clearJobCompletionTimer(),s(mt())}),this._clearJobCompletionTimer(),this._jobCompletionTimer=setInterval(()=>{this._jobCompletionTimer||s(mt()),this.checkJobStatus().then(({jobStatus:o})=>{switch(o){case"job-succeeded":this._clearJobCompletionTimer(),n(this);break;case"job-executing":case"job-new":case"job-submitted":case"job-waiting":r&&r(this);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-failed":case"job-timed-out":this._clearJobCompletionTimer(),s(this)}}).catch(o=>{this._clearJobCompletionTimer(),s(o)})},e)})}_clearCancelJobTimer(){clearInterval(this._cancelJobTimer),this._cancelJobTimer=void 0}_clearJobCompletionTimer(){clearInterval(this._jobCompletionTimer),this._jobCompletionTimer=void 0}};l([c()],Cd.prototype,"jobId",void 0),l([oe(yze,{ignoreUnknown:!1})],Cd.prototype,"jobStatus",void 0),l([c({type:[Ole]})],Cd.prototype,"messages",void 0),l([c()],Cd.prototype,"progress",void 0),l([c()],Cd.prototype,"requestOptions",void 0),l([c({json:{write:!0}})],Cd.prototype,"sourceUrl",void 0),Cd=SM=l([$("esri.rest.support.JobInfo")],Cd);const gze=Cd;async function Ple(t,e,i,r){return i=tj.from(i||{}),Ale(t,"submitJob",i,e??{},r).then(({data:n})=>{const s=gze.fromJSON(n);return s.sourceUrl=t,s})}const pC=new $e({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),Y1=pC.fromJSON.bind(pC),vze=pC.toJSON.bind(pC);function bze(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function _ze(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function R7(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function wze(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function Sze(t,e=15){const i=t.canvas.width,r=t.canvas.height,n=t.getImageData(0,0,i,r).data;let s,o,a,u,d,p;e:for(o=r;o--;)for(s=i;s--;)if(n[4*(i*o+s)+3]>e){p=o;break e}if(!p)return null;e:for(s=i;s--;)for(o=p+1;o--;)if(n[4*(i*o+s)+3]>e){d=s;break e}e:for(s=0;s<=d;++s)for(o=p+1;o--;)if(n[4*(i*o+s)+3]>e){a=s;break e}e:for(o=0;o<=p;++o)for(s=a;s<=d;++s)if(n[4*(i*o+s)+3]>e){u=o;break e}return{x:a,y:u,width:d-a,height:p-u}}function $ze(t,e){var n,s;const i=((n=e.color)==null?void 0:n.clone())??new ee([0,255,255]),r=((s=e.haloColor)==null?void 0:s.clone())??i.clone();switch(t){case"envelope":case"polygon":return i.a*=e.fillOpacity??.25,new Qo({color:i,outline:new yr({color:r}),style:"solid"});case"polyline":return new yr({color:r});default:return r.a=1,new Or({color:r,outline:null})}}function Eze(t,e){const i=t.allLayerViews.items;if(e===t.scale)return i.filter(n=>!n.suspended);const r=new Array;for(const n of i){const s=n.parent;s&&s!==n.view&&(Ize(s)||xze(s))&&!r.includes(s)||n.visible&&n.visibleAtCurrentTimeExtent&&UGe(n.layer.effectiveScaleRange,e)&&r.push(n)}return r}function Tze(t){return(t==null?void 0:t.type)==="bing-maps"}function Fle(t){return t&&"blendMode"in t&&"effect"in t}function Ize(t){return t.layer.type==="catalog"}function xze(t){return t.layer.type==="group"}function Mze(t){const e=t.layer;if(Fle(e)){const i=e.blendMode;if((!i||i==="normal")&&(e.effect||"featureEffect"in t&&t.featureEffect))return!0}return!1}let zr=class extends q{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format="png32",this.includeCharts=!1,this.includeTables=!1,this.label=null,this.layout="map-only",this.layoutItem=null,this.layoutOptions=null,this.outScale=0,this.report=null,this.reportItem=null,this.reportOptions=null,this.scalePreserved=!0,this.showLabels=!0}};l([c()],zr.prototype,"attributionVisible",void 0),l([c()],zr.prototype,"exportOptions",void 0),l([c()],zr.prototype,"forceFeatureAttributes",void 0),l([c()],zr.prototype,"format",void 0),l([c()],zr.prototype,"includeCharts",void 0),l([c()],zr.prototype,"includeTables",void 0),l([c()],zr.prototype,"label",void 0),l([c()],zr.prototype,"layout",void 0),l([c({type:so})],zr.prototype,"layoutItem",void 0),l([c()],zr.prototype,"layoutOptions",void 0),l([c()],zr.prototype,"outScale",void 0),l([c()],zr.prototype,"report",void 0),l([c({type:so})],zr.prototype,"reportItem",void 0),l([c()],zr.prototype,"reportOptions",void 0),l([c()],zr.prototype,"scalePreserved",void 0),l([c()],zr.prototype,"showLabels",void 0),zr=l([$("esri.rest.support.PrintTemplate")],zr);const Nle=zr,hC=new $e({"Attribute List Letter ANSI A Landscape":"attribute-list-letter-ansi-a-landscape","Attribute List Letter ANSI A Portrait":"attribute-list-letter-ansi-a-portrait","Attribute List With Group Letter ANSI A Landscape":"attribute-list-with-group-letter-ansi-a-landscape","Attribute List With Group Letter ANSI A Portrait":"attribute-list-with-group-letter-ansi-a-portrait","Page per Feature Letter ANSI A Landscape":"page-per-feature-letter-ansi-a-landscape","Page per Feature Letter ANSI A Portrait":"page-per-feature-letter-ansi-a-portrait"});hC.fromJSON.bind(hC);const Cze=hC.toJSON.bind(hC),P7={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},F7=new $e({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),kze=new $e({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),TD=new Map;async function Lze(t,e,i){var a;const r=await rj(t,i),n=await Oze(e,r);if(await Dle(t,i)==="sync"){const{results:u}=await Rle(t,n,void 0,i);return(a=u==null?void 0:u[0])==null?void 0:a.value}const s=await Ple(t,n,void 0,i);await s.waitForJobCompletion({interval:e.updateDelay});const{value:o}=await s.fetchResultData("Output_File",null,i);return o}async function rj(t,e){const i=Pze(t),r=TD.get(i)??{gpServerUrl:i,legendLayerNameMap:{},legendLayers:[]};return r.gpMetadata??(r.gpMetadata=(await Ee(i,J$({f:"json"},e))).data),r.cimVersion=r.gpMetadata.cimVersion,TD.set(i,r),r}async function Dle(t,e){return rBe(await rj(t,e))}async function Aze(t,e){return(await rj(t,e)).gpMetadata.tasks}async function Oze(t,e){var h,m,y,g,v;e=e||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]};const i=t.template||new Nle;i.showLabels==null&&(i.showLabels=!0);const r=i.exportOptions;let n;const s=vze(i.layout);if(r&&(n={dpi:r.dpi},(s==null?void 0:s.toLowerCase())==="map_only"||s==="")){const{width:_,height:w}=r;n.outputSize=_!=null&&w!=null?[_,w]:void 0}const o=i.layoutOptions;let a;if(o){let _,w;o.scalebarUnit==="Miles"||o.scalebarUnit==="Kilometers"?(_="Kilometers",w="Miles"):o.scalebarUnit!=="Meters"&&o.scalebarUnit!=="Feet"||(_="Meters",w="Feet"),a={titleText:o.titleText,authorText:o.authorText,copyrightText:o.copyrightText,customTextElements:o.customTextElements,elementOverrides:o.elementOverrides,scaleBarOptions:{metricUnit:F7.toJSON(_),metricLabel:_?P7[_]:void 0,nonMetricUnit:F7.toJSON(w),nonMetricLabel:w?P7[w]:void 0}}}let u=null;o!=null&&o.legendLayers&&(u=o.legendLayers.map(_=>{const w=_.layerId;e.legendLayerNameMap[w]=_.title;const S={id:w};return _.subLayerIds&&(S.subLayerIds=_.subLayerIds),S}));const d=await Rze(t,i,e);if(d.operationalLayers){const _=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),w=/[\u0600-\u06FF]/,S=E=>{var C;const T=E.text,M=E.font,x=(C=M==null?void 0:M.family)==null?void 0:C.toLowerCase();T&&M&&(x==="arial"||x==="arial unicode ms")&&(M.family=_.test(T)?"Arial Unicode MS":"Arial",M.style!=="normal"&&w.test(T)&&(M.family="Arial Unicode MS"))};for(const E of d.operationalLayers)if((h=E.featureCollection)!=null&&h.layers)for(const T of E.featureCollection.layers){if((g=(y=(m=T.layerDefinition)==null?void 0:m.drawingInfo)==null?void 0:y.renderer)!=null&&g.symbol){const M=T.layerDefinition.drawingInfo.renderer;M.symbol.type==="esriTS"&&S(M.symbol)}if((v=T.featureSet)!=null&&v.features)for(const M of T.featureSet.features)M.symbol&&M.symbol.type==="esriTS"&&S(M.symbol)}}t.outSpatialReference&&(d.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(d,{exportOptions:n,layoutOptions:a||{}}),Object.assign(d.layoutOptions,{legendOptions:{operationalLayers:u??e.legendLayers.slice()}}),e.legendLayers.length=0,TD.set(e.gpServerUrl,e);const p={Web_Map_as_JSON:JSON.stringify(d),Format:I$.toJSON(i.format),Layout_Template:s,Layout_Item_ID:void 0,Report_Template:Cze(i.report),Report_Item_ID:void 0};if(i.layoutItem){delete p.Layout_Template;const _=i.layoutItem;await _.load(),_.access!=="public"&&Te&&await Te.getCredential(e.gpServerUrl),p.Layout_Item_ID=JSON.stringify({id:_.id})}if(i.reportItem){delete p.Report_Template;const _=i.reportItem;await _.load(),_.access!=="public"&&Te&&await Te.getCredential(e.gpServerUrl),p.Report_Item_ID=JSON.stringify({id:_.id})}return t.extraParameters&&Object.assign(p,t.extraParameters),p}async function Rze(t,e,i){const r=t.view;let n=r.spatialReference;const s={operationalLayers:await Fze(r,e,i)};e.includeTables&&(s.tables=await Kze(r));let o=t.extent||i.ssExtent||r.extent;if(n!=null&&n.isWrappable&&(o=o.clone()._normalize(!0),n=o.spatialReference),s.mapOptions={extent:o&&o.toJSON(),spatialReference:n&&n.toJSON(),showAttribution:e.attributionVisible},i.ssExtent=null,r.background&&(s.background=r.background.toJSON()),r.rotation&&(s.mapOptions.rotation=-r.rotation),e.scalePreserved&&(s.mapOptions.scale=e.outScale||r.scale),r.timeExtent!=null){const a=r.timeExtent.start!=null?r.timeExtent.start.getTime():null,u=r.timeExtent.end!=null?r.timeExtent.end.getTime():null;s.mapOptions.time=[a,u]}return e.reportOptions&&(s.reportOptions=e.reportOptions),s}function Pze(t){let e=t;const i=e.lastIndexOf("/GPServer/");return i>0&&(e=e.slice(0,i+9)),e}async function Fze(t,e,i){var a;const r=[],n={layerView:null,printTemplate:e,view:t};let s=0;e.scalePreserved&&(s=e.outScale||t.scale);const o=Eze(t,s);for(const u of o){const d=u.layer;if(!d.loaded||"layers"in d)continue;let p;n.layerView=u,p=Mze(u)?await Yb(d,n,i):Tze(d)?Nze(d):(d==null?void 0:d.type)==="csv"?await Vze(d,n,i):(d==null?void 0:d.type)==="catalog-footprint"?await Dze(d,n,i):(d==null?void 0:d.type)==="feature"?await Uze(d,n,i):(d==null?void 0:d.type)==="geojson"?await jze(d,n,i):(d==null?void 0:d.type)==="graphics"?await Gze(d,n,i):(d==null?void 0:d.type)==="imagery"?zze(d,i):(d==null?void 0:d.type)==="imagery-tile"?await Bze(d,n,i):(d==null?void 0:d.type)==="kml"?await Hze(d,n,i):(d==null?void 0:d.type)==="map-image"?qze(d,n,i):(d==null?void 0:d.type)==="map-notes"?await Wze(n,i):(d==null?void 0:d.type)==="open-street-map"?Zze():(d==null?void 0:d.type)==="stream"?await Jze(d,n,i):(d==null?void 0:d.type)==="subtype-group"?await Yze(d,i):(d==null?void 0:d.type)==="tile"?Xze(d,i):(d==null?void 0:d.type)==="vector-tile"?await Qze(d,n,i):(d==null?void 0:d.type)==="web-tile"?eBe(d):(d==null?void 0:d.type)==="wms"?tBe(d,i):(d==null?void 0:d.type)==="wmts"?iBe(d):await Yb(d,n,i),p&&(Array.isArray(p)?r.push(...p):(p.id=d.id,p.title=i.legendLayerNameMap[d.id]||d.title,p.opacity=u.fullOpacity,p.minScale=d.minScale||0,p.maxScale=d.maxScale||0,Fle(d)&&d.blendMode&&d.blendMode!=="normal"&&(p.blendMode=d.blendMode),r.push(p)))}if(s)for(const u of r)u.minScale=0,u.maxScale=0;if((a=t.graphics)!=null&&a.length){const u=await Cc(null,t.graphics,e,i);u&&r.push(u)}return r}function Nze(t){return{culture:t.culture,key:t.key,type:"BingMaps"+(t.style==="aerial"?"Aerial":t.style==="hybrid"?"Hybrid":"Road")}}async function Dze(t,{layerView:e,printTemplate:i},r){if(parseFloat(r.cimVersion)<3.1)return Cc(t,await ME(e),i,r);const n=t.parent,s={id:(o=bu(n,"web-map")).id,url:o.url,layerType:o.layerType,customParameters:o.customParameters,dynamicGroupLayer:{visibility:!1},footprintLayer:o.footprintLayer,layerDefinition:o.layerDefinition};var o;return Om(s,n),s}async function Vze(t,e,i){t.legendEnabled&&i.legendLayers.push({id:t.id});const r=e.layerView,n=e.printTemplate;if(!(r.filter||t.portalItem&&t.portalItem.access!=="public")){const s=bu(t,"web-map");return s.type="CSV",delete s.popupInfo,delete s.layerType,s.showLabels=n.showLabels&&t.labelsVisible,s}return Cc(t,await ME(r),n,i)}async function Cc(t,e,i,r){var _,w,S,E,T,M;let n;const s=_ze(),o=wze(),a=R7(),u=bze(),d=R7();if(d.layerDefinition.name="textLayer",delete d.layerDefinition.drawingInfo,t){if(t.declaredClass==="esri.layers.FeatureLayer"||t.declaredClass==="esri.layers.StreamLayer"?s.layerDefinition.name=o.layerDefinition.name=a.layerDefinition.name=u.layerDefinition.name=r.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:t.declaredClass==="esri.layers.GraphicsLayer"&&(e=t.graphics.items),t.renderer){const x=t.renderer.toJSON(),C=s.layerDefinition.drawingInfo;C&&(C.renderer=x);const O=o.layerDefinition.drawingInfo;O&&(O.renderer=x);const F=a.layerDefinition.drawingInfo;F&&(F.renderer=x);const V=u.layerDefinition.drawingInfo;V&&(V.renderer=x)}if(i.showLabels&&t.labelsVisible&&typeof t.write=="function"){const x=bu(t,"web-map"),C=(w=(_=x.layerDefinition)==null?void 0:_.drawingInfo)==null?void 0:w.labelingInfo;if(C){n=!0;const O=s.layerDefinition.drawingInfo;O&&(O.labelingInfo=C);const F=o.layerDefinition.drawingInfo;F&&(F.labelingInfo=C);const V=a.layerDefinition.drawingInfo;V&&(V.labelingInfo=C);const z=u.layerDefinition.drawingInfo;z&&(z.labelingInfo=C)}}}let p;t!=null&&t.renderer||n||(delete s.layerDefinition.drawingInfo,delete o.layerDefinition.drawingInfo,delete a.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo);const h=t==null?void 0:t.fieldsIndex,m=t==null?void 0:t.renderer;if(h){const x=new Set;n&&await a1e(x,t),m&&typeof m.collectRequiredFields=="function"&&await m.collectRequiredFields(x,h),p=Array.from(x);const C=h.fields.map(O=>O.toJSON());s.layerDefinition.fields=C,o.layerDefinition.fields=C,a.layerDefinition.fields=C,u.layerDefinition.fields=C}const y=e==null?void 0:e.length;let g;for(let x=0;x<y;x++){const C=e[x]||e.at(x);if(C.visible!==!1&&C.geometry){if(g=C.toJSON(),g.hasOwnProperty("popupTemplate")&&delete g.popupTemplate,(S=g.geometry)!=null&&S.z&&delete g.geometry.z,g.symbol&&(g.symbol.angle||delete g.symbol.angle,EM(g.symbol)?g.symbol=await $M(g.symbol,r):g.symbol.text&&delete g.attributes),(!i||!i.forceFeatureAttributes)&&(p==null?void 0:p.length)){const O={};for(const F of p)(E=g.attributes)!=null&&E.hasOwnProperty(F)&&(O[F]=g.attributes[F]);g.attributes=O}C.geometry.type==="polygon"?s.featureSet.features.push(g):C.geometry.type==="polyline"?o.featureSet.features.push(g):C.geometry.type==="point"?(T=g.symbol)!=null&&T.text?d.featureSet.features.push(g):a.featureSet.features.push(g):C.geometry.type==="multipoint"?u.featureSet.features.push(g):C.geometry.type==="extent"&&(g.geometry=os.fromExtent(C.geometry).toJSON(),s.featureSet.features.push(g))}}const v=[s,o,u,a,d].filter(x=>x.featureSet.features.length>0);for(const x of v){const C=x.featureSet.features.every(O=>O.symbol);if(C&&(!i||!i.forceFeatureAttributes))for(const O of x.featureSet.features)delete O.attributes;C&&delete x.layerDefinition.drawingInfo,(M=x.layerDefinition.drawingInfo)!=null&&M.renderer&&await Vle(x.layerDefinition.drawingInfo.renderer,r)}return v.length?{featureCollection:{layers:v},showLabels:n}:null}async function Uze(t,e,i){var h,m,y,g,v,_,w,S,E,T,M,x;let r;const n=t.renderer,s=parseFloat(i.cimVersion);if(((h=t.featureReduction)==null?void 0:h.type)==="binning"||((m=t.featureReduction)==null?void 0:m.type)==="cluster"&&s<2.9||(n==null?void 0:n.type)==="pie-chart"||(n==null?void 0:n.type)==="dot-density"&&s<2.6)return Yb(t,e,i);t.legendEnabled&&i.legendLayers.push({id:t.id});const o=e.layerView,{printTemplate:a,view:u}=e,d=((y=t.source)==null?void 0:y.type)!=="feature-layer"&&((g=t.source)==null?void 0:g.type)!=="ogc-feature";if(o.filter||d||!n||"field"in n&&n.field!=null&&!t.getField(n.field)){const C=await ME(o);r=await Cc(t,C,a,i)}else{if(r={id:(p=bu(t)).id,title:p.title,url:p.url,layerType:p.layerType,customParameters:p.customParameters,layerDefinition:p.layerDefinition,charts:a.includeCharts?p.charts:void 0},r.showLabels=a.showLabels&&t.labelsVisible,Om(r,t),(_=(v=r.layerDefinition)==null?void 0:v.featureReduction)==null||delete _.disablePopup,(S=(w=r.layerDefinition)==null?void 0:w.featureReduction)==null||delete S.popupInfo,((T=(E=r.layerDefinition)==null?void 0:E.drawingInfo)==null?void 0:T.renderer)&&(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,await Vle(r.layerDefinition.drawingInfo.renderer,i),"visualVariables"in n&&((M=n.visualVariables)==null?void 0:M[0]))){const O=n.visualVariables[0];if(O.type==="size"&&O.maxSize&&typeof O.maxSize!="number"&&O.minSize&&typeof O.minSize!="number"){const F=Oee(O,u.scale);r.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=F.minSize,r.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=F.maxSize}}const C=nze(o);if(C&&(r.layerDefinition??(r.layerDefinition={}),r.layerDefinition.definitionExpression=r.layerDefinition.definitionExpression?`(${r.layerDefinition.definitionExpression}) AND (${C})`:C),t.gdbVersion&&(r.layerDefinition??(r.layerDefinition={}),r.layerDefinition.gdbVersion=t.gdbVersion),((x=o.hasHighlight)==null?void 0:x.call(o))&&"getHighlightIds"in o){const O=o;r.selectionObjectIds=O.getHighlightIds(),r.selectionSymbol=$ze(t.geometryType,O.highlightOptions??u.highlightOptions)}}var p;return r}async function jze(t,e,i){var r,n;return((r=t.featureReduction)==null?void 0:r.type)==="binning"||((n=t.featureReduction)==null?void 0:n.type)==="cluster"?Yb(t,e,i):(t.legendEnabled&&i.legendLayers.push({id:t.id}),Cc(t,await ME(e.layerView),e.printTemplate,i))}async function Gze(t,{printTemplate:e},i){return Cc(t,null,e,i)}function zze(t,e){var n;t.legendEnabled&&e.legendLayers.push({id:t.id});const i={layerType:(r=bu(t)).layerType,customParameters:r.customParameters};var r;return i.bandIds=t.bandIds,i.compressionQuality=t.compressionQuality,i.format=t.format,i.interpolation=t.interpolation,(t.mosaicRule||t.definitionExpression)&&(i.mosaicRule=t.exportImageServiceParameters.mosaicRule.toJSON()),t.rasterFunction&&(i.renderingRule=t.rasterFunction.toJSON()),t.renderer&&(i.layerDefinition??(i.layerDefinition={}),(n=i.layerDefinition).drawingInfo??(n.drawingInfo={}),i.layerDefinition.drawingInfo.renderer=t.renderer.toJSON()),Om(i,t),i}async function Bze(t,e,i){var s;if(((s=t.renderer)==null?void 0:s.type)==="flow")return Yb(t,e,i);t.legendEnabled&&i.legendLayers.push({id:t.id});const r={bandIds:(n=bu(t)).bandIds,customParameters:n.customParameters,interpolation:n.interpolation,layerDefinition:n.layerDefinition};var n;return r.layerType="ArcGISImageServiceLayer",Om(r,t),r}async function Hze(t,e,i){const r=e.printTemplate;if(!t.portalItem||t.portalItem.access==="public"){const d=bu(t,"web-map");return d.type="kml",delete d.layerType,d.url=kn(t.url),d}const n=[],s=e.layerView,o="data:image/png;base64,";s.allVisibleMapImages.forEach((d,p)=>{const h={id:`${t.id}_image${p}`,type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:s.fullOpacity,extent:d.extent};d.href.startsWith(o)?h.imageData=d.href.slice(o.length):h.url=d.href,n.push(h)});const a=[...s.allVisiblePoints.items,...s.allVisiblePolylines.items,...s.allVisiblePolygons.items],u={id:t.id,...await Cc(null,a,r,i)};return n.push(u),n}function qze(t,{view:e},i){var d,p;let r;const n={id:t.id,subLayerIds:[]};let s=[];const o=e.scale,a=h=>{const m=o===0,y=h.minScale===0||o<=h.minScale,g=h.maxScale===0||o>=h.maxScale;if(h.visible&&(m||y&&g))if(h.sublayers)h.sublayers.forEach(a);else{const v=h.toExportImageJSON(),_={id:h.id,name:h.title,layerDefinition:{drawingInfo:v.drawingInfo,definitionExpression:v.definitionExpression,source:v.source}};s.unshift(_),n.subLayerIds.push(h.id)}};var u;return t.sublayers&&t.sublayers.forEach(a),s.length&&(s=s.map(({id:h,name:m,layerDefinition:y})=>({id:h,name:m,layerDefinition:y})),r={layerType:(u=bu(t)).layerType,customParameters:u.customParameters},r.layers=s,r.visibleLayers=(p=(d=t.capabilities)==null?void 0:d.exportMap)!=null&&p.supportsDynamicLayers?void 0:n.subLayerIds,t.gdbVersion&&(r.gdbVersion=t.gdbVersion),Om(r,t),t.legendEnabled&&i.legendLayers.push(n)),r}async function Wze({layerView:t,printTemplate:e},i){const r=[],n=t.layer;if(n.featureCollections!=null)for(const s of n.featureCollections){const o=await Cc(s,s.source,e,i);o&&r.push(...o.featureCollection.layers)}else if(n.sublayers!=null)for(const s of n.sublayers){const o=await Cc(null,s.graphics,e,i);o&&r.push(...o.featureCollection.layers)}return{featureCollection:{layers:r}}}function Zze(){return{type:"OpenStreetMap"}}async function Yb(t,{printTemplate:e,view:i},r){var h;const n={type:"image"},s={format:"png",ignoreBackground:!0,ignorePadding:!0,layers:[t]};i.rotation!==0&&(s.rotation=0);const o=r.ssExtent||i.state.extent.clone();let a=96,u=!0,d=!0;if(e.exportOptions){const m=e.exportOptions;m.dpi!=null&&m.dpi>0&&(a=m.dpi),m.width!=null&&m.width>0&&(u=m.width%2==i.width%2),m.height!=null&&m.height>0&&(d=m.height%2==i.height%2)}if(e.layout==="map-only"&&e.scalePreserved&&(!e.outScale||e.outScale===i.scale)&&a===96&&(!u||!d)&&i.state.extent.equals(i.extent)&&(s.area={x:0,y:0,width:i.width,height:i.height},u||(s.area.width-=1),d||(s.area.height-=1),!r.ssExtent)){const m=i.toMap(Mi(s.area.width,s.area.height));o.ymin=m.y,o.xmax=m.x,r.ssExtent=o}n.extent=o.clone()._normalize(!0).toJSON();const p=await i.takeScreenshot(s);return n.imageData=(h=dm(p.dataUrl))==null?void 0:h.data,n}async function Jze(t,{layerView:e,printTemplate:i},r){return t.legendEnabled&&r.legendLayers.push({id:t.id}),Cc(t,await ME(e),i,r)}async function Yze(t,e){if(t.legendEnabled)for(const n of t.sublayers)n.legendEnabled&&e.legendLayers.push({id:n.id});const i={customParameters:(r=bu(t)).customParameters,effect:r.effect,layerDefinition:r.layerDefinition,layerType:r.layerType,layers:r.layers,url:r.url};var r;if(Array.isArray(i.layers))for(const n of i.layers)delete n.popupInfo;return Om(i,t),i}async function Kze(t){var n,s;const e=[],i=[];for(const o of t.map.allTables)o.type!=="feature"||o.loaded||i.push(o.load());i.length&&await Promise.allSettled(i);for(const o of t.map.allTables)if(o.type==="feature"&&o.loaded&&o.isTable&&((n=o.source)==null?void 0:n.type)==="feature-layer"){const a={id:(r=bu(o)).id,title:r.title,customParameters:r.customParameters,layerDefinition:{definitionExpression:(s=r.layerDefinition)==null?void 0:s.definitionExpression},url:r.url};Om(a,o),e.push(a)}var r;return e.length?e:void 0}function Xze(t,e){t.legendEnabled&&e.legendLayers.push({id:t.id});const i={layerType:(r=bu(t)).layerType,customParameters:r.customParameters};var r;return Om(i,t),i}async function Qze(t,e,i){const r=e.layerView;if(t.serviceUrl&&t.styleUrl&&!r.spriteSourceChanged&&!r.styleChanged){const n=f2(t.styleUrl,t.apiKey),s=f2(t.serviceUrl,t.apiKey);if(!n&&!s||i.cimVersion!=="2.1.0"){const o={type:"VectorTileLayer"};return o.styleUrl=kn(t.styleUrl),o.token=n,s!==n&&(o.additionalTokens=[{url:t.serviceUrl,token:s}]),o}}return Yb(t,e,i)}function eBe(t){var r;const e=(r=t.urlTemplate)==null?void 0:r.replace(/\${/g,"{"),i={type:"WebTiledLayer",urlTemplate:e,credits:t.copyright};return t.subDomains&&t.subDomains.length>0&&(i.subDomains=t.subDomains),i}function tBe(t,e){let i;const r=[],n=s=>{s.visible&&(s.sublayers?s.sublayers.forEach(n):s.name&&r.unshift(s.name))};return t.sublayers&&t.sublayers.forEach(n),r.length&&(t.legendEnabled&&e.legendLayers.push({id:t.id,subLayerIds:r}),i={type:"wms",customLayerParameters:t.customLayerParameters,customParameters:t.customParameters,transparentBackground:t.imageTransparency,visibleLayers:r,url:kn(t.url),version:t.version}),i}function iBe(t){const e=t.activeLayer;return{type:"wmts",customLayerParameters:t.customLayerParameters,customParameters:t.customParameters,format:e.imageFormat,layer:e.id,style:e.styleId,tileMatrixSet:e.tileMatrixSetId,url:kn(t.url)}}function Om(t,e){e.url&&(t.url=kn(t.url||e.url),t.token=f2(t.url,e.apiKey))}async function $M(t,e){var o;e.canvas||(e.canvas=document.createElement("canvas"));const i=1024;e.canvas.width=i,e.canvas.height=i;const r=e.canvas.getContext("2d");let n,s;if(t.path){const a=new Path2D(t.path);a.closePath(),r.fillStyle=Array.isArray(t.color)?`rgba(${t.color[0]},${t.color[1]},${t.color[2]},${t.color[3]/255})`:"rgb(0,0,0)",r.fill(a);const u=Sze(r);if(!u)return null;r.clearRect(0,0,i,i);const d=si(t.size)/Math.max(u.width,u.height);r.scale(d,d);const p=i/d,h=p/2-u.width/2-u.x,m=p/2-u.height/2-u.y;if(r.translate(h,m),Array.isArray(t.color)&&r.fill(a),((o=t.outline)==null?void 0:o.width)&&Array.isArray(t.outline.color)){const g=t.outline;r.lineWidth=si(g.width)/d,r.lineJoin="round",r.strokeStyle=`rgba(${g.color[0]},${g.color[1]},${g.color[2]},${g.color[3]/255})`,r.stroke(a),u.width+=r.lineWidth,u.height+=r.lineWidth}u.width*=d,u.height*=d;const y=r.getImageData(i/2-u.width/2,i/2-u.height/2,Math.ceil(u.width),Math.ceil(u.height));n=y.width,s=y.height,r.canvas.width=n,r.canvas.height=s,r.putImageData(y,0,0)}else{const a=t.contentType==="image/svg+xml"?"data:image/svg+xml;base64,"+t.imageData:t.url,u=(await Ee(a,{responseType:"image"})).data;n=si(t.width),s=si(t.height),r.canvas.width=n,r.canvas.height=s,r.drawImage(u,0,0,r.canvas.width,r.canvas.height)}return{type:"esriPMS",imageData:r.canvas.toDataURL("image/png").slice(22),angle:t.angle,contentType:"image/png",height:Jr(s),width:Jr(n),xoffset:t.xoffset,yoffset:t.yoffset}}async function Vle(t,e){const i=t.type;if(i==="simple"&&EM(t.symbol))t.symbol=await $M(t.symbol,e);else if(i==="uniqueValue"||i==="classBreaks"){EM(t.defaultSymbol)&&(t.defaultSymbol=await $M(t.defaultSymbol,e));const r=t[i==="uniqueValue"?"uniqueValueInfos":"classBreakInfos"];if(r)for(const n of r)EM(n.symbol)&&(n.symbol=await $M(n.symbol,e))}}async function ME(t){return t.queryFeatures(t.createQuery()).then(e=>e.features)}function bu(t,e){return t.write({},{ignorePersistenceEnabled:!0,origin:e})??{}}function rBe(t){var e;return(e=t.gpMetadata)!=null&&e.executionType?kze.fromJSON(t.gpMetadata.executionType):"sync"}function EM(t){var e;return t&&(t.path||t.contentType==="image/svg+xml"||((e=t.url)==null?void 0:e.endsWith(".svg")))}let kd=class extends q{constructor(e){super(e),this.extent=null,this.extraParameters=null,this.outSpatialReference=null,this.template=null,this.updateDelay=1e3,this.view=null}};l([c()],kd.prototype,"extent",void 0),l([c()],kd.prototype,"extraParameters",void 0),l([c()],kd.prototype,"outSpatialReference",void 0),l([c()],kd.prototype,"template",void 0),l([c()],kd.prototype,"updateDelay",void 0),l([c()],kd.prototype,"view",void 0),kd=l([$("esri.rest.support.PrintParameters")],kd);const nBe=kd;let er=class extends q{constructor(e){super(e),this.strokeDash=[],this.strokeWidth=2,this.strokeColor=[0,0,0,1],this.strokeBackgroundColor=[0,0,0,0],this.fillColor=[0,0,0,0],this.backgroundFillColor=[0,0,0,.5],this.visible=!0,this.isDecoration=!1,this.boxWidth=0,this.boxHeight=0,this.backgroundWidth=0,this.backgroundHeight=0,this.padding={left:0,top:0,right:0,bottom:0}}get _strokeStyle(){return`rgba(${this.strokeColor.join()})`}get _strokeBackgroundStyle(){return`rgba(${this.strokeBackgroundColor.join()})`}get _fillStyle(){return`rgba(${this.fillColor.join()})`}get _backgroundFillStyle(){return`rgba(${this.backgroundFillColor.join()})`}render(){const{backgroundWidth:e,backgroundHeight:i,boxWidth:r,boxHeight:n,padding:s}=this,o=s.left,a=s.top,u=this.x??o+e/2-r/2,d=this.y??a+i/2-n/2,p=u+r,h=d+n;return b("div",{classes:{"esri-box-overlay-item":!0},styles:{left:"0px",top:"0px",width:"100%",height:"100%",visibility:this.visible?"visible":"hidden"}},b("svg",{styles:{width:"100%",height:"100%"}},b("path",{d:`M ${o} ${a} L ${e+o} ${a} L ${e+o} ${i+a} L ${o} ${i+a} Z M ${u} ${d} L ${u} ${h} L ${p} ${h} L ${p} ${d} Z`,fill:this._backgroundFillStyle,stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),b("rect",{fill:this._fillStyle,height:n,stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.join(" ")||void 0,"stroke-width":this.strokeWidth,width:r,x:u,y:d})))}renderCanvas(){}};l([c()],er.prototype,"strokeDash",void 0),l([c()],er.prototype,"strokeWidth",void 0),l([c()],er.prototype,"strokeColor",void 0),l([c()],er.prototype,"strokeBackgroundColor",void 0),l([c()],er.prototype,"fillColor",void 0),l([c()],er.prototype,"backgroundFillColor",void 0),l([c()],er.prototype,"visible",void 0),l([c()],er.prototype,"isDecoration",void 0),l([c()],er.prototype,"boxWidth",void 0),l([c()],er.prototype,"boxHeight",void 0),l([c()],er.prototype,"backgroundWidth",void 0),l([c()],er.prototype,"backgroundHeight",void 0),l([c()],er.prototype,"x",void 0),l([c()],er.prototype,"y",void 0),l([c()],er.prototype,"padding",void 0),l([c({readOnly:!0})],er.prototype,"_strokeStyle",null),l([c({readOnly:!0})],er.prototype,"_strokeBackgroundStyle",null),l([c({readOnly:!0})],er.prototype,"_fillStyle",null),l([c({readOnly:!0})],er.prototype,"_backgroundFillStyle",null),er=l([$("esri.views.overlay.BoxOverlayItem")],er);const sBe=er;async function Ule(t,e,i){if(!t)throw new L("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:t});if(await Dle(t)==="async"){const r=await Ple(t,e,void 0,i||void 0);return await r.waitForJobCompletion(),(await r.fetchResultData("Output_JSON")).value}return(await Rle(t,e,null,i)).results[0].value}let bs=class extends j{constructor(e){super(e),this.description=null,this.format=null,this.state="not-loaded",this.label=null,this.layoutInfoTaskUrl=null,this.layout=null,this.layoutItem=null,this.layoutOptions=null,this.layoutTemplateInfo=null,this.type=null}get id(){var e;return((e=this.layoutItem)==null?void 0:e.id)??`${this.layout}-${I4(JSON.stringify(this.toJSON()))}`}get mapSurroundInfoOptions(){var r,n,s;const e=(n=(r=this.layoutTemplateInfo)==null?void 0:r.layoutOptions)==null?void 0:n.mapSurroundInfos;if(!e)return null;const i={northArrow:[],scaleBar:[],legend:[]};for(const o of e)switch(o.type){case"CIMMarkerNorthArrow":i.northArrow.push(o);break;case"CIMScaleLine":i.scaleBar.push(o);break;case"CIMGroupElement":(s=o.elements)!=null&&s.some(a=>a.type==="CIMScaleLine")&&i.scaleBar.push(o);break;case"CIMLegend":i.legend.push(o)}return i}async fetchLayoutItemTemplateInfo(e){var r,n;const{layoutItem:i}=this;if(i!=null&&i.id&&!this.layoutTemplateInfo&&this.state!=="loaded")try{this._set("state","loading");const s=this.layoutInfoTaskUrl;if(!s)throw new L("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:s});i.access!=="public"&&Te&&await Te.getCredential(s);const o={Layout_Item_ID:JSON.stringify({id:i.id})},a=(await Ule(s,o,e))[0];this._set("layoutTemplateInfo",a);const{hasLegend:u}=a.layoutOptions,d=((r=this.mapSurroundInfoOptions)==null?void 0:r.northArrow.some(({visible:h})=>h))??!1,p=((n=this.mapSurroundInfoOptions)==null?void 0:n.scaleBar.some(({visible:h})=>h))??!1;this._set("layoutOptions",{legend:u,northArrow:d,scaleBar:p}),this._set("state","loaded")}catch(s){this._set("state",rr(s)?"not-loaded":"error")}}setLayoutTemplateInfo(e){this._set("layoutTemplateInfo",e),this._set("state","loaded")}};l([c({json:{write:!0}})],bs.prototype,"description",void 0),l([oe(I$)],bs.prototype,"format",void 0),l([c({readOnly:!0})],bs.prototype,"id",null),l([c({readOnly:!0})],bs.prototype,"state",void 0),l([c({json:{write:!0}})],bs.prototype,"label",void 0),l([c()],bs.prototype,"layoutInfoTaskUrl",void 0),l([c({json:{read:Y1,write:!0}})],bs.prototype,"layout",void 0),l([c({type:so,json:{write:!0}})],bs.prototype,"layoutItem",void 0),l([c({readOnly:!0,json:{write:!0}})],bs.prototype,"layoutOptions",void 0),l([c({readOnly:!0})],bs.prototype,"layoutTemplateInfo",void 0),l([c({readOnly:!0})],bs.prototype,"mapSurroundInfoOptions",null),l([c()],bs.prototype,"type",void 0),bs=l([$("esri.widgets.Print.CustomTemplate")],bs);const u0=bs;let Di=class extends q{constructor(e){super(e),this._abortController=null,this.attributionEnabled=!0,this.author=null,this.copyright=null,this.customTextElements=null,this.dpi=96,this.fileName=null,this.forceFeatureAttributes=!1,this.format="pdf",this.height=null,this.includeTables=!0,this.id=null,this.state="ready",this.layout="letter-ansi-a-landscape",this.layoutItem=null,this.legendEnabled=!0,this.northArrowEnabled=!1,this.scale=null,this.scaleBarEnabled=!1,this.scaleEnabled=!1,this.title=null,this.width=null}async applyTemplate(e,i){var r,n,s;if(((e==null?void 0:e.id)!==this.id||(e==null?void 0:e.state)==="error")&&(this._abortController&&(this._abortController.abort(),this._abortController=null),e)){if(this._set("state","pending"),this._resetMapSurroundInfoOptions(),this._set("id",e.id),this.set({layout:e.layout,layoutItem:e.layoutItem}),!e.layoutOptions&&e.layoutItem){const o=new AbortController;if(this._abortController=o,await e.fetchLayoutItemTemplateInfo({signal:this._abortController.signal}),e.state!=="loaded")return e.state==="error"&&this._set("state","error"),this._abortController!==o?void 0:void(this._abortController=null);this._abortController=null}this.set({customTextElements:i?R(i):this.customTextElements,format:this.format??e.format,legendEnabled:((r=e.layoutOptions)==null?void 0:r.legend)??this.legendEnabled,northArrowEnabled:((n=e.layoutOptions)==null?void 0:n.northArrow)??this.northArrowEnabled,scaleBarEnabled:((s=e.layoutOptions)==null?void 0:s.scaleBar)??this.scaleBarEnabled}),this._set("state","ready")}}reset(){this._set("id",null),this._set("state","ready"),this.set({layout:null,layoutItem:null,customTextElements:null}),this._resetMapSurroundInfoOptions()}_resetMapSurroundInfoOptions(){this.set({legendEnabled:!0,northArrowEnabled:!1,scaleBarEnabled:!1})}};l([c()],Di.prototype,"attributionEnabled",void 0),l([c()],Di.prototype,"author",void 0),l([c()],Di.prototype,"copyright",void 0),l([c()],Di.prototype,"customTextElements",void 0),l([c()],Di.prototype,"dpi",void 0),l([c()],Di.prototype,"fileName",void 0),l([c()],Di.prototype,"forceFeatureAttributes",void 0),l([c()],Di.prototype,"format",void 0),l([c()],Di.prototype,"height",void 0),l([c()],Di.prototype,"includeTables",void 0),l([c({readOnly:!0})],Di.prototype,"id",void 0),l([c({readOnly:!0})],Di.prototype,"state",void 0),l([c()],Di.prototype,"layout",void 0),l([c({type:so})],Di.prototype,"layoutItem",void 0),l([c()],Di.prototype,"legendEnabled",void 0),l([c()],Di.prototype,"northArrowEnabled",void 0),l([c()],Di.prototype,"scale",void 0),l([c()],Di.prototype,"scaleBarEnabled",void 0),l([c()],Di.prototype,"scaleEnabled",void 0),l([c()],Di.prototype,"title",void 0),l([c()],Di.prototype,"width",void 0),Di=l([$("esri.widgets.Print.TemplateOptions")],Di);const jle=Di,oBe=[30,144,255,255],N7=[237,211,23,255],aBe=[216,48,32,255],lBe=new Set(["GISProfessionalStdUT","GISProfessionalAdvUT"]),uBe=/(\/GPServer\/).+/i,cBe=new $e({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),nb=Y.ofType(u0);function dBe(t){var i;t.layoutOptions??(t.layoutOptions={}),(i=t.layoutOptions).customTextElements??(i.customTextElements=[]);const e="date";if(!t.layoutOptions.customTextElements.find(r=>e in r)){const{customTextElements:r}=t.layoutOptions;let n=hr(Date.now(),Ms("short-date"));lY()==="ar"&&(n="‏"+n),r.push({date:n})}}function D7(t,e,i){e&&e.visible!==i&&t.layoutOptions&&(t.layoutOptions.elementOverrides?t.layoutOptions.elementOverrides[e.name]={visible:i}:t.layoutOptions.elementOverrides={[e.name]:{visible:i}})}let ti=class extends uo{constructor(e){super(e),this._serviceTemplateCustomTextElements=null,this._templateIdToCustomTemplate=new ip,this._isFreeHand=!1,this._freeHandWidth=0,this._freehandHeight=0,this._asyncPrintTaskUrl=null,this._layoutInfoTaskUrl=null,this.allowedFormats="all",this.allowedLayouts="all",this.browseTemplates=new nb,this.defaultTemplates=new nb,this.error=null,this.extraParameters=null,this.includeDefaultTemplates=!0,this.outSpatialReference=null,this.portal=ki.getDefault(),this.portalTemplateIds=[],this.printServiceTemplates=new nb,this.defaultTemplate=null,this.showPrintAreaEnabled=!1,this.printServiceUrl=null,this.printTimeout=12e4,this.templatesInfo=null,this.updateDelay=1e3,this.view=null,this.templateCustomTextElements=null,this.templateOptions=new jle}initialize(){this.addHandles([N(()=>[this.showPrintAreaEnabled,this.view],()=>{var e,i;this.showPrintAreaEnabled?this._enablePrintPreview():(this.removeHandles("overlay-handler"),(i=(e=this.view)==null?void 0:e.overlay)==null||i.removeItem(this._getOverlayItem()))}),N(()=>[this.templateOptions.layout,this.templateOptions.layoutItem],()=>{this.loaded&&this._processTemplateOptions()})])}destroy(){var e;this.removeHandles("overlay-handler"),this.view&&(this._overlayItem&&((e=this.view.overlay)==null||e.removeItem(this._overlayItem),this._overlayItem.destroy(),this._overlayItem=null),this.view=null)}get effectivePrintServiceUrl(){return this.printServiceUrl??null}get effectiveTemplateCustomTextElements(){if(!this._serviceTemplateCustomTextElements)return{};const e=R(this._serviceTemplateCustomTextElements);return this.templateCustomTextElements&&Object.keys(this.templateCustomTextElements).forEach(i=>{var n;const r=e[i];if(r){const s=(n=this.templateCustomTextElements)==null?void 0:n[i];r.forEach(o=>{const[a]=Object.entries(o)[0];s==null||s.forEach(u=>{const[d,p]=Object.entries(u)[0];a===d&&(o[a]=p)})})}}),Object.freeze(e)}get state(){var e;return this.loadStatus==="loading"?"initializing":this.loadStatus==="failed"||this.error?"error":this.loadStatus==="loaded"&&((e=this.view)!=null&&e.ready)?"ready":"disabled"}async load(e){return this.addResolvingPromise(this._loadResources(e).catch(i=>this.error=i)),this}async print(e){var d;const{view:i,extraParameters:r,updateDelay:n,outSpatialReference:s}=this;if(!i)throw new L("print:view-required","view is not set");dBe(e);const o=this._getOverlayItem(),a=e.scalePreserved||!this.showPrintAreaEnabled?void 0:jre(new at,i.viewpoint,e.layout==="map-only"?[e.exportOptions.width,e.exportOptions.height]:[o.boxWidth,o.boxHeight]),u=new nBe({view:i,template:e,extent:a,extraParameters:r,updateDelay:n,outSpatialReference:s});try{const p=!!((d=e.layoutItem)!=null&&d.id)&&(this.portalTemplateIds.includes(e.layoutItem.id)||this.browseTemplates.some(h=>{var m,y;return((m=h.layoutItem)==null?void 0:m.id)===((y=e.layoutItem)==null?void 0:y.id)}));return await Lze(p&&this._asyncPrintTaskUrl?this._asyncPrintTaskUrl:this.effectivePrintServiceUrl,u,{timeout:this.printTimeout})}catch(p){throw new L("print:export-error","An error occurred while exporting the web map.",{error:p})}}toPrintTemplate({attributionEnabled:e,author:i,copyright:r,customTextElements:n,dpi:s,forceFeatureAttributes:o,format:a,height:u,id:d,includeTables:p,layout:h,layoutItem:m,legendEnabled:y,northArrowEnabled:g,scale:v,scaleEnabled:_,title:w,width:S}){var T;if(!h&&!m)throw new L("print:layout-required","layout is not set");const E=new Nle({attributionVisible:e,forceFeatureAttributes:o,format:a,includeTables:p,layout:h,layoutItem:m,layoutOptions:{authorText:i||"",copyrightText:r||"",customTextElements:n,titleText:w||""},outScale:v??0,scalePreserved:_});if(S&&(E.exportOptions.width=S),u&&(E.exportOptions.height=u),s&&(E.exportOptions.dpi=s),E.layoutOptions){y||(E.layoutOptions.legendLayers=[]);const M=(T=this.getLayoutTemplateById(d))==null?void 0:T.mapSurroundInfoOptions;if(M){D7(E,M.northArrow[0],g);const x=M.scaleBar;for(const C of x)D7(E,C,_)}}return E}getLayoutTemplateById(e){return e?this._templateIdToCustomTemplate.get(e):null}async addPortalTemplate(e){if(!this.portal||!(e!=null&&e.id))return;try{e.loaded||await e.load()}catch{return void this.applyTemplate(this.defaultTemplate)}const i=new u0({type:"browse-template",layoutInfoTaskUrl:this._layoutInfoTaskUrl,label:e.title,layoutItem:e});this._templateIdToCustomTemplate.set(i.id,i),this.browseTemplates.add(i)}removePortalTemplate(e){e.layoutItem&&this.templateOptions.id===e.layoutItem.id&&(this.defaultTemplate?this.applyTemplate(this.defaultTemplate):this.templateOptions.reset()),this.browseTemplates.remove(e),this._templateIdToCustomTemplate.delete(e.id)}async applyTemplate(e){if(!e)return void this.templateOptions.reset();!e.layout||!this.templatesInfo||this.templatesInfo.layout.choiceList.includes(e.layout)||(this.defaultTemplate?e=this.defaultTemplate:this.templateOptions.reset());const i=e.layout?this.effectiveTemplateCustomTextElements[e.layout]:null;await this.templateOptions.applyTemplate(e,i)}async _loadResources(e){if(this.destroyed)return;await this._loadUrls(e);const[i,r]=await Promise.all([this._getLayoutToLayoutTemplateInfos(e),this._getPrintServiceTemplatesInfo(e)]);await this._loadAllTemplates(i,e),this._processPrintServiceTemplatesInfo(r),await this._processTemplateOptions(),this._updateOverLayItem()}async _processTemplateOptions(){const{layout:e,layoutItem:i}=this.templateOptions;if(e!=="map-only"&&!this.templateOptions.id){if(i!=null&&i.id){try{i.loaded||await i.load()}catch{return void this.applyTemplate(this.defaultTemplate)}let r=this._templateIdToCustomTemplate.get(i.id);r||(r=new u0({label:i.title,layoutItem:i,layoutInfoTaskUrl:this._layoutInfoTaskUrl}),this._templateIdToCustomTemplate.set(r.id,r)),await this.applyTemplate(r)}else if(e){const r=this.defaultTemplates.find(n=>n.layout===this.templateOptions.layout)??this.printServiceTemplates.find(n=>n.layout===this.templateOptions.layout);await this.applyTemplate(r??this.defaultTemplate)}}}async _loadPortal(e){try{await this.portal.load(e)}catch(i){throw new L("print:could-not-load-portal","Cannot load print resource information from portal",{error:i,url:this.effectivePrintServiceUrl})}}async _loadUrls(e){var r,n;if(this.printServiceUrl)this._set("effectivePrintServiceUrl",this.printServiceUrl),await this._updateLayoutInfoTaskUrl(this.effectivePrintServiceUrl);else{await this._loadPortal(e);const{printTask:s,asyncPrintTask:o,layoutInfoTask:a}=((r=this.portal)==null?void 0:r.helperServices)??{};this._set("effectivePrintServiceUrl",s==null?void 0:s.url),this._asyncPrintTaskUrl=o==null?void 0:o.url,await this._updateLayoutInfoTaskUrl((a==null?void 0:a.url)||this.effectivePrintServiceUrl)}const i=(n=this.effectivePrintServiceUrl)==null?void 0:n.toLowerCase().split("/");if(!(i!=null&&i.includes("gpserver")))throw new L("print:invalid-print-service-url","Can't fetch print templates information from provided URL",{url:this.effectivePrintServiceUrl})}async _updateLayoutInfoTaskUrl(e,i){if(!e)return;const r=(await Aze(e,i)).find(n=>n.includes("Get Layout Templates Info"));r&&(this._layoutInfoTaskUrl=e.replace(uBe,`$1${encodeURI(r)}`))}_getPortalDefaultTemplates(e){var i,r,n,s,o;return((o=(s=(n=(r=(i=this.portal)==null?void 0:i.helperServices)==null?void 0:r.printTask)==null?void 0:n.templates)==null?void 0:s.filter(a=>a.layout.toLowerCase()!=="map_only"))==null?void 0:o.map(a=>{const u=u0.fromJSON(a);if(u.type="default-template",u.layoutInfoTaskUrl=this._layoutInfoTaskUrl,u.layout){const d=e.get(u.layout);d&&u.setLayoutTemplateInfo(d)}return u}))??[]}async _getPortalCustomTemplates(e){if(this.printServiceUrl||!this.portal)return[];const{layoutGroupQuery:i,user:r}=this.portal,n=cV.test(this.portal.url),s=r==null?void 0:r.userLicenseTypeId,o=s&&lBe.has(s);if(!i||n&&!o)return[];const a=new Uo({query:i,disableExtraQuery:!0}),u=await this.portal.queryGroups(a,e);if(!u.total)return[];const d=u.results[0],p=new Uo({num:100,query:"type:Layout",sortField:d.sortField,sortOrder:d.sortOrder??void 0}),h=(await d.queryItems(p,e)).results;return h.length?h.map(m=>(this.portalTemplateIds.push(m.id),new u0({type:"default-template",label:m.title,layoutItem:m,layoutInfoTaskUrl:this._layoutInfoTaskUrl}))):[]}async _loadAllTemplates(e,i){let r=!1;if(this.includeDefaultTemplates&&this.portal&&!this.printServiceUrl){const n=this._getPortalDefaultTemplates(e);r=!!n.length,this.defaultTemplates.addMany(n);const s=await this._getPortalCustomTemplates(i);this.defaultTemplates.addMany(s);for(const o of this.defaultTemplates)this._templateIdToCustomTemplate.set(o.id,o)}r||e.forEach((n,s)=>{const o=new u0({type:"print-service-template",layout:s,layoutInfoTaskUrl:this._layoutInfoTaskUrl});o.setLayoutTemplateInfo(n),this.printServiceTemplates.add(o),this._templateIdToCustomTemplate.set(o.id,o)})}_processPrintServiceTemplatesInfo(e){var r;this._set("templatesInfo",e);const i=(r=e==null?void 0:e.layout)==null?void 0:r.defaultValue;i&&i!=="map-only"&&this._set("defaultTemplate",this.defaultTemplates.find(n=>n.layout===i)??this.printServiceTemplates.find(n=>n.layout===i))}async _getLayoutToLayoutTemplateInfos(e){const i=await Ule(this._layoutInfoTaskUrl,void 0,e),r=new Map,n={};for(const s of i){const o=Y1(s.layoutTemplate);r.set(o,s),n[o]=s.layoutOptions.customTextElements}return this._serviceTemplateCustomTextElements=Object.freeze(n),r}async _getPrintServiceTemplatesInfo(e){let i;try{({data:i}=await Ee(this.effectivePrintServiceUrl,{...e,query:{f:"json"},timeout:this.printTimeout}))}catch(o){throw rr(o)?o:new L("print:unavailable-service-info","Can't fetch templates info from service",{error:o})}const{parameters:r}=i,n=r.find(({name:o})=>o==="Format"),s=r.find(({name:o})=>o==="Layout_Template");return{format:this._getFormat(n),layout:this._getLayout(s)}}_getFormat(e){const i=this.allowedFormats==="all"?e.choiceList:e.choiceList.filter(o=>typeof this.allowedFormats!="string"&&this.allowedFormats.some(a=>new RegExp(`\\b${a}\\b`,"i").test(o))),r=(i.length?i:e.choiceList).map(o=>I$.fromJSON(o)).filter(ot),n=I$.fromJSON(e.defaultValue),s=r.some(o=>new RegExp(`\\b${n}\\b`,"i").test(o))?n:r[0];return{choiceList:r,defaultValue:s}}_getLayout(e){const i=e.choiceList.filter(a=>a.toLowerCase()!=="map_only"),r=this.allowedLayouts==="all"?i:i.filter(a=>this.allowedLayouts.includes(Y1(a))),n=(r.length?r:i).map(Y1).filter(ot),s=Y1(e.defaultValue),o=n.includes(s)?s:n.find(a=>/(?=.*letter)(?=.*landscape)/i.test(a))??n.find(a=>/(?=.*a4)(?=.*landscape)/i.test(a))??n[0];return{choiceList:n,defaultValue:o}}_getOverlayItem(){return this._overlayItem||(this._overlayItem=new sBe({strokeDash:[5],strokeWidth:2,strokeColor:[30,144,255,255]})),this._overlayItem}_enablePrintPreview(){var r,n,s;if(!((r=this.view)!=null&&r.overlay))return;const e=this.templateOptions,i=this._getOverlayItem();this.addHandles([N(()=>{var o,a,u,d;return[e.width,e.height,e.scaleEnabled,e.scale,e.layout,e.layoutItem,e.id,e.state,(o=this.view)==null?void 0:o.scale,(a=this.view)==null?void 0:a.size,(u=this.view)==null?void 0:u.state.paddedViewState.size,(d=this.view)==null?void 0:d.state.padding,this.loaded]},()=>this._updateOverLayItem(),be),(n=this.view)==null?void 0:n.on("drag",["Shift"],o=>this._handleDrag(o),yt.WIDGET),(s=this.view)==null?void 0:s.on("key-down",["Escape"],()=>this._resetDrag(),yt.WIDGET)],"overlay-handler"),this.view.overlay.addItem(i)}_updateOverLayItem(){var g;if(!this.view)return;const e=this.templateOptions,i=this._getOverlayItem(),r=((g=e.layoutItem)==null?void 0:g.id)??e.layout,n=this.view,s=n.spatialReference,[o,a]=n.state.paddedViewState.size,u=n.state.padding;let d=0,p=0;if(r==="map-only")e.width!=null&&e.height!=null&&(d=e.width,p=e.height);else if(r){const v=e.id?this._templateIdToCustomTemplate.get(e.id):null,{webMapFrameSize:_,pageUnits:w}=(v==null?void 0:v.layoutTemplateInfo)??{};let S=!1;if(_&&w)if(this._isFreeHand){const E=_[0]/_[1];d=this._freeHandWidth,p=this._freehandHeight,d>p?p=d/E:d=p*E}else{const E=cBe.fromJSON(w.toLowerCase()),T=s.unit;cp(E)===cp(T)?(d=Oe(_[0],E,T),p=Oe(_[1],E,T)):(S=!0,d=_[0],p=_[1])}if(!this._isFreeHand)if(e.scaleEnabled&&e.scale){const E=S?Math.min(o/d,a/p):Ci(s)*UC*e.dpi;d*=E,p*=E}else if(d===0||p===0)d=o,p=a;else{const E=(o-.1*o)/d,T=(a-.1*a)/p,M=Math.min(E,T);d*=M,p*=M}}const{scaleEnabled:h,scale:m}=e,y=h&&m?m/this.view.scale:1;if(i.boxWidth=d*y||o,i.boxHeight=p*y||a,u&&(i.padding=u),i.backgroundWidth=o??0,i.backgroundHeight=a??0,this.loadStatus==="loading")i.strokeColor=N7;else if(this.loadStatus==="loaded")switch(this.templateOptions.state){case"pending":i.strokeColor=N7;break;case"ready":i.strokeColor=oBe;break;case"error":i.strokeColor=aBe}}_resetDrag(){this._isFreeHand=!1,this._updateOverLayItem()}_handleDrag(e){switch(e.action){case"start":this._start();break;case"update":this._update(e);break;case"end":this._end()}e.stopPropagation()}_start(){this._isFreeHand=!0}_update(e){const i=this._getOverlayItem(),{x:r,y:n}=e,{x:s,y:o}=e.origin;r>s?(i.x=s,i.boxWidth=r-s):(i.x=r,i.boxWidth=s-r),n>o?(i.y=o,i.boxHeight=n-o):(i.y=n,i.boxHeight=o-n)}_end(){const e=this._getOverlayItem();if(!this.view||e.x==null||e.y==null)return;const i=this.view,r=i.toMap(Mi(e.x+.5*e.boxWidth,e.y+.5*e.boxHeight));e.x=null,e.y=null,i.goTo({center:r}),this._freeHandWidth=e.boxWidth,this._freehandHeight=e.boxHeight,this.templateOptions.layout==="map-only"&&(this.templateOptions.width=this._freeHandWidth,this.templateOptions.height=this._freehandHeight),this.templateOptions.scale=this.view.scale,this._updateOverLayItem()}};l([c()],ti.prototype,"_serviceTemplateCustomTextElements",void 0),l([c()],ti.prototype,"_templateIdToCustomTemplate",void 0),l([c()],ti.prototype,"allowedFormats",void 0),l([c()],ti.prototype,"allowedLayouts",void 0),l([c({type:nb})],ti.prototype,"browseTemplates",void 0),l([c({type:nb})],ti.prototype,"defaultTemplates",void 0),l([c()],ti.prototype,"error",void 0),l([c()],ti.prototype,"extraParameters",void 0),l([c()],ti.prototype,"includeDefaultTemplates",void 0),l([c({readOnly:!0})],ti.prototype,"effectivePrintServiceUrl",null),l([c()],ti.prototype,"effectiveTemplateCustomTextElements",null),l([c({type:le})],ti.prototype,"outSpatialReference",void 0),l([c({type:ki})],ti.prototype,"portal",void 0),l([c()],ti.prototype,"portalTemplateIds",void 0),l([c({type:nb})],ti.prototype,"printServiceTemplates",void 0),l([c({readOnly:!0})],ti.prototype,"defaultTemplate",void 0),l([c()],ti.prototype,"showPrintAreaEnabled",void 0),l([c()],ti.prototype,"printServiceUrl",void 0),l([c()],ti.prototype,"printTimeout",void 0),l([c({readOnly:!0})],ti.prototype,"state",null),l([c({readOnly:!0})],ti.prototype,"templatesInfo",void 0),l([c()],ti.prototype,"updateDelay",void 0),l([c()],ti.prototype,"view",void 0),l([c()],ti.prototype,"templateCustomTextElements",void 0),l([c({type:jle})],ti.prototype,"templateOptions",void 0),ti=l([$("esri.widgets.Print.PrintViewModel")],ti);const Gle=ti,zle=Y.ofType(Cle),Ble="map-only";var lt;(function(t){t.layout="layoutTab",t.mapOnly="mapOnlyTab",t.export="exportTab"})(lt||(lt={}));const ke="esri-print",qg=`${ke}__advanced-options-button`,ce={base:ke,headerTitle:`${ke}__header-title`,layoutTabList:`${ke}__layout-tab-list`,layoutTab:`${ke}__layout-tab`,layoutSection:`${ke}__layout-section`,mapOnlySection:`${ke}__map-only-section`,panelItemsCentered:`${ke}__panel-items--centered`,loader:`${ke}__loader`,advancedOptionsButton:qg,advancedOptionsButtonContainer:`${qg}-container`,advancedOptionsButtonTitle:`${qg}-title`,advancedOptionsButtonIconOpened:`${qg}-icon--opened`,advancedOptionsButtonIconClosed:`${qg}-icon--closed`,advancedOptionsButtonIconClosed_RTL:`${qg}-icon--closed-rtl`,swapButton:`${ke}__swap-button`,printButton:`${ke}__export-button`,printButtonSection:`${ke}__export-button-section`,printButtonSectionDivider:`${ke}__export-button-section--divider`,templateSelectContainer:`${ke}__template-select-container`,templateSelectBlock:`${ke}__template-select-block`,templateSelectIcon:`${ke}__template-select-icon`,templateSelectError:`${ke}__template-select-error`,templateSelectArrow:`${ke}__template-select-arrow`,formSectionContainer:`${ke}__form-section-container`,formCheckboxLabel:`${ke}__form-checkbox-label`,advancedOptionsSection:`${ke}__advanced-options-section`,advancedOptionsContainer:`${ke}__advanced-options-container`,browseTemplateButtonContainer:`${ke}__browse-template-button-container`,browseTemplateButtonContainerFilter:`${ke}__browse-template-button-container-filter`,exportedFilesContainer:`${ke}__export-panel-container`,exportedFilesTitle:`${ke}__export-title`,exportedFile:`${ke}__exported-file`,exportedFileLink:`${ke}__exported-file-link`,exportedFileLinkTitle:`${ke}__exported-file-link-title`,exportedFileLinkDescription:`${ke}__exported-file-link-description`,exportedFilesEmpty:`${ke}__exported-files-empty`,printWidgetContainer:`${ke}__container`,content:`${ke}__content`,panelContainer:`${ke}__panel-container`,scaleInfoContainer:`${ke}__scale-info-container`,scaleInputContainer:`${ke}__scale-input-container`,scaleInput:`${ke}__scale-input`,sizeContainer:`${ke}__size-container`,panelError:`${ke}__panel--error`,exportedFileError:`${ke}__exported-file--error`,exportedFileLoader:`${ke}__exported-file--loader`,exportSection:`${ke}__export-section`,exportSectionCentered:`${ke}__export-section--centered`,templateButtonContainer:`${ke}__template-button-container`,templateDoneButton:`${ke}__template-done-button`,templateSelectFlowItemContainer:`${ke}__template-select-flow-item-container`,templateSelectFlowItemContent:`${ke}__template-select-flow-item-content`,templateSelectFlowItemListHeading:`${ke}__template-select-flow-item-list-heading`,srLabel:`${ke}__sr-label`,invalidWkidText:`${ke}__invalid-wkid-text`};function pBe(t,e,i,r){const n=i/e,s=r/e;return{width:Math.round(t*n),height:Math.round(t*s)}}function hBe(t){return!isNaN(t)&&t>0}function _I(t){return(t==null?void 0:t.toLowerCase())===Ble}function mBe(t){var r;const{state:e,extension:i}=t;switch(e){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return(r=i==null?void 0:i.toLowerCase())!=null&&r.includes("pdf")?"file-pdf":"file"}}const fBe=new $e({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),V7=new Map([["a3-landscape","a3-landscape"],["a3-portrait","a3-portrait"],["a4-landscape","a4-landscape"],["a4-portrait","a4-portrait"],["letter-ansi-a-landscape","ansi-a-landscape"],["letter-ansi-a-portrait","ansi-a-portrait"],["tabloid-ansi-b-landscape","ansi-b-landscape"],["tabloid-ansi-b-portrait","ansi-b-portrait"]]);let Ot=class extends $t{constructor(e,i){super(e,i),this._activeTabFocusRequested=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._selectedTab=lt.layout,this._pendingExportScroll=!1,this._rootNode=null,this._selectedTemplate=null,this._formats=[],this._showTemplates=!1,this._isValidSpatialReference=!0,this.allowedFormatsForSaving=null,this.browseTemplateButtonOnClick=null,this.exportedLinks=new zle,this.headerVisible=!0,this.headingLevel=3,this.messagesCommon=null,this.messagesUnits=null,this.saveExportEnabled=!1,this.saveExportHidden=!0,this.saveAsButtonCallback=null,this.viewModel=new Gle,this._onInput=r=>{this._selectedTab===lt.layout?this.templateOptions.title=r.target.value:this._selectedTab===lt.mapOnly&&(this.templateOptions.fileName=r.target.value)},this._handleLinkClick=r=>{const n=r.currentTarget["data-item"];if(!n||n.state!=="ready"||!n.url)return;const s=f2(this.viewModel.effectivePrintServiceUrl),o=n.url,a=document.createElement("a");if(a.target="_blank",a.href=o,a.rel="noreferrer",a.download=n.formattedName??"",!s)return a.click(),void r.stopPropagation();r.preventDefault();const u=new URL(o);u.searchParams.set("token",s),a.href=u.href,a.click(),a.href=o},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([N(()=>{var n;return[this.templateOptions.format,(n=this.viewModel.templatesInfo)==null?void 0:n.format]},()=>{var s;const{templatesInfo:n}=this.viewModel;if(n){if(this._formats.length!==n.format.choiceList.length){const o=I$.apiValues;this._formats=n.format.choiceList.map(a=>{const u=o.find(d=>new RegExp(`\\b${d}\\b`,"i").test(a))??a;return{value:u,label:a===u?a.toUpperCase():a}}).sort((a,u)=>a.label.localeCompare(u.label))}if(!(!n.format.defaultValue||this.templateOptions.format)){const o=(s=this._formats.find(({value:a})=>new RegExp(`\\b${a}\\b`,"i").test(n.format.defaultValue)))==null?void 0:s.value;o&&(this.templateOptions.format=o)}}}),N(()=>[this.templateOptions.id,this.viewModel.loaded],async()=>{const{layout:n}=this.templateOptions;this._selectedTab=_I(n)?lt.mapOnly:lt.layout,this._selectedTab===lt.layout&&this.viewModel.loaded&&(this._selectedTemplate=this.viewModel.getLayoutTemplateById(this.templateOptions.id))}),N(()=>this.templateOptions.dpi,n=>{n<=0&&(this.templateOptions.dpi=1)}),N(()=>{var n;return(n=this.viewModel.view)==null?void 0:n.scale},n=>{!n||this.templateOptions.scaleEnabled&&this.templateOptions.scale||(this.templateOptions.scale=n)})]);for(const{name:n,extension:s}of this.exportedLinks)n&&s&&this._updateExportedFileNameMap(`${n}${s}`);const{height:e,width:i}=this.templateOptions;this.templateOptions.width=i||800,this.templateOptions.height=e||1100;const r=setTimeout(()=>{this._awaitingServerResponse=!0,this.scheduleRender()},500);this.viewModel.load().then(()=>{clearTimeout(r),this._awaitingServerResponse=!1})}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),block:()=>k(()=>import("./calcite-block-aUGSXHTV.js"),__vite__mapDeps([296,282,242,235,236,240,241,243,263,239,262,259,260,248,238,244,245,256,257,258,261,264,279,265])),button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),checkbox:()=>k(()=>import("./calcite-checkbox-D7cySzqb.js"),__vite__mapDeps([352,235,234,236,241,237,238,239])),combobox:()=>k(()=>import("./calcite-combobox-BGpwkbPG.js"),__vite__mapDeps([297,298,299,277,260,235,259,234,236,237,238,239,240,241,242,262,243,268,300,251,244,301,282,270])),"combobox-item":()=>k(()=>import("./calcite-combobox-item-Cvy0gMR5.js"),__vite__mapDeps([302,301,282,242,235,236,300,238,244])),flow:()=>k(()=>import("./calcite-flow-pVqs_qJ1.js"),__vite__mapDeps([253,242,239])),"flow-item":()=>k(()=>import("./calcite-flow-item-Dp3v--sg.js"),__vite__mapDeps([254,235,236,239,240,241,242,243,255,256,257,248,238,244,245,258,259,260,261,262,263,264,265])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),input:()=>k(()=>import("./calcite-input-Dp8TE27V.js"),__vite__mapDeps([266,267,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),"input-number":()=>k(()=>import("./calcite-input-number-C2RkDlhZ.js"),__vite__mapDeps([307,308,235,234,236,241,237,238,239,240,242,243,268,269,244,270,271])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242])),switch:()=>k(()=>import("./calcite-switch-CIQH1lYU.js"),__vite__mapDeps([284,235,234,236,241,237,238,239])),chip:()=>k(()=>import("./calcite-chip-DfTljyqc.js"),__vite__mapDeps([250,251,235,239,243,240,241,242,236,238,244])),popover:()=>k(()=>import("./calcite-popover-Bvialn6r.js"),__vite__mapDeps([292,258,259,235,260,261,262,263,240,241,242,243,239,264,238,248,236,244,245])),link:()=>k(()=>import("./calcite-link-CePZkldV.js"),__vite__mapDeps([359,235,236,239,244,242]))})}destroy(){this.viewModel.destroy()}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get icon(){return"print"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get outSpatialReference(){return this.viewModel.outSpatialReference}set outSpatialReference(e){this.viewModel.outSpatialReference=e}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get showPrintAreaEnabled(){return this.viewModel.showPrintAreaEnabled}set showPrintAreaEnabled(e){this.viewModel.showPrintAreaEnabled=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get templateOptions(){return this.viewModel.templateOptions}set templateOptions(e){this.viewModel.templateOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var mo,cs,Fc,sl,ds,_u,Nc,PE,FE,NE,DE,VE,UE,jE,GE,zE,O_,R_,ol,BE,HE,qE;const{messages:e,templateOptions:i,viewModel:r,view:n}=this,{attributionEnabled:s,author:o,copyright:a,dpi:u,format:d,height:p,layout:h,layoutItem:m,legendEnabled:y,northArrowEnabled:g,scaleBarEnabled:v,scaleEnabled:_,scale:w,width:S}=i,E=r.state!=="ready"||this._awaitingServerResponse||!(h||m),T=this._renderTitleOrFileNameSection(),M=b("div",{class:ce.formSectionContainer},b("calcite-label",null,e.fileFormatTitle,b("calcite-combobox",{clearDisabled:!0,label:e.formatDefaultOption,maxItems:6,placeholder:e.formatDefaultOption,selectionMode:"single-persist",onCalciteComboboxChange:({target:Ps})=>{var wu;this.templateOptions.format=((wu=Ps.selectedItems[0])==null?void 0:wu.value)??"pdf"}},this._formats.map(({value:Ps,label:wu},pL)=>b("calcite-combobox-item",{key:`file-format-${pL}`,selected:Ps===this.templateOptions.format,textLabel:wu,value:Ps}))))),x=b("calcite-label",{layout:"inline"},b("calcite-switch",{checked:this.showPrintAreaEnabled,onCalciteSwitchChange:Ps=>{this.showPrintAreaEnabled=!!Ps.target.checked}}),e.printPreview),C=b("div",null,b("div",{class:ce.formSectionContainer},b("calcite-label",null,e.template,b("calcite-block",{class:ce.templateSelectContainer,collapsible:!1,description:this._getPageSizeLabel(this._selectedTemplate),heading:this._getTemplateLabel(this._selectedTemplate,!0),key:"template-select-block",loading:((mo=this._selectedTemplate)==null?void 0:mo.state)==="loading",onclick:()=>{this._showTemplates=!0}},b("calcite-icon",{class:ce.templateSelectIcon,icon:((cs=this._selectedTemplate)!=null&&cs.layout?V7.get(this._selectedTemplate.layout):null)||"custom-print",key:"template-select-icon",scale:"l",slot:"content-start"}),((Fc=this._selectedTemplate)==null?void 0:Fc.state)==="error"?b("calcite-icon",{class:ce.templateSelectError,icon:"exclamation-mark-circle",key:"template-select-error",scale:"s",slot:"actions-end"}):null,b("calcite-icon",{class:ce.templateSelectArrow,icon:qy()?"chevron-left":"chevron-right",key:"template-select-arrow",scale:"s",slot:"actions-end"})))),x),O=b("div",{class:ce.formSectionContainer},b("calcite-label",null,e.dpi,b("calcite-input-number",{bind:this,"data-input-name":"dpi",min:1,value:`${u}`,onCalciteInputNumberInput:this._handleDPIChange}))),F=b("div",{class:ce.formSectionContainer},b("calcite-label",null,b("div",{class:ce.srLabel},e.outSpatialReference,b("calcite-link",{href:"https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references/",target:"_blank"},"(WKID)")),b("calcite-input-number",{bind:this,"data-input-name":"outSpatialReference",integer:!0,numberButtonType:"none",value:((ds=(sl=r.outSpatialReference)==null?void 0:sl.wkid)==null?void 0:ds.toString())??"",onCalciteInputNumberInput:({target:Ps})=>{const wu=LC(Ps.value);r.outSpatialReference=Number.isNaN(wu)||wu==null?null:new le({wkid:wu}),this._isValidSpatialReference=!r.outSpatialReference||Cs(r.outSpatialReference)}}),this._isValidSpatialReference?null:b("div",{class:ce.invalidWkidText,key:`out-sr-${(_u=r.outSpatialReference)==null?void 0:_u.wkid}`},e.invalidWkid))),V=b("div",{class:this.classes(ce.scaleInfoContainer,ce.formSectionContainer)},b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:_,"data-option-name":"scaleEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.scale),b("div",{class:ce.scaleInputContainer},b("calcite-input-number",{"aria-label":e.scaleLabel,"aria-valuenow":`${w}`,bind:this,class:ce.scaleInput,"data-input-name":"scale",disabled:!_,value:`${w}`,onCalciteInputNumberInput:this._updateNumberInputValue}),b("calcite-button",{appearance:"outline","aria-label":e.reset,bind:this,disabled:!_,iconStart:"refresh",kind:"neutral",onclick:this._resetToCurrentScale}))),z=b("div",{"aria-labelledby":`${this.id}__advancedOptionsForLayout`,class:ce.advancedOptionsContainer,key:"advanced-section-for-layout"},V,((FE=(PE=(Nc=this._selectedTemplate)==null?void 0:Nc.layoutTemplateInfo)==null?void 0:PE.layoutOptions)==null?void 0:FE.hasAuthorText)??1?b("div",{class:ce.formSectionContainer,key:"author-info"},b("calcite-label",null,e.author,b("calcite-input",{bind:this,"data-input-name":"author",value:o??"",onCalciteInputInput:this._updateInputValue}))):null,((VE=(DE=(NE=this._selectedTemplate)==null?void 0:NE.layoutTemplateInfo)==null?void 0:DE.layoutOptions)==null?void 0:VE.hasCopyrightText)??1?b("div",{class:ce.formSectionContainer,key:"copyright-text"},b("calcite-label",null,e.copyright,b("calcite-input",{bind:this,"data-input-name":"copyright",value:a??"",onCalciteInputInput:this._updateInputValue}))):null,O,F,this._renderCustomTextElementSection(),((GE=(jE=(UE=this._selectedTemplate)==null?void 0:UE.layoutTemplateInfo)==null?void 0:jE.layoutOptions)==null?void 0:GE.hasLegend)??1?b("div",{class:ce.formSectionContainer,key:"legend-info"},b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:y,"data-option-name":"legendEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.legend)):null,(O_=(zE=this._selectedTemplate)==null?void 0:zE.mapSurroundInfoOptions)!=null&&O_.northArrow.length?b("div",{class:ce.formSectionContainer,key:"north-arrow"},b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:g,"data-option-name":"northArrowEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.northArrow)):null,(ol=(R_=this._selectedTemplate)==null?void 0:R_.mapSurroundInfoOptions)!=null&&ol.scaleBar.length?b("div",{class:ce.formSectionContainer,key:"scale-bar"},b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:v,"data-option-name":"scaleBarEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.scaleBar)):null),H=b("div",{"aria-labelledby":`${this.id}__advancedOptionsForMapOnly`,class:ce.advancedOptionsContainer},V,O,F,b("div",{class:ce.formSectionContainer},b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:s,"data-option-name":"attributionEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.attribution)),this._renderCustomTextElementSection()),Q=this.exportedLinks.toArray(),J=this._renderExportedLink(Q),ne={[ce.exportSectionCentered]:!Q.length},Pe=this._selectedTab===lt.layout?b("section",{"aria-labelledby":`${this.id}__layoutTab`,class:ce.layoutSection,id:`${this.id}__layoutContent`,key:"esri-print__layoutContent",role:"tabpanel"},b("div",{class:ce.panelContainer},((qE=(HE=(BE=this._selectedTemplate)==null?void 0:BE.layoutTemplateInfo)==null?void 0:HE.layoutOptions)==null?void 0:qE.hasTitleText)??1?T:null,C,this._selectedTab===lt.layout?M:null,b("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(ce.panelContainer,ce.advancedOptionsSection),collapsible:!0,disabled:!(h||m!=null&&m.id),heading:e.advancedOptions,id:"advancedOptionsForLayout",key:"advanced-options-for-layout"},z))):this._selectedTab===lt.mapOnly?b("section",{"aria-labelledby":`${this.id}__mapOnlyTab`,class:ce.mapOnlySection,id:`${this.id}__mapOnlyContent`,key:"esri-print__mapOnlyContent",role:"tabpanel"},b("div",{class:ce.panelContainer},T,M,b("div",null,b("div",{class:this.classes(ce.sizeContainer,ce.formSectionContainer)},b("calcite-label",null,e.width,b("calcite-input-number",{bind:this,"data-input-name":"width",value:`${S}`,onCalciteInputNumberInput:this._updateNumberInputValue})),b("calcite-label",null,e.height,b("calcite-input-number",{bind:this,"data-input-name":"height",value:`${p}`,onCalciteInputNumberInput:this._updateNumberInputValue})),b("button",{"aria-label":e.swap,bind:this,class:this.classes(K.widgetButton,ce.swapButton,Cr.swap),onclick:this._switchInput,type:"button"})),x),b("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(ce.panelContainer,ce.advancedOptionsSection),collapsible:!0,heading:e.advancedOptions,id:"advancedOptionsForMapOnly",key:"advanced-options-for-map-only"},H))):b("section",{"aria-labelledby":`${this.id}__exportTab`,class:this.classes(ce.exportSection,ne),id:`${this.id}__exportContent`,key:"esri-print__exportContent",role:"tabpanel"},b("div",{class:ce.panelContainer},b("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:ce.exportedFilesContainer},Q.length===0?b("div",{class:ce.exportedFilesEmpty},b("calcite-icon",{icon:"file",scale:"l"}),b("div",null,b(Ya,{class:ce.exportedFilesTitle,level:this.headingLevel},e.noExportedFiles),b("div",null,e.exportHint))):J))),_e=(n==null?void 0:n.type)!=="2d",ue=b("div",{class:ce.panelError},n?_e?e.sceneViewError:e.serviceError:e.noViewError),it=Q.some(({state:Ps})=>Ps==="pending"),Xr=b("div",{class:ce.content,key:"panel"},b("div",null,b("ul",{bind:this,class:ce.layoutTabList,onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},b("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===lt.layout}`,class:ce.layoutTab,"data-tab-id":lt.layout,id:`${this.id}__layoutTab`,role:"tab",tabIndex:0},e.layoutTab),b("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===lt.mapOnly}`,class:ce.layoutTab,"data-tab-id":lt.mapOnly,id:`${this.id}__mapOnlyTab`,role:"tab",tabIndex:0},e.mapOnlyTab),b("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===lt.export}`,class:ce.layoutTab,"data-tab-id":lt.export,id:`${this.id}__exportedFilesTab`,role:"tab",tabIndex:0},it?b("calcite-loader",{inline:!0,label:"loading",scale:"s"}):null,e.exportsTab)),Pe),this._selectedTab!==lt.export?b("div",{class:this.classes(ce.printButtonSection,!this.saveExportHidden&&this.portal?ce.printButtonSectionDivider:null),key:"export-button-section"},!this.saveExportHidden&&this.portal?b("calcite-label",{layout:"inline"},b("calcite-checkbox",{bind:this,checked:this.saveExportEnabled,onCalciteCheckboxChange:Ps=>{this.saveExportEnabled=!!Ps.target.checked}}),e.saveExportToMyContent):null,b("calcite-button",{"aria-label":e.exportDescription,bind:this,class:this.classes(ce.printButton),disabled:E||!(h||m!=null&&m.id)&&!d,onclick:this._handlePrintMap,scale:"l",width:"full"},e.export)):null),us=b("calcite-flow",{key:"root-flow"},b("calcite-flow-item",{bind:this,key:"root-flow-item"},b("div",{class:ce.printWidgetContainer},this.headerVisible?b("header",{class:ce.headerTitle},e.export):null,this.error||_e||!n?ue:Xr)),this._renderChooseTemplateFlowItem()),ho=r.state==="initializing",nl=ho?this._renderLoader():us,Fn={[ce.panelItemsCentered]:ho};return b("div",{bind:this,class:this.classes(ce.base,K.widget,K.panel,Fn)},nl)}_getPageSizeLabel(e){if(!e)return;const i=e.layoutTemplateInfo;if(!i)return;const r=fBe.fromJSON(i.pageUnits.toLowerCase());return`${Rn(i.pageSize[0])} x ${Rn(i.pageSize[1])} ${nU(this.messagesUnits,r,"abbr")}`}_getTemplateLabel(e,i=!1){if(!e)return i?this.messages.selectTemplate:this.messages.untitled;const{label:r,layout:n,layoutItem:s,type:o}=e;if(o==="print-service-template")return this.messages[n];const a=r??n??(s==null?void 0:s.id);return(a==null?void 0:a.replaceAll("_"," "))??this.messages.untitled}_getPortalTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates?this.viewModel.defaultTemplates.toArray().filter(({layout:i,layoutItem:r})=>!_I(i)&&!!(r!=null&&r.id)&&e.includes(r.id)):[]}_getDefaultTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates?this.viewModel.defaultTemplates.toArray().filter(({layout:i,layoutItem:r})=>!(_I(i)||r!=null&&r.id&&e.includes(r.id))):[]}_getPrintServiceTemplates(){return this.includeDefaultTemplates&&this._getDefaultTemplates().length?[]:this.viewModel.printServiceTemplates.toArray().filter(({layout:e})=>!_I(e))}_renderLayoutTemplates(e,i=!1,r=!1){return i&&e.sort((n,s)=>(n.label??"")>(s.label??"")?1:-1),e.map(n=>b("calcite-list-item",{description:this._getPageSizeLabel(n),key:`template-${n.id}-${n.id===this.templateOptions.id}`,label:this._getTemplateLabel(n),selected:n.id===this.templateOptions.id,title:n.description??"",value:n},b("calcite-icon",{icon:(n.layout?V7.get(n.layout):null)||"custom-print",slot:"content-start"}),n.state==="loading"?b("calcite-loader",{inline:!0,key:`template-loader-${n.id}`,label:"loading",scale:"s",slot:"content-end"}):null,(n==null?void 0:n.state)==="error"?b("calcite-icon",{class:ce.templateSelectError,icon:"exclamation-mark-circle",key:`template-error-${n.id}`,scale:"s",slot:"content-end"}):null,r?b("calcite-action",{icon:"trash",onclick:()=>this.viewModel.removePortalTemplate(n),slot:"actions-end",text:"delete"}):null))}_renderChooseTemplateFlowItem(){var d;if(!this._showTemplates)return null;const{messages:e}=this,i=cV.test((d=this.portal)==null?void 0:d.url),r=this.viewModel.browseTemplates.toArray(),n=this._getPortalTemplates(),s=this._getDefaultTemplates(),o=this._getPrintServiceTemplates(),a=r.length+n.length+s.length+o.length>15,u=this.browseTemplateButtonOnClick?b("calcite-button",{appearance:"outline",class:a?ce.browseTemplateButtonContainerFilter:ce.browseTemplateButtonContainer,iconStart:"folder",key:"browse-template-button",onclick:this.browseTemplateButtonOnClick,slot:a?"filter-actions-end":"default"},a?null:e.browseTemplates):null;return b("calcite-flow-item",{bind:this,closable:!1,heading:e.chooseTemplate,key:"template-flow-item",onCalciteFlowItemBack:p=>{p.preventDefault(),this._showTemplates=!1}},b("div",{class:ce.templateSelectFlowItemContainer},b("div",{class:ce.templateSelectFlowItemContent},a?null:u,b("calcite-list",{filterEnabled:a,filterProps:["label"],key:"template-list",selectionMode:"single-persist",onCalciteListChange:({target:p})=>{var h;return this.viewModel.applyTemplate((h=p.selectedItems[0])==null?void 0:h.value)}},a?u:null,r.length?b("div",{key:"my-templates"},b("div",{class:ce.templateSelectFlowItemListHeading},e.myTemplates,b("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:e.beta},e.beta)),this._renderLayoutTemplates(r,!0,!0)):null,n.length?b("div",{key:"org-templates"},b("div",{class:ce.templateSelectFlowItemListHeading},e.organizationTemplates,i?b("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:e.beta},e.beta):null),this._renderLayoutTemplates(n)):null,r.length||n.length?s.length?b("div",{key:"default-templates"},b("div",{class:ce.templateSelectFlowItemListHeading},e.defaultTemplates),this._renderLayoutTemplates(s,!0)):null:this._renderLayoutTemplates(s,!0),r.length||n.length?o.length?b("div",{key:"service-templates"},b("div",{class:ce.templateSelectFlowItemListHeading},e.defaultTemplates),this._renderLayoutTemplates(o)):null:this._renderLayoutTemplates(o))),b("div",{class:ce.templateButtonContainer},b("calcite-button",{class:ce.templateDoneButton,onclick:()=>this._showTemplates=!1},this.messagesCommon.done))))}_renderCustomTextElementSection(){const{customTextElements:e}=this.templateOptions;return e?b("div",{class:ce.formSectionContainer,key:"custom-text-elements"},e.map((i,r)=>{const[n,s]=Object.entries(i)[0];return n==="date"?null:b("calcite-label",{key:`custom-text-elements-${n}-${r}`},n,b("calcite-input",{bind:this,"data-input-custom":!0,"data-input-name":n,value:s??"",onCalciteInputInput:this._updateInputValue}))})):null}_renderTitleOrFileNameSection(){const{title:e,fileName:i,titlePlaceHolder:r,fileNamePlaceHolder:n}=this.messages,s=this._selectedTab===lt.layout?e:i,o=this._selectedTab===lt.layout?r:n,a=this._selectedTab===lt.layout?this.templateOptions.title:this.templateOptions.fileName;return b("div",{class:ce.formSectionContainer,key:s},b("calcite-label",null,s,b("calcite-input",{placeholder:o,value:a??"",onCalciteInputInput:this._onInput})))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const i=e.getAttribute("data-tab-id");(i==="layoutTab"&&this._selectedTab===lt.layout||i==="mapOnlyTab"&&this._selectedTab===lt.mapOnly||i==="exportTab"&&this._selectedTab===lt.export)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[ce.loader]:this._awaitingServerResponse};return b("div",{class:this.classes(e),key:"loader"})}_updateExportedFileNameMap(e){this._exportedFileNameMap[e]!==void 0?this._exportedFileNameMap[e]++:this._exportedFileNameMap[e]=0}_createFileLink(e,i){const r=i||this.messages.untitled,n=e.format.toLowerCase(),s=n.includes("png")?"png":n,o=r+s;return this._updateExportedFileNameMap(o),new Cle({name:r,extension:s,count:this._exportedFileNameMap[o]})}_resetToCurrentScale(){var e;this.templateOptions.scale=(e=this.viewModel.view)==null?void 0:e.scale}_updateCustomTextElementValue(e,i,r){e.find(n=>{const[s]=Object.entries(n)[0];return s===i})[i]=r}_updateInputValue(e){const i=e.target,r=i.getAttribute("data-input-name"),n=!!i["data-input-custom"],{templateOptions:s}=this;n?this._updateCustomTextElementValue(s.customTextElements,r,i.value):s[r]=i.value}_updateNumberInputValue(e){const i=e.target,r=i.getAttribute("data-input-name"),{templateOptions:n}=this,s=Number(i.value);if(hBe(s))n[r]=s;else{const o=n[r];i.value=`${o}`}}_handleDPIChange(e){const{templateOptions:i}=this,r=i.dpi;this._updateNumberInputValue(e);const n=i.dpi,{height:s,width:o}=pBe(n,r,i.width,i.height);i.height=s,i.width=o}_handlePrintMap(){var o;this._pendingExportScroll=!0;const{templateOptions:e,saveExportEnabled:i}=this,r=this.viewModel.toPrintTemplate(e),n=this._selectedTab===lt.layout?(o=r.layoutOptions)==null?void 0:o.titleText:e.fileName,s=this._createFileLink(r,n);this.exportedLinks.add(s),this.emit("submit",{link:s,saveExportEnabled:i}),this._selectedTab=lt.export,this.viewModel.print(r).then(a=>{s.set({url:a&&a.url,state:"ready"})}).catch(a=>{s.set({error:a,state:"error"})}).then(()=>{this.emit("complete",{link:s,saveExportEnabled:i}),this.scheduleRender()})}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_scrollExportIntoView(){if(!this._pendingExportScroll)return;this._pendingExportScroll=!1;const e=this._rootNode;if(!e)return;const{clientHeight:i,scrollHeight:r}=e,n=r-i;n>0&&(e.scrollTop=n)}_toggleInputValue(e){const i=e.target,r=i.getAttribute("data-option-name");this.templateOptions[r]=i.checked,r==="scaleEnabled"&&this._resetToCurrentScale()}_renderExportedLink(e){const i=this.messages,r=e.map(n=>{const{error:s,url:o,state:a}=n,u=n.formattedName??"",d=a==="error",p=a==="pending",h=a==="ready";let m=o||null;m&&(m=eme(m));const y=Oy(o,location.href);let g;g=p?i.pending:h?i.ready:i.errorMessage;const v=d?(s==null?void 0:s.name)==="print-task:cim-symbol-unsupported"?i.exportWebMapCIMError:i.exportWebMapError:"";return b("calcite-list-item",{"aria-label":g,key:u,title:v},b("div",{class:ce.exportedFile,"data-item":n,onclick:this._handleLinkClick,slot:"content"},b("div",null,b("div",{class:ce.exportedFileLinkTitle},u),b("div",{class:ce.exportedFileLinkDescription},p?i.generatingExport:v||(y?i.ready:i.linkReady))),h?b("calcite-icon",{"aria-label":`${u}. ${i.linkReady}`,icon:y?"download-to":"launch",key:`${u}-end-icon`,scale:"s",slot:"content-end"}):null),p?b("calcite-loader",{class:ce.exportedFileLoader,inline:!0,key:`${u}-loader`,label:i.generatingExport,scale:"m",slot:"content-start"}):b("calcite-icon",{icon:mBe(n),key:`${u}-start-icon`,scale:"s",slot:"content-start"}),p?null:this.saveAsButtonCallback&&!d&&this._isFormatAllowedForSaving(n.extension)?b("calcite-action",{"aria-label":`${v}`,icon:"ellipsis",id:`${u}-popover-button`,key:`${u}-action`,slot:"actions-end",text:`${v}`},b("calcite-popover",{autoClose:!0,key:`${u}-popover`,label:"Popover",offsetDistance:1,overlayPositioning:"fixed",pointerDisabled:!0,referenceElement:`${u}-popover-button`,scale:"s"},b("calcite-list",null,n.portalItem?b("calcite-list-item",{label:i.openItem,onCalciteListItemSelect:()=>{const _=n.portalItem;if(!_||!_.itemPageUrl)return;const w=document.createElement("a");w.target="_blank",w.href=_.itemPageUrl,w.rel="noreferrer",w.click()}},b("calcite-icon",{icon:"launch2",key:`${u}-launch-icon`,scale:"s",slot:"content-start"})):b("calcite-list-item",{label:i.saveAs,onCalciteListItemSelect:async()=>{this.saveAsButtonCallback&&(wi(()=>n.portalItem).then(_=>{_.itemPageUrl&&this.scheduleRender()}),await this.saveAsButtonCallback(n))}},b("calcite-icon",{icon:"save",key:`${u}-save-icon`,scale:"s",slot:"content-start"})),b("calcite-list-item",{label:this.messagesCommon.delete,onCalciteListItemSelect:()=>this.exportedLinks.remove(n)},b("calcite-icon",{icon:"trash",key:`${u}-delete-icon`,scale:"s",slot:"content-start"}))))):b("calcite-action",{"aria-label":`${v}`,icon:"x",key:`${u}-action`,onclick:()=>{this.exportedLinks.remove(n)},slot:"actions-end",text:`${v}`}))});return b("calcite-list",{filterEnabled:(e==null?void 0:e.length)>10},r)}_isFormatAllowedForSaving(e){return!this.allowedFormatsForSaving||this.allowedFormatsForSaving==="all"||!(!e||!this.allowedFormatsForSaving.includes(e))}_toggleLayoutPanel(e){const i=e.target;this._toggleTab(i.getAttribute("data-tab-id"))}_toggleTab(e,i=!0){if(this._selectedTab=e,this._selectedTab===lt.mapOnly)this.templateOptions.reset(),this.templateOptions.layout=Ble;else if(this._selectedTab===lt.layout){const r=this._selectedTemplate??this.viewModel.defaultTemplate;r?this.viewModel.applyTemplate(r):this.templateOptions.reset()}i&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const{key:i}=e,r=e.target.getAttribute("data-tab-id");if(F4(i))return this._toggleTab(r),e.preventDefault(),void e.stopPropagation();if(i==="ArrowLeft"||i==="ArrowRight"){switch(r){case lt.layout:this._toggleTab(i==="ArrowLeft"?lt.export:lt.mapOnly);break;case lt.mapOnly:this._toggleTab(i==="ArrowLeft"?lt.layout:lt.export);break;case lt.export:this._toggleTab(i==="ArrowLeft"?lt.mapOnly:lt.layout)}e.preventDefault(),e.stopPropagation()}}};l([c()],Ot.prototype,"_showTemplates",void 0),l([c()],Ot.prototype,"_isValidSpatialReference",void 0),l([c()],Ot.prototype,"allowedFormats",null),l([c()],Ot.prototype,"allowedFormatsForSaving",void 0),l([c()],Ot.prototype,"allowedLayouts",null),l([c()],Ot.prototype,"browseTemplateButtonOnClick",void 0),l([c()],Ot.prototype,"error",null),l([c({type:zle})],Ot.prototype,"exportedLinks",void 0),l([c()],Ot.prototype,"extraParameters",null),l([c()],Ot.prototype,"headerVisible",void 0),l([c()],Ot.prototype,"headingLevel",void 0),l([c()],Ot.prototype,"icon",null),l([c()],Ot.prototype,"includeDefaultTemplates",null),l([c()],Ot.prototype,"label",null),l([c(),Ue("esri/widgets/Print/t9n/Print")],Ot.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Ot.prototype,"messagesCommon",void 0),l([c(),Ue("esri/core/t9n/Units")],Ot.prototype,"messagesUnits",void 0),l([c({type:le})],Ot.prototype,"outSpatialReference",null),l([c()],Ot.prototype,"portal",null),l([c()],Ot.prototype,"saveExportEnabled",void 0),l([c()],Ot.prototype,"saveExportHidden",void 0),l([c()],Ot.prototype,"showPrintAreaEnabled",null),l([c()],Ot.prototype,"printServiceUrl",null),l([c()],Ot.prototype,"saveAsButtonCallback",void 0),l([c()],Ot.prototype,"templateCustomTextElements",null),l([c()],Ot.prototype,"templateOptions",null),l([c()],Ot.prototype,"view",null),l([c({type:Gle})],Ot.prototype,"viewModel",void 0),Ot=l([$("esri.widgets.Print")],Ot);const yBe=Ot;let Ia=class extends q{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=JI("hybrid",this._basemapCache),this.view=null}initialize(){N(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},be)}destroy(){this.view=null,ZY(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return Qge(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,i;return JI(((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return JI(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!e.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:i,state:r,view:n}=this;if(!n||r==="disabled"||r==="incompatible-next-basemap")return;const s=this._viewSpatialReferenceLocked;if(!s){if(await wi(()=>!this._nextBasemapSpatialReferenceTask.updating),i!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:o}=this._nextBasemapSpatialReferenceTask;if(o==null||ci(n.spatialReference,o)||Ac()||Yo(n.spatialReference,o)||(this._loadingProjectionEngine=!0,await $c(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||e!==this.activeBasemap)return}n.map.basemap=i,s||this._nextBasemapSpatialReferenceTask.spatialReference==null||ci(n.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(n.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return KY(e)}};l([c()],Ia.prototype,"_loadingProjectionEngine",void 0),l([c({readOnly:!0})],Ia.prototype,"_nextBasemapSpatialReferenceTask",null),l([c({readOnly:!0})],Ia.prototype,"_viewSpatialReferenceLocked",null),l([c({readOnly:!0})],Ia.prototype,"activeBasemap",null),l([c()],Ia.prototype,"nextBasemap",void 0),l([We("nextBasemap")],Ia.prototype,"castNextBasemap",null),l([c({readOnly:!0})],Ia.prototype,"state",null),l([c()],Ia.prototype,"view",void 0),l([c()],Ia.prototype,"toggle",null),Ia=l([$("esri.widgets.BasemapToggle.BasemapToggleViewModel")],Ia);const Hle=Ia,Hm="esri-basemap-toggle",yw="esri-basemap-thumbnail",Tu={base:Hm,secondaryBasemapImage:`${Hm}__image--secondary`,container:`${yw} ${Hm}__container`,image:`${yw}__image ${Hm}__image`,imageLoading:`${Hm}__image--loading`,overlay:`${yw}__overlay ${Hm}__image-overlay`,title:`${yw}__title ${Hm}__title`,overlayScrim:`${yw}__overlay-scrim`};function U7(t){const e=KY(t);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const j7={title:!1};let xa=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Hle,this.visibleElements={...j7},this.toggle=()=>this.viewModel.toggle()}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),scrim:()=>k(()=>import("./calcite-scrim-BZKfzama.js"),__vite__mapDeps([283,265,240,235,241,242,243,245]))})}get activeBasemap(){return this.viewModel.activeBasemap}get icon(){return"layer-basemap"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...j7,...e}}render(){const e=this.viewModel,i=e.state==="disabled"?null:e.activeBasemap,r=e.state==="disabled"?null:e.nextBasemap,n=e.state==="loading",s=e.state==="incompatible-next-basemap",o=(r==null?void 0:r.title)??"",a=r&&r.loadStatus!=="loaded";let u;const d=this.visibleElements.title&&o,p=s;return(d||p)&&(u=b("div",{class:Tu.overlay,key:"overlay"},d?b("span",{class:Tu.title,title:o},o):null,p?b("calcite-scrim",{class:Tu.overlayScrim,title:this.messages.incompatibleSpatialReference},b("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),b("div",{class:this.classes(Tu.base,K.widget)},b("calcite-button",{appearance:"transparent","data-basemap-id":r?r.id:"",disabled:s,kind:"neutral",label:this.label,onclick:()=>{this.toggle()},title:this.label},b("div",{class:this.classes(Tu.container,Tu.secondaryBasemapImage)},b("div",{class:Tu.image,styles:U7(i)})),b("div",{class:Tu.container},b("div",{class:this.classes(Tu.image,a?Tu.imageLoading:null),styles:U7(r)},a||n?b("calcite-scrim",null,b("span",{"aria-hidden":"true",class:K.loaderAnimation,role:"presentation"})):null),u)))}};l([c({readOnly:!0})],xa.prototype,"activeBasemap",null),l([c()],xa.prototype,"icon",null),l([c()],xa.prototype,"label",null),l([c(),Ue("esri/widgets/BasemapToggle/t9n/BasemapToggle")],xa.prototype,"messages",void 0),l([c()],xa.prototype,"nextBasemap",null),l([c()],xa.prototype,"view",null),l([c({type:Hle})],xa.prototype,"viewModel",void 0),l([c()],xa.prototype,"visibleElements",void 0),l([We("visibleElements")],xa.prototype,"castVisibleElements",null),xa=l([$("esri.widgets.BasemapToggle")],xa);const gBe=xa;function G7(t,e){const i=t.featureReduction;return i&&i.type!=="selection"&&(!("maxScale"in i)||!i.maxScale||i.maxScale<e.scale)?i:null}const x$=-1;let jl=class extends q{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=G("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(z7(e))}catch(i){this._transitionTo([]),U.getLogger(this).warn("Invalid Effect",{effect:e,error:i})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&B7(this._current,z7(e),this.scale)}catch{return!1}}transitionStep(e,i){this._applyTimeTransition(e),this._updateForScale(i)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&B7(this._current,e,this.scale)?(this._final=e,this._to=R(e),vBe(this._current,this._to,this.scale),this._from=R(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?R(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const i=Math.min(1,this._time/this.duration);for(let r=0;r<this._current.length;r++){const n=this._current[r],s=this._from[r],o=this._to[r];n.scale=bBe(s.scale,o.scale,i);for(let a=0;a<n.effects.length;a++){const u=n.effects[a],d=s.effects[a],p=o.effects[a];u.interpolate(d,p,i)}}i===1&&(this._current=this._final,this._set("effects",this._current[0]?R(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const i=this._current,r=this._current.length-1;let n,s,o=1;if(i.length===1||e>=i[0].scale)s=n=i[0].effects;else if(e<=i[r].scale)s=n=i[r].effects;else for(let a=0;a<r;a++){const u=i[a],d=i[a+1];if(u.scale>=e&&d.scale<=e){o=(e-u.scale)/(d.scale-u.scale),n=u.effects,s=d.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(n[a],s[a],o)}};function z7(t){const e=h4(t)||[];return _Be(e)?[{scale:x$,effects:e}]:e}function B7(t,e,i){var r,n,s,o;return!((r=t[0])!=null&&r.effects)||!((n=e[0])!=null&&n.effects)?!0:!((((s=t[0])==null?void 0:s.scale)===x$||((o=e[0])==null?void 0:o.scale)===x$)&&(t.length>1||e.length>1)&&i<=0)&&qY(t[0].effects,e[0].effects)}function vBe(t,e,i){const r=t.length>e.length?t:e,n=t.length>e.length?e:t,s=n[n.length-1],o=(s==null?void 0:s.scale)??i,a=(s==null?void 0:s.effects)??[];for(let u=n.length;u<r.length;u++)n.push({scale:o,effects:[...a]});for(let u=0;u<r.length;u++)n[u].scale=n[u].scale===x$?i:n[u].scale,r[u].scale=r[u].scale===x$?i:r[u].scale,WY(n[u].effects,r[u].effects)}function bBe(t,e,i){return t+(e-t)*i}function _Be(t){const e=t[0];return!!e&&"type"in e}l([c()],jl.prototype,"_to",void 0),l([c()],jl.prototype,"duration",void 0),l([c({value:""})],jl.prototype,"effect",null),l([c({readOnly:!0})],jl.prototype,"effects",void 0),l([c({readOnly:!0})],jl.prototype,"final",null),l([c({readOnly:!0})],jl.prototype,"hasEffects",null),l([c({value:0})],jl.prototype,"scale",null),l([c({readOnly:!0})],jl.prototype,"transitioning",null),jl=l([$("esri.layers.effects.EffectView")],jl);const nj=96;function Flt(t,e){const i=t.extent,r=t.width,n=Ci(i==null?void 0:i.spatialReference);return i&&r?i.width/r*n*UC*nj:0}function wBe(t,e){return t/(Ci(e)*UC*nj)}function Nlt(t){return t/(UC*nj)}function SBe(t,e){const i=t.extent,r=t.width-(t.padding?t.padding.left+t.padding.right:0),n=wBe(e,i.spatialReference);return i.clone().expand(n*r/i.width)}function $Be(t,e,i){return EBe(t,e)&&TBe(t,i)}function EBe(t,e){return e===0||N0(t,e)||t<e}function TBe(t,e){return e===0||N0(t,e)||t>e}function Dlt(t,e,i){return e.flatten(({sublayers:n})=>n).length!==t.length?!0:!!t.some(n=>n.originIdOf("minScale")>i||n.originIdOf("maxScale")>i||n.originIdOf("renderer")>i||n.originIdOf("labelingInfo")>i||n.originIdOf("opacity")>i||n.originIdOf("labelsVisible")>i||n.originIdOf("source")>i)||!qle(t,e)}function IBe(t,e,i){return!!t.some(r=>{const n=r.source,s=!n||n.type==="map-layer"&&n.mapLayerId===r.id&&(n.gdbVersion==null||n.gdbVersion===i);return r.commitProperty("renderer"),r.commitProperty("labelingInfo"),r.commitProperty("opacity"),r.commitProperty("labelsVisible"),!s||r.originIdOf("renderer")>Le.SERVICE||r.originIdOf("labelingInfo")>Le.SERVICE||r.originIdOf("opacity")>Le.SERVICE||r.originIdOf("labelsVisible")>Le.SERVICE})||!qle(t,e)}function qle(t,e){if(!(t!=null&&t.length)||e==null)return!0;const i=e.slice().reverse().flatten(({sublayers:s})=>s&&s.toArray().reverse()).map(s=>s.id).toArray();if(t.length>i.length)return!1;let r=0;const n=i.length;for(const{id:s}of t){for(;r<n&&i[r]!==s;)r++;if(r>=n)return!1}return!0}function Vlt(t){return!!t&&t.some(e=>{var i;return e.minScale!=null||((i=e.layerDefinition)==null?void 0:i.minScale)!=null})}const xBe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Ma=class extends q{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(i=>{const r=L7(this.floors,i);return i.toExportImageJSON(r)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&IBe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",i=>this.notifyChange(xBe[i.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(i=>i.id).join(","):"show:-1":null}get layerDefs(){var r;const e=!!((r=this.floors)!=null&&r.length),i=this.visibleSublayers.filter(n=>n.definitionExpression!=null||e&&n.floorInfo!=null);return i.length?JSON.stringify(i.reduce((n,s)=>{const o=L7(this.floors,s),a=_5(o,s.definitionExpression);return a!=null&&(n[s.id]=a),n},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const i=this.layer.sublayers,r=this.scale,n=o=>{o.visible&&(r===0||$Be(r,o.minScale,o.maxScale))&&(o.sublayers?o.sublayers.forEach(n):e.unshift(o))};i&&i.forEach(n);const s=this._get("visibleSublayers");return!s||s.length!==e.length||s.some((o,a)=>e[a]!==o)?e:s}toJSON(){const e=this.layer;let i={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?i.dynamicLayers=this.dynamicLayers:i={...i,layers:this.layers,layerDefs:this.layerDefs},i}};l([c({readOnly:!0})],Ma.prototype,"dynamicLayers",null),l([c()],Ma.prototype,"floors",void 0),l([c({readOnly:!0})],Ma.prototype,"hasDynamicLayers",null),l([c()],Ma.prototype,"layer",null),l([c({readOnly:!0})],Ma.prototype,"layers",null),l([c({readOnly:!0})],Ma.prototype,"layerDefs",null),l([c({type:Number})],Ma.prototype,"scale",void 0),l([c({readOnly:!0})],Ma.prototype,"version",null),l([c({readOnly:!0})],Ma.prototype,"visibleSublayers",null),Ma=l([$("esri.layers.support.ExportImageParameters")],Ma);const MBe=9999999e31,CBe=2e-7,kBe={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function mC(t){return kBe[t]??[-34028234663852886e22,34028234663852886e22]}function jlt(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function LBe(t){return((t==null?void 0:t.startsWith("s"))||(t==null?void 0:t.startsWith("u")))??!1}function Glt(t,e,i,r){let[n,s]=mC(i);const o=LBe(i);return o&&(n-=1e-5,s+=1e-5),o?i.startsWith("u")?ABe(t,e,r,[n,s]):OBe(t,e,r,[n,s]):RBe(t,e,r,[n,s])}function zlt(t,e){for(let i=0;i<e.length;i++)e[i]&&isNaN(t[i])&&(e[i]=0,t[i]=0)}function ABe(t,e,i,r){const[n,s]=r;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<n||a>s?e[o]=0:i[o]=a+.5|0}}function OBe(t,e,i,r){const[n,s]=r;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<n||a>s?e[o]=0:i[o]=a+(a>0?.5:-.5)|0}}function RBe(t,e,i,r){const[n,s]=r;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<n||a>s?e[o]=0:i[o]=a}}function Blt(t,e,i){var m,y;if(t.depthCount&&t.depthCount>1)return;const{pixels:r,statistics:n,pixelType:s}=t,o=r[0].length,a=t.bandMasks??[],u=t.mask??new Uint8Array(o).fill(255),d=s==="f32"||s==="f64",p=mC(s);let h=!1;for(let g=0;g<r.length;g++){const v=typeof e=="number"?e:e[g];if(v==null)continue;const _=((m=n==null?void 0:n[g])==null?void 0:m.minValue)??p[0],w=((y=n==null?void 0:n[g])==null?void 0:y.maxValue)??p[1];if(_>v+Number.EPSILON||w<v-Number.EPSILON)continue;const S=a[g]||u.slice(),E=r[g],T=i==null?void 0:i.customFloatTolerance;if(d&&T!==0){let M=T;M||(M=Math.abs(v)>=MBe?CBe*Math.abs(v):s==="f32"?2**-23:Number.EPSILON);for(let x=0;x<E.length;x++)S[x]&&Math.abs(E[x]-v)<M&&(E[x]=0,S[x]=0,u[x]=0,h=!0)}else for(let M=0;M<E.length;M++)S[M]&&E[M]===v&&(E[M]=0,S[M]=0,u[M]=0,h=!0);a[g]=S}h&&(t.bandMasks=t.bandMasks||t.pixels.length>1?a:null,t.mask=u),h&&"updateStatistics"in t&&t.updateStatistics()}function Wle(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function Hlt(t,e){if(t==null)return null;if(!Wle(t))return new L("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type||t.declaredClass}'`,{renderer:t});switch(t.type){case"simple":return PBe(t,e);case"unique-value":return FBe(t,e);case"class-breaks":return NBe(t,e);case"dictionary":case"heatmap":return null}return null}function sj(t,e){if(!e)return null;let i;if(i=Array.isArray(e)?e:[e],i.length>0){const r=i.map(s=>s.details.symbol.type||s.details.symbol.declaredClass).filter(s=>!!s);r.sort();const n=[];return r.forEach((s,o)=>{o!==0&&s===r[o-1]||n.push(s)}),new L("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:i})}return null}function PBe(t,e){const i={...Gd,...e,cimFallbackEnabled:!0};return sj(t,zy(t.symbol,i).error)}function FBe(t,e){var s;const i={...Gd,...e,cimFallbackEnabled:!0},r=(s=t.uniqueValueInfos)==null?void 0:s.map(o=>zy(o.symbol,i).error).filter(ot),n=zy(t.defaultSymbol,i);return n.error&&(r==null||r.unshift(n.error)),sj(t,r)}function NBe(t,e){const i={...Gd,...e,cimFallbackEnabled:!0},r=t.classBreakInfos.map(s=>zy(s.symbol,i).error).filter(ot),n=zy(t.defaultSymbol,i);return n.error&&r.unshift(n.error),sj(t,r)}var ID;function DBe(t){switch(t){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function oj(t){var e;return(t==null?void 0:t.type)==="CIMVectorMarker"?(e=t.markerGraphics)==null?void 0:e[0]:void 0}function Zle(t){var e,i;return((e=t==null?void 0:t.symbol)==null?void 0:e.type)==="CIMPolygonSymbol"?(i=t.symbol.symbolLayers)==null?void 0:i[0]:void 0}function VBe(t,e){(t==null?void 0:t.type)==="CIMVectorMarker"&&e!=null&&(t.size=e)}function UBe(t,e){const i=oj(t);i&&e!=null&&(i.geometry=DBe(e))}function jBe(t,e){const i=Zle(oj(t));i&&e!=null&&(i.color=e.toArray())}function GBe(t,e,i){const r=Zle(oj(t));r&&e!=null&&i&&(r.colorLocked=e)}function Jle(t,e){var d;const{outerRingSize:i,innerDotSize:r,type:n,color:s,colorLocked:o,primitiveOverrides:a}=e,u=((d=t.data.symbol)==null?void 0:d.type)==="CIMPolygonSymbol"?t.data.symbol.symbolLayers:null;if((u==null?void 0:u.length)===2)for(const p of u){const h=p.primitiveName===ID.OuterRing;VBe(p,h?i:r),UBe(p,n),jBe(p,s),GBe(p,o,h)}return i!=null&&r!=null&&(t.data.primitiveOverrides=null),a!==void 0&&(t.data.primitiveOverrides=R(a)),t}(function(t){t.OuterRing="reference-size-outer-ring",t.InnerDot="reference-size-inner-dot"})(ID||(ID={}));function zBe(t,e,i){const r=t.effectiveClusterRenderer;if(!r||!("visualVariables"in r)||!r.visualVariables)return null;const n=r.visualVariables.find(p=>p.type==="size");if(!("stops"in n)||!n.stops)return null;const s=n.stops.find(p=>p.useMinValue),o=n.stops.find(p=>p.useMaxValue);if(s==null||o==null)return null;const a=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,u=n.field,d=e.getDisplayStatistics(a,u);return d?new b_({field:n.field,minSize:t.clusterMinSize,minDataValue:d.minValue,maxSize:t.clusterMaxSize,maxDataValue:d.maxValue}):null}const BBe=/^-?(\d+)(\.(\d+))?$/i;function HBe(t,e){return t-e}function qBe(t,e){let i,r;return i=Number(t.toFixed(e)),i<t?r=i+1/10**e:(r=i,i-=1/10**e),i=Number(i.toFixed(e)),r=Number(r.toFixed(e)),[i,r]}function WBe(t,e,i,r,n){const s=TM(t,e,i,r),o=s.previous==null||s.previous<=n,a=s.next==null||s.next<=n;return o&&a||s.previous+s.next<=2*n}function fC(t){const e=String(t),i=e.match(BBe);if(i!=null&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const r=e.split("e"),n=r[0],s=r[1];if(n&&s){const o=Number(n);let a=Number(s);const u=a>0;u||(a=Math.abs(a));const d=fC(o);return u?(d.integer+=a,a>d.fractional?d.fractional=0:d.fractional-=a):(d.fractional+=a,a>d.integer?d.integer=1:d.integer-=a),d}}return{integer:0,fractional:0}}function TM(t,e,i,r){const n={previous:null,next:null};if(i!=null){const s=t-i,o=e-i-s;n.previous=Math.floor(Math.abs(100*o/s))}if(r!=null){const s=r-t,o=r-e-s;n.next=Math.floor(Math.abs(100*o/s))}return n}function yC(t,e={}){const i=t.slice(),{tolerance:r=2,strictBounds:n=!1,indexes:s=i.map((o,a)=>a)}=e;s.sort(HBe);for(let o=0;o<s.length;o++){const a=s[o],u=i[a],d=a===0?null:i[a-1],p=a===i.length-1?null:i[a+1],h=fC(u).fractional;if(h){let m,y=0,g=!1;for(;y<=h&&!g;){const v=qBe(u,y);m=n&&o===0?v[1]:v[0],g=WBe(u,m,d,p,r),y++}g&&(i[a]=m)}}return i}const ZBe={maximumFractionDigits:20};function JBe(t){return Rn(t,ZBe)}const Yle="<",Kle=">";function Xle(t,e,i,r){let n="";return e===0?n=`${Yle} `:e===i&&(n=`${Kle} `),n+(r?sU(t,r):JBe(t))}const YBe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function xD(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(o=>o.type==="color");if(!e)return null;let i=null,r=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;i=e.stops[0].value,r=e.stops[e.stops.length-1].value}const n=i!=null&&r!=null?i+(r-i)/2:0,{getColor:s}=await k(async()=>{const{getColor:o}=await Promise.resolve().then(()=>pg);return{getColor:o}},void 0);return s(e,n)??null}async function Qle(t,e){const i=t.trailCap,r=t.trailWidth||1,n=e||await xD(t)||t.color;return new yr({cap:i,color:n,width:r})}function KBe(t,e){var i,r;if(!e.field)return null;if("featureReduction"in t)switch((i=t.featureReduction)==null?void 0:i.type){case"cluster":case"binning":{const n=t.featureReduction.fields.find(({name:s})=>s.toLowerCase()===e.field.toLowerCase());return n&&"getField"in t?t.getField(n.onStatisticField):null}}return"getField"in t?(r=t.getField)==null?void 0:r.call(t,e.field):null}function XBe(t,e){var r,n,s;const i="popupTemplate"in t?(r=t.popupTemplate)==null?void 0:r.fieldInfos:null;if(i!=null&&i.length&&e)return(s=(n=i.find(o=>{var a;return((a=o.fieldName)==null?void 0:a.toLowerCase())===e.toLowerCase()}))==null?void 0:n.format)==null?void 0:s.dateFormat}function QBe(t,e,i){var s,o,a,u;const r=KBe(t,e);if(!r||!w$(r)&&!Lb(r))return null;let n=XBe(t,r.name);if(!n&&r.type==="date"){let d=0,p=0;e.stops?(d=((o=(s=e.stops)==null?void 0:s.at(0))==null?void 0:o.value)??d,p=((u=(a=e.stops)==null?void 0:a.at(-1))==null?void 0:u.value)??p):"minDataValue"in e&&"maxDataValue"in e&&(d=e.minDataValue??d,p=e.maxDataValue??p),n=p-d>2*VR.days?"short-date":"short-date-short-time"}return{fieldType:r.type,format:n,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function MD(t){var e,i;if("authoringInfo"in t)return(i=(e=t.authoringInfo)==null?void 0:e.visualVariables)==null?void 0:i.find(({theme:r})=>r==="reference-size")}const e8e=new ee([64,64,64]);function eue(t,e){const i=[],r=t.length-1;return t.length===5?i.push(0,2,4):i.push(0,r),t.map((n,s)=>i.includes(s)?Xle(n,s,r,e):null)}async function CD(t,e,i){let r=!1,n=[],s=[];if(t.stops){const d=t.stops;n=d.map(p=>p.value),r=d.some(p=>!!p.label),r&&(s=d.map(p=>p.label))}const o=n[0],a=n[n.length-1];if(o==null&&a==null)return null;const u=r?null:eue(n,i);return(await Promise.all(n.map(async(d,p)=>({value:d,color:t.type==="opacity"?await t8e(d,t,e):(await k(async()=>{const{getColor:h}=await Promise.resolve().then(()=>pg);return{getColor:h}},void 0)).getColor(t,d),label:r?s[p]:(u==null?void 0:u[p])??""})))).reverse()}async function t8e(t,e,i){const r=new ee(i??e8e),n=(await k(async()=>{const{getOpacity:s}=await Promise.resolve().then(()=>pg);return{getOpacity:s}},void 0)).getOpacity(e,t);return n!=null&&(r.a=n),r}function i8e(t){let e=!1,i=[],r=[];i=t.map(a=>a.value),e=t.some(a=>!!a.label),e&&(r=t.map(a=>a.label??""));const n=i[0],s=i[i.length-1];if(n==null&&s==null)return null;const o=e?null:eue(i);return i.map((a,u)=>({value:a,color:tue(a,t),label:e?r[u]:(o==null?void 0:o[u])??""})).reverse()}function tue(t,e){const{startIndex:i,endIndex:r,weight:n}=r8e(t,e);if(i===r)return e[i].color;const s=ee.blendColors(e[i].color,e[r].color,n);return new ee(s)}function r8e(t,e){let i=0,r=e.length-1;return e.some((n,s)=>t<n.value?(r=s,!0):(i=s,!1)),{startIndex:i,endIndex:r,weight:(t-e[i].value)/(e[r].value-e[i].value)}}function n8e(t,e){let i=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((r,n)=>{n===0?i.push({value:e.max,color:new ee(r.toColor),label:"high"}):i.push({value:null,color:new ee(r.toColor),label:""}),n===t.colorRamps.length-1?i.push({value:e.min,color:new ee(r.fromColor),label:"low"}):i.push({value:null,color:new ee(r.fromColor),label:""})});else{let r,n;t&&t.type==="algorithmic"?(r=t.fromColor,n=t.toColor):(r=[0,0,0,1],n=[255,255,255,1]),i=[{value:e.max,color:new ee(n),label:"high"},{value:e.min,color:new ee(r),label:"low"}]}return i}function iue(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let i=e.length-1;if(e&&e[0]){const r=e[i];r&&r.ratio!==1&&(e.push(new gS({ratio:1,color:r.color})),i++)}return e.map((r,n)=>{var o,a;let s="";return n===0?s=((o=t.legendOptions)==null?void 0:o.minLabel)||"low":n===i&&(s=((a=t.legendOptions)==null?void 0:a.maxLabel)||"high"),{color:r.color,label:s,ratio:r.ratio}}).reverse()}const kD=30,LD=12,AD=24,rue=[255,255,255],aj=[200,200,200],A0=[128,128,128],s8e=20,o8e=5;function a8e(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function l8e(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function u8e(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function c8e(t){return t.declaredClass==="esri.symbols.TextSymbol"}function d8e(t,e){const i=t.length-1;return t.map((r,n)=>Xle(r,n,i,e))}async function p8e(t,e,i,r,n,s,o){const a=e.legendOptions,u=a==null?void 0:a.customValues,d=o||await y8e(t,i),p=e.stops,h=!!d,m=!!u,y=e.minSize!=null&&e.maxSize!=null,g=p&&p.length>1,v=!!e.target;if(!h||!m&&!(y||g&&!v))return;const _=qk(d);let w=!1,S=null,E=null;S=_&&!g?yC([e.minDataValue,e.maxDataValue]):u??await v8e(e,d,r,n==null?void 0:n.type);const T=t==null?void 0:t.authoringInfo,M=(T==null?void 0:T.type)==="univariate-color-size",x=M&&(T==null?void 0:T.univariateTheme)==="above-and-below",C=!!MD(t);if(!S&&g&&(S=p.map(z=>z.value),w=p.some(z=>!!z.label),t.type==="flow"&&(S=yC(S)),w&&(E=p.map(z=>z.label))),_&&S!=null&&(S==null?void 0:S.length)>2&&!x&&(S=[S[0],S[S.length-1]]),!S)return null;M&&(S==null?void 0:S.length)!==5&&(S=oue({minSize:S[0],maxSize:S[S.length-1]}));const O=_?h8e(t,S):null,F=k5e(d),V=w?null:d8e(S,s);return(await Promise.all(S.map(async(z,H)=>{const Q=_?O[H]:await c0(e,d,z,r,n==null?void 0:n.type);return{value:z,symbol:!C||t.type!=="class-breaks"&&t.type!=="unique-value"?w8e(x&&t.type==="class-breaks"?f8e(t,H):d,Q):m8e(t,Q,e.maxSize,i)??d,label:w?E[H]:V[H],size:C?AD:Q,outlineSize:F}}))).reverse()}function h8e(t,e){const i=t==null?void 0:t.authoringInfo,r=(i==null?void 0:i.type)==="univariate-color-size";let n=[LD,kD];if(r){const s=e[0],o=e[e.length-1],a=LD,u=kD;n=e.map(d=>a+(d-s)/(o-s)*(u-a))}return r&&(i==null?void 0:i.univariateTheme)==="below"&&n.reverse(),n}function m8e(t,e,i,r){var o,a,u,d,p,h;const n=t.type==="class-breaks",s=n?(u=(a=(o=t.classBreakInfos)==null?void 0:o[0])==null?void 0:a.symbol)==null?void 0:u.clone():(h=(p=(d=t.uniqueValueInfos)==null?void 0:d[0])==null?void 0:p.symbol)==null?void 0:h.clone();return s&&"type"in s&&s.type==="cim"?(Jle(s,{color:r??(n?null:new ee(aj)),innerDotSize:e*(AD/i)||1,outerRingSize:AD}),s):null}function f8e(t,e){var o;const i=t.classBreakInfos,r=i.length,n=r<2||!(e>=2)?i[0].symbol.clone():i[r-1].symbol.clone();return((o=t.visualVariables)==null?void 0:o.some(a=>a.type==="color"))&&(n.type.includes("3d")?nue(n):sue(n)),n}async function y8e(t,e){var n,s;if(t.type==="flow")return Qle(t,e);if(t.type==="pie-chart")return new Or({color:null,outline:(n=t.outline)!=null&&n.width?t.outline:new yr});let i=null,r=null;if(t.type==="simple")i=t.symbol;else if(t.type==="class-breaks"){const o=t.classBreakInfos;i=o&&o[0]&&o[0].symbol,r=o.length>1}else if(t.type==="unique-value"){const o=t.uniqueValueInfos;i=(s=o==null?void 0:o[0])==null?void 0:s.symbol,r=o!=null&&o.length>1}return!i||g8e(i)?null:(i=i.clone(),(e||r)&&(i.type.includes("3d")?nue(i):sue(i)),i)}function g8e(t){return t?xc(t)?!!t.symbolLayers&&t.symbolLayers.some(e=>e&&e.type==="fill"):t.type.includes("fill"):!1}function nue(t){t.type==="line-3d"?t.symbolLayers.forEach(e=>{e.material={color:A0}}):t.symbolLayers.forEach(e=>{var i;e.type!=="icon"||(i=e.resource)!=null&&i.href?e.material={color:aj}:(e.material={color:rue},e.outline={color:A0,size:1.5})})}function sue(t){var i,r;const e=ise();t.type==="cim"?xoe(t,new ee(aj)):t.type.includes("line")?t.color=A0:(t.color=e?A0:rue,t.type==="simple-marker"&&(t.outline?((r=(i=t.outline)==null?void 0:i.color)==null?void 0:r.toHex())==="#ffffff"&&(t.outline.color=A0):t.outline={color:A0,width:1.5}))}async function v8e(t,e,i,r){const n=(await k(async()=>{const{getSizeRangeAtScale:a}=await Promise.resolve().then(()=>pg);return{getSizeRangeAtScale:a}},void 0)).getSizeRangeAtScale(t,i,r),s=n&&oue(n);if(!n||!s)return;let o=s.map(a=>b8e(a,t,n));o=yC(o);for(let a=1;a<o.length-1;a++){const u=await _8e(t,e,o[a],o[a-1],i,r);u&&(o[a]=u[0],s[a]=u[1])}return o}function oue(t){const e=t.minSize,i=t.maxSize,r=o8e,n=(i-e)/(r-1),s=[];for(let o=0;o<r;o++)s.push(e+n*o);return s}function b8e(t,e,i){const r=i.minSize,n=i.maxSize,s=e.minDataValue,o=e.maxDataValue;let a;return t<=r?a=s:t>=n?a=o:a=(t-r)/(n-r)*(o-s)+s,a}async function _8e(t,e,i,r,n,s){const o=await c0(t,e,i,n,s),a=await c0(t,e,r,n,s),u=fC(i),d=u.fractional,p=s8e;let h=u.integer,m=null,y=null;i>0&&i<1&&(m=10**d,h=fC(i*=m).integer);for(let g=h-1;g>=0;g--){const v=10**g;let _=Math.floor(i/v)*v,w=Math.ceil(i/v)*v;m!=null&&(_/=m,w/=m);let S=(_+w)/2;[,S]=yC([_,S,w],{indexes:[1]});const E=await c0(t,e,_,n,s),T=await c0(t,e,w,n,s),M=await c0(t,e,S,n,s),x=TM(o,E,a,null),C=TM(o,T,a,null),O=TM(o,M,a,null);let F=x.previous<=p,V=C.previous<=p;if(F&&V&&(x.previous<=C.previous?(F=!0,V=!1):(V=!0,F=!1)),F?y=[_,E]:V?y=[w,T]:O.previous<=p&&(y=[S,M]),y)break}return y}async function c0(t,e,i,r,n){const{getSize:s}=await k(()=>Promise.resolve().then(()=>pg),void 0);return s(t,i,{scale:r,view:n,shape:e.type==="simple-marker"?e.style:null})}function w8e(t,e){const i=t.clone();if(xc(i))qk(i)||i.symbolLayers.forEach(r=>{r.type!=="fill"&&(r.size=e)});else if(a8e(i))i.size=e;else if(l8e(i)){const r=i.width,n=i.height;i.height=e,i.width=e*(r/n)}else u8e(i)?i.width=e:c8e(i)&&i.font&&(i.font.size=e);return i}Ms("short-date");async function go(t,e,i){Xd(t,e,()=>[]).push(...i)}async function qlt(t){var i,r;const e=new Map;if(!t)return e;if("visualVariables"in t&&t.visualVariables){const n=t.visualVariables.filter(s=>s.type==="color");for(const s of n){const o=(await CD(s)??[]).map(a=>a.color);await go(e,s.field||s.valueExpression,o)}}if(t.type==="heatmap"){const n=iue(t).map(s=>s.color);await go(e,t.field||t.valueExpression,n)}else if(t.type==="pie-chart"){for(const n of t.attributes)await go(e,n.field||n.valueExpression,[n.color]);await go(e,"default",[(i=t==null?void 0:t.othersCategory)==null?void 0:i.color,Dg(t.backgroundFillSymbol,null)])}else if(t.type==="dot-density"){for(const n of t.attributes)await go(e,n.field||n.valueExpression,[n.color]);await go(e,"default",[t.backgroundColor])}else if(t.type==="unique-value")if(((r=t.authoringInfo)==null?void 0:r.type)==="predominance")for(const n of t.uniqueValueInfos??[])await go(e,n.value.toString(),[Dg(n.symbol,null)]);else{const n=(t.uniqueValueInfos??[]).map(d=>Dg(d.symbol,null)),{field:s,field2:o,field3:a,valueExpression:u}=t;(s||u)&&await go(e,s||u,n),o&&await go(e,o,n),a&&await go(e,a,n)}else if(t.type==="class-breaks"){const n=t.classBreakInfos.map(a=>Dg(a.symbol,null)),{field:s,valueExpression:o}=t;await go(e,s??o,n)}else t.type==="simple"&&await go(e,"default",[Dg(t.symbol,null)]);return"defaultSymbol"in t&&t.defaultSymbol&&await go(e,"default",[Dg(t.defaultSymbol,null)]),e.forEach((n,s)=>{const o=Ide(n.filter(Boolean),(a,u)=>JSON.stringify(a)===JSON.stringify(u));e.set(s,o)}),e}function S8e(t){const i=Math.floor(Math.log10(Math.abs(t)))+1,r=i<4||i>6?4:i,n=1e6,s=Math.abs(t)>=n?"compact":"standard";return Rn(t,{notation:s,minimumSignificantDigits:2,maximumSignificantDigits:r})}const H7=16,$8e="https://utility.arcgis.com/sharing/tools/legend",E8e="esri.layers.ImageryLayer",T8e="esri.layers.ImageryTileLayer",I8e="esri.layers.WCSLayer",wI=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,x8e=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),SI=new Or({size:6,outline:{color:[128,128,128,.5],width:.5}}),M8e=new Qo({style:"solid"});function OD(t){return t.type==="flow"}function aue(t){return t.type==="vector-field"}function lue(t){return t.type==="raster-colormap"}function uue(t){return t.type==="raster-stretch"}function cue(t){return t.type==="raster-shaded-relief"}function d0(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function Kf(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function p0(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function due(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function C8e(t){return lj(t)||uj(t)||cj(t)||k8e(t)}function k8e(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function lj(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function uj(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function cj(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function pue(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function hue(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function L8e(t,e){return d0(t)||Kf(t)||p0(t)||due(t)||pue(t)||hue(t)?e.type==="2d"||Wle(t):uue(t)||lue(t)||cue(t)||lj(t)||uj(t)||cj(t)||aue(t)||OD(t)}function A8e(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function wO(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function O8e(t){return t.declaredClass==="esri.layers.VoxelLayer"}function R8e(t){return t.declaredClass==="esri.layers.WMSLayer"}function P8e(t){return t.declaredClass==="esri.layers.WMTSLayer"}function SO(t){return t.declaredClass==="esri.layers.MapImageLayer"}function q7(t){return t.declaredClass==="esri.layers.TileLayer"}function Wg(t){return t.declaredClass===E8e}function $I(t){return t.declaredClass===T8e}function F8e(t){return t.declaredClass===I8e}function N8e(t){return t.type==="stretch-ramp"}function D8e(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"}function V8e(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"&&(e==null?void 0:e.univariateTheme)==="above-and-below"}function W7(t){return"sublayers"in t}async function Bc(t,e){const i=await BC("esri/widgets/Legend/t9n/Legend");return t!=="previewTemplateAriaLabel"||e||(t="previewAriaLabel"),Wr(i[t],{label:e})}function U8e(t,e){const{field:i,field2:r,field3:n,fieldDelimiter:s,valueExpression:o}=t;if(!i)return null;const a=!i&&!o||!r&&!n?[e]:e==null?void 0:e.toString().split(s||""),u=i?{[i]:a==null?void 0:a[0]}:null;return u&&(r&&(u[r]=a==null?void 0:a[1]),n&&(u[n]=a==null?void 0:a[2])),u}const j8e=new Or({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Zg={},ur=class extends q{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this.children=new Y,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([St(()=>this.children,"change",e=>{const{added:i,removed:r}=e;i.forEach(n=>{const s=`activeLayerInfo-ready-watcher-${n.layer.uid}`;this.addHandles(N(()=>n.ready,t,be),s)}),r.forEach(n=>this.removeHandles(n.layer.uid)),t()})]),this.keepCacheOnDestroy||(Zg={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(Zg=null),this._layerDefinitionExpressionClause=null}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new jl,e.effect=t.effect,e.endTransitions(),e.scale=this.scale),e}get opacity(){var n;const t=this.layer.opacity,e=(n=this.parent)==null?void 0:n.opacity,i=this.layer.parent,r=i&&"uid"in i?this._getParentLayerOpacity(i):null;return e!=null?e*t:r!=null?r*t:t}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){var t;return((t=this.view)==null?void 0:t.scale)??0}get isScaleDriven(){const t=this.layer;if(t===null)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if(t.featureReduction.type==="cluster")return!0;if(t.featureReduction.type==="binning"&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,i=>{var r;if(hY(i))return this._getRendererLegendElements(i.renderer,{title:i.title});if((r=i.featureSet)!=null&&r.features.length){const n=i.layerDefinition,s=n==null?void 0:n.drawingInfo,o=s&&ATe(s.renderer),a=x8e.read(n.geometryType);return o?this._getRendererLegendElements(o,{title:i.name,geometryType:a}):(U.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const i=[],r=await Promise.allSettled(e);for(const n of r)if(n.status==="fulfilled")for(const s of n.value??[])i.push(s);this.legendElements=i,this.notifyChange("ready")}catch(i){U.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(e){U.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(e){U.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){var e,i;const t=this.layer;if(O8e(t))this._constructLegendElementsForVoxelLayer();else if(P8e(t))this._constructLegendElementsForWMTSlayer();else if(R8e(t))await this._constructLegendElementsForWMSSublayers();else if(A8e(t))await this._constructLegendElementsForBuildingSceneLayer();else if(SO(t)||q7(t)||wO(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let r="default";if(Wg(t)){const n=t;r=(((e=n==null?void 0:n.rasterFunction)==null?void 0:e.functionName)||"default")+"_"+((i=t.bandIds)!=null&&i.length?t.bandIds.join(""):"###")}if($I(t)||t.type==="link-chart")return;await this._getLegendLayers(`${t.uid}-${r}`).then(async n=>{this.legendElements=[],this.notifyChange("ready");const s=n.map(async o=>{if(Wg(t)){const u=N(()=>["renderingRule"in t&&t.rasterFunction,t.bandIds],()=>Bo(async()=>{Zg.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()})());this.addHandles(u,"imageryLayers-watcher")}const a=this._generateSymbolTableElementForLegendLayer(o);a!=null&&a.infos.length&&(Wg(t)&&(a.title=t.title),this.legendElements.push(a)),this.notifyChange("ready")});await Promise.allSettled(s)}).catch(n=>{U.getLogger(this).warn("Request to server for legend has failed!",n)})}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,i=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!i&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await wi(()=>!e.updating);const r=i?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();return r?(r.geometry=this.view.extent,(i?"queryFeatureCount"in e&&await e.queryFeatureCount(r):"queryFeatureCount"in t&&await t.queryFeatureCount(r))!==0):!0}_getParentLayerOpacity(t){let e=1;const i=t.parent;return i&&"uid"in i&&(e=this._getParentLayerOpacity(i)),t.opacity*e}_isGroupActive(){return this.children.some(t=>t.ready)}_isRendererScaleDriven(t){if(t.type==="dot-density")return!0;const e="valueExpression"in t?t.valueExpression:null;if(wI.test(e))return!0;const i="visualVariables"in t?t.visualVariables:null;return!!(i!=null&&i.some(r=>this._isScaleDrivenSizeVariable(r)))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){var e;switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some(i=>this._isScaleDrivenSymbol(i.symbol));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!((e=t.uniqueValueInfos)!=null&&e.some(i=>this._isScaleDrivenSymbol(i.symbol)))}return!1}_isScaleDrivenSymbol(t){if((t==null?void 0:t.type)==="cim"){const{primitiveOverrides:e,minScale:i,maxScale:r}=t.data,n=(e==null?void 0:e.some(s=>{var o;return/\$view\.scale/.test(((o=s.valueExpressionInfo)==null?void 0:o.expression)||"")}))??!1;return i!=null||r!=null||n}return!1}_isScaleDrivenSizeVariable(t){if(t&&t.type!=="size")return!1;const e=t,i=e.minSize,r=e.maxSize;return!(typeof i!="object"||!i||!this._isScaleDrivenSizeVariable(i))||!(typeof r!="object"||!r||!this._isScaleDrivenSizeVariable(r))||wI.test(e.valueExpression)}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some(i=>this._isLayerScaleDriven(i));const e=t.parent;if(t.loaded===!1&&e&&SO(e)&&"source"in t&&t.source&&t.source.type==="map-layer"){for(const i of e.sourceJSON.layers??[])if(i.id===t.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxelLayer(){var s;this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(N(()=>t.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable"),this.addHandles(N(()=>t.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");const e=t.getVariableStyle(null),i=[];if(e){if((s=e.uniqueValues)!=null&&s.length){const o=[];e.uniqueValues.forEach(a=>{a.enabled&&o.push({label:a.label||`${a.value}`,value:a.value,symbol:new Qo({color:a.color,outline:null})})}),o.length&&i.push({type:"symbol-table",title:e.label,infos:o})}else if(e.transferFunction){const{colorStops:o,stretchRange:a}=e.transferFunction,u=o.toArray().reverse(),d=a.map((h,m)=>`${m===0?Yle:Kle} ${S8e(h)}`).reverse(),p=u.map(h=>({color:h.color,value:null,label:null}));p[0].label=d[0],p[p.length-1].label=d[1],i.push({type:"color-ramp",title:e.label,infos:p,preview:Hf(u.map(h=>h.color),{ariaLabel:await Bc("previewColorRampAriaLabel")})})}}const r=t.opacity,n=i.reduce((o,a)=>[...o,...this._getAllInfos(a)],[]).filter(o=>!!(o!=null&&o.symbol)).map(o=>this._getSymbolPreview(o,r));await Promise.allSettled(n),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){var i,r;this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(N(()=>{const{layer:n}=this;return n&&"activeLayer"in n&&n.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");const e=t.styleId?(r=(i=t.styles)==null?void 0:i.find(({id:n})=>n===t.styleId))==null?void 0:r.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(N(()=>{const{layer:i}=this;return i&&"sublayers"in i&&i.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){var o,a;const i=this.layer,r=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const n=((a=(o=this.sublayerIds)==null?void 0:o.map(u=>i.findSublayerById(u)))==null?void 0:a.filter(ot))??[],s=n.length?n:t.toArray();for(const u of s){const d=N(()=>[u.title,u.visible,u.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this.addHandles(d,"wms-sublayers-watcher"),!this.respectLayerVisibility||u.visible&&u.legendEnabled){const p=await this._generateSymbolTableElementForWMSSublayer(u,e);p!=null&&p.infos.length&&r.unshift(p)}}return r}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter(r=>r);return{type:"symbol-table",title:t.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){var o;let i=t.legendUrl;if(!i)return;const r={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(i=UI(i,e));let n=null;const s=(o=t.layer)==null?void 0:o.opacity;try{n=(await Ee(i,{responseType:"image"})).data,n&&(n.style.opacity=s)}catch{}return r.infos.push({src:i,preview:n,opacity:s}),r}_getLegendLayers(t,e){const i=Zg&&Zg[t];return i?Promise.resolve(i):this._legendRequest(e).then(r=>{const n=r.layers;return Zg[t]=n,n})}_legendRequest(t){var n;const e=this.layer;let i={f:"json",dynamicLayers:t};if(Wg(e)){const s=e.exportImageServiceParameters.rasterFunction;if(s&&(i.renderingRule=JSON.stringify(((n=s.functionDefinition)==null?void 0:n.toJSON())||s.toJSON())),e.bandIds&&(i.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:o,viewId:a,customParameters:u}=e;i={raster:o,viewId:a,...i,...u}}}let r=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const s=r.indexOf("?");s>-1?r=r.slice(0,s)+"/legend"+r.slice(s):r+="/legend"}else{const s=r.toLowerCase().indexOf("/rest/"),o=s===-1?r:r.slice(0,s)+r.slice(s+5);r=$8e+"?soapUrl="+encodeURI(o)+"&returnbytes=true"}return Ee(r,{query:i}).then(s=>s.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(N(()=>t.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){U.getLogger(this).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(t,e){let i=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const r=t.toArray();for(const n of r){const s=N(()=>["renderer"in n&&n.renderer,n.opacity,n.title,n.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this.addHandles(s,"sublayers-watcher"),!this.respectLayerVisibility||n.visible){const o=(n==null?void 0:n.opacity)!=null?n.opacity:null,a=o!=null?o*e:e;if(n.type==="building-group"){const u={type:"symbol-table",title:n.title,infos:[]},d=await this._generateLegendElementsForBuildingSublayers(n.sublayers,a);u.infos.push(...d),i=[u,...i]}else n.renderer&&(i=[...await this._getRendererLegendElements(n.renderer,{title:n.title,opacity:a,sublayer:n}),...i])}}return i.filter(n=>!!n&&(!("infos"in n)||!n.infos||n.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(SO(t)||q7(t)||wO(t)){this.addHandles(N(()=>t.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){U.getLogger(this).warn("Request to server for legend has failed!",e)}}}async _generateLegendElementsForSublayers(t,e,i){const r=this.layer;let n=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let s=t.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(s=wO(r)?this.sublayerIds.map(o=>r.findSublayerForSubtypeCode(o)).filter(ot):this.sublayerIds.map(o=>r.findSublayerById(o)).filter(ot));for(const o of s){const a=N(()=>[o.renderer,o.opacity,o.title,o.visible,o.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled&&this._isSublayerInScale(o)){const u=(o==null?void 0:o.opacity)!=null?o.opacity:null,d=u!=null?u*e:e,p=!W7(o)||o.originIdOf("renderer")>Le.SERVICE&&!o.sublayers;if(o.renderer&&p)await o.load(),n=[...await this._getRendererLegendElements(o.renderer,{title:o.title,opacity:d,sublayer:o}),...n];else if(W7(o)){const h=await this._generateSymbolTableElementForSublayer(o,d,i);h&&n.unshift(h)}}}return n.filter(o=>!!o&&(!("infos"in o)||!o.infos||o.infos.length>0))}async _generateSymbolTableElementForSublayer(t,e,i){if(!i){i=new Map;const n=this.layer,s=t.source;let o=null;if(!(!s||s.type==="map-layer"&&s.mapLayerId===t.id&&(!s.gdbVersion||s.gdbVersion===("gdbVersion"in n&&n.gdbVersion)))||t.originIdOf("renderer")>Le.SERVICE||t.originIdOf("labelingInfo")>Le.SERVICE||t.originIdOf("labelsVisible")>Le.SERVICE){const u=new Ma({layer:this.layer});o=u.hasDynamicLayers?u.dynamicLayers:null,u.destroy()}const a=o||`${n.uid}-default`;(await this._getLegendLayers(a,o)).forEach(u=>i.set(u.layerId,u))}const r=i.get(t.id);if((!r||r!=null&&r.subLayerIds&&r.defaultVisibility)&&t.sublayers){const n=await this._generateLegendElementsForSublayers(t.sublayers,e,i);return{type:"symbol-table",title:t.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(r,t,e)}_generateSymbolTableElementForLegendLayer(t,e,i){if(!(t!=null&&t.legend)||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const r=e==null?void 0:e.renderer;let n=(e==null?void 0:e.title)||t.layerName;if(r&&(!e||(e==null?void 0:e.originIdOf("renderer"))>Le.SERVICE)){const a=(e==null?void 0:e.title)||this._getRendererTitle(r,e);a&&(n&&typeof a!="string"&&"title"in a&&(a.title=n),n=a)}const s={type:"symbol-table",title:n,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach(a=>{var d;const u={type:"symbol-table",title:a.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter(p=>p.groupId===a.id),t.layerId,i)};((d=u.infos)==null?void 0:d.length)>0&&s.infos.push(u)}):s.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,i),s.infos.length>0?s:null}_generateSymbolTableElementInfosForLegendLayer(t,e,i){return t.map(r=>{let n=r.url;if(r.imageData&&r.imageData.length>0)n=`data:image/png;base64,${r.imageData}`;else{if(n.indexOf("http")===0)return null;n=fme(`${this.layer.url}/${e}/images/${n}`)}return{label:r.label,src:n,opacity:i??this.opacity,width:r.width,height:r.height}}).filter(ot)}_isSublayerInScale(t){const e=t.minScale||0,i=t.maxScale||0;return!(e>0&&e<this.scale||i>this.scale)}_isLegendLayerInScale(t,e){const i=e||this.layer;let r=null,n=null,s=!0;return!i.minScale&&i.minScale!==0||!i.maxScale&&i.maxScale!==0?(t.minScale===0&&i.tileInfo&&(r=i.tileInfo.lods[0].scale),t.maxScale===0&&i.tileInfo&&(n=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(r=Math.min(i.minScale,t.minScale)||i.minScale||t.minScale,n=Math.max(i.maxScale,t.maxScale)),(r>0&&r<this.scale||n>this.scale)&&(s=!1),s}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||t.length===0)return t;const i=e.renderer,r=t.some(o=>o.values);let n=0,s=null;return r&&t.some((o,a)=>(o.values||(n=a,s=o,s.label||(s.label="others")),s!=null)),i?i.type==="unique-value"?s&&(t.splice(n,1),t.push(s)):i.type==="class-breaks"&&(s&&t.splice(n,1),t.reverse(),s&&t.push(s)):s&&(t.splice(n,1),t.push(s)),t}async _getRendererLegendElements(t,e={}){if(!L8e(t,this.view))return U.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(C8e(t))return this._constructPointCloudRendererLegendElements(t,e);if(pue(t))return this._constructDotDensityRendererLegendElements(t);const i=await this._loadRenderer(t);return hue(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return t.type==="binning"?e=t.renderer:t.type==="cluster"&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){var e;return(((e=t.legendOptions)==null?void 0:e.title)||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){var a;const i=e.title,r=[];let n=null,s=null;if(lj(t))n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach(u=>{n.infos.unshift({label:u.label||u.minValue+" - "+u.maxValue,value:[u.minValue,u.maxValue],symbol:this._getAppliedCloneSymbol(SI,u.color)})});else if(uj(t)){const u=t.stops;let d=null;if(u!=null&&u.length&&(u.length===1&&(d=u[0].color),!d)){const h=u[0].value,m=u[u.length-1].value;h!=null&&m!=null&&(d=tue(h+(m-h)/2,u))}n={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(SI,d||SI.color)}]};const p=i8e(t.stops??[])??[];s={type:"color-ramp",title:i||this._getPointCloudRendererTitle(t),infos:p,preview:Hf(p.map(h=>h.color),{ariaLabel:await Bc("previewColorRampAriaLabel")})}}else cj(t)&&(n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},(a=t.colorUniqueValueInfos)==null||a.forEach(u=>{n.infos.push({label:u.label||u.values.join(", "),value:u.values.join(", "),symbol:this._getAppliedCloneSymbol(SI,u.color)})}));n!=null&&n.infos.length&&r.push(n),s!=null&&s.infos.length&&r.push(s);const o=r.reduce((u,d)=>[...u,...d.infos??[]],[]).filter(u=>!!u.symbol).map(u=>this._getSymbolPreview(u,this.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}}));return await Promise.allSettled(o),r}async _getElementInfoForDotDensity(t,e){const{color:i,label:r,valueExpressionTitle:n}=e,{backgroundColor:s,outline:o,dotSize:a}=t,u=this.effectList,d=u==null?void 0:u.effects.map(w=>w.toJSON()),p=w2(d),h=await Bc("previewTemplateAriaLabel",r||n),m=a+"-"+i+"-"+s+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+p,y=this._dotDensityUrlCache,g=y.has(m)?y.get(m):g4e(t,i,{ariaLabel:h});y.set(m,g);const v={shape:{type:"image",x:0,y:0,width:g.width,height:g.height,src:g.src},fill:null,stroke:null,offset:[0,0]},_=gE([[v]],[g.width,g.height],{effectView:this.effectList,ariaLabel:h});return{opacity:1,src:g.src,preview:_,width:g.width,height:g.height}}async _constructDotDensityRendererLegendElements(t){var n;const e=t.calculateDotValue(this.view.scale),i=(n=t.legendOptions)==null?void 0:n.unit,r={type:"symbol-table",title:{value:e&&Math.round(e),unit:i||""},infos:[]};for(const s of t.attributes){const o=await this._getElementInfoForDotDensity(t,s);o.label=s.label||s.valueExpressionTitle||s.field,r.infos.push(o)}return[r]}async _constructPieChartRendererLegendElements(t){var u,d,p,h;const e=this.layer.opacity,i=[];let r=null;const n=t.outline;t.attributes.forEach(m=>{const y=new Or({color:m.color,outline:n}),g=m.label||m.valueExpressionTitle||m.field;i.push({label:g,symbol:y})});const s=i.length?[...i]:[];if((u=t.othersCategory)!=null&&u.color&&((d=t.othersCategory)==null?void 0:d.threshold)!==0){const m=new Or({color:t.othersCategory.color,outline:n});r=t.othersCategory.label||"Other",i.push({label:r,symbol:m})}if((p=t.defaultColor)!=null&&p.a){const m=new Or({color:t.defaultColor,outline:n});i.push({label:t.defaultLabel,symbol:m})}const o=await this._getVisualVariableLegendElements(t,this.layer)||[];if(i.length){o.unshift({type:"symbol-table",title:null,infos:i});const m=s.filter(g=>g.label!==r).map(g=>g.symbol.color).filter(Boolean),y=v4e(m,{holePercentage:t.holePercentage,backgroundColor:(h=t.backgroundFillSymbol)==null?void 0:h.color,effectList:this.effectList,outline:n,ariaLabel:await Bc("previewPieChartAriaLabel")});o.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:i,preview:y})}const a=o.reduce((m,y)=>[...m,...this._getAllInfos(y)],[]).filter(m=>!!(m!=null&&m.symbol)&&!(m!=null&&m.preview)).map(m=>this._getSymbolPreview(m,e,{effectList:this.effectList}));return await Promise.allSettled(a),o}async _constructRendererLegendElements(t,e={}){var _,w,S,E,T,M;const{title:i,sublayer:r}=e,n=r||this.layer,s=MD(t);if("definitionExpression"in n){const x=n.definitionExpression;if(x&&this.respectLayerDefinitionExpression&&p0(t)){if(this._layerDefinitionExpression!==x){this._layerDefinitionExpressionClause=await b5(x,n.fieldsIndex);const C=new Set((await L1e(t,n.fieldsIndex)).map(F=>F.toLowerCase())),O=(_=this._layerDefinitionExpressionClause)==null?void 0:_.fieldNames.map(F=>F.toLowerCase());O!=null&&O.every(F=>C.has(F))||(this._layerDefinitionExpressionClause=null,O!=null&&O.length&&U.getLogger(this).warn("Definition expression will be ignored in the Legend, as fields in the expression do not match with renderer fields"))}}else this._layerDefinitionExpressionClause=null;this._layerDefinitionExpression=x}this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const o=await this._getVisualVariableLegendElements(t,n)||[],a={type:"symbol-table",title:i||this._getRendererTitle(t,n),infos:[]};let u=null,d=!1;const p=new Set;if(OD(t)&&!this._hasSizeRamp){const x=await Qle(t);a.infos.push({label:null,symbol:x})}else if(D8e(t)){let x=i;const C=V8e(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",O=o.findIndex(Q=>Q.type==="color-ramp"),F=O!==-1?o.splice(O,1)[0]:null,V=o.findIndex(Q=>Q.type==="size-ramp"),z=V!==-1?o.splice(V,1)[0]:null,H=[];F&&(x=F.title,H.push(F)),z&&(x=z.title,H.push(z)),H.length>0&&o.push({type:C,title:x,infos:H})}else if(due(t)){const x=iue(t);o.push({type:"heatmap-ramp",title:i||this._getRendererTitle(t,n),infos:x,preview:Hf(x.map(C=>C.color),{effectList:this.effectList,ariaLabel:await Bc("previewColorRampAriaLabel")})})}else if(p0(t)){const x=t.authoringInfo;if(x&&x.type==="relationship"){const{numClasses:C,field1:O,field2:F}=x,V=x.focus;if(C&&O&&F){const z=[O,F];let H=Yoe(V)||0;for(const J of z){const{field:ne,normalizationField:Pe,label:_e}=J,ue=_e||{field:this._getFieldAlias(ne,n),normField:Pe&&this._getFieldAlias(Pe,n)},it=j8e.clone();it.angle=H,a.infos.push({label:ue,symbol:it}),p.add(it),H+=90}const Q=y4e({focus:V,numClasses:C,infos:t.uniqueValueInfos??[]});o.unshift(Q)}}else if(Wg(this.layer)||$I(this.layer))(w=t.uniqueValueInfos)==null||w.forEach(C=>{C.symbol&&this._checkDefinitionExpressionForUVR(t,C.value)&&a.infos.push({label:C.label||C.value,value:C.value,symbol:C.symbol})});else{const{field:C,field2:O,field3:F,fieldDelimiter:V,valueExpression:z,defaultSymbol:H}=t,Q=!(!C&&!z||!O&&!F),J=[];if((S=t.uniqueValueGroups)==null||S.forEach(ne=>{var _e;const Pe={type:"symbol-table",title:ne.heading,infos:[]};(_e=ne.classes)==null||_e.forEach(ue=>{const{symbol:it,values:Xr}=ue;if(it){const us=[],ho=[];for(const cs of Xr??[]){const{value:Fc,value2:sl,value3:ds}=cs,_u=[],Nc=[];(C||z)&&(_u.push(Fc),Nc.push(this._getDomainName(C,Fc,n))),O&&(_u.push(sl),Nc.push(this._getDomainName(O,sl,n))),F&&(_u.push(ds),Nc.push(this._getDomainName(F,ds,n))),us.push(Q?_u.join(V||""):_u[0]),ho.push(Nc.join(" - "))}const nl=us.join(", ");let Fn=ue.label;if(!Fn){const cs=ho.filter(Boolean);Fn=cs.length?cs.join(", "):nl}const mo=it.clone();mo.type==="cim"&&s&&Jle(mo,{innerDotSize:.5*H7,outerRingSize:H7}),us.some(cs=>this._checkDefinitionExpressionForUVR(t,cs))&&Pe.infos.push({label:Fn,value:nl,symbol:mo})}}),Pe.infos.length&&J.push(Pe)}),J.length){const ne=J[0];J.length===1&&"title"in ne&&!ne.title?a.infos.push(...ne.infos??[]):(H&&(J.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:H}]}),d=!0),a.infos.push(...J)),i||(E=t.legendOptions)!=null&&E.title||t.valueExpressionTitle||(a.title=null)}}t.defaultSymbol&&!d&&(a.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),d=!0)}else if(Kf(t)){if(!s){if(u=this._isUnclassedRenderer(t),!u||!this._hasSizeRamp){const x=t.classBreakInfos.filter(({symbol:C})=>C);for(const{label:C,minValue:O,maxValue:F,symbol:V}of x)a.infos.unshift({label:C||(u?null:`${O} - ${F}`),value:[O,F],symbol:V});u&&(a.title=null),this._updateInfosForClassedSizeRenderer(t,a.infos)}t.defaultSymbol&&!u&&(a.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),d=!0)}}else if(uue(t))if($I(this.layer)||F8e(this.layer)){const x=await this._constructTileImageryStretchRendererElements(t);N8e(x)?o.push(x):a.infos=x}else{const x=this.layer;let C,O;(T=t.customStatistics)!=null&&T.length&&({min:C,max:O}=t.customStatistics[0]);let F=[],V=x.serviceRasterInfo;if(x.rasterFunction)try{V=await x.generateRasterInfo(x.rasterFunction)}catch{}const z=mC(V.pixelType);if(V.bandCount===1){const H=((M=x.bandIds)==null?void 0:M[0])||0;C=C??(V.statistics?V.statistics[H].min:z[0]),O=O??(V.statistics?V.statistics[H].max:z[1]),C||O?o.push(await this._getStretchLegendElements(t,{min:C,max:O})):this._getServerSideLegend()}else if(x.bandIds&&x.bandIds.length===1)C=C??(V.statistics?V.statistics[x.bandIds[0]].min:z[0]),O=O??(V.statistics?V.statistics[x.bandIds[0]].max:z[1]),C||O?o.push(await this._getStretchLegendElements(t,{min:C,max:O})):this._getServerSideLegend();else if(V.bandCount>=3){const{bandInfos:H}=V,{bandIds:Q}=x;H.length>=V.bandCount?(Q==null?void 0:Q.length)===3?(F=Q.map(J=>H[J].name),a.infos=this._createSymbolTableElementMultiBand(F)):x.format==="lerc"?(F=[0,1,2].map(J=>H[J].name),a.infos=this._createSymbolTableElementMultiBand(F)):this._getServerSideLegend():x.format==="lerc"?(F=["band1","band2","band3"],a.infos=this._createSymbolTableElementMultiBand(F)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(lue(t))t.colormapInfos.forEach(x=>{a.infos.push({label:x.label,value:x.value,symbol:this._getAppliedCloneSymbol(M8e,x.color)})});else if(d0(t)){let x=t.symbol;switch(e.geometryType){case"point":x="pointSymbol"in n?n.pointSymbol:null;break;case"polyline":x="lineSymbol"in n?n.lineSymbol:null;break;case"polygon":x="polygonSymbol"in n?n.polygonSymbol:null}const C=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&C&&a.infos.push({label:t.label,symbol:x})}else if(aue(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),a.title=t.attributeField;const x=t.getClassBreakInfos();x!=null&&x.length?x.forEach(C=>{a.infos.push({label:C.minValue+" - "+C.maxValue,symbol:C.symbol})}):a.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else cue(t)&&o.push(await this._getStretchLegendElements(t,{min:0,max:255}));const h=t.defaultSymbol;!h||d||d0(t)||u&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||o.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:h}]}),a.infos.length&&o.unshift(a);const m=e.opacity==null?this.opacity:e.opacity,y=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),g=Wg(this.layer)||$I(this.layer),v=o.reduce((x,C)=>[...x,...this._getAllInfos(C)],[]).filter(x=>!!(x!=null&&x.symbol)).filter(x=>{if(x.symbol.type==="cim"){const{minScale:C,maxScale:O}=x.symbol.data;if(C&&C<this.scale||O&&O>this.scale)return!1}return!0}).map(x=>this._getSymbolPreview(x,m,{isDefault:x.symbol===h,applyScaleDrivenSize:!p.has(x.symbol),symbolConfig:{isTall:y,isSquareFill:g},effectList:p.has(x.symbol)?null:this.effectList}));return t=null,await Promise.allSettled(v),o}_checkDefinitionExpressionForUVR(t,e){if(!this._layerDefinitionExpressionClause)return!0;const i=U8e(t,e);return(i&&this._layerDefinitionExpressionClause.testFeature(i))??!0}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(t){const e=t==null?void 0:t.infos;return e?e.reduce((i,r)=>i.concat(this._getAllInfos(r)),[]):[t]}async _constructTileImageryStretchRendererElements(t){var a,u,d;const e=this.layer,i=e.symbolizer.rasterInfo??e.raster.rasterInfo;let r,n;const s=(a=t==null?void 0:t.customStatistics)!=null&&a.length?t.customStatistics:i==null?void 0:i.statistics;if(s)({min:r,max:n}=s[0]);else{const p=mC(i.pixelType);r=p[0],n=p[1]}if(e.hasStandardTime()&&(r=e.getStandardTimeValue(r),n=e.getStandardTimeValue(n)),i.bandCount===1||((u=e.bandIds)==null?void 0:u.length)===1)return this._getStretchLegendElements(t,{min:r,max:n});const o=((d=e==null?void 0:e.bandIds)!=null&&d.length?e.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map(p=>i.bandInfos[p].name);return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const i=t.colorRamp,r=n8e(i,e);return{type:"stretch-ramp",title:"",infos:r,preview:Hf(r.map(n=>n.color),{ariaLabel:await Bc("previewColorRampAriaLabel")})}}_getClusterSymbol(){var r;const t=this.layer,e="featureReduction"in t&&t.featureReduction,i=e&&"symbol"in e&&e.renderer;return i&&((r=i==null?void 0:i.authoringInfo)==null?void 0:r.isAutoGenerated)!==!0?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,i,r){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await p8e(i,e,await xD(i),this.scale,this.view,r,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],i=["red","green","blue"];return t.forEach((r,n)=>{e.push({label:{colorName:i[n],bandName:r},src:YBe[n],opacity:this.opacity??1})}),e}_updateInfosForClassedSizeRenderer(t,e){const i=t.authoringInfo&&t.authoringInfo.type==="class-breaks-size",r=t.classBreakInfos.some(n=>qk(n.symbol));if(i&&r){const n=kD,s=LD,o=t.classBreakInfos.length,a=(n-s)/(o>1?o-1:o);e.forEach((u,d)=>{u.size=n-a*d})}}_isTallSymbol(t){let e=!1,i=!1;if(t)for(let r=0;r<t.length&&(!e||!i);r++){const n=t[r];n.type==="size"&&(n.axis==="height"&&(e=!0),n.axis==="width-and-depth"&&(i=!0))}return e&&i}async _getSymbolPreview(t,e,i){var s,o,a;let r=!(i!=null&&i.isDefault)&&t.size==null&&this._hasSizeRamp?Jr(Pr.size):t.size;if(this._scaleDrivenSizeVariable&&(i!=null&&i.applyScaleDrivenSize)){const{getSize:u}=await k(()=>Promise.resolve().then(()=>pg),void 0);r=u(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:t.symbol.type==="simple-marker"?t.symbol.style:null})}const n=!(i!=null&&i.isDefault)&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!(i!=null&&i.applyScaleDrivenSize));return bU(t.symbol,{size:r,opacity:e,scale:!1,symbolConfig:i==null?void 0:i.symbolConfig,effectView:i==null?void 0:i.effectList,style:"legend",cimOptions:{allowScalingUp:n,viewParams:this.isScaleDriven?{viewingMode:((s=this.view)==null?void 0:s.type)==="2d"?"map":(o=this.view)==null?void 0:o.viewingMode,scale:(a=this.view)==null?void 0:a.scale}:null},ariaLabel:t.label&&typeof t.label!="string"?null:await Bc("previewTemplateAriaLabel",t.label)}).then(u=>(t.preview=u,t)).catch(()=>(t.preview=null,t))}_getClusterRenderer(t){var n,s;this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,i=((n=t.renderer)==null?void 0:n.clone())||(e==null?void 0:e.clone()),r=zBe(t,this.layerView,this.view);if(r&&i!=null&&"visualVariables"in i&&!((s=i.visualVariables)==null?void 0:s.some(a=>a.type==="size"&&a.target!=="outline"&&!wI.test(a.valueExpression)))){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:u,clusterMaxSize:d}=t;r.legendOptions=new Eee({showLegend:u!==d})}const a=i.visualVariables||[];i.visualVariables=a.concat([r]),this._hasClusterSizeVariable=!0}return i}async _loadRenderer(t){const e=[],i=t.clone(),r=await xD(i);if(Kf(i)||p0(i)){const n=(i.classBreakInfos||i.uniqueValueInfos).map(s=>this._fetchSymbol(s.symbol,r).then(o=>{s.symbol=o}).catch(()=>{s.symbol=null}));Array.prototype.push.apply(e,n)}return e.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:r).then(n=>{this._applySymbolToRenderer(i,n,d0(i))}).catch(()=>{this._applySymbolToRenderer(i,null,d0(i))})),await Promise.allSettled(e),i}_applySymbolToRenderer(t,e,i){i?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if(t.type==="web-style"){const i=this._webStyleSymbolCache;try{const r=await(this.view.type==="2d"?t.fetchCIMSymbol({cache:i}):t.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(r,e)}catch{throw U.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const i=t.clone(),r=e&&e.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,r):i.type==="cim"?xoe(i,e):i.color&&(i.color=new ee(r||i.color)),i}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach(i=>{i&&(i.material||(i.material={}),i.material.color=new ee(e))})}async _getVisualVariableLegendElements(t,e){var h,m;if(!("visualVariables"in t)||t.type==="vector-field")return null;const i=t.visualVariables??[],r=[],n=[],s=[],o=MD(t);if(((h=o==null?void 0:o.sizeStops)==null?void 0:h.length)===2&&(Kf(t)||p0(t))){const[y,g]=o.sizeStops;n.push(new b_({field:o.field??void 0,normalizationField:o.normalizationField,minSize:y.size,maxSize:g.size,minDataValue:y.value,maxDataValue:g.value}))}for(const y of i)y.type==="color"?r.push(y):y.type==="size"?n.push(y):y.type==="opacity"&&s.push(y);const a=[...r,...n,...s];let u,d;if(r.length===0&&Kf(t)&&t.classBreakInfos&&t.classBreakInfos.length===1){const y=t.classBreakInfos[0];u=y&&y.symbol}if(r.length===0&&d0(t)&&(u=t.symbol),u)if(u.type.includes("3d")){const y=u.symbolLayers.at(0);y.type==="water"?y.color!=null&&(d=y.color):((m=y.material)==null?void 0:m.color)!=null&&(d=y.material.color)}else u.url||(d=u.color);const p=this.effectList;return(await Promise.all(a.map(async y=>{if(!y.legendOptions||y.legendOptions.showLegend!==!1){const g=OD(t)?y.field:this._getRampTitle(y,e);let v=null;const _=QBe(e,y,this.view.timeZone);if(y.type==="color"){const w=await CD(y,null,_)??[];v={type:"color-ramp",title:g,infos:w,preview:Hf(w.map(S=>S.color),{effectList:p,ariaLabel:await Bc("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=w.length>0)}else if(y.type==="size"&&y.target!=="outline")wI.test(y.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=y):(v=await this._getSizeLegendElement(g,y,t,_),this._hasSizeRamp||(this._hasSizeRamp=!(v.infos==null||!v.infos.length)));else if(y.type==="opacity"){const w=await CD(y,d,_)??[];v={type:"opacity-ramp",title:g,infos:w,preview:Hf(w.map(S=>S.color),{effectList:p,ariaLabel:await Bc("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=w.length>0)}return v!=null&&v.infos?v:null}}))).filter(ot)}_getDomainName(t,e,i){var r;if(t&&typeof t!="function"){const n="getField"in i&&((r=i.getField)==null?void 0:r.call(i,t)),s=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name):null;return(s==null?void 0:s.type)==="coded-value"?s.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,i=t.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const r=e.featureReduction,n="popupTemplate"in r&&r.popupTemplate,s=n&&n.fieldInfos;if(s){for(const o of s)if(o.fieldName===i)return i==="cluster_count"?o.label||{showCount:!0}:o.label}}return{showCount:!0}}_getRampTitle(t,e){var d,p;let i=t.field,r=t.normalizationField,n=!1,s=!1,o=!1,a=null;i=typeof i=="function"?null:i,r=typeof r=="function"?null:r;const u=(d=t.legendOptions)==null?void 0:d.title;if(u!=null)a=u;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&((p=e.renderer.authoringInfo)!=null&&p.visualVariables)){const h=e.renderer.authoringInfo.visualVariables;for(let m=0;m<h.length;m++){const y=h[m];if(y.type==="color"){if(y.style==="ratio"){n=!0;break}if(y.style==="percent"){s=!0;break}if(y.style==="percent-of-total"){o=!0;break}}}}a={field:i&&this._getFieldAlias(i,e),normField:r&&this._getFieldAlias(r,e),ratio:n,ratioPercent:s,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){var a;const i=t;if((a=i.legendOptions)!=null&&a.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let r=i.field,n=null,s=null;if(Kf(i)&&(n=i.normalizationField,s=i.normalizationType==="percent-of-total"),r=typeof r=="function"?null:r,n=typeof n=="function"?null:n,p0(i)){const{field2:u,field3:d,fieldDelimiter:p}=i;let h=r&&this._getFieldAlias(r,e);return u&&(h=`<${h}>${p}<${this._getFieldAlias(u,e)}>`,d&&(h=`${h}${p}<${this._getFieldAlias(d,e)}>`)),h}let o=null;return(r||n)&&(o={field:r&&this._getFieldAlias(r,e),normField:n&&this._getFieldAlias(n,e),normByPct:s}),o}_getFieldAlias(t,e){var p,h;const i="popupTemplate"in e?e.popupTemplate:null,r=i==null?void 0:i.fieldInfos;let n=r==null?void 0:r.find(m=>t===m.fieldName),s=null;"getField"in e&&e.getField?s=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(s=e.fieldsIndex.get(t));let o=null;const a="featureReduction"in e&&e.featureReduction;a&&(n??(n="popupTemplate"in a?(h=(p=a.popupTemplate)==null?void 0:p.fieldInfos)==null?void 0:h.find(m=>{var y;return(t==null?void 0:t.toLowerCase())===((y=m.fieldName)==null?void 0:y.toLowerCase())}):void 0),"fields"in a&&a.fields&&(o=a.fields.find(m=>{var y;return((y=m.name)==null?void 0:y.toLowerCase())===(t==null?void 0:t.toLowerCase())})));const u=n||s||o;let d=null;return u&&(d=(n==null?void 0:n.label)||(s==null?void 0:s.alias)||(o==null?void 0:o.alias)||"name"in u&&u.name||"fieldName"in u&&u.fieldName||null),d}_isUnclassedRenderer(t){const e=t.visualVariables;let i=!1;return Kf(t)&&t.classBreakInfos&&t.classBreakInfos.length===1&&e&&(i=t.field?e.some(r=>!(!r||t.field!==r.field||(t.normalizationField||r.normalizationField)&&t.normalizationField!==r.normalizationField)):!!e.length),i}};l([c()],ur.prototype,"children",void 0),l([c({readOnly:!0})],ur.prototype,"effectList",null),l([c()],ur.prototype,"layerView",void 0),l([c()],ur.prototype,"layer",void 0),l([c()],ur.prototype,"legendElements",void 0),l([c({readOnly:!0})],ur.prototype,"opacity",null),l([c()],ur.prototype,"parent",void 0),l([c({readOnly:!0,dependsOn:[]})],ur.prototype,"ready",null),l([c()],ur.prototype,"hideLayersNotInCurrentView",void 0),l([c()],ur.prototype,"keepCacheOnDestroy",void 0),l([c()],ur.prototype,"respectLayerDefinitionExpression",void 0),l([c()],ur.prototype,"respectLayerVisibility",void 0),l([c({readOnly:!0})],ur.prototype,"scale",null),l([c()],ur.prototype,"sublayerIds",void 0),l([c({readOnly:!0})],ur.prototype,"isScaleDriven",null),l([c()],ur.prototype,"title",void 0),l([c({readOnly:!0,dependsOn:["ready"],value:0})],ur.prototype,"version",null),l([c()],ur.prototype,"view",void 0),ur=l([$("esri.widgets.Legend.support.ActiveLayerInfo")],ur);const mue=ur,qm={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},fue=Y.ofType(mue),G8e=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),yue="view.basemapView.baseLayerViews",gue="view.groundView.layerViews",vue="view.basemapView.referenceLayerViews",z8e=[yue,gue,"view.layerViews",vue];let Lo=class extends q{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new Y,this.activeLayerInfos=new fue,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(N(()=>this.view,()=>this._viewHandles(),be),qm.view),this.addHandles(GC(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(qm.state),this.view&&this.addHandles(N(()=>this.state,()=>this._stateHandles(),be),qm.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([qm.allLayerViews,qm.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const i=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],i!=null&&i.parent&&i.parent.children.remove(i)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:i}=e;i.length&&this._refresh(),this.addHandles(i.on("change",r=>this._allLayerViewsChangeHandle(r)),qm.allLayerViews),this.addHandles(N(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),qm.legendProperties)}_allLayerViewsChangeHandle(e){e.moved.length?this._propertiesChangeHandle():(e.removed.forEach(i=>this._destroyViewActiveLayerInfo(i.uid)),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const i=this.view;if(e.length<2||!i)return;const r=[];e.forEach(s=>{if(!s.parent){const o=s.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],u=a&&this._activeLayerInfosByLayerViewId[a.uid];u&&e.includes(u)&&(r.push(s),s.parent=u,u.children.add(s),this._sortActiveLayerInfos(u.children))}}),e.removeMany(r);const n={};i.allLayerViews.forEach((s,o)=>n[s.layer.uid]=o),e.sort((s,o)=>{const a=n[s.layer.uid]||0;return(n[o.layer.uid]||0)-a})}_generateLayerViews(){const e=[];return z8e.filter(this._filterLayerViews,this).map(i=>rs(this,i)).filter(i=>i!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const i=!this.basemapLegendVisible&&(e===yue||e===vue),r=!this.groundLegendVisible&&e===gue;return!i&&!r}_collectLayerViews(e,i){const r=n=>(n&&n.forEach(s=>{i.push(s),r(s[e])}),i);return r}_filterLayerViewsByLayerInfos(e){const i=this.layerInfos;return!i||!i.length||i.some(r=>this._hasLayerInfo(r,e))}_hasLayerInfo(e,i){const r=this._isLayerUIDMatching(e.layer,i.layer.uid);return r&&(this._layerInfosByLayerViewId[i.uid]=e),r}_isLayerUIDMatching(e,i){return e&&(e.uid===i||this._hasLayerUID(e.layers,i))}_hasLayerUID(e,i){return e&&e.some(r=>this._isLayerUIDMatching(r,i))}_isLayerViewSupported(e){return!!G8e.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(N(()=>{var i;return[e.legendEnabled,(i=e.layer)==null?void 0:i.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){var i;return!this.respectLayerVisibility||e.legendEnabled&&((i=e.layer)==null?void 0:i.legendEnabled)}_buildActiveLayerInfo(e){var a;const i=e.layer,r=e.uid,n=this._layerInfosByLayerViewId[r];let s=this._activeLayerInfosByLayerViewId[r];if(!s){const u=(n==null?void 0:n.title)!==void 0&&n.layer.uid===i.uid;s=new mue({layer:i,layerView:e,title:u?n.title:i.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:(n==null?void 0:n.sublayerIds)||[]}),this._activeLayerInfosByLayerViewId[r]=s}const o=i.parent&&"uid"in i.parent?this._layerViewByLayerId[(a=i.parent)==null?void 0:a.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[o==null?void 0:o.uid],!this.hasHandles(r)){const u=[N(()=>i.title,d=>this._titleHandle(d,s)),N(()=>[i.opacity,"renderer"in i&&i.renderer,"pointSymbol"in i&&i.pointSymbol,"lineSymbol"in i&&i.lineSymbol,"polygonSymbol"in i&&i.polygonSymbol],()=>this._constructLegendElements(s)),Hi(()=>{var d;return((d=this.view)==null?void 0:d.stationary)===!0},()=>this._scaleHandle(s),be),N(()=>e.layer?G7(e.layer,e.view):null,()=>this._constructLegendElements(s)),N(()=>e.updating,()=>{e.layer!=null&&G7(e.layer,e.view)!=null&&this._constructLegendElements(s)}),N(()=>"effect"in i&&i.effect,()=>this._constructLegendElements(s)),Hi(()=>{var d;return(d=this.view)==null?void 0:d.timeZone},()=>this._constructLegendElements(s),be)];if(this.respectLayerVisibility){const d=N(()=>e.legendEnabled,h=>this._legendEnabledHandle(h,s)),p=N(()=>i.legendEnabled,h=>this._legendEnabledHandle(h,s));u.push(d,p)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in i){const d=N(()=>[i.definitionExpression,this.respectLayerDefinitionExpression],()=>{s.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(s)});u.push(d)}this.addHandles(u,r)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(e,i){i.title=e,this._constructLegendElements(i)}_legendEnabledHandle(e,i){e?this._addActiveLayerInfo(i):this._removeActiveLayerInfo(i)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var n;const{layerView:i,layer:r}=e;if(this._isLayerActive(i)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const o=(n=this.layerInfos)==null?void 0:n.some(u=>u.layer.uid===r.uid),a=r.parent;a&&"uid"in a&&this._layerViewByLayerId[a.uid]&&!o?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const o=[];this._activeLayerInfosWithNoParent.forEach(a=>{const u=a.layer.parent,d=u&&"uid"in u?this._layerViewByLayerId[u==null?void 0:u.uid]:null,p=this._activeLayerInfosByLayerViewId[d==null?void 0:d.uid];p&&(o.push(a),a.parent=p)}),o.length&&(this._activeLayerInfosWithNoParent.removeMany(o),o.forEach(a=>this._addActiveLayerInfo(a)))}}}_removeActiveLayerInfo(e){const i=e.parent;i?i.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const i=e.layer;"featureCollections"in i&&i.featureCollections?e.buildLegendElementsForFeatureCollections(i.featureCollections):"featureReduction"in i&&i.featureReduction&&"renderer"in i.featureReduction&&(i.featureReduction.type==="binning"||i.featureReduction.type==="cluster")&&(!this.view||i.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(i.featureReduction):"renderer"in i&&i.renderer&&!("sublayers"in i)?e.buildLegendElementsForRenderer(i.renderer):"url"in i&&i.url&&i.type!=="catalog"&&i.type!=="knowledge-graph"?e.buildLegendElementsForTools():e.children.forEach(r=>this._constructLegendElements(r))}};l([c({type:fue})],Lo.prototype,"activeLayerInfos",void 0),l([c()],Lo.prototype,"basemapLegendVisible",void 0),l([c()],Lo.prototype,"groundLegendVisible",void 0),l([c()],Lo.prototype,"hideLayersNotInCurrentView",void 0),l([c()],Lo.prototype,"keepCacheOnDestroy",void 0),l([c()],Lo.prototype,"respectLayerDefinitionExpression",void 0),l([c()],Lo.prototype,"respectLayerVisibility",void 0),l([c()],Lo.prototype,"layerInfos",void 0),l([c({readOnly:!0})],Lo.prototype,"state",null),l([c()],Lo.prototype,"view",void 0),Lo=l([$("esri.widgets.Legend.LegendViewModel")],Lo);const B8e=Lo,bt="esri-legend--card",Jg="esri-legend",ve={activated:`${bt}__carousel-indicator--activated`,base:bt,stacked:`${Jg}--stacked`,carouselTitle:`${bt}__carousel-title`,indicator:`${bt}__carousel-indicator`,intervalSeparator:`${bt}__interval-separator`,imageryLayerStretchedImage:`${bt}__imagery-layer-image--stretched`,imageLabel:`${bt}__image-label`,layerCaption:`${bt}__layer-caption`,labelElement:`${bt}__label-element`,layerRow:`${bt}__layer-row`,labelCell:`${bt}__label-cell`,message:`${bt}__message`,rampLabel:`${bt}__ramp-label`,section:`${bt}__section`,relationshipSection:`${bt}__relationship-section`,serviceCaptionText:`${bt}__service-caption-text`,serviceContent:`${bt}__service-content`,service:`${bt}__service`,groupLayer:`${bt}__group-layer`,groupLayerChild:`${bt}__group-layer-child`,symbol:`${bt}__symbol`,sizeRampRow:`${bt}__size-ramp-row`,symbolRow:`${bt}__symbol-row`,symbolCell:`${bt}__symbol-cell`,indicatorContainer:`${bt}__carousel-indicator-container`,intervalSeparatorsContainer:`${bt}__interval-separators-container`,relationshipLabelContainer:`${bt}__relationship-label-container`,labelContainer:`${bt}__label-container`,serviceCaptionContainer:`${bt}__service-caption-container`,symbolContainer:`${bt}__symbol-container`,sizeRampContainer:`${bt}__size-ramp-container`,sizeRampPreview:`${bt}__size-ramp-preview`,pieChartRampPreview:`${bt}__pie-chart-ramp-preview`,rampContainer:`${Jg}__ramps`,sizeRampHorizontal:`${Jg}__size-ramp--horizontal`,rampLabelsContainer:`${Jg}__ramp-labels`,layerInfo:`${Jg}__layer-cell ${Jg}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"},H8e=x2(),bue=10,dj=20,lL=10,pj=20,hj={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function q8e(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?b("svg",{height:"4",width:"10"},b("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):b("svg",{height:"10",width:"10"},b("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function W8e(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${dj}px`,i.className=hj.univariateAboveAndBelowSymbol,t!=null&&(i.style.opacity=t.toString()),H8e.append(i,q8e.bind(null,e)),i}function _ue(t,e,i="vertical",r){t.infos.forEach((n,s)=>{if(r&&s===2)n.preview=W8e(e,i);else{const o=si(n.size)+(i==="horizontal"?pj:lL),a=n.preview,u=(a==null?void 0:a.tagName.toLowerCase())==="div",d=u?a:document.createElement("div");d.className=hj.univariateAboveAndBelowSymbol,i==="horizontal"?d.style.width=`${o}px`:d.style.height=`${o}px`,!u&&a&&d.appendChild(a),n.preview=d}})}function gC(t,e="classic"){const i=t.infos;return e==="classic"?(si(i[0].size)+lL)/2:(si(i[0].size)-si(i[i.length-1].size))/2}function sb(t,e){if(!t)return null;const i=t.infos.map(n=>n.color),r=Hf(e.type==="full"?i:e.type==="above"?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return r.className=hj.colorRamp,e.opacity!=null&&(r.style.opacity=e.opacity.toString()),r}function RD(t,e,i,r="vertical"){let n=0;const s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,u=e==="full"||e==="below"?s.length-1:o;for(let d=a;d<=u;d++)i&&d===o?n+=r==="horizontal"?bue:dj:n+=si(s[d].size)+(r==="horizontal"?pj:lL);return Math.round(n)}function ob(t,e,i,r="vertical"){const n=RD(t,e,i,r),s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,u=e==="full"||e==="below"?s.length-1:o,d=e==="full"?s[a].size+s[u].size:e==="above"?s[a].size:s[u].size,p=i?r==="vertical"?dj:bue:0,h=r==="vertical"?lL*(e==="full"?2:1):pj*(e==="full"?2:1);return Math.round(n-(si(d)/2+p/2+h/2))}function wue(t,e,i="vertical"){const r=t.infos;let n=r.find(({type:o})=>o==="size-ramp"),s=r.find(({type:o})=>o==="color-ramp");return n&&(n={...n},n.infos=[...n.infos],_ue(n,e,i,!0)),s&&(s={...s},s.infos=[...s.infos]),i==="horizontal"&&(n==null||n.infos.reverse(),s==null||s.infos.reverse()),{sizeRampElement:n,colorRampElement:s}}function Sue(t,e="vertical"){const i=t.infos;let r=i.find(({type:s})=>s==="size-ramp"),n=i.find(({type:s})=>s==="color-ramp");return r&&(r={...r},r.infos=[...r.infos],_ue(r,null,e,!1)),n&&(n={...n},n.infos=[...n.infos]),e==="horizontal"&&(r==null||r.infos.reverse(),n==null||n.infos.reverse()),{sizeRampElement:r,colorRampElement:n}}function Z8e(t,e){return e}function Hr(t){const e=this;t.appendChild(e)}function im(t,e,i){if(!e)return;if(typeof e=="number")return e;if(typeof e=="string")return Ude(e);if("value"in e||"unit"in e)return Wr(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let r=null;return Z8e(e,i)?r=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:$ue(e,i)&&(r=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),r?Wr(r==="showField"?"{field}":t[r],{field:e.field,normField:e.normField}):void 0}function $ue(t,e){return!e}function Eue(t,e){return!!(e&&e==="Stretched"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}function Tue(t,e){var i;return t.label?e[t.label]+": "+(typeof t.value=="string"?t.value:Rn(t.value??0,{style:"decimal",notation:(i=t.value)!=null&&i.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}const J8e=25,Y8e=25,K8e=768,X8e=100,Q8e="#ddd",Yg=window.devicePixelRatio;function e9e(t){var e,i;if(t){if(t.type.includes("3d")){const r=(e=t.symbolLayers)==null?void 0:e.length;if(!r)return;const n=t.symbolLayers.at(r-1),s=(i=n.resource)==null?void 0:i.primitive;return s==="circle"||s==="cross"||s==="kite"||s==="sphere"||s==="cube"||s==="diamond"}{const r=t.style;return r==="circle"||r==="diamond"||r==="cross"}}}function t9e(t){var e;if(t){if(t.type.includes("3d")){const i=(e=t.symbolLayers)==null?void 0:e.length;if(!i)return;const r=t.symbolLayers.at(i-1).get("resource.primitive");return r==="triangle"||r==="cone"||r==="tetrahedron"}return t.style==="triangle"}}let Gl=class extends $t{constructor(e,i){super(e,i),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(N(()=>this.activeLayerInfos,e=>{this.removeAllHandles(),this._watchForSectionChanges(e)}))}render(){const{view:e}=this;this._hasIndicators=this.layout==="auto"&&e&&e.container.clientWidth<=K8e||this.layout==="stack";const i=this.activeLayerInfos,r=i==null?void 0:i.toArray().map(d=>this._renderLegendForLayer(d)).filter(d=>!!d);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,s=this._sectionNames.map((d,p)=>{const h=Wr(this.messagesCommon.pagination.pageText,{index:p+1,total:n});return b("div",{"aria-controls":`${d}-panel`,"aria-label":h,"aria-selected":(this._selectedSectionName===d).toString(),bind:this,class:this.classes(ve.indicator,{[ve.activated]:this._selectedSectionName===d}),"data-section-name":d,id:d,key:d,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===d?0:-1,title:h})}),o=this._hasIndicators&&n>1?b("div",{class:ve.indicatorContainer,key:"carousel-navigation",role:"tablist"},s):null,a=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):r!=null&&r.length?r:null,u={[ve.stacked]:this._hasIndicators};return b("div",{class:this.classes(ve.base,u)},a||b("div",{class:ve.message},this.messages.noLegend),o)}_selectSection(e){const i=e.target.getAttribute("data-section-name");i&&(this._selectedSectionName=i)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const i=e.key,r=i==="ArrowLeft"?-1:1,n=e.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(n),o=this._sectionNames;let a=null;s!==-1&&(o[s+r]?a=document.getElementById(o[s+r]):i==="ArrowLeft"?a=document.getElementById(o[o.length-1]):i==="ArrowRight"&&(a=document.getElementById(o[0])),a==null||a.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(r=>{const n=`activeLayerInfo-${r.layer.uid}-version-change`;this.removeHandles(n),this._watchForSectionChanges(r.children),this.addHandles(N(()=>r.version,()=>this._generateSectionNames()),n)});const i="activeLayerInfos-collection-change";this.removeHandles(i),this.addHandles(e.on("change",()=>this._watchForSectionChanges(e)),i)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,i,r){return`${this.id}${e.uid}-type-${i.type}-${r}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((i,r)=>{this._sectionNames.push(this._getSectionName(e.layer,i,r))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const i=e.children.map(r=>this._renderLegendForLayer(r)).toArray();return b("div",{class:this.classes(ve.service,ve.groupLayer),key:e.layer.uid},b("div",{class:ve.serviceCaptionContainer},e.title),i)}{const i=e.legendElements;if(i&&!i.length)return null;const r=i.some(o=>o.type==="relationship-ramp"),n=i.map((o,a)=>this._renderLegendForElement(o,e,a,r)).filter(o=>!!o);if(!n.length)return null;const s={[ve.groupLayerChild]:!!e.parent};return b("div",{class:this.classes(ve.service,s),key:e.layer.uid},b("div",{class:ve.serviceCaptionContainer},b("div",{class:ve.serviceCaptionText},e.title)),b("div",{class:ve.serviceContent},n))}}_renderLegendForElement(e,i,r,n=!1,s=!1){var v;const o=e.type==="color-ramp",a=e.type==="opacity-ramp",u=i.layer;let d=null;if(typeof e.title=="string")d=e.title;else if(e.title){const _=e.title,w=im(this.messages,_,o||a);d=_.title?`${_.title} (${w})`:w}const p=this._getSectionName(u,e,r),h=this._hasIndicators&&!s?b("div",null,b(Ya,{class:ve.carouselTitle,level:this.headingLevel},i.title),b(Ya,{class:ve.layerCaption,level:tb(this.headingLevel)},d)):d?b(Ya,{class:ve.layerCaption,level:this.headingLevel},d):null,m=i.effectList;let y=null;switch(e.type){case"symbol-table":{const _=e.infos.map((w,S)=>this._renderLegendForElementInfo(w,i,e.legendType,S)).filter(w=>!!w);if(_.length){const w=(v=_[0].properties.classes)==null?void 0:v[ve.symbolRow],S={[ve.labelContainer]:!w&&!n,[ve.relationshipLabelContainer]:n};y=b("div",{class:this.classes(S)},_)}break}case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":y=this._renderLegendForRamp(e,u.opacity,m);break;case"size-ramp":y=this._renderSizeRamp(e,u.opacity);break;case"pie-chart-ramp":y=this._renderPieChartRamp(e);break;case"relationship-ramp":y=joe(e,this.id,{opacity:u.opacity,effectList:m,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case"univariate-above-and-below-ramp":y=this._renderUnivariateAboveAndBelowRamp(e,u.opacity,m);break;case"univariate-color-size-ramp":y=this._renderUnivariateColorSizeRamp(e,u.opacity,m)}if(!y)return null;const g=b("div",{"aria-labelledby":p,class:ve.section,id:`${p}-panel`,key:p,role:"tabpanel",tabIndex:0},[h,y]);return s||this._sectionMap.set(p,g),g}_renderPieChartRamp(e){return b("div",{afterCreate:Hr,bind:e.preview,class:ve.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(e,i,r){var M;const{sizeRampElement:n,colorRampElement:s}=wue(e,i,"horizontal");if(!n)return null;const o=RD(n,"full",!0,"horizontal"),a=ob(n,"above",!0,"horizontal"),u=ob(n,"below",!0,"horizontal"),d=12,p=(M=this.messages)==null?void 0:M.previewColorRampAriaLabel,h=sb(s,{width:a,height:d,rampAlignment:"horizontal",opacity:i,type:"above",effectList:r,ariaLabel:p}),m=sb(s,{width:u,height:d,rampAlignment:"horizontal",opacity:i,type:"below",effectList:r,ariaLabel:p}),y=gC(n,"card"),g=n.infos.map(x=>x.label),v=g.length-1,_=g.map((x,C)=>C===0||C===v?b("div",{key:C},x):null),w={display:"flex",flexDirection:"column"},S={display:"flex",flexDirection:"row"},E={marginTop:"3px",display:"flex"};qy(this.container)?E.marginRight=`${y}px`:E.marginLeft=`${y}px`;const T={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return b("div",{class:ve.layerRow,key:"size-ramp-preview",styles:w},b("div",{class:this.classes(ve.symbolContainer,ve.sizeRampHorizontal),styles:S},n.infos.map((x,C)=>b("div",{afterCreate:Hr,bind:x.preview,class:ve.symbol,key:C}))),h?b("div",{class:ve.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:E},b("div",{afterCreate:Hr,bind:h}),b("div",{afterCreate:Hr,bind:m})):null,b("div",{class:ve.layerInfo},b("div",{class:ve.rampLabelsContainer,styles:T},_)))}_renderUnivariateColorSizeRamp(e,i,r){var _;const{sizeRampElement:n,colorRampElement:s}=Sue(e,"horizontal");if(!n)return null;const o=RD(n,"full",!1,"horizontal"),a=ob(n,"full",!1,"horizontal"),u=sb(s,{width:a,height:12,rampAlignment:"horizontal",opacity:i,type:"full",effectList:r,ariaLabel:(_=this.messages)==null?void 0:_.previewColorRampAriaLabel}),d=gC(n,"card"),p=n.infos.length-1,h=n.infos.map((w,S)=>S===0||S===p?b("div",{key:S},w.label):null),m={display:"flex",flexDirection:"column"},y={display:"flex",flexDirection:"row"},g={marginTop:"3px",display:"flex"};qy(this.container)?g.marginRight=`${d}px`:g.marginLeft=`${d}px`;const v={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return b("div",{class:ve.layerRow,key:"size-ramp-preview",styles:m},b("div",{class:this.classes(ve.symbolContainer,ve.sizeRampHorizontal),styles:y},n.infos.map((w,S)=>b("div",{afterCreate:Hr,bind:w.preview,class:ve.symbol,key:S}))),b("div",{class:ve.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:g},b("div",{afterCreate:Hr,bind:u})),b("div",{class:ve.layerInfo},b("div",{class:ve.rampLabelsContainer,styles:v},h)))}_renderLegendForElementInfo(e,i,r,n){var u,d,p,h,m;const s=i.layer;if(e.type)return this._renderLegendForElement(e,i,n,!1,!0);const o=Eue(s,r),a=im(this.messages,e.label,!1)??"";if(e.preview){if(!((u=e.symbol)!=null&&u.type.includes("simple-fill"))){if(!e.label)return b("div",{afterCreate:Hr,bind:e.preview,key:n});const V={[ve.symbolCell]:this._hasIndicators};return b("div",{class:this.classes(ve.layerRow,{[ve.symbolRow]:this._hasIndicators}),key:n},b("div",{afterCreate:Hr,bind:e.preview,class:this.classes(V)}),b("div",{class:this.classes(ve.imageLabel,{[ve.labelCell]:this._hasIndicators})},a))}let y=255,g=255,v=255,_=0,w=255,S=255,E=255,T=0;const M=(d=e.symbol.color)==null?void 0:d.a,x=(h=(p=e.symbol.outline)==null?void 0:p.color)==null?void 0:h.a;M&&(y=e.symbol.color.r,g=e.symbol.color.g,v=e.symbol.color.b,_=e.symbol.color.a*s.opacity),x&&(w=e.symbol.outline.color.r,S=e.symbol.outline.color.g,E=e.symbol.outline.color.b,T=e.symbol.outline.color.a*s.opacity);const C=((m=e.symbol.color)==null?void 0:m.isBright)??!0,O=C?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",F={background:M?`rgba(${y}, ${g}, ${v}, ${_})`:"none",color:C?"black":"white",textShadow:`-1px -1px 0 ${O},
                                              1px -1px 0 ${O},
                                              -1px 1px 0 ${O},
                                              1px 1px 0 ${O}`,border:x?`1px solid rgba(${w}, ${S}, ${E}, ${T})`:"none",filter:E$(i.effectList)??void 0};return b("div",{class:ve.layerRow,key:n},b("div",{class:ve.labelElement,styles:F},a))}if(e.src){const y=this._renderImage(e,s,o);return b("div",{class:ve.layerRow,key:n},y,b("div",{class:ve.imageLabel},a))}}_renderImage(e,i,r){const{label:n,src:s,opacity:o}=e,a={[ve.imageryLayerStretchedImage]:r,[ve.symbol]:!r},u={opacity:`${o??i.opacity}`};return b("img",{alt:im(this.messages,n,!1),"aria-label":im(this.messages,n,!1),border:0,class:this.classes(a),height:e.height,src:s,styles:u,width:e.width})}_renderSizeRampLines(e){const i=e.infos,r=i[0],n=i[i.length-1],s=r.symbol,o=this._hasIndicators,a=si(r.size+r.outlineSize)*Yg,u=si(n.size+n.outlineSize)*Yg,d=o?a:a+50*Yg,p=o?a/2+50*Yg:a,h=t9e(s),m=e9e(s),y=document.createElement("canvas");y.width=d,y.height=p,y.style.width=y.width/Yg+"px",y.style.height=y.height/Yg+"px";const g=y.getContext("2d");if(o){g.beginPath();const v=0,_=0,w=d/2-u/2,S=p;g.moveTo(v,_),g.lineTo(w,S);const E=d,T=0,M=d/2+u/2,x=p;g.moveTo(E,T),g.lineTo(M,x)}else{g.beginPath();const v=0,_=p/2-u/2,w=d;g.moveTo(v,_),g.lineTo(w,0);const E=0,T=p/2+u/2,M=d,x=p;g.moveTo(E,T),g.lineTo(M,x)}return g.strokeStyle=Q8e,g.stroke(),b("div",{afterCreate:Hr,bind:y,styles:o?{display:"flex",marginTop:`-${h?0:m?a/2:0}px`,marginBottom:`-${h?u:m?u/2:0}px`}:{display:"flex",marginRight:`-${h?0:m?a/2:0}px`,marginLeft:`-${h?0:m?u/2:0}px`}})}_renderSizeRamp(e,i){const r=e.infos,n=r[0].label,s=r[r.length-1].label;let o=r[0].preview,a=r[r.length-1].preview;const u=this._hasIndicators,d={"flex-direction":u?"column":"row-reverse"};o&&(o=o.cloneNode(!0),o.style.display="flex"),a&&(a=a.cloneNode(!0),a.style.display="flex");const p={opacity:i!=null?`${i}`:""};return b("div",{class:this.classes(ve.layerRow,{[ve.sizeRampRow]:u})},b("div",{class:ve.rampLabel},u?n:s),b("div",{class:ve.sizeRampContainer,styles:d},b("div",{afterCreate:Hr,bind:o,class:ve.sizeRampPreview,styles:p}),this._renderSizeRampLines(e),b("div",{afterCreate:Hr,bind:a,class:ve.sizeRampContainer,styles:p})),b("div",{class:ve.rampLabel},u?s:n))}_getRampStopLabel(e,i){switch(i){case"heatmap-ramp":return this.messages[e.label];case"stretch-ramp":return Tue(e,this.messages);default:return e.label}}_renderLegendForRamp(e,i,r){const n=e.infos,s=e.type,o=s==="heatmap-ramp",a=n.length-1,u=Y8e,d=a>2&&!o?J8e*a:X8e,p=d+20,h=10,m=n.slice().reverse(),y=m.length-1,g=m.length%2!=0?m[m.length/2|0]:null,v=g&&b("div",{class:ve.intervalSeparatorsContainer},b("div",{class:ve.intervalSeparator},"|"),b("div",{class:ve.rampLabel},this._getRampStopLabel(g,s))),_=[[{shape:{type:"path",path:`M0 ${u/2} L${h} 0 L${h} ${u} Z`},fill:m[0].color,stroke:{width:0}},{shape:{type:"rect",x:h,y:0,width:d,height:u},fill:{type:"linear",x1:h,y1:0,x2:d+h,y2:0,colors:m.map((T,M)=>({color:T.color,offset:o&&"ratio"in T?T.ratio:M/a}))},stroke:{width:0}},{shape:{type:"path",path:`M${d+h} 0 L${p} ${u/2} L${d+h} ${u} Z`},fill:m[y].color,stroke:{width:0}}]],w=Noe(_,p,u),S={filter:E$(r)??void 0,opacity:i==null?void 0:`${i}`},E={justifyContent:"center"};return b("div",{class:ve.layerRow,styles:E},b("div",{class:ve.rampLabel},this._getRampStopLabel(m[0],s)),b("div",{class:ve.symbolContainer},b("div",{styles:S},w),v),b("div",{class:ve.rampLabel},this._getRampStopLabel(m[y],s)))}};l([c()],Gl.prototype,"activeLayerInfos",void 0),l([c()],Gl.prototype,"headingLevel",void 0),l([c()],Gl.prototype,"layout",void 0),l([c(),Ue("esri/widgets/Legend/t9n/Legend")],Gl.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Gl.prototype,"messagesCommon",void 0),l([c({readOnly:!0})],Gl.prototype,"type",void 0),l([c()],Gl.prototype,"view",void 0),l([xy()],Gl.prototype,"_selectSection",null),Gl=l([$("esri.widgets.Legend.styles.Card")],Gl);const $O=Gl,It="esri-legend",Ce={service:`${It}__service`,label:`${It}__service-label`,layer:`${It}__layer`,groupLayer:`${It}__group-layer`,groupLayerChild:`${It}__group-layer-child`,layerTable:`${It}__layer-table`,layerTableSizeRamp:`${It}__layer-table--size-ramp`,layerChildTable:`${It}__layer-child-table`,layerCaption:`${It}__layer-caption`,layerBody:`${It}__layer-body`,layerRow:`${It}__layer-row`,layerCell:`${It}__layer-cell`,layerInfo:`${It}__layer-cell ${It}__layer-cell--info`,imageryLayerStretchedImage:`${It}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${It}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${It}__imagery-layer-info--stretched`,symbolContainer:`${It}__layer-cell ${It}__layer-cell--symbols`,symbol:`${It}__symbol`,rampContainer:`${It}__ramps`,sizeRamp:`${It}__size-ramp`,colorRamp:`${It}__color-ramp`,opacityRamp:`${It}__opacity-ramp`,borderlessRamp:`${It}__borderless-ramp`,rampTick:`${It}__ramp-tick`,rampFirstTick:`${It}__ramp-tick-first`,rampLastTick:`${It}__ramp-tick-last`,rampLabelsContainer:`${It}__ramp-labels`,rampLabel:`${It}__ramp-label`,message:`${It}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},i9e=`${It}__`,r9e=24,Z7={display:"flex",alignItems:"flex-start"},EO={marginLeft:"3px"},Kg={display:"table-cell",verticalAlign:"middle"};let Xf=class extends $t{constructor(e,i){super(e,i),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,i=e==null?void 0:e.toArray().map(r=>this._renderLegendForLayer(r)).filter(r=>!!r);return b("div",null,i!=null&&i.length?i:b("div",{class:Ce.message},this.messages.noLegend))}_renderLegendForLayer(e,i){if(!e.ready)return null;const r=!!e.children.length,n=`${e.layer.uid}-version-${e.version}`,s=`${i9e}${i?`${i}-`:""}${n}`,o=e.title?Ya({level:this.headingLevel,class:this.classes(K.heading,Ce.label)},e.title):null;if(r){const a=e.children.map(u=>this._renderLegendForLayer(u,n)).toArray();return b("div",{class:this.classes(Ce.service,Ce.groupLayer),key:s},o,a)}{const a=e.legendElements;if(a&&!a.length)return null;const u=a.map(p=>this._renderLegendForElement(p,e.layer,e.effectList,s)).filter(p=>!!p);if(!u.length)return null;const d={[Ce.groupLayerChild]:!!e.parent};return b("div",{class:this.classes(Ce.service,d),key:s},o,b("div",{class:Ce.layer},u))}}_renderLegendForElement(e,i,r,n,s){const o=e.type==="color-ramp",a=e.type==="opacity-ramp",u=e.type==="size-ramp";let d=null;const p=`${n}-${e.type}`;if(e.type==="symbol-table"||u){const _=e.infos.map(w=>this._renderLegendForElementInfo(w,i,r,u,e.legendType,p)).filter(w=>!!w);_.length&&(d=b("div",{class:Ce.layerBody},_))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?d=this._renderLegendForRamp(e,i.opacity,p):e.type==="relationship-ramp"?d=joe(e,this.id,{opacity:i.opacity,effectList:r,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:p}):e.type==="pie-chart-ramp"?d=this._renderPieChartRamp(e,p):e.type==="univariate-above-and-below-ramp"?d=this._renderUnivariateAboveAndBelowRamp(e,i.opacity,r,p):e.type==="univariate-color-size-ramp"&&(d=this._renderUnivariateColorSizeRamp(e,i.opacity,r,p));if(!d)return null;const h=e.title;let m=null;if(typeof h=="string")m=h;else if(h){const _=im(this.messages,h,o||a);m=$ue(h,o||a)&&h.title?`${h.title} (${_})`:_}const y=s?Ce.layerChildTable:Ce.layerTable,g=m?b("div",{class:Ce.layerCaption},m):null,v={[Ce.layerTableSizeRamp]:u||!s};return b("div",{class:this.classes(y,v),key:`${n}-table`},g,d)}_renderPieChartRamp(e,i){return b("div",{afterCreate:Hr,bind:e.preview,key:`${i}-preview`})}_renderUnivariateAboveAndBelowRamp(e,i,r,n){var C;const{sizeRampElement:s,colorRampElement:o}=wue(e,i);if(!s)return null;const a=(C=this.messages)==null?void 0:C.previewColorRampAriaLabel,u=ob(s,"above",!0),d=ob(s,"below",!0),p=12,h=sb(o,{width:p,height:u,rampAlignment:"vertical",opacity:i,type:"above",effectList:r,ariaLabel:a}),m=sb(o,{width:p,height:d,rampAlignment:"vertical",opacity:i,type:"below",effectList:r,ariaLabel:a}),y=gC(s),g=s.infos.map(O=>O.label),v=g.map((O,F)=>F===0?b("div",{class:O?h?Ce.univariateAboveAndBelowLabel:Ce.rampLabel:void 0,key:`${n}-color-ramp-above-label-${O??F}`},O):F===2?b("div",null):null),_=g.length-1,w=Math.floor(g.length/2),S=g.map((O,F)=>F===w||F===_?b("div",{class:O?h?Ce.univariateAboveAndBelowLabel:Ce.rampLabel:void 0,key:`${n}-color-ramp-below-label-${O??F}`},O):null),E={display:"table-cell",verticalAlign:"middle"},T={marginTop:`${y}px`},M={height:`${u}px`},x={height:`${d}px`};return b("div",{key:`${n}-container`,styles:Z7},b("div",{class:Ce.layerBody},s.infos.map((O,F)=>b("div",{class:this.classes(Ce.layerRow,Ce.sizeRamp),key:`${n}-row-${F}`},b("div",{afterCreate:Hr,bind:O.preview,class:Ce.symbol,styles:E}),h||F%2!=0?null:b("div",{class:Ce.layerInfo},g[F])))),h?b("div",{styles:T},b("div",{styles:EO},b("div",{styles:Kg},b("div",{afterCreate:Hr,bind:h,class:Ce.rampContainer})),b("div",{styles:Kg},b("div",{class:Ce.rampLabelsContainer,styles:M},v))),b("div",{styles:EO},b("div",{styles:Kg},b("div",{afterCreate:Hr,bind:m,class:Ce.rampContainer})),b("div",{styles:Kg},b("div",{class:Ce.rampLabelsContainer,styles:x},S)))):null)}_renderUnivariateColorSizeRamp(e,i,r,n){var _;const{sizeRampElement:s,colorRampElement:o}=Sue(e);if(!s)return null;const a=gC(s),u=12,d=ob(s,"full",!1),p=sb(o,{width:u,height:d,rampAlignment:"vertical",opacity:i,type:"full",effectList:r,ariaLabel:(_=this.messages)==null?void 0:_.previewColorRampAriaLabel}),h=s.infos.length-1,m=s.infos.map((w,S)=>S===0||S===h?b("div",{class:w.label?o?Ce.univariateAboveAndBelowLabel:Ce.rampLabel:void 0,key:`${n}-color-ramp-label-${w.label??S}`},w.label):null),y={display:"table-cell",verticalAlign:"middle"},g={marginTop:`${a}px`},v={height:`${d}px`};return b("div",{key:`${n}-container`,styles:Z7},b("div",{class:Ce.layerBody},s.infos.map((w,S)=>b("div",{class:this.classes(Ce.layerRow,Ce.sizeRamp),key:`${n}-row-${S}`},b("div",{afterCreate:Hr,bind:w.preview,class:Ce.symbol,styles:y})))),b("div",{styles:g},b("div",{styles:EO},b("div",{styles:Kg},b("div",{afterCreate:Hr,bind:p,class:Ce.rampContainer})),b("div",{styles:Kg},b("div",{class:Ce.rampLabelsContainer,styles:v},m)))))}_renderLegendForRamp(e,i,r){const n=e.infos,s=e.type==="opacity-ramp",o=e.type==="heatmap-ramp",a=e.type==="stretch-ramp",u=e.preview,d=s?Ce.opacityRamp:"";u.className=`${Ce.colorRamp} ${d}`,i!=null&&(u.style.opacity=i.toString());const p=n.map((y,g)=>b("div",{class:y.label?Ce.rampLabel:void 0,key:`${r}-stop-${y.label??g}-label`},o?this.messages[y.label]||y.label:a?Tue(y,this.messages):y.label)),h={width:`${r9e}px`},m={height:u.style.height};return b("div",{class:Ce.layerRow,key:`${r}-row`},b("div",{class:Ce.symbolContainer,styles:h},b("div",{afterCreate:Hr,bind:u,class:Ce.rampContainer})),b("div",{class:Ce.layerInfo},b("div",{class:Ce.rampLabelsContainer,styles:m},p)))}_renderLegendForElementInfo(e,i,r,n,s,o){const a=`${o}-${e.label}`;if(e.type)return this._renderLegendForElement(e,i,r,a,!0);let u=null;const d=Eue(i,s);if(e.preview?u=b("div",{afterCreate:Hr,bind:e.preview,class:Ce.symbol}):e.src&&(u=this._renderImage(e,i,d)),!u)return null;const p={[Ce.imageryLayerInfoStretched]:d},h={[Ce.imageryLayerInfoStretched]:d,[Ce.sizeRamp]:!d&&n};return b("div",{class:Ce.layerRow,key:`${a}-row`},b("div",{class:this.classes(Ce.symbolContainer,h)},u),b("div",{class:this.classes(Ce.layerInfo,p)},im(this.messages,e.label,!1)||""))}_renderImage(e,i,r){const{label:n,src:s,opacity:o}=e,a={[Ce.imageryLayerStretchedImage]:r,[Ce.symbol]:!r},u={opacity:`${o??i.opacity}`};return b("img",{alt:im(this.messages,n,!1),"aria-label":im(this.messages,n,!1),border:0,class:this.classes(a),height:e.height,src:s,styles:u,width:e.width})}};l([c()],Xf.prototype,"activeLayerInfos",void 0),l([c()],Xf.prototype,"headingLevel",void 0),l([c(),Ue("esri/widgets/Legend/t9n/Legend")],Xf.prototype,"messages",void 0),l([c({readOnly:!0})],Xf.prototype,"type",void 0),Xf=l([$("esri.widgets.Legend.styles.Classic")],Xf);const Xg=Xf,n9e={base:"esri-legend"};let Br=class extends $t{constructor(e,i){super(e,i),this.headingLevel=3,this.messages=null,this.style=new Xg,this.viewModel=new B8e}initialize(){this.addHandles([St(()=>this.view,"resize",()=>this.scheduleRender()),St(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),N(()=>this.headingLevel,e=>{const{style:i}=this;i&&(i.headingLevel=e)}),N(()=>this.style,(e,i)=>{i&&e!==i&&i.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},be)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof $O||e instanceof Xg)return e;if(typeof e=="string")return e==="card"?new $O:new Xg;if(e&&typeof e.type=="string"){const i={...e};return delete i.type,new(e.type==="card"?$O:Xg)(i)}return new Xg}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return b("div",{class:this.classes(n9e.base,K.widget,this.style instanceof Xg?K.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach(i=>{this.removeHandles(`version_${i.layer.uid}`),this._renderOnActiveLayerInfoChange(i)}),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const i=N(()=>e.version,()=>this.scheduleRender());this.addHandles(i,`version_${e.layer.uid}`);const r=St(()=>e.children,"change",()=>e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n)),be);this.addHandles(r,`version_${e.layer.uid}`),e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))}};l([c()],Br.prototype,"activeLayerInfos",null),l([c()],Br.prototype,"basemapLegendVisible",null),l([c()],Br.prototype,"groundLegendVisible",null),l([c()],Br.prototype,"headingLevel",void 0),l([c()],Br.prototype,"hideLayersNotInCurrentView",null),l([c()],Br.prototype,"keepCacheOnDestroy",null),l([c()],Br.prototype,"respectLayerDefinitionExpression",null),l([c()],Br.prototype,"respectLayerVisibility",null),l([c()],Br.prototype,"icon",null),l([c()],Br.prototype,"label",null),l([c()],Br.prototype,"layerInfos",null),l([c(),Ue("esri/widgets/Legend/t9n/Legend")],Br.prototype,"messages",void 0),l([c()],Br.prototype,"style",void 0),l([We("style")],Br.prototype,"castStyle",null),l([c()],Br.prototype,"view",null),l([c()],Br.prototype,"viewModel",void 0),Br=l([$("esri.widgets.Legend")],Br);const Iue=Br,s9e=Object.freeze(Object.defineProperty({__proto__:null,default:Iue},Symbol.toStringTag,{value:"Module"})),ai="esri-search",zt={base:ai,hasMultipleSources:`${ai}--multiple-sources`,isLoading:`${ai}--loading`,isSearching:`${ai}--searching`,showSuggestions:`${ai}--show-suggestions`,showSources:`${ai}--sources`,showWarning:`${ai}--warning`,container:`${ai}__container`,input:`${ai}__input`,inputContainer:`${ai}__input-container`,form:`${ai}__form`,submitButton:`${ai}__submit-button`,sourcesButton:`${ai}__sources-button`,sourcesButtonDown:`${ai}__sources-button--down`,sourcesButtonUp:`${ai}__sources-button--up`,clearButton:`${ai}__clear-button`,sourceName:`${ai}__source-name`,suggestionsMenu:`${ai}__suggestions-menu`,suggestionList:`${ai}__suggestions-list`,suggestionListCurrentLocation:`${ai}__suggestions-list--current-location`,sourcesMenu:`${ai}__sources-menu`,source:`${ai}__source`,warningMenu:`${ai}__warning-menu`,warningMenuBody:`${ai}__warning-body`,warningMenuHeader:`${ai}__warning-header`,warningMenuText:`${ai}__warning-text`,noValueText:`${ai}__no-value-text`},Wm="esri-search-result-renderer",Zm={base:Wm,showMoreResults:`${Wm}__more-results--show-more-results`,moreResults:`${Wm}__more-results`,moreResultsList:`${Wm}__more-results-list`,moreResultsHeader:`${Wm}__more-results-header`,moreResultsItem:`${Wm}__more-results-item`,moreResultsListHeader:`${Wm}__more-results-list-header`};function J7(t){var e;switch(t==null?void 0:t.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":case"polyline":return(e=t.extent)==null?void 0:e.center;default:return null}}async function o9e(t,e){var n,s;if(t.hasZ||e.type==="2d")return t;const i=(n=e.map)==null?void 0:n.ground;if(!(i!=null&&i.layers.length))return t;const{geometry:r}=await i.queryElevation(t,{cache:(s=e.basemapTerrain)==null?void 0:s.elevationQueryCache});return r}function PD(t,e,i){return xue(t.center,e,i)}function mj(t,e,i){switch(t==null?void 0:t.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return xue(t,e,i);default:return null}}function xue(t,e,i){const r=t.hasZ?t.z:void 0;if(e!=null&&e.map)return(i!=null?SBe(e,i):e.extent).clone().centerAt(t).set({zmax:r,zmin:r});const{x:n,y:s,spatialReference:o}=t;return new at({xmin:n-.25,ymin:s-.25,xmax:n+.25,ymax:s+.25,spatialReference:o,zmin:r,zmax:r})}let cr=class extends vu(j){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};l([c()],cr.prototype,"autoNavigate",void 0),l([c()],cr.prototype,"filter",void 0),l([c()],cr.prototype,"getResults",void 0),l([c()],cr.prototype,"getSuggestions",void 0),l([c()],cr.prototype,"maxResults",void 0),l([c()],cr.prototype,"maxSuggestions",void 0),l([c()],cr.prototype,"minSuggestCharacters",void 0),l([c()],cr.prototype,"outFields",void 0),l([c()],cr.prototype,"placeholder",void 0),l([c()],cr.prototype,"popupEnabled",void 0),l([c()],cr.prototype,"popupTemplate",void 0),l([c()],cr.prototype,"prefix",void 0),l([c()],cr.prototype,"resultGraphicEnabled",void 0),l([c()],cr.prototype,"resultSymbol",void 0),l([c()],cr.prototype,"suggestionsEnabled",void 0),l([c()],cr.prototype,"suffix",void 0),l([c()],cr.prototype,"withinViewEnabled",void 0),l([c()],cr.prototype,"zoomScale",void 0),cr=l([$("esri.widgets.Search.SearchSource")],cr);const fj=cr,a9e=/https?:\/\/services.*\.arcgis\.com/i,l9e=/(?:\{([^}]+)\})/g,ab=()=>U.getLogger("esri.widgets.Search.support.layerSearchUtils");function u9e(t,e){const{exactMatch:i=!1,location:r,maxResults:n,spatialReference:s,source:o,sourceIndex:a,suggestResult:u,view:d}=t,{layer:p,filter:h,zoomScale:m}=o,y=d==null?void 0:d.scale,g=Mue(o,d),v=e==null?void 0:e.signal;return kue(p).then(()=>{const _=p.popupTemplate;return _?_.getRequiredFields(p.fieldsIndex):null}).then(_=>{var z,H,Q,J;const{objectIdField:w,returnZ:S}=p,E=Fue(o);if(!yj(p,E))throw ab().error("invalid-field: displayField is invalid."),new L("getResults():invalid-field","displayField is invalid.");const T=_!=null&&_.length?_:[E],M=o.outFields||T,x=Cue(M);if(M.includes(w)||x||M.push(w),(z=p.floorInfo)!=null&&z.floorField&&M.push(p.floorInfo.floorField),!(x||vC(p,M)))throw ab().error("invalid-field: outField is invalid."),new L("getResults():invalid-field","outField is invalid.");const C=p.createQuery(),{orderByFields:O}=o;if(O&&(C.orderByFields=O),s){C.outSpatialReference=s;const ne=1/Ci(s);ne&&(C.maxAllowableOffset=ne)}const F=p.geometryType==="mesh"||p.geometryType==="multipatch",V=((Q=(H=p.capabilities)==null?void 0:H.data)==null?void 0:Q.supportsZ)&&!F;if(C.returnZ=V&&S!==!1,C.returnGeometry=!0,C.multipatchOption=F?"xyFootprint":null,M&&(C.outFields=M),r)C.geometry=r;else if(u.key)C.objectIds=[u.key];else{const ne=o.searchFields||[E];if(!vC(p,ne))throw ab().error("invalid-field: search field is invalid."),new L("getResults():invalid-field","search field is invalid.");if(Pue(p)&&(C.num=n),g&&(C.geometry=g),!((J=u.text)==null?void 0:J.trim()))return[];const _e=u.text,{prefix:ue="",suffix:it=""}=o,Xr=Nue(`${ue}${_e}${it}`);Rue(p)&&Aue(p,ne)&&!i&&_e&&(C.fullText=Oue({text:_e,searchFields:ne}));const us=Due({searchTerm:Xr,layer:p,searchFields:ne,filter:h,exactMatch:i,query:C,type:"search"});if(C.where=us,!Lue(C))return[]}return p.queryFeatures(C,{signal:v}).then(ne=>S9e(ne,d,o,a,E,y,m))})}function c9e(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:s,maxSuggestions:o,sourceIndex:a,exactMatch:u}=t,{layer:d,filter:p}=i,h=e==null?void 0:e.signal,m=Mue(i,n);return kue(d).then(()=>{if(!Pue(d))return[];const y=Fue(i),g=i.searchFields||[y],v=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(l9e,(V,z)=>(v.push(z),V)):v.push(y);const _=Cue(v);v.includes(d.objectIdField)||_||v.push(d.objectIdField);const w=yj(d,y),S=_||vC(d,v),E=vC(d,g);if(!w)throw ab().error("invalid-field: displayField is invalid."),new L("getSuggestions():invalid-field","displayField is invalid.");if(!S)throw ab().error("invalid-field: outField is invalid."),new L("getSuggestions():invalid-field","outField is invalid.");if(!E)throw ab().error("invalid-field: search field is invalid."),new L("getSuggestions():invalid-field","search field is invalid.");const T=d.createQuery(),{orderByFields:M}=i;if(M&&(T.orderByFields=M),T.outSpatialReference=r,T.returnGeometry=!1,T.num=o,T.outFields=v,m&&(T.geometry=m),!s.trim())return[];const{prefix:x="",suffix:C=""}=i,O=Nue(`${x}${s}${C}`);Rue(d)&&Aue(d,g)&&!u&&s&&(T.fullText=Oue({text:s,searchFields:g}));const F=Due({searchTerm:O,layer:d,searchFields:g,filter:p,exactMatch:u,query:T,type:"suggest"});return T.where=F,Lue(T)?d.queryFeatures(T,{signal:h}).then(V=>b9e(V,i,a,y)):[]})}function Mue(t,e){const{filter:i,withinViewEnabled:r}=t,n=e==null?void 0:e.extent;return(i==null?void 0:i.geometry)??(r&&n?n:void 0)}function Cue(t){return t&&t.includes("*")}async function kue(t){t&&await t.load()}function Lue(t){return!(!t.fullText&&!t.where)}function Aue(t,e){const i=t==null?void 0:t.indexes;return!i||!(e!=null&&e.length)?!1:i.filter(r=>r.indexType==="FullText").some(r=>{var s;const n=((s=r.fields)==null?void 0:s.split(",").map(o=>o.trim().toLowerCase()))||[];return e.every(o=>n.includes(o.toLowerCase()))})}function Oue({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new rie({onFields:e,searchTerm:i,searchType:"prefix"}))}function Rue(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsFullTextSearch)??!1}function Pue(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsPagination)??!1}function d9e(t){var e,i,r;return((r=(i=(e=t==null?void 0:t.fieldsIndex)==null?void 0:e.fields)==null?void 0:i.find(n=>n.type==="string"))==null?void 0:r.name)??""}function Fue(t){return t.displayField||t.layer.displayField||d9e(t.layer)}function vC(t,e){return!(!t||!(e!=null&&e.length))&&e.every(i=>yj(t,i))}function yj(t,e){return!!t.getField(e)}function p9e(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function h9e({codedValues:t},e,i){return mb(t??[],r=>{const n=r.name,s=i?n:n.toLowerCase();return(i?e:e.toLowerCase())===s?r.code.toString():null})??null}function Nue(t){return t.replaceAll("'","''")}function gw(t,e){const i=e==null?void 0:e.where;return i?`(${t}) AND (${i})`:t}function m9e({currentTerm:t,field:e,filter:i,exactMatch:r,url:n,type:s}){const o=e==null?void 0:e.type,a=e==null?void 0:e.name;if(o==="string"||o==="date"||o==="global-id"){const u=a9e.test(n??""),d=u&&p9e(t)?"N":"";return gw(r&&s==="search"?`${a} = ${d}'${t}'`:u?`${a} LIKE ${d}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${d}${`'${t.toLowerCase()}%'`}`,i)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const u=Number(t);return isNaN(u)?null:gw(`${a} = ${u}`,i)}return gw(`${a} = ${t}`,i)}function f9e(t,e){return t?` OR (${e})`:`(${e})`}function Due({searchTerm:t,layer:e,searchFields:i,filter:r,exactMatch:n,query:s,type:o}){const{definitionExpression:a,url:u}=e;let d="";return!s.fullText&&t&&i&&i.forEach(p=>{const h=e.getField(p),m=typeof e.getFieldDomain=="function"&&e.getFieldDomain(p),y=(m&&m.type==="coded-value"?h9e(m,t,n):null)||t||null;if(y!==null){const g=m9e({currentTerm:y,field:h,filter:r,exactMatch:n,url:u,type:o});g&&(d+=f9e(d,g))}}),a&&d?`(${a}) AND (${d})`:a||d}function y9e(t,e){let i=null;const{codedValues:r}=t;return r&&r.length&&r.some(n=>n.code===e&&(i=n.name,!0)),i}function g9e(t,e){return t[e]??t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function Vue(t,e,i){const r=t.sourceLayer,{attributes:n}=t,s=typeof r.getFieldDomain=="function"&&r.getFieldDomain(i);if(e)return Wr(e,n);if(i&&n){const o=r.getField(i),a=g9e(n,i);return a==null?"":s&&s.type==="coded-value"?y9e(s,a)??"":(o==null?void 0:o.type)==="date"?hr(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function v9e(t,e,i,r){const n=t.sourceLayer,{attributes:s}=t,{objectIdField:o}=n,a=o?s[o]:null;return{text:Vue(t,e.suggestionTemplate,r),key:a,sourceIndex:i}}function b9e(t,e,i,r){return t.features.map(n=>v9e(n,e,i,r))}function _9e(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function w9e(t,e,i,r,n,s,o){const a=t.clone(),u=t.sourceLayer,d=u==null?void 0:u.objectIdField,p=d?t.attributes[d]:null,h=Vue(t,i.searchTemplate,n);s!=null&&_9e(u)&&(u.minScale&&u.minScale<s?s=u.minScale:u.maxScale&&u.maxScale>s&&(s=u.maxScale));const m=a.geometry?mj(a.geometry,e??void 0,s??void 0):void 0,y=typeof o=="number"&&m?PD(R(m),e??void 0,o):m,g=t.clone();return y!=null&&(g.geometry=os.fromExtent(y)),{extent:y,target:g,feature:a,key:p,name:h,sourceIndex:r}}function S9e(t,e,i,r,n,s,o){return t.features.map(a=>w9e(a,e,i,r,n,s,o))}var FD;let zl=FD=class extends fj{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>u9e({source:this,...e},i),this.getSuggestions=(e,i)=>c9e({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new FD({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?R(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?R(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var t,e;return((e=(t=this.layer.fieldsIndex)==null?void 0:t.fields.find(i=>i.type==="string"))==null?void 0:e.name)??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;return t.loaded?`: ${(e||[this._getDisplayField()]).map(i=>{const r=t.getField(i);return(r==null?void 0:r.alias)||i}).join(", ")}`:""}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};l([c({json:{read:{source:"field.name"},write:{target:"field.name"}}})],zl.prototype,"displayField",void 0),l([c({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],zl.prototype,"exactMatch",void 0),l([c({value:null})],zl.prototype,"layer",null),l([c()],zl.prototype,"name",null),l([c({type:[String],json:{write:!0}})],zl.prototype,"orderByFields",void 0),l([c()],zl.prototype,"searchFields",void 0),l([c()],zl.prototype,"searchTemplate",void 0),l([c()],zl.prototype,"suggestionTemplate",void 0),zl=FD=l([$("esri.widgets.Search.LayerSearchSource")],zl);const h0=zl;function $9e(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function E9e(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let kh=class extends j{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};l([c({type:String,json:{write:!0}})],kh.prototype,"address",void 0),l([c({type:Object,json:{write:!0}})],kh.prototype,"attributes",void 0),l([c({type:at,json:{write:!0}})],kh.prototype,"extent",void 0),l([c({type:we,json:{write:!0}})],kh.prototype,"location",void 0),l([c({type:Number,json:{write:!0}})],kh.prototype,"score",void 0),kh=l([$("esri.rest.support.AddressCandidate")],kh);const Uue=kh,gj={type:String,json:{read:{source:"token"},write:{target:"token"}}};let Tn=class extends j{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};l([c({type:Object,json:{write:!0}})],Tn.prototype,"address",void 0),l([c(gj)],Tn.prototype,"apiKey",void 0),l([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Tn.prototype,"categories",void 0),l([c({type:String,json:{write:!0}})],Tn.prototype,"countryCode",void 0),l([c({type:Boolean,json:{write:!0}})],Tn.prototype,"forStorage",void 0),l([c({type:we,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Tn.prototype,"location",void 0),l([c({type:String,json:{write:!0}})],Tn.prototype,"locationType",void 0),l([c({type:String,json:{write:!0}})],Tn.prototype,"magicKey",void 0),l([c({type:Number,json:{write:!0}})],Tn.prototype,"maxLocations",void 0),l([c({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],Tn.prototype,"outFields",void 0),l([c({type:le,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Tn.prototype,"outSpatialReference",void 0),l([c({type:at,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],Tn.prototype,"searchExtent",void 0),Tn=l([$("esri.rest.support.AddressToLocationsParameters")],Tn),Tn.from=pi(Tn);const jue=Tn;async function T9e(t,e,i){e=jue.from(e);const r=eu(t),{address:n,...s}=e.toJSON(),o={...n,...s,f:"json"},a=Y$({...r.query,...o}),u=J$(a,i),d=`${r.path}/findAddressCandidates`;return Ee(d,u).then(I9e)}function I9e({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(r=>{if(!r)return;const{extent:n,location:s}=r,o=!n||E9e(n);return $9e(s)&&o?(n&&(n.spatialReference=i),s&&(s.spatialReference=i),Uue.fromJSON(r)):void 0}):[]}let Ld=class extends j{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};l([c(gj)],Ld.prototype,"apiKey",void 0),l([c({type:we,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,r=i!==void 0;e.location=r?i:null}}}})],Ld.prototype,"location",void 0),l([c({type:String,json:{write:!0}})],Ld.prototype,"locationType",void 0),l([c({type:le,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ld.prototype,"outSpatialReference",void 0),Ld=l([$("esri.rest.support.LocationToAddressParameters")],Ld),Ld.from=pi(Ld);const Gue=Ld;async function x9e(t,e,i){e=Gue.from(e);const r=eu(t),n={...e.toJSON(),f:"json"},s=Y$({...r.query,...n}),o=J$(s,i),a=`${r.path}/reverseGeocode`;return Ee(a,o).then(M9e)}function M9e({data:t}){if(!t)return;const{address:e,location:i}=t,r=(e==null?void 0:e.Match_addr)||"";return Uue.fromJSON({address:r,attributes:e||{},location:i,score:100})}let m0=class extends j{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};l([c({type:Boolean,json:{write:!0}})],m0.prototype,"isCollection",void 0),l([c({type:String,json:{write:!0}})],m0.prototype,"magicKey",void 0),l([c({type:String,json:{write:!0}})],m0.prototype,"text",void 0),m0=l([$("esri.rest.support.SuggestionCandidate")],m0);const C9e=m0;let Ao=class extends j{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};l([c(gj)],Ao.prototype,"apiKey",void 0),l([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Ao.prototype,"categories",void 0),l([c({type:String,json:{write:!0}})],Ao.prototype,"countryCode",void 0),l([c({type:we,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Ao.prototype,"location",void 0),l([c({type:Number,json:{write:!0}})],Ao.prototype,"maxSuggestions",void 0),l([c({type:le,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ao.prototype,"outSpatialReference",void 0),l([c({type:at,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],Ao.prototype,"searchExtent",void 0),l([c({type:String,json:{write:!0}})],Ao.prototype,"text",void 0),Ao=l([$("esri.rest.support.SuggestLocationsParameters")],Ao),Ao.from=pi(Ao);const zue=Ao;async function k9e(t,e,i){const r=eu(t),n={...(e=zue.from(e)).toJSON(),f:"json"},s=Y$({...r.query,...n}),o=J$(s,i),a=`${r.path}/suggest`;return Ee(a,o).then(L9e)}function L9e(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(r=>new C9e(r)):[]}const A9e="Single Line Input",O9e=3e5;function R9e(t,e){return t.location?V9e(t,e):U9e(t,e)}function Bue(t,e){var r;if(e.localSearchDisabled)return null;const i=t==null?void 0:t.scale;return typeof i=="number"&&i<=O9e?(r=t==null?void 0:t.extent)==null?void 0:r.center:null}async function P9e(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:s,maxSuggestions:o,sourceIndex:a}=t,u=new zue,{apiKey:d,url:p}=i,h=Hue(i,n),m=e==null?void 0:e.signal;if(!p)return null;d&&(u.apiKey=d),i.categories&&(u.categories=i.categories),r&&(u.outSpatialReference=r);const y=Bue(n,i);if(y&&(u.location=y),!s.trim())return null;const{prefix:g="",suffix:v=""}=i,_=`${g}${s}${v}`;return u.text=_,h&&(u.searchExtent=h),u.maxSuggestions=o,i.countryCode&&(u.countryCode=i.countryCode),k9e(p,u,{signal:m}).then(w=>G9e(w,a))}function F9e(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function N9e(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Y7(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const D9e="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function V9e(t,e){const{source:i,spatialReference:r,location:n,sourceIndex:s,view:o}=t,{apiKey:a,url:u,zoomScale:d,defaultZoomScale:p}=i;if(u==null)return[];const h=o==null?void 0:o.scale,m=e==null?void 0:e.signal,y=new Gue({location:n});a&&(y.apiKey=a),r&&(y.outSpatialReference=r);try{return que([await x9e(u,y,{signal:m})],{sourceIndex:s,scale:h,view:o,zoomScale:d,defaultZoomScale:p})}catch{return[]}}function Hue(t,e){const{filter:i,withinViewEnabled:r}=t,n=e==null?void 0:e.scale,s=e==null?void 0:e.extent,o=i==null?void 0:i.geometry;return(o?mj(o,e??void 0,n):void 0)||(r&&s?s:void 0)}async function U9e(t,e){var C;const{source:i,suggestResult:r,spatialReference:n,view:s,maxResults:o,sourceIndex:a}=t,u=i==null?void 0:i.zoomScale,d=i==null?void 0:i.defaultZoomScale;if(!((C=r.text)==null?void 0:C.trim()))return null;const h=!r.key&&i.prefix?i.prefix:"",m=!r.key&&i.suffix?i.suffix:"",y=`${h}${r.text}${m}`,g=new jue,{apiKey:v,url:_}=i,w=s==null?void 0:s.scale,S=Hue(i,s),E=e==null?void 0:e.signal;if(v&&(g.apiKey=v),!_)return null;i.categories&&(g.categories=i.categories),i.locationType&&(g.locationType=i.locationType),n&&(g.outSpatialReference=n);const T=Bue(s,i);T&&(g.location=T),g.maxLocations=o,S&&(g.searchExtent=S),i.countryCode&&(g.countryCode=i.countryCode);const{key:M}=r,x=`${M}`;return M&&(g.magicKey=x),g.address={},g.address[i.singleLineFieldName||A9e]=y,i.outFields&&(g.outFields=i.outFields),T9e(_,g,{signal:E}).then(O=>que(O,{key:x,scale:w,sourceIndex:a,view:s,zoomScale:u,defaultZoomScale:d}))}function j9e(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function G9e(t,e){return t.map(i=>j9e(i,e))}function z9e(t,e){const{key:i,scale:r,sourceIndex:n,view:s,zoomScale:o,defaultZoomScale:a}=e,{attributes:u,extent:d,location:p,address:h}=t,m=new Li({geometry:p,attributes:u}),y=d||p,g=y?mj(y,s??void 0,r??void 0):void 0,v=g?typeof o=="number"?PD(g,s??void 0,o):typeof a=="number"&&(y==null?void 0:y.type)==="point"?PD(g,s??void 0,a):g:null,_=p?`${p.x},${p.y}`:"",w=h||_,S=m.clone();return v!=null&&(S.geometry=os.fromExtent(v)),{extent:v,feature:m,target:S,key:i,name:w,sourceIndex:n}}function que(t,e){return t.filter(Boolean).map(i=>z9e(i,e))}var ND;let Zn=ND=class extends fj{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>R9e({source:this,...e},i),this.getSuggestions=(e,i)=>P9e({source:this,...e},i)}clone(){return new ND({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?R(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?R(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};l([c()],Zn.prototype,"apiKey",void 0),l([c()],Zn.prototype,"categories",void 0),l([c()],Zn.prototype,"countryCode",void 0),l([c({json:{write:!0}})],Zn.prototype,"defaultZoomScale",void 0),l([c()],Zn.prototype,"localSearchDisabled",void 0),l([c()],Zn.prototype,"locationType",void 0),l([c({json:{write:!0}})],Zn.prototype,"name",void 0),l([c({json:{write:!0}})],Zn.prototype,"placeholder",void 0),l([c()],Zn.prototype,"searchTemplate",void 0),l([c({json:{write:!0}})],Zn.prototype,"singleLineFieldName",void 0),l([c({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Zn.prototype,"suggestionsEnabled",void 0),l([c({json:{write:!0}})],Zn.prototype,"url",void 0),l([c({json:{write:!0}})],Zn.prototype,"zoomScale",void 0),Zn=ND=l([$("esri.widgets.Search.LocatorSearchSource")],Zn);const Wue=Zn,Zue=()=>U.getLogger("esri.widgets.support.geolocationUtils"),B9e={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function H9e(){const t=!!G("esri-geolocation");return t||Zue().warn("geolocation-unsupported","Geolocation unsupported."),t}function q9e(){const t=window.isSecureContext;return t||Zue().warn("insecure-context","Geolocation requires a secure origin."),t}function K7(){return H9e()&&q9e()}function W9e(t){return t??(t=B9e),new Promise((i,r)=>{setTimeout(()=>r(new L("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,r,t??void 0)})}function Z9e(t,e){const{position:i,view:r}=t,n=J9e(i),s=n==null?void 0:n.coords;if(!s)throw new L("geometry-service:no-coords","Geolocation has no coordinates");return K9e(Y9e(s),r,e)}function J9e(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t&&{coords:i,timestamp:t.timestamp}}function Y9e({longitude:t,latitude:e,altitude:i}){return new we({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function K9e(t,e,i){if(!e)return Promise.resolve(t);const r=e.spatialReference;return r.isWGS84?Promise.resolve(t):r.isWebMercator?Promise.resolve(Qd(t)):X9e(i).then(n=>{if(!n)throw new L("geometry-service:missing-url","Geometry service URL is missing");const s=new y5({geometries:[t],outSpatialReference:r});return aQ(n,s,i).then(o=>o[0])})}function X9e(t){if(et.geometryServiceUrl)return Promise.resolve(et.geometryServiceUrl);const e=ki.getDefault();return e.load(t).catch(()=>{}).then(()=>{var i,r;return(r=(i=e.helperServices)==null?void 0:i.geometry)==null?void 0:r.url})}function jn(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const Q9e=()=>BC("esri/widgets/Search/t9n/Search"),X7="highlight",IM=Y.ofType({key:t=>t.layer?"layer":"locator",base:fj,typeMap:{layer:h0,locator:Wue}}),Q7=le.WGS84,eHe="esri/images/search/search-symbol-32.png",tHe=/<[\s\S]*?>/g,f0=-1;let Je=class extends jk(ji.EventedMixin(q)){constructor(e){super(e),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new IM,this.defaultSymbols={point:new g_({url:ut(eHe),size:24,width:24,height:24}),polyline:new yr({color:[130,130,130,1],width:2}),polygon:new Qo({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=ki.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new IM,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const i=await Q9e();this.messages=i,this.defaultPopupTemplate=new ag({title:i.searchResult,content:"{Match_addr}"})};e(),this.addHandles([N(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),be),GC(e)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:f0}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){var e;return(e=this.messages)==null?void 0:e.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:i,includeDefaultSources:r}=this,n=typeof r=="function"?r.call(null,{sources:e,defaultSources:i}):r?i.concat(e):e,s=this._get("allSources")||new IM;return s.removeAll(),s.addMany(n.filter(Boolean)),s}get locationEnabled(){return this._get("locationEnabled")||K7()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const i=K7();if(e&&!i){const r=new L("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});U.getLogger(this).error(r)}this._override("locationEnabled",!!e&&i)}get placeholder(){const{allSources:e,activeSourceIndex:i,allPlaceholder:r}=this;if(i===f0)return r??"";const n=e.at(i);return(n==null?void 0:n.placeholder)??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:i}=this;e&&i&&e.graphics.remove(i),this._set("resultGraphic",null)}search(e,i){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),n=(async()=>{var s;try{await this.when();const o=await this._getResultsFromSources(r,i);if((s=i==null?void 0:i.signal)!=null&&s.aborted)return null;const a={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(a,o,r);const u=this._getFirstResult(a.results),d=r.location&&u?u.name:r.text,p=d==null?void 0:d.replace(tHe,"");return this._set("searchTerm",p),(r.key&&typeof r.sourceIndex=="number"||r.location)&&this._set("selectedSuggestion",r),this._set("results",a.results),this._set("resultCount",a.results.reduce((h,m)=>{var y;return h+(((y=m.results)==null?void 0:y.length)??0)},0)),this.emit("search-complete",a),await this._selectFirstResult(u),a}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(e){if(!this.locationEnabled){const r=new L("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw U.getLogger(this).error(r),r}const i=(async()=>{try{const r=await W9e(),n=await Z9e({position:r,view:this.view},e);return await this.search(n,e)}finally{this._clearSearching()}})();return this._searching=i,i}async select(e){if(this.clearGraphics(),!e){const V=new L("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});throw U.getLogger(this).error(V),V}const{view:i}=this,r=jn(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),n=r!=null?this.allSources.at(r):null;if(!n){const V=new L("select:missing-source","Cannot select without a source.",{source:n});throw U.getLogger(this).error(V),V}const s=n instanceof h0?this._getLayerSourcePopupTemplate(n):n.popupTemplate,o=n.resultSymbol||this._getDefaultSymbol(e),a=jn(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,u=jn(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,d=jn(n,"popupEnabled")?n.popupEnabled:this.popupEnabled,p=d?s||this.popupTemplate||this.defaultPopupTemplate:null,{feature:h}=e;if(!h){const V=new L("select:missing-feature","Cannot select without a feature.",{feature:h});throw U.getLogger(this).error(V),V}const{attributes:m,geometry:y,layer:g,sourceLayer:v}=h,_=y?J7(y):null,w={layerViewQuery:this._getLayerView(h),elevationQuery:i&&_!=null?o9e(_,i):Promise.resolve(_)},S=await py(w),E=S.layerViewQuery.value,T=S.elevationQuery.value;o instanceof cg&&(o.text=e.name);const M=i&&u?e.target||e.extent:null;await(M!=null?this._goToSearchResult(M):Promise.resolve());const C=E?h:new Li({geometry:y,symbol:o,attributes:m,layer:g,sourceLayer:v,popupTemplate:p}),O=i==null?void 0:i.popup,F=O&&d&&C.getEffectivePopupTemplate(O.defaultPopupTemplateEnabled);return F&&await i.openPopup({features:[C],location:T}),E&&qU(E)&&!F&&this._highlightFeature({graphic:C,layerView:E}),!E&&a&&i&&i.graphics.push(C),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",C),this.emit("select-result",{result:e,source:n,sourceIndex:r}),e}async suggest(e,i,r){const n=e||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(i,r);const s=await this._suggestImmediate(n,r);return this._set("suggestions",s==null?void 0:s.results),this._set("suggestionCount",(s==null?void 0:s.results.reduce((o,a)=>{var u;return o+(((u=a.results)==null?void 0:u.length)??0)},0))??null),this.emit("suggest-complete",s),s}async when(){await wi(()=>!this.updating)}async _update(){const{portal:e,view:i}=this;if(this.includeDefaultSources){const r=this._updatingPromise=py([e==null?void 0:e.load(),i==null?void 0:i.when()]);if(this.destroyed||(await r,r!==this._updatingPromise))return}await wi(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){var i,r;const e=(r=(i=this.portal)==null?void 0:i.helperServices)==null?void 0:r.geocode;return e?e.map(n=>{var u;if(n.placefinding===!1)return;const s=et.apiKey&&Y7(n.url)?{url:D9e}:null,o=Wue.fromJSON({...n,...s}),a=o.url;if(Y7(a)||N9e(a)||F9e(a)){const d=o.outFields??["Addr_type","Match_addr","StAddr","City"],p=(o.placeholder||((u=this.messages)==null?void 0:u.placeholder))??"",h=typeof o.defaultZoomScale=="number"?o.defaultZoomScale:2500;o.singleLineFieldName="SingleLine",o.outFields=d,o.placeholder=p,o.defaultZoomScale=h}return o.singleLineFieldName?o:void 0}).filter(ot):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e==null?void 0:e.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(s=>{const o=r.findLayerById(s.id);if(!o)return;const a=this._getLayerJSON(s),u=h0.fromJSON(a);return u.placeholder=i,this._getLayer(o,a).then(d=>{u.layer=d}),u}).filter(ot).toArray()}_getTableSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(s=>{if(!s.id)return;const o=r.findTableById(s.id);if(!o)return;const a=this._getLayerJSON(s),u=h0.fromJSON(a);return u.placeholder=i,this._getLayer(o,a).then(d=>{u.layer=d}),u}).filter(ot).toArray()}_convertApplicationProperties(){var a,u,d;const e=(a=this.view)==null?void 0:a.map,i=(d=(u=e==null?void 0:e.applicationProperties)==null?void 0:u.viewing)==null?void 0:d.search;if(!i)return[];const{enabled:r,hintText:n,layers:s,tables:o}=i;return r?[...this._getLayerSources(s,n),...this._getTableSources(o,n)]:[]}async _getSubLayer(e,i){var s;if(await e.load(),!e.allSublayers)throw new Error;const r=e.allSublayers.find(o=>o.id===i.subLayer);if(!r)throw new Error;const n=await((s=r.createFeatureLayer)==null?void 0:s.call(r));if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(e,i){await e.load();const r=e.allSublayers.find(n=>n.id===i.subLayer);if((r==null?void 0:r.type)!=="building-component")throw new Error;if(await r.load(),r.associatedLayer==null)throw new Error;return await r.associatedLayer.load(),r}async _getLayer(e,i){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,i)}catch{const n=new L("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return U.getLogger(this).error(n),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,i):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:i}=this;this._destroyFeatureLayers(),e.removeAll(),i&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var s;const e=(s=this.view)==null?void 0:s.popup,{resultGraphic:i}=this;if(!e||!i)return;const r="selectedFeature"in e,n=r?e.selectedFeature:null;r&&n&&n===i&&e.close()}_suggestTimer(e,i){const r=e??this.suggestionDelay;return i_(r,null,i==null?void 0:i.signal)}_createLocationForSearch(e){return e instanceof Li&&e.geometry?J7(e.geometry):e instanceof we?e:Array.isArray(e)&&e.length===2?new we({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&jn(e,"key")&&jn(e,"text")&&jn(e,"sourceIndex"))return e;const i=this._createLocationForSearch(e),r=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:n,selectedResult:s}=this,o=!e&&n&&s,a=o&&n.key===s.key&&n.sourceIndex===s.sourceIndex,u=o&&n.location;return a||u?n:{location:i,text:i?"":r,sourceIndex:null,key:null}}_getFirstResult(e){return mb(e,({results:i})=>i==null?void 0:i[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,i){var s;await this.when();const r=await this._getSuggestionsFromSources(e,i);if((s=i==null?void 0:i.signal)!=null&&s.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,r),n}_formatSourceResponse(e,i,r){const n=(i==null?void 0:i.value)||[],s=i==null?void 0:i.error,o=this.allSources.at(r);if(s){const a={sourceIndex:r,source:o,error:s};e.errors.push(a),U.getLogger(this).error(s),e.numErrors++}else{const a={sourceIndex:r,source:o,results:n};e.results.push(a),e.numResults+=n.length}}_formatResponse(e,i,r){if(i)if(e.activeSourceIndex===f0){const n=r&&jn(r,"sourceIndex")&&r.sourceIndex!==-1?r.sourceIndex:void 0;i.forEach((s,o)=>{const a=n!==void 0?n:o;this._formatSourceResponse(e,s,a)})}else this._formatSourceResponse(e,i[0],e.activeSourceIndex)}async _getResultsFromSources(e,i){const{allSources:r}=this,n=!e.location&&jn(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,s=[];if(!r.length){const o=new L("search:no-sources-defined","At least one source is required.",{allSources:r});throw U.getLogger(this).error(o),o}return n===f0?r.forEach((o,a)=>{s.push(this._getResultsFromSource(e,a,i))}):s.push(this._getResultsFromSource(e,n,i)),py(s)}async _getSuggestionsFromSources(e,i){const{allSources:r,activeSourceIndex:n}=this,s=[];if(!r.length){const o=new L("suggest:no-sources-defined","At least one source is required.",{allSources:r});throw U.getLogger(this).error(o),o}return n===f0?r.forEach((o,a)=>{s.push(this._getSuggestionsFromSource(e,a,i))}):s.push(this._getSuggestionsFromSource(e,n,i)),py(s)}async _getResultsFromSource(e,i,r){var p,h;const n=i!=null?this.allSources.at(i):null;if(!n)return null;const{location:s=null}=e,o=((p=this.view)==null?void 0:p.spatialReference)||Q7,a=jn(n,"maxResults")?n.maxResults:this.maxResults,u=!!(n instanceof h0&&jn(n,"exactMatch"))&&n.exactMatch,{view:d}=this;return(h=n.getResults)==null?void 0:h.call(n,{view:d,sourceIndex:i,location:s,suggestResult:e,spatialReference:o,exactMatch:u,maxResults:a},r)}async _getSuggestionsFromSource(e,i,r){var u,d;const n=this.allSources.at(i);if(!n)return null;e??(e="");const s=jn(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,o=e==null?void 0:e.length,a=jn(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(s&&e.trim()&&o>=a){const p=((u=this.view)==null?void 0:u.spatialReference)||Q7,h=jn(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:m}=this,y=!!(n instanceof h0&&jn(n,"exactMatch"))&&n.exactMatch;return(d=n.getSuggestions)==null?void 0:d.call(n,{view:m,sourceIndex:i,suggestTerm:e,spatialReference:p,maxSuggestions:h,exactMatch:y},r)}return null}_getLayerSourcePopupTemplate(e){const{layer:i}=e;if(i)return jn(e,"popupTemplate")?e.popupTemplate:i.popupTemplate}_getSourceIndexOfResult(e){return mb(this.results??[],({results:i,sourceIndex:r})=>(i==null?void 0:i.includes(e))?r:null)??null}async _goToSearchResult(e){this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{signal:i.signal}};e||(r.options.animate=!1),await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){var n;const{defaultSymbols:i}=this,r=(n=e.feature)==null?void 0:n.geometry;if(r==null)return null;switch(r.type){case"point":case"multipoint":return i.point;case"polyline":return i.polyline;case"extent":case"polygon":return i.polygon;default:return null}}_removeHighlight(){this.removeHandles(X7)}async _getLayerView(e){var n,s;const{view:i}=this;if(!e||!i||((n=e.layer)==null?void 0:n.type)==="building-component"||((s=e.layer)==null?void 0:s.type)==="subtype-sublayer")return null;const{layer:r}=e;return r?(await i.when(),i.whenLayerView(r)):null}_highlightFeature(e){const{graphic:i,layerView:r}=e,{attributes:n,layer:s}=i,{objectIdField:o}=s,a=(o&&(n==null?void 0:n[o]))??null,u=r.highlight(a??i);this.addHandles(u,X7)}_setResultFloor(e){var s,o,a;const{view:i}=this,r=(s=e.feature)==null?void 0:s.attributes,n=(o=e.feature)==null?void 0:o.sourceLayer;if(n&&"floorInfo"in n&&((a=n==null?void 0:n.floorInfo)!=null&&a.floorField)&&r){const u=r[n.floorInfo.floorField];i==null||i.emit("select-result-floor",u)}}};Je.ALL_INDEX=f0,l([c()],Je.prototype,"_searching",void 0),l([c()],Je.prototype,"_updatingPromise",void 0),l([c({readOnly:!0,value:null})],Je.prototype,"activeSource",null),l([c()],Je.prototype,"activeSourceIndex",null),l([c()],Je.prototype,"allPlaceholder",null),l([c({readOnly:!0})],Je.prototype,"allSources",null),l([c()],Je.prototype,"autoNavigate",void 0),l([c()],Je.prototype,"autoSelect",void 0),l([c()],Je.prototype,"defaultPopupTemplate",void 0),l([c({readOnly:!0})],Je.prototype,"defaultSources",void 0),l([c()],Je.prototype,"defaultSymbols",void 0),l([c()],Je.prototype,"includeDefaultSources",void 0),l([c()],Je.prototype,"locationEnabled",null),l([c()],Je.prototype,"maxInputLength",void 0),l([c()],Je.prototype,"maxResults",void 0),l([c()],Je.prototype,"maxSuggestions",void 0),l([c()],Je.prototype,"messages",void 0),l([c()],Je.prototype,"minSuggestCharacters",void 0),l([c({readOnly:!0})],Je.prototype,"placeholder",null),l([c()],Je.prototype,"popupEnabled",void 0),l([c({type:ag})],Je.prototype,"popupTemplate",void 0),l([c({type:ki})],Je.prototype,"portal",void 0),l([c()],Je.prototype,"resultCount",void 0),l([c()],Je.prototype,"resultGraphicEnabled",void 0),l([c({readOnly:!0})],Je.prototype,"resultGraphic",void 0),l([c({readOnly:!0})],Je.prototype,"results",void 0),l([c({readOnly:!0})],Je.prototype,"selectedSuggestion",void 0),l([c()],Je.prototype,"searchAllEnabled",void 0),l([c({readOnly:!0})],Je.prototype,"selectedResult",void 0),l([c()],Je.prototype,"searchTerm",null),l([c({type:IM})],Je.prototype,"sources",void 0),l([c({readOnly:!0})],Je.prototype,"state",null),l([c()],Je.prototype,"suggestionDelay",void 0),l([c()],Je.prototype,"suggestionCount",void 0),l([c({readOnly:!0})],Je.prototype,"suggestions",void 0),l([c()],Je.prototype,"suggestionsEnabled",void 0),l([c({readOnly:!0})],Je.prototype,"updating",null),l([c()],Je.prototype,"view",void 0),l([c()],Je.prototype,"clear",null),Je=l([$("esri.widgets.Search.SearchViewModel")],Je);const O0=Je;let Lh=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[Zm.showMoreResults]:this.showMoreResultsOpen};return b("div",{class:this.classes(Zm.base,K.widget)},b("div",{class:this.classes(Zm.moreResults,e),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return b("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){var r;const e=(r=this.viewModel)==null?void 0:r.selectedResult,i=(e==null?void 0:e.name)||"";return b("div",{class:Zm.moreResultsItem,key:"esri-search-renderer__result-name"},i)}_renderMoreResultsLists(){const{viewModel:e}=this;if(!e)return[];const i=e.results;if((e.resultCount??0)<2)return null;const r=i==null?void 0:i.map(n=>this._renderMoreResultsList(n));return b("div",{class:Zm.moreResultsList,key:"esri-search-renderer__more-results-container"},r)}_renderMoreResultsButton(){const{messages:e,viewModel:i}=this;return i?(i.resultCount??0)<2?null:b("div",{class:Zm.moreResultsItem,key:"esri-search-renderer__more-results-button"},b("a",{bind:this,class:K.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults)):null}_renderMoreResultsHeader(e,i){return b("div",{class:Zm.moreResultsListHeader,key:`esri-search-result-renderer__header-${i}`},e)}_renderMoreResultsList(e){var h,m,y;const{results:i}=e,r=(i==null?void 0:i.length)??0,n=r>0,s=(h=this.viewModel)==null?void 0:h.selectedResult,o=r===1&&i[0]===s,a=this._getSourceName(e.source,e.sourceIndex),u=(((y=(m=this.viewModel)==null?void 0:m.results)==null?void 0:y.length)??0)>1&&!o?this._renderMoreResultsHeader(a,e.sourceIndex):null,d=n&&i.map((g,v)=>this._renderMoreResultsListItem(g,v)),p=n&&!o?b("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},d):null;return n?b("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},u,p):null}_renderMoreResultsListItem(e,i){var n;const r=(n=this.viewModel)==null?void 0:n.selectedResult;return e!==r?b("li",{key:`esri-search-result-renderer__list-item-${i}`},b("a",{bind:this,class:K.anchor,"data-result":e,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},e.name)):null}_showMoreResultsClick(e){var r,n;e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const i=(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.popup;i&&"reposition"in i&&i.reposition()}_selectResultClick(e){var r;e.preventDefault();const i=e.currentTarget["data-result"];(r=this.viewModel)==null||r.select(i)}_getSourceName(e,i){return i===O0.ALL_INDEX?this.messages.all:e.name}};l([c(),Ue("esri/widgets/Search/t9n/Search")],Lh.prototype,"messages",void 0),l([c()],Lh.prototype,"showMoreResultsOpen",void 0),l([c()],Lh.prototype,"viewModel",void 0),l([xy()],Lh.prototype,"_showMoreResultsClick",null),l([xy()],Lh.prototype,"_selectResultClick",null),Lh=l([$("esri.widgets.Search.SearchResultRenderer")],Lh);const iHe=Lh,rHe=/<[a-z/][\s\S]*>/i,nHe=(t,e)=>{const i=Vde(e).split(/\s/),r=new RegExp(`(${i.join("|")})`,"gi");return t.replace(r,n=>`<strong>${n}</strong>`)};let Ke=class extends $t{constructor(e,i){super(e,i),this._activeMenuItemIndex=-1,this._inputNode=null,this._focusAbortController=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new iHe,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new O0,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=r=>{var s;const n=r.relatedTarget;n&&((s=this._container)!=null&&s.contains(n))||this._clearActiveMenu()},this._renderSearchResultsContent=()=>this._searchResultRenderer,this.addHandles([N(()=>this.searchTerm,r=>{var n,s;(r&&this.activeMenu==="warning"||!r&&!((s=(n=this.viewModel)==null?void 0:n.selectedSuggestion)!=null&&s.location))&&this._clearActiveMenu()}),St(()=>{var r;return(r=this.viewModel)==null?void 0:r.allSources},"change",()=>this._watchSourceChanges()),N(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),be),N(()=>this.viewModel,r=>this._searchResultRenderer.viewModel=r,be),N(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),N(()=>{var r;return(r=this.viewModel)==null?void 0:r.defaultPopupTemplate},r=>{r&&(r.content=this._renderSearchResultsContent)},be)])}destroy(){var e;this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=xe(this._searchResultRenderer),(e=this._focusAbortController)==null||e.abort()}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){var e;return(e=this.viewModel)==null?void 0:e.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"search"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){var e;return(e=this.viewModel)==null?void 0:e.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this.viewModel.clear()}focus(){this._handleFocus(),this.emit("search-focus")}async _handleFocus(){var i,r;(i=this._focusAbortController)==null||i.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;await zo(VZ(e)),(r=this._inputNode)==null||r.focus()}blur(){var e;(e=this._inputNode)==null||e.blur(),this.emit("search-blur")}async search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const i=new AbortController,{signal:r}=i;this._searchController=i;try{const n=await this.viewModel.search(e,{signal:r});return this._searchController!==i?void 0:(this.activeMenu=n!=null&&n.numResults?"none":"warning",this._searchController=null,n)}catch{return this._searchController!==i?void 0:(this._clearActiveMenu(),void(this._searchController=null))}}async suggest(e){this._cancelSuggest();const i=new AbortController,{signal:r}=i;this._suggestController=i;try{const n=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==i?void 0:(this._suggestController=null,n!=null&&n.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n)}catch{return this._suggestController!==i||(this._suggestController=null),null}}render(){const{state:e}=this.viewModel,i={[K.disabled]:e==="disabled",[K.widgetDisabled]:this.disabled};return b("div",{class:this.classes(zt.base,K.widget,i)},e==="loading"?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const{messages:e,disabled:i}=this;return b("button",{"aria-label":e.searchButtonTitle,bind:this,class:this.classes(zt.submitButton,K.widgetButton),disabled:i,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},b("span",{"aria-hidden":"true",class:Cr.search}))}_renderWarningMenu(){return b("div",{class:this.classes(K.menu,zt.warningMenu),key:"esri-search__error-menu"},b("div",{class:zt.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const{messages:e,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n,disabled:s}=this,{activeSourceIndex:o,allSources:a}=this.viewModel;return a.length>1?b("button",{afterCreate:T0,"aria-controls":r,"aria-expanded":(i==="source").toString(),"aria-haspopup":"true","aria-label":e.searchIn,bind:this,class:this.classes(zt.sourcesButton,K.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:s,id:n,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,title:e.searchIn,type:"button"},b("span",{"aria-hidden":"true",class:this.classes(Cr.downArrow,zt.sourcesButtonDown)}),b("span",{"aria-hidden":"true",class:this.classes(Cr.upArrow,zt.sourcesButtonUp)}),b("span",{class:zt.sourceName},this._getSourceName(o))):null}_renderSourcesList(){const{allSources:e,searchAllEnabled:i}=this.viewModel,{_activeMenuItemIndex:r,activeMenu:n,sourceMenuId:s,sourceMenuButtonId:o}=this,a=n==="source"&&r>-1?this._buildId("source-item",r):null;return e.length>1?b("ul",{afterCreate:T0,"aria-activedescendant":a,"aria-labelledby":o,bind:this,class:K.menuList,"data-node-ref":"_sourceListNode",id:s,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},i?this._renderSource(O0.ALL_INDEX):null,e.map((u,d)=>this._renderSource(d)).toArray()):null}_renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?b("div",{class:this.classes(K.menu,zt.sourcesMenu),key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const{messages:e,messagesCommon:i,disabled:r}=this;return b("div",{class:K.loader,key:"base-loader",tabIndex:r?-1:void 0},b("span",{"aria-hidden":"true",class:K.loaderAnimation}),b("span",{class:Cr.fontFallbackText},e.searchButtonTitle),b("span",{class:K.loaderText},i.loading))}_renderContainer(){const{allSources:e,state:i}=this.viewModel,{activeMenu:r}=this,n={[zt.hasMultipleSources]:e.length>1,[zt.isLoading]:i==="loading",[zt.isSearching]:i==="searching",[zt.showWarning]:r==="warning",[zt.showSources]:r==="source",[zt.showSuggestions]:r==="suggestion"};return b("div",{afterCreate:s=>{this._container=s,s.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:s=>{s.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,zt.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?b("button",{bind:this,class:this.classes(zt.clearButton,K.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},b("span",{"aria-hidden":"true",class:Cr.close})):null}_renderLocationGroup(){const{messages:e,locationEnabled:i,displayedSearchTerm:r}=this,n=i&&!r,s=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return n?b("ul",{class:this.classes(K.menuList,zt.suggestionList,zt.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},b("li",{"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),bind:this,class:this.classes(K.menuItem,s?K.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",0),onclick:this._handleUseCurrentLocationClick,role:"option"},b("span",{"aria-hidden":"true",class:Cr.locateCircled})," ",e.useCurrentLocation)):null}_renderInput(){const{activeMenu:e,locationEnabled:i,displayedSearchTerm:r,messages:n,suggestionsMenuId:s,inputId:o,_activeMenuItemIndex:a,disabled:u}=this,{maxInputLength:d,placeholder:p,searchTerm:h,suggestionCount:m}=this.viewModel,y=!(!(i&&!r)&&!m),g=e==="suggestion"&&a>-1?this._buildId("suggestion-item",a):null;return b("input",{afterCreate:T0,"aria-activedescendant":g,"aria-autocomplete":"list","aria-controls":y?s:null,"aria-expanded":(y&&e==="suggestion").toString(),"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(K.input,zt.input),"data-node-ref":"_inputNode",disabled:u,id:o,maxlength:d,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:p,role:"combobox",title:h?"":p,type:"text",value:h})}_renderForm(){return b("form",{bind:this,class:zt.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(e){const{sourceIndex:i}=e,{results:r}=e;return(r==null?void 0:r.length)?b("ul",{class:this.classes(K.menuList,zt.suggestionList),key:`esri-search__suggestion-list-${i}`,role:"group"},r==null?void 0:r.map(s=>this._renderSuggestion(s,this._menuItemCount++))):null}_renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map(i=>[this._renderSuggestionHeader(i),this._renderSuggestList(i)]):[]}_renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:i,suggestionsMenuId:r,inputId:n}=this,{suggestionCount:s}=this.viewModel,o=i&&!e||s;return this._menuItemCount=0,o?b("div",{afterCreate:T0,"aria-labelledby":n,bind:this,class:this.classes(K.menu,zt.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:r,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),this._renderSuggestionsGroup()):null}_renderInputContainer(){return b("div",{class:zt.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(e){var a;const{allSources:i,activeSourceIndex:r}=this.viewModel,{sourceIndex:n}=e,s=(a=e.results)==null?void 0:a.length,o=i.length>1&&r===O0.ALL_INDEX;return s&&o?b("div",{class:K.menuHeader,key:`esri-search__suggestion-header-${n}`},this._getSourceName(n)):null}_renderSuggestion(e,i){const{_activeMenuItemIndex:r,viewModel:{searchTerm:n}}=this;if(!n)return;const s=this.activeMenu==="suggestion"&&r===i;return b("li",{"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===i).toString(),bind:this,class:this.classes(K.menuItem,s?K.menuItemFocus:null),"data-suggestion":e,id:this._buildId("suggestion-item",i),innerHTML:this._getSuggestResultHTML(e.text,n),key:`esri-search__suggestion_${i}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(e){const{activeSourceIndex:i,searchAllEnabled:r}=this.viewModel,n={[K.menuItemActive]:e===i,[K.menuItemFocus]:this.activeMenu==="source"&&e===(r?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},s=r?e+1:e;return b("li",{"aria-checked":(e===i).toString(),bind:this,class:this.classes(zt.source,K.menuItem,n),"data-source-index":e,id:this._buildId("source-item",s),key:`esri-search__source-${e}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(e))}_renderNoResultsWarning(e){const{messages:i}=this,r=e?Wr(i.noResultsFoundForValue,{value:`"${e}"`}):i.noResultsFound;return b("div",{key:"esri-search__no_results"},b("div",{class:zt.warningMenuHeader},i.noResults),b("div",{class:zt.warningMenuText},r))}_renderEmptySearchWarning(){const{messages:e}=this;return b("div",{key:"esri-search__empty-search"},b("span",{"aria-hidden":"true",class:Cr.noticeTriangle}),b("span",{class:zt.noValueText},e.emptyValue))}_renderLocateWarning(){const{messages:e}=this;return b("div",{key:"esri-search__locate-error"},b("span",{"aria-hidden":"true",class:Cr.noticeTriangle}),b("span",{class:zt.noValueText},e.locateError))}_renderWarning(){var n;const{displayedSearchTerm:e,_locateFailed:i}=this,{viewModel:r}=this;return i?this._renderLocateWarning():(n=r.selectedSuggestion)!=null&&n.location||e?this._renderNoResultsWarning(e):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,i){return`${this.id}-${e}${i===void 0?"":`-${i}`}`}_watchSourceChanges(){const{viewModel:{allSources:e}}=this,i="sources";this.removeHandles(i),e.forEach(r=>this.addHandles(N(()=>r.name,()=>this.scheduleRender()),i))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var i;const e=this.activeMenu==="source";this.activeMenu=e?"none":"source",this.renderNow(),this.activeMenu==="source"&&((i=this._sourceListNode)==null||i.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const i=eW(e.currentTarget);i&&(this._focus(),this.search(i))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e,(async()=>{try{const r=await this.viewModel.searchNearby({signal:i});this.activeMenu=r!=null&&r.numResults?"none":"warning"}catch{this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var r;if(!e)return;const i=sHe(e);i!=null&&(this.viewModel.activeSourceIndex=i,this._clearActiveMenu(),(r=this._sourceMenuButtonNode)==null||r.focus())}_cancelSuggest(){this._suggestController=mr(this._suggestController)}_cancelSearch(){this._searchController=mr(this._searchController),this._locateFailed=!1}_handleInputKeyup(e){var s;const{key:i}=e;if(e.ctrlKey||e.metaKey||i==="Copy"||i==="ArrowLeft"||i==="ArrowRight"||i==="Shift")return;if(i==="Tab"||i==="Escape"||e.shiftKey&&i==="Tab")return this._cancelSuggest(),void(i==="Escape"&&this._clearActiveMenu());const r=i==="Home"||i==="End"||i==="ArrowUp"||i==="ArrowDown";if(i==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=(s=this._suggestionListNode)==null?void 0:s.getElementsByTagName("li");if(n!=null&&n.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),r)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(i,n,this._suggestionListNode);const o=n[this._activeMenuItemIndex];if(i==="Enter"&&o){const a=eW(o);return void(a?(this._focus(),this.search(a)):oHe(o)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(e,i,r){const n=this._activeMenuItemIndex;e==="Home"&&(this._activeMenuItemIndex=0),e==="End"&&(this._activeMenuItemIndex=i.length-1),e==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?i.length-1:this._activeMenuItemIndex-1),e==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===i.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&r&&aHe(i[this._activeMenuItemIndex],r)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const i=e.target;this.viewModel.searchTerm!==i.value&&(this.viewModel.searchTerm=i.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){var r;const{key:i}=e;if(F4(i)){e.preventDefault();const n=(r=this._sourceListNode)==null?void 0:r.getElementsByTagName("li"),s=n==null?void 0:n[this._activeMenuItemIndex];this._setSourceFromMenuItem(s)}else i!=="ArrowUp"&&i!=="ArrowDown"&&i!=="End"&&i!=="Home"||e.preventDefault()}_handleSourceMenuKeyup(e){var s,o,a;const{key:i}=e,r=i==="ArrowUp"||i==="ArrowDown"||i==="End"||i==="Home";if(r&&e.preventDefault(),i==="Escape")return this._clearActiveMenu(),void((s=this._sourceMenuButtonNode)==null?void 0:s.focus());const n=(o=this._sourceListNode)==null?void 0:o.getElementsByTagName("li");return n&&n.length!==0&&r?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(i,n,(a=this._sourceListNode)==null?void 0:a.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(e){const{messages:i}=this,r=this.viewModel,{allSources:n}=r,s=n.at(e);return e===O0.ALL_INDEX?i.all:s&&s.name||i.untitledSource}_getSuggestResultHTML(e,i){return e?rHe.test(e)?e:nHe(e,i):this.messages.untitledResult}};function eW(t){return t==null?void 0:t["data-suggestion"]}function sHe(t){return t==null?void 0:t["data-source-index"]}function oHe(t){return!!(t!=null&&t["data-current-location-item"])}function aHe(t,e){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),n=i.top+i.height,s=r.top+r.height,o=i.top,a=r.top;(n>s||o<a)&&t.scrollIntoView({block:"end"})}l([c()],Ke.prototype,"_activeMenuItemIndex",void 0),l([c()],Ke.prototype,"displayedSearchTerm",null),l([c({readOnly:!0})],Ke.prototype,"inputId",null),l([c({readOnly:!0})],Ke.prototype,"suggestionsMenuId",null),l([c({readOnly:!0})],Ke.prototype,"sourceMenuId",null),l([c({readOnly:!0})],Ke.prototype,"sourceMenuButtonId",null),l([c()],Ke.prototype,"activeMenu",void 0),l([c({readOnly:!0})],Ke.prototype,"activeSource",null),l([c()],Ke.prototype,"activeSourceIndex",null),l([c()],Ke.prototype,"allPlaceholder",null),l([c({readOnly:!0})],Ke.prototype,"allSources",null),l([c()],Ke.prototype,"autoNavigate",null),l([c()],Ke.prototype,"autoSelect",null),l([c({readOnly:!0})],Ke.prototype,"defaultSources",null),l([c()],Ke.prototype,"disabled",void 0),l([c()],Ke.prototype,"goToOverride",null),l([c()],Ke.prototype,"icon",null),l([c()],Ke.prototype,"includeDefaultSources",null),l([c()],Ke.prototype,"label",null),l([c()],Ke.prototype,"locationEnabled",null),l([c()],Ke.prototype,"maxResults",null),l([c()],Ke.prototype,"maxSuggestions",null),l([c(),Ue("esri/widgets/Search/t9n/Search")],Ke.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Ke.prototype,"messagesCommon",void 0),l([c()],Ke.prototype,"minSuggestCharacters",null),l([c()],Ke.prototype,"popupEnabled",null),l([c()],Ke.prototype,"popupTemplate",null),l([c()],Ke.prototype,"portal",null),l([c()],Ke.prototype,"resultGraphic",null),l([c()],Ke.prototype,"resultGraphicEnabled",null),l([c({readOnly:!0})],Ke.prototype,"results",null),l([c()],Ke.prototype,"searchAllEnabled",null),l([c()],Ke.prototype,"searchTerm",null),l([c({readOnly:!0})],Ke.prototype,"selectedResult",null),l([c()],Ke.prototype,"sources",null),l([c({readOnly:!0})],Ke.prototype,"suggestions",null),l([c()],Ke.prototype,"suggestionsEnabled",null),l([c()],Ke.prototype,"view",null),l([km(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),c({type:O0})],Ke.prototype,"viewModel",void 0),Ke=l([$("esri.widgets.Search")],Ke);const lHe=Ke;function uHe(t){var n,s;const e="metric";if(t==null)return e;const i=t.map,r=(i&&"portalItem"in i?(n=i.portalItem)==null?void 0:n.portal:null)??ki.getDefault();switch(((s=r.user)==null?void 0:s.units)??r.units){case e:return e;case"english":return"imperial"}return wfe(t.spatialReference)??e}const Jue={readOnly:!0,get(){return uHe(this.view)}},hs="esri-scale-bar",mi={base:hs,labelContainer:`${hs}__label-container`,rulerLabelContainer:`${hs}__label-container--ruler`,lineLabelContainer:`${hs}__label-container--line`,topLabelContainer:`${hs}__label-container--top`,bottomLabelContainer:`${hs}__label-container--bottom`,label:`${hs}__label`,line:`${hs}__line`,topLine:`${hs}__line--top`,bottomLine:`${hs}__line--bottom`,ruler:`${hs}__ruler`,rulerBlock:`${hs}__ruler-block`,barContainer:`${hs}__bar-container`,rulerBarContainer:`${hs}__bar-container--ruler`,lineBarContainer:`${hs}__bar-container--line`};function cHe(t){return t>.5?{min:.5,max:1}:t>.2?{min:.2,max:.5}:{min:.1,max:.2}}function dHe(t,e){switch(e){case"metric":return t>1e3?{distance:Oe(t,"meters","kilometers"),unit:"kilometer"}:t>1?{distance:t,unit:"meter"}:t>.01?{distance:Oe(t,"meters","centimeters"),unit:"centimeter"}:{distance:Oe(t,"meters","millimeters"),unit:"millimeter"};case"imperial":return t>1609.344?{distance:Oe(t,"meters","miles"),unit:"mile"}:t>.3048?{distance:Oe(t,"meters","feet"),unit:"foot"}:{distance:Oe(t,"meters","inches"),unit:"inch"}}}function pHe(t){var n;const{isWebMercator:e,wkt:i,wkt2:r}=t;return e||(((n=r||i)==null?void 0:n.includes("WGS_1984_Web_Mercator"))??!1)}function tW({state:{paddedViewState:t},spatialReference:e,width:i}){return e.isWrappable&&t.worldScreenWidth<i}function iW(t,e){const{x:i,y:r}=t?hy(e,!0):e;return[i,r]}let y0=class extends q{constructor(e){super(e),this.scaleComputedFrom=Mi(),this.view=null}get state(){var e;return(e=this.view)!=null&&e.ready&&this.view.type==="2d"?bD(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(e,i){if(this.state==="disabled"||isNaN(e)||!i||!this.view)return null;const r=this._getDistanceInMeters();return r==null?null:this._getScaleBarProps(e,r,i)}_getDistanceInMeters(){const{state:e,spatialReference:i}=this.view;if(!Cs(i))return null;const{isGeographic:r}=i,n=pHe(i);if(!r&&!n)return e.extent.width*(KJ(i)??1);const[s,o]=this._getScaleMeasuringPoints(),a=n||r&&!x_(i)?le.WGS84:i,u=new hn({paths:[[iW(n,s),iW(n,o)]],spatialReference:a}),d=Pre(u,10);let p;try{[p]=toe([d],"meters")}catch{return null}return p}_getScaleMeasuringPoints(){const e=this.view,{width:i,height:r,position:n,spatialReference:s}=e;if(tW(e)){const d=Ln(s),{valid:p}=d;return[new we(p[0],0,s),new we(p[1],0,s)]}let o=this.scaleComputedFrom.y-n[1];o>r?o=r:o<0&&(o=0);const a=Mi(0,o),u=Mi(i,o);return[e.toMap(a),e.toMap(u)]}_getScaleBarProps(e,i,r){const n=this.view,s=e*i/(tW(n)?n.state.paddedViewState.worldScreenWidth:n.width);if(s<.001)return null;const o=dHe(s,r),{distance:a,unit:u}=o;let d=a,p=0;for(;d>=1;)d/=10,p++;const{min:h,max:m}=cHe(d),y=m/d>=d/h?h:m;return{length:e*(y/d),value:10**p*y,unit:u}}};l([c()],y0.prototype,"scaleComputedFrom",void 0),l([c({readOnly:!0})],y0.prototype,"state",null),l([c()],y0.prototype,"view",void 0),y0=l([$("esri.widgets.ScaleBar.ScaleBarViewModel")],y0);const hHe=y0;function rW(t,e){return Rn(t,{style:"unit",unit:e,unitDisplay:"short"})}let Bl=class extends $t{constructor(e,i){super(e,i),this.messages=null,this.style="line",this.viewModel=new hHe}initialize(){this.addHandles(N(()=>{const{view:e}=this;return[e==null?void 0:e.stationary,e==null?void 0:e.center,e==null?void 0:e.scale,e==null?void 0:e.zoom]},([e])=>{e&&this.scheduleRender()}))}get icon(){return"actual-size"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this._defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel.state==="disabled",i={[K.disabled]:e};let r,n;if(!e){const{unit:s,style:o}=this,a=s==="metric"||s==="dual",u=100,d=s==="dual"?"line":o;if(s==="imperial"||s==="dual"){const p=this.viewModel.getScaleBarProperties(u,"imperial");p&&(n=d==="ruler"?this._renderRuler(p):this._renderLine(p,"bottom"))}if(a){const p=this.viewModel.getScaleBarProperties(u,"metric");p&&(r=d==="ruler"?this._renderRuler(p):this._renderLine(p,"top"))}}return b("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(mi.base,K.widget,i)},r,n)}_renderRuler(e){const{length:i,unit:r,value:n}=e,s=Math.round(i),o=rW(n,r);return b("div",{class:this.classes(mi.barContainer,mi.rulerBarContainer),key:mi.rulerBarContainer},b("div",{class:mi.ruler,styles:{width:`${s}px`}},b("div",{class:mi.rulerBlock}),b("div",{class:mi.rulerBlock}),b("div",{class:mi.rulerBlock}),b("div",{class:mi.rulerBlock})),b("div",{class:this.classes(mi.labelContainer,mi.rulerLabelContainer)},b("div",{class:mi.label},"0"),b("div",{class:mi.label},o)))}_renderLine(e,i){const{length:r,unit:n,value:s}=e,o=Math.round(r),a=rW(s,n),u={[mi.topLabelContainer]:i==="top",[mi.bottomLabelContainer]:i==="bottom"},d=b("div",{class:this.classes(mi.labelContainer,mi.lineLabelContainer,u),key:mi.labelContainer},b("div",{class:mi.label},a)),p={[mi.topLine]:i==="top",[mi.bottomLine]:i==="bottom"},h=b("div",{class:this.classes(mi.line,p),key:mi.line,styles:{width:`${o}px`}});return b("div",{class:this.classes(mi.barContainer,mi.lineBarContainer),key:mi.lineBarContainer},[h,d])}_handleRootCreateOrUpdate(e){if(!this.viewModel)return;const{scaleComputedFrom:i}=this.viewModel,r=e.getBoundingClientRect(),n=r.left+window.pageXOffset,s=r.top+window.pageYOffset,o=Mi(n,s);(o.x!==i.x||o.y!==i.y)&&(this.viewModel.scaleComputedFrom=o)}};l([c(Jue)],Bl.prototype,"_defaultUnit",void 0),l([c()],Bl.prototype,"icon",null),l([c()],Bl.prototype,"label",null),l([c(),Ue("esri/widgets/ScaleBar/t9n/ScaleBar")],Bl.prototype,"messages",void 0),l([c({type:["ruler","line"]})],Bl.prototype,"style",void 0),l([c({type:["metric","imperial","dual"]})],Bl.prototype,"unit",null),l([c()],Bl.prototype,"view",null),l([c()],Bl.prototype,"viewModel",void 0),Bl=l([$("esri.widgets.ScaleBar")],Bl);const mHe=Bl,Ca="esri-layer-list",vl=`${Ca}__item`,vw={base:Ca,actionMenu:`${Ca}__action-menu`,actionGroup:`${Ca}__action-group`,filterNoResults:`${Ca}__filter-no-results`,item:vl,itemActive:`${vl}--active`,itemContent:`${vl}-content`,itemContentBottom:`${vl}-content-bottom`,itemMessage:`${vl}-message`,itemInvisible:`${vl}--invisible`,itemActionIcon:`${vl}-action-icon`,itemActionImage:`${vl}-action-image`,itemTemporaryIcon:`${vl}-temporary-icon`,itemTableIcon:`${vl}-table-icon`,itemCatalogIcon:`${vl}-catalog-icon`,statusIndicator:`${Ca}__status-indicator`,publishing:`${Ca}__publishing`,updating:`${Ca}__updating`,connectionStatus:`${Ca}__connection-status`,connectionStatusConnected:`${Ca}__connection-status--connected`,visibleToggle:`${Ca}__visible-toggle`,visibleIcon:`${Ca}__visible-icon`};function nW(t){return t.icon?t.icon:"image"in t&&t.image||t.className?void 0:"question"}function fHe(t){return t?{backgroundImage:`url(${t})`}:{}}function lut({action:t,feature:e}){const i=e==null?void 0:e.attributes,r="image"in t?t.image:void 0;return r&&i?Wr(r,i):r??""}var DD;let je=DD=class extends $t{constructor(t){super(t),this.dragEnabled=!1,this.listModeDisabled=!1,this.parent=null,this.parentTitles=null,this.viewModel=null,this._onActionMenuOpen=e=>{this.item.actionsOpen=e.target.open},this._setTooltipReference=e=>{var i;(i=this.onTooltipReferenceChange)==null||i.call(this,this.item.layer.uid,e)},this._removeTooltipReference=()=>{var e;(e=this.onTooltipReferenceChange)==null||e.call(this,this.item.layer.uid,null)}}loadDependencies(){return Gt({"action-group":()=>k(()=>import("./calcite-action-group-B6cGYo2B.js"),__vite__mapDeps([360,361,282,242,239,240,235,241,243,256,257,248,236,238,244,245,258,259,260,261,262,263,264])),"action-menu":()=>k(()=>import("./calcite-action-menu-CzcgXQJh.js"),__vite__mapDeps([362,256,257,235,241,239,248,236,240,242,238,243,244,245,258,259,260,261,262,263,264])),action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242])),"list-item":()=>k(()=>import("./calcite-list-item-C35I928x.js"),__vite__mapDeps([278,235,236,240,241,242,243,239,276,275,248,238,244,245,279])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244]))})}render(){var g,v;const t=this.parentTitles??[],{_title:e,item:i,activeItem:r,selectedDragItemLayerUid:n,selectionMode:s,selectedItems:o,messages:a,parent:u,css:d}=this,p="visibleAtCurrentTimeExtent"in i&&"layerInvisibleAtTime"in a&&!i.visibleAtCurrentTimeExtent?`${e} (${a.layerInvisibleAtTime})`:"visibleAtCurrentScale"in i&&"layerInvisibleAtScale"in a&&!i.visibleAtCurrentScale?`${e} (${a.layerInvisibleAtScale})`:e,h="parent"in i&&((v=(g=i.parent)==null?void 0:g.layer)==null?void 0:v.type)==="catalog",{layer:m}=i,y="visibleAtCurrentScale"in i&&!i.visibleAtCurrentScale||"visibleAtCurrentTimeExtent"in i&&!i.visibleAtCurrentTimeExtent;return b("calcite-list-item",{afterCreate:_=>this._focusSelectedDragEl(_,i),afterUpdate:_=>this._focusSelectedDragEl(_,i),class:this.classes(d.item,"itemActive"in d&&{[d.itemActive]:r===i}),"data-item":i,"data-layer-id":m.id,dragDisabled:!i.sortable||h,dragSelected:m.uid===n,id:m.uid,key:`list-item-${m.uid}`,label:e,metadata:{parentTitles:t,_title:e},open:"open"in i&&i.open,selected:s!=="none"&&o.includes(i),title:p,unavailable:y,value:m.uid,onCalciteListItemDragHandleChange:_=>this._handleCalciteListItemDragHandleChange(_,i),onCalciteListItemSelect:_=>"visible"in i&&this._handleCalciteListItemSelect(_,i,u),onCalciteListItemToggle:_=>"open"in i&&this._handleCalciteListItemToggle(_,i)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,b("div",{class:this.classes(d.itemContent,"itemInvisible"in d&&{[d.itemInvisible]:y}),slot:"content"},e),this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const{messages:t}=this;return this.item.title||("untitledTable"in t?t.untitledTable:t.untitledLayer)}get _renderedItemStatus(){const{item:t,parent:e,visibleElements:i,css:r}=this;if(!i.statusIndicators)return null;const{publishing:n}=t,s="updating"in t&&t.updating&&!e,o="connectionStatus"in t?t.connectionStatus:void 0,a=!!o;return b("calcite-icon",{class:this.classes(r.statusIndicator,{[r.publishing]:n},"updating"in r&&{[r.updating]:s},"connectionStatus"in r&&{[r.connectionStatus]:a},"connectionStatusConnected"in r&&{[r.connectionStatusConnected]:a&&o==="connected"}),icon:g6e({connectionStatus:o,publishing:n}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const{item:t,visibleElements:e,css:i}=this,{layer:r}=t,n="temporaryLayerIndicators"in e&&e.temporaryLayerIndicators,s="temporaryTableIndicators"in e&&e.temporaryTableIndicators,o="persistenceEnabled"in r&&(zV(r)||!r.persistenceEnabled);return(n||s)&&o?b("calcite-icon",{class:i.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const{item:t,parent:e,messages:i,visibilityAppearance:r,css:n}=this;if(!("visible"in t&&"layerVisibility"in i&&"visibleToggle"in n&&r))return null;const{visible:s}=t,o=e==null?void 0:e.visibilityMode;if(o==="inherited")return null;const a=y6e({visible:s,exclusive:o==="exclusive",visibilityAppearance:r}),u=r==="checkbox",d=i.layerVisibility;return b("calcite-action",{appearance:"transparent",class:n.visibleToggle,icon:u?a:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(t,e),scale:"s",slot:u?"actions-start":"actions-end",text:d,title:d},u?null:b("calcite-icon",{class:this.classes({[n.visibleIcon]:o!=="exclusive"&&s}),icon:a,scale:"s"}))}get _renderedPanel(){const{panel:t}=this.item;return!(t!=null&&t.open)||t.disabled||t.flowEnabled?null:b("div",{class:this.css.itemContentBottom,key:`content-panel-${t.uid}`,slot:"content-bottom"},t.render())}get _renderedPanelAction(){const{panel:t}=this.item;if(!(t!=null&&t.visible))return null;const{open:e,title:i,disabled:r}=t;return b("calcite-action",{active:e,appearance:"transparent",disabled:r,icon:nW(t),key:`action-${t.uid}`,onclick:()=>this._togglePanel(t),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(t))}get _renderedActions(){switch(this._actionsCount){case 0:return null;case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const{item:t,messagesCommon:e}=this,i=e.options;return b("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:e.menu,open:t.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},b("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map(t=>b("calcite-action-group",{key:`action-section-${t.uid}`},t.toArray().map(e=>this._renderAction({action:e,textEnabled:!0}))))}get _renderedCatalogFootprintIcon(){var i;const{css:t}=this,e=((i=this.item.layer)==null?void 0:i.type)==="catalog-footprint";return"itemCatalogIcon"in t&&e?b("calcite-icon",{class:t.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){var i;const{css:t}=this,e=((i=this.item.layer)==null?void 0:i.type)==="catalog-dynamic-group";return"itemCatalogIcon"in t&&e?b("calcite-icon",{class:t.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const{_title:t,item:e,visibleElements:i}=this;if(!("visible"in e))return;const{layer:r}=e,n=(r==null?void 0:r.type)==="catalog-dynamic-group";return"catalogLayerList"in i&&i.catalogLayerList&&n?b("calcite-action",{appearance:"transparent",disabled:!r.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(e),scale:"s",slot:"actions-end",text:t}):null}get _renderedChildList(){const{dragEnabled:t,item:e,rootGroupUid:i,listModeDisabled:r,selectionMode:n}=this;if(!("visible"in e))return;const s=[...this.parentTitles??[],e.title],{children:o,layer:a}=e,u=(a==null?void 0:a.type)!=="catalog-dynamic-group"&&x6e(e),d=!r&&v6e(a);return u||!d&&!u&&t&&(a==null?void 0:a.type)==="group"?b("calcite-list",{canPull:p=>!!this.canMove&&this.canMove(p,"pull"),canPut:p=>!!this.canMove&&this.canMove(p,"put"),"data-item":e,"data-layer-type":i,dragEnabled:!!t&&e.childrenSortable&&S6e(e),group:`${i}-${a.uid}`,key:`child-list-${a.uid}`,selectionAppearance:"border",selectionMode:n},o==null?void 0:o.filter(p=>!p.hidden).toArray().map(p=>this._renderItem(p,e,s)),this._renderedTablesItem):null}get _hasTables(){var i,r;const{layerTablesEnabled:t}=this,e=this.item.layer;if(!t||!e)return!1;switch(e.type){case"knowledge-graph":return t.includes(e.type)&&!!((i=e.tables)!=null&&i.length);case"map-image":case"tile":return t.includes(e.type)&&!!((r=e.subtables)!=null&&r.length);default:return!1}}get _renderedTablesItem(){const{item:t,messages:e,css:i}=this,{layer:r}=t;return"itemTableIcon"in i&&"visible"in t&&"tables"in e&&this._hasTables?b("calcite-list-item",{class:i.item,"data-layer-id":r.id,dragDisabled:!0,key:`list-item-table-list-tables-${r.uid}`,title:e.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(t)},b("div",{class:i.itemContent,slot:"content"},e.tables),b("calcite-icon",{class:i.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),b("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const{item:t,messages:e,css:i}=this;return t.error?b("div",{class:i.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},b("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},b("div",{slot:"message"},"tableError"in e?e.tableError:e.layerError))):"incompatible"in t&&t.incompatible&&"layerIncompatible"in e?b("div",{class:i.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},b("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},b("div",{slot:"message"},e.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:M6e(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map(t=>t.filter(e=>e.visible))}get _actionsCount(){return this.item.actionsSections.reduce((t,e)=>t+e.length,0)}_renderAction(t){const{item:e}=this,{action:i,textEnabled:r}=t;if(!i)return null;const{active:n,disabled:s,title:o,type:a,indicator:u}=i;return b("calcite-action",{active:a==="toggle"&&i.value,appearance:"transparent",disabled:s,icon:nW(i),indicator:u,key:`action-${i.uid}`,loading:n,onclick:()=>this._triggerAction(e,i),scale:"s",slot:r?void 0:"actions-end",text:o??"",textEnabled:r,title:o??void 0},this._renderFallbackIcon(i))}_renderFallbackIcon(t){const{css:e}=this,{className:i,icon:r}=t;if(r)return null;const n="image"in t?t.image:void 0,s={[e.itemActionIcon]:!!i,[e.itemActionImage]:!!n};return i&&(s[i]=!0),n||i?b("span",{"aria-hidden":"true",class:this.classes(e.itemActionIcon,s),key:"icon",styles:fHe(n)}):null}_renderItem(t,e,i=[]){return b(DD,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,dragEnabled:this.dragEnabled,item:t,key:`layerListItem-${t.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:e,parentTitles:i,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(t,e){e&&t&&(e.type==="toggle"&&(e.value=!e.value),this.onAction(e,t))}_triggerOnTablesOpen(t){t&&this.onTablesOpen&&this.onTablesOpen(t)}_triggerOnCatalogOpen(t){var e;t&&((e=this.onCatalogOpen)==null||e.call(this,t))}_focusSelectedDragEl(t,e){this.selectedDragItemLayerUid===e.layer.uid&&qa(t)}_handleCalciteListItemToggle(t,e){t.stopPropagation(),e.open=t.target.open}_handleCalciteListItemDragHandleChange(t,e){var r;t.stopPropagation();const i=t.target.dragSelected;(r=this.onSelectedDragItemLayerUidChange)==null||r.call(this,i?e.layer.uid:null)}_handleCalciteListItemSelect(t,e,i){Ku(t.target)===e&&this.selectionMode==="none"&&(i==null?void 0:i.visibilityMode)!=="inherited"&&this._toggleVisibility(e,i)}_togglePanel(t){t.open=!t.open,t.open&&this.onPanelOpen()}_toggleVisibility(t,e){if(!t)return;(e==null?void 0:e.visibilityMode)==="exclusive"&&t.visible||(t.visible=!t.visible)}};je.vnodeSelector="calcite-list-item",l([c()],je.prototype,"activeItem",void 0),l([c()],je.prototype,"canMove",void 0),l([c()],je.prototype,"css",void 0),l([c()],je.prototype,"dragEnabled",void 0),l([c()],je.prototype,"item",void 0),l([c()],je.prototype,"layerTablesEnabled",void 0),l([c()],je.prototype,"listModeDisabled",void 0),l([c()],je.prototype,"messages",void 0),l([c()],je.prototype,"messagesCommon",void 0),l([c()],je.prototype,"onAction",void 0),l([c()],je.prototype,"onPanelOpen",void 0),l([c()],je.prototype,"onCatalogOpen",void 0),l([c()],je.prototype,"onTablesOpen",void 0),l([c()],je.prototype,"onSelectedDragItemLayerUidChange",void 0),l([c()],je.prototype,"onTooltipReferenceChange",void 0),l([c()],je.prototype,"parent",void 0),l([c()],je.prototype,"parentTitles",void 0),l([c()],je.prototype,"rootGroupUid",void 0),l([c()],je.prototype,"selectionMode",void 0),l([c()],je.prototype,"selectedItems",void 0),l([c()],je.prototype,"selectedDragItemLayerUid",void 0),l([c()],je.prototype,"visibleElements",void 0),l([c()],je.prototype,"visibilityAppearance",void 0),l([c()],je.prototype,"_title",null),l([c()],je.prototype,"_renderedItemStatus",null),l([c()],je.prototype,"_renderedItemTemporaryIcon",null),l([c()],je.prototype,"_renderedItemToggle",null),l([c()],je.prototype,"_renderedPanel",null),l([c()],je.prototype,"_renderedPanelAction",null),l([c()],je.prototype,"_renderedActions",null),l([c()],je.prototype,"_renderedActionMenu",null),l([c()],je.prototype,"_renderedActionMenuContent",null),l([c()],je.prototype,"_renderedCatalogFootprintIcon",null),l([c()],je.prototype,"_renderedCatalogDynamicIcon",null),l([c()],je.prototype,"_renderedCatalogSelectNode",null),l([c()],je.prototype,"_renderedChildList",null),l([c()],je.prototype,"_hasTables",null),l([c()],je.prototype,"_renderedTablesItem",null),l([c()],je.prototype,"_renderedItemMessage",null),l([c()],je.prototype,"_singleAction",null),l([c()],je.prototype,"_filteredSections",null),l([c()],je.prototype,"_actionsCount",null),je=DD=l([$("esri.widgets.LayerList.LayerListItem")],je);const yHe=je;let ka=class extends q{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};l([c({type:Boolean,nonNullable:!0})],ka.prototype,"catalogLayerList",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"closeButton",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"collapseButton",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"errors",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"filter",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"flow",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"heading",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"statusIndicators",void 0),l([c({type:Boolean,nonNullable:!0})],ka.prototype,"temporaryLayerIndicators",void 0),ka=l([$("esri.widgets.LayerList.LayerListVisibleElements")],ka);const Yue=ka,gHe=Y.ofType(aL);let Be=class extends vu($t){constructor(e,i){super(e,i),this._activeItem=null,this._tooltipReferenceMap=new ip,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new ip,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new Y(["knowledge-graph"]),this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=f6e,this.minFilterItems=m6e,this.openedLayers=new Y,this.openedLayerLists=new Y,this.selectedItems=new gHe,this.selectionMode="none",this.tableList=null,this.tileOptions=null,this.viewModel=new QU,this.visibilityAppearance="default",this.visibleElements=new Yue,this._canMove=({dragEl:r,fromEl:n,toEl:s},o)=>{var M,x,C;const a=o==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,u=Ku(r);if(!(u!=null&&u.sortable))return!1;const d=Ku(n),p=M7(n),h=Ku(s),m=M7(s),y=!!p&&!!m&&p===m,g={selected:u,from:d,to:h},v=n.group,_=s.group,w=((M=d==null?void 0:d.layer)==null?void 0:M.type)??"",S=((x=h==null?void 0:h.layer)==null?void 0:x.type)??"",E=new Set(["map-image","catalog","knowledge-graph"]);return v&&_&&typeof a=="function"?a.call(null,g):y&&!E.has(w)&&!E.has(S)&&((C=u==null?void 0:u.layer)==null?void 0:C.type)!=="sublayer"},this._onCatalogOpen=r=>{this.openedLayers.push(r.layer.parent),this._focusLayerFlowItem=r.layer.uid},this._onTablesOpen=r=>{this.openedLayers.push(r.layer),this._focusLayerFlowItem=r.layer.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onSelectedDragItemLayerUidChange=r=>{this._selectedDragItemLayerUid=r},this._onTooltipReferenceChange=(r,n)=>{n?this._tooltipReferenceMap.set(r,n):this._tooltipReferenceMap.delete(r)},this._onTriggerAction=(r,n)=>{this.triggerAction(r,n)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=r=>{if(this.visibilityAppearance!=="default")return;const n=Array.from(r.composedPath()).find(s=>{var o;return(o=s.classList)==null?void 0:o.contains(vw.item)});this._activeItem=Ku(n)},this._onCalciteListOrderChange=r=>{const{_lastDragDetail:n}=this,{toEl:s,fromEl:o,dragEl:a,newIndex:u}=r;if(o&&s&&!((n==null?void 0:n.newIndex)===u&&(n==null?void 0:n.dragEl)===a&&(n==null?void 0:n.toEl)===s&&(n==null?void 0:n.fromEl)===o))if(this._lastDragDetail=r,o!==s)this._moveLayerFromChildList({toEl:s,fromEl:o,dragEl:a,newIndex:u});else{const d=Array.from(o.children).filter(p=>p==null?void 0:p.matches("calcite-list-item")).map(p=>p.value);this._sortLayers(o,d)}}}initialize(){this.addHandles(St(()=>this.openedLayers,"change",()=>this._handleOpenedLayersChange(),be))}loadDependencies(){return Gt({button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),flow:()=>k(()=>import("./calcite-flow-pVqs_qJ1.js"),__vite__mapDeps([253,242,239])),"flow-item":()=>k(()=>import("./calcite-flow-item-Dp3v--sg.js"),__vite__mapDeps([254,235,236,239,240,241,242,243,255,256,257,248,238,244,245,258,259,260,261,262,263,264,265])),list:()=>k(()=>import("./calcite-list-uoMWRhXD.js"),__vite__mapDeps([274,235,236,242,275,276,239,243,240,241,277,260,244,267,234,237,238,268,269,270,271,245,265])),notice:()=>k(()=>import("./calcite-notice-BUqfqS28.js"),__vite__mapDeps([281,282,242,235,239,240,241,243,262,238,244])),tooltip:()=>k(()=>import("./calcite-tooltip-DHysjdJv.js"),__vite__mapDeps([351,235,259,260,262,264]))})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(i=>i.layer.type!=="catalog-dynamic-group")).length}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){return this.openedLayers.toArray().map(e=>this._renderLayerFlowItem(e))}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get multipleSelectionEnabled(){return Ga(U.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode==="multiple"}set multipleSelectionEnabled(e){Ga(U.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get selectionEnabled(){return Ga(U.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.selectionMode!=="none"&&this.dragEnabled}set selectionEnabled(e){Ga(U.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,i){return this.viewModel.triggerAction(e,i)}render(){var n,s;const e=(n=this.viewModel)==null?void 0:n.state,i={[K.hidden]:e==="loading",[K.disabled]:e==="disabled"},r=(s=this.operationalItems)==null?void 0:s.filter(o=>!o.hidden&&(this.visibleElements.errors||!o.error));return b("div",{class:this.classes(vw.base,K.widget,K.panel,i)},r!=null&&r.length?[this._renderItemTooltips(r),this._renderItems(r)]:this._renderNoItems())}async _createFlowList(e,i){const{_layerListMap:r}=this,n=r.get(e);if(n)return n;const s=e.type==="catalog"?await this._createCatalogLayerList(e):await this._createTableList(e);return i.aborted||r.set(e,s),s}async _handleOpenedLayersChange(){var u;const{_layerListMap:e,openedLayers:i,openedLayerLists:r}=this;(u=this._openedLayersController)==null||u.abort();const n=new AbortController,{signal:s}=n;this._openedLayersController=n,e.forEach((d,p)=>{i.includes(p)||(d.destroy(),e.delete(p))});const o=await Promise.all(i.map(d=>this._createFlowList(d,s)));if(s.aborted)return;r.removeAll(),r.addMany(o);const a=r.at(-1);a?"catalogLayer"in a?(this._set("catalogLayerList",a),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",a)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){const{_tooltipReferenceMap:i,messages:r}=this;return e?b("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:i.get(e.layer.uid)},r.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var i;return e.incompatible?this._renderItemTooltip(e):(i=e.children)==null?void 0:i.filter(r=>!r.hidden).toArray().map(r=>this._renderItemTooltipNodes(r))}_renderItemTooltips(e){return e==null?void 0:e.toArray().map(i=>this._renderItemTooltipNodes(i))}_renderNoItemsMessage(){return b("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return b("div",{class:vw.itemMessage,key:"esri-layer-list__no-items"},b("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(e){const{default:i}=await k(()=>import("./CatalogLayerList-C3ff_qZL.js"),[]),{headingLevel:r,catalogOptions:n,view:s,filterPlaceholder:o,listItemCreatedFunction:a,minFilterItems:u,selectionMode:d,visibilityAppearance:p,_onCatalogOpen:h,_onTablesOpen:m,layerTablesEnabled:y}=this;return new i({headingLevel:r,view:s,filterPlaceholder:o,listItemCreatedFunction:a,minFilterItems:u,selectionMode:d,visibilityAppearance:p,...n,catalogLayer:e,layerTablesEnabled:y,onCatalogOpen:h,onTablesOpen:m})}_getTableListParams(e){switch(e.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case"map-image":return{...this.mapImageOptions,tables:e.subtables};case"tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){const{default:i}=await k(()=>import("./TableList-KKEw_YwC.js"),[]),{headingLevel:r,selectionMode:n,dragEnabled:s}=this;return new i({headingLevel:r,selectionMode:n,dragEnabled:s,...this._getTableListParams(e)})}_renderLayerFlowItem(e){var s;const{messages:i,openedLayers:r}=this,n=e.title||this.messages.untitledLayer;return b("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:n,heading:i[e.type==="catalog"?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,onCalciteFlowItemBack:o=>{o.preventDefault(),r.pop();const a=r.at(-1);a?this._focusLayerFlowItem=a.uid:this._focusRootFlowItem=!0}},(s=this._layerListMap.get(e))==null?void 0:s.render())}_renderPanelFlowItems(e){return e?e.flatten(i=>i.children).filter(({hidden:i,panel:r})=>!i&&(r==null?void 0:r.open)&&!r.disabled&&r.flowEnabled).toArray().map(({title:i,panel:r})=>{const n=()=>this._handlePanelFlowItemBack(r);return b("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:i,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,onCalciteFlowItemBack:s=>{s.preventDefault(),n()}},r.render(),b("calcite-button",{appearance:"transparent",onclick:n,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,qa(e))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,qa(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,qa(e))}_renderItems(e){const{visible:i,collapsed:r,_filterEnabled:n,_rootGroupUid:s,visibleElements:{closeButton:o,collapseButton:a,heading:u,flow:d},_dragEnabled:p,selectionMode:h,filterText:m,filterPlaceholder:y,messages:g}=this,v=[b("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:o,closed:!i,collapsed:r,collapsible:a,heading:u?g.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},b("calcite-list",{afterCreate:_=>{_.addEventListener("focusin",this._setActiveItem),_.addEventListener("focusout",this._clearActiveItem)},afterRemoved:_=>{_.removeEventListener("focusin",this._setActiveItem),_.removeEventListener("focusout",this._clearActiveItem)},canPull:_=>this._canMove(_,"pull"),canPut:_=>this._canMove(_,"put"),"data-layer-type":s,dragEnabled:p,filterEnabled:n,filterPlaceholder:y,filterProps:Jse,filterText:n?m:"",group:s,key:"root-list",label:g.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:h,onCalciteListChange:_=>this._handleCalciteListChange(_),onCalciteListDragEnd:_=>this._handleCalciteListDragEnd(_.detail),onCalciteListFilter:_=>{var w;return this.filterText=((w=_.target)==null?void 0:w.filterText)??""},onCalciteListOrderChange:_=>this._onCalciteListOrderChange(_.detail)},e==null?void 0:e.toArray().map(_=>this._renderItem(_)),e!=null&&e.length&&n?b("div",{class:vw.filterNoResults,slot:"filter-no-results"},b("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(e),this._renderedOpenLayerFlowItems];return i?d?b("calcite-flow",{key:"root-flow"},v):v:null}_renderItem(e,i,r){return b(yHe,{activeItem:this._activeItem,canMove:this._canMove,css:vw,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:i,parentTitles:r,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:i,dragEl:r,newIndex:n}){const s=Ku(r),o=Ku(e),a=Ku(i);this.viewModel.moveListItem(s,a,o,n)}_handleCalciteListDragEnd(e){const{fromEl:i,dragEl:r,oldIndex:n}=e;i.insertBefore(r,i.children[n])}_sortLayers(e,i){var r,n;if(e)if(e.group===this._rootGroupUid)Ele((n=(r=this.view)==null?void 0:r.map)==null?void 0:n.layers,i);else{const s=Ku(e);if(!s)return;E6e(s,i)}}_handleCalciteListChange(e){const{selectionMode:i,selectedItems:r}=this;if(i==="none")return;const n=e.target.selectedItems.map(s=>Ku(s)).filter(Boolean);r.removeAll(),r.addMany(n)}};l([c()],Be.prototype,"_activeItem",void 0),l([c()],Be.prototype,"_tooltipReferenceMap",void 0),l([c()],Be.prototype,"_focusRootFlowItem",void 0),l([c()],Be.prototype,"_focusPanelFlowItem",void 0),l([c()],Be.prototype,"_focusLayerFlowItem",void 0),l([c()],Be.prototype,"_layerListMap",void 0),l([c()],Be.prototype,"_totalItems",null),l([c()],Be.prototype,"_dragEnabled",null),l([c()],Be.prototype,"_filterEnabled",null),l([c()],Be.prototype,"_renderedOpenLayerFlowItems",null),l([c({readOnly:!0})],Be.prototype,"catalogLayerList",void 0),l([c()],Be.prototype,"catalogOptions",void 0),l([c()],Be.prototype,"collapsed",void 0),l([c()],Be.prototype,"dragEnabled",void 0),l([c()],Be.prototype,"filterPlaceholder",void 0),l([c()],Be.prototype,"filterText",void 0),l([c()],Be.prototype,"headingLevel",void 0),l([c()],Be.prototype,"icon",null),l([c()],Be.prototype,"knowledgeGraphOptions",void 0),l([c()],Be.prototype,"label",null),l([c()],Be.prototype,"layerTablesEnabled",void 0),l([c()],Be.prototype,"listItemCanGiveFunction",void 0),l([c()],Be.prototype,"listItemCanReceiveFunction",void 0),l([c()],Be.prototype,"listItemCreatedFunction",null),l([c()],Be.prototype,"mapImageOptions",void 0),l([c(),Ue("esri/widgets/LayerList/t9n/LayerList")],Be.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Be.prototype,"messagesCommon",void 0),l([c()],Be.prototype,"minDragEnabledItems",void 0),l([c()],Be.prototype,"minFilterItems",void 0),l([c()],Be.prototype,"multipleSelectionEnabled",null),l([c({readOnly:!0})],Be.prototype,"openedLayers",void 0),l([c({readOnly:!0})],Be.prototype,"openedLayerLists",void 0),l([c()],Be.prototype,"operationalItems",null),l([c()],Be.prototype,"selectionEnabled",null),l([c()],Be.prototype,"selectedItems",void 0),l([c()],Be.prototype,"selectionMode",void 0),l([c({readOnly:!0})],Be.prototype,"tableList",void 0),l([c()],Be.prototype,"tileOptions",void 0),l([c()],Be.prototype,"view",null),l([km("trigger-action"),c({type:QU})],Be.prototype,"viewModel",void 0),l([c()],Be.prototype,"visibilityAppearance",void 0),l([c({type:Yue,nonNullable:!0})],Be.prototype,"visibleElements",void 0),Be=l([$("esri.widgets.LayerList")],Be);const vHe=Be,Et="esri-slider",rt={base:Et,reversed:`${Et}--reversed`,horizontalLayout:`${Et}--horizontal`,verticalLayout:`${Et}--vertical`,contentElement:`${Et}__content`,extraContentElement:`${Et}__extra-content`,trackElement:`${Et}__track`,ticksContainerElement:`${Et}__ticks`,tickElement:`${Et}__tick`,tickLabelElement:`${Et}__tick-label`,maxElement:`${Et}__max`,minElement:`${Et}__min`,maxElementInteractive:`${Et}__max--interactive`,minElementInteractive:`${Et}__min--interactive`,rangeElementActive:`${Et}__range--active`,rangeInput:`${Et}__range-input`,anchorElement:`${Et}__anchor`,movingAnchorElement:`${Et}__anchor--moving`,lastMovedAnchorElement:`${Et}__anchor--moved`,anchorElementActive:`${Et}__anchor--active`,anchorElementIndexPrefix:`${Et}__anchor-`,segmentElement:`${Et}__segment`,segmentElementIndexPrefix:`${Et}__segment-`,segmentElementInteractive:`${Et}__segment--interactive`,segmentElementActive:`${Et}__segment--active`,effectiveSegmentElement:`${Et}__effective-segment`,effectiveMaxSegmentElement:`${Et}__effective-max-segment`,effectiveMinSegmentElement:`${Et}__effective-min-segment`,thumbElement:`${Et}__thumb`,labelElement:`${Et}__label`,labelElementInteractive:`${Et}__label--interactive`,labelInput:`${Et}__label-input`};let _s=class extends q{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:i,values:r}=this,n=r!=null&&r.length?r.map((s,o)=>this.getLabelForValue(s,"value",o)):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(i,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:i}=this;return e!=null&&i!=null&&e>i?"ready":"disabled"}set values(e){const{max:i,min:r}=this,n=this.values;n&&e&&n.length===e.length&&n.every((s,o)=>s===e[o])||(this._set("values",null),e!=null&&e.length&&(r!=null&&e.some(s=>s<r)&&(this.min=Math.min(...e)),i!=null&&e.some(s=>s>i)&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:i,min:r,precision:n}=this,s=i!=null&&r!=null&&i-r>10?2:n;return parseFloat(e.toFixed(s)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:i,max:r,min:n}=this;return{min:i!=null&&n!=null?Math.max(n,i):n,max:e!=null&&r!=null?Math.min(r,e):r}}getBoundsForValueAtIndex(e){const{thumbsConstrained:i,values:r}=this,{min:n,max:s}=this.getBounds();if(i&&r){const o=e-1,a=e+1;return{min:r[o]!=null?r[o]:n,max:r[a]!=null?r[a]:s}}return{min:n,max:s}}getLabelForValue(e,i,r){return e==null?null:this.labelFormatFunction?this.labelFormatFunction(e,i,r):this.defaultLabelFormatFunction(e)}setMax(e){const{max:i,values:r}=this;if(e==null)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(i!==n&&(this._set("max",n),r==null?void 0:r.length))for(let s=0;s<r.length;s++)n<r[s]&&this.setValue(s,n)}setMin(e){const{min:i,values:r}=this;if(e==null)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(i!==n&&(this._set("min",n),r==null?void 0:r.length))for(let s=0;s<r.length;s++)n>r[s]&&this.setValue(s,n)}setEffectiveMax(e){if(e==null)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const i=this.toPrecision(e);this.effectiveMax!==i&&this._set("effectiveMax",this._applyBoundsToValue(i))}setEffectiveMin(e){if(e==null)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const i=this.toPrecision(e);this.effectiveMin!==i&&this._set("effectiveMin",this._applyBoundsToValue(i))}setValue(e,i){if(isNaN(i))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:r}=this;if(r==null)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=r[e],s=this.toPrecision(i);if(n===s)return;const o=[...r];o[e]=s,this._set("values",o),this.notifyChange("labels")}_applyBoundsToValue(e){const{max:i,min:r}=this;return r!=null&&e<r?r:i!=null&&e>i?i:e}_logError(e,i,r){U.getLogger(this).error(new L(e,i,r))}};l([c()],_s.prototype,"effectiveMax",null),l([c()],_s.prototype,"effectiveMin",null),l([c()],_s.prototype,"labelFormatFunction",null),l([c()],_s.prototype,"inputFormatFunction",null),l([c()],_s.prototype,"inputParseFunction",null),l([c({readOnly:!0})],_s.prototype,"labels",null),l([c()],_s.prototype,"max",null),l([c()],_s.prototype,"min",null),l([c()],_s.prototype,"precision",void 0),l([c({readOnly:!0})],_s.prototype,"state",null),l([c()],_s.prototype,"thumbsConstrained",void 0),l([c()],_s.prototype,"values",null),_s=l([$("esri.widgets.Slider.SliderViewModel")],_s);const bHe=_s,Vs={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},sW={labels:!1,rangeLabels:!1};let Qe=class extends $t{constructor(e,i){super(e,i),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=[],this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new Y,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new Y,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new Y,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new Y,this.tickElements=new Y,this.trackElement=null,this.viewModel=new bHe,this.visibleElements={...sW},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get icon(){return"caret-double-horizontal"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:i,_isMinInputActive:r,_dragStartInfo:n,_segmentDragStartInfo:s,disabled:o,viewModel:a}=this;return o?"disabled":e===null&&!i&&!r?n!=null||s!=null?"dragging":a.state:"editing"}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...sW,...e}}render(){const{label:e}=this,i=this.classes(rt.base,K.widget,this._isHorizontalLayout()?rt.horizontalLayout:rt.verticalLayout,this._isReversedLayout()?rt.reversed:null,this._isDisabled()?K.disabled:null);return this._storeTrackDimensions(),b("div",{afterCreate:this._afterContainerCreate,"aria-label":e,bind:this,class:i,"touch-action":"none"},this._renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}getCurrentPosition(){var e;return this._positionFromValue(((e=this.values)==null?void 0:e[0])??0)}_renderContent(){const{max:e,min:i}=this;if(!(i==null||e==null||i>=e))return[this._renderMin(),this._renderSliderContainer(),this._renderMax()]}_renderSliderContainer(){return b("div",{bind:this,class:rt.contentElement,key:"slider-container"},this._renderTrackElement(),this._renderTicksContainer(),this._renderExtraContentElements())}_renderTrackElement(){return b("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:rt.trackElement,"touch-action":"none"},this._renderEffectiveSegmentElements(),this._renderSegmentElements(),this._renderAnchorElements())}_renderEffectiveSegmentElements(){var u;if(!this.trackElement||!((u=this.values)!=null&&u.length))return;const e=this.effectiveMax!=null,i=this.effectiveMin!=null;if(!e&&!i)return;const{max:r,min:n,viewModel:s}=this,o=s.getBounds(),a=[];return i&&a.push(this._renderEffectiveSegmentElement(n,o.min,!0)),e&&a.push(this._renderEffectiveSegmentElement(o.max,r,!1)),a}_renderSegmentElements(){var r;if(!this.trackElement||!((r=this.values)!=null&&r.length))return;const e=this.values.length,i=[];for(let n=0;n<=e;n++)i.push(this._renderSegmentElement(n));return i}_renderSegmentElement(e){const{_trackHeight:i,_trackWidth:r,draggableSegmentsEnabled:n,id:s,state:o}=this,a=this.values,u=this._isHorizontalLayout(),d=u?r:i,p=this.viewModel.getBounds(),h=this._positionFromValue(p.max),m=this._positionFromValue(p.min),y=e===(a==null?void 0:a.length)?null:e,g=e===0?null:e-1,v=y!=null,_=g!=null;let w,S;const E=[...a].sort((O,F)=>O-F);this._isReversedLayout()?(w=_?this._positionFromValue(E[g]):m,S=v?this._positionFromValue(E[y]):h):(w=v?this._positionFromValue(E[y]):h,S=_?this._positionFromValue(E[g]):m);const T=this._applyPrecisionToPosition(100*S/d),M=(w-S)/d,x=u?`transform: translate(${T}%, 0px) scale(${M}, 1);`:`transform: translate(0px, ${T}%) scale(1, ${M});`,C=this.classes(rt.segmentElement,rt.segmentElementIndexPrefix+e,n&&v&&_&&o!=="disabled"?rt.segmentElementInteractive:null);return b("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:C,"data-max-thumb-index":y,"data-min-thumb-index":g,"data-segment-index":e,key:`${s}-segment-${e}`,style:x,"touch-action":"none"})}_renderEffectiveSegmentElement(e,i,r){const{_trackHeight:n,_trackWidth:s,layout:o}=this,a=this._positionFromValue(e),u=this._positionFromValue(i),d=this._isHorizontalLayout(),p=d?s:n,h=this._applyPrecisionToPosition(100*a/p);let m=null;if(o==="horizontal"){const v=r?p-u:u,_=a===p?0:h;m=`clip-path: inset(0% ${u===p?0:this._applyPrecisionToPosition(v/p*100)}% 0% ${_}%);`}else{const v=(u-a)/p;m=d?`transform: translate(${h}%, 0px) scale(${v}, 1);`:`transform: translate(0px, ${h}%) scale(1, ${v});`}const y=r?rt.effectiveMinSegmentElement:rt.effectiveMaxSegmentElement,g=this.classes(rt.segmentElement,rt.effectiveSegmentElement,y);return b("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:g,style:m,"touch-action":"none"})}_renderAnchorElements(){const{trackElement:e,values:i}=this;if(i!=null&&i.length)return this._zIndices=i.map((r,n)=>{const s=this._positionFromValue(r),o=this._positionToPercent(s),a=(this._isHorizontalLayout()?o>50:o<50)?-1:1;return this._zIndexOffset+(i.length+a*n)}),e&&i&&i.length?i.map((r,n)=>this._renderAnchorElement(r,n)):null}_renderAnchorElement(e,i){const r=this._positionFromValue(e),n=this._valueFromPosition(r);if(n==null||isNaN(n))return;const{_dragStartInfo:s,_lastMovedHandleIndex:o,id:a,layout:u,visibleElements:{labels:d}}=this,p=this.values,h=s&&s.index===i,m=o===i,y=this.classes(rt.anchorElement,rt.anchorElementIndexPrefix+i,h?rt.movingAnchorElement:null,m?rt.lastMovedAnchorElement:null),g=this.labels.values[i],v=this._getStyleForAnchor(e,i,h||m),{min:_,max:w}=this.viewModel.getBoundsForValueAtIndex(i),{disabled:S,messages:E}=this,T=p.length===2?Wr(i===0?E.rangeMinimum:E.rangeMaximum,{value:e}):g,M=p.length===1?null:i===0?`${a}-handle-${i+1}`:i===p.length-1?`${a}-handle-${i-1}`:`${a}-handle-${i-1} ${a}-handle-${i+1}`;return b("div",{afterCreate:this._afterAnchorCreate,afterRemoved:this._afterAnchorRemoved,afterUpdate:this._afterAnchorUpdate,"aria-controls":M,"aria-label":E.sliderValue,"aria-labelledby":d?`${a}-label-${i}`:null,"aria-orientation":u,"aria-valuemax":w==null?void 0:w.toString(),"aria-valuemin":_==null?void 0:_.toString(),"aria-valuenow":e.toString(),"aria-valuetext":T,bind:this,class:y,"data-thumb-index":i,"data-value":e,id:`${a}-handle-${i}`,key:`${a}-handle-${i}`,onkeydown:this._onAnchorKeyDown,role:"slider",style:v,tabIndex:S?-1:0,"touch-action":"none"},b("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:rt.thumbElement,"data-thumb-index":i,"touch-action":"none"}),this.renderThumbLabel(i))}renderThumbLabel(e){const{id:i,labels:r,labelInputsEnabled:n,state:s}=this,o=this.visibleElements.labels,a=r.values[e],u=this.classes(rt.labelElement,o?null:K.hidden,n&&s!=="disabled"?rt.labelElementInteractive:null);return b("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!o).toString(),bind:this,class:u,"data-thumb-index":e,id:`${i}-label-${e}`,key:`${i}-label-${e}`,role:n?"button":null,"touch-action":"none"},this._activeLabelInputIndex===e?this._renderValueInput(e):a)}_renderValueInput(e){const{disabled:i,values:r}=this;if(r==null)return;const n=r[e];return b("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:rt.labelInput,"data-input-index":e,"data-input-type":"thumb",key:`value-input-${e}`,onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:i?-1:0,type:"text",value:this._formatInputValue(n,"value",e)})}_renderMax(){const{_isMaxInputActive:e,labels:i,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,o=this.classes(rt.maxElement,{[K.hidden]:!s,[rt.maxElementInteractive]:r&&n!=="disabled",[rt.rangeElementActive]:e});return b("div",{afterCreate:this._afterMaxLabelCreate,"aria-hidden":(!s).toString(),bind:this,class:o,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this._renderMaxInput():i.max)}_renderMin(){const{_isMinInputActive:e,labels:i,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,o=this.classes(rt.minElement,{[K.hidden]:!s,[rt.minElementInteractive]:r&&n!=="disabled",[rt.rangeElementActive]:e});return b("div",{afterCreate:this._afterMinLabelCreate,"aria-hidden":(!s).toString(),bind:this,class:o,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this._renderMinInput():i.min)}_renderMaxInput(){return b("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:rt.rangeInput,"data-input-type":"max",onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max")})}_renderMinInput(){return b("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:rt.rangeInput,"data-input-type":"min",onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min")})}_renderExtraContentElements(){return b("div",{bind:this,class:rt.extraContentElement},this.extraNodes)}_renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(this._trackHeight!==0||this._trackWidth!==0))return this.tickConfigs.map((e,i)=>b("div",{class:this.classes(rt.ticksContainerElement),key:"ticks-container"},this._renderTicks(e,i)))}_renderTicks(e,i){const{mode:r,values:n}=e;if(this.tickElements.at(i)||this.tickElements.add(new Y,i),r==="position"){const a=Array.isArray(n)?n:[n];return this._calculateTickPositions(a).map((u,d)=>this._renderTickGroup(e,d,i,u))}if(r==="percent"&&Array.isArray(n)){const a=this.min??0,u=(this.max??0)-a,d=n.map(p=>this._applyPrecisionToPosition(p/100*u+a));return this._calculateTickPositions(d).map((p,h)=>this._renderTickGroup(e,h,i,p))}const s=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,o=this._getTickCounts(s,e);return this._calculateEquidistantTickPositions(o).map((a,u)=>this._renderTickGroup(e,u,i,a))}_renderTickGroup(e,i,r,n){const s=e.mode==="position"?Array.isArray(e.values)?e.values[i]:e.values:this._valueFromPosition(n);if(s!=null&&!isNaN(s))return b("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":s,key:`tick-group-${i}`,onclick:this._onTickGroupClick},this._renderTickLine(e,i,r,s),e.labelsVisible?this._renderTickLabel(e,i,r,s):null)}_renderTickLine(e,i,r,n){return b("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:rt.tickElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":n,key:`tick-label-${i}`,style:this._getPositionStyleForElement(n)})}_renderTickLabel(e,i,r,n){const s=e.labelFormatFunction?e.labelFormatFunction(n,"tick",i):this.viewModel.getLabelForValue(n,"tick",i);return b("div",{afterCreate:this._afterTickLabelCreate,"aria-label":s,"aria-valuenow":n.toString(),"aria-valuetext":s,bind:this,class:rt.tickLabelElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":n,key:`tick-label-${i}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},s)}_afterContainerCreate(e){this.addHandles(R4(e,()=>this.scheduleRender()))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const i=bw(e),r=TO(e),n=this.thumbElements.at(i),s=this.labelElements.at(i)||null;this.thumbCreatedFunction(i,r,n,s)}}_afterAnchorUpdate(e){this._focusedAnchorIndex!=null&&bw(e)===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const i=this._anchorElements.indexOf(e,0);i>-1&&this._anchorElements.splice(i,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const i=e.getAttribute("data-input-type"),r=i==="thumb"?_He(e):null;this.inputCreatedFunction(e,i,r)}}_afterTickLineCreate(e){const i=_w(e),r=EI(e),n=this.tickElements.at(i),s=n.at(r);s?s.tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},r)}_afterTickLabelCreate(e){const i=_w(e),r=EI(e),n=this.tickElements.at(i),s=n.at(r);s?s.labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},r)}_afterTickGroupRemoved(e){const i=_w(e),r=this.tickElements.items[i],n=r==null?void 0:r.find(s=>s.groupElement===e);n&&r.remove(n)}_afterTickGroupCreate(e){var r,n;const i=oW(e);if(i!=null&&i.tickCreatedFunction){const s=_w(e),o=EI(e),a=TO(e),u=(n=(r=this.tickElements)==null?void 0:r.at(s))==null?void 0:n.at(o);if(u){u.groupElement=e;const d=u.tickElement||null,p=u.labelElement||null;i.tickCreatedFunction(a,d,p)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled()||this.state==="editing")return;const{key:i,target:r}=e,n=this.values,s=bw(r),o=this._anchorElements[s],a=n[s],u=[Vs.moveAnchorUp,Vs.moveAnchorDown,Vs.moveAnchorLeft,Vs.moveAnchorRight];if(i===Vs.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=s,this.notifyChange("state");else if(u.includes(i)){e.preventDefault();const{steps:d}=this,p=i===Vs.moveAnchorUp||i===Vs.moveAnchorRight?1:-1;if(d!=null)this._toStep(s,this._isReversedLayout()?-1*p:p);else{const{precision:m}=this,y=this._getPositionOfElement(o),g=this._valueFromPosition(y),v=this._isHorizontalLayout()?p:-1*p;let _;_=m===0?this._positionFromValue(g+v):m===1?this._positionFromValue(g+.1*v):y+v,this._toPosition(s,_)}const h=this.values[s];a!==h&&this._emitThumbChangeEvent({index:s,oldValue:a,value:h})}else if(i===Vs.moveAnchorToMax||i===Vs.moveAnchorToMin){e.preventDefault();const{min:d,max:p}=this._getAnchorBoundsInPixels(s),h=this._isPositionInverted()?i===Vs.moveAnchorToMax?d:p:i===Vs.moveAnchorToMin?d:p;this._toPosition(s,h);const m=this.values[s];a!==m&&this._emitThumbChangeEvent({index:s,oldValue:a,value:m})}}_onAnchorPointerDown(e){if(this._isDisabled())return;const{target:i,clientX:r,clientY:n}=e,s=bw(i);s!=null&&(e.preventDefault(),this._anchorElements[s]&&this._anchorElements[s].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:r,clientY:n,index:s,position:this._getPositionOfElement(this._anchorElements[s])},this.notifyChange("state"),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if(this.state==="editing"||!this._dragStartInfo)return;e.preventDefault();const{values:i,_anchorElements:r,_dragged:n,_dragStartInfo:s,_dragStartInfo:{index:o,position:a}}=this,{clientX:u,clientY:d}=e,p=n?"drag":"start",h=r[o],m=this._getPositionOfElement(h),y=this._applyPrecisionToPosition(this._isHorizontalLayout()?a+u-s.clientX:a+d-s.clientY);if(m===y)return;const g=i[o];this._dragged=!0,this._toPosition(o,y);const v=this.values[o];n?g!==v&&this._emitThumbDragEvent({index:o,state:p,value:v}):this._emitThumbDragEvent({index:o,state:p,value:g})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:i}=this._dragStartInfo,r=this._dragged,n=this.values[i];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=i,this.notifyChange("state"),r?this._emitThumbDragEvent({index:i,state:"stop",value:n}):(this.scheduleRender(),this.state!=="editing"&&this._emitThumbClickEvent({index:i,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:i,snapOnClickEnabled:r,state:n,values:s}=this;if(this._isDisabled()||n==="editing"||i||(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!r||!(s!=null&&s.length)))return;const{steps:o}=this,{clientX:a,clientY:u}=e,d=this._getCursorPositionFromEvent(e),p=this._valueFromPosition(d),h=this._getIndexOfNearestValue(p),m=s[h],y=s.some((w,S)=>w===m&&S!==h)&&p>m?s.lastIndexOf(m):h;if(y==null)return;const g=s[y],v=o!=null?this._calculateNearestStepPosition(d):d;this._toPosition(y,v),this._dragged=!0,this._dragStartInfo={clientX:a,clientY:u,index:y,position:v},this._focusedAnchorIndex=y,this.notifyChange("state"),this._emitThumbDragEvent({index:y,state:"start",value:g});const _=this.values[y];g!==_&&this._emitThumbDragEvent({index:y,state:"drag",value:_}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const i=this._getCursorPositionFromEvent(e),r=this._valueFromPosition(i);this._emitTrackClickEvent({value:r})}}_onSegmentPointerDown(e){var u,d;e.preventDefault();const i=e.target,r=wHe(i),n=SHe(i),s=$He(i);if(this._isDisabled()||n==null||s==null)return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const o=this._getAnchorDetails(n),a=this._getAnchorDetails(s);this.syncedSegmentsEnabled?(this.segmentElements.forEach(p=>p.classList.add(rt.segmentElementActive)),this._anchorElements.forEach(p=>p.classList.add(rt.anchorElementActive))):(this.segmentElements.at(r).classList.add(rt.segmentElementActive),(u=this._anchorElements[o.index])==null||u.classList.add(rt.anchorElementActive),(d=this._anchorElements[a.index])==null||d.classList.add(rt.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:r,details:this._normalizeSegmentDetails({min:o,max:a})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this.notifyChange("state"),this._emitSegmentDragEvent({index:r,state:"start",thumbIndices:[n,s]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:i,_trackWidth:r,_segmentDragStartInfo:{index:n,cursorPosition:s,details:{min:o,max:a}}}=this,{index:u,position:d,value:p}=o,{index:h,position:m,value:y}=a;this._dragged=!0;const g=this._getCursorPositionFromEvent(e);if(g===s)return;const v=this._positionToPercent(s),_=this._positionToPercent(g)-v,w=this._positionToPercent(d)+_,S=this._positionToPercent(m)+_,{min:E}=this._getAnchorBoundsAsPercents(u),{max:T}=this._getAnchorBoundsAsPercents(h);let M=!1,x=!1;if(w<E?M=!0:S>T&&(x=!0),M){const{min:J,max:ne}=this.viewModel.getBoundsForValueAtIndex(u),Pe=this._isPositionInverted()?ne:J,_e=Pe,ue=y+(Pe-p),it=ue-this.values[h];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(it):this._updateAnchorValues([u,h],[_e,ue]))}if(x){const{min:J,max:ne}=this.viewModel.getBoundsForValueAtIndex(h),Pe=this._isPositionInverted()?J:ne,_e=Pe,ue=p+(Pe-y),it=ue-this.values[u];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(it):this._updateAnchorValues([u,h],[ue,_e]))}const C=this._isHorizontalLayout()?r:i,O=S/100*C,F=w/100*C,V=this.values,z=[V[u],V[h]],H=this._getValueForAnchorAtPosition(u,F),Q=this._getValueForAnchorAtPosition(h,O);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(H-z[0]):this._updateAnchorValues([u,h],[H,Q]),[this.values[u],this.values[h]].every((J,ne)=>J===z[ne])||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[u,h]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:i}=this,r=this.min,n=this.max,s=this.values,{index:o,details:{min:{index:a},max:{index:u}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach(d=>d.classList.remove(rt.segmentElementActive)),this._anchorElements.forEach(d=>d.classList.remove(rt.anchorElementActive)),this.draggableSegmentsEnabled){const d=n-r,p=s[a],h=s[u];this._lastMovedHandleIndex=p===h?p>d/2?a:u:null,this._dragged=!1,this._segmentDragStartInfo=null,this.notifyChange("state"),this._emitSegmentDragEvent({index:o,state:"stop",thumbIndices:[a,u]})}if(!i){const d=this._getCursorPositionFromEvent(e),p=this._valueFromPosition(d);this._emitSegmentClickEvent({index:o,value:p,thumbIndices:[a,u]})}}_onTickGroupClick(e){const i=e.target;if(oW(i)){const r=_w(i),n=EI(i),s=TO(i);this._emitTickClickEvent({configIndex:r,groupIndex:n,value:s})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=this._applyPrecisionToPosition(e.height),this._trackWidth=this._applyPrecisionToPosition(e.width)}}_onLabelPointerDown(){this._isDisabled()||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled()||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled())return;const i=bw(e.target);this.labelInputsEnabled&&!this._dragged&&i!=null&&(this._activeLabelInputIndex=i),this._dragged=!1,this.notifyChange("state"),document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:i,values:r,viewModel:n}=this,s=e.target.value;if(this._activeLabelInputIndex=null,this.notifyChange("state"),!s||i==null||r==null)return;const o=this._parseInputValue(s,"value",i),a=r[i],{min:u,max:d}=this.viewModel.getBoundsForValueAtIndex(i);if(o<u||o>d)return;n.setValue(i,o);const p=this.values[i];a!==p&&this._emitThumbChangeEvent({index:i,oldValue:a,value:p})}_onInputKeyDown(e){var p;if(this._isDisabled())return;const{key:i,target:r}=e,{hideInput1:n,hideInput2:s,hideInput3:o}=Vs,{_activeLabelInputIndex:a,_anchorElements:u}=this,d=r;if(i===n||i===s||i===o){e.stopPropagation();const h=a;d.blur(),h!=null?u[h].focus():(p=d.parentElement)==null||p.focus()}}_onMaxLabelClick(){this._isDisabled()||(this._emitMaxRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0,this.notifyChange("state")))}_onMaxLabelKeyDown({key:e}){this._isDisabled()||e!==Vs.showInput||(this._isMaxInputActive=!0,this.notifyChange("state"))}_onMaxInputBlur(e){const i=e.target.value;if(this._isMaxInputActive=!1,this.notifyChange("state"),!i)return;const r=this.max,n=this._parseInputValue(i,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==r&&this._emitMaxChangeEvent({oldValue:r,value:this.max}))}_onMinLabelClick(){this._isDisabled()||(this._emitMinRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0,this.notifyChange("state")))}_onMinLabelKeyDown({key:e}){this._isDisabled()||e!==Vs.showInput||(this._isMinInputActive=!0,this.notifyChange("state"))}_onMinInputBlur(e){const i=e.target.value;if(this._isMinInputActive=!1,this.notifyChange("state"),!i)return;const r=this.min,n=this._parseInputValue(i,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==r&&this._emitMinChangeEvent({oldValue:r,value:this.min}))}_isDisabled(){return this.disabled||this.state==="disabled"}_positionFromValue(e){const{_trackHeight:i,_trackWidth:r}=this,n=this.min??0,s=this.max??0,o=s-n;if(o===0||e==null)return 0;const a=this._isHorizontalLayout();let u=a?this._applyPrecisionToPosition(r*(e-n)/o):this._applyPrecisionToPosition(i*(s-e)/o);return this._isReversedLayout()&&(u=a?r-u:i-u),u}_valueFromPosition(e){const{_trackHeight:i,_trackWidth:r,precision:n}=this,s=this.min??0,o=this.max??0,a=o-s;let u=this._isHorizontalLayout()?e*a/r+s:a*(1e3-e/i*1e3)/1e3+s;return this._isReversedLayout()&&(u=o+s-u),parseFloat(u.toFixed(n))}_positionToPercent(e){const{_trackHeight:i,_trackWidth:r}=this,n=100*e/(this._isHorizontalLayout()?r:i);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return e==="horizontal-reversed"||e==="vertical"}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:i,max:r}=e;return{min:r,max:i}}return e}_parseInputValue(e,i,r){return this.inputParseFunction?this.inputParseFunction(e,i,r):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,i,r){return this.inputFormatFunction?this.inputFormatFunction(e,i,r):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const i=this.values,r=[...i].sort((s,o)=>s-o)[e],n=i.indexOf(r);return{index:n,position:this._getPositionOfElement(this._anchorElements[n]),value:r}}_updateAnchorStyle(e,i){const r=this._anchorElements[e];r&&(this._isHorizontalLayout()?r.style.left=`${i}`:r.style.top=`${i}`)}_getStyleForAnchor(e,i,r){var o;const n=this._getPositionStyleForElement(e);if(((o=this.values)==null?void 0:o.length)===1)return`${n}`;const s=this._zIndices[i];return`${n}; z-index: ${r?this._zIndexOffset+s:s}`}_getPositionStyleForElement(e){const i=this._positionFromValue(e),r=this._positionToPercent(i);return`${this._isHorizontalLayout()?"left":"top"}: ${r}%`}_getPositionOfElement(e){const i=this._getDimensions(e.offsetParent),r=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(r.left-i.left):this._applyPrecisionToPosition(r.top-i.top)}_updateAnchorValues(e,i){e.forEach((r,n)=>this._toValue(r,i[n]))}_updateAnchorValuesByDifference(e){const{min:i,max:r,values:n}=this;n==null||n.forEach((s,o)=>this._toValue(o,Math.max(Math.min(s+e,r),i)))}_toValue(e,i){this.steps!=null&&(i=this._getStepValues()[this._getIndexOfNearestStepValue(i)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(i)),this.viewModel.setValue(e,i)}_toPosition(e,i){const r=this.steps!=null?this._getStepValueForAnchorAtPosition(e,i):this._getValueForAnchorAtPosition(e,i);this._updateAnchorStyle(e,this._getPositionStyleForElement(r)),this.viewModel.setValue(e,r)}_getValueForAnchorAtPosition(e,i){const{min:r,max:n}=this._getAnchorBoundsInPixels(e),{min:s,max:o}=this.viewModel.getBoundsForValueAtIndex(e);let a,u,d=null;return this._isPositionInverted()?(a=s,u=o):(a=o,u=s),d=i>n?a:i<r?u:this._valueFromPosition(i),d>o?d=o:d<s&&(d=s),d}_getStepValueForAnchorAtPosition(e,i){const r=this._getStepValues(),n=this._calculateNearestStepPosition(i),s=this._getValueForAnchorAtPosition(e,n);return r[this._getIndexOfNearestStepValue(s)]}_getAnchorBoundsAsPercents(e){const{min:i,max:r}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(i),max:this._positionToPercent(r)}}_getAnchorBoundsInPixels(e){const{_anchorElements:i,_trackHeight:r,_trackWidth:n,effectiveMax:s,effectiveMin:o,thumbsConstrained:a}=this,u=i[e-1],d=i[e+1],p=this._isHorizontalLayout()?n:r;let h,m;return this._isPositionInverted()?(h=o!=null?this._positionFromValue(o):p,m=s!=null?this._positionFromValue(s):0):(h=s!=null?this._positionFromValue(s):p,m=o!=null?this._positionFromValue(o):0),a?this._isPositionInverted()?{max:u?this._getPositionOfElement(u):h,min:d?this._getPositionOfElement(d):m}:{max:d?this._getPositionOfElement(d):h,min:u?this._getPositionOfElement(u):m}:{max:h,min:m}}_getIndexOfNearestValue(e){const i=this.values;return i.indexOf(i.reduce((r,n)=>Math.abs(n-e)<Math.abs(r-e)?n:r))}_getCursorPositionFromEvent(e){const i=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?this._applyPrecisionToPosition(e.clientX-i.left):this._applyPrecisionToPosition(e.clientY-i.top)}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:i,min:r}=this;if(r==null||i==null||e==null)return[];const n=Math.ceil((i-r)/e),s=[];for(let o=0;o<=n;o++){const a=r+e*o;s.push(a>i?i:a)}return s}_toStep(e,i){const r=this.values[e],n=this._getStepValues(),s=n.indexOf(r);let o=null;if(s>-1){let a=n[s+i];isNaN(a)&&(a=n[s]);const u=this._positionFromValue(a);o=this._getStepValueForAnchorAtPosition(e,u)}else o=n[this._getIndexOfNearestStepValue(r)+i];this.viewModel.setValue(e,o)}_getIndexOfNearestStepValue(e){const{steps:i}=this;if(i==null)return null;const r=this._getStepValues(),n=r.reduce((s,o)=>Math.abs(o-e)<Math.abs(s-e)?o:s);return r.indexOf(n)}_calculateNearestStepPosition(e){const i=this._valueFromPosition(e),r=this._getIndexOfNearestStepValue(i),n=this._getStepValues();return this._positionFromValue(n[r])}_getTickCounts(e,i){const{mode:r}=i;return r==="count"||r==="position"?e||0:r==="percent"&&100/e||0}_calculateTickPositions(e){return e.map(i=>this._positionFromValue(i))}_calculateEquidistantTickPositions(e){const{_trackWidth:i,_trackHeight:r}=this,n=this._isHorizontalLayout()?i:r,s=n/(e-1),o=[];if(e===1)return[n/2];for(let a=0;a<e;a++){const u=a*s;u<=n&&o.push(u)}return o}_getDimensions(e){try{return $m(e),e.getBoundingClientRect()}catch(i){if(typeof i=="object"&&i!==null)return new DOMRect(0,0,0,0);throw i}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitMinRangeLabelClickEvent(e){this.emit("min-click",e)}_emitMaxRangeLabelClickEvent(e){this.emit("min-click",e)}};function bw(t){return t==null?void 0:t["data-thumb-index"]}function _He(t){return t==null?void 0:t["data-input-index"]}function wHe(t){return t==null?void 0:t["data-segment-index"]}function SHe(t){return t==null?void 0:t["data-min-thumb-index"]}function $He(t){return t==null?void 0:t["data-max-thumb-index"]}function TO(t){return t==null?void 0:t["data-value"]}function _w(t){return t==null?void 0:t["data-tick-config-index"]}function EI(t){return t==null?void 0:t["data-tick-group-index"]}function oW(t){return t==null?void 0:t["data-config"]}l([c()],Qe.prototype,"disabled",void 0),l([c()],Qe.prototype,"draggableSegmentsEnabled",void 0),l([c()],Qe.prototype,"effectiveMax",null),l([c()],Qe.prototype,"effectiveMin",null),l([c({readOnly:!0})],Qe.prototype,"effectiveSegmentElements",void 0),l([c()],Qe.prototype,"extraNodes",void 0),l([c()],Qe.prototype,"inputCreatedFunction",void 0),l([c()],Qe.prototype,"inputFormatFunction",null),l([c()],Qe.prototype,"inputParseFunction",null),l([c()],Qe.prototype,"icon",null),l([c()],Qe.prototype,"label",null),l([c({readOnly:!0})],Qe.prototype,"labelElements",void 0),l([c()],Qe.prototype,"labelInputsEnabled",void 0),l([c()],Qe.prototype,"labelFormatFunction",null),l([c({readOnly:!0})],Qe.prototype,"labels",null),l([c({value:"horizontal"})],Qe.prototype,"layout",null),l([c()],Qe.prototype,"max",null),l([c({readOnly:!0})],Qe.prototype,"maxLabelElement",void 0),l([c(),Ue("esri/widgets/Slider/t9n/Slider")],Qe.prototype,"messages",void 0),l([c()],Qe.prototype,"min",null),l([c({readOnly:!0})],Qe.prototype,"minLabelElement",void 0),l([c()],Qe.prototype,"precision",null),l([c()],Qe.prototype,"rangeLabelInputsEnabled",void 0),l([c({readOnly:!0})],Qe.prototype,"segmentElements",void 0),l([c()],Qe.prototype,"snapOnClickEnabled",void 0),l([c({readOnly:!0})],Qe.prototype,"state",null),l([c()],Qe.prototype,"steps",void 0),l([c()],Qe.prototype,"syncedSegmentsEnabled",void 0),l([c()],Qe.prototype,"thumbsConstrained",null),l([c()],Qe.prototype,"thumbCreatedFunction",void 0),l([c({readOnly:!0})],Qe.prototype,"thumbElements",void 0),l([c()],Qe.prototype,"tickConfigs",null),l([c({readOnly:!0})],Qe.prototype,"tickElements",void 0),l([c({readOnly:!0})],Qe.prototype,"trackElement",void 0),l([c()],Qe.prototype,"values",null),l([c()],Qe.prototype,"viewModel",void 0),l([c()],Qe.prototype,"visibleElements",void 0),l([We("visibleElements")],Qe.prototype,"castVisibleElements",null),Qe=l([$("esri.widgets.Slider")],Qe);const EHe=Qe,Bt="esri-time-slider",Ye={timeSlider:`${Bt}`,timeSliderOutOfBounds:`${Bt}--out-of-bounds`,timeSliderMode:`${Bt}__mode--`,timeSliderLayout:`${Bt}__layout--`,timeSliderRow:`${Bt}__row`,animation:`${Bt}__animation`,animationButton:`${Bt}__animation-button`,timeExtent:`${Bt}__time-extent`,timeExtentGroup:`${Bt}__time-extent-group`,timeExtentDate:`${Bt}__time-extent-date`,timeExtentTime:`${Bt}__time-extent-time`,timeExtentSeparator:`${Bt}__time-extent-separator`,playbackControls:`${Bt}__playback-controls`,min:`${Bt}__min`,minDate:`${Bt}__min-date`,minTime:`${Bt}__min-time`,slider:`${Bt}__slider`,sliderMajorTick:"majorTick",sliderMinorTick:"minorTick",max:`${Bt}__max`,maxDate:`${Bt}__max-date`,maxTime:`${Bt}__max-time`,previous:`${Bt}__previous`,previousButton:`${Bt}__previous-button`,next:`${Bt}__next`,nextButton:`${Bt}__next-button`,warning:`${Bt}__warning`,warningText:`${Bt}__warning-text`,hasActions:`${Bt}--has-actions`,actions:`${Bt}__actions`,actionsButton:`${Bt}__actions-button`},aW=1e4;function VD(t){return t!=null&&t.count!==void 0}function bC(t){return t!=null&&t.interval!==void 0}function lW(t){return t!=null&&t.dates!==void 0}let $r=class extends ji.EventedAccessor{constructor(e){super(e),this._animationController=null,this._isViewTimeExtentInitialized=!1,this._timerId=null,this.actions=new Y,this.fullTimeExtent=null,this.loop=!1,this.mode="time-window",this.stops={count:10},this.timeExtent=null,this.view=null}initialize(){this.addHandles([N(()=>this.effectiveStops,()=>{this.timeExtent==null&&(this.timeExtent=this._getDefaultTimeExtent())},be),N(()=>this.view,(e,i)=>{this._unregisterWidget(i),this._registerWidget(e)},gt),N(()=>this.timeExtent,e=>{if(this.view==null)return;const i=this.view.timeExtent;(e!=null&&!e.isAllTime||i!=null&&!i.isAllTime)&&(e!=null&&i!=null&&e.equals(i)||(this.view.timeExtent=e))},be),N(()=>{var e;return(e=this.view)==null?void 0:e.timeExtent},e=>{this._isViewTimeExtentInitialized?(e!=null&&!e.isAllTime||this.timeExtent!=null&&!this.timeExtent.isAllTime)&&(e!=null&&this.timeExtent!=null&&e.equals(this.timeExtent)||(this.timeExtent=e)):this._isViewTimeExtentInitialized=!0})])}destroy(){this._timerId!=null&&(clearInterval(this._timerId),this._timerId=null),this._unregisterWidget(this.view),this.view=null,this._animationController!=null&&(this._animationController.abort(),this._animationController=null)}get effectiveStops(){const{fullTimeExtent:e,stops:i}=this;if(lW(i)){const{dates:r}=i;if(r==null||r.length===0)return null;const n=r.sort((a,u)=>a.getTime()-u.getTime());if(e==null)return n;const{start:s,end:o}=e;return s==null||o==null?n:n.filter(a=>!(a.getTime()<s.getTime()||a.getTime()>o.getTime()))}if(VD(i)){const r=i.timeExtent??e;return this._divideTimeExtentByCount(r,i.count)}if(bC(i)){const r=i.timeExtent??e;return this._divideTimeExtentByInterval(r,i.interval)}return[]}set playRate(e){e<=0||e>36e5||(this.state==="playing"&&this._startAnimation(),this._set("playRate",e))}get state(){return this.fullTimeExtent==null?"disabled":this._animationController!=null?"playing":"ready"}get timeExtentValues(){const{mode:e,timeExtent:i}=this;if(i==null||i.isAllTime||i.isEmpty)return null;const{start:r,end:n}=i;switch(e){case"cumulative-from-end":case"instant":return r!=null?[r.getTime()]:null;case"cumulative-from-start":return n!=null?[n.getTime()]:null;case"time-window":return r!=null&&n!=null?[r.getTime(),n.getTime()]:null}}static async getPropertiesFromWebMap(e,i){IC(U.getLogger("esri.widgets.TimeSlider.TimeSliderViewModel"),"`TimeSliderViewModel.getPropertiesFromWebMap` is deprecated in favor of 'timeUtils.getTimeSliderSettingsFromWebDocument'",{replacement:"timeUtils.getTimeSliderSettingsFromWebDocument",version:"4.29",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-support-timeUtils.html#getTimeSliderSettingsFromWebDocument",warnOnce:!0});const{getTimeSliderSettingsFromWebDocument:r}=await k(()=>import("./timeUtils-C35TngI1.js"),__vite__mapDeps([194,195]));return r(e,i)}next(){this._step({forward:!0,allowRestart:!1})}play(){this._startAnimation()}previous(){this._step({forward:!1,allowRestart:!1})}stop(){this._stopAnimation()}triggerAction(e){this.emit("trigger-action",{action:e})}updateWebDocument(e){const i=new rQ({currentTimeExtent:this.timeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:VD(this.stops)?this.stops.count:null,numThumbs:this.mode==="time-window"?2:1,stopDelay:this.playRate,stopInterval:bC(this.stops)?this.stops.interval:null,stops:lW(this.stops)?this.stops.dates:null});e.widgets?e.widgets.timeSlider=i:e.widgets=new nQ({timeSlider:i})}valuesToTimeExtent(e){if(e==null)return null;const i=e.sort((s,o)=>s-o).map(s=>new Date(s)),r=i.length>0?i[0]:null,n=i.length>1?i[1]:null;switch(this.mode){case"time-window":return new Pt({start:r,end:n});case"instant":return new Pt({start:r,end:r});case"cumulative-from-start":return new Pt({start:null,end:r});case"cumulative-from-end":return new Pt({start:r,end:null});default:return Pt.allTime}}async _animate(){var e;try{const i=this.view,r=(e=this._animationController)==null?void 0:e.signal;await Promise.all([i_(this.playRate,null,r),i!=null&&wi(()=>i.updating===!1,r)])}catch(i){return rr(i)||U.getLogger(this).error(i),void(this._animationController=null)}this._step({forward:!0,allowRestart:!1}),this._animationController!=null&&this._animate()}_divideTimeExtentByCount(e,i=10){if(!e||!i)return[];const{start:r,end:n}=e;if(r==null||n==null)return[];if(i>aW)return this._divideTimeExtentByCount(e);const s=[],o=r.getTime(),a=n.getTime()-o;for(let u=0;u<=i;u++)s.push(new Date(o+u/i*a));return s}_divideTimeExtentByInterval(e,i,r=aW){if(!e||!i)return[];const{start:n,end:s}=e;if(n==null||s==null)return[];const o=s.getTime()-n.getTime(),a=i.toMilliseconds();if(a<=0||o/a>r)return this._divideTimeExtentByCount(e);const u=[],{value:d,unit:p}=i;let h=n;for(;h.getTime()<=s.getTime();)u.push(new Date(h.getTime())),h=lS(h,d,p);return u}_getDefaultTimeExtent(){const{effectiveStops:e,mode:i}=this;if(e==null||!i)return null;switch(i){case"time-window":return e.length>1?new Pt({start:e[0],end:e[1]}):null;case"cumulative-from-start":return e.length>0?new Pt({start:null,end:e[0]}):null;case"cumulative-from-end":return e.length>0?new Pt({start:e[0],end:null}):null;case"instant":return e.length>0?new Pt({start:e[0],end:e[0]}):null;default:return null}}_registerWidget(e){e!=null&&(e.persistableViewModels.includes(this)||e.persistableViewModels.add(this))}_startAnimation(){this._stopAnimation(),this._animationController=new AbortController,this._step({forward:!0,allowRestart:!0}),this._animate()}_step(e){const{forward:i,allowRestart:r}=e,{effectiveStops:n}=this;if(this.timeExtentValues==null||n==null)return;const s=n.map(h=>h.getTime()),o=this.timeExtentValues.map(h=>{const m=s.indexOf(h);if(m!==-1)return m;const y=s.reduce((g,v)=>Math.abs(v-h)<Math.abs(g-h)?v:g);return s.indexOf(y)}),a=o.map(h=>h+(i?1:-1)),u=a.some(h=>h<0||h>s.length-1),{loop:d,state:p}=this;if(u)if(d||r){const h=Math.min(...o),m=Math.max(...o),y=(i?o.map(g=>g-h):o.map(g=>g+(s.length-1-m))).map(g=>s[g]);this.timeExtent=this.valuesToTimeExtent(y)}else p==="playing"&&this.stop();else{const h=a.map(m=>s[m]);this.timeExtent=this.valuesToTimeExtent(h)}}_stopAnimation(){this._animationController!=null&&(this._animationController.abort(),this._animationController=null)}_unregisterWidget(e){e!=null&&e.persistableViewModels.remove(this)}};l([c()],$r.prototype,"_animationController",void 0),l([c({type:Y})],$r.prototype,"actions",void 0),l([c({readOnly:!0})],$r.prototype,"effectiveStops",null),l([c({type:Pt})],$r.prototype,"fullTimeExtent",void 0),l([c({nonNullable:!0})],$r.prototype,"loop",void 0),l([c({nonNullable:!0})],$r.prototype,"mode",void 0),l([c({nonNullable:!0,value:1e3})],$r.prototype,"playRate",null),l([c({readOnly:!0})],$r.prototype,"state",null),l([c({cast:t=>t==null?null:(bC(t)&&(t.interval=pi(hp,t.interval)),(bC(t)||VD(t))&&(t.timeExtent=pi(Pt,t.timeExtent)),t)})],$r.prototype,"stops",void 0),l([c({type:Pt})],$r.prototype,"timeExtent",void 0),l([c({readOnly:!0})],$r.prototype,"timeExtentValues",null),l([c()],$r.prototype,"view",void 0),l([c()],$r.prototype,"next",null),l([c()],$r.prototype,"play",null),l([c()],$r.prototype,"previous",null),l([c()],$r.prototype,"stop",null),l([c()],$r.prototype,"updateWebDocument",null),$r=l([$("esri.widgets.TimeSlider.TimeSliderViewModel")],$r);const UD=$r,THe=3,IHe=858,xHe=[{minor:{value:100,unit:"milliseconds"},major:{value:1,unit:"seconds"},format:{second:"numeric"}},{minor:{value:500,unit:"milliseconds"},major:{value:5,unit:"seconds"},format:{second:"numeric"}},{minor:{value:1,unit:"seconds"},major:{value:20,unit:"seconds"},format:{minute:"numeric",second:"numeric"}},{minor:{value:2,unit:"seconds"},major:{value:30,unit:"seconds"},format:{minute:"numeric",second:"numeric"}},{minor:{value:10,unit:"seconds"},major:{value:1,unit:"minutes"},format:{minute:"numeric"}},{minor:{value:15,unit:"seconds"},major:{value:5,unit:"minutes"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:1,unit:"minutes"},major:{value:20,unit:"minutes"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:5,unit:"minutes"},major:{value:2,unit:"hours"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:15,unit:"minutes"},major:{value:6,unit:"hours"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:1,unit:"hours"},major:{value:1,unit:"days"},format:{day:"numeric",month:"short"}},{minor:{value:6,unit:"hours"},major:{value:1,unit:"weeks"},format:{day:"numeric",month:"short"}},{minor:{value:1,unit:"days"},major:{value:1,unit:"months"},format:{month:"long"}},{minor:{value:2,unit:"days"},major:{value:1,unit:"months"},format:{month:"short"}},{minor:{value:3,unit:"days"},major:{value:1,unit:"months"},format:{month:"short"}},{minor:{value:4,unit:"days"},major:{value:3,unit:"months"},format:{month:"short",year:"numeric"}},{minor:{value:1,unit:"weeks"},major:{value:1,unit:"years"},format:{year:"numeric"}},{minor:{value:1,unit:"months"},major:{value:1,unit:"years"},format:{year:"numeric"}},{minor:{value:2,unit:"months"},major:{value:2,unit:"years"},format:{year:"numeric"}},{minor:{value:1,unit:"years"},major:{value:1,unit:"decades"},format:{year:"numeric"}},{minor:{value:2,unit:"years"},major:{value:5,unit:"decades"},format:{year:"numeric"}},{minor:{value:5,unit:"decades"},major:{value:10,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:1,unit:"centuries"},major:{value:10,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:2,unit:"centuries"},major:{value:20,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:5,unit:"centuries"},major:{value:50,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:10,unit:"centuries"},major:{value:100,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:20,unit:"centuries"},major:{value:200,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:50,unit:"centuries"},major:{value:500,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:100,unit:"centuries"},major:{value:1e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:200,unit:"centuries"},major:{value:1e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:500,unit:"centuries"},major:{value:5e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:1e3,unit:"centuries"},major:{value:1e4,unit:"centuries"},format:{era:"short",year:"numeric"}}];let Vt=class extends $t{constructor(e,i){super(e,i),this._ignoreNextSliderUpdate=!1,this._slider=new EHe({precision:0,visibleElements:{rangeLabels:!1},rangeLabelInputsEnabled:!1,thumbsConstrained:!1}),this._tickFormat=null,this.disabled=!1,this.labelFormatFunction=null,this.messages=null,this.messagesCommon=null,this.tickConfigs=null,this.timeVisible=!1,this.viewModel=new UD}initialize(){this.addHandles([N(()=>this._slider.values,e=>{if(this._ignoreNextSliderUpdate)return void(this._ignoreNextSliderUpdate=!1);const i=this.viewModel.valuesToTimeExtent(e);this.timeExtent!=null?i!=null?this.timeExtent.equals(i)||(this.timeExtent=i):this.timeExtent=null:i!=null&&(this.timeExtent=i)}),N(()=>this.effectiveStops,()=>this._updateSliderSteps(),be)])}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),"action-menu":()=>k(()=>import("./calcite-action-menu-CzcgXQJh.js"),__vite__mapDeps([362,256,257,235,241,239,248,236,240,242,238,243,244,245,258,259,260,261,262,263,264]))})}destroy(){this._slider.destroy(),this._tickFormat=null}get _dateFormat(){return this._getIntlOptions("short-date")}get _timeFormat(){return this._getIntlOptions("long-time")}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}get effectiveStops(){return this.viewModel.effectiveStops}get fullTimeExtent(){return this.viewModel.fullTimeExtent}set fullTimeExtent(e){this.viewModel.fullTimeExtent=e}get icon(){return"clock"}set icon(e){this._overrideIfSome("icon",e)}get interactive(){return!(this.disabled||this.viewModel.state==="disabled"||this.timeZone===pp)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){["auto","compact","wide"].includes(e)||(e="auto"),this._set("layout",e)}get loop(){return this.viewModel.loop}set loop(e){this.viewModel.loop=e}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}get playRate(){return this.viewModel.playRate}set playRate(e){this.viewModel.playRate=e}get stops(){return this.viewModel.stops}set stops(e){this.viewModel.stops=e}get tickFormats(){const{timeZone:e}=this;return xHe.map(({minor:i,major:r,format:n})=>({minor:new hp(i),major:new hp(r),format:{...n,timeZone:e}}))}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(e){this.viewModel.timeExtent=e}get timeZone(){var e;return((e=this.viewModel.view)==null?void 0:e.timeZone)??Os}set timeZone(e){this._overrideIfSome("timeZone",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}static async getPropertiesFromWebMap(e,i){return IC(U.getLogger("esri.widgets.TimeSlider"),"`TimeSlider.getPropertiesFromWebMap` is deprecated in favor of 'timeUtils.getTimeSliderSettingsFromWebDocument'",{replacement:"timeUtils.getTimeSliderSettingsFromWebDocument",version:"4.29",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-support-timeUtils.html#getTimeSliderSettingsFromWebDocument",warnOnce:!0}),UD.getPropertiesFromWebMap(e,i)}next(){return this.viewModel.next()}play(){return this.viewModel.play()}previous(){return this.viewModel.previous()}stop(){return this.viewModel.stop()}render(){var Pe,_e;const{_slider:e,actions:i,domNode:r,effectiveStops:n,fullTimeExtent:s,interactive:o,messages:a,messagesCommon:u,mode:d,tickConfigs:p,timeExtent:h,timeVisible:m,viewModel:{state:y,timeExtentValues:g}}=this;if(s!=null){const{start:ue,end:it}=s;if(ue!=null&&it!=null){const Xr=ue.getTime(),us=it.getTime(),ho=e.min!==Xr||e.max!==us;if(ho&&(e.min=Xr,e.max=us),p!=null)e.tickConfigs!==p&&(e.tickConfigs=p);else{const nl=(us-Xr)/(((Pe=e.trackElement)==null?void 0:Pe.offsetWidth)||400),Fn=this.tickFormats.find(cs=>cs.minor.toMilliseconds()>THe*nl)??this.tickFormats.at(-1),mo=this._tickFormat!==Fn&&Fn!=null;if(mo&&(this._tickFormat=Fn),ho||mo){const cs={mode:"position",values:this._getTickPositions(Fn.minor),labelsVisible:!1,tickCreatedFunction:(sl,ds)=>{ds==null||ds.classList.add(Ye.sliderMinorTick)}},Fc={mode:"position",values:this._getTickPositions(Fn.major),labelsVisible:!0,tickCreatedFunction:(sl,ds)=>{ds==null||ds.classList.add(Ye.sliderMajorTick)},labelFormatFunction:sl=>hr(sl,Fn.format)};e.tickConfigs=[cs,Fc]}}}}const v=((_e=this.fullTimeExtent)==null?void 0:_e.start)==null||this.fullTimeExtent.end==null||this.timeExtent==null||this.timeExtent.isAllTime||this.timeExtent.isEmpty||this.timeExtent.start!=null&&(this.timeExtent.start<this.fullTimeExtent.start||this.timeExtent.start>this.fullTimeExtent.end)||this.timeExtent.end!=null&&(this.timeExtent.end>this.fullTimeExtent.end||this.timeExtent.end<this.fullTimeExtent.start);if(v)switch(this._ignoreNextSliderUpdate=!0,d){case"time-window":e.values=[e.min,e.max];break;case"instant":case"cumulative-from-end":e.values=[e.min];break;case"cumulative-from-start":e.values=[e.max]}else g!=null?eg(e.values,g)||(e.values=g):e.values=null;e.disabled=!o;const _=y==="ready",w=y==="playing",S=v||!o||n==null||n.length===0,E=this.layout==="auto"?r.clientWidth<IHe?"compact":"wide":this.layout,T=b("div",{class:Ye.animation},b("button",{"aria-disabled":S?"true":"false","aria-label":w?u.control.stop:u.control.play,bind:this,class:this.classes(K.widgetButton,Ye.animationButton,S&&K.buttonDisabled),disabled:S,onclick:this._playOrStopClick,title:w?u.control.stop:u.control.play,type:"button"},b("div",{class:this.classes((_||S)&&Cr.play,w&&Cr.pause)}))),M=this.labelFormatFunction!=null?b("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:Ye.timeExtentDate,"data-date":h?[h.start,h.end]:null,"data-layout":E,"data-type":"extent",key:"extent"}):h==null||h!=null&&h.isAllTime?[b("div",{class:this.classes(Ye.warning,Cr.noticeTriangle)}),b("div",{class:Ye.warningText,key:"warning-text"},a.noTimeExtent)]:h.isEmpty?[b("div",{class:this.classes(Ye.warning,Cr.noticeTriangle)}),b("div",{class:Ye.warningText,key:"warning-text"},a.emptyTimeExtent)]:[h.start!=null&&b("div",{class:Ye.timeExtentGroup,key:"start-date-group"},b("div",{class:Ye.timeExtentDate,key:"start-date"},this._formatDate(h.start)),m?b("div",{class:Ye.timeExtentTime,key:"start-time"},this._formatTime(h.start)):null),h.start!=null&&h.end!=null&&h.start.getTime()!==h.end.getTime()&&b("div",{class:Ye.timeExtentSeparator,key:"separator"},"–"),h.end!=null&&(h.start==null||h.start.getTime()!==h.end.getTime())&&b("div",{class:Ye.timeExtentGroup,key:"end-date-group"},b("div",{class:Ye.timeExtentDate,key:"end-date"},this._formatDate(h.end)),m?b("div",{class:Ye.timeExtentTime,key:"end-time"},this._formatTime(h.end)):null)],x=b("div",{class:this.classes(Ye.timeExtent,!o&&K.buttonDisabled)},[M]),C=this.labelFormatFunction!=null?b("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:Ye.minDate,"data-date":s==null?void 0:s.start,"data-layout":E,"data-type":"min",key:"min-date"}):(s==null?void 0:s.start)!=null&&[b("div",{class:Ye.minDate,key:"min-date"},this._formatDate(s.start)),m&&b("div",{class:Ye.minTime,key:"min-time"},this._formatTime(s.start))],O=b("div",{class:this.classes(Ye.min,!o&&K.buttonDisabled)},[C]),F=b("div",{class:Ye.slider},e.render()),V=this.labelFormatFunction!=null?b("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:Ye.maxDate,"data-date":s==null?void 0:s.end,"data-layout":E,"data-type":"max",key:"max-date"}):(s==null?void 0:s.end)!=null&&[b("div",{class:Ye.maxDate,key:"max-date"},this._formatDate(s.end)),m&&b("div",{class:Ye.maxTime,key:"max-time"},this._formatTime(s.end))],z=b("div",{class:this.classes(Ye.max,!o&&K.buttonDisabled)},[V]),H=b("div",{class:Ye.previous},b("button",{"aria-disabled":S?"true":"false","aria-label":u.pagination.previous,bind:this,class:this.classes(K.widgetButton,Ye.previousButton,(w||S)&&K.buttonDisabled),disabled:S,onclick:this._previousClick,title:u.pagination.previous,type:"button"},b("div",{class:Cr.reverse}))),Q=b("div",{class:Ye.next},b("button",{"aria-disabled":S?"true":"false","aria-label":u.pagination.next,bind:this,class:this.classes(K.widgetButton,Ye.nextButton,(w||S)&&K.buttonDisabled),disabled:S,onclick:this._nextClick,title:u.pagination.next,type:"button"},b("div",{class:Cr.forward}))),J=(i==null?void 0:i.length)>0,ne=J&&b("div",{class:Ye.actions,title:u.options},b("calcite-action-menu",{class:Ye.actionsButton,label:u.options},i.toArray().map(ue=>b("calcite-action",{bind:this,icon:ue.icon,id:ue.id,onclick:()=>this.viewModel.triggerAction(ue),text:ue.title,textEnabled:!0,title:ue.title}))));return b("div",{afterCreate:ue=>{this.addHandles(R4(ue,()=>this.scheduleRender()))},"aria-label":a.widgetLabel,class:this.classes(Ye.timeSlider,K.widget,`${Ye.timeSliderMode}${d}`,`${Ye.timeSliderLayout}${E}`,!o&&K.disabled,v&&Ye.timeSliderOutOfBounds,J&&Ye.hasActions,rse())},E==="wide"&&b("div",{class:Ye.timeSliderRow},b("div",{class:Ye.playbackControls},[T,x,O,F,z,H,Q]),ne),E==="compact"&&[b("div",{class:Ye.timeSliderRow,key:"time-slider-row-1"},[x,ne]),b("div",{class:Ye.timeSliderRow,key:"time-slider-row-2"},[F]),b("div",{class:Ye.timeSliderRow,key:"time-slider-row-3"},[O,H,T,Q,z])])}updateWebDocument(e){var i;(i=this.viewModel)==null||i.updateWebDocument(e)}_createLabel(e){if(this.labelFormatFunction==null)return;const i=e.getAttribute("data-type"),r=e.getAttribute("data-layout"),n=e["data-date"];this.labelFormatFunction(n,i,e,r)}_formatDate(e){return hr(e,this._dateFormat)}_formatTime(e){return hr(e,this._timeFormat)}_getIntlOptions(e){const{timeZone:i}=this;return{...Ms(e),timeZone:i}}_getTickPositions(e){const{fullTimeExtent:i}=this;if((i==null?void 0:i.start)==null||i.end==null)return[];const{start:r,end:n}=i,s=[],{value:o,unit:a}=e;let u=UR(r,a,this.timeZone);for(;u.getTime()<=n.getTime();)u.getTime()>=r.getTime()&&s.push(u.getTime()),u=lS(u,o,a,this.timeZone);return s}_updateSliderSteps(){this._slider.steps=this.effectiveStops!=null&&this.effectiveStops.length>0?this.effectiveStops.map(e=>e.getTime()):null}_playOrStopClick(){switch(this.viewModel.state){case"ready":this.viewModel.play();break;case"playing":this.viewModel.stop();break;case"disabled":break;default:this.viewModel.state}}_previousClick(){this.viewModel.previous()}_nextClick(){this.viewModel.next()}};l([c()],Vt.prototype,"_dateFormat",null),l([c()],Vt.prototype,"_timeFormat",null),l([c()],Vt.prototype,"actions",null),l([c()],Vt.prototype,"disabled",void 0),l([c()],Vt.prototype,"effectiveStops",null),l([c()],Vt.prototype,"fullTimeExtent",null),l([c()],Vt.prototype,"icon",null),l([c({readOnly:!0})],Vt.prototype,"interactive",null),l([c()],Vt.prototype,"label",null),l([c()],Vt.prototype,"labelFormatFunction",void 0),l([c({value:"auto"})],Vt.prototype,"layout",null),l([c()],Vt.prototype,"loop",null),l([c(),Ue("esri/widgets/TimeSlider/t9n/TimeSlider")],Vt.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Vt.prototype,"messagesCommon",void 0),l([c()],Vt.prototype,"mode",null),l([c()],Vt.prototype,"playRate",null),l([c()],Vt.prototype,"stops",null),l([c()],Vt.prototype,"tickConfigs",void 0),l([c()],Vt.prototype,"tickFormats",null),l([c()],Vt.prototype,"timeExtent",null),l([c({nonNullable:!0})],Vt.prototype,"timeVisible",void 0),l([c()],Vt.prototype,"timeZone",null),l([c()],Vt.prototype,"view",null),l([c({type:UD}),km("trigger-action")],Vt.prototype,"viewModel",void 0),l([xy()],Vt.prototype,"_playOrStopClick",null),l([xy()],Vt.prototype,"_previousClick",null),l([xy()],Vt.prototype,"_nextClick",null),Vt=l([$("esri.widgets.TimeSlider")],Vt);const uW=Vt;function lu(t){let e,i,r=[],n=!1;function s(...o){return n&&e===this&&MHe(o,r)||(i=t.apply(this,o),e=this,r=o,n=!0),i}return s}function MHe(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}const Nr="esri-elevation-profile",or={base:`${Nr}`,portrait:`${Nr}--portrait`,refined:`${Nr}--refined`,mainContainer:`${Nr}__main-container`,promptContainer:`${Nr}__prompt-container`,header:`${Nr}__header`,zoomOutButton:`${Nr}__zoom-out-button`,clearButton:`${Nr}__clear-button`,actionButton:`${Nr}__action-button`,sketchButton:`${Nr}__sketch-button`,sketchCancelButton:`${Nr}__sketch-cancel-button`,sketchDoneButton:`${Nr}__sketch-done-button`,selectButton:`${Nr}__select-button`,selectCancelButton:`${Nr}__select-cancel-button`,chartContainer:`${Nr}__chart-container`,chartSpinner:`${Nr}__chart-spinner`,chartSpinnerVisible:`${Nr}__chart-spinner--visible`,chartSpinnerSmall:`${Nr}__chart-spinner--small`,footer:`${Nr}__footer`},CHe={base:"esri-elevation-profile-legend"},Hc="esri-elevation-profile-legend-item",qc={base:Hc,disabled:`${Hc}--disabled`,expanded:`${Hc}--expanded`,colorIndicator:`${Hc}__color-indicator`,header:`${Hc}__header`,content:`${Hc}__content`,collapseToggle:`${Hc}__collapse-toggle`,label:`${Hc}__label`,checkbox:`${Hc}__checkbox`},ww="esri-elevation-profile-statistics",Sw={base:ww,statistic:`${ww}__statistic`,statisticLabel:`${ww}__statistic__label`,statisticValue:`${ww}__statistic__value`,slopeValue:`${ww}__slope-value`},TI="esri-elevation-profile-settings",II={base:`${TI}`,popoverContent:`${TI}__popover-content`,uniformChartScalingLabel:`${TI}__uniform-scaling-label`,uniformChartScalingCheckbox:`${TI}__uniform-scaling-checkbox`};let kHe=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,i){this._store.put(e,i,i.values.byteLength+256)}};function Kue(t,e,i,r){let n=null,s=1e3;typeof e=="number"?(s=e,r=i):(n=e??null,s=i);let o,a=0;const u=()=>{a=0,t.apply(r,o)},d=(...p)=>{n&&n.apply(r,p),o=p,s?a||(a=setTimeout(u,s)):u()};return d.remove=()=>{a&&(clearTimeout(a),a=0)},d.forceUpdate=()=>{a&&(clearTimeout(a),u())},d.hasPendingUpdates=()=>!!a,d}let LHe=class{};const AHe=LHe;function cW(t,...e){let i="";for(let r=0;r<e.length;r++)i+=t[r]+e[r];return i+=t[t.length-1],i}function gut(t,e,i=""){return t?e:i}(function(t){function e(r){return Math.round(r).toString()}function i(r){return r.toPrecision(8)}t.int=e,t.float=i})(cW||(cW={}));let OHe=class{constructor(){this.id=rm()}};var jD;(function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"})(jD||(jD={}));var Bi;function but(t){return t===Bi.POSITION}(function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.ROTATION="rotation",t.TANGENT="tangent",t.OFFSET="offset",t.PERSPECTIVEDIVIDE="perspectiveDivide",t.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",t.LENGTH="length",t.PREVPOSITION="prevPosition",t.NEXTPOSITION="nextPosition",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.INSTANCEMODELORIGINHI="instanceModelOriginHi",t.INSTANCEMODELORIGINLO="instanceModelOriginLo",t.INSTANCEMODEL="instanceModel",t.INSTANCEMODELNORMAL="instanceModelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMAL2COMPRESSED="normal2Compressed",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.START_UP="startUp",t.END_UP="endUp",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"})(Bi||(Bi={}));const RHe=new Map([[Bi.POSITION,0],[Bi.NORMAL,1],[Bi.NORMALCOMPRESSED,1],[Bi.UV0,2],[Bi.COLOR,3],[Bi.COLORFEATUREATTRIBUTE,3],[Bi.SIZE,4],[Bi.TANGENT,4],[Bi.CENTEROFFSETANDDISTANCE,5],[Bi.SYMBOLCOLOR,5],[Bi.FEATUREATTRIBUTE,6],[Bi.INSTANCEFEATUREATTRIBUTE,6],[Bi.INSTANCECOLOR,7],[Bi.OBJECTANDLAYERIDCOLOR,7],[Bi.INSTANCEOBJECTANDLAYERIDCOLOR,7],[Bi.ROTATION,8],[Bi.INSTANCEMODEL,8],[Bi.INSTANCEMODELNORMAL,12],[Bi.INSTANCEMODELORIGINHI,11],[Bi.INSTANCEMODELORIGINLO,15]]);function CE(t){return t?{origin:Yr(t.origin),vector:Yr(t.vector)}:{origin:W(),vector:W()}}function PHe(t,e){const i=DHe.get();return i.origin=t,i.vector=e,i}function _ut(t,e=CE()){return FHe(t.origin,t.vector,e)}function FHe(t,e,i=CE()){return Yt(i.origin,t),Yt(i.vector,e),i}function wut(t,e,i=CE()){return Yt(i.origin,t),hi(i.vector,e,t),i}function NHe(t,e){const i=hi(Re.get(),e,t.origin),r=tt(t.vector,i),n=tt(t.vector,t.vector),s=fr(r/n,0,1),o=hi(Re.get(),jt(Re.get(),t.vector,s),i);return tt(o,o)}function Sut(t,e,i){return GD(t,e,0,1,i)}function $ut(t,e,i){return di(i,t.origin,jt(i,t.vector,e))}function GD(t,e,i,r,n){const{vector:s,origin:o}=t,a=hi(Re.get(),e,o),u=tt(s,a)/Wy(s);return jt(n,s,fr(u,i,r)),di(n,n,t.origin)}function Eut(t,e){if(Xue(t,PHe(e.origin,e.direction),!1,_C)){const{tA:i,pB:r,distance2:n}=_C;if(i>=0&&i<=1)return n;if(i<0)return yp(t.origin,r);if(i>1)return yp(di(Re.get(),t.origin,t.vector),r)}return null}function Tut(t,e,i){return!!Xue(t,e,!0,_C)&&(Yt(i,_C.pA),!0)}function Xue(t,e,i,r){const s=t.origin,o=di(Re.get(),s,t.vector),a=e.origin,u=di(Re.get(),a,e.vector),d=Re.get(),p=Re.get();if(d[0]=s[0]-a[0],d[1]=s[1]-a[1],d[2]=s[2]-a[2],p[0]=u[0]-a[0],p[1]=u[1]-a[1],p[2]=u[2]-a[2],Math.abs(p[0])<1e-6&&Math.abs(p[1])<1e-6&&Math.abs(p[2])<1e-6)return!1;const h=Re.get();if(h[0]=o[0]-s[0],h[1]=o[1]-s[1],h[2]=o[2]-s[2],Math.abs(h[0])<1e-6&&Math.abs(h[1])<1e-6&&Math.abs(h[2])<1e-6)return!1;const m=d[0]*p[0]+d[1]*p[1]+d[2]*p[2],y=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],g=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],v=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],_=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*v-y*y;if(Math.abs(_)<1e-6)return!1;let w=(m*y-g*v)/_,S=(m+y*w)/v;i&&(w=fr(w,0,1),S=fr(S,0,1));const E=Re.get(),T=Re.get();return E[0]=s[0]+w*h[0],E[1]=s[1]+w*h[1],E[2]=s[2]+w*h[2],T[0]=a[0]+S*p[0],T[1]=a[1]+S*p[1],T[2]=a[2]+S*p[2],r.tA=w,r.tB=S,r.pA=E,r.pB=T,r.distance2=yp(E,T),!0}const _C={tA:0,tB:0,pA:W(),pB:W(),distance2:0},DHe=new SE(()=>CE()),IO=()=>U.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let VHe=class{constructor(){this.plane=vn(),this.origin=W(),this.basis1=W(),this.basis2=W()}};const UHe=VHe;function kE(t=lce){return{plane:vn(t.plane),origin:Yr(t.origin),basis1:Yr(t.basis1),basis2:Yr(t.basis2)}}function jHe(t,e,i){const r=nqe.get();return r.origin=t,r.basis1=e,r.basis2=i,r.plane=mUe(0,0,0,0),cL(r),r}function uL(t,e=kE()){return Que(t.origin,t.basis1,t.basis2,e)}function GHe(t,e){Yt(e.origin,t.origin),Yt(e.basis1,t.basis1),Yt(e.basis2,t.basis2),pae(e.plane,t.plane)}function Que(t,e,i,r=kE()){return Yt(r.origin,t),Yt(r.basis1,e),Yt(r.basis2,i),cL(r),iqe(r,"fromValues()"),r}function cL(t){sD(t.basis2,t.basis1,t.origin,t.plane)}function ece(t,e,i){t!==i&&uL(t,i);const r=jt(Re.get(),vp(t),e);return di(i.origin,i.origin,r),i.plane[3]-=e,i}function zHe(t,e,i){return tce(e,i),ece(i,_j(t,t.origin),i),i}function BHe(t,e){const i=t.basis1[0],r=t.basis2[1],[n,s]=t.origin;return Eve(n-i,s-r,n+r,s+r,e)}function tce(t,e=kE()){const i=(t[2]-t[0])/2,r=(t[3]-t[1])/2;return vt(e.origin,t[0]+i,t[1]+r,0),vt(e.basis1,i,0,0),vt(e.basis2,0,r,0),CU(0,0,1,0,e.plane),e}function vj(t,e,i){return!!gUe(t.plane,e,i)&&oce(t,i)}function HHe(t,e,i){if(vj(t,e,i))return i;const r=ice(t,e,Re.get());return di(i,e.origin,jt(Re.get(),e.direction,fg(e.origin,r)/Si(e.direction))),i}function ice(t,e,i){const r=wC.get();ace(t,e,r,wC.get());let n=Number.POSITIVE_INFINITY;for(const s of Sj){const o=wj(t,s,dL.get()),a=Re.get();if(vUe(r,o,a)){const u=$ne(Re.get(),e.origin,a),d=Math.abs(qC(tt(e.direction,u)));d<n&&(n=d,Yt(i,a))}}return n===Number.POSITIVE_INFINITY?rce(t,e,i):i}function qHe(t,e){return(e-t)/e}function rce(t,e,i){if(vj(t,e,i))return i;const r=wC.get(),n=wC.get();ace(t,e,r,n);let s=Number.POSITIVE_INFINITY;for(const o of Sj){const a=wj(t,o,dL.get()),u=Re.get();if(bUe(r,a,u)){const d=EUe(e,u);if(!kU(n,u))continue;d<s&&(s=d,Yt(i,u))}}return bj(t,e.origin)<s&&nce(t,e.origin,i),i}function nce(t,e,i){const r=LU(t.plane,e,Re.get()),n=GD(dW(t,t.basis1),r,-1,1,Re.get()),s=GD(dW(t,t.basis2),r,-1,1,Re.get());return hi(i,di(Re.get(),n,s),t.origin),i}function sce(t,e,i){const{origin:r,basis1:n,basis2:s}=t,o=hi(Re.get(),e,r),a=Cy(n,o),u=Cy(s,o),d=Cy(vp(t),o);return vt(i,a,u,d)}function bj(t,e){const i=sce(t,e,Re.get()),{basis1:r,basis2:n}=t,s=Si(r),o=Si(n),a=Math.max(Math.abs(i[0])-s,0),u=Math.max(Math.abs(i[1])-o,0),d=i[2];return a*a+u*u+d*d}function WHe(t,e){return Math.sqrt(bj(t,e))}function ZHe(t,e){let i=Number.NEGATIVE_INFINITY;for(const r of Sj){const n=wj(t,r,dL.get()),s=NHe(n,e);s>i&&(i=s)}return Math.sqrt(i)}function JHe(t,e){return kU(t.plane,e)&&oce(t,e)}function YHe(t,e,i,r){return tqe(t,i,r)}function _j(t,e){const i=-t.plane[3];return Cy(vp(t),e)-i}function KHe(t,e,i,r){const n=_j(t,e),s=jt(rqe,vp(t),i-n);return di(r,e,s),r}function XHe(t,e){return Ft(t.basis1,e.basis1)&&Ft(t.basis2,e.basis2)&&Ft(t.origin,e.origin)}function QHe(t,e,i){return t!==i&&uL(t,i),JC(Qg,e),tl(Qg,Qg),Wa(i.basis1,t.basis1,Qg),Wa(i.basis2,t.basis2,Qg),Wa(i.plane,t.plane,Qg),Wa(i.origin,t.origin,e),yUe(i.plane,i.plane,i.origin),i}function eqe(t,e,i,r){return t!==r&&uL(t,r),WV(xO,e,i),Wa(r.basis1,t.basis1,xO),Wa(r.basis2,t.basis2,xO),cL(r),r}function vp(t){return t.plane}function tqe(t,e,i){switch(e){case uu.X:Yt(i,t.basis1),ls(i,i);break;case uu.Y:Yt(i,t.basis2),ls(i,i);break;case uu.Z:Yt(i,vp(t))}return i}function oce(t,e){const i=hi(Re.get(),e,t.origin),r=Wy(t.basis1),n=Wy(t.basis2),s=tt(t.basis1,i),o=tt(t.basis2,i);return-s-r<0&&s-r<0&&-o-n<0&&o-n<0}function dW(t,e){const i=dL.get();return Yt(i.origin,t.origin),Yt(i.vector,e),i}function wj(t,e,i){const{basis1:r,basis2:n,origin:s}=t,o=jt(Re.get(),r,e.origin[0]),a=jt(Re.get(),n,e.origin[1]);di(i.origin,o,a),di(i.origin,i.origin,s);const u=jt(Re.get(),r,e.direction[0]),d=jt(Re.get(),n,e.direction[1]);return jt(i.vector,di(u,u,d),2),i}function iqe(t,e){Math.abs(tt(t.basis1,t.basis2)/(Si(t.basis1)*Si(t.basis2)))>1e-6&&IO().warn(e,"Provided basis vectors are not perpendicular"),Math.abs(tt(t.basis1,vp(t)))>1e-6&&IO().warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-tt(vp(t),t.origin)-t.plane[3])>1e-6&&IO().warn(e,"Plane offset is not consistent with plane origin")}function ace(t,e,i,r){const n=vp(t);sD(n,e.direction,e.origin,i),sD(i,n,e.origin,r)}const lce={plane:vn(),origin:Lr(0,0,0),basis1:Lr(1,0,0),basis2:Lr(0,1,0)},wC=new SE(vn),dL=new SE(CE),rqe=W(),nqe=new SE(()=>kE()),Sj=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Qg=ou(),xO=ou(),xut=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:UHe,altitudeAt:_j,axisAt:YHe,cameraFrustumCoverage:qHe,closestPoint:rce,closestPointOnSilhouette:ice,copy:uL,copyWithoutVerify:GHe,create:kE,distance:WHe,distance2:bj,distanceToSilhouette:ZHe,elevate:ece,equals:XHe,extrusionContainsPoint:JHe,fromAABoundingRect:tce,fromValues:Que,getExtent:BHe,intersectRay:vj,intersectRayClosestSilhouette:HHe,normal:vp,projectPoint:nce,projectPointLocal:sce,rotate:eqe,setAltitudeAt:KHe,setExtent:zHe,transform:QHe,up:lce,updateUnboundedPlane:cL,wrap:jHe},Symbol.toStringTag,{value:"Module"}));function sqe(t){return Math.abs(t*t*t)}function uce(t,e,i){const r=i.parameters;return MO.scale=Math.min(r.divisor/(e-r.offset),1),MO.factor=sqe(t),MO}function cce(t,e){return Wh(t*Math.max(e.scale,e.minScaleFactor),t,e.factor)}function oqe(t,e,i){const r=uce(t,e,i);return r.minScaleFactor=0,cce(1,r)}function Mut(t,e,i,r){r.scale=oqe(t,e,i),r.factor=0,r.minScaleFactor=i.minScaleFactor}function Cut(t,e,i=[0,0]){const r=Math.min(Math.max(e.scale,e.minScaleFactor),1);return i[0]=t[0]*r,i[1]=t[1]*r,i}function aqe(t,e,i,r){return cce(t,uce(e,i,r))}const MO={scale:0,factor:0,minScaleFactor:0};function kut(t,e,i,r,n){let s=(i.screenLength||0)*t.pixelRatio;n!=null&&(s=aqe(s,r,e,n));const o=s*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return fr(o*e,i.minWorldLength||0,i.maxWorldLength!=null?i.maxWorldLength:1/0)}function pW(t,e){let i=!1;for(const r in e){const n=e[r];n!==void 0&&(Array.isArray(n)?Array.isArray(t[r])&&eg(n,t[r])||(t[r]=n.slice(),i=!0):t[r]!==n&&(i=!0,t[r]=n))}return i}const Lut={multiply:1,ignore:2,replace:3,tint:4};let Aut=class extends OHe{constructor(e,i){super(),this.type=jD.Material,this.supportsEdges=!1,this._renderPriority=0,this.vertexAttributeLocations=RHe,this._pp0=Lr(0,0,1),this._pp1=Lr(0,0,0),this._parameters=new i,pW(this._parameters,e),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(e){return!1}setParameters(e,i=!0){pW(this._parameters,e)&&(this.validateParameters(this._parameters),i&&this._parametersChanged())}validateParameters(e){}shouldRender(e){return this.visible&&this.isVisibleForOutput(e.output)&&(!this.parameters.isDecoration||e.bind.decorations)&&!!(this.parameters.renderOccluded&e.renderOccludedMask)}isVisibleForOutput(e){return!0}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this._parametersChanged())}_parametersChanged(){var e;(e=this.repository)==null||e.materialChanged(this)}queryRenderOccludedState(e){return this.visible&&this.parameters.renderOccluded===e}get hasEmissions(){return!1}intersectDraped(e,i,r,n,s,o){return this._pp0[0]=this._pp1[0]=n[0],this._pp0[1]=this._pp1[1]=n[1],this.intersect(e,i,r,this._pp0,this._pp1,s)}};var SC;(function(t){t[t.None=0]="None",t[t.Occlude=1]="Occlude",t[t.Transparent=2]="Transparent",t[t.OccludeAndTransparent=4]="OccludeAndTransparent",t[t.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",t[t.Opaque=16]="Opaque"})(SC||(SC={}));let Rut=class extends AHe{constructor(){super(...arguments),this.renderOccluded=SC.Occlude,this.isDecoration=!1}};var io,Ir;(function(t){t.Disabled="disabled",t.Ready="ready",t.Creating="creating",t.Created="created",t.Selecting="selecting",t.Selected="selected"})(io||(io={})),function(t){t.NoValidInput="no-valid-input",t.NoVisibleProfiles="no-visible-profiles",t.InvalidGeometry="invalid-geometry",t.TooComplex="too-complex",t.InvalidElevationInfo="invalid-elevation-info",t.UnknownError="unknown-error",t.RefinedButNoChartData="refined-but-no-chart-data",t.None="none"}(Ir||(Ir={}));let dce={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:dce.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:Oe(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,falloff:0,innerWidth:0,innerColor:Pc(0,0,0,0),renderOccluded:SC.Opaque},profileLines3DUpdateThrottleMillis:100,hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function Ka(){return dce}const lqe=" ― ",uqe={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null},pce="ProfileGenerationError";var Za;(function(t){t.TooComplex="too-complex",t.InvalidGeometry="invalid-geometry",t.InvalidElevationInfo="invalid-elevation-info",t.ElevationQueryError="elevation-query-error"})(Za||(Za={}));let lb=class extends Error{constructor(e){super("profile could not be generated",{cause:e}),this.type=pce}};function cqe(t){return t.type===pce}async function dqe(t,e,i,r,n,s,o){let a,u,d;const p=t.spatialReference,h=p.isGeographic||p.isWebMercator;let m=0;if(!h){const{planarLength:v}=await k(()=>import("./geometryEngineAsync-Bw7Kl4S9.js"),[]);qe(o),m=await v(t,"meters"),qe(o)}const y=1/Ci(r),g=n.geodesicDistanceThreshold??1/0;if(h||m>=g){await Ec([{source:p,dest:r},{source:p,dest:le.WGS84}],o);const v=Sqe(t);a=toe([v],"meters")[0];const _=hW(a,n);if(yW(t,a,_)>s)throw new lb(Za.TooComplex);const w=mW(v,e,i);({densifiedPath:u,distances:d}=fqe(w,_,y)),u=On(u,r)}else{await Ec([{source:p,dest:r}],o),a=m;const v=hW(a,n);if(yW(t,a,v)>s)throw new lb(Za.TooComplex);const _=mW(t,e,i);({densifiedPath:u,distances:d}=mqe(_,v,y)),qe(o),u=On(u,r)}return{densifiedPath:u,pathLength:a*y,distances:d}}function hW(t,e){const i=t/e.densificationMaxSamples;return Math.max(e.samplingDistance,i)}function mW(t,e,i){if(e==null)return fW(t);const r=t.spatialReference,n=e.mode,s=Zk(e,r);let o=null;switch(i.type){case"2d":o=pqe(t,n,s);break;case"3d":o=hqe(t,n,s,i)}return o==null?fW(t):new hn({hasZ:!0,hasM:!1,spatialReference:r,paths:hce(t.paths,o)})}function pqe({hasZ:t},e,i){return e==="absolute-height"?t?([r,n,s])=>[r,n,s+i]:([r,n])=>[r,n,i]:null}function hqe({spatialReference:t,hasZ:e},i,r,{elevationProvider:n}){const s=(o,a,u,d)=>(n==null?void 0:n.getElevation(o,a,u,t,d))??0;switch(i){case"on-the-ground":return([o,a])=>[o,a,s(o,a,0,"ground")];case"absolute-height":return e?([o,a,u])=>[o,a,u+r]:([o,a])=>[o,a,r];case"relative-to-ground":return e?([o,a,u])=>[o,a,u+s(o,a,u,"ground")+r]:([o,a])=>[o,a,s(o,a,0,"ground")+r];case"relative-to-scene":return e?([o,a,u])=>[o,a,u+s(o,a,u,"scene")+r]:([o,a])=>[o,a,s(o,a,0,"scene")+r];default:return null}}function fW(t){return t.hasZ?new hn({hasZ:!1,hasM:!1,spatialReference:t.spatialReference,paths:hce(t.paths,([e,i])=>[e,i])}):t}function hce(t,e){const i=t.length,r=new Array(i);for(let n=0;n<i;++n){const s=t[n],o=s.length,a=new Array(s.length);r[n]=a;for(let u=0;u<o;++u)a[u]=e(s[u])}return r}function $j(t){return LE(t)&&t.paths.length>0&&t.paths.every(e=>e.length>=2)}function LE(t){return t!=null&&t.type==="polyline"}function mce(t,e,i,r,n){const{spatialReference:s,hasZ:o}=t,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:s,metersPerSR:Ci(s)},u=[],d=[];let p=0;for(let h=0;h<t.paths.length;++h){const m=t.paths[h],y=new Array,g=new Array;let v=0;for(let _=1;_<m.length;++_){const w=m[_-1],S=m[_],E=r(a,w,S);let T;for(T=v;T<E.distance&&!Oye(T,E.distance);T+=e)y.push(n(E,T)),g.push((p+T)*i);v=T-E.distance,p+=E.distance,y.push(S),g.push(p*i)}u[h]=y,d[h]=g}return{densifiedPath:new hn({spatialReference:s,hasZ:o,paths:u}),distances:d}}function mqe(t,e,i){const{hasZ:r}=t;return mce(t,e,i,gqe,r?wqe:_qe)}function fqe(t,e,i){const{hasZ:r}=t;return mce(t,e,i,yqe,r?bqe:vqe)}function yqe(t,e,i){return t.distance=0,M_(t,e,i,t.spatialReference),t.from=e,t.to=i,t}function gqe(t,e,i){return t.from=e,t.to=i,t.distance=E_(i,e)*t.metersPerSR,t}function vqe({from:t,azimuth:e,spatialReference:i},r){return op([0,0],t,e,r,i)}function bqe({from:t,to:e,azimuth:i,distance:r,spatialReference:n},s){const o=s/r,a=[0,0,Wh(t[2],e[2],o)];return op(a,t,i,s,n),a}function _qe({from:t,to:e,distance:i},r){return j4([0,0],t,e,r/i)}function wqe({from:t,to:e,distance:i},r){return Uk([0,0,0],t,e,r/i)}function Sqe(t){return x_(t.spatialReference)?t:On(t,le.WGS84)}function fce(t){return t.paths.reduce((e,i)=>e+i.length,0)}function yW(t,e,i){return fce(t)+Math.floor(e/i)+Math.max(0,t.paths.reduce(r=>1+r,0)-1)}function $qe(t,e){const i=t.length;if(i===0)return null;const r=t[0],n=r.sampledZ;let s=n,o=n,a=0,u=0,d=null,p=null,h=n??0,m=0,y=0,g=n!=null?1:0,v=0,_=0;const w=Ci(e),S=fu(e),E=Ka().minSlopeSampleDistance/w,T=2*E,M=new gW,x=new gW,C=()=>{F(),M.copy(x),x.reset()},O=(V,z)=>{C(),V>0&&V-M.start<=T&&(V=M.start+E),x.restart(V,z)},F=()=>{if(M.isHole||x.isHole)return;const V=x.avgElevation-M.avgElevation,z=x.start-M.start,H=V*S,Q=z*w,J=Oe(Math.atan2(H,Q),"radians","degrees");J>0?(m+=J,d=Yd(d,J),v++):J<0&&(y-=J,p=Yd(p,-J),_++)};r.sampledZ!=null&&O(r.distance,r.sampledZ);for(let V=1;V<i;++V){const z=t[V-1],H=t[V],Q=H.sampledZ;if(Q==null){x.isHole||C();continue}g++,h+=Q,s=Ej(s,Q),o=Yd(o,Q),x.isHole||H.distance-x.start>=E?O(H.distance,Q):x.insert(Q);const J=z.sampledZ;if(J!=null){const ne=Q-J;ne>0?a+=ne:ne<0&&(u-=ne)}}return C(),g===0?null:{maxDistance:t[i-1].distance,minElevation:s,maxElevation:o,avgElevation:g===0?null:h/g,elevationGain:a,elevationLoss:u,maxPositiveSlope:d,maxNegativeSlope:p,avgPositiveSlope:v===0?null:m/v,avgNegativeSlope:_===0?null:y/_}}function Eqe(t){const e=t.filter(ot),i=e.length;if(i===0)return null;const r=e[0];if(i===1)return r;let n=r.maxDistance,s=r.minElevation,o=r.maxElevation,a=r.maxPositiveSlope,u=r.maxNegativeSlope;for(let d=1;d<e.length;++d){const p=e[d];n=Yd(n,p.maxDistance),s=Ej(s,p.minElevation),o=Yd(o,p.maxElevation),a=Yd(a,p.maxPositiveSlope),u=Yd(u,p.maxNegativeSlope)}return{maxDistance:n,minElevation:s,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:u,avgPositiveSlope:null,avgNegativeSlope:null}}function Tqe(t){let e=null,i=null,r=null;for(const n of t){if(n==null)continue;const{statistics:s,spatialReference:o}=n;if(s==null)continue;const a=Ci(o);e=Yd(e,CO(s.maxDistance,a));const u=fu(o);r=Ej(r,CO(s.minElevation,u)),i=Yd(i,CO(s.maxElevation,u))}return{minDistance:0,maxDistance:e??0,minElevation:r??0,maxElevation:i??0}}function Ej(t,e){return e==null?t:t!=null?Math.min(t,e):e}function Yd(t,e){return e==null?t:t!=null?Math.max(t,e):e}function CO(t,e){return t!=null&&e!=null?t*e:null}let gW=class{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return this._sampleCount===0}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,i){this._start=e,this._sampleCount=1,this._totalElevation=i}insert(e){++this._sampleCount,this._totalElevation+=e}};function Iqe(t,e,i=[]){if(t>=e||(i.push(t),e-t<2))return i;const r=e-1;i.push(r);const n=zD(t+1,r);for(;;){const s=n.next();if(s.done)break;i.push(s.value)}return i}function*zD(t,e){if(t>=e)return;const i=t+Math.floor((e-t)/2);yield i;const r=zD(t,i),n=zD(i+1,e);for(;;){const s=r.next(),o=n.next();if(s.done&&o.done)break;s.done||(yield s.value),o.done||(yield o.value)}}async function*xqe(t,e){const{view:i,geometry:r,elevationInfo:n,providers:s,options:o}=t,a=i.spatialReference;if(!a||r==null||!$j(r))throw new lb(Za.InvalidGeometry);const u=s.length;if(u===0)return null;const d=Math.round(o.maxTotalSamples/u);if(fce(r)>d)throw new lb(Za.TooComplex);const p=await dqe(r,n,i,a,o,d,e);let h=0;const m=new Array(u),y=new Array(u);for(let _=0;_<u;_++){const w=Oqe(p);m[_]=w,h+=w.samples.length;const S={...t,provider:s[_],result:w,densificationResult:p};y[_]=Mqe(S,e)[Symbol.iterator]()}if(h>o.maxTotalSamples)throw new lb(Za.TooComplex);const g=await Promise.all(y.map(_=>{const w=_.next();return w.done===!0?Promise.resolve(null):w.value}));qe(e);for(let _=0;_<u;_++)m[_]=g[_];yield m,await i_(t.delayAfterPreview??Ka().delayAfterPreviewMillis,null,e.signal);const v=[];try{let _;do{_=!1;for(let w=0;w<u;w++){const S=y[w].next();S.done===!1&&(v.push({resultPromise:S.value,index:w}),_=!0)}}while(_)}finally{y.forEach(_=>{var w;return(w=_.return)==null?void 0:w.call(_)})}for(const{resultPromise:_,index:w}of v)m[w]=await _,qe(e),yield m;for(const _ of m)_!=null&&(_.progress=1);yield m}function*Mqe(t,e){const{densificationResult:i}=t,r={...t,abortOptions:e,densificationResult:i},n=Iqe(0,r.result.samples.length),s=n.slice(0,r.provider.numSamplesForPreview);yield vW(r,s,!0);const o=xde(n,r.provider.numSamplesPerChunk);for(const a of o)yield vW(r,a,!1)}async function vW({densificationResult:t,result:e,provider:i,queue:r,abortOptions:n,cache:s},o,a){const{densifiedPath:u,pathLength:d}=t,p=e.spatialReference,{samples:h}=e,m=[];for(let y=0;y<o.length;y++){const g=h[o[y]];m[y]=g.coordinate}try{return await r.push({geometry:new ep({spatialReference:p,points:m,hasZ:u.hasZ}),provider:i,indices:o,preview:a,result:e,queryOptions:{...Ka().defaultQueryOptions(),minDemResolution:Math.round(a?d/i.numSamplesForPreview:d/h.length),cache:s}},n),{...e}}catch(y){return rr(y)?null:uqe}}function Cqe(t){return new yne({priority:He.ELEVATION_PROFILE,concurrency:1,scheduler:t,process:async e=>{qe(e.queryOptions);try{await kqe(e)}catch(i){NM(i)}}})}async function kqe({geometry:t,provider:e,indices:i,preview:r,result:n,queryOptions:s}){if(i.length===0)return;const o=(await Fqe(e,t,s)).geometry,{hasZ:a,points:u}=o,d=s.noDataValue,{samples:p}=n;for(let h=0;h<i.length;h++){const m=p[i[h]];if(m.isHole)continue;const y=a?u[h][2]:null;y===null||y===d?m.sampledZ=null:(n.hasZ=!0,m.sampledZ=y),m.sampled=!0}Lqe(p),n.progress=r?0:n.progress+i.length/p.length,n.statistics=$qe(n.samples,n.spatialReference)}function Lqe(t){const e=t.length-1;let i=0;for(let r=1;r<=e;r++)(t[r].sampled||r===e)&&(Aqe(t,i,r),i=r)}function Aqe(t,e,i){if(i-e==1)return;const r=t[e],n=r.sampledZ,s=t[i],o=s.sampledZ;if(n==null||o==null){for(let d=e+1;d<i;d++)t[d].sampledZ=null;return}const a=r.distance,u=s.distance-a;for(let d=e+1;d<i;d++){const p=t[d],h=(p.distance-a)/u;p.sampledZ=Wh(n,o,h)}}function Oqe({densifiedPath:t,distances:e}){const i=t.spatialReference,r=Ln(i),n=t.paths,s=n.length,o=[];let a=null,u=0;for(let d=0;d<s;d++){const p=n[d],h=p.length,m=e[d];for(let y=0;y<h;y++){const g=p[y],v=m[y];r&&(g[0]=iK(g[0],r.valid[0],r.valid[1])),a&&y===0&&Rqe(o,a,g,u,v),o.push(Pqe(g,v)),a=g,u=v}}return{progress:0,samples:o,hasZ:!1,statistics:null,spatialReference:i}}function Rqe(t,e,i,r,n){t.push(bW(e,r)),t.push(bW(i,n))}function Pqe(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!1,isHole:!1}}function bW(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!0,isHole:!0}}async function Fqe(t,e,i){try{return await t.queryElevation(e,i)}catch{throw new lb(Za.ElevationQueryError)}}function Nqe(t,e,i){if(!t||t.length===0)return;const r=t.length-1,n=t[0];if(e<=i(n))return n;const s=t[r];if(e>=i(s))return s;let o=0,a=0,u=r;for(;o<u;){a=o+Math.floor((u-o)/2);const d=t[a],p=i(d);if(p===e)return d;if(e<p){if(a>0){const h=t[a-1],m=i(h);if(e>m)return e-m>=p-e?d:h}u=a}else{if(a<r){const h=t[a+1],m=i(h);if(e<m)return e-p>=m-e?h:d}o=a+1}}return t[a]}const _W=Symbol("line-change");let Ah=class extends q{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=lu((i,r,n)=>({stationary:i,visibleProfiles:r,generationParameters:n})),this._getGenerationParametersMemoized=lu((i,r,n,s,o,a,u)=>LE(r)&&$j(r)&&s!=null?{view:i,geometry:r,elevationInfo:n,options:a,queue:s,cache:o,slicePlane:u}:null),this._getElevationInfoMemoized=lu((i,r)=>({mode:i,offset:r})),this._getOptionsMemoized=lu((i,r,n)=>{const{densificationMaxSamples:s,maxTotalSamples:o}=Ka();return{geodesicDistanceThreshold:i,samplingDistance:r,densificationMaxSamples:Math.round(s/n),maxTotalSamples:o}}),this._updateThrottled=Kue(i=>zo(this._update(i)),Ka().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([N(()=>({visible:e.visible,profiles:e.profiles.toArray()}),({visible:i,profiles:r})=>{this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(_W),i&&r.length!==0&&this.addHandles([...r.map(n=>kr([n.attach(this.viewModel),n.on("change",()=>{this._invalidateProfile(n)})])),N(()=>this._updateParameters,this._updateThrottled,gt),this._updateThrottled],_W)},gt)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,i=e.view;return this._getUpdateParametersMemoized(i==null||i.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:i,queue:r,tileCache:n}=this.viewModel;return e!=null&&e.ready?this._getGenerationParametersMemoized(e,i==null?void 0:i.geometry,this._elevationInfo,r,n,this._options,e.type==="3d"?e.slicePlane:null):null}get _elevationInfo(){const e=this.viewModel.input,i=e?nae(e)?null:EU(e):null;return i!=null?this._getElevationInfoMemoized(i.mode,i.offset):null}get _options(){const e=this.viewModel,i=e.visibleProfiles.length;let r=e.minDemResolution??Ka().defaultDemResolution;return r=parseFloat(r.toFixed(2)),this._getOptionsMemoized(e.geodesicDistanceThreshold,r,i)}async _update({stationary:e,visibleProfiles:i,generationParameters:r}){this._abortUpdate(),e&&(r!=null?this._updateTask=Xo(async n=>{this.viewModel.error=null;const s=i.filter(a=>!this._isProfileValid(a,r)),o=xqe({...r,providers:s},{signal:n});try{for await(const a of o){qe(n),this._clearInvalidResults(r);for(let u=0;u<s.length;u++)s[u].result=a[u]}for(const a of s)this._paramsPerProfile.set(a,r)}catch(a){Vo(a),this._abortUpdate(),this.viewModel.error=a,s.forEach(u=>{u.result=null})}}):this._clearResults())}_abortUpdate(){this._updateTask=mr(this._updateTask)}_isProfileValid(e,i){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===i}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const i of this.viewModel.profiles.items)this._isProfileValid(i,e)||(i.result=null,this._paramsPerProfile.delete(i))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};l([c({nonNullable:!0})],Ah.prototype,"viewModel",void 0),l([c()],Ah.prototype,"_updateParameters",null),l([c()],Ah.prototype,"_generationParameters",null),l([c()],Ah.prototype,"_elevationInfo",null),l([c()],Ah.prototype,"_options",null),Ah=l([$("esri.widgets.ElevationProfile.ElevationProfileController")],Ah);function Dqe(t,e){if(t==null||e==null)return null;const{samples:i,spatialReference:r}=t,{distance:n,elevation:s}=e,o=Ci(r),a=fu(r),u=i.length,d=new Array(u);for(let p=0;p<u;++p){const h=i[p],m=h.sampledZ,y=h.coordinate;d[p]={x:y[0],y:y[1],z:m,distance:yce(h.distance,o,n),elevation:g0(m,a,s)}}return d}function Vqe(t,e){if(t==null||e==null||t.statistics==null||t.spatialReference==null)return null;const{distance:i,elevation:r}=e,{statistics:n,spatialReference:s}=t,o=Ci(s),a=fu(s);return{maxDistance:yce(n.maxDistance,o,i),minElevation:g0(n.minElevation,a,r),maxElevation:g0(n.maxElevation,a,r),avgElevation:g0(n.avgElevation,a,r),elevationGain:g0(n.elevationGain,a,r),elevationLoss:g0(n.elevationLoss,a,r),maxPositiveSlope:n.maxPositiveSlope,maxNegativeSlope:n.maxNegativeSlope,avgPositiveSlope:n.avgPositiveSlope,avgNegativeSlope:n.avgNegativeSlope}}function yce(t,e,i){return t==null?null:Oe(t*e,"meters",i)}function g0(t,e,i){return t==null?null:Oe(t*e,"meters",i)}let zi=class extends ji.EventedAccessor{constructor(e){super(e),this.type=null,this.id=Mk(),this.title=null,this.color=new ee("#000000"),this.visible=!0,this._getSamplesMemoized=lu((i,r)=>Dqe(i,r)),this._getStatisticsMemoized=lu((i,r)=>Vqe(i,r)),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return this.result!=null&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var i;const e=(i=this._viewModel)==null?void 0:i.hoveredChartPosition;return e!=null?this._getPoint(e):null}get available(){return!0}get hasZ(){const e=this.result;return e!=null&&e.hasZ}get minDemResolution(){return Ka().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,kr([N(()=>e.effectiveUnits,i=>{this.effectiveUnits=i},gt),N(()=>[e.input],()=>this._onChange(),yn)])}toggleVisibility(e){this.visible=e===void 0?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:i,result:r}=this;if(i==null||r==null)return null;const n=i.length;if(n===0)return null;const s=i[n-1].distance,o=Nqe(i,e*s,p=>p.distance);if(o==null)return null;const{x:a,y:u,z:d}=o;return d==null?null:new we({x:a,y:u,z:d,spatialReference:r.spatialReference})}};l([c({nonNullable:!0})],zi.prototype,"id",void 0),l([c({nonNullable:!0})],zi.prototype,"title",void 0),l([c({type:ee,nonNullable:!0})],zi.prototype,"color",void 0),l([c({nonNullable:!0})],zi.prototype,"visible",void 0),l([c({readOnly:!0})],zi.prototype,"progress",null),l([c({readOnly:!0})],zi.prototype,"samples",null),l([c({readOnly:!0})],zi.prototype,"statistics",null),l([c()],zi.prototype,"hoveredPoint",null),l([c()],zi.prototype,"viewVisualizationEnabled",void 0),l([c()],zi.prototype,"available",null),l([c()],zi.prototype,"result",void 0),l([c()],zi.prototype,"effectiveUnits",void 0),l([c()],zi.prototype,"numSamplesForPreview",void 0),l([c()],zi.prototype,"numSamplesPerChunk",void 0),l([c()],zi.prototype,"chartFillEnabled",void 0),l([c()],zi.prototype,"chartStrokeWidth",void 0),l([c()],zi.prototype,"chartStrokeOffsetY",void 0),l([c({readOnly:!0})],zi.prototype,"hasZ",null),l([c({readOnly:!0})],zi.prototype,"minDemResolution",null),l([c()],zi.prototype,"_viewModel",void 0),zi=l([$("esri.widgets.ElevationProfile.ElevationProfileLine")],zi);const AE=zi;function gce(t){var r;if(t==null)return null;if(t instanceof ZS)return vce(t);const e=t.tileInfo;if(e==null)return null;const i=(r=e.lods)==null?void 0:r.at(-1);return i==null?null:i.resolution*Ci(e.spatialReference)}function vce(t){if(t==null)return null;const e=t.layers.items.map(Uqe).filter(ot);return eZ(e)??null}function Uqe(t){return t&&"tileInfo"in t?gce(t):null}let tc=class extends AE{constructor(e){super(e),this.type="ground",this.color=new ee("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=lu((i,r)=>({ground:i,groundLayers:r}))}get available(){const e=this._ground;return e!=null&&e.layers.some(i=>i.visible)}get minDemResolution(){return vce(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e,i,r;return(r=(i=(e=this._viewModel)==null?void 0:e.view)==null?void 0:i.map)==null?void 0:r.ground}get _groundLayers(){var e,i;return((i=(e=this._ground)==null?void 0:e.layers)==null?void 0:i.toArray())??[]}async queryElevation(e,i){const r=this._queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=r;if(n==null)throw new Error("No ground configured in the view");const s=await n.queryElevation(e,i),o=fu(e.spatialReference),a=fu(n.layers.at(0).spatialReference);if(o!==a){const u=s.geometry;u.points=u.points.map(([d,p,h])=>[d,p,h===i.noDataValue?h:h*a/o])}return s}attach(e){return kr([super.attach(e),N(()=>this._queryElevationDependencies,()=>this._onChange())])}};l([c({type:ee,nonNullable:!0})],tc.prototype,"color",void 0),l([c()],tc.prototype,"viewVisualizationEnabled",void 0),l([c()],tc.prototype,"available",null),l([c({readOnly:!0})],tc.prototype,"minDemResolution",null),l([c()],tc.prototype,"_queryElevationDependencies",null),l([c()],tc.prototype,"_ground",null),l([c()],tc.prototype,"_groundLayers",null),tc=l([$("esri.widgets.ElevationProfile.ElevationProfileLineGround")],tc);const bce=tc,Tj=()=>U.getLogger("esri.layers.support.ElevationSampler");let _ce=class{queryElevation(e){return Gqe(e.clone(),this)}on(){return ye()}projectIfRequired(e,i){return wce(e,i)}},jqe=class extends _ce{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){super(),this.tile=e,this.noDataValue=r;const n=e.tile.extent;this.extent=sK(n,i.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=n;const s=Ci(i.spatialReference),o=i.lodAt(e.tile.level).resolution*s;this.demResolution={min:o,max:o}}contains(e){const i=this.projectIfRequired(e,this.spatialReference);return i!=null&&this.containsAt(i.x,i.y)}containsAt(e,i){return lK(this._aaExtent,e,i)}elevationAt(e,i){if(!this.containsAt(e,i)){const r=this.extent,n=`${r.xmin}, ${r.ymin}, ${r.xmax}, ${r.ymax}`;return Tj().warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e,i)??this.noDataValue}},wW=class extends _ce{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){let n;super(),typeof i=="number"?(this.noDataValue=i,n=null):(n=i,this.noDataValue=r),this.samplers=n?e.map(o=>new jqe(o,n,this.noDataValue)):e;const s=this.samplers[0];if(s){this.extent=s.extent.clone();const{min:o,max:a}=s.demResolution;this.demResolution={min:o,max:a};for(let u=1;u<this.samplers.length;u++){const d=this.samplers[u];this.extent.union(d.extent),this.demResolution.min=Math.min(this.demResolution.min,d.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,d.demResolution.max)}}else this.extent=sK(Cn(),n.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,i){let r,n=!1;for(const s of this.samplers)if(s.containsAt(e,i)&&(n=!0,r=s.elevationAt(e,i),r!==s.noDataValue))return r;return r??(n||Tj().warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler`),this.noDataValue)}};function Gqe(t,e){const i=wce(t,e.spatialReference);if(!i)return null;switch(t.type){case"point":zqe(t,i,e);break;case"polyline":Bqe(t,i,e);break;case"multipoint":Hqe(t,i,e)}return t}function wce(t,e){if(t==null)return null;const i=t.spatialReference;if(i.equals(e))return t;const r=V$(t,e);return r||Tj().error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${e.wkid})`),r}function zqe(t,e,i){t.z=i.elevationAt(e.x,e.y)}function Bqe(t,e,i){fc.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.paths.length;n++){const s=t.paths[n],o=e.paths[n];for(let a=0;a<s.length;a++){const u=s[a],d=o[a];fc.x=d[0],fc.y=d[1],r&&(u[3]=u[2]),u[2]=i.elevationAt(fc.x,fc.y)}}t.hasZ=!0}function Hqe(t,e,i){fc.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.points.length;n++){const s=t.points[n],o=e.points[n];fc.x=o[0],fc.y=o[1],r&&(s[3]=s[2]),s[2]=i.elevationAt(fc.x,fc.y)}t.hasZ=!0}const fc=new we;let qqe=class{constructor(e,i){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(i[2]-i[0]),this.dy=(e.width-1)/(i[3]-i[1]),this.x0=i[0],this.y1=i[3]}},Sce=class{constructor(e,i=null){if(this.tile=e,i!=null&&e!=null){const r=e.extent;this._samplerData=new qqe(i,r)}}get zmin(){return this._samplerData!=null?this._samplerData.data.minValue:0}get zmax(){return this._samplerData!=null?this._samplerData.data.maxValue:0}get hasNoDataValues(){var e;return!!((e=this._samplerData)!=null&&e.data.hasNoDataValues)}sample(e,i){if(this._samplerData==null)return;const{safeWidth:r,data:n,dx:s,dy:o,y1:a,x0:u}=this._samplerData,{width:d,values:p,noDataValue:h}=n,m=SW(o*(a-i),0,r),y=SW(s*(e-u),0,r),g=Math.floor(m),v=Math.floor(y),_=g*d+v,w=_+d,S=p[_],E=p[w],T=p[_+1],M=p[w+1];if(S!==h&&E!==h&&T!==h&&M!==h){const x=y-v,C=S+(T-S)*x;return C+(E+(M-E)*x-C)*(m-g)}}};function SW(t,e,i){return t<e?e:t>i?i:t}let Wqe=class{async queryAll(e,i,r){if(!(e=r!=null&&r.ignoreInvisibleLayers?e.filter(d=>d.visible):e.slice()).length)throw new L("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const n=Qy.fromGeometry(i);let s=!1;r!=null&&r.returnSampleInfo||(s=!0);const o={...xI,...r,returnSampleInfo:!0},a=await this.query(e[e.length-1],n,o),u=await this._queryAllContinue(e,a,o);return u.geometry=u.geometry.export(),s&&delete u.sampleInfo,u}async query(e,i,r){if(!e)throw new L("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||!(i instanceof Qy)&&i.type!=="point"&&i.type!=="multipoint"&&i.type!=="polyline")throw new L("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const n={...xI,...r},s=new Zqe(e,i.spatialReference,n),o=n.signal;return await e.load({signal:o}),await Yqe(s,i,o),await this._selectTiles(s,o),await MI(s,o),i7e(s),r7e(s,o)}async createSampler(e,i,r){if(!e)throw new L("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new L("elevation-query:invalid-extent","Invalid or undefined extent");const n={...xI,...r};return this._createSampler(e,i,n)}async createSamplerAll(e,i,r){if(!(e=r!=null&&r.ignoreInvisibleLayers?e.filter(o=>o.visible):e.slice()).length)throw new L("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new L("elevation-query:invalid-extent","Invalid or undefined extent");const n={...xI,...r,returnSampleInfo:!0},s=await this._createSampler(e[e.length-1],i,n);return this._createSamplerAllContinue(e,i,s,n)}async _createSampler(e,i,r,n){const s=r.signal;await e.load({signal:s});const o=i.spatialReference,a=e.tileInfo.spatialReference;o.equals(a)||(await Ec([{source:o,dest:a}],{signal:s}),i=On(i,a));const u=new Jqe(e,i,r,n);return await this._selectTiles(u,s),await MI(u,s),new wW(u.elevationTiles,u.layer.tileInfo,u.options.noDataValue)}async _createSamplerAllContinue(e,i,r,n){if(e.pop(),!e.length)return r;const s=r.samplers.filter(d=>!d.tile.hasNoDataValues).map(d=>Tve(d.extent)),o=await this._createSampler(e[e.length-1],i,n,s);if(o.samplers.length===0)return r;const a=r.samplers.concat(o.samplers),u=new wW(a,n.noDataValue);return this._createSamplerAllContinue(e,i,u,n)}async _queryAllContinue(e,i,r){const n=e.pop(),s=i.geometry.coordinates,o=i.sampleInfo;$m(o);const a=[],u=[];for(let m=0;m<s.length;m++){const y=o[m];y.demResolution>=0?y.source||(y.source=n):e.length&&(a.push(s[m]),u.push(m))}if(!e.length||a.length===0)return i;const d=i.geometry.clone(a),p=await this.query(e[e.length-1],d,r),h=p.sampleInfo;if(!h)throw new Error("no sampleInfo");return u.forEach((m,y)=>{s[m].z=p.geometry.coordinates[y].z,o[m].demResolution=h[y].demResolution}),this._queryAllContinue(e,i,r)}async _selectTiles(e,i){e.type==="geometry"&&Kqe(e);const r=e.options.demResolution;if(typeof r=="number")Qqe(e,r);else if(r==="finest-contiguous")await this._selectTilesFinestContiguous(e,i);else{if(r!=="auto")throw new L("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${r}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,i)}}async _selectTilesFinestContiguous(e,i){const{tileInfo:r,tilemapCache:n}=e.layer,s=Ij(r,n,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,s,i)}async _selectTilesFinestContiguousAt(e,i,r){const n=e.layer;if(e.selectTilesAtLOD(i),i<0)return;const s=n.tilemapCache,o=e.getTilesToFetch();try{if(s&&!BD(s))await Xa(Promise.all(o.map(a=>s.fetchAvailability(a.level,a.row,a.col,{signal:r}))),r);else if(await MI(e,r),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new L("elevation-query:has-unavailable-tiles")}catch(a){Vo(a),await this._selectTilesFinestContiguousAt(e,i-1,r)}}async _selectTilesAuto(e,i){e7e(e),t7e(e);const r=e.layer.tilemapCache;if(!r||BD(r))return this._selectTilesAutoPrefetchUpsample(e,i);const n=e.getTilesToFetch(),s={},o=n.map(async a=>{const u=new k4(null,0,0,0,Cn()),d=await N$(r.fetchAvailabilityUpsample(a.level,a.row,a.col,u,{signal:i}));d.ok!==!1?a.id!=null&&(s[a.id]=u):Vo(d.error)});await Xa(Promise.all(o),i),e.remapTiles(s)}async _selectTilesAutoPrefetchUpsample(e,i){const r=e.layer.tileInfo;await MI(e,i);let n=!1;e.forEachTileToFetch((s,o)=>{r.upsampleTile(s)?n=!0:o()}),n&&await this._selectTilesAutoPrefetchUpsample(e,i)}},Qy=class xM{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const i=new xM;return i.geometry=this.geometry,i.spatialReference=this.spatialReference,i.coordinates=e||this.coordinates.map(r=>r.clone()),i._exporter=this._exporter,i}async project(e,i){if(this.spatialReference.equals(e))return this.clone();await Ec([{source:this.spatialReference,dest:e}],{signal:i});const r=new ep({spatialReference:this.spatialReference,points:this.coordinates.map(a=>[a.x,a.y])}),n=On(r,e);if(!n)return null;const s=this.coordinates.map((a,u)=>{const d=a.clone(),p=n.points[u];return d.x=p[0],d.y=p[1],d}),o=this.clone(s);return o.spatialReference=e,o}static fromGeometry(e){const i=new xM;if(i.geometry=e,i.spatialReference=e.spatialReference,e instanceof xM)i.coordinates=e.coordinates.map(r=>r.clone()),i._exporter=(r,n)=>{const s=e.clone(r);return s.spatialReference=n,s};else switch(e.type){case"point":{const r=e,{hasZ:n,hasM:s}=r;i.coordinates=n&&s?[new na(r.x,r.y,r.z,r.m)]:n?[new na(r.x,r.y,r.z)]:s?[new na(r.x,r.y,null,r.m)]:[new na(r.x,r.y)],i._exporter=(o,a)=>e.hasM?new we(o[0].x,o[0].y,o[0].z,o[0].m,a):new we(o[0].x,o[0].y,o[0].z,a);break}case"multipoint":{const r=e,{hasZ:n,hasM:s}=r;i.coordinates=n&&s?r.points.map(o=>new na(o[0],o[1],o[2],o[3])):n?r.points.map(o=>new na(o[0],o[1],o[2])):s?r.points.map(o=>new na(o[0],o[1],null,o[2])):r.points.map(o=>new na(o[0],o[1])),i._exporter=(o,a)=>e.hasM?new ep({points:o.map(u=>[u.x,u.y,u.z,u.m]),hasZ:!0,hasM:!0,spatialReference:a}):new ep(o.map(u=>[u.x,u.y,u.z]),a);break}case"polyline":{const r=e,n=[],s=[],{hasZ:o,hasM:a}=e;let u=0;for(const d of r.paths)if(s.push([u,u+d.length]),u+=d.length,o&&a)for(const p of d)n.push(new na(p[0],p[1],p[2],p[3]));else if(o)for(const p of d)n.push(new na(p[0],p[1],p[2]));else if(a)for(const p of d)n.push(new na(p[0],p[1],null,p[2]));else for(const p of d)n.push(new na(p[0],p[1]));i.coordinates=n,i._exporter=(d,p)=>{const h=e.hasM?d.map(y=>[y.x,y.y,y.z??0,y.m??0]):d.map(y=>[y.x,y.y,y.z??0]),m=s.map(y=>h.slice(y[0],y[1]));return new hn({paths:m,hasM:e.hasM,hasZ:!0,spatialReference:p})};break}}return i}},na=class $ce{constructor(e,i,r=null,n=null,s=null,o=null){this.x=e,this.y=i,this.z=r,this.m=n,this.tile=s,this.elevationTile=o}clone(){return new $ce(this.x,this.y,this.z,this.m)}},Ece=class{constructor(e,i){this.layer=e,this.options=i}},Zqe=class extends Ece{constructor(e,i,r){super(e,r),this.outSpatialReference=i,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach(i=>i.tile=null);else{const{tileInfo:i,tilemapCache:r}=this.layer,n=M$(i,r)[e].level;this.geometry.coordinates.forEach(s=>s.tile=i.tileAt(n,s.x,s.y))}}allElevationTilesFetched(){return!this.geometry.coordinates.some(e=>!e.elevationTile)}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){var i;for(const r of this.geometry.coordinates)!r.elevationTile&&((i=r.tile)!=null&&i.id)&&(r.elevationTile=e[r.tile.id])}remapTiles(e){var i;for(const r of this.geometry.coordinates){const n=(i=r.tile)==null?void 0:i.id;r.tile=n?e[n]:null}}getTilesToFetch(){var r;const e={},i=[];for(const n of this.geometry.coordinates){const s=n.tile;if(!s)continue;const o=(r=n.tile)==null?void 0:r.id;n.elevationTile||!o||e[o]||(e[o]=s,i.push(s))}return i}forEachTileToFetch(e){for(const i of this.geometry.coordinates)i.tile&&!i.elevationTile&&e(i.tile,()=>{i.tile=null})}},Jqe=class extends Ece{constructor(e,i,r,n){super(e,r),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=i.clone().intersection(e.fullExtent),this.maskExtents=n}selectTilesAtLOD(e,i){const r=this._maximumLodForRequests(i),n=Math.min(r,e);n<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(n)}_maximumLodForRequests(e){const{tileInfo:i,tilemapCache:r}=this.layer,n=M$(i,r);if(!e)return n.length-1;const s=this.extent;if(s==null)return-1;for(let o=n.length-1;o>=0;o--){const a=n[o],u=a.resolution*i.size[0],d=a.resolution*i.size[1];if(Math.ceil(s.width/u)*Math.ceil(s.height/d)<=e)return o}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const i of this._candidateTiles){const r=i.id&&e[i.id];r&&(this._fetchedCandidates.add(i),this.elevationTiles.push(r))}}remapTiles(e){this._candidateTiles=$W(this._candidateTiles.map(i=>e[i.id]))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,i){const r=this._candidateTiles;this._candidateTiles=[],r.forEach(n=>{if(this._fetchedCandidates.has(n))return void(i&&i(n));let s=!1;e(n,()=>s=!0),s?i&&i(n):this._candidateTiles.push(n)}),this._candidateTiles=$W(this._candidateTiles,i)}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const i=this.extent;if(i==null)return;const{tileInfo:r,tilemapCache:n}=this.layer,s=M$(r,n)[e],o=r.tileAt(s.level,i.xmin,i.ymin),a=o.extent;if(a==null)return;const u=s.resolution*r.size[0],d=s.resolution*r.size[1],p=Math.ceil((i.xmax-a[0])/u),h=Math.ceil((i.ymax-a[1])/d);for(let m=0;m<h;m++)for(let y=0;y<p;y++){const g=new k4(null,o.level,o.row-m,o.col+y);r.updateTileInfo(g),this._tileIsMasked(g)||this._candidateTiles.push(g)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some(i=>e.extent&&ZV(i,e.extent))}};function Ij(t,e,i=0){const r=M$(t,e);let n=r.length-1;if(i>0){const s=i/Ci(t.spatialReference),o=r.findIndex(a=>a.resolution<s);o===0?n=0:o>0&&(n=o-1)}return n}const xI={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};async function Yqe(t,e,i){let r;const n=t.layer.tileInfo.spatialReference;if(e instanceof Qy?r=await e.project(n,i):(await Ec([{source:e.spatialReference,dest:n}],{signal:i}),r=On(e,n)),!r)throw new L("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${e.spatialReference.wkid}' on an elevation service in '${n.wkid}'`);t.geometry=Qy.fromGeometry(r)}function Kqe(t){if(t.layer.fullExtent==null)return;const e=new Sce(null);e.sample=()=>t.options.noDataValue,t.outsideExtentTile=e;const i=t.layer.fullExtent;t.geometry.coordinates.forEach(r=>{const n=r.x,s=r.y;(n<i.xmin||n>i.xmax||s<i.ymin||s>i.ymax)&&(r.elevationTile=e)})}function Xqe(t,e){const{tileInfo:i,tilemapCache:r}=t.layer,n=e/Ci(i.spatialReference),s=M$(i,r);let o=s[0],a=0;for(let u=1;u<s.length;u++){const d=s[u];Math.abs(d.resolution-n)<Math.abs(o.resolution-n)&&(o=d,a=u)}return a}function Qqe(t,e){const i=Xqe(t,e);t.selectTilesAtLOD(i)}function e7e(t){const{tileInfo:e,tilemapCache:i}=t.layer,r=Ij(e,i,t.options.minDemResolution);t.selectTilesAtLOD(r,t.options.maximumAutoTileRequests)}function M$(t,e){const i=t.lods;if(BD(e)){const{effectiveMinLOD:r,effectiveMaxLOD:n}=e;return i.filter(s=>s.level>=r&&s.level<=n)}return i}async function MI(t,e){const i=t.getTilesToFetch(),r={},n=t.options.cache,s=t.options.noDataValue,o=i.map(async a=>{if(a.id==null)return;const u=`${t.layer.uid}:${a.id}:${s}`,d=n!=null?n.get(u):null,p=d??await t.layer.fetchTile(a.level,a.row,a.col,{noDataValue:s,signal:e});n!=null&&n.put(u,p),r[a.id]=new Sce(a,p)});await Xa(Promise.allSettled(o),e),t.populateElevationTiles(r)}function t7e(t){const e=t.layer.tileInfo;let i=0;const r={},n=a=>{a.id!=null&&(a.id in r?r[a.id]++:(r[a.id]=1,i++))},s=a=>{if(a.id==null)return;const u=r[a.id];u===1?(delete r[a.id],i--):r[a.id]=u-1};t.forEachTileToFetch(n,s);let o=!0;for(;o&&(o=!1,t.forEachTileToFetch(a=>{i<=t.options.maximumAutoTileRequests||(s(a),e.upsampleTile(a)&&(o=!0),n(a))},s),o););}function i7e(t){t.geometry.coordinates.forEach(e=>{const i=e.elevationTile;let r=t.options.noDataValue;if(i){const n=i.sample(e.x,e.y);n!=null?r=n:e.elevationTile=null}e.z=r})}function $W(t,e){const i={},r=[];for(const s of t){const o=s.id;o&&!i[o]?(i[o]=s,r.push(s)):e&&e(s)}const n=r.sort((s,o)=>s.level-o.level);return n.filter((s,o)=>{for(let a=0;a<o;a++){const u=n[a].extent;if(u&&s.extent&&ZV(u,s.extent))return e&&e(s),!1}return!0})}async function r7e(t,e){const i=await t.geometry.project(t.outSpatialReference,e);$m(i);const r={geometry:i.export(),noDataValue:t.options.noDataValue};return t.options.returnSampleInfo&&(r.sampleInfo=n7e(t)),t.geometry.coordinates.forEach(n=>{n.tile=null,n.elevationTile=null}),r}function n7e(t){const e=t.layer.tileInfo,i=Ci(e.spatialReference);return t.geometry.coordinates.map(r=>{let n=-1;return r.elevationTile&&r.elevationTile!==t.outsideExtentTile&&(n=e.lodAt(r.elevationTile.tile.level).resolution*i),{demResolution:n}})}function BD(t){return(t==null?void 0:t.tileInfo)!=null}const EW=Object.freeze(Object.defineProperty({__proto__:null,ElevationQuery:Wqe,GeometryDescriptor:Qy,getFinestLodIndex:Ij},Symbol.toStringTag,{value:"Module"}));let Ad=class extends AE{constructor(e){super(e),this.type="input",this.color=new ee("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=lu((i,r,n,s,o)=>i?{elevationInfo:i,visibleLayers:r,view:n,stationary:s,spatialReference:o}:null)}get queryElevationDependencies(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e==null?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){var e;return!((e=this._viewModel)!=null&&e.inputIsSketched)}get _elevationInfo(){var i;const e=(i=this._viewModel)==null?void 0:i.input;return e?EU(e):null}get _visibleLayers(){var e,i,r,n;return((n=(r=(i=(e=this._viewModel)==null?void 0:e.view)==null?void 0:i.map)==null?void 0:r.allLayers)==null?void 0:n.filter(s=>s.visible).toArray())??[]}async queryElevation(e,{noDataValue:i,signal:r}){const n=this.queryElevationDependencies;if(n==null)throw new Error("ElevationProfileLineInput: no dependencies");const{view:s,elevationInfo:o,spatialReference:a}=n;if(o.mode==="on-the-ground"&&s.type==="3d"&&a){const u=await Qy.fromGeometry(e).project(a,r);if(!u)return{geometry:e,noDataValue:i};const d=s.elevationProvider;return u.coordinates.forEach(p=>{p.z=d.getElevation(p.x,p.y,0,a,"ground")??0}),{geometry:u.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const i=()=>this._onChange();return kr([super.attach(e),N(()=>this.queryElevationDependencies,i),St(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};l([c({type:ee,nonNullable:!0})],Ad.prototype,"color",void 0),l([c()],Ad.prototype,"viewVisualizationEnabled",void 0),l([c()],Ad.prototype,"queryElevationDependencies",null),l([c()],Ad.prototype,"available",null),l([c()],Ad.prototype,"_elevationInfo",null),l([c()],Ad.prototype,"_visibleLayers",null),Ad=l([$("esri.widgets.ElevationProfile.ElevationProfileLineInput")],Ad);const s7e=Ad;let Oh=class extends AE{constructor(e){super(e),this.type="query",this.color=new ee("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return gce(this.source)}get available(){const e=this.source;return!!e&&(e.visible==null||e.visible)&&(e.layers==null||e.layers.some(i=>i.visible))}queryElevation(e,i){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,i)}attach(e){return kr([super.attach(e),N(()=>this.source,()=>this._onChange(),yn)])}};l([c({type:ee,nonNullable:!0})],Oh.prototype,"color",void 0),l([c()],Oh.prototype,"viewVisualizationEnabled",void 0),l([c()],Oh.prototype,"source",void 0),l([c({readOnly:!0})],Oh.prototype,"minDemResolution",null),l([c()],Oh.prototype,"available",null),Oh=l([$("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],Oh);const o7e=Oh,a7e="OBJECTID";let Ii=class extends q{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};l([c()],Ii.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),l([c()],Ii.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),l([c()],Ii.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),l([c()],Ii.prototype,"DECONFLICTOR_SHOW_GRID",void 0),l([c()],Ii.prototype,"LABELS_SHOW_BORDER",void 0),l([c()],Ii.prototype,"TEXT_SHOW_BASELINE",void 0),l([c()],Ii.prototype,"TEXT_SHOW_BORDER",void 0),l([c()],Ii.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),l([c()],Ii.prototype,"OVERLAY_SHOW_CENTER",void 0),l([c()],Ii.prototype,"SHOW_POI",void 0),l([c()],Ii.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),l([c()],Ii.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),l([c()],Ii.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),l([c()],Ii.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),l([c()],Ii.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),l([c()],Ii.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),l([c()],Ii.prototype,"I3S_TREE_SHOW_TILES",void 0),l([c()],Ii.prototype,"I3S_SHOW_MODIFICATIONS",void 0),l([c()],Ii.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),l([c()],Ii.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),l([c()],Ii.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),l([c()],Ii.prototype,"LINE_WIREFRAMES",void 0),Ii=l([$("esri.views.3d.support.debugFlags")],Ii);const Qut=new Ii;var Rs,Kb;(function(t){t[t.OBJECT=0]="OBJECT",t[t.HUD=1]="HUD",t[t.TERRAIN=2]="TERRAIN",t[t.OVERLAY=3]="OVERLAY",t[t.I3S=4]="I3S",t[t.PCL=5]="PCL",t[t.LOD=6]="LOD",t[t.VOXEL=7]="VOXEL",t[t.TILES3D=8]="TILES3D"})(Rs||(Rs={}));let l7e=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=Kb.ALL,this.normalRequired=!0,this.excludeLabels=!1}};(function(t){t[t.MIN=0]="MIN",t[t.MINMAX=1]="MINMAX",t[t.ALL=2]="ALL"})(Kb||(Kb={}));let u7e=class{constructor(e,i,r){this.object=e,this.geometryId=i,this.triangleNr=r}};class c7e extends u7e{constructor(e,i,r,n){super(e,i,r),this.center=n!=null?Yr(n):null}}let d7e=class{constructor(e){this.layerUid=e}},Tce=class extends d7e{constructor(e,i){super(e),this.graphicUid=i}};function xp(t){return(t==null?void 0:t.dist)!=null}function p7e(t){return xp(t)&&t.intersector===Rs.OBJECT&&!!t.target}function h7e(t){return xp(t)&&t.intersector===Rs.HUD&&!!t.target&&"center"in t.target&&t.target.center!=null}function m7e(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ice(t,e,i){i*=.5;const r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t}function f7e(t,e){const i=2*Math.acos(e[3]),r=Math.sin(i/2);return r>qi()?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),i}function xj(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=i[0],u=i[1],d=i[2],p=i[3];return t[0]=r*p+o*a+n*d-s*u,t[1]=n*p+o*u+s*a-r*d,t[2]=s*p+o*d+r*u-n*a,t[3]=o*p-r*a-n*u-s*d,t}function y7e(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=r*u+o*a,t[1]=n*u+s*a,t[2]=s*u-n*a,t[3]=o*u-r*a,t}function g7e(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=r*u-s*a,t[1]=n*u+o*a,t[2]=s*u+r*a,t[3]=o*u-n*a,t}function v7e(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=r*u+n*a,t[1]=n*u-r*a,t[2]=s*u+o*a,t[3]=o*u-s*a,t}function b7e(t,e){const i=e[0],r=e[1],n=e[2];return t[0]=i,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),t}function MM(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3];let u,d,p,h,m,y=i[0],g=i[1],v=i[2],_=i[3];return d=n*y+s*g+o*v+a*_,d<0&&(d=-d,y=-y,g=-g,v=-v,_=-_),1-d>qi()?(u=Math.acos(d),p=Math.sin(u),h=Math.sin((1-r)*u)/p,m=Math.sin(r*u)/p):(h=1-r,m=r),t[0]=h*n+m*y,t[1]=h*s+m*g,t[2]=h*o+m*v,t[3]=h*a+m*_,t}function _7e(t){const e=z$,i=e(),r=e(),n=e(),s=Math.sqrt(1-i),o=Math.sqrt(i);return t[0]=s*Math.sin(2*Math.PI*r),t[1]=s*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*n),t[3]=o*Math.cos(2*Math.PI*n),t}function w7e(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i*i+r*r+n*n+s*s,a=o?1/o:0;return t[0]=-i*a,t[1]=-r*a,t[2]=-n*a,t[3]=s*a,t}function Ly(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function xce(t,e){const i=e[0]+e[4]+e[8];let r;if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const s=(n+1)%3,o=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*s+s]-e[3*o+o]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*s+o]-e[3*o+s])*r,t[s]=(e[3*s+n]+e[3*n+s])*r,t[o]=(e[3*o+n]+e[3*n+o])*r}return t}function S7e(t,e,i,r){const n=.5*Math.PI/180;e*=n,i*=n,r*=n;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(i),u=Math.cos(i),d=Math.sin(r),p=Math.cos(r);return t[0]=s*u*p-o*a*d,t[1]=o*a*p+s*u*d,t[2]=o*u*d-s*a*p,t[3]=o*u*p+s*a*d,t}function $7e(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const E7e=n$,Mce=X5,T7e=zee,I7e=xj,x7e=Wee,M7e=t4,C7e=i4,Cce=Q5,k7e=Cce,kce=e4,L7e=kce,Mj=Yee,A7e=Kee,O7e=vk;function R7e(t,e,i){const r=tt(e,i);return r<-.999999?(As(Iu,P7e,e),Ene(Iu)<1e-6&&As(Iu,F7e,e),ls(Iu,Iu),Ice(t,Iu,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(As(Iu,e,i),t[0]=Iu[0],t[1]=Iu[1],t[2]=Iu[2],t[3]=1+r,Mj(t,t))}const Iu=W(),P7e=Lr(1,0,0),F7e=Lr(0,1,0);function N7e(t,e,i,r,n,s){return MM(TW,e,n,s),MM(IW,i,r,s),MM(t,TW,IW,2*s*(1-s)),t}const TW=Tp(),IW=Tp();function D7e(t,e,i,r){const n=V7e;return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=r[0],n[4]=r[1],n[7]=r[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],Mj(t,xce(t,n))}const V7e=C_();Object.freeze(Object.defineProperty({__proto__:null,add:T7e,calculateW:b7e,conjugate:Ly,copy:E7e,dot:M7e,equals:O7e,exactEquals:A7e,fromEuler:S7e,fromMat3:xce,getAxisAngle:f7e,identity:m7e,invert:w7e,len:k7e,length:Cce,lerp:C7e,mul:I7e,multiply:xj,normalize:Mj,random:_7e,rotateX:y7e,rotateY:g7e,rotateZ:v7e,rotationTo:R7e,scale:x7e,set:Mce,setAxes:D7e,setAxisAngle:Ice,slerp:MM,sqlerp:N7e,sqrLen:L7e,squaredLength:kce,str:$7e},Symbol.toStringTag,{value:"Module"}));const U7e=new le(HJ),K1=new le(NC),X1=new le(DC),nct=new le(qJ);function C$(t){const e=xW.get(t);if(e)return e;let i=U7e;if(t)if(t===K1)i=K1;else if(t===X1)i=X1;else{const r=t.wkid,n=t.latestWkid;if(r!=null||n!=null)bb(r)||bb(n)?i=K1:(_b(r)||_b(n))&&(i=X1);else{const s=t.wkt2??t.wkt;if(s){const o=s.toUpperCase();o===j7e?i=K1:o===G7e&&(i=X1)}}}return xW.set(t,i),i}const xW=new Map,j7e=K1.wkt.toUpperCase(),G7e=X1.wkt.toUpperCase();function Lce(t,e,i){const r=Math.sin(t),n=Math.cos(t),s=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-r,a[4]=-s*n,a[8]=o*n,a[12]=0,a[1]=n,a[5]=-s*r,a[9]=o*r,a[13]=0,a[2]=0,a[6]=o,a[10]=s,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function z7e(t,e,i){return Lce(t,e,i),tl(i,i),i}function B7e(t,e,i,r){if(t==null||r==null)return!1;const n=h2(t,C_e),s=h2(r,k_e);if(n===s&&!kO(s)&&(n!==D.UNKNOWN||ci(t,r)))return AY(i,e),!0;if(kO(s)){const a=Nw[n][D.LON_LAT],u=Nw[D.LON_LAT][s];return a!=null&&u!=null&&(a(e,0,jp,0),u(jp,0,Gp,0),Lce(CI*jp[0],CI*jp[1],i),i[12]=Gp[0],i[13]=Gp[1],i[14]=Gp[2],!0)}const o=kO(n);if((s===D.WEB_MERCATOR||s===D.PLATE_CARREE||s===D.WGS84||s===D.CGCS2000)&&(n===D.WGS84||o||n===D.WEB_MERCATOR||n===D.CGCS2000)){const a=Nw[n][D.LON_LAT],u=Nw[D.LON_LAT][s];return a!=null&&u!=null&&(a(e,0,jp,0),u(jp,0,Gp,0),o?z7e(CI*jp[0],CI*jp[1],i):B$(i),i[12]=Gp[0],i[13]=Gp[1],i[14]=Gp[2],!0)}return!1}function kO(t){return t===D.SPHERICAL_ECEF||t===D.SPHERICAL_MARS_PCPF||t===D.SPHERICAL_MOON_PCPF||t===D.WGS84_ECEF}const CI=G$(1),jp=W(),Gp=W();let Cj=class{constructor(e,i,r=i){this.data=e,this.size=i,this.stride=r}};class oct extends Cj{constructor(e,i,r,n=!1,s=r){super(e,r,s),this.indices=i,this.exclusive=n}}const Xb=1e-6,$w=W(),kI=W();function H7e(t,e){const{data:i,size:r}=t,n=i.length/r;if(n<=0)return;const s=new tWe(t);qD($w,s.minProj,s.maxProj),Q1($w,$w,.5),Na(kI,s.maxProj,s.minProj);const o=HD(kI),a=new iWe;a.quality=o,n<14&&(t=new Cj(new Float64Array(s.buffer,112,42),3));const u=W(),d=W(),p=W(),h=W(),m=W(),y=W(),g=W();switch(q7e(s,t,g,u,d,p,h,m,y,a)){case 1:return void LW($w,kI,e);case 2:return void Q7e(t,h,e)}W7e(t,g,u,d,p,h,m,y,a),Ace(t,a.b0,a.b1,a.b2,cb,db);const v=W();Na(v,db,cb),a.quality=HD(v),a.quality<o?Oce(a.b0,a.b1,a.b2,cb,db,v,e):LW($w,kI,e)}function q7e(t,e,i,r,n,s,o,a,u,d){return Z7e(t,r,n),WD(r,n)<Xb?1:(Na(o,r,n),cn(o,o),J7e(e,r,o,s)<Xb?2:(Na(a,n,s),cn(a,a),Na(u,s,r),cn(u,u),Da(i,a,o),cn(i,i),Qf(e,i,o,a,u,d),0))}const Ew=W(),Tw=W(),sa=W(),oa=W(),aa=W(),zp=W(),Bp=W(),Hp=W();function W7e(t,e,i,r,n,s,o,a,u){Y7e(t,e,i,Ew,Tw),Ew[0]!==void 0&&(Na(sa,Ew,i),cn(sa,sa),Na(oa,Ew,r),cn(oa,oa),Na(aa,Ew,n),cn(aa,aa),Da(zp,oa,s),cn(zp,zp),Da(Bp,aa,o),cn(Bp,Bp),Da(Hp,sa,a),cn(Hp,Hp),Qf(t,zp,s,oa,sa,u),Qf(t,Bp,o,aa,oa,u),Qf(t,Hp,a,sa,aa,u)),Tw[0]!==void 0&&(Na(sa,Tw,i),cn(sa,sa),Na(oa,Tw,r),cn(oa,oa),Na(aa,Tw,n),cn(aa,aa),Da(zp,oa,s),cn(zp,zp),Da(Bp,aa,o),cn(Bp,Bp),Da(Hp,sa,a),cn(Hp,Hp),Qf(t,zp,s,oa,sa,u),Qf(t,Bp,o,aa,oa,u),Qf(t,Hp,a,sa,aa,u))}function Z7e(t,e,i){let r=WD(t.maxVert[0],t.minVert[0]),n=0;for(let s=1;s<7;++s){const o=WD(t.maxVert[s],t.minVert[s]);o>r&&(r=o,n=s)}Go(e,t.minVert[n]),Go(i,t.maxVert[n])}const la=[0,0,0];function J7e(t,e,i,r){const{data:n,size:s}=t;let o=Number.NEGATIVE_INFINITY,a=0;for(let u=0;u<n.length;u+=s){la[0]=n[u]-e[0],la[1]=n[u+1]-e[1],la[2]=n[u+2]-e[2];const d=i[0]*la[0]+i[1]*la[1]+i[2]*la[2],p=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],h=la[0]*la[0]+la[1]*la[1]+la[2]*la[2]-d*d/p;h>o&&(o=h,a=u)}return Go(r,n,a),o}const dr=pt();function Y7e(t,e,i,r,n){X7e(t,e,dr,n,r);const s=Pce(i,e);dr[1]-Xb<=s&&(r[0]=void 0),dr[0]+Xb>=s&&(n[0]=void 0)}const MW=W(),CW=W(),kW=W(),ev=W(),tv=W(),LI=W();function Qf(t,e,i,r,n,s){if(Rce(e)<Xb)return;Da(MW,i,e),Da(CW,r,e),Da(kW,n,e),ub(t,e,dr),tv[1]=dr[0],ev[1]=dr[1],LI[1]=ev[1]-tv[1];const o=[i,r,n],a=[MW,CW,kW];for(let u=0;u<3;++u){ub(t,o[u],dr),tv[0]=dr[0],ev[0]=dr[1],ub(t,a[u],dr),tv[2]=dr[0],ev[2]=dr[1],LI[0]=ev[0]-tv[0],LI[2]=ev[2]-tv[2];const d=HD(LI);d<s.quality&&(Go(s.b0,o[u]),Go(s.b1,e),Go(s.b2,a[u]),s.quality=d)}}const K7e=W();function ub(t,e,i){const{data:r,size:n}=t;i[0]=Number.POSITIVE_INFINITY,i[1]=Number.NEGATIVE_INFINITY;for(let s=0;s<r.length;s+=n){const o=r[s]*e[0]+r[s+1]*e[1]+r[s+2]*e[2];i[0]=Math.min(i[0],o),i[1]=Math.max(i[1],o)}}function X7e(t,e,i,r,n){const{data:s,size:o}=t;Go(r,s),Go(n,r),i[0]=Pce(K7e,e),i[1]=i[0];for(let a=o;a<s.length;a+=o){const u=s[a]*e[0]+s[a+1]*e[1]+s[a+2]*e[2];u<i[0]&&(i[0]=u,Go(r,s,a)),u>i[1]&&(i[1]=u,Go(n,s,a))}}function LW(t,e,i){i.center=t,i.halfSize=jt(e,e,.5),i.quaternion=xU}const Wc=W(),iv=W(),Iw=W(),cb=W(),db=W(),AW=W();function Q7e(t,e,i){Go(Wc,e),Math.abs(e[0])>Math.abs(e[1])&&Math.abs(e[0])>Math.abs(e[2])?Wc[0]=0:Math.abs(e[1])>Math.abs(e[2])?Wc[1]=0:Wc[2]=0,Rce(Wc)<Xb&&(Wc[0]=Wc[1]=Wc[2]=1),Da(iv,e,Wc),cn(iv,iv),Da(Iw,e,iv),cn(Iw,Iw),Ace(t,e,iv,Iw,cb,db),Na(AW,db,cb),Oce(e,iv,Iw,cb,db,AW,i)}function Ace(t,e,i,r,n,s){ub(t,e,dr),n[0]=dr[0],s[0]=dr[1],ub(t,i,dr),n[1]=dr[0],s[1]=dr[1],ub(t,r,dr),n[2]=dr[0],s[2]=dr[1]}const Jm=W(),xw=W(),AI=W(),xu=dae(1,0,0,0,1,0,0,0,1),eWe=Tp();function Oce(t,e,i,r,n,s,o){xu[0]=t[0],xu[1]=t[1],xu[2]=t[2],xu[3]=e[0],xu[4]=e[1],xu[5]=e[2],xu[6]=i[0],xu[7]=i[1],xu[8]=i[2],o.quaternion=rWe(eWe,xu),qD(Jm,r,n),Q1(Jm,Jm,.5),Q1(xw,t,Jm[0]),Q1(AI,e,Jm[1]),qD(xw,xw,AI),Q1(AI,i,Jm[2]),o.center=di(xw,xw,AI),o.halfSize=jt(Jm,s,.5)}const vo=7;let tWe=class{constructor(e){this.minVert=new Array(vo),this.maxVert=new Array(vo);const i=64*vo;this.buffer=new ArrayBuffer(i);let r=0;this.minProj=new Float64Array(this.buffer,r,vo),r+=8*vo,this.maxProj=new Float64Array(this.buffer,r,vo),r+=8*vo;for(let u=0;u<vo;++u)this.minVert[u]=new Float64Array(this.buffer,r,3),r+=24;for(let u=0;u<vo;++u)this.maxVert[u]=new Float64Array(this.buffer,r,3),r+=24;for(let u=0;u<vo;++u)this.minProj[u]=Number.POSITIVE_INFINITY,this.maxProj[u]=Number.NEGATIVE_INFINITY;const n=new Array(vo),s=new Array(vo),{data:o,size:a}=e;for(let u=0;u<o.length;u+=a){let d=o[u];d<this.minProj[0]&&(this.minProj[0]=d,n[0]=u),d>this.maxProj[0]&&(this.maxProj[0]=d,s[0]=u),d=o[u+1],d<this.minProj[1]&&(this.minProj[1]=d,n[1]=u),d>this.maxProj[1]&&(this.maxProj[1]=d,s[1]=u),d=o[u+2],d<this.minProj[2]&&(this.minProj[2]=d,n[2]=u),d>this.maxProj[2]&&(this.maxProj[2]=d,s[2]=u),d=o[u]+o[u+1]+o[u+2],d<this.minProj[3]&&(this.minProj[3]=d,n[3]=u),d>this.maxProj[3]&&(this.maxProj[3]=d,s[3]=u),d=o[u]+o[u+1]-o[u+2],d<this.minProj[4]&&(this.minProj[4]=d,n[4]=u),d>this.maxProj[4]&&(this.maxProj[4]=d,s[4]=u),d=o[u]-o[u+1]+o[u+2],d<this.minProj[5]&&(this.minProj[5]=d,n[5]=u),d>this.maxProj[5]&&(this.maxProj[5]=d,s[5]=u),d=o[u]-o[u+1]-o[u+2],d<this.minProj[6]&&(this.minProj[6]=d,n[6]=u),d>this.maxProj[6]&&(this.maxProj[6]=d,s[6]=u)}for(let u=0;u<vo;++u){let d=n[u];Go(this.minVert[u],o,d),d=s[u],Go(this.maxVert[u],o,d)}}},iWe=class{constructor(){this.b0=Lr(1,0,0),this.b1=Lr(0,1,0),this.b2=Lr(0,0,1),this.quality=0}};function HD(t){return t[0]*t[1]+t[0]*t[2]+t[1]*t[2]}function qD(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2]}function Na(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2]}function Q1(t,e,i){t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}function Go(t,e,i=0){t[0]=e[i],t[1]=e[i+1],t[2]=e[i+2]}function Da(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],u=i[2];t[0]=n*u-s*a,t[1]=s*o-r*u,t[2]=r*a-n*o}function cn(t,e){const i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(i>0){const r=1/Math.sqrt(i);t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r}}function Rce(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function WD(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n}function Pce(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function rWe(t,e){const i=e[0]+e[4]+e[8];if(i>0){let r=Math.sqrt(i+1);t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r}else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const n=(r+1)%3,s=(r+2)%3;let o=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*s+s]+1);t[r]=.5*o,o=.5/o,t[3]=(e[3*n+s]-e[3*s+n])*o,t[n]=(e[3*n+r]+e[3*r+n])*o,t[s]=(e[3*s+r]+e[3*r+s])*o}return t}let Fce=class CM{constructor(e=kY,i=mWe,r=xU){this._data=[e[0],e[1],e[2],i[0],i[1],i[2],r[0],r[1],r[2],r[3]]}clone(){const e=new CM;return e._data=this._data.slice(),e}invalidate(){this._data[3]=-1}get isValid(){return this._data[3]>=0}static fromData(e){const i=new CM;return i._data=e.slice(),i}static fromJSON(e){return new CM(e.center,e.halfSize,e.quaternion)}copy(e){this._data=e.data.slice()}get center(){return vt(Re.get(),this._data[0],this._data[1],this._data[2])}get centerX(){return this._data[0]}get centerY(){return this._data[1]}get centerZ(){return this._data[2]}getCenter(e){return e[0]=this._data[0],e[1]=this._data[1],e[2]=this._data[2],e}set center(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2]}setCenter(e,i,r){this._data[0]=e,this._data[1]=i,this._data[2]=r}get halfSize(){return vt(Re.get(),this._data[3],this._data[4],this._data[5])}get halfSizeX(){return this._data[3]}get halfSizeY(){return this._data[4]}get halfSizeZ(){return this._data[5]}getHalfSize(e){return e[0]=this._data[3],e[1]=this._data[4],e[2]=this._data[5],e}set halfSize(e){this._data[3]=e[0],this._data[4]=e[1],this._data[5]=e[2]}get quaternion(){return Mce(hUe.get(),this._data[6],this._data[7],this._data[8],this._data[9])}getQuaternion(e){return e[0]=this._data[6],e[1]=this._data[7],e[2]=this._data[8],e[3]=this._data[9],e}set quaternion(e){this._data[6]=e[0],this._data[7]=e[1],this._data[8]=e[2],this._data[9]=e[3]}get data(){return this._data}getCorners(e){const i=Jt,r=this._data;i[0]=r[6],i[1]=r[7],i[2]=r[8],i[3]=r[9];for(let n=0;n<8;++n){const s=e[n];s[0]=(1&n?-1:1)*r[3],s[1]=(2&n?-1:1)*r[4],s[2]=(4&n?-1:1)*r[5],Do(s,s,i),s[0]+=r[0],s[1]+=r[1],s[2]+=r[2]}}doesIntersectFrustumConservativeApproximation(e){return this.intersectPlane(e[0])<=0&&this.intersectPlane(e[1])<=0&&this.intersectPlane(e[2])<=0&&this.intersectPlane(e[3])<=0&&this.intersectPlane(e[4])<=0&&this.intersectPlane(e[5])<=0}get radius(){const e=this._data[3],i=this._data[4],r=this._data[5];return Math.sqrt(e*e+i*i+r*r)}intersectSphere(e){De[0]=this._data[0]-e[0],De[1]=this._data[1]-e[1],De[2]=this._data[2]-e[2];const i=this.getQuaternion(Wd);return Ly(Jt,i),Do(De,De,Jt),Bb(De,De),Zc[0]=Math.min(De[0],this._data[3]),Zc[1]=Math.min(De[1],this._data[4]),Zc[2]=Math.min(De[2],this._data[5]),kN(Zc,De)<e[3]*e[3]}intersectSphereWithMBS(e,i=this.radius){const r=this._data;De[0]=r[0]-e[0],De[1]=r[1]-e[1],De[2]=r[2]-e[2];const n=e[3],s=n+i;return!(g$(De)>s*s)&&(Jt[0]=-r[6],Jt[1]=-r[7],Jt[2]=-r[8],Jt[3]=r[9],Do(De,De,Jt),Bb(De,De),Zc[0]=Math.min(De[0],r[3]),Zc[1]=Math.min(De[1],r[4]),Zc[2]=Math.min(De[2],r[5]),kN(Zc,De)<n*n)}intersectPlane(e){const i=e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3],r=this.projectedRadius(e);return i>r?1:i<-r?-1:0}intersectRay(e,i,r=0){const n=this._data,s=Jt;s[0]=-n[6],s[1]=-n[7],s[2]=-n[8],s[3]=n[9],De[0]=e[0]-n[0],De[1]=e[1]-n[1],De[2]=e[2]-n[2];const o=Do(De,De,Jt),a=Do(Zc,i,Jt);let u=-1/0,d=1/0;const p=this.getHalfSize(pb);for(let h=0;h<3;h++){const m=o[h],y=a[h],g=p[h]+r;if(Math.abs(y)>1e-6){const v=(g-m)/y,_=(-g-m)/y;u=Math.max(u,Math.min(v,_)),d=Math.min(d,Math.max(v,_))}else if(m>g||m<-g)return!1}return u<=d}projectedArea(e,i,r,n){const s=this.getQuaternion(Wd);Ly(Jt,s),De[0]=e[0]-this._data[0],De[1]=e[1]-this._data[1],De[2]=e[2]-this._data[2],Do(De,De,Jt);const o=this.getHalfSize(pb),a=De[0]<-o[0]?-1:De[0]>o[0]?1:0,u=De[1]<-o[1]?-1:De[1]>o[1]?1:0,d=De[2]<-o[2]?-1:De[2]>o[2]?1:0,p=Math.abs(a)+Math.abs(u)+Math.abs(d);if(p===0)return 1/0;const h=p===1?4:6,m=6*(a+3*u+9*d+13);k2(v0,s),Xre(v0,v0,o);const y=this.getCenter(iu);for(let _=0;_<h;_++){const w=oWe[m+_];vt(De,((1&w)<<1)-1,(2&w)-1,((4&w)>>1)-1),wne(De,De,v0),di(Ym,y,De),Ym[3]=1,r4(Ym,Ym,i);const S=1/Math.max(1e-6,Ym[3]);bl[2*_]=Ym[0]*S,bl[2*_+1]=Ym[1]*S}const g=2*h-2;let v=bl[0]*(bl[3]-bl[g+1])+bl[g]*(bl[1]-bl[g-1]);for(let _=2;_<g;_+=2)v+=bl[_]*(bl[_+3]-bl[_-1]);return Math.abs(v)*r*n*.125}projectedRadius(e){const i=this.getQuaternion(Wd);return Ly(Jt,i),Do(De,e,Jt),Math.abs(De[0]*this._data[3])+Math.abs(De[1]*this._data[4])+Math.abs(De[2]*this._data[5])}minimumDistancePlane(e){return e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3]-this.projectedRadius(e)}maximumDistancePlane(e){return e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3]+this.projectedRadius(e)}toAaBoundingBox(e){const i=this.getQuaternion(Wd),r=k2(v0,i),n=this._data[3]*Math.abs(r[0])+this._data[4]*Math.abs(r[3])+this._data[5]*Math.abs(r[6]),s=this._data[3]*Math.abs(r[1])+this._data[4]*Math.abs(r[4])+this._data[5]*Math.abs(r[7]),o=this._data[3]*Math.abs(r[2])+this._data[4]*Math.abs(r[5])+this._data[5]*Math.abs(r[8]);e[0]=this._data[0]-n,e[1]=this._data[1]-s,e[2]=this._data[2]-o,e[3]=this._data[0]+n,e[4]=this._data[1]+s,e[5]=this._data[2]+o}transform(e,i,r,n=0,s=C$(r),o=C$(i),a=sk(i,o)){if(r===s)i.isGeographic?dWe(this,e,i,n,o):cWe(this,e,i,n,o,a);else if(i.isWGS84&&(r.isWebMercator||mR(r)))lWe(i,this,r,e,n);else if(i.isWebMercator&&mR(r))uWe(i,this,r,e,n);else{const u=this.getCenter(iu);u[2]+=n,Lc(u,i,0,u,r,0),e.center=u,this!==e&&(e.quaternion=this.getQuaternion(Wd),e.halfSize=this.getHalfSize(pb))}}};const Jt=Tp(),Wd=Tp(),nWe=Tp(),De=W(),Zc=W(),Ym=Rc();function sWe(t,e=new Fce){return H7e(t,e),e}const bl=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],oWe=(()=>{const t=new Int8Array(162);let e=0;const i=r=>{for(let n=0;n<r.length;n++)t[e+n]=r[n];e+=6};return i([6,2,3,1,5,4]),i([0,2,3,1,5,4]),i([0,2,3,7,5,4]),i([0,1,3,2,6,4]),i([0,1,3,2,0,0]),i([0,1,5,7,3,2]),i([0,1,3,7,6,4]),i([0,1,3,7,6,2]),i([0,1,5,7,6,2]),i([0,1,5,4,6,2]),i([0,1,5,4,0,0]),i([0,1,3,7,5,4]),i([0,2,6,4,0,0]),i([0,0,0,0,0,0]),i([1,3,7,5,0,0]),i([2,3,7,6,4,0]),i([2,3,7,6,0,0]),i([2,3,1,5,7,6]),i([0,1,5,7,6,2]),i([0,1,5,7,6,4]),i([0,1,3,7,6,4]),i([4,5,7,6,2,0]),i([4,5,7,6,0,0]),i([4,5,1,3,7,6]),i([0,2,3,7,5,4]),i([6,2,3,7,5,4]),i([6,2,3,1,5,4]),t})();function aWe(t,e,i,r,n){const s=t.getQuaternion(Wd);n.quaternion=s,Ly(Jt,s);const o=t.getCenter(iu),a=t.getHalfSize(pb);if(r===mp.Global){Do(Ct,o,Jt),Bb(Xl,Ct),bne(_o,Xl,a),is(_o,Xl,_o);const u=Si(_o);di(_o,Xl,a);const d=Si(_o);if(u<i)n.center=o,vt(Ct,i,i,i),n.halfSize=di(Ct,a,Ct);else{const p=d>0?1+e/d:1,h=u>0?1+i/u:1,m=(h+p)/2,y=(h-p)/2;jt(_o,Xl,y),n.halfSize=ni(_o,_o,a,m),jt(_o,Xl,m),ni(_o,_o,a,y),vne(Ct,Ct),X4(Ct,_o,Ct);const g=t.getQuaternion(nWe);n.center=Do(Ct,Ct,g)}}else{n.center=ni(Ct,o,KS,(i+e)/2);const u=Do(Ct,KS,Jt);Bb(u,u),n.halfSize=ni(Xl,a,u,(i-e)/2)}return n}function lWe(t,e,i,r,n){e.getCenter(iu),iu[2]+=n;const s=C$(i);Lc(iu,t,0,iu,s,0),Nce(s,e,iu,i,r)}function uWe(t,e,i,r,n){e.getCenter(iu),iu[2]+=n,Nce(t,e,iu,i,r)}function Nce(t,e,i,r,n){const s=e.getQuaternion(Wd),o=k2(v0,s),a=e.getHalfSize(pb);for(let u=0;u<8;++u){for(let d=0;d<3;++d)yc[d]=a[d]*(u&1<<d?-1:1);for(let d=0;d<3;++d){let p=i[d];for(let h=0;h<3;++h)p+=yc[h]*o[3*h+d];kM[3*u+d]=p}}Lc(kM,t,0,kM,r,0,8),sWe(pWe,n)}function cWe(t,e,i,r,n=C$(i),s=sk(i,n)){t.getCorners(OW),t.getCenter(yc),yc[2]+=r,B7e(i,yc,bo,n),e.setCenter(bo[12],bo[13],bo[14]);const o=2*Math.sqrt(1+bo[0]+bo[5]+bo[10]);Jt[0]=(bo[6]-bo[9])/o,Jt[1]=(bo[8]-bo[2])/o,Jt[2]=(bo[1]-bo[4])/o,Jt[3]=.25*o;const a=t.getQuaternion(Wd);e.quaternion=xj(Jt,Jt,a),Ly(Jt,Jt),vt(Xl,0,0,0);const u=e.getCenter(hWe);for(const d of OW)d[2]+=r,s(d,0,d,0),is(Ct,d,u),Do(Ct,Ct,Jt),Bb(Ct,Ct),_ne(Xl,Xl,Ct);e.halfSize=Xl}function dWe(t,e,i,r,n=C$(i)){const s=VC(i),o=1+Math.max(0,r)/(s.radius+t.centerZ);t.getCenter(yc),yc[2]+=r,Lc(yc,i,0,yc,n,0),e.center=yc;const a=t.getQuaternion(Wd);e.quaternion=a,Ly(Jt,a),vt(Ct,0,0,1),Do(Ct,Ct,Jt);const u=t.getHalfSize(pb);vt(Ct,u[0]*Math.abs(Ct[0]),u[1]*Math.abs(Ct[1]),u[2]*Math.abs(Ct[2])),jt(Ct,Ct,s.inverseFlattening),di(Ct,u,Ct),e.halfSize=jt(Ct,Ct,o)}const kM=new Array(24),pWe=new Cj(kM,3),yc=W(),iu=W(),hWe=W(),pb=W(),v0=C_(),bo=ou(),OW=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],Ct=W(),Xl=W(),_o=W(),mWe=EY(-1,-1,-1);let fWe=class{constructor(){this._transform=ou(),this._transformInverse=new OI({value:this._transform},JC,ou),this._transformInverseTranspose=new OI(this._transformInverse,tl,ou),this._transformTranspose=new OI({value:this._transform},tl,ou),this._transformInverseRotation=new OI({value:this._transform},Qre,C_)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){$b(this._transform,e)}multiplyTransform(e){qV(this._transform,this._transform,e)}set(e){$b(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,i){this.setTransformMatrix(e),this.multiplyTransform(i),this._invalidateLazyTransforms()}},OI=class{constructor(e,i,r){this._original=e,this._update=i,this._dirty=!0,this._transform=r()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},yWe=class{constructor(e=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=W(),this._tmpMbs=$E(),this._tmpObb=new Fce,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Si(e)}applyToVertex(e,i,r){const n=vt(Dce,e,i,r),s=vt(bWe,e,i,r+this.componentLocalOriginLength),o=this._totalOffset/Si(s);return ni(this._tmpVertex,n,s,o),this._tmpVertex}applyToAabb(e){const i=this.componentLocalOriginLength,r=e[0],n=e[1],s=e[2]+i,o=e[3],a=e[4],u=e[5]+i,d=Math.abs(r),p=Math.abs(n),h=Math.abs(s),m=Math.abs(o),y=Math.abs(a),g=Math.abs(u),v=.5*(1+Math.sign(r*o))*Math.min(d,m),_=.5*(1+Math.sign(n*a))*Math.min(p,y),w=.5*(1+Math.sign(s*u))*Math.min(h,g),S=Math.max(d,m),E=Math.max(p,y),T=Math.max(h,g),M=Math.sqrt(v*v+_*_+w*w),x=Math.sign(d+r),C=Math.sign(p+n),O=Math.sign(h+s),F=Math.sign(m+o),V=Math.sign(y+a),z=Math.sign(g+u),H=this._totalOffset;if(M<H)return e[0]-=(1-x)*H,e[1]-=(1-C)*H,e[2]-=(1-O)*H,e[3]+=F*H,e[4]+=V*H,e[5]+=z*H,e;const Q=H/Math.sqrt(S*S+E*E+T*T),J=H/M,ne=J-Q,Pe=-ne;return e[0]+=r*(x*Pe+J),e[1]+=n*(C*Pe+J),e[2]+=s*(O*Pe+J),e[3]+=o*(F*ne+Q),e[4]+=a*(V*ne+Q),e[5]+=u*(z*ne+Q),e}applyToMbs(e){const i=Si(e),r=this._totalOffset/i;return ni(this._tmpMbs,e,e,r),this._tmpMbs[3]=e[3]+e[3]*this._totalOffset/i,this._tmpMbs}applyToObb(e){return aWe(e,this._totalOffset,this._totalOffset,mp.Global,this._tmpObb),this._tmpObb}};class gWe{constructor(e=0){this.offset=e,this.sphere=$E(),this.tmpVertex=W()}applyToVertex(e,i,r){const n=this.objectTransform.transform,s=vt(Dce,e,i,r),o=Wa(s,s,n),a=this.offset/Si(o);ni(o,o,o,a);const u=this.objectTransform.inverse;return Wa(this.tmpVertex,o,u),this.tmpVertex}applyToMinMax(e,i){const r=this.offset/Si(e);ni(e,e,e,r);const n=this.offset/Si(i);ni(i,i,i,n)}applyToAabb(e){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e){const i=Si(e),r=this.offset/i;return ni(this.sphere,e,e,r),this.sphere[3]=e[3]+e[3]*this.offset/i,this.sphere}}const RW=new gWe;function PW(t){return t!=null?(RW.offset=t,RW):null}new yWe;const vWe="terrain",Dce=W(),bWe=W(),FW=1e-5;let _We=class{constructor(e){this.options=new l7e,this._results=new SWe,this.transform=new fWe,this.tolerance=FW,this.verticalOffset=null,this._ray=Ua(),this._rayEnd=W(),this._rayBeginTransformed=W(),this._rayEndTransformed=W(),this.viewingMode=e??mp.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,i,r){this.resetWithRay(AU(e,i,this._ray),r)}resetWithRay(e,i){this.camera=i,e!==this._ray&&aD(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===mp.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,di(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,i,r,n,s){var a;this.point=i,this.filterPredicate=n,this.tolerance=r??FW;const o=PW(this.verticalOffset);if(e&&e.length>0){const u=s?d=>{s(d)&&this.intersectObject(d)}:d=>{this.intersectObject(d)};for(const d of e){const p=(a=d.getSpatialQueryAccelerator)==null?void 0:a.call(d);p!=null?(o!=null?p.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,u,o):p.forEachAlongRay(this._ray.origin,this._ray.direction,u),this.options.selectionMode&&this.options.hud&&p.forEachDegenerateObject(u)):d.objects.forAll(h=>u(h))}}this.sortResults()}intersectObject(e){const i=e.geometries;if(!i)return;const r=e.effectiveTransformation,n=PW(this.verticalOffset);for(const s of i){if(!s.visible)continue;const{material:o,id:a}=s;if(!o.visible)continue;this.transform.setAndInvalidateLazyTransforms(r,s.transformation),Wa(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Wa(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const u=this.transform.transform;n!=null&&(n.objectTransform=this.transform),o.intersect(s,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(d,p,h,m,y,g)=>{if(d>=0){if(this.filterPredicate!=null&&!this.filterPredicate(this._ray.origin,this._rayEnd,d))return;const v=m?this._results.hud:this._results,_=m?w=>{const S=new c7e(e,a,h,g);w.set(Rs.HUD,S,d,p,IU,y)}:w=>w.set(Rs.OBJECT,{object:e,geometryId:a,triangleNr:h},d,p,u,y);if((v.min.drapedLayerOrder==null||y>=v.min.drapedLayerOrder)&&(v.min.dist==null||d<v.min.dist)&&_(v.min),this.options.store!==Kb.MIN&&(v.max.drapedLayerOrder==null||y<v.max.drapedLayerOrder)&&(v.max.dist==null||d>v.max.dist)&&_(v.max),this.options.store===Kb.ALL)if(m){const w=new ZD(this._ray);_(w),this._results.hud.all.push(w)}else{const w=new hb(this._ray);_(w),this._results.all.push(w)}}})}}sortResults(e=this._results.all){e.sort((i,r)=>i.dist!==r.dist?(i.dist??0)-(r.dist??0):i.drapedLayerOrder!==r.drapedLayerOrder?NW(i.drapedLayerOrder,r.drapedLayerOrder):NW(i.drapedLayerGraphicOrder,r.drapedLayerGraphicOrder))}};function NW(t,e){return(e??-Number.MAX_VALUE)-(t??-Number.MAX_VALUE)}function wWe(t){return new _We(t)}let SWe=class{constructor(){this.min=new hb(Ua()),this.max=new hb(Ua()),this.hud={min:new ZD(Ua()),max:new ZD(Ua()),all:new Array},this.ground=new hb(Ua()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},hb=class{get ray(){return this._ray}get distanceInRenderSpace(){return this.dist!=null?(jt(RI,this.ray.direction,this.dist),Si(RI)):null}getIntersectionPoint(e){return!!xp(this)&&(jt(RI,this.ray.direction,this.dist),di(e,this.ray.origin,RI),!0)}getTransformedNormal(e){return Yt(Mw,this.normal),Mw[3]=0,r4(Mw,Mw,this.transformation),Yt(e,Mw),ls(e,e)}constructor(e){this.intersector=Rs.OBJECT,this.normal=W(),this.transformation=ou(),this._ray=Ua(),this.init(e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Rs.OBJECT,aD(e,this._ray)}set(e,i,r,n,s,o,a){this.intersector=e,this.dist=r,Yt(this.normal,n??KS),$b(this.transformation,s??IU),this.target=i,this.drapedLayerOrder=o,this.drapedLayerGraphicOrder=a}copy(e){aD(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Yt(this.normal,e.normal),$b(this.transformation,e.transformation)}},ZD=class extends hb{constructor(){super(...arguments),this.intersector=Rs.HUD}};function yct(t){return new hb(t)}const RI=W(),Mw=Rc();function $We(t){return xp(t)&&t.intersector===Rs.PCL&&!!t.target}function EWe(t){return xp(t)&&t.intersector===Rs.I3S&&!!t.target}function TWe(t){return xp(t)&&t.intersector===Rs.VOXEL&&!!t.target}function IWe(t){return xp(t)&&t.intersector===Rs.TILES3D&&!!t.target}let gct=class extends Tce{constructor(e,i,r){super(e,i),this.triangleNr=r}};function xWe(t){return xp(t)&&t.intersector===Rs.OVERLAY&&!!t.target}let bct=class extends Tce{constructor(e,i,r,n,s,o){super(e,i),this.layerUid=e,this.graphicUid=i,this.geometryId=r,this.triangleNr=n,this.baseBoundingSphere=s,this.numLodLevels=o}};function MWe(t){return xp(t)&&t.intersector===Rs.LOD&&!!t.target}function CWe(t,e){const i=kWe(t,e);return i!=null&&i.type==="graphic"?i.graphic:null}function kWe(t,e){var i;if(t==null)return null;if(p7e(t)||h7e(t))return DW((i=t.target)==null?void 0:i.object,e);if($We(t)){const r=t.target.createGraphic();return{type:"graphic",graphic:r,layer:r.layer}}if(TWe(t)){const r=t.target.createVoxelGraphic();return{type:"graphic",graphic:r,layer:r.layer}}if(IWe(t)){const r=t.target.createTiles3DGraphic();return{type:"graphic",graphic:r,layer:r.layer}}return xWe(t)||MWe(t)?DW(t.target,e):EWe(t)?LWe(t.target,e):null}function DW(t,e){if((t==null?void 0:t.graphicUid)==null)return null;const i=Vce(t,e);if(i==null)return null;if(i===e.graphics)return e.graphicsView==null||typeof t.graphicUid!="number"?null:e.graphicsView.getHit(t.graphicUid);const r=e.allLayerViews.find(n=>n.layer===i);return!r||r.suspended||t.graphicUid==null?null:"getHit"in r?r.getHit(t.graphicUid):null}function LWe(t,e){const i=Vce(t,e);if(i==null)return null;const r=e.allLayerViews.find(n=>n.layer===i);return r&&!r.suspended&&"getGraphicFromIntersectorTarget"in r?AWe(r.getGraphicFromIntersectorTarget(t)):null}function AWe(t){return t!=null?{type:"graphic",graphic:t,layer:t.layer}:null}function Vce(t,e){return(t==null?void 0:t.layerUid)==null?null:e.graphicsView!=null&&t.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.allLayers.find(i=>i.uid===t.layerUid)}function OWe(t){var n;const e=t.sourceLayer,i=t.layer,r=e&&"objectIdField"in e?e:i&&"objectIdField"in i?i:e;if(r){const s=r.objectIdField??a7e,o=(n=t.attributes)==null?void 0:n[s];if(o)return`o-${r.id}-${o}`}return`u-${t.uid}`}function VW(t,e){const i=JD(t,e.include,Qb.INCLUDE),r=JD(t,e.exclude,Qb.EXCLUDE);return{include:i.layerUids,exclude:r.layerUids,graphics:{include:i.graphicUids,exclude:r.graphicUids},mediaElements:{include:i.mediaElements,exclude:r.mediaElements}}}function JD(t,e,i,r={layerUids:void 0,graphicUids:void 0,mediaElements:void 0}){if(!e)return r;if(e instanceof Li)RWe(r,OWe(e)),i===Qb.INCLUDE&&(t.graphicsView!=null&&e.layer===t?rv(r,t.graphicsView.processor.layer.id):e.layer&&rv(r,e.layer.uid));else if("layer"in e&&"element"in e)PWe(r,e.element),i===Qb.INCLUDE&&rv(r,e.layer.uid);else if(NS(e))for(const n of e)n===t.graphics&&t.graphicsView!=null?rv(r,t.graphicsView.processor.layer.id):n===t.map.ground?rv(r,vWe):JD(t,n,i,r);else"uid"in e&&rv(r,e.uid);return r}function rv(t,e){t.layerUids||(t.layerUids=new Set),t.layerUids.add(e)}function RWe(t,e){t.graphicUids||(t.graphicUids=new Set),t.graphicUids.add(e)}function PWe(t,e){t.mediaElements||(t.mediaElements=new Set),t.mediaElements.add(e)}var Qb;(function(t){t[t.INCLUDE=0]="INCLUDE",t[t.EXCLUDE=1]="EXCLUDE"})(Qb||(Qb={}));const FWe=2e5;let ws=class extends AE{constructor(t){super(t),this.type="view",this.color=new ee("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=lu((e,i,r,n,s,o,a)=>({inputGraphicUid:e!=null?Uce(e):null,visibleLayers:i,maxIntersectionDistance:r,intersectOptions:n,view:s,stationary:o,spatialReference:a})),this._vecA=W(),this._vecB=W(),this._ray=Ua()}get minDemResolution(){var i,r,n;const t=(i=this._viewModel)==null?void 0:i.view;if(t==null||t.type!=="3d")return null;const e=(n=(r=t.pointsOfInterest)==null?void 0:r.focus)==null?void 0:n.worldUnitsPerContentPixel;return e==null?null:e*fu(t.spatialReference)}get queryElevationDependencies(){var e;const t=this._view;return t?this._getQueryElevationDependencies((e=this._viewModel)==null?void 0:e.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,t,t.stationary,t.spatialReference):null}get _visibleLayers(){var t,e,i;return((i=(e=(t=this._view)==null?void 0:t.map)==null?void 0:e.allLayers)==null?void 0:i.filter(r=>r.visible).toArray())??[]}get _intersectOptions(){const t=this._view;if(t==null||t.destroyed)return{};const e=VW(t,{include:this.include,exclude:this.exclude}),i=VW(t,{exclude:this._pointCloudLayers});return e.exclude=oV(e.exclude,i.exclude),e}get _pointCloudLayers(){const t=this._view;return t==null?[]:t.allLayerViews.toArray().filter(e=>{var i;return((i=e.layer)==null?void 0:i.type)==="point-cloud"}).map(e=>e.layer)}get _view(){var e;const t=(e=this._viewModel)==null?void 0:e.view;return t!=null&&t.type==="3d"?t:null}get _maxIntersectionDistance(){const t=this._view;return t!=null&&t.renderCoordsHelper?VC(t.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const t=this._view;if(t==null)return null;const e=wWe(t.state.viewingMode),i=e.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=Kb.ALL,e}async queryElevation(t,{noDataValue:e,signal:i}){const r=this.queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineInput: no dependencies");const n=this._intersector;if(n==null)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:s,view:o,spatialReference:a}=r,u=o.renderCoordsHelper,d=o.sceneIntersectionHelper,p=this._vecA,h=this._vecA,m=this._vecB,y=this._ray;if(!a)return{geometry:t,noDataValue:e};const g=await Qy.fromGeometry(t).project(a,i);if(!g)return{geometry:t,noDataValue:e};const v=g.coordinates,_=v.length;for(let w=0;w<_;++w){const S=v[w];vt(m,S.x,S.y,S.z??0),u.toRenderCoords(m,a,m),u.setAltitude(p,FWe,m);const E=AU(p,m,y);d.computeIntersection(E,n,s,!0);const T=NWe(r,n.results.all);T?(T.getIntersectionPoint(h),u.fromRenderCoords(h,h,a),S.z=h[2]):S.z=e}return{geometry:g.export(),noDataValue:e}}attach(t){const e=()=>this._onChange();return kr([super.attach(t),N(()=>this.queryElevationDependencies,e),St(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e})])}};function NWe({view:t,inputGraphicUid:e,maxIntersectionDistance:i},r){for(const n of r){if(n.distanceInRenderSpace!=null&&n.distanceInRenderSpace>i)continue;const s=CWe(n,t);if(s==null||Uce(s)!==e)return n}return null}function Uce(t){if(t.layer&&"objectIdField"in t.layer){const e=t.attributes[t.layer.objectIdField];if(e)return`o-${t.layer.id}-${e}`}return`u-${t.uid}`}l([c({type:ee,nonNullable:!0})],ws.prototype,"color",void 0),l([c()],ws.prototype,"viewVisualizationEnabled",void 0),l([c()],ws.prototype,"include",void 0),l([c()],ws.prototype,"exclude",void 0),l([c({readOnly:!0})],ws.prototype,"minDemResolution",null),l([c()],ws.prototype,"queryElevationDependencies",null),l([c()],ws.prototype,"_visibleLayers",null),l([c()],ws.prototype,"_intersectOptions",null),l([c()],ws.prototype,"_pointCloudLayers",null),l([c()],ws.prototype,"_view",null),l([c()],ws.prototype,"_maxIntersectionDistance",null),l([c()],ws.prototype,"_intersector",null),ws=l([$("esri.widgets.ElevationProfile.ElevationProfileLineView")],ws);const DWe=ws,VWe={base:AE,key:"type",typeMap:{ground:bce,input:s7e,query:o7e,view:DWe},errorContext:"elevation-profile-line"},UWe=Y.ofType(VWe);var Zt,Ro;function jWe(t){return t==="2d"?new Sp({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new yr({color:[0,0,0,0]})}(function(t){t.Ready="ready",t.Creating="creating",t.Reshaping="reshaping",t.ReshapingDisabled="reshaping-disabled",t.Selecting="selecting",t.Selected="selected"})(Zt||(Zt={})),function(t){t.View="view",t.Main="main",t.Interaction="interaction"}(Ro||(Ro={}));let Oo=class extends q{constructor(t){super(t),this.state=Zt.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles(N(()=>({view:this.tool.viewModel.view,visible:this.tool.visible}),({view:t,visible:e})=>{t!=null&&e?this._attach(t):this._detach()},gt),Ro.View)}destroy(){this._detach()}get canStopCreating(){const t=this._geometry,e=this._shouldRemoveLastPoint?3:2;return LE(t)&&t.paths.length>0&&t.paths[0].length>=e}get _input(){return this.tool.viewModel.input}set _input(t){this.tool.viewModel.input=t}get _geometry(){var t;return(t=this._input)==null?void 0:t.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){}start(t={mode:"sketch"}){if(!this.tool.editable)return;const e=this._view;if(e!=null&&e.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),this._previousInputInfo==null&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),t.mode){case"sketch":this._set("state",Zt.Creating),this._startCreationInteraction();break;case"select":this._set("state",Zt.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=t}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",Zt.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(t){return t!=null&&this._sketchedGraphics.has(t)}_attach(t){this._detach();const e={mode:t.type==="3d"?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new vE({listMode:"hide",internal:!0,elevationInfo:e});const i=jWe(t.type);this._sketchVM=new nL({layer:this._graphicsLayer,view:t,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([Hi(()=>t.ready,()=>{const r=this._pendingStartOptions;r&&this.start(r)},gt),N(()=>[this._input,this._visibleAndEditable],()=>this._update(),gt),N(()=>({map:t.map,graphicsLayer:this._graphicsLayer}),({map:r,graphicsLayer:n})=>{r!=null&&n!=null&&r.add(n),this._update()},gt)],Ro.Main)}_detach(){var i;this.removeHandles(Ro.Main),this._sketchVM=xe(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const t=(i=this._view)==null?void 0:i.map,e=this._graphicsLayer;t!=null&&e!=null&&t.remove(e),this._graphicsLayer=xe(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",Zt.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const t=this._view,e=this._sketchVM;if(t==null||e==null)return;this._shouldRemoveLastPoint=!1;const i=e.on("create",n=>{var o;const s=n.graphic;switch(n.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(s),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(s),((o=n.toolEventInfo)==null?void 0:o.type)==="cursor-update"&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(s)}}),r=()=>{var o;i.remove();const n=this.canStopCreating,s=(o=this._geometry)==null?void 0:o.clone();e.cancel(),this._creationToolPromise=null,s!=null&&n?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new Li({geometry:GWe(s)})):this._input=null};this.removeHandles(Ro.Interaction),this.addHandles(ye(r),Ro.Interaction),this._creationToolPromise=zo(e.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const t=this._view,e=this._sketchVM;if(t==null||e==null)return;const i=e.on("update",s=>{const o=s.graphics[0];switch(s.state){case"complete":this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(o)}}),r=()=>{i.remove(),e.cancel(),this._updateToolPromise=null};this.removeHandles(Ro.Interaction),this.addHandles(ye(r),Ro.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=zo(e.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const t=this._view;if(t==null)return;const e=t.cursor,i=ye(()=>t.cursor=e);t.cursor="crosshair",t.closePopup();let r=null;const n=ye(()=>mr(r)),s=t.on("immediate-click",a=>{a.async(async()=>{mr(r),r=Xo(async u=>{const{results:d}=await t.hitTest(a);qe(u);const p=d.filter(h=>h.type==="graphic").map(h=>h.graphic).find(h=>h.geometry!=null&&h.geometry.type==="polyline");p&&(a.preventDefault(),a.stopPropagation(),this._input=p,this._clearPreviousInput(),this._stopInteractionAndUpdate())}),await r.promise})},yt.TOOL),o=t.on("key-down",a=>{a.key==="Escape"&&this.cancel()});this.removeHandles(Ro.Interaction),this.addHandles([s,o,n,i],Ro.Interaction),t.ready&&t.focus()}_stopInteraction(){this.removeHandles(Ro.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(Ro.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",Zt.Ready),this._update()}_update(){if(this._updateDisabled)return;const t=this.state;if(t!==Zt.Selecting){if(this._visibleAndEditable){if(t===Zt.Creating||t===Zt.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return this._input==null?Zt.Ready:this.isSketchedGraphic(this._input)?this.state===Zt.Creating?Zt.Creating:this._visibleAndEditable?Zt.Reshaping:Zt.ReshapingDisabled:Zt.Selected}_updateVisuals(){switch(this.state){case Zt.Creating:break;case Zt.Reshaping:this._startReshapeInteraction();break;case Zt.ReshapingDisabled:{this._stopInteractionAndUpdate();const t=this._input;t!=null&&this.isSketchedGraphic(t)&&(t.visible=!1);break}case Zt.Ready:case Zt.Selected:this._stopInteractionAndUpdate();case Zt.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(t){this._previousInputInfo={graphic:t}}_restorePreviousInput(){const t=this._previousInputInfo;t!=null&&(this._clearPreviousInput(),this._input=t.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const t=this._graphicsLayer;if(t==null)return;const e=t.graphics,i=this._input;if(i==null||!this.isSketchedGraphic(i))return void e.removeAll();if(e.indexOf(i)===-1)e.removeAll(),e.add(i);else if(e.length!==1){const r=e.filter(n=>n!==i);e.removeMany(r)}}_setSketchedGraphic(t){t!=null&&this._sketchedGraphics.add(t),this._input=t,this._updateSketchedGraphic()}};function GWe(t){if(LE(t)){const e=t.clone();return e.paths=[e.paths[0].slice(0,-1)],e}return t}l([c({nonNullable:!0})],Oo.prototype,"state",void 0),l([c({nonNullable:!0})],Oo.prototype,"tool",void 0),l([c()],Oo.prototype,"canStopCreating",null),l([c()],Oo.prototype,"_graphicsLayer",void 0),l([c()],Oo.prototype,"_sketchVM",void 0),l([c()],Oo.prototype,"_input",null),l([c()],Oo.prototype,"_geometry",null),l([c()],Oo.prototype,"_visibleAndEditable",null),l([c()],Oo.prototype,"_view",null),l([c()],Oo.prototype,"_shouldRemoveLastPoint",void 0),Oo=l([$("esri.widgets.ElevationProfile.ElevationProfileInteraction")],Oo);let LM=class extends q{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles(N(()=>{var e;return{tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!((e=this.tool.viewModel.view)!=null&&e.ready)}},({tool:e,view:i,visible:r})=>{i!=null&&r?this._show(i,e):this._hide()},gt))}destroy(){this._hide()}_show(e,i){this._loadingTask=mr(this._loadingTask),this._loadingTask=Xo(async r=>{if(e.type==="2d"){const n=k(()=>import("./ElevationProfileView2D-CxSf8RhQ.js"),__vite__mapDeps([363,364])),s=(await Xa(n,r)).ElevationProfileView2D;this._implementation=new s(e,i)}else if(e.type==="3d"){const n=k(()=>import("./ElevationProfileView3D-N92bioYZ.js"),__vite__mapDeps([365,364,335,112,55,336,133,118,92,134,132,135,58,136,337,96,57,338,138,139,103,52,53,54,145,116,130,131,59,60,137,152,84])),s=(await Xa(n,r)).ElevationProfileView3D;this._implementation=new s(e,i)}})}_hide(){this._loadingTask=mr(this._loadingTask),this._implementation=xe(this._implementation)}};l([c()],LM.prototype,"tool",void 0),LM=l([$("esri.widgets.ElevationProfile.support.ElevationProfileView")],LM);let Od=class extends q{constructor(t){super(t),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new LM({tool:this}),this.interaction=new Oo({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var e;switch((e=this.interaction)==null?void 0:e.state){case Zt.Ready:return io.Ready;case Zt.Creating:return io.Creating;case Zt.Selecting:return io.Selecting;case Zt.Selected:return io.Selected;case Zt.Reshaping:case Zt.ReshapingDisabled:return io.Created}}};l([c({nonNullable:!0})],Od.prototype,"viewModel",void 0),l([c()],Od.prototype,"view",void 0),l([c()],Od.prototype,"interaction",void 0),l([c()],Od.prototype,"editable",void 0),l([c()],Od.prototype,"visible",void 0),l([c()],Od.prototype,"highlightEnabled",void 0),Od=l([$("esri.widgets.ElevationProfile.ElevationProfileTool")],Od);let ht=class extends q{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=lu((i,r)=>({distance:i,elevation:r})),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new bce,this._userUnitOptions=null,this._userUnit=null,e!=null&&e.profiles||(this.profiles=new Y([this._defaultProfileLineGround]))}initialize(){this.addHandles(N(()=>this.view,e=>{var n;if(e==null)return void U.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(UW);const i=e.type==="3d"?e.resourceController:void 0;(n=this.queue)==null||n.destroy(),this.queue=Cqe(i==null?void 0:i.scheduler);const r=i==null?void 0:i.addUpdatingObject(this);r&&this.addHandles(r,UW)},gt)),this.tool=new Od({viewModel:this}),this._controller=new Ah({viewModel:this})}destroy(){this._defaultProfileLineGround=xe(this._defaultProfileLineGround),this._controller=xe(this._controller),this._currentTileCache=xe(this._currentTileCache),this.tool=xe(this.tool),this.queue=xe(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const i=this._get("profiles"),r=e??new Y;this._set("profiles",up(r,i))}get state(){const e=this.view;return e!=null&&e.ready?this.tool.state:io.Disabled}get progress(){let e=0,i=0;for(const r of this.visibleProfiles)e++,i+=r.progress;return e>0?i/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=Tqe(this.visibleProfiles.map(n=>n.result)),i=hfe(e.maxDistance,"meters",this.unit),r=mfe(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(i,r)}get geodesicDistanceThreshold(){return this._get("geodesicDistanceThreshold")}set geodesicDistanceThreshold(e){Ga(U.getLogger(this),"geodesicDistanceThreshold",{version:"4.29",warnOnce:!0}),this._set("geodesicDistanceThreshold",e)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){var i;const e=(i=this.input)==null?void 0:i.geometry;return LE(e)&&e.paths.reduce((r,n)=>r+n.length,0)>0}get hoveredPoints(){return this.input!=null&&this.visible&&this.tool.editable?this.visibleProfiles.map(e=>{const i=e.hoveredPoint;return i!=null?{hoveredPoint:i,color:e.color}:null}).filter(ot):[]}get statistics(){return Eqe(this.visibleProfiles.map(e=>e.statistics))}get chartData(){if(this.input==null)return null;const{effectiveUnits:e,progress:i,statistics:r,visibleProfiles:n,uniformChartScaling:s}=this,o=n.filter(a=>a.hasZ).map(a=>({id:a.id,type:a.type,title:a.title,color:a.color,samples:a.samples,progress:a.progress,chartFillEnabled:a.chartFillEnabled,chartStrokeWidth:a.chartStrokeWidth,chartStrokeOffsetY:a.chartStrokeOffsetY,viewVisualizationEnabled:a.viewVisualizationEnabled}));return o.length===0?null:{lines:o,effectiveUnits:e,statistics:r,refined:i===1,dynamicElevationRange:n.some(a=>a.type==="view"),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter(e=>e.available&&e.visible)}get minDemResolutions(){const e=[];for(const{minDemResolution:i}of this.visibleProfiles)i!=null&&e.push(i);return e}get minDemResolution(){return eZ(this.minDemResolutions)}get errorState(){var i;const e=(i=this.input)==null?void 0:i.geometry;if(!$j(e))return Ir.NoValidInput;if(this.error!=null){if(cqe(this.error))switch(this.error.cause){case Za.TooComplex:return Ir.TooComplex;case Za.InvalidGeometry:return Ir.InvalidGeometry;case Za.InvalidElevationInfo:return Ir.InvalidElevationInfo;case Za.ElevationQueryError:return Ir.NoValidInput}return Ir.UnknownError}return this.visibleProfiles.length===0?Ir.NoVisibleProfiles:this.chartData==null&&this.progress===1?Ir.RefinedButNoChartData:Ir.None}get tileCache(){var i;this._currentTileCache=xe(this._currentTileCache);const e=this.view;if(e!=null&&(e==null?void 0:e.type)==="3d"){const r=(i=e.basemapTerrain)==null?void 0:i.elevationQueryCache;if(r!=null)return r}return this._currentTileCache==null&&(this._currentTileCache=new kHe(new K5(20*_$.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get selectAvailable(){var e,i,r,n;for(const s of((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers)??[])if(s.type==="graphics"&&!s.internal&&s.graphics.some(o=>{var a;return((a=o.geometry)==null?void 0:a.type)==="polyline"})||"geometryType"in s&&s.geometryType==="polyline")return!0;return!!((n=(r=this.view)==null?void 0:r.graphics)!=null&&n.some(s=>{var o;return((o=s.geometry)==null?void 0:o.type)==="polyline"}))}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return e!=null&&e.type==="3d"?e.elevationProvider:null}get updating(){var r;const{progress:e}=this,i=!!((r=this.queue)!=null&&r.updating);return e>0&&e<1||i}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,i){const r=this.unitOptions;return e!=null&&r.includes(e)?e:i?this._findSelectableUnit(i):r[0]}_filteredOrAllUnits(e){const i=(e??[]).filter(r=>n2.includes(r));return i.length===0?n2.slice():i}};l([c()],ht.prototype,"view",void 0),l([c({type:Li})],ht.prototype,"input",void 0),l([c({type:UWe,nonNullable:!0})],ht.prototype,"profiles",null),l([c({readOnly:!0})],ht.prototype,"state",null),l([c({readOnly:!0})],ht.prototype,"progress",null),l([c()],ht.prototype,"unitOptions",null),l([c()],ht.prototype,"unit",null),l([c({readOnly:!0})],ht.prototype,"effectiveUnits",null),l([c()],ht.prototype,"geodesicDistanceThreshold",null),l([c()],ht.prototype,"hoveredChartPosition",void 0),l([c()],ht.prototype,"uniformChartScaling",void 0),l([c()],ht.prototype,"highlightEnabled",null),l([c({readOnly:!0})],ht.prototype,"hoveredPoints",null),l([c({readOnly:!0})],ht.prototype,"statistics",null),l([c()],ht.prototype,"chartData",null),l([c()],ht.prototype,"visibleProfiles",null),l([c()],ht.prototype,"minDemResolutions",null),l([c({readOnly:!0})],ht.prototype,"minDemResolution",null),l([c({readOnly:!0})],ht.prototype,"errorState",null),l([c(Jue)],ht.prototype,"defaultUnit",void 0),l([c()],ht.prototype,"queue",void 0),l([c()],ht.prototype,"tileCache",null),l([c()],ht.prototype,"tool",void 0),l([c()],ht.prototype,"visible",null),l([c()],ht.prototype,"error",void 0),l([c()],ht.prototype,"selectAvailable",null),l([c()],ht.prototype,"inputIsSketched",null),l([c()],ht.prototype,"elevationProvider",null),l([c()],ht.prototype,"updating",null),l([c()],ht.prototype,"_defaultProfileLineGround",void 0),l([c()],ht.prototype,"_userUnitOptions",void 0),l([c()],ht.prototype,"_controller",void 0),l([c()],ht.prototype,"_userUnit",void 0),ht=l([$("esri.widgets.ElevationProfile.ElevationProfileViewModel")],ht);const UW=Symbol("updating-object"),jce=ht;let Hl=class extends q{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};l([c()],Hl.prototype,"legend",void 0),l([c()],Hl.prototype,"chart",void 0),l([c()],Hl.prototype,"clearButton",void 0),l([c()],Hl.prototype,"settingsButton",void 0),l([c()],Hl.prototype,"sketchButton",void 0),l([c()],Hl.prototype,"selectButton",void 0),l([c()],Hl.prototype,"unitSelector",void 0),l([c()],Hl.prototype,"uniformChartScalingToggle",void 0),Hl=l([$("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],Hl);const Gce=Hl,zWe=100;let ey=class extends $t{constructor(t,e){super(t,e),this._updateLayout=i=>{const r=i.parentElement,n=i.style.display;r==null||r.removeChild(i),document.body.appendChild(i),i.style.display="block";let s=80;for(const o of i.childNodes)o instanceof HTMLElement&&(s=Math.max(s,o.offsetWidth));document.body.removeChild(i),r==null||r.appendChild(i),i.style.display=n,i.style.setProperty("--max-width",`${s}px`)},this._updateLayoutThrottled=Kue(this._updateLayout,zWe)}loadDependencies(){return Gt({icon:()=>k(()=>import("./calcite-icon-Dy-uICJg.js"),__vite__mapDeps([246,244,235,242]))})}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return b("div",{afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled,bind:this,class:Sw.base},this._renderStatistics())}_renderStatistics(){var e;const t=(e=this._messages)==null?void 0:e.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(t,e){const i=Ka().formatPrecision,r=this._renderValue(t,n=>{const s=this.effectiveUnits.distance;return wm(this._messagesUnits,n,s,i)});return this._renderStatistic(e,r)}_renderElevationStatistic(t,e){const i=Ka().formatPrecision,r=this._renderValue(t,n=>{const s=this.effectiveUnits.elevation;return wm(this._messagesUnits,n,s,i)});return this._renderStatistic(e,r)}_renderSlopeStatistic(t,e,i){const r=Ka().formatPrecision,n=b("div",{class:Sw.slopeValue,key:"slope-up"},b("calcite-icon",{icon:"arrow-up",scale:"s"}),this._renderValue(t,s=>nq(s,"degrees","geographic","geographic",r)),b("calcite-icon",{icon:"arrow-down",scale:"s"}),this._renderValue(e,s=>nq(s,"degrees","geographic","geographic",r)));return this._renderStatistic(i,n)}_renderStatistic(t,e){return b("div",{class:Sw.statistic},b("label",{class:Sw.statisticLabel},t),b("div",{class:Sw.statisticValue},e))}_renderValue(t,e){const i=this.line,r=i.progress===1?i.statistics:null,n=r==null?void 0:r[t];return n!=null?e(n):lqe}};l([c()],ey.prototype,"effectiveUnits",void 0),l([c()],ey.prototype,"line",void 0),l([c(),Ue("esri/widgets/ElevationProfile/t9n/ElevationProfile")],ey.prototype,"_messages",void 0),l([c(),Ue("esri/core/t9n/Units")],ey.prototype,"_messagesUnits",void 0),ey=l([$("esri.widgets.ElevationProfile.components.Statistics")],ey);function jW(t,{profiles:e}){const i=t.title;if(i!=null)return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}let ql=class extends $t{constructor(t,e){super(t,e),this.checkboxVisible=!0,this.expanded=!1}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),checkbox:()=>k(()=>import("./calcite-checkbox-D7cySzqb.js"),__vite__mapDeps([352,235,234,236,241,237,238,239])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),tooltip:()=>k(()=>import("./calcite-tooltip-DHysjdJv.js"),__vite__mapDeps([351,235,259,260,262,264]))})}initialize(){this._statistics=new ey(this._statisticsProps),this.addHandles(N(()=>this._statisticsProps,t=>this._statistics.set(t)))}destroy(){this._statistics=xe(this._statistics)}render(){const t=this.expanded;return b("div",{class:this.classes(qc.base,{[qc.disabled]:this.disabled,[qc.expanded]:t}),key:this},this._renderColorIndicator(),b("div",{class:qc.header,key:"header"},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),t?b("div",{class:qc.content,key:"content"},this._statistics.render()):null)}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return b("div",{class:qc.colorIndicator,key:"color-indicator",styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const{expanded:t,messages:e}=this,i=t?e.hideDetails:e.showDetails;return b("calcite-action",{appearance:"transparent",bind:this,class:qc.collapseToggle,"data-testid":"legend-toggle",icon:t?"chevron-up":"chevron-down",key:"collapse-toggle",onclick:this._onCollapseToggleClick,scale:"s",text:i,title:i})}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:t,checkboxVisible:e,disabled:i,messages:r}=this,n=`label-${t.id}`;return b("calcite-label",{class:qc.label,disabled:i,key:n,layout:"inline"},e?this._renderCheckbox(t.id):null,jW(t,r))}_renderCheckbox(t){const{disabled:e,line:i,messages:r}=this,n=i.visible,s=`${t}-checkbox`,o=n?r.hideProfile:r.showProfile,a=Wr(o,{name:jW(i,r)});return b(lm,null,b("calcite-checkbox",{checked:n,class:qc.checkbox,disabled:e,id:s,key:"checkbox",onCalciteCheckboxChange:()=>i.toggleVisibility()}),b("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:s},a))}};l([c()],ql.prototype,"checkboxVisible",void 0),l([c()],ql.prototype,"disabled",null),l([c({nonNullable:!0})],ql.prototype,"effectiveUnits",void 0),l([c()],ql.prototype,"expanded",void 0),l([c({nonNullable:!0})],ql.prototype,"line",void 0),l([c()],ql.prototype,"messages",void 0),l([c()],ql.prototype,"onExpandedToggle",void 0),l([c()],ql.prototype,"_statistics",void 0),ql=l([$("esri.widgets.ElevationProfile.components.LegendItem")],ql);let ty=class extends $t{constructor(){super(...arguments),this._expandedLine=null}render(){const{profiles:e,messages:i,effectiveUnits:r,_expandedLine:n}=this;return b("div",{class:CHe.base},e.map(s=>b(ql,{checkboxVisible:e.length>1,effectiveUnits:r,expanded:s===n,line:s,messages:i,onExpandedToggle:()=>this._onExpandedToggle(s)})))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e}};l([c()],ty.prototype,"effectiveUnits",void 0),l([c()],ty.prototype,"messages",void 0),l([c()],ty.prototype,"profiles",void 0),l([c()],ty.prototype,"_expandedLine",void 0),ty=l([$("esri.widgets.ElevationProfile.components.Legend")],ty);const LO="esri-unit-select",AO={base:LO,label:`${LO}__label`,select:`${LO}__select`};let Rh=class extends $t{constructor(t,e){super(t,e),this._onSelectChange=i=>{this.onChange(i.target.value)}}loadDependencies(){return Gt({label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),option:()=>k(()=>import("./calcite-option-DtIKFu1I.js"),__vite__mapDeps([366,242])),select:()=>k(()=>import("./calcite-select-DcusL6Ql.js"),__vite__mapDeps([367,235,234,236,237,238,239,242,268,244,270]))})}render(){const{messages:t,options:e,selectLabel:i,value:r,_onSelectChange:n}=this;return b("div",{class:AO.base,key:"units"},b("calcite-label",{class:AO.label},i,b("calcite-select",{class:AO.select,label:i,onCalciteSelectChange:n},e.map(s=>{var o;return b("calcite-option",{key:s,selected:s===r,value:s},dfe(s)?t.systems[s]:(o=t.units[s])==null?void 0:o.pluralCapitalized)}))))}};l([c()],Rh.prototype,"options",void 0),l([c()],Rh.prototype,"onChange",void 0),l([c()],Rh.prototype,"selectLabel",void 0),l([c()],Rh.prototype,"value",void 0),l([c(),Ue("esri/core/t9n/Units")],Rh.prototype,"messages",void 0),Rh=l([$("esri.widgets.support.UnitSelect")],Rh);let La=class extends $t{constructor(){super(...arguments),this.messages=null,this._popover=null,this._popoverIsOpen=!1,this._onPopoverAfterCreate=t=>{this._popover=t},this._onUniformChartScalingChange=t=>{this.onUniformChartScalingChange(t.target.checked)}}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),checkbox:()=>k(()=>import("./calcite-checkbox-D7cySzqb.js"),__vite__mapDeps([352,235,234,236,241,237,238,239])),label:()=>k(()=>import("./calcite-label-B30aR4Rh.js"),__vite__mapDeps([273,237,235,238])),popover:()=>k(()=>import("./calcite-popover-Bvialn6r.js"),__vite__mapDeps([292,258,259,235,260,261,262,263,240,241,242,243,239,264,238,248,236,244,245])),tooltip:()=>k(()=>import("./calcite-tooltip-DHysjdJv.js"),__vite__mapDeps([351,235,259,260,262,264]))})}initialize(){const t=()=>this._popover;this.addHandles([St(t,"calcitePopoverOpen",()=>this._popoverIsOpen=!0),St(t,"calcitePopoverClose",()=>this._popoverIsOpen=!1)])}render(){const{id:t,messages:e,visibleElements:i}=this,{unitSelector:r,uniformChartScalingToggle:n}=i;if(!e||!r&&!n)return b("div",{key:`${t}-empty`});const s=`${t}__action`,o=this._popoverIsOpen?e.hideSettings:e.showSettings;return b("div",{class:II.base,key:this},b("calcite-popover",{afterCreate:this._onPopoverAfterCreate,autoClose:!0,label:o,overlayPositioning:"fixed",placement:"bottom-end",referenceElement:s},this._renderPopoverContent()),b("calcite-action",{appearance:"transparent","data-testid":"settings-button",icon:"gear",id:s,scale:"s",text:o,title:o}))}_renderPopoverContent(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;return b("div",{class:II.popoverContent},t?this._renderUnitSelector():null,e?this._renderUniformChartScalingToggle():null)}_renderUnitSelector(){const{messages:t}=this;return b(Rh,{key:"unit-selector-label",options:this.unitOptions,selectLabel:(t==null?void 0:t.unitSelectLabel)??"",value:this.unit,onChange:this.onUnitChange})}_renderUniformChartScalingToggle(){const{messages:t}=this,e=this.uniformChartScaling,i=`${this.id}__uniform-chart-scaling-toggle`,r=(t==null?void 0:t[e?"uniformChartScalingDisable":"uniformChartScalingEnable"])??"";return b("calcite-label",{class:II.uniformChartScalingLabel,key:"uniform-chart-scaling-label",layout:"inline"},b("calcite-checkbox",{checked:e,class:II.uniformChartScalingCheckbox,id:i,onCalciteCheckboxChange:this._onUniformChartScalingChange}),b("calcite-tooltip",{overlayPositioning:"fixed",referenceElement:i},r),t==null?void 0:t.uniformChartScalingLabel)}};l([c()],La.prototype,"messages",void 0),l([c()],La.prototype,"onUniformChartScalingChange",void 0),l([c()],La.prototype,"onUnitChange",void 0),l([c()],La.prototype,"uniformChartScaling",void 0),l([c()],La.prototype,"unit",void 0),l([c()],La.prototype,"unitOptions",void 0),l([c()],La.prototype,"visibleElements",void 0),l([c()],La.prototype,"_popover",void 0),l([c()],La.prototype,"_popoverIsOpen",void 0),La=l([$("esri.widgets.ElevationProfile.components.SettingsButton")],La);var Ks;(function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"})(Ks||(Ks={}));const Cw=[{type:Ks.Select},{type:Ks.Sketch}],BWe={[Ir.None]:null,[Ir.NoValidInput]:"noProfile",[Ir.NoVisibleProfiles]:"noProfile",[Ir.RefinedButNoChartData]:"noProfile",[Ir.TooComplex]:"tooComplex",[Ir.UnknownError]:"unknown",[Ir.InvalidGeometry]:"invalidGeometry",[Ir.InvalidElevationInfo]:"invalidElevationInfo"},OO=Symbol("resize-observer-handle");let Wt=class extends $t{constructor(t,e){super(t,e),this.viewModel=null,this.visibleElements=new Gce,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._contentWrapper=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=lu((i,r,n,s)=>({chart:i,data:r,stationary:n,messages:s})),this._onZoomOutButtonClick=()=>{var i;(i=this._chart)==null||i.zoomOut()},this._onClearButtonClick=()=>{this.viewModel.clear()},t!=null&&t.viewModel||(this._defaultViewModel=new jce({view:t==null?void 0:t.view}),this.viewModel=this._defaultViewModel)}loadDependencies(){return Gt({action:()=>k(()=>import("./calcite-action-DS3OQO0H.js"),__vite__mapDeps([247,248,235,236,239,240,241,242,238,243,244,245])),button:()=>k(()=>import("./calcite-button-EcJw6lo6.js"),__vite__mapDeps([232,233,234,235,236,237,238,239,240,241,242,243,244,245])),loader:()=>k(()=>import("./calcite-loader-QhHZunGs.js"),__vite__mapDeps([280,245,235,240,241,242]))})}postInitialize(){this.addHandles([N(()=>({container:this._chartContainer,width:this._width}),({container:t,width:e})=>{this._destroyChart(),t!=null&&e>0&&this._initializeChart(t)},be),N(()=>this._chartUpdateParams,()=>this._updateChart(this._chartUpdateParams),be)])}destroy(){this._destroyChart(),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get input(){return this.viewModel.input}set input(t){this.viewModel.input=t}get profiles(){return this.viewModel.profiles}set profiles(t){this.viewModel.profiles=t}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(t){this.viewModel.unitOptions=t}get unit(){return this.viewModel.unit}set unit(t){this.viewModel.unit=t}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(t){this.viewModel.geodesicDistanceThreshold=t}get icon(){return"altitude"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}get _portrait(){return this._width<Ka().portraitModePixelBreakpoint}get _selectButtonVisible(){return this.visibleElements.selectButton===!0&&this.viewModel.selectAvailable}get _chartUpdateParams(){const t=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,t==null||t.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _profilesArray(){return this.profiles.toArray()}render(){const{viewModel:t,visible:e}=this;return b("div",{"aria-label":this.messages.widgetLabel,class:this.classes({[or.base]:e,[K.widget]:e,[K.panel]:e,[K.widgetDisabled]:e&&t.state==="disabled",[or.portrait]:this._portrait,[or.refined]:t.progress===1}),key:this},b("div",{afterCreate:this._onContentWrapperUpdate,afterRemoved:this._onContentWrapperRemoved,afterUpdate:this._onContentWrapperUpdate,bind:this,key:"content-wrapper"},e?this._renderContentForState():null))}_renderContentForState(){switch(this.viewModel.state){case io.Ready:return this._renderContentForReadyState();case io.Selecting:return this._renderContentForSelectingState();case io.Creating:return this._renderContentForCreatingState();case io.Selected:return this._renderContentForSelectedState();case io.Created:return this._renderContentForCreatedState();case io.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var s;const{messages:t,visibleElements:e,_selectButtonVisible:i}=this,{sketchButton:r}=e;let n;return n=r&&i?t.readyPrompt:r?t.readyPromptCreateOnly:i?t.readyPromptSelectOnly:(s=t.errors)==null?void 0:s.noProfile,this._renderContent({prompt:n,chart:!1,actions:Cw})}_renderContentForSelectingState(){const{view:t}=this;if(t==null)return null;const e=this.messages[`selectingPrompt-${t.type}`];return this._renderContent({prompt:e,chart:!1,actions:[{type:Ks.SelectCancel}]})}_renderContentForCreatingState(){const{view:t,viewModel:e}=this;if(t==null)return null;const i=e.hasVertices?[{type:Ks.SketchCancel},{type:Ks.SketchDone,disabled:!e.tool.interaction.canStopCreating}]:[{type:Ks.Select},{type:Ks.Sketch,disabled:!0}];if(e.errorState===Ir.NoValidInput){const n=this.messages[`creatingPrompt-${t.type}`];return this._renderContent({chart:!1,actions:i,prompt:n})}const r=this._getErrorMessage();return r?this._renderContent({chart:!1,actions:i,prompt:r}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Cw,prompt:t}):this._renderContent({chart:!0,actions:Cw})}_renderContentForCreatedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Cw,prompt:t}):this._renderContent({chart:!0,actions:Cw})}_getErrorMessage(){var e,i;const t=BWe[this.viewModel.errorState];return t?(i=(e=this.messages)==null?void 0:e.errors)==null?void 0:i[t]:null}_renderContent(t){const e=t.prompt!=null?this._renderPrompt(t.prompt):t.chart&&this._renderChart(),{viewModel:i}=this,r=i.input!=null;return b(lm,null,b("header",{class:or.header,key:"header"},this._zoomOutButtonVisible?this._renderZoomOutButton():null,this.visibleElements.clearButton&&r?this._renderClearButton():null,this.visibleElements.settingsButton?b(La,{messages:this.messages,uniformChartScaling:i.uniformChartScaling,unit:i.unit,unitOptions:i.unitOptions,visibleElements:this.visibleElements,onUniformChartScalingChange:n=>i.uniformChartScaling=n,onUnitChange:n=>i.unit=n}):null),b("div",{class:or.mainContainer,key:"main-container"},e),this.visibleElements.legend?b(ty,{effectiveUnits:i.effectiveUnits,messages:this.messages,profiles:this._profilesArray}):null,this._renderActions(t))}_renderZoomOutButton(){const t=this.messages.zoomOut;return b("calcite-action",{appearance:"transparent",class:or.zoomOutButton,"data-testid":"zoom-out-button",icon:"magnifying-glass-minus",key:"zoom-out",onclick:this._onZoomOutButtonClick,scale:"s",text:t,title:t})}_renderClearButton(){const t=this.messages.clearProfile;return b("calcite-action",{appearance:"transparent",class:or.clearButton,"data-testid":"clear-button",icon:"trash",key:"clear-profile",onclick:this._onClearButtonClick,scale:"s",text:t,title:t})}_renderPrompt(t){return[b("div",{bind:this,class:or.promptContainer,key:"prompt-container"},b("p",null,t))]}_renderChart(){if(!this.visibleElements.chart)return b("div",{class:or.chartContainer,key:"empty-chart-container"});const{chartData:t,progress:e}=this.viewModel,i=this._chartIsRefined||this._canRenderChart(),r=t!=null&&e<1;return i?b(lm,null,this._renderSpinner({size:i?"small":"large",visible:r}),b("div",{afterCreate:this._onChartContainerUpdate,afterRemoved:this._onChartContainerRemoved,afterUpdate:this._onChartContainerUpdate,bind:this,class:or.chartContainer,key:"chart-container"})):b(lm,null,this._renderSpinner({size:"large",visible:r}),b("div",{class:or.chartContainer,key:"chart-container-empty"}))}_renderSpinner(t){const e=t.size==="small",i=t.visible??!0;return b("calcite-loader",{class:this.classes(or.chartSpinner,e&&or.chartSpinnerSmall,i&&or.chartSpinnerVisible),inline:e,key:"spinner",label:"",scale:"s"})}_canRenderChart(){const t=this.viewModel.chartData;if(t==null)return!1;if(!this.viewModel.inputIsSketched)return t.refined;let e=0;for(const{samples:i}of t.lines)e+=i!=null?i.length:0;return t.refined||e<=Ka().largeChartSamples}_renderActions({actions:t}){const e=t.map(i=>{switch(i.type){case Ks.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:i,className:or.sketchButton,label:this.messages.sketchButtonLabel,onClick:this._onSketchButtonClick,primary:!0});case Ks.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:i,onClick:this._onCancelButtonClick,className:or.sketchCancelButton,label:this.messagesCommon.cancel,primary:!1});case Ks.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:i,onClick:this._onDoneButtonClick,className:or.sketchDoneButton,label:this.messagesCommon.done,primary:!0});case Ks.Select:return this._selectButtonVisible&&this._renderAction({action:i,onClick:this._onSelectButtonClick,className:or.selectButton,label:this.messages.selectButtonLabel,primary:!1});case Ks.SelectCancel:return this._selectButtonVisible&&this._renderAction({action:i,onClick:this._onCancelButtonClick,className:or.selectCancelButton,label:this.messagesCommon.cancel,primary:!1})}}).filter(Boolean);return e.length?b("footer",{class:or.footer,key:"footer"},e):null}_renderAction({action:t,className:e,label:i,onClick:r,primary:n}){return b("calcite-button",{appearance:n?"solid":"outline-fill",bind:this,class:this.classes(or.actionButton,e),disabled:t.disabled,key:`action-${t.type}`,onclick:r},i)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperUpdate(t){t!==this._contentWrapper&&(this._contentWrapper=t,this.removeHandles(OO),this.addHandles(R4(t,e=>{this._width=e.contentRect.width}),OO))}_onContentWrapperRemoved(){this.removeHandles(OO),this._contentWrapper=null}_updateChart(t){const{data:e,chart:i,messages:r,stationary:n}=t;i!=null&&r!=null&&n&&this._canRenderChart()&&(i.update(t),this._chartIsRefined=e!=null&&e.refined)}_onChartContainerUpdate(t){this._chartContainer=t}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(t){mr(this._chartInitTask),this._chartInitTask=Xo(async e=>{const{createChart:i}=await k(()=>import("./chartUtils-DhrT9nUT.js"),__vite__mapDeps([368,369,370,371,372,373,374,375,376,377]));qe(e);const r=await i({container:t,abortOptions:{signal:e},onRangeChange:(n,s)=>{this._zoomOutButtonVisible=n!==1||s!==1},onCursorPositionChange:n=>{this.viewModel.hoveredChartPosition=n}});if(e.aborted)throw xe(r),mt();this._chart=r,this._updateChart(this._chartUpdateParams)})}_destroyChart(){this._chartInitTask=mr(this._chartInitTask),this._chart=xe(this._chart),this._chartIsRefined=!1}};l([c({type:jce})],Wt.prototype,"viewModel",void 0),l([c()],Wt.prototype,"view",null),l([c()],Wt.prototype,"input",null),l([c()],Wt.prototype,"profiles",null),l([c()],Wt.prototype,"unitOptions",null),l([c()],Wt.prototype,"unit",null),l([c()],Wt.prototype,"geodesicDistanceThreshold",null),l([c({type:Gce,nonNullable:!0})],Wt.prototype,"visibleElements",void 0),l([c()],Wt.prototype,"icon",null),l([c()],Wt.prototype,"label",null),l([c()],Wt.prototype,"visible",null),l([c(),Ue("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Wt.prototype,"messages",void 0),l([c(),Ue("esri/t9n/common")],Wt.prototype,"messagesCommon",void 0),l([c(),Ue("esri/core/t9n/Units")],Wt.prototype,"messagesUnits",void 0),l([c()],Wt.prototype,"_contentWrapper",void 0),l([c()],Wt.prototype,"_chartContainer",void 0),l([c()],Wt.prototype,"_chart",void 0),l([c()],Wt.prototype,"_chartInitTask",void 0),l([c()],Wt.prototype,"_chartIsRefined",void 0),l([c()],Wt.prototype,"_width",void 0),l([c()],Wt.prototype,"_portrait",null),l([c()],Wt.prototype,"_zoomOutButtonVisible",void 0),l([c()],Wt.prototype,"_selectButtonVisible",null),l([c()],Wt.prototype,"_chartUpdateParams",null),l([c()],Wt.prototype,"_chartMessages",null),l([c()],Wt.prototype,"_profilesArray",null),Wt=l([$("esri.widgets.ElevationProfile")],Wt);const HWe=Wt;et.assetsPath="https://js.arcgis.com/4.31/@arcgis/core/assets/";let Qn;window.parent.postMessage("ready","*");const GW=new URL(window.location.href),OE="b4cfa4a48dbb49b8b150c14bb6cca6f9",RE="https://www.arcgis.com";if(GW.searchParams.get("locale")&&xr>4.15){const t=GW.searchParams.get("locale");Yfe(t),console.log(xr,"-- locale:",t)}console.log(xr,"-- webmap:",OE,"from",RE);footerDiv.innerHTML+=" <a href='about.html' target='_blank'>About</a> this app";footerDiv.innerHTML+=" -- <a target='_blank' href='"+RE+"/home/item.html?id="+OE+"'>item page</a>";footerDiv.innerHTML+=" -- <a target='_blank' href='"+RE+"/sharing/rest/content/items/"+OE+"/data?f=pjson'>webmap JSON</a>";et.portalUrl=RE;Qn=new vCe({portalItem:{id:OE,portal:RE}});Qn.when(function(){uW.getPropertiesFromWebMap(Qn).then(t=>{if(t){console.log(xr,"-- timeslider smartness added at 4.22:",t);const e=new uW({container:"timeSlider",...t,view:ct});ct.ui.add(e,"manual")}else console.log(xr,"-- no timeslider properties.")}),console.log(xr,"-- webmap (version "+Qn.resourceInfo.version+") with "+Qn.resourceInfo.operationalLayers.length+" operational layers and "+Qn.resourceInfo.baseMap.baseMapLayers.length+" basemap layers."),Qn.bookmarks&&Qn.bookmarks.length?(console.log(xr,"-- webmap has",Qn.bookmarks.length,"bookmarks."),zW()):(editbookmarks&&editbookmarks!="false"&&(console.log(xr,"-- editbookmarks:",editbookmarks),zW()),debug&&console.log(xr,"No bookmarks in this webmap.")),show.includes("editor")&&qWe(),show.includes("basemaptoggle")&&WWe()}).catch(function(t){versionDiv.innerHTML+="<font color='red'><br><br><i>Hmm, we got a problem!</i><br><br>",t.name&&(versionDiv.innerHTML+="<b>name:</b> "+t.name+"<br>"),t.message&&(versionDiv.innerHTML+="<b>message:</b> "+t.message+"<br>"),t.details&&(versionDiv.innerHTML+="<b>details:</b> "+JSON.stringify(t.details)+"<br>")});const ct=new DNe({container:"viewDiv",map:Qn,padding:{bottom:40}});ct.when(function(){{Qn.ground="world-topobathymetry";const d=new HWe({view:ct});ct.ui.add(d,"bottom-right")}N(()=>ct.stationary,d=>{scaleDiv.innerHTML="1:"+ct.scale,scaleDiv.style.display="block",ct.zoom,ct.zoom=="-1"?(zoomDiv.innerHTML="No LODs",zoomDiv.style.display="block"):(zoomDiv.innerHTML="L:"+ct.zoom,zoomDiv.style.display="block")});const t=new uy({view:ct,expandTooltip:"webmap metadata",content:"<div class='esri-widget' style='width:400px;padding:3px;border:thin solid darkgray;border-radius:9px;'>WebMap title: <a target='_blank' href='"+et.portalUrl+"/home/item.html?id="+OE+"'>"+Qn.portalItem.title+"</a><br>Created: "+new Date(Qn.portalItem.created).toLocaleString()+"<br>Last modified: "+new Date(Qn.portalItem.modified).toLocaleString()+"<br>Owner: "+Qn.portalItem.owner+"</div>",expanded:!0});ct.ui.add(t,{position:"top-left",index:0});let e=0;Qn.layers.items.forEach(function(d){if(console.log(xr,"----",++e+". '"+d.type+"' layer: ",d.title,"--",d.id),d.type=="feature"&&d.source&&(d.url?console.log(xr,"------ Service-based FL on the way",d):d.source?console.log(xr,"------ Featurecollection FL on the way?",d):console.log(xr,"------ Hmm, what FL is on the way?",d),ct.whenLayerView(d).then(function(h){d&&d.source&&d.source.items&&(console.log(xr,"------ items in featurecollection",d.source.items.length),d.source.items.forEach(function(m){m.attributes.No_Storeys&&console.log(xr,"item",m.attributes.GlobalID,"has",m.attributes.No_Storeys)}))})),d.loadError){var p=d.loadError;p.name==="layer:unknown-layer-type"&&(versionDiv.innerHTML+="<font color='red'><br><br><i>unknown layer type</i><br><br>",p.name&&(versionDiv.innerHTML+="<b>name:</b> "+p.name+"<br>"),p.message&&(versionDiv.innerHTML+="<b>message:</b> "+p.message+"<br>"),p.details&&(versionDiv.innerHTML+="<b>details:</b> "+JSON.stringify(p.details)+"<br>")),console.log("layer",d.loadError)}else d.accessInformation&&console.log(xr,"layer.accessInformation:",d.accessInformation),d.portalItem&&console.log(xr,"layer.portalItem:",d.portalItem)});const i=new Rse({view:ct}),r=new BNe({view:ct});ct.ui.add([r,i],"top-left");const n=new uy({view:ct,content:new vHe({view:ct})}),s=new uy({view:ct,content:new Iue({view:ct}),group:"bottomrightgroup"}),o=new uy({view:ct,content:new yBe({view:ct})}),a=new uy({view:ct,content:new lHe({view:ct})});ct.ui.add([a,o],{position:"top-right"}),ct.ui.add([s],{position:"bottom-right"});const u=new mHe({view:ct,unit:"dual"});ct.ui.add(u,{position:"bottom-right"}),ct.ui.add([n],{position:"bottom-left"})});versionDiv.innerHTML="v"+xr;versionDiv.style.display="block";function zW(){const t=new uy({view:ct,content:new jNe({view:ct,editingEnabled:editbookmarks}),expanded:!1,group:"goodidea"});ct.ui.add(t,{position:"top-right"})}function qWe(){const t=new uy({view:ct,content:new rze({view:ct}),expanded:!0,group:"bottomrightgroup"});ct.ui.add(t,{position:"bottom-right"})}function WWe(){const t=new gBe({view:ct,nextBasemap:"osm"});ct.ui.add(t,"bottom-right")}export{X2e as $,qR as A,iQ as B,Drt as C,Vrt as D,Xge as E,Hrt as F,RQe as G,Urt as H,nr as I,HC as J,Mk as K,kJe as L,qe as M,py as N,et as O,TZe as P,wV as Q,XZe as R,so as S,JJe as T,Ee as U,gb as V,ime as W,l as X,c as Y,aet as Z,k as _,MFe as a,IZe as a$,X as a0,te as a1,hn as a2,$ as a3,j as a4,r_ as a5,at as a6,eu as a7,J$ as a8,Y$ as a9,XV as aA,$K as aB,Y6 as aC,qKe as aD,Eve as aE,$m as aF,fr as aG,Lrt as aH,bZ as aI,zb as aJ,tne as aK,Ln as aL,qM as aM,el as aN,qT as aO,gYe as aP,Ore as aQ,hve as aR,Cn as aS,gy as aT,G as aU,mz as aV,fz as aW,AJe as aX,tg as aY,ye as aZ,G3 as a_,Q2e as aa,AN as ab,tH as ac,P2 as ad,Cg as ae,ac as af,aZ as ag,uZ as ah,cZ as ai,XWe as aj,U as ak,Ode as al,pZe as am,vrt as an,gH as ao,F2 as ap,Crt as aq,SK as ar,qit as as,GPe as at,K9 as au,Q9 as av,eH as aw,X9 as ax,EK as ay,Sy as az,qrt as b,f7e as b$,pt as b0,q as b1,Xo as b2,dJe as b3,fn as b4,lat as b5,O$ as b6,Ec as b7,we as b8,On as b9,Yr as bA,Ice as bB,_ge as bC,JC as bD,ou as bE,Rge as bF,Tp as bG,FQe as bH,h8 as bI,mY as bJ,Uy as bK,dm as bL,d8 as bM,Fre as bN,Y as bO,Li as bP,cat as bQ,sKe as bR,u_ as bS,hm as bT,Yt as bU,Jye as bV,Yye as bW,KS as bX,G$ as bY,bge as bZ,vY as b_,bCe as ba,Kj as bb,rr as bc,TIe as bd,RS as be,RIe as bf,YZe as bg,CJe as bh,eg as bi,RO as bj,ot as bk,DYe as bl,NYe as bm,FS as bn,Ft as bo,ZGe as bp,sL as bq,y$e as br,g$e as bs,v$e as bt,R as bu,Db as bv,gu as bw,W as bx,Wye as by,Lr as bz,Grt as c,JS as c$,xj as c0,As as c1,ls as c2,JRe as c3,V2e as c4,det as c5,os as c6,ep as c7,Ik as c8,se as c9,Ac as cA,$c as cB,Ci as cC,Yo as cD,zS as cE,_i as cF,sR as cG,aR as cH,t2 as cI,ZX as cJ,Rne as cK,pe as cL,v$ as cM,qr as cN,R2 as cO,Fne as cP,oH as cQ,bi as cR,$re as cS,UI as cT,Q$ as cU,KP as cV,bYe as cW,MKe as cX,ZKe as cY,up as cZ,RJ as c_,MS as ca,kq as cb,Aq as cc,Ty as cd,CRe as ce,Wtt as cf,He as cg,Jtt as ch,Yae as ci,_m as cj,vu as ck,l_ as cl,ji as cm,Wo as cn,xe as co,iat as cp,St as cq,rKe as cr,og as cs,An as ct,Vde as cu,N as cv,be as cw,ag as cx,ATe as cy,w_ as cz,du as d,lYe as d$,vy as d0,PO as d1,APe as d2,tZ as d3,Ze as d4,B4 as d5,aae as d6,Oe as d7,Nlt as d8,cot as d9,BG as dA,Tb as dB,rL as dC,SE as dD,CE as dE,hi as dF,Si as dG,Snt as dH,dZ as dI,pZ as dJ,XZ as dK,xC as dL,FV as dM,j$ as dN,qS as dO,qh as dP,Ho as dQ,nye as dR,RC as dS,sye as dT,I4 as dU,ZZe as dV,xJe as dW,LJe as dX,zKe as dY,LKe as dZ,fYe as d_,Rje as da,mM as db,Ko as dc,ZRe as dd,fu as de,vt as df,EU as dg,H4e as dh,K5 as di,PKe as dj,YKe as dk,Rr as dl,Xst as dm,Mre as dn,Sp as dp,Jr as dq,iC as dr,Zz as ds,Xz as dt,Or as du,yr as dv,dp as dw,$C as dx,EC as dy,I_ as dz,ki as e,Kte as e$,OHe as e0,Ide as e1,Bi as e2,ee as e3,nwe as e4,x2e as e5,H5e as e6,si as e7,Pr as e8,t5e as e9,g5 as eA,u1e as eB,nKe as eC,po as eD,H$ as eE,Zwe as eF,J0 as eG,AQ as eH,aKe as eI,v2 as eJ,T5 as eK,oKe as eL,Cs as eM,PJe as eN,ro as eO,V$ as eP,Fce as eQ,XD as eR,QD as eS,Jo as eT,cZe as eU,EJ as eV,Oy as eW,vV as eX,qde as eY,Uve as eZ,AQe as e_,S$ as ea,kS as eb,Loe as ec,Cst as ed,gE as ee,CEe as ef,i5e as eg,KKe as eh,YXe as ei,vte as ej,gt as ek,D4e as el,Ka as em,VR as en,efe as eo,tQe as ep,sQe as eq,Lb as er,w$ as es,Tc as et,oQe as eu,$e as ev,oe as ew,HKe as ex,zJ as ey,jee as ez,zrt as f,P$ as f$,w2e as f0,Mie as f1,VIe as f2,s2e as f3,c2e as f4,nk as f5,v2e as f6,LIe as f7,dxe as f8,Ma as f9,Wa as fA,Lc as fB,qJ as fC,bne as fD,_ne as fE,is as fF,Yst as fG,Wst as fH,Jst as fI,Oxe as fJ,RM as fK,fm as fL,Xd as fM,Ua as fN,cg as fO,M4 as fP,aYe as fQ,qX as fR,yYe as fS,sK as fT,Zr as fU,vE as fV,HG as fW,Uh as fX,We as fY,GS as fZ,Jte as f_,Le as fa,Dlt as fb,Flt as fc,i2 as fd,Pt as fe,PC as ff,I2e as fg,p2 as fh,Lxe as fi,u5 as fj,Xe as fk,ig as fl,Pxe as fm,Axe as fn,Pn as fo,g_ as fp,Qo as fq,a_e as fr,o_e as fs,ave as ft,Bo as fu,ER as fv,gc as fw,ao as fx,yn as fy,di as fz,vFe as g,uo as g$,uat as g0,eme as g1,fme as g2,cDe as g3,l8 as g4,Yde as g5,yt as g6,Jde as g7,aO as g8,Lje as g9,nU as gA,Nqe as gB,h$ as gC,qi as gD,Ga as gE,q2e as gF,FT as gG,jl as gH,eM as gI,KJe as gJ,ut as gK,Dit as gL,b0 as gM,jC as gN,GI as gO,ZR as gP,_Ye as gQ,D$ as gR,Tpe as gS,xZe as gT,IC as gU,Yx as gV,lS as gW,j_e as gX,rx as gY,yJe as gZ,QZe as g_,Aje as ga,Sm as gb,zae as gc,L_ as gd,qst as ge,lu as gf,mot as gg,pot as gh,Xa as gi,$pe as gj,Q4e as gk,kst as gl,Mde as gm,_p as gn,TVe as go,kc as gp,yst as gq,Qd as gr,ise as gs,qy as gt,kr as gu,Wr as gv,jW as gw,wm as gx,lqe as gy,Rn as gz,dse as h,fg as h$,oMe as h0,IIe as h1,p8 as h2,zx as h3,PQe as h4,MF as h5,i_ as h6,mat as h7,pi as h8,rg as h9,x_ as hA,qNe as hB,M_ as hC,toe as hD,fE as hE,DV as hF,VGe as hG,nze as hH,fot as hI,hY as hJ,ss as hK,UJe as hL,r7 as hM,Ub as hN,Nje as hO,aC as hP,Pot as hQ,jje as hR,yp as hS,dot as hT,Ky as hU,G4e as hV,oie as hW,mXe as hX,WJe as hY,Yot as hZ,Xse as h_,W2e as ha,nV as hb,Yre as hc,$N as hd,Kre as he,iOe as hf,J4 as hg,NM as hh,zo as hi,_5 as hj,jZe as hk,nH as hl,mr as hm,xr as hn,hV as ho,Tve as hp,wne as hq,XAe as hr,Tr as hs,eOe as ht,Jre as hu,C_ as hv,_xe as hw,e_ as hx,Hi as hy,Mi as hz,$se as i,v4 as i$,Gye as i0,VJe as i1,cW as i2,vn as i3,wot as i4,uu as i5,mae as i6,EKe as i7,$Ke as i8,sSe as i9,C$ as iA,Qme as iB,nct as iC,zX as iD,rm as iE,rZe as iF,Ly as iG,Do as iH,ni as iI,$E as iJ,AUe as iK,wut as iL,Sut as iM,BUe as iN,k4 as iO,Vy as iP,u2e as iQ,r2e as iR,$xe as iS,z6 as iT,EQ as iU,M2e as iV,Dxe as iW,b4 as iX,Ck as iY,gA as iZ,WF as i_,eK as ia,_7 as ib,ale as ic,Oa as id,OGe as ie,Lm as ig,Kt as ih,qU as ii,io as ij,aOe as ik,FJe as il,YAe as im,wJe as io,_G as ip,jJ as iq,GJ as ir,B7e as is,Wi as it,IU as iu,$b as iv,URe as iw,qV as ix,oge as iy,Oye as iz,Vo as j,gst as j$,Sk as j0,xTe as j1,kxe as j2,x4 as j3,S2e as j4,Ude as j5,WG as j6,kie as j7,nm as j8,cme as j9,Wxe as jA,rMe as jB,Zxe as jC,Jxe as jD,Yxe as jE,Kxe as jF,Xxe as jG,Qxe as jH,eMe as jI,Cie as jJ,Rxe as jK,Mat as jL,Aat as jM,hat as jN,pat as jO,Dat as jP,Uat as jQ,Gat as jR,B6e as jS,cle as jT,ple as jU,kat as jV,Rat as jW,Fat as jX,p$ as jY,vst as jZ,fst as j_,Sc as ja,kn as jb,mu as jc,a$ as jd,w4 as je,Nxe as jf,Fxe as jg,s_ as jh,tMe as ji,nMe as jj,Cxe as jk,Vte as jl,$p as jm,l4 as jn,Uee as jo,Fee as jp,Pee as jq,Ree as jr,CMe as js,mxe as jt,aMe as ju,PIe as jv,Gxe as jw,zxe as jx,Bxe as jy,qxe as jz,Te as k,Xpe as k$,Wrt as k0,Y9 as k1,Stt as k2,Xre as k3,SH as k4,J9 as k5,hZe as k6,uE as k7,nZe as k8,_$ as k9,mp as kA,QY as kB,Yi as kC,SC as kD,Ud as kE,lEe as kF,Kue as kG,Txe as kH,m2 as kI,dQ as kJ,FYe as kK,vie as kL,LC as kM,xc as kN,Ov as kO,cMe as kP,JF as kQ,tet as kR,mMe as kS,fMe as kT,Kl as kU,Vlt as kV,p4 as kW,NIe as kX,DIe as kY,ip as kZ,Iie as k_,Ape as ka,lo as kb,ks as kc,mt as kd,ZWe as ke,ON as kf,IS as kg,Bre as kh,HV as ki,aD as kj,jt as kk,pae as kl,pUe as km,r4 as kn,dUe as ko,hae as kp,Eot as kq,Pc as kr,gae as ks,xot as kt,EE as ku,DUe as kv,Uk as kw,_nt as kx,Nye as ky,eYe as kz,BYe as l,VLe as l$,yJ as l0,SJ as l1,H_e as l2,Wde as l3,c5 as l4,xs as l5,zR as l6,WX as l7,pr as l8,OQe as l9,QJe as lA,XJe as lB,gve as lC,G_e as lD,X5 as lE,oEe as lF,dEe as lG,LY as lH,cge as lI,lge as lJ,uge as lK,eE as lL,tE as lM,iE as lN,R5 as lO,kKe as lP,xKe as lQ,rae as lR,OUe as lS,Kst as lT,EOe as lU,TOe as lV,dae as lW,kde as lX,N$ as lY,oct as lZ,Jq as l_,Vhe as la,aL as lb,cC as lc,m6e as ld,Ku as le,Gt as lf,b as lg,K as lh,qa as li,Jse as lj,yHe as lk,Ue as ll,km as lm,$t as ln,Z9 as lo,Iit as lp,xit as lq,Ait as lr,Oit as ls,Mit as lt,Cit as lu,kit as lv,Lit as lw,dat as lx,OV as ly,zfe as lz,Qge as m,QNe as m$,gne as m0,Ufe as m1,Wfe as m2,U$ as m3,SJe as m4,M0 as m5,Zy as m6,b3e as m7,w3e as m8,S3e as m9,yrt as mA,rH as mB,tu as mC,One as mD,Dd as mE,iH as mF,grt as mG,W9 as mH,yve as mI,O2 as mJ,Vit as mK,Uit as mL,jit as mM,jPe as mN,yXe as mO,gXe as mP,fXe as mQ,rse as mR,Rde as mS,WZe as mT,Ghe as mU,OC as mV,eJe as mW,pc as mX,cae as mY,E_ as mZ,hot as m_,bD as ma,UGe as mb,IBe as mc,L7 as md,Jae as me,wBe as mf,Gy as mg,mC as mh,fL as mi,Hme as mj,hYe as mk,oV as ml,OZe as mm,AZe as mn,Fpe as mo,jZ as mp,iZe as mq,Ade as mr,cYe as ms,dt as mt,krt as mu,I as mv,hJe as mw,k$ as mx,i3e as my,RN as mz,ci as n,om as n$,CYe as n0,MYe as n1,knt as n2,ZNe as n3,gp as n4,kae as n5,Ui as n6,Cot as n7,Fje as n8,lC as n9,sH as nA,N2e as nB,cEe as nC,w1e as nD,S1e as nE,eQe as nF,_K as nG,rYe as nH,R$ as nI,KQ as nJ,cne as nK,e3e as nL,NJe as nM,Jue as nN,vle as nO,wle as nP,L0 as nQ,nu as nR,U1e as nS,hp as nT,KYe as nU,uMe as nV,aat as nW,H6e as nX,q6e as nY,oat as nZ,Zst as n_,Cm as na,fp as nb,pu as nc,j4 as nd,kot as ne,Dje as nf,jD as ng,tt as nh,_E as ni,gUe as nj,qC as nk,$ne as nl,oZe as nm,aZe as nn,sZe as no,bp as np,nme as nq,xS as nr,X$ as ns,VQ as nt,UQ as nu,C6e as nv,rs as nw,f6e as nx,M7 as ny,Aut as nz,JWe as o,flt as o$,A8 as o0,WS as o1,_2e as o2,kE as o3,tce as o4,WHe as o5,Zd as o6,V5 as o7,oee as o8,xSe as o9,Fge as oA,b5 as oB,bm as oC,uxe as oD,cxe as oE,Sxe as oF,HMe as oG,l2e as oH,lZ as oI,TJ as oJ,bV as oK,qZe as oL,BJ as oM,QO as oN,uY as oO,G3e as oP,tJe as oQ,WQe as oR,clt as oS,Ha as oT,ult as oU,mlt as oV,alt as oW,rlt as oX,llt as oY,slt as oZ,olt as o_,f_ as oa,Wh as ob,mRe as oc,pge as od,oUe as oe,sge as of,age as og,Yit as oh,kre as oi,C2 as oj,Gb as ok,Rk as ol,_N as om,U4 as on,$_ as oo,DZe as op,Me as oq,Xbe as or,vxe as os,nie as ot,gxe as ou,Rc as ov,AHe as ow,jKe as ox,GKe as oy,Nge as oz,Brt as p,DS as p$,plt as p0,Yat as p1,hlt as p2,ilt as p3,tlt as p4,nlt as p5,sg as p6,Ql as p7,EXe as p8,F$e as p9,t3e as pA,cH as pB,uH as pC,Qut as pD,Q0 as pE,KWe as pF,$de as pG,YWe as pH,_ot as pI,CUe as pJ,bot as pK,RHe as pL,bct as pM,Rs as pN,Kb as pO,yct as pP,RKe as pQ,OKe as pR,Lut as pS,brt as pT,q2 as pU,rOe as pV,TXe as pW,hg as pX,xEe as pY,ay as pZ,Is as p_,DJe as pa,QAe as pb,KLe as pc,rp as pd,OJe as pe,QV as pf,JZe as pg,FZ as ph,IKe as pi,TKe as pj,yV as pk,wge as pl,kY as pm,vge as pn,jRe as po,gge as pp,WV as pq,xU as pr,uSe as ps,Y5 as pt,YSe as pu,$g as pv,A7e as pw,uUe as px,S7e as py,frt as pz,J_e as q,Hre as q$,eZe as q0,tl as q1,Wee as q2,vk as q3,Kee as q4,n$ as q5,$ge as q6,Pge as q7,wN as q8,Jee as q9,blt as qA,glt as qB,ylt as qC,gj as qD,Qat as qE,dlt as qF,elt as qG,__ as qH,z5 as qI,zSe as qJ,BSe as qK,b_ as qL,$ee as qM,z5e as qN,l$e as qO,B5e as qP,H5 as qQ,_2 as qR,_ee as qS,bS as qT,Nit as qU,vH as qV,Sit as qW,CNe as qX,Ar as qY,Dk as qZ,Gre as q_,g$ as qa,kN as qb,Cy as qc,xge as qd,zJe as qe,UQe as qf,qme as qg,zQ as qh,jQe as qi,yne as qj,FIe as qk,Blt as ql,jlt as qm,lY as qn,pJe as qo,y$ as qp,bOe as qq,$te as qr,vTe as qs,sXe as qt,oXe as qu,aXe as qv,Xat as qw,vlt as qx,Kat as qy,Ole as qz,jrt as r,cje as r$,OAe as r0,$tt as r1,jAe as r2,Ett as r3,bk as r4,ege as r5,SYe as r6,X4 as r7,Os as r8,pp as r9,Pk as rA,pE as rB,N0 as rC,eY as rD,KJ as rE,gfe as rF,op as rG,np as rH,bAe as rI,G4 as rJ,R7e as rK,w7e as rL,tYe as rM,fve as rN,z1 as rO,n7 as rP,BN as rQ,uje as rR,vfe as rS,TU as rT,gJe as rU,Dae as rV,W2 as rW,to as rX,zU as rY,sje as rZ,XNe as r_,Bwe as ra,w0 as rb,hr as rc,Ms as rd,RMe as re,srt as rf,Lne as rg,sE as rh,dYe as ri,JKe as rj,B$ as rk,VC as rl,Mot as rm,Que as rn,xut as ro,Re as rp,Em as rq,got as rr,YJe as rs,KXe as rt,art as ru,ort as rv,_it as rw,wit as rx,yz as ry,hc as rz,L as s,bit as s$,$nt as s0,qje as s1,Cnt as s2,Tnt as s3,m$ as s4,BZ as s5,Hst as s6,k9 as s7,Dq as s8,SU as s9,QLe as sA,Sne as sB,i4 as sC,iUe as sD,wE as sE,Lot as sF,kU as sG,LU as sH,fae as sI,iYe as sJ,yR as sK,Tit as sL,lAe as sM,oy as sN,$H as sO,Une as sP,trt as sQ,irt as sR,rrt as sS,nrt as sT,zit as sU,Hit as sV,Bit as sW,_3e as sX,Mr as sY,rE as sZ,G7 as s_,j4e as sa,tUe as sb,Zl as sc,B4e as sd,vot as se,zLe as sf,BLe as sg,cL as sh,eAe as si,Oje as sj,Mc as sk,Pje as sl,Wae as sm,bnt as sn,eDe as so,Ent as sp,iq as sq,vnt as sr,WNe as ss,iY as st,vJe as su,mUe as sv,Wy as sw,Tot as sx,xnt as sy,NLe as sz,Z_e as t,qlt as t$,nQe as t0,vz as t1,wxe as t2,a1e as t3,QYe as t4,tKe as t5,eKe as t6,iKe as t7,Ls as t8,OQ as t9,cre as tA,VZ as tB,pfe as tC,mJe as tD,fJe as tE,Ope as tF,p6e as tG,GJe as tH,Y3e as tI,Lnt as tJ,r2 as tK,lU as tL,Ya as tM,HDe as tN,znt as tO,Bnt as tP,M5 as tQ,Hnt as tR,uoe as tS,Wnt as tT,MDe as tU,EDe as tV,qnt as tW,oU as tX,_De as tY,R1e as tZ,FDe as t_,xrt as ta,Fj as tb,XYe as tc,IV as td,FC as te,cR as tf,QM as tg,dR as th,e2 as ti,JYe as tj,nq as tk,Ont as tl,Nnt as tm,Hk as tn,Rnt as to,Pnt as tp,Fnt as tq,jnt as tr,Dnt as ts,Vnt as tt,Unt as tu,Gnt as tv,rk as tw,oot as tx,uHe as ty,lm as tz,tQ as u,BXe as u$,aoe as u0,Xnt as u1,O1e as u2,QS as u3,t$ as u4,Pb as u5,OVe as u6,rst as u7,uet as u8,cet as u9,jEe as uA,Jz as uB,Rz as uC,vYe as uD,Uz as uE,rB as uF,nB as uG,sB as uH,xve as uI,nYe as uJ,pve as uK,oB as uL,sYe as uM,JAe as uN,NXe as uO,B3 as uP,FXe as uQ,XXe as uR,JXe as uS,qXe as uT,HXe as uU,WXe as uV,ZXe as uW,wB as uX,SB as uY,$B as uZ,zXe as u_,iet as ua,Ynt as ub,Knt as uc,bDe as ud,VDe as ue,yE as uf,Znt as ug,Jnt as uh,est as ui,Qnt as uj,tst as uk,ist as ul,GNe as um,Cr as un,jk as uo,J7 as up,tD as uq,a7e as ur,lut as us,fHe as ut,V4e as uu,Mrt as uv,Nz as uw,Az as ux,cve as uy,Oz as uz,hy as v,UZ as v$,Git as v0,fB as v1,Mz as v2,_z as v3,wz as v4,Sz as v5,jz as v6,mB as v7,gB as v8,Cz as v9,$it as vA,Eit as vB,Qit as vC,Xit as vD,lrt as vE,urt as vF,Rit as vG,crt as vH,drt as vI,UPe as vJ,BPe as vK,ese as vL,yb as vM,ert as vN,KZe as vO,nOe as vP,Ife as vQ,Tfe as vR,bJe as vS,ihe as vT,mYe as vU,nK as vV,prt as vW,hrt as vX,xre as vY,gct as vZ,IY as v_,pk as va,oYe as vb,jXe as vc,GXe as vd,Kit as ve,QXe as vf,z3 as vg,DXe as vh,nte as vi,RXe as vj,pte as vk,_k as vl,UXe as vm,GEe as vn,DEe as vo,VXe as vp,NEe as vq,wk as vr,Fk as vs,UEe as vt,Jit as vu,Zit as vv,PXe as vw,n3e as vx,Wit as vy,_H as vz,wi as w,AKe as w$,Ige as w0,AY as w1,xUe as w2,y_e as w3,nAe as w4,$rt as w5,Ert as w6,Trt as w7,g3e as w8,Vne as w9,aot as wA,ULe as wB,lot as wC,but as wD,NHe as wE,Tut as wF,DQe as wG,cce as wH,Cut as wI,Mut as wJ,kut as wK,aEe as wL,CLe as wM,vtt as wN,zst as wO,Int as wP,a$e as wQ,ESe as wR,WKe as wS,DKe as wT,FKe as wU,lZe as wV,Rut as wW,rXe as wX,iXe as wY,tZe as wZ,jme as w_,Pit as wa,Fit as wb,m3e as wc,Irt as wd,vit as we,IQe as wf,UC as wg,dIe as wh,cQe as wi,uQe as wj,fb as wk,q9 as wl,zlt as wm,Glt as wn,LBe as wo,PG as wp,gut as wq,TY as wr,xn as ws,gme as wt,QRe as wu,xoe as wv,ire as ww,uL as wx,IXe as wy,nGe as wz,y5 as x,AXe as x$,uYe as x0,BKe as x1,wWe as x2,zy as x3,Gke as x4,hRe as x5,une as x6,NZe as x7,$T as x8,P6 as x9,kXe as xA,Bst as xB,HJe as xC,c9 as xD,BJe as xE,Eut as xF,pYe as xG,Zk as xH,u9 as xI,p5 as xJ,Lce as xK,$Z as xL,mZe as xM,z4e as xN,UKe as xO,lK as xP,yot as xQ,mge as xR,dge as xS,LXe as xT,xXe as xU,CGe as xV,ri as xW,wnt as xX,aUe as xY,qk as xZ,l9 as x_,ZJe as xa,hk as xb,vXe as xc,dg as xd,Wle as xe,Hlt as xf,U3 as xg,ZV as xh,sD as xi,$ot as xj,ZPe as xk,GC as xl,MXe as xm,j3 as xn,BC as xo,oae as xp,Vje as xq,qJe as xr,aSe as xs,eot as xt,Z4e as xu,Qst as xv,tot as xw,il as xx,VKe as xy,U4e as xz,le as y,EUe as y0,Sge as y1,hUe as y2,EY as y3,sUe as y4,PW as y5,DRe as y6,NKe as y7,ige as y8,CKe as y9,PYe as yA,pg as yB,BQe as yC,D2e as yD,Art as yE,bst as yF,EW as yG,L5e as ya,OXe as yb,Toe as yc,S0 as yd,iTe as ye,_Se as yf,mR as yg,Tte as yh,Woe as yi,Zoe as yj,STe as yk,jb as yl,Cj as ym,FLe as yn,RJe as yo,ZLe as yp,oSe as yq,Sot as yr,MZe as ys,$ut as yt,_ut as yu,pW as yv,FHe as yw,AU as yx,CXe as yy,OYe as yz,aQ as z};
