const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bundle-D64hP45p.js","assets/bundle-BKXzeEhA.js"])))=>i.map(i=>d[i]);
import{BS as e,BT as t,LS as n,RS as r,TC as i}from"./index-CzMixifc.js";import{n as a}from"./QueueProcessor-CbN5H2eO.js";import{c as o,d as s,o as c,s as l}from"./bundle-BKXzeEhA.js";var u=null;async function d(){return u||=f(),u}async function f(){let t=await e(()=>import(`./bundle-D64hP45p.js`),__vite__mapDeps([0,1]));return await t.default({module_or_path:n(`esri/libs/parquet/pkg/bundle_bg.wasm`)}),t}var p=new a({concurrency:8,process:async e=>{let{data:t}=await r(e.url,e.options);return t}}),m=e=>async function(t,n,r,i){let a=e?.(),o=a??{};return await p.push({url:t,options:{responseType:`array-buffer`,query:o,headers:{range:`bytes=${n}-${r}`}}})},h=e=>async function(t){if(i(t)){let{data:e}=await r(t,{responseType:`blob`});return e.size}let{data:n}=await r(t,{responseType:`native`,method:`head`,query:e?.()}),a=n.headers.get(`Content-Length`);if(a==null)throw Error(`Unable to parse content length`);return parseInt(a,10)};function g(e){switch(e){case`esriGeometryPoint`:return c.Point;case`esriGeometryPolygon`:return c.Polygon;case`esriGeometryPolyline`:return c.Polyline;case`esriGeometryMultipoint`:return c.Multipoint;default:throw new t(`parquet`,`Found unexpected GeometryType: ${e}`)}}function _(e){switch(e.geometryEncoding.type){case`wkb`:return s.fromWkb(e.geometryEncoding.field);case`location`:{let{yField:t,xField:n}=e.geometryEncoding;return s.fromLocation(t,n)}}}function v(e,n){let r=e.spatialReference.wkid,i=n.wkid;if(!r||!i)throw new t(`parquet`,`Unable to create ParquetFile, in and out wkid must be specified`);let a=g(e.geometryType),s=_(e),c=[];if(e.displayOptimization?.mode===`xz`){let t=e.displayOptimization.multiscale;for(let e of t.levels??[]){let[t,n]=e.transform.translate,[r,i]=e.transform.scale,a=new Float64Array([t,n]),s=new Float64Array([r,i]);c.push(o.new(e.level,e.column,a,s))}}return l.new(a,r,i,s,c)}async function y(e,t={}){let{ParquetFile:n}=await d(),r=m(t.getCustomParameters),i=h(t.getCustomParameters),a=t.geometryInfo?v(t.geometryInfo,t.outSpatialReference??t.geometryInfo.spatialReference):null;return n.fromUrl(e,r,i,a)}function b(e){let t=e.keyValueMetadata(`geo`);return t==null?null:JSON.parse(t)}function x(e){let t=e.keyValueMetadata(`esri`);return t==null?null:JSON.parse(t)}export{x as n,b as r,y as t};