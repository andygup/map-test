import{Ay as e,Fy as t,Ny as n,Oy as r,Py as i,Zb as a,hy as o,ky as s,mD as c,mx as l,ny as u,uw as d,xy as f}from"./index-BN8X5Ryz.js";import{t as p}from"./curveOperationUtils-CjGTFE3v.js";function m(t,n,r,i){if(i==null||t.hasZ||(i=void 0),t.type===`point`)return t.x+=n,t.y+=r,t.hasZ&&i!=null&&(t.z+=i),t;if(t.type===`multipoint`){let e=t.points;for(let t=0;t<e.length;t++)e[t]=_(e[t],n,r,i);return t}if(t.type===`extent`)return t.xmin+=n,t.xmax+=n,t.ymin+=r,t.ymax+=r,i!=null&&(t.zmin??=0,t.zmin+=i,t.zmax??=0,t.zmax+=i),t;let a=t.type===`polyline`?t.curvePaths??t.paths:t.curveRings??t.rings,o=e(t);for(let e=0;e<a.length;e++){let t=a[e];for(let e=0;e<t.length;e++)t[e]=v(t[e],n,r,i)}return`paths`in t?o?t.curvePaths=a:t.paths=a:o?t.curveRings=a:t.rings=a,t}function h(e,t,n,r,i){let a=e.clone();if(i){let{resolution:e}=r;m(a,t*e,-n*e)}else{let{dxMap:e,dyMap:i}=g(t,n,r);m(a,e,i)}return a}function g(e,t,n){let r=n.state.inverseTransform;return{dxMap:r[0]*e+r[2]*t,dyMap:r[1]*e+r[3]*t}}function _(e,t,n,r){return w(e,e[0]+t,e[1]+n,e[2]!=null&&r!=null?e[2]+r:void 0)}function v(e,t,a,o){let c=_(r(e),t,a,o);if(s(e))return c;if(n(e)){let[,n,r]=e.b;return{b:[c,[n[0]+t,n[1]+a],[r[0]+t,r[1]+a]]}}if(i(e)){let[,n]=e.c;return{c:[c,[n[0]+t,n[1]+a]]}}let[,l,...u]=e.a;return{a:[c,[l[0]+t,l[1]+a],...u]}}function y(e,t,n,i){if(e.type===`point`){let{x:r,y:a}=e,o=i?i[0]:r,s=i?i[1]:a,c=e.clone(),l=(r-o)*t+o,u=(a-s)*n+s;return c.x=l,c.y=u,c}if(e.type===`extent`){let{xmin:r,xmax:a,ymin:o,ymax:s}=e,c=i?i[0]:(r+a)/2,l=i?i[1]:(s+o)/2,u=e.clone();if(u.xmin=(r-c)*t+c,u.ymax=(s-l)*n+l,u.xmax=(a-c)*t+c,u.ymin=(o-l)*n+l,u.xmin>u.xmax){let e=u.xmin;u.xmin=u.xmax,u.xmax=e}if(u.ymin>u.ymax){let e=u.ymin;u.ymin=u.ymax,u.ymax=e}return u}let s=null;if(!i){s=u(e);let t=l(),n=o(t,s);if(!n)return e.clone();let[r,a,c,d]=n;i=[(r+c)/2,(a+d)/2]}let[d,f]=i;if(e.type===`multipoint`){let r=e.clone(),i=r.points;for(let e=0;e<i.length;e++){let r=i[e],[a,o]=r,s=(a-d)*t+d,c=(o-f)*n+f;i[e]=w(r,s,c,void 0)}return r.points=i,r}let p=e.clone();s??=u(e);let m=p.type===`polygon`,h=m?p.curveRings??p.rings:p.curvePaths??p.paths;if(!i){let e=l(),t=o(e,h,!1,!1);if(!t)return p;i=a(t)}for(let e of h){let i=null,a=m&&e.length>0&&c(r(e[0]),r(e.at(-1)));for(let r=0;r<e.length;r++){let a=e[r];e[r]=x(a,t,n,d,f,i),i=a}a&&(e[0]=[...r(e.at(-1))])}return p}function b(e,t,n,r,i){let[a,o,...s]=e;return[(a-r)*t+r,(o-i)*n+i,...s]}function x(e,a,o,c,l,u){if(s(e))return b(e,a,o,c,l);if(n(e)){let[t,n,r]=e.b.map(e=>b(e,a,o,c,l));return{b:[t,n,r]}}if(!u)return e;let d=r(u),m=i(e)?t(d,e):e,[h,g,_,v,y,x,S]=m.a,C=y??0,w=x??Math.hypot(h[0]-g[0],h[1]-g[1]),T=S??1,E=p(c,l,1,0,0,1,a,o);return f(d,{a:[[...h],[...g],_,v,C,w,T]},E)}function S(e,t,n,r,i,a){let o=Math.sqrt((n-e)*(n-e)+(r-t)*(r-t));return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t))/o}function C(e,t,n,r=!1){let i=Math.atan2(t.y-n.y,t.x-n.x)-Math.atan2(e.y-n.y,e.x-n.x),a=Math.atan2(Math.sin(i),Math.cos(i));return r?a:d(a)}function w(e,t,n,r){let i=[t,n];return e.length>2&&i.push(r??e[2]),e.length>3&&i.push(e[3]),i}export{h as a,g as i,S as n,C as r,y as t};