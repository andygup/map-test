import{Aw as e,BT as t,Ex as n,L as r,Lf as i,Mf as a,Ng as o,OT as s,Ow as c,Rh as l,Ua as u,VT as d,eg as f,hv as p,kD as m,kf as h,kw as g,mD as _,mv as v,pv as y,rh as b,rw as x,tg as S,zi as C}from"./index-BN8X5Ryz.js";import"./quatf64-D37SEdPg.js";import"./vectorStacks-Cuo89CNO.js";import"./memoize-Dl61_jt0.js";import{g as w}from"./elevationInfoUtils-uoMH3ofe.js";import{t as T}from"./Analysis-Cy3EfPty.js";import"./ObjectStack-l5kM7JZu.js";import"./ray-LkJ58wpZ.js";import"./HUDIntersectorResult-C5AENPbM.js";import"./Intersector-DL9RPLNy.js";import{n as E,t as D}from"./featureReferenceUtils-B5plW_k2.js";var O=class extends x(g(e)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return s(this.position,e.position)&&s(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};m([t({type:n,json:{write:{isRequired:!0}}})],O.prototype,`position`,void 0),m([t({type:C}),b()],O.prototype,`elevationInfo`,void 0),m([t(E)],O.prototype,`feature`,void 0),O=m([d(`esri.analysis.LineOfSightAnalysisObserver`)],O);var k=O,A=class extends x(c){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return s(this.position,e.position)&&s(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};m([t({type:n,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),b()],A.prototype,`position`,void 0),m([t({type:C}),b()],A.prototype,`elevationInfo`,void 0),m([t(E)],A.prototype,`feature`,void 0),A=m([d(`esri.analysis.LineOfSightAnalysisTarget`)],A);var j=p.ofType(A),M=class extends T{constructor(e){super(e),this.type=`line-of-sight`,this.observer=null,this.extent=null}initialize(){this.addHandles(y(()=>this._computeExtent(),e=>{e?.pending??this._set(`extent`,e==null?null:e.extent)},v))}get targets(){return this._get(`targets`)||new j}set targets(e){this._set(`targets`,S(e,this.targets,j))}get spatialReference(){return this.observer?.position==null?null:this.observer.position.spatialReference}get valid(){return this.observer?.position!=null}async waitComputeExtent(){let e=this._computeExtent();return e==null?Promise.resolve():e.pending}_computeExtent(){let e=this.spatialReference;if(this.observer?.position==null||e==null)return null;let t=e=>w(e.position,e.elevationInfo)===`absolute-height`,n=this.observer.position,r=i(n.x,n.y,n.z,n.x,n.y,n.z);for(let t of this.targets)if(t.position!=null){let n=o(t.position,e);if(n.pending!=null)return{pending:n.pending,extent:null};if(n.geometry!=null){let{x:e,y:t,z:i}=n.geometry;a(r,[e,t,i])}}let s=h(r,e);return t(this.observer)&&this.targets.every(t)||(s.zmin=void 0,s.zmax=void 0),{pending:null,extent:s}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&s(this.observer,e.observer)&&_(this.targets.toArray(),e.targets.toArray(),(e,t)=>e.equals(t))}};m([t({type:[`line-of-sight`]})],M.prototype,`type`,void 0),m([t({type:k,json:{read:!0,write:!0}})],M.prototype,`observer`,void 0),m([t({cast:f,type:j,nonNullable:!0,json:{read:!0,write:!0}})],M.prototype,`targets`,null),m([t({value:null,readOnly:!0})],M.prototype,`extent`,void 0),m([t()],M.prototype,`spatialReference`,null),m([t({readOnly:!0})],M.prototype,`valid`,null),M=m([d(`esri.analysis.LineOfSightAnalysis`)],M);var N=p.ofType(A),P=class extends r(u(l)){constructor(e){super(e),this.type=`line-of-sight`,this.operationalLayerType=`LineOfSightLayer`,this.analysis=new M,this.opacity=1}initialize(){this.addHandles(y(()=>this.analysis,(e,t)=>{t!=null&&t.parent===this&&(t.parent=null),e!=null&&(e.parent=this)},v))}async load(){return this.analysis!=null&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(e){let{analysis:t}=this;t&&(t.observer=e)}get targets(){return this.analysis==null?new p:this.analysis.targets}set targets(e){S(e,this.analysis?.targets)}get fullExtent(){return this.analysis==null?null:this.analysis.extent}get spatialReference(){return this.analysis==null?null:this.analysis.spatialReference}releaseAnalysis(e){this.analysis===e&&(this.analysis=new M)}};m([t({json:{read:!1},readOnly:!0})],P.prototype,`type`,void 0),m([t({type:[`LineOfSightLayer`]})],P.prototype,`operationalLayerType`,void 0),m([t({type:k,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],P.prototype,`observer`,null),m([t({type:N,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],P.prototype,`targets`,null),m([t({type:M,nonNullable:!0,json:{read:!1,write:!1}})],P.prototype,`analysis`,void 0),m([t({readOnly:!0})],P.prototype,`fullExtent`,null),m([t({readOnly:!0})],P.prototype,`spatialReference`,null),m([t({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],P.prototype,`opacity`,void 0),m([t({type:[`show`,`hide`]})],P.prototype,`listMode`,void 0),P=m([d(`esri.layers.LineOfSightLayer`)],P);var F=P;export{F as default};