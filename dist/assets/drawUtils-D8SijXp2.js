import{Cy as e,Gv as t,Sy as n,ZC as r,_y as i,iy as a,ly as o,py as s,tD as c,tx as l,vy as u,xy as d,zb as f}from"./index-ByaFsVj4.js";import{r as p}from"./GraphicManipulator-Bcgu8Y5Q.js";function m(e,t,n,r){if(r==null||e.hasZ||(r=void 0),e.type===`point`)return e.x+=t,e.y+=n,e.hasZ&&r!=null&&(e.z+=r),e;if(e.type===`multipoint`){let i=e.points;for(let e=0;e<i.length;e++)i[e]=_(i[e],t,n,r);return e}if(e.type===`extent`)return e.xmin+=t,e.xmax+=t,e.ymin+=n,e.ymax+=n,r!=null&&(e.zmin??=0,e.zmin+=r,e.zmax??=0,e.zmax+=r),e;let i=e.type===`polyline`?e.curvePaths??e.paths:e.curveRings??e.rings,a=u(e);for(let e=0;e<i.length;e++){let a=i[e];for(let e=0;e<a.length;e++)a[e]=v(a[e],t,n,r)}return`paths`in e?a?e.curvePaths=i:e.paths=i:a?e.curveRings=i:e.rings=i,e}function h(e,t,n,r,i){let a=e.clone();if(i){let{resolution:e}=r;m(a,t*e,-n*e)}else{let{dxMap:e,dyMap:i}=g(t,n,r);m(a,e,i)}return a}function g(e,t,n){let r=n.state.inverseTransform;return{dxMap:r[0]*e+r[2]*t,dyMap:r[1]*e+r[3]*t}}function _(e,t,n,r){return w(e,e[0]+t,e[1]+n,e[2]!=null&&r!=null?e[2]+r:void 0)}function v(e,t,r,a){let o=_(s(e),t,r,a);if(i(e))return o;if(d(e)){let[,n,i]=e.b;return{b:[o,[n[0]+t,n[1]+r],[i[0]+t,i[1]+r]]}}if(n(e)){let[,n]=e.c;return{c:[o,[n[0]+t,n[1]+r]]}}let[,c,...l]=e.a;return{a:[o,[c[0]+t,c[1]+r],...l]}}function y(e,n,r,i){if(e.type===`point`){let{x:t,y:a}=e,o=i?i[0]:t,s=i?i[1]:a,c=e.clone(),l=(t-o)*n+o,u=(a-s)*r+s;return c.x=l,c.y=u,c}if(e.type===`extent`){let{xmin:t,xmax:a,ymin:o,ymax:s}=e,c=i?i[0]:(t+a)/2,l=i?i[1]:(s+o)/2,u=e.clone();if(u.xmin=(t-c)*n+c,u.ymax=(s-l)*r+l,u.xmax=(a-c)*n+c,u.ymin=(o-l)*r+l,u.xmin>u.xmax){let e=u.xmin;u.xmin=u.xmax,u.xmax=e}if(u.ymin>u.ymax){let e=u.ymin;u.ymin=u.ymax,u.ymax=e}return u}let o=null;if(!i){o=t(e);let n=l(),r=a(n,o);if(!r)return e.clone();let[s,c,u,d]=r;i=[(s+u)/2,(c+d)/2]}let[u,d]=i;if(e.type===`multipoint`){let t=e.clone(),i=t.points;for(let e=0;e<i.length;e++){let t=i[e],[a,o]=t,s=(a-u)*n+u,c=(o-d)*r+d;i[e]=w(t,s,c,void 0)}return t.points=i,t}let p=e.clone();o??=t(e);let m=p.type===`polygon`,h=m?p.curveRings??p.rings:p.curvePaths??p.paths;if(!i){let e=l(),t=a(e,h,!1,!1);if(!t)return p;i=f(t)}for(let e of h){let t=null,i=m&&e.length>0&&c(s(e[0]),s(e.at(-1)));for(let i=0;i<e.length;i++){let a=e[i];e[i]=x(a,n,r,u,d,t),t=a}i&&(e[0]=[...s(e.at(-1))])}return p}function b(e,t,n,r,i){let[a,o,...s]=e;return[(a-r)*t+r,(o-i)*n+i,...s]}function x(t,r,a,c,l,u){if(i(t))return b(t,r,a,c,l);if(d(t)){let[e,n,i]=t.b.map(e=>b(e,r,a,c,l));return{b:[e,n,i]}}if(!u)return t;let f=s(u),m=n(t)?e(f,t):t,[h,g,_,v,y,x,S]=m.a,C=y??0,w=x??Math.hypot(h[0]-g[0],h[1]-g[1]),T=S??1,E=p(c,l,1,0,0,1,r,a);return o(f,{a:[[...h],[...g],_,v,C,w,T]},E)}function S(e,t,n,r,i,a){let o=Math.sqrt((n-e)*(n-e)+(r-t)*(r-t));return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t))/o}function C(e,t,n,i=!1){let a=Math.atan2(t.y-n.y,t.x-n.x)-Math.atan2(e.y-n.y,e.x-n.x),o=Math.atan2(Math.sin(a),Math.cos(a));return i?o:r(o)}function w(e,t,n,r){let i=[t,n];return e.length>2&&i.push(r??e[2]),e.length>3&&i.push(e[3]),i}export{h as a,g as i,S as n,C as r,y as t};