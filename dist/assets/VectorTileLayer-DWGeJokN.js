import{$T as e,A as t,AC as n,Ag as r,BT as i,CE as a,DS as o,Ex as s,FC as c,FE as l,HC as u,IS as d,L as f,LC as p,Li as m,Lx as h,M as g,MC as _,Ma as ee,Mg as te,Nx as v,Rh as ne,SC as y,Sg as b,UC as x,UT as re,Ua as ie,VC as S,VT as ae,WT as C,Wo as w,XE as T,YE as E,ZS as D,aT as O,ca as oe,dl as k,ew as se,hT as ce,j as le,jT as ue,kC as A,kD as j,mC as de,ma as fe,oT as pe,pT as M,pa as me,sT as N,ua as P,vE as F,vx as I,xC as L}from"./index-BN8X5Ryz.js";import"./memoryEstimations-D_IbKyOk.js";import"./TileInfoTilemapCache-DkoFuD4x.js";import{t as R}from"./TilemapCache-jwsQgZr5.js";import{t as z}from"./ArcGISCachedService-yM7NwnvX.js";import"./colorUtils-CzajW9E7.js";import"./constants-aR35pbTG.js";import"./GeometryUtils-B-8QW9FG.js";import{t as he}from"./StyleRepository-BJ1oLUi4.js";import"./VertexAttributeLocations-BScEla0R.js";import"./VertexElementDescriptor-Cl_nC_ty.js";var B=null;function ge(e){if(B)return B;let t={lossy:`UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA`,lossless:`UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==`,alpha:`UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==`,animation:`UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA`};return B=new Promise(n=>{let r=new Image;r.onload=()=>{r.onload=r.onerror=null,n(r.width>0&&r.height>0)},r.onerror=()=>{r.onload=r.onerror=null,n(!1)},r.src=`data:image/webp;base64,`+t[e]}),B}var V=1.15,H=class{constructor(e,t){this._spriteSource=e,this._maxTextureSize=t,this.devicePixelRatio=1,this._spriteImageFormat=`png`,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus=`not-loaded`,e.type===`url`&&e.spriteFormat&&(this._spriteImageFormat=e.spriteFormat),e.pixelRatio&&(this.devicePixelRatio=e.pixelRatio),this.baseURL=e.spriteUrl}get spriteNames(){let e=[];for(let t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData?this._spritesData[e]:null}async load(e){if(this.baseURL){this.loadStatus=`loading`;try{await this._loadSprites(e),this.loadStatus=`loaded`}catch{this.loadStatus=`failed`}}else this.loadStatus=`failed`}async _loadSprites(t){this._isRetina=this.devicePixelRatio>V;let{width:n,height:r,data:i,json:o}=await this._getSpriteData(this._spriteSource,t),s=Object.keys(o);if(!s||s.length===0||!i)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=o,this.width=n,this.height=r;let c=Math.max(this._maxTextureSize,4096);if(n>c||r>c){let t=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${c} pixels}`;throw a.getLogger(`esri.layers.support.SpriteSource`).error(t),new e(`SpriteSource`,t)}let l;for(let e=0;e<i.length;e+=4)l=i[e+3]/255,i[e]=i[e]*l,i[e+1]=i[e+1]*l,i[e+2]=i[e+2]*l;this.image=i}async _getSpriteData(t,n){if(t.type===`image`){let n,r;if(this.devicePixelRatio<V){if(!t.spriteSource1x)throw new e(`SpriteSource`,`no image data provided for low resolution sprites!`);n=t.spriteSource1x.image,r=t.spriteSource1x.json}else{if(!t.spriteSource2x)throw new e(`SpriteSource`,`no image data provided for high resolution sprites!`);n=t.spriteSource2x.image,r=t.spriteSource2x.json}return`width`in n&&`height`in n&&`data`in n&&(E(n.data)||T(n.data))?{width:n.width,height:n.height,data:new Uint8Array(n.data),json:r}:{...U(n),json:r}}let r=A(this.baseURL),i=r.query?`?`+L(r.query):``,a=this._isRetina?`@2x`:``,o=`${r.path}${a}.${this._spriteImageFormat}${i}`,s=`${r.path}${a}.json${i}`,[c,l]=await Promise.all([D(s,n),D(o,{responseType:`image`,...n})]);return{...U(l.data),json:c.data}}};function U(e){let t=document.createElement(`canvas`),n=t.getContext(`2d`);t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(r.data)}}var _e=class{constructor(e){this.url=e}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||=D(this.url).then(e=>e.data.index),this._tileIndexPromise}async dataKey(e,t){let n=await this.fetchTileIndex();return M(t),this._getIndexedDataKey(n,e)}_getIndexedDataKey(e,t){let n=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return null;let r=t;for(;r.level!==0;)r=new k(r.level-1,r.row>>1,r.col>>1,r.world),n.push(r);let i,a,o=e,s=n.pop();if(o===1)return s;for(;n.length;)if(i=n.pop(),a=(1&i.col)+((1&i.row)<<1),o){if(o[a]===0){s=null;break}if(o[a]===1){s=i;break}s=i,o=o[a]}return s}},ve=class{constructor(e,t){this._tilemap=e,this._tileIndexUrl=t}destroy(){this._tilemap=ue(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(e){return this._tileIndexPromise||=D(this._tileIndexUrl,{query:{...e?.query}}).then(e=>e.data.index),this._tileIndexPromise}dataKey(e,t){let{level:n,row:r,col:i}=e,a=new k(e);return this._tilemap.fetchAvailabilityUpsample(n,r,i,a,t).then(()=>(a.world=e.world,a)).catch(e=>{if(pe(e))throw e;return null})}},ye=class{constructor(e){this._tileUrl=e,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(e){(this._promise==null||O(this._abortController?.signal))&&(this._promise=this._makeRequest(this._tileUrl));let t=this._abortOptions;return t.push(e),ce(e,()=>{t.every(e=>O(e))&&this._abortController.abort()}),this._promise.then(e=>l(e))}async _makeRequest(e){this._abortController=new AbortController;let{data:t}=await D(e,{responseType:`array-buffer`,signal:this._abortController.signal});return t}},W=new Map;function be(e,t,n,r,i){let a=A(e),o=a.query;if(o)for(let[e,i]of Object.entries(o))switch(i){case`{x}`:o[e]=r.toString();break;case`{y}`:o[e]=n.toString();break;case`{z}`:o[e]=t.toString()}let s=a.path;return xe(y(s.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,n.toString()).replaceAll(/\{x\}/gi,r.toString()),{...a.query}),i)}function xe(e,t){return F(W,e,()=>new ye(e)).getData(t).finally(()=>W.delete(e))}var Se=class{constructor(e,t,n){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=e,this.sourceUrl=t;let i=A(this.sourceUrl),a=l(n),o=a.tiles;if(i)for(let e=0;e<o.length;e++){let t=A(o[e]);t&&(p(t.path)||(t.path=c(i.path,t.path)),o[e]=y(t.path,{...i.query,...t.query}))}this.tileServers=o;let s=n.capabilities&&n.capabilities.split(`,`).map(e=>e.toLowerCase().trim()),u=!0===n?.exportTilesAllowed,d=!0===s?.includes(`tilemap`),f=u&&n.hasOwnProperty(`maxExportTilesCount`)?n.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:u,supportsTileMap:d},exportTiles:u?{maxExportTilesCount:+f}:null},this.tileInfo=r.fromJSON(a.tileInfo);let m=n.tileMap?y(c(i.path,n.tileMap),i.query??{}):null;d?(this.type=`vector-tile`,this.tilemap=new ve(new R({layer:{parsedUrl:i,tileInfo:this.tileInfo},minLOD:a.minLOD??this.tileInfo.lods[0].level,maxLOD:a.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),m)):m&&(this.tilemap=new _e(m)),this.fullExtent=I.fromJSON(n.fullExtent),this.initialExtent=I.fromJSON(n.initialExtent)}destroy(){this.tilemap?.destroy()}async getRefKey(e,t){return this.tilemap?this.tilemap.dataKey(e,t):e}requestTile(e,t,n,r){let i=this.tileServers[t%this.tileServers.length];return be(i,e,t,n,r)}isCompatibleWith(e){let t=this.tileInfo,n=e.tileInfo;if(!t.spatialReference.equals(n.spatialReference)||!t.origin.equals(n.origin)||Math.round(t.dpi)!==Math.round(n.dpi))return!1;let r=t.lods,i=n.lods,a=Math.min(r.length,i.length);for(let e=0;e<a;e++){let t=r[e],n=i[e];if(t.level!==n.level||Math.round(t.scale)!==Math.round(n.scale))return!1}return!0}};async function Ce(e,t){let n={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:``,spriteFormat:`png`},[r,i]=typeof e==`string`?[e,null]:[null,e.jsonUrl];return await K(n,`esri`,e,i,t),{layerDefinition:n.validatedSource,url:r,serviceUrl:n.sourceUrl,style:n.style,styleUrl:n.styleUrl,spriteUrl:n.style&&n.style.sprite&&G(n.styleBase,n.style.sprite),spriteFormat:n.spriteFormat,glyphsUrl:n.style&&n.style.glyphs&&G(n.styleBase,n.style.glyphs),sourceNameToSource:n.sourceNameToSource,primarySourceName:n.primarySourceName}}function G(...e){let t;for(let n of e)n!=null&&(S(n)?t&&=t.split(`://`)[0]+`:`+n.trim():t=p(n)?n:c(t,n));return t?x(t):void 0}async function K(e,t,r,i,a){let o,s,c;if(M(a),typeof r==`string`){let e=n(r);c=await D(e,{...a,responseType:`json`,query:{f:`json`,...a?.query}}),c.ssl&&(o&&=o.replace(/^http:/i,`https:`),s&&=s.replace(/^http:/i,`https:`)),o=e,s=e}else r!=null&&(c={data:r},o=r.jsonUrl||null,s=i);let l=c?.data;if(J(l))return e.styleUrl=o||null,Te(e,l,s,a);if(we(l))return e.sourceUrl?Y(e,l,s,!1,t,a):(e.sourceUrl=o||null,q(l)&&e.style==null&&(t=`tilejson`),Y(e,l,s,!0,t,a));throw Error(`You must specify the URL or the JSON for a service or for a style.`)}function q(e){return typeof e==`object`&&!!e&&`tilejson`in e&&e.tilejson!=null}function J(e){return!!e&&`sources`in e&&!!e.sources}function we(e){return!J(e)}async function Te(e,t,n,r){let i=n?_(n):u();e.styleBase=i,e.style=t,t[`sprite-format`]&&t[`sprite-format`].toLowerCase()===`webp`&&(e.spriteFormat=`webp`);let a=[];if(t.sources&&t.sources.esri){let n=t.sources.esri;n.url?await K(e,`esri`,G(i,n.url),void 0,r):a.push(K(e,`esri`,n,i,r))}for(let n of Object.keys(t.sources))n!==`esri`&&n!==`tilejson`&&t.sources[n].type===`vector`&&(t.sources[n].url?a.push(K(e,n,G(i,t.sources[n].url),void 0,r)):t.sources[n].tiles&&a.push(K(e,n,t.sources[n],i,r)));await Promise.all(a)}async function Y(e,t,n,r,i,a){let o=n?x(n)+`/`:u(),s=Ee(t,e),c=new Se(i,y(o,a?.query??{}),s);if(!r&&e.primarySourceName in e.sourceNameToSource){let t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(c))return;c.fullExtent!=null&&(t.fullExtent==null?t.fullExtent=c.fullExtent.clone():t.fullExtent.union(c.fullExtent)),t.tileInfo&&c.tileInfo&&t.tileInfo.lods.length<c.tileInfo.lods.length&&(t.tileInfo=c.tileInfo)}if(r&&(e.sourceBase=o,e.source=t,e.validatedSource=s,e.primarySourceName=i),e.sourceNameToSource[i]=c,!q(e)&&`defaultStyles`in t&&!e.style){if(t.defaultStyles==null)throw Error();return typeof t.defaultStyles==`string`?K(e,``,G(o,t.defaultStyles,`root.json`),void 0,a):K(e,``,t.defaultStyles,G(o,`root.json`),a)}if(q(t)&&e.style==null&&s.defaultStyles)return K(e,``,s.defaultStyles,G(o,`root.json`),a)}function Ee(e,t){if(X(e)){let t=e?.tileInfo;return t!=null&&(t.rows??=512,t.cols??=512),e}let n={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100,latestWkid:3857}},r,i=null;if(q(e)){let{bounds:n,vector_layers:a}=e;if(n){let e=v({x:n[0],y:n[1],spatialReference:l(o)}),t=v({x:n[2],y:n[3],spatialReference:l(o)});i={xmin:e.x,ymin:e.y,xmax:t.x,ymax:t.y,spatialReference:l(d)}}if(a&&a.length>0)r={version:8,sprite:``,glyphs:``,sources:{tilejson:{type:`vector`,url:e.tilejson}},layers:De(a)};else if(t.style==null)throw Error(`The TileJSON source does not contain any vector_layers. This VectorTileLayer cannot be loaded.`)}i===null&&(i=n);let a=78271.51696400007,s=295828763.7957775,c=[],u=e.hasOwnProperty(`maxzoom`)&&e.maxzoom!=null?Math.abs(+e.maxzoom):22;for(let e=0;e<=u;e++)c.push({level:e,scale:s,resolution:a}),a/=2,s/=2;return{capabilities:`TilesOnly`,initialExtent:i,fullExtent:n,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:`pbf`,origin:{x:-20037508.342787,y:20037508.342787},lods:c,spatialReference:l(d)},defaultStyles:r}}function X(e){return e.hasOwnProperty(`tileInfo`)}function De(e){let t=[];for(let n of e)n.geometry_type?t.push(Z(n.geometry_type.toLowerCase(),n,!1)):(t.push(Z(`polygon`,n,!0)),t.push(Z(`line`,n,!0)),t.push(Z(`circle`,n,!0)));return t}function Z(e,t,n){let{id:r,minzoom:i,maxzoom:a}=t,o={type:e===`polygon`||e===`polygons`?`fill`:e===`line`||e===`lines`?`line`:`circle`,id:r,source:`tilejson`,"source-layer":r,minzoom:i,maxzoom:a};switch(e){case`fill`:n&&(o.id+=`_polygon`,o.filter=`(["==", "$type", "Polygon"])`),o.paint={"fill-color":`#808080`};break;case`line`:n&&(o.id+=`_line`,o.filter=`(["==", "$type", "LineString"])`);break;case`circle`:n&&(o.id+=`_point`,o.filter=`(["==", "$type", "Point"])`)}return o}var Q=1e-6;function Oe(e,t){if(e===t)return!0;if(e==null&&t!=null||e!=null&&t==null||e==null||t==null||!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;let n=e.origin,r=t.origin;if(Math.abs(n.x-r.x)>=Q||Math.abs(n.y-r.y)>=Q)return!1;let i,a;e.lods[0].scale>t.lods[0].scale?(i=e,a=t):(a=e,i=t);for(let e=i.lods[0].scale;e>=a.lods[a.lods.length-1].scale-Q;e/=2)if(Math.abs(e-a.lods[0].scale)<Q)return!0;return!1}function ke(e,t){if(e===t)return e;if(e==null&&t!=null)return t;if(e!=null&&t==null)return e;if(e==null||t==null)return null;let n=e.size[0],i=e.format,a=e.dpi,o=new s({x:e.origin.x,y:e.origin.y}),c=e.spatialReference,l=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],u=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],d=l.scale,f=l.resolution,p=u.scale,m=[],h=d,g=f,_=0;for(;h>=p;)m.push(new te({level:_,resolution:g,scale:h})),_++,h/=2,g/=2;return new r({size:[n,n],dpi:a,format:i||`pbf`,origin:o,lods:m,spatialReference:c})}var $=class extends P(t(le(z(me(f(g(oe(fe(ie(ne)))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType=`VectorTileLayer`,this.path=null,this.refreshInterval=0,this.style=null,this.tilemapCache=null,this.type=`vector-tile`}normalizeCtorArgs(e,t){return typeof e==`string`?{url:e,...t}:e}destroy(){if(this.sourceNameToSource)for(let e of Object.values(this.sourceNameToSource))e?.destroy();this.primarySource?.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){let t=this.loadFromPortal({supportedTypes:[`Vector Tile Service`],supportsData:!1},e).catch(N).then(async()=>{if(!this.portalItem?.id)return;let t=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await D(t,{...e,query:{f:`json`,...this.customParameters,token:this.apiKey},authMode:this.portalItem.portal.authMode})).data&&this.read({url:t},ee(this.portalItem,`portal-item`))}).catch(N).then(()=>this._loadStyle(e));return this.addResolvingPromise(t),Promise.resolve(this)}get apiKey(){return super.apiKey}set apiKey(e){super.apiKey=e}get portalItem(){return super.portalItem}set portalItem(e){super.portalItem=e}get attributionDataUrl(){let e=this.currentStyleInfo,t=e?.serviceUrl&&A(e.serviceUrl);if(!t)return null;let n=this._getDefaultAttribution(t.path);return n?y(n,{...this.customParameters,token:this.apiKey}):null}get capabilities(){let e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){return this.primarySource?.fullExtent||null}get initialExtent(){return this.primarySource?.initialExtent||null}get parsedUrl(){return this.serviceUrl?A(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo?.serviceUrl||null}get spatialReference(){return this.tileInfo?.spatialReference??null}get styleUrl(){return this.currentStyleInfo?.styleUrl||null}writeStyleUrl(e,t){e&&S(e)&&(e=`https:${e}`);let n=se(e);t.styleUrl=de(e,n)}get tileInfo(){let e=[];for(let t in this.sourceNameToSource)e.push(this.sourceNameToSource[t]);let t=this.primarySource?.tileInfo||new r;if(e.length>1)for(let n=0;n<e.length;n++)Oe(t,e[n].tileInfo)&&(t=ke(t,e[n].tileInfo));return t}readTilemapCache(e,t){return t.capabilities?.includes(`Tilemap`)?new R({layer:this}):null}set url(e){if(!e)return void this._set(`url`,e);let t=A(e);this._set(`url`,t.path),t.query&&(this.customParameters={...this.customParameters,...t.query})}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){let n=w().maxTextureSize,r=this.currentStyleInfo?.spriteUrl?y(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,i=new H({type:`url`,spriteUrl:r,pixelRatio:e,spriteFormat:this.currentStyleInfo?.spriteFormat},n);await i.load(t),this._spriteSourceMap.set(e,i)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;let n=w().maxTextureSize,r=e.spriteUrl,i=r?y(r,{...this.customParameters,token:this.apiKey}):null;if(!i&&e.type===`url`)return null;let a=new H(e,n);try{await a.load(t);let n=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(n,a),i&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=i),this.emit(`spriteSource-change`,{spriteSource:a}),a}catch(e){N(e)}return null}async loadStyle(e,t){let n=e||this.style||this.url;return this._loadingTask&&typeof n==`string`&&this.url===n||(this._loadingTask?.abort(),this._loadingTask=b(e=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(n,{signal:e})),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return l(this.styleRepository?.getPaintProperties(e))}setPaintProperties(e,t){let n=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);let r=this.styleRepository.isPainterDataDriven(e);this.emit(`paint-change`,{layer:e,paint:t,isDataDriven:n||r})}getStyleLayer(e){return l(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit(`style-layer-change`,{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit(`delete-style-layer`,{layer:e})}getLayoutProperties(e){return l(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit(`layout-change`,{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit(`style-layer-visibility-change`,{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(t,n){return n?.origin&&!this.styleUrl?(n.messages&&n.messages.push(new e(`vectortilelayer:unsupported`,`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(t,n)}getTileUrl(e,t,n){return null}async _getSourceAndStyle(e,t){if(!e)throw Error(`invalid style!`);let n=await Ce(e,{...t,query:{...this.customParameters,token:this.apiKey}});n.spriteFormat===`webp`&&(await ge(`lossy`)||(n.spriteFormat=`png`)),this._set(`currentStyleInfo`,{...n}),typeof e==`string`?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set(`sourceNameToSource`,n.sourceNameToSource),this._set(`primarySource`,n.sourceNameToSource[n.primarySourceName]),this._set(`styleRepository`,new he(n.style,!1)),this.read(n.layerDefinition,{origin:`service`}),this.emit(`load-style`)}_getDefaultAttribution(e){let t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i),r=[`OpenBasemap_v2`,`OpenBasemap_GCS_v2`,`OpenStreetMap_v2`,`OpenStreetMap_Daylight_v2`,`OpenStreetMap_Export_v2`,`OpenStreetMap_FTS_v2`,`OpenStreetMap_GCS_v2`,`World_Basemap`,`World_Basemap_v2`,`World_Basemap_Export_v2`,`World_Basemap_GCS_v2`,`World_Basemap_WGS84`,`World_Contours_v2`,`World_Hillshade_v2`];if(!t)return;let i=t[2]&&t[2].toLowerCase();if(!i)return;let a=t[1]||``;for(let e of r)if(e.toLowerCase().includes(i))return n(`//static.arcgis.com/attribution/Vector${a}/${e}`)}async _loadStyle(e){return this._loadingTask?.promise??this.loadStyle(null,e)}};j([i({readOnly:!0})],$.prototype,`attributionDataUrl`,null),j([i({type:[`show`,`hide`]})],$.prototype,`listMode`,void 0),j([i({json:{read:!0,write:!0}})],$.prototype,`blendMode`,void 0),j([i({readOnly:!0,json:{read:!1}})],$.prototype,`capabilities`,null),j([i({readOnly:!0})],$.prototype,`currentStyleInfo`,void 0),j([i({json:{read:!1},readOnly:!0,type:I})],$.prototype,`fullExtent`,null),j([i({json:{read:!1},readOnly:!0,type:I})],$.prototype,`initialExtent`,null),j([i({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],$.prototype,`isReference`,void 0),j([i({type:[`VectorTileLayer`]})],$.prototype,`operationalLayerType`,void 0),j([i({readOnly:!0})],$.prototype,`parsedUrl`,null),j([i({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],$.prototype,`path`,void 0),j([i({type:Number,json:{write:!1,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],$.prototype,`refreshInterval`,void 0),j([i()],$.prototype,`style`,void 0),j([i({readOnly:!0})],$.prototype,`serviceUrl`,null),j([i({type:h,readOnly:!0})],$.prototype,`spatialReference`,null),j([i({readOnly:!0})],$.prototype,`styleRepository`,void 0),j([i({readOnly:!0})],$.prototype,`sourceNameToSource`,void 0),j([i({readOnly:!0})],$.prototype,`primarySource`,void 0),j([i({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],$.prototype,`styleUrl`,null),j([re([`portal-item`,`web-document`],`styleUrl`)],$.prototype,`writeStyleUrl`,null),j([i({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:r})],$.prototype,`tileInfo`,null),j([i()],$.prototype,`tilemapCache`,void 0),j([C(`service`,`tilemapCache`,[`capabilities`,`tileInfo`])],$.prototype,`readTilemapCache`,null),j([i({json:{read:!1},readOnly:!0,value:`vector-tile`})],$.prototype,`type`,void 0),j([i({json:{origins:{"web-document":{read:{source:`styleUrl`}},"portal-item":{read:{source:`url`}}},write:!1,read:!1}}),i(m)],$.prototype,`url`,null),j([i({readOnly:!0})],$.prototype,`version`,void 0),j([C(`version`,[`version`,`currentVersion`])],$.prototype,`readVersion`,null),$=j([ae(`esri.layers.VectorTileLayer`)],$);var Ae=$;export{Ae as default};