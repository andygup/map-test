import{$_ as e,Cb as t,Cl as n,DT as r,Db as i,Eb as a,Fw as o,Gh as s,Iw as c,Ja as l,Nu as u,OT as d,Ol as ee,Qh as te,Rc as ne,Rl as re,_w as f,au as p,c_ as ie,cu as ae,dw as oe,eg as se,eu as ce,gD as m,iu as le,jl as ue,nu as de,ov as fe,pD as pe,px as me,su as he,tu as ge,u_ as _e,uv as ve,vD as h,vT as ye}from"./index-ByaFsVj4.js";import{f as g}from"./WGLContainer-CiXk9por.js";import{A as be,B as xe,D as Se,H as _,I as Ce,It as v,J as we,L as Te,M as y,Mt as b,Tt as x,U as S,W as Ee,Y as De,_ as C,_t as Oe,a as w,c as T,ct as ke,dt as E,gt as Ae,h as je,i as Me,it as Ne,j as Pe,jt as Fe,k as Ie,kt as Le,l as D,mt as Re,n as O,ot as ze,q as k,r as A,s as j,st as Be,t as M,tt as Ve,u as N,v as P,wt as He,x as Ue,y as We,z as F}from"./GraphShaderModule-VKGmZBI7.js";import{c as Ge}from"./constants-TfCITEY_.js";import{a as I,l as Ke,o as qe,s as Je}from"./utils-CXmRmFbM.js";import{t as Ye}from"./CircularArray-DMZDYVGN.js";import{t as Xe}from"./DisjointTimerQuery-DtAX08b4.js";import{t as Ze}from"./SymbolFader-DLYhimu0.js";var Qe={vertexShader:g(`bitBlit/bitBlit.vert`),fragmentShader:g(`bitBlit/bitBlit.frag`)},$e={vertexShader:g(`stencil/stencil.vert`),fragmentShader:g(`stencil/stencil.frag`)},et=class extends M{};m([w(0,F)],et.prototype,`position`,void 0);var tt=class extends O{},L=class extends N{};m([T(y)],L.prototype,`layerTexture`,void 0),m([T(y)],L.prototype,`backbufferTexture`,void 0),m([T(C)],L.prototype,`opacity`,void 0),m([T(C)],L.prototype,`inFadeOpacity`,void 0);var R=class extends A{constructor(){super(...arguments),this.type=`BlendShader`}vertex(e){return{uv:e.position,glPosition:new k(Ke(e.position),0,1)}}fragment(e){let t=new D,n=b(this.config.layerTexture,e.uv),r=b(this.config.backbufferTexture,e.uv),i=v(P(n.a,new C(0)),n.rgb,n.rgb.divide(n.a)),a=v(P(r.a,new C(0)),r.rgb,r.rgb.divide(r.a)),o=this.config.opacity.multiply(n.a),s=r.a;switch(this.blendMode){case`destination-over`:t.fragColor=new k(i.multiply(o).multiply(I(s)).add(a.multiply(s)),o.add(s).subtract(o.multiply(s)));break;case`source-in`:{let e=new k(i.multiply(o).multiply(s),o.multiply(s)),n=new k(a.multiply(s),s).multiply(I(this.config.opacity)).multiply(this.config.inFadeOpacity);t.fragColor=e.add(n)}break;case`destination-in`:{let e=new k(a.multiply(s).multiply(o),s.multiply(o)),n=new k(a.multiply(s),s).multiply(new k(I(this.config.opacity).multiply(this.config.inFadeOpacity)));t.fragColor=e.add(n)}break;case`source-out`:t.fragColor=new k(i.multiply(o).multiply(I(s)),o.multiply(I(s)));break;case`destination-out`:t.fragColor=new k(a.multiply(s).multiply(I(o)),s.multiply(I(o)));break;case`source-atop`:t.fragColor=new k(i.multiply(o).multiply(s).add(a.multiply(s.multiply(I(o)))),s);break;case`destination-atop`:t.fragColor=new k(i.multiply(o.multiply(I(s))).add(a.multiply(s).multiply(o)),o);break;case`xor`:t.fragColor=new k(i.multiply(o.multiply(I(s))).add(a.multiply(s.multiply(I(o)))),o.multiply(I(s)).add(s.multiply(I(o))));break;case`multiply`:t.fragColor=new k(i.multiply(o).multiply(a.multiply(s)).add(i.multiply(o).multiply(I(s))).add(a.multiply(s).multiply(I(o))),o.add(s.multiply(I(o))));break;case`screen`:t.fragColor=new k(i.add(a).subtract(i.multiply(a)).multiply(o.multiply(s)).add(i.multiply(o).multiply(I(s))).add(a.multiply(s).multiply(I(o))),o.add(s.multiply(I(o))));break;case`overlay`:{let e=new _(nt(a.r,i.r),nt(a.g,i.g),nt(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`darken`:{let e=S(i,a);t.fragColor=z(e,i,a,o,s)}break;case`lighter`:t.fragColor=new k(i.multiply(o).add(a.multiply(s)),o.add(s));break;case`lighten`:{let e=xe(i,a);t.fragColor=z(e,i,a,o,s)}break;case`color-dodge`:{let e=x(new _(rt(a.r,i.r),rt(a.g,i.g),rt(a.b,i.b)),new _(0),new _(1));t.fragColor=z(e,i,a,o,s)}break;case`color-burn`:{let e=new _(it(a.r,i.r),it(a.g,i.g),it(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`hard-light`:{let e=new _(at(a.r,i.r),at(a.g,i.g),at(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`soft-light`:{let e=new _(ot(a.r,i.r),ot(a.g,i.g),ot(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`difference`:{let e=Se(a.subtract(i));t.fragColor=z(e,i,a,o,s)}break;case`exclusion`:{let e=i.add(a).subtract(new C(2).multiply(i).multiply(a));t.fragColor=z(e,i,a,o,s)}break;case`invert`:t.fragColor=new k(new _(1).subtract(a).multiply(o).multiply(s).add(a.multiply(s).multiply(I(o))),s);break;case`vivid-light`:{let e=new _(x(st(a.r,i.r),new C(0),new C(1)),x(st(a.g,i.g),new C(0),new C(1)),x(st(a.b,i.b),new C(0),new C(1)));t.fragColor=z(e,i,a,o,s)}break;case`hue`:{let e=mt(i,a,a);t.fragColor=z(e,i,a,o,s)}break;case`saturation`:{let e=mt(a,i,a);t.fragColor=z(e,i,a,o,s)}break;case`color`:{let e=pt(i,a);t.fragColor=z(e,i,a,o,s)}break;case`luminosity`:{let e=pt(a,i);t.fragColor=z(e,i,a,o,s)}break;case`plus`:t.fragColor=x(new k(n.r.add(a.r),n.g.add(a.g),n.b.add(a.b),o.add(s)),new k(0),new k(1));break;case`minus`:t.fragColor=new k(x(new _(a.r.subtract(n.r),a.g.subtract(n.g),a.b.subtract(n.b)),new _(0),new _(1)),s.multiply(o));break;case`average`:{let e=a.add(i).divide(2);t.fragColor=z(e,i,a,o,s)}break;case`reflect`:{let e=x(new _(ht(a.r,i.r),ht(a.g,i.g),ht(a.b,i.b)),new _(0),new _(1));t.fragColor=z(e,i,a,o,s)}break;default:t.fragColor=n.multiply(this.config.opacity)}return t}};function z(e,t,n,r,i){return new k(e.multiply(r).multiply(i).add(t.multiply(r).multiply(I(i))).add(n.multiply(i).multiply(I(r))),r.add(i.multiply(I(r))))}function nt(e,t){return new C(1).subtract(E(new C(.5),t)).multiply(I(new C(2).multiply(I(t).multiply(I(e))))).add(E(new C(.5),t).multiply(new C(2).multiply(t).multiply(e)))}function rt(e,t){return v(P(e,new C(0)),new C(0),v(P(t,new C(1)),new C(1),S(new C(1),e.divide(new C(1).subtract(t)))))}function it(e,t){return v(P(e,new C(1)),new C(1),v(P(t,new C(0)),new C(0),I(S(new C(1),I(e).divide(t)))))}function at(e,t){return new C(1).subtract(E(new C(.5),t)).multiply(new C(2).multiply(t).multiply(e)).add(E(new C(.5),t).multiply(I(new C(2).multiply(I(t).multiply(I(e))))))}function ot(e,t){return Pe([De(t,new C(.5)),()=>{let n=new C(2).multiply(t),r=I(n),i=I(e);return e.subtract(r.multiply(e).multiply(i))}],[De(e,new C(.25)),()=>{let n=new C(2).multiply(t),r=qe(n).multiply(e),i=new C(16).multiply(e).subtract(new C(12)).multiply(e).add(new C(3));return e.add(r.multiply(i))}],[!0,()=>{let n=new C(2).multiply(t),r=qe(n),i=Ne(e).subtract(e);return e.add(r.multiply(i))}])}function st(e,t){let n=I(E(new C(.5),t)).multiply(it(e,new C(2).multiply(t))),r=E(new C(.5),t).multiply(rt(e,new C(2).multiply(Je(t,.5))));return n.add(r)}function ct(e){return S(S(e.r,e.g),e.b)}function lt(e){return xe(xe(e.r,e.g),e.b)}function ut(e){return Fe(e,new _(.3,.59,.11))}function dt(e){return lt(e).subtract(ct(e))}function ft(e){let t=ut(e),n=ct(e),r=lt(e);return Pe([Ee(n,new C(0)),()=>{let r=e.subtract(t).multiply(t),i=t.subtract(n);return t.add(r.divide(i))}],[Ue(r,new C(1)),()=>{let n=e.subtract(t),i=I(t),a=n.multiply(i),o=r.subtract(t);return t.add(a.divide(o))}],[!0,e])}function pt(e,t){let n=ut(e),r=ut(t).subtract(n);return ft(e.add(new _(r)))}function mt(e,t,n){let r=ct(e),i=dt(e),a=dt(t);return pt(v(Ue(i,new C(0)),()=>e.subtract(r).multiply(a).divide(i),new _(0)),n)}function ht(e,t){return v(P(t,new C(1)),t,()=>{let n=I(t),r=e.multiply(e).divide(n);return S(r,new C(1))})}m([Me],R.prototype,`blendMode`,void 0),m([T(L)],R.prototype,`config`,void 0),m([h(0,j(et))],R.prototype,`vertex`,null),m([h(0,j(tt))],R.prototype,`fragment`,null);var gt=class extends M{};m([w(0,F)],gt.prototype,`position`,void 0);var _t=class extends O{},vt=class extends N{};m([T(y)],vt.prototype,`layerTexture`,void 0),m([T(C)],vt.prototype,`opacity`,void 0);var yt=class extends A{constructor(){super(...arguments),this.type=`OpacityShader`}vertex(e){return{uv:e.position,glPosition:new k(e.position.subtract(new F(.5)).multiply(2),0,1)}}fragment(e){let t=new D;return t.fragColor=b(this.config.layerTexture,e.uv).multiply(this.config.opacity),t}};m([T(vt)],yt.prototype,`config`,void 0),m([h(0,j(gt))],yt.prototype,`vertex`,null),m([h(0,j(_t))],yt.prototype,`fragment`,null);var bt={vertexShader:g(`highlight/textured.vert`),fragmentShader:g(`highlight/highlight.frag`)},xt={vertexShader:g(`highlight/textured.vert`),fragmentShader:g(`highlight/blur.frag`)},St=class extends M{};m([w(0,F)],St.prototype,`position`,void 0);var B=class extends O{},V=class extends A{constructor(){super(...arguments),this.type=`PostProcessingShader`}vertex(e){return{uv:e.position,glPosition:new k(Ke(e.position),0,1)}}};m([h(0,j(St))],V.prototype,`vertex`,null);var Ct=class extends N{};m([T(y)],Ct.prototype,`blitTexture`,void 0);var wt=class extends V{fragment(e){let t=new D;return t.fragColor=b(this.blitConfig.blitTexture,e.uv),t}};m([T(Ct)],wt.prototype,`blitConfig`,void 0),m([h(0,j(B))],wt.prototype,`fragment`,null);var H=class extends N{};m([T(y)],H.prototype,`luminosityTexture`,void 0),m([T(_)],H.prototype,`defaultColor`,void 0),m([T(C)],H.prototype,`defaultOpacity`,void 0),m([T(C)],H.prototype,`luminosityThreshold`,void 0),m([T(C)],H.prototype,`smoothWidth`,void 0);var Tt=class extends V{constructor(){super(...arguments),this.type=`LuminosityHighPassShader`}fragment(e){let t=new D,n=b(this.luminosityHighPassConfig.luminosityTexture,e.uv),r=new _(.299,.587,.114),i=Fe(n.xyz,r),a=new k(this.luminosityHighPassConfig.defaultColor.rgb,this.luminosityHighPassConfig.defaultOpacity),o=Oe(this.luminosityHighPassConfig.luminosityThreshold,this.luminosityHighPassConfig.luminosityThreshold.add(this.luminosityHighPassConfig.smoothWidth),i);return t.fragColor=we(a,n,o),t}};m([T(H)],Tt.prototype,`luminosityHighPassConfig`,void 0),m([h(0,j(B))],Tt.prototype,`fragment`,null);var U=class extends N{};m([T(y)],U.prototype,`blurTexture1`,void 0),m([T(y)],U.prototype,`blurTexture2`,void 0),m([T(y)],U.prototype,`blurTexture3`,void 0),m([T(y)],U.prototype,`blurTexture4`,void 0),m([T(y)],U.prototype,`blurTexture5`,void 0),m([T(C)],U.prototype,`bloomStrength`,void 0),m([T(C)],U.prototype,`bloomRadius`,void 0),m([T(je.ofType(C,5))],U.prototype,`bloomFactors`,void 0),m([T(_)],U.prototype,`bloomTintColor`,void 0);var Et=class extends V{constructor(){super(...arguments),this.type=`CompositeShader`}fragment(e){let t=new D,{blurTexture1:n,blurTexture2:r,blurTexture3:i,blurTexture4:a,blurTexture5:o,bloomStrength:s,bloomFactors:c,bloomTintColor:l}=this.compositeConfig,u=this._lerpBloomFactor(c[0]).multiply(new k(l,1).multiply(b(n,e.uv))),d=this._lerpBloomFactor(c[1]).multiply(new k(l,1).multiply(b(r,e.uv))),ee=this._lerpBloomFactor(c[2]).multiply(new k(l,1).multiply(b(i,e.uv))),te=this._lerpBloomFactor(c[3]).multiply(new k(l,1).multiply(b(a,e.uv))),ne=this._lerpBloomFactor(c[4]).multiply(new k(l,1).multiply(b(o,e.uv))),re=s.multiply(u.add(d.add(ee.add(te.add(ne)))));return t.fragColor=x(re,new C(0),new C(1)),t}_lerpBloomFactor(e){let t=new C(1.2).subtract(e);return we(e,t,this.compositeConfig.bloomRadius)}};m([Me],Et.prototype,`numMips`,void 0),m([T(U)],Et.prototype,`compositeConfig`,void 0),m([h(0,j(B))],Et.prototype,`fragment`,null);var Dt=class extends N{};m([T(y)],Dt.prototype,`texture`,void 0),m([T(F)],Dt.prototype,`texSize`,void 0),m([T(F)],Dt.prototype,`direction`,void 0),m([T(C)],Dt.prototype,`sigma`,void 0);var Ot=class extends V{constructor(){super(...arguments),this.type=`GaussianBlurShader`}fragment(e){let t=new D,n=new C(1).divide(this.gaussianBlurConfig.texSize),r=this.gaussianBlurConfig.sigma,i=kt(new C(0),r),a=b(this.gaussianBlurConfig.texture,e.uv).multiply(i);for(let t=1;t<this.kernelRadius;t++){let o=new C(t),s=kt(o,r),c=this.gaussianBlurConfig.direction.multiply(n).multiply(o),l=b(this.gaussianBlurConfig.texture,e.uv.add(c)),u=b(this.gaussianBlurConfig.texture,e.uv.subtract(c));a=a.add(l.multiply(s)).add(u.multiply(s)),i=i.add(new C(2).multiply(s))}return t.fragColor=a.divide(i),t}};function kt(e,t){return new C(.39894).multiply(Ve(new C(-.5).multiply(e).multiply(e).divide(t.multiply(t))).divide(t))}m([Me],Ot.prototype,`kernelRadius`,void 0),m([T(Dt)],Ot.prototype,`gaussianBlurConfig`,void 0),m([h(0,j(B))],Ot.prototype,`fragment`,null);var At=class extends N{};m([T(y)],At.prototype,`texture`,void 0);var jt=1,Mt=2.2,Nt=[-.08,-.05,-.03,-.02,-.01,.01,.02,.03,.05,.08],Pt=class extends V{constructor(){super(...arguments),this.type=`RadialBlurShader`}fragment(e){let t=new D,n=new C(.5).subtract(e.uv),r=Ne(n.x.multiply(n.y).add(n.y.multiply(n.y)));n=n.divide(r);let i=b(this.radialBlurConfig.texture,e.uv),a=i;for(let t=0;t<10;t++){let r=b(this.radialBlurConfig.texture,e.uv.add(n).multiply(new C(Nt[t]).multiply(jt)));a=a.add(r)}let o=new C(1).divide(new C(11));a=a.multiply(o);let s=r.multiply(Mt);return s=x(s,new C(0),new C(1)),t.fragColor=we(i,a,s),t}};m([Me],Pt.prototype,`kernelRadius`,void 0),m([T(At)],Pt.prototype,`radialBlurConfig`,void 0),m([h(0,j(B))],Pt.prototype,`fragment`,null);var Ft=class extends N{};m([T(y)],Ft.prototype,`colorTexture`,void 0),m([T(Be)],Ft.prototype,`coefficients`,void 0);var It=class extends V{constructor(){super(...arguments),this.type=`FilterEffectShader`}fragment(e){let t=new D,n=b(this.filterEffectConfig.colorTexture,e.uv),r=v(Ue(n.a,new C(0)),n.rgb.divide(n.a),new _(0)),i=this.filterEffectConfig.coefficients.multiply(new k(r,1)),a=n.a;return t.fragColor=new k(a.multiply(i.rgb),a),t}};m([T(Ft)],It.prototype,`filterEffectConfig`,void 0),m([h(0,j(B))],It.prototype,`fragment`,null);var W=class extends N{};m([T(y)],W.prototype,`layerFBOTexture`,void 0),m([T(y)],W.prototype,`blurTexture`,void 0),m([T(k)],W.prototype,`shadowColor`,void 0),m([T(F)],W.prototype,`shadowOffset`,void 0),m([T(He)],W.prototype,`displayViewMat3`,void 0);var Lt=class extends V{constructor(){super(...arguments),this.type=`CompositeShader`}fragment(e){let t=new D,{layerFBOTexture:n,blurTexture:r,shadowColor:i,shadowOffset:a,displayViewMat3:o}=this.compositeConfig,s=o.multiply(new _(a,new C(0))),c=b(n,e.uv);return t.fragColor=b(r,e.uv.subtract(s.xy.divide(2))).a.multiply(i).multiply(new C(1).subtract(c.a)).add(c),t}};m([T(W)],Lt.prototype,`compositeConfig`,void 0),m([h(0,j(B))],Lt.prototype,`fragment`,null);var G=!!pe(`esri-2d-profiler`),Rt=class{constructor(e,t){if(this._events=new fe,this._entries=new Map,this._timings=new Ye(10),this._currentContainer=null,this._currentPass=null,this._currentBrush=null,this._currentSummary=null,!G)return;this._ext=Xe(e.gl,{}),this._debugOutput=t;let n=e.gl;if(!this.enableCommandLogging)return;let r;for(r in n)if(typeof n[r]==`function`){let e=n[r],t=r.includes(`draw`);n[r]=(...i)=>(this._events.emit(`command`,{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:r,args:i,isDrawCommand:t}),this._currentSummary&&(this._currentSummary.commands++,t&&this._currentSummary.drawCommands++),e.apply(n,i))}}get enableCommandLogging(){return typeof G==`object`&&G.commandLogging}get enableTimeLogging(){return typeof G==`object`&&G.timeLogging}get lastTime(){return this._timings.peekLast()}recordContainerStart(e){G&&(this._currentContainer=e)}recordContainerEnd(){G&&(this._currentContainer=null)}recordPassStart(e){G&&(this._currentPass=e,this._initSummary())}recordPassEnd(){G&&(this._currentPass=null,this._emitSummary())}recordBrushStart(e){G&&(this._currentBrush=e)}recordBrushEnd(){G&&(this._currentBrush=null)}recordStart(e){if(G&&this._ext!=null){if(this._entries.has(e)){let t=this._entries.get(e),n=this._ext.resultAvailable(t.query),r=this._ext.disjoint();if(n&&!r){let n=this._ext.getResult(t.query)/1e6,r=0;if(this._timings.enqueue(n)!=null&&this.enableTimeLogging){let e=this._timings.entries,t=e.length,n=0;for(let t of e)n+=t;r=n/t}let i=n.toFixed(2),a=r?r.toFixed(2):`--`;this.enableCommandLogging?(this.enableTimeLogging?console.groupCollapsed(`Frame report for ${e}, ${i} ms (${a} last 10 avg)\n              ${t.commandsLen} Commands (${t.drawCommands} draw)`):console.groupCollapsed(`Frame report for ${e}\n              ${t.commandsLen} Commands (${t.drawCommands} draw)`),console.log(`RenderPass breakdown: `),console.table(t.summaries),console.log(`Commands: `,t.commands),console.groupEnd()):this.enableTimeLogging&&console.log(`Frame report for ${e}, ${i} ms (${a} last 10 avg)`),this.enableTimeLogging&&(this._debugOutput.innerHTML=`${i} (${a})`)}for(let e of t.handles)e.remove();this._ext.deleteQuery(t.query),this._entries.delete(e)}let t={name:e,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(t.handles.push(this._events.on(`command`,e=>{t.commandsLen++,t.commands.push(e),e.isDrawCommand&&t.drawCommands++})),t.handles.push(this._events.on(`summary`,e=>{t.summaries.push(e)}))),this._ext.beginTimeElapsed(t.query),this._entries.set(e,t)}}recordEnd(e){G&&this._ext!=null&&this._entries.has(e)&&this._ext.endTimeElapsed()}_initSummary(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})}_emitSummary(){this.enableCommandLogging&&this._currentSummary&&this._events.emit(`summary`,this._currentSummary)}},zt=class extends M{};m([w(0,F)],zt.prototype,`position`,void 0),m([w(1,F)],zt.prototype,`texcoord`,void 0),m([w(2,C)],zt.prototype,`w`,void 0);var Bt=class extends O{},Vt=class extends N{};m([T(y)],Vt.prototype,`texture`,void 0),m([T(C)],Vt.prototype,`opacity`,void 0);var Ht=class extends A{constructor(){super(...arguments),this.type=`VideoScreenShader`}vertex(e){let{position:t,texcoord:n,w:r}=e;return{glPosition:new k(t,0,r),texcoord:n}}fragment(e){let t=new D;return t.fragColor=b(this.config.texture,e.texcoord).multiply(this.config.opacity),t}};m([T(Vt)],Ht.prototype,`config`,void 0),m([h(0,j(zt))],Ht.prototype,`vertex`,null),m([h(0,j(Bt))],Ht.prototype,`fragment`,null);var Ut=64,Wt=class{constructor(){this.styles=new Map,this.layerContexts=new Map}get cachedStyles(){return this.styles}setLabelClassStyle(e,t,n){this.layerContexts.set(e,t),this.styles.set(e,n)}removeContainer(e){for(let[t,n]of this.layerContexts.entries())n===e&&this.layerContexts.delete(t)}},K=class extends f{constructor(e){super(e),this._faderWorkingSet=[],this._styleRepository=new Wt,this.lastUpdateId=-1,this.updateRequested=!1,this.view=null,this.symbolFader=new Ze(`feature-tile`,this._styleRepository,(e,t)=>{e.updateLabelVisibility(),e.requestRender(),e.isReady&&(e.decluttered=!0)},this._faderWorkingSet,512,Ut)}get updating(){return pe(`esri-2d-log-updating`)&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`),this.updateRequested}viewChange(){this.requestUpdate()}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view?.requestUpdate())}processUpdate(e){this.doUpdate(e)?this.updateRequested=!1:(this.updateRequested=!0,this.view?.requestUpdate())}setLabelSchemaStyles(e,t){let n;switch(e.type){case`label`:n=e.classes;break;case`subtype`:n=Array.from(Object.values(e.renderers).flatMap(e=>e.classes));break;case`cluster`:n=[...e.cluster.classes,...e.feature.classes];break;case`track`:n=[...e.latestObservation.classes,...e.previousObservation.classes,...e.trackLine.classes]}for(let e of n){let n=Gt(e);this._styleRepository.setLabelClassStyle(e.labelClassId,t,n)}}removeContainer(e){this._styleRepository.removeContainer(e),this.requestUpdate()}doUpdate(e){this._faderWorkingSet.length=0;let t=this.view;if(!t)return!1;let n=t.allLayerViews.map(e=>e.featureContainer).filter(e=>!!e&&e?.hasLabels);if(n.length>0){for(let t of n)for(let n of t.tiles||[])n.setTransform(e.state),this._faderWorkingSet.push(n);let r=e.state.scale,i=t.featuresTilingScheme.scaleToZoom(r);return this.symbolFader.update(i,e.state)}return!0}};function Gt(e){let t=e.geometryType===`esriGeometryPolyline`?0:1,n=e.geometryType===`esriGeometryPolyline`?0:1;return{geometryType:e.geometryType,iconAllowOverlap:!e.deconflictionEnabled,iconIgnorePlacement:!1,textAllowOverlap:!e.deconflictionEnabled,textIgnorePlacement:!1,iconRotationAlignment:t,textRotationAlignment:t,iconTranslateAnchor:n,iconTranslate:[0,0],textTranslateAnchor:n,textTranslate:[0,0]}}m([r()],K.prototype,`updateRequested`,void 0),m([r()],K.prototype,`updating`,null),m([r()],K.prototype,`view`,void 0),K=m([d(`esri.views.2d.LabelManager`)],K);var Kt=`esri-zoom-box`,qt={container:`${Kt}__container`,overlay:`${Kt}__overlay`,background:`${Kt}__overlay-background`,box:`${Kt}__outline`},Jt={zoom:`Shift`,counter:`Control`},Yt=class extends f{constructor(e){super(e),this._container=null,this._overlay=null,this._backgroundShape=null,this._boxShape=null,this._box={x:0,y:0,width:0,height:0},this._rafId=null,this._redraw=this._redraw.bind(this)}destroy(){this.view=null}set view(e){this.removeAllHandles(),this._destroyOverlay(),this._set(`view`,e),e&&this.addHandles([e.on(`drag`,[Jt.zoom],e=>this._handleDrag(e,1),s.INTERNAL),e.on(`drag`,[Jt.zoom,Jt.counter],e=>this._handleDrag(e,-1),s.INTERNAL)])}_start(){this._createContainer(),this._createOverlay(),this.navigation.begin()}_update(e,t,n,r){this._box.x=e,this._box.y=t,this._box.width=n,this._box.height=r,this._rafId||=requestAnimationFrame(this._redraw)}_end(e,t,n,r,i){let a=this.view,o=a.toMap(se(e+.5*n,t+.5*r)),s=Math.max(n/a.width,r/a.height);i===-1&&(s=1/s),this._destroyOverlay(),this.navigation.end(),a.goTo({center:o,scale:a.scale*s},{animationMode:`always`,duration:l()})}_updateBox(e,t,n,r){let i=this._boxShape;i.setAttributeNS(null,`x`,``+e),i.setAttributeNS(null,`y`,``+t),i.setAttributeNS(null,`width`,``+n),i.setAttributeNS(null,`height`,``+r),i.setAttributeNS(null,`class`,qt.box)}_updateBackground(e,t,n,r){this._backgroundShape.setAttributeNS(null,`d`,this._toSVGPath(e,t,n,r,this.view.width,this.view.height))}_createContainer(){let e=document.createElement(`div`);e.className=qt.container,this.view.root.appendChild(e),this._container=e}_createOverlay(){let e=this.view.width,t=this.view.height,n=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);n.setAttributeNS(null,`d`,`M 0 0 L `+e+` 0 L `+e+` `+t+` L 0 `+t+` Z`),n.setAttributeNS(null,`class`,qt.background);let r=document.createElementNS(`http://www.w3.org/2000/svg`,`rect`),i=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);i.setAttributeNS(`http://www.w3.org/2000/xmlns/`,`xmlns:xlink`,`http://www.w3.org/1999/xlink`),i.setAttributeNS(null,`class`,qt.overlay),i.appendChild(n),i.appendChild(r),this._container.appendChild(i),this._backgroundShape=n,this._boxShape=r,this._overlay=i}_destroyOverlay(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null}_toSVGPath(e,t,n,r,i,a){let o=e+n,s=t+r;return`M 0 0 L `+i+` 0 L `+i+` `+a+` L 0 `+a+` ZM `+e+` `+t+` L `+e+` `+s+` L `+o+` `+s+` L `+o+` `+t+` Z`}_handleDrag(e,t){let n=e.x,r=e.y,i=e.origin.x,a=e.origin.y,o,s,c,l;switch(n>i?(o=i,c=n-i):(o=n,c=i-n),r>a?(s=a,l=r-a):(s=r,l=a-r),e.action){case`start`:this._start();break;case`update`:this._update(o,s,c,l);break;case`end`:this._end(o,s,c,l,t)}e.stopPropagation()}_redraw(){if(!this._rafId||(this._rafId=null,!this._overlay))return;let{x:e,y:t,width:n,height:r}=this._box;this._updateBox(e,t,n,r),this._updateBackground(e,t,n,r),this._rafId=requestAnimationFrame(this._redraw)}};m([r()],Yt.prototype,`navigation`,void 0),m([r()],Yt.prototype,`view`,null),Yt=m([d(`esri.views.2d.navigation.ZoomBox`)],Yt);var q=class{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){let t=this.computeDelta(e);this._updateDelta(t)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return this.lastValue!==void 0}hasFilteredDelta(){return this.filteredDelta!==void 0}computeDelta(e){return this.lastValue===void 0?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta===void 0?this.filteredDelta=e:this.filteredDelta=(1-this._gain)*this.filteredDelta+this._gain*e}},Xt=class{constructor(e,t,n){this._initialVelocity=e,this._stopVelocity=t,this.friction=n,this._duration=o(Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this.friction)))}get duration(){return this._duration}isFinished(e){return e>this.duration}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,t){let n=this.value(e);return this.value(e+t)-n}valueFromInitialVelocity(e,t){t=Math.min(t,this.duration);let n=1-this.friction;return e*(n**t-1)/Math.log(n)}},Zt=class extends Xt{constructor(e,t,n,r,i){super(e,t,n),this._sceneVelocity=r,this.direction=i}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}},Qt=class{constructor(e=300,t=12,n=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this.enabled=!0,this._time=new q(.6),this._screen=[new q(.4),new q(.4)],this._scene=[new q(.6),new q(.6),new q(.6)],this._tmpDirection=ie()}add(e,t,n){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(n)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(n)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;let e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,n=e==null||t==null?0:Math.sqrt(e*e+t*t),r=this._time.filteredDelta,i=r==null||n==null?0:n/r;return Math.abs(i)<this._minimumInitialVelocity?null:this.createMomentum(i,this._stopVelocity,this._friction)}createMomentum(e,t,r){ee(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);let i=ue(this._tmpDirection);i>0&&n(this._tmpDirection,this._tmpDirection,1/i);let a=this._time.filteredDelta;return new Zt(e,t,r,a==null?0:i/a,this._tmpDirection)}},J=class extends f{constructor(t){super(t),this.animationTime=o(0),this.momentumEstimator=new Qt(500,6,.92),this.momentum=null,this.tmpMomentum=ie(),this.momentumFinished=!1,this.viewpoint=new ve({targetGeometry:new me,scale:0,rotation:0}),this._previousDrag=null,this.addHandles(e(()=>this.momentumFinished,()=>this.navigation.stop()))}begin(e,t){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(t),this._previousDrag=t}update(e,t){this.addToEstimator(t);let n=t.center.x,r=t.center.y,i=this._previousDrag;n=i?i.center.x-n:-n,r=i?r-i.center.y:r,e.viewpoint=p(this.viewpoint,e.viewpoint,[n||0,r||0]),this._previousDrag=t}end(e,t){this.addToEstimator(t),this.momentum=e.navigation.momentumEnabled&&!re()?this.momentumEstimator.evaluateMomentum():null,this.animationTime=o(0),this.momentum&&this.onAnimationUpdate(e),this._previousDrag=null,this.navigation.end()}addToEstimator(e){let t=e.center.x,n=e.center.y,r=te(-t,n),i=_e(-t,n,0);this.momentumEstimator.add(r,i,.001*e.timestamp)}onAnimationUpdate(e){this.navigation.animationManager?.animateContinuous(e.viewpoint,(t,r)=>{let{momentum:i,animationTime:a,tmpMomentum:s}=this,l=this.momentumFinished=!i||i.isFinished(a),u=c(r);if(!l){let r=i.valueDelta(a,u);n(s,i.direction,r),p(t,t,s),e.constraints.constrainByGeometry(t)}this.animationTime=o(this.animationTime+u)})}stopMomentumNavigation(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())}};m([r()],J.prototype,`momentumFinished`,void 0),m([r()],J.prototype,`viewpoint`,void 0),m([r()],J.prototype,`navigation`,void 0),J=m([d(`esri.views.2d.navigation.actions.Pan`)],J);var $t=class{constructor(e=2.5,t=.01,n=.95,r=12){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this._maxVelocity=r,this.enabled=!0,this.value=new q(.8),this.time=new q(.3)}add(e,t){if(this.enabled&&t!=null){if(this.time.hasLastValue()){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta()){let t=this.value.computeDelta(e);this.value.filteredDelta*t<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=oe(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,t,n){return new Xt(e,t,n)}},en=class extends $t{constructor(e=3,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){let n=this.value.lastValue;if(n!=null){let t=e-n;for(;t>Math.PI;)t-=2*Math.PI;for(;t<-Math.PI;)t+=2*Math.PI;e=n+t}super.add(e,t)}},tn=class extends Xt{constructor(e,t,n){super(e,t,n)}value(e){let t=super.value(e);return Math.exp(t)}valueDelta(e,t){let n=super.value(e),r=super.value(e+t)-n;return Math.exp(r)}},nn=class extends $t{constructor(e=2.5,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){super.add(Math.log(e),t)}createMomentum(e,t,n){return new tn(e,t,n)}},Y=class extends f{constructor(t){super(t),this._animationTime=o(0),this._momentumFinished=!1,this._previousAngle=0,this._previousRadius=0,this._previousCenter=null,this._rotationMomentumEstimator=new en(.6,.15,.95),this._rotationDirection=1,this._startAngle=0,this._startRadius=0,this._updateTimestamp=null,this._zoomDirection=1,this._zoomMomentumEstimator=new nn,this._zoomOnly=null,this.viewpoint=new ve({targetGeometry:new me,scale:0,rotation:0}),this.zoomMomentum=null,this.rotateMomentum=null,this.addHandles(e(()=>this._momentumFinished,()=>this.navigation.stop()))}begin(e,t){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=t.angle,this._previousRadius=this._startRadius=t.radius,this._previousCenter=t.center,this._updateTimestamp=null,e.constraints.rotationEnabled&&this.addToRotateEstimator(0,t.timestamp),this.addToZoomEstimator(t,1)}update(e,t){this._updateTimestamp===null&&(this._updateTimestamp=t.timestamp);let n=t.angle,r=t.radius,i=t.center,a=Math.abs(180*(n-this._startAngle)/Math.PI),o=Math.abs(r-this._startRadius),s=this._startRadius/r;if(this._previousRadius&&this._previousCenter){let c=r/this._previousRadius,l=180*(n-this._previousAngle)/Math.PI;this._rotationDirection=l>=0?1:-1,this._zoomDirection=c>=1?1:-1,e.constraints.rotationEnabled?(this._zoomOnly===null&&t.timestamp-this._updateTimestamp>200&&(this._zoomOnly=o-a>0),this._zoomOnly===null||this._zoomOnly?l=0:this.addToRotateEstimator(n-this._startAngle,t.timestamp)):l=0,this.addToZoomEstimator(t,s),this.navigation.setViewpoint([i.x,i.y],1/c,l,[this._previousCenter.x-i.x,i.y-this._previousCenter.y])}this._previousAngle=n,this._previousRadius=r,this._previousCenter=i}end(e){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=o(0),(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(e),this.navigation.end()}addToRotateEstimator(e,t){this._rotationMomentumEstimator.add(e,.001*t)}addToZoomEstimator(e,t){this._zoomMomentumEstimator.add(t,.001*e.timestamp)}canZoomIn(e){let t=e.scale,n=e.constraints.effectiveMaxScale;return n===0||t>n}canZoomOut(e){let t=e.scale,n=e.constraints.effectiveMinScale;return n===0||t<n}onAnimationUpdate(e){this.navigation.animationManager?.animateContinuous(e.viewpoint,(n,r)=>{let a=!this.canZoomIn(e)&&this._zoomDirection>1||!this.canZoomOut(e)&&this._zoomDirection<1,s=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime),l=a||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime),d=c(r);if(this._momentumFinished=s&&l,!this._momentumFinished){let r=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,d))*this._rotationDirection*180/Math.PI:0,a=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,d)):1,o=u(),s=u();if(this._previousCenter){t(o,this._previousCenter.x,this._previousCenter.y),ae(s,e.size,e.padding),i(o,o,s);let{constraints:c,scale:l}=e,u=l*a;a<1&&!c.canZoomInTo(u)?(a=l/c.effectiveMaxScale,this.zoomMomentum=null,this.rotateMomentum=null):a>1&&!c.canZoomOutTo(u)&&(a=l/c.effectiveMinScale,this.zoomMomentum=null,this.rotateMomentum=null),ge(n,e.viewpoint,a,r,o,e.size),e.constraints.constrainByGeometry(n)}}this._animationTime=o(this._animationTime+d)})}stopMomentumNavigation(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&=(this._rotationMomentumEstimator.reset(),null),this.zoomMomentum&&=(this._zoomMomentumEstimator.reset(),null),this.navigation.stop())}};m([r()],Y.prototype,`_momentumFinished`,void 0),m([r()],Y.prototype,`viewpoint`,void 0),m([r()],Y.prototype,`navigation`,void 0),Y=m([d(`esri.views.2d.navigation.actions.Pinch`)],Y);var rn=u(),an=u(),on=class extends f{constructor(e){super(e),this._previousCenter=u(),this.viewpoint=new ve({targetGeometry:new me,scale:0,rotation:0})}begin(e,n){this.navigation.begin(),t(this._previousCenter,n.center.x,n.center.y)}update(e,n){let{state:{size:r,padding:i}}=e;t(rn,n.center.x,n.center.y),ce(an,r,i),e.viewpoint=le(this.viewpoint,e.state.paddedViewState.viewpoint,he(an,this._previousCenter,rn)),a(this._previousCenter,rn)}end(){this.navigation.end()}};m([r()],on.prototype,`viewpoint`,void 0),m([r()],on.prototype,`navigation`,void 0),on=m([d(`esri.views.2d.navigation.actions.Rotate`)],on);var X=10,sn=1,cn=new ve({targetGeometry:new me}),ln=[0,0],un=250,Z=class extends f{constructor(e){super(e),this._endTimer=null,this._lastEventTimestamp=null,this.animationManager=null,this.interacting=!1}initialize(){this.pan=new J({navigation:this}),this.rotate=new on({navigation:this}),this.pinch=new Y({navigation:this}),this.zoomBox=new Yt({view:this.view,navigation:this})}destroy(){this.pan=ye(this.pan),this.rotate=ye(this.rotate),this.pinch=ye(this.pinch),this.zoomBox=ye(this.zoomBox),this.animationManager=null}begin(){this.stop(),this._set(`interacting`,!0)}end(){this._lastEventTimestamp=performance.now(),this._startTimer(un)}async zoom(e,t=this._getDefaultAnchor()){if(this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return e<1?this.zoomIn(t):this.zoomOut(t);this.setViewpoint(t,e,0,[0,0])}async zoomIn(e){let t=this.view,n=t.constraints.snapToNextScale(t.scale);return this._zoomToScale(n,e)}async zoomOut(e){let t=this.view,n=t.constraints.snapToPreviousScale(t.scale);return this._zoomToScale(n,e)}setViewpoint(e,t,n,r){this.begin(),this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,e,t,n,r),this.end()}setViewpointImmediate(e,t=0,n=[0,0],r=this._getDefaultAnchor()){this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,r,e,t,n)}continuousRotateClockwise(){let e=this.view.viewpoint;this.animationManager?.animateContinuous(e,e=>{le(e,e,-sn)})}continuousRotateCounterclockwise(){let e=this.view.viewpoint;this.animationManager?.animateContinuous(e,e=>{le(e,e,sn)})}resetRotation(){this.view.constraints.rotationEnabled&&(this.view.rotation=0)}continuousPanLeft(){this._continuousPan([-X,0])}continuousPanRight(){this._continuousPan([X,0])}continuousPanUp(){this._continuousPan([0,X])}continuousPanDown(){this._continuousPan([0,-X])}continuousPanVector({x:e,y:t}){this._continuousPan([e*X,t*X])}stop(){this.pan.stopMomentumNavigation(),this.animationManager?.stop(),this.end(),this._endTimer!==null&&(clearTimeout(this._endTimer),this._endTimer=null,this._set(`interacting`,!1))}_continuousPan(e){let t=this.view.viewpoint;this.animationManager?.animateContinuous(t,t=>{p(t,t,e),this.view.constraints.constrainByGeometry(t)})}_startTimer(e){return this._endTimer!==null||(this._endTimer=setTimeout(()=>{this._endTimer=null;let e=performance.now()-(this._lastEventTimestamp??0);e<un?this._endTimer=this._startTimer(e):this._set(`interacting`,!1)},e)),this._endTimer}_getDefaultAnchor(){let{size:e,padding:{left:t,right:n,top:r,bottom:i}}=this.view;return ln[0]=.5*(e[0]-n+t),ln[1]=.5*(e[1]-i+r),ln}async _zoomToScale(e,t=this._getDefaultAnchor()){let{view:n}=this,{constraints:r,scale:i,viewpoint:a,size:o,padding:s}=n,c=r.canZoomInTo(e),u=r.canZoomOutTo(e);if(!(e<i&&!c||e>i&&!u))return de(cn,a,e/i,0,t,o,s),r.constrainByGeometry(cn),n.goTo(cn,{animate:!0,animationMode:`always`,duration:l(),pickClosestTarget:!1})}_scaleRotateTranslateViewpoint(e,t,n,r,i){let{view:a}=this,{size:o,padding:s,constraints:c,scale:l,viewpoint:u}=a,d=l*n,ee=c.canZoomInTo(d),te=c.canZoomOutTo(d);return(n<1&&!ee||n>1&&!te)&&(n=1),p(u,u,i),de(e,u,n,r,t,o,s),c.constrainByGeometry(e)}};m([r()],Z.prototype,`animationManager`,void 0),m([r({type:Boolean,readOnly:!0})],Z.prototype,`interacting`,void 0),m([r()],Z.prototype,`pan`,void 0),m([r()],Z.prototype,`pinch`,void 0),m([r()],Z.prototype,`rotate`,void 0),m([r()],Z.prototype,`view`,void 0),m([r()],Z.prototype,`zoomBox`,void 0),Z=m([d(`esri.views.2d.navigation.MapViewNavigation`)],Z);var dn=Z,fn=class extends M{};m([w(0,F)],fn.prototype,`position`,void 0);var pn=class extends O{},Q=class extends N{};m([T(y)],Q.prototype,`readbackTexture`,void 0),m([T(y)],Q.prototype,`maskTexture`,void 0),m([T(y)],Q.prototype,`overlayTexture`,void 0),m([T(k)],Q.prototype,`background`,void 0),m([T(k)],Q.prototype,`drawPos`,void 0),m([T(C)],Q.prototype,`maskEnabled`,void 0),m([T(C)],Q.prototype,`overlayEnabled`,void 0);var mn=class extends A{constructor(){super(...arguments),this.type=`MagnifierShader`}vertex(e){let t=e.position,n=e.position.subtract(new F(.5)).multiply(this.config.drawPos.zw),r=this.config.drawPos.xy.add(n);return{glPosition:new k(r,0,1),texCoord:t}}fragment(e){let t=b(this.config.readbackTexture,hn(e.texCoord));t=t.add(new C(1).subtract(t.a)).multiply(this.config.background);let n=v(P(this.config.maskEnabled,new C(1)),b(this.config.maskTexture,e.texCoord).a,new C(1));t=t.multiply(n);let r=v(P(this.config.overlayEnabled,new C(1)),b(this.config.overlayTexture,e.texCoord),new k(0)),i=new D;return i.fragColor=r.add(new C(1).subtract(r.a).multiply(t)),i}};function hn(e){let t=e.multiply(new F(2)).subtract(1);return v(P(t.x,new C(0)).and(P(t.y,new C(0))),new F(.5),()=>{let e=ze(t.y,t.x),n=Te(ke(t),new C(Ge)),r=new F(Ae(e),Le(e));return n.multiply(r).multiply(new F(.5)).add(new C(.5))})}m([T(Q)],mn.prototype,`config`,void 0),m([h(0,j(fn))],mn.prototype,`vertex`,null),m([h(0,j(pn))],mn.prototype,`fragment`,null);var gn=class extends M{};m([w(0,F)],gn.prototype,`position`,void 0);var _n=class extends O{},vn=class extends N{};m([T(He)],vn.prototype,`dvs`,void 0);var $=class extends N{};m([T(C)],$.prototype,`halfWidth`,void 0),m([T(C)],$.prototype,`aaWidth`,void 0),m([T(C)],$.prototype,`pxPerCell`,void 0),m([T(k)],$.prototype,`minorLineColor`,void 0),m([T(k)],$.prototype,`majorLineColor`,void 0),m([T(Ce)],$.prototype,`majorLineInterval`,void 0);var yn=class extends A{constructor(){super(...arguments),this.type=`GridShader`}vertex(e){let t=e.position.multiply(2).subtract(1);return{gridPos:this.transform.dvs.multiply(new _(t,1)).xy,glPosition:new k(t,0,1)}}fragment(e){let t=Se(e.gridPos),n=be(t),r=S(n.x,new C(1).subtract(n.x)),i=S(n.y,new C(1).subtract(n.y)),a=new F(r,i).multiply(this.config.pxPerCell).subtract(this.config.halfWidth),o=S(a.x,a.y),s=new C(1).subtract(Oe(new C(0),this.config.aaWidth,o)),c=new Ce(Re(t.x)),l=new Ce(Re(t.y)),u=new C(Ie(c,this.config.majorLineInterval)),d=new C(Ie(l,this.config.majorLineInterval)),ee=v(Ee(a.x,a.y),u,d),te=Ue(We(E(a.x,this.config.aaWidth),E(a.y,this.config.aaWidth)),new C(.5)),ne=S(u,d),re=v(te,ne,ee),f=we(this.config.majorLineColor,this.config.minorLineColor,S(re,new C(1))),p=new D;return p.fragColor=f.multiply(s),p}};m([T(vn)],yn.prototype,`transform`,void 0),m([T($)],yn.prototype,`config`,void 0),m([h(0,j(gn))],yn.prototype,`vertex`,null),m([h(0,j(_n))],yn.prototype,`fragment`,null);export{R as _,Ht as a,It as c,Et as d,Tt as f,yt as g,xt as h,K as i,Pt as l,bt as m,mn as n,Rt as o,wt as p,dn as r,Lt as s,yn as t,Ot as u,$e as v,Qe as y};