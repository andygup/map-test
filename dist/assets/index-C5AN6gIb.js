const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-Bf00Sxit.js","assets/ArcGISCachedService-BtsMwUK4.js","assets/TileInfoTilemapCache-ezsA-0la.js","assets/TilemapCache-BKvjrpeX.js","assets/WorkerHandle-DzCdB08Y.js","assets/layersCreator-DYPEGeb7.js","assets/portalLayers-CyTRE0oC.js","assets/associatedFeatureServiceUtils-2IKHoey5.js","assets/fetchService-jH9VHRWL.js","assets/arcgisLayers-DspE1Bq3.js","assets/arcadeUtils-u4M4i7vy.js","assets/number-BA4HJ515.js","assets/featureConversionUtils-C3NW8rek.js","assets/OptimizedFeature-7juV2tZm.js","assets/OptimizedGeometry-vU5jWBvU.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/geometryEngineJSON-DDjAODZ3.js","assets/json-Wa8cmqdu.js","assets/statsWorker-kVOMbpxB.js","assets/utils-DKaxd0pF.js","assets/utils-BUKYl_Lx.js","assets/ClassBreaksDefinition-DkBi6sY8.js","assets/geometryEngineWorker-BB-8ztDN.js","assets/CSVSourceWorker-MOzkYKIT.js","assets/date-M6n_RqpC.js","assets/FeatureStore-Cbjw9jbD.js","assets/BoundsStore-U2eIEVMR.js","assets/PooledRBush-BI9lRTDf.js","assets/timeSupport-DCAQeUtx.js","assets/SnappingCandidate-xj0n6h40.js","assets/centroid-DdLmOD72.js","assets/QueryEngine-zQzW3jdH.js","assets/WhereClause-CwdWzaSi.js","assets/QueryEngineCapabilities-CTDe3LlQ.js","assets/clientSideDefaults-C1erWadG.js","assets/EdgeProcessingWorker-DkSGm1O8.js","assets/workerHelper-Dj2GLcWc.js","assets/InterleavedLayout-Bq7Nk9sY.js","assets/BufferView-CNNe45YH.js","assets/types-D0PSWh4d.js","assets/Util-DZ-J3OpH.js","assets/edgeProcessing-Bd6CVQt5.js","assets/deduplicate-Bon-NhLh.js","assets/Indices-BRKmhTP5.js","assets/glUtil-C6KhMg1m.js","assets/enums-BlUEVwJR.js","assets/VertexElementDescriptor-BOD-G50G.js","assets/Normals-BE87b4Vz.js","assets/ElevationSamplerWorker-Cbjg7Q8D.js","assets/MeshLocalVertexSpace-CTAY8X8I.js","assets/vertexSpaceConversion-Dzki7RJ-.js","assets/meshVertexSpaceUtils-CUbXRTTC.js","assets/vec3-CiIgb4WS.js","assets/projection-DyzoT35-.js","assets/DoubleArray-Bc_s-eRk.js","assets/vec4-DO8SGWMS.js","assets/FeatureServiceSnappingSourceWorker-D-NdNC5S.js","assets/symbologySnappingCandidates-DLNBj2Q4.js","assets/pbfQueryUtils-S9bERzlu.js","assets/pbf-BQAkLotO.js","assets/query-D9E5mc5-.js","assets/GeoJSONSourceWorker-D8hlEeU2.js","assets/geojson-C__zI6ua.js","assets/sourceUtils-BZjIng5-.js","assets/MemorySourceWorker-DOZFeeqZ.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-BnT79yel.js","assets/dehydratedFeatures-zLOmthQT.js","assets/FeaturePipelineWorker-BAv6nSr0.js","assets/definitions-Y_v3njP4.js","assets/AttributeStore-BcKPyP_9.js","assets/LabelMetric-G82jk8Dw.js","assets/Texture-CTKIRDMu.js","assets/Program-DbcSl83q.js","assets/BufferObject-KHYTZLM-.js","assets/BoundingBox-DtHb85M2.js","assets/UpdateTracking2D-BLvcY7jP.js","assets/BindType-BmZEZMMh.js","assets/highlightReasons-DFsDA0zc.js","assets/CIMSymbolHelper-BvTJZJyB.js","assets/BidiEngine-BwB1Df7c.js","assets/fontUtils-CwPg7HxN.js","assets/GeometryUtils-DhrvD4RL.js","assets/Rect-CUzevAry.js","assets/tileUtils-B7X19rIS.js","assets/MeshWriterRegistry-Dm2KKozL.js","assets/PieChartMeshWriter-D6AsjPGy.js","assets/TurboLine-DsqCuoq9.js","assets/earcut-h7wdVcTx.js","assets/constants-D5zmR9t2.js","assets/grouping-Di9_JLxj.js","assets/ogcFeatureUtils-B2uZgO5E.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-fIwF0syz.js","assets/PointCloudWorker-25Z40cNn.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-DYRB2ru4.js","assets/I3SBinaryReader-Cwxfyz08.js","assets/RasterWorker-DEPt9zU_.js","assets/dataUtils-DRXJgO2r.js","assets/RasterSymbolizer-CUtB0elx.js","assets/PolynomialTransform-BkKDZtUc.js","assets/rasterProjectionHelper-CIOTJ63u.js","assets/SceneLayerSnappingSourceWorker-ClUnr_Rn.js","assets/Octree-CyDSDobB.js","assets/SceneLayerWorker-9JQqpx_Z.js","assets/I3SUtil-g1t_dMDb.js","assets/edgeUtils-CFaF66uh.js","assets/floatRGBA-Ca01y9H_.js","assets/symbolColorUtils-sUjk6CNU.js","assets/NormalAttribute.glsl-BsjrRndr.js","assets/WFSSourceWorker-C4y6K679.js","assets/wfsUtils-1R6-PWiZ.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-DArYwucC.js","assets/enums-BRzLM11V.js","assets/config-MDUrh2eL.js","assets/StyleDefinition-CzFICxQ3.js","assets/SourceLayerData-DiACrBw8.js","assets/StyleRepository-uV7iFlyA.js","assets/layersLoader-CMEegXUs.js","assets/featureLayerUtils-Bg56292n.js","assets/originUtils-D69mHv66.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/utils-Brn5aNjo.js","assets/saveAPIKeyUtils-ot4Qx3WZ.js","assets/saveUtils-Cgg_D2MY.js","assets/FeatureLayerSource-Do8053ST.js","assets/External-DFED46rE.js","assets/MeshTransform-XUwO-bLO.js","assets/axisAngleDegrees-Bq-bfGg9.js","assets/editingSupport-CQxJG2oj.js","assets/QueryTask-Bn17AehK.js","assets/executeForIds-BZUPskyd.js","assets/executeQueryJSON-wSHCtr-x.js","assets/executeQueryPBF-Dmq124oG.js","assets/queryAssociations-Bhax4Dgh.js","assets/Association-CWH9h5NF.js","assets/synthesizeAssociationGeometries-B7BChGLz.js","assets/webdocSaveUtils-IWjVZ_dS.js","assets/resourceUtils-C405elns.js","assets/resourceUtils-qzCWpzM5.js","assets/Popup-B2NIVT8N.js","assets/webglDeps-kz7LeiOp.js","assets/NestedMap-DgiGbX8E.js","assets/ProgramTemplate-Dt1rsZaa.js","assets/VertexArrayObject-itGszRJk.js","assets/mapViewDeps-CS44jmb5.js","assets/SDFHelper-DxEEJj2K.js","assets/Container-DoXxt5zf.js","assets/WGLContainer-CF9Cdabk.js","assets/vec4f32-CjrfB-0a.js","assets/MagnifierPrograms-9GV0nDF7.js","assets/testSVGPremultipliedAlpha-m7Gxddoh.js","assets/RenderingContext-euf9d5ze.js","assets/renderState-Clz7MxYz.js","assets/doublePrecisionUtils-B0owpBza.js","assets/CIMResourceManager-De5Cy2vj.js","assets/imageUtils-Cp-OddyP.js","assets/rasterizingUtils-DYG6GrbT.js","assets/utils-B-cZaJGG.js","assets/FeatureCommandQueue-BDDWB6HO.js","assets/GraphicsView2D-C5JT0i5c.js","assets/normalizeUtilsSync-Ccn9l9sq.js","assets/GraphicContainer-Bwt5gDIs.js","assets/AGraphicContainer-CuMJmQTl.js","assets/TechniqueInstance-CSiYJXEd.js","assets/TileContainer-4z5zi0ok.js","assets/requestImageUtils-CvlvwEvR.js","assets/TileLayerView2D-BbiM35U5.js","assets/imageUtils-CU_Vl9k6.js","assets/Bitmap-DG_ir5iM.js","assets/LayerView2D-tmdMtJYv.js","assets/HighlightGraphicContainer-D4LOd8qB.js","assets/LayerView-B14_-j8k.js","assets/RefreshableLayerView-jCvPH_4N.js","assets/MapServiceLayerViewHelper-CNBpp8Vq.js","assets/popupUtils-C2S1hc7n.js","assets/FeatureLayerView2D-DgaKD1BR.js","assets/timeSupport-eZnpTcn9.js","assets/timeUtils-DYBWcYWP.js","assets/tagSymbols-BPcGfZon.js","assets/HighlightCounter-D8XekeoG.js","assets/BaseDynamicLayerView2D-Bsfh8ezB.js","assets/BitmapContainer-CRI2tBpP.js","assets/ExportStrategy-q3f0E9ch.js","assets/CatalogLayerView2D-D6G0KAvs.js","assets/CatalogDynamicGroupLayerView2D-s2u87Tr1.js","assets/CatalogFootprintLayerView2D-Ba8ZqbU1.js","assets/GeoRSSLayerView2D-XeofU7NP.js","assets/GraphicsLayerView2D-_gX72LD0.js","assets/GroupLayerView2D-CdxHeSep.js","assets/ImageryLayerView2D-CBNL83ge.js","assets/RasterVFDisplayObject-DIYHiaDr.js","assets/ImageryTileLayerView2D-B1TCPppt.js","assets/multidimensionalUtils-DGcnNDO-.js","assets/rasterUtils-BIDQy-TH.js","assets/RawBlockCache-CIRyTLlX.js","assets/KMLLayerView2D-B3CjVcNl.js","assets/kmlUtils-DaaI0ylU.js","assets/KnowledgeGraphLayerView2D-CxNETH5e.js","assets/MapImageLayerView2D-DpI0HvyQ.js","assets/MapNotesLayerView2D-DG-EhvKs.js","assets/MediaLayerView2D-BNX2D3Ag.js","assets/perspectiveUtils-Tb9rmwmB.js","assets/OverlayContainer-BnQiLgGp.js","assets/OGCFeatureLayerView2D-ZDKlNOql.js","assets/RouteLayerView2D-UhxQhv1w.js","assets/Stop-DmqRe9mZ.js","assets/StreamLayerView2D-DCcYb25H.js","assets/SubtypeGroupLayerView2D-Dmt4-2DR.js","assets/VectorTileLayerView2D-CVXviBfi.js","assets/VideoLayerView2D-CdApG18_.js","assets/TelemetryDisplay-CRFHJ_Dt.js","assets/WMSLayerView2D-DbmQwIov.js","assets/ExportWMSImageParameters-DBjkr2l4.js","assets/WMTSLayerView2D-D_C2zw1x.js","assets/calcite-button-BzJqMxwJ.js","assets/button-B5aEEtbc.js","assets/form-BnXW4FPo.js","assets/dom-C5N_1hiZ.js","assets/interactive-CmWnkkOC.js","assets/label-CAIjuis8.js","assets/component-CeOigQot.js","assets/loadable-CIDEs4qX.js","assets/locale-BqOq_HI1.js","assets/key-BSF9a80T.js","assets/observers-DkXuzKPz.js","assets/t9n-CNLrLhpx.js","assets/icon-C-hoQ7C9.js","assets/loader-JN6lUMag.js","assets/calcite-icon-C251eVDJ.js","assets/calcite-action-DBBzvUB2.js","assets/action-C9RvJ6oL.js","assets/calcite-chip-group-BlfANbY0.js","assets/calcite-chip-CizeI5-9.js","assets/chip-CHzcrSIZ.js","assets/calcite-fab-cnv1QGH6.js","assets/calcite-flow-CExHLkC9.js","assets/calcite-flow-item-BieRNoUa.js","assets/panel-mPIXA_dr.js","assets/action-menu-DPIE1kkw.js","assets/array-D9rxjK_-.js","assets/popover-ZQetc43R.js","assets/floating-ui-C_rWs4-h.js","assets/debounce-DUf35w49.js","assets/focusTrapComponent-7oqHJDIf.js","assets/openCloseComponent-BZMSNP3t.js","assets/Heading-DA3D04z6.js","assets/FloatingArrow-D9qZTw40.js","assets/scrim-aij3vOuk.js","assets/calcite-input-Dl0Mk_X_.js","assets/input2-BWc-D8rL.js","assets/Validation-B5FDPjXY.js","assets/input-De-TCHNF.js","assets/input-message-IeZ9YW4t.js","assets/progress-Baf-cjVV.js","assets/calcite-input-message-DUzlrVMh.js","assets/calcite-label-BqccM8mP.js","assets/calcite-list-5FytLBV3.js","assets/resources4-BWCcs03d.js","assets/utils3-BQV4cmxf.js","assets/filter-Ig933xs6.js","assets/calcite-list-item-0BU0z9Zo.js","assets/handle-Ys4OUVaK.js","assets/calcite-loader-BdVH7ICK.js","assets/calcite-notice-mqUu1NoI.js","assets/conditionalSlot-DYlEyccB.js","assets/calcite-scrim-CBy6Hnad.js","assets/calcite-switch-Bg2wMLH-.js","assets/calcite-table-Dv69p7Kv.js","assets/calcite-table-cell-C7qVMk8W.js","assets/table-cell-Drtc08Nm.js","assets/calcite-table-header-aUxVo_Ld.js","assets/table-header-DCzieTBm.js","assets/calcite-table-row-DbWHWlj8.js","assets/calcite-panel-D1958UUA.js","assets/calcite-popover-CjjGVWYj.js","assets/calcite-sheet-BOjPciOX.js","assets/calcite-radio-button-CcS5x8sg.js","assets/calcite-radio-button-group-DAXgLR4O.js","assets/calcite-block-DOM6q34Z.js","assets/calcite-combobox-DJcusimv.js","assets/combobox-DRq3yAaW.js","assets/utils2-DADnorAU.js","assets/combobox-item-BkNbAdY1.js","assets/calcite-combobox-item-C0Ck8epN.js","assets/calcite-combobox-item-group-Vy3aYLmY.js","assets/combobox-item-group-B4v_NxdQ.js","assets/calcite-input-date-picker-DnA9GQP_.js","assets/input-text-Cgd1aF0I.js","assets/calcite-input-number-wv0rR9lK.js","assets/calcite-input-time-picker-BrieeaIK.js","assets/calcite-input-time-zone-_W4PHIVg.js","assets/calcite-text-area-BxSE4CTL.js","assets/previewSymbol2D-DsmaHFZP.js","assets/previewCIMSymbol-BoCrdrpL.js","assets/CIMSymbolRasterizer-BFjNFcgD.js","assets/FeatureServiceSnappingSource-DrgyL8xV.js","assets/queryEngineUtils-DbK-o78J.js","assets/VertexSnappingCandidate-DEqzcnvD.js","assets/PointSnappingHint-DjYXgixC.js","assets/FeatureCollectionSnappingSource-DVHHzaaC.js","assets/GraphicsSnappingSource-BOzEOAxq.js","assets/SceneLayerSnappingSource-CLC8NkqL.js","assets/Upload-CgP3A_h1.js","assets/progressUtils-D49OrrLs.js","assets/editingTools-BlLARBY8.js","assets/SnappingVisualizer2D-Bp1ed0rr.js","assets/SnappingContext-DyM9dOsy.js","assets/Tooltip-BWAq0e_r.js","assets/triangle-BDxswaYW.js","assets/editPlaneUtils-DGDWT6Mq.js","assets/helpMessageUtils3d-ChbE8t4G.js","assets/hydratedFeatures-CMrptU6P.js","assets/GraphicManipulator-CN-1TMAN.js","assets/drawUtils-tLXf0mE9.js","assets/editingTools-Dr1cynXz.js","assets/Laserlines.glsl-DEL4_FNC.js","assets/OverlayCompositing.glsl-DsnZPVOs.js","assets/IntegerPassUniform-D4i1Uds1.js","assets/triangulationUtils-CsU-mkhu.js","assets/ColorMaterial.glsl-CD6ejSSs.js","assets/VertexColor.glsl-BV8edxDv.js","assets/SelectedVertexTooltipInfo-CgNtL8iw.js","assets/TranslateTooltipInfo-ob1DrpZt.js","assets/persistable-BNHBAgp6.js","assets/resourceExtension-CvC0KOtE.js","assets/ExtentScaleTooltipInfo-DhXR2bTg.js","assets/GraphicsLayerView3D-BlPN3ywE.js","assets/RealisticTree.glsl-HU85G3Rp.js","assets/DefaultMaterial_COLOR_GAMMA-CZdOc506.js","assets/resourceUtils-Cx3hVMrh.js","assets/MeshComponent-Cv3oJpgz.js","assets/MeshVertexAttributes-BKMquezO.js","assets/geometryServiceUtils-hjs3Ep4E.js","assets/GraphicMover-NTua9M1W.js","assets/Box-CkfANLzB.js","assets/settings-Cl0Ilsoo.js","assets/Reshape-BhmEx87d.js","assets/calcite-tooltip-Ci-tYktH.js","assets/calcite-checkbox-UYHQBuOi.js","assets/calcite-accordion-KX8zrHgK.js","assets/calcite-accordion-item-DdVyXs_s.js","assets/MapImageLayer-VzX6JjA_.js","assets/SublayersOwner-CKVfguQo.js","assets/imageBitmapUtils-BNDRGeXG.js","assets/calcite-action-group-DplWbV3U.js","assets/action-group-BjoixOYB.js","assets/calcite-action-menu-E8cc6COU.js","assets/ElevationProfileView2D-CQSqbbmy.js","assets/HoveredPoints-CBczvf_V.js","assets/ElevationProfileView3D-BVJSDWPy.js","assets/calcite-option-CiypywlM.js","assets/calcite-select-Cw0k5ryP.js","assets/chartUtils-B0ZcHlLN.js","assets/ResponsiveTheme-14X2T0S4.js","assets/Theme-BHB5kfaC.js","assets/chartUtilsAm5-DhZdo-TA.js","assets/Tooltip-CMiFfF24.js","assets/DefaultTheme-ziHgLqFQ.js","assets/LineSeries-C2YunYE5.js","assets/ColorSet-dmpX7IwU.js","assets/Tick-7g2CHdl-.js","assets/Button-IiUZYl1k.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();function m(t,e,i,r){var n,o=arguments.length,u=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(t,e,i,r);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(u=(o<3?n(u):o>3?n(e,i,u):n(e,i))||u);return o>3&&u&&Object.defineProperty(e,i,u),u}function Jqe(t,e){return function(i,r){e(i,r,t)}}function Zqe(t,e,i,r){function n(o){return o instanceof i?o:new i(function(u){u(o)})}return new(i||(i=Promise))(function(o,u){function p(S){try{w(r.next(S))}catch(T){u(T)}}function g(S){try{w(r.throw(S))}catch(T){u(T)}}function w(S){S.done?o(S.value):n(S.value).then(p,g)}w((r=r.apply(t,[])).next())})}const Uue="modulepreload",Gue=function(t){return"/"+t},vN={},ie=function(e,i,r){let n=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),p=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));n=Promise.allSettled(i.map(g=>{if(g=Gue(g),g in vN)return;vN[g]=!0;const w=g.endsWith(".css"),S=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${S}`))return;const T=document.createElement("link");if(T.rel=w?"stylesheet":Uue,w||(T.as="script"),T.crossOrigin="",T.href=g,p&&T.setAttribute("nonce",p),document.head.appendChild(T),w)return new Promise((E,C)=>{T.addEventListener("load",E),T.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${g}`)))})}))}function o(u){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=u,window.dispatchEvent(p),!p.defaultPrevented)throw u}return n.then(u=>{for(const p of u||[])p.status==="rejected"&&o(p.reason);return e().catch(o)})};let Lf;function me(t){return typeof Lf[t]=="function"?Lf[t]=Lf[t](globalThis):Lf[t]}var sW,oW,aW,lW;Lf=(sW=globalThis.dojoConfig)!=null&&sW.has||(oW=globalThis.esriConfig)!=null&&oW.has?{...(aW=globalThis.dojoConfig)==null?void 0:aW.has,...(lW=globalThis.esriConfig)==null?void 0:lW.has}:{},me.add=(t,e,i,r)=>((r||Lf[t]===void 0)&&(Lf[t]=e),i&&me(t)),me.cache=Lf,me.add("big-integer-warning-enabled",!0),me.add("esri-deprecation-warnings",!0),me.add("esri-tests-disable-screenshots",!1),me.add("esri-tests-use-full-window",!1),me.add("esri-tests-post-to-influx",!0),(()=>{var e;me.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(me.add("host-browser",t),me.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),me.add("dom",t),me("host-browser")){const i=navigator,r=i.userAgent,n=i.appVersion,o=parseFloat(n);if(me.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),me.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),me.add("khtml",n.includes("Konqueror")?o:void 0),me.add("edge",parseFloat(r.split("Edge/")[1])||void 0),me.add("opr",parseFloat(r.split("OPR/")[1])||void 0),me.add("webkit",!me("wp")&&!me("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),me.add("chrome",!me("edge")&&!me("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),me.add("android",!me("wp")&&parseFloat(r.split("Android ")[1])||void 0),me.add("safari",!n.includes("Safari")||me("wp")||me("chrome")||me("android")||me("edge")||me("opr")?void 0:parseFloat(n.split("Version/")[1])),me.add("mac",n.includes("Macintosh")),!me("wp")&&/(iPhone|iPod|iPad)/.test(r)){const u=RegExp.$1.replace(/P/,"p"),p=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",g=parseFloat(p.replace(/_/,".").replaceAll("_",""));me.add(u,g),me.add("ios",g)}me("webkit")||(!r.includes("Gecko")||me("wp")||me("khtml")||me("edge")||me.add("mozilla",o),me("mozilla")&&me.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&me.add("esri-mobile",e),i&&me.add("esri-iPhone",i),me.add("esri-geolocation",!!navigator.geolocation)}me.add("esri-wasm","WebAssembly"in globalThis),me.add("esri-performance-mode-frames-between-render",20),me.add("esri-force-performance-mode",!1),me.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),me.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),me.add("esri-atomics","Atomics"in globalThis),me.add("esri-workers","Worker"in globalThis),me.add("web-feat:cache","caches"in globalThis),me.add("esri-workers-arraybuffer-transfer",!me("safari")||Number(me("safari"))>=12),me.add("workers-pool-size",8),me.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),me.add("featurelayer-simplify-payload-size-factors",[1,1,4]),me.add("featurelayer-fast-triangulation-enabled",!0),me.add("featurelayer-animation-enabled",!0),me.add("featurelayer-snapshot-enabled",!0),me.add("featurelayer-snapshot-point-min-threshold",8e4),me.add("featurelayer-snapshot-point-max-threshold",4e5),me.add("featurelayer-snapshot-point-coverage",.1),me.add("featurelayer-query-max-depth",4),me.add("featurelayer-query-pausing-enabled",!1),me.add("featurelayer-advanced-symbols",!1),me.add("featurelayer-pbf",!0),me.add("featurelayer-pbf-statistics",!1),me.add("feature-layers-workers",!0),me.add("feature-polyline-generalization-factor",1),me.add("mapview-transitions-duration",200),me.add("mapview-essential-goto-duration",200),me.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),me.add("mapserver-pbf-version-support",10.81),me.add("mapservice-popup-identify-max-tolerance",20),me("host-webworker")||me("host-browser")&&(me.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),me.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{me.add("esri-image-decode",!0,!0,!0)}).catch(()=>{me.add("esri-image-decode",!1,!0,!0)})}return!1}),me.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();let o9=class j0{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*j0._m}getInt(){return this._seed=(j0._a*this._seed+j0._c)%j0._m,this._seed}getFloat(){return this.getInt()/(j0._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const r=i-e;return e+this.getInt()/j0._m*r}};o9._m=2147483647,o9._a=48271,o9._c=0;const Bue=1.5,Kqe=1/Bue,Yqe=.5;function que(t,e){if(!e)return t;for(const i of e)t.push(i);return t}function Hue(t){if(!t)return;const e=t.length;return e>0?t[e-1]:void 0}function dW(t){return t}function Wue(t,e=dW){if(!t||t.length===0)return;let i=t[0],r=e(i);for(let n=1;n<t.length;++n){const o=t[n],u=Number(e(o));u>r&&(r=u,i=o)}return i}function fW(t,e=dW){return Wue(t,i=>-e(i))}function Jue(t,e){return e?t.filter((i,r,n)=>n.findIndex(e.bind(null,i))===r):Array.from(new Set(t))}function Rb(t,e,i){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(i){for(let r=0;r<t.length;r++)if(!i(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Zue(t,e){let i=t.length!==e.length;i&&(t.length=e.length);for(let r=0;r<e.length;++r)t[r]!==e[r]&&(t[r]=e[r],i=!0);return i}function w4(t,e,i){let r,n;return i?(r=e.filter(o=>!t.some(u=>i(u,o))),n=t.filter(o=>!e.some(u=>i(u,o)))):(r=e.filter(o=>!t.includes(o)),n=t.filter(o=>!e.includes(o))),{added:r,removed:n}}function Xqe(t){return t&&typeof t.length=="number"}function Kue(t,e){const i=t.length;if(i===0)return[];const r=[];for(let n=0;n<i;n+=e)r.push(t.slice(n,n+e));return r}function Yue(t,e,i){if(!t||t.length===0)return;const r=t.length-1,n=t[0];if(e<=i(n))return n;const o=t[r];if(e>=i(o))return o;let u=0,p=0,g=r;for(;u<g;){p=u+Math.floor((g-u)/2);const w=t[p],S=i(w);if(S===e)return w;if(e<S){if(p>0){const T=t[p-1],E=i(T);if(e>E)return e-E>=S-e?w:T}g=p}else{if(p<r){const T=t[p+1],E=i(T);if(e<E)return e-S>=E-e?T:w}u=p+1}}return t[p]}let yW=class{constructor(){this.last=0}};const mW=new yW;function _4(t,e,i,r){r=r||mW;const n=Math.max(0,r.last-10);for(let u=n;u<i;++u)if(t[u]===e)return r.last=u,u;const o=Math.min(n,i);for(let u=0;u<o;++u)if(t[u]===e)return r.last=u,u;return-1}function Xue(t,e,i,r){const n=t.length,o=_4(t,e,n,r);if(o!==-1)return t[o]=t[n-1],t.pop(),e}const Yl=new Set;function Que(t,e,i=t.length,r=e.length,n,o){if(r===0||i===0)return i;Yl.clear();for(let p=0;p<r;++p)Yl.add(e[p]);n=n||mW;const u=Math.max(0,n.last-10);for(let p=u;p<i;++p)if(Yl.has(t[p])&&(o==null||o.push(t[p]),Yl.delete(t[p]),t[p]=t[i-1],--i,--p,Yl.size===0||i===0))return Yl.clear(),i;for(let p=0;p<u;++p)if(Yl.has(t[p])&&(o==null||o.push(t[p]),Yl.delete(t[p]),t[p]=t[i-1],--i,--p,Yl.size===0||i===0))return Yl.clear(),i;return Yl.clear(),i}function eHe(t,e){let i=0;for(let r=0;r<t.length;++r){const n=t[r];e(n,r)&&(t[i]=n,i++)}t.length=i}function L5(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function Rt(t,e){return t!=null}const tHe=[];function gW(t){return 32+t.length}function L7(){return 16}function iHe(t){if(!t)return 0;let e=bW;for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];switch(typeof r){case"string":e+=gW(r);break;case"number":e+=L7();break;case"boolean":e+=4}}return e}function ece(t){if(!t)return 0;if(Array.isArray(t))return tce(t);let e=bW;for(const i in t)t.hasOwnProperty(i)&&(e+=vW(t[i]));return e}function tce(t){const e=t.length;if(e===0||typeof t[0]=="number")return 32+8*e;let i=wW;for(let r=0;r<e;r++)i+=vW(t[r]);return i}function vW(t){switch(typeof t){case"object":return ece(t);case"string":return gW(t);case"number":return L7();case"boolean":return 4;default:return 8}}function ice(t,e){return wW+t.length*e}const bW=32,wW=16;function rHe(t){return t instanceof ArrayBuffer}function O7(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function _W(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function SW(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function P7(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function xW(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function R7(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function $W(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function _I(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function SI(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function rce(t){return!("buffer"in t)}function nHe(...t){return t.reduce((e,i)=>e+(i?rce(i)?ice(i,L7()):i.byteLength+nce:0),0)}const nce=145,sHe=1024;function oHe(t){return SI(t)||_I(t)||R7(t)||P7(t)||O7(t)}function aHe(t){return SI(t)||_I(t)}function lHe(t){return SI(t)?179769e303:_I(t)?3402823e32:$W(t)?4294967295:xW(t)?65535:_W(t)||SW(t)?255:R7(t)?2147483647:P7(t)?32767:O7(t)?127:256}function sce(t,e){let i;for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function ae(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=IW(t);if(e!=null)return e;if(O5(t))return t.clone();if(TW(t))return t.map(ae);if(EW(t))return t.clone();const i={};for(const r of Object.getOwnPropertyNames(t))i[r]=ae(t[r]);return i}function S4(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=IW(t);if(e!=null)return e;if(TW(t)){let i=!0;const r=t.map(n=>{const o=S4(n);return n!=null&&o==null&&(i=!1),o});return i?r:null}if(O5(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!EW(t)){const i=new(Object.getPrototypeOf(t)).constructor;for(const r of Object.getOwnPropertyNames(t)){const n=t[r],o=S4(n);if(n!=null&&o==null)return null;i[r]=o}return i}return null}function O5(t){return typeof t.clone=="function"}function TW(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function EW(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function bN(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function IW(t){if(O7(t)||_W(t)||SW(t)||P7(t)||xW(t)||R7(t)||$W(t)||_I(t)||SI(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,r]of t)e.set(i,ae(r));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(ae(i));return e}return null}function F7(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t==null?void 0:t.getTime)=="function"&&typeof(e==null?void 0:e.getTime)=="function"&&t.getTime()===e.getTime()||!1}function N7(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&Rb(t,e):t instanceof Set?e instanceof Set&&ace(t,e):t instanceof Map?e instanceof Map&&lce(t,e):!!bN(t)&&bN(e)&&oce(t,e))}function oce(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const r of i)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function ace(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function lce(t,e){if(t.size!==e.size)return!1;for(const[i,r]of t){const n=e.get(i);if(n!==r||n===void 0&&!e.has(i))return!1}return!0}function D7(t,e,i=!1){return kW(t,e,i)}function G3(t,e){if(e!=null)return e[t]||MW(t.split("."),!1,e)}function Wn(t,e,i){const r=t.split("."),n=r.pop(),o=MW(r,!0,i);o&&n&&(o[n]=e)}function wN(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let r=0;r<t.length;r++)if(wN(t[r],i[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t)if(wN(t[i],e[i]))return!0;return!1}return t!==e}function MW(t,e,i){let r=i;for(const n of t){if(r==null)return;if(!(n in r)){if(!e)return;r[n]={}}r=r[n]}return r}function kW(t,e,i){return e?Object.keys(e).reduce((r,n)=>{let o=r[n],u=e[n];return o===u?r:o===void 0?(r[n]=ae(u),r):(Array.isArray(u)||Array.isArray(r)?(o=o?Array.isArray(o)?r[n]=o.concat():r[n]=[o]:r[n]=[],u&&(Array.isArray(u)||(u=[u]),i?u.forEach(p=>{o.includes(p)||o.push(p)}):r[n]=u.concat())):u&&typeof u=="object"?r[n]=kW(o,u,i):r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[n]=u),r)},t||{}):t}var uW;const Ct={apiKey:void 0,applicationName:"",applicationUrl:(uW=globalThis.location)==null?void 0:uW.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(D7(Ct,globalThis.esriConfig,!0),delete Ct.has),!Ct.assetsPath){{const t="4.30";Ct.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Ct.defaultAssetsPath=Ct.assetsPath}const uce=/\{([^}]+)\}/g;function _N(t){return t??""}function Xu(t,e){return e?t.replaceAll(uce,typeof e=="object"?(i,r)=>_N(G3(r,e)):(i,r)=>_N(e(r))):t}function cce(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,i=>e!=null&&e.includes(i)?i:`\\${i}`)}function CW(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let SN;function hce(t){return SN??(SN=new DOMParser),SN.parseFromString(t||"","text/html").body.innerText||""}function X2(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function uHe(t,...e){let i=t[0];for(let r=0;r<e.length;++r)i+=e[r]+t[r+1];return i}const xN={info:0,warn:1,error:2,none:3};let fe=class fa{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,fa._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=fa.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,fa._loggers.get(e)||new fa({module:e})}_log(e,i,...r){if(this._matchLevel(e)){if(i!=="always"&&!fa._throttlingDisabled){const n=dce(r),o=this._loggedMessages[e].get(n);if(i==="once"&&o!=null||i==="oncePerTick"&&o&&o>=fa._tickCounter)return;this._loggedMessages[e].set(n,fa._tickCounter),fa._scheduleTickCounterIncrement()}for(const n of Ct.log.interceptors)if(n(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,i){let r=this;for(;r!=null;){const n=r[e];if(n!=null)return n;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",pce)}_matchLevel(e){const i=Ct.log.level||"warn";return xN[this._parentWithMember("level",i)]<=xN[e]}static _scheduleTickCounterIncrement(){fa._tickCounterScheduled||(fa._tickCounterScheduled=!0,Promise.resolve().then(()=>{fa._tickCounter++,fa._tickCounterScheduled=!1}))}};function pce(t,e,...i){console[t](`[${e}]`,...i)}function dce(...t){return CW(JSON.stringify(t,(i,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}fe._loggers=new Map,fe._tickCounter=0,fe._tickCounterScheduled=!1,fe._throttlingDisabled=!1;function fce(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(i,r)=>r===""?"$":(G3(r,e)??"").toString())}let AW=class{constructor(e,i,r=void 0){this.name=e,this.details=r,this.message=(i&&fce(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},re=class LW extends AW{constructor(e,i,r){super(e,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return ae(i)}catch{return"[object]"}}))}}catch(e){throw fe.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new LW(e.name,e.message,e.details)}};re.prototype.type="error";const $N=new WeakMap;function yce(t,e,i=!1){const r=`ðŸ›‘ DEPRECATED - ${e}`;if(!i)return void t.warn(r);let n=$N.get(t);n||(n=new Set,$N.set(t,n)),n.has(e)||(n.add(e),t.warn(r))}function xI(t,e,i={}){if(me("esri-deprecation-warnings")){const{moduleName:r}=i;wm(t,`Function: ${(r?r+"::":"")+e+"()"}`,i)}}function wo(t,e,i={}){if(me("esri-deprecation-warnings")){const{moduleName:r}=i;wm(t,`Property: ${(r?r+"::":"")+e}`,i)}}function mce(t,e,i={}){me("esri-deprecation-warnings")&&wm(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function wm(t,e,i={}){if(me("esri-deprecation-warnings")){const{replacement:r,version:n,see:o,warnOnce:u}=i;let p=e;r&&(p+=`
	ðŸ› ï¸ Replacement: ${r}`),n&&(p+=`
	âš™ï¸ Version: ${n}`),o&&(p+=`
	ðŸ”— See ${o} for more details.`),yce(t,p,u)}}function hHe(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function gce(t,e){for(const i of t)if(i!=null&&e(i))return i}function Q2(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let Fb=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(Q2(e)){const r=this._getOrCreateGroup(i);for(const n of e)EN(n)&&r.push(n)}else EN(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&i&&r.forEach(i)}}has(e){return this._groups.has(KS(e))}remove(e){if(typeof e!="string"&&Q2(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(TN(this._getGroup(e)),this._groups.delete(KS(e)),this):this}removeAll(){return this._groups.forEach(TN),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(KS(e),i),i}_getGroup(e){return this._groups.get(KS(e))}};function KS(t){return t||"_default_"}function TN(t){for(const e of t)e instanceof Fb?e.removeAll():e.remove()}function EN(t){return t!=null&&(!!t.remove||t instanceof Fb)}function a0(t,e){if(t==null)throw new Error(e??"value is None")}function ot(t){return t==null||t.destroy(),null}function dHe(t){return t==null||t.dispose(),null}function Vi(t){return t==null||t.remove(),null}function En(t){return t==null||t.abort(),null}function fHe(t){return t==null||t.release(),null}function vce(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function Qv(t,e){let i;return t.some((r,n)=>(i=e(r,n),i!=null)),i??void 0}const OW=Symbol("Accessor-beforeDestroy"),bce={remove:()=>{}};function We(t){return t?{remove(){t&&(t(),t=void 0)}}:bce}function wce(t){t.forEach(e=>e==null?void 0:e.remove())}function In(t){return We(()=>wce(t))}function yHe(t){return We(()=>{var e;return(e=t())==null?void 0:e.remove()})}function _ce(t){return We(()=>t==null?void 0:t.abort())}function PW(t){return We(t!=null?()=>t.destroy():void 0)}function So(t){return t.__accessor__??null}function Sce(t,e){var i;return((i=t==null?void 0:t.metadata)==null?void 0:i[e])!=null}function z$(t,e,i){return i?P5(t,e,{policy:i,path:""}):P5(t,e,null)}function P5(t,e,i){return e?Object.keys(e).reduce((r,n)=>{const o=n;let u=null,p="merge";if(i&&(u=i.path?`${i.path}.${n}`:n,p=i.policy(u)),p==="replace"||p==="replace-arrays"&&Array.isArray(r[o]))return r[o]=e[o],r;if(r[o]===void 0)return r[o]=ae(e[o]),r;let g=r[o],w=e[o];if(g===w)return r;if(Array.isArray(w)||Array.isArray(r))g=g?Array.isArray(g)?r[o]=g.concat():r[o]=[g]:r[o]=[],w&&(Array.isArray(w)||(w=[w]),w.forEach(S=>{g.includes(S)||g.push(S)}));else if(w&&typeof w=="object")if(i){const S=i.path;i.path=u,r[o]=P5(g,w,i),i.path=S}else r[o]=P5(g,w,null);else r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[o]=w);return r},t||{}):t}function RW(t){return Array.isArray(t)?t:t.split(".")}function IN(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function xce(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...IN(i));return e}return IN(t)}function FW(t,e,i,r){const n=xce(e);if(n.length!==1){const o=n.map(u=>r(t,u,i));return In(o)}return r(t,n[0],i)}function NW(t,e){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const r=So(e);return Sce(r,i)?r.get(i):e[i]}function DW(t,e,i){if(t==null)return t;const r=NW(e[i],t);return!r&&i<e.length-1?void 0:i===e.length-1?r:DW(r,e,i+1)}function B3(t,e,i=0){return typeof e!="string"||e.includes(".")?DW(t,RW(e),i):NW(e,t)}function Ks(t,e){return B3(t,e)}function MN(t,e){return B3(e,t)!==void 0}var Go;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"})(Go||(Go={}));function q3(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const r in e)e[r]=ae(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function $I(t,e){const i=q3(t);let r=i[e];return r||(r=i[e]={}),r}function $ce(t,e){return z$(t,e,Ece)}const Tce=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Ece(t){return Tce.test(t)?"replace":"merge"}function Ice(t){return(t==null?void 0:t.release)&&typeof t.release=="function"}function Mce(t){return(t==null?void 0:t.acquire)&&typeof t.acquire=="function"}let Hp=class x4{constructor(e,i,r,n=1,o=0){if(this._ctor=e,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=n,this._pool=new Array(o),this._initialSize=o,this._ctor)for(let u=0;u<o;u++)this._pool[u]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...e){let i;if(x4.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let n=0;n<r;n++)this._pool[n]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):Mce(i)&&i.acquire(...e),i}release(e){e&&!x4.test.disabled&&(this._releaseFunction?this._releaseFunction(e):Ice(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};Hp.test={disabled:!1};let kce=class{constructor(e,i){this._observers=e,this._observer=i}remove(){L5(this._observers,this._observer)}},jW=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return Cce;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,n=!1;const o=i.length;for(let u=0;u<o;++u){const p=i[u];if(p.destroyed)n=!0;else if(p===e){r=!0;break}}return r||(i.push(e),n&&this._removeDestroyedObservers()),new kce(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let r=0;for(let n=0;n<i;++n){for(;n+r<i&&e[n+r].destroyed;)++r;if(r>0){if(!(n+r<i))break;e[n]=e[n+r]}}e.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const Cce=We();var ut;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(ut||(ut={}));const $4=ut.USER+1;function Of(t){switch(t){case"defaults":return ut.DEFAULTS;case"service":return ut.SERVICE;case"portal-item":return ut.PORTAL_ITEM;case"web-scene":return ut.WEB_SCENE;case"web-map":return ut.WEB_MAP;case"link-chart":return ut.LINK_CHART;case"user":return ut.USER;default:return null}}function R5(t){switch(t){case ut.DEFAULTS:return"defaults";case ut.SERVICE:return"service";case ut.PORTAL_ITEM:return"portal-item";case ut.WEB_SCENE:return"web-scene";case ut.WEB_MAP:return"web-map";case ut.LINK_CHART:return"link-chart";case ut.USER:return"user"}}function Ace(t){return R5(t)}var Ii;(function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(Ii||(Ii={}));const F5={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},Xw=[];let m2=F5;function He(t){m2.onObservableAccessed(t)}let U$=!1,G$=!1;function Wp(t,e,i){if(U$)return j7(t,e,i);VW(t);const r=e.call(i);return zW(),r}function Lce(t,e){return Wp(F5,t,e)}function j7(t,e,i){const r=U$;U$=!0,VW(t);let n=null;try{n=e.call(i)}catch(o){G$&&fe.getLogger("esri.core.accessorSupport.tracking").error(o)}return zW(),U$=r,n}function VW(t){m2=t,Xw.push(t)}function zW(){const t=Xw.length;if(t>1){const e=Xw.pop();m2=Xw[t-2],e.onTrackingEnd()}else if(t===1){const e=Xw.pop();m2=F5,e.onTrackingEnd()}else m2=F5}function UW(t,e){if(e.flags&Ii.DepTrackingInitialized)return;const i=G$;G$=!1,e.flags&Ii.AutoTracked?j7(e,e.metadata.get,t):GW(t,e),G$=i}const Oce=[];function GW(t,e){e.flags&Ii.ExplicitlyTracking||(e.flags|=Ii.ExplicitlyTracking,j7(e,()=>{const i=e.metadata.dependsOn||Oce;for(const r of i)if(typeof r!="string"||r.includes(".")){const n=RW(r);for(let o=0,u=t;o<n.length&&u!=null&&typeof u=="object";++o)u=kN(u,n[o],o!==n.length-1)}else kN(t,r,!1)}),e.flags&=~Ii.ExplicitlyTracking)}function kN(t,e,i){const r=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const o=parseInt(r,10);if(!isNaN(o))return Array.isArray(t)?t[o]:t.at(o)}const n=So(t);if(n){const o=n.propertiesByName.get(r);o&&(He(o),UW(t,o))}return i?t[r]:void 0}let CN=class extends jW{constructor(e,i){super(),this.propertyName=e,this.metadata=i,this._accessed=null,this._handles=null,this.flags=0,this.flags=Ii.Dirty|(i.nonNullable?Ii.NonNullable:0)|(i.hasOwnProperty("value")?Ii.HasDefaultValue:0)|(i.get===void 0?Ii.DepTrackingInitialized:0)|(i.dependsOn===void 0?Ii.AutoTracked:0)}destroy(){this.flags&Ii.Dirty&&this.onCommitted(),super.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(e){He(this);const i=e.store,r=this.propertyName,n=this.flags,o=i.get(r);if(n&Ii.Computing||~n&Ii.Dirty&&i.has(r))return o;this.flags|=Ii.Computing;const u=e.host;let p;n&Ii.AutoTracked?p=Wp(this,this.metadata.get,u):(GW(u,this),p=this.metadata.get.call(u)),i.set(r,p,ut.COMPUTED);const g=i.get(r);return g===o?this.flags&=~Ii.Dirty:Lce(this.commit,this),this.flags&=~Ii.Computing,g}onObservableAccessed(e){e!==this&&(this._accessed??(this._accessed=new Set),this._accessed.add(e))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=Ii.DepTrackingInitialized,this._accessed!=null&&(this._handles??(this._handles=[]),this._accessed.forEach(e=>{this._handles.push(e.observe(this))}),this._accessed.clear())}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~Ii.Dirty,this.onCommitted()}_clearObservationHandles(){const e=this._handles;if(e!==null){for(let i=0;i<e.length;++i)e[i].remove();e.length=0}}onInvalidated(){~this.flags&Ii.Overridden&&(this.flags|=Ii.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onCommitted()}}},Pce=class BW{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new BW;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,ae(r))}),i}get(e){return this._values.get(e)}originOf(){return ut.USER}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function YS(t,e,i){return t!==void 0}function AN(t,e,i,r){return t!==void 0&&(!(i==null&&t.flags&Ii.NonNullable)||(r.lifecycle,Go.INITIALIZING,!1))}let Rce=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Go.INITIALIZING,this.store=new Pce,this._origin=ut.USER;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const n=new CN(r,i[r]);this.propertiesByName.set(r,n)}this.metadata=i}initialize(){this.lifecycle=Go.CONSTRUCTING}constructed(){this.lifecycle=Go.CONSTRUCTED}destroy(){this.lifecycle=Go.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Go.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(i.metadata.get)return i.getComputed(this);He(i);const r=this.store;return r.has(e)?r.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&Ii.HasDefaultValue)return"defaults"}return R5(i)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(YS(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const r=this.propertiesByName.get(e);YS(r)&&this._internalSet(r,i)}getDependsInfo(e,i,r){const n=this.propertiesByName.get(i);if(!YS(n))return"";const o=new Set,u=Wp({onObservableAccessed:g=>o.add(g),onTrackingEnd:()=>{}},()=>{var g;return(g=n.metadata.get)==null?void 0:g.call(e)});let p=`${r}${e.declaredClass.split(".").pop()}.${i}: ${u}
`;if(o.size===0)return p;r+="  ";for(const g of o)g instanceof CN&&(p+=`${r}${g.propertyName}: undefined
`);return p}setAtOrigin(e,i,r){const n=this.propertiesByName.get(e);if(YS(n))return this._setAtOrigin(n,i,r)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.flags&Ii.Overridden)}clearOverride(e){const i=this.propertiesByName.get(e);i&&i.flags&Ii.Overridden&&(i.flags&=~Ii.Overridden,i.notifyChange())}override(e,i){const r=this.propertiesByName.get(e);if(!AN(r,e,i,this))return;const n=r.metadata.cast;if(n){const o=this._cast(n,i),{valid:u,value:p}=o;if(a9.release(o),!u)return;i=p}r.flags|=Ii.Overridden,this._internalSet(r,i)}set(e,i){const r=this.propertiesByName.get(e);if(!AN(r,e,i,this))return;const n=r.metadata.cast;if(n){const u=this._cast(n,i),{valid:p,value:g}=u;if(a9.release(u),!p)return;i=g}const o=r.metadata.set;o?o.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(e){this._origin=Of(e)}getDefaultOrigin(){return R5(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const r=this.lifecycle!==Go.INITIALIZING?this._origin:ut.DEFAULTS;this._setAtOrigin(e,i,r)}_setAtOrigin(e,i,r){const n=this.store,o=e.propertyName;n.has(o,r)&&F7(i,n.get(o))&&~e.flags&Ii.Overridden&&r===n.originOf(o)||(e.invalidate(),n.set(o,i,r),e.commit(),UW(this.host,e))}_cast(e,i){const r=a9.acquire();return r.valid=!0,r.value=i,e&&(r.value=e.call(this.host,i,r)),r}},Fce=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const a9=new Hp(Fce);function N5(t,e,i){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))N5(t,r,e[r]);else{if(e.includes(".")){const n=e.split("."),o=n.splice(-1,1)[0];return void N5(Ks(t,n),o,i)}const r=t.__accessor__;r!=null&&Nce(e,r),t[e]=i}}function Nce(t,e){if(me("esri-unknown-property-errors")&&!Dce(t,e))throw new re("set:unknown-property",jce(t,e))}function Dce(t,e){return e.metadata[t]!=null}function jce(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let Vce;function zce(){return Vce}var LN;(function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"})(LN||(LN={}));function Uce(t){t.length=0}let vo=class{constructor(e=50,i=50){this._pool=new Hp(Array,void 0,Uce,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return l9.acquire()}static release(e){return l9.release(e)}static prune(){l9.prune()}};const l9=new vo(100);let qW=class extends Hp{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const XS=[];function eb(t){XS.push(t),XS.length===1&&queueMicrotask(()=>{const e=XS.slice();XS.length=0;for(const i of e)i()})}let g2=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}record(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var T4;(function(t){const e=(o,u,p,g)=>{let w=u,S=u;const T=p>>>1,E=o[w-1];for(;S<=T;){S=w<<1,S<p&&g(o[S-1],o[S])<0&&++S;const C=o[S-1];if(g(C,E)<=0)break;o[w-1]=C,w=S}o[w-1]=E},i=(o,u)=>o<u?-1:o>u?1:0;function r(o,u,p,g){u===void 0&&(u=0),p===void 0&&(p=o.length),g===void 0&&(g=i);for(let S=p>>>1;S>u;S--)e(o,S,p,g);const w=u+1;for(let S=p-1;S>u;S--){const T=o[u];o[u]=o[S],o[S]=T,e(o,w,S,g)}}function*n(o,u,p,g){u===void 0&&(u=0),p===void 0&&(p=o.length),g===void 0&&(g=i);for(let S=p>>>1;S>u;S--)e(o,S,p,g),yield;const w=u+1;for(let S=p-1;S>u;S--){const T=o[u];o[u]=o[S],o[S]=T,e(o,w,S,g),yield}}t.sort=r,t.iterableSort=n})(T4||(T4={}));const ON=T4,Gce=1.5,Bce=1.1;let om=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new yW,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>PN(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let r=0;r<this._length;r++){const n=this.data[r];e(n)&&i.push(n)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const r=this.data.indexOf(e,i);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let r=0;r<i;r++)this.data[this._length++]=e[r]}fill(e,i){for(let r=0;r<i;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,PN(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=_4(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(_4(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,r){this.length=Que(this.data,e,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const r=this.data[e];this.data[e]=this.data[i],this.data[i]=r}sort(e){ON.sort(this.data,0,this.length,e)}iterableSort(e){return ON.iterableSort(this.data,0,this.length,e)}some(e,i){for(let r=0;r<this.length;++r)if(e.call(i,this.data[r],r,this.data))return!0;return!1}find(e,i){for(let r=0;r<this.length;++r){const n=this.data[r];if(e.call(i,n,r))return n}}filterInPlace(e,i){let r=0;for(let n=0;n<this._length;++n){const o=this.data[n];e.call(i,o,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=o,r++)}if(this._deallocator)for(let n=r;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=r,this._shrink(),this}forAll(e,i){const{data:r,length:n}=this;for(let o=0;o<n;++o)e.call(i,r[o],o,r)}forEach(e,i){this.data.slice(0,this.length).forEach(e,i)}map(e,i){const r=new Array(this.length);for(let n=0;n<this.length;++n)r[n]=e.call(i,this.data[n],n,this.data);return r}reduce(e,i){let r=i;for(let n=0;n<this.length;++n)r=e(r,this.data[n],n,this.data);return r}has(e){const i=this.length,r=this.data;for(let n=0;n<i;++n)if(r[n]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function PN(t){t.data.length>Gce*t.length&&(t.data.length=Math.floor(t.length*Bce))}function qce(t){return{setTimeout:(e,i)=>{const r=t.setTimeout(e,i);return We(()=>t.clearTimeout(r))}}}const Nb=qce(globalThis);function TI(t){return Hce(t)||HW(t)}function Hce(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function HW(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function H3(t,e,i){if(!TI(t))throw new TypeError("target is not a Evented or EventTarget object");return HW(t)?Wce(t,e,i):t.on(e,i)}function Wce(t,e,i,r){if(Array.isArray(e)){const n=e.slice();for(const o of n)t.addEventListener(o,i,r);return We(()=>{for(const o of n)t.removeEventListener(o,i,r)})}return t.addEventListener(e,i,r),We(()=>t.removeEventListener(e,i,r))}function WW(t,e,i){if(!TI(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const r=H3(t,e,n=>{r.remove(),i.call(t,n)});return r}function ni(t="Aborted"){return new re("AbortError",t)}function At(t,e="Aborted"){if(Xo(t))throw ni(e)}function EI(t){return t instanceof AbortSignal?t:t==null?void 0:t.signal}function Xo(t){const e=EI(t);return e!=null&&e.aborted}function Ra(t){if(Cn(t))throw t}function D5(t){if(!Cn(t))throw t}function Zo(t,e){const i=EI(t);if(i!=null){if(!i.aborted)return WW(i,"abort",()=>e());e()}}function V7(t,e){const i=EI(t);if(i!=null)return At(i),WW(i,"abort",()=>e(ni()))}function zl(t,e){return EI(e)==null?t:new Promise((i,r)=>{let n=Zo(e,()=>r(ni()));const o=()=>{n=Vi(n)};t.then(o,o),t.then(i,r)})}function Cn(t){return(t==null?void 0:t.name)==="AbortError"}async function Wu(t){try{return await t}catch(e){if(!Cn(e))throw e;return}}async function Qy(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),r=i.map(u=>t[u]),n=await Qy(r),o={};return i.map((u,p)=>o[u]=n[p]),o}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(r,n)=>{const o=i[n];return o.status==="fulfilled"?{promise:r,value:o.value}:{promise:r,error:o.reason}}))}async function JW(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function THe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function Db(t,e=void 0,i){const r=new AbortController;return Zo(i,()=>r.abort()),new Promise((n,o)=>{let u=setTimeout(()=>{u=0,n(e)},t);Zo(r,()=>{u&&(clearTimeout(u),o(ni()))})})}function Jce(t,e){const i=new AbortController,r=setTimeout(()=>i.abort(),e);return Zo(t,()=>{i.abort(),clearTimeout(r)}),{...t,signal:i.signal}}function ed(t){return t&&typeof t.then=="function"}function E4(t){return ed(t)?t:Promise.resolve(t)}function Da(t,e=-1){let i,r,n,o,u=null;const p=(...g)=>{if(i){r=g,o&&o.reject(ni()),o=os();const E=o.promise;if(u){const C=u;u=null,C.abort()}return E}if(n=o||os(),o=null,e>0){const E=new AbortController;i=E4(t(...g,E.signal));const C=i;Db(e).then(()=>{i===C&&(o?E.abort():u=E)})}else i=1,i=E4(t(...g));const w=()=>{const E=r;r=n=i=u=null,E!=null&&p(...E)},S=i,T=n;return S.then(w,w),S.then(T.resolve,T.reject),T.promise};return p}function os(){let t,e;const i=new Promise((n,o)=>{t=n,e=o}),r=n=>{t(n)};return r.resolve=n=>t(n),r.reject=n=>e(n),r.timeout=(n,o)=>Nb.setTimeout(()=>r.reject(o),n),r.promise=i,r}async function RN(t){await Promise.resolve(),At(t)}function EHe(t){return t}function Zce(t){return 1e3*t}function IHe(t){return t}function MHe(t){return .001*t}let Kce=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},Yce=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},I4=0;const pw={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},M4=["prepare","preRender","render","postRender","update","finish"],k4=[],_m=new om;let Xce=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};function Qce(){am!=null&&(cancelAnimationFrame(am),am=requestAnimationFrame(z7))}const j5={frameTasks:_m,willDispatch:!1,clearFrameTasks:ehe,dispatch:KW,executeFrameTasks:the,reschedule:Qce};function jb(t){const e=new Yce(t);return k4.push(e),j5.willDispatch||(j5.willDispatch=!0,eb(KW)),e}function tb(t){const e=new Kce(t);return _m.push(e),am==null&&(I4=performance.now(),am=requestAnimationFrame(z7)),new Xce(e)}let am=null;function ehe(t=!1){_m.forAll(e=>{e.removed=!0}),t&&ZW()}function z7(){const t=performance.now();am=null,am=_m.length>0?requestAnimationFrame(z7):null,j5.executeFrameTasks(t)}function the(t){const e=t-I4;I4=t;const i=1e3/60,r=Math.max(0,e-i);pw.time=t,pw.frameDuration=i-r;for(let n=0;n<M4.length;n++){const o=performance.now(),u=M4[n];_m.forAll(p=>{var g;p.paused||p.removed||(n===0&&p.ticks++,p.phases[u]&&(pw.elapsedFrameTime=performance.now()-t,pw.deltaTime=p.ticks===0?0:e,(g=p.phases[u])==null||g.call(p,pw)))}),nhe[n].record(performance.now()-o)}ZW(),she.record(performance.now()-t)}const QS=new om;function ZW(){_m.forAll(t=>{t.removed&&QS.push(t)}),_m.removeUnorderedMany(QS.data,QS.length),QS.clear()}function KW(){for(;k4.length;){const t=k4.shift();t.isActive&&t.callback()}j5.willDispatch=!1}function ihe(t=1,e){const i=os(),r=()=>{Xo(e)?i.reject(ni()):t===0?i():(--t,eb(()=>r()))};return r(),i.promise}function rhe(t){return ihe(1,t)}async function LHe(){await rhe(),await new Promise(t=>requestAnimationFrame(t))}const nhe=M4.map(t=>new g2(t)),she=new g2("total");function ohe(t,e){for(const i of t.entries())if(e(i[0]))return!0;return!1}function V5(t,e){if(!e)return t;for(const i of e)i!=null&&t.add(i);return t}function FN(t,e){return e!=null&&t.add(e),t}function U7(t,e){const i=new Set;return V5(i,t),V5(i,e),i}function YW(t,e){const i=new Set;for(const r of e)t.has(r)&&i.add(r);return i}function OHe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function PHe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function ahe(t,e){const i=new Set(t);for(const r of e)i.delete(r);return i}function lhe(t,e){return ahe(U7(t,e),YW(t,e))}function NN(t){let e;for(e of t);return e}let uhe=0;function Fp(){return++uhe}let II=class{constructor(e){this._accessed=new Set,this._handles=[],this._observerObject=new che(e),DN.register(this,new WeakRef(this._observerObject),this)}destroy(){var e;DN.unregister(this._observerObject),this._accessed.clear(),(e=this._observerObject)==null||e.destroy(),this.clear()}onObservableAccessed(e){this._accessed.add(e)}onTrackingEnd(){const e=this._handles,i=this._observerObject;this._accessed.forEach(r=>{e.push(r.observe(i))}),this._accessed.clear()}clear(){const e=this._handles;for(let i=0;i<e.length;++i)e[i].remove();e.length=0}},che=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=hhe}};const DN=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function hhe(){}let bv=!1;const z5=[];function XW(t,e){let i=new II(o),r=null,n=!1;function o(){if(!i||n)return;if(bv)return void tJ(o);const p=r;i.clear(),bv=!0,n=!0,r=Wp(i,t),n=!1,bv=!1,e(r,p),iJ()}function u(){i&&(i.destroy(),i=null,r=null)}return n=!0,r=Wp(i,t),n=!1,We(u)}function QW(t,e){let i=new II(n),r=null;function n(){e(r,u)}function o(){i&&(i.destroy(),i=null),r=null}function u(){return i?(i.clear(),r=Wp(i,t),r):null}return u(),We(o)}function eJ(t){let e=new II(r),i=!1;function r(){e&&!i&&(bv?tJ(r):(e.clear(),bv=!0,i=!0,Wp(e,t),i=!1,bv=!1,iJ()))}function n(){e&&(e.destroy(),e=null)}return i=!0,Wp(e,t),i=!1,We(n)}function tJ(t){z5.includes(t)||z5.unshift(t)}function iJ(){for(;z5.length;)z5.pop()()}var v2;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})(v2||(v2={}));let e3=class{constructor(){this.uid=Fp(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,r,n,o){return this.pool.acquire(v2.Untracked,e,i,r,n,o,F7)}static acquireTracked(e,i,r,n){return this.pool.acquire(v2.Tracked,e,i,r,null,null,n)}notify(e,i){this.type===v2.Untracked?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,r,n,o,u,p){this.uid=Fp(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=r,this.getValue=n,this.target=o,this.path=u,this.equals=p}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Fp(),this.removed=!0}};e3.pool=new qW(e3);const B$=new vo,Np=new Set;let U5;function G5(t){Np.delete(t),Np.add(t),U5||(U5=jb(fhe))}function phe(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function dhe(t){for(const e of Np.values())e.target===t&&(e.removed=!0)}function fhe(){let t=10;for(;U5&&t--;){U5=null;const e=yhe(),i=B$.acquire();for(const r of e){const n=r.uid;phe(r),n===r.uid&&r.removed&&i.push(r)}for(const r of Np)r.removed&&(i.push(r),Np.delete(r));for(const r of i)e3.pool.release(r);B$.release(i),B$.release(e),C4.forEach(r=>r())}}function yhe(){const t=B$.acquire();t.length=Np.size;let e=0;for(const i of Np)t[e]=i,++e;return Np.clear(),t}const C4=new Set;function mhe(t){return C4.add(t),We(()=>C4.delete(t))}function ghe(t,e,i){let r=FW(t,e,i,(n,o,u)=>{let p,g,w=QW(()=>B3(n,o),(S,T)=>{var E;((E=n.__accessor__)==null?void 0:E.lifecycle)===Go.DESTROYED||p&&p.uid!==g?r.remove():(p||(p=e3.acquireUntracked(S,u,T,n,o),g=p.uid),G5(p))});return We(()=>{w.remove(),p&&(p.uid!==g||p.removed||(p.removed=!0,G5(p)),p=null),r=w=null})});return r}function vhe(t,e,i){const r=FW(t,e,i,(n,o,u)=>{let p=!1;return XW(()=>B3(n,o),(g,w)=>{n.__accessor__.lifecycle!==Go.DESTROYED?p||(p=!0,F7(w,g)||u.call(n,g,w,o,n),p=!1):r.remove()})});return r}function bhe(t,e,i,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Go.DESTROYED?r?vhe(t,e,i):ghe(t,e,i):We()}function whe(t,e,i){let r,n,o=QW(t,(u,p)=>{r&&r.uid!==n?o.remove():(r||(r=e3.acquireTracked(u,e,p,i),n=r.uid),G5(r))});return We(()=>{o.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,G5(r)),r=null),o=null})}function _he(t,e,i){let r=!1;return XW(t,(n,o)=>{r||(r=!0,i(o,n)||e(n,o),r=!1)})}function She(t,e,i=!1,r=N7){return i?_he(t,e,r):whe(t,e,r)}function jN(t){return ohe(Np,e=>e.oldValue===t)}function MI(t,e){for(const[i,r]of t)if(e(r,i))return!0;return!1}function DHe(t,e){for(const[i,r]of t)if(e(r,i))return r;return null}function Bf(t,e,i){const r=t.get(e);if(r!==void 0)return r;const n=i();return t.set(e,n),n}function jHe(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}const wv=()=>fe.getLogger("esri.core.accessorSupport.ensureTypes");function xhe(t){return t==null?t:new Date(t)}function $he(t){return t==null?t:!!t}function W3(t){return t==null?t:t.toString()}function Tl(t){return t==null?t:(t=parseFloat(t),isNaN(t)?0:t)}function G7(t){return t==null?t:Math.round(parseFloat(t))}function The(t){return null}function rJ(t){return(t==null?void 0:t.constructor)&&t.constructor.__accessorMetadata__!==void 0}function B5(t,e){return e!=null&&t&&!(e instanceof t)}function nJ(t){return t&&"isCollection"in t}function VN(t){return t!=null&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function Ehe(t,e){if(!(e!=null&&e.constructor)||!nJ(e.constructor))return A4(t,e)?e:new t(e);const i=VN(t.prototype.itemType),r=VN(e.constructor.prototype.itemType);return i?r?i===r?e:i.prototype.isPrototypeOf(r.prototype)?new t(e):(A4(t,e),e):new t(e):e}function A4(t,e){return!!rJ(e)&&(wv().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+kI(t)+"'"),!0)}function J3(t,e){return e==null?e:nJ(t)?Ehe(t,e):B5(t,e)?A4(t,e)?e:new t(e):e}function kI(t){var e;return((e=t==null?void 0:t.prototype)==null?void 0:e.declaredClass)||"unknown"}const Ihe=new WeakMap;function Mhe(t){switch(t){case Number:return Tl;case zt:return G7;case Boolean:return $he;case String:return W3;case Date:return xhe;case Vb:return The;default:return Bf(Ihe,t,()=>J3.bind(null,t))}}function Yi(t,e){const i=Mhe(t);return arguments.length===1?i:i(e)}function t3(t,e,i){return arguments.length===1?t3.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,i)):[t(e,i)])}function khe(t,e){return arguments.length===1?t3(i=>Yi(t,i)):t3(i=>Yi(t,i),e)}function sJ(t,e,i){return e!==0&&Array.isArray(i)?i.map(r=>sJ(t,e-1,r)):t(i)}function q5(t,e,i){if(arguments.length===2)return o=>q5(t,e,o);if(!i)return i;i=sJ(t,e,i);let r=e,n=i;for(;r>0&&Array.isArray(n);)r--,n=n[0];if(n!==void 0)for(let o=0;o<r;o++)i=[i];return i}function Che(t,e,i){return arguments.length===2?q5(r=>Yi(t,r),e):q5(r=>Yi(t,r),e,i)}function oJ(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function L4(t,e){if(arguments.length===2)return L4(t).call(null,e);const i=new Set,r=t.filter(p=>typeof p!="function"),n=t.filter(p=>typeof p=="function");for(const p of t)typeof p!="string"&&typeof p!="number"||i.add(p);let o=null,u=null;return(p,g)=>{if(p==null)return p;const w=typeof p,S=w==="string"||w==="number";return S&&(i.has(p)||n.some(T=>w==="string"&&T===String||w==="number"&&T===Number))||w==="object"&&n.some(T=>!B5(p,T))?p:(S&&r.length?(o||(o=r.map(T=>typeof T=="string"?`'${T}'`:`${T}`).join(", ")),wv().error("Accessor#set",`'${p}' is not a valid value for this property, only the following values are valid: ${o}`)):typeof p=="object"&&n.length?(u||(u=n.map(T=>kI(T)).join(", ")),wv().error("Accessor#set",`'${p}' is not a valid value for this property, value must be one of ${u}`)):wv().error("Accessor#set",`'${p}' is not a valid value for this property`),g&&(g.valid=!1),null)}}function ch(t,e){if(arguments.length===2)return ch(t).call(null,e);const i={},r=[],n=[];for(const g in t.typeMap){const w=t.typeMap[g];i[g]=Yi(w),r.push(kI(w)),n.push(g)}const o=()=>`'${r.join("', '")}'`,u=()=>`'${n.join("', '")}'`,p=typeof t.key=="string"?g=>g[t.key]:t.key;return g=>{if(t.base&&!B5(t.base,g)||g==null)return g;const w=p(g)||t.defaultKeyValue,S=i[w];if(!S)return wv().error("Accessor#set",`Invalid property value, value needs to be one of ${o()}, or a plain object that can autocast (having .type = ${u()})`),null;if(!B5(t.typeMap[w],g))return g;if(typeof t.key=="string"&&!rJ(g)){const T={};for(const E in g)E!==t.key&&(T[E]=g[E]);return S(T)}return S(g)}}let zt=class{},Vb=class{};const UHe={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Ahe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function aJ(t){switch(t.type){case"native":return Yi(t.value);case"array":return t3(aJ(t.value));case"one-of":return Lhe(t);default:return null}}function Lhe(t){let e=null;return(i,r)=>P4(i,t)?i:(e==null&&(e=O4(t)),wv().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function O4(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case zt:return"integer";case Date:return"date";case Vb:return"null";default:return kI(t.value)}case"array":return`array of ${O4(t.value)}`;case"one-of":{const e=t.values.map(i=>O4(i));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function P4(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case zt:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case Vb:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!P4(i,e.value));case"one-of":return e.values.some(i=>P4(t,i))}}function b(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),n=$I(e,i);r&&(r.get||r.set?(n.get=r.get||n.get,n.set=r.set||n.set):"value"in r&&("value"in t&&fe.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=r.value)),t.readOnly!=null&&(n.readOnly=t.readOnly);const o=t.aliasOf;if(o){const g=typeof o=="string"?o:o.source,w=typeof o=="string"?null:o.overridable===!0;let S;n.dependsOn=[g],n.get=function(){let T=Ks(this,g);if(typeof T=="function"){S||(S=g.split(".").slice(0,-1).join("."));const E=Ks(this,S);E&&(T=T.bind(E))}return T},n.readOnly||(n.set=w?function(T){this._override(i,T)}:function(T){N5(this,g,T)})}const u=t.type,p=t.types;n.cast||(u?n.cast=Ohe(u):p&&(Array.isArray(p)?n.cast=t3(ch(p[0])):n.cast=ch(p))),$ce(n,t),t.range&&(n.cast=Phe(n.cast,t.range))}}function lJ(t,e,i){const r=$I(t,i);r.json||(r.json={});let n=r.json;return e!==void 0&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function Ohe(t){let e=0,i=t;if(Ahe(t))return aJ(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const r=i;if(oJ(r))return e===0?L4(r):q5(L4(r),e);if(e===1)return khe(r);if(e>1)return Che(r,e);const n=t;return n.from?n.from:Yi(n)}function Phe(t,e){return i=>{let r=+t(i);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function Rhe(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(e[r]){const n=e[r];i[r].forEach(o=>{e[o]=n}),delete e[r]}}}let Ul=class extends AW{constructor(e,i,r){super(e,i,r)}};Ul.prototype.type="warning";function uJ(t){var e;return!!t&&((e=t.prototype)==null?void 0:e.declaredClass)&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const R4=()=>fe.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function zN(t,e,i){var r,n;t&&(!i&&!e.read||(r=e.read)!=null&&r.reader||((n=e.read)==null?void 0:n.enabled)===!1||Dhe(t)&&Wn("read.reader",zb(t),e))}function zb(t){var i,r;const e=t.ndimArray??0;if(e>1)return Nhe(t);if(e===1)return UN(t);if("type"in t&&hJ(t.type)){const n=(r=(i=t.type.prototype)==null?void 0:i.itemType)==null?void 0:r.Type,o=UN(typeof n=="function"?{type:n}:{types:n});return(u,p,g)=>{const w=o(u,p,g);return w&&new t.type(w)}}return B7(t)}function B7(t){return"type"in t?Fhe(t.type):jhe(t.types)}function Fhe(t){return t.prototype.read?(e,i,r)=>{if(e==null)return e;const n=typeof e;if(n!=="object")return void R4().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const o=new t;return o.read(e,r),o}:t.fromJSON}function cJ(t,e,i,r){return r!==0&&Array.isArray(e)?e.map(n=>cJ(t,n,i,r-1)):t(e,void 0,i)}function Nhe(t){const e=B7(t),i=cJ.bind(null,e),r=t.ndimArray??0;return(n,o,u)=>{if(n==null)return n;n=i(n,u,r);let p=r,g=n;for(;p>0&&Array.isArray(g);)p--,g=g[0];if(g!==void 0)for(let w=0;w<p;w++)n=[n];return n}}function UN(t){const e=B7(t);return(i,r,n)=>{if(i==null)return i;if(Array.isArray(i)){const u=[];for(const p of i){const g=e(p,void 0,n);g!==void 0&&u.push(g)}return u}const o=e(i,void 0,n);return o!==void 0?[o]:void 0}}function hJ(t){if(!uJ(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?q7(e.Type):pJ(e.Type))}function Dhe(t){return"types"in t?pJ(t.types):q7(t.type)}function q7(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||hJ(t))}function pJ(t){for(const e in t.typeMap)if(!q7(t.typeMap[e]))return!1;return!0}function jhe(t){let e=null;const i=t.errorContext??"type",r=t.validate;return(n,o,u)=>{if(n==null)return n;const p=typeof n;if(p!=="object")return void R4().error(`Expected JSON value of type 'object' to deserialize, but got '${p}'`);e||(e=Vhe(t));const g=t.key;if(typeof g!="string")return;const w=n[g],S=w?e[w]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!S){const E=`Type '${w||"unknown"}' is not supported`;return u!=null&&u.messages&&n&&u.messages.push(new Ul(`${i}:unsupported`,E,{definition:n,context:u})),void R4().error(E)}const T=new S;return T.read(n,u),r?r(T):T}}function Vhe(t){var i,r;const e={};for(const n in t.typeMap){const o=t.typeMap[n],u=q3(o.prototype);if(typeof t.key=="function")continue;const p=u[t.key];if(!p)continue;if((i=p.json)!=null&&i.type&&Array.isArray(p.json.type)&&p.json.type.length===1&&typeof p.json.type[0]=="string"){e[p.json.type[0]]=o;continue}const g=(r=p.json)==null?void 0:r.write;if(!(g!=null&&g.writer)){e[n]=o;continue}const w=g.target,S=typeof w=="string"?w:t.key,T={};g.writer(n,T,S),T[S]&&(e[T[S]]=o)}return e}function zhe(t){if(t.json||(t.json={}),BN(t.json),qN(t.json),GN(t.json),t.json.origins)for(const e in t.json.origins)BN(t.json.origins[e]),qN(t.json.origins[e]),GN(t.json.origins[e]);return!0}function GN(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function BN(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function qN(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function HN(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=(t==null?void 0:t.ndimArray)??0;t&&(i===1||"type"in t&&uJ(t.type))?e.write.writer=Bhe:i>1?e.write.writer=qhe(i):e.types?Array.isArray(e.types)?e.write.writer=Ghe(e.types[0]):e.write.writer=Uhe(e.types):e.write.writer=i3}function Uhe(t){return(e,i,r,n)=>e?dJ(e,t,n)?i3(e,i,r,n):void 0:i3(e,i,r,n)}function dJ(t,e,i){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(i!=null&&i.messages){const r=e.errorContext??"type",n=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new re(`${r}:unsupported`,n,{definition:t,context:i})),fe.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function Ghe(t){return(e,i,r,n)=>!e||!Array.isArray(e)?i3(e,i,r,n):i3(e.filter(o=>dJ(o,t,n)),i,r,n)}function i3(t,e,i,r){Wn(i,H5(t,r),e)}function H5(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?W5(t):t}function W5(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function Bhe(t,e,i,r){let n;t===null?n=null:t&&typeof t.map=="function"?(n=t.map(o=>H5(o,r)),typeof n.toArray=="function"&&(n=n.toArray())):n=[H5(t,r)],Wn(i,n,e)}function fJ(t,e,i){return i!==0&&Array.isArray(t)?t.map(r=>fJ(r,e,i-1)):H5(t,e)}function qhe(t){return(e,i,r,n)=>{let o;if(e===null)o=null;else{o=fJ(e,n,t);let u=t,p=o;for(;u>0&&Array.isArray(p);)u--,p=p[0];if(p!==void 0)for(let g=0;g<u;g++)o=[o]}Wn(r,o,i)}}function Hhe(t,e){return H7(t,"any",e==null?void 0:e.origin)}function F4(t,e){return H7(t,"read",e==null?void 0:e.origin)}function yJ(t,e){return H7(t,"write",e==null?void 0:e.origin)}function H7(t,e,i){let r=t==null?void 0:t.json;if(r!=null&&r.origins&&i){let n;n=i==="link-chart"?r.origins[i]&&(e==="any"||e in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],n&&(e==="any"||e in n)&&(r=n)}return r}function Whe(t){var i;const e=Jhe(t);if(t.json.origins)for(const r in t.json.origins){const n=t.json.origins[r],o=n.types?Zhe(n):e;zN(o,n,!1),n.types&&!n.write&&((i=t.json.write)!=null&&i.enabled)&&(n.write={...t.json.write}),HN(o,n)}zN(e,t.json,!0),HN(e,t.json)}function Jhe(t){return t.json.types?N4(t.json):t.type?mJ(t):N4(t)}function Zhe(t){return t.type?mJ(t):N4(t)}function mJ(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!oJ(i);)i=i[0],e++;return{type:i,ndimArray:e}}function N4(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function Khe(t){zhe(t)&&(Rhe(t),Whe(t))}const u9=new Set,c9=new Set;function G(t){return e=>{t??(t="esri.core.Accessor"),e.prototype.declaredClass=t,Xhe(e);const i=[],r=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!u9.has(n.initialize)&&(u9.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!c9.has(n.destroy)&&(c9.add(n.destroy),r.push(n.destroy)),n=Object.getPrototypeOf(n);u9.clear(),c9.clear();const o=class extends e{constructor(...p){if(super(...p),this.constructor===o&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let g=i.length-1;g>=0;g--)i[g].call(this)}}),r.length){let g=!1;const w=this[OW];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!g){g=!0,w.call(this);for(let S=0;S<r.length;S++)r[S].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};o.__accessorMetadata__=q3(e.prototype),o.prototype.declaredClass=t;const u=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(o,"name",{value:u,configurable:!0}),o}}function Yhe(t,e){return e.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r===void 0)return;He(r);const n=i.store;return n.has(t)?n.get(t):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r!==void 0)return r.getComputed(i)}}function Xhe(t){const e=t.prototype,i=q3(e),r={};for(const n of Object.getOwnPropertyNames(i)){const o=i[n];Khe(o),r[n]={enumerable:!0,configurable:!0,get:Yhe(n,o),set(u){const p=this.__accessor__;if(p!==void 0){if(!Object.isFrozen(this))return p.initialized&&o.readOnly?WN("read-only",n):p.lifecycle===Go.CONSTRUCTED&&o.constructOnly?WN("construct-only",n):void p.set(n,u)}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:u})}}}Object.defineProperties(t.prototype,r)}const WN=(t,e)=>{fe.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var gJ,vJ;function Qhe(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const fc=Symbol("Accessor-Handles"),D4=Symbol("Accessor-Initialized");let Te=class bJ{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:n}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const o=this;class u extends o{constructor(...g){super(...g),this.inherited=null,n&&n.apply(this,g)}}q3(u.prototype);for(const p in e){const g=e[p];u.prototype[p]=typeof g=="function"?function(...w){const S=this.inherited;let T;this.inherited=function(...E){if(o.prototype[p])return o.prototype[p].apply(this,E)};try{T=g.apply(this,w)}catch(E){throw this.inherited=S,E}return this.inherited=S,T}:e[p]}for(const p in i){const g=Qhe(i[p]);b(g)(u.prototype,p)}return G(r)(u)}constructor(...e){var r;if(this[gJ]=null,this[vJ]=!1,this.constructor===bJ)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new Rce(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&(i.ctorArgs=((r=this.normalizeCtorArgs)==null?void 0:r.apply(this,e))??e[0])}postscript(){const e=this.__accessor__,i=e.ctorArgs;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[D4]=!0}initialize(){}[OW](){this[fc]=ot(this[fc])}destroy(){var e;this.destroyed||(dhe(this),this.__accessor__.destroy(),(e=zce())==null||e.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[D4]}get destroyed(){var e;return((e=this.__accessor__)==null?void 0:e.lifecycle)===Go.DESTROYED||!1}commitProperty(e){Ks(this,e)}get(e){return xI(fe.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),Ks(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return N5(this,e,i),this}watch(e,i,r){return bhe(this,e,i,r)}addHandles(e,i){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const n of r)n.remove();return}(this[fc]??(this[fc]=new Fb)).add(e,i)}removeHandles(e){var i;(i=this[fc])==null||i.remove(e)}removeAllHandles(){var e;(e=this[fc])==null||e.removeAll()}removeHandlesReference(e){var i;(i=this[fc])==null||i.removeReference(e)}hasHandles(e){var i;return((i=this[fc])==null?void 0:i.has(e))===!0}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}};gJ=fc,vJ=D4;let epe=class wJ{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new wJ;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,ae(r.value),r.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const r=this._values.get(e);return i==null||(r==null?void 0:r.origin)===i?r==null?void 0:r.value:void 0}originOf(e){var i;return((i=this._values.get(e))==null?void 0:i.origin)??ut.USER}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(r=>{var n;return((n=this._values.get(r))==null?void 0:n.origin)===e})}set(e,i,r){if((r=this._normalizeOrigin(r))===ut.DEFAULTS){const n=this._values.get(e);if((n==null?void 0:n.origin)!=null&&n.origin>r)return}this._values.set(e,new tpe(i,r))}delete(e,i){var r;(i=this._normalizeOrigin(i))!=null&&((r=this._values.get(e))==null?void 0:r.origin)!==i||this._values.delete(e)}has(e,i){var r;return(i=this._normalizeOrigin(i))!=null?((r=this._values.get(e))==null?void 0:r.origin)===i:this._values.has(e)}forEach(e){this._values.forEach(({value:i},r)=>e(i,r))}_normalizeOrigin(e){if(e!=null)return e===ut.DEFAULTS?e:ut.USER}},tpe=class{constructor(e,i){this.value=e,this.origin=i}};function _J(t,e,i){e.keys().forEach(n=>{i.set(n,e.get(n),ut.DEFAULTS)});const r=t.metadata;Object.keys(r).forEach(n=>{t.internalGet(n)&&i.set(n,t.internalGet(n),ut.DEFAULTS)})}function ipe(t,e,i){if(!(t!=null&&t.read)||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.indexOf(e)===0&&MN(r,i))return!0}else for(const n of r)if(n===e||n.includes(".")&&n.indexOf(e)===0&&MN(n,i))return!0;return!1}function rpe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function npe(t,e,i,r,n){let o=F4(e[i],n);rpe(o)&&(t[i]=!0);for(const u of Object.getOwnPropertyNames(e))o=F4(e[u],n),ipe(o,i,r)&&(t[u]=!0)}function spe(t,e,i,r){const n=i.metadata,o=Hhe(n[e],r),u=o==null?void 0:o.default;if(u===void 0)return;const p=typeof u=="function"?u.call(t,e,r):u;p!==void 0&&i.set(e,p)}const SJ={origin:"service"};function xJ(t,e,i=SJ){if(!e||typeof e!="object")return;const r=So(t),n=r.metadata,o={};for(const u of Object.getOwnPropertyNames(e))npe(o,n,u,e,i);r.setDefaultOrigin(i.origin);for(const u of Object.getOwnPropertyNames(o)){const p=F4(n[u],i).read,g=p==null?void 0:p.source;let w;w=g&&typeof g=="string"?B3(e,g):e[u],p!=null&&p.reader&&(w=p.reader.call(t,w,e,i)),w!==void 0&&r.set(u,w)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const u of Object.getOwnPropertyNames(n))o[u]||spe(t,u,r,i)}r.setDefaultOrigin("user")}function $J(t,e,i,r=SJ){var o;const n={...r,messages:[]};i(n),(o=n.messages)==null||o.forEach(u=>{u.type!=="warning"||t.loaded?r!=null&&r.messages&&r.messages.push(u):t.loadWarnings.push(u)})}function ope(t,e,i,r,n){var u,p;const o={};return(p=(u=e.write)==null?void 0:u.writer)==null||p.call(t,r,o,i,n),o}function TJ(t,e,i,r,n,o){if(!(r!=null&&r.write))return!1;const u=Ks(t,i);if(!n&&r.write.overridePolicy){const p=r.write.overridePolicy.call(t,u,i,o??void 0);p!==void 0&&(n=p)}if(n||(n=r.write),!n||n.enabled===!1||n.layerContainerTypes&&(o!=null&&o.layerContainerType)&&!n.layerContainerTypes.includes(o.layerContainerType))return!1;if((u===null&&!n.allowNull&&!n.writerEnsuresNonNull||u===void 0)&&n.isRequired){const p=new re("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return p&&(o!=null&&o.messages)?o.messages.push(p):p&&!o&&fe.getLogger("esri.core.accessorSupport.write").error(p.name,p.message),!1}return!(u===void 0||u===null&&!n.allowNull&&!n.writerEnsuresNonNull||!n.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===ut.DEFAULTS)&&ape(t,i,o,r,u)||!n.ignoreOrigin&&(o!=null&&o.origin)&&e.store.multipleOriginsSupported&&e.store.originOf(i)<Of(o.origin))}function ape(t,e,i,r,n){const o=r.default;if(o===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(n);if(typeof o=="function"){if(Array.isArray(n)){const u=o.call(t,e,i??void 0);return Rb(u,n)}return!1}return o===n}function lpe(t,e,i,r){const n=So(t),o=n.metadata,u=yJ(o[e],r);return!!u&&TJ(t,n,e,u,i,r)}function EJ(t,e,i){var o,u;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return z$(e,t.toJSON(i));const r=So(t),n=r.metadata;for(const p in n){const g=yJ(n[p],i);if(!TJ(t,r,p,g,void 0,i))continue;const w=Ks(t,p),S=ope(t,g,g.write&&typeof g.write.target=="string"?g.write.target:p,w,i);Object.keys(S).length>0&&(e=z$(e,S),(u=(o=i==null?void 0:i.resources)==null?void 0:o.pendingOperations)!=null&&u.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>z$(e,S,()=>"replace-arrays"))),i!=null&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:p,oldOrigin:Ace(r.store.originOf(p)),newOrigin:i.origin}))}return e}const Um=t=>{let e=class extends t{constructor(...i){super(...i);const r=So(this),n=r.store,o=new epe;r.store=o,_J(r,n,o)}read(i,r){xJ(this,i,r)}write(i,r){return EJ(this,i??{},r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return upe.call(this,i,r)}};return e=m([G("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function upe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}function J5(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}let ye=class extends Um(Te){};ye=m([G("esri.core.JSONSupport")],ye);const W7=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,cpe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function j4(t){const e=t==null?void 0:t.match(W7);if(!e)return null;const[,i,r,n]=e;if(!i)return null;let o=null,u=null,p=null;const{devext:g,qaext:w,www:S}=cpe;if(r)if(o=i,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:u,portalHostname:p}=g);break;case"qa":({customBaseUrl:u,portalHostname:p}=w);break;default:return null}else({customBaseUrl:u,portalHostname:p}=S);else switch(i.toLowerCase()){case"devext":({customBaseUrl:u,portalHostname:p}=g);break;case"qaext":({customBaseUrl:u,portalHostname:p}=w);break;case"www":({customBaseUrl:u,portalHostname:p}=S);break;default:return null}return{customBaseUrl:u,isPortal:!1,portalHostname:p,urlKey:o}}function hpe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function IJ(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function ppe(t){const e=atob(t),i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i.buffer}function dpe(t){const e=new Uint8Array(t);let i="";for(let r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);return btoa(i)}const fpe=()=>fe.getLogger("esri.core.urlUtils"),Ub=Ct.request,JN="esri/config: esriConfig.request.proxyUrl is not set.",MJ=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,kJ=/^\s*http:/i,ype=/^\s*https:/i,mpe=/^\s*file:/i,gpe=/:\d+$/,vpe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,bpe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),wpe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let qf=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(bpe);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(wpe),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const ex={},_pe=new qf(Ct.applicationUrl);let Ws=_pe;const Spe=xpe();let J7=Spe;const Z7=()=>Ws,WHe=()=>J7;function xpe(){const t=Ws.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${`${Ws.scheme}://${Ws.host}${Ws.port!=null?`:${Ws.port}`:""}`}${e}`}function Zr(t){if(!t)return null;const e={path:null,query:null},i=new qf(t),r=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.substring(0,r),e.query=K7(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function K7(t){const e=t.split("&"),i={};for(const r of e){if(!r)continue;const n=r.indexOf("=");let o,u;n<0?(o=decodeURIComponent(r),u=""):(o=decodeURIComponent(r.slice(0,n)),u=decodeURIComponent(r.slice(n+1)));let p=i[o];typeof p=="string"&&(p=i[o]=[p]),Array.isArray(p)?p.push(u):i[o]=u}return i}function r3(t,e){return t?Object.keys(t).map(i=>{const r=t[i];if(r==null)return"";const n=encodeURIComponent(i)+"=",o=e==null?void 0:e[i];return o?n+encodeURIComponent(o(r)):Array.isArray(r)?r.map(u=>J5(u)?n+encodeURIComponent(JSON.stringify(u)):n+encodeURIComponent(u)).join("&"):J5(r)?n+encodeURIComponent(JSON.stringify(r)):n+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function $pe(t=!1){let e,i=Ub.proxyUrl;if(typeof t=="string"){e=Ape(t);const r=CI(t);r&&(i=r.proxyUrl)}else e=!!t;if(!i)throw fpe().warn(JN),new re("urlUtils:proxy-not-set",JN);return e&&z4()&&(i=tP(i)),Zr(i)}function Tpe(t){const e=CI(t);let i,r;if(e){const n=Y7(e.proxyUrl);i=n.path,r=n.query?K7(n.query):null}if(i){const n=Zr(t);t=i+"?"+n.path;const o=r3({...r,...n.query});o&&(t=`${t}?${o}`)}return t}const dw={path:"",query:""};function Y7(t){const e=t.indexOf("?");return e!==-1?(dw.path=t.slice(0,e),dw.query=t.slice(e+1)):(dw.path=t,dw.query=null),dw}function CJ(t){return t=(t=K5(t=Fpe(t=Y7(t).path),!0)).toLowerCase()}function Epe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:CJ(t.urlPrefix)},i=Ub.proxyRules,r=e.urlPrefix;let n=i.length;for(let o=0;o<i.length;o++){const u=i[o].urlPrefix;if(r.indexOf(u)===0){if(r.length===u.length)return-1;n=o;break}u.indexOf(r)===0&&(n=o+1)}return i.splice(n,0,e),n}function CI(t){const e=Ub.proxyRules,i=CJ(t);for(let r=0;r<e.length;r++)if(i.indexOf(e[r].urlPrefix)===0)return e[r]}function Ipe(t,e){if(!t||!e)return!1;t=Z5(t),e=Z5(e);const i=j4(t),r=j4(e);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&Sm(t,e,!0)}function AJ(t,e){return t=Z5(t),e=Z5(e),K5(t)===K5(e)}function Z5(t){const e=(t=ws(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function V4(t,e=Ub.interceptors){const i=r=>r==null||r instanceof RegExp&&r.test(t)||typeof r=="string"&&t.startsWith(r);if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(i))return r}else if(i(r.urls))return r}return null}function Sm(t,e,i=!1){if(!t||!e)return!1;const r=G4(t),n=G4(e);return!(!i&&r.scheme!==n.scheme)&&r.host!=null&&n.host!=null&&r.host.toLowerCase()===n.host.toLowerCase()&&r.port===n.port}function X7(t){if(typeof t=="string"){if(!ja(t))return!0;t=G4(t)}if(Sm(t,Ws))return!0;const e=Ub.trustedServers||[];for(let i=0;i<e.length;i++){const r=Mpe(e[i]);for(let n=0;n<r.length;n++)if(Sm(t,r[n]))return!0}return!1}function Mpe(t){return ex[t]||(eP(t)||hh(t)?ex[t]=[new qf(Wo(t))]:ex[t]=[new qf(`http://${t}`),new qf(`https://${t}`)]),ex[t]}function Wo(t,e=J7,i){return hh(t)?i!=null&&i.preserveProtocolRelative?t:Ws.scheme==="http"&&Ws.authority===Fl(t).slice(2)?`http:${t}`:`https:${t}`:eP(t)?t:ib(t[0]==="/"?Rpe(e):e,t)}function Q7(t,e=J7,i){if(t==null||!ja(t))return t;const r=ws(t),n=r.toLowerCase(),o=ws(e).toLowerCase().replace(/\/+$/,""),u=i?ws(i).toLowerCase().replace(/\/+$/,""):null;if(u&&o.indexOf(u)!==0)return t;const p=(T,E,C)=>(C=T.indexOf(E,C))===-1?T.length:C;let g=p(n,"/",n.indexOf("//")+2),w=-1;for(;n.slice(0,g+1)===o.slice(0,g)+"/"&&(w=g+1,g!==n.length);)g=p(n,"/",g+1);if(w===-1||u&&w<u.length)return t;t=r.slice(w);const S=o.slice(w-1).replaceAll(/[^/]+/g,"").length;if(S>0)for(let T=0;T<S;T++)t=`../${t}`;else t=`./${t}`;return t}function ws(t){return t=jpe(t=Dpe(t=Npe(t=Wo(t=t.trim()))))}function ib(...t){const e=t.filter(Rt);if(!(e!=null&&e.length))return;const i=[];if(ja(e[0])){const n=e[0],o=n.indexOf("//");o!==-1&&(i.push(n.slice(0,o+1)),Ope(e[0])&&(i[0]+="/"),e[0]=n.slice(o+2))}else e[0][0]==="/"&&i.push("");const r=e.reduce((n,o)=>o?n.concat(o.split("/")):n,[]);for(let n=0;n<r.length;n++){const o=r[n];o===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!o&&n===r.length-1||o&&(o!=="."||i.length===0))&&i.push(o)}return i.join("/")}function Fl(t,e=!1){if(t==null||AI(t)||l0(t))return null;let i=t.indexOf("://");if(i===-1&&hh(t))i=2;else{if(i===-1)return null;i+=3}const r=t.indexOf("/",i);return r!==-1&&(t=t.slice(0,r)),e&&(t=K5(t,!0)),t}function ja(t){return hh(t)||eP(t)}function AI(t){return t!=null&&t.slice(0,5)==="blob:"}function l0(t){return t!=null&&t.slice(0,5)==="data:"}function kpe(t){const e=xm(t);return e!=null&&e.isBase64?ppe(e.data):null}function JHe(t){return dpe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const Cpe=/^data:(.*?)(;base64)?,(.*)$/;function xm(t){const e=t.match(Cpe);if(!e)return null;const[,i,r,n]=e;return{mediaType:i,isBase64:!!r,data:n}}function LJ(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function ZHe(t){return(await fetch(t)).blob()}function KHe(t){const e=kpe(t);if(!e)return null;const i=xm(t);return new Blob([e],{type:i.mediaType})}function hh(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function eP(t){return t!=null&&MJ.test(t)}function Ape(t){return t!=null&&ype.test(t)||Ws.scheme==="https"&&hh(t)}function Lpe(t){return t!=null&&kJ.test(t)||Ws.scheme==="http"&&hh(t)}function Ope(t){return t!=null&&mpe.test(t)}function tP(t){return hh(t)?`https:${t}`:t.replace(kJ,"https:")}function Ppe(){return Ws.scheme==="http"}function z4(){return Ws.scheme==="https"}function K5(t,e=!1){return hh(t)?t.slice(2):(t=t.replace(MJ,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function Rpe(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function iP(t){let e=0;if(ja(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function YHe(t,e){if(!t)return"";const i=Zr(t).path.replace(/\/+$/,""),r=i.substring(i.lastIndexOf("/")+1);if(!(e!=null&&e.length))return r;const n=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(n,"")}function Fpe(t){return t.endsWith("/")?t:`${t}/`}function OJ(t){return t.replace(/\/+$/,"")}function Npe(t){if(/^https?:\/\//i.test(t)){const e=Y7(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function Dpe(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function jpe(t){const e=Ub.httpsDomains;if(!Lpe(t))return t;const i=t.indexOf("/",7);let r;if(r=i===-1?t:t.slice(0,i),r=r.toLowerCase().slice(7),gpe.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return Ppe()&&r===Ws.authority&&!vpe.test(t)||(z4()&&r===Ws.authority||e&&e.some(n=>r===n||r.endsWith(`.${n}`))||z4()&&!CI(t))&&(t=tP(t)),t}function U4(t,e,i){if(!(e&&i&&t&&ja(t)))return t;const r=t.indexOf("//"),n=t.indexOf("/",r+2),o=t.indexOf(":",r+2),u=Math.min(n<0?t.length:n,o<0?t.length:o);return t.slice(r+2,u).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${i}${t.slice(u)}`}function G4(t){return typeof t=="string"?new qf(Wo(t)):(t.scheme||(t.scheme=Ws.scheme),t)}function XHe(t){return Vpe.test(t)}function PJ(t,e){const i=Zr(t),r=Object.keys(i.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function RJ(t,e,i){const r=Zr(t),n=r.query||{};return n[e]=String(i),`${r.path}?${r3(n)}`}function q$(t,e){if(!e)return t;const i=Zr(t),r=i.query||{};for(const[o,u]of Object.entries(e))u!=null&&(r[o]=u);const n=r3(r);return n?`${i.path}?${n}`:i.path}function QHe(t){if(t==null)return null;const e=t.match(FJ);return e?e[2]:null}function ZN(t){if(t==null)return null;const e=t.match(FJ);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function eWe(t){return typeof t=="string"?xm(t)??{data:t}:new Promise((e,i)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(xm(r.result)),r.onerror=n=>i(n)})}const FJ=/([^.]*)\.([^/]*)$/,Vpe=/(^data:image\/svg|\.svg$)/i,NJ="20240724",DJ="ac51c09e1d17be02f839eb2e22bd05fd7a16c2d3";Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const Sn="4.30";let rt,rP=Sn;rP="4.30.9";function tWe(t){rt=t}function zpe(t){const e=rt==null?void 0:rt.findCredential(t);return e!=null&&e.token?RJ(t,"token",e.token):t}me("host-webworker");const Upe=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function nP(t){const e=Fl(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!Upe.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function Gpe(t,e,i=!1,r){return new Promise((n,o)=>{if(Xo(r))return void o(KN());let u=()=>{w(),o(new Error(`Unable to load ${e}`))},p=()=>{const S=t;w(),n(S)},g=()=>{if(!t)return;const S=t;w(),S.src="",o(KN())};const w=()=>{me("esri-image-decode")||(t.removeEventListener("error",u),t.removeEventListener("load",p)),u=null,p=null,t=null,r!=null&&r.removeEventListener("abort",g),g=null,i&&URL.revokeObjectURL(e)};r!=null&&r.addEventListener("abort",g),me("esri-image-decode")?t.decode().then(p,u):(t.addEventListener("error",u),t.addEventListener("load",p))})}function KN(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const jJ="Timeout exceeded";function Bpe(){return new Error(jJ)}function iWe(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===jJ}function qpe(t){Ct.request.crossOriginNoCorsDomains||(Ct.request.crossOriginNoCorsDomains={});const e=Ct.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[Fl(i)??""]=0:(e[Fl("http://"+i)??""]=0,e[Fl("https://"+i)??""]=0)}function Hpe(t){const e=Ct.request.crossOriginNoCorsDomains;if(e){let i=Fl(t);if(i)return i=i.toLowerCase(),!Sm(i,Z7())&&e[i]<Date.now()-36e5}return!1}async function Wpe(t){var n;const e=Ct.request.crossOriginNoCorsDomains,i=Fl(t);e&&i&&(e[i.toLowerCase()]=Date.now());const r=Zr(t);t=r.path,((n=r.query)==null?void 0:n.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}}async function nt(t,e){var E;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=K7(e.query.toString().replaceAll("+"," ")));const i=l0(t),r=AI(t);r||i||(t=ws(t));const n={url:t,requestOptions:{...e}},o=C=>({data:C,getAllHeaders:rb,getHeader:rb,httpStatus:200,requestOptions:n.requestOptions,url:n.url}),u=V4(t,$l.internalInterceptors);if(u){const C=await XN(u,n);if(C!=null)return o(C)}let p=V4(t);if(p){const C=await XN(p,n);if(C!=null)return o(C);p.after||p.error||(p=null)}if(t=n.url,(e=n.requestOptions).responseType==="image"&&(me("host-webworker")||me("host-node")))throw oh("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n);if(e.method==="head"){if(e.body)throw oh("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||r)throw oh("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await Xpe(),Y5)return Y5.execute(t,e);const g=new AbortController,w=Zo(e,()=>g.abort()),S={controller:g,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:p,params:n,redoRequest:!1,useIdentity:$l.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},T=await ide(S).finally(()=>w==null?void 0:w.remove());return(E=p==null?void 0:p.after)==null||E.call(p,T),T}let Y5;const $l=Ct.request,VJ="FormData"in globalThis,Jpe=new Set([499,498,403,401]),Zpe=new Set(["COM_0056","COM_0057","SB_0008"]),Kpe=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],rb=()=>null,X5=Symbol();function Ype(t){const e=Fl(t);e&&!nt._corsServers.includes(e)&&nt._corsServers.push(e)}function YN(t){const e=Fl(t);return!e||e.endsWith(".arcgis.com")||nt._corsServers.includes(e)||X7(e)}function oh(t,e,i,r){let n="Error";const o={url:i.url,requestOptions:i.requestOptions,getAllHeaders:rb,getHeader:rb,ssl:!1};if(e instanceof re)return e.details?(e.details=ae(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=o,e;if(e){const u=r&&(()=>Array.from(r.headers)),p=r&&(S=>r.headers.get(S)),g=r==null?void 0:r.status,w=e.message;w&&(n=w),u&&p&&(o.getAllHeaders=u,o.getHeader=p),o.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||g||0,o.subCode=e.subcode,o.messageCode=e.messageCode,typeof e.details=="string"?o.messages=[e.details]:o.messages=e.details,o.raw=X5 in e?e[X5]:e}return Cn(e)?ni():new re(t,n,o)}async function Xpe(){me("host-webworker")&&!Y5&&(Y5=await ie(()=>import("./request-Chn24bG-.js"),[]))}async function B4(){rt||await ie(()=>import("./IdentityManager-BJyn6w0h.js"),[])}async function Qpe(t){var p;const e=t.params.url,i=t.params.requestOptions,r=t.controller.signal,n=i.body;let o=null,u=null;if(VJ&&"HTMLFormElement"in globalThis&&(n instanceof FormData?o=n:n instanceof HTMLFormElement&&(o=new FormData(n))),typeof n=="string"&&(u=n),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:$l.priority,redirect:"follow",signal:r},(o||u)&&(t.fetchOptions.body=o||u),i.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(p=i.query)!=null&&p.token||o!=null&&o.get("token")),!t.hasToken&&Ct.apiKey&&nP(e)&&(i.query||(i.query={}),i.query.token=Ct.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!zJ(e)&&!Xo(r)){let g;i.authMode==="immediate"?(await B4(),g=await rt.getCredential(e,{signal:r}),t.credential=g):i.authMode==="no-prompt"?(await B4(),g=await rt.getCredential(e,{prompt:!1,signal:r}).catch(()=>{}),t.credential=g):rt&&(g=rt.findCredential(e)),g&&(t.credentialToken=g.token,t.useSSL=!!g.ssl)}}function zJ(t){return Kpe.some(e=>e.test(t))}async function ede(t){let e=t.params.url;const i=t.params.requestOptions,r=t.fetchOptions??{},n=AI(e)||l0(e),o=i.responseType||"json",u=n?0:i.timeout!=null?i.timeout:$l.timeout;let p=!1;if(!n){t.useSSL&&(e=tP(e));let E={...i.query};t.credentialToken&&(E.token=t.credentialToken);let C=r3(E);me("esri-url-encodes-apostrophe")&&(C=C.replaceAll("'","%27"));const L=e.length+1+C.length;let R;p=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||L>$l.maxUrlLength;const F=i.useProxy||!!CI(e);if(F){const V=$pe(e);R=V.path,!p&&R.length+1+L>$l.maxUrlLength&&(p=!0),V.query&&(E={...V.query,...E})}if(r.method==="HEAD"&&(p||F)){if(p)throw L>$l.maxUrlLength?oh("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):oh("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(F)throw oh("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(p?(r.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=q$(e,E):(r.body=r3(E),r.headers||(r.headers={}),r.headers["Content-Type"]="application/x-www-form-urlencoded")):e=q$(e,E),F&&(t.useProxy=!0,e=`${R}?${e}`),E.token&&VJ&&r.body instanceof FormData&&!hpe(e)&&r.body.set("token",E.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Sm(e,Z7())){if(X7(e))t.withCredentials=!0;else if(rt){const V=rt.findServerInfo(e);V!=null&&V.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(r.credentials="include",Hpe(e)&&await Wpe(p?q$(e,E):e))}let g,w,S=0,T=!1;u>0&&(S=setTimeout(()=>{T=!0,t.controller.abort()},u));try{if(i.responseType==="native-request-init")w=r,w.url=e;else if(i.responseType!=="image"||r.cache!=="default"||r.method!=="GET"||p||tde(i.headers)||!n&&!t.useProxy&&$l.proxyUrl&&!YN(e)){if(nt._beforeFetch&&await nt._beforeFetch(e,r),g=await fetch(e,r),nt._afterFetch&&await nt._afterFetch(g),t.useProxy||Ype(e),i.responseType==="native")w=g;else if(r.method!=="HEAD")if(g.ok){switch(o){case"array-buffer":w=await g.arrayBuffer();break;case"blob":case"image":w=await g.blob();break;default:w=await g.text()}if(S&&(clearTimeout(S),S=0),o==="json"||o==="xml"||o==="document")if(w)switch(o){case"json":w=JSON.parse(w);break;case"xml":w=QN(w,"application/xml");break;case"document":w=QN(w,"text/html")}else w=null;if(w){if(o==="array-buffer"||o==="blob"){const E=g.headers.get("Content-Type");if(E&&/application\/json|text\/plain/i.test(E)&&w[o==="blob"?"size":"byteLength"]<=750)try{const C=await new Response(w).json();C.error&&(w=C)}catch{}}o==="image"&&w instanceof Blob&&(w=await eD(URL.createObjectURL(w),t,!0))}}else{w=await g.text();try{w=JSON.parse(w)}catch{}}}else w=await eD(e,t)}catch(E){if(E.name==="AbortError")throw T?Bpe():ni("Request canceled");if(!(!g&&E instanceof TypeError&&$l.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||YN(e))throw E;t.redoRequest=!0,Epe({proxyUrl:$l.proxyUrl,urlPrefix:Fl(e)??""})}finally{S&&clearTimeout(S)}return[g,w]}async function XN(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,r;try{r=await t.before(e)}catch(n){i=oh("request:interceptor",n,e)}if((r instanceof Error||r instanceof re)&&(i=oh("request:interceptor",r,e)),i)throw t.error&&t.error(i),i;return r}}function tde(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function QN(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function ide(t){var o,u;let e,i;await Qpe(t);try{do[e,i]=await ede(t);while(!await rde(t,e,i))}catch(p){const g=oh("request:server",p,t.params,e);throw g.details.ssl=t.useSSL,(o=t.interceptor)!=null&&o.error&&t.interceptor.error(g),g}const r=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&((u=i.user)!=null&&u.username)&&!X7(r)){const p=Fl(r,!0);p&&$l.trustedServers.push(p)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&qpe(i.authorizedCrossOriginNoCorsDomains)}const n=t.credential;if(n&&rt){const p=rt.findServerInfo(n.server);let g=p==null?void 0:p.owningSystemUrl;if(g){g=g.replace(/\/?$/,"/sharing");const w=rt.findCredential(g,n.userId);w&&rt._getIdenticalSvcIdx(g,w)===-1&&w.resources.unshift(g)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):rb,getHeader:e?p=>e.headers.get(p):rb,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function rde(t,e,i){var w;if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let n,o;if(i&&(i.error&&typeof i.error=="object"?n=i.error:i.status==="error"&&Array.isArray(i.messages)&&(n={...i},n[X5]=i,n.details=i.messages)),!n&&!e.ok)throw n=new Error(`Unable to load ${e.url} status: ${e.status}`),n[X5]=i,n;let u,p=null;n&&(o=Number(n.code),p=n.hasOwnProperty("subcode")?Number(n.subcode):null,u=n.messageCode,u=u==null?void 0:u.toUpperCase());const g=r.authMode;if(o===403&&(p===4||(w=n.message)!=null&&w.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(g!=="no-prompt"||o===498)&&o!==void 0&&Jpe.has(o)&&!zJ(t.params.url)&&(o!==403||(!u||!Zpe.has(u))&&(p==null||p===2&&t.credentialToken))){await B4();try{const S=await rt.getCredential(t.params.url,{error:oh("request:server",n,t.params),prompt:g!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=S,t.credentialToken=S.token,t.useSSL=t.useSSL||S.ssl,!1}catch(S){if(g==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;n=S}}if(n)throw n;return!0}function eD(t,e,i=!1){const r=e.controller.signal,n=new Image;return e.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=$l.priority,n.src=t,Gpe(n,t,i,r)}nt._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],nt._beforeFetch=void 0,nt._afterFetch=void 0;let H$=class UJ{constructor(){this._emitter=new UJ.EventEmitter(this)}emit(e,i){return this._emitter.emit(e,i)}on(e,i){return this._emitter.on(e,i)}once(e,i){return this._emitter.once(e,i)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(n=null){this._target=n,this._listenersMap=null}clear(){var n;(n=this._listenersMap)==null||n.clear(),this._listenersMap=null}destroy(){this.clear()}emit(n,o){var w;let u=(w=this._listenersMap)==null?void 0:w.get(n);if(!u)return!1;const p=this._target||this;let g=!1;for(const S of u.slice()){const T="deref"in S?S.deref():S;T?T==null||T.call(p,o):g=!0}return g&&(u=u.filter(S=>!("deref"in S)||S.deref()!=null),this._listenersMap.set(n,u)),u.length>0}on(n,o){if(Array.isArray(n)){const p=n.map(g=>this.on(g,o));return In(p)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const u=this._listenersMap.get(n)||[];return u.push(o),this._listenersMap.set(n,u),We(()=>{var w;const p=(w=this._listenersMap)==null?void 0:w.get(n),g=(p==null?void 0:p.indexOf(o))??-1;g>=0&&p.splice(g,1)})}once(n,o){const u=this.on(n,p=>{u.remove();const g="deref"in o?o.deref():o;g==null||g.call(null,p)});return u}hasEventListener(n){var u;const o=(u=this._listenersMap)==null?void 0:u.get(n);return o!=null&&o.length>0}}t.EventEmitter=e,t.EventedMixin=r=>{let n=class extends r{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(o,u){return this._emitter.emit(o,u)}on(o,u){return this._emitter.on(o,u)}once(o,u){return this._emitter.once(o,u)}hasEventListener(o){return this._emitter.hasEventListener(o)}};return n=m([G("esri.core.Evented")],n),n};let i=class extends Te{constructor(){super(...arguments),this._emitter=new H$.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,n){return this._emitter.emit(r,n)}on(r,n){return this._emitter.on(r,n)}once(r,n){return this._emitter.once(r,n)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=m([G("esri.core.Evented.EventedAccessor")],i),t.EventedAccessor=i})(H$||(H$={}));const Ar=H$;var fi;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(fi||(fi={}));function sP(t){return(e,i)=>{e[i]=t}}let Gb=class extends jW{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}};var Ip;let nde=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},sde=class{constructor(e,i,r,n,o){this.target=e,this.added=i,this.removed=r,this.start=n,this.deleteCount=o}};const Ja=new Hp(nde,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function tD(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function h9(t){return t?t instanceof xp?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function p9(t){if(t!=null&&t.length)return t[0]}function ode(t,e,i,r){const n=Math.min(t.length-i,e.length-r);let o=0;for(;o<n&&t[i+o]===e[r+o];)o++;return o}function GJ(t,e,i,r){e&&e.forEach((n,o,u)=>{t.push(n),GJ(t,i.call(r,n,o,u),i,r)})}const hd=new Set,pd=new Set,dd=new Set,d9=new Map;let ade=0,xp=Ip=class extends Ar.EventedAccessor{static isCollection(t){return t!=null&&t instanceof Ip}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Gb,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:ade++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Ip?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return He(this._observable),this._items}set items(t){this._emitBeforeChanges(fi.ADD)||(this._splice(0,this.length,h9(t)),this._emitAfterChanges(fi.ADD))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return We();if(t==="change"){const i=this._chgListeners,r={removed:!1,callback:e};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),We(()=>{r.removed=!0,i.splice(i.indexOf(r),1)})}return this._emitter.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,r=this.on(t,n=>{var o;(o=i())==null||o.call(null,n),r.remove()});return r}add(t,e){if(He(this._observable),this._emitBeforeChanges(fi.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(fi.ADD),this}addMany(t,e=this._items.length){if(He(this._observable),!(t!=null&&t.length))return this;if(this._emitBeforeChanges(fi.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,h9(t)),this._emitAfterChanges(fi.ADD),this}at(t){if(He(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(He(this._observable),!this.length||this._emitBeforeChanges(fi.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(fi.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return He(this._observable),this._createNewInstance({items:this._items.map(ae)})}concat(...t){He(this._observable);const e=t.map(h9);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(He(this._observable),!this.length||this._emitBeforeChanges(fi.REMOVE))return;const i=this._splice(0,this.length),r=i.length;for(let n=0;n<r;n++)t.call(e,i[n],n,i);this._emitAfterChanges(fi.REMOVE)}destroyAll(){this.drain(tD)}destroyMany(t){const e=this.removeMany(t);return e.forEach(tD),e}every(t,e){return He(this._observable),this._items.every(t,e)}filter(t,e){let i;return He(this._observable),i=arguments.length===2?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return He(this._observable),this._items.find(t,e)}findIndex(t,e){return He(this._observable),this._items.findIndex(t,e)}flatten(t,e){He(this._observable);const i=[];return GJ(i,this,t,e),new Ip(i)}forEach(t,e){return He(this._observable),this._items.forEach(t,e)}getItemAt(t){return He(this._observable),this._items[t]}getNextIndex(t){He(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return He(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return He(this._observable),this._items.indexOf(t,e)}join(t=","){return He(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return He(this._observable),this._items.lastIndexOf(t,e)}map(t,e){He(this._observable);const i=this._items.map(t,e);return new Ip({items:i})}reorder(t,e=this.length-1){He(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(fi.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(fi.MOVE)}return t}}pop(){if(He(this._observable),!this.length||this._emitBeforeChanges(fi.REMOVE))return;const t=p9(this._splice(this.length-1,1));return this._emitAfterChanges(fi.REMOVE),t}push(...t){return He(this._observable),this._emitBeforeChanges(fi.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(fi.ADD)),this.length}reduce(t,e){He(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){He(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return He(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(He(this._observable),t<0||t>=this.length||this._emitBeforeChanges(fi.REMOVE))return;const e=p9(this._splice(t,1));return this._emitAfterChanges(fi.REMOVE),e}removeMany(t){if(He(this._observable),!(t!=null&&t.length)||this._emitBeforeChanges(fi.REMOVE))return[];const e=t instanceof Ip?t.toArray():t,i=this._items,r=[],n=e.length;for(let o=0;o<n;o++){const u=e[o],p=i.indexOf(u);if(p>-1){const g=1+ode(e,i,o+1,p+1),w=this._splice(p,g);w&&w.length>0&&r.push.apply(r,w),o+=g-1}}return this._emitAfterChanges(fi.REMOVE),r}reverse(){if(He(this._observable),this._emitBeforeChanges(fi.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(fi.MOVE),this}shift(){if(He(this._observable),!this.length||this._emitBeforeChanges(fi.REMOVE))return;const t=p9(this._splice(0,1));return this._emitAfterChanges(fi.REMOVE),t}slice(t=0,e=this.length){return He(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return He(this._observable),this._items.some(t,e)}sort(t){if(He(this._observable),!this.length||this._emitBeforeChanges(fi.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(fi.MOVE),this}splice(t,e,...i){He(this._observable);const r=(e?fi.REMOVE:0)|(i.length?fi.ADD:0);if(this._emitBeforeChanges(r))return[];const n=this._splice(t,e,i)||[];return this._emitAfterChanges(r),n}toArray(){return He(this._observable),this._items.slice()}toJSON(){return He(this._observable),this.toArray()}toLocaleString(){return He(this._observable),this._items.toLocaleString()}toString(){return He(this._observable),this._items.toString()}unshift(...t){return He(this._observable),!t.length||this._emitBeforeChanges(fi.ADD)||(this._splice(0,0,t),this._emitAfterChanges(fi.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const r=this._items,n=this.itemType;let o,u;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=jb(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(u=r.splice(t,e),this.hasEventListener("before-remove")){const p=Ja.acquire();p.target=this,p.cancellable=!0;for(let g=0,w=u.length;g<w;g++)o=u[g],p.reset(o),this.emit("before-remove",p),p.defaultPrevented&&(u.splice(g,1),r.splice(t,0,o),t+=1,g-=1,w-=1);Ja.release(p)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const p=Ja.acquire();p.target=this,p.cancellable=!1;const g=u.length;for(let w=0;w<g;w++)p.reset(u[w]),this.emit("after-remove",p);Ja.release(p)}}if(i!=null&&i.length){if(n){const S=[];for(const T of i){const E=n.ensureType(T);E==null&&T!=null||S.push(E)}i=S}const p=this.hasEventListener("before-add"),g=this.hasEventListener("after-add"),w=t===this.length;if(p||g){const S=Ja.acquire();S.target=this,S.cancellable=!0;const T=Ja.acquire();T.target=this,T.cancellable=!1;for(const E of i)p?(S.reset(E),this.emit("before-add",S),S.defaultPrevented||(w?r.push(E):r.splice(t++,0,E),this._set("length",r.length),g&&(T.reset(E),this.emit("after-add",T)))):(w?r.push(E):r.splice(t++,0,E),this._set("length",r.length),T.reset(E),this.emit("after-add",T));Ja.release(T),Ja.release(S)}else{if(w)for(const S of i)r.push(S);else r.splice(t,0,...i);this._set("length",r.length)}}if((i!=null&&i.length||u!=null&&u.length)&&this._notifyChangeEvent(i,u),this.hasEventListener("after-splice")){const p=new sde(this,i,u,t,e);this.emit("after-splice",p)}return u}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Ja.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Ja.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Ja.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Ja.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;hd.clear(),pd.clear(),dd.clear();for(const{added:g,removed:w}of i){if(g)if(dd.size===0&&pd.size===0)for(const S of g)hd.add(S);else for(const S of g)pd.has(S)?(dd.add(S),pd.delete(S)):dd.has(S)||hd.add(S);if(w)if(dd.size===0&&hd.size===0)for(const S of w)pd.add(S);else for(const S of w)hd.has(S)?hd.delete(S):(dd.delete(S),pd.add(S))}const r=vo.acquire();hd.forEach(g=>{r.push(g)});const n=vo.acquire();pd.forEach(g=>{n.push(g)});const o=this._items,u=e.items,p=vo.acquire();if(dd.forEach(g=>{u.indexOf(g)!==o.indexOf(g)&&p.push(g)}),e.listeners&&(r.length||n.length||p.length)){const g={target:this,added:r,removed:n,moved:p},w=e.listeners.length;for(let S=0;S<w;S++){const T=e.listeners[S];T.removed||T.callback.call(this,g)}}vo.release(r),vo.release(n),vo.release(p)}hd.clear(),pd.clear(),dd.clear()}};xp.ofType=t=>{if(!t)return Ip;if(d9.has(t))return d9.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const n=t.typeMap[r].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends Ip{};return m([sP({Type:t,ensureType:typeof t=="function"?Yi(t):ch(t)})],i.prototype,"itemType",void 0),i=m([G(`esri.core.Collection<${e}>`)],i),d9.set(t,i),i},m([b()],xp.prototype,"_updating",void 0),m([b()],xp.prototype,"length",void 0),m([b()],xp.prototype,"items",null),m([b({readOnly:!0})],xp.prototype,"updating",null),xp=Ip=m([G("esri.core.Collection")],xp);const Ie=xp;function Jp(t,e,i=Ie){return e||(e=new i),e===t||(e.removeAll(),lde(t)?e.addMany(t):t&&e.add(t)),e}function BJ(t){return t}function lde(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var Sf;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(Sf||(Sf={}));let ude=class{constructor(){this._resolver=os(),this._status=Sf.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=Sf.RESOLVED,this._cleanUp()},()=>{this._status=Sf.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===Sf.RESOLVED}isRejected(){return this._status===Sf.REJECTED}isFulfilled(){return this._status!==Sf.PENDING}abort(){this._resolver.reject(ni())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=os(),i=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},n=>{this.isFulfilled()||this._allPromise!==r||Cn(n)||this._resolver.reject(n)}),e.resolve()}};const Bb=t=>{let e=class extends t{constructor(...i){super(...i),this._promiseProps=new ude,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return this._promiseProps.promise.then(()=>this).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return e=m([G("esri.core.Promise")],e),e};let Q5=class extends Bb(Te){};Q5=m([G("esri.core.Promise")],Q5);const cde="not-loaded",hde="loading",pde="failed",iD="loaded",qJ=t=>{let e=class extends t{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(r=>{const n=this.load.bind(this);this.load=o=>{const u=new Promise((p,g)=>{const w=V7(o,g);this.destroyed&&g(new re("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(p,g).finally(()=>{w&&w.remove()})});if(this.loadStatus===cde){this._set("loadStatus",hde);const p=this._loadController=new AbortController;n({signal:p.signal})}return r(),u}})),this.when(()=>{this._set("loadStatus",iD),this._loadController=null},r=>{this._set("loadStatus",pde),this._set("loadError",r),this._loadController=null})}destroy(){this._loadController&&(this._loadController=En(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===iD}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new re("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort(),this._promiseProps.abort()),this}};return m([b({readOnly:!0})],e.prototype,"loaded",null),m([b({readOnly:!0})],e.prototype,"loadError",void 0),m([b({clonable:!1})],e.prototype,"loadStatus",void 0),m([b({type:[Ul],readOnly:!0})],e.prototype,"loadWarnings",null),e=m([G("esri.core.Loadable")],e),e};let Qw=class extends qJ(Q5){};Qw=m([G("esri.core.Loadable")],Qw),function(t){function e(i){return!(!i||!i.load)}t.LoadableMixin=qJ,t.isLoadable=e}(Qw||(Qw={}));const Qo=Qw;function dde(t,e,i){return Qy(t.map((r,n)=>e.apply(i,[r,n])))}async function fde(t,e,i){return(await Qy(t.map((r,n)=>e.apply(i,[r,n])))).map(r=>r.value)}function oP(t){return{ok:!0,value:t}}function aP(t){return{ok:!1,error:t}}function yde(t){return t!=null&&t.ok===!0?t.value:null}function mde(t){return t!=null&&t.ok===!1?t.error:null}async function Z3(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return oP(await t)}catch(e){return aP(e)}}async function gde(t){try{return oP(await t)}catch(e){return Ra(e),aP(e)}}function Sh(t,e){return new kd(t,e)}let kd=class extends Te{get value(){return yde(this._result)}get error(){return mde(this._result)}get finished(){return this._result!=null}constructor(e,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=En(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(n=>{this._result=oP(n),this._cleanup()},n=>{this._result=aP(n),this._cleanup()}),this._abortHandle=Zo(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Vi(this._abortHandle),this._abortController=null}};m([b()],kd.prototype,"value",null),m([b()],kd.prototype,"error",null),m([b()],kd.prototype,"finished",null),m([b()],kd.prototype,"promise",void 0),m([b()],kd.prototype,"_result",void 0),kd=m([G("esri.core.asyncUtils.ReactiveTask")],kd);async function lP(t,e){return await t.load(),vde(t,e)}async function vde(t,e){const i=[],r=(...o)=>{for(const u of o)u!=null&&(Array.isArray(u)?r(...u):Ie.isCollection(u)?u.forEach(p=>r(p)):Qo.isLoadable(u)&&i.push(u))};e(r);let n=null;if(await fde(i,async o=>{const u=await Z3(bde(o)?o.loadAll():o.load());u.ok!==!1||n||(n=u)}),n)throw n.error;return t}function bde(t){return"loadAll"in t&&typeof t.loadAll=="function"}function Le(t,e,i){let r,n;return e===void 0?(n=t,r=[void 0]):typeof e!="string"?(n=t,r=[void 0],i=e):(n=e,r=Array.isArray(t)?t:[t]),(o,u)=>{const p=o.constructor.prototype;for(const g of r){const w=lJ(o,g,n);w.write&&typeof w.write=="object"||(w.write={}),i&&(w.write.target=i),w.write.writer=p[u]}}}let et=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=wde(e),this.apiValues=rD(this._apiToJSON),this.jsonValues=rD(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,n,o)=>{const u=this.toJSON(r);u!==void 0&&Wn(o,u,n)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function wde(t){const e={};for(const i in t)e[t[i]]=i;return e}function rD(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function dt(){return function(t,e){return new et(t,{ignoreUnknown:!0,...e})}}let uP=class{constructor(e,i,r,n){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=r;const o=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*o,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=n||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Nr=new uP(6378137,1/298.257223563,3e5,.006694379990137799),ah=new uP(3396190,1/169.8944472236118,23e4),Xf=new uP(1737400,0,0);function qt(t){if(!Ct.assetsPath)throw fe.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new re("assets:path-not-set","config.assetsPath is not set");return ib(Ct.assetsPath,t)}let f9,he=null;function cP(){return!!he}function _de(){return!!me("esri-wasm")}function HJ(){return f9||(f9=ie(()=>import("./pe-wasm-Cr-tRJhg.js"),[]).then(t=>t.p).then(({default:t})=>t({locateFile:e=>qt(`esri/geometry/support/${e}`)})).then(t=>{JJ(t)}),f9)}var q4,gr,H4;(function(t){function e(o,u,p){he.ensureCache.prepare();const g=Uy(p),w=p===g,S=he.ensureFloat64(g),T=he._pe_geog_to_proj(he.getPointer(o),u,S);return T&&Cf(p,u,S,w),T}function i(o,u,p,g){switch(g){case gr.PE_TRANSFORM_P_TO_G:return r(o,u,p);case gr.PE_TRANSFORM_G_TO_P:return e(o,u,p)}return 0}function r(o,u,p){return n(o,u,p,0)}function n(o,u,p,g){he.ensureCache.prepare();const w=Uy(p),S=p===w,T=he.ensureFloat64(w),E=he._pe_proj_to_geog_center(he.getPointer(o),u,T,g);return E&&Cf(p,u,T,S),E}t.geogToProj=e,t.projGeog=i,t.projToGeog=r,t.projToGeogCenter=n})(q4||(q4={})),function(t){function e(){t.PE_BUFFER_MAX=he.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=he.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=he.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=he.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=he.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=he.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=he.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=he.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=he.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=he.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=he.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=he.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=he.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=he.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=he.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=he.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=he.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=he.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=he.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=he.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=he.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=he.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=he.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=he.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=he.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=he.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=he.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=he.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=he.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=he.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=he.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=he.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(gr||(gr={})),function(t){const e={},i={},r=C=>{if(C){const L=C.getType();switch(L){case gr.PE_TYPE_GEOGCS:C=he.castObject(C,he.PeGeogcs);break;case gr.PE_TYPE_PROJCS:C=he.castObject(C,he.PeProjcs);break;case gr.PE_TYPE_GEOGTRAN:C=he.castObject(C,he.PeGeogtran);break;default:L&gr.PE_TYPE_UNIT&&(C=he.castObject(C,he.PeUnit))}}return C};function n(){he.PeFactory.prototype.initialize(null)}function o(C){return u(gr.PE_TYPE_COORDSYS,C)}function u(C,L){let R=null,F=e[C];if(F||(F={},e[C]=F),F.hasOwnProperty(String(L)))R=F[L];else{const V=he.PeFactory.prototype.factoryByType(C,L);he.compare(V,he.NULL)||(R=V,F[L]=R)}return R=r(R),R}function p(C,L){let R=null,F=i[C];if(F||(F={},i[C]=F),F.hasOwnProperty(L))R=F[L];else{const V=he.PeFactory.prototype.fromString(C,L);he.compare(V,he.NULL)||(R=V,F[L]=R)}return R=r(R),R}function g(C){return u(gr.PE_TYPE_GEOGCS,C)}function w(C){return u(gr.PE_TYPE_GEOGTRAN,C)}function S(C){return he.PeFactory.prototype.getCode(C)}function T(C){return u(gr.PE_TYPE_PROJCS,C)}function E(C){return u(gr.PE_TYPE_UNIT,C)}t.initialize=n,t.coordsys=o,t.factoryByType=u,t.fromString=p,t.geogcs=g,t.geogtran=w,t.getCode=S,t.projcs=T,t.unit=E}(H4||(H4={}));let WJ=null;var eE,W4,J4,Z4,tE,K4,iE,rE,Y4;function JJ(t){function e(o,u,p){o[u]=p(o[u])}he=t,gr.init(),eE.init(),tE.init(),iE.init(),rE.init(),WJ=class extends he.PeGCSExtent{destroy(){he.destroy(this)}};const i=[he.PeDatum,he.PeGeogcs,he.PeGeogtran,he.PeObject,he.PeParameter,he.PePrimem,he.PeProjcs,he.PeSpheroid,he.PeUnit];for(const o of i)e(o.prototype,"getName",u=>function(){return u.call(this,new Array(gr.PE_NAME_MAX))});for(const o of[he.PeGeogtran,he.PeProjcs])e(o.prototype,"getParameters",u=>function(){const p=new Array(gr.PE_PARM_MAX);let g=u.call(this);for(let w=0;w<p.length;w++){const S=he.getValue(g,"*");p[w]=S?he.wrapPointer(S,he.PeParameter):null,g+=Int32Array.BYTES_PER_ELEMENT}return p});e(he.PeHorizon.prototype,"getCoord",o=>function(){const u=this.getSize();if(!u)return null;const p=[];return Cf(p,u,o.call(this)),p}),e(he.PeGTlistExtendedEntry.prototype,"getEntries",o=>{const u=he._pe_getPeGTlistExtendedGTsSize();return function(){let p=null;const g=o.call(this);if(!he.compare(g,he.NULL)){p=[g];const w=this.getSteps();if(w>1){const S=he.getPointer(g);for(let T=1;T<w;T++)p.push(he.wrapPointer(S+u*T,he.PeGTlistExtendedGTs))}}return p}});const r=he._pe_getPeHorizonSize(),n=o=>function(){let u=this._cache;if(u||(u=new Map,this._cache=u),u.has(o))return u.get(o);let p=null;const g=o.call(this);if(!he.compare(g,he.NULL)){p=[g];const w=g.getNump();if(w>1){const S=he.getPointer(g);for(let T=1;T<w;T++)p.push(he.wrapPointer(S+r*T,he.PeHorizon))}}return u.set(o,p),p};e(he.PeProjcs.prototype,"horizonGcsGenerate",n),e(he.PeProjcs.prototype,"horizonPcsGenerate",n),he.PeObject.prototype.toString=function(o=gr.PE_STR_OPTS_NONE){he.ensureCache.prepare();const u=he.getPointer(this),p=he.ensureInt8(new Array(gr.PE_BUFFER_MAX));return he.UTF8ToString(he._pe_object_to_string_ext(u,o,p))}}function kh(t){if(!t)return;const e=he.getClass(t);if(!e)return;const i=he.getCache(e);if(!i)return;const r=he.getPointer(t);r&&delete i[r]}function tx(t,e){const i=[],r=new Array(e);for(let n=0;n<t;n++)i.push(he.ensureInt8(r));return i}function Uy(t){let e;return Array.isArray(t[0])?(e=[],t.forEach(i=>{e.push(i[0],i[1])})):e=t,e}function Cf(t,e,i,r=!1){if(r)for(let n=0;n<2*e;n++)t[n]=he.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=t.length===0;for(let o=0;o<e;o++)n&&(t[o]=new Array(2)),t[o][0]=he.getValue(i,"double"),t[o][1]=he.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=he.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=he._pe_getPeGTlistExtendedEntrySize()}function r(n,o,u,p,g,w){let S=null;const T=new he.PeInteger(w);try{const E=he.PeGTlistExtended.prototype.getGTlist(n,o,u,p,g,T);if((w=T.val)&&(S=[E],w>1)){const C=he.getPointer(E);for(let L=1;L<w;L++)S.push(he.wrapPointer(C+e*L,he.PeGTlistExtendedEntry))}}finally{he.destroy(T)}return S}t.init=i,t.getGTlist=r})(eE||(eE={})),function(t){function e(i){if(i!=null&&i.length){for(const r of i)kh(r),r.getEntries().forEach(n=>{kh(n);const o=n.getGeogtran();kh(o),o.getParameters().forEach(kh),[o.getGeogcs1(),o.getGeogcs2()].forEach(u=>{kh(u);const p=u.getDatum();kh(p),kh(p.getSpheroid()),kh(u.getPrimem()),kh(u.getUnit())})});he.PeGTlistExtendedEntry.prototype.Delete(i[0])}}t.destroy=e}(W4||(W4={})),function(t){function e(i,r,n,o,u){he.ensureCache.prepare();const p=Uy(n),g=n===p,w=he.ensureFloat64(p);let S=0;o&&(S=he.ensureFloat64(o));const T=he._pe_geog_to_geog(he.getPointer(i),r,w,S,u);return T&&Cf(n,r,w,g),T}t.geogToGeog=e}(J4||(J4={})),function(t){const e=(w,S,T,E,C,L)=>{let R,F;switch(he.ensureCache.prepare(),w){case"dd":R=he._pe_geog_to_dd,F=gr.PE_DD_MAX;break;case"ddm":R=he._pe_geog_to_ddm,F=gr.PE_DDM_MAX;break;case"dms":R=he._pe_geog_to_dms,F=gr.PE_DMS_MAX}let V=0;S&&(V=he.getPointer(S));const U=Uy(E),W=he.ensureFloat64(U),H=tx(T,F),J=R(V,T,W,C,he.ensureInt32(H));if(J)for(let X=0;X<T;X++)L[X]=he.UTF8ToString(H[X]);return J},i=(w,S,T,E,C)=>{let L;switch(he.ensureCache.prepare(),w){case"dd":L=he._pe_dd_to_geog;break;case"ddm":L=he._pe_ddm_to_geog;break;case"dms":L=he._pe_dms_to_geog}let R=0;S&&(R=he.getPointer(S));const F=E.map(H=>he.ensureString(H)),V=he.ensureInt32(F),U=he.ensureFloat64(new Array(2*T)),W=L(R,T,V,U);return W&&Cf(C,T,U),W};function r(w,S,T,E,C){return e("dms",w,S,T,E,C)}function n(w,S,T,E){return i("dms",w,S,T,E)}function o(w,S,T,E,C){return e("ddm",w,S,T,E,C)}function u(w,S,T,E){return i("ddm",w,S,T,E)}function p(w,S,T,E,C){return e("dd",w,S,T,E,C)}function g(w,S,T,E){return i("dd",w,S,T,E)}t.geogToDms=r,t.dmsToGeog=n,t.geogToDdm=o,t.ddmToGeog=u,t.geogToDd=p,t.ddToGeog=g}(Z4||(Z4={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=he.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=he.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=he.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=he.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=he.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(n,o,u,p,g,w,S){he.ensureCache.prepare();let T=0;n&&(T=he.getPointer(n));const E=Uy(u),C=he.ensureFloat64(E),L=tx(o,gr.PE_MGRS_MAX),R=he.ensureInt32(L),F=he._pe_geog_to_mgrs_extended(T,o,C,p,g,w,R);if(F)for(let V=0;V<o;V++)S[V]=he.UTF8ToString(L[V]);return F}function r(n,o,u,p,g){he.ensureCache.prepare();let w=0;n&&(w=he.getPointer(n));const S=u.map(L=>he.ensureString(L)),T=he.ensureInt32(S),E=he.ensureFloat64(new Array(2*o)),C=he._pe_mgrs_to_geog_extended(w,o,T,p,E);return C&&Cf(g,o,E),C}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=r}(tE||(tE={})),function(t){function e(r,n,o,u,p,g,w){he.ensureCache.prepare();let S=0;r&&(S=he.getPointer(r));const T=Uy(o),E=he.ensureFloat64(T),C=tx(n,gr.PE_MGRS_MAX),L=he.ensureInt32(C),R=he._pe_geog_to_usng(S,n,E,u,p,g,L);if(R)for(let F=0;F<n;F++)w[F]=he.UTF8ToString(C[F]);return R}function i(r,n,o,u){he.ensureCache.prepare();let p=0;r&&(p=he.getPointer(r));const g=o.map(E=>he.ensureString(E)),w=he.ensureInt32(g),S=he.ensureFloat64(new Array(2*n)),T=he._pe_usng_to_geog(p,n,w,S);return T&&Cf(u,n,S),T}t.geogToUsng=e,t.usngToGeog=i}(K4||(K4={})),function(t){function e(){t.PE_UTM_OPTS_NONE=he.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=he.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=he.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(n,o,u,p,g){he.ensureCache.prepare();let w=0;n&&(w=he.getPointer(n));const S=Uy(u),T=he.ensureFloat64(S),E=tx(o,gr.PE_UTM_MAX),C=he.ensureInt32(E),L=he._pe_geog_to_utm(w,o,T,p,C);if(L)for(let R=0;R<o;R++)g[R]=he.UTF8ToString(E[R]);return L}function r(n,o,u,p,g){he.ensureCache.prepare();let w=0;n&&(w=he.getPointer(n));const S=u.map(L=>he.ensureString(L)),T=he.ensureInt32(S),E=he.ensureFloat64(new Array(2*o)),C=he._pe_utm_to_geog(w,o,T,p,E);return C&&Cf(g,o,E),C}t.init=e,t.geogToUtm=i,t.utmToGeog=r}(iE||(iE={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=he.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=he.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=he.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=he.PePCSInfo.prototype.PE_POLE_POINT}function r(n,o=t.PE_PCSINFO_OPTION_DOMAIN){let u=null,p=null;return e.has(n)&&(p=e.get(n),p[o]&&(u=p[o])),u||(u=he.PePCSInfo.prototype.generate(n,o),p||(p=[],e.set(n,p)),p[o]=u),u}t.init=i,t.generate=r}(rE||(rE={})),function(t){function e(){return he.PeVersion.prototype.version_string()}t.versionString=e}(Y4||(Y4={}));const Sde=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return q4},get PeDefs(){return gr},get PeFactory(){return H4},get PeGCSExtent(){return WJ},get PeGTTransformations(){return J4},get PeGTlistExtended(){return eE},get PeGTlistExtendedEntry(){return W4},get PeNotationDms(){return Z4},get PeNotationMgrs(){return tE},get PeNotationUsng(){return K4},get PeNotationUtm(){return iE},get PePCSInfo(){return rE},get PeVersion(){return Y4},_init:JJ,get _pe(){return he},isLoaded:cP,isSupported:_de,load:HJ},Symbol.toStringTag,{value:"Module"}));var $m;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})($m||($m={}));let M;const K={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(M=2e3;M<=2045;M++)K[M]=0;for(M=2056;M<=2065;M++)K[M]=0;for(M=2067;M<=2135;M++)K[M]=0;for(M=2137;M<=2154;M++)K[M]=0;for(M=2161;M<=2170;M++)K[M]=0;for(M=2172;M<=2193;M++)K[M]=0;for(M=2195;M<=2198;M++)K[M]=0;for(M=2200;M<=2203;M++)K[M]=0;for(M=2205;M<=2217;M++)K[M]=0;for(M=2222;M<=2224;M++)K[M]=1;for(M=2225;M<=2250;M++)K[M]=2;for(M=2251;M<=2253;M++)K[M]=1;for(M=2257;M<=2264;M++)K[M]=2;for(M=2274;M<=2279;M++)K[M]=2;for(M=2280;M<=2282;M++)K[M]=1;for(M=2283;M<=2289;M++)K[M]=2;for(M=2290;M<=2292;M++)K[M]=0;for(M=2308;M<=2313;M++)K[M]=0;for(M=2315;M<=2491;M++)K[M]=0;for(M=2494;M<=2866;M++)K[M]=0;for(M=2867;M<=2869;M++)K[M]=1;for(M=2870;M<=2888;M++)K[M]=2;for(M=2891;M<=2895;M++)K[M]=2;for(M=2896;M<=2898;M++)K[M]=1;for(M=2902;M<=2908;M++)K[M]=2;for(M=2915;M<=2920;M++)K[M]=2;for(M=2921;M<=2923;M++)K[M]=1;for(M=2924;M<=2930;M++)K[M]=2;for(M=2931;M<=2962;M++)K[M]=0;for(M=2964;M<=2968;M++)K[M]=2;for(M=2969;M<=2973;M++)K[M]=0;for(M=2975;M<=2991;M++)K[M]=0;for(M=2995;M<=3051;M++)K[M]=0;for(M=3054;M<=3079;M++)K[M]=0;for(M=3081;M<=3088;M++)K[M]=0;for(M=3092;M<=3101;M++)K[M]=0;for(M=3106;M<=3138;M++)K[M]=0;for(M=3146;M<=3151;M++)K[M]=0;for(M=3153;M<=3166;M++)K[M]=0;for(M=3168;M<=3172;M++)K[M]=0;for(M=3174;M<=3203;M++)K[M]=0;for(M=3294;M<=3358;M++)K[M]=0;for(M=3367;M<=3403;M++)K[M]=0;for(M=3408;M<=3416;M++)K[M]=0;for(M=3417;M<=3438;M++)K[M]=2;for(M=3441;M<=3446;M++)K[M]=2;for(M=3447;M<=3450;M++)K[M]=0;for(M=3451;M<=3459;M++)K[M]=2;for(M=3460;M<=3478;M++)K[M]=0;for(M=3554;M<=3559;M++)K[M]=0;for(M=3560;M<=3570;M++)K[M]=2;for(M=3571;M<=3581;M++)K[M]=0;for(M=3594;M<=3597;M++)K[M]=0;for(M=3601;M<=3604;M++)K[M]=0;for(M=3637;M<=3639;M++)K[M]=0;for(M=3665;M<=3667;M++)K[M]=0;for(M=3693;M<=3695;M++)K[M]=0;for(M=3701;M<=3727;M++)K[M]=0;for(M=3728;M<=3739;M++)K[M]=2;for(M=3740;M<=3751;M++)K[M]=0;for(M=3753;M<=3760;M++)K[M]=2;for(M=3761;M<=3773;M++)K[M]=0;for(M=3775;M<=3777;M++)K[M]=0;for(M=3779;M<=3781;M++)K[M]=0;for(M=3783;M<=3785;M++)K[M]=0;for(M=3788;M<=3791;M++)K[M]=0;for(M=3797;M<=3802;M++)K[M]=0;for(M=3814;M<=3816;M++)K[M]=0;for(M=3825;M<=3829;M++)K[M]=0;for(M=3832;M<=3841;M++)K[M]=0;for(M=3844;M<=3852;M++)K[M]=0;for(M=3873;M<=3885;M++)K[M]=0;for(M=3890;M<=3893;M++)K[M]=0;for(M=3907;M<=3912;M++)K[M]=0;for(M=3942;M<=3950;M++)K[M]=0;for(M=3968;M<=3970;M++)K[M]=0;for(M=3973;M<=3976;M++)K[M]=0;for(M=3986;M<=3989;M++)K[M]=0;for(M=3994;M<=3997;M++)K[M]=0;for(M=4048;M<=4051;M++)K[M]=0;for(M=4056;M<=4063;M++)K[M]=0;for(M=4093;M<=4096;M++)K[M]=0;for(M=4390;M<=4398;M++)K[M]=0;for(M=4399;M<=4413;M++)K[M]=2;for(M=4418;M<=4433;M++)K[M]=2;for(M=4455;M<=4457;M++)K[M]=2;for(M=4484;M<=4489;M++)K[M]=0;for(M=4491;M<=4554;M++)K[M]=0;for(M=4568;M<=4589;M++)K[M]=0;for(M=4652;M<=4656;M++)K[M]=0;for(M=4766;M<=4800;M++)K[M]=0;for(M=5014;M<=5016;M++)K[M]=0;for(M=5069;M<=5072;M++)K[M]=0;for(M=5105;M<=5130;M++)K[M]=0;for(M=5167;M<=5188;M++)K[M]=0;for(M=5253;M<=5259;M++)K[M]=0;for(M=5269;M<=5275;M++)K[M]=0;for(M=5292;M<=5311;M++)K[M]=0;for(M=5329;M<=5331;M++)K[M]=0;for(M=5343;M<=5349;M++)K[M]=0;for(M=5355;M<=5357;M++)K[M]=0;for(M=5387;M<=5389;M++)K[M]=0;for(M=5459;M<=5463;M++)K[M]=0;for(M=5479;M<=5482;M++)K[M]=0;for(M=5518;M<=5520;M++)K[M]=0;for(M=5530;M<=5539;M++)K[M]=0;for(M=5550;M<=5552;M++)K[M]=0;for(M=5562;M<=5583;M++)K[M]=0;for(M=5623;M<=5625;M++)K[M]=2;for(M=5631;M<=5639;M++)K[M]=0;for(M=5649;M<=5653;M++)K[M]=0;for(M=5663;M<=5680;M++)K[M]=0;for(M=5682;M<=5685;M++)K[M]=0;for(M=5875;M<=5877;M++)K[M]=0;for(M=5896;M<=5899;M++)K[M]=0;for(M=5921;M<=5940;M++)K[M]=0;for(M=6050;M<=6125;M++)K[M]=0;for(M=6244;M<=6275;M++)K[M]=0;for(M=6328;M<=6348;M++)K[M]=0;for(M=6350;M<=6356;M++)K[M]=0;for(M=6366;M<=6372;M++)K[M]=0;for(M=6381;M<=6387;M++)K[M]=0;for(M=6393;M<=6404;M++)K[M]=0;for(M=6480;M<=6483;M++)K[M]=0;for(M=6511;M<=6514;M++)K[M]=0;for(M=6579;M<=6581;M++)K[M]=0;for(M=6619;M<=6624;M++)K[M]=0;for(M=6625;M<=6627;M++)K[M]=2;for(M=6628;M<=6632;M++)K[M]=0;for(M=6634;M<=6637;M++)K[M]=0;for(M=6669;M<=6692;M++)K[M]=0;for(M=6707;M<=6709;M++)K[M]=0;for(M=6720;M<=6723;M++)K[M]=0;for(M=6732;M<=6738;M++)K[M]=0;for(M=6931;M<=6933;M++)K[M]=0;for(M=6956;M<=6959;M++)K[M]=0;for(M=7005;M<=7007;M++)K[M]=0;for(M=7057;M<=7070;M++)K[M]=2;for(M=7074;M<=7082;M++)K[M]=0;for(M=7109;M<=7118;M++)K[M]=0;for(M=7119;M<=7127;M++)K[M]=1;for(M=7374;M<=7376;M++)K[M]=0;for(M=7528;M<=7586;M++)K[M]=0;for(M=7587;M<=7645;M++)K[M]=2;for(M=7692;M<=7696;M++)K[M]=0;for(M=7755;M<=7787;M++)K[M]=0;for(M=7791;M<=7795;M++)K[M]=0;for(M=7799;M<=7801;M++)K[M]=0;for(M=7803;M<=7805;M++)K[M]=0;for(M=7825;M<=7831;M++)K[M]=0;for(M=7845;M<=7859;M++)K[M]=0;for(M=8013;M<=8032;M++)K[M]=0;for(M=8065;M<=8068;M++)K[M]=1;for(M=8518;M<=8529;M++)K[M]=2;for(M=8533;M<=8536;M++)K[M]=2;for(M=8538;M<=8540;M++)K[M]=2;for(M=8677;M<=8679;M++)K[M]=0;for(M=8836;M<=8840;M++)K[M]=0;for(M=8857;M<=8859;M++)K[M]=0;for(M=8908;M<=8910;M++)K[M]=0;for(M=9154;M<=9159;M++)K[M]=0;for(M=9205;M<=9218;M++)K[M]=0;for(M=9271;M<=9273;M++)K[M]=0;for(M=9295;M<=9297;M++)K[M]=0;for(M=9356;M<=9360;M++)K[M]=0;for(M=9404;M<=9407;M++)K[M]=0;for(M=9476;M<=9482;M++)K[M]=0;for(M=9487;M<=9494;M++)K[M]=0;for(M=9697;M<=9699;M++)K[M]=0;for(M=9821;M<=9865;M++)K[M]=0;for(M=10285;M<=10291;M++)K[M]=0;for(M=10314;M<=10317;M++)K[M]=0;for(M=10448;M<=10465;M++)K[M]=0;for(M=10731;M<=10733;M++)K[M]=0;for(M=11114;M<=11118;M++)K[M]=0;for(M=20004;M<=20032;M++)K[M]=0;for(M=20047;M<=20049;M++)K[M]=0;for(M=20062;M<=20092;M++)K[M]=0;for(M=20135;M<=20138;M++)K[M]=0;for(M=20248;M<=20258;M++)K[M]=0;for(M=20348;M<=20358;M++)K[M]=0;for(M=20436;M<=20440;M++)K[M]=0;for(M=20822;M<=20824;M++)K[M]=0;for(M=20904;M<=20932;M++)K[M]=0;for(M=20934;M<=20936;M++)K[M]=0;for(M=21004;M<=21032;M++)K[M]=0;for(M=21035;M<=21037;M++)K[M]=0;for(M=21095;M<=21097;M++)K[M]=0;for(M=21148;M<=21150;M++)K[M]=0;for(M=21207;M<=21264;M++)K[M]=0;for(M=21307;M<=21364;M++)K[M]=0;for(M=21413;M<=21423;M++)K[M]=0;for(M=21453;M<=21463;M++)K[M]=0;for(M=21473;M<=21483;M++)K[M]=0;for(M=21780;M<=21782;M++)K[M]=0;for(M=21891;M<=21894;M++)K[M]=0;for(M=21896;M<=21899;M++)K[M]=0;for(M=22171;M<=22177;M++)K[M]=0;for(M=22181;M<=22187;M++)K[M]=0;for(M=22191;M<=22197;M++)K[M]=0;for(M=22207;M<=22222;M++)K[M]=0;for(M=22229;M<=22232;M++)K[M]=0;for(M=22234;M<=22236;M++)K[M]=0;for(M=22243;M<=22250;M++)K[M]=0;for(M=22262;M<=22265;M++)K[M]=0;for(M=22307;M<=22322;M++)K[M]=0;for(M=22348;M<=22357;M++)K[M]=0;for(M=22407;M<=22422;M++)K[M]=0;for(M=22462;M<=22465;M++)K[M]=0;for(M=22521;M<=22525;M++)K[M]=0;for(M=22607;M<=22622;M++)K[M]=0;for(M=22641;M<=22646;M++)K[M]=0;for(M=22648;M<=22657;M++)K[M]=0;for(M=22707;M<=22722;M++)K[M]=0;for(M=22762;M<=22765;M++)K[M]=0;for(M=22807;M<=22822;M++)K[M]=0;for(M=22991;M<=22994;M++)K[M]=0;for(M=23028;M<=23038;M++)K[M]=0;for(M=23301;M<=23333;M++)K[M]=2;for(M=23830;M<=23853;M++)K[M]=0;for(M=23866;M<=23872;M++)K[M]=0;for(M=23877;M<=23884;M++)K[M]=0;for(M=23886;M<=23894;M++)K[M]=0;for(M=23946;M<=23948;M++)K[M]=0;for(M=24311;M<=24313;M++)K[M]=0;for(M=24342;M<=24347;M++)K[M]=0;for(M=24370;M<=24374;M++)K[M]=10;for(M=24375;M<=24381;M++)K[M]=0;for(M=24718;M<=24721;M++)K[M]=0;for(M=24817;M<=24821;M++)K[M]=0;for(M=24877;M<=24882;M++)K[M]=0;for(M=24891;M<=24893;M++)K[M]=0;for(M=25391;M<=25395;M++)K[M]=0;for(M=25828;M<=25838;M++)K[M]=0;for(M=26191;M<=26195;M++)K[M]=0;for(M=26391;M<=26393;M++)K[M]=0;for(M=26701;M<=26722;M++)K[M]=0;for(M=26729;M<=26799;M++)K[M]=2;for(M=26801;M<=26803;M++)K[M]=2;for(M=26811;M<=26813;M++)K[M]=2;for(M=26847;M<=26870;M++)K[M]=2;for(M=26891;M<=26899;M++)K[M]=0;for(M=26901;M<=26923;M++)K[M]=0;for(M=26929;M<=26946;M++)K[M]=0;for(M=26948;M<=26998;M++)K[M]=0;for(M=27037;M<=27040;M++)K[M]=0;for(M=27205;M<=27232;M++)K[M]=0;for(M=27258;M<=27260;M++)K[M]=0;for(M=27391;M<=27398;M++)K[M]=0;for(M=27561;M<=27564;M++)K[M]=0;for(M=27571;M<=27574;M++)K[M]=0;for(M=27581;M<=27584;M++)K[M]=0;for(M=27591;M<=27594;M++)K[M]=0;for(M=27700;M<=27707;M++)K[M]=0;for(M=28191;M<=28193;M++)K[M]=0;for(M=28348;M<=28358;M++)K[M]=0;for(M=28402;M<=28432;M++)K[M]=0;for(M=28462;M<=28492;M++)K[M]=0;for(M=29118;M<=29122;M++)K[M]=0;for(M=29168;M<=29172;M++)K[M]=0;for(M=29177;M<=29185;M++)K[M]=0;for(M=29187;M<=29195;M++)K[M]=0;for(M=29900;M<=29903;M++)K[M]=0;for(M=30161;M<=30179;M++)K[M]=0;for(M=30491;M<=30494;M++)K[M]=0;for(M=30729;M<=30732;M++)K[M]=0;for(M=31251;M<=31259;M++)K[M]=0;for(M=31265;M<=31268;M++)K[M]=0;for(M=31275;M<=31279;M++)K[M]=0;for(M=31281;M<=31297;M++)K[M]=0;for(M=31461;M<=31469;M++)K[M]=0;for(M=31491;M<=31495;M++)K[M]=0;for(M=31917;M<=31922;M++)K[M]=0;for(M=31965;M<=32e3;M++)K[M]=0;for(M=32001;M<=32003;M++)K[M]=2;for(M=32005;M<=32031;M++)K[M]=2;for(M=32033;M<=32060;M++)K[M]=2;for(M=32064;M<=32067;M++)K[M]=2;for(M=32074;M<=32077;M++)K[M]=2;for(M=32081;M<=32086;M++)K[M]=0;for(M=32107;M<=32130;M++)K[M]=0;for(M=32133;M<=32159;M++)K[M]=0;for(M=32164;M<=32167;M++)K[M]=2;for(M=32180;M<=32199;M++)K[M]=0;for(M=32201;M<=32260;M++)K[M]=0;for(M=32301;M<=32360;M++)K[M]=0;for(M=32401;M<=32460;M++)K[M]=0;for(M=32501;M<=32560;M++)K[M]=0;for(M=32601;M<=32662;M++)K[M]=0;for(M=32664;M<=32667;M++)K[M]=2;for(M=32701;M<=32761;M++)K[M]=0;for(M=53001;M<=53004;M++)K[M]=0;for(M=53008;M<=53019;M++)K[M]=0;for(M=53021;M<=53032;M++)K[M]=0;for(M=53034;M<=53037;M++)K[M]=0;for(M=53042;M<=53046;M++)K[M]=0;for(M=53074;M<=53080;M++)K[M]=0;for(M=54001;M<=54004;M++)K[M]=0;for(M=54008;M<=54019;M++)K[M]=0;for(M=54021;M<=54032;M++)K[M]=0;for(M=54034;M<=54037;M++)K[M]=0;for(M=54042;M<=54046;M++)K[M]=0;for(M=54048;M<=54053;M++)K[M]=0;for(M=54074;M<=54080;M++)K[M]=0;for(M=54098;M<=54101;M++)K[M]=0;for(M=102001;M<=102040;M++)K[M]=0;for(M=102042;M<=102063;M++)K[M]=0;for(M=102065;M<=102067;M++)K[M]=0;for(M=102070;M<=102117;M++)K[M]=0;for(M=102122;M<=102216;M++)K[M]=0;for(M=102221;M<=102377;M++)K[M]=0;for(M=102382;M<=102388;M++)K[M]=0;for(M=102389;M<=102398;M++)K[M]=2;for(M=102399;M<=102444;M++)K[M]=0;for(M=102445;M<=102447;M++)K[M]=2;for(M=102448;M<=102458;M++)K[M]=0;for(M=102459;M<=102468;M++)K[M]=2;for(M=102469;M<=102499;M++)K[M]=0;for(M=102500;M<=102519;M++)K[M]=1;for(M=102520;M<=102524;M++)K[M]=0;for(M=102525;M<=102529;M++)K[M]=2;for(M=102530;M<=102588;M++)K[M]=0;for(M=102590;M<=102598;M++)K[M]=0;for(M=102601;M<=102603;M++)K[M]=0;for(M=102605;M<=102628;M++)K[M]=0;for(M=102629;M<=102646;M++)K[M]=2;for(M=102648;M<=102700;M++)K[M]=2;for(M=102701;M<=102703;M++)K[M]=0;for(M=102707;M<=102730;M++)K[M]=2;for(M=102733;M<=102758;M++)K[M]=2;for(M=102767;M<=102900;M++)K[M]=0;for(M=102901;M<=102933;M++)K[M]=2;for(M=102934;M<=102950;M++)K[M]=13;for(M=102951;M<=102963;M++)K[M]=0;for(M=102965;M<=102969;M++)K[M]=0;for(M=102971;M<=102973;M++)K[M]=0;for(M=102975;M<=102989;M++)K[M]=0;for(M=102990;M<=102992;M++)K[M]=1;for(M=102997;M<=103002;M++)K[M]=0;for(M=103003;M<=103008;M++)K[M]=2;for(M=103009;M<=103011;M++)K[M]=0;for(M=103012;M<=103014;M++)K[M]=2;for(M=103019;M<=103021;M++)K[M]=0;for(M=103022;M<=103024;M++)K[M]=2;for(M=103029;M<=103031;M++)K[M]=0;for(M=103032;M<=103034;M++)K[M]=2;for(M=103065;M<=103068;M++)K[M]=0;for(M=103074;M<=103076;M++)K[M]=0;for(M=103077;M<=103079;M++)K[M]=1;for(M=103080;M<=103082;M++)K[M]=0;for(M=103083;M<=103085;M++)K[M]=2;for(M=103090;M<=103093;M++)K[M]=0;for(M=103097;M<=103099;M++)K[M]=0;for(M=103100;M<=103102;M++)K[M]=2;for(M=103107;M<=103109;M++)K[M]=0;for(M=103110;M<=103112;M++)K[M]=2;for(M=103113;M<=103116;M++)K[M]=0;for(M=103117;M<=103120;M++)K[M]=2;for(M=103153;M<=103157;M++)K[M]=0;for(M=103158;M<=103162;M++)K[M]=2;for(M=103163;M<=103165;M++)K[M]=0;for(M=103166;M<=103168;M++)K[M]=1;for(M=103169;M<=103171;M++)K[M]=2;for(M=103186;M<=103188;M++)K[M]=0;for(M=103189;M<=103191;M++)K[M]=2;for(M=103192;M<=103195;M++)K[M]=0;for(M=103196;M<=103199;M++)K[M]=2;for(M=103200;M<=103224;M++)K[M]=0;for(M=103225;M<=103227;M++)K[M]=1;for(M=103232;M<=103237;M++)K[M]=0;for(M=103238;M<=103243;M++)K[M]=2;for(M=103244;M<=103246;M++)K[M]=0;for(M=103247;M<=103249;M++)K[M]=2;for(M=103254;M<=103256;M++)K[M]=0;for(M=103257;M<=103259;M++)K[M]=2;for(M=103264;M<=103266;M++)K[M]=0;for(M=103267;M<=103269;M++)K[M]=2;for(M=103300;M<=103375;M++)K[M]=0;for(M=103381;M<=103383;M++)K[M]=0;for(M=103384;M<=103386;M++)K[M]=1;for(M=103387;M<=103389;M++)K[M]=0;for(M=103390;M<=103392;M++)K[M]=2;for(M=103397;M<=103399;M++)K[M]=0;for(M=103400;M<=103471;M++)K[M]=2;for(M=103476;M<=103478;M++)K[M]=0;for(M=103479;M<=103481;M++)K[M]=2;for(M=103486;M<=103488;M++)K[M]=0;for(M=103489;M<=103491;M++)K[M]=2;for(M=103492;M<=103495;M++)K[M]=0;for(M=103496;M<=103499;M++)K[M]=2;for(M=103528;M<=103543;M++)K[M]=0;for(M=103544;M<=103548;M++)K[M]=2;for(M=103549;M<=103551;M++)K[M]=0;for(M=103552;M<=103554;M++)K[M]=1;for(M=103555;M<=103557;M++)K[M]=2;for(M=103558;M<=103560;M++)K[M]=0;for(M=103571;M<=103573;M++)K[M]=0;for(M=103574;M<=103576;M++)K[M]=2;for(M=103577;M<=103580;M++)K[M]=0;for(M=103581;M<=103583;M++)K[M]=2;for(M=103595;M<=103694;M++)K[M]=0;for(M=103696;M<=103699;M++)K[M]=0;for(M=103700;M<=103793;M++)K[M]=2;for(M=103794;M<=103890;M++)K[M]=0;for(M=103891;M<=103896;M++)K[M]=2;for(M=103900;M<=103971;M++)K[M]=2;for(M=103972;M<=103977;M++)K[M]=0;for(M=112e3;M<=112101;M++)K[M]=0;const ZJ=[102100,102113,3857,3785],xde=[104905,104971],$de=[4326,...ZJ,...xde],nD='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',ix=[-20037508342788905e-9,20037508342788905e-9],rx=[-20037508342787e-6,20037508342787e-6],KJ={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:ix,origin:rx,dx:1e-5},102100:{wkTemplate:nD,valid:ix,origin:rx,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:ix,origin:rx,dx:1e-5},3857:{wkTemplate:nD,valid:ix,origin:rx,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Ki(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const i=t.wkid,r=e.wkid;if(i!=null||r!=null){if(i===r||ea(t)&&ea(e))return!0;const u=t.latestWkid;if(u!=null&&r===u)return!0;const p=e.latestWkid;return p!=null&&i===p}let n,o;return t.wkt2&&e.wkt2?(n=t.wkt2,o=e.wkt2):t.wkt&&e.wkt&&(n=t.wkt,o=e.wkt),!(!n||!o)&&n.toUpperCase()===o.toUpperCase()}function _s(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&KJ[e]||null}function nE(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function u0(t){if(!Jo(t))return!1;const{wkid:e}=t;if(e)return K[e]==null;const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function Tde(t){return!(YJ(t)||XJ(t))}function Qf(t){return(t==null?void 0:t.wkid)===4326}function pWe(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function sD(t){return(t==null?void 0:t.wkid)===$m.CGCS2000}function ea(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&ZJ.includes(e)}function X4(t){return(t==null?void 0:t.wkid)===32662}function nb(t){return t===$m.GCSMARS2000||t===$m.GCSMARS2000_SPHERE}function YJ(t){return nb(t==null?void 0:t.wkid)}function sb(t){return t===$m.GCSMOON2000}function XJ(t){return sb(t==null?void 0:t.wkid)}function Ede(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&$de.includes(e)}function Jo(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const QJ={wkid:4326,wkt:Xu(KJ[4326].wkTemplate,{Central_Meridian:"0.0"})},eZ={wkid:102100,latestWkid:3857},Ide={wkid:32662};function hP(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const tZ=hP(Nr),LI=hP(ah),OI=hP(Xf),iZ={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Nr.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},Mde=LI.wkt.toUpperCase(),kde=OI.wkt.toUpperCase();function PI(t){if(t!=null&&Jo(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(nb(e))return ah;const r=i==null?void 0:i.toUpperCase();if(i&&r===Mde)return ah;if(sb(e)||r&&r===kde)return Xf}return Nr}function dWe(t){return nb(t)?ah:sb(t)?Xf:Nr}function sE(t){return Ki(t,tZ)}function e0(t){return sE(t)||Ki(t,LI)||Ki(t,OI)}const pP=39.37,Cde=Nr.radius*Math.PI/200,rZ=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,lm=K,nZ=/UNIT\[([^\]]+)]/i,Ade=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),Lde=dt()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),ac=t=>t*t,fd=t=>t*t*t,n3={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:ac(.001)},"square-centimeters":{inBaseUnits:ac(.01)},"square-decimeters":{inBaseUnits:ac(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:ac(1e3)},"square-inches":{inBaseUnits:ac(.0254)},"square-feet":{inBaseUnits:ac(.3048)},"square-yards":{inBaseUnits:ac(.9144)},"square-miles":{inBaseUnits:ac(1609.344)},"square-us-feet":{inBaseUnits:ac(1200/3937)},acres:{inBaseUnits:.0015625*ac(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*fd(.001)},"cubic-centimeters":{inBaseUnits:1e3*fd(.01)},"cubic-decimeters":{inBaseUnits:1e3*fd(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*fd(1e3)},"cubic-inches":{inBaseUnits:1e3*fd(.0254)},"cubic-feet":{inBaseUnits:1e3*fd(.3048)},"cubic-yards":{inBaseUnits:1e3*fd(.9144)},"cubic-miles":{inBaseUnits:1e3*fd(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Ode=(()=>{const t={};for(const e in n3)for(const i in n3[e].units)t[i]=e;return t})();function Pde(t,e,i){return t*n3[i].units[e].inBaseUnits}function Rde(t,e,i){return t/n3[i].units[e].inBaseUnits}const oE=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],Fde=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function Nde(t){return t==="imperial"||t==="metric"}function Zp(t){const e=Ode[t];if(!e)throw new Error("unknown type");return e}function oD(t,e=null){return e=e||Zp(t),n3[e].baseUnit===t}function lt(t,e,i){if(e===i)return t;const r=Zp(e);if(r!==Zp(i))throw new Error("incompatible units");const n=oD(e,r)?t:Pde(t,e,r);return oD(i,r)?n:Rde(n,i,r)}function Dde(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function fWe(t){return Dde(t)}function yWe(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function jde(t,e,i){switch(i){case"metric":return dP(t,e);case"imperial":return yP(t,e);default:return i}}function Vde(t,e,i){switch(i){case"metric":return fP(t,e);case"imperial":return mP(t,e);default:return i}}function dP(t,e){const i=lt(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function fP(t,e){const i=lt(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function yP(t,e){const i=lt(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function mP(t,e){const i=lt(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function zde(t,e){const i=lt(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function Ude(t,e){const i=lt(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function Gde(t,e,i){return lt(t,e,"meters")/(i*Math.PI/180)}function sZ(t){return Lde.fromJSON(t.toLowerCase())||null}function Gl(t){if(t!=null&&!Tde(t))return 1;const e=hr(t);return e>1e5?1:e}function oZ(t){return hr(t)>=PI(t).metersPerDegree?"meters":K3(t)}function hr(t,e=Nr.metersPerDegree){return aZ(t,!0)??e}function aZ(t,e=!1){const i=(t==null?void 0:t.wkid)??null,r=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let n=null;if(i){if(nb(i))return ah.metersPerDegree;if(sb(i))return Xf.metersPerDegree;n=lm.values[lm[i]],!n&&e&&Ade.has(i)&&(n=Cde)}else r&&(cZ(r)?n=aD(rZ.exec(r),n):uZ(r)&&(n=aD(nZ.exec(r),n)));return n}function mWe(t){return u0(t)?1:hr(t)}function aD(t,e){return t!=null&&t[1]?lZ(t[1]):e}function lZ(t){return parseFloat(t.split(",")[1])}function K3(t){const e=(t==null?void 0:t.wkid)??null,i=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let r=null;if(e)r=lm.units[lm[e]];else if(i){const n=cZ(i)?rZ:uZ(i)?nZ:null;if(n){const o=n.exec(i);o!=null&&o[1]&&(r=Hde(o[1]))}}return r!=null?sZ(r):null}function gWe(t){const e=K3(t);return e!=null&&oE.includes(e)?e:null}function Bde(t){const e=oZ(t);return e!=null&&oE.includes(e)?e:null}function vWe(t){const e=K3(t);return e==null?null:Fde.get(e)}function uZ(t){return/^GEOCCS/i.test(t)}function cZ(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const qde=1e-7;function Hde(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let i=e==null?void 0:e[1];if(!i||!lm.units.includes(i)){const r=lZ(t);i=null;const n=lm.values;for(let o=0;o<n.length;++o)if(Math.abs(r-n[o])<qde){i=lm.units[o];break}}return i}function Wde(t){const e=K3(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const Jde={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},Zde={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},Kde={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Yde=dt()(Jde),Xde=dt()(Zde),bWe=dt()(Kde);var yc;let ti=yc=class extends ye{static fromJSON(t){if(!t)return null;if(t.wkid){if(t.wkid===102100)return yc.WebMercator;if(t.wkid===4326)return yc.WGS84}const e=new yc;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return Qf(this)}get isWebMercator(){return ea(this)}get isGeographic(){return u0(this)}get isWrappable(){return Ede(this)}get metersPerUnit(){return hr(this)}get unit(){return K3(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===yc.WGS84)return new yc(QJ);if(this===yc.WebMercator)return new yc(eZ);const t=new yc;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(t.wkt=this.wkt),this.wkt2!=null&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=ae(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:r}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return e==null||r?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return Ki(this,t)}toJSON(t){return this.write(void 0,t)}};ti.GCS_NAD_1927=null,ti.WGS84=null,ti.WebMercator=null,ti.PlateCarree=null,m([b({readOnly:!0})],ti.prototype,"isWGS84",null),m([b({readOnly:!0})],ti.prototype,"isWebMercator",null),m([b({readOnly:!0})],ti.prototype,"isGeographic",null),m([b({readOnly:!0})],ti.prototype,"isWrappable",null),m([b({type:zt,json:{write:!0}})],ti.prototype,"latestWkid",void 0),m([b({readOnly:!0})],ti.prototype,"metersPerUnit",null),m([b({readOnly:!0})],ti.prototype,"unit",null),m([b({type:zt,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],ti.prototype,"wkid",void 0),m([b({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],ti.prototype,"wkt",void 0),m([Le("wkt"),Le("web-scene","wkt")],ti.prototype,"writeWkt",null),m([b({type:String,json:{write:!1}})],ti.prototype,"wkt2",void 0),m([b({type:zt,json:{write:!0}})],ti.prototype,"vcsWkid",void 0),m([b({type:zt,json:{write:!0}})],ti.prototype,"latestVcsWkid",void 0),m([b()],ti.prototype,"imageCoordinateSystem",void 0),ti=yc=m([G("esri.geometry.SpatialReference")],ti),ti.prototype.toJSON.isDefaultToJSON=!0,ti.GCS_NAD_1927=new ti({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),ti.WGS84=new ti(QJ),ti.WebMercator=new ti(eZ),ti.PlateCarree=new ti(Ide),Object.freeze&&(Object.freeze(ti.GCS_NAD_1927),Object.freeze(ti.WGS84),Object.freeze(ti.WebMercator),Object.freeze(ti.PlateCarree));const Ge=ti;function Me(t,e,i){let r,n;return e===void 0||Array.isArray(e)?(n=t,i=e,r=[void 0]):(n=e,r=Array.isArray(t)?t:[t]),(o,u)=>{const p=o.constructor.prototype;r.forEach(g=>{const w=lJ(o,g,n);w.read&&typeof w.read=="object"||(w.read={}),w.read.reader=p[u],i&&(w.read.source=(w.read.source||[]).concat(i))})}}let mc=class extends ye{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Ge.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Ge)return e;if(e!=null){const r=new Ge;return r.read(e,i),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};m([b()],mc.prototype,"type",void 0),m([b({readOnly:!0})],mc.prototype,"cache",null),m([b({readOnly:!0})],mc.prototype,"extent",null),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],mc.prototype,"hasM",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],mc.prototype,"hasZ",void 0),m([b({type:Ge,json:{write:!0},value:Ge.WGS84})],mc.prototype,"spatialReference",void 0),m([Me("spatialReference")],mc.prototype,"readSpatialReference",null),mc=m([G("esri.geometry.Geometry")],mc);const td=mc,Qde=Object.prototype.toString;function efe(t){const e="__accessorMetadata__"in t?Yi(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return tfe.apply(this,i)}}function tfe(t,e,i,r){$I(t,e).cast=r}function ife(t){return(e,i)=>{$I(e,t).cast=e[i]}}function Dt(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&Qde.call(t[0])==="[object Function]"?efe(t[0]):t.length===1&&typeof t[0]=="string"?ife(t[0]):void 0}const rfe=57.29577951308232,nfe=.017453292519943;function lD(t){return t*rfe}function uD(t){return t*nfe}function _We(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Nr.radius))}function Q4(t){return t.wkid!=null||t.wkt!=null}const y9=[0,0];function aE(t,e,i,r,n){const o=t,u=n;if(u.spatialReference=i,"x"in o&&"x"in u)[u.x,u.y]=e(o.x,o.y,y9,r);else if("xmin"in o&&"xmin"in u)[u.xmin,u.ymin]=e(o.xmin,o.ymin,y9,r),[u.xmax,u.ymax]=e(o.xmax,o.ymax,y9,r);else if("paths"in o&&"paths"in u||"rings"in o&&"rings"in u){const p="paths"in o?o.paths:o.rings,g=[];let w;for(let S=0;S<p.length;S++){const T=p[S];w=[],g.push(w);for(let E=0;E<T.length;E++)w.push(e(T[E][0],T[E][1],[0,0],r)),T[E].length>2&&w[E].push(T[E][2]),T[E].length>3&&w[E].push(T[E][3])}"paths"in u?u.paths=g:u.rings=g}else if("points"in o&&"points"in u){const p=o.points,g=[];for(let w=0;w<p.length;w++)g[w]=e(p[w][0],p[w][1],[0,0],r),p[w].length>2&&g[w].push(p[w][2]),p[w].length>3&&g[w].push(p[w][3]);u.points=g}return n}function W$(t,e){const i=t&&(Q4(t)?t:t.spatialReference),r=e&&(Q4(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!r)&&(!!Ki(r,i)||ea(r)&&Qf(i)||ea(i)&&Qf(r))}function Y3(t,e){if(t==null)return null;const i=t.spatialReference,r=e&&(Q4(e)?e:e.spatialReference);return W$(i,r)?Ki(i,r)?ae(t):ea(r)?aE(t,nv,Ge.WebMercator,!1,ae(t)):Qf(r)?aE(t,RI,Ge.WGS84,!1,ae(t)):null:null}function nv(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=uD(e);return i[0]=uD(t)*Nr.radius,i[1]=Nr.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function RI(t,e,i=[0,0],r=!1){const n=lD(t/Nr.radius);return i[0]=r?n:n-360*Math.floor((n+180)/360),i[1]=lD(Math.PI/2-2*Math.atan(Math.exp(-e/Nr.radius))),i}function Dp(t,e=!1,i=ae(t)){return aE(t,nv,Ge.WebMercator,e,i)}function em(t,e=!1,i=ae(t)){return aE(t,RI,Ge.WGS84,e,i)}function hZ(t,e){const i=t.x-e.x,r=t.y-e.y,n=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(i*i+r*r+n*n)}function sfe(t){var e;return((e=pZ(t,dZ))==null?void 0:e[0])??null}function ofe(t){var e;return((e=pZ(t,dZ))==null?void 0:e[1])??null}function pZ({x:t,y:e,spatialReference:i},r=[0,0]){if(i){if(ea(i))return RI(t,e,r);if(u0(i))return r[0]=t,r[1]=e,r}return null}const dZ=[0,0];var J$;const m9=[0,0];function cD(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let so=J$=class extends td{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,r,n){let o;if(Array.isArray(t))o=t,n=e,t=o[0],e=o[1],i=o[2],r=o[3];else if(t&&typeof t=="object"){if(o=t,t=o.x!=null?o.x:o.longitude,e=o.y!=null?o.y:o.latitude,i=o.z,r=o.m,(n=o.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new Ge(n)),o.longitude!=null||o.latitude!=null){if(o.longitude==null)fe.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(o.latitude==null)fe.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&(n!=null&&n.isWebMercator)){const p=nv(o.longitude,o.latitude,m9);t=p[0],e=p[1]}}}else cD(i)?(n=i,i=null):cD(r)&&(n=r,r=null);const u={x:t,y:e};return u.x==null&&u.y!=null?fe.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):u.y==null&&u.x!=null&&fe.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(u.spatialReference=n),i!=null&&(u.z=i),r!=null&&(u.m=r),u}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return ofe(this)}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",nv(i,t,m9)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return sfe(this)}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",nv(t,e,m9)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new J$;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return J$.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:r,m:n,spatialReference:o}=this,{z:u,m:p}=t;let{x:g,y:w,spatialReference:S}=t;if(!o.equals(S))if(o.isWebMercator&&S.isWGS84)[g,w]=nv(g,w),S=o;else{if(!o.isWGS84||!S.isWebMercator)return!1;[g,w]=RI(g,w),S=o}return e===g&&i===w&&r===u&&n===p&&o.wkid===S.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=_s(this.spatialReference);if(!t)return this;let e=this.x;const[i,r]=t.valid,n=2*r;let o;return e>r?(o=Math.ceil(Math.abs(e-r)/n),e-=o*n):e<i&&(o=Math.ceil(Math.abs(e-i)/n),e+=o*n),this._set("x",e),this}distance(t){return hZ(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};m([b({readOnly:!0})],so.prototype,"cache",null),m([b({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],so.prototype,"hasM",null),m([b({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],so.prototype,"hasZ",null),m([b({type:Number})],so.prototype,"latitude",null),m([b({type:Number})],so.prototype,"longitude",null),m([b({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Dt(t=>isNaN(t)?t:Tl(t))],so.prototype,"x",void 0),m([Le("x")],so.prototype,"writeX",null),m([Me("x")],so.prototype,"readX",null),m([b({type:Number,json:{write:!0}})],so.prototype,"y",void 0),m([b({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],so.prototype,"z",void 0),m([b({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],so.prototype,"m",void 0),so=J$=m([G("esri.geometry.Point")],so),so.prototype.toJSON.isDefaultToJSON=!0;const Ke=so,g9=[0,0];function X3(t,e){return e!=null&&mo(t,e.x,e.y,e.z)}function SWe(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!ob(t,i))return!1;return!0}function afe(t,e){const{xmin:i,ymin:r,zmin:n,xmax:o,ymax:u,zmax:p}=e;return t.hasZ&&e.hasZ?mo(t,i,r,n)&&mo(t,i,u,n)&&mo(t,o,u,n)&&mo(t,o,r,n)&&mo(t,i,r,p)&&mo(t,i,u,p)&&mo(t,o,u,p)&&mo(t,o,r,p):mo(t,i,r)&&mo(t,i,u)&&mo(t,o,u)&&mo(t,o,r)}function ob(t,e){return mo(t,e[0],e[1])}function lfe(t,e){return mo(t,e[0],e[1],e[2])}function mo(t,e,i,r){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function gP(t,e){return g9[1]=e.y,g9[0]=e.x,ufe(t,g9)}function ufe(t,e){return vP(t.rings,e)}function vP(t,e){if(!t)return!1;if(cfe(t))return hD(!1,t,e);let i=!1;for(let r=0,n=t.length;r<n;r++)i=hD(i,t[r],e);return i}function cfe(t){return!Array.isArray(t[0][0])}function hD(t,e,i){const[r,n]=i;let o=t,u=0;for(let p=0,g=e.length;p<g;p++){u++,u===g&&(u=0);const[w,S]=e[p],[T,E]=e[u];(S<n&&E>=n||E<n&&S>=n)&&w+(n-S)/(E-S)*(T-w)<r&&(o=!o)}return o}function hfe(t,e){return X3(t,e)}function pfe(t,e){const i=t.hasZ&&e.hasZ;let r,n,o;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(n=e.ymin,t.ymax<n)return!1}else if(n=t.ymin,e.ymax<n)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(o=e.zmin,t.zmax<o)return!1}else if(o=t.zmin,e.zmax<o)return!1}return!0}function dfe(t,e){const{points:i,hasZ:r}=e,n=r?lfe:ob;for(const o of i)if(n(t,o))return!0;return!1}const Tm=[0,0],Em=[0,0],Im=[0,0],Mm=[0,0],ffe=[Tm,Em,Im,Mm],fZ=[[Im,Tm],[Tm,Em],[Em,Mm],[Mm,Im]];function yfe(t,e){return mfe(t,e.rings)}function mfe(t,e){Tm[0]=t.xmin,Tm[1]=t.ymax,Em[0]=t.xmax,Em[1]=t.ymax,Im[0]=t.xmin,Im[1]=t.ymin,Mm[0]=t.xmax,Mm[1]=t.ymin;for(const i of ffe)if(vP(e,i))return!0;for(const i of e){if(!i.length)continue;let r=i[0];if(ob(t,r))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(ob(t,o)||yZ(r,o,fZ))return!0;r=o}}return!1}function gfe(t,e){Tm[0]=t.xmin,Tm[1]=t.ymax,Em[0]=t.xmax,Em[1]=t.ymax,Im[0]=t.xmin,Im[1]=t.ymin,Mm[0]=t.xmax,Mm[1]=t.ymin;const i=e.paths;for(const r of i){if(!i.length)continue;let n=r[0];if(ob(t,n))return!0;for(let o=1;o<r.length;o++){const u=r[o];if(ob(t,u)||yZ(n,u,fZ))return!0;n=u}}return!1}const Kn=[0,0];function vfe(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const o=i[n],u=i[n+1];for(let p=e+1;p<t.length;p++)for(let g=0;g<t[p].length-1;g++){const w=t[p][g],S=t[p][g+1];if(eC(o,u,w,S,Kn)&&!(Kn[0]===o[0]&&Kn[1]===o[1]||Kn[0]===w[0]&&Kn[1]===w[1]||Kn[0]===u[0]&&Kn[1]===u[1]||Kn[0]===S[0]&&Kn[1]===S[1]))return!0}}const r=i.length;if(!(r<=4))for(let n=0;n<r-3;n++){let o=r-1;n===0&&(o=r-2);const u=i[n],p=i[n+1];for(let g=n+2;g<o;g++){const w=i[g],S=i[g+1];if(eC(u,p,w,S,Kn)&&!(Kn[0]===u[0]&&Kn[1]===u[1]||Kn[0]===w[0]&&Kn[1]===w[1]||Kn[0]===p[0]&&Kn[1]===p[1]||Kn[0]===S[0]&&Kn[1]===S[1]))return!0}}}return!1}function yZ(t,e,i){for(let r=0;r<i.length;r++)if(eC(t,e,i[r][0],i[r][1]))return!0;return!1}function eC(t,e,i,r,n){const[o,u]=t,[p,g]=e,[w,S]=i,[T,E]=r,C=T-w,L=o-w,R=p-o,F=E-S,V=u-S,U=g-u,W=F*R-C*U;if(W===0)return!1;const H=(C*V-F*L)/W,J=(R*V-U*L)/W;return H>=0&&H<=1&&J>=0&&J<=1&&(n&&(n[0]=o+H*(p-o),n[1]=u+H*(g-u)),!0)}function bfe(t){switch(t){case"esriGeometryEnvelope":case"extent":return pfe;case"esriGeometryMultipoint":case"multipoint":return dfe;case"esriGeometryPoint":case"point":return hfe;case"esriGeometryPolygon":case"polygon":return yfe;case"esriGeometryPolyline":case"polyline":return gfe}}var il;function wfe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function yd(t,e,i){return e==null?i:i==null?e:t(e,i)}let Rn=il=class extends td{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,r,n){return wfe(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Ge.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:r,spatialReference:n??Ge.WGS84}}static fromBounds(t,e){return new il({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new il({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Ke({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new il;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&W$(e,i)&&(t=e.isWebMercator?Dp(t):em(t,!0)),t.type==="point"?X3(this,t):t.type==="extent"&&afe(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&W$(e,i)&&(t=e.isWebMercator?Dp(t):em(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,r=this.height*e;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const n=(this.zmax-this.zmin)*e;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*e;this.mmin+=n,this.mmax-=n}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!Ki(e,i)&&W$(e,i)&&(t=e.isWebMercator?Dp(t):em(t,!0)),bfe(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=yd(Math.min,this.zmin,t.zmin),this.zmax=yd(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=yd(Math.min,this.mmin,t.mmin),this.mmax=yd(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=yd(Math.max,this.zmin,t.zmin),this.zmax=yd(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=yd(Math.max,this.mmin,t.mmin),this.mmax=yd(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=_s(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const r=e.isWebMercator?em(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(r.x=v9(r.x,t).x),this.spatialReference=new Ge(Xu((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[i,r]=t.valid,n=this.xmin,o=this.xmax;return n>=i&&n<=r&&o>=i&&o<=r||(e=this.center),e}_normalize(t,e,i){const r=this.spatialReference;if(!r)return this;const n=i??_s(r);if(n==null)return this;const o=this._getParts(n).map(g=>g.extent);if(o.length<2)return o[0]||this;if(o.length>2)return t?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(t)return this._shiftCM(n);if(e)return o;let u=!0,p=!0;return o.forEach(g=>{g.hasZ||(u=!1),g.hasM||(p=!1)}),{rings:o.map(g=>{const w=[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]];if(u){const S=(g.zmax-g.zmin)/2;for(let T=0;T<w.length;T++)w[T].push(S)}if(p){const S=(g.mmax-g.mmin)/2;for(let T=0;T<w.length;T++)w[T].push(S)}return w}),hasZ:u,hasM:p,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:n,ymax:o,spatialReference:u}=this,p=this.width,g=this.xmin,w=this.xmax;let S;t=t||_s(u);const[T,E]=t.valid;S=v9(this.xmin,t);const C=S.x,L=S.frameId;S=v9(this.xmax,t);const R=S.x,F=S.frameId,V=C===R&&p>0;if(p>2*E){const U=new il(g<w?C:R,n,E,o,u),W=new il(T,n,g<w?R:C,o,u),H=new il(0,n,E,o,u),J=new il(T,n,0,o,u),X=[],te=[];U.contains(H)&&X.push(L),U.contains(J)&&te.push(L),W.contains(H)&&X.push(F),W.contains(J)&&te.push(F);for(let oe=L+1;oe<F;oe++)X.push(oe),te.push(oe);e.push({extent:U,frameIds:[L]},{extent:W,frameIds:[F]},{extent:H,frameIds:X},{extent:J,frameIds:te})}else C>R||V?e.push({extent:new il(C,n,E,o,u),frameIds:[L]},{extent:new il(T,n,R,o,u),frameIds:[F]}):e.push({extent:new il(C,n,R,o,u),frameIds:[L]});this.cache._parts=e}const i=this.hasZ,r=this.hasM;if(i||r){const n={};i&&(n.zmin=this.zmin,n.zmax=this.zmax),r&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let o=0;o<e.length;o++)e[o].extent.set(n)}return e}};function v9(t,e){const[i,r]=e.valid,n=2*r;let o,u=0;return t>r?(o=Math.ceil(Math.abs(t-r)/n),t-=o*n,u=o):t<i&&(o=Math.ceil(Math.abs(t-i)/n),t+=o*n,u=-o),{x:t,frameId:u}}m([b({readOnly:!0})],Rn.prototype,"cache",null),m([b({readOnly:!0})],Rn.prototype,"center",null),m([b({readOnly:!0})],Rn.prototype,"extent",null),m([b({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Rn.prototype,"hasM",null),m([b({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Rn.prototype,"hasZ",null),m([b({readOnly:!0})],Rn.prototype,"height",null),m([b({readOnly:!0})],Rn.prototype,"width",null),m([b({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Rn.prototype,"xmin",void 0),m([b({type:Number,json:{write:!0}})],Rn.prototype,"ymin",void 0),m([b({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Rn.prototype,"mmin",void 0),m([b({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Rn.prototype,"zmin",void 0),m([b({type:Number,json:{write:!0}})],Rn.prototype,"xmax",void 0),m([b({type:Number,json:{write:!0}})],Rn.prototype,"ymax",void 0),m([b({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Rn.prototype,"mmax",void 0),m([b({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Rn.prototype,"zmax",void 0),Rn=il=m([G("esri.geometry.Extent")],Rn),Rn.prototype.toJSON.isDefaultToJSON=!0;const jt=Rn;let mZ,b2;var cW,hW;const _fe=((cW=globalThis.esriConfig)==null?void 0:cW.locale)??((hW=globalThis.dojoConfig)==null?void 0:hW.locale);function gZ(){var t;return _fe??((t=globalThis.navigator)==null?void 0:t.language)??"en"}function Ss(){return b2===void 0&&(b2=gZ()),b2}function Sfe(t){mZ=t||void 0,bZ()}function vZ(t=Ss()){const e=/^([a-zA-Z]{2,3})(?:[_-]\w+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const Z$=[];function FI(t){return Z$.push(t),We(()=>Z$.splice(Z$.indexOf(t),1))}const K$=[];function bP(t){return K$.push(t),We(()=>K$.splice(K$.indexOf(t),1))}function bZ(){const t=mZ??gZ();b2!==t&&([...K$].forEach(e=>e(t)),b2=t,[...Z$].forEach(e=>e(t)))}var pW;(pW=globalThis.addEventListener)==null||pW.call(globalThis,"languagechange",bZ);let nx;function xfe(t){return nx&&!nx.destroyed||(nx=t()),nx}var tC;const $fe=new et({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let rl=tC=class extends Te{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new tC({categories:this.categories?ae(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(u=>Array.isArray(u)?JSON.stringify(u):u));let r="";if(this.extent){const u=Y3(this.extent,Ge.WGS84);u!=null&&(r=`${u.xmin},${u.ymin},${u.xmax},${u.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const o={categories:i,bbox:r,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(o.sortField=this.sortField.split(",").map(u=>$fe.toJSON(u.trim())).join(","),o.sortOrder=this.sortOrder),{query:{...e,...o}}}};m([b()],rl.prototype,"categories",void 0),m([b()],rl.prototype,"disableExtraQuery",void 0),m([b({type:jt})],rl.prototype,"extent",void 0),m([b()],rl.prototype,"filter",void 0),m([b()],rl.prototype,"num",void 0),m([b()],rl.prototype,"query",void 0),m([b()],rl.prototype,"sortField",void 0),m([b()],rl.prototype,"sortOrder",null),m([b()],rl.prototype,"start",void 0),rl=tC=m([G("esri.portal.PortalQueryParams")],rl);const Ml=rl;var iC;let yn=iC=class extends ye{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var i;const t=this.url,e=this.thumbnail;return t&&e&&this.portal?(i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const i=e.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):i})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new re("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new iC({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=Yi(Ml,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Ml,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Ml,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then(r=>{const n=r.contentCategorySetsGroupQuery;if(n){const o=new Ml({disableExtraQuery:!0,num:1,query:n});return i.queryGroups(o,e)}throw new re("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const n=r.results[0],o=new Ml({num:1,query:`typekeywords:"${t}"`});return n.queryItems(o,e)}throw new re("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(n=>{const o=n==null?void 0:n.categorySchema;return o!=null&&o.length?o:[]}):[])}};m([b()],yn.prototype,"access",void 0),m([b({type:Date})],yn.prototype,"created",void 0),m([b()],yn.prototype,"description",void 0),m([b()],yn.prototype,"id",void 0),m([b()],yn.prototype,"isInvitationOnly",void 0),m([b({type:Date})],yn.prototype,"modified",void 0),m([b()],yn.prototype,"owner",void 0),m([b()],yn.prototype,"portal",void 0),m([b()],yn.prototype,"snippet",void 0),m([b()],yn.prototype,"sortField",void 0),m([b()],yn.prototype,"sortOrder",void 0),m([b()],yn.prototype,"sourceJSON",void 0),m([b()],yn.prototype,"tags",void 0),m([b()],yn.prototype,"thumbnail",void 0),m([b({readOnly:!0})],yn.prototype,"thumbnailUrl",null),m([b()],yn.prototype,"title",void 0),m([b({readOnly:!0})],yn.prototype,"url",null),yn=iC=m([G("esri.portal.PortalGroup")],yn);const rC=yn;let V0=class extends Te{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};m([b()],V0.prototype,"nextQueryParams",void 0),m([b()],V0.prototype,"queryParams",void 0),m([b()],V0.prototype,"results",void 0),m([b()],V0.prototype,"total",void 0),V0=m([G("esri.portal.PortalQueryResult")],V0);const Tfe=V0;let zh=class extends ye{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var i;const e=(i=this.portal)==null?void 0:i.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new re("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};m([b({type:Date})],zh.prototype,"created",void 0),m([b()],zh.prototype,"id",void 0),m([b()],zh.prototype,"portal",void 0),m([b()],zh.prototype,"title",void 0),m([b({readOnly:!0})],zh.prototype,"url",null),m([b()],zh.prototype,"username",void 0),zh=m([G("esri.portal.PortalFolder")],zh);const Efe=zh;var nC;let tr=nC=class extends ye{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t==null?void 0:t.data,r=t==null?void 0:t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),i!=null&&(typeof i=="string"?n.query.text=i:typeof i=="object"&&(n.query.text=JSON.stringify(i))));let o=this.userContentUrl;return r&&(o+="/"+(typeof r=="string"?r:r.id)),this.portal.request(o+"/addItem",n).then(u=>(e.id=u.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.concat();const i=this.userContentUrl+"/deleteItems",r=[],n=t.map(o=>o.id);if(n.length){const o={method:"post",query:{items:n.join(","),permanentDelete:e}},u=await this.portal.request(i,o);for(const p of u.results){const g=t.find(T=>p.itemId===T.id),w=p.success;let S=null;w?(g.id=null,g.portal=null):p.error&&(S=new re("portal:delete-item-failed",p.error.message,p.error)),r.push({item:g,success:w,error:S})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(r=>{const n=Efe.fromJSON(r);return n.portal=this.portal,n}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const r=rC.fromJSON(i);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??(t={});let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await ie(()=>Promise.resolve().then(()=>SZ),void 0),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},n=await this.portal.request(e,{query:r});let o;return n!=null&&n.items?(o=n.items.map(u=>{const p=i.fromJSON(u);return p.portal=this.portal,p}),await Promise.all(o.map(u=>u.load())),{items:o,nextStart:n.nextStart,total:n.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new rC({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new re("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new re("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new nC({sourceJSON:t});return e.read(t),e}};m([b()],tr.prototype,"access",void 0),m([b({type:Date})],tr.prototype,"created",void 0),m([b()],tr.prototype,"culture",void 0),m([b()],tr.prototype,"description",void 0),m([b()],tr.prototype,"email",void 0),m([b()],tr.prototype,"favGroupId",void 0),m([b()],tr.prototype,"fullName",void 0),m([b({type:Date})],tr.prototype,"modified",void 0),m([b()],tr.prototype,"orgId",void 0),m([b()],tr.prototype,"portal",void 0),m([b()],tr.prototype,"preferredView",void 0),m([b()],tr.prototype,"privileges",void 0),m([b()],tr.prototype,"region",void 0),m([b()],tr.prototype,"role",void 0),m([b()],tr.prototype,"roleId",void 0),m([b()],tr.prototype,"sourceJSON",void 0),m([b()],tr.prototype,"thumbnail",void 0),m([b({readOnly:!0})],tr.prototype,"thumbnailUrl",null),m([b()],tr.prototype,"units",void 0),m([b({readOnly:!0})],tr.prototype,"userContentUrl",null),m([b({readOnly:!0})],tr.prototype,"url",null),m([b()],tr.prototype,"username",void 0),m([b()],tr.prototype,"userLicenseTypeId",void 0),m([b()],tr.prototype,"userType",void 0),tr=nC=m([G("esri.portal.PortalUser")],tr);const wP=tr;var ya;let sx;const pD={PortalGroup:()=>Promise.resolve({default:rC}),PortalItem:()=>ie(()=>Promise.resolve().then(()=>SZ),void 0),PortalUser:()=>Promise.resolve({default:wP})};let Re=ya=class extends Um(Qo){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Ct.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){dD.unregister(this),this.defaultBasemap=ot(this.defaultBasemap),this.defaultDevBasemap=ot(this.defaultDevBasemap),this.defaultVectorBasemap=ot(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Vi(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)Ct.request.trustedServers.includes(e)||Ct.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){var i;const t=(i=this.user)==null?void 0:i.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=wP.fromJSON(t),e.portal=this),e}load(t){const e=ie(()=>Promise.resolve().then(()=>e0e),void 0).then(({default:i})=>{At(t),sx=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(i=>{var r;if(rt){const n=rt;this.credential=n.findCredential(this.restUrl),this.credential||this.authMode!==ya.AUTH_MODE_AUTO&&this.authMode!==ya.AUTH_MODE_NO_PROMPT||((r=this._esriIdCredentialCreateHandle)==null||r.remove(),this._esriIdCredentialCreateHandle=n.on("credential-create",Ife(new WeakRef(this))),dD.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await ie(async()=>{const{default:i}=await import("./ElevationLayer-Bf00Sxit.js");return{default:i}},__vite__mapDeps([0,1,2,3,4]))).default;return t?t.map(i=>new e({id:i.id,url:i.url})):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const r=await this._fetchBasemaps3D(t,e);i.unshift(...r)}return i}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):Xo(t)?Promise.reject(ni()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new Ml({num:100,sortField:"title"});if(e!=null&&e.length){const r=[];for(const n of e)r.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=r.join(" OR "),this.queryGroups(i,t).then(n=>n.results)}return Xo(t)?Promise.reject(ni()):Promise.resolve([])}fetchRegions(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||Ss();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||Ss();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return xfe(()=>new ya)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const r=this.restUrl+"/portals/self",n={authMode:t,query:{culture:Ss().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this.request(r,n)}queryPortal(t,e,i,r){const n=Yi(Ml,e),o=u=>this.request(this.restUrl+t,{...n.toRequestOptions(this),...r}).then(p=>{const g=n.clone();return g.start=p.nextStart,new Tfe({nextQueryParams:g,queryParams:n,total:p.total,results:ya._resultsToTypedArray(u,{portal:this},p,r)})}).then(p=>Promise.all(p.results.map(g=>typeof g.when=="function"?g.when():p)).then(()=>p,g=>(Ra(g),p)));return i&&pD[i]?pD[i]().then(({default:u})=>(At(r),o(u))):o()}signIn(){if(this.authMode===ya.AUTH_MODE_ANONYMOUS||this.authMode===ya.AUTH_MODE_NO_PROMPT&&!rt)return Promise.reject(new re("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return rt?rt.getCredential(this.restUrl,{prompt:this.authMode!==ya.AUTH_MODE_NO_PROMPT}).then(e=>t(e)):t(this.credential)}normalizeUrl(t){var i;const e=(i=this.credential)==null?void 0:i.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then(r=>{const n=ya._resultsToTypedArray(i,{portal:this},r);return Promise.all(n.map(o=>typeof o.when=="function"?o.when():r)).then(()=>n,()=>n)})}request(t,e={}){const i={f:"json",...e.query},{authMode:r=this.authMode===ya.AUTH_MODE_ANONYMOUS||this.authMode===ya.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:u="auto",responseType:p="json",signal:g}=e,w={authMode:r,body:n,cacheBust:o,method:u,query:i,responseType:p,timeout:0,signal:g};return e.withCredentials&&(w.withCredentials=!0),nt(this._normalizeSSL(t),w).then(S=>S.data)}toJSON(){throw new re("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new ya({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new re("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new Ml;i.query=t||(Ct.apiKey&&nP(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const r=await this.queryGroups(i,e);if(!r.total)return[];const n=r.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,e);return o.total?o.results.filter(u=>u.type==="Web Map").map(u=>new sx({portalItem:u})):[]}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const r=new Ml({query:i,disableExtraQuery:!0}),n=await this.queryGroups(r,e);if(!n.total)return[];const o=n.results[0];r.num=100,r.query='type:"Web Scene"',r.sortField=o.sortField||"name",r.sortOrder=o.sortOrder||"desc";const u=await o.queryItems(r,e);return u.total?u.results.filter(p=>p.type==="Web Scene").map(p=>new sx({portalItem:p})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=sx.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,r){let n;if(i){const o=r!=null?r.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map(u=>{const p=Object.assign(t?t.fromJSON(u):u,e);return typeof p.load=="function"&&p.load(o),p}))}else n=[];return n}};Re.AUTH_MODE_ANONYMOUS="anonymous",Re.AUTH_MODE_AUTO="auto",Re.AUTH_MODE_IMMEDIATE="immediate",Re.AUTH_MODE_NO_PROMPT="no-prompt",m([b()],Re.prototype,"access",void 0),m([b()],Re.prototype,"allSSL",void 0),m([b()],Re.prototype,"authMode",void 0),m([b()],Re.prototype,"authorizedCrossOriginDomains",void 0),m([Me("authorizedCrossOriginDomains")],Re.prototype,"readAuthorizedCrossOriginDomains",null),m([b()],Re.prototype,"basemapGalleryGroupQuery",void 0),m([b({json:{name:"3DBasemapGalleryGroupQuery"}})],Re.prototype,"basemapGalleryGroupQuery3D",void 0),m([b()],Re.prototype,"bingKey",void 0),m([b()],Re.prototype,"canListApps",void 0),m([b()],Re.prototype,"canListData",void 0),m([b()],Re.prototype,"canListPreProvisionedItems",void 0),m([b()],Re.prototype,"canProvisionDirectPurchase",void 0),m([b()],Re.prototype,"canSearchPublic",void 0),m([b()],Re.prototype,"canShareBingPublic",void 0),m([b()],Re.prototype,"canSharePublic",void 0),m([b()],Re.prototype,"canSignInArcGIS",void 0),m([b()],Re.prototype,"canSignInIDP",void 0),m([b()],Re.prototype,"colorSetsGroupQuery",void 0),m([b()],Re.prototype,"commentsEnabled",void 0),m([b({type:Date})],Re.prototype,"created",void 0),m([b()],Re.prototype,"credential",void 0),m([b()],Re.prototype,"culture",void 0),m([b()],Re.prototype,"currentVersion",void 0),m([b()],Re.prototype,"customBaseUrl",void 0),m([b()],Re.prototype,"defaultBasemap",void 0),m([Me("defaultBasemap")],Re.prototype,"readDefaultBasemap",null),m([b()],Re.prototype,"defaultDevBasemap",void 0),m([Me("defaultDevBasemap")],Re.prototype,"readDefaultDevBasemap",null),m([b({type:jt})],Re.prototype,"defaultExtent",void 0),m([b()],Re.prototype,"defaultVectorBasemap",void 0),m([Me("defaultVectorBasemap")],Re.prototype,"readDefaultVectorBasemap",null),m([b()],Re.prototype,"description",void 0),m([b()],Re.prototype,"devBasemapGalleryGroupQuery",void 0),m([b()],Re.prototype,"eueiEnabled",void 0),m([b({readOnly:!0})],Re.prototype,"extraQuery",null),m([b()],Re.prototype,"featuredGroups",void 0),m([b()],Re.prototype,"featuredItemsGroupQuery",void 0),m([b()],Re.prototype,"galleryTemplatesGroupQuery",void 0),m([b()],Re.prototype,"layoutGroupQuery",void 0),m([b()],Re.prototype,"livingAtlasGroupQuery",void 0),m([b()],Re.prototype,"hasCategorySchema",void 0),m([b()],Re.prototype,"helpBase",void 0),m([b()],Re.prototype,"helperServices",void 0),m([b()],Re.prototype,"helpMap",void 0),m([b()],Re.prototype,"homePageFeaturedContent",void 0),m([b()],Re.prototype,"homePageFeaturedContentCount",void 0),m([b()],Re.prototype,"httpPort",void 0),m([b()],Re.prototype,"httpsPort",void 0),m([b()],Re.prototype,"id",void 0),m([b()],Re.prototype,"ipCntryCode",void 0),m([b({readOnly:!0})],Re.prototype,"isOrganization",null),m([b()],Re.prototype,"isPortal",void 0),m([b()],Re.prototype,"isReadOnly",void 0),m([b({readOnly:!0})],Re.prototype,"itemPageUrl",null),m([b()],Re.prototype,"layerTemplatesGroupQuery",void 0),m([b()],Re.prototype,"maxTokenExpirationMinutes",void 0),m([b({type:Date})],Re.prototype,"modified",void 0),m([b()],Re.prototype,"name",void 0),m([b()],Re.prototype,"portalHostname",void 0),m([b()],Re.prototype,"portalMode",void 0),m([b()],Re.prototype,"portalProperties",void 0),m([b()],Re.prototype,"region",void 0),m([b()],Re.prototype,"recycleBinEnabled",void 0),m([b({readOnly:!0})],Re.prototype,"restUrl",null),m([b()],Re.prototype,"rotatorPanels",void 0),m([b()],Re.prototype,"showHomePageDescription",void 0),m([b()],Re.prototype,"sourceJSON",void 0),m([b()],Re.prototype,"staticImagesUrl",void 0),m([b({json:{name:"2DStylesGroupQuery"}})],Re.prototype,"stylesGroupQuery2d",void 0),m([b({json:{name:"stylesGroupQuery"}})],Re.prototype,"stylesGroupQuery3d",void 0),m([b()],Re.prototype,"supportsHostedServices",void 0),m([b()],Re.prototype,"symbolSetsGroupQuery",void 0),m([b()],Re.prototype,"templatesGroupQuery",void 0),m([b()],Re.prototype,"thumbnail",void 0),m([b({readOnly:!0})],Re.prototype,"thumbnailUrl",null),m([b()],Re.prototype,"units",void 0),m([b()],Re.prototype,"url",void 0),m([b()],Re.prototype,"urlKey",void 0),m([Me("urlKey")],Re.prototype,"readUrlKey",null),m([b()],Re.prototype,"user",void 0),m([Me("user")],Re.prototype,"readUser",null),m([b()],Re.prototype,"use3dBasemaps",void 0),m([b()],Re.prototype,"useStandardizedQuery",void 0),m([b()],Re.prototype,"useVectorBasemaps",void 0),m([b()],Re.prototype,"vectorBasemapGalleryGroupQuery",void 0),Re=ya=m([G("esri.portal.Portal")],Re);const wr=Re,dD=new FinalizationRegistry(t=>{t.remove()});function Ife(t){const e=rt;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let Uh=class extends Te{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e!=null&&e.portalItem&&e.path?{...e,path:fD(e.path,e.portalItem)}:e}set path(e){e!=null&&ja(e)?fe.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return fD(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",i){const r=this.cdnUrl;if(r==null)throw new re("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey},signal:i==null?void 0:i.signal})}async update(e,i){const{addOrUpdateResources:r}=await ie(()=>import("./resourceUtils-qzCWpzM5.js"),[]);return await r(this.portalItem,[{resource:this,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"update",i),this}hasPath(){return this.path!=null}};function fD(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&ja(t)&&(t=Q7(t,e.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}m([b()],Uh.prototype,"portalItem",void 0),m([b({type:String,value:null})],Uh.prototype,"path",null),m([Dt("path")],Uh.prototype,"_castPath",null),m([b({type:String,readOnly:!0})],Uh.prototype,"url",null),m([b({type:String,readOnly:!0})],Uh.prototype,"cdnUrl",null),m([b({type:String,readOnly:!0})],Uh.prototype,"itemRelativeUrl",null),Uh=m([G("esri.portal.PortalItemResource")],Uh);const Mfe=Uh;let e_=class extends Te{constructor(e){super(e),this.created=null,this.rating=null}};m([b()],e_.prototype,"created",void 0),m([b()],e_.prototype,"rating",void 0),e_=m([G("esri.portal.PortalRating")],e_);const b9=e_;function t0(t,e){var r;const i=(r=e==null?void 0:e.url)==null?void 0:r.path;if(t&&i&&(t=Wo(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const n=Q7(t,e.portalItem.itemUrl);n!=null&&kfe.test(n)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(n).path)}return(t=sC(t,e==null?void 0:e.portal))&&NI.test(t)?SP(t):t}function Q3(t,e,i=s3.YES){var n,o;if((t=t&&NI.test(t)?_Z(t):t)==null)return t;!ja(t)&&(e!=null&&e.blockedRelativeUrls)&&e.blockedRelativeUrls.push(t);let r=Wo(t);if(e){const u=((n=e.verifyItemRelativeUrls)==null?void 0:n.rootPath)||((o=e.url)==null?void 0:o.path);if(u){const p=sC(u,e.portal),g=sC(r,e.portal);r=Q7(g,p,p),r!=null&&r!==g&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=wZ(r,e==null?void 0:e.portal),ja(r)&&(r=ws(r)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!ja(r)&&!l0(r)&&i===s3.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function _P(t,e,i){return t0(t,i)}function km(t,e,i,r){const n=Q3(t,r);n!==void 0&&(e[i]=n)}const NI=/\/items\/([^/]+)\/resources\/(.*)/,kfe=/^\.\/resources\//;function Cfe(t){const e=(t==null?void 0:t.match(NI))??null;return(e==null?void 0:e[1])??null}function Afe(t){const e=(t==null?void 0:t.match(NI))??null;if(e==null)return null;const i=e[2],r=i.lastIndexOf("/");if(r===-1){const{path:u,extension:p}=ZN(i);return{prefix:null,filename:u,extension:p}}const{path:n,extension:o}=ZN(i.slice(r+1));return{prefix:i.slice(0,r),filename:n,extension:o}}function wZ(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?U4(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function sC(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,r=Z7();return Sm(r,`${r.scheme}://${i}`)?U4(t,e.portalHostname,i):U4(t,i,e.portalHostname)}function SP(t){if(!t)return t||null;let e=t;return e&&rt&&!rt.findCredential(e)&&(e=IJ(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function _Z(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&rt&&!rt.findCredential(e)&&(e=IJ(e)),e}var s3;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(s3||(s3={}));const IWe=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return s3},ensureMainOnlineDomain:wZ,fromCDNUrl:_Z,fromJSON:t0,itemIdFromResourceUrl:Cfe,prefixAndFilenameFromResourceUrl:Afe,read:_P,toCDNUrl:SP,toJSON:Q3,write:km},Symbol.toStringTag,{value:"Module"}));var z0;const Lfe=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),Ofe=new Set(["KML","GeoJson","CSV"]);let gt=z0=class extends Um(Qo){static from(t){return J3(z0,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return t==="Feature Service"||t==="Feature Collection"?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?i="Scene Layer":t==="Video Service"?i="Video Layer":t==="Scene Package"?i="Scene Layer Package":t==="Stream Service"?i="Feature Layer":t==="Geoprocessing Service"?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?i="GeoEnrichment Service":t==="Geocoding Service"?i="Locator":t==="Microsoft Powerpoint"?i="Microsoft PowerPoint":t==="GeoJson"?i="GeoJSON":t==="Globe Service"?i="Globe Layer":t==="Vector Tile Service"?i="Tile Layer":t==="netCDF"?i="NetCDF":t==="Map Service"?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t!=null&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?i="Big Data File Share":t==="Compact Tile Package"?i="Tile Package (tpkx)":t==="Raster function template"?i="Raster Function Template":t==="OGCFeatureServer"?i="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?i="Instant App":t==="Insights Page"?i="Insights Report":t==="Excalibur Imagery Project"?i="Excalibur Project":t==="3DTiles Service"?i="3D tiles layer":t==="3DTiles Package"&&(i="3D tiles package"),i}readExtent(t){return t&&t.length?new jt(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){var C;const t=((C=this.type)==null?void 0:C.toLowerCase())||"",e=this.typeKeywords||[],i="esri/images/portal/",r="16";let n,o=!1,u=!1,p=!1,g=!1,w=!1,S=!1,T=!1,E=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(o=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(u=e.includes("Table"),p=e.includes("Route Layer"),g=e.includes("Markup"),w=e.includes("Spatiotemporal"),S=e.includes("UtilityNetwork"),n=w&&u?"spatiotemporaltable":u?"table":p?"routelayer":g?"markup":w?"spatiotemporal":S?"utilitynetwork":o?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(w=e.includes("Spatiotemporal"),T=e.includes("Relational"),n=w||T?"mapimages":o||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):n=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?n="maps":t==="web scene"?n=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?n="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?n="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?n="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?n="datafiles":t==="360 vr experience"?n="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?n="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?n="addindesktop":t==="pdf"?n="pdf":t==="microsoft word"?n="word":t==="microsoft excel"?n="excel":t==="microsoft powerpoint"?n="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?n="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?n="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?n="layersgray":t==="analysis model"?n="analysismodel":t==="scene package"?n="scenepackage":t==="3dtiles package"?n="3dtileslayerpackage":t==="3dtiles service"?n="3dtileslayer":t==="mobile scene package"?n="mobilescenepackage":t==="tile package"||t==="compact tile package"?n="tilepackage":t==="task file"?n="taskfile":t==="report template"?n="report-template":t==="statistical data collection"?n="statisticaldatacollection":t==="insights workbook"?n="workbook":t==="insights model"?n="insightsmodel":t==="insights page"?n="insightspage":t==="insights theme"?n="insightstheme":t==="hub initiative"?n="hubinitiative":t==="hub page"?n="hubpage":t==="hub site application"?n="hubsite":t==="hub event"?n="hubevent":t==="hub project"?n="hubproject":t==="relational database connection"?n="relationaldatabaseconnection":t==="big data file share"?n="datastorecollection":t==="image collection"?n="imagecollection":t==="desktop style"?n="desktopstyle":t==="style"?n=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?n="dashboard":t==="raster function template"?n="rasterprocessingtemplate":t==="vector tile package"?n="vectortilepackage":t==="ortho mapping project"?n="orthomappingproject":t==="ortho mapping template"?n="orthomappingtemplate":t==="solution"?n="solutions":t==="geopackage"?n="geopackage":t==="deep learning package"?n="deeplearningpackage":t==="real time analytic"?n="realtimeanalytics":t==="big data analytic"?n="bigdataanalytics":t==="feed"?n="feed":t==="excalibur imagery project"?n="excaliburimageryproject":t==="notebook"?n="notebook":t==="storymap"?n="storymap":t==="survey123 add in"?n="survey123addin":t==="mission"?n="mission":t==="mission report"?n="missionreport":t==="mission template"?n="missiontemplate":t==="quickcapture project"?n="quickcaptureproject":t==="pro report"?n="proreport":t==="pro report template"?n="proreporttemplate":t==="urban model"?n="urbanmodel":t==="web experience"?n="experiencebuilder":t==="web experience template"?n="webexperiencetemplate":t==="experience builder widget"?n="experiencebuilderwidget":t==="experience builder widget package"?n="experiencebuilderwidgetpackage":t==="workflow"?n="workflow":t==="kernel gateway connection"?n="kernelgatewayconnection":t==="insights script"?n="insightsscript":t==="hub initiative template"?n="hubinitiativetemplate":t==="storymap theme"?n="storymaptheme":t==="knowledge graph"?n="knowledgegraph":t==="knowledge graph layer"?n="knowledgegraphlayer":t==="knowledge studio project"?n="knowledgestudio":t==="native application"?n="nativeapp":t==="native application installer"?n="nativeappinstaller":t==="web link chart"?n="linkchart":t==="knowledge graph web investigation"?n="investigation":t==="ogcfeatureserver"?n="features":t==="pro project"?n="proproject":t==="insights workbook package"?n="insightsworkbookpackage":t==="apache parquet"?n="apacheparquet":t==="notebook code snippet library"?n="notebookcodesnippets":t==="suitability model"?n="suitabilitymodel":t==="esri classifier definition"?n="classifierdefinition":t==="esri classification schema"?n="classificationschema":t==="insights data engineering workbook"?n="dataengineeringworkbook":t==="insights data engineering model"?n="dataengineeringmodel":t==="deep learning studio project"?n="deeplearningproject":t==="discussion"?n="discussion":t==="allsource project"?n="allsourceproject":t==="api key"?n="apikey":t==="data pipeline"?n="datapipelines":t==="group layer"?(E=e.includes("Map"),n=E?"layergroup2d":"layergroup"):n=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":"maps",n?qt(i+n+r+".png"):null}get isLayer(){return this.type!=null&&Lfe.has(this.type)}get itemCdnUrl(){return SP(this.itemUrl)}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const t=this.itemUrl,e=this.thumbnail;return t&&e?((i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){var i,r,n;const t=(i=this.portal)==null?void 0:i.restUrl;if(!t)return null;const e=this.owner||((n=(r=this.portal)==null?void 0:r.user)==null?void 0:n.username);return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=wr.getDefault()),i=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof b9&&(t=t.rating),t==null||isNaN(t)||typeof t!="number"||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new b9({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:ae(this.applicationProxies),avgRating:this.avgRating,categories:ae(this.categories),created:ae(this.created),culture:this.culture,description:this.description,extent:ae(this.extent),groupCategories:ae(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:ae(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:ae(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:ae(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:ae(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new z0({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var i;const t=this.toJSON();for(const r of["tags","typeKeywords","categories"])t[r]=(i=t[r])==null?void 0:i.join(", ");const{extent:e}=t;return e&&(t.extent=JSON.stringify(e)),t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new b9(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},z0)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t==null?void 0:t.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?i.query.text=e:typeof e=="object"&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new re("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new re("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await e.signIn();const{copyResources:r,folder:n,tags:o,title:u}=t||{},p={method:"post",query:{copyPrivateResources:r==="all",folder:typeof n=="string"?n:n==null?void 0:n.id,includeResources:!!r,tags:o==null?void 0:o.join(","),title:u}},{itemId:g}=await e.request(`${i}/copy`,p);return new z0({id:g,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,i=t.filename,r={method:"post"};if(typeof e=="string")l0(e)?r.query={data:e}:r.query={url:Wo(e)},i!=null&&(r.query.filename=i);else{const n=new FormData;i!=null?n.append("file",e,i):n.append("file",e),r.body=n}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new re("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await ie(()=>import("./resourceUtils-qzCWpzM5.js"),[]);return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResources:r}=await ie(()=>import("./resourceUtils-qzCWpzM5.js"),[]);return t.portalItem=this,await r(this,[{resource:t,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"add",i),t}async removeResource(t,e){const{removeResource:i}=await ie(()=>import("./resourceUtils-qzCWpzM5.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new re("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await ie(()=>import("./resourceUtils-qzCWpzM5.js"),[]);return e(this,t)}resourceFromPath(t){return new Mfe({portalItem:this,path:t})}toJSON(){var i,r;const t=this.extent,e={accessInformation:this.accessInformation,categories:ae(this.categories),created:(i=this.created)==null?void 0:i.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(r=this.modified)==null?void 0:r.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:ae(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:ae(this.typeKeywords),url:this.url};return sce(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new z0({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};m([b({type:["private","shared","org","public"]})],gt.prototype,"access",void 0),m([b()],gt.prototype,"accessInformation",void 0),m([b({type:String})],gt.prototype,"apiKey",void 0),m([b({json:{read:{source:"appProxies"}}})],gt.prototype,"applicationProxies",void 0),m([b()],gt.prototype,"avgRating",void 0),m([b()],gt.prototype,"categories",void 0),m([b({type:Date})],gt.prototype,"created",void 0),m([b()],gt.prototype,"culture",void 0),m([b()],gt.prototype,"description",void 0),m([b({readOnly:!0})],gt.prototype,"displayName",null),m([b({type:jt})],gt.prototype,"extent",void 0),m([Me("extent")],gt.prototype,"readExtent",null),m([b()],gt.prototype,"groupCategories",void 0),m([b({readOnly:!0})],gt.prototype,"iconUrl",null),m([b()],gt.prototype,"id",void 0),m([b({readOnly:!0})],gt.prototype,"isLayer",null),m([b({type:Boolean,readOnly:!0})],gt.prototype,"isOrgItem",void 0),m([b()],gt.prototype,"itemControl",void 0),m([b({readOnly:!0})],gt.prototype,"itemPageUrl",null),m([b({readOnly:!0})],gt.prototype,"itemUrl",null),m([b()],gt.prototype,"licenseInfo",void 0),m([b({type:Date})],gt.prototype,"modified",void 0),m([b()],gt.prototype,"name",void 0),m([b()],gt.prototype,"numComments",void 0),m([b()],gt.prototype,"numRatings",void 0),m([b()],gt.prototype,"numViews",void 0),m([b()],gt.prototype,"owner",void 0),m([b()],gt.prototype,"ownerFolder",void 0),m([b({type:wr})],gt.prototype,"portal",void 0),m([b()],gt.prototype,"screenshots",void 0),m([b()],gt.prototype,"size",void 0),m([b()],gt.prototype,"snippet",void 0),m([b()],gt.prototype,"sourceJSON",void 0),m([b({type:String})],gt.prototype,"sourceUrl",void 0),m([b({type:String})],gt.prototype,"spatialReference",void 0),m([b()],gt.prototype,"tags",void 0),m([b()],gt.prototype,"thumbnail",void 0),m([b({readOnly:!0})],gt.prototype,"thumbnailUrl",null),m([b()],gt.prototype,"title",void 0),m([b()],gt.prototype,"type",void 0),m([b()],gt.prototype,"typeKeywords",void 0),m([b({type:String,json:{read(t,e){var i;if(Ofe.has(e.type)){const r=(i=this.portal)==null?void 0:i.restUrl;t||(t=r&&this.id?`${r}/content/items/${this.id}/data`:null)}return t}}})],gt.prototype,"url",void 0),m([b({readOnly:!0})],gt.prototype,"userItemUrl",null),gt=z0=m([G("esri.portal.PortalItem")],gt);const Nl=gt,SZ=Object.freeze(Object.defineProperty({__proto__:null,default:Nl},Symbol.toStringTag,{value:"Module"})),yD=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,Pfe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function mD(t){return t in Pfe}const t_=[],_v=new Map;function gD(t){for(const e of _v.keys())xZ(t.pattern,e)&&_v.delete(e)}function Rfe(t){return t_.includes(t)||(gD(t),t_.unshift(t)),We(()=>{const e=t_.indexOf(t);e>-1&&(t_.splice(e,1),gD(t))})}async function DI(t){const e=Ss();_v.has(t)||_v.set(t,Nfe(t,e));const i=_v.get(t);return i&&await Dfe.add(i),i}function Ffe(t){if(!yD.test(t))return null;const e=yD.exec(t);if(e===null)return null;const[,i,r]=e,n=i+(r?"-"+r.toUpperCase():"");return mD(n)?n:mD(i)?i:null}async function Nfe(t,e){const i=[];for(const r of t_)if(xZ(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(n){i.push(n)}throw i.length?new re("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new re("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function xZ(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}bP(()=>{_v.clear()});const Dfe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=os())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function jfe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,i=await DI("esri/t9n/basemaps");return i[t]||i[e]}const ab={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return qt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return qt("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return qt("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return qt("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return qt("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return qt("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return qt("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return qt("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return qt("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return qt("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return qt("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return qt("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return qt("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return qt("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return qt("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return qt("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}},Vfe=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let Cd=class extends Te{constructor(e){super(e),this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const e=Ss().toLowerCase();switch(e){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const i=vZ(e);return i==="pt"?"pt-BR":i&&Vfe.has(i)?i:"global"}};m([b()],Cd.prototype,"id",void 0),m([b()],Cd.prototype,"language",void 0),m([b()],Cd.prototype,"places",void 0),m([b()],Cd.prototype,"serviceUrl",void 0),m([b()],Cd.prototype,"worldview",void 0),Cd=m([G("esri.support.BasemapStyle")],Cd);const zfe=Cd;function w2(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function sv(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function U0(t){return(t==null?void 0:t.type)==="subtype-sublayer"}const kWe={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function $Z(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function Ufe(t){return t==="integrated-mesh"||t==="integrated-mesh-3dtiles"}function jI(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function CWe(t){var e;return((t==null?void 0:t.type)==="feature"||(t==null?void 0:t.type)==="subtype-group")&&((e=t.source)==null?void 0:e.type)==="feature-layer"}async function xP(t,e){const i=rt==null?void 0:rt.findServerInfo(t);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const n=`${t.substring(0,r)}/rest/info`,o=e!=null?e.signal:null,{data:u}=await nt(n,{query:{f:"json"},responseType:"json",signal:o});return(u==null?void 0:u.owningSystemUrl)||null}function Gfe(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function um(t){return t!=null&&typeof t=="object"&&"isTable"in t&&!!t.isTable}function Cm(t){return Gfe(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function Bfe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function TZ(t){return!!Bfe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const qfe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),Hfe=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function Wfe(t){return t.layerContainerType==="basemap"?qfe:t.layerContainerType==="operational-layers"?Hfe:null}function Jfe(t,e){if(e.restrictedWebMapWriting){const i=Wfe(e);return i==null||i.has(t.type)&&!jI(t)}return!0}function Zfe(t,e){var i;if(e)if(jI(t)){const r=G3("featureCollection.layers",e),n=(i=r==null?void 0:r[0])==null?void 0:i.layerDefinition;n&&vD(t,n)}else t.type!=="group"&&vD(t,e)}function vD(t,e){"maxScale"in t&&(e.maxScale=W5(t.maxScale)??void 0),"minScale"in t&&(e.minScale=W5(t.minScale)??void 0)}function Kfe(t,e){if(Zfe(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=W5(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(jI(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function oC(t,e,i){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return i!=null&&i.messages&&i.messages.push(new re("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(jI(t)&&!t.isTable)e=t.resourceInfo;else if(Jfe(t,i)){const r={};return t.write(r,i)?r:null}return e!=null&&Kfe(t,e=ae(e)),e}var i_;let Yfe=0,ma=i_=class extends Um(Qo){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+Yfe++,this.baseLayers=new Ie,this.referenceLayers=new Ie;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&fe.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.addHandles([this.baseLayers.on("after-add",r=>e(r.item)),this.referenceLayers.on("after-add",r=>e(r.item)),this.baseLayers.on("after-remove",r=>i(r.item)),this.referenceLayers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{fe.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const i of t)i.destroy();const e=this.referenceLayers.toArray();for(const i of e)i.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=ot(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",Jp(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const r=[];t&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{const o=oC(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&r.push(o)}),this.referenceLayers.forEach(n=>{const o=oC(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&(n.type!=="scene"&&(o.isReference=!0),r.push(o))})),e.baseMapLayers=r}set referenceLayers(t){this._set("referenceLayers",Jp(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return lP(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>O5(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>O5(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new i_({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){var i;return t=t||{},e!=null&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&((i=this.resourceInfo)!=null&&i.data.baseMapLayers)&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const n=ae(r);return n.url&&hh(n.url)&&(n.url=`https:${n.url}`),n.templateUrl&&hh(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`),n})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i,style:r}=this;At(t);const n=[];if(e){const o=e.context?e.context.url:null;if(n.push(this._loadLayersFromJSON(e.data,o,t)),e.data.id&&!e.data.title){const u=e.data.id;n.push(jfe(u).then(p=>{p&&this.read({title:p},e.context)}))}}else i?n.push(this._loadFromItem(i,t)):r&&n.push(this._loadFromStylesService(r,t));await Promise.all(n)}async _loadLayersFromJSON(t,e,i){var g,w;const r=(g=this.resourceInfo)==null?void 0:g.context,n=((w=this.portalItem)==null?void 0:w.portal)||(r==null?void 0:r.portal)||null,o=Qfe[(r==null?void 0:r.origin)||""]??"web-map",{populateOperationalLayers:u}=await ie(async()=>{const{populateOperationalLayers:S}=await import("./layersCreator-DYPEGeb7.js");return{populateOperationalLayers:S}},__vite__mapDeps([5,6,7,8])),p=[];if(At(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const S={context:{...r,origin:o,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},T=L=>o==="web-scene"&&L.layerType==="ArcGISSceneServiceLayer"||L.isReference,E=u(this.baseLayers,t.baseMapLayers.filter(L=>!T(L)),S);p.push(E);const C=u(this.referenceLayers,t.baseMapLayers.filter(T),S);p.push(C)}await Promise.allSettled(p)}async _loadFromItem(t,e){const i=await t.load(e),r=await i.fetchData("json",e),n=Zr(t.itemUrl??"");return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:Xfe[t.type||""]??"web-map",portal:t.portal||wr.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||wr.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}async _loadFromStylesService(t,e){const i=`${t.serviceUrl}/${t.id}`,r=(await nt(i,{query:{language:t.getLanguageParamValue(),places:t.places,worldview:t.worldview},signal:e==null?void 0:e.signal})).data,n=Zr(i);return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:"web-map",url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}static fromId(t){const e=ab[t];return e?e.itemId?new i_({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):i_.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};m([b({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ie}},writer(t,e,i,r){this._writeBaseLayers(t,e,r)}}}}}})],ma.prototype,"baseLayers",null),m([b({type:String,json:{origins:{"web-scene":{write:!0}}}})],ma.prototype,"id",void 0),m([b({type:Nl})],ma.prototype,"portalItem",void 0),m([b()],ma.prototype,"referenceLayers",null),m([b({readOnly:!0})],ma.prototype,"resourceInfo",void 0),m([b({type:Ge})],ma.prototype,"spatialReference",void 0),m([b({type:zfe})],ma.prototype,"style",void 0),m([b()],ma.prototype,"thumbnailUrl",void 0),m([b({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],ma.prototype,"title",void 0),m([Le("title")],ma.prototype,"writeTitle",null),ma=i_=m([G("esri.Basemap")],ma);const Xfe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},Qfe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},_2=ma,e0e=Object.freeze(Object.defineProperty({__proto__:null,default:_2},Symbol.toStringTag,{value:"Module"})),lE={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function EZ(t){return!!lE[t]||!!lE[t.toLowerCase()]}function $P(t){return lE[t]??lE[t.toLowerCase()]}function t0e(t){return[...$P(t)]}function w9(t,e,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?t+(e-t)*r:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function IZ(t,e,i,r=1){const n=(t%360+360)%360/360,o=i<=.5?i*(e+1):i+e-i*e,u=2*i-o;return[Math.round(255*w9(u,o,n+1/3)),Math.round(255*w9(u,o,n)),Math.round(255*w9(u,o,n-1/3)),r]}function i0e(t){const e=t.length>5,i=e?8:4,r=(1<<i)-1,n=e?1:17,o=e?t.length===9:t.length===5;let u=+("0x"+t.substr(1));if(isNaN(u))return null;const p=[0,0,0,1];let g;return o&&(g=u&r,u>>=i,p[3]=n*g/255),g=u&r,u>>=i,p[2]=n*g,g=u&r,u>>=i,p[1]=n*g,g=u&r,u>>=i,p[0]=n*g,p}function be(){return[0,0,0]}function xs(t){return[t[0],t[1],t[2]]}function un(t,e,i){return[t,e,i]}function r0e(t,e=be()){const i=Math.min(3,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function n0e(t,e){return new Float64Array(t,e,3)}function MZ(){return be()}function kZ(){return un(1,1,1)}function CZ(){return un(1,0,0)}function AZ(){return un(0,1,0)}function LZ(){return un(0,0,1)}const OZ=MZ(),PZ=kZ(),s0e=CZ(),o0e=AZ(),o3=LZ();Object.freeze(Object.defineProperty({__proto__:null,ONES:PZ,UNIT_X:s0e,UNIT_Y:o0e,UNIT_Z:o3,ZEROS:OZ,clone:xs,create:be,createView:n0e,fromArray:r0e,fromValues:un,ones:kZ,unitX:CZ,unitY:AZ,unitZ:LZ,zeros:MZ},Symbol.toStringTag,{value:"Module"}));let TP=1e-6;function kr(){return TP}function a0e(t){TP=t}const eS=Math.random,l0e=Math.PI/180,u0e=180/Math.PI;function EP(t){return t*l0e}function c0e(t){return t*u0e}function h0e(t,e){return Math.abs(t-e)<=TP*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:eS,equals:h0e,getEpsilon:kr,setEpsilon:a0e,toDegree:c0e,toRadian:EP},Symbol.toStringTag,{value:"Module"}));function cr(t){const e=t[0],i=t[1],r=t[2];return Math.sqrt(e*e+i*i+r*r)}function ki(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Qt(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t}function nr(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Xi(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function IP(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function RZ(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function p0e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function d0e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function lb(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function FZ(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function NZ(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function DZ(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function f0e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Mi(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function ji(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t}function Gm(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+r*r+n*n)}function ph(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n}function Am(t){const e=t[0],i=t[1],r=t[2];return e*e+i*i+r*r}function y0e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function m0e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ta(t,e){const i=e[0],r=e[1],n=e[2];let o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Ft(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ko(t,e,i){const r=e[0],n=e[1],o=e[2],u=i[0],p=i[1],g=i[2];return t[0]=n*g-o*p,t[1]=o*u-r*g,t[2]=r*p-n*u,t}function VI(t,e,i,r){const n=e[0],o=e[1],u=e[2];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t[2]=u+r*(i[2]-u),t}function g0e(t,e,i,r,n,o){const u=o*o,p=u*(2*o-3)+1,g=u*(o-2)+o,w=u*(o-1),S=u*(3-2*o);return t[0]=e[0]*p+i[0]*g+r[0]*w+n[0]*S,t[1]=e[1]*p+i[1]*g+r[1]*w+n[1]*S,t[2]=e[2]*p+i[2]*g+r[2]*w+n[2]*S,t}function v0e(t,e,i,r,n,o){const u=1-o,p=u*u,g=o*o,w=p*u,S=3*o*p,T=3*g*u,E=g*o;return t[0]=e[0]*w+i[0]*S+r[0]*T+n[0]*E,t[1]=e[1]*w+i[1]*S+r[1]*T+n[1]*E,t[2]=e[2]*w+i[2]*S+r[2]*T+n[2]*E,t}function b0e(t,e){e=e||1;const i=eS,r=2*i()*Math.PI,n=2*i()-1,o=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*e,t}function Ll(t,e,i){const r=e[0],n=e[1],o=e[2];return t[0]=i[0]*r+i[4]*n+i[8]*o+i[12],t[1]=i[1]*r+i[5]*n+i[9]*o+i[13],t[2]=i[2]*r+i[6]*n+i[10]*o+i[14],t}function jZ(t,e,i){const r=e[0],n=e[1],o=e[2];return t[0]=r*i[0]+n*i[3]+o*i[6],t[1]=r*i[1]+n*i[4]+o*i[7],t[2]=r*i[2]+n*i[5]+o*i[8],t}function Pa(t,e,i){const r=i[0],n=i[1],o=i[2],u=i[3],p=e[0],g=e[1],w=e[2],S=n*w-o*g,T=o*p-r*w,E=r*g-n*p,C=n*E-o*T,L=o*S-r*E,R=r*T-n*S,F=2*u;return t[0]=p+S*F+2*C,t[1]=g+T*F+2*L,t[2]=w+E*F+2*R,t}function w0e(t,e,i,r){const n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function _0e(t,e,i,r){const n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function S0e(t,e,i,r){const n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function x0e(t,e){ta(bD,t),ta(wD,e);const i=Ft(bD,wD);return i>1?0:i<-1?Math.PI:Math.acos(i)}const bD=be(),wD=be();function $0e(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Si(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function VZ(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],o=e[0],u=e[1],p=e[2],g=kr();return Math.abs(i-o)<=g*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-u)<=g*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-p)<=g*Math.max(1,Math.abs(n),Math.abs(p))}function zZ(t,e,i){const r=i[0]-e[0],n=i[1]-e[1],o=i[2]-e[2];let u=r*r+n*n+o*o;return u>0?(u=1/Math.sqrt(u),t[0]=r*u,t[1]=n*u,t[2]=o*u,t):(t[0]=0,t[1]=0,t[2]=0,t)}const Js=Xi,T0e=IP,E0e=RZ,I0e=Gm,aC=ph,UZ=cr,a3=Am;Object.freeze(Object.defineProperty({__proto__:null,abs:lb,add:nr,angle:x0e,bezier:v0e,ceil:p0e,copy:ki,cross:Ko,direction:zZ,dist:I0e,distance:Gm,div:E0e,divide:RZ,dot:Ft,equals:VZ,exactEquals:Si,floor:d0e,hermite:g0e,inverse:m0e,len:UZ,length:cr,lerp:VI,max:DZ,min:NZ,mul:T0e,multiply:IP,negate:y0e,normalize:ta,random:b0e,rotateX:w0e,rotateY:_0e,rotateZ:S0e,round:f0e,scale:Mi,scaleAndAdd:ji,set:Qt,sign:FZ,sqrDist:aC,sqrLen:a3,squaredDistance:ph,squaredLength:Am,str:$0e,sub:Js,subtract:Xi,transformMat3:jZ,transformMat4:Ll,transformQuat:Pa},Symbol.toStringTag,{value:"Module"}));const _D=new Float32Array(1);function AWe(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function An(t,e,i){return Math.min(Math.max(t,e),i)}function LWe(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Pf(t,e,i){return t+(e-t)*i}function OWe(t,e,i,r,n){return Pf(r,n,(t-e)/(i-e))}function tS(t){return t*Math.PI/180}function GZ(t){return 180*t/Math.PI}function PWe(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function MP(t){return Math.acos(An(t,-1,1))}function kP(t){return Math.asin(An(t,-1,1))}function Sv(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}const uE=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function lC(t){return uE.setFloat64(0,t),uE.getBigInt64(0)}function M0e(t){return uE.setBigInt64(0,t),uE.getFloat64(0)}const Y$=BigInt("1000000"),k0e=BZ(1);function BZ(t){const e=lC(t=Math.abs(t)),i=M0e(e<=Y$?Y$:e-Y$);return Math.abs(t-i)}function C0e(t,e,i=k0e){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(i!=null&&BZ(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i;const r=lC(t),n=lC(e);return r<0!=n<0?!1:!((r<n?n-r:r-n)>Y$)}function RWe(t){return qZ(Math.max(-xD,Math.min(t,xD)))}function qZ(t){return _D[0]=t,_D[0]}function SD(t,e){const i=cr(t),r=kP(t[2]/i),n=Math.atan2(t[1]/i,t[0]/i);return Qt(e,i,r,n),e}function FWe(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Sv(e,1)&&Sv(i,1)&&Sv(r,1))}const xD=qZ(34028234663852886e22);function ox(t){return An(G7(t),0,255)}function ax(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}function lx(t,e){const i=t.toString(16).padStart(2,"0");return e?i.substring(0,1):i}let X$=class Fn{static blendColors(e,i,r,n=new Fn){return n.r=Math.round(e.r+(i.r-e.r)*r),n.g=Math.round(e.g+(i.g-e.g)*r),n.b=Math.round(e.b+(i.b-e.b)*r),n.a=e.a+(i.a-e.a)*r,n._sanitize()}static fromRgb(e,i){const r=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(r){const n=r[2].split(/\s*,\s*/),o=r[1];if(o==="rgb"&&n.length===3||o==="rgba"&&n.length===4){const u=n[0];if(u.charAt(u.length-1)==="%"){const p=n.map(g=>2.56*parseFloat(g));return n.length===4&&(p[3]=parseFloat(n[3])),Fn.fromArray(p,i)}return Fn.fromArray(n.map(p=>parseFloat(p)),i)}if(o==="hsl"&&n.length===3||o==="hsla"&&n.length===4)return Fn.fromArray(IZ(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),i)}return null}static fromHex(e,i=new Fn){if(e[0]!=="#"||isNaN(+`0x${e.substring(1)}`))return null;switch(e.length){case 4:case 5:{const r=parseInt(e.substring(1,2),16),n=parseInt(e.substring(2,3),16),o=parseInt(e.substring(3,4),16),u=e.length===5?15:parseInt(e.substring(4),16);return Fn.fromArray([r+16*r,n+16*n,o+16*o,(u+16*u)/255],i)}case 7:case 9:{const r=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16),u=e.length===7?255:parseInt(e.substring(7),16);return Fn.fromArray([r,n,o,u/255],i)}default:return null}}static fromArray(e,i=new Fn){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const r=EZ(e)?$P(e):null;return r&&Fn.fromArray(r,i)||Fn.fromRgb(e,i)||Fn.fromHex(e,i)}static fromJSON(e){return e!=null?new Fn([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Fn.fromString(e,this):Array.isArray(e)?Fn.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Fn||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const i=(e==null?void 0:e.capitalize)??!1,r=(e==null?void 0:e.digits)??6,n=r===3||r===4,o=r===4||r===8,u=`#${lx(this.r,n)}${lx(this.g,n)}${lx(this.b,n)}${o?lx(Math.round(255*this.a),n):""}`;return i?u.toUpperCase():u}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=Fn.AlphaMode.ALWAYS){const i=ox(this.r),r=ox(this.g),n=ox(this.b);return e===Fn.AlphaMode.ALWAYS||this.a!==1?[i,r,n,ox(255*this.a)]:[i,r,n]}clone(){return new Fn(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(ax(this.r,0,255)),this.g=Math.round(ax(this.g,0,255)),this.b=Math.round(ax(this.b,0,255)),this.a=ax(this.a,0,1),this}_set(e,i,r,n){this.r=e,this.g=i,this.b=r,this.a=n}};X$.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(X$||(X$={}));const Ce=X$;function NWe(t){}function A0e(t){return()=>t}function ze(t,e={}){const i=t instanceof et?t:new et(t,e),r={type:(e==null?void 0:e.ignoreUnknown)??1?i.apiValues:String,json:{type:i.jsonValues,read:!(e!=null&&e.readOnly)&&{reader:i.read},write:{writer:i.write}}};return(e==null?void 0:e.readOnly)!==void 0&&(r.readOnly=!!e.readOnly),(e==null?void 0:e.default)!==void 0&&(r.json.default=e.default),(e==null?void 0:e.name)!==void 0&&(r.json.name=e.name),(e==null?void 0:e.nonNullable)!==void 0&&(r.nonNullable=e.nonNullable),b(r)}var uC;let Q$=uC=class extends ye{constructor(t){super(t),this.type="none"}clone(){return new uC({type:this.type})}};m([ze({none:"none",stayAbove:"stay-above"})],Q$.prototype,"type",void 0),Q$=uC=m([G("esri.ground.NavigationConstraint")],Q$);function zI(t){const e=G7(100*(1-t));return Math.max(0,Math.min(e,100))}function l3(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var cC;let Gh=cC=class extends Um(Qo){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ie;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&fe.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{Cn(t)||fe.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)ot(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",Jp(t,this._get("layers")))}writeLayers(t,e,i,r){const n=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(o=>{if("write"in o){const u={};A0e(o)().write(u,r)&&n.push(u)}else r!=null&&r.messages&&r.messages.push(new re("layer:unsupported",`Layers (${o.title}, ${o.id}) of type '${o.declaredClass}' cannot be persisted in the ground`,{layer:o}))})),e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return lP(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await ie(()=>Promise.resolve().then(()=>NH),void 0);At(e);const r=new i,n=this.layers.filter($D).toArray();return r.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await ie(()=>Promise.resolve().then(()=>NH),void 0);At(e);const r=new i,n=this.layers.filter($D).toArray();return r.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:ae(this.surfaceColor),navigationConstraint:ae(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new cC({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const r=(e==null?void 0:e.origin)||"web-scene",n=(e==null?void 0:e.portal)||null,o=(e==null?void 0:e.url)||null,{populateOperationalLayers:u}=await ie(async()=>{const{populateOperationalLayers:g}=await import("./layersCreator-DYPEGeb7.js");return{populateOperationalLayers:g}},__vite__mapDeps([5,6,7,8]));At(i);const p=[];if(t.layers&&Array.isArray(t.layers)){const g={context:{origin:r,url:o,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};p.push(u(this.layers,t.layers,g))}await Promise.allSettled(p)}};function L0e(t){return t&&"createElevationSampler"in t}function $D(t){return t.type==="elevation"||L0e(t)}m([b({json:{read:!1}})],Gh.prototype,"layers",null),m([Le("layers")],Gh.prototype,"writeLayers",null),m([b({readOnly:!0})],Gh.prototype,"resourceInfo",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:zt,read:{reader:l3,source:"transparency"},write:{writer:(t,e)=>{e.transparency=zI(t)},target:"transparency"}}})],Gh.prototype,"opacity",void 0),m([b({type:Ce,json:{type:[zt],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Gh.prototype,"surfaceColor",void 0),m([b({type:Q$,json:{write:!0}})],Gh.prototype,"navigationConstraint",void 0),Gh=cC=m([G("esri.Ground")],Gh);const u3=Gh;let Jg=class extends Ie{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(eJ(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let i=0;for(const r of e)r!=null&&(i=this._processCollection(i,r));this.splice(i,this.length)}_createNewInstance(e){return new Ie(e)}_processCollection(e,i){if(!i)return e;const r=this.itemFilterFunction??(n=>!!n);for(const n of i)if(n){if(r(n)){const o=this.indexOf(n,e);o>=0?o!==e&&this.reorder(n,e):this.add(n,e),++e}if(this.getChildrenFunction){const o=this.getChildrenFunction(n);if(Array.isArray(o))for(const u of o)e=this._processCollection(e,u);else e=this._processCollection(e,o)}}return e}};m([b()],Jg.prototype,"getCollections",void 0),m([b()],Jg.prototype,"getChildrenFunction",void 0),m([b()],Jg.prototype,"itemFilterFunction",void 0),Jg=m([G("esri.core.CollectionFlattener")],Jg);const c3=Jg;function ce(t,e,i={}){return CP(t,e,i,HZ)}function Fr(t,e,i={}){return CP(t,e,i,WZ)}function CP(t,e,i={},r){let n=null;const o=i.once?(u,p)=>{r(u)&&(Vi(n),e(u,p))}:(u,p)=>{r(u)&&e(u,p)};if(n=She(t,o,i.sync,i.equals),i.initial){const u=t();o(u,u)}return n}function gi(t,e,i,r={}){let n=null,o=null,u=null;function p(){var S;n&&o&&(o.remove(),(S=r.onListenerRemove)==null||S.call(r,n),n=null,o=null)}function g(S){r.once&&r.once&&Vi(u),i(S)}const w=ce(t,(S,T)=>{var E;p(),TI(S)&&(n=S,o=H3(S,e,g),(E=r.onListenerAdd)==null||E.call(r,S))},{sync:r.sync,initial:!0});return u=We(()=>{w.remove(),p()}),u}function vr(t,e){return O0e(t,WZ,e)}function O0e(t,e,i){if(Xo(i))return Promise.reject(ni());const r=t();if(e!=null&&e(r))return Promise.resolve(r);let n=null;function o(){n=Vi(n)}return new Promise((u,p)=>{n=In([Zo(i,()=>{o(),p(ni())}),CP(t,g=>{o(),u(g)},{sync:!1,once:!0},e??HZ)])})}function HZ(t){return!0}function WZ(t){return!!t}function P0e(t,e,i={}){let r=!1;const n=ce(t,(o,u)=>{r||e(o,u)},i);return{remove(){n.remove()},pause(){r=!0},resume(){r=!1}}}function R0e(t,e){const i=new Ie,r=gi(t,"after-splice",({added:n,start:o,deleteCount:u})=>{const p=i.splice(o,u);for(const g of p)g.remove();if(n!=null&&n.length){const g=n.map(e);i.addMany(g,o)}},{sync:!0,onListenerRemove:()=>i.drain(n=>n.remove()),onListenerAdd:n=>i.addMany(n.items.map(e))});return i.addHandles(r),i}function F0e(t,e){const i=new Ie,r=R0e(t,p=>Sh(async g=>{const w=await e(p,g);if(Xo(g))throw w.remove(),ni();return w})),n=()=>null,o=async p=>{const g=await p.promise,w=r.indexOf(p);w<0||i.splice(w,1,g)};i.addMany(r.items.map(n));for(const p of r)Wu(o(p));const u=r.on("after-splice",({added:p,start:g,deleteCount:w})=>{const S=i.splice(g,w);for(const T of S)T==null||T.remove();if(p!=null&&p.length){i.addMany(p.map(n),g);for(const T of p)Wu(o(T))}});return i.addHandles([PW(r),u]),i}const $s={sync:!0},Qe={initial:!0},ri={sync:!0,initial:!0},ux=new WeakMap;function JZ(t){return!t.destroyed&&(ux.has(t)||t.addHandles([ce(()=>{const e=t.parent;return!(!e||!("type"in e))&&(e.type==="catalog-dynamic-group"||JZ(e))},e=>ux.set(t,e),ri),We(()=>ux.delete(t))]),ux.get(t))}function N0e(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function h3(t){var e,i;return!(!N0e(t)||!((i=(e=Cm(t))==null?void 0:e.operations)!=null&&i.supportsEditing)||"editingEnabled"in t&&!TZ(t)||JZ(t))}const D0e=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,j0e="screenUtils.toPt: input not recognized!",ZZ=96;function Zi(t){return t?t/72*ZZ:0}function Jn(t){return t?72*t/ZZ:0}function Wt(t){if(typeof t=="string"){const e=t.match(D0e);if(e){const i=Number(e[1]),r=e[3]&&e[3].toLowerCase(),n=t.charAt(0)==="-",o=r==="px"?Jn(i):i;return n?-o:o}return console.warn(j0e),null}return t}function Mr(t=0,e=0){return{x:t,y:e}}function V0e(t=0,e=0){return[t,e]}function jWe(t=0,e=0,i=0){return[t,e,i]}function VWe(t){return t}function zWe(t){return t}function UWe(t){return t}function GWe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function UI(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function z0e(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function U0e(t,e,i,r,n,o,u,p,g,w,S,T,E,C,L,R){const F=new Float32Array(16);return F[0]=t,F[1]=e,F[2]=i,F[3]=r,F[4]=n,F[5]=o,F[6]=u,F[7]=p,F[8]=g,F[9]=w,F[10]=S,F[11]=T,F[12]=E,F[13]=C,F[14]=L,F[15]=R,F}function G0e(t,e){return new Float32Array(t,e,16)}const B0e=UI();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:B0e,clone:z0e,create:UI,createView:G0e,fromValues:U0e},Symbol.toStringTag,{value:"Module"}));function p3(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function c0(t,e,i,r,n,o,u,p,g,w,S,T,E,C,L,R,F){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=u,t[6]=p,t[7]=g,t[8]=w,t[9]=S,t[10]=T,t[11]=E,t[12]=C,t[13]=L,t[14]=R,t[15]=F,t}function iS(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Bl(t,e){if(t===e){const i=e[1],r=e[2],n=e[3],o=e[6],u=e[7],p=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=u,t[14]=p}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function q0e(t,e){return GI(t,e)||iS(t),t}function GI(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5],g=e[6],w=e[7],S=e[8],T=e[9],E=e[10],C=e[11],L=e[12],R=e[13],F=e[14],V=e[15],U=i*p-r*u,W=i*g-n*u,H=i*w-o*u,J=r*g-n*p,X=r*w-o*p,te=n*w-o*g,oe=S*R-T*L,pe=S*F-E*L,de=S*V-C*L,ge=T*F-E*R,we=T*V-C*R,ke=E*V-C*F;let $e=U*ke-W*we+H*ge+J*de-X*pe+te*oe;return $e?($e=1/$e,t[0]=(p*ke-g*we+w*ge)*$e,t[1]=(n*we-r*ke-o*ge)*$e,t[2]=(R*te-F*X+V*J)*$e,t[3]=(E*X-T*te-C*J)*$e,t[4]=(g*de-u*ke-w*pe)*$e,t[5]=(i*ke-n*de+o*pe)*$e,t[6]=(F*H-L*te-V*W)*$e,t[7]=(S*te-E*H+C*W)*$e,t[8]=(u*we-p*de+w*oe)*$e,t[9]=(r*de-i*we-o*oe)*$e,t[10]=(L*X-R*H+V*U)*$e,t[11]=(T*H-S*X-C*U)*$e,t[12]=(p*pe-u*ge-g*oe)*$e,t[13]=(i*ge-r*pe+n*oe)*$e,t[14]=(R*W-L*J-F*U)*$e,t[15]=(S*J-T*W+E*U)*$e,t):null}function H0e(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5],g=e[6],w=e[7],S=e[8],T=e[9],E=e[10],C=e[11],L=e[12],R=e[13],F=e[14],V=e[15];return t[0]=p*(E*V-C*F)-T*(g*V-w*F)+R*(g*C-w*E),t[1]=-(r*(E*V-C*F)-T*(n*V-o*F)+R*(n*C-o*E)),t[2]=r*(g*V-w*F)-p*(n*V-o*F)+R*(n*w-o*g),t[3]=-(r*(g*C-w*E)-p*(n*C-o*E)+T*(n*w-o*g)),t[4]=-(u*(E*V-C*F)-S*(g*V-w*F)+L*(g*C-w*E)),t[5]=i*(E*V-C*F)-S*(n*V-o*F)+L*(n*C-o*E),t[6]=-(i*(g*V-w*F)-u*(n*V-o*F)+L*(n*w-o*g)),t[7]=i*(g*C-w*E)-u*(n*C-o*E)+S*(n*w-o*g),t[8]=u*(T*V-C*R)-S*(p*V-w*R)+L*(p*C-w*T),t[9]=-(i*(T*V-C*R)-S*(r*V-o*R)+L*(r*C-o*T)),t[10]=i*(p*V-w*R)-u*(r*V-o*R)+L*(r*w-o*p),t[11]=-(i*(p*C-w*T)-u*(r*C-o*T)+S*(r*w-o*p)),t[12]=-(u*(T*F-E*R)-S*(p*F-g*R)+L*(p*E-g*T)),t[13]=i*(T*F-E*R)-S*(r*F-n*R)+L*(r*E-n*T),t[14]=-(i*(p*F-g*R)-u*(r*F-n*R)+L*(r*g-n*p)),t[15]=i*(p*E-g*T)-u*(r*E-n*T)+S*(r*g-n*p),t}function W0e(t){const e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],u=t[5],p=t[6],g=t[7],w=t[8],S=t[9],T=t[10],E=t[11],C=t[12],L=t[13],R=t[14],F=t[15];return(e*u-i*o)*(T*F-E*R)-(e*p-r*o)*(S*F-E*L)+(e*g-n*o)*(S*R-T*L)+(i*p-r*u)*(w*F-E*C)-(i*g-n*u)*(w*R-T*C)+(r*g-n*p)*(w*L-S*C)}function AP(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=e[6],S=e[7],T=e[8],E=e[9],C=e[10],L=e[11],R=e[12],F=e[13],V=e[14],U=e[15];let W=i[0],H=i[1],J=i[2],X=i[3];return t[0]=W*r+H*p+J*T+X*R,t[1]=W*n+H*g+J*E+X*F,t[2]=W*o+H*w+J*C+X*V,t[3]=W*u+H*S+J*L+X*U,W=i[4],H=i[5],J=i[6],X=i[7],t[4]=W*r+H*p+J*T+X*R,t[5]=W*n+H*g+J*E+X*F,t[6]=W*o+H*w+J*C+X*V,t[7]=W*u+H*S+J*L+X*U,W=i[8],H=i[9],J=i[10],X=i[11],t[8]=W*r+H*p+J*T+X*R,t[9]=W*n+H*g+J*E+X*F,t[10]=W*o+H*w+J*C+X*V,t[11]=W*u+H*S+J*L+X*U,W=i[12],H=i[13],J=i[14],X=i[15],t[12]=W*r+H*p+J*T+X*R,t[13]=W*n+H*g+J*E+X*F,t[14]=W*o+H*w+J*C+X*V,t[15]=W*u+H*S+J*L+X*U,t}function J0e(t,e,i){const r=i[0],n=i[1],o=i[2];if(e===t)t[12]=e[0]*r+e[4]*n+e[8]*o+e[12],t[13]=e[1]*r+e[5]*n+e[9]*o+e[13],t[14]=e[2]*r+e[6]*n+e[10]*o+e[14],t[15]=e[3]*r+e[7]*n+e[11]*o+e[15];else{const u=e[0],p=e[1],g=e[2],w=e[3],S=e[4],T=e[5],E=e[6],C=e[7],L=e[8],R=e[9],F=e[10],V=e[11];t[0]=u,t[1]=p,t[2]=g,t[3]=w,t[4]=S,t[5]=T,t[6]=E,t[7]=C,t[8]=L,t[9]=R,t[10]=F,t[11]=V,t[12]=u*r+S*n+L*o+e[12],t[13]=p*r+T*n+R*o+e[13],t[14]=g*r+E*n+F*o+e[14],t[15]=w*r+C*n+V*o+e[15]}return t}function Z0e(t,e,i){const r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function K0e(t,e,i,r){let n,o,u,p,g,w,S,T,E,C,L,R,F,V,U,W,H,J,X,te,oe,pe,de,ge,we=r[0],ke=r[1],$e=r[2],Fe=Math.sqrt(we*we+ke*ke+$e*$e);return Fe<kr()?null:(Fe=1/Fe,we*=Fe,ke*=Fe,$e*=Fe,n=Math.sin(i),o=Math.cos(i),u=1-o,p=e[0],g=e[1],w=e[2],S=e[3],T=e[4],E=e[5],C=e[6],L=e[7],R=e[8],F=e[9],V=e[10],U=e[11],W=we*we*u+o,H=ke*we*u+$e*n,J=$e*we*u-ke*n,X=we*ke*u-$e*n,te=ke*ke*u+o,oe=$e*ke*u+we*n,pe=we*$e*u+ke*n,de=ke*$e*u-we*n,ge=$e*$e*u+o,t[0]=p*W+T*H+R*J,t[1]=g*W+E*H+F*J,t[2]=w*W+C*H+V*J,t[3]=S*W+L*H+U*J,t[4]=p*X+T*te+R*oe,t[5]=g*X+E*te+F*oe,t[6]=w*X+C*te+V*oe,t[7]=S*X+L*te+U*oe,t[8]=p*pe+T*de+R*ge,t[9]=g*pe+E*de+F*ge,t[10]=w*pe+C*de+V*ge,t[11]=S*pe+L*de+U*ge,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Y0e(t,e,i){const r=Math.sin(i),n=Math.cos(i),o=e[4],u=e[5],p=e[6],g=e[7],w=e[8],S=e[9],T=e[10],E=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+w*r,t[5]=u*n+S*r,t[6]=p*n+T*r,t[7]=g*n+E*r,t[8]=w*n-o*r,t[9]=S*n-u*r,t[10]=T*n-p*r,t[11]=E*n-g*r,t}function X0e(t,e,i){const r=Math.sin(i),n=Math.cos(i),o=e[0],u=e[1],p=e[2],g=e[3],w=e[8],S=e[9],T=e[10],E=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-w*r,t[1]=u*n-S*r,t[2]=p*n-T*r,t[3]=g*n-E*r,t[8]=o*r+w*n,t[9]=u*r+S*n,t[10]=p*r+T*n,t[11]=g*r+E*n,t}function Q0e(t,e,i){const r=Math.sin(i),n=Math.cos(i),o=e[0],u=e[1],p=e[2],g=e[3],w=e[4],S=e[5],T=e[6],E=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+w*r,t[1]=u*n+S*r,t[2]=p*n+T*r,t[3]=g*n+E*r,t[4]=w*n-o*r,t[5]=S*n-u*r,t[6]=T*n-p*r,t[7]=E*n-g*r,t}function KZ(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function eye(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function LP(t,e,i){if(e===0)return iS(t);let r,n,o,u=i[0],p=i[1],g=i[2],w=Math.sqrt(u*u+p*p+g*g);return w<kr()?null:(w=1/w,u*=w,p*=w,g*=w,r=Math.sin(e),n=Math.cos(e),o=1-n,t[0]=u*u*o+n,t[1]=p*u*o+g*r,t[2]=g*u*o-p*r,t[3]=0,t[4]=u*p*o-g*r,t[5]=p*p*o+n,t[6]=g*p*o+u*r,t[7]=0,t[8]=u*g*o+p*r,t[9]=p*g*o-u*r,t[10]=g*g*o+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function tye(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function iye(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rye(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function YZ(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=r+r,g=n+n,w=o+o,S=r*p,T=r*g,E=r*w,C=n*g,L=n*w,R=o*w,F=u*p,V=u*g,U=u*w;return t[0]=1-(C+R),t[1]=T+U,t[2]=E-V,t[3]=0,t[4]=T-U,t[5]=1-(S+R),t[6]=L+F,t[7]=0,t[8]=E+V,t[9]=L-F,t[10]=1-(S+C),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function nye(t,e){const i=sye,r=-e[0],n=-e[1],o=-e[2],u=e[3],p=e[4],g=e[5],w=e[6],S=e[7],T=r*r+n*n+o*o+u*u;return T>0?(i[0]=2*(p*u+S*r+g*o-w*n)/T,i[1]=2*(g*u+S*n+w*r-p*o)/T,i[2]=2*(w*u+S*o+p*n-g*r)/T):(i[0]=2*(p*u+S*r+g*o-w*n),i[1]=2*(g*u+S*n+w*r-p*o),i[2]=2*(w*u+S*o+p*n-g*r)),YZ(t,e,i),t}const sye=be();function oye(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function aye(t,e){const i=e[0],r=e[1],n=e[2],o=e[4],u=e[5],p=e[6],g=e[8],w=e[9],S=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(o*o+u*u+p*p),t[2]=Math.sqrt(g*g+w*w+S*S),t}function lye(t,e){const i=e[0]+e[5]+e[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function uye(t,e,i,r){const n=e[0],o=e[1],u=e[2],p=e[3],g=n+n,w=o+o,S=u+u,T=n*g,E=n*w,C=n*S,L=o*w,R=o*S,F=u*S,V=p*g,U=p*w,W=p*S,H=r[0],J=r[1],X=r[2];return t[0]=(1-(L+F))*H,t[1]=(E+W)*H,t[2]=(C-U)*H,t[3]=0,t[4]=(E-W)*J,t[5]=(1-(T+F))*J,t[6]=(R+V)*J,t[7]=0,t[8]=(C+U)*X,t[9]=(R-V)*X,t[10]=(1-(T+L))*X,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function cye(t,e,i,r,n){const o=e[0],u=e[1],p=e[2],g=e[3],w=o+o,S=u+u,T=p+p,E=o*w,C=o*S,L=o*T,R=u*S,F=u*T,V=p*T,U=g*w,W=g*S,H=g*T,J=r[0],X=r[1],te=r[2],oe=n[0],pe=n[1],de=n[2],ge=(1-(R+V))*J,we=(C+H)*J,ke=(L-W)*J,$e=(C-H)*X,Fe=(1-(E+V))*X,yt=(F+U)*X,qe=(L+W)*te,Ue=(F-U)*te,ei=(1-(E+R))*te;return t[0]=ge,t[1]=we,t[2]=ke,t[3]=0,t[4]=$e,t[5]=Fe,t[6]=yt,t[7]=0,t[8]=qe,t[9]=Ue,t[10]=ei,t[11]=0,t[12]=i[0]+oe-(ge*oe+$e*pe+qe*de),t[13]=i[1]+pe-(we*oe+Fe*pe+Ue*de),t[14]=i[2]+de-(ke*oe+yt*pe+ei*de),t[15]=1,t}function hye(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=i+i,p=r+r,g=n+n,w=i*u,S=r*u,T=r*p,E=n*u,C=n*p,L=n*g,R=o*u,F=o*p,V=o*g;return t[0]=1-T-L,t[1]=S+V,t[2]=E-F,t[3]=0,t[4]=S-V,t[5]=1-w-L,t[6]=C+R,t[7]=0,t[8]=E+F,t[9]=C-R,t[10]=1-w-T,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pye(t,e,i,r,n,o,u){const p=1/(i-e),g=1/(n-r),w=1/(o-u);return t[0]=2*o*p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*g,t[6]=0,t[7]=0,t[8]=(i+e)*p,t[9]=(n+r)*g,t[10]=(u+o)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*o*2*w,t[15]=0,t}function dye(t,e,i,r,n){const o=1/Math.tan(e/2);let u;return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(u=1/(r-n),t[10]=(n+r)*u,t[14]=2*n*r*u):(t[10]=-1,t[14]=-2*r),t}function fye(t,e,i,r){const n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),u=Math.tan(e.leftDegrees*Math.PI/180),p=Math.tan(e.rightDegrees*Math.PI/180),g=2/(u+p),w=2/(n+o);return t[0]=g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=w,t[6]=0,t[7]=0,t[8]=-(u-p)*g*.5,t[9]=(n-o)*w*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t}function yye(t,e,i,r,n,o,u){const p=1/(e-i),g=1/(r-n),w=1/(o-u);return t[0]=-2*p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*g,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+i)*p,t[13]=(n+r)*g,t[14]=(u+o)*w,t[15]=1,t}function mye(t,e,i,r){const n=e[0],o=e[1],u=e[2];let p=n-i[0],g=o-i[1],w=u-i[2];const S=kr();if(Math.abs(p)<S&&Math.abs(g)<S&&Math.abs(w)<S)return void iS(t);let T=1/Math.sqrt(p*p+g*g+w*w);p*=T,g*=T,w*=T;const E=r[0],C=r[1],L=r[2];let R=C*w-L*g,F=L*p-E*w,V=E*g-C*p;T=Math.sqrt(R*R+F*F+V*V),T?(T=1/T,R*=T,F*=T,V*=T):(R=0,F=0,V=0);let U=g*V-w*F,W=w*R-p*V,H=p*F-g*R;T=Math.sqrt(U*U+W*W+H*H),T?(T=1/T,U*=T,W*=T,H*=T):(U=0,W=0,H=0),t[0]=R,t[1]=U,t[2]=p,t[3]=0,t[4]=F,t[5]=W,t[6]=g,t[7]=0,t[8]=V,t[9]=H,t[10]=w,t[11]=0,t[12]=-(R*n+F*o+V*u),t[13]=-(U*n+W*o+H*u),t[14]=-(p*n+g*o+w*u),t[15]=1}function gye(t,e,i,r){const n=e[0],o=e[1],u=e[2],p=r[0],g=r[1],w=r[2];let S=n-i[0],T=o-i[1],E=u-i[2],C=S*S+T*T+E*E;C>0&&(C=1/Math.sqrt(C),S*=C,T*=C,E*=C);let L=g*E-w*T,R=w*S-p*E,F=p*T-g*S;return C=L*L+R*R+F*F,C>0&&(C=1/Math.sqrt(C),L*=C,R*=C,F*=C),t[0]=L,t[1]=R,t[2]=F,t[3]=0,t[4]=T*F-E*R,t[5]=E*L-S*F,t[6]=S*R-T*L,t[7]=0,t[8]=S,t[9]=T,t[10]=E,t[11]=0,t[12]=n,t[13]=o,t[14]=u,t[15]=1,t}function vye(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function bye(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function wye(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function XZ(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function _ye(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function Sye(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t}function xye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function $ye(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],o=t[3],u=t[4],p=t[5],g=t[6],w=t[7],S=t[8],T=t[9],E=t[10],C=t[11],L=t[12],R=t[13],F=t[14],V=t[15],U=e[0],W=e[1],H=e[2],J=e[3],X=e[4],te=e[5],oe=e[6],pe=e[7],de=e[8],ge=e[9],we=e[10],ke=e[11],$e=e[12],Fe=e[13],yt=e[14],qe=e[15],Ue=kr();return Math.abs(i-U)<=Ue*Math.max(1,Math.abs(i),Math.abs(U))&&Math.abs(r-W)<=Ue*Math.max(1,Math.abs(r),Math.abs(W))&&Math.abs(n-H)<=Ue*Math.max(1,Math.abs(n),Math.abs(H))&&Math.abs(o-J)<=Ue*Math.max(1,Math.abs(o),Math.abs(J))&&Math.abs(u-X)<=Ue*Math.max(1,Math.abs(u),Math.abs(X))&&Math.abs(p-te)<=Ue*Math.max(1,Math.abs(p),Math.abs(te))&&Math.abs(g-oe)<=Ue*Math.max(1,Math.abs(g),Math.abs(oe))&&Math.abs(w-pe)<=Ue*Math.max(1,Math.abs(w),Math.abs(pe))&&Math.abs(S-de)<=Ue*Math.max(1,Math.abs(S),Math.abs(de))&&Math.abs(T-ge)<=Ue*Math.max(1,Math.abs(T),Math.abs(ge))&&Math.abs(E-we)<=Ue*Math.max(1,Math.abs(E),Math.abs(we))&&Math.abs(C-ke)<=Ue*Math.max(1,Math.abs(C),Math.abs(ke))&&Math.abs(L-$e)<=Ue*Math.max(1,Math.abs(L),Math.abs($e))&&Math.abs(R-Fe)<=Ue*Math.max(1,Math.abs(R),Math.abs(Fe))&&Math.abs(F-yt)<=Ue*Math.max(1,Math.abs(F),Math.abs(yt))&&Math.abs(V-qe)<=Ue*Math.max(1,Math.abs(V),Math.abs(qe))}function Tye(t){const e=kr(),i=t[0],r=t[1],n=t[2],o=t[4],u=t[5],p=t[6],g=t[8],w=t[9],S=t[10];return Math.abs(1-(i*i+o*o+g*g))<=e&&Math.abs(1-(r*r+u*u+w*w))<=e&&Math.abs(1-(n*n+p*p+S*S))<=e}function Eye(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const Iye=AP,Mye=XZ;Object.freeze(Object.defineProperty({__proto__:null,add:wye,adjoint:H0e,copy:p3,determinant:W0e,equals:$ye,exactEquals:xye,frob:bye,fromQuat:hye,fromQuat2:nye,fromRotation:LP,fromRotationTranslation:YZ,fromRotationTranslationScale:uye,fromRotationTranslationScaleOrigin:cye,fromScaling:eye,fromTranslation:KZ,fromXRotation:tye,fromYRotation:iye,fromZRotation:rye,frustum:pye,getRotation:lye,getScaling:aye,getTranslation:oye,hasIdentityRotation:Eye,identity:iS,invert:GI,invertOrIdentity:q0e,isOrthoNormal:Tye,lookAt:mye,mul:Iye,multiply:AP,multiplyScalar:_ye,multiplyScalarAndAdd:Sye,ortho:yye,perspective:dye,perspectiveFromFieldOfView:fye,rotate:K0e,rotateX:Y0e,rotateY:X0e,rotateZ:Q0e,scale:Z0e,set:c0,str:vye,sub:Mye,subtract:XZ,targetTo:gye,translate:J0e,transpose:Bl},Symbol.toStringTag,{value:"Module"}));const kye=(t,e)=>{const i=c0(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return Bl(i,i)},Cye=(t,e)=>{const i=c0(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return Bl(i,i)},Aye=(t,e)=>{const i=1-e,r=c0(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return Bl(r,r)},Lye=(t,e)=>{const i=Math.sin(e*Math.PI/180),r=Math.cos(e*Math.PI/180),n=c0(t,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return Bl(n,n)},Oye=(t,e)=>{const i=1-2*e,r=c0(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return Bl(r,r)},Pye=(t,e)=>{const i=c0(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return Bl(i,i)},Rye=(t,e)=>{const i=1-e,r=c0(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return Bl(r,r)};let QZ=class eK{constructor(e,i,r){this.strength=e,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(e,i,r){this.strength=Uo(e.strength,i.strength,r),this.radius=Uo(e.radius,i.radius,r),this.threshold=Uo(e.threshold,i.threshold,r)}clone(){return new eK(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:S2(this.radius),strength:this.strength,threshold:this.threshold}}},tK=class iK{constructor(e){this.radius=e,this.type="blur"}interpolate(e,i,r){this.radius=Math.round(Uo(e.radius,i.radius,r))}clone(){return new iK(this.radius)}toJSON(){return{type:"blur",radius:S2(this.radius)}}},hC=class rK{constructor(e,i){this.type=e,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.amount=Uo(e.amount,i.amount,r),this._updateMatrix()}clone(){return new rK(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||UI();switch(this.type){case"brightness":this._colorMatrix=kye(e,this.amount);break;case"contrast":this._colorMatrix=Cye(e,this.amount);break;case"grayscale":this._colorMatrix=Aye(e,this.amount);break;case"invert":this._colorMatrix=Oye(e,this.amount);break;case"saturate":this._colorMatrix=Pye(e,this.amount);break;case"sepia":this._colorMatrix=Rye(e,this.amount)}}},nK=class sK{constructor(e,i,r,n){this.offsetX=e,this.offsetY=i,this.blurRadius=r,this.color=n,this.type="drop-shadow"}interpolate(e,i,r){this.offsetX=Uo(e.offsetX,i.offsetX,r),this.offsetY=Uo(e.offsetY,i.offsetY,r),this.blurRadius=Uo(e.blurRadius,i.blurRadius,r),this.color[0]=Math.round(Uo(e.color[0],i.color[0],r)),this.color[1]=Math.round(Uo(e.color[1],i.color[1],r)),this.color[2]=Math.round(Uo(e.color[2],i.color[2],r)),this.color[3]=Uo(e.color[3],i.color[3],r)}clone(){return new sK(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:S2(this.offsetX),yoffset:S2(this.offsetY),blurRadius:S2(this.blurRadius),color:e}}},oK=class aK{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.angle=Uo(e.angle,i.angle,r),this._updateMatrix()}clone(){return new aK(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||UI();this._colorMatrix=Lye(e,this.angle)}},lK=class uK{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,i,r){this.amount=Uo(e.amount,i.amount,r)}clone(){return new uK(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Uo(t,e,i){return t+(e-t)*i}function S2(t){return Math.round(1e3*Jn(t))/1e3}function Fye(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new hC(t.type,0);case"saturate":case"brightness":case"contrast":return new hC(t.type,1);case"opacity":return new lK(1);case"hue-rotate":return new oK(0);case"blur":return new tK(0);case"drop-shadow":return new nK(0,0,0,[...$P("transparent")]);case"bloom":return new QZ(0,0,1)}}function cK(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every((r,n)=>r.type===i[n].type)}function hK(t,e){const i=t.length>e.length?t:e,r=t.length>e.length?e:t;for(let n=r.length;n<i.length;n++)r.push(Fye(i[n]))}function Nye(t){const e=t[0];return!!e&&"type"in e}function Dye(t,e){return JSON.stringify(t??null)===JSON.stringify(e??null)}const TD=()=>fe.getLogger("esri.support.basemapUtils");function jye(){return{}}function pK(t){for(const e in t){const i=t[e];ot(i),delete t[e]}}function eT(t,e){let i;if(typeof t=="string"){const r=t in ab,n=!r&&t.includes("/");if(!r&&!n){const o=Object.entries(ab).filter(([u,p])=>Ct.apiKey&&!p.classic||!Ct.apiKey&&(p.classic||p.is3d)).map(([u])=>`"${u}"`).sort().join(", ");return TD().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${o}`),null}e&&(i=e[t]),i||(i=r?_2.fromId(t):new _2({style:{id:t}}),e&&(e[t]=i))}else i=Yi(_2,t);return i!=null&&i.destroyed&&(TD().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function BWe(t,e){var i,r,n,o;return((r=(i=t.basemap)==null?void 0:i.referenceLayers)==null?void 0:r.some(u=>u.uid===e))||((o=(n=t.basemap)==null?void 0:n.baseLayers)==null?void 0:o.some(u=>u.uid===e))}function Vye(t){let e=null;const i=Bye(t),r=!(i!=null&&i.baseLayers.length);for(const n in ab){const o=Wye(i,dK(ab[n]),{mustMatchReferences:r});if(o==="equal"){e=n;break}o==="base-layers-equal"&&(e=n)}return e}function qWe(t){return!!(t!=null&&t.baseLayers.concat(t.referenceLayers).some(zye))}function zye(t){if(ED(t.url))return!0;if(t.type==="vector-tile")for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(ED(i==null?void 0:i.sourceUrl))return!0}return!1}function Uye(t,e){var o;if(e==null||t==null)return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?(o=i.tileInfo)==null?void 0:o.spatialReference:i.spatialReference]).filter(Boolean),n=t.spatialReference;return n?{spatialReference:r.find(u=>n.equals(u))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}const Gye=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function ED(t){if(!t)return!1;const e=new qf(Wo(t));return!!e.authority&&Gye.test(e.authority)}function Bye(t){return t?!t.loaded&&t.resourceInfo?dK(t.resourceInfo.data):{baseLayers:ID(t.baseLayers),referenceLayers:ID(t.referenceLayers)}:null}function ID(t){return(Ie.isCollection(t)?t.toArray():t).map(qye)}function qye(t){var e,i;return{type:t.type,effect:"effect"in t?t.effect:void 0,url:fK("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&t.minScale!=null?t.minScale:0,maxScale:"maxScale"in t&&t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visible==null||!!t.visible,sublayers:t.type!=="map-image"&&t.type!=="wms"||t.sublayers==null||(e=t.sublayers)==null?void 0:e.map(r=>({id:r.id,visible:r.visible})),activeLayerId:t.type==="wmts"?(i=t.activeLayer)==null?void 0:i.id:void 0}}function MD(t){return t.isReference||t.layerType==="ArcGISSceneServiceLayer"}function dK(t){return t?{baseLayers:kD((t.baseMapLayers??[]).filter(e=>!MD(e))),referenceLayers:kD((t.baseMapLayers??[]).filter(e=>MD(e)))}:null}function kD(t){return t.map(e=>Hye(e))}function Hye(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;case"ArcGISSceneServiceLayer":e="scene";break;default:e="unknown"}return{type:e,effect:t.effect,url:fK(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:t.visibility==null||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function Wye(t,e,i){return t!=null!=(e!=null)?"not-equal":!t||!e?"equal":CD(t.baseLayers,e.baseLayers)?CD(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function CD(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Jye(t[i],e[i]))return!1;return!0}function Jye(t,e){if(t.type!==e.type||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity||!Dye(t.effect,e.effect))return!1;if(t.activeLayerId!=null||e.activeLayerId!=null)return t.activeLayerId===e.activeLayerId;if(t.sublayers!=null||e.sublayers!=null){if(t.sublayers==null||e.sublayers==null||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const r=t.sublayers.at(i),n=e.sublayers.at(i);if((r==null?void 0:r.id)!==(n==null?void 0:n.id)||(r==null?void 0:r.visible)!==(n==null?void 0:n.visible))return!1}}return!0}function fK(t){return t?ws(t).replace(/^\s*https?:/i,"").toLowerCase():""}function yK(t){if(!t)return null;const{thumbnailUrl:e}=t;if(e)return e;const i=Vye(t);return i?ab[i].thumbnailUrl:Qv(t.baseLayers,Zye)}function Zye(t){var e;return"portalItem"in t?(e=t.portalItem)==null?void 0:e.thumbnailUrl:void 0}function Kye(t){return new c3({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const i=[];return"tables"in e&&i.push(e.tables),"layers"in e&&i.push(e.layers),i},itemFilterFunction:e=>{const i=e.parent;return!!i&&"tables"in i&&i.tables.includes(e)}})}function _9(t){for(const e of t.values())e==null||e.destroy();t.clear()}const AD={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Yye(t){let e=null;if(typeof t=="string")if(t in AD){const i=AD[t];e=new u3({resourceInfo:{data:{layers:[i]}}})}else fe.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=Yi(u3,t);return e}function ub(t,e,i=!1){let{hasM:r,hasZ:n}=t;Array.isArray(e)?e.length!==4||r||n?e.length===3&&i&&!r?(n=!0,r=!1):e.length===3&&r&&n&&(r=!1,n=!1):(r=!0,n=!0):(n=!n&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=r}var pC;function LD(t){return(e,i)=>e==null?i:i==null?e:t(e,i)}function Xye(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Ad=pC=class extends td{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){var n;if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):Xye(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const r=(n=i.points)==null?void 0:n[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new jt,i=this.hasZ,r=this.hasM,n=i?3:2,o=t[0],u=LD(Math.min),p=LD(Math.max);let g,w,S,T,[E,C]=o,[L,R]=o;for(let F=0,V=t.length;F<V;F++){const U=t[F],[W,H]=U;if(E=u(E,W),C=u(C,H),L=p(L,W),R=p(R,H),i&&U.length>2){const J=U[2];g=u(g,J),S=p(S,J)}if(r&&U.length>n){const J=U[n];w=u(w,J),T=p(T,J)}}return e.xmin=E,e.ymin=C,e.xmax=L,e.ymax=R,e.spatialReference=this.spatialReference,i?(e.zmin=g,e.zmax=S):(e.zmin=void 0,e.zmax=void 0),r?(e.mmin=w,e.mmax=T):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=ae(this.points)}addPoint(t){return ub(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:ae(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new pC(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=e[2],r=3),this.hasM&&(i.m=e[r]),new Ke(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Ke(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(ub(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};m([b({readOnly:!0})],Ad.prototype,"cache",null),m([b()],Ad.prototype,"extent",null),m([b({type:[[Number]],json:{write:{isRequired:!0}}})],Ad.prototype,"points",void 0),m([Le("points")],Ad.prototype,"writePoints",null),Ad=pC=m([G("esri.geometry.Multipoint")],Ad),Ad.prototype.toJSON.isDefaultToJSON=!0;const lh=Ad;function HWe(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function Qye(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var Ju;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(Ju||(Ju={}));function OD(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,i=t.hasM;if(t.type==="point")return i&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:i?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice(0);if(t.type==="polyline")return t.paths.slice(0);if(t.type==="multipoint")return t.points.slice(0);if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let n=!1,o=!1;return r.forEach(u=>{u.hasZ&&(n=!0),u.hasM&&(o=!0)}),r.map(u=>{const p=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(n&&u.hasZ){const g=.5*(u.zmax-u.zmin);for(let w=0;w<p.length;w++)p[w].push(g)}if(o&&u.hasM){const g=.5*(u.mmax-u.mmin);for(let w=0;w<p.length;w++)p[w].push(g)}return p})}return null}function BI(t,e){const i=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)}return Math.sqrt(i*i+r*r)}function mK(t,e,i){const r=t[0]+i*(e[0]-t[0]),n=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[r,n,t[2]+i*(e[2]-t[2])]:[r,n]}function eme(t,e,i,r){return tme(t,e,i[r],i[r+1])}function tme(t,e,i,r){const[n,o]=e,[u,p]=i,[g,w]=r,S=g-u,T=w-p,E=S*S+T*T,C=(n-u)*S+(o-p)*T,L=Math.min(1,Math.max(0,C/E));return t[0]=u+S*L,t[1]=p+T*L,t}function WWe(t,e,i,r,n,o){let u=i,p=r,g=n-u,w=o-p;if(g!==0||w!==0){const S=((t-u)*g+(e-p)*w)/(g*g+w*w);S>1?(u=n,p=o):S>0&&(u+=g*S,p+=w*S)}return g=t-u,w=e-p,g*g+w*w}function gK(t,e){return mK(t,e,.5)}function JWe(t){const e=t.length;let i=0;for(let r=0;r<e-1;++r)i+=BI(t[r],t[r+1]);return i}function ZWe(t,e){if(e<=0)return t[0];const i=t.length;let r=0;for(let n=0;n<i-1;++n){const o=BI(t[n],t[n+1]);if(e-r<o){const u=(e-r)/o;return mK(t[n],t[n+1],u)}r+=o}return t[i-1]}function vK(t,e=Ju.X,i=Ju.Y){let r=0;const n=t.length;let o=t[0];for(let u=1;u<n;u++){const p=t[u];r+=(p[e]-o[e])*(p[i]+o[i]),o=p}if(!bK(t)){const u=t[0];r+=(u[e]-o[e])*(u[i]+o[i])}return r>=0}function bK(t){const e=t.length;return e<3||Rb(t[0],t[e-1])}function KWe(t){"rings"in t&&(ime(t),rme(t))}function ime(t){if(!("rings"in t))return!1;let e=!1;for(const i of t.rings)bK(i)||(i.push(i[0].slice()),e=!0);return e}function rme(t){if(!("rings"in t)||t.rings.length===0||vK(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function YWe(t){return t.type!=="polygon"&&t.type!=="polyline"||nme(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function nme(t,e){const i=_s(e);if(!i)return;const r=i.valid[0],n=i.valid[1],o=n-r;for(const u of t){let p=1/0,g=-1/0;for(const S of u){const T=wK(S[0],r,n);p=Math.min(p,T),g=Math.max(g,T),S[0]=T}const w=g-p;o-w<w&&u.forEach(S=>{S[0]<0&&(S[0]+=o)})}}function wK(t,e,i){const r=i-e;return t<e?i-(e-t)%r:t>i?e+(t-e)%r:t}function XWe(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[i,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return i.length===r.length&&i.every((n,o)=>n.length===r[o].length)}function QWe(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function sme(t){return t?ome(t.rings,t.hasZ??!1):null}function ome(t,e){if(!(t!=null&&t.length))return null;const i=[],r=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let o=0,u=t.length;o<u;o++){const p=_K(t[o],e,n);p&&r.push(p)}if(r.sort((o,u)=>{let p=o[2]-u[2];return p===0&&e&&(p=o[4]-u[4]),p}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const o=t[0]&&t[0].length?ame(t[0],e):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function _K(t,e,i){let r=0,n=0,o=0,u=0,p=0;const g=t.length?t[0][0]:0,w=t.length?t[0][1]:0,S=t.length&&e?t[0][2]:0;for(let E=0;E<t.length;E++){const C=t[E],L=t[(E+1)%t.length],[R,F,V]=C,U=R-g,W=F-w,[H,J,X]=L,te=H-g,oe=J-w,pe=U*oe-te*W;if(u+=pe,r+=(U+te)*pe,n+=(W+oe)*pe,e&&C.length>2&&L.length>2){const de=V-S,ge=X-S,we=U*ge-te*de;o+=(de+ge)*we,p+=we}R<i[0]&&(i[0]=R),R>i[1]&&(i[1]=R),F<i[2]&&(i[2]=F),F>i[3]&&(i[3]=F),e&&(V<i[4]&&(i[4]=V),V>i[5]&&(i[5]=V))}if(u>0&&(u*=-1),p>0&&(p*=-1),!u)return null;u*=.5,p*=.5;const T=[r/(6*u)+g,n/(6*u)+w,u];return e&&(i[4]===i[5]||p===0?(T[3]=(i[4]+i[5])/2,T[4]=0):(T[3]=o/(6*p)+S,T[4]=p)),T}function eJe(t,e){let i=0,r=0,n=0;t.nextPoint();const o=t.pathSize?t.x:0,u=t.pathSize?t.y:0;for(let p=0;p<t.pathSize;p++){t.seekInPath(p);const g=[t.x,t.y];t.seekInPath((p+1)%t.pathSize);const w=[t.x,t.y],[S,T]=g,E=S-o,C=T-u,[L,R]=w,F=L-o,V=R-u,U=E*V-F*C;n+=U,i+=(E+F)*U,r+=(C+V)*U,S<e[0]&&(e[0]=S),S>e[1]&&(e[1]=S),T<e[2]&&(e[2]=T),T>e[3]&&(e[3]=T)}return n>0&&(n*=-1),n?(n*=.5,[i/(6*n)+o,r/(6*n)+u,n]):null}function ame(t,e){const i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,o=0,u=0,p=0;for(let g=0,w=t.length;g<w-1;g++){const S=t[g],T=t[g+1];if(S&&T){i[0]=S[0],i[1]=S[1],r[0]=T[0],r[1]=T[1],e&&S.length>2&&T.length>2&&(i[2]=S[2],r[2]=T[2]);const E=BI(i,r);if(E){n+=E;const C=gK(S,T);o+=E*C[0],u+=E*C[1],e&&C.length>2&&(p+=E*C[2])}}}return n>0?e?[o/n,u/n,p/n]:[o/n,u/n]:t.length?t[0]:null}function lme(t){const{hasZ:e,totalSize:i}=t;if(i===0)return null;const r=[],n=[],o=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const u=_K(Qye(t),t.hasZ,o);u&&n.push(u)}if(n.sort((u,p)=>{let g=u[2]-p[2];return g===0&&e&&(g=u[4]-p[4]),g}),n.length&&(r[0]=n[0][0],r[1]=n[0][1],e&&(r[2]=n[0][3]),(r[0]<o[0]||r[0]>o[1]||r[1]<o[2]||r[1]>o[3]||e&&(r[2]<o[4]||r[2]>o[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const u=t.pathSize?ume(t):null;if(!u)return null;r[0]=u[0],r[1]=u[1],e&&u.length>2&&(r[2]=u[2])}return r}function ume(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,o=0,u=0,p=0;if(t.nextPoint()){let g=t.x,w=t.y,S=t.z;for(;t.nextPoint();){const T=t.x,E=t.y,C=t.z;i[0]=g,i[1]=w,r[0]=T,r[1]=E,e&&(i[2]=S,r[2]=C);const L=BI(i,r);if(L){n+=L;const R=gK(i,r);o+=L*R[0],u+=L*R[1],e&&R.length>2&&(p+=L*R[2])}g=T,w=E,S=C}}return n>0?e?[o/n,u/n,p/n]:[o/n,u/n]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const cme=1e-6;function tJe(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<cme){const n=lme(t);return n?[n[0],n[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)pme(i,r,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=r[0],i[1]+=r[1],i}const hme=1/3;function pme(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,n=i.y;i.nextPoint();let o,u=i.x-r,p=i.y-n,g=0,w=0;for(;i.nextPoint();)g=i.x-r,w=i.y-n,o=.5*hme*(g*p-w*u),t[0]+=o*(u+g),t[1]+=o*(p+w),u=g,p=w;const S=i.getCurrentRingArea(),T=[r,n];return T[0]-=e[0],T[1]-=e[1],T[0]*=S,T[1]*=S,t[0]+=T[0],t[1]+=T[1],t}function bs(t=fme){return[t[0],t[1],t[2],t[3]]}function SK(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function iJe(t,e,i,r,n=bs()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function dme(t,e=bs()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function xK(t,e){return new jt({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function rJe(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function nJe(t,e,i){if(e!=null)if("length"in e)dC(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else SK(i,t)}function sJe(t,e,i=t){const r=e.length;let n=t[0],o=t[1],u=t[2],p=t[3];for(let g=0;g<r;g++){const w=e[g];n=Math.min(n,w[0]),o=Math.min(o,w[1]),u=Math.max(u,w[0]),p=Math.max(p,w[1])}return i[0]=n,i[1]=o,i[2]=u,i[3]=p,i}function oJe(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function $K(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function TK(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function aJe(t){return $K(t)*TK(t)}function lJe(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function uJe(t,e){return EK(t,e.x,e.y)}function EK(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function cJe(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function OP(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function hJe(t,e,i,r=t){return r[0]=t[0]+e,r[1]=t[1]+i,r[2]=t[2]+e,r[3]=t[3]+i,r}function pJe(t){return t?SK(t,PD):bs(PD)}function dC(t){return t!=null&&t.length===4}function dJe(t,e){return dC(t)&&dC(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const PD=[1/0,1/0,-1/0,-1/0],fme=[0,0,0,0];function IK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function MK(t){return t.points!==void 0}function kK(t){return t.x!==void 0&&t.y!==void 0}function CK(t){return t.paths!==void 0}function AK(t){return t.rings!==void 0}function LK(t){function e(i,r){return i==null?r:r==null?i:t(i,r)}return e}const Rf=LK(Math.min),Ff=LK(Math.max);function fJe(t,e){return CK(e)?cb(t,e.paths,!1,!1):AK(e)?cb(t,e.rings,!1,!1):MK(e)?PP(t,e.points,!1,!1,!1,!1):IK(e)?OK(t,e):(kK(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function yJe(t){let e,i,r,n;for(t.reset(),e=r=1/0,i=n=-1/0;t.nextPath();){const o=yme(t);e=Math.min(o[0],e),r=Math.min(o[1],r),i=Math.max(o[2],i),n=Math.max(o[3],n)}return bs([e,r,i,n])}function yme(t){let e,i,r,n;for(e=r=1/0,i=n=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),i=Math.max(t.x,i),n=Math.max(t.y,n);return bs([e,r,i,n])}function mJe(t,e){return CK(e)?cb(t,e.paths,!0,!1):AK(e)?cb(t,e.rings,!0,!1):MK(e)?PP(t,e.points,!0,!1,!0,!1):IK(e)?OK(t,e,!0,!1,!0,!1):(kK(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function cb(t,e,i,r){const n=i?3:2;if(!e.length||!e[0].length)return null;let o,u,p,g,[w,S]=e[0][0],[T,E]=e[0][0];for(let C=0;C<e.length;C++){const L=e[C];for(let R=0;R<L.length;R++){const F=L[R],[V,U]=F;if(w=Rf(w,V),S=Rf(S,U),T=Ff(T,V),E=Ff(E,U),i&&F.length>2){const W=F[2];o=Rf(o,W),u=Ff(u,W)}if(r&&F.length>n){const W=F[n];p=Rf(o,W),g=Ff(u,W)}}}return i?r?(t[0]=w,t[1]=S,t[2]=o,t[3]=p,t[4]=T,t[5]=E,t[6]=u,t[7]=g,t.length=8,t):(t[0]=w,t[1]=S,t[2]=o,t[3]=T,t[4]=E,t[5]=u,t.length=6,t):r?(t[0]=w,t[1]=S,t[2]=p,t[3]=T,t[4]=E,t[5]=g,t.length=6,t):(t[0]=w,t[1]=S,t[2]=T,t[3]=E,t.length=4,t)}function OK(t,e,i,r,n,o){const u=e.xmin,p=e.xmax,g=e.ymin,w=e.ymax;let S=e.zmin,T=e.zmax,E=e.mmin,C=e.mmax;return n?(S=S||0,T=T||0,o?(E=E||0,C=C||0,t[0]=u,t[1]=g,t[2]=S,t[3]=E,t[4]=p,t[5]=w,t[6]=T,t[7]=C,t):(t[0]=u,t[1]=g,t[2]=S,t[3]=p,t[4]=w,t[5]=T,t)):o?(E=E||0,C=C||0,t[0]=u,t[1]=g,t[2]=E,t[3]=p,t[4]=w,t[5]=C,t):(t[0]=u,t[1]=g,t[2]=p,t[3]=w,t)}function PP(t,e,i,r,n,o){const u=i?3:2,p=r&&o,g=i&&n;if(!e.length||!e[0].length)return null;let w,S,T,E,[C,L]=e[0],[R,F]=e[0];for(let V=0;V<e.length;V++){const U=e[V],[W,H]=U;if(C=Rf(C,W),L=Rf(L,H),R=Ff(R,W),F=Ff(F,H),g&&U.length>2){const J=U[2];w=Rf(w,J),S=Ff(S,J)}if(p&&U.length>u){const J=U[u];T=Rf(w,J),E=Ff(S,J)}}return n?(w=w||0,S=S||0,o?(T=T||0,E=E||0,t[0]=C,t[1]=L,t[2]=w,t[3]=T,t[4]=R,t[5]=F,t[6]=S,t[7]=E,t):(t[0]=C,t[1]=L,t[2]=w,t[3]=R,t[4]=F,t[5]=S,t)):o?(T=T||0,E=E||0,t[0]=C,t[1]=L,t[2]=T,t[3]=R,t[4]=F,t[5]=E,t):(t[0]=C,t[1]=L,t[2]=R,t[3]=F,t)}function mme(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function gme(t){return t.points!==void 0}function vme(t){return t.x!==void 0&&t.y!==void 0}function bme(t){return t.paths!==void 0}function wme(t){return t.rings!==void 0}const RP=[];function PK(t,e,i,r){return{xmin:t,ymin:e,xmax:i,ymax:r}}function RK(t,e,i,r,n,o){return{xmin:t,ymin:e,zmin:i,xmax:r,ymax:n,zmax:o}}function FK(t,e,i,r,n,o){return{xmin:t,ymin:e,mmin:i,xmax:r,ymax:n,mmax:o}}function NK(t,e,i,r,n,o,u,p){return{xmin:t,ymin:e,zmin:i,mmin:r,xmax:n,ymax:o,zmax:u,mmax:p}}function FP(t,e=!1,i=!1){return e?i?NK(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):RK(t[0],t[1],t[2],t[3],t[4],t[5]):i?FK(t[0],t[1],t[2],t[3],t[4],t[5]):PK(t[0],t[1],t[2],t[3])}function gJe(t){return t?mme(t)?t:vme(t)?Sme(t):wme(t)?DK(t):bme(t)?jK(t):gme(t)?_me(t):null:null}function _me(t){const{hasZ:e,hasM:i,points:r}=t;return FP(PP(RP,r,e??!1,i??!1),e,i)}function Sme(t){const{x:e,y:i,z:r,m:n}=t,o=n!=null;return r!=null?o?NK(e,i,r,n,e,i,r,n):RK(e,i,r,e,i,r):o?FK(e,i,n,e,i,n):PK(e,i,e,i)}function DK(t){const{hasZ:e,hasM:i,rings:r}=t,n=cb(RP,r,e??!1,i??!1);return n?FP(n,e,i):null}function jK(t){const{hasZ:e,hasM:i,paths:r}=t,n=cb(RP,r,e??!1,i??!1);return n?FP(n,e,i):null}var tT;function RD(t){return!Array.isArray(t[0])}let gc=tT=class extends td{static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let r=!1,n=!1;for(const u of e)u.hasZ&&(r=!0),u.hasM&&(n=!0);const o={rings:e.map(u=>{const p=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(r&&u.hasZ){const g=u.zmin+.5*(u.zmax-u.zmin);for(let w=0;w<p.length;w++)p[w].push(g)}if(n&&u.hasM){const g=u.mmin+.5*(u.mmax-u.mmin);for(let w=0;w<p.length;w++)p[w].push(g)}return p}),spatialReference:i};return r&&(o.hasZ=!0),n&&(o.hasM=!0),new tT(o)}constructor(...t){super(...t),this.rings=[],this.type="polygon"}normalizeCtorArgs(t,e){var u,p;let i,r,n=null,o=null;return t&&!Array.isArray(t)?(n=t.rings??null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,r=t.hasM):n=t,n=n||[],e=e||Ge.WGS84,n.length&&((u=n[0])==null?void 0:u[0])!=null&&typeof n[0][0]=="number"&&(n=[n]),o=(p=n[0])==null?void 0:p[0],o&&(i===void 0&&r===void 0?(i=o.length>2,r=o.length>3):i===void 0?i=r?o.length>3:o.length>2:r===void 0&&(r=i?o.length>3:o.length>2)),{rings:n,spatialReference:e,hasZ:i,hasM:r}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=sme(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new Ke;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=DK(this);if(!e)return null;const i=new jt(e);return i.spatialReference=t,i}get isSelfIntersecting(){return vfe(this.rings)}writeRings(t,e){e.rings=ae(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(RD(t)){const r=[];for(let n=0,o=t.length;n<o;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new tT;return t.spatialReference=this.spatialReference,t.rings=ae(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const r=([n,o,u,p],[g,w,S,T])=>n===g&&o===w&&(u==null&&S==null||u===S)&&(p==null&&T==null||p===T);for(let n=0;n<this.rings.length;n++){const o=this.rings[n],u=t.rings[n];if(!Rb(o,u,r))return!1}return!0}contains(t){if(!t)return!1;const e=Y3(t,this.spatialReference);return gP(this,e??t)}isClockwise(t){const e=RD(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t;return vK(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new Ke(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new Ke(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new Ke(i[0],i[1],i[2],i[3],this.spatialReference):new Ke(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(ub(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Ke(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new Ke(n,i));return this.notifyChange("rings"),r}setPoint(t,e,i){return this._validateInputs(t,e)?(ub(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};m([b({readOnly:!0})],gc.prototype,"cache",null),m([b({readOnly:!0})],gc.prototype,"centroid",null),m([b({readOnly:!0})],gc.prototype,"extent",null),m([b({readOnly:!0})],gc.prototype,"isSelfIntersecting",null),m([b({type:[[[Number]]],json:{write:{isRequired:!0}}})],gc.prototype,"rings",void 0),m([Le("rings")],gc.prototype,"writeRings",null),gc=tT=m([G("esri.geometry.Polygon")],gc),gc.prototype.toJSON.isDefaultToJSON=!0;const xo=gc;var fC;function xme(t){return!Array.isArray(t[0])}let Ld=fC=class extends td{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){var u,p;let i,r,n=null,o=null;return t&&!Array.isArray(t)?(n=t.paths??null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,r=t.hasM):n=t,n=n||[],e=e||Ge.WGS84,n.length&&((u=n[0])==null?void 0:u[0])!=null&&typeof n[0][0]=="number"&&(n=[n]),o=(p=n[0])==null?void 0:p[0],o&&(i===void 0&&r===void 0?(i=o.length>2,r=!1):i===void 0?i=!r&&o.length>3:r===void 0&&(r=!i&&o.length>3)),{paths:n,spatialReference:e,hasZ:i,hasM:r}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=jK(this);if(!e)return null;const i=new jt(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=ae(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(xme(t)){const r=[];for(let n=0,o=t.length;n<o;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new fC;return t.spatialReference=this.spatialReference,t.paths=ae(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new Ke(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new Ke(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new Ke(i[0],i[1],i[2],i[3],this.spatialReference):new Ke(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(ub(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new Ke(n,i));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Ke(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(ub(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};m([b({readOnly:!0})],Ld.prototype,"cache",null),m([b({readOnly:!0})],Ld.prototype,"extent",null),m([b({type:[[[Number]]],json:{write:{isRequired:!0}}})],Ld.prototype,"paths",void 0),m([Le("paths")],Ld.prototype,"writePaths",null),Ld=fC=m([G("esri.geometry.Polyline")],Ld),Ld.prototype.toJSON.isDefaultToJSON=!0;const Bn=Ld,$me=dt()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),FD=dt()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function VK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function zK(t){return t.points!==void 0}function UK(t){return t.x!==void 0&&t.y!==void 0}function GK(t){return t.paths!==void 0}function xv(t){return t.rings!==void 0}function dh(t){return t==null?null:t instanceof td?t:UK(t)?Ke.fromJSON(t):GK(t)?Bn.fromJSON(t):xv(t)?xo.fromJSON(t):zK(t)?lh.fromJSON(t):VK(t)?jt.fromJSON(t):null}function rS(t){return t?UK(t)?"esriGeometryPoint":GK(t)?"esriGeometryPolyline":xv(t)?"esriGeometryPolygon":VK(t)?"esriGeometryEnvelope":zK(t)?"esriGeometryMultipoint":null:null}const Tme={esriGeometryPoint:Ke,esriGeometryPolyline:Bn,esriGeometryPolygon:xo,esriGeometryEnvelope:jt,esriGeometryMultipoint:lh};function Eme(t){return t&&Tme[t]||null}const h0={base:td,key:"type",typeMap:{extent:jt,multipoint:lh,point:Ke,polyline:Bn,polygon:xo}};ch(h0);const ND=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class Bm extends Error{}class Ime extends Bm{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Mme extends Bm{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class kme extends Bm{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class ov extends Bm{}class BK extends Bm{constructor(e){super(`Invalid unit ${e}`)}}class Bo extends Bm{}class md extends Bm{constructor(){super("Zone is an abstract class")}}const Ve="numeric",Qu="short",Va="long",cE={year:Ve,month:Ve,day:Ve},qK={year:Ve,month:Qu,day:Ve},Cme={year:Ve,month:Qu,day:Ve,weekday:Qu},HK={year:Ve,month:Va,day:Ve},WK={year:Ve,month:Va,day:Ve,weekday:Va},JK={hour:Ve,minute:Ve},ZK={hour:Ve,minute:Ve,second:Ve},KK={hour:Ve,minute:Ve,second:Ve,timeZoneName:Qu},YK={hour:Ve,minute:Ve,second:Ve,timeZoneName:Va},XK={hour:Ve,minute:Ve,hourCycle:"h23"},QK={hour:Ve,minute:Ve,second:Ve,hourCycle:"h23"},eY={hour:Ve,minute:Ve,second:Ve,hourCycle:"h23",timeZoneName:Qu},tY={hour:Ve,minute:Ve,second:Ve,hourCycle:"h23",timeZoneName:Va},iY={year:Ve,month:Ve,day:Ve,hour:Ve,minute:Ve},rY={year:Ve,month:Ve,day:Ve,hour:Ve,minute:Ve,second:Ve},nY={year:Ve,month:Qu,day:Ve,hour:Ve,minute:Ve},sY={year:Ve,month:Qu,day:Ve,hour:Ve,minute:Ve,second:Ve},Ame={year:Ve,month:Qu,day:Ve,weekday:Qu,hour:Ve,minute:Ve},oY={year:Ve,month:Va,day:Ve,hour:Ve,minute:Ve,timeZoneName:Qu},aY={year:Ve,month:Va,day:Ve,hour:Ve,minute:Ve,second:Ve,timeZoneName:Qu},lY={year:Ve,month:Va,day:Ve,weekday:Va,hour:Ve,minute:Ve,timeZoneName:Va},uY={year:Ve,month:Va,day:Ve,weekday:Va,hour:Ve,minute:Ve,second:Ve,timeZoneName:Va};class qm{get type(){throw new md}get name(){throw new md}get ianaName(){return this.name}get isUniversal(){throw new md}offsetName(e,i){throw new md}formatOffset(e,i){throw new md}offset(e){throw new md}equals(e){throw new md}get isValid(){throw new md}}let S9=null;class qI extends qm{static get instance(){return S9===null&&(S9=new qI),S9}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return vY(e,i,r)}formatOffset(e,i){return x2(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let iT={};function Lme(t){return iT[t]||(iT[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),iT[t]}const Ome={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Pme(t,e){const i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,n,o,u,p,g,w,S]=r;return[u,n,o,p,g,w,S]}function Rme(t,e){const i=t.formatToParts(e),r=[];for(let n=0;n<i.length;n++){const{type:o,value:u}=i[n],p=Ome[o];o==="era"?r[p]=u:wt(p)||(r[p]=parseInt(u,10))}return r}let cx={};class ia extends qm{static create(e){return cx[e]||(cx[e]=new ia(e)),cx[e]}static resetCache(){cx={},iT={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=ia.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return vY(e,i,r,this.name)}formatOffset(e,i){return x2(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const r=Lme(this.name);let[n,o,u,p,g,w,S]=r.formatToParts?Rme(r,i):Pme(r,i);p==="BC"&&(n=-Math.abs(n)+1);const E=WI({year:n,month:o,day:u,hour:g===24?0:g,minute:w,second:S,millisecond:0});let C=+i;const L=C%1e3;return C-=L>=0?L:1e3+L,(E-C)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let DD={};function Fme(t,e={}){const i=JSON.stringify([t,e]);let r=DD[i];return r||(r=new Intl.ListFormat(t,e),DD[i]=r),r}let yC={};function mC(t,e={}){const i=JSON.stringify([t,e]);let r=yC[i];return r||(r=new Intl.DateTimeFormat(t,e),yC[i]=r),r}let gC={};function Nme(t,e={}){const i=JSON.stringify([t,e]);let r=gC[i];return r||(r=new Intl.NumberFormat(t,e),gC[i]=r),r}let vC={};function Dme(t,e={}){const{base:i,...r}=e,n=JSON.stringify([t,r]);let o=vC[n];return o||(o=new Intl.RelativeTimeFormat(t,e),vC[n]=o),o}let r_=null;function jme(){return r_||(r_=new Intl.DateTimeFormat().resolvedOptions().locale,r_)}let jD={};function Vme(t){let e=jD[t];if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,jD[t]=e}return e}function zme(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let r,n;try{r=mC(t).resolvedOptions(),n=t}catch{const g=t.substring(0,i);r=mC(g).resolvedOptions(),n=g}const{numberingSystem:o,calendar:u}=r;return[n,o,u]}}function Ume(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function Gme(t){const e=[];for(let i=1;i<=12;i++){const r=De.utc(2009,i,1);e.push(t(r))}return e}function Bme(t){const e=[];for(let i=1;i<=7;i++){const r=De.utc(2016,11,13+i);e.push(t(r))}return e}function hx(t,e,i,r){const n=t.listingMode();return n==="error"?null:n==="en"?i(e):r(e)}function qme(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class Hme{constructor(e,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:o,...u}=r;if(!i||Object.keys(u).length>0){const p={useGrouping:!1,...r};r.padTo>0&&(p.minimumIntegerDigits=r.padTo),this.inf=Nme(e,p)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):VP(e,3);return bn(i,this.padTo)}}}class Wme{constructor(e,i,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const u=-1*(e.offset/60),p=u>=0?`Etc/GMT+${u}`:`Etc/GMT${u}`;e.offset!==0&&ia.create(p).valid?(n=p,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const o={...this.opts};o.timeZone=o.timeZone||n,this.dtf=mC(i,o)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Jme{constructor(e,i,r){this.opts={style:"long",...r},!i&&mY()&&(this.rtf=Dme(e,r))}format(e,i){return this.rtf?this.rtf.format(e,i):fge(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const Zme={firstDay:1,minimalDays:4,weekend:[6,7]};class Wi{static fromOpts(e){return Wi.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,r,n,o=!1){const u=e||sn.defaultLocale,p=u||(o?"en-US":jme()),g=i||sn.defaultNumberingSystem,w=r||sn.defaultOutputCalendar,S=bC(n)||sn.defaultWeekSettings;return new Wi(p,g,w,S,u)}static resetCache(){r_=null,yC={},gC={},vC={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:r,weekSettings:n}={}){return Wi.create(e,i,r,n)}constructor(e,i,r,n,o){const[u,p,g]=zme(e);this.locale=u,this.numberingSystem=i||p||null,this.outputCalendar=r||g||null,this.weekSettings=n,this.intl=Ume(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=o,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=qme(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Wi.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,bC(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return hx(this,e,_Y,()=>{const r=i?{month:e,day:"numeric"}:{month:e},n=i?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=Gme(o=>this.extract(o,r,"month"))),this.monthsCache[n][e]})}weekdays(e,i=!1){return hx(this,e,$Y,()=>{const r=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=i?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=Bme(o=>this.extract(o,r,"weekday"))),this.weekdaysCache[n][e]})}meridiems(){return hx(this,void 0,()=>TY,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[De.utc(2016,11,13,9),De.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return hx(this,e,EY,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[De.utc(-40,1,1),De.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[e]})}extract(e,i,r){const n=this.dtFormatter(e,i),o=n.formatToParts(),u=o.find(p=>p.type.toLowerCase()===r);return u?u.value:null}numberFormatter(e={}){return new Hme(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new Wme(e,this.intl,i)}relFormatter(e={}){return new Jme(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Fme(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:gY()?Vme(this.locale):Zme}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let x9=null;class an extends qm{static get utcInstance(){return x9===null&&(x9=new an(0)),x9}static instance(e){return e===0?an.utcInstance:new an(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new an(JI(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${x2(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${x2(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return x2(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class Kme extends qm{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Af(t,e){if(wt(t)||t===null)return e;if(t instanceof qm)return t;if(Qme(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?qI.instance:i==="utc"||i==="gmt"?an.utcInstance:an.parseSpecifier(i)||ia.create(t)}else return cm(t)?an.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new Kme(t)}let VD=()=>Date.now(),zD="system",UD=null,GD=null,BD=null,qD=60,HD,WD=null;class sn{static get now(){return VD}static set now(e){VD=e}static set defaultZone(e){zD=e}static get defaultZone(){return Af(zD,qI.instance)}static get defaultLocale(){return UD}static set defaultLocale(e){UD=e}static get defaultNumberingSystem(){return GD}static set defaultNumberingSystem(e){GD=e}static get defaultOutputCalendar(){return BD}static set defaultOutputCalendar(e){BD=e}static get defaultWeekSettings(){return WD}static set defaultWeekSettings(e){WD=bC(e)}static get twoDigitCutoffYear(){return qD}static set twoDigitCutoffYear(e){qD=e%100}static get throwOnInvalid(){return HD}static set throwOnInvalid(e){HD=e}static resetCaches(){Wi.resetCache(),ia.resetCache()}}class Vu{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const cY=[0,31,59,90,120,151,181,212,243,273,304,334],hY=[0,31,60,91,121,152,182,213,244,274,305,335];function Ol(t,e){return new Vu("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function NP(t,e,i){const r=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const n=r.getUTCDay();return n===0?7:n}function pY(t,e,i){return i+(nS(t)?hY:cY)[e-1]}function dY(t,e){const i=nS(t)?hY:cY,r=i.findIndex(o=>o<e),n=e-i[r];return{month:r+1,day:n}}function DP(t,e){return(t-e+7)%7+1}function hE(t,e=4,i=1){const{year:r,month:n,day:o}=t,u=pY(r,n,o),p=DP(NP(r,n,o),i);let g=Math.floor((u-p+14-e)/7),w;return g<1?(w=r-1,g=d3(w,e,i)):g>d3(r,e,i)?(w=r+1,g=1):w=r,{weekYear:w,weekNumber:g,weekday:p,...ZI(t)}}function JD(t,e=4,i=1){const{weekYear:r,weekNumber:n,weekday:o}=t,u=DP(NP(r,1,e),i),p=$v(r);let g=n*7+o-u-7+e,w;g<1?(w=r-1,g+=$v(w)):g>p?(w=r+1,g-=$v(r)):w=r;const{month:S,day:T}=dY(w,g);return{year:w,month:S,day:T,...ZI(t)}}function $9(t){const{year:e,month:i,day:r}=t,n=pY(e,i,r);return{year:e,ordinal:n,...ZI(t)}}function ZD(t){const{year:e,ordinal:i}=t,{month:r,day:n}=dY(e,i);return{year:e,month:r,day:n,...ZI(t)}}function KD(t,e){if(!wt(t.localWeekday)||!wt(t.localWeekNumber)||!wt(t.localWeekYear)){if(!wt(t.weekday)||!wt(t.weekNumber)||!wt(t.weekYear))throw new ov("Cannot mix locale-based week fields with ISO-based week fields");return wt(t.localWeekday)||(t.weekday=t.localWeekday),wt(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),wt(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Yme(t,e=4,i=1){const r=HI(t.weekYear),n=Pl(t.weekNumber,1,d3(t.weekYear,e,i)),o=Pl(t.weekday,1,7);return r?n?o?!1:Ol("weekday",t.weekday):Ol("week",t.weekNumber):Ol("weekYear",t.weekYear)}function Xme(t){const e=HI(t.year),i=Pl(t.ordinal,1,$v(t.year));return e?i?!1:Ol("ordinal",t.ordinal):Ol("year",t.year)}function fY(t){const e=HI(t.year),i=Pl(t.month,1,12),r=Pl(t.day,1,pE(t.year,t.month));return e?i?r?!1:Ol("day",t.day):Ol("month",t.month):Ol("year",t.year)}function yY(t){const{hour:e,minute:i,second:r,millisecond:n}=t,o=Pl(e,0,23)||e===24&&i===0&&r===0&&n===0,u=Pl(i,0,59),p=Pl(r,0,59),g=Pl(n,0,999);return o?u?p?g?!1:Ol("millisecond",n):Ol("second",r):Ol("minute",i):Ol("hour",e)}function wt(t){return typeof t>"u"}function cm(t){return typeof t=="number"}function HI(t){return typeof t=="number"&&t%1===0}function Qme(t){return typeof t=="string"}function ege(t){return Object.prototype.toString.call(t)==="[object Date]"}function mY(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function gY(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function tge(t){return Array.isArray(t)?t:[t]}function YD(t,e,i){if(t.length!==0)return t.reduce((r,n)=>{const o=[e(n),n];return r&&i(r[0],o[0])===r[0]?r:o},null)[1]}function ige(t,e){return e.reduce((i,r)=>(i[r]=t[r],i),{})}function hb(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function bC(t){if(t==null)return null;if(typeof t!="object")throw new Bo("Week settings must be an object");if(!Pl(t.firstDay,1,7)||!Pl(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Pl(e,1,7)))throw new Bo("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Pl(t,e,i){return HI(t)&&t>=e&&t<=i}function rge(t,e){return t-e*Math.floor(t/e)}function bn(t,e=2){const i=t<0;let r;return i?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function xf(t){if(!(wt(t)||t===null||t===""))return parseInt(t,10)}function S0(t){if(!(wt(t)||t===null||t===""))return parseFloat(t)}function jP(t){if(!(wt(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function VP(t,e,i=!1){const r=10**e;return(i?Math.trunc:Math.round)(t*r)/r}function nS(t){return t%4===0&&(t%100!==0||t%400===0)}function $v(t){return nS(t)?366:365}function pE(t,e){const i=rge(e-1,12)+1,r=t+(e-i)/12;return i===2?nS(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function WI(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function XD(t,e,i){return-DP(NP(t,1,e),i)+e-1}function d3(t,e=4,i=1){const r=XD(t,e,i),n=XD(t+1,e,i);return($v(t)-r+n)/7}function wC(t){return t>99?t:t>sn.twoDigitCutoffYear?1900+t:2e3+t}function vY(t,e,i,r=null){const n=new Date(t),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);const u={timeZoneName:e,...o},p=new Intl.DateTimeFormat(i,u).formatToParts(n).find(g=>g.type.toLowerCase()==="timezonename");return p?p.value:null}function JI(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const r=parseInt(e,10)||0,n=i<0||Object.is(i,-0)?-r:r;return i*60+n}function bY(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new Bo(`Invalid unit value ${t}`);return e}function dE(t,e){const i={};for(const r in t)if(hb(t,r)){const n=t[r];if(n==null)continue;i[e(r)]=bY(n)}return i}function x2(t,e){const i=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),n=t>=0?"+":"-";switch(e){case"short":return`${n}${bn(i,2)}:${bn(r,2)}`;case"narrow":return`${n}${i}${r>0?`:${r}`:""}`;case"techie":return`${n}${bn(i,2)}${bn(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function ZI(t){return ige(t,["hour","minute","second","millisecond"])}const nge=["January","February","March","April","May","June","July","August","September","October","November","December"],wY=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],sge=["J","F","M","A","M","J","J","A","S","O","N","D"];function _Y(t){switch(t){case"narrow":return[...sge];case"short":return[...wY];case"long":return[...nge];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const SY=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],xY=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],oge=["M","T","W","T","F","S","S"];function $Y(t){switch(t){case"narrow":return[...oge];case"short":return[...xY];case"long":return[...SY];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const TY=["AM","PM"],age=["Before Christ","Anno Domini"],lge=["BC","AD"],uge=["B","A"];function EY(t){switch(t){case"narrow":return[...uge];case"short":return[...lge];case"long":return[...age];default:return null}}function cge(t){return TY[t.hour<12?0:1]}function hge(t,e){return $Y(e)[t.weekday-1]}function pge(t,e){return _Y(e)[t.month-1]}function dge(t,e){return EY(e)[t.year<0?0:1]}function fge(t,e,i="always",r=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&o){const T=t==="days";switch(e){case 1:return T?"tomorrow":`next ${n[t][0]}`;case-1:return T?"yesterday":`last ${n[t][0]}`;case 0:return T?"today":`this ${n[t][0]}`}}const u=Object.is(e,-0)||e<0,p=Math.abs(e),g=p===1,w=n[t],S=r?g?w[1]:w[2]||w[1]:g?n[t][0]:t;return u?`${p} ${S} ago`:`in ${p} ${S}`}function QD(t,e){let i="";for(const r of t)r.literal?i+=r.val:i+=e(r.val);return i}const yge={D:cE,DD:qK,DDD:HK,DDDD:WK,t:JK,tt:ZK,ttt:KK,tttt:YK,T:XK,TT:QK,TTT:eY,TTTT:tY,f:iY,ff:nY,fff:oY,ffff:lY,F:rY,FF:sY,FFF:aY,FFFF:uY};class Zs{static create(e,i={}){return new Zs(e,i)}static parseFormat(e){let i=null,r="",n=!1;const o=[];for(let u=0;u<e.length;u++){const p=e.charAt(u);p==="'"?(r.length>0&&o.push({literal:n||/^\s+$/.test(r),val:r}),i=null,r="",n=!n):n||p===i?r+=p:(r.length>0&&o.push({literal:/^\s+$/.test(r),val:r}),r=p,i=p)}return r.length>0&&o.push({literal:n||/^\s+$/.test(r),val:r}),o}static macroTokenToFormatOpts(e){return yge[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return bn(e,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,i){const r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",o=(C,L)=>this.loc.extract(e,C,L),u=C=>e.isOffsetFixed&&e.offset===0&&C.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,C.format):"",p=()=>r?cge(e):o({hour:"numeric",hourCycle:"h12"},"dayperiod"),g=(C,L)=>r?pge(e,C):o(L?{month:C}:{month:C,day:"numeric"},"month"),w=(C,L)=>r?hge(e,C):o(L?{weekday:C}:{weekday:C,month:"long",day:"numeric"},"weekday"),S=C=>{const L=Zs.macroTokenToFormatOpts(C);return L?this.formatWithSystemDefault(e,L):C},T=C=>r?dge(e,C):o({era:C},"era"),E=C=>{switch(C){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return u({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return u({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return u({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return p();case"d":return n?o({day:"numeric"},"day"):this.num(e.day);case"dd":return n?o({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return w("short",!0);case"cccc":return w("long",!0);case"ccccc":return w("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return w("short",!1);case"EEEE":return w("long",!1);case"EEEEE":return w("narrow",!1);case"L":return n?o({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?o({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return g("short",!0);case"LLLL":return g("long",!0);case"LLLLL":return g("narrow",!0);case"M":return n?o({month:"numeric"},"month"):this.num(e.month);case"MM":return n?o({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return g("short",!1);case"MMMM":return g("long",!1);case"MMMMM":return g("narrow",!1);case"y":return n?o({year:"numeric"},"year"):this.num(e.year);case"yy":return n?o({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?o({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?o({year:"numeric"},"year"):this.num(e.year,6);case"G":return T("short");case"GG":return T("long");case"GGGGG":return T("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return S(C)}};return QD(Zs.parseFormat(i),E)}formatDurationFromString(e,i){const r=g=>{switch(g[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=g=>w=>{const S=r(w);return S?this.num(g.get(S),w.length):w},o=Zs.parseFormat(i),u=o.reduce((g,{literal:w,val:S})=>w?g:g.concat(S),[]),p=e.shiftTo(...u.map(r).filter(g=>g));return QD(o,n(p))}}const IY=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function qb(...t){const e=t.reduce((i,r)=>i+r.source,"");return RegExp(`^${e}$`)}function Hb(...t){return e=>t.reduce(([i,r,n],o)=>{const[u,p,g]=o(e,n);return[{...i,...u},p||r,g]},[{},null,1]).slice(0,2)}function Wb(t,...e){if(t==null)return[null,null];for(const[i,r]of e){const n=i.exec(t);if(n)return r(n)}return[null,null]}function MY(...t){return(e,i)=>{const r={};let n;for(n=0;n<t.length;n++)r[t[n]]=xf(e[i+n]);return[r,null,i+n]}}const kY=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,mge=`(?:${kY.source}?(?:\\[(${IY.source})\\])?)?`,zP=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,CY=RegExp(`${zP.source}${mge}`),UP=RegExp(`(?:T${CY.source})?`),gge=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,vge=/(\d{4})-?W(\d\d)(?:-?(\d))?/,bge=/(\d{4})-?(\d{3})/,wge=MY("weekYear","weekNumber","weekDay"),_ge=MY("year","ordinal"),Sge=/(\d{4})-(\d\d)-(\d\d)/,AY=RegExp(`${zP.source} ?(?:${kY.source}|(${IY.source}))?`),xge=RegExp(`(?: ${AY.source})?`);function Tv(t,e,i){const r=t[e];return wt(r)?i:xf(r)}function $ge(t,e){return[{year:Tv(t,e),month:Tv(t,e+1,1),day:Tv(t,e+2,1)},null,e+3]}function Jb(t,e){return[{hours:Tv(t,e,0),minutes:Tv(t,e+1,0),seconds:Tv(t,e+2,0),milliseconds:jP(t[e+3])},null,e+4]}function sS(t,e){const i=!t[e]&&!t[e+1],r=JI(t[e+1],t[e+2]),n=i?null:an.instance(r);return[{},n,e+3]}function oS(t,e){const i=t[e]?ia.create(t[e]):null;return[{},i,e+1]}const Tge=RegExp(`^T?${zP.source}$`),Ege=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Ige(t){const[e,i,r,n,o,u,p,g,w]=t,S=e[0]==="-",T=g&&g[0]==="-",E=(C,L=!1)=>C!==void 0&&(L||C&&S)?-C:C;return[{years:E(S0(i)),months:E(S0(r)),weeks:E(S0(n)),days:E(S0(o)),hours:E(S0(u)),minutes:E(S0(p)),seconds:E(S0(g),g==="-0"),milliseconds:E(jP(w),T)}]}const Mge={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function GP(t,e,i,r,n,o,u){const p={year:e.length===2?wC(xf(e)):xf(e),month:wY.indexOf(i)+1,day:xf(r),hour:xf(n),minute:xf(o)};return u&&(p.second=xf(u)),t&&(p.weekday=t.length>3?SY.indexOf(t)+1:xY.indexOf(t)+1),p}const kge=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Cge(t){const[,e,i,r,n,o,u,p,g,w,S,T]=t,E=GP(e,n,r,i,o,u,p);let C;return g?C=Mge[g]:w?C=0:C=JI(S,T),[E,new an(C)]}function Age(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Lge=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Oge=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Pge=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ej(t){const[,e,i,r,n,o,u,p]=t;return[GP(e,n,r,i,o,u,p),an.utcInstance]}function Rge(t){const[,e,i,r,n,o,u,p]=t;return[GP(e,p,i,r,n,o,u),an.utcInstance]}const Fge=qb(gge,UP),Nge=qb(vge,UP),Dge=qb(bge,UP),jge=qb(CY),LY=Hb($ge,Jb,sS,oS),Vge=Hb(wge,Jb,sS,oS),zge=Hb(_ge,Jb,sS,oS),Uge=Hb(Jb,sS,oS);function Gge(t){return Wb(t,[Fge,LY],[Nge,Vge],[Dge,zge],[jge,Uge])}function Bge(t){return Wb(Age(t),[kge,Cge])}function qge(t){return Wb(t,[Lge,ej],[Oge,ej],[Pge,Rge])}function Hge(t){return Wb(t,[Ege,Ige])}const Wge=Hb(Jb);function Jge(t){return Wb(t,[Tge,Wge])}const Zge=qb(Sge,xge),Kge=qb(AY),Yge=Hb(Jb,sS,oS);function Xge(t){return Wb(t,[Zge,LY],[Kge,Yge])}const tj="Invalid Duration",OY={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Qge={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...OY},Za=146097/400,cg=146097/4800,e1e={years:{quarters:4,months:12,weeks:Za/7,days:Za,hours:Za*24,minutes:Za*24*60,seconds:Za*24*60*60,milliseconds:Za*24*60*60*1e3},quarters:{months:3,weeks:Za/28,days:Za/4,hours:Za*24/4,minutes:Za*24*60/4,seconds:Za*24*60*60/4,milliseconds:Za*24*60*60*1e3/4},months:{weeks:cg/7,days:cg,hours:cg*24,minutes:cg*24*60,seconds:cg*24*60*60,milliseconds:cg*24*60*60*1e3},...OY},tm=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],t1e=tm.slice(0).reverse();function gd(t,e,i=!1){const r={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new ui(r)}function PY(t,e){let i=e.milliseconds??0;for(const r of t1e.slice(1))e[r]&&(i+=e[r]*t[r].milliseconds);return i}function ij(t,e){const i=PY(t,e)<0?-1:1;tm.reduceRight((r,n)=>{if(wt(e[n]))return r;if(r){const o=e[r]*i,u=t[n][r],p=Math.floor(o/u);e[n]+=p*i,e[r]-=p*u*i}return n},null),tm.reduce((r,n)=>{if(wt(e[n]))return r;if(r){const o=e[r]%1;e[r]-=o,e[n]+=o*t[r][n]}return n},null)}function i1e(t){const e={};for(const[i,r]of Object.entries(t))r!==0&&(e[i]=r);return e}class ui{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let r=i?e1e:Qge;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Wi.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,i){return ui.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Bo(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new ui({values:dE(e,ui.normalizeUnit),loc:Wi.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(cm(e))return ui.fromMillis(e);if(ui.isDuration(e))return e;if(typeof e=="object")return ui.fromObject(e);throw new Bo(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[r]=Hge(e);return r?ui.fromObject(r,i):ui.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[r]=Jge(e);return r?ui.fromObject(r,i):ui.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Bo("need to specify a reason the Duration is invalid");const r=e instanceof Vu?e:new Vu(e,i);if(sn.throwOnInvalid)throw new kme(r);return new ui({invalid:r})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new BK(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Zs.create(this.loc,r).formatDurationFromString(this,e):tj}toHuman(e={}){if(!this.isValid)return tj;const i=tm.map(r=>{const n=this.values[r];return wt(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=VP(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},De.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?PY(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=ui.fromDurationLike(e),r={};for(const n of tm)(hb(i.values,n)||hb(this.values,n))&&(r[n]=i.get(n)+this.get(n));return gd(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const i=ui.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=bY(e(this.values[r],r));return gd(this,{values:i},!0)}get(e){return this[ui.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...dE(e,ui.normalizeUnit)};return gd(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:r,matrix:n}={}){const u={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:n,conversionAccuracy:r};return gd(this,u)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return ij(this.matrix,e),gd(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=i1e(this.normalize().shiftToAll().toObject());return gd(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(u=>ui.normalizeUnit(u));const i={},r={},n=this.toObject();let o;for(const u of tm)if(e.indexOf(u)>=0){o=u;let p=0;for(const w in r)p+=this.matrix[w][u]*r[w],r[w]=0;cm(n[u])&&(p+=n[u]);const g=Math.trunc(p);i[u]=g,r[u]=(p*1e3-g*1e3)/1e3}else cm(n[u])&&(r[u]=n[u]);for(const u in r)r[u]!==0&&(i[o]+=u===o?r[u]:r[u]/this.matrix[o][u]);return ij(this.matrix,i),gd(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return gd(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(const r of tm)if(!i(this.values[r],e.values[r]))return!1;return!0}}const hg="Invalid Interval";function r1e(t,e){return!t||!t.isValid?Hr.invalid("missing or invalid start"):!e||!e.isValid?Hr.invalid("missing or invalid end"):e<t?Hr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Hr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Bo("need to specify a reason the Interval is invalid");const r=e instanceof Vu?e:new Vu(e,i);if(sn.throwOnInvalid)throw new Mme(r);return new Hr({invalid:r})}static fromDateTimes(e,i){const r=yw(e),n=yw(i),o=r1e(r,n);return o??new Hr({start:r,end:n})}static after(e,i){const r=ui.fromDurationLike(i),n=yw(e);return Hr.fromDateTimes(n,n.plus(r))}static before(e,i){const r=ui.fromDurationLike(i),n=yw(e);return Hr.fromDateTimes(n.minus(r),n)}static fromISO(e,i){const[r,n]=(e||"").split("/",2);if(r&&n){let o,u;try{o=De.fromISO(r,i),u=o.isValid}catch{u=!1}let p,g;try{p=De.fromISO(n,i),g=p.isValid}catch{g=!1}if(u&&g)return Hr.fromDateTimes(o,p);if(u){const w=ui.fromISO(n,i);if(w.isValid)return Hr.after(o,w)}else if(g){const w=ui.fromISO(r,i);if(w.isValid)return Hr.before(p,w)}}return Hr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(e,i);let n;return i!=null&&i.useLocaleWeeks?n=this.end.reconfigure({locale:r.locale}):n=this.end,n=n.startOf(e,i),Math.floor(n.diff(r,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?Hr.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(yw).filter(u=>this.contains(u)).sort((u,p)=>u.toMillis()-p.toMillis()),r=[];let{s:n}=this,o=0;for(;n<this.e;){const u=i[o]||this.e,p=+u>+this.e?this.e:u;r.push(Hr.fromDateTimes(n,p)),n=p,o+=1}return r}splitBy(e){const i=ui.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,n=1,o;const u=[];for(;r<this.e;){const p=this.start.plus(i.mapUnits(g=>g*n));o=+p>+this.e?this.e:p,u.push(Hr.fromDateTimes(r,o)),r=o,n+=1}return u}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return i>=r?null:Hr.fromDateTimes(i,r)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Hr.fromDateTimes(i,r)}static merge(e){const[i,r]=e.sort((n,o)=>n.s-o.s).reduce(([n,o],u)=>o?o.overlaps(u)||o.abutsStart(u)?[n,o.union(u)]:[n.concat([o]),u]:[n,u],[[],null]);return r&&i.push(r),i}static xor(e){let i=null,r=0;const n=[],o=e.map(g=>[{time:g.s,type:"s"},{time:g.e,type:"e"}]),u=Array.prototype.concat(...o),p=u.sort((g,w)=>g.time-w.time);for(const g of p)r+=g.type==="s"?1:-1,r===1?i=g.time:(i&&+i!=+g.time&&n.push(Hr.fromDateTimes(i,g.time)),i=null);return Hr.merge(n)}difference(...e){return Hr.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} â€“ ${this.e.toISO()})`:hg}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=cE,i={}){return this.isValid?Zs.create(this.s.loc.clone(i),e).formatInterval(this):hg}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:hg}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:hg}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:hg}toFormat(e,{separator:i=" â€“ "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:hg}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):ui.invalid(this.invalidReason)}mapEndpoints(e){return Hr.fromDateTimes(e(this.s),e(this.e))}}class px{static hasDST(e=sn.defaultZone){const i=De.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return ia.isValidZone(e)}static normalizeZone(e){return Af(e,sn.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||Wi.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||Wi.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||Wi.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:o="gregory"}={}){return(n||Wi.create(i,r,o)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:o="gregory"}={}){return(n||Wi.create(i,r,o)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||Wi.create(i,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||Wi.create(i,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Wi.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return Wi.create(i,null,"gregory").eras(e)}static features(){return{relative:mY(),localeWeek:gY()}}}function rj(t,e){const i=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(e)-i(t);return Math.floor(ui.fromMillis(r).as("days"))}function n1e(t,e,i){const r=[["years",(g,w)=>w.year-g.year],["quarters",(g,w)=>w.quarter-g.quarter+(w.year-g.year)*4],["months",(g,w)=>w.month-g.month+(w.year-g.year)*12],["weeks",(g,w)=>{const S=rj(g,w);return(S-S%7)/7}],["days",rj]],n={},o=t;let u,p;for(const[g,w]of r)i.indexOf(g)>=0&&(u=g,n[g]=w(t,e),p=o.plus(n),p>e?(n[g]--,t=o.plus(n),t>e&&(p=t,n[g]--,t=o.plus(n))):t=p);return[t,n,p,u]}function s1e(t,e,i,r){let[n,o,u,p]=n1e(t,e,i);const g=e-n,w=i.filter(T=>["hours","minutes","seconds","milliseconds"].indexOf(T)>=0);w.length===0&&(u<e&&(u=n.plus({[p]:1})),u!==n&&(o[p]=(o[p]||0)+g/(u-n)));const S=ui.fromObject(o,r);return w.length>0?ui.fromMillis(g,r).shiftTo(...w).plus(S):S}const BP={arab:"[Ù -Ù©]",arabext:"[Û°-Û¹]",bali:"[á­-á­™]",beng:"[à§¦-à§¯]",deva:"[à¥¦-à¥¯]",fullwide:"[ï¼-ï¼™]",gujr:"[à«¦-à«¯]",hanidec:"[ã€‡|ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹]",khmr:"[áŸ -áŸ©]",knda:"[à³¦-à³¯]",laoo:"[à»-à»™]",limb:"[á¥†-á¥]",mlym:"[àµ¦-àµ¯]",mong:"[á -á ™]",mymr:"[á€-á‰]",orya:"[à­¦-à­¯]",tamldec:"[à¯¦-à¯¯]",telu:"[à±¦-à±¯]",thai:"[à¹-à¹™]",tibt:"[à¼ -à¼©]",latn:"\\d"},nj={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},o1e=BP.hanidec.replace(/[\[|\]]/g,"").split("");function a1e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);if(t[i].search(BP.hanidec)!==-1)e+=o1e.indexOf(t[i]);else for(const n in nj){const[o,u]=nj[n];r>=o&&r<=u&&(e+=r-o)}}return parseInt(e,10)}else return e}function Xl({numberingSystem:t},e=""){return new RegExp(`${BP[t||"latn"]}${e}`)}const l1e="missing Intl.DateTimeFormat.formatToParts support";function bi(t,e=i=>i){return{regex:t,deser:([i])=>e(a1e(i))}}const u1e="Â ",RY=`[ ${u1e}]`,FY=new RegExp(RY,"g");function c1e(t){return t.replace(/\./g,"\\.?").replace(FY,RY)}function sj(t){return t.replace(/\./g,"").replace(FY," ").toLowerCase()}function Ql(t,e){return t===null?null:{regex:RegExp(t.map(c1e).join("|")),deser:([i])=>t.findIndex(r=>sj(i)===sj(r))+e}}function oj(t,e){return{regex:t,deser:([,i,r])=>JI(i,r),groups:e}}function dx(t){return{regex:t,deser:([e])=>e}}function h1e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function p1e(t,e){const i=Xl(e),r=Xl(e,"{2}"),n=Xl(e,"{3}"),o=Xl(e,"{4}"),u=Xl(e,"{6}"),p=Xl(e,"{1,2}"),g=Xl(e,"{1,3}"),w=Xl(e,"{1,6}"),S=Xl(e,"{1,9}"),T=Xl(e,"{2,4}"),E=Xl(e,"{4,6}"),C=F=>({regex:RegExp(h1e(F.val)),deser:([V])=>V,literal:!0}),R=(F=>{if(t.literal)return C(F);switch(F.val){case"G":return Ql(e.eras("short"),0);case"GG":return Ql(e.eras("long"),0);case"y":return bi(w);case"yy":return bi(T,wC);case"yyyy":return bi(o);case"yyyyy":return bi(E);case"yyyyyy":return bi(u);case"M":return bi(p);case"MM":return bi(r);case"MMM":return Ql(e.months("short",!0),1);case"MMMM":return Ql(e.months("long",!0),1);case"L":return bi(p);case"LL":return bi(r);case"LLL":return Ql(e.months("short",!1),1);case"LLLL":return Ql(e.months("long",!1),1);case"d":return bi(p);case"dd":return bi(r);case"o":return bi(g);case"ooo":return bi(n);case"HH":return bi(r);case"H":return bi(p);case"hh":return bi(r);case"h":return bi(p);case"mm":return bi(r);case"m":return bi(p);case"q":return bi(p);case"qq":return bi(r);case"s":return bi(p);case"ss":return bi(r);case"S":return bi(g);case"SSS":return bi(n);case"u":return dx(S);case"uu":return dx(p);case"uuu":return bi(i);case"a":return Ql(e.meridiems(),0);case"kkkk":return bi(o);case"kk":return bi(T,wC);case"W":return bi(p);case"WW":return bi(r);case"E":case"c":return bi(i);case"EEE":return Ql(e.weekdays("short",!1),1);case"EEEE":return Ql(e.weekdays("long",!1),1);case"ccc":return Ql(e.weekdays("short",!0),1);case"cccc":return Ql(e.weekdays("long",!0),1);case"Z":case"ZZ":return oj(new RegExp(`([+-]${p.source})(?::(${r.source}))?`),2);case"ZZZ":return oj(new RegExp(`([+-]${p.source})(${r.source})?`),2);case"z":return dx(/[a-z_+-/]{1,256}?/i);case" ":return dx(/[^\S\n\r]/);default:return C(F)}})(t)||{invalidReason:l1e};return R.token=t,R}const d1e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function f1e(t,e,i){const{type:r,value:n}=t;if(r==="literal"){const g=/^\s+$/.test(n);return{literal:!g,val:g?" ":n}}const o=e[r];let u=r;r==="hour"&&(e.hour12!=null?u=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?u="hour12":u="hour24":u=i.hour12?"hour12":"hour24");let p=d1e[u];if(typeof p=="object"&&(p=p[o]),p)return{literal:!1,val:p}}function y1e(t){return[`^${t.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,t]}function m1e(t,e,i){const r=t.match(e);if(r){const n={};let o=1;for(const u in i)if(hb(i,u)){const p=i[u],g=p.groups?p.groups+1:1;!p.literal&&p.token&&(n[p.token.val[0]]=p.deser(r.slice(o,o+g))),o+=g}return[r,n]}else return[r,{}]}function g1e(t){const e=o=>{switch(o){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return wt(t.z)||(i=ia.create(t.z)),wt(t.Z)||(i||(i=new an(t.Z)),r=t.Z),wt(t.q)||(t.M=(t.q-1)*3+1),wt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),wt(t.u)||(t.S=jP(t.u)),[Object.keys(t).reduce((o,u)=>{const p=e(u);return p&&(o[p]=t[u]),o},{}),i,r]}let T9=null;function v1e(){return T9||(T9=De.fromMillis(1555555555555)),T9}function b1e(t,e){if(t.literal)return t;const i=Zs.macroTokenToFormatOpts(t.val),r=jY(i,e);return r==null||r.includes(void 0)?t:r}function NY(t,e){return Array.prototype.concat(...t.map(i=>b1e(i,e)))}function DY(t,e,i){const r=NY(Zs.parseFormat(i),t),n=r.map(u=>p1e(u,t)),o=n.find(u=>u.invalidReason);if(o)return{input:e,tokens:r,invalidReason:o.invalidReason};{const[u,p]=y1e(n),g=RegExp(u,"i"),[w,S]=m1e(e,g,p),[T,E,C]=S?g1e(S):[null,null,void 0];if(hb(S,"a")&&hb(S,"H"))throw new ov("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:g,rawMatches:w,matches:S,result:T,zone:E,specificOffset:C}}}function w1e(t,e,i){const{result:r,zone:n,specificOffset:o,invalidReason:u}=DY(t,e,i);return[r,n,o,u]}function jY(t,e){if(!t)return null;const r=Zs.create(e,t).dtFormatter(v1e()),n=r.formatToParts(),o=r.resolvedOptions();return n.map(u=>f1e(u,t,o))}const E9="Invalid DateTime",aj=864e13;function fx(t){return new Vu("unsupported zone",`the zone "${t.name}" is not supported`)}function I9(t){return t.weekData===null&&(t.weekData=hE(t.c)),t.weekData}function M9(t){return t.localWeekData===null&&(t.localWeekData=hE(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function x0(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new De({...i,...e,old:i})}function VY(t,e,i){let r=t-e*60*1e3;const n=i.offset(r);if(e===n)return[r,e];r-=(n-e)*60*1e3;const o=i.offset(r);return n===o?[r,n]:[t-Math.min(n,o)*60*1e3,Math.max(n,o)]}function yx(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function rT(t,e,i){return VY(WI(t),e,i)}function lj(t,e){const i=t.o,r=t.c.year+Math.trunc(e.years),n=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,o={...t.c,year:r,month:n,day:Math.min(t.c.day,pE(r,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},u=ui.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),p=WI(o);let[g,w]=VY(p,i,t.zone);return u!==0&&(g+=u,w=t.zone.offset(g)),{ts:g,o:w}}function fw(t,e,i,r,n,o){const{setZone:u,zone:p}=i;if(t&&Object.keys(t).length!==0||e){const g=e||p,w=De.fromObject(t,{...i,zone:g,specificOffset:o});return u?w:w.setZone(p)}else return De.invalid(new Vu("unparsable",`the input "${n}" can't be parsed as ${r}`))}function mx(t,e,i=!0){return t.isValid?Zs.create(Wi.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function k9(t,e){const i=t.c.year>9999||t.c.year<0;let r="";return i&&t.c.year>=0&&(r+="+"),r+=bn(t.c.year,i?6:4),e?(r+="-",r+=bn(t.c.month),r+="-",r+=bn(t.c.day)):(r+=bn(t.c.month),r+=bn(t.c.day)),r}function uj(t,e,i,r,n,o){let u=bn(t.c.hour);return e?(u+=":",u+=bn(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(u+=":")):u+=bn(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(u+=bn(t.c.second),(t.c.millisecond!==0||!r)&&(u+=".",u+=bn(t.c.millisecond,3))),n&&(t.isOffsetFixed&&t.offset===0&&!o?u+="Z":t.o<0?(u+="-",u+=bn(Math.trunc(-t.o/60)),u+=":",u+=bn(Math.trunc(-t.o%60))):(u+="+",u+=bn(Math.trunc(t.o/60)),u+=":",u+=bn(Math.trunc(t.o%60)))),o&&(u+="["+t.zone.ianaName+"]"),u}const zY={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},_1e={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},S1e={ordinal:1,hour:0,minute:0,second:0,millisecond:0},UY=["year","month","day","hour","minute","second","millisecond"],x1e=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],$1e=["year","ordinal","hour","minute","second","millisecond"];function T1e(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new BK(t);return e}function cj(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return T1e(t)}}function hj(t,e){const i=Af(e.zone,sn.defaultZone),r=Wi.fromObject(e),n=sn.now();let o,u;if(wt(t.year))o=n;else{for(const w of UY)wt(t[w])&&(t[w]=zY[w]);const p=fY(t)||yY(t);if(p)return De.invalid(p);const g=i.offset(n);[o,u]=rT(t,g,i)}return new De({ts:o,zone:i,loc:r,o:u})}function pj(t,e,i){const r=wt(i.round)?!0:i.round,n=(u,p)=>(u=VP(u,r||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(u,p)),o=u=>i.calendary?e.hasSame(t,u)?0:e.startOf(u).diff(t.startOf(u),u).get(u):e.diff(t,u).get(u);if(i.unit)return n(o(i.unit),i.unit);for(const u of i.units){const p=o(u);if(Math.abs(p)>=1)return n(p,u)}return n(t>e?-0:0,i.units[i.units.length-1])}function dj(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}class De{constructor(e){const i=e.zone||sn.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new Vu("invalid input"):null)||(i.isValid?null:fx(i));this.ts=wt(e.ts)?sn.now():e.ts;let n=null,o=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[n,o]=[e.old.c,e.old.o];else{const p=i.offset(this.ts);n=yx(this.ts,p),r=Number.isNaN(n.year)?new Vu("invalid input"):null,n=r?null:n,o=r?null:p}this._zone=i,this.loc=e.loc||Wi.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=n,this.o=o,this.isLuxonDateTime=!0}static now(){return new De({})}static local(){const[e,i]=dj(arguments),[r,n,o,u,p,g,w]=i;return hj({year:r,month:n,day:o,hour:u,minute:p,second:g,millisecond:w},e)}static utc(){const[e,i]=dj(arguments),[r,n,o,u,p,g,w]=i;return e.zone=an.utcInstance,hj({year:r,month:n,day:o,hour:u,minute:p,second:g,millisecond:w},e)}static fromJSDate(e,i={}){const r=ege(e)?e.valueOf():NaN;if(Number.isNaN(r))return De.invalid("invalid input");const n=Af(i.zone,sn.defaultZone);return n.isValid?new De({ts:r,zone:n,loc:Wi.fromObject(i)}):De.invalid(fx(n))}static fromMillis(e,i={}){if(cm(e))return e<-aj||e>aj?De.invalid("Timestamp out of range"):new De({ts:e,zone:Af(i.zone,sn.defaultZone),loc:Wi.fromObject(i)});throw new Bo(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(cm(e))return new De({ts:e*1e3,zone:Af(i.zone,sn.defaultZone),loc:Wi.fromObject(i)});throw new Bo("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const r=Af(i.zone,sn.defaultZone);if(!r.isValid)return De.invalid(fx(r));const n=Wi.fromObject(i),o=dE(e,cj),{minDaysInFirstWeek:u,startOfWeek:p}=KD(o,n),g=sn.now(),w=wt(i.specificOffset)?r.offset(g):i.specificOffset,S=!wt(o.ordinal),T=!wt(o.year),E=!wt(o.month)||!wt(o.day),C=T||E,L=o.weekYear||o.weekNumber;if((C||S)&&L)throw new ov("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(E&&S)throw new ov("Can't mix ordinal dates with month/day");const R=L||o.weekday&&!C;let F,V,U=yx(g,w);R?(F=x1e,V=_1e,U=hE(U,u,p)):S?(F=$1e,V=S1e,U=$9(U)):(F=UY,V=zY);let W=!1;for(const de of F){const ge=o[de];wt(ge)?W?o[de]=V[de]:o[de]=U[de]:W=!0}const H=R?Yme(o,u,p):S?Xme(o):fY(o),J=H||yY(o);if(J)return De.invalid(J);const X=R?JD(o,u,p):S?ZD(o):o,[te,oe]=rT(X,w,r),pe=new De({ts:te,zone:r,o:oe,loc:n});return o.weekday&&C&&e.weekday!==pe.weekday?De.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${pe.toISO()}`):pe}static fromISO(e,i={}){const[r,n]=Gge(e);return fw(r,n,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[r,n]=Bge(e);return fw(r,n,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[r,n]=qge(e);return fw(r,n,i,"HTTP",i)}static fromFormat(e,i,r={}){if(wt(e)||wt(i))throw new Bo("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:o=null}=r,u=Wi.fromOpts({locale:n,numberingSystem:o,defaultToEN:!0}),[p,g,w,S]=w1e(u,e,i);return S?De.invalid(S):fw(p,g,r,`format ${i}`,e,w)}static fromString(e,i,r={}){return De.fromFormat(e,i,r)}static fromSQL(e,i={}){const[r,n]=Xge(e);return fw(r,n,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Bo("need to specify a reason the DateTime is invalid");const r=e instanceof Vu?e:new Vu(e,i);if(sn.throwOnInvalid)throw new Ime(r);return new De({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const r=jY(e,Wi.fromObject(i));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(e,i={}){return NY(Zs.parseFormat(e),Wi.fromObject(i)).map(n=>n.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?I9(this).weekYear:NaN}get weekNumber(){return this.isValid?I9(this).weekNumber:NaN}get weekday(){return this.isValid?I9(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?M9(this).weekday:NaN}get localWeekNumber(){return this.isValid?M9(this).weekNumber:NaN}get localWeekYear(){return this.isValid?M9(this).weekYear:NaN}get ordinal(){return this.isValid?$9(this.c).ordinal:NaN}get monthShort(){return this.isValid?px.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?px.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?px.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?px.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,r=WI(this.c),n=this.zone.offset(r-e),o=this.zone.offset(r+e),u=this.zone.offset(r-n*i),p=this.zone.offset(r-o*i);if(u===p)return[this];const g=r-u*i,w=r-p*i,S=yx(g,u),T=yx(w,p);return S.hour===T.hour&&S.minute===T.minute&&S.second===T.second&&S.millisecond===T.millisecond?[x0(this,{ts:g}),x0(this,{ts:w})]:[this]}get isInLeapYear(){return nS(this.year)}get daysInMonth(){return pE(this.year,this.month)}get daysInYear(){return this.isValid?$v(this.year):NaN}get weeksInWeekYear(){return this.isValid?d3(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?d3(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:r,calendar:n}=Zs.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:n}}toUTC(e=0,i={}){return this.setZone(an.instance(e),i)}toLocal(){return this.setZone(sn.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(e=Af(e,sn.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(i||r){const o=e.offset(this.ts),u=this.toObject();[n]=rT(u,o,e)}return x0(this,{ts:n,zone:e})}else return De.invalid(fx(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:r}={}){const n=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:r});return x0(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=dE(e,cj),{minDaysInFirstWeek:r,startOfWeek:n}=KD(i,this.loc),o=!wt(i.weekYear)||!wt(i.weekNumber)||!wt(i.weekday),u=!wt(i.ordinal),p=!wt(i.year),g=!wt(i.month)||!wt(i.day),w=p||g,S=i.weekYear||i.weekNumber;if((w||u)&&S)throw new ov("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(g&&u)throw new ov("Can't mix ordinal dates with month/day");let T;o?T=JD({...hE(this.c,r,n),...i},r,n):wt(i.ordinal)?(T={...this.toObject(),...i},wt(i.day)&&(T.day=Math.min(pE(T.year,T.month),T.day))):T=ZD({...$9(this.c),...i});const[E,C]=rT(T,this.o,this.zone);return x0(this,{ts:E,o:C})}plus(e){if(!this.isValid)return this;const i=ui.fromDurationLike(e);return x0(this,lj(this,i))}minus(e){if(!this.isValid)return this;const i=ui.fromDurationLike(e).negate();return x0(this,lj(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},n=ui.normalizeUnit(e);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(n==="weeks")if(i){const o=this.loc.getStartOfWeek(),{weekday:u}=this;u<o&&(r.weekNumber=this.weekNumber-1),r.weekday=o}else r.weekday=1;if(n==="quarters"){const o=Math.ceil(this.month/3);r.month=(o-1)*3+1}return this.set(r)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?Zs.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):E9}toLocaleString(e=cE,i={}){return this.isValid?Zs.create(this.loc.clone(i),e).formatDateTime(this):E9}toLocaleParts(e={}){return this.isValid?Zs.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:o=!1}={}){if(!this.isValid)return null;const u=e==="extended";let p=k9(this,u);return p+="T",p+=uj(this,u,i,r,n,o),p}toISODate({format:e="extended"}={}){return this.isValid?k9(this,e==="extended"):null}toISOWeekDate(){return mx(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:o=!1,format:u="extended"}={}){return this.isValid?(n?"T":"")+uj(this,u==="extended",i,e,r,o):null}toRFC2822(){return mx(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return mx(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?k9(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(i||e)&&(r&&(n+=" "),i?n+="z":e&&(n+="ZZ")),mx(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():E9}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",r={}){if(!this.isValid||!e.isValid)return ui.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...r},o=tge(i).map(ui.normalizeUnit),u=e.valueOf()>this.valueOf(),p=u?this:e,g=u?e:this,w=s1e(p,g,o,n);return u?w.negate():w}diffNow(e="milliseconds",i={}){return this.diff(De.now(),e,i)}until(e){return this.isValid?Hr.fromDateTimes(this,e):this}hasSame(e,i,r){if(!this.isValid)return!1;const n=e.valueOf(),o=this.setZone(e.zone,{keepLocalTime:!0});return o.startOf(i,r)<=n&&n<=o.endOf(i,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||De.fromObject({},{zone:this.zone}),r=e.padding?this<i?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],o=e.unit;return Array.isArray(e.unit)&&(n=e.unit,o=void 0),pj(i,this.plus(r),{...e,numeric:"always",units:n,unit:o})}toRelativeCalendar(e={}){return this.isValid?pj(e.base||De.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(De.isDateTime))throw new Bo("min requires all arguments be DateTimes");return YD(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(De.isDateTime))throw new Bo("max requires all arguments be DateTimes");return YD(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,r={}){const{locale:n=null,numberingSystem:o=null}=r,u=Wi.fromOpts({locale:n,numberingSystem:o,defaultToEN:!0});return DY(u,e,i)}static fromStringExplain(e,i,r={}){return De.fromFormatExplain(e,i,r)}static get DATE_SHORT(){return cE}static get DATE_MED(){return qK}static get DATE_MED_WITH_WEEKDAY(){return Cme}static get DATE_FULL(){return HK}static get DATE_HUGE(){return WK}static get TIME_SIMPLE(){return JK}static get TIME_WITH_SECONDS(){return ZK}static get TIME_WITH_SHORT_OFFSET(){return KK}static get TIME_WITH_LONG_OFFSET(){return YK}static get TIME_24_SIMPLE(){return XK}static get TIME_24_WITH_SECONDS(){return QK}static get TIME_24_WITH_SHORT_OFFSET(){return eY}static get TIME_24_WITH_LONG_OFFSET(){return tY}static get DATETIME_SHORT(){return iY}static get DATETIME_SHORT_WITH_SECONDS(){return rY}static get DATETIME_MED(){return nY}static get DATETIME_MED_WITH_SECONDS(){return sY}static get DATETIME_MED_WITH_WEEKDAY(){return Ame}static get DATETIME_FULL(){return oY}static get DATETIME_FULL_WITH_SECONDS(){return aY}static get DATETIME_HUGE(){return lY}static get DATETIME_HUGE_WITH_SECONDS(){return uY}}function yw(t){if(De.isDateTime(t))return t;if(t&&t.valueOf&&cm(t.valueOf()))return De.fromJSDate(t);if(t&&typeof t=="object")return De.fromObject(t);throw new Bo(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const $o="system",Kp="unknown",ra="UTC",E1e=Intl.DateTimeFormat().resolvedOptions().timeZone,I1e="shortOffset";function M1e(t){return"timeZoneIANA"in t}function k1e(t){return t.startsWith("UTC")}function fE(t,e=!1){return{json:{read:{source:t,reader:(i,r)=>r[t]?nT(r[t]):null},write:!!e&&{allowNull:!0,writer(i,r){r[t]=i?C1e(i):null}}}}}function nT(t,e=$o){return t?M1e(t)?t.timeZoneIANA:A1e(t,e):e}function C1e(t){return{timeZoneIANA:t}}function A1e(t,e=$o){if(!t||!ND.has(t.timeZone))return e;const i=ND.get(t.timeZone);return k1e(t.timeZone)||t.respectsDaylightSaving?i:L1e(i)}function L1e(t){const e=De.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${an.instance(-i).formatOffset(0,"narrow")}`}function GY(t,e,i,r,n){if(e&&n==="date")return{timeZone:ra,timeZoneName:void 0};const o=r.timeStyle||r.hour,u=i===Kp;return{timeZone:u?n==="timestamp-offset"?void 0:t??ra:i,timeZoneName:u&&o?I1e:void 0}}const O1e={year:void 0,month:void 0,day:void 0,weekday:void 0},P1e={hour:void 0,minute:void 0,second:void 0},BY={timeZone:ra},lc={year:"numeric",month:"numeric",day:"numeric"},mw={year:"numeric",month:"long",day:"numeric"},gw={year:"numeric",month:"short",day:"numeric"},vw={year:"numeric",month:"long",weekday:"long",day:"numeric"},$f={hour:"numeric",minute:"numeric"},G0={...$f,second:"numeric"},qY={hourCycle:"h23"},bw={...$f,...qY},ww={...G0,...qY},HY={"short-date":lc,"short-date-short-time":{...lc,...$f},"short-date-short-time-24":{...lc,...bw},"short-date-long-time":{...lc,...G0},"short-date-long-time-24":{...lc,...ww},"short-date-le":lc,"short-date-le-short-time":{...lc,...$f},"short-date-le-short-time-24":{...lc,...bw},"short-date-le-long-time":{...lc,...G0},"short-date-le-long-time-24":{...lc,...ww},"long-month-day-year":mw,"long-month-day-year-short-time":{...mw,...$f},"long-month-day-year-short-time-24":{...mw,...bw},"long-month-day-year-long-time":{...mw,...G0},"long-month-day-year-long-time-24":{...mw,...ww},"day-short-month-year":gw,"day-short-month-year-short-time":{...gw,...$f},"day-short-month-year-short-time-24":{...gw,...bw},"day-short-month-year-long-time":{...gw,...G0},"day-short-month-year-long-time-24":{...gw,...ww},"long-date":vw,"long-date-short-time":{...vw,...$f},"long-date-short-time-24":{...vw,...bw},"long-date-long-time":{...vw,...G0},"long-date-long-time-24":{...vw,...ww},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":$f,"long-time":G0},R1e=dt()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),WY={ar:"ar-u-nu-latn-ca-gregory"};let _C=new WeakMap;const KI=HY["short-date-short-time"];function F1e(t){let e=_C.get(t);if(!e){const i=Ss(),r=WY[i]||i,n=qP(t.timeZone??$o),o={...t,timeZone:n};e=new Intl.DateTimeFormat(r,o),_C.set(t,e)}return e}function bo(t){return HY[t]}function ln(t,e=KI){return F1e(e).format(t)}function JY(t,e=KI){return ln(new Date(t),{...e,...BY,...P1e})}function ZY(t,e=KI){return ln(new Date(`1970-01-01T${t}Z`),{...e,...BY,...O1e})}function KY(t,e=KI){if(e.timeZone)return ln(new Date(t),e);const i=De.fromISO(t,{setZone:!0}),r=Ss(),n=WY[r]??r,o=i.offset===0?ra:e.timeZone,u={...e,timeZone:o};return i.toLocaleString(u,{locale:n})}function qP(t){switch(t){case $o:return E1e;case Kp:return ra;default:return t}}bP(()=>{_C=new WeakMap});const SC={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function $2(t,e,i,r=$o){const n=new ia(qP(r)),o=De.fromJSDate(t,{zone:n}),u=i==="decades"||i==="centuries"?"year":XY(i);return i==="decades"&&(e*=10),i==="centuries"&&(e*=100),o.plus({[u]:e}).toJSDate()}function vJe(t,e,i="milliseconds"){const r=t.getTime(),n=YY(e,i,"milliseconds");return new Date(r+n)}function xC(t,e,i=$o){const r=new ia(qP(i)),n=De.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const u=n.startOf("year"),{year:p}=u,g=p-p%(e==="decades"?10:100);return u.set({year:g}).toJSDate()}const o=XY(e);return n.startOf(o).toJSDate()}function YY(t,e,i){return t===0?0:t*SC[e]/SC[i]}function N1e(t,e){return t&&e?t.intersection(e):t||e}function XY(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var nl;let Aa=nl=class extends ye{static get allTime(){return fj}static get empty(){return D1e}static fromArray(t){return new nl({start:t[0]!=null?new Date(t[0]):t[0],end:t[1]!=null?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=(t==null?void 0:t.getTime())??null}get isAllTime(){return this.equals(nl.allTime)}get isEmpty(){return this.equals(nl.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=(t==null?void 0:t.getTime())??null}clone(){return new nl({end:this.end,start:this.start})}equals(t){var o,u,p,g;if(!t)return!1;const e=((o=this.start)==null?void 0:o.getTime())??this.start,i=((u=this.end)==null?void 0:u.getTime())??this.end,r=((p=t.start)==null?void 0:p.getTime())??t.start,n=((g=t.end)==null?void 0:g.getTime())??t.end;return e===r&&i===n}expandTo(t,e=$o){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=xC(i,t,e));let r=this.end;if(r){const n=xC(r,t,e);r=r.getTime()===n.getTime()?n:$2(n,1,t,e)}return new nl({start:i,end:r})}intersection(t){var p,g,w,S;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return nl.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((p=this.start)==null?void 0:p.getTime())??-1/0,i=((g=this.end)==null?void 0:g.getTime())??1/0,r=((w=t.start)==null?void 0:w.getTime())??-1/0,n=((S=t.end)==null?void 0:S.getTime())??1/0;let o,u;return r>=e&&r<=i?o=r:e>=r&&e<=n&&(o=e),i>=r&&i<=n?u=i:n>=e&&n<=i&&(u=n),o==null||u==null||isNaN(o)||isNaN(u)?nl.empty:new nl({start:o===-1/0?null:new Date(o),end:u===1/0?null:new Date(u)})}offset(t,e,i=$o){if(this.isEmpty||this.isAllTime)return this.clone();const r=new nl,{start:n,end:o}=this;return n!=null&&(r.start=$2(n,t,e,i)),o!=null&&(r.end=$2(o,t,e,i)),r}toArray(){var t,e;return this.isEmpty?[void 0,void 0]:[((t=this.start)==null?void 0:t.getTime())??null,((e=this.end)==null?void 0:e.getTime())??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return fj.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new nl({start:e,end:i})}};m([b({type:Date,json:{write:{allowNull:!0}}})],Aa.prototype,"end",void 0),m([Me("end")],Aa.prototype,"readEnd",null),m([Le("end")],Aa.prototype,"writeEnd",null),m([b({readOnly:!0,json:{read:!1}})],Aa.prototype,"isAllTime",null),m([b({readOnly:!0,json:{read:!1}})],Aa.prototype,"isEmpty",null),m([b({type:Date,json:{write:{allowNull:!0}}})],Aa.prototype,"start",void 0),m([Me("start")],Aa.prototype,"readStart",null),m([Le("start")],Aa.prototype,"writeStart",null),Aa=nl=m([G("esri.TimeExtent")],Aa);const fj=new Aa,D1e=new Aa({start:void 0,end:void 0}),Di=Aa;let QY=0;const nc=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+QY++})}};return e=m([G("esri.core.Identifiable")],e),e},HP=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:QY++})}};return e=m([G("esri.core.Identifiable.NumericIdentifiable")],e),e};let yj=class extends nc(class{}){};yj=m([G("esri.core.Identifiable")],yj);async function j1e(t){var r;const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await ie(async()=>{const{fromItem:n}=await import("./portalLayers-CyTRE0oC.js").then(o=>o.p);return{fromItem:n}},__vite__mapDeps([6,7,8]));try{return await i(e)}catch(n){const o=e==null?void 0:e.portalItem,u=(o==null?void 0:o.id)||"unset",p=((r=o==null?void 0:o.portal)==null?void 0:r.url)||Ct.portalUrl;throw fe.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+p+"', id: '"+u+"')",n),n}}let V1e=0,Xr=class extends Ar.EventedMixin(nc(Qo)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new jt(-180,-90,180,90,Ge.WGS84),this.id=Date.now().toString(16)+"-layer-"+V1e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Ge.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await ie(async()=>{const{fromUrl:r}=await import("./arcgisLayers-DspE1Bq3.js");return{fromUrl:r}},__vite__mapDeps([9,7,8]))).fromUrl(i)}static fromPortalItem(e){return j1e(e)}initialize(){this.when().catch(e=>{Cn(e)||fe.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const e=this.parent;if(e){const i=this;"layers"in e&&e.layers.includes(i)?e.layers.remove(i):"tables"in e&&e.tables.includes(i)?e.tables.remove(i):"baseLayers"in e&&e.baseLayers.includes(i)?e.baseLayers.remove(i):"referenceLayers"in e&&e.referenceLayers.includes(i)&&e.referenceLayers.remove(i),this._set("parent",null)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Zr(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await nt(e,{query:{f:"json"},responseType:"json"})).data;throw new re("layer:no-attribution-data","Layer does not have attribution data")}};m([b({type:String})],Xr.prototype,"attributionDataUrl",void 0),m([b({type:jt})],Xr.prototype,"fullExtent",void 0),m([b({readOnly:!0})],Xr.prototype,"hasAttributionData",null),m([b({type:String,clonable:!1})],Xr.prototype,"id",void 0),m([b({type:Boolean,nonNullable:!0})],Xr.prototype,"legendEnabled",void 0),m([b({type:["show","hide","hide-children"]})],Xr.prototype,"listMode",void 0),m([b({type:Number,range:{min:0,max:1},nonNullable:!0})],Xr.prototype,"opacity",void 0),m([b({clonable:!1})],Xr.prototype,"parent",void 0),m([b({readOnly:!0})],Xr.prototype,"parsedUrl",null),m([b({type:Boolean,readOnly:!0})],Xr.prototype,"persistenceEnabled",void 0),m([b({type:Boolean})],Xr.prototype,"popupEnabled",void 0),m([b({type:Boolean})],Xr.prototype,"attributionVisible",void 0),m([b({type:Ge})],Xr.prototype,"spatialReference",void 0),m([b({type:String})],Xr.prototype,"title",void 0),m([b({readOnly:!0,json:{read:!1}})],Xr.prototype,"type",void 0),m([b()],Xr.prototype,"url",void 0),m([b({type:Di})],Xr.prototype,"visibilityTimeExtent",void 0),m([b({type:Boolean,nonNullable:!0})],Xr.prototype,"visible",void 0),Xr=m([G("esri.layers.Layer")],Xr);const WP=Xr;function $C(t,e,i){let r,n;if(t)for(let o=0,u=t.length;o<u;o++){if(r=t.at(o),(r==null?void 0:r[e])===i)return r;if((r==null?void 0:r.type)==="group"&&(n=$C(r.layers,e,i),n))return n}}const z1e=t=>{let e=class extends t{constructor(...i){super(...i),this.layers=new Ie;const r=u=>{u.parent&&"remove"in u.parent&&u.parent.remove(u)},n=u=>{u.parent=this,this.layerAdded(u),u.type!=="elevation"&&u.type!=="base-elevation"||fe.getLogger(this).error(`Layer 'title:${u.title}, id:${u.id}' of type '${u.type}' is not supported as an operational layer and will therefore be ignored.`)},o=u=>{u.parent=null,this.layerRemoved(u)};this.addHandles([this.layers.on("before-add",u=>{if(u.item===this)return u.preventDefault(),void fe.getLogger(this).error("#add()","Cannot add layer to itself.");r(u.item)}),this.layers.on("after-add",u=>n(u.item)),this.layers.on("after-remove",u=>o(u.item))])}destroy(){const i=this.layers.toArray();for(const r of i)r.destroy();this.layers.destroy()}set layers(i){this._set("layers",Jp(i,this._get("layers")))}add(i,r){const n=this.layers;if(r=n.getNextIndex(r),i instanceof WP){const o=i;o.parent===this?this.reorder(o,r):n.add(o,r)}else ed(i)?i.then(o=>{this.destroyed||this.add(o,r)}):fe.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const n=this.layers;let o=n.getNextIndex(r);i.slice().forEach(u=>{u.parent!==this?(n.add(u,o),o+=1):this.reorder(u,o)})}findLayerById(i){return $C(this.layers,"id",i)}findLayerByUid(i){return $C(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return m([b()],e.prototype,"layers",null),e=m([G("esri.support.LayersMixin")],e),e};function TC(t,e,i){if(t)for(let r=0,n=t.length;r<n;r++){const o=t.at(r);if(o[e]===i)return o;if((o==null?void 0:o.type)==="group"){const u=TC(o.tables,e,i);if(u)return u}}}const U1e=t=>{let e=class extends t{constructor(...i){super(...i),this.tables=new Ie,this.addHandles([this.tables.on("after-add",r=>{const n=r.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,n.type!=="feature"&&fe.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",Jp(i,this._get("tables")))}findTableById(i){return TC(this.tables,"id",i)}findTableByUid(i){return TC(this.tables,"uid",i)}};return m([b()],e.prototype,"tables",null),e=m([G("esri.support.TablesMixin")],e),e};let lu=class extends U1e(z1e(Ar.EventedMixin(Te))){constructor(e){super(e),this.allLayers=new c3({getCollections:()=>{var i,r,n;return[(i=this.basemap)==null?void 0:i.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=Kye(this),this.basemap=null,this.editableLayers=new c3({getCollections:()=>[this.allLayers],itemFilterFunction:h3}),this.ground=new u3,this._basemapCache=jye()}destroy(){pK(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=ot(this.basemap),ot(this.ground),this._set("ground",null)}castBasemap(e){return eT(e,this._basemapCache)}castGround(e){return Yye(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};m([b({readOnly:!0,dependsOn:[]})],lu.prototype,"allLayers",void 0),m([b({readOnly:!0})],lu.prototype,"allTables",void 0),m([b({type:_2,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],lu.prototype,"basemap",void 0),m([Dt("basemap")],lu.prototype,"castBasemap",null),m([b({readOnly:!0})],lu.prototype,"editableLayers",void 0),m([b({type:u3,nonNullable:!0})],lu.prototype,"ground",void 0),m([Dt("ground")],lu.prototype,"castGround",null),m([b()],lu.prototype,"undoRedo",void 0),lu=m([G("esri.Map")],lu);const eX=lu,Gt=t=>{let e=class extends t{clone(){var g;const i=So(this);a0(i,"unable to clone instance of non-accessor class");const r=i.metadata,n=i.store,o={},u=new Map;for(const w in r){const S=r[w],T=n==null?void 0:n.originOf(w),E=S.clonable;if(S.readOnly||E===!1||T!==ut.USER&&T!==ut.DEFAULTS&&T!==ut.WEB_MAP&&T!==ut.WEB_SCENE)continue;const C=this[w];let L=null;L=typeof E=="function"?E(C):E==="reference"?C:S4(C),C!=null&&L==null||(T===ut.DEFAULTS?u.set(w,L):o[w]=L)}const p=new(Object.getPrototypeOf(this)).constructor(o);if(u.size){const w=(g=So(p))==null?void 0:g.store;if(w)for(const[S,T]of u)w.set(S,T,ut.DEFAULTS)}return p}};return e=m([G("esri.core.Clonable")],e),e};let EC=class extends Gt(Te){};EC=m([G("esri.core.Clonable")],EC);let B0=class extends EC{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};m([b({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],B0.prototype,"row",void 0),m([b({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],B0.prototype,"column",void 0),m([b({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],B0.prototype,"rows",void 0),m([b({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],B0.prototype,"columns",void 0),B0=m([G("esri.CameraLayout")],B0);const tX=B0;let YI=class{constructor(e,i){this.min=e,this.max=i,this.range=i-e}normalize(e,i=0,r=!1){return mj(this.range,this.min,this.max,e,i,r)}clamp(e,i=0){return An(e-i,this.min,this.max)+i}monotonic(e,i,r){return e<i?i:i+IC(this.range,e-i,r)}minimalMonotonic(e,i,r){return mj(this.range,e,e+this.range,i,r)}center(e,i,r){return i=this.monotonic(e,i,r),this.normalize((e+i)/2,r)}diff(e,i,r){return this.monotonic(e,i,r)-e}shortestSignedDiff(e,i){e=this.normalize(e);const r=(i=this.normalize(i))-e,n=i<e?this.minimalMonotonic(e,i)-e:i-this.minimalMonotonic(i,e);return Math.abs(r)<Math.abs(n)?r:n}contains(e,i,r){return i=this.minimalMonotonic(e,i),(r=this.minimalMonotonic(e,r))>e&&r<i}};function mj(t,e,i,r,n=0,o=!1){return(r-=n)<e?r+=IC(t,e-r):r>i&&(r-=IC(t,r-i)),o&&r===i&&(r=e),r+n}function IC(t,e,i=0){return Math.ceil((e-i)/t)*t+i}const iX=new YI(0,2*Math.PI),G1e=new YI(-Math.PI,Math.PI),JP=new YI(0,360);let vc=class extends Gt(ye){constructor(...e){super(...e),this.position=new Ke([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new tX}normalizeCtorArgs(e,i,r,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const o={position:e};return i!=null&&(o.heading=i),r!=null&&(o.tilt=r),n!=null&&(o.fov=n),o}return e}writePosition(e,i,r,n){const o=e.clone();o.x=Tl(e.x||0),o.y=Tl(e.y||0),o.z=e.hasZ?Tl(e.z||0):e.z,i[r]=o.write({},n)}readPosition(e,i){const r=new Ke;return r.read(e,i),r.x=Tl(r.x||0),r.y=Tl(r.y||0),r.z=r.hasZ?Tl(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};m([b({type:Ke,json:{write:{isRequired:!0}}})],vc.prototype,"position",void 0),m([Le("position")],vc.prototype,"writePosition",null),m([Me("position")],vc.prototype,"readPosition",null),m([b({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Dt(t=>JP.normalize(Tl(t)))],vc.prototype,"heading",void 0),m([b({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Dt(t=>An(Tl(t),-180,180))],vc.prototype,"tilt",void 0),m([b({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],vc.prototype,"fov",void 0),m([b({type:tX,nonNullable:!0,json:{read:!1,write:!1}})],vc.prototype,"layout",void 0),vc=m([G("esri.Camera")],vc);const B1e=vc;var MC;let Od=MC=class extends ye{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new MC({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};m([b({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:C9}}}}})],Od.prototype,"rotation",void 0),m([Dt("rotation")],Od.prototype,"castRotation",null),m([b({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:C9}}}}})],Od.prototype,"scale",void 0),m([b({types:h0,json:{read:dh,write:!0,origins:{"web-scene":{read:dh,write:{overridePolicy:C9}}}}})],Od.prototype,"targetGeometry",void 0),m([b({type:B1e,json:{write:!0}})],Od.prototype,"camera",void 0),Od=MC=m([G("esri.Viewpoint")],Od);const Mn=Od;function C9(){return{enabled:!this.camera}}let q1e=class rX{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array($4),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new rX,r=this._originStores[ut.DEFAULTS];r&&r.forEach((n,o)=>{i.set(o,ae(n),ut.DEFAULTS)});for(let n=ut.SERVICE;n<$4;n++){const o=this._originStores[n];o&&o.forEach((u,p)=>{e&&e.has(p)||i.set(p,ae(u),n)})}return i}get(e,i){const r=i===void 0?this._values:this._originStores[i];return r?r.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,r=ut.USER){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,i),!this._values.has(e)||this._propertyOriginMap.get(e)<=r){const o=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,r),o!==i}return!1}delete(e,i=ut.USER){const r=this._originStores[i];if(!r)return;const n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let o=i-1;o>=0;o--){const u=this._originStores[o];if(u&&u.has(e)){this._values.set(e,u.get(e)),this._propertyOriginMap.set(e,o);break}}}return n}has(e,i){const r=i===void 0?this._values:this._originStores[i];return!!r&&r.has(e)}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const r=this._originStores[i],n=r==null?void 0:r.get(e),o=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,i),o!==n}originOf(e){return this._propertyOriginMap.get(e)||ut.DEFAULTS}forEach(e){this._values.forEach(e)}};const nX=t=>{let e=class extends t{constructor(...i){super(...i);const r=So(this),n=r.store,o=new q1e;r.store=o,_J(r,n,o)}read(i,r){xJ(this,i,r)}getAtOrigin(i,r){const n=A9(this),o=Of(r);if(typeof i=="string")return n.get(i,o);const u={};return i.forEach(p=>{u[p]=n.get(p,o)}),u}originOf(i){return R5(this.originIdOf(i))}originIdOf(i){return A9(this).originOf(i)}revert(i,r){const n=A9(this),o=Of(r),u=So(this);let p;p=typeof i=="string"?i==="*"?n.keys(o):[i]:i,p.forEach(g=>{u.invalidate(g),n.revert(g,o),u.commit(g)})}};return e=m([G("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function A9(t){return So(t).store}let gj=class extends nX(Te){};gj=m([G("esri.core.ReadOnlyMultiOriginJSONSupport")],gj);const H1e=t=>{let e=class extends t{constructor(...i){super(...i)}clear(i,r="user"){return L9(this).delete(i,Of(r))}write(i,r){return EJ(this,i=i||{},r),i}setAtOrigin(i,r,n){So(this).setAtOrigin(i,r,Of(n))}removeOrigin(i){const r=L9(this),n=Of(i),o=r.keys(n);for(const u of o)r.originOf(u)===n&&r.set(u,r.get(u,n),ut.USER)}updateOrigin(i,r){const n=L9(this),o=Of(r),u=Ks(this,i);for(let p=o+1;p<$4;++p)n.delete(i,p);n.set(i,u,o)}toJSON(i){return this.write({},i)}};return e=m([G("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function L9(t){return So(t).store}const XI=t=>{let e=class extends H1e(nX(t)){constructor(...i){super(...i)}};return e=m([G("esri.core.MultiOriginJSONSupport")],e),e};let kC=class extends XI(Te){};kC=m([G("esri.core.MultiOriginJSONSupport")],kC);async function ZP(t,e){const{WhereClause:i}=await ie(()=>import("./WhereClause-CwdWzaSi.js").then(r=>r.W),[]);return i.create(t,e)}function aS(t,e){return t==="1=1"?e??t:e==="1=1"?t??e:t!=null&&t!==""?e!=null&&e!==""?`(${t}) AND (${e})`:t:e}const W1e={ar:"ar-u-nu-latn"};let sT=new WeakMap,sX={};function CC(t){const e=t||sX;if(!sT.has(e)){const i=Ss(),r=W1e[Ss()]||i;sT.set(e,new Intl.NumberFormat(r,t))}return sT.get(e)}function yE(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function as(t,e){return Object.is(t,-0)&&(t=0),CC(e).format(t)}function MJe(t,e=Ss()){var r,n;if(!t)return null;let i=vj.get(e);if(!i){const o=CC().formatToParts(12345.6),u=[...CC({useGrouping:!1}).format(9876543210)].reverse(),p=new Map(u.map((C,L)=>[C,L])),g=new RegExp(`[${(r=o.find(C=>C.type==="group"))==null?void 0:r.value}]`,"g"),w=new RegExp(`[${(n=o.find(C=>C.type==="decimal"))==null?void 0:n.value}]`),S=new RegExp(`[${u.join("")}]`,"g"),T=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,E=/[-\u2212\u2013\u2014\u2015]/g;i=C=>{if((C=C.trim().replaceAll(g,"").replace(w,".").replace(S,R=>String(p.get(R))).replaceAll(T,"").replaceAll(E,"-"))==="")return null;const L=Number(C);return isNaN(L)?null:L},vj.set(e,i)}return i(t)}bP(()=>{sT=new WeakMap,sX={}});const vj=new Map,oX=()=>fe.getLogger("esri.intl.substitute");function qn(t,e,i={}){const{format:r={}}=i;return Xu(t,n=>J1e(n,e,r))}function J1e(t,e,i){let r,n;const o=t.indexOf(":");if(o===-1?r=t.trim():(r=t.slice(0,o).trim(),n=t.slice(o+1).trim()),!r)return"";const u=G3(r,e);if(u==null)return"";const p=(n?i==null?void 0:i[n]:null)??(i==null?void 0:i[r]);return p?Z1e(u,p):n?K1e(u,n):KP(u)}function Z1e(t,e){switch(e.type){case"date":return ln(t,e.intlOptions);case"number":return as(t,e.intlOptions);default:return oX().warn("missing format descriptor for key {key}"),KP(t)}}function K1e(t,e){switch(e.toLowerCase()){case"dateformat":return ln(t);case"numberformat":return as(t);default:return oX().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?ln(t):/^numberformat/i.test(e)?as(t):KP(t)}}function KP(t){switch(typeof t){case"string":return t;case"number":return as(t);case"boolean":return""+t;default:return t instanceof Date?ln(t):""}}async function Y1e(t,e,i,r){const n=e.exec(i);if(!n)throw new re("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const o=n[1]?`${n[1]}/`:"",u=n[2],p=Ffe(r),g=`${o}${u}.json`,w=p?`${o}${u}_${p}.json`:g;let S;try{S=await bj(t(w))}catch(T){if(w===g)throw new re("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:T});try{S=await bj(t(g))}catch(E){throw new re("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:E})}}return S}async function bj(t){if(wj.fetchBundleAsset!=null)return wj.fetchBundleAsset(t);const e=await nt(t,{responseType:"text"});return JSON.parse(e.data)}let X1e=class{constructor({base:e="",pattern:i,location:r=new URL(window.location.href)}){let n;n=typeof r=="string"?o=>new URL(o,new URL(r,window.location.href)).href:r instanceof URL?o=>new URL(o,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=n,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,i){return Y1e(this.getAssetUrl,this.matcher,e,i)}};function Q1e(t){return new X1e(t)}const wj={};Rfe(Q1e({pattern:"esri/",location:qt}));function q0(t){return typeof t=="number"}function pb(t){return typeof t=="string"||t instanceof String}const eve=ra,AC={date:null,time:null,timeZoneOffset:null},tve=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]),lS="yyyy-MM-dd",aX="TT";var Ev;(function(t){t.HM="HH:mm",t.HMS="HH:mm:ss",t.HMS_MS="HH:mm:ss.SSS"})(Ev||(Ev={}));const ive=[Ev.HMS_MS,Ev.HMS,Ev.HM,aX],n_="latn",rve=t=>"valueAsDate"in t;function Lm(t){return{locale:Ss(),numberingSystem:n_,zone:t??eve}}function lX(t,e){return t===null?null:De.fromMillis(t,Lm(e))}function s_(t,e){if(t==null||!pb(t)||t===""){if(e){const r=De.local({zone:e});return{date:null,time:null,timeZoneOffset:r.isValid?r.offset.toString():null}}return AC}const i=De.fromISO(t,{setZone:!0});return{date:i.toFormat(lS,Lm()),time:i.toFormat(Ev.HMS_MS,Lm()),timeZoneOffset:i.offset.toString()}}function gx(t,e){if(t==null||!q0(t)||isNaN(t))return AC;const i=lX(t,e);return i?{date:i.toFormat(lS,Lm(e)),time:i.toFormat(aX,Lm(e))}:AC}function YP(t){switch(t.type){case"date":default:return bo("short-date-short-time");case"date-only":return bo("short-date");case"time-only":return bo("short-time");case"timestamp-offset":return{...bo("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function uX(t,e,i){if(!t||e==null)return null;switch(t.type){case"date":return ln(e,i);case"date-only":return JY(e,i);case"time-only":return ZY(e,i);case"timestamp-offset":return KY(e,i);default:return null}}function nve(t){const{dateComponent:e,defaultTimeZone:i,timeComponent:r,timeZoneComponent:n,oldValue:o}=t;if(!(e!=null&&e.value)||!(r!=null&&r.value))return null;const{year:u,month:p,day:g}=De.fromFormat(e.value,lS),{hour:w,minute:S,second:T,millisecond:E}=LC(r,ra)??De.now(),C=s_(o,i),L=(n==null?void 0:n.value)!=null?parseInt(n.value,10):C.timeZoneOffset!=null?parseInt(C.timeZoneOffset,10):new Date().getTimezoneOffset(),R=an.instance(L),F=De.fromObject({year:u,month:p,day:g,hour:w,minute:S,second:T,millisecond:E},{zone:R});return F.isValid?F.toISO({includeOffset:!0}):null}function sve(t){const{dateComponent:e,timeComponent:i,timeZone:r,max:n,min:o,oldValue:u}=t,p=LC(e,r);let g=!!t.applyRange;if(!p)return null;let w=null;if((i==null?void 0:i.value)!=null){const T=LC(i,r),E=Date.now(),C=n!=null&&n<E?n:E,L=De.fromMillis(C,Lm(r)),R=p||L,{year:F,month:V,day:U}=R,{hour:W,minute:H,second:J,millisecond:X}=T||L;w=R.set({year:F,month:V,day:U,hour:W,minute:H,second:J,millisecond:X})}else{const T=lX(Sj({value:u??Date.now(),max:n,min:o}),r),{year:E,month:C,day:L}=p,{hour:R,minute:F,second:V,millisecond:U}=T;g=!0,w=p.set({year:E,month:C,day:L,hour:R,minute:F,second:V,millisecond:U})}if(!w.isValid)return null;const S=w.toMillis();return g?Sj({value:S,max:n,min:o}):S}function LC(t,e){if((t==null?void 0:t.value)==null||Array.isArray(t.value))return null;let i=null;return i=rve(t)?De.fromFormat(t.value,lS,Lm(e)):Iv(t.value),i!=null&&i.isValid?i:null}function _j(t){const{max:e,min:i,value:r}=t;return!isNaN(r)&&!(e!=null&&r>e)&&!(i!=null&&r<i)}function Sj(t){const{max:e,min:i,value:r}=t;return e!=null&&i!=null?An(r,i,e):e!=null&&r>e?e:i!=null&&r<i?i:r}function OC(t){if(!t)return"";const e=t.split(".").at(0);if(!e||e.length<1)throw new re("invalid time-only field",`Cannot parse valid time-only field value from ${t}`);const i=e.split(":"),r=new Array(3);for(let n=0;n<3;n++){const o=i.at(n)??"";r[n]=o.padStart(2,"0")}return r.join(":")}function ove(t,e){switch(e){case"date":return t.getTime();case"date-only":return t.toISODate();case"time-only":return OC(t.toISOTime(!0,!1));case"timestamp-offset":return t.toISOString(!1);default:return null}}function ave(t){return!!t&&typeof t=="object"&&"getTime"in t&&"toISOString"in t&&"timeZone"in t}function T2(t){if(!t||!pb(t))return null;const e=De.fromFormat(t,lS);return e.isValid?e:null}function Iv(t){return t&&pb(t)?Qv(ive,e=>{const i=De.fromFormat(t,e);return i.isValid?i:null})??null:null}function E2(t){if(!t||!pb(t))return null;const e=De.fromISO(t);return e.isValid?e:null}function lve(t){const{type:e,range:i,value:r}=t;if(r==null||!i||r===i.min||r===i.max)return!0;if(e==="date")return _j({value:r,min:i.min,max:i.max});const{rawMax:n,rawMin:o}=i;let u=null,p=null,g=null;switch(e){case"date-only":u=T2(n),p=T2(o),g=T2(r);break;case"time-only":u=Iv(n),p=Iv(o),g=Iv(r);break;case"timestamp-offset":u=E2(n),p=E2(o),g=E2(r)}return!g||_j({value:g.valueOf(),min:p==null?void 0:p.valueOf(),max:u==null?void 0:u.valueOf()})}var i0;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(i0||(i0={}));const uve=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function cve(t){return t!=null&&uve.has(t.type)}function cX(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function hX(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function pX(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function PC(t,e,i){const r=i??(t==null?void 0:t.domain);if(!r)return null;switch(r.type){case"range":{const{min:n,max:o}=av(t,i);if(n!=null&&+e<n||o!=null&&+e>o)return i0.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(r.codedValues==null||r.codedValues.every(n=>n==null||n.code!==e))return i0.INVALID_CODED_VALUE}return null}function av(t,e){const i=e??(t==null?void 0:t.domain);if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,n="range"in i?i.range[1]:i.maxValue,o=cve(t);return cX(t)||pX(t)||hX(t)?{...dX(t,n,r),isInteger:o}:{min:r!=null&&typeof r=="number"?r:null,max:n!=null&&typeof n=="number"?n:null,rawMin:r,rawMax:n,isInteger:o}}function dX(t,e,i){var r,n,o,u,p,g;return cX(t)?{min:(r=T2(i))==null?void 0:r.toMillis(),max:(n=T2(e))==null?void 0:n.toMillis(),rawMin:i,rawMax:e}:pX(t)?{min:(o=Iv(i))==null?void 0:o.toMillis(),max:(u=Iv(e))==null?void 0:u.toMillis(),rawMin:i,rawMax:e}:hX(t)?{min:(p=E2(i))==null?void 0:p.toMillis(),max:(g=E2(e))==null?void 0:g.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}const hve=()=>fe.getLogger("esri.support.arcadeOnDemand");let O9;function fh(){return O9||(O9=(async()=>{const t=await ie(()=>import("./arcadeUtils-u4M4i7vy.js").then(e=>e.aN),__vite__mapDeps([10,11,12,13,14,15]));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),O9}const pve=(t,e,i)=>fX.create(t,e,i,null,["$feature","$view"],[]),dve=(t,e,i,r)=>fX.create(t,e,i,r,["$feature","$view"],[]);let fX=class yX{constructor(e,i,r,n,o,u,p){this.services=null,this.script=e,this.evaluate=n;const g=Array.isArray(u)?u:u==null?void 0:u.fields;this.fields=g??[],this._syntaxTree=r,this._arcade=i,this._arcadeFeature=o,this._spatialReference=p,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(e,i,r,n,o,u){const{arcade:p,Feature:g,Dictionary:w}=await fh(),S=Ge.fromJSON(i);let T;try{T=p.parseScript(e,u)}catch(oe){return hve().error(new re("arcade-bad-expression","Failed to parse arcade script",{script:e,error:oe})),null}const E=o.reduce((oe,pe)=>({...oe,[pe]:null}),{});let C=null;n!=null&&(C=new w(n),C.immutable=!0,E.$config=null);const L=p.scriptUsesGeometryEngine(T),R=L&&p.enableGeometrySupport(),F=p.scriptUsesFeatureSet(T)&&p.enableFeatureSetSupport(),V=p.scriptIsAsync(T),U=V&&p.enableAsyncSupport(),W={vars:E,spatialReference:S,useAsync:!!U};await Promise.all([R,F,U]);const H=new Set;await p.loadDependentModules(H,T,null,V,L);const J=new w;J.immutable=!1,J.setField("scale",0);const X=p.compileScript(T,W),te=(oe,pe)=>{var ge;const de=(ge=oe.$view)==null?void 0:ge.timeZone;return"$view"in oe&&oe.$view&&(J.setField("scale",typeof oe.$view=="object"&&"scale"in oe.$view?oe.$view.scale:void 0),oe.$view=J),C&&(oe.$config=C),X({vars:oe,spatialReference:S,services:pe,timeZone:de})};return new yX(e,p,T,te,new g,r,S)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const fve=/^([0-9_])/,yve=/[^a-z0-9_\u0080-\uffff]+/gi;function mve(t){return t==null?null:t.trim().replaceAll(yve,"_").replace(fve,"F$1")||null}const gve=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],vve=["field","normalizationField"];function xj(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if($j(gve,i,e),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)$j(vve,r,e)}}function $j(t,e,i){if(t)for(const r of t){const n=G3(r,e),o=n&&typeof n!="function"&&i.get(n);o&&Wn(r,o.name,e)}}function mX(t,e){var i;if(t!=null&&((i=e==null?void 0:e.fields)!=null&&i.length))if("startField"in t){const r=e.get(t.startField),n=e.get(t.endField);t.startField=(r==null?void 0:r.name)??null,t.endField=(n==null?void 0:n.name)??null}else{const r=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=(r==null?void 0:r.name)??null,t.endTimeField=(n==null?void 0:n.name)??null}}const P9=new Set;function Hm(t,e){return t&&e?(P9.clear(),Om(P9,t,e),Array.from(P9).sort()):[]}function Om(t,e,i){var r;if(i)if((r=e==null?void 0:e.fields)!=null&&r.length)if(i.includes("*"))for(const{name:n}of e.fields)t.add(n);else for(const n of i)_o(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const n of i)n!=null&&t.add(n)}}function _o(t,e,i){if(typeof i=="string")if(e){const r=e.get(i);r&&t.add(r.name)}else t.add(i)}function CJe(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}function AJe(t,e,i=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const r=Hm(t,e);return r.length/t.fields.length>=i?["*"]:r}async function Qs(t,e,i){var o;if(!i)return;const{arcadeUtils:r}=await fh(),n=r.extractFieldNames(i,(o=e==null?void 0:e.fields)==null?void 0:o.map(u=>u.name));for(const u of n)_o(t,e,u)}async function gX(t,e,i){if(i&&i!=="1=1"){const r=await ZP(i,e);if(!r.isStandardized)throw new re("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});Om(t,e,r.fieldNames)}}function XP({displayField:t,fields:e}){return t||(e!=null&&e.length?R9(e,"name-or-title")||R9(e,"unique-identifier")||R9(e,"type-or-category")||bve(e):null)}function bve(t){for(const e of t){if(!(e!=null&&e.name))continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function R9(t,e){for(const i of t)if(i!=null&&i.valueType&&i.valueType===e)return i.name;return null}async function LJe(t,e){var r;if(!e)return;const i=(r=e.elevationInfo)==null?void 0:r.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function wve(t,e,i){i.onStatisticExpression?Qs(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function OJe(t,e,i){if(!e||!i||!("fields"in i))return;const r=[],n=i.popupTemplate;r.push(_ve(t,e,n)),i.fields&&r.push(...i.fields.map(async o=>wve(t,e.fieldsIndex,o))),await Promise.all(r)}async function _ve(t,e,i){const r=[];i!=null&&i.expressionInfos&&r.push(...i.expressionInfos.map(o=>Qs(t,e.fieldsIndex,o.expression)));const n=i==null?void 0:i.content;if(Array.isArray(n))for(const o of n)o.type==="expression"&&o.expressionInfo&&r.push(Qs(t,e.fieldsIndex,o.expressionInfo.expression));await Promise.all(r)}async function PJe(t,e,i){e&&(e.timeInfo&&(i!=null&&i.timeExtent)&&Om(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Om(t,e.fieldsIndex,[e.floorInfo.floorField]),(i==null?void 0:i.where)!=null&&await gX(t,e.fieldsIndex,i.where))}async function RJe(t,e,i){e&&i&&await Promise.all(i.map(r=>Sve(t,e,r)))}async function Sve(t,e,i){e&&i&&(i.valueExpression?await Qs(t,e.fieldsIndex,i.valueExpression):i.field&&_o(t,e.fieldsIndex,i.field))}function FJe(t){return t?Hm(t.fieldsIndex,vX(t)):[]}function xve(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?Hm(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const $ve=new Set(["oid","global-id","guid"]),Tve=new Set(["oid","global-id"]),Eve=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function Ive(t){const e=new Set;QP(t).forEach(r=>e.add(r)),xve(t).forEach(r=>e.add(r.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function vX(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:r,editDateField:n,editorField:o}=e;return[i,r,n,o].filter(Boolean)}function QP(t){return vX(t).map(e=>e.toLowerCase())}function Mve(t,e){var i;return t.editable&&!$ve.has(t.type)&&!QP(e).includes(((i=t.name)==null?void 0:i.toLowerCase())??"")}function bX(t,e){var r;const i=((r=t.name)==null?void 0:r.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&i===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&i===e.globalIdField.toLowerCase()||Ive(e).includes(i)||Tve.has(t.type)||Eve.some(n=>n.test(i)))}async function kve(t,e){const{labelingInfo:i,fieldsIndex:r}=e;i!=null&&i.length&&await Promise.all(i.map(n=>Cve(t,r,n)))}async function Cve(t,e,i){if(!i)return;const r=i.getLabelExpression(),n=i.where;if(r.type==="arcade")await Qs(t,e,r.expression);else{const o=r.expression.match(/{[^}]*}/g);o&&o.forEach(u=>{_o(t,e,u.slice(1,-1))})}await gX(t,e,n)}function Ave(t){const e=t.defaultValue;return e!==void 0&&SX(t,e)?e:t.nullable?null:void 0}function NJe(t){const e=typeof t=="string"?{type:t}:t;return mE(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function wX(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Lve(t){return t===null||wX(t)}function Ove(t){return t===null||Number.isInteger(t)}function _X(t){return t!=null&&typeof t=="string"}function Pve(t){return t===null||_X(t)}function Rve(){return!0}function SX(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?Ove:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Lve:wX;break;case"string":case"esriFieldTypeString":i=t.nullable?Pve:_X;break;default:i=Rve}return arguments.length===1?i:i(e)}const Fve=["integer","small-integer","big-integer"],Nve=["single","double"],Dve=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],jve=["esriFieldTypeSingle","esriFieldTypeDouble"],xX=new Set([...Fve,...Dve]),Vve=new Set([...Nve,...jve]),zve=U7(xX,Vve);function Uve(t){return t!=null&&xX.has(t.type)}function Mv(t){return t!=null&&zve.has(t.type)}function mE(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function e8(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function Gve(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Bve(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function db(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function Tj(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function Ej(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function DJe(t,e){return $X(t,e)===null}var fb,yb;function jJe(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function $X(t,e){return t==null||t.nullable&&e===null?null:Mv(t)&&!qve(t.type,Number(e))?fb.OUT_OF_RANGE:SX(t,e)?t.domain?PC(t,e):null:yb.INVALID_TYPE}function qve(t,e){const i=typeof t=="string"?t8(t):t;if(!i)return!1;const r=i.min,n=i.max;return i.isInteger?Number.isInteger(e)&&e>=r&&e<=n:e>=r&&e<=n}function Hve(t,e){return av(t,e)||(Mv(t)?t8(t.type):void 0)}function t8(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Wve;case"esriFieldTypeInteger":case"integer":return Jve;case"esriFieldTypeBigInteger":case"big-integer":return Zve;case"esriFieldTypeSingle":case"single":return Kve;case"esriFieldTypeDouble":case"double":return Yve}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(fb||(fb={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(yb||(yb={}));const Wve={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Jve={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},Zve={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},Kve={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},Yve={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function VJe(t,e,i){switch(t){case i0.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case i0.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case yb.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case fb.OUT_OF_RANGE:{const{min:r,max:n}=t8(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${n}`}}}function TX(t,e){return!Xve(t,e,null)}function Xve(t,e,i){if(!(e!=null&&e.attributes)||!t)return!0;const r=new Set(Object.keys(e.attributes));let n=!1;for(const o of t)if(!r.has(o)&&(n=!0,i==null))break;return n}function RC(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function i8(t){const e=t==null?void 0:t.match(/{[^}]+}/g);return e?e.map(i=>i.slice(1,-1).split(":")[0].trim()):[]}let oT=class extends ye{constructor(e){super(e),this.type=null}};m([b({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],oT.prototype,"type",void 0),oT=m([G("esri.popup.content.Content")],oT);const p0=oT;var FC;let H0=FC=class extends p0{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new FC({description:this.description,displayType:this.displayType,title:this.title})}};m([b({type:String,json:{write:!0}})],H0.prototype,"description",void 0),m([b({type:["auto","preview","list"],json:{write:!0}})],H0.prototype,"displayType",void 0),m([b({type:String,json:{write:!0}})],H0.prototype,"title",void 0),m([b({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],H0.prototype,"type",void 0),H0=FC=m([G("esri.popup.content.AttachmentsContent")],H0);const f3=H0;var NC;let W0=NC=class extends p0{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new NC({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?ae(this.outFields):null})}};m([b()],W0.prototype,"creator",void 0),m([b()],W0.prototype,"destroyer",void 0),m([b()],W0.prototype,"outFields",void 0),m([b({type:["custom"],readOnly:!0})],W0.prototype,"type",void 0),W0=NC=m([G("esri.popup.content.CustomContent")],W0);const Qve=W0;var DC;let Zg=DC=class extends ye{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new DC({title:this.title,expression:this.expression})}};m([b({type:String,json:{write:!0}})],Zg.prototype,"title",void 0),m([b({type:String,json:{write:!0}})],Zg.prototype,"expression",void 0),m([b({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],Zg.prototype,"returnType",void 0),Zg=DC=m([G("esri.popup.ElementExpressionInfo")],Zg);const ebe=Zg;var jC;let o_=jC=class extends p0{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new jC({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};m([b({type:ebe,json:{write:!0}})],o_.prototype,"expressionInfo",void 0),m([b({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],o_.prototype,"type",void 0),o_=jC=m([G("esri.popup.content.ExpressionContent")],o_);const r8=o_;let Kg=class extends Gt(ye){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};m([ze(R1e)],Kg.prototype,"dateFormat",void 0),m([b({type:Boolean,json:{write:!0}})],Kg.prototype,"digitSeparator",void 0),m([b({type:zt,json:{write:!0}})],Kg.prototype,"places",void 0),Kg=m([G("esri.popup.support.FieldInfoFormat")],Kg);const aT=Kg;var VC;let uu=VC=class extends ye{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){var t;return new VC({fieldName:this.fieldName,format:(t=this.format)==null?void 0:t.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};m([b({type:String,json:{write:!0}})],uu.prototype,"fieldName",void 0),m([b({type:aT,json:{write:!0}})],uu.prototype,"format",void 0),m([b({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],uu.prototype,"isEditable",void 0),m([b({type:String,json:{write:!0}})],uu.prototype,"label",void 0),m([ze(new et({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],uu.prototype,"stringFieldOption",void 0),m([b({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],uu.prototype,"statisticType",void 0),m([b({type:String,json:{write:!0}})],uu.prototype,"tooltip",void 0),m([b({type:Boolean,json:{write:!0}})],uu.prototype,"visible",void 0),uu=VC=m([G("esri.popup.FieldInfo")],uu);const n8=uu;var zC;let Bh=zC=class extends p0{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(i=>i.toJSON())}clone(){return new zC(ae({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};m([b({type:Object,json:{write:!0}})],Bh.prototype,"attributes",void 0),m([b({type:String,json:{write:!0}})],Bh.prototype,"description",void 0),m([b({type:[n8]})],Bh.prototype,"fieldInfos",void 0),m([Le("fieldInfos")],Bh.prototype,"writeFieldInfos",null),m([b({type:String,json:{write:!0}})],Bh.prototype,"title",void 0),m([b({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],Bh.prototype,"type",void 0),Bh=zC=m([G("esri.popup.content.FieldsContent")],Bh);const y3=Bh;let J0=class extends ye{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};m([b({type:String,json:{write:!0}})],J0.prototype,"altText",void 0),m([b({type:String,json:{write:!0}})],J0.prototype,"caption",void 0),m([b({type:String,json:{write:!0}})],J0.prototype,"title",void 0),m([b({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],J0.prototype,"type",void 0),J0=m([G("esri.popup.content.mixins.MediaInfo")],J0);const s8=J0;var UC;let Z0=UC=class extends Te{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){var t;return new UC({color:(t=this.color)==null?void 0:t.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};m([b()],Z0.prototype,"color",void 0),m([b()],Z0.prototype,"fieldName",void 0),m([b()],Z0.prototype,"tooltip",void 0),m([b()],Z0.prototype,"value",void 0),Z0=UC=m([G("esri.popup.content.support.ChartMediaInfoValueSeries")],Z0);const tbe=Z0;var GC;let Pd=GC=class extends ye{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new GC({colors:ae(this.colors),fields:ae(this.fields),normalizeField:this.normalizeField,series:ae(this.series),tooltipField:this.tooltipField})}};m([b({type:[Ce],json:{type:[[zt]],write:!0}})],Pd.prototype,"colors",void 0),m([b({type:[String],json:{write:!0}})],Pd.prototype,"fields",void 0),m([b({type:String,json:{write:!0}})],Pd.prototype,"normalizeField",void 0),m([b({type:[tbe],json:{read:!1}})],Pd.prototype,"series",void 0),m([b({type:String,json:{write:!0}})],Pd.prototype,"tooltipField",void 0),Pd=GC=m([G("esri.popup.content.support.ChartMediaInfoValue")],Pd);const ibe=Pd;let a_=class extends s8{constructor(e){super(e),this.type=null,this.value=void 0}};m([b({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],a_.prototype,"type",void 0),m([b({type:ibe,json:{write:!0}})],a_.prototype,"value",void 0),a_=m([G("esri.popup.content.mixins.ChartMediaInfo")],a_);const QI=a_,eM=dt()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var BC;let lT=BC=class extends QI{constructor(t){super(t),this.type="bar-chart"}clone(){var t;return new BC({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};m([b({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:eM.write}})],lT.prototype,"type",void 0),lT=BC=m([G("esri.popup.content.BarChartMediaInfo")],lT);const EX=lT;var qC;let uT=qC=class extends QI{constructor(t){super(t),this.type="column-chart"}clone(){var t;return new qC({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};m([b({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:eM.write}})],uT.prototype,"type",void 0),uT=qC=m([G("esri.popup.content.ColumnChartMediaInfo")],uT);const IX=uT;var HC;let l_=HC=class extends ye{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new HC({linkURL:this.linkURL,sourceURL:this.sourceURL})}};m([b({type:String,json:{write:!0}})],l_.prototype,"linkURL",void 0),m([b({type:String,json:{write:!0}})],l_.prototype,"sourceURL",void 0),l_=HC=m([G("esri.popup.content.support.ImageMediaInfoValue")],l_);const rbe=l_;var WC;let Yg=WC=class extends s8{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){var t;return new WC({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:(t=this.value)==null?void 0:t.clone()})}};m([b({type:Number,json:{write:!0}})],Yg.prototype,"refreshInterval",void 0),m([b({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],Yg.prototype,"type",void 0),m([b({type:rbe,json:{write:!0}})],Yg.prototype,"value",void 0),Yg=WC=m([G("esri.popup.content.ImageMediaInfo")],Yg);const MX=Yg;var JC;let cT=JC=class extends QI{constructor(t){super(t),this.type="line-chart"}clone(){var t;return new JC({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};m([b({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:eM.write}})],cT.prototype,"type",void 0),cT=JC=m([G("esri.popup.content.LineChartMediaInfo")],cT);const kX=cT;var ZC;let hT=ZC=class extends QI{constructor(t){super(t),this.type="pie-chart"}clone(){var t;return new ZC({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};m([b({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:eM.write}})],hT.prototype,"type",void 0),hT=ZC=m([G("esri.popup.content.PieChartMediaInfo")],hT);const CX=hT,AX={base:s8,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":EX,"column-chart":IX,"line-chart":kX,"pie-chart":CX,image:MX}};var KC;let cu=KC=class extends p0{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?MX.fromJSON(e):e.type==="barchart"?EX.fromJSON(e):e.type==="columnchart"?IX.fromJSON(e):e.type==="linechart"?kX.fromJSON(e):e.type==="piechart"?CX.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new KC(ae({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};m([b()],cu.prototype,"activeMediaInfoIndex",void 0),m([b({type:Object,json:{write:!0}})],cu.prototype,"attributes",void 0),m([b({type:String,json:{write:!0}})],cu.prototype,"description",void 0),m([b({types:[AX]})],cu.prototype,"mediaInfos",void 0),m([Me("mediaInfos")],cu.prototype,"readMediaInfos",null),m([Le("mediaInfos")],cu.prototype,"writeMediaInfos",null),m([b({type:String,json:{write:!0}})],cu.prototype,"title",void 0),m([b({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],cu.prototype,"type",void 0),cu=KC=m([G("esri.popup.content.MediaContent")],cu);const gE=cu;var YC;let u_=YC=class extends ye{constructor(t){super(t),this.field=null,this.order=null}clone(){return new YC({field:this.field,order:this.order})}};m([b({type:String,json:{write:!0}})],u_.prototype,"field",void 0),m([b({type:["asc","desc"],json:{write:!0}})],u_.prototype,"order",void 0),u_=YC=m([G("esri.popup.support.RelatedRecordsInfoFieldOrder")],u_);const o8=u_;let bc=class extends Gt(p0){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};m([b({type:String,json:{write:!0}})],bc.prototype,"description",void 0),m([b({type:Number,json:{type:zt,write:!0}})],bc.prototype,"displayCount",void 0),m([b({type:["list"],json:{write:!0}})],bc.prototype,"displayType",void 0),m([b({type:[o8],json:{write:!0}})],bc.prototype,"orderByFields",void 0),m([b({type:Number,json:{type:zt,write:!0}})],bc.prototype,"relationshipId",void 0),m([b({type:String,json:{write:!0}})],bc.prototype,"title",void 0),m([b({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],bc.prototype,"type",void 0),bc=m([G("esri.popup.content.RelationshipContent")],bc);const vE=bc;var XC;let c_=XC=class extends p0{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new XC({text:this.text})}};m([b({type:String,json:{write:!0}})],c_.prototype,"text",void 0),m([b({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],c_.prototype,"type",void 0),c_=XC=m([G("esri.popup.content.TextContent")],c_);const bE=c_,nbe={base:null,key:"type",typeMap:{attachment:f3,media:gE,text:bE,expression:r8,field:y3,relationship:vE}};var QC;let K0=QC=class extends ye{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new QC({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};m([b({type:String,json:{write:!0}})],K0.prototype,"name",void 0),m([b({type:String,json:{write:!0}})],K0.prototype,"title",void 0),m([b({type:String,json:{write:!0}})],K0.prototype,"expression",void 0),m([b({type:["string","number"],json:{write:!0}})],K0.prototype,"returnType",void 0),K0=QC=m([G("esri.popup.ExpressionInfo")],K0);const sbe=K0;var e6;let h_=e6=class extends ye{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new e6({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};m([b({type:Boolean,json:{write:!0}})],h_.prototype,"returnTopmostRaster",void 0),m([b({type:Boolean,json:{write:!0}})],h_.prototype,"showNoDataRecords",void 0),h_=e6=m([G("esri.popup.LayerOptions")],h_);const obe=h_;var t6;let p_=t6=class extends ye{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new t6({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?ae(this.orderByFields):null})}};m([b({type:Boolean,json:{write:!0}})],p_.prototype,"showRelatedRecords",void 0),m([b({type:[o8],json:{write:!0}})],p_.prototype,"orderByFields",void 0),p_=t6=m([G("esri.popup.RelatedRecordsInfo")],p_);const abe=p_;var i6;let sl=i6=class extends nc(Te){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new i6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};m([b()],sl.prototype,"active",void 0),m([b()],sl.prototype,"className",void 0),m([b()],sl.prototype,"disabled",void 0),m([b()],sl.prototype,"icon",void 0),m([b()],sl.prototype,"id",void 0),m([b()],sl.prototype,"indicator",void 0),m([b()],sl.prototype,"title",void 0),m([b()],sl.prototype,"type",void 0),m([b()],sl.prototype,"visible",void 0),sl=i6=m([G("esri.support.actions.ActionBase")],sl);const uS=sl;var r6;let pT=r6=class extends uS{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new r6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};m([b()],pT.prototype,"image",void 0),pT=r6=m([G("esri.support.actions.ActionButton")],pT);const LX=pT;var n6;let d_=n6=class extends uS{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new n6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};m([b()],d_.prototype,"image",void 0),m([b()],d_.prototype,"value",void 0),d_=n6=m([G("esri.support.actions.ActionToggle")],d_);const OX=d_,_w="relationships/",Ij="expression/",lbe=Ie.ofType({key:"type",defaultKeyValue:"button",base:uS,typeMap:{button:LX,toggle:OX}}),ube={base:p0,key:"type",typeMap:{media:gE,custom:Qve,text:bE,attachments:f3,fields:y3,expression:r8,relationship:vE}},cbe=new Set(["attachments","fields","media","text","expression","relationship"]);let Nn=class extends Gt(ye){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>ch(ube,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||ed(e)?e:(fe.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeContent(e,i,r,n){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(o=>cbe.has(o.type)).map(o=>o==null?void 0:o.toJSON(n)),i.popupElements.forEach(o=>{o.type==="attachments"?this._writeAttachmentContent(i):o.type==="media"?this._writeMediaContent(o,i):o.type==="text"?this._writeTextContent(o,i):o.type==="relationship"&&this._writeRelationshipContent(o,i)})):i.description=e}writeFieldInfos(e,i,r,n){const{content:o}=this,u=Array.isArray(o)?o:null;if(e){const p=u?u.filter(w=>w.type==="fields"):[],g=p.length&&p.every(w=>{var S;return(S=w.fieldInfos)==null?void 0:S.length});i.fieldInfos=e.filter(Boolean).map(w=>{const S=w.toJSON(n);return g&&(S.visible=!1),S})}if(u)for(const p of u)p.type==="fields"&&this._writeFieldsContent(p,i)}writeLayerOptions(e,i,r,n){i[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(n)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i){const r=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,[...r,...this._getContentExpressionInfos(this.content,r)]),Om(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const i=new Set;return await this.collectRequiredFields(i,e),[...i].sort()}_writeFieldsContent(e,i){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const r=ae(e.fieldInfos);Array.isArray(i.fieldInfos)?r.forEach(n=>{const o=i.fieldInfos.find(u=>{var p,g;return((p=u.fieldName)==null?void 0:p.toLowerCase())===((g=n.fieldName)==null?void 0:g.toLowerCase())});o?o.visible=!0:i.fieldInfos.push(n)}):i.fieldInfos=r}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){var o,u;const r=((o=e.orderByFields)==null?void 0:o.map(p=>this._toFieldOrderJSON(p,e.relationshipId)))||[],n=[...((u=i.relatedRecordsInfo)==null?void 0:u.orderByFields)||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...(n==null?void 0:n.length)&&{orderByFields:n}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=ae(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(e,i,r){const n={description:!1,mediaInfos:!1};return r.map(o=>o.type==="media"?(o.mediaInfos||!i||n.mediaInfos||(o.mediaInfos=i,n.mediaInfos=!0),gE.fromJSON(o)):o.type==="text"?(o.text||!e||n.description||(o.text=e,n.description=!0),bE.fromJSON(o)):o.type==="attachments"?f3.fromJSON(o):o.type==="fields"?y3.fromJSON(o):o.type==="expression"?r8.fromJSON(o):o.type==="relationship"?vE.fromJSON(o):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:r}=e;if(!(i!=null&&i.startsWith(_w)))return null;const n=i.replace(_w,"").split("/");if(n.length!==2)return null;const o=parseInt(n[0],10),u=n[1];return typeof o=="number"&&u?vE.fromJSON({relationshipId:o,orderByFields:[{field:u,order:r}]}):null}_toFieldOrderJSON(e,i){const{order:r,field:n}=e;return{field:`${_w}${i}/${n}`,order:r}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:r,relatedRecordsInfo:n={showRelatedRecords:!1}}){const o=[];e?o.push(new bE({text:e})):o.push(new y3),Array.isArray(i)&&i.length&&o.push(gE.fromJSON({mediaInfos:i})),r&&o.push(f3.fromJSON({displayType:"auto"}));const{showRelatedRecords:u,orderByFields:p}=n;return u&&(p!=null&&p.length)&&p.forEach(g=>{const w=this._toRelationshipContent(g);w&&o.push(w)}),o.length?o:e}_getContentElementFields(e){const i=e==null?void 0:e.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((n,o)=>[...n,...this._getMediaInfoFields(o)],[])]}return i==="text"?this._extractFieldNames(e.text):[]}_getMediaInfoFields(e){const{caption:i,title:r,value:n}=e,o=n||{},{fields:u,normalizeField:p,tooltipField:g,sourceURL:w,linkURL:S}=o,T=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(w),...this._extractFieldNames(S),...u??[]];return p&&T.push(p),g&&T.push(g),T}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((r,n)=>[...r,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,i,r){r&&await Promise.all(r.map(n=>Qs(e,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:i,visible:r})=>!(r!==void 0&&!r||!i||i.startsWith(_w)||i.startsWith(Ij))).map(i=>i.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:i,title:r,type:n}=e,o=n==="button"||n==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(o)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return i8(e).filter(i=>!(i.indexOf(_w)===0||i.indexOf(Ij)===0))}};m([b({type:lbe})],Nn.prototype,"actions",void 0),m([b()],Nn.prototype,"content",void 0),m([Dt("content")],Nn.prototype,"castContent",null),m([Me("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],Nn.prototype,"readContent",null),m([Le("content",{popupElements:{type:Ie.ofType(nbe)},showAttachments:{type:Boolean},mediaInfos:{type:Ie.ofType(AX)},description:{type:String},relatedRecordsInfo:{type:abe}})],Nn.prototype,"writeContent",null),m([b({type:[sbe],json:{write:!0}})],Nn.prototype,"expressionInfos",void 0),m([b({type:[n8]})],Nn.prototype,"fieldInfos",void 0),m([Le("fieldInfos")],Nn.prototype,"writeFieldInfos",null),m([b({type:obe})],Nn.prototype,"layerOptions",void 0),m([Le("layerOptions")],Nn.prototype,"writeLayerOptions",null),m([b({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Nn.prototype,"lastEditInfoEnabled",void 0),m([b()],Nn.prototype,"outFields",void 0),m([b()],Nn.prototype,"overwriteActions",void 0),m([b()],Nn.prototype,"returnGeometry",void 0),m([b({json:{type:String}})],Nn.prototype,"title",void 0),m([Le("title")],Nn.prototype,"writeTitle",null),Nn=m([G("esri.PopupTemplate")],Nn);const Wm=Nn,Mj=new et({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let hbe=0,Xg=class extends ye{constructor(e){super(e),this.id="sym"+hbe++,this.type=null,this.color=new Ce([0,0,0,1])}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};m([b({type:Mj.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Mj.write}}})],Xg.prototype,"type",void 0),m([b({type:Ce,json:{write:{allowNull:!0}}})],Xg.prototype,"color",void 0),m([Me("color")],Xg.prototype,"readColor",null),Xg=m([G("esri.symbols.Symbol")],Xg);const Es=Xg;var s6;let Rd=s6=class extends Es{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const n=r.map(o=>{const u=o.valueExpressionInfo;return u?Qs(t,e,u.expression):null});await Promise.all(n)}}}clone(){return new s6({data:ae(this.data)})}hash(){return CW(JSON.stringify(this.data)).toString()}};m([b({json:{write:!1}})],Rd.prototype,"color",void 0),m([b({json:{write:!0}})],Rd.prototype,"data",void 0),m([Me("data",["symbol"])],Rd.prototype,"readData",null),m([Le("data",{})],Rd.prototype,"writeData",null),m([ze({CIMSymbolReference:"cim"},{readOnly:!0})],Rd.prototype,"type",void 0),Rd=s6=m([G("esri.symbols.CIMSymbol")],Rd);const id=Rd;let Qg=class extends ye{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,r){e||(i[r]=e)}};m([b({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Qg.prototype,"enabled",void 0),m([Le("enabled")],Qg.prototype,"writeEnabled",null),m([b({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],Qg.prototype,"type",void 0),Qg=m([G("esri.symbols.Symbol3DLayer")],Qg);const xh=Qg;function pbe(t,e){const i=e.transparency!=null?l3(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new Ce([r[0]||0,r[1]||0,r[2]||0,i]):null}function dbe(t,e){e.color=t.toJSON().slice(0,3);const i=zI(t.a);i!==0&&(e.transparency=i)}const d0={type:Ce,json:{type:[zt],default:null,read:{source:["color","transparency"],reader:pbe},write:{target:{color:{type:[zt]},transparency:{type:zt}},writer:dbe}}},yh={type:Number,cast:Wt,json:{write:!0}};let Y0=class extends ye{constructor(e){super(e),this.color=new Ce([0,0,0,1]),this.extensionLength=0,this.size=Jn(1)}clone(){}cloneProperties(){return{color:ae(this.color),size:this.size,extensionLength:this.extensionLength}}};m([b({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Y0.prototype,"type",void 0),m([b(d0)],Y0.prototype,"color",void 0),m([b({...yh,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Y0.prototype,"extensionLength",void 0),m([b(yh)],Y0.prototype,"size",void 0),Y0=m([G("esri.symbols.edges.Edges3D")],Y0);const a8=Y0;var o6;let dT=o6=class extends a8{constructor(t){super(t),this.type="sketch"}clone(){return new o6(this.cloneProperties())}};m([ze({sketch:"sketch"},{readOnly:!0})],dT.prototype,"type",void 0),dT=o6=m([G("esri.symbols.edges.SketchEdges3D")],dT);const fbe=dT;var a6;let fT=a6=class extends a8{constructor(t){super(t),this.type="solid"}clone(){return new a6(this.cloneProperties())}};m([ze({solid:"solid"},{readOnly:!0})],fT.prototype,"type",void 0),fT=a6=m([G("esri.symbols.edges.SolidEdges3D")],fT);const PX=fT,RX={types:{key:"type",base:a8,typeMap:{solid:PX,sketch:fbe}},json:{write:!0}};var l6;let za=l6=class extends ye{constructor(t){super(t),this.color=null}clone(){const t={color:this.color!=null?this.color.clone():null};return new l6(t)}};m([b(d0)],za.prototype,"color",void 0),za=l6=m([G("esri.symbols.support.Symbol3DMaterial")],za);var u6;let Fd=u6=class extends xh{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){var t,e;return new u6({edges:(t=this.edges)==null?void 0:t.clone(),enabled:this.enabled,material:(e=this.material)==null?void 0:e.clone(),castShadows:this.castShadows,size:this.size})}};m([ze({Extrude:"extrude"},{readOnly:!0})],Fd.prototype,"type",void 0),m([b({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Fd.prototype,"size",void 0),m([b({type:za,json:{write:!0}})],Fd.prototype,"material",void 0),m([b({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Fd.prototype,"castShadows",void 0),m([b(RX)],Fd.prototype,"edges",void 0),Fd=u6=m([G("esri.symbols.ExtrudeSymbol3DLayer")],Fd);const FX=Fd;let f_=class extends Es{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};m([ze({esriSLS:"simple-line"},{readOnly:!0})],f_.prototype,"type",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],f_.prototype,"width",void 0),f_=m([G("esri.symbols.LineSymbol")],f_);const ybe=f_,mbe=["begin","end","begin-end"],NX=["arrow","circle","square","diamond","cross","x"];var c6;let wc=c6=class extends ye{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,r){e[i]=(r==null?void 0:r.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,r){(r==null?void 0:r.origin)==="web-map"||(e[i]=t)}clone(){return new c6({color:ae(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};m([b({type:["begin","end","begin-end"],json:{write:!0}})],wc.prototype,"placement",void 0),m([ze({"line-marker":"line-marker"},{readOnly:!0}),b({json:{origins:{"web-map":{write:!1}}}})],wc.prototype,"type",void 0),m([b({type:NX})],wc.prototype,"style",void 0),m([Le("style")],wc.prototype,"writeStyle",null),m([b({type:Ce,value:null,json:{write:{allowNull:!0}}})],wc.prototype,"color",null),m([Me("color")],wc.prototype,"readColor",null),m([Le("color")],wc.prototype,"writeColor",null),wc=c6=m([G("esri.symbols.LineSymbolMarker")],wc);const gbe=wc;var h6;const F9=new et({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let qh=h6=class extends ybe{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,r,n,o){if(t&&typeof t!="string")return t;const u={};return t!=null&&(u.style=t),e!=null&&(u.color=e),i!=null&&(u.width=Wt(i)),r!=null&&(u.cap=r),n!=null&&(u.join=n),o!=null&&(u.miterLimit=Wt(o)),u}clone(){var t;return new h6({color:ae(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};m([ze({esriSLS:"simple-line"},{readOnly:!0})],qh.prototype,"type",void 0),m([b({type:F9.apiValues,json:{read:F9.read,write:F9.write}})],qh.prototype,"style",void 0),m([b({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],qh.prototype,"cap",void 0),m([b({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],qh.prototype,"join",void 0),m([b({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":gbe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],qh.prototype,"marker",void 0),m([b({type:Number,json:{read:!1,write:!1}})],qh.prototype,"miterLimit",void 0),qh=h6=m([G("esri.symbols.SimpleLineSymbol")],qh);const cn=qh,vbe=Object.freeze(Object.defineProperty({__proto__:null,default:cn},Symbol.toStringTag,{value:"Module"}));let y_=class extends Es{constructor(e){super(e),this.outline=null,this.type=null}hash(){var e;return`${this.type}.${(e=this.outline)==null?void 0:e.hash()}`}};m([b({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":cn}},json:{default:null,write:!0}})],y_.prototype,"outline",void 0),m([b({type:["simple-fill","picture-fill"],readOnly:!0})],y_.prototype,"type",void 0),y_=m([G("esri.symbols.FillSymbol")],y_);const DX=y_;let yT=class extends ye{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};m([b({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],yT.prototype,"type",void 0),yT=m([G("esri.symbols.patterns.LinePattern3D")],yT);const jX=yT,bbe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var p6;const wbe=dt()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let m_=p6=class extends jX{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new p6(t)}};m([b({type:["style"]})],m_.prototype,"type",void 0),m([ze(wbe),b({type:bbe})],m_.prototype,"style",void 0),m_=p6=m([G("esri.symbols.patterns.LineStylePattern3D")],m_);const l8=m_;let mT=class extends ye{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};m([b({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],mT.prototype,"type",void 0),mT=m([G("esri.symbols.patterns.Pattern3D")],mT);const VX=mT,_be=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var d6;let g_=d6=class extends VX{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new d6({style:this.style})}};m([b({type:["style"]})],g_.prototype,"type",void 0),m([b({type:_be,json:{read:!0,write:!0}})],g_.prototype,"style",void 0),g_=d6=m([G("esri.symbols.patterns.StylePattern3D")],g_);const zX=g_,Sbe={types:{key:"type",base:VX,typeMap:{style:zX}},json:{write:!0}},UX={types:{key:"type",base:jX,typeMap:{style:l8}},json:{write:!0}},I2=new Ce("white");new Ce("black");const xbe=new Ce([255,255,255,0]);function $be(t){return t.r===0&&t.g===0&&t.b===0}var f6;let M2=f6=class extends za{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color!=null?this.color.clone():null,colorMixMode:this.colorMixMode};return new f6(t)}};m([ze({multiply:"multiply",replace:"replace",tint:"tint"})],M2.prototype,"colorMixMode",void 0),M2=f6=m([G("esri.symbols.support.Symbol3DFillMaterial")],M2);function u8(t=Ibe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function c8(t,e,i,r,n,o,u=u8()){return u[0]=t,u[1]=e,u[2]=i,u[3]=r,u[4]=n,u[5]=o,u}function eZe(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new jt(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function tZe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function iZe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function rZe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function nZe(t,e,i=0,r=e.length/3){let n=t[0],o=t[1],u=t[2],p=t[3],g=t[4],w=t[5];for(let S=0;S<r;S++)n=Math.min(n,e[i+3*S]),o=Math.min(o,e[i+3*S+1]),u=Math.min(u,e[i+3*S+2]),p=Math.max(p,e[i+3*S]),g=Math.max(g,e[i+3*S+1]),w=Math.max(w,e[i+3*S+2]);t[0]=n,t[1]=o,t[2]=u,t[3]=p,t[4]=g,t[5]=w}function sZe(t,e,i){const r=e.length;let n=t[0],o=t[1],u=t[2],p=t[3],g=t[4],w=t[5];if(i)for(let S=0;S<r;S++){const T=e[S];n=Math.min(n,T[0]),o=Math.min(o,T[1]),u=Math.min(u,T[2]),p=Math.max(p,T[0]),g=Math.max(g,T[1]),w=Math.max(w,T[2])}else for(let S=0;S<r;S++){const T=e[S];n=Math.min(n,T[0]),o=Math.min(o,T[1]),p=Math.max(p,T[0]),g=Math.max(g,T[1])}t[0]=n,t[1]=o,t[2]=u,t[3]=p,t[4]=g,t[5]=w}function oZe(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function cS(t){return t[0]>=t[3]?0:t[3]-t[0]}function hS(t){return t[1]>=t[4]?0:t[4]-t[1]}function pS(t){return t[2]>=t[5]?0:t[5]-t[2]}function aZe(t){const e=cS(t),i=pS(t),r=hS(t);return Math.sqrt(e*e+i*i+r*r)}function lZe(t,e=[0,0,0]){return e[0]=t[0]+cS(t)/2,e[1]=t[1]+hS(t)/2,e[2]=t[2]+pS(t)/2,e}function uZe(t,e=[0,0,0]){return e[0]=cS(t),e[1]=hS(t),e[2]=pS(t),e}function cZe(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function Tbe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function hZe(t,e){return e==null||Tbe(t,e)}function pZe(t,e,i,r,n=t){return n[0]=t[0]+e,n[1]=t[1]+i,n[2]=t[2]+r,n[3]=t[3]+e,n[4]=t[4]+i,n[5]=t[5]+r,n}function dZe(t,e,i=t){const r=t[0]+cS(t)/2,n=t[1]+hS(t)/2,o=t[2]+pS(t)/2;return i[0]=r+(t[0]-r)*e,i[1]=n+(t[1]-n)*e,i[2]=o+(t[2]-o)*e,i[3]=r+(t[3]-r)*e,i[4]=n+(t[4]-n)*e,i[5]=o+(t[5]-o)*e,i}function fZe(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function yZe(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function mZe(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function Ebe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function gZe(t){return t?Ebe(t,Cj):u8(Cj)}function vZe(t,e){return e||(e=bs()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function bZe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function wZe(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=n,t[5]=Number.POSITIVE_INFINITY,t}function kj(t){return t.length===6}function _Ze(t){return cS(t)===0&&hS(t)===0&&pS(t)===0}function SZe(t,e,i){if(t==null||e==null)return t===e;if(!kj(t)||!kj(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const Cj=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Ibe=[0,0,0,0,0,0];u8();function xZe(t,{isPrimitive:e,width:i,depth:r,height:n}){const o=e?10:1;if(i==null&&n==null&&r==null)return[o*t[0],o*t[1],o*t[2]];const u=un(i,r,n);let p;for(let g=0;g<3;g++){const w=u[g];if(w!=null){p=w/t[g];break}}for(let g=0;g<3;g++)u[g]==null&&(u[g]=t[g]*p);return u}const Mbe=c8(-.5,-.5,-.5,.5,.5,.5),kbe=c8(-.5,-.5,0,.5,.5,1),Cbe=c8(-.5,-.5,0,.5,.5,.5);function $Ze(t){switch(t){case"sphere":case"cube":case"diamond":return Mbe;case"cylinder":case"cone":case"inverted-cone":return kbe;case"tetrahedron":return Cbe;default:return}}const h8=["butt","square","round"],Abe=[...h8,"none"],GX=["miter","bevel","round"];var y6;let X0=y6=class extends ye{constructor(t){super(t),this.color=new Ce([0,0,0,1]),this.size=Jn(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new y6(t)}};m([b(d0)],X0.prototype,"color",void 0),m([b(yh)],X0.prototype,"size",void 0),m([b(UX)],X0.prototype,"pattern",void 0),m([b({type:h8,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],X0.prototype,"patternCap",void 0),X0=y6=m([G("esri.symbols.support.Symbol3DOutline")],X0);var gT;let Hh=gT=class extends xh{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new gT(t)}static fromSimpleFillSymbol(t){var r,n,o;const e=t.outline&&t.outline.style&&t.outline.style!=="solid"?new l8({style:t.outline.style}):null,i={size:((r=t.outline)==null?void 0:r.width)??0,color:(((n=t.outline)==null?void 0:n.color)??I2).clone(),pattern:e};return e&&((o=t.outline)!=null&&o.cap)&&(i.patternCap=t.outline.cap),new gT({material:new M2({color:(t.color??xbe).clone()}),pattern:t.style&&t.style!=="solid"?new zX({style:t.style}):null,outline:i})}};m([ze({Fill:"fill"},{readOnly:!0})],Hh.prototype,"type",void 0),m([b({type:M2,json:{write:!0}})],Hh.prototype,"material",void 0),m([b(Sbe)],Hh.prototype,"pattern",void 0),m([b({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Hh.prototype,"castShadows",void 0),m([b({type:X0,json:{write:!0}})],Hh.prototype,"outline",void 0),m([b(RX)],Hh.prototype,"edges",void 0),Hh=gT=m([G("esri.symbols.FillSymbol3DLayer")],Hh);const f0=Hh,Lbe=["none","underline","line-through"],Obe=["normal","italic","oblique"],Pbe=["normal","lighter","bold","bolder"],BX={type:Number,cast:t=>{const e=Tl(t);return e===0?1:An(e,.1,4)},nonNullable:!0},Rbe=["left","right","center"],Fbe=["baseline","top","middle","bottom"],qX={type:Rbe,nonNullable:!0},HX={type:Fbe,nonNullable:!0},TZe=8;var m6;let Wh=m6=class extends ye{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Wt(t)}clone(){return new m6({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};m([b({type:Lbe,json:{default:"none",write:!0}})],Wh.prototype,"decoration",void 0),m([b({type:String,json:{write:!0}})],Wh.prototype,"family",void 0),m([b({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],Wh.prototype,"size",void 0),m([Dt("size")],Wh.prototype,"castSize",null),m([b({type:Obe,json:{default:"normal",write:!0}})],Wh.prototype,"style",void 0),m([b({type:Pbe,json:{default:"normal",write:!0}})],Wh.prototype,"weight",void 0),Wh=m6=m([G("esri.symbols.Font")],Wh);const tM=Wh;var g6;const Nbe=dt()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Q0=g6=class extends ye{constructor(t){super(t)}readHref(t,e,i){return t?t0(t,i):e.dataURI}writeHref(t,e,i,r){t&&(l0(t)?e.dataURI=t:(e.href=Q3(t,r),ja(e.href)&&(e.href=ws(e.href))))}clone(){return new g6({href:this.href,primitive:this.primitive})}};m([b({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Q0.prototype,"href",void 0),m([Me("href")],Q0.prototype,"readHref",null),m([Le("href",{href:{type:String},dataURI:{type:String}})],Q0.prototype,"writeHref",null),m([ze(Nbe)],Q0.prototype,"primitive",void 0),Q0=g6=m([G("esri.symbols.support.IconSymbol3DLayerResource")],Q0);const Dbe="circle";var v6;let lv=v6=class extends Te{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new v6({x:this.x,y:this.y})}};m([b({type:Number})],lv.prototype,"x",void 0),m([b({type:Number})],lv.prototype,"y",void 0),lv=v6=m([G("esri.symbols.support.Symbol3DAnchorPosition2D")],lv);var b6;let v_=b6=class extends ye{constructor(t){super(t),this.color=new Ce([0,0,0,1]),this.size=Jn(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new b6(t)}};m([b(d0)],v_.prototype,"color",void 0),m([b(yh)],v_.prototype,"size",void 0),v_=b6=m([G("esri.symbols.support.Symbol3DIconOutline")],v_);var e1;const WX="esri.symbols.IconSymbol3DLayer";let _c=e1=class extends xh{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new e1({anchor:this.anchor,anchorPosition:ae(this.anchorPosition),enabled:this.enabled,material:ae(this.material),outline:ae(this.outline),resource:ae(this.resource),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||I2,i=Aj(t),r=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||I2).clone()}:null;return new e1({size:t.size,resource:{primitive:Vbe(t.style)},material:{color:e},outline:r,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||$be(t.color)?I2:t.color,i=Aj(t);return new e1({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new e1({resource:{href:LJ({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};m([b({type:za,json:{write:!0}})],_c.prototype,"material",void 0),m([b({type:Q0,json:{write:!0}})],_c.prototype,"resource",void 0),m([ze({Icon:"icon"},{readOnly:!0})],_c.prototype,"type",void 0),m([b(yh)],_c.prototype,"size",void 0),m([ze({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),b({json:{default:"center"}})],_c.prototype,"anchor",void 0),m([b({type:lv,json:{type:[Number],read:{reader:t=>new lv({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],_c.prototype,"anchorPosition",void 0),m([b({type:v_,json:{write:!0}})],_c.prototype,"outline",void 0),_c=e1=m([G(WX)],_c);const im=_c;function Aj(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,r=Lj(t.xoffset),n=Lj(t.yoffset);return(r||n)&&e&&i?{x:-r/e,y:n/i}:null}function Lj(t){return isFinite(t)?t:0}const jbe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Vbe(t){return jbe[t]||(fe.getLogger(WX).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}let ey=class extends Gt(ye){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};m([b({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],ey.prototype,"type",void 0),m([b({type:mbe,json:{default:"begin-end",write:!0}})],ey.prototype,"placement",void 0),m([b({type:NX,json:{default:"arrow",write:!0}})],ey.prototype,"style",void 0),m([b({type:Ce,json:{type:[zt],default:null,write:!0}})],ey.prototype,"color",void 0),ey=m([G("esri.symbols.LineStyleMarker3D")],ey);const w6=ey;var vT;let Sc=vT=class extends xh{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Jn(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new vT(t)}static fromSimpleLineSymbol(t){var i;const e={enabled:!0,size:t.width??Jn(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new l8({style:t.style}):null,material:new za({color:(t.color||I2).clone()}),marker:t.marker?new w6({placement:t.marker.placement,style:t.marker.style,color:((i=t.marker.color)==null?void 0:i.clone())??null}):null};return new vT(e)}};m([b({type:za,json:{write:!0}})],Sc.prototype,"material",void 0),m([ze({Line:"line"},{readOnly:!0})],Sc.prototype,"type",void 0),m([b({type:GX,json:{write:!0,default:"miter"}})],Sc.prototype,"join",void 0),m([b({type:h8,json:{write:!0,default:"butt"}})],Sc.prototype,"cap",void 0),m([b(yh)],Sc.prototype,"size",void 0),m([b(UX)],Sc.prototype,"pattern",void 0),m([b({types:{key:"type",base:w6,typeMap:{style:w6}},json:{write:!0}})],Sc.prototype,"marker",void 0),Sc=vT=m([G("esri.symbols.LineSymbol3DLayer")],Sc);const Zb=Sc;var _6;const zbe=dt()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let b_=_6=class extends ye{clone(){return new _6({href:this.href,primitive:this.primitive})}};m([b({type:String,json:{read:_P,write:km}})],b_.prototype,"href",void 0),m([ze(zbe)],b_.prototype,"primitive",void 0),b_=_6=m([G("esri.symbols.support.ObjectSymbol3DLayerResource")],b_);const Ube="sphere";var S6;let Gy=S6=class extends Te{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new S6({x:this.x,y:this.y,z:this.z})}};m([b({type:Number})],Gy.prototype,"x",void 0),m([b({type:Number})],Gy.prototype,"y",void 0),m([b({type:Number})],Gy.prototype,"z",void 0),Gy=S6=m([G("esri.symbols.support.Symbol3DAnchorPosition3D")],Gy);var x6;let Rs=x6=class extends xh{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var t,e,i;return new x6({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(t=this.anchorPosition)==null?void 0:t.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((e=this.material)==null?void 0:e.clone())??null,castShadows:this.castShadows,resource:(i=this.resource)==null?void 0:i.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};m([b({type:za,json:{write:!0}})],Rs.prototype,"material",void 0),m([b({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Rs.prototype,"castShadows",void 0),m([b({type:b_,json:{write:!0}})],Rs.prototype,"resource",void 0),m([ze({Object:"object"},{readOnly:!0})],Rs.prototype,"type",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"width",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"height",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"depth",void 0),m([ze({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),b({json:{default:"origin"}})],Rs.prototype,"anchor",void 0),m([b({type:Gy,json:{type:[Number],read:{reader:t=>new Gy({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Rs.prototype,"anchorPosition",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"heading",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"tilt",void 0),m([b({type:Number,json:{write:!0}})],Rs.prototype,"roll",void 0),m([b({readOnly:!0})],Rs.prototype,"isPrimitive",null),Rs=x6=m([G("esri.symbols.ObjectSymbol3DLayer")],Rs);const p8=Rs;var $6;let oo=$6=class extends xh{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new $6({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};m([b({type:za,json:{write:!0}})],oo.prototype,"material",void 0),m([b({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],oo.prototype,"castShadows",void 0),m([ze({Path:"path"},{readOnly:!0})],oo.prototype,"type",void 0),m([b({type:["circle","quad"],json:{write:!0,default:"circle"}})],oo.prototype,"profile",void 0),m([b({type:GX,json:{write:!0,default:"miter"}})],oo.prototype,"join",void 0),m([b({type:Abe,json:{write:!0,default:"butt"}})],oo.prototype,"cap",void 0),m([b({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],oo.prototype,"width",void 0),m([Me("width",["width","size","height"])],oo.prototype,"readWidth",null),m([b({type:Number,json:{write:!0}})],oo.prototype,"height",void 0),m([Me("height",["height","size","width"])],oo.prototype,"readHeight",null),m([b({type:["center","bottom","top"],json:{write:!0,default:"center"}})],oo.prototype,"anchor",void 0),m([b({type:["heading","all"],json:{write:!0,default:"all"}})],oo.prototype,"profileRotation",void 0),oo=$6=m([G("esri.symbols.PathSymbol3DLayer")],oo);const d8=oo;var T6;let uv=T6=class extends ye{constructor(){super(...arguments),this.color=new Ce([0,0,0,1]),this.size=0}clone(){const t={color:ae(this.color),size:this.size};return new T6(t)}};m([b(d0)],uv.prototype,"color",void 0),m([b(yh)],uv.prototype,"size",void 0),uv=T6=m([G("esri.symbols.support.Symbol3DHalo")],uv);let k2=class extends Gt(ye){constructor(e){super(e),this.color=null}};m([b(d0)],k2.prototype,"color",void 0),k2=m([G("esri.symbols.support.Symbol3DTextBackground")],k2);var bT;let Co=bT=class extends xh{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,r){const n={...r,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){var t;return this._userSize!=null?this._userSize:((t=this.font)==null?void 0:t.size)!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new bT({enabled:this.enabled,font:this.font&&ae(this.font),halo:this.halo&&ae(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:ae(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new bT({font:t.font!=null?t.font.clone():new tM,halo:Gbe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new za({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new k2({color:t.backgroundColor.clone()}):null})}};function Gbe(t,e){return t&&e!=null&&e>0?new uv({color:ae(t),size:e}):null}m([b({type:tM,json:{write:!0}})],Co.prototype,"font",null),m([Le("font")],Co.prototype,"writeFont",null),m([b({type:uv,json:{write:!0}})],Co.prototype,"halo",void 0),m([b({...qX,json:{default:"center",write:!0}})],Co.prototype,"horizontalAlignment",void 0),m([b({...BX,json:{default:1,write:!0}})],Co.prototype,"lineHeight",void 0),m([b({type:za,json:{write:!0}})],Co.prototype,"material",void 0),m([b({type:k2,json:{write:!0}})],Co.prototype,"background",void 0),m([b(yh)],Co.prototype,"size",null),m([b({type:String,json:{write:!0}})],Co.prototype,"text",void 0),m([ze({Text:"text"},{readOnly:!0})],Co.prototype,"type",void 0),m([b({...HX,json:{default:"baseline",write:!0}})],Co.prototype,"verticalAlignment",void 0),Co=bT=m([G("esri.symbols.TextSymbol3DLayer")],Co);const Kb=Co;var E6;let Nd=E6=class extends xh{constructor(t){super(t),this.color=I6.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new E6({color:ae(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};m([b({type:Ce,nonNullable:!0,json:{type:[zt],write:(t,e,i)=>e[i]=t.toArray(Ce.AlphaMode.UNLESS_OPAQUE),default:()=>I6.clone(),defaultEquals:t=>t.toCss(!0)===I6.toCss(!0)}})],Nd.prototype,"color",void 0),m([ze({Water:"water"},{readOnly:!0})],Nd.prototype,"type",void 0),m([b({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Nd.prototype,"waterbodySize",void 0),m([b({type:Number,json:{write:!0,default:null}})],Nd.prototype,"waveDirection",void 0),m([b({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Nd.prototype,"waveStrength",void 0),Nd=E6=m([G("esri.symbols.WaterSymbol3DLayer")],Nd);const JX=Nd,I6=new Ce([0,119,190]);var M6;let ty=M6=class extends Te{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new M6({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};m([b({type:String})],ty.prototype,"name",void 0),m([b({type:String})],ty.prototype,"styleUrl",void 0),m([b({type:String})],ty.prototype,"styleName",void 0),m([b({type:wr})],ty.prototype,"portal",void 0),ty=M6=m([G("esri.symbols.support.StyleOrigin")],ty);const m3=ty;var k6;let hm=k6=class extends Te{constructor(){super(...arguments),this.url=""}clone(){return new k6({url:this.url})}};m([b({type:String})],hm.prototype,"url",void 0),hm=k6=m([G("esri.symbols.support.Thumbnail")],hm);const ZX={icon:im,object:p8,line:Zb,path:d8,fill:f0,extrude:FX,text:Kb,water:JX},Bbe=Ie.ofType({base:xh,key:"type",typeMap:ZX,errorContext:"symbol-layer"});let xc=class extends Es{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i==null?void 0:i.type,n=r||Ie;this._set("symbolLayers",new n)}get color(){return null}set color(e){this.constructed&&fe.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Jp(e,this._get("symbolLayers"))}readStyleOrigin(e,i,r){if(e.styleUrl&&e.name){const n=t0(e.styleUrl,r);return new m3({styleUrl:n,name:e.name})}if(e.styleName&&e.name)return new m3({portal:(r==null?void 0:r.portal)||wr.getDefault(),styleName:e.styleName,name:e.name});r!=null&&r.messages&&r.messages.push(new Ul("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,i,r,n){if(e.styleUrl&&e.name){let o=Q3(e.styleUrl,n);ja(o)&&(o=ws(o)),i.styleOrigin={styleUrl:o,name:e.name}}else e.styleName&&e.name&&(e.portal&&(n!=null&&n.portal)&&!AJ(e.portal.restUrl,n.portal.restUrl)?n!=null&&n.messages&&n.messages.push(new Ul("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof xh||e&&ZX[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};m([b({json:{read:!1,write:!1}})],xc.prototype,"color",null),m([b({type:Bbe,nonNullable:!0,json:{write:!0}}),Dt(BJ)],xc.prototype,"symbolLayers",null),m([b({type:m3})],xc.prototype,"styleOrigin",void 0),m([Me("styleOrigin")],xc.prototype,"readStyleOrigin",null),m([Le("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],xc.prototype,"writeStyleOrigin",null),m([b({type:hm,json:{read:!1}})],xc.prototype,"thumbnail",void 0),m([b({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],xc.prototype,"type",void 0),xc=m([G("esri.symbols.Symbol3D")],xc);const Yb=xc;let w_=class extends ye{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};m([b({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],w_.prototype,"type",void 0),m([b({readOnly:!0})],w_.prototype,"visible",void 0),w_=m([G("esri.symbols.callouts.Callout3D")],w_);const KX=w_;var C6;let wT=C6=class extends ye{constructor(t){super(t),this.color=new Ce("white")}clone(){return new C6({color:ae(this.color)})}};m([b(d0)],wT.prototype,"color",void 0),wT=C6=m([G("esri.symbols.callouts.LineCallout3DBorder")],wT);const qbe=wT;var A6;let Dd=A6=class extends KX{constructor(t){super(t),this.type="line",this.color=new Ce([0,0,0,1]),this.size=Jn(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new A6({color:ae(this.color),size:this.size,border:ae(this.border)})}};m([ze({line:"line"})],Dd.prototype,"type",void 0),m([b(d0)],Dd.prototype,"color",void 0),m([b(yh)],Dd.prototype,"size",void 0),m([b({type:qbe,json:{write:!0}})],Dd.prototype,"border",void 0),m([b({readOnly:!0})],Dd.prototype,"visible",null),Dd=A6=m([G("esri.symbols.callouts.LineCallout3D")],Dd);const YX=Dd;function f8(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function XX(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!f8(t)}function CZe(t){return t.type==="point-3d"||t.type==="label-3d"}function AZe(t){return t.horizontalAlignment==="center"}const QX={types:{key:"type",base:KX,typeMap:{line:YX}},json:{write:!0}};var L6;let t1=L6=class extends ye{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new L6({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};m([b(yh)],t1.prototype,"screenLength",void 0),m([b({type:Number,nonNullable:!0,json:{write:!0,default:0}})],t1.prototype,"minWorldLength",void 0),m([b({type:Number,json:{write:!0}})],t1.prototype,"maxWorldLength",void 0),t1=L6=m([G("esri.symbols.support.Symbol3DVerticalOffset")],t1);const y8=t1;var _T;const eQ=Ie.ofType({base:null,key:"type",typeMap:{text:Kb}});let jd=_T=class extends Yb{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new eQ,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return XX(this)}hasVisibleVerticalOffset(){return f8(this)}clone(){return new _T({styleOrigin:ae(this.styleOrigin),symbolLayers:ae(this.symbolLayers),thumbnail:ae(this.thumbnail),callout:ae(this.callout),verticalOffset:ae(this.verticalOffset)})}static fromTextSymbol(t){return new _T({symbolLayers:new Ie([Kb.fromTextSymbol(t)])})}};m([b({type:y8,json:{write:!0}})],jd.prototype,"verticalOffset",void 0),m([b(QX)],jd.prototype,"callout",void 0),m([b({json:{read:!1,write:!1}})],jd.prototype,"styleOrigin",void 0),m([b({type:eQ})],jd.prototype,"symbolLayers",void 0),m([ze({LabelSymbol3D:"label-3d"},{readOnly:!0})],jd.prototype,"type",void 0),jd=_T=m([G("esri.symbols.LabelSymbol3D")],jd);const iM=jd;var ST;const tQ=Ie.ofType({base:null,key:"type",typeMap:{line:Zb,path:d8}}),Hbe=Ie.ofType({base:null,key:"type",typeMap:{line:Zb,path:d8}});let __=ST=class extends Yb{constructor(t){super(t),this.symbolLayers=new tQ,this.type="line-3d"}clone(){return new ST({styleOrigin:ae(this.styleOrigin),symbolLayers:ae(this.symbolLayers),thumbnail:ae(this.thumbnail)})}static fromSimpleLineSymbol(t){return new ST({symbolLayers:new Ie([Zb.fromSimpleLineSymbol(t)])})}};m([b({type:tQ,json:{type:Hbe}})],__.prototype,"symbolLayers",void 0),m([ze({LineSymbol3D:"line-3d"},{readOnly:!0})],__.prototype,"type",void 0),__=ST=m([G("esri.symbols.LineSymbol3D")],__);const Jm=__;let Vd=class extends Es{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};m([b({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Vd.prototype,"angle",void 0),m([b({type:["simple-marker","picture-marker"],readOnly:!0})],Vd.prototype,"type",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],Vd.prototype,"xoffset",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],Vd.prototype,"yoffset",void 0),m([b({type:Number,cast:t=>t==="auto"?t:Wt(t),json:{write:!0}})],Vd.prototype,"size",void 0),Vd=m([G("esri.symbols.MarkerSymbol")],Vd);const iQ=Vd;var xT;const rQ=Ie.ofType({base:null,key:"type",typeMap:{fill:f0}});let S_=xT=class extends Yb{constructor(t){super(t),this.symbolLayers=new rQ,this.type="mesh-3d"}clone(){return new xT({styleOrigin:ae(this.styleOrigin),symbolLayers:ae(this.symbolLayers),thumbnail:ae(this.thumbnail)})}static fromSimpleFillSymbol(t){return new xT({symbolLayers:new Ie([f0.fromSimpleFillSymbol(t)])})}};m([b({type:rQ})],S_.prototype,"symbolLayers",void 0),m([ze({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],S_.prototype,"type",void 0),S_=xT=m([G("esri.symbols.MeshSymbol3D")],S_);const Xb=S_;function Wbe(t,e,i){return e.imageData?LJ({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):nQ(e.url,i)}function nQ(t,e){if(!ja(t)){const i=Zbe(e);if(i)return ib(i,"images",t)}return t0(t,e)}function Jbe(t,e,i,r){if(l0(t)){const n=xm(t);if(!n)return;e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&km(i.url,e,"url",r)}else km(t,e,"url",r)}const sQ={json:{read:{source:["imageData","url"],reader:Wbe},write:{writer(t,e,i,r){Jbe(t,e,this.source,r)}}}},oQ={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=nQ(e.url,i)),r}}}};function Zbe(t){var n,o;if(!t)return null;const{origin:e,layer:i}=t;if(e!=="service"&&e!=="portal-item")return null;const r=i==null?void 0:i.type;return r==="feature"||r==="stream"?(n=i.parsedUrl)==null?void 0:n.path:r==="map-image"||r==="tile"?(o=t.url)==null?void 0:o.path:null}var O6;let ol=O6=class extends DX{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),i!=null&&(n.width=Wt(i)),r!=null&&(n.height=Wt(r)),n}clone(){const t=new O6({color:ae(this.color),height:this.height,outline:ae(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",ae(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};m([ze({esriPFS:"picture-fill"},{readOnly:!0})],ol.prototype,"type",void 0),m([b(sQ)],ol.prototype,"url",void 0),m([b({type:Number,json:{write:!0}})],ol.prototype,"xscale",void 0),m([b({type:Number,json:{write:!0}})],ol.prototype,"yscale",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],ol.prototype,"width",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],ol.prototype,"height",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],ol.prototype,"xoffset",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],ol.prototype,"yoffset",void 0),m([b(oQ)],ol.prototype,"source",void 0),ol=O6=m([G("esri.symbols.PictureFillSymbol")],ol);const m8=ol;var P6;let hu=P6=class extends iQ{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=Wt(e)),i!=null&&(r.height=Wt(i)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new P6({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",ae(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};m([b({json:{write:!1}})],hu.prototype,"color",void 0),m([ze({esriPMS:"picture-marker"},{readOnly:!0})],hu.prototype,"type",void 0),m([b(sQ)],hu.prototype,"url",void 0),m([b(oQ)],hu.prototype,"source",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],hu.prototype,"height",void 0),m([Me("height",["height","size"])],hu.prototype,"readHeight",null),m([b({type:Number,cast:Wt,json:{write:!0}})],hu.prototype,"width",void 0),m([b({json:{write:!1}})],hu.prototype,"size",void 0),hu=P6=m([G("esri.symbols.PictureMarkerSymbol")],hu);const Qb=hu;var iy;const aQ=Ie.ofType({base:null,key:"type",typeMap:{icon:im,object:p8,text:Kb}});let ry=iy=class extends Yb{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new aQ,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return XX(this)}hasVisibleVerticalOffset(){return f8(this)}clone(){return new iy({verticalOffset:ae(this.verticalOffset),callout:ae(this.callout),styleOrigin:ae(this.styleOrigin),symbolLayers:ae(this.symbolLayers),thumbnail:ae(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new iy({symbolLayers:new Ie([im.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new iy({symbolLayers:new Ie([im.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){var r,n;if(((n=(r=t.data)==null?void 0:r.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const i=t.data.symbol;return new iy(i!=null&&i.callout?{symbolLayers:new Ie([im.fromCIMSymbol(t)]),callout:new YX({size:.5,color:new Ce([0,0,0])}),verticalOffset:new y8({screenLength:40})}:{symbolLayers:new Ie([im.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new iy({symbolLayers:new Ie([Kb.fromTextSymbol(t)])})}};m([b({type:y8,json:{write:!0}})],ry.prototype,"verticalOffset",void 0),m([b(QX)],ry.prototype,"callout",void 0),m([b({type:aQ,json:{origins:{"web-scene":{write:!0}}}})],ry.prototype,"symbolLayers",void 0),m([ze({PointSymbol3D:"point-3d"},{readOnly:!0})],ry.prototype,"type",void 0),ry=iy=m([G("esri.symbols.PointSymbol3D")],ry);const Pp=ry;var x_;const lQ=Ie.ofType({base:null,key:"type",typeMap:{extrude:FX,fill:f0,icon:im,line:Zb,object:p8,text:Kb,water:JX}});let $_=x_=class extends Yb{constructor(t){super(t),this.symbolLayers=new lQ,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&wm(fe.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&wm(fe.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(gi(()=>this.symbolLayers,"after-add",({item:e})=>t(e),$s))}clone(){return new x_({styleOrigin:ae(this.styleOrigin),symbolLayers:ae(this.symbolLayers),thumbnail:ae(this.thumbnail)})}static fromJSON(t){var i;const e=new x_;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||(i=t.symbolLayers)!=null&&i[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:n.size,color:n.material!=null?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new x_({symbolLayers:new Ie([f0.fromSimpleFillSymbol(t)])})}};m([b({type:lQ,json:{write:!0}})],$_.prototype,"symbolLayers",void 0),m([ze({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],$_.prototype,"type",void 0),$_=x_=m([G("esri.symbols.PolygonSymbol3D")],$_);const y0=$_;var R6;const N9=new et({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let ny=R6=class extends DX{constructor(...t){super(...t),this.color=new Ce([0,0,0,.25]),this.outline=new cn,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),i&&(r.color=i),r}clone(){return new R6({color:ae(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};m([b()],ny.prototype,"color",void 0),m([b()],ny.prototype,"outline",void 0),m([ze({esriSFS:"simple-fill"},{readOnly:!0})],ny.prototype,"type",void 0),m([b({type:N9.apiValues,json:{read:N9.read,write:N9.write}})],ny.prototype,"style",void 0),ny=R6=m([G("esri.symbols.SimpleFillSymbol")],ny);const na=ny,Kbe=Object.freeze(Object.defineProperty({__proto__:null,default:na},Symbol.toStringTag,{value:"Module"}));var F6;const D9=new et({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let $c=F6=class extends iQ{constructor(...t){super(...t),this.color=new Ce([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new cn}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string")return t;const n={};return t&&(n.style=t),e!=null&&(n.size=Wt(e)),i&&(n.outline=i),r&&(n.color=r),n}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new F6({angle:this.angle,color:ae(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};m([b()],$c.prototype,"color",void 0),m([Le("color")],$c.prototype,"writeColor",null),m([ze({esriSMS:"simple-marker"},{readOnly:!0})],$c.prototype,"type",void 0),m([b()],$c.prototype,"size",void 0),m([b({type:D9.apiValues,json:{read:D9.read,write:D9.write}})],$c.prototype,"style",void 0),m([b({type:String,json:{write:!0}})],$c.prototype,"path",null),m([b({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":cn}},json:{default:null,write:!0}})],$c.prototype,"outline",void 0),$c=F6=m([G("esri.symbols.SimpleMarkerSymbol")],$c);const kn=$c,Ybe=Object.freeze(Object.defineProperty({__proto__:null,default:kn},Symbol.toStringTag,{value:"Module"}));var N6;let dr=N6=class extends Es{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new tM,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),i&&(r.color=i),r}writeLineWidth(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}castLineWidth(t){return Wt(t)}writeLineHeight(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}clone(){return new N6({angle:this.angle,backgroundColor:ae(this.backgroundColor),borderLineColor:ae(this.borderLineColor),borderLineSize:this.borderLineSize,color:ae(this.color),font:this.font&&this.font.clone(),haloColor:ae(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t,e,i;return`${(t=this.backgroundColor)==null?void 0:t.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(e=this.color)==null?void 0:e.hash()}.${this.font&&this.font.hash()}.${(i=this.haloColor)==null?void 0:i.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};m([b({type:Ce,json:{write:!0}})],dr.prototype,"backgroundColor",void 0),m([b({type:Ce,json:{write:!0}})],dr.prototype,"borderLineColor",void 0),m([b({type:Number,json:{write:!0},cast:Wt})],dr.prototype,"borderLineSize",void 0),m([b({type:tM,json:{write:!0}})],dr.prototype,"font",void 0),m([b({...qX,json:{write:!0}})],dr.prototype,"horizontalAlignment",void 0),m([b({type:Boolean,json:{write:!0}})],dr.prototype,"kerning",void 0),m([b({type:Ce,json:{write:!0}})],dr.prototype,"haloColor",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],dr.prototype,"haloSize",void 0),m([b({type:Boolean,json:{write:!0}})],dr.prototype,"rightToLeft",void 0),m([b({type:Boolean,json:{write:!0}})],dr.prototype,"rotated",void 0),m([b({type:String,json:{write:!0}})],dr.prototype,"text",void 0),m([ze({esriTS:"text"},{readOnly:!0})],dr.prototype,"type",void 0),m([b({...HX,json:{write:!0}})],dr.prototype,"verticalAlignment",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],dr.prototype,"xoffset",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],dr.prototype,"yoffset",void 0),m([b({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],dr.prototype,"angle",void 0),m([b({type:Number,json:{write:!0}})],dr.prototype,"width",void 0),m([b({type:Number})],dr.prototype,"lineWidth",void 0),m([Le("lineWidth")],dr.prototype,"writeLineWidth",null),m([Dt("lineWidth")],dr.prototype,"castLineWidth",null),m([b(BX)],dr.prototype,"lineHeight",void 0),m([Le("lineHeight")],dr.prototype,"writeLineHeight",null),dr=N6=m([G("esri.symbols.TextSymbol")],dr);const Zm=dr;var D6;let pu=D6=class extends Es{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:wr.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new D6({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=e!=null?e.cache:null,r=i?this._fetchCacheKey:null;if(i!=null){const p=r&&i.get(r);if(p)return p.clone()}const{resolveWebStyleSymbol:n}=await ie(()=>Promise.resolve().then(()=>l7e),void 0);At(e);const o=n(this,{portal:this.portal},t,e);o.catch(p=>{fe.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",p)});const u=await o;return t==="webRef"&&u.type==="point-3d"||t==="cimRef"&&u.type==="cim"?(i!=null&&i.set(r,u.clone()),u):null}};m([b({json:{write:!1}})],pu.prototype,"color",void 0),m([b({type:String,json:{write:!0}})],pu.prototype,"styleName",void 0),m([b({type:wr,json:{write:!1}})],pu.prototype,"portal",void 0),m([b({type:String,json:{read:_P,write:km}})],pu.prototype,"styleUrl",void 0),m([b({type:hm,json:{read:!1}})],pu.prototype,"thumbnail",void 0),m([b({type:String,json:{write:!0}})],pu.prototype,"name",void 0),m([ze({styleSymbolReference:"web-style"},{readOnly:!0})],pu.prototype,"type",void 0),m([b()],pu.prototype,"_fetchCacheKey",null),pu=D6=m([G("esri.symbols.WebStyleSymbol")],pu);const Km=pu;function rM(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function mh(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const zu={base:Es,key:"type",typeMap:{"simple-fill":na,"picture-fill":m8,"picture-marker":Qb,"simple-line":cn,"simple-marker":kn,text:Zm,"label-3d":iM,"line-3d":Jm,"mesh-3d":Xb,"point-3d":Pp,"polygon-3d":y0,"web-style":Km,cim:id},errorContext:"symbol"},OZe={base:Es,key:"type",typeMap:{"picture-marker":Qb,"simple-marker":kn,"point-3d":Pp,cim:id},errorContext:"symbol"},PZe={base:Es,key:"type",typeMap:{"simple-line":cn,"line-3d":Jm,cim:id},errorContext:"symbol"},RZe={base:Es,key:"type",typeMap:{"simple-fill":na,"picture-fill":m8,"polygon-3d":y0,cim:id},errorContext:"symbol"},Xbe={base:Es,key:"type",typeMap:{"picture-marker":Qb,"simple-marker":kn,text:Zm,"web-style":Km,cim:id},errorContext:"symbol"},Qbe=zb({types:zu}),uQ={base:Es,key:"type",typeMap:{"simple-fill":na,"picture-fill":m8,"picture-marker":Qb,"simple-line":cn,"simple-marker":kn,text:Zm,"line-3d":Jm,"mesh-3d":Xb,"point-3d":Pp,"polygon-3d":y0,"web-style":Km,cim:id},errorContext:"symbol"},ewe={base:Es,key:"type",typeMap:{text:Zm,"label-3d":iM},errorContext:"symbol"},Oj={base:Es,key:"type",typeMap:{"line-3d":Jm,"mesh-3d":Xb,"point-3d":Pp,"polygon-3d":y0,"web-style":Km,cim:id},errorContext:"symbol"},twe={base:Es,key:"type",typeMap:{"label-3d":iM},errorContext:"symbol"},cQ=ch(zu);var j6;function iwe(t){if(!t)return null;const e={};for(const i in t){const r=dh(t[i]);r&&(e[i]=r)}return Object.keys(e).length!==0?e:null}function rwe(t){if(t==null)return null;const e={};for(const i in t){const r=t[i];r&&(e[i]=r.toJSON())}return Object.keys(e).length!==0?e:null}let ao=j6=class extends Gt(ye){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:Fp(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&mce(fe.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),(t==null?void 0:t.type)!=="mesh"&&this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new j6({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[e,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(t&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var t;return{aggregateGeometries:rwe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:J5(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((t=this.popupTemplate)==null?void 0:t.toJSON())??null}}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,r){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};t==="origin-transform"&&(n.action=r),t==="attributes"&&(n.attributeName=r),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([Fr(()=>{var t,e;return((t=this.geometry)==null?void 0:t.type)==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:(e=this.geometry.transform)==null?void 0:e.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0},({localMatrix:t,origin:e})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===e||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=e,this.notifyMeshTransformChanged())}),Fr(()=>{var t;return((t=this.geometry)==null?void 0:t.type)==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0},()=>{var e;const t=this.geometry;(t==null?void 0:t.type)==="mesh"&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=(e=t.transform)==null?void 0:e.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(t,e)=>t===e,sync:!0})])}};m([b({value:null,json:{read:iwe}})],ao.prototype,"aggregateGeometries",null),m([b({value:null})],ao.prototype,"attributes",null),m([b({value:null,types:h0,json:{read:dh}})],ao.prototype,"geometry",null),m([b({type:Boolean})],ao.prototype,"isAggregate",void 0),m([b({clonable:"reference"})],ao.prototype,"layer",void 0),m([b({clonable:"reference"})],ao.prototype,"origin",void 0),m([b({type:Wm})],ao.prototype,"popupTemplate",void 0),m([b({clonable:"reference"})],ao.prototype,"sourceLayer",void 0),m([b({value:null,types:zu})],ao.prototype,"symbol",null),m([b({type:Boolean,value:!0})],ao.prototype,"visible",null),ao=j6=m([G("esri.Graphic")],ao),function(t){t.generateUID=Fp}(ao||(ao={}));const Cr=ao;var V6;let T_=V6=class extends ye{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new V6({minValue:this.minValue,maxValue:this.maxValue})}};m([b({type:Number,json:{write:!0}})],T_.prototype,"minValue",void 0),m([b({type:Number,json:{write:!0}})],T_.prototype,"maxValue",void 0),T_=V6=m([G("esri.renderers.support.AuthoringInfoClassBreakInfo")],T_);var z6;let Tf=z6=class extends ye{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new z6({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:ae(this.classBreakInfos)})}};m([b({type:String,json:{write:!0}})],Tf.prototype,"field",void 0),m([b({type:String,json:{write:!0}})],Tf.prototype,"normalizationField",void 0),m([b({type:String,json:{write:!0}})],Tf.prototype,"label",void 0),m([b({type:[T_],json:{write:!0}})],Tf.prototype,"classBreakInfos",void 0),Tf=z6=m([G("esri.renderers.support.AuthoringInfoFieldInfo")],Tf);var U6;let i1=U6=class extends ye{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new U6({label:this.label,value:this.value,size:this.size})}};m([b({type:String,json:{write:!0}})],i1.prototype,"label",void 0),m([b({type:Number,json:{write:!0}})],i1.prototype,"size",void 0),m([b({type:Number,json:{write:!0}})],i1.prototype,"value",void 0),i1=U6=m([G("esri.renderers.support.AuthoringInfoSizeStop")],i1);const nwe=i1;var G6;const vx=new et({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),bx=new et({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),Pj={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},Rj=["high-to-low","above-and-below","centered-on","extremes"],Fj=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size"])],Nj=["seconds","minutes","hours","days","months","years"],swe=["circle","diamond","hexagon-flat","hexagon-pointy","square"];let Yn=G6=class extends ye{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new G6({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:ae(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};m([b({types:Pj,json:{write:!0}})],Yn.prototype,"endTime",void 0),m([Dt("endTime")],Yn.prototype,"castEndTime",null),m([b({type:String,json:{write:!0}})],Yn.prototype,"field",void 0),m([b({type:Number,json:{write:!0}})],Yn.prototype,"maxSliderValue",void 0),m([b({type:Number,json:{write:!0}})],Yn.prototype,"minSliderValue",void 0),m([b({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],Yn.prototype,"normalizationField",null),m([b({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Yn.prototype,"referenceSizeScale",null),m([b({type:swe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Yn.prototype,"referenceSizeSymbolStyle",null),m([b({types:Pj,json:{write:!0}})],Yn.prototype,"startTime",void 0),m([Dt("startTime")],Yn.prototype,"castStartTime",null),m([b({type:[nwe],json:{origins:{"web-scene":{write:!1}},write:!0}})],Yn.prototype,"sizeStops",null),m([b({type:vx.apiValues,value:null,json:{type:vx.jsonValues,read:vx.read,write:vx.write}})],Yn.prototype,"style",null),m([b({type:Fj,value:null,json:{type:Fj,origins:{"web-scene":{type:Rj,write:{writer:(t,e)=>{Rj.includes(t)&&(e.theme=t)}}}},write:!0}})],Yn.prototype,"theme",null),m([b({type:bx.apiValues,json:{type:bx.jsonValues,read:bx.read,write:bx.write}})],Yn.prototype,"type",void 0),m([b({type:Nj,json:{type:Nj,write:!0}})],Yn.prototype,"units",void 0),Yn=G6=m([G("esri.renderers.support.AuthoringInfoVisualVariable")],Yn);const owe=Yn;let $T=class extends ye{constructor(e){super(e),this.type=null}};m([b({readOnly:!0,json:{read:!1,write:!0}})],$T.prototype,"type",void 0),$T=m([G("esri.rest.support.ColorRamp")],$T);const g8=$T;var B6;let sy=B6=class extends g8{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new B6({fromColor:ae(this.fromColor),toColor:ae(this.toColor),algorithm:this.algorithm})}};m([ze({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],sy.prototype,"algorithm",void 0),m([b({type:Ce,json:{type:[zt],write:!0}})],sy.prototype,"fromColor",void 0),m([b({type:Ce,json:{type:[zt],write:!0}})],sy.prototype,"toColor",void 0),m([b({type:["algorithmic"]})],sy.prototype,"type",void 0),sy=B6=m([G("esri.rest.support.AlgorithmicColorRamp")],sy);const v8=sy;var q6;let E_=q6=class extends g8{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new q6({colorRamps:ae(this.colorRamps)})}};m([b({type:[v8],json:{write:!0}})],E_.prototype,"colorRamps",void 0),m([b({type:["multipart"]})],E_.prototype,"type",void 0),E_=q6=m([G("esri.rest.support.MultipartColorRamp")],E_);const hQ=E_,awe={key:"type",base:g8,typeMap:{algorithmic:v8,multipart:hQ}};function lwe(t){return t!=null&&t.type?t.type==="algorithmic"?v8.fromJSON(t):t.type==="multipart"?hQ.fromJSON(t):null:null}var H6;const $0=new et({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),wx=new et({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),Dj=new et({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),jj=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],uwe=["high-to-low","above-and-below","above","below"],cwe=["flow-line","wave-front"],hwe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Pr=H6=class extends ye{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?lwe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){var t;return new H6({classificationMethod:this.classificationMethod,colorRamp:ae(this.colorRamp),fadeRatio:ae(this.fadeRatio),fields:(t=this.fields)==null?void 0:t.slice(0),field1:ae(this.field1),field2:ae(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(e=>e.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};m([b({type:$0.apiValues,value:null,json:{type:$0.jsonValues,read:$0.read,write:$0.write,origins:{"web-document":{default:"manual",type:$0.jsonValues,read:$0.read,write:$0.write}}}})],Pr.prototype,"classificationMethod",null),m([b({types:awe,json:{write:!0}})],Pr.prototype,"colorRamp",void 0),m([Me("colorRamp")],Pr.prototype,"readColorRamp",null),m([b({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pr.prototype,"fadeRatio",void 0),m([b({type:[String],value:null,json:{write:!0}})],Pr.prototype,"fields",null),m([b({type:Tf,value:null,json:{write:!0}})],Pr.prototype,"field1",null),m([b({type:Tf,value:null,json:{write:!0}})],Pr.prototype,"field2",null),m([b({type:cwe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Pr.prototype,"flowTheme",null),m([b({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Pr.prototype,"focus",null),m([b({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Pr.prototype,"isAutoGenerated",void 0),m([b({type:Number,value:null,json:{type:zt,write:!0}})],Pr.prototype,"numClasses",null),m([b({type:jj,json:{type:jj,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Pr.prototype,"lengthUnit",void 0),m([b({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pr.prototype,"maxSliderValue",void 0),m([b({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pr.prototype,"minSliderValue",void 0),m([b({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pr.prototype,"statistics",null),m([b({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Pr.prototype,"standardDeviationInterval",null),m([b({type:wx.apiValues,value:null,json:{type:wx.jsonValues,read:wx.read,write:wx.write,origins:{"web-scene":{type:Dj.jsonValues,write:{writer:Dj.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],Pr.prototype,"type",null),m([b({type:[owe],json:{write:!0}})],Pr.prototype,"visualVariables",void 0),m([b({type:hwe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Pr.prototype,"univariateSymbolStyle",null),m([b({type:uwe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Pr.prototype,"univariateTheme",null),Pr=H6=m([G("esri.renderers.support.AuthoringInfo")],Pr);const b8=Pr,j9=new et({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let I_=class extends ye{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,e),Array.from(i).sort()}getSymbol(e,i){}async getSymbolAsync(e,i){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};m([b({type:b8,json:{write:!0}})],I_.prototype,"authoringInfo",void 0),m([b({type:j9.apiValues,readOnly:!0,json:{type:j9.jsonValues,read:!1,write:{writer:j9.write,ignoreOrigin:!0}}})],I_.prototype,"type",void 0),I_=m([G("esri.renderers.Renderer")],I_);const rd=I_;function pwe(t){var e,i;return((i=(e=t.match(dwe))==null?void 0:e[1])==null?void 0:i.replace(/\\'/g,"'"))??null}const dwe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var W6;let kv=W6=class extends ye{constructor(){super(...arguments),this.title=null}clone(){return new W6({title:this.title})}};m([b({type:String,json:{write:!0}})],kv.prototype,"title",void 0),kv=W6=m([G("esri.renderers.support.LegendOptions")],kv);var J6;let TT=J6=class extends kv{constructor(){super(...arguments),this.showLegend=null}clone(){return new J6({title:this.title,showLegend:this.showLegend})}};m([b({type:Boolean,json:{write:!0}})],TT.prototype,"showLegend",void 0),TT=J6=m([G("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],TT);const pQ=TT,V9=new et({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let du=class extends ye{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(fe.getLogger(this).error(".field: field must be a string value"),null):W3(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};m([b()],du.prototype,"index",void 0),m([b({type:V9.apiValues,readOnly:!0,json:{read:V9.read,write:V9.write}})],du.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],du.prototype,"field",void 0),m([Dt("field")],du.prototype,"castField",null),m([b({type:String,json:{write:!0}})],du.prototype,"valueExpression",void 0),m([b({type:String,json:{write:!0}})],du.prototype,"valueExpressionTitle",void 0),m([b({readOnly:!0})],du.prototype,"arcadeRequired",null),m([b({type:pQ,json:{write:!0}})],du.prototype,"legendOptions",void 0),du=m([G("esri.renderers.visualVariables.VisualVariable")],du);const dS=du;var Z6;let oy=Z6=class extends ye{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new Z6({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};m([b({type:Ce,json:{type:[zt],write:!0}})],oy.prototype,"color",void 0),m([b({type:String,json:{write:!0}})],oy.prototype,"label",void 0),m([b({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],oy.prototype,"value",void 0),m([Le("value")],oy.prototype,"writeValue",null),oy=Z6=m([G("esri.renderers.visualVariables.support.ColorStop")],oy);const fwe=oy;var K6;let ay=K6=class extends dS{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new K6({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};m([b({readOnly:!0})],ay.prototype,"cache",null),m([b({type:["color"],json:{type:["colorInfo"]}})],ay.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],ay.prototype,"normalizationField",void 0),m([b({type:[fwe],json:{write:!0}})],ay.prototype,"stops",null),ay=K6=m([G("esri.renderers.visualVariables.ColorVariable")],ay);const dQ=ay;var Y6;let zd=Y6=class extends ye{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return l3(e.transparency)}writeOpacity(t,e,i){e[i]=zI(t)}clone(){return new Y6({label:this.label,opacity:this.opacity,value:this.value})}};m([b({type:String,json:{write:!0}})],zd.prototype,"label",void 0),m([b({type:Number,json:{type:zt,write:{target:"transparency"}}})],zd.prototype,"opacity",void 0),m([Me("opacity",["transparency"])],zd.prototype,"readOpacity",null),m([Le("opacity")],zd.prototype,"writeOpacity",null),m([b({type:Number,json:{write:!0}})],zd.prototype,"value",void 0),zd=Y6=m([G("esri.renderers.visualVariables.support.OpacityStop")],zd);const ywe=zd;var X6;let ly=X6=class extends dS{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new X6({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};m([b({readOnly:!0})],ly.prototype,"cache",null),m([b({type:["opacity"],json:{type:["transparencyInfo"]}})],ly.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],ly.prototype,"normalizationField",void 0),m([b({type:[ywe],json:{write:!0}})],ly.prototype,"stops",null),ly=X6=m([G("esri.renderers.visualVariables.OpacityVariable")],ly);const fQ=ly;var Q6;let Jh=Q6=class extends dS{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,r){if(r!=null&&r.messages){const n=`visualVariables[${this.index}]`;r.messages.push(new re("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpressionTitle",context:r}))}}clone(){var t;return new Q6({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}};m([b({readOnly:!0})],Jh.prototype,"cache",null),m([b({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Jh.prototype,"axis",void 0),m([b({type:["rotation"],json:{type:["rotationInfo"]}})],Jh.prototype,"type",void 0),m([b({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Jh.prototype,"rotationType",void 0),m([b({type:String,json:{write:!0}})],Jh.prototype,"valueExpressionTitle",void 0),m([Le("web-scene","valueExpressionTitle")],Jh.prototype,"writeValueExpressionTitleWebScene",null),Jh=Q6=m([G("esri.renderers.visualVariables.RotationVariable")],Jh);const yQ=Jh;function mwe(t){return Wt(t)}var eA;let Ud=eA=class extends ye{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new eA({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};m([b({type:String,json:{write:!0}})],Ud.prototype,"label",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],Ud.prototype,"size",void 0),m([b({type:Number,json:{write:!0}})],Ud.prototype,"value",void 0),m([b({type:Boolean,json:{write:!1}})],Ud.prototype,"useMinValue",void 0),m([b({type:Boolean,json:{write:!1}})],Ud.prototype,"useMaxValue",void 0),Ud=eA=m([G("esri.renderers.visualVariables.support.SizeStop")],Ud);const ET=Ud;var tA;let IT=tA=class extends pQ{constructor(){super(...arguments),this.customValues=null}clone(){var t;return new tA({title:this.title,showLegend:this.showLegend,customValues:(t=this.customValues)==null?void 0:t.slice(0)})}};m([b({type:[Number],json:{write:!0}})],IT.prototype,"customValues",void 0),IT=tA=m([G("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],IT);const mQ=IT;var jp,xn;function cv(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function g3(t){return t!=null&&!isNaN(t)&&isFinite(t)}function gQ(t){return t.valueExpression?jp.Expression:t.field&&typeof t.field=="string"?jp.Field:jp.Unknown}function vQ(t,e){const i=e||gQ(t),r=t.valueUnit||"unknown";return i===jp.Unknown?xn.Constant:t.stops?xn.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?xn.ClampedLinear:r==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?xn.Proportional:xn.Additive:xn.Identity:xn.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(jp||(jp={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(xn||(xn={}));const fS={unknown:1,inches:lt(1,"meters","inches"),feet:lt(1,"meters","feet"),"us-feet":lt(1,"meters","us-feet"),yards:lt(1,"meters","yards"),miles:lt(1,"meters","miles"),"nautical-miles":lt(1,"meters","nautical-miles"),millimeters:lt(1,"meters","millimeters"),centimeters:lt(1,"meters","centimeters"),decimeters:lt(1,"meters","decimeters"),meters:lt(1,"meters","meters"),kilometers:lt(1,"meters","kilometers"),"decimal-degrees":1/Gde(1,"meters",Nr.radius)},bQ=()=>fe.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),nM=t=>bQ().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),sM=()=>bQ().error("Use of arcade expressions requires an arcade context"),Vj=new Cr,MT=Math.PI,wQ=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function _Q(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(L=>L.type==="color"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void nM("ColorVariable");const n=typeof e=="number",o=n?null:e,u=o==null?void 0:o.attributes;let p=n?e:null;const g=r.field,{ipData:w,hasExpression:S}=r.cache;let T=r.cache.compiledFunc;if(!g&&!S){const L=r.stops;return L&&L[0]&&L[0].color}if(typeof p!="number")if(S){if((i==null?void 0:i.arcade)==null)return void sM();const L={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},R=i.arcade.arcadeUtils,F=R.getViewInfo(L),V=R.createExecContext(o,F,i.timeZone);if(!T){const U=R.createSyntaxTree(r.valueExpression);T=R.createFunction(U),r.cache.compiledFunc=T}p=R.executeFunction(T,V)}else u&&(p=u[g]);const E=r.normalizationField,C=u!=null&&E!=null?parseFloat(u[E]):void 0;if(p!=null&&(!E||n||!isNaN(C)&&C!==0)){isNaN(C)||n||(p/=C);const L=_8(p,w);if(L){const R=L[0],F=L[1],V=R===F?r.stops[R].color:Ce.blendColors(r.stops[R].color,r.stops[F].color,L[2],i!=null?i.color:void 0);return new Ce(V)}}}function SQ(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(L=>L.type==="opacity"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void nM("OpacityVariable");const n=typeof e=="number",o=n?null:e,u=o==null?void 0:o.attributes;let p=n?e:null;const g=r.field,{ipData:w,hasExpression:S}=r.cache;let T=r.cache.compiledFunc;if(!g&&!S){const L=r.stops;return L&&L[0]&&L[0].opacity}if(typeof p!="number")if(S){if((i==null?void 0:i.arcade)==null)return void sM();const L={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},R=i.arcade.arcadeUtils,F=R.getViewInfo(L),V=R.createExecContext(o,F,i.timeZone);if(!T){const U=R.createSyntaxTree(r.valueExpression);T=R.createFunction(U),r.cache.compiledFunc=T}p=R.executeFunction(T,V)}else u&&(p=u[g]);const E=r.normalizationField,C=u!=null&&E!=null?parseFloat(u[E]):void 0;if(p!=null&&(!E||n||!isNaN(C)&&C!==0)){isNaN(C)||n||(p/=C);const L=_8(p,w);if(L){const R=L[0],F=L[1];if(R===F)return r.stops[R].opacity;{const V=r.stops[R].opacity;return V+(r.stops[F].opacity-V)*L[2]}}}}function w8(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(C=>C.type==="rotation"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void nM("RotationVariable");const n=r.axis||"heading",o=n==="heading"&&r.rotationType==="arithmetic"?90:0,u=n==="heading"&&r.rotationType==="arithmetic"?-1:1,p=typeof e=="number"?null:e,g=p==null?void 0:p.attributes,w=r.field,{hasExpression:S}=r.cache;let T=r.cache.compiledFunc,E=0;if(!w&&!S)return E;if(S){if((i==null?void 0:i.arcade)==null)return void sM();const C={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},L=i.arcade.arcadeUtils,R=L.getViewInfo(C),F=L.createExecContext(p,R,i.timeZone);if(!T){const V=L.createSyntaxTree(r.valueExpression);T=L.createFunction(V),r.cache.compiledFunc=T}E=L.executeFunction(T,F)}else g&&(E=g[w]||0);return E=typeof E!="number"||isNaN(E)?null:o+u*E,E}function gwe(t,e,i){const r=typeof e=="number",n=r?null:e,o=n==null?void 0:n.attributes;let u=r?e:null;const{isScaleDriven:p}=t.cache;let g=t.cache.compiledFunc;if(p){const S=i!=null?i.scale:void 0,T=i!=null?i.view:void 0;u=S==null||T==="3d"?vwe(t):S}else if(!r)switch(t.inputValueType){case jp.Expression:{if((i==null?void 0:i.arcade)==null)return void sM();const S={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},T=i.arcade.arcadeUtils,E=T.getViewInfo(S),C=T.createExecContext(n,E,i.timeZone);if(!g){const L=T.createSyntaxTree(t.valueExpression);g=T.createFunction(L),t.cache.compiledFunc=g}u=T.executeFunction(g,C);break}case jp.Field:o&&(u=o[t.field]);break;case jp.Unknown:u=null}if(!g3(u))return null;if(r||!t.normalizationField)return u;const w=o?parseFloat(o[t.normalizationField]):null;return g3(w)&&w!==0?u/w:null}function vwe(t){let e=null,i=null;const r=t.stops;return r?(e=r[0].value,i=r[r.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function yS(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(o=>o.type==="size"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void nM("SizeVariable");const n=$Q(gwe(r,e,i),r,e,i,r.cache.ipData);return n==null||isNaN(n)?0:n}function Yo(t,e,i){return t==null?null:cv(t)?yS(t,e,i):g3(t)?t:null}function xQ(t,e,i){return g3(i)&&t>i?i:g3(e)&&t<e?e:t}function bwe(t,e,i,r){return t+((Yo(e.minSize,i,r)||e.minDataValue)??0)}function wwe(t,e,i){const r=t.stops;let n=(r==null?void 0:r.length)&&r[0].size;return n==null&&(n=t.minSize),Yo(n,e,i)}function _we(t,e,i,r){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),o=Yo(e.minSize,i,r),u=Yo(e.maxSize,i,r),p=r!=null?r.shape:void 0;if(t<=e.minDataValue)return o;if(t>=e.maxDataValue)return u;if(o==null||u==null)return null;if(e.scaleBy==="area"&&p){const g=p==="circle",w=g?MT*(o/2)**2:o*o,S=w+n*((g?MT*(u/2)**2:u*u)-w);return g?2*Math.sqrt(S/MT):Math.sqrt(S)}return o+n*(u-o)}function Swe(t,e,i,r){const n=r!=null?r.shape:void 0,o=t/e.minDataValue,u=Yo(e.minSize,i,r),p=Yo(e.maxSize,i,r);let g=null;return g=n==="circle"?2*Math.sqrt(o*(u/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(o*u**2):o*u,xQ(g,u,p)}function xwe(t,e,i,r,n){var g,w,S;const[o,u,p]=_8(t,n);if(o===u)return Yo((g=e.stops)==null?void 0:g[o].size,i,r);{const T=Yo((w=e.stops)==null?void 0:w[o].size,i,r);return T+(Yo((S=e.stops)==null?void 0:S[u].size,i,r)-T)*p}}function $we(t,e,i,r){const n=((r==null?void 0:r.resolution)??1)*fS[e.valueUnit],o=Yo(e.minSize,i,r),u=Yo(e.maxSize,i,r),{valueRepresentation:p}=e;let g=null;return g=p==="area"?2*Math.sqrt(t/MT)/n:p==="radius"||p==="distance"?2*t/n:t/n,xQ(g,o,u)}function $Q(t,e,i,r,n){switch(e.transformationType){case xn.Additive:return bwe(t,e,i,r);case xn.Constant:return wwe(e,i,r);case xn.ClampedLinear:return _we(t,e,i,r);case xn.Proportional:return Swe(t,e,i,r);case xn.Stops:return xwe(t,e,i,r,n);case xn.RealWorldSize:return $we(t,e,i,r);case xn.Identity:return t;case xn.Unknown:return null}}function TQ(t,e,i){const{isScaleDriven:r}=t.cache;if(!(r&&i==="3d"||e))return null;const n={scale:e,view:i};let o=Yo(t.minSize,Vj,n),u=Yo(t.maxSize,Vj,n);if(o!=null||u!=null){if(o>u){const p=u;u=o,o=p}return{minSize:o,maxSize:u}}}function Twe(t,e,i){if(!t.visualVariables)return;const r=[],n=[],o=[],u=[],p=[];for(const g of t.visualVariables)switch(g.type){case"color":n.push(g);break;case"opacity":o.push(g);break;case"rotation":p.push(g);break;case"size":u.push(g)}return n.forEach(g=>{const w=_Q(g,e,i);r.push({variable:g,value:w})}),o.forEach(g=>{const w=SQ(g,e,i);r.push({variable:g,value:w})}),p.forEach(g=>{const w=w8(g,e,i);r.push({variable:g,value:w})}),u.forEach(g=>{const w=yS(g,e,i);r.push({variable:g,value:w})}),r.filter(g=>g.value!=null)}function _8(t,e){if(!e)return;let i=0,r=e.length-1;return e.some((n,o)=>t<n?(r=o,!0):(i=o,!1)),[i,r,(t-e[i])/(e[r]-e[i])]}function Ewe(t,e,i){const r=["proportional","proportional","proportional"];for(const n of t){const o=n.useSymbolValue?"symbol-value":yS(n,e,i);switch(n.axis){case"width":r[0]=o;break;case"depth":r[1]=o;break;case"height":r[2]=o;break;case"width-and-depth":r[0]=o,r[1]=o;break;case"all":case void 0:case null:r[0]=o,r[1]=o,r[2]=o;break;default:n.axis}}return r}const Ym=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:Ewe,getColor:_Q,getOpacity:SQ,getRotationAngle:w8,getSize:yS,getSizeForValue:$Q,getSizeFromNumberOrVariable:Yo,getSizeRangeAtScale:TQ,getVisualVariableValues:Twe,viewScaleRE:wQ},Symbol.toStringTag,{value:"Module"}));var iA;const _x=new et({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),rA=new et({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function zj(t){if(t!=null)return typeof t=="string"||typeof t=="number"?mwe(t):t.type==="size"?cv(t)?t:(delete(t={...t}).type,new yi(t)):void 0}function Uj(t,e,i){if(typeof t!="object")return t;const r=new yi;return r.read(t,i),r}let yi=iA=class extends dS{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&wQ.test(this.valueExpression)}}set index(t){cv(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),cv(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return gQ(this)}set maxDataValue(t){t&&this.stops&&(fe.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(fe.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return zj(t)}readMaxSize(t,e,i){return Uj(t,e,i)}set minDataValue(t){t&&this.stops&&(fe.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(fe.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return zj(t)}readMinSize(t,e,i){return Uj(t,e,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value):t&&(fe.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return vQ(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,r){if(t==="$view.scale"){if(r!=null&&r.messages){const n=this.index,o=typeof n=="string"?n:`visualVariables[${n}]`;r.messages.push(new re("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:o+".valueExpression",context:r}))}}else e[i]=t}readValueUnit(t){return t?rA.read(t):null}clone(){var t,e;return new iA({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:cv(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:cv(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(t=this.stops)==null?void 0:t.map(i=>i.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}flipSizes(){if(this.transformationType===xn.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===xn.Stops){const t=this.stops;if(!t)return this;const e=t.map(r=>r.size).reverse(),i=t.length;for(let r=0;r<i;r++)t[r].size=e[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var t;return(t=this.stops)==null?void 0:t.map(e=>e.value||0)}};m([b({readOnly:!0})],yi.prototype,"cache",null),m([b({type:_x.apiValues,json:{type:_x.jsonValues,origins:{"web-map":{read:!1}},read:_x.read,write:_x.write}})],yi.prototype,"axis",void 0),m([b()],yi.prototype,"index",null),m([b({type:String,readOnly:!0})],yi.prototype,"inputValueType",null),m([b({type:mQ,json:{write:!0}})],yi.prototype,"legendOptions",void 0),m([b({type:Number,value:null,json:{write:!0}})],yi.prototype,"maxDataValue",null),m([b({type:Number,value:null,json:{write:!0}})],yi.prototype,"maxSize",null),m([Dt("maxSize")],yi.prototype,"castMaxSize",null),m([Me("maxSize")],yi.prototype,"readMaxSize",null),m([b({type:Number,value:null,json:{write:!0}})],yi.prototype,"minDataValue",null),m([b({type:Number,value:null,json:{write:!0}})],yi.prototype,"minSize",null),m([Dt("minSize")],yi.prototype,"castMinSize",null),m([Me("minSize")],yi.prototype,"readMinSize",null),m([b({type:String,json:{write:!0}})],yi.prototype,"normalizationField",void 0),m([b({readOnly:!0})],yi.prototype,"arcadeRequired",null),m([b({type:String})],yi.prototype,"scaleBy",void 0),m([b({type:[ET],value:null,json:{write:!0}})],yi.prototype,"stops",null),m([b({type:["outline"],json:{write:!0}})],yi.prototype,"target",void 0),m([b({type:String,readOnly:!0})],yi.prototype,"transformationType",null),m([b({type:["size"],json:{type:["sizeInfo"]}})],yi.prototype,"type",void 0),m([b({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],yi.prototype,"useSymbolValue",void 0),m([b({type:String,json:{write:!0}})],yi.prototype,"valueExpression",void 0),m([Me("valueExpression",["valueExpression","expression"])],yi.prototype,"readValueExpression",null),m([Le("web-scene","valueExpression")],yi.prototype,"writeValueExpressionWebScene",null),m([b({type:["radius","diameter","area","width","distance"],json:{write:!0}})],yi.prototype,"valueRepresentation",void 0),m([b({type:rA.apiValues,json:{write:rA.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],yi.prototype,"valueUnit",void 0),m([Me("valueUnit")],yi.prototype,"readValueUnit",null),yi=iA=m([G("esri.renderers.visualVariables.SizeVariable")],yi);const mS=yi,Iwe={color:dQ,size:mS,opacity:fQ,rotation:yQ},Mwe=new et({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),kwe=/^\[([^\]]+)\]$/i;let kT=class extends Te{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e&&e.filter(i=>!!i),e==null?void 0:e.length){for(const i of e)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some(i=>!!i.target)&&e.sort((i,r)=>{let n=null;return n=i.target===r.target?0:i.target?1:-1,n});for(let i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,i,r){const{rotationExpression:n,rotationType:o}=i,u=n==null?void 0:n.match(kwe),p=u==null?void 0:u[1];if(p&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:o,field:p})),e)return e.map(g=>{const w=Mwe.read(g.type),S=Iwe[w];S||(fe.getLogger(this).warn(`Unknown variable type: ${w}`),r!=null&&r.messages&&r.messages.push(new Ul("visual-variable:unsupported",`visualVariable of type '${w}' is not supported`,{definition:g,context:r})));const T=new S;return T.read(g,r),T})}writeVariables(e,i){const r=[];for(const n of e){const o=n.toJSON(i);o&&r.push(o)}return r}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};m([b()],kT.prototype,"visualVariables",null),kT=m([G("esri.renderers.visualVariables.VisualVariableFactory")],kT);const Cwe=kT,Awe={base:dS,key:"type",typeMap:{opacity:fQ,color:dQ,rotation:yQ,size:mS}},ew=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new Cwe}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,r,n){return this._vvFactory.readVariables(i,r,n)}writeVisualVariables(i,r,n,o){r[n]=this._vvFactory.writeVariables(i,o)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const i of this.visualVariables)if(i.arcadeRequired)return!0;return!1}hasVisualVariables(i,r){return i?this.getVisualVariablesForType(i,r).length>0:this.getVisualVariablesForType("size",r).length>0||this.getVisualVariablesForType("color",r).length>0||this.getVisualVariablesForType("opacity",r).length>0||this.getVisualVariablesForType("rotation",r).length>0}getVisualVariablesForType(i,r){const n=this.visualVariables;return n?n.filter(o=>o.type===i&&(typeof r=="string"?o.target===r:r!==!1||!o.target)):[]}async collectVVRequiredFields(i,r){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const o of n)o&&(o.field&&_o(i,r,o.field),o.normalizationField&&_o(i,r,o.normalizationField),o.valueExpression&&(Lwe(o.valueExpression,i,r)||await Qs(i,r,o.valueExpression)))}};return m([b({types:[Awe],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),m([Me("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),m([Le("visualVariables")],e.prototype,"writeVisualVariables",null),e=m([G("esri.renderers.mixins.VisualVariablesMixin")],e),e};function Lwe(t,e,i){const r=pwe(t);return r!=null&&(_o(e,i,r),!0)}const S8=[252,146,31,255],Owe=[153,153,153,255],Pwe={type:"esriSMS",style:"esriSMSCircle",size:6,color:S8,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Rwe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:S8},Fwe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},Nwe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},Dwe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},jwe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Vwe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},EQ=kn.fromJSON(Pwe),IQ=cn.fromJSON(Rwe),MQ=na.fromJSON(Fwe),zwe=Zm.fromJSON(Nwe);function VZe(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return EQ;case"polyline":return IQ;case"polygon":case"extent":return MQ}return null}const zZe=kn.fromJSON(Dwe),UZe=cn.fromJSON(jwe),GZe=na.fromJSON(Vwe),Uwe=Pp.fromSimpleMarkerSymbol(EQ),Gwe=Jm.fromSimpleLineSymbol(IQ),Bwe=y0.fromSimpleFillSymbol(MQ),qwe=new Xb({symbolLayers:new Ie([new f0({material:{color:S8},edges:new PX({size:Jn(1),color:new Ce(Owe)})})])}),Hwe=new Jm({symbolLayers:new Ie([new Zb({material:{color:new Ce([0,0,0])},size:Jn(1)})])}),Wwe=new y0({symbolLayers:new Ie([new f0({outline:{color:new Ce([0,0,0]),size:Jn(1)}})])});function BZe(t){if(t==null)return null;switch(t.type){case"mesh":return qwe;case"point":case"multipoint":return Uwe;case"polyline":return Gwe;case"polygon":case"extent":return Bwe}return null}const Mp={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Pm(t,e=Mp){var g,w,S,T;if(!t)return{symbol:null};const{retainId:i=Mp.retainId,ignoreDrivers:r=Mp.ignoreDrivers,hasLabelingContext:n=Mp.hasLabelingContext,retainCIM:o=Mp.retainCIM,cimFallbackEnabled:u=Mp.cimFallbackEnabled}=e;let p=null;if(mh(t)||t instanceof Km)p=t.clone();else if(t.type==="cim"){const E=(w=(g=t.data)==null?void 0:g.symbol)==null?void 0:w.type;switch(E){case"CIMPointSymbol":p=o?t.clone():Pp.fromCIMSymbol(t);break;case"CIMLineSymbol":u&&(p=Hwe.clone(),(S=e==null?void 0:e.logWarning)==null||S.call(e,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":u&&(p=Wwe.clone(),(T=e==null?void 0:e.logWarning)==null||T.call(e,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!p)return{error:new re("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${E||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof cn)p=Jm.fromSimpleLineSymbol(t);else if(t instanceof kn)p=Pp.fromSimpleMarkerSymbol(t);else if(t instanceof Qb)p=Pp.fromPictureMarkerSymbol(t);else if(t instanceof na)p=e.geometryType&&e.geometryType==="mesh"?Xb.fromSimpleFillSymbol(t):y0.fromSimpleFillSymbol(t);else{if(!(t instanceof Zm))return{error:new re("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};p=n?iM.fromTextSymbol(t):Pp.fromTextSymbol(t)}return i&&p&&p.type!=="cim"&&(p.id=t.id),r&&mh(p)&&p.symbolLayers.forEach(E=>E.ignoreDrivers=!0),{symbol:p}}function wE(t,e,i,r){const n=kQ(t,{},{context:r,isLabelSymbol:!1});n!=null&&(e[i]=n)}function Gj(t,e,i,r){const n=kQ(t,{},{context:r,isLabelSymbol:!0});n!=null&&(e[i]=n)}function Bj(t){return t instanceof Yb||t instanceof Km}function kQ(t,e,i){if(t==null)return null;const{context:r,isLabelSymbol:n}=i,o=r==null?void 0:r.origin,u=r==null?void 0:r.messages;if(o==="web-scene"&&!Bj(t)){const p=Pm(t,{retainCIM:!0,hasLabelingContext:n});return p.symbol!=null?p.symbol.write(e,r):(u==null||u.push(new re("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:r,error:p.error})),null)}return(o==="web-map"||o==="portal-item"&&!$Z(r==null?void 0:r.layer))&&Bj(t)?(u==null||u.push(new re("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:r})),null):t.write(e,r)}function CQ(t,e){return Qbe(t,null,e)}const oM={types:uQ,json:{write:{writer:wE},origins:{"web-scene":{types:Oj,write:{writer:wE},read:{reader:zb({types:Oj})}}}}},x8=D7({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},oM),AQ={types:{base:Es,key:"type",typeMap:{"simple-fill":zu.typeMap["simple-fill"],"picture-fill":zu.typeMap["picture-fill"],"polygon-3d":zu.typeMap["polygon-3d"]}},json:{write:{writer:wE},origins:{"web-scene":{type:y0,write:{writer:wE}}}}},CT={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var nA;let Gd=nA=class extends ye{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){var t;return new nA({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:((t=this.symbol)==null?void 0:t.clone())??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};m([b({type:String,json:{write:!0}})],Gd.prototype,"description",void 0),m([b({type:String,json:{write:!0}})],Gd.prototype,"label",void 0),m([b({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Gd.prototype,"minValue",void 0),m([b({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Gd.prototype,"maxValue",void 0),m([b(x8)],Gd.prototype,"symbol",void 0),Gd=nA=m([G("esri.renderers.support.ClassBreakInfo")],Gd);const _E=Gd;var sA;const LQ="log",AT="percent-of-total",LT="field",Sx=new et({esriNormalizeByLog:LQ,esriNormalizeByPercentOfTotal:AT,esriNormalizeByField:LT}),Jwe=Yi(_E);let mn=sA=class extends ew(rd){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let r=e.minValue;return t.map(n=>{const o=new _E;return o.read(n,i),o.minValue==null&&(o.minValue=r),o.maxValue==null&&(o.maxValue=o.minValue),r=o.maxValue,o})}writeClassBreakInfos(t,e,i,r){const n=t.map(o=>o.write({},r));this._areClassBreaksConsecutive()&&n.forEach(o=>delete o.classMinValue),e[i]=n}castField(t){return t==null?t:typeof t=="function"?(fe.getLogger(this).error(".field: field must be a string value"),null):W3(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=this.normalizationTotal!=null;return e||i?(t=e&&LT||i&&AT||null,e&&i&&fe.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==LT&&t!==AT||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let r=null;r=typeof t=="number"?new _E({minValue:t,maxValue:e,symbol:cQ(i)}):Jwe(ae(t)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]===t&&n[1]===e){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(e==null?void 0:e.arcade)==null&&fe.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await fh()});const r=this.getBreakIndex(t,i);return r!==-1?this.classBreakInfos[r]:null}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void fe.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(e==null?void 0:e.arcade)==null){const n=await fh(),{arcadeUtils:o}=n;o.hasGeometryOperations(this.valueExpression)&&await o.enableGeometryOperations(),i={...i,arcade:n}}const r=this.getBreakIndex(t,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((r,n)=>r+n.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var t,e;return new sA({field:this.field,backgroundFillSymbol:(t=this.backgroundFillSymbol)==null?void 0:t.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(e=this.defaultSymbol)==null?void 0:e.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:ae(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:ae(this.visualVariables),legendOptions:ae(this.legendOptions),authoringInfo:ae(this.authoringInfo)})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),Qs(t,e,this.valueExpression)];_o(t,e,this.field),_o(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:o,timeZone:u}=e??{},{valueExpression:p}=this;let g=this._compiledValueExpression.valueExpression===p?this._compiledValueExpression.compiledFunction:null;const w=o.arcadeUtils;if(!g){const T=w.createSyntaxTree(p);g=w.createFunction(T),this._compiledValueExpression.compiledFunction=g}this._compiledValueExpression.valueExpression=p;const S=w.executeFunction(g,w.createExecContext(t,w.getViewInfo({viewingMode:i,scale:r,spatialReference:n}),u));return this._getBreakIndexfromInfos(S)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,r=this.normalizationType;let n=parseFloat(i[e]);if(r){const o=this.normalizationTotal,u=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(r===LQ)n=Math.log(n)*Math.LOG10E;else if(r!==AT||o==null||isNaN(o)){if(r===LT&&!isNaN(u)){if(isNaN(n)||isNaN(u))return-1;n/=u}}else n=n/o*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=t&&(e?t<=r[1]:t<r[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};m([b(AQ)],mn.prototype,"backgroundFillSymbol",void 0),m([b({type:[_E]})],mn.prototype,"classBreakInfos",void 0),m([Me("classBreakInfos")],mn.prototype,"readClassBreakInfos",null),m([Le("classBreakInfos")],mn.prototype,"writeClassBreakInfos",null),m([b({type:String,json:{write:!0}})],mn.prototype,"defaultLabel",void 0),m([b(oM)],mn.prototype,"defaultSymbol",void 0),m([b({type:String,json:{write:!0}})],mn.prototype,"field",void 0),m([Dt("field")],mn.prototype,"castField",null),m([b({type:Boolean})],mn.prototype,"isMaxInclusive",void 0),m([b({type:kv,json:{write:!0}})],mn.prototype,"legendOptions",void 0),m([b({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],mn.prototype,"minValue",null),m([b({type:String,json:{write:!0}})],mn.prototype,"normalizationField",void 0),m([b({type:Number,cast:t=>Tl(t),json:{write:!0}})],mn.prototype,"normalizationTotal",void 0),m([b({type:Sx.apiValues,value:null,json:{type:Sx.jsonValues,read:Sx.read,write:Sx.write}})],mn.prototype,"normalizationType",null),m([ze({classBreaks:"class-breaks"})],mn.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],mn.prototype,"valueExpression",void 0),m([b({type:String,json:{write:!0}})],mn.prototype,"valueExpressionTitle",void 0),mn=sA=m([G("esri.renderers.ClassBreaksRenderer")],mn);const OQ=mn,oA=-3,Zwe=oA-1;var $p;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})($p||($p={}));let qZe=class{constructor(e,i,r){this.name=e,this._storage=i,this.id=Ywe+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(e){return this._storage.getSize(this,e)}resetHitRate(){this._hit=this._miss=0}put(e,i,r,n=0){this._storage.put(this,e,i,r,n)}pop(e){const i=this._storage.pop(this,e);return i===void 0?++this._miss:++this._hit,i}get(e){const i=this._storage.get(this,e);return i===void 0?++this._miss:++this._hit,i}peek(e){return this._storage.peek(this,e)}updateSize(e,i,r){this._storage.updateSize(this,e,i,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}},Kwe=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new om,this._users=new om}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,i){this._removeFuncs.push([e,i])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(i=>i[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,i){const r=this._db.get(e.id+i);return(r==null?void 0:r.size)??0}put(e,i,r,n,o){i=e.id+i;const u=this._db.get(i);if(u&&(this._size-=u.size,e.size-=u.size,this._db.delete(i),u.entry!==r&&this._notifyRemove(i,u.entry,u.size,$p.ALL)),n>this._maxSize)return void this._notifyRemove(i,r,n,$p.ALL);if(r===void 0)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${i}`),void this._notifyRemove(i,r,0,$p.ALL);const p=1+Math.max(o,Zwe)-oA;this._db.set(i,new Xwe(r,n,p)),this._size+=n,e.size+=n,this._checkSize()}updateSize(e,i,r,n){i=e.id+i;const o=this._db.get(i);if(o&&o.entry===r){for(this._size-=o.size,e.size-=o.size;n>this._maxSize;){const u=this._notifyRemove(i,r,n,$p.SOME);if(!(u!=null&&u>0))return void this._db.delete(i);n=u}o.size=n,this._size+=n,e.size+=n,this._checkSize()}}pop(e,i){i=e.id+i;const r=this._db.get(i);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(i),++this._hit,r.entry;++this._miss}get(e,i){i=e.id+i;const r=this._db.get(i);if(r!==void 0)return this._db.delete(i),r.lives=r.lifetime,this._db.set(i,r),++this._hit,r.entry;++this._miss}peek(e,i){const r=this._db.get(e.id+i);return r?++this._hit:++this._miss,r==null?void 0:r.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach((u,p)=>{const g=u.lifetime;r[g]=(r[g]||0)+u.size,this._users.forAll(w=>{const{id:S,name:T}=w;if(p.startsWith(S)){const E=i[T]||0;i[T]=E+u.size}})});const n={};this._users.forAll(u=>{const p=u.name;if("hitRate"in u&&typeof u.hitRate=="number"&&!isNaN(u.hitRate)&&u.hitRate>0){const g=i[p]||0;i[p]=g,n[p]=Math.round(100*u.hitRate)+"%"}else n[p]="0%"});const o=Object.keys(i);o.sort((u,p)=>i[p]-i[u]),o.forEach(u=>e[u]=Math.round(i[u]/2**20)+"MB / "+n[u]);for(let u=r.length-1;u>=0;--u){const p=r[u];p&&(e["Priority "+(u+oA-1)]=Math.round(p/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const i=e.id;this._db.forEach((r,n)=>{n.startsWith(i)&&(this._size-=r.size,this._db.delete(n),this._notifyRemove(n,r.entry,r.size,$p.ALL))}),e.size=0}clearAll(){this._db.forEach((e,i)=>this._notifyRemove(i,e.entry,e.size,$p.ALL)),this._users.forAll(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,i,r,n){let o;return this._removeFuncs.some(u=>{if(e.startsWith(u[0])){const p=u[1](i,n,r);return typeof p=="number"&&(o=p),!0}return!1}),o}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e)),this._checkSizeLimits()}_checkSizeLimits(e){const i=e??this;if(i.maxSize<0||i.size<=i.maxSize)return;const r=e==null?void 0:e.id;let n=!0;for(;n;){n=!1;for(const[o,u]of this._db)if(u.lifetime===0&&(!r||o.startsWith(r))){if(this._purgeItem(o,u,e),i.size<=.9*i.maxSize)return;n||(n=this._db.has(o))}}for(const[o,u]of this._db)if((!r||o.startsWith(r))&&(this._purgeItem(o,u,e),i.size<=.9*i.maxSize))return}_purgeItem(e,i,r=this._users.find(n=>e.startsWith(n.id))){if(this._db.delete(e),i.lives<=1){this._size-=i.size,r&&(r.size-=i.size);const n=this._notifyRemove(e,i.entry,i.size,$p.SOME);n!=null&&n>0&&(this._size+=n,r&&(r.size+=n),i.lives=i.lifetime,i.size=n,this._db.set(e,i))}else--i.lives,this._db.set(e,i)}},Ywe=0,Xwe=class{constructor(e,i,r){this.entry=e,this.size=i,this.lifetime=r,this.lives=r}},$8=class{constructor(e,i){this._storage=new Kwe,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,i,r=1){this._storage.put(this,e,i,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},PQ=class aA{constructor(e,i,r=""){this.major=e,this.minor=i,this._context=r}lessThan(e,i){return this.major<e||e===this.major&&this.minor<i}since(e,i){return!this.lessThan(e,i)}validate(e){if(this.major!==e.major){const i=this._context&&this._context+":",r=this._context&&this._context+" ";throw new re(i+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new aA(this.major,this.minor,this._context)}static parse(e,i=""){const[r,n]=e.split("."),o=/^\s*\d+\s*$/;if(!(r!=null&&r.match)||!o.test(r))throw new re((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!(n!=null&&n.match)||!o.test(n))throw new re((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const u=parseInt(r,10),p=parseInt(n,10);return new aA(u,p,i)}},Nu=class{};function Qwe(t){return t instanceof qm?t===Nu.instance:(t==null?void 0:t.toString().toLowerCase())==="unknown"}function YZe(t){return Qwe(t)?Nu.instance:t}Nu.instance=new ia("Etc/UTC");function e_e(t){return"timeZone"in t}function t_e(t){return"timeZone"in t}function i_e(t){return"dateFieldsTimeZone"in t}const r_e=new Map;let RQ=class OT{static fromJSON(e){return new OT(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new OT(e.fields??[],Hj(e))}static fromLayerJSON(e){return new OT(e.fields??[],Hj(e))}constructor(e=[],i){var n;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const r=[];for(const o of this.fields){const u=o==null?void 0:o.name,p=qj(u);if(u&&p){const g=By(u);this._fieldsMap.set(u,o),this._fieldsMap.set(g,o),this._normalizedFieldsMap.set(p,o),r.push(`${g}:${o.type}:${(n=this._timeZoneByFieldName)==null?void 0:n.get(u)}`),e8(o)?(this.dateFields.push(o),this._dateFieldsSet.add(o)):Mv(o)&&(this._numericFieldsSet.add(o),this.numericFields.push(o)),Tj(o)||Ej(o)||(o.editable=o.editable==null||!!o.editable,o.nullable=o.nullable==null||!!o.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)Tj(e)||Ej(e)||e.nullable||Ave(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(e==null?void 0:e.uid)}has(e){return this.get(e)!=null}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(By(e))??this._normalizedFieldsMap.get(qj(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(e){const i=this.get(e&&typeof e!="string"?e.name:e);return i?this._timeZoneByFieldName?this._timeZoneByFieldName.get(i.name):i.type==="date"||i.type==="esriFieldTypeDate"?(fe.getLogger("esri.layers.support.FieldsIndex").error(new re("getTimeZone:no-timezone-information",`no time zone information for field '${i.name}'`)),ra):FQ.has(i.type)?Kp:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===Kp?Nu.instance:i===ra?an.utcInstance:Bf(r_e,i,()=>ia.create(i)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return db(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var i;return((i=this.get(e))==null?void 0:i.name)??void 0}toJSON(){return{fields:this.fields.map(e=>J5(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function By(t){return t.trim().toLowerCase()}function qj(t){var e;return((e=mve(t))==null?void 0:e.toLowerCase())??""}const FQ=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function Hj(t){const e=new Map;if(!t.fields)return e;const i=t.datesInUnknownTimezone===!0,{timeInfo:r,editFieldsInfo:n}=t,o=(r?"startField"in r?r.startField:r.startTimeField:"")??"",u=(r?"endField"in r?r.endField:r.endTimeField:"")??"",p=i_e(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?nT(t.dateFieldsTimeReference):null,g=n?e_e(n)?n.timeZone??p:n.dateFieldsTimeReference?nT(n.dateFieldsTimeReference):p??ra:null,w=r?t_e(r)?r.timeZone??p:r.timeReference?nT(r.timeReference):p:null,S=new Map([[By((n==null?void 0:n.creationDateField)??""),g],[By((n==null?void 0:n.editDateField)??""),g],[By(o),w],[By(u),w]]);for(const{name:T,type:E}of t.fields)if(FQ.has(E))e.set(T,Kp);else if(E!=="date"&&E!=="esriFieldTypeDate")e.set(T,null);else if(i)e.set(T,Kp);else{const C=S.get(By(T??""))??p;e.set(T,C)}return e}function v3(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function n_e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function T8(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}function NQ(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function DQ(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function jQ(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function VQ(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function s_e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function o_e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function a_e(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function l_e(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function u_e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function zQ(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function c_e(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t}function UQ(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+r*r+n*n+o*o)}function GQ(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return i*i+r*r+n*n+o*o}function E8(t){const e=t[0],i=t[1],r=t[2],n=t[3];return Math.sqrt(e*e+i*i+r*r+n*n)}function I8(t){const e=t[0],i=t[1],r=t[2],n=t[3];return e*e+i*i+r*r+n*n}function h_e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function p_e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function BQ(t,e){const i=e[0],r=e[1],n=e[2],o=e[3];let u=i*i+r*r+n*n+o*o;return u>0&&(u=1/Math.sqrt(u),t[0]=i*u,t[1]=r*u,t[2]=n*u,t[3]=o*u),t}function M8(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function k8(t,e,i,r){const n=e[0],o=e[1],u=e[2],p=e[3];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t[2]=u+r*(i[2]-u),t[3]=p+r*(i[3]-p),t}function d_e(t,e){const i=eS;let r,n,o,u,p,g;e=e||1;do r=2*i()-1,n=2*i()-1,p=r*r+n*n;while(p>=1);do o=2*i()-1,u=2*i()-1,g=o*o+u*u;while(g>=1);const w=Math.sqrt((1-p)/g);return t[0]=e*r,t[1]=e*n,t[2]=e*o*w,t[3]=e*u*w,t}function C8(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*u,t[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*u,t[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*u,t[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*u,t}function f_e(t,e,i){const r=e[0],n=e[1],o=e[2],u=i[0],p=i[1],g=i[2],w=i[3],S=w*r+p*o-g*n,T=w*n+g*r-u*o,E=w*o+u*n-p*r,C=-u*r-p*n-g*o;return t[0]=S*w+C*-u+T*-g-E*-p,t[1]=T*w+C*-p+E*-u-S*-g,t[2]=E*w+C*-g+S*-p-T*-u,t[3]=e[3],t}function y_e(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function qQ(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function aM(t,e){const i=t[0],r=t[1],n=t[2],o=t[3],u=e[0],p=e[1],g=e[2],w=e[3],S=kr();return Math.abs(i-u)<=S*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-p)<=S*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(n-g)<=S*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-w)<=S*Math.max(1,Math.abs(o),Math.abs(w))}const m_e=DQ,g_e=jQ,v_e=VQ,b_e=UQ,w_e=GQ,__e=E8,S_e=I8;Object.freeze(Object.defineProperty({__proto__:null,add:NQ,ceil:s_e,copy:v3,copyVec3:n_e,dist:b_e,distance:UQ,div:v_e,divide:VQ,dot:M8,equals:aM,exactEquals:qQ,floor:o_e,inverse:p_e,len:__e,length:E8,lerp:k8,max:l_e,min:a_e,mul:g_e,multiply:jQ,negate:h_e,normalize:BQ,random:d_e,round:u_e,scale:zQ,scaleAndAdd:c_e,set:T8,sqrDist:w_e,sqrLen:S_e,squaredDistance:GQ,squaredLength:I8,str:y_e,sub:m_e,subtract:DQ,transformMat4:C8,transformQuat:f_e},Symbol.toStringTag,{value:"Module"}));function $h(){return[0,0,0,0]}function x_e(t){return[t[0],t[1],t[2],t[3]]}function nd(t,e,i,r){return[t,e,i,r]}function HQ(t,e=$h()){const i=Math.min(4,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function $_e(t,e){return new Float64Array(t,e,4)}function WQ(){return $h()}function JQ(){return nd(1,1,1,1)}function ZQ(){return nd(1,0,0,0)}function KQ(){return nd(0,1,0,0)}function YQ(){return nd(0,0,1,0)}function XQ(){return nd(0,0,0,1)}const T_e=WQ(),E_e=JQ(),I_e=ZQ(),M_e=KQ(),k_e=YQ(),C_e=XQ();Object.freeze(Object.defineProperty({__proto__:null,ONES:E_e,UNIT_W:C_e,UNIT_X:I_e,UNIT_Y:M_e,UNIT_Z:k_e,ZEROS:T_e,clone:x_e,create:$h,createView:$_e,fromArray:HQ,fromValues:nd,ones:JQ,unitW:XQ,unitX:ZQ,unitY:KQ,unitZ:YQ,zeros:WQ},Symbol.toStringTag,{value:"Module"}));function QQ(t){return"r"in t&&"g"in t&&"b"in t}function eee(t){return"h"in t&&"s"in t&&"v"in t}function tee(t){return"l"in t&&"a"in t&&"b"in t}function iee(t){return"l"in t&&"c"in t&&"h"in t}function A_e(t){return"x"in t&&"y"in t&&"z"in t}const L_e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],O_e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function ree(t,e){const i=[];let r,n;if(t[0].length!==e.length)throw new Error("dimensions do not match");const o=t.length,u=t[0].length;let p=0;for(r=0;r<o;r++){for(p=0,n=0;n<u;n++)p+=t[r][n]*e[n];i.push(p)}return i}function nee(t){const e=[t.r/255,t.g/255,t.b/255].map(r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4),i=ree(L_e,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function A8(t){const e=ree(O_e,[t.x/100,t.y/100,t.z/100]).map(i=>{const r=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(r,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function see(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function oee(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function P_e(t){const e=t.l,i=t.a,r=t.b,n=Math.sqrt(i*i+r*r);let o=Math.atan2(r,i);return o=o>0?o:o+2*Math.PI,{l:e,c:n,h:o}}function R_e(t){const e=t.l,i=t.c,r=t.h;return{l:e,a:i*Math.cos(r),b:i*Math.sin(r)}}function F_e(t){return see(nee(t))}function N_e(t){return A8(oee(t))}function D_e(t){return P_e(see(nee(t)))}function j_e(t){return A8(oee(R_e(t)))}function V_e(t){const e=t.r,i=t.g,r=t.b,n=Math.max(e,i,r),o=n-Math.min(e,i,r);let u=n,p=o===0?0:n===e?(i-r)/o%6:n===i?(r-e)/o+2:(e-i)/o+4,g=o===0?0:o/u;return p<0&&(p+=6),p*=60,g*=100,u*=100/255,{h:p,s:g,v:u}}function z_e(t){const e=(t.h+360)%360/60,i=t.s/100,r=t.v/100*255,n=r*i,o=n*(1-Math.abs(e%2-1));let u;switch(Math.floor(e)){case 0:u={r:n,g:o,b:0};break;case 1:u={r:o,g:n,b:0};break;case 2:u={r:0,g:n,b:o};break;case 3:u={r:0,g:o,b:n};break;case 4:u={r:o,g:0,b:n};break;case 5:case 6:u={r:n,g:0,b:o};break;default:u={r:0,g:0,b:0}}return u.r=Math.round(u.r+r-n),u.g=Math.round(u.g+r-n),u.b=Math.round(u.b+r-n),u}function Xm(t){return QQ(t)?t:iee(t)?j_e(t):tee(t)?N_e(t):A_e(t)?A8(t):eee(t)?z_e(t):t}function lM(t){return eee(t)?t:V_e(Xm(t))}function U_e(t){return tee(t)?t:F_e(Xm(t))}function XZe(t){return iee(t)?t:D_e(Xm(t))}function G_e(t){let{r:e,g:i,b:r,a:n}=t;return n<1&&(e=Math.round(n*e+255*(1-n)),i=Math.round(n*i+255*(1-n)),r=Math.round(n*r+255*(1-n))),new Ce({r:e,g:i,b:r})}function B_e(t,e){const{r:i,g:r,b:n}=e!=null&&e.ignoreAlpha?t:G_e(t);return .2126*i+.7152*r+.0722*n}var lA;function QZe(t,e=lA.High){return B_e(t,{ignoreAlpha:!0})>e?new Ce([0,0,0,t.a]):new Ce([255,255,255,t.a])}function eKe(t,e){const i=U_e(t);i.l*=1-e;const r=Xm(i),n=t.clone();return n.setColor(r),n.a=t.a,n}function tKe(t,e){const i=t.clone();return i.a*=e,i}function iKe(t,e){const i=lM(t);i.s*=e;const r=Xm(i),n=t.clone();return n.setColor(r),n.a=t.a,n}function rKe(t){return Ce.toUnitRGBA(t)}function nKe(t){return nd(t[0],t[1],t[2],t.length>3?t[3]:1)}function sKe(t,e){const i=Ce.toUnitRGBA(t);return i[3]*=e,i}(function(t){t[t.Low=160]="Low",t[t.High=225]="High"})(lA||(lA={}));const q_e={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},uA={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0}};function H_e(t){return typeof t=="function"}function oKe(t,e,i,r){return H_e(t)?t(e,i,r):t}function aKe(t){return[t.r,t.g,t.b,t.a]}const W_e=` /-,
`;function Wj(t){let e=t.length;for(;e--;)if(!W_e.includes(t.charAt(e)))return!1;return!0}function J_e(t,e){const i=[];let r=0,n=-1;do if(n=t.indexOf("[",r),n>=r){if(n>r){const o=t.substr(r,n-r);i.push([o,null,Wj(o)])}if(r=n+1,n=t.indexOf("]",r),n>=r){if(n>r){const o=e[t.substr(r,n-r)];o&&i.push([null,o,!1])}r=n+1}}while(n!==-1);if(r<t.length-1){const o=t.substr(r);i.push([o,null,Wj(o)])}return i}function Z_e(t,e,i,r){let n="",o=null;for(const u of e){const[p,g,w]=u;if(p)w?o=p:(o&&(n+=o,o=null),n+=p);else{let S=g;i!=null&&(S=hee(g,i));const T=t.attributes[S];T&&(o&&(n+=o,o=null),n+=T)}}return K_e(n,r)}function K_e(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function lKe(t,e,i,r,n,o,u=!0){const p=e/n,g=i/o,w=Math.ceil(p/2),S=Math.ceil(g/2);for(let T=0;T<o;T++)for(let E=0;E<n;E++){const C=4*(E+(u?o-T-1:T)*n);let L=0,R=0,F=0,V=0,U=0,W=0,H=0;const J=(T+.5)*g;for(let X=Math.floor(T*g);X<(T+1)*g;X++){const te=Math.abs(J-(X+.5))/S,oe=(E+.5)*p,pe=te*te;for(let de=Math.floor(E*p);de<(E+1)*p;de++){let ge=Math.abs(oe-(de+.5))/w;const we=Math.sqrt(pe+ge*ge);we>=-1&&we<=1&&(L=2*we*we*we-3*we*we+1,L>0&&(ge=4*(de+X*e),H+=L*t[ge+3],F+=L,t[ge+3]<255&&(L=L*t[ge+3]/250),V+=L*t[ge],U+=L*t[ge+1],W+=L*t[ge+2],R+=L))}}r[C]=V/R,r[C+1]=U/R,r[C+2]=W/R,r[C+3]=H/F}}function aee(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function lee(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function uee(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function cee(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function uKe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function uM(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const cKe=(t,e=0)=>t==null||isNaN(t)?e:t,hKe=(t,e)=>t??e,pKe=t=>t.tintColor?aee(t.tintColor):[255,255,255,1],dKe=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function fKe(){return ie(()=>import("./geometryEngineJSON-DDjAODZ3.js").then(t=>t.g),__vite__mapDeps([16,17]))}function yKe(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function mKe(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function gKe(t){let e="normal",i="normal";if(t){const r=t.toLowerCase();r.includes("italic")?e="italic":r.includes("oblique")&&(e="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:e,weight:i}}function vKe(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function Jj(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=Jj(e);if(i!=null)return i}break;case"CIMTextSymbol":return Jj(t.symbol);case"CIMSolidFill":return t.color}return null}function Zj(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const i of e){const r=Zj(i);if(r!=null)return r}break}case"CIMTextSymbol":return Zj(t.symbol);case"CIMSolidStroke":return t.color}}function Kj(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=Kj(e);if(i!==void 0)return i}break;case"CIMTextSymbol":return Kj(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function bKe(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function wKe(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function Y_e(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const _Ke=t=>t.includes("data:image/svg+xml");function SKe(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function L8(t){return t&&t.charAt(0).toLowerCase()+t.substring(1)}function xKe(t,e,i,r,n,o){const{infos:u}=o;let p=1,g=0,w=0,S=0;for(const{offsetX:C,offsetY:L,rotation:R,size:F,frameHeight:V,rotateClockWise:U}of u)w=Qj(C,L,g,p,w),S=Xj(C,L,g,p,S),V&&(p*=F/V),g=eV(R,U,g);const T=Qj(r,n,g,p,w),E=Xj(r,n,g,p,S);return{size:t*p,rotation:eV(e,i,g),offsetX:T,offsetY:E}}function X_e(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>X_e(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function $Ke(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...q_e[e]];const i=uA[t];if(!i)throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function Q_e(t){return t!=null&&t.dashTemplate&&typeof t.dashTemplate=="string"&&(t.dashTemplate=t.dashTemplate.split(" ").map(Number)),t}function cA(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const i of e)if(i.type==="CIMVectorMarker")return cA(i)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const i of e)if(i.symbol)return cA(i.symbol)}}return"Normal"}function TKe(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const r=i.size??uA.CIMVectorMarker.size;r>e&&(e=r);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const r=i.width;r!=null&&r>e&&(e=r);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&uM(i.markerPlacement)){const r=i.size??uA.CIMVectorMarker.size;r>e&&(e=r)}break;case"CIMPictureFill":{const r=i.height;r!=null&&r>e&&(e=r)}}}return e}}}function hee(t,e){if(e!==null){const i=e.get(t);return i?i.name:t}return t}function e2e(t){return t.map(e=>({...e,propertyName:L8(e.propertyName)}))}function Yj(t){const e={};for(const i in t){const r=t[i];e[L8(i)]=r}return e}function Xj(t,e,i,r,n){const o=i*Math.PI/180;if(o){const u=Math.cos(o);return(Math.sin(o)*t+u*e)*r+n}return e*r+n}function Qj(t,e,i,r,n){const o=i*Math.PI/180;return o?(Math.cos(o)*t-Math.sin(o)*e)*r+n:t*r+n}function eV(t,e,i){return e?i-t:i+t}function EKe(t){return t?{originPosition:t.originPosition==="upper-left"?"upperLeft":t.originPosition==="lower-left"?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:t.extent!=null?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}:null}function t2e(t){return t.originPosition==="lowerLeft"&&t.scale.length===4&&t.translate.length===4}function gS(t){if(t2e(t))return t;const{originPosition:e,scale:i,translate:r}=t,n=i[0]??1,o=i[1]??1;return{originPosition:"lowerLeft",scale:[n,e==="lowerLeft"?o:-o,i[2]??1,i[3]??1],translate:[r[0]??0,r[1]??0,r[2]??0,r[3]??0]}}function i2e({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function r2e({scale:t,translate:e},i){return Math.round((i-e[1])/t[1])}function n2e({scale:t,translate:e},i){return Math.round(((i??0)-e[2])/t[2])}function s2e({scale:t,translate:e},i){return i?Math.round((i-e[3])/t[3]):0}function vS({scale:t,translate:e},i){return i*t[0]+e[0]}function bS({scale:t,translate:e},i){return i*t[1]+e[1]}function b3({scale:t,translate:e},i){return(i??0)*t[2]+e[2]}function w3({scale:t,translate:e},i){return i?i*t[3]+e[3]:0}function O8(t,e){return t&&e?u2e:t&&!e?a2e:!t&&e?l2e:o2e}const o2e=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=vS(t,r[0]),o=bS(t,r[1]);i[0]=[n,o];const{scale:u,originPosition:p}=t,g=u[0],w=p==="lowerLeft"?u[1]:-u[1];for(let S=1;S<e.length;S++){const[T,E]=e[S];n+=g*T,o+=w*E,i[S]=[n,o]}return i},a2e=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=vS(t,r[0]),o=bS(t,r[1]);i[0]=[n,o,b3(t,r[2])];const{scale:u,originPosition:p}=t,g=u[0],w=p==="lowerLeft"?u[1]:-u[1];for(let S=1;S<e.length;S++){const[T,E,C]=e[S];n+=g*T,o+=w*E,i[S]=[n,o,b3(t,C)]}return i},l2e=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=vS(t,r[0]),o=bS(t,r[1]);i[0]=[n,o,w3(t,r[2])];const{scale:u,originPosition:p}=t,g=u[0],w=p==="lowerLeft"?u[1]:-u[1];for(let S=1;S<e.length;S++){const[T,E,C]=e[S];n+=g*T,o+=w*E,i[S]=[n,o,w3(t,C)]}return i},u2e=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const r=e[0];let n=vS(t,r[0]),o=bS(t,r[1]);i[0]=[n,o,b3(t,r[2]),w3(t,r[3])];const{scale:u,originPosition:p}=t,g=u[0],w=p==="lowerLeft"?u[1]:-u[1];for(let S=1;S<e.length;S++){const[T,E,C,L]=e[S];n+=g*T,o+=w*E,i[S]=[n,o,b3(t,C),w3(t,L)]}return i};function pee(t,e,i){const r=new Array(i.length);for(let n=0;n<i.length;n++)r[n]=e(t,i[n]);return r}function IKe(t,e,i){const r=gS(t);return e.x=i2e(r,i.x),e.y=r2e(r,i.y),i.z!=null&&(e.z=n2e(r,i.z)),i.m!=null&&(e.m=s2e(r,i.m)),e}function c2e(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const o=gS(t);e.points=O8(r,n)(o,i.points),e.hasZ=r,e.hasM=n}return e}function h2e(t,e,i,r=(i==null?void 0:i.z)!=null,n=(i==null?void 0:i.m)!=null){if(i==null)return e;const o=gS(t);return e.x=vS(o,i.x),e.y=bS(o,i.y),r&&(e.z=b3(o,i.z)),n&&(e.m=w3(o,i.m)),e}function p2e(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const o=gS(t);e.rings=pee(o,O8(r,n),i.rings),e.hasZ=r,e.hasM=n}return e}function d2e(t,e,i,r=(i==null?void 0:i.hasZ)??!1,n=(i==null?void 0:i.hasM)??!1){if(i!=null){const o=gS(t);e.paths=pee(o,O8(r,n),i.paths),e.hasZ=r,e.hasM=n}return e}function f2e(t,e,i,r,n){if(t==null)return null;const o=t.referencesGeometry()&&n?y2e(e,r,n):e,u=t.repurposeFeature(o);try{return t.evaluate({...i,$feature:u},t.services)}catch(p){return fe.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",p),null}}const z9=new Map;function y2e(t,e,i){const{transform:r,hasZ:n,hasM:o}=i;z9.has(e)||z9.set(e,m2e(e));const u=z9.get(e)(t.geometry,r,n,o);return{...t,geometry:u}}function m2e(t){const e={};switch(t){case"esriGeometryPoint":return(i,r,n,o)=>h2e(r,e,i,n,o);case"esriGeometryPolygon":return(i,r,n,o)=>p2e(r,e,i,n,o);case"esriGeometryPolyline":return(i,r,n,o)=>d2e(r,e,i,n,o);case"esriGeometryMultipoint":return(i,r,n,o)=>c2e(r,e,i,n,o);default:return fe.getLogger("esri.views.2d.support.arcadeOnDemand").error(new re("mapview-arcade",`Unable to handle geometryType: ${t}`)),i=>i}}const g2e=t=>{if(!t)return[0,0,0,0];const{r:e,g:i,b:r,a:n}=t;return[e,i,r,255*n]};let dee=class _r{static findApplicableOverrides(e,i,r){if(e&&i){if(e.primitiveName){let n=!1;for(const o of r)if(o.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const o of i)o.primitiveName===e.primitiveName&&r.push(o)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)_r.findApplicableOverrides(n,i,r);if(e.symbolLayers)for(const n of e.symbolLayers)_r.findApplicableOverrides(n,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)_r.findApplicableOverrides(n,i,r);if(e.markerPlacement&&_r.findApplicableOverrides(e.markerPlacement,i,r),e.type==="CIMVectorMarker"){if(e.markerGraphics)for(const n of e.markerGraphics)_r.findApplicableOverrides(n,i,r),_r.findApplicableOverrides(n.symbol,i,r)}else e.type==="CIMCharacterMarker"?_r.findApplicableOverrides(e.symbol,i,r):e.type==="CIMHatchFill"?_r.findApplicableOverrides(e.lineSymbol,i,r):e.type==="CIMPictureMarker"&&_r.findApplicableOverrides(e.animatedSymbolProperties,i,r)}}}static findEffectOverrides(e,i){if(!e)return null;if(e.type==="CIMGeometricEffectDashes"&&Q_e(e),!i||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=Yj(e),n=e.primitiveName,o=[];for(const u of i)u.primitiveName===n&&o.push(Yj(u));return{type:"cim-effect-param",effect:r,overrides:e2e(o)}}static async resolveSymbolOverrides(e,i,r,n,o,u,p){if(!(e!=null&&e.symbol))return null;let{symbol:g,primitiveOverrides:w}=e;const S=!!w;if(!S&&!n)return g;g=ae(g),w=ae(w);let T=!0;if(i||(i={attributes:{}},T=!1),S){if(T||(w=w.filter(E=>{var C;return!((C=E.valueExpressionInfo)!=null&&C.expression.includes("$feature"))})),p||(w=w.filter(E=>{var C;return!((C=E.valueExpressionInfo)!=null&&C.expression.includes("$view"))})),w.length>0){const E={spatialReference:r,fields:Y_e(i.attributes),geometryType:o};await _r.createRenderExpressions(w,E),_r.evaluateOverrides(w,i,o??"esriGeometryPoint",u,p)}_r.applyOverrides(g,w)}return n&&_r.applyDictionaryTextOverrides(g,i,n,null),g}static async createRenderExpressions(e,i){const r=[];for(const n of e){const o=n.valueExpressionInfo;if(!o||_r._expressionToRenderExpression.has(o.expression))continue;const u=pve(o.expression,i.spatialReference,i.fields);r.push(u),u.then(p=>_r._expressionToRenderExpression.set(o.expression,p))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,i,r,n,o){const u={$view:{scale:o==null?void 0:o.scale}};for(const p of e){p.value&&typeof p.value=="object"&&QQ(p.value)&&(p.propertyName==="Color"||p.propertyName==="StrokeColor")&&(p.value=g2e(p.value));const g=p.valueExpressionInfo;if(!g)continue;const w=_r._expressionToRenderExpression.get(g.expression);w&&(p.value=f2e(w,i,u,r,n))}}static applyDictionaryTextOverrides(e,i,r,n,o="Normal"){if(e!=null&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const u=e.symbolLayers;if(!u)return;for(const p of u)p&&p.type==="CIMVectorMarker"&&_r.applyDictionaryTextOverrides(p,i,r,n,e.type==="CIMTextSymbol"?e.textCase:o)}break;case"CIMVectorMarker":{const u=e.markerGraphics;if(!u)return;for(const p of u)p&&_r.applyDictionaryTextOverrides(p,i,r,n)}break;case"CIMMarkerGraphic":{const u=e.textString;if(u&&u.includes("[")){const p=J_e(u,r);e.textString=Z_e(i,p,n,o)}}}}static applyOverrides(e,i,r,n){if(e.primitiveName){for(const o of i)if(o.primitiveName===e.primitiveName){const u=L8(o.propertyName);if(n&&n.push({cim:e,nocapPropertyName:u,value:e[u]}),r){let p=!1;for(const g of r)g.primitiveName===e.primitiveName&&(p=!0);p||r.push(o)}o.value!=null&&(e[u]=o.value)}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)_r.applyOverrides(o,i,r,n);if(e.symbolLayers)for(const o of e.symbolLayers)_r.applyOverrides(o,i,r,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)_r.applyOverrides(o,i,r,n);if(e.type==="CIMVectorMarker"&&e.markerGraphics)for(const o of e.markerGraphics)_r.applyOverrides(o,i,r,n),_r.applyOverrides(o.symbol,i,r,n)}}static restoreOverrides(e){for(const i of e)i.cim[i.nocapPropertyName]=i.value}static buildOverrideKey(e){let i="";for(const r of e)r.value!==void 0&&(i+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return i}static toValue(e,i){if(e==="DashTemplate")return i.split(" ").map(r=>Number(r));if(e==="Color"){const r=new Ce(i).toRgba();return r[3]*=255,r}return i}};dee._expressionToRenderExpression=new Map;const tV="esri.renderers.support.DictionaryLoader",v2e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let fee=class{constructor(e,i,r){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new $8(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=i,this.fieldMap=r}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,i){var T;let r;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{r=await this._dictionaryPromise}catch(E){if(Cn(E))return this._dictionaryPromise=null,null}const n=(T=this._dictionaryVersion)==null?void 0:T.since(4,0),o={};if(this.fieldMap)for(const E of this._symbolFields){const C=hee(this.fieldMap[E],this._fieldIndex);if(C){const L=e.attributes[C];o[E]=n?L:L!=null?""+e.attributes[C]:""}else o[E]=""}let u=null;try{u=r==null?void 0:r(o,i)}catch{return null}if(!u||typeof u!="string"||u==="invalid")return null;const p=u.split(";"),g=[],w=[];for(const E of p)if(E)if(E.includes("po:")){const C=E.substr(3).split("|");if(C.length===3){const L=C[0],R=C[1];let F=C[2];if(R==="DashTemplate")F=F.split(" ").map(V=>Number(V));else if(R==="Color"){const V=new Ce(F).toRgba();F=[V[0],V[1],V[2],255*V[3]]}else F=Number(F);w.push({primitiveName:L,propertyName:R,value:F,defaultValue:null})}}else if(E.includes("|")){for(const C of E.split("|"))if(this._itemNames.has(C)){g.push(C);break}}else this._itemNames.has(E)&&g.push(E);const S=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point";return this._cimPartsToCIMSymbol(e,g,w,S,i)}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void fe.getLogger(tV).error("no valid URL!");const i=nt(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:r}]=await Promise.all([i,fh()]);if(!r)throw this._dictionaryPromise=null,new re("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:o,expression:u,itemsNames:p}=r,g=u;let w=!1;o&&(this._dictionaryVersion=PQ.parse(o),w=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(p),this._symbolFields=n.symbol;const S={};if(this.config){const C=this.config;for(const L in C)S[L]=C[L]}if(n.configuration)for(const C of n.configuration)S.hasOwnProperty(C.name)||(S[C.name]=C.value);const T=[];if(e!=null&&e.fields&&this.fieldMap)for(const C in this.fieldMap){const L=this.fieldMap[C],R=e.fields.filter(F=>F.name.toLowerCase()===(L==null?void 0:L.toLowerCase()));R.length>0&&T.push({...R[0],type:w?R[0].type:"esriFieldTypeString"})}T.length>0&&(this._fieldIndex=new RQ(T));const E=dve(g,e!=null?e.spatialReference:null,T,S).then(C=>{const L={scale:0};return(R,F)=>{if(C==null)return null;const V=C.repurposeFeature({geometry:null,attributes:R});return L.scale=F!=null?F.scale??void 0:void 0,C.evaluate({$feature:V,$view:L},C.services)}}).catch(C=>(fe.getLogger(tV).error("Creating dictionary expression failed:",C),null));return this._dictionaryPromise=E,E}async _cimPartsToCIMSymbol(e,i,r,n,o){const u=new Array(i.length);for(let w=0;w<i.length;w++)u[w]=this._getSymbolPart(i[w],o);let p=await Promise.all(u);const g=this.fieldMap;if(g){p=ae(p);for(const w of p)dee.applyDictionaryTextOverrides(w,e,g,this._fieldIndex,cA(w))}return new id({data:b2e(p,r,n)})}async _getSymbolPart(e,i){const r=this._symbolCache.get(e);if(r)return r;if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(u=>u.data);const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),o=nt(n,{responseType:"json",query:{f:"json"},...i});this._ongoingRequests.set(e,o),o.finally(()=>this._ongoingRequests.delete(e));try{const u=await o;return this._symbolCache.put(e,u.data),u.data}catch(u){throw u}}};function b2e(t,e,i){if(!t||t.length===0)return null;const r={...t[0]};if(t.length>1){r.symbolLayers=[];for(const n of t){const o=n;r.symbolLayers.unshift(...o.symbolLayers)}}return i&&(r.callout=v2e),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:e}}var hA;let fu=hA=class extends ew(rd){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new fee(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,r){r!=null&&r.origin||super.writeVisualVariables(t,e,i,r)}clone(){return new hA({config:ae(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:ae(this.fieldMap),url:ae(this.url),visualVariables:ae(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await Qs(t,e,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];e.has(r)&&t.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};m([b({type:fee})],fu.prototype,"_loader",null),m([b({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],fu.prototype,"config",void 0),m([b({type:Object,json:{write:!0}})],fu.prototype,"fieldMap",void 0),m([b({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],fu.prototype,"scaleExpression",void 0),m([Le("scaleExpression")],fu.prototype,"writeData",null),m([b({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],fu.prototype,"scaleExpressionTitle",void 0),m([b({type:String,json:{write:!0}})],fu.prototype,"url",void 0),m([Le("visualVariables")],fu.prototype,"writeVisualVariables",null),fu=hA=m([G("esri.renderers.DictionaryRenderer")],fu);const w2e=fu;var pA;let Zh=pA=class extends ye{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(fe.getLogger(this).error(".field: field must be a string value"),null):W3(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){var t;return new pA({color:(t=this.color)==null?void 0:t.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};m([b({type:Ce,json:{type:[Number],write:!0}})],Zh.prototype,"color",void 0),m([b({type:String,json:{write:!0}})],Zh.prototype,"field",void 0),m([Dt("field")],Zh.prototype,"castField",null),m([b({type:String,json:{write:!0}})],Zh.prototype,"label",void 0),m([b({type:String,json:{write:!0}})],Zh.prototype,"valueExpression",void 0),m([b({type:String,json:{write:!0}})],Zh.prototype,"valueExpressionTitle",void 0),Zh=pA=m([G("esri.renderers.support.AttributeColorInfo")],Zh);const yee=Zh;var dA;let PT=dA=class extends ye{constructor(){super(...arguments),this.unit=null}clone(){return new dA({unit:this.unit})}};m([b({type:String,json:{write:!0}})],PT.prototype,"unit",void 0),PT=dA=m([G("esri.renderers.support.DotDensityLegendOptions")],PT);const _2e=PT;var fA;let Ao=fA=class extends ew(rd){constructor(t){super(t),this.attributes=null,this.backgroundColor=new Ce([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new cn,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new na({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new fA({attributes:ae(this.attributes),backgroundColor:ae(this.backgroundColor),dotBlendingEnabled:ae(this.dotBlendingEnabled),dotShape:ae(this.dotShape),dotSize:ae(this.dotSize),dotValue:ae(this.dotValue),legendOptions:ae(this.legendOptions),outline:ae(this.outline),referenceScale:ae(this.referenceScale),seed:ae(this.seed),visualVariables:ae(this.visualVariables),authoringInfo:ae(this.authoringInfo)})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await Qs(t,e,i.valueExpression),i.field&&t.add(i.field)}};m([b({type:[yee],json:{write:!0}})],Ao.prototype,"attributes",void 0),m([b({type:Ce,json:{write:!0}})],Ao.prototype,"backgroundColor",void 0),m([b({type:Boolean,json:{write:!0}})],Ao.prototype,"dotBlendingEnabled",void 0),m([b({type:String,json:{write:!1}})],Ao.prototype,"dotShape",void 0),m([b({type:Number,json:{write:!0}})],Ao.prototype,"dotSize",void 0),m([b({type:_2e,json:{write:!0}})],Ao.prototype,"legendOptions",void 0),m([b({type:cn,json:{default:null,write:!0}})],Ao.prototype,"outline",void 0),m([b({type:Number,json:{write:!0}})],Ao.prototype,"dotValue",void 0),m([b({type:Number,json:{write:!0}})],Ao.prototype,"referenceScale",void 0),m([b({type:Number,json:{write:!0}})],Ao.prototype,"seed",void 0),m([ze({dotDensity:"dot-density"})],Ao.prototype,"type",void 0),Ao=fA=m([G("esri.renderers.DotDensityRenderer")],Ao);const S2e=Ao;var yA;let M_=yA=class extends ye{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new yA({color:this.color&&this.color.clone(),ratio:this.ratio})}};m([b({type:Ce,json:{type:[zt],default:null,write:!0}})],M_.prototype,"color",void 0),m([b({type:Number,json:{write:!0}})],M_.prototype,"ratio",void 0),M_=yA=m([G("esri.renderers.support.HeatmapColorStop")],M_);const C2=M_;let r1=class extends Gt(ye){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};m([b({type:String,json:{write:!0}})],r1.prototype,"minLabel",void 0),m([b({type:String,json:{write:!0}})],r1.prototype,"maxLabel",void 0),m([b({type:String,json:{write:!0}})],r1.prototype,"title",void 0),r1=m([G("esri.renderers.support.HeatmapLegendOptions")],r1);const P8=2.4;function x2e(t){return Jn(t*P8)}function $2e(t){return Zi(t)/P8}function T2e(t,e,i,r){let{color:n,ratio:o}=e,{color:u,ratio:p}=i;p===o&&(p===1?o-=1e-6:p+=1e-6);const g=An((r-o)/(p-o),0,1);k8(t,n.toArray(),u.toArray(),g)}function CKe(t){const i=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:p})=>p>=0&&p<=1).sort((p,g)=>p.ratio-g.ratio).map(({color:p,ratio:g})=>({color:p,ratio:Math.max(g,.001)})),t.length<1)return i;let r=t[0],n=t[0],o=1;const u=$h();for(let p=0;p<512;p++){const g=(p+.5)/512;for(;g>n.ratio&&o<t.length;)r=n,n=t[o++];T2e(u,r,n,g),i.set(u,4*p)}return i}function AKe(t,e,i){const r=Math.sqrt(t**2+e**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function LKe(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var mA;function iV(t){if(t!=null){const{maxDensity:e,minDensity:i,radius:r}=t;if(e!=null||i!=null||r!=null){const{blurRadius:n,maxPixelIntensity:o,minPixelIntensity:u,...p}=t;return p}}return t}let Xn=mA=class extends rd{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new C2({ratio:0,color:new Ce("rgba(255, 140, 0, 0)")}),new C2({ratio:.75,color:new Ce("rgba(255, 140, 0, 1)")}),new C2({ratio:.9,color:new Ce("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(t){return iV(t)}get blurRadius(){return $2e(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",x2e(t)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(P8**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(t,e){this._warnedProps[t]||So(this).getDefaultOrigin()==="user"&&(this._warnedProps[t]=!0,jb(()=>{wo(fe.getLogger(this),t,{replacement:`${String(e)} (suggested value: ${this._get(e)})`,version:"4.24"})}))}read(t,e){t=iV(t),super.read(t,e)}getSymbol(){return new kn}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,r=this.valueExpression;i&&typeof i=="string"&&_o(t,e,i),r&&typeof r=="string"&&await Qs(t,e,r)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new mA({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:ae(this.colorStops),field:this.field,legendOptions:ae(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};m([b({type:b8,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Xn.prototype,"authoringInfo",void 0),m([b({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Xn.prototype,"blurRadius",null),m([b({type:[C2],json:{write:!0}})],Xn.prototype,"colorStops",void 0),m([b({type:String,json:{write:!0}})],Xn.prototype,"field",void 0),m([b({type:r1,json:{write:!0}})],Xn.prototype,"legendOptions",void 0),m([b({type:Number,json:{write:!0}})],Xn.prototype,"maxDensity",void 0),m([b({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Xn.prototype,"maxPixelIntensity",null),m([b({type:Number,json:{write:!0}})],Xn.prototype,"minDensity",void 0),m([b({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Xn.prototype,"minPixelIntensity",null),m([b({type:Number,cast:Wt,json:{write:!0}})],Xn.prototype,"radius",void 0),m([b({type:Number,range:{min:0},json:{default:0,write:!0}})],Xn.prototype,"referenceScale",void 0),m([ze({heatmap:"heatmap"})],Xn.prototype,"type",void 0),m([b({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Xn.prototype,"valueExpression",void 0),m([b({type:String})],Xn.prototype,"valueExpressionTitle",void 0),m([b({readOnly:!0})],Xn.prototype,"_pixelIntensityToDensity",null),Xn=mA=m([G("esri.renderers.HeatmapRenderer")],Xn);const mee=Xn;let qy=class extends Gt(ye){constructor(){super(...arguments),this.color=new Ce([0,0,0,0]),this.label=null,this.threshold=0}};m([b({type:Ce,json:{write:!0}})],qy.prototype,"color",void 0),m([b({type:String,json:{write:!0}})],qy.prototype,"label",void 0),m([b({type:Number,range:{min:0,max:1},json:{write:!0}})],qy.prototype,"threshold",void 0),qy=m([G("esri.renderers.support.OthersCategory")],qy);let RT=class extends Gt(ye){constructor(){super(...arguments),this.title=null}};m([b({type:String,json:{write:!0}})],RT.prototype,"title",void 0),RT=m([G("esri.renderers.support.PieChartLegendOptions")],RT);let ga=class extends ew(Gt(rd)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new Ce([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new qy,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){var e;return new kn({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Rt)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,i)=>e+i.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,i)=>e+JSON.stringify(i),"")}async collectRequiredFields(e,i){await this.collectVVRequiredFields(e,i);for(const r of this.attributes)r.valueExpression&&await Qs(e,i,r.valueExpression),r.field&&e.add(r.field)}};m([b({type:[yee],json:{write:!0}})],ga.prototype,"attributes",void 0),m([b({type:na,json:{default:null,write:!0}})],ga.prototype,"backgroundFillSymbol",void 0),m([b({type:Ce,json:{write:!0}})],ga.prototype,"defaultColor",void 0),m([b({type:String,json:{write:!0}})],ga.prototype,"defaultLabel",void 0),m([b({type:Number,range:{min:0,max:1},json:{write:!0}})],ga.prototype,"holePercentage",void 0),m([b({type:qy,json:{write:!0}})],ga.prototype,"othersCategory",void 0),m([b({type:RT,json:{write:!0}})],ga.prototype,"legendOptions",void 0),m([b({type:cn,json:{default:null,write:!0}})],ga.prototype,"outline",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],ga.prototype,"size",void 0),m([ze({pieChart:"pie-chart"})],ga.prototype,"type",void 0),ga=m([G("esri.renderers.PieChartRenderer")],ga);const E2e=ga;var gA;let uy=gA=class extends ew(rd){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map(i=>i.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new gA({description:this.description,label:this.label,symbol:ae(this.symbol),visualVariables:ae(this.visualVariables),authoringInfo:ae(this.authoringInfo)})}};m([b({type:String,json:{write:!0}})],uy.prototype,"description",void 0),m([b({type:String,json:{write:!0}})],uy.prototype,"label",void 0),m([b(x8)],uy.prototype,"symbol",void 0),m([ze({simple:"simple"})],uy.prototype,"type",void 0),uy=gA=m([G("esri.renderers.SimpleRenderer")],uy);const tw=uy,I2e=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function vA(t){return t instanceof Te}function rV(t){return t instanceof Ie?Object.keys(t.items):vA(t)?So(t).keys():t?Object.keys(t):[]}function xx(t,e){return t instanceof Ie?t.items[e]:t[e]}function M2e(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function A2(t){return t?t.declaredClass:null}function gee(t,e){var T;const i=t.diff;if(i&&typeof i=="function")return i(t,e);const r=rV(t),n=rV(e);if(r.length===0&&n.length===0)return;if(!r.length||!n.length||M2e(t,e))return{type:"complete",oldValue:t,newValue:e};const o=n.filter(E=>!r.includes(E)),u=r.filter(E=>!n.includes(E)),p=r.filter(E=>n.includes(E)&&xx(t,E)!==xx(e,E)).concat(o,u).sort(),g=A2(t);if(g&&I2e.has(g)&&p.length)return{type:"complete",oldValue:t,newValue:e};let w;const S=vA(t)&&vA(e);for(const E of p){const C=xx(t,E),L=xx(e,E);let R;if((S||typeof C!="function"&&typeof L!="function")&&C!==L&&(C!=null||L!=null)){if(i&&i[E]&&typeof i[E]=="function")R=(T=i[E])==null?void 0:T.call(i,C,L);else if(C instanceof Date&&L instanceof Date){if(C.getTime()===L.getTime())continue;R={type:"complete",oldValue:C,newValue:L}}else R=typeof C=="object"&&typeof L=="object"&&A2(C)===A2(L)?gee(C,L):{type:"complete",oldValue:C,newValue:L};R!=null&&(w!=null?w.diff[E]=R:w={type:"partial",diff:{[E]:R}})}}return w}function FKe(t,e){return k2e(t,e)}function k2e(t,e){if(t==null)return!1;const i=e.split(".");let r=t;for(const n of i){if(r.type==="complete")return!0;if(r.type!=="partial")return!1;{const o=r.diff[n];if(!o)return!1;r=o}}return!0}function NKe(t,e){if(!t)return!1;if(t.type==="partial"){const i=Object.keys(t.diff);return i.length===1&&i[0]===e}return!1}function vee(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&A2(t)!==A2(e)?{type:"complete",oldValue:t,newValue:e}:gee(t,e)}function $x(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const i of e.added)if(!$x(i))return!1;for(const i of e.removed)if(!$x(i))return!1;for(const i of e.changed)if(!$x(i))return!1;return!0}case"partial":for(const e in t.diff)if(!$x(t.diff[e]))return!1;return!0}}let n1=class extends Gt(ye){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};m([b(CT)],n1.prototype,"value",void 0),m([b(CT)],n1.prototype,"value2",void 0),m([b(CT)],n1.prototype,"value3",void 0),n1=m([G("esri.renderers.support.UniqueValue")],n1);const Cv=n1;let Bd=class extends Gt(ye){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const i=typeof(e=Array.isArray(e)?e:[e])[0];return i==="string"||i==="number"?e.map(r=>new Cv({value:r})):i==="object"?e[0]instanceof Cv?e:e.map(r=>new Cv(r)):null}};m([b({type:String,json:{write:!0}})],Bd.prototype,"description",void 0),m([b({type:String,json:{write:!0}})],Bd.prototype,"label",void 0),m([b(oM)],Bd.prototype,"symbol",void 0),m([b({type:[Cv],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new Cv({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const i=[];for(const r of t){const n=[r.value,r.value2,r.value3].filter(Rt).map(o=>o.toString());i.push(n)}e.values=i}}}})],Bd.prototype,"values",void 0),m([Dt("values")],Bd.prototype,"castValues",null),Bd=m([G("esri.renderers.support.UniqueValueClass")],Bd);const bee=Bd;let k_=class extends Gt(ye){constructor(e){super(e),this.heading=null,this.classes=null}};m([b({type:String,json:{write:!0}})],k_.prototype,"heading",void 0),m([b({type:[bee],json:{write:!0}})],k_.prototype,"classes",void 0),k_=m([G("esri.renderers.support.UniqueValueGroup")],k_);const bA=k_;var wA;let cy=wA=class extends ye{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new wA({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var e;const t=JSON.stringify((e=this.symbol)==null?void 0:e.toJSON());return`${this.value}.${t}`}};m([b({type:String,json:{write:!0}})],cy.prototype,"description",void 0),m([b({type:String,json:{write:!0}})],cy.prototype,"label",void 0),m([b(x8)],cy.prototype,"symbol",void 0),m([b(CT)],cy.prototype,"value",void 0),cy=wA=m([G("esri.renderers.support.UniqueValueInfo")],cy);const L2=cy,C2e=()=>!!me("enable-feature:force-wosr"),A2e=()=>me.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),L2e=()=>me.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),O2e=()=>!!me("enable-i3s-patching"),P2e=()=>me.add("enable-i3s-patching",!0,!0,!0),R2e=()=>me.add("enable-i3s-patching",!1,!0,!0),F2e=()=>!!me("enable-feature:SceneLayer-editing"),N2e=(t="i3s-patching")=>{switch(R2e(),L2e(),me.add("enable-feature:SceneLayer-editing",!0,!0,!0),t){case"feature-layer-view":A2e();break;case"i3s-patching":P2e()}};N2e("i3s-patching");let U9={};async function D2e(t,e){try{return{data:(await R8(t,e)).data,baseUrl:iP(t),styleUrl:t}}catch(i){return Ra(i),null}}function j2e(t,e,i){var u;const r=e.portal!=null?e.portal:wr.getDefault();let n;const o=`${r.url} - ${(u=r.user)==null?void 0:u.username} - ${t}`;return U9[o]||(U9[o]=V2e(t,r,i).then(p=>(n=p,p.fetchData())).then(p=>({data:p,baseUrl:n.itemUrl??"",styleName:t}))),U9[o]}function V2e(t,e,i){return e.load(i).then(()=>{const r=new Ml({disableExtraQuery:!0,query:`owner:${nV} AND type:${sV} AND typekeywords:"${t}"`});return e.queryItems(r,i)}).then(({results:r})=>{var u;let n=null;const o=t.toLowerCase();if(r&&Array.isArray(r)){for(const p of r)if(((u=p.typeKeywords)==null?void 0:u.some(w=>w.toLowerCase()===o))&&p.type===sV&&p.owner===nV){n=p;break}}if(!n)throw new re("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)})}function wee(t,e,i){return(t==null?void 0:t.styleUrl)!=null?D2e(t.styleUrl,i):(t==null?void 0:t.styleName)!=null?j2e(t.styleName,e,i):Promise.reject(new re("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function _ee(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function z2e(t,e,i=["gltf"]){if(e==="cimRef")return encodeURI(t.cimRef);if(t.formatInfos&&!C2e())for(const r of i){const n=t.formatInfos.find(o=>o.type===r);if(n)return n.href}return encodeURI(t.webRef)}function R8(t,e){const i={responseType:"json",query:{f:"json"},...e};return nt(ws(t),i)}const nV="esri_en",sV="Style",U2e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var C_;const See="esri.renderers.UniqueValueRenderer",vd=()=>fe.getLogger(See),oV="uvInfos-watcher",aV="uvGroups-watcher",G2e=",",B2e=Yi(L2);function q2e(t){const{field1:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueInfos:o,valueExpression:u}=t,p=!(!e||!i);return[{classes:(o??[]).map(g=>{var V;const{symbol:w,label:S,value:T,description:E}=g,[C,L,R]=p?((V=T==null?void 0:T.toString())==null?void 0:V.split(n||""))||[]:[T],F=[];return(e||u)&&F.push(C),i&&F.push(L),r&&F.push(R),{symbol:w,label:S,values:[F],description:E}})}]}let fr=C_=class extends ew(rd){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,i){if(!e&&!i)return;if(!e||!i)return{type:"complete",oldValue:e,newValue:i};let r=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let o=0;o<i.length;o++){const u=e.find(p=>p.value===i[o].value);u?vee(u,i[o])?(n.changed.push({type:"complete",oldValue:u,newValue:i[o]}),r=!0):n.unchanged.push({oldValue:u,newValue:i[o]}):(n.added.push(i[o]),r=!0)}for(let o=0;o<e.length;o++)i.find(u=>u.value===e[o].value)||(n.removed.push(e[o]),r=!0);return r?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:W3(t)}writeField(t,e,i,r){typeof t=="string"?e[i]=t:r!=null&&r.messages?r.messages.push(new re("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):vd().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||wr.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const r=t0(e.styleUrl,i);return Object.freeze({styleUrl:r})}}writeStyleOrigin(t,e,i,r){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=Q3(t.styleUrl,r))}set uniqueValueGroups(t){this.styleOrigin?vd().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?vd().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var r;if(this.styleOrigin)return void vd().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof t=="object"?B2e(t):new L2({value:t,symbol:cQ(e)}),(r=this.uniqueValueInfos)==null||r.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void vd().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let i=0;i<e.length;i++){const r=e[i];if(String(r.value)===String(t)){delete this._valueInfoMap[t],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await fh()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void vd().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return(i==null?void 0:i.symbol)||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(i==null?void 0:i.arcade)==null){const n=await fh(),{arcadeUtils:o}=n;o.hasGeometryOperations(this.valueExpression)&&await o.enableGeometryOperations(),i={...i,arcade:n}}const r=this._getUniqueValueInfo(t,i);return(r==null?void 0:r.symbol)||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){var r;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=(r=this.uniqueValueInfos)==null?void 0:r.reduce((n,o)=>n+o.getMeshHash(),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new C_({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:ae(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:ae(this.visualVariables),legendOptions:ae(this.legendOptions),authoringInfo:ae(this.authoringInfo),backgroundFillSymbol:ae(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=ae(this.uniqueValueInfos),i=ae(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(ae(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),Qs(t,e,this.valueExpression)];_o(t,e,this.field),_o(t,e,this.field2),_o(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return wee(this.styleOrigin,{portal:this.portal}).then(t=>{var i;const e=[];return this._valueInfoMap={},t!=null&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const n=new Km({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const o=new L2({value:r.name,symbol:n});e.push(o),this._valueInfoMap[r.name]=o}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)!=null&&i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",G2e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[e.value+""]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(oV);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(ce(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(r,n)=>{r!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,oV)}}_watchUniqueValueGroups(){this.removeHandles(aV);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(ce(()=>({classes:i.classes}),(r,n)=>{r!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const r of i.classes??[])e.push(ce(()=>({symbol:r.symbol,values:r.values,label:r.label,description:r.description}),(n,o)=>{n!==o&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,aV)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueGroups:o,valueExpression:u}=this;if(!e&&!u)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const p=!(!e||!i);for(const g of o)for(const w of g.classes??[]){const{symbol:S,label:T,values:E,description:C}=w;for(const L of E??[]){const{value:R,value2:F,value3:V}=L,U=[R];i&&U.push(F),r&&U.push(V);const W=p?U.join(n||""):U[0]??void 0;t.push(new L2({symbol:S,label:T,value:W,description:C}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:r,fieldDelimiter:n,uniqueValueInfos:o}=this;if(!e&&!r||!o.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const u=!(!e||!i),p=o.map(w=>{var V;const{symbol:S,label:T,value:E,description:C}=w,[L,R,F]=u?((V=E==null?void 0:E.toString())==null?void 0:V.split(n||""))||[]:[E];return new bee({symbol:S,label:T,description:C,values:[new Cv({value:L,value2:R,value3:F})]})}),g=[new bA({classes:p})];t&&Object.freeze(g),this._set("uniqueValueGroups",g),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:o,timeZone:u}=e??{};let p=this._cache.compiledFunc;const g=o.arcadeUtils;if(!p){const S=g.createSyntaxTree(this.valueExpression);p=g.createFunction(S),this._cache.compiledFunc=p}const w=g.executeFunction(p,g.createExecContext(t,g.getViewInfo({viewingMode:i,scale:r,spatialReference:n}),u));return this._valueInfoMap[w+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let r;if(this.field2){const n=this.field2,o=this.field3,u=[];e&&u.push(i[e]),n&&u.push(i[n]),o&&u.push(i[o]),r=u.join(this.fieldDelimiter||"")}else e&&(r=i[e]);return this._valueInfoMap[r+""]}static fromPortalStyle(t,e){const i=new C_(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",(e==null?void 0:e.portal)||wr.getDefault());const r=i.populateFromStyle();return r.catch(n=>{vd().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",n)}),r}static fromStyleUrl(t,e){const i=new C_(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const r=i.populateFromStyle();return r.catch(n=>{vd().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),r}};m([b({readOnly:!0})],fr.prototype,"_cache",null),m([ze({uniqueValue:"unique-value"})],fr.prototype,"type",void 0),m([b(AQ)],fr.prototype,"backgroundFillSymbol",void 0),m([b({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],fr.prototype,"field",null),m([Dt("field")],fr.prototype,"castField",null),m([Le("field")],fr.prototype,"writeField",null),m([b({type:String,value:null,json:{write:!0}})],fr.prototype,"field2",null),m([b({type:String,value:null,json:{write:!0}})],fr.prototype,"field3",null),m([b({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],fr.prototype,"orderByClassesEnabled",void 0),m([b({type:String,value:null,json:{write:!0}})],fr.prototype,"valueExpression",null),m([b({type:String,json:{write:!0}})],fr.prototype,"valueExpressionTitle",void 0),m([b({type:kv,json:{write:!0}})],fr.prototype,"legendOptions",void 0),m([b({type:String,json:{write:!0}})],fr.prototype,"defaultLabel",void 0),m([b(D7({...oM},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],fr.prototype,"defaultSymbol",null),m([b({type:String,value:null,json:{write:!0}})],fr.prototype,"fieldDelimiter",null),m([b({type:wr,readOnly:!0})],fr.prototype,"portal",void 0),m([Me("portal",["styleName"])],fr.prototype,"readPortal",null),m([b({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],fr.prototype,"styleOrigin",void 0),m([Me("styleOrigin",["styleName","styleUrl"])],fr.prototype,"readStyleOrigin",null),m([Le("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],fr.prototype,"writeStyleOrigin",null),m([b({type:[bA],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||q2e(e)).map(r=>bA.fromJSON(r,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],fr.prototype,"uniqueValueGroups",null),m([b({type:[L2],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],fr.prototype,"uniqueValueInfos",null),fr=C_=m([G(See)],fr);const F8=fr,cM={key:"type",base:rd,typeMap:{heatmap:mee,simple:tw,"unique-value":F8,"class-breaks":OQ,"dot-density":S2e,dictionary:w2e,"pie-chart":E2e},errorContext:"renderer"},H2e={key:"type",base:rd,typeMap:{simple:tw,"unique-value":F8,"class-breaks":OQ,heatmap:mee},errorContext:"renderer",validate:W2e};function W2e(t){switch(t.type){case"simple":return J2e(t);case"unique-value":return Z2e(t);case"class-breaks":return K2e(t);case"heatmap":return t}}function J2e(t){if(t.symbol)return t;fe.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function Z2e(t){const e=t.uniqueValueInfos,i=e==null?void 0:e.filter(({symbol:r,label:n},o)=>(r||fe.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${o}] ${n}) without a symbol from web scene.`),!!r));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.uniqueValueInfos=i),t}function K2e(t){const e=t.classBreakInfos,i=e==null?void 0:e.filter(({symbol:r,label:n},o)=>(r||fe.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${o}] ${n}) without a symbol from web scene.`),!!r));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.classBreakInfos=i),t}function Y2e(t,e){return _3(t,null,e)}const X2e=zb({types:cM});function _3(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(i!=null&&i.messages&&i.messages.push(new Ul("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):X2e(t,e,i):null}const ss=(t=>t)(["operational-layers","basemap","ground"]);var _A;let hy=_A=class extends ye{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new _A({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};m([b({type:String,json:{write:!0}})],hy.prototype,"expression",void 0),m([b({type:String,json:{write:!0}})],hy.prototype,"name",void 0),m([b({type:["boolean","date","number","string"],json:{write:!0}})],hy.prototype,"returnType",void 0),m([b({type:String,json:{write:!0}})],hy.prototype,"title",void 0),hy=_A=m([G("esri.form.ExpressionInfo")],hy);const Q2e=hy;let py=class extends ye{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};m([b({type:String,json:{write:!0}})],py.prototype,"description",void 0),m([b({type:String,json:{write:!0}})],py.prototype,"label",void 0),m([b()],py.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],py.prototype,"visibilityExpression",void 0),py=m([G("esri.form.elements.Element")],py);const Rm=py;var SA;let FT=SA=class extends ye{constructor(t){super(t),this.type=null}clone(){return new SA({type:this.type})}};m([b({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],FT.prototype,"type",void 0),FT=SA=m([G("esri.form.elements.inputs.AttachmentInput")],FT);const e3e=FT;var xA;let dy=xA=class extends Rm{constructor(t){super(t),this.attachmentKeyword=null,this.editableExpression=null,this.input=null,this.type="attachment"}clone(){return new xA({attachmentKeyword:this.attachmentKeyword,description:this.description,editableExpression:this.editableExpression,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};m([b({type:String,json:{write:!0}})],dy.prototype,"attachmentKeyword",void 0),m([b({type:String,json:{write:!0}})],dy.prototype,"editableExpression",void 0),m([b({type:e3e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],dy.prototype,"input",void 0),m([b({type:["attachment"],json:{read:!1,write:!0}})],dy.prototype,"type",void 0),dy=xA=m([G("esri.form.elements.AttachmentElement")],dy);const lV=dy;let NT=class extends ye{constructor(e){super(e),this.type=null}};m([b()],NT.prototype,"type",void 0),NT=m([G("esri.form.elements.inputs.Input")],NT);const sd=NT;let A_=class extends sd{constructor(e){super(e),this.maxLength=null,this.minLength=0}};m([b({type:Number,json:{write:!0}})],A_.prototype,"maxLength",void 0),m([b({type:Number,json:{write:!0}})],A_.prototype,"minLength",void 0),A_=m([G("esri.form.elements.inputs.TextInput")],A_);const N8=A_;var $A;let DT=$A=class extends N8{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new $A({maxLength:this.maxLength,minLength:this.minLength})}};m([b({type:["barcode-scanner"],json:{read:!1,write:!0}})],DT.prototype,"type",void 0),DT=$A=m([G("esri.form.elements.inputs.BarcodeScannerInput")],DT);const t3e=DT;var TA;let s1=TA=class extends sd{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new TA({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};m([b({type:String,json:{write:!0}})],s1.prototype,"noValueOptionLabel",void 0),m([b({type:Boolean,json:{write:!0}})],s1.prototype,"showNoValueOption",void 0),m([b({type:["combo-box"],json:{read:!1,write:!0}})],s1.prototype,"type",void 0),s1=TA=m([G("esri.form.elements.inputs.ComboBoxInput")],s1);const i3e=s1;var EA;function uV(t){return t??null}function cV(t){return t??null}let Tc=EA=class extends sd{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return uV(e.max)}writeMax(t,e){e.max=cV(t)}readMin(t,e){return uV(e.min)}writeMin(t,e){e.min=cV(t)}clone(){return new EA({max:this.max,min:this.min})}};m([b({type:String,json:{type:String,write:!0}})],Tc.prototype,"max",void 0),m([Me("max")],Tc.prototype,"readMax",null),m([Le("max")],Tc.prototype,"writeMax",null),m([b({type:String,json:{type:String,write:!0}})],Tc.prototype,"min",void 0),m([Me("min")],Tc.prototype,"readMin",null),m([Le("min")],Tc.prototype,"writeMin",null),m([b({type:["date-picker"],json:{read:!1,write:!0}})],Tc.prototype,"type",void 0),Tc=EA=m([G("esri.form.elements.inputs.DatePickerInput")],Tc);const r3e=Tc;var IA;function G9(t){return t??null}function B9(t){return t??null}let Lo=IA=class extends sd{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return G9(e.max)}writeMax(t,e){e.max=B9(t)}readMin(t,e){return G9(e.min)}writeMin(t,e){e.min=B9(t)}readTimeResolution(t,e){return G9(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=B9(t)}clone(){return new IA({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};m([b({type:Boolean,json:{write:!0}})],Lo.prototype,"includeTimeOffset",void 0),m([b({type:String,json:{type:String,write:!0}})],Lo.prototype,"max",void 0),m([Me("max")],Lo.prototype,"readMax",null),m([Le("max")],Lo.prototype,"writeMax",null),m([b({type:String,json:{type:String,write:!0}})],Lo.prototype,"min",void 0),m([Me("min")],Lo.prototype,"readMin",null),m([Le("min")],Lo.prototype,"writeMin",null),m([b({type:String,json:{type:String,write:!0}})],Lo.prototype,"timeResolution",void 0),m([Me("timeResolution")],Lo.prototype,"readTimeResolution",null),m([Le("timeResolution")],Lo.prototype,"writeTimeResolution",null),m([b({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],Lo.prototype,"type",void 0),Lo=IA=m([G("esri.form.elements.inputs.DateTimeOffsetPickerInput")],Lo);const n3e=Lo;var MA;function hV(t){return t!=null?new Date(t):null}function pV(t){return t?t.getTime():null}let yu=MA=class extends sd{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return hV(e.max)}writeMax(t,e){e.max=pV(t)}readMin(t,e){return hV(e.min)}writeMin(t,e){e.min=pV(t)}clone(){return new MA({includeTime:this.includeTime,max:this.max,min:this.min})}};m([b({type:Boolean,json:{write:!0}})],yu.prototype,"includeTime",void 0),m([b({type:Date,json:{type:Number,write:!0}})],yu.prototype,"max",void 0),m([Me("max")],yu.prototype,"readMax",null),m([Le("max")],yu.prototype,"writeMax",null),m([b({type:Date,json:{type:Number,write:!0}})],yu.prototype,"min",void 0),m([Me("min")],yu.prototype,"readMin",null),m([Le("min")],yu.prototype,"writeMin",null),m([b({type:["datetime-picker"],json:{read:!1,write:!0}})],yu.prototype,"type",void 0),yu=MA=m([G("esri.form.elements.inputs.DateTimePickerInput")],yu);const s3e=yu;var kA;let o1=kA=class extends sd{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new kA({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};m([b({type:String,json:{write:!0}})],o1.prototype,"noValueOptionLabel",void 0),m([b({type:Boolean,json:{write:!0}})],o1.prototype,"showNoValueOption",void 0),m([b({type:["radio-buttons"],json:{read:!1,write:!0}})],o1.prototype,"type",void 0),o1=kA=m([G("esri.form.elements.inputs.RadioButtonsInput")],o1);const o3e=o1;var CA;let a1=CA=class extends sd{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new CA({offValue:this.offValue,onValue:this.onValue})}};m([b({type:[String,Number],json:{write:!0}})],a1.prototype,"offValue",void 0),m([b({type:[String,Number],json:{write:!0}})],a1.prototype,"onValue",void 0),m([b({type:["switch"],json:{read:!1,write:!0}})],a1.prototype,"type",void 0),a1=CA=m([G("esri.form.elements.inputs.SwitchInput")],a1);const a3e=a1;var AA;let jT=AA=class extends N8{constructor(t){super(t),this.type="text-area"}clone(){return new AA({maxLength:this.maxLength,minLength:this.minLength})}};m([b({type:["text-area"],json:{read:!1,write:!0}})],jT.prototype,"type",void 0),jT=AA=m([G("esri.form.elements.inputs.TextAreaInput")],jT);const l3e=jT;var LA;let VT=LA=class extends N8{constructor(t){super(t),this.type="text-box"}clone(){return new LA({maxLength:this.maxLength,minLength:this.minLength})}};m([b({type:["text-box"],json:{read:!1,write:!0}})],VT.prototype,"type",void 0),VT=LA=m([G("esri.form.elements.inputs.TextBoxInput")],VT);const u3e=VT;var OA;function q9(t){return t??null}function H9(t){return t??null}let va=OA=class extends sd{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return q9(e.max)}writeMax(t,e){e.max=H9(t)}readMin(t,e){return q9(e.min)}writeMin(t,e){e.min=H9(t)}readTimeResolution(t,e){return q9(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=H9(t)}clone(){return new OA({max:this.max,min:this.min,timeResolution:this.timeResolution})}};m([b({type:String,json:{type:String,write:!0}})],va.prototype,"max",void 0),m([Me("max")],va.prototype,"readMax",null),m([Le("max")],va.prototype,"writeMax",null),m([b({type:String,json:{type:String,write:!0}})],va.prototype,"min",void 0),m([Me("min")],va.prototype,"readMin",null),m([Le("min")],va.prototype,"writeMin",null),m([b({type:String,json:{type:String,write:!0}})],va.prototype,"timeResolution",void 0),m([Me("timeResolution")],va.prototype,"readTimeResolution",null),m([Le("timeResolution")],va.prototype,"writeTimeResolution",null),m([b({type:["time-picker"],json:{read:!1,write:!0}})],va.prototype,"type",void 0),va=OA=m([G("esri.form.elements.inputs.TimePickerInput")],va);const c3e=va,h3e={base:sd,key:"type",typeMap:{"barcode-scanner":t3e,"combo-box":i3e,"date-picker":r3e,"datetime-picker":s3e,"datetimeoffset-picker":n3e,"radio-buttons":o3e,switch:a3e,"text-area":l3e,"text-box":u3e,"time-picker":c3e}};var PA;let rm=PA=class extends ye{constructor(t){super(t),this.name=null,this.code=null}clone(){return new PA({name:this.name,code:this.code})}};m([b({type:String,json:{write:!0}})],rm.prototype,"name",void 0),m([b({type:[String,Number],json:{write:!0}})],rm.prototype,"code",void 0),rm=PA=m([G("esri.layers.support.CodedValue")],rm);const p3e=new et({inherited:"inherited",codedValue:"coded-value",range:"range"});let L_=class extends ye{constructor(e){super(e),this.name=null,this.type=null}};m([b({type:String,json:{write:!0}})],L_.prototype,"name",void 0),m([ze(p3e)],L_.prototype,"type",void 0),L_=m([G("esri.layers.support.Domain")],L_);const hM=L_;var RA;let O_=RA=class extends hM{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some(r=>(String(r.code)===i&&(e=r.name),!!e))}return e}clone(){return new RA({codedValues:ae(this.codedValues),name:this.name})}};m([b({type:[rm],json:{write:!0}})],O_.prototype,"codedValues",void 0),m([ze({codedValue:"coded-value"})],O_.prototype,"type",void 0),O_=RA=m([G("esri.layers.support.CodedValueDomain")],O_);const SE=O_;var FA;let zT=FA=class extends hM{constructor(t){super(t),this.type="inherited"}clone(){return new FA}};m([ze({inherited:"inherited"})],zT.prototype,"type",void 0),zT=FA=m([G("esri.layers.support.InheritedDomain")],zT);const xee=zT;var NA;let l1=NA=class extends hM{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new NA({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};m([b({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],l1.prototype,"maxValue",void 0),m([b({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[0]}},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],l1.prototype,"minValue",void 0),m([ze({range:"range"})],l1.prototype,"type",void 0),l1=NA=m([G("esri.layers.support.RangeDomain")],l1);const $ee=l1,Tee={key:"type",base:hM,typeMap:{range:$ee,"coded-value":SE,inherited:xee}};function pM(t){if(!(t!=null&&t.type))return null;switch(t.type){case"range":return $ee.fromJSON(t);case"codedValue":return SE.fromJSON(t);case"inherited":return xee.fromJSON(t)}return null}var DA;let al=DA=class extends Rm{constructor(t){super(t),this.domain=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}get editable(){return this._get("editable")??!0}set editable(t){this._set("editable",t)}clone(){return new DA({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};m([b({types:Tee,json:{read:{reader:pM},write:!0}})],al.prototype,"domain",void 0),m([b({type:Boolean,json:{write:!0}})],al.prototype,"editable",null),m([b({type:String,json:{write:!0}})],al.prototype,"editableExpression",void 0),m([b({type:String,json:{write:!0}})],al.prototype,"fieldName",void 0),m([b({type:String,json:{write:!0}})],al.prototype,"hint",void 0),m([b({types:h3e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],al.prototype,"input",void 0),m([b({type:String,json:{write:!0}})],al.prototype,"requiredExpression",void 0),m([b({type:String,json:{read:!1,write:!0}})],al.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],al.prototype,"valueExpression",void 0),al=DA=m([G("esri.form.elements.FieldElement")],al);const dV=al;var jA;let Kh=jA=class extends Rm{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new jA({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:ae(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};m([b({type:Number,json:{write:!0}})],Kh.prototype,"displayCount",void 0),m([b({type:["list"],json:{write:!0}})],Kh.prototype,"displayType",void 0),m([b({type:String,json:{write:!0}})],Kh.prototype,"editableExpression",void 0),m([b({type:[o8],json:{write:!0}})],Kh.prototype,"orderByFields",void 0),m([b({type:Number,json:{write:!0}})],Kh.prototype,"relationshipId",void 0),m([b({type:["relationship"],json:{read:!1,write:!0}})],Kh.prototype,"type",void 0),Kh=jA=m([G("esri.form.elements.RelationshipElement")],Kh);const fV=Kh;var VA;let u1=VA=class extends Rm{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new VA({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};m([b({type:String,json:{write:!0}})],u1.prototype,"text",void 0),m([b({type:String,json:{write:!0}})],u1.prototype,"textFormat",void 0),m([b({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],u1.prototype,"type",void 0),u1=VA=m([G("esri.form.elements.TextElement")],u1);const yV=u1;function Eee(t){return{typesWithGroup:{base:Rm,key:"type",typeMap:{attachment:lV,field:dV,group:t,relationship:fV,text:yV}},typesWithoutGroup:{base:Rm,key:"type",typeMap:{attachment:lV,field:dV,relationship:fV,text:yV}}}}function Iee(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function Mee(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>n.toJSON())}function kee(t,e,i=!0){return t?t.map(r=>ch(i?e.typesWithGroup:e.typesWithoutGroup,r)):null}var zA;let Wc=zA=class extends Rm{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return kee(t,W9,!1)}readElements(t,e){return Iee(e.formElements,W9,!1)}writeElements(t,e){e.formElements=Mee(t,W9,!1)}clone(){return new zA({description:this.description,elements:ae(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};m([b({json:{write:!0}})],Wc.prototype,"elements",void 0),m([Dt("elements")],Wc.prototype,"castElements",null),m([Me("elements",["formElements"])],Wc.prototype,"readElements",null),m([Le("elements")],Wc.prototype,"writeElements",null),m([b({type:["collapsed","expanded"],json:{write:!0}})],Wc.prototype,"initialState",void 0),m([b({type:String,json:{read:!1,write:!0}})],Wc.prototype,"type",void 0),Wc=zA=m([G("esri.form.elements.GroupElement")],Wc);const W9=Eee(Wc),d3e=Wc,D8=t=>t.type==="field",UA=t=>t.type==="group",Cee=t=>t.type==="text",f3e=t=>t.type==="relationship";var GA;const J9=Eee(d3e);let mu=GA=class extends ye{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return kee(t,J9)}readElements(t,e){return Iee(e.formElements,J9)}writeElements(t,e){e.formElements=Mee(t,J9)}clone(){return new GA({description:this.description,expressionInfos:ae(this.expressionInfos),elements:ae(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const i=new Set,{description:r,elements:n,expressionInfos:o,title:u}=this;if(O2(i,t,r),O2(i,t,u),!n)return[];const p=y3e(n,o).map(g=>Qs(i,t,g));await Promise.all(p);for(const g of n)Aee(i,{fieldsIndex:t,relationships:e},g);return Array.from(i).sort()}};function Aee(t,e,i){var n;const{fieldsIndex:r}=e;if(!r||r.fields.length!==t.size)switch(O2(t,r,i.label),O2(t,r,i.description),i.type){case"field":_o(t,r,i.fieldName);break;case"group":i.elements.forEach(o=>Aee(t,e,o));break;case"relationship":if(e.relationships){const o=e.relationships.find(u=>u.id===i.relationshipId);o&&_o(t,r,o.keyField)}Om(t,r,(n=i.orderByFields)==null?void 0:n.map(o=>o.field));break;case"text":O2(t,r,i.text)}}function y3e(t,e){if(!e||e.length===0)return[];const i=Lee(t),r=[];for(const n of e)i.has(n.name)&&r.push(n.expression);return r}function Lee(t){const e=new Set;for(const i of t)if(FN(e,i.visibilityExpression),!Cee(i)){if(UA(i))V5(e,Lee(i.elements));else if(FN(e,i.editableExpression),D8(i)){const{requiredExpression:r,valueExpression:n}=i;V5(e,[r,n])}}return e}function O2(t,e,i){Om(t,e,i8(i))}m([b({type:String,json:{write:!0}})],mu.prototype,"description",void 0),m([b({json:{write:!0}})],mu.prototype,"elements",void 0),m([Dt("elements")],mu.prototype,"castElements",null),m([Me("elements",["formElements"])],mu.prototype,"readElements",null),m([Le("elements")],mu.prototype,"writeElements",null),m([b({type:[Q2e],json:{write:!0}})],mu.prototype,"expressionInfos",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],mu.prototype,"preserveFieldValuesWhenHidden",void 0),m([b({type:String,json:{write:!0}})],mu.prototype,"title",void 0),mu=GA=m([G("esri.form.FormTemplate")],mu);const Oee=mu;let mb=class{constructor(e=i=>i.values().next().value){this._peeker=e,this._observable=new Gb,this._items=new Set}get length(){return He(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return He(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const i=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){He(this._observable),yield*this._items}};const Pee=new FinalizationRegistry(t=>{t.close()});function m3e(t,e){Pee.register(t,e,e)}function g3e(t){Pee.unregister(t)}function Ree(t,e){return new Proxy({},{get:(i,r,n)=>(...o)=>{let u,p;const g=o[o.length-1];return v3e(g)&&(u=g.signal,p=g.transferList,o.pop()),t.apply(e?`${e}.${r.toString()}`:r.toString(),o,{transferList:p,signal:u})}})}function v3e(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const b3e={statsWorker:()=>ie(()=>import("./statsWorker-kVOMbpxB.js"),__vite__mapDeps([18,19,20,21])),geometryEngineWorker:()=>ie(()=>import("./geometryEngineWorker-BB-8ztDN.js"),__vite__mapDeps([22,16,17])),CSVSourceWorker:()=>ie(()=>import("./CSVSourceWorker-MOzkYKIT.js"),__vite__mapDeps([23,24,17,13,14,25,12,15,26,27,28,29,30,31,32,33,19,20,21,11,34])),EdgeProcessingWorker:()=>ie(()=>import("./EdgeProcessingWorker-DkSGm1O8.js"),__vite__mapDeps([35,36,37,38,39,40,41,42,43,44,45,46,47])),ElevationSamplerWorker:()=>ie(()=>import("./ElevationSamplerWorker-Cbjg7Q8D.js"),__vite__mapDeps([48,27,49,50,51,52,53,54,38,55])),FeatureServiceSnappingSourceWorker:()=>ie(()=>import("./FeatureServiceSnappingSourceWorker-D-NdNC5S.js"),__vite__mapDeps([56,25,12,13,14,15,26,27,28,17,29,30,31,32,33,19,20,21,57,58,59,60])),GeoJSONSourceWorker:()=>ie(()=>import("./GeoJSONSourceWorker-D8hlEeU2.js"),__vite__mapDeps([61,12,13,14,15,25,26,27,28,17,29,30,31,32,33,19,20,21,62,24,34,63])),LercWorker:()=>ie(()=>import("./LercWorker-CMfN4kmZ.js"),[]),MemorySourceWorker:()=>ie(()=>import("./MemorySourceWorker-DOZFeeqZ.js"),__vite__mapDeps([64,12,13,14,15,65,25,26,27,28,17,29,30,31,32,33,19,20,21,34,63,24])),PBFDecoderWorker:()=>ie(()=>import("./PBFDecoderWorker-BnT79yel.js"),__vite__mapDeps([66,67,12,13,14,15,58,59])),FeaturePipelineWorker:()=>ie(()=>import("./FeaturePipelineWorker-BAv6nSr0.js"),__vite__mapDeps([68,69,70,71,72,45,73,74,46,75,76,77,40,78,79,80,81,14,82,83,30,12,13,15,28,17,84,85,86,87,88,89,90,29,31,32,33,19,20,21,60,58,59,91,62,24,34,63,92,93])),PointCloudWorker:()=>ie(()=>import("./PointCloudWorker-25Z40cNn.js"),__vite__mapDeps([94,95,96,97])),RasterWorker:()=>ie(()=>import("./RasterWorker-DEPt9zU_.js"),__vite__mapDeps([98,99,100,101,102])),SceneLayerSnappingSourceWorker:()=>ie(()=>import("./SceneLayerSnappingSourceWorker-ClUnr_Rn.js"),__vite__mapDeps([103,104,40,41,42,43,37,38,39,44,45,46,47])),SceneLayerWorker:()=>ie(()=>import("./SceneLayerWorker-9JQqpx_Z.js"),__vite__mapDeps([105,54,49,52,106,97,107,108,109,110,77])),WFSSourceWorker:()=>ie(()=>import("./WFSSourceWorker-C4y6K679.js"),__vite__mapDeps([111,12,13,14,15,25,26,27,28,17,29,30,31,32,33,19,20,21,62,24,63,112,113])),WorkerTileHandler:()=>ie(()=>import("./WorkerTileHandler-DArYwucC.js"),__vite__mapDeps([114,115,82,83,116,117,59,87,69,118,119,45,46,88,80])),Lyr3DWorker:()=>ie(()=>import("./Lyr3DWorker-DzC08EVF.js"),[])},Fee="worker:port-closed";var ns;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(ns||(ns={}));let w3e=0;function Nee(){return w3e++}function _3e(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function S3(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function j8(t,e,i,r){if(e.type===ns.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==ns.INVOKE&&e.type!==ns.RESPONSE)return void t.postMessage(e);let n;if(_3e(i)?(n=mV(i.transferList),e.data=i.result):(n=mV(r),e.data=i),n){if(me("ff")){for(const o of n)if("byteLength"in o&&o.byteLength>267386880){const u="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case ns.INVOKE:throw u;case ns.RESPONSE:return void j8(t,{type:ns.RESPONSE,jobId:e.jobId,error:S3(u)})}}}t.postMessage(e,n)}else t.postMessage(e)}function x3(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function mV(t){if(!(t!=null&&t.length))return null;if(me("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(i=>!S3e(i));return e.length?e:null}function S3e(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}async function HKe(t){try{return await t}catch(e){const i=(e==null?void 0:e.name)===Fee;if(!(Cn(e)||i))throw e;return}}const{CLOSE:gV,ABORT:vV,INVOKE:bV,RESPONSE:Sw,OPEN_PORT:wV,ON:x3e}=ns,$3e=2;let T3e=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===ns.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},r0=class c1{static connect(e,i){const r=new MessageChannel;let n;n=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const o=new c1(r.port1,{channel:r,client:n,schedule:i});return typeof n=="object"&&"remoteClient"in n&&(n.remoteClient=o),c1.clients.set(o,n),r.port2}static loadWorker(e){const i=b3e[e];return i?i():Promise.resolve(null)}constructor(e,i,r){this._port=e,this._jobQueue=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new T3e(n=>this._onInvokeMessage(n)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:gV}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,i,r){return this.apply(e,[i],r)}apply(e,i,r){const n=r==null?void 0:r.signal,o=r==null?void 0:r.transferList;if(!this._port)return Promise.reject(new re(Fee,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:i}));const u=Nee();return new Promise((p,g)=>{if(Xo(n))return this._processWork(),void g(ni());const w=Zo(n,()=>{const T=this._outJobs.get(u);T&&(this._outJobs.delete(u),this._processWork(),Vi(T.abortHandle),this._post({type:vV,jobId:u}),g(ni()))}),S={resolve:p,reject:g,abortHandle:w,debugInfo:e};this._outJobs.set(u,S),this._post({type:bV,jobId:u,methodName:e,abortable:n!=null},i,o)})}createInvokeProxy(e){return Ree(this,e)}on(e,i){const r=new MessageChannel;function n(o){i(o.data)}return this._port.postMessage({type:ns.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),We(()=>{r.port1.postMessage({type:ns.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:wV,port:e.port2}),e.port1}_processWork(){var u;if(this._outJobs.size>=$3e)return;const e=(u=this._jobQueue)==null?void 0:u.pop();if(!e)return;const{methodName:i,data:r,invokeOptions:n,resolver:o}=e;this.apply(i,r,n).then(p=>o.resolve(p)).catch(p=>o.reject(p))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{Vi(e.abortHandle),e.reject(ni(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,i){const r=x3(e);if(r)switch(r.type){case Sw:this._onResponseMessage(r);break;case bV:i?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case vV:this._onAbortMessage(r);break;case gV:this._onCloseMessage();break;case wV:this._onOpenPortMessage(r);break;case x3e:this._onOnMessage(r)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),i.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&c1.clients.get(this)===e&&e.destroy(),c1.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n=[],abortable:o}=e,u=o?new AbortController:null,p=this._inJobs;let g,w=this._client,S=w[i];try{if(!S&&i&&i.includes(".")){const T=i.split(".");for(let E=0;E<T.length-1;E++)w=w[T[E]],S=w[T[E+1]]}if(typeof S!="function")throw new TypeError(`${i} is not a function`);n.push({client:this,signal:u?u.signal:null}),g=S.apply(w,n)}catch(T){return void this._post({type:Sw,jobId:r,error:S3(T)})}ed(g)?(p.set(r,{controller:u,promise:g}),g.then(T=>{p.has(r)&&(p.delete(r),this._post({type:Sw,jobId:r},T))},T=>{p.has(r)&&(p.delete(r),Cn(T)||this._post({type:Sw,jobId:r,error:S3(T||{message:`Error encountered at method ${i}`})}))})):this._post({type:Sw,jobId:r},g)}_onOpenPortMessage(e){new c1(e.port,{client:this._client})}_onOnMessage(e){const{port:i}=e,r=this._client.on(e.eventType,o=>{i.postMessage(o)}),n=H3(e.port,"message",o=>{const u=x3(o);(u==null?void 0:u.type)===ns.CLOSE&&(n.remove(),r.remove(),i.close())})}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,o=this._outJobs;if(!o.has(i))return;const u=o.get(i);o.delete(i),this._processWork(),Vi(u.abortHandle),r?u.reject(re.fromJSON(JSON.parse(r))):u.resolve(n)}_post(e,i,r){return j8(this._port,e,i,r)}};r0.kernelInfo={buildDate:NJ,fullVersion:rP,revision:DJ},r0.clients=new Map;let E3e=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new mb}destroy(){this.close()}get closed(){var e;return!((e=this._clients)!=null&&e.length)}open(e,i){return new Promise((r,n)=>{let o=!0;const u=p=>{At(i.signal),o&&(o=!1,p())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let p=0;p<e.length;++p){const g=e[p];ed(g)?this._clientPromises[p]=g.then(w=>(this._clients[p]=new r0(w,i,this._ongoingJobsQueue),u(r),this._clients[p]),()=>(u(n),null)):(this._clients[p]=new r0(g,i,this._ongoingJobsQueue),this._clientPromises[p]=Promise.resolve(this._clients[p]),u(r))}})}broadcast(e,i,r){const n=new Array(this._clientPromises.length);for(let o=0;o<this._clientPromises.length;++o){const u=this._clientPromises[o];n[o]=u.then(p=>p==null?void 0:p.invoke(e,i,r))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(ni(`Worker closing, aborting job calling '${e.methodName}'`));for(const i of this._clientPromises)i.then(r=>r==null?void 0:r.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,g3e(this)}invoke(e,i,r){return this.apply(e,[i],r)}apply(e,i,r){const n=os();this._ongoingJobsQueue.push({methodName:e,data:i,invokeOptions:r,resolver:n});for(let o=0;o<this._clientPromises.length;o++){const u=this._clients[o];u?u.jobAdded():this._clientPromises[o].then(p=>p==null?void 0:p.jobAdded())}return n.promise}createInvokeProxy(e){return Ree(this,e)}on(e,i){return Promise.all(this._clientPromises).then(()=>In(this._clients.map(r=>r.on(e,i))))}openPorts(){return new Promise(e=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(o=>{o&&(i[n]=o.openPort()),--r==0&&e(i)})})}get test(){}};const I3e={async request(t,e){var u,p;const i=t.options,r=i.responseType;i.signal=e==null?void 0:e.signal,i.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&((u=V4(t.url))!=null&&u.after)?r:"array-buffer";const n=await nt(t.url,i),o={data:n.data,httpStatus:n.httpStatus,ssl:n.ssl};switch((p=n.requestOptions)==null?void 0:p.responseType){case"native-request-init":return delete o.data.signal,o;case"blob":o.data=await o.data.arrayBuffer();break;case"json":o.data=new TextEncoder().encode(JSON.stringify(o.data)).buffer;break;case"text":o.data=new TextEncoder().encode(o.data).buffer}return{result:o,transferList:[o.data]}}},_V={};function M3e(t){var i;const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:((i=t.packages)==null?void 0:i.concat())||[],paths:{..._V.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=_V.baseUrl),e}let k3e=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...r)=>e[i](...r)})}},UT=class{constructor(){this._dispatcher=new k3e,this._workerPostMessage({type:ns.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){eb(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,i,r){this._dispatcher.addEventListener(e,i,r)}removeEventListener(e,i,r){this._dispatcher.removeEventListener(e,i,r)}_workerPostMessage(e){eb(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const i=x3(e);if(i&&i.type===ns.OPEN){const{modulePath:r,jobId:n}=i;let o=await r0.loadWorker(r);o||(o=await import(r));const u=r0.connect(o);this._workerPostMessage({type:ns.OPENED,jobId:n,data:u})}}};const BA=()=>fe.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:C3e}=ns,A3e='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let Tx,Ex;const SV="Failed to create Worker. Fallback to execute module in main thread";async function L3e(){if(!me("esri-workers"))return xV(new UT);if(!Tx&&!Ex)try{const e=A3e.split("{CONFIGURATION}").join(O3e());Tx=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){Ex=e||{}}let t;if(Tx)try{t=new Worker(Tx,{name:"esri-worker-"+P3e++})}catch{BA().warn(SV,Ex),t=new UT}else BA().warn(SV,Ex),t=new UT;return xV(t)}async function xV(t){return new Promise(e=>{function i(n){const o=x3(n);o&&o.type===C3e&&(t.removeEventListener("message",i),t.removeEventListener("error",r),e(t))}function r(n){n.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",r),BA().warn("Failed to create Worker. Fallback to execute module in main thread",n),(t=new UT).addEventListener("message",i),t.addEventListener("error",r)}t.addEventListener("message",i),t.addEventListener("error",r)})}function O3e(){let t;if(Ct.default!=null){const n={...Ct};delete n.default,t=JSON.parse(JSON.stringify(n))}else t=JSON.parse(JSON.stringify(Ct));t.assetsPath=Wo(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Wo(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=Ss(),t.has={"esri-csp-restrictions":me("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":me("esri-2d-update-debug"),"esri-2d-log-updating":me("esri-2d-log-updating"),"featurelayer-pbf":me("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":me("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":me("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":me("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":me("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":me("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":me("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":me("featurelayer-snapshot-enabled"),"esri-atomics":me("esri-atomics"),"esri-shared-array-buffer":me("esri-shared-array-buffer"),"esri-tiles-debug":me("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":me("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":me("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Wo(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Wo(t.workers.workerPath):t.workers.workerPath=Wo(qt("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Ct.workers.loaderConfig,i=M3e({baseUrl:e==null?void 0:e.baseUrl,locale:Ss(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{buildDate:NJ,fullVersion:rP,revision:DJ}})}let P3e=0;const{ABORT:$V,INVOKE:R3e,OPEN:F3e,OPENED:N3e,RESPONSE:xw}=ns;let D3e=class Dee{static async create(e){const i=await L3e();return new Dee(i,e)}constructor(e,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=i,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),fe.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,i={}){const{signal:r}=i,n=Nee();return new Promise((o,u)=>{const p={resolve:o,reject:u,abortHandle:V7(r,()=>{this._outJobs.delete(n),this._post({type:$V,jobId:n})})};this._outJobs.set(n,p),this._post({type:F3e,jobId:n,modulePath:e})})}_onMessage(e){const i=x3(e);if(i)switch(i.type){case N3e:this._onOpenedMessage(i);break;case xw:this._onResponseMessage(i);break;case $V:this._onAbortMessage(i);break;case R3e:this._onInvokeMessage(i)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);n&&(n.controller&&n.controller.abort(),i.delete(r))}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n,abortable:o}=e,u=o?new AbortController:null,p=this._inJobs,g=I3e[i];let w;try{if(typeof g!="function")throw new TypeError(`${i} is not a function`);w=g.call(null,n,{signal:u?u.signal:null})}catch(S){return void this._post({type:xw,jobId:r,error:S3(S)})}ed(w)?(p.set(r,{controller:u,promise:w}),w.then(S=>{p.has(r)&&(p.delete(r),this._post({type:xw,jobId:r},S))},S=>{p.has(r)&&(p.delete(r),S||(S={message:"Error encountered at method"+i}),Cn(S)||this._post({type:xw,jobId:r,error:S3(S||{message:`Error encountered at method ${i}`})}))})):this._post({type:xw,jobId:r},w)}_onOpenedMessage(e){const{jobId:i,data:r}=e,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),Vi(n.abortHandle),n.resolve(r))}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,o=this._outJobs.get(i);o&&(this._outJobs.delete(i),Vi(o.abortHandle),r?o.reject(re.fromJSON(JSON.parse(r))):o.resolve(n))}_post(e,i,r){return j8(this.worker,e,i,r)}};const TV=me("host-browser")?Math.min(navigator.hardwareConcurrency-1,me("workers-pool-size")):0;let nm=me("esri-mobile")?Math.min(TV,3):TV;nm||(nm=me("safari")&&me("mac")?7:2);let EV=0;const GT=[];function j3e(){jee()}async function Ix(t,e){const i=new E3e,{registryTarget:r,...n}=e;return await i.open(t,n),r&&m3e(r,i),i}async function V3e(t,e={}){if(typeof t!="string")throw new re("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(me("host-webworker")&&!me("esri-workers")&&(i="local"),i==="local"){let r=await r0.loadWorker(t);r||(r=await import(t)),At(e.signal);const n=e.client||r;return Ix([r0.connect(r,e.schedule)],{...e,client:n})}if(await jee(),At(e.signal),i==="dedicated"){const r=EV++%nm;return Ix([await GT[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,nm);if(r<nm){const n=new Array(r);for(let o=0;o<r;++o){const u=EV++%nm;n[o]=GT[u].open(t,e)}return Ix(n,e)}}return Ix(GT.map(r=>r.open(t,e)),e)}let Mx=null;async function jee(){if(Mx)return Mx;new AbortController;const t=[];for(let e=0;e<nm;e++){const i=D3e.create(e).then(r=>(GT[e]=r,r));t.push(i)}return Mx=Promise.all(t),Mx}function IV(t,e,i){if(t.hasM==null||t.hasZ)for(const r of e)for(const n of r)n.length>2&&(n[2]*=i)}function z3e(t,e,i){if(!t&&!e||!i)return;const r=Gl(i);MV(t,i,r),MV(e,i,r)}function MV(t,e,i){if(t)for(const r of t)U3e(r.geometry,e,i)}function U3e(t,e,i){if(!(t!=null&&t.spatialReference)||Ki(t.spatialReference,e))return;const r=Gl(t.spatialReference)/i;if(r!==1){if("x"in t)t.z!=null&&(t.z*=r);else if("rings"in t)IV(t,t.rings,r);else if("paths"in t)IV(t,t.paths,r);else if("points"in t&&(t.hasM==null||t.hasZ))for(const n of t.points)n.length>2&&(n[2]*=r)}}function Vee(t,e,i){if(e==null||i==null||i.vcsWkid||Ki(e,i)||e0(e)||e0(i))return null;const r=Gl(e)/Gl(i);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return n=>G3e(n,r);case"polyline":case"esriGeometryPolyline":return n=>q3e(n,r);case"polygon":case"esriGeometryPolygon":return n=>B3e(n,r);case"multipoint":case"esriGeometryMultipoint":return n=>H3e(n,r);case"extent":case"esriGeometryEnvelope":return n=>W3e(n,r);default:return null}}function G3e(t,e){(t==null?void 0:t.z)!=null&&(t.z*=e)}function B3e(t,e){if(t)for(const i of t.rings)for(const r of i)r.length>2&&(r[2]*=e)}function q3e(t,e){if(t)for(const i of t.paths)for(const r of i)r.length>2&&(r[2]*=e)}function H3e(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function W3e(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}function kV(t,e,i){if(!(i!=null&&i.features)||!i.hasZ)return;const r=Vee(i.geometryType,e,t.outSpatialReference);if(r!=null)for(const n of i.features)r(n.geometry)}const V8=new et({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var qA;const J3e=new et({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let Fs=qA=class extends ye{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return(i==null?void 0:i.value)??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return i?J3e.fromJSON(i.fieldValueType):null}clone(){var t;return new qA({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((t=this.domain)==null?void 0:t.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};m([b({type:String,json:{write:!0}})],Fs.prototype,"alias",void 0),m([b({type:[String,Number],json:{write:{allowNull:!0}}})],Fs.prototype,"defaultValue",void 0),m([b()],Fs.prototype,"description",void 0),m([Me("description")],Fs.prototype,"readDescription",null),m([b({types:Tee,json:{read:{reader:pM},write:!0}})],Fs.prototype,"domain",void 0),m([b({type:Boolean,json:{write:!0}})],Fs.prototype,"editable",void 0),m([b({type:zt,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Fs.prototype,"length",void 0),m([b({type:String,json:{write:!0}})],Fs.prototype,"name",void 0),m([b({type:Boolean,json:{write:!0}})],Fs.prototype,"nullable",void 0),m([ze(V8)],Fs.prototype,"type",void 0),m([b()],Fs.prototype,"valueType",void 0),m([Me("valueType",["description"])],Fs.prototype,"readValueType",null),m([b({type:Boolean,json:{read:!1}})],Fs.prototype,"visible",void 0),Fs=qA=m([G("esri.layers.support.Field")],Fs);const dM=Fs;var HA;const WA=new et({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Qn=HA=class extends ye{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){var n;const i=Ge.fromJSON(e.spatialReference),r=[];for(let o=0;o<t.length;o++){const u=t[o],p=Cr.fromJSON(u),g=(n=u.geometry)==null?void 0:n.spatialReference;p.geometry==null||g||(p.geometry.spatialReference=i);const w=u.aggregateGeometries,S=p.aggregateGeometries;if(w&&S!=null)for(const T in S){const E=S[T],C=w[T],L=C==null?void 0:C.spatialReference;E==null||L||(E.spatialReference=i)}r.push(p)}return r}writeGeometryType(t,e,i,r){if(t)return void WA.write(t,e,i,r);const{features:n}=this;if(n){for(const o of n)if((o==null?void 0:o.geometry)!=null)return void WA.write(o.geometry.type,e,i,r)}}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,r=dh(t);return r&&!i&&e.spatialReference&&(r.spatialReference=Ge.fromJSON(e.spatialReference)),r}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i){for(const r of i)if(r&&r.geometry!=null&&r.geometry.spatialReference)return void(e.spatialReference=r.geometry.spatialReference.toJSON())}}clone(){return new HA(this.cloneProperties())}cloneProperties(){return ae({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const r=e.features[i];if(r.geometry){const n=t==null?void 0:t[i];r.geometry=(n==null?void 0:n.toJSON())||r.geometry}}return e}quantize(t){const{scale:[e,i],translate:[r,n]}=t,o=w=>Math.round((w-r)/e),u=w=>Math.round((n-w)/i),p=this.features,g=this._getQuantizationFunction(this.geometryType,o,u);for(let w=0,S=p.length;w<S;w++)g!=null&&g(p[w].geometry)||(p.splice(w,1),w--,S--);return this.transform=t,this}unquantize(){var E,C;const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[r,n],scale:[o,u]}=i,p=L=>L*o+r,g=L=>n-L*u;let w=null,S=null;if(this.hasZ&&((E=i==null?void 0:i.scale)==null?void 0:E[2])!=null){const{translate:[,,L],scale:[,,R]}=i;w=F=>F*R+L}if(this.hasM&&((C=i==null?void 0:i.scale)==null?void 0:C[3])!=null){const{translate:[,,,L],scale:[,,,R]}=i;S=F=>F==null?F:F*R+L}const T=this._getHydrationFunction(t,p,g,w,S);for(const{geometry:L}of e)L!=null&&T&&T(L);return this.transform=null,this}_quantizePoints(t,e,i){let r,n;const o=[];for(let u=0,p=t.length;u<p;u++){const g=t[u];if(u>0){const w=e(g[0]),S=i(g[1]);w===r&&S===n||(o.push([w-r,S-n]),r=w,n=S)}else r=e(g[0]),n=i(g[1]),o.push([r,n])}return o.length>0?o:null}_getQuantizationFunction(t,e,i){return t==="point"?r=>(r.x=e(r.x),r.y=i(r.y),r):t==="polyline"||t==="polygon"?r=>{const n=xv(r)?r.rings:r.paths,o=[];for(let u=0,p=n.length;u<p;u++){const g=n[u],w=this._quantizePoints(g,e,i);w&&o.push(w)}return o.length>0?(xv(r)?r.rings=o:r.paths=o,r):null}:t==="multipoint"?r=>{const n=this._quantizePoints(r.points,e,i);return n&&n.length>0?(r.points=n,r):null}:t==="extent"?r=>r:null}_getHydrationFunction(t,e,i,r,n){return t==="point"?o=>{o.x=e(o.x),o.y=i(o.y),r&&(o.z=r(o.z))}:t==="polyline"||t==="polygon"?o=>{const u=xv(o)?o.rings:o.paths;let p,g;for(let w=0,S=u.length;w<S;w++){const T=u[w];for(let E=0,C=T.length;E<C;E++){const L=T[E];E>0?(p+=L[0],g+=L[1]):(p=L[0],g=L[1]),L[0]=e(p),L[1]=i(g)}}if(r&&n)for(let w=0,S=u.length;w<S;w++){const T=u[w];for(let E=0,C=T.length;E<C;E++){const L=T[E];L[2]=r(L[2]),L[3]=n(L[3])}}else if(r)for(let w=0,S=u.length;w<S;w++){const T=u[w];for(let E=0,C=T.length;E<C;E++){const L=T[E];L[2]=r(L[2])}}else if(n)for(let w=0,S=u.length;w<S;w++){const T=u[w];for(let E=0,C=T.length;E<C;E++){const L=T[E];L[2]=n(L[2])}}}:t==="extent"?o=>{o.xmin=e(o.xmin),o.ymin=i(o.ymin),o.xmax=e(o.xmax),o.ymax=i(o.ymax),r&&o.zmax!=null&&o.zmin!=null&&(o.zmax=r(o.zmax),o.zmin=r(o.zmin)),n&&o.mmax!=null&&o.mmin!=null&&(o.mmax=n(o.mmax),o.mmin=n(o.mmin))}:t==="multipoint"?o=>{const u=o.points;let p,g;for(let w=0,S=u.length;w<S;w++){const T=u[w];w>0?(p+=T[0],g+=T[1]):(p=T[0],g=T[1]),T[0]=e(p),T[1]=i(g)}if(r&&n)for(let w=0,S=u.length;w<S;w++){const T=u[w];T[2]=r(T[2]),T[3]=n(T[3])}else if(r)for(let w=0,S=u.length;w<S;w++){const T=u[w];T[2]=r(T[2])}else if(n)for(let w=0,S=u.length;w<S;w++){const T=u[w];T[2]=n(T[2])}}:null}};m([b({type:String,json:{write:!0}})],Qn.prototype,"displayFieldName",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Qn.prototype,"exceededTransferLimit",void 0),m([b({type:[Cr],json:{write:!0}})],Qn.prototype,"features",void 0),m([Me("features")],Qn.prototype,"readFeatures",null),m([b({type:[dM],json:{write:!0}})],Qn.prototype,"fields",void 0),m([b({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:WA.read}}})],Qn.prototype,"geometryType",void 0),m([Le("geometryType")],Qn.prototype,"writeGeometryType",null),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Qn.prototype,"hasM",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Qn.prototype,"hasZ",void 0),m([b({types:h0,json:{write:!0}})],Qn.prototype,"queryGeometry",void 0),m([Me("queryGeometry")],Qn.prototype,"readQueryGeometry",null),m([b({type:Ge,json:{write:!0}})],Qn.prototype,"spatialReference",void 0),m([Le("spatialReference")],Qn.prototype,"writeSpatialReference",null),m([b({json:{write:!0}})],Qn.prototype,"transform",void 0),Qn=HA=m([G("esri.rest.support.FeatureSet")],Qn),Qn.prototype.toJSON.isDefaultToJSON=!0;const gb=Qn;let Z3e=0,Tp=class extends Qo.LoadableMixin(Bb(Ie)){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var i;const e=(i=this.layer)==null?void 0:i.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,i={}){await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);kV(e,this.layer.spatialReference,r);const n=gb.fromJSON(r);if(!this._requiresClientGraphicMapping())return n;const o=this.layer.objectIdField;for(const u of n.features){const p=u.attributes[o],g=this._idToClientGraphic.get(p);g&&(u.geometry=g.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(e,i={}){if(this._requiresClientGraphicMapping())throw new re("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);return kV(e,this.layer.spatialReference,r),r}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(r=>({count:r.count,extent:jt.fromJSON(r.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}async _applyEdits(e){if(!this._connection)throw new re("feature-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField;let r=null;const n=[],o=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const u=S=>"objectId"in S&&S.objectId!=null?S.objectId:"attributes"in S&&S.attributes[i]!=null?S.attributes[i]:null;if(e.addFeatures&&(r=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const S of e.deleteFeatures){const T=u(S);T!=null&&n.push(T)}const p=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const S of e.updateFeatures)if(o.push(this._serializeFeature(S)),p){const T=u(S);T!=null&&p.set(T,S)}}z3e(r?r.features:null,o,this.layer.spatialReference);const{fullExtent:g,featureEditResults:w}=await this._connection.invoke("applyEdits",{adds:r?r.features:[],updates:o,deletes:n});return this.fullExtent=g,r&&r.finish(w.uidToObjectId),this._updateClientGraphicIds(p,w),this._createEditsResult(w)}async _prepareClientMapping(e,i){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const r=[];for(const{geometry:n}of e)n==null||n.type!=="mesh"||n.hasExtent||n.loaded||r.push(n.load({signal:i}));r.length&&await Promise.all(r)}_updateClientGraphicIds(e,i){if(this._idToClientGraphic){if(e)for(const r of i.updateResults){if(!r.success)continue;const n=e.get(r.objectId);n!=null&&this._addIdToClientGraphic(n)}for(const r of i.deleteResults)r.success&&this._idToClientGraphic.delete(r.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new re("feature-layer-source:edit-failure",i.description,{code:i.code}):null}}_prepareAddFeatures(e){const i=new Map,r=new Array(e.length);let n=null;for(let u=0;u<e.length;u++){const p=e[u],g=this._serializeFeature(p);n||p.geometry==null||(n=p.geometry.type),r[u]=g,i.set(`${g.uid}`,p)}const o=this;return{features:r,inferredGeometryType:n,finish(u){const p=o.sourceJSON.objectIdField;for(const g in u){const w=u[g],S=i.get(g);S&&(S.attributes||(S.attributes={}),w===-1?delete S.attributes[p]:S.attributes[p]=w,o._addIdToClientGraphic(S))}}}}_addIdToClientGraphic(e){var n;if(!this._idToClientGraphic)return;const i=this.sourceJSON.objectIdField,r=(n=e.attributes)==null?void 0:n[i];r!=null&&this._idToClientGraphic.set(r,e)}get _layerOrSourceGeometryType(){var e,i;return((e=this.layer)==null?void 0:e.geometryType)??((i=this.sourceJSON)==null?void 0:i.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:i}=e,r=this._geometryForSerialization(e),n=(Z3e++).toString();return r?{uid:n,geometry:r.toJSON(),attributes:i}:{uid:n,attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:this._geometryRequiresClientGraphicMapping(i)?i.extent?xo.fromExtent(i.extent):null:i}async _startWorker(e){this._connection=await V3e("MemorySourceWorker",{strategy:me("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:i,spatialReference:r,objectIdField:n,hasM:o,hasZ:u,timeInfo:p,dateFieldsTimeZone:g}=this.layer,w=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const S=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",L=>{fe.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),L.preventDefault()}));const T={features:S.features,fields:i==null?void 0:i.map(L=>L.toJSON()),geometryType:FD.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&o,hasZ:this._layerOrSourceGeometryType==="mesh"||u,objectIdField:n,spatialReference:w?null:r&&r.toJSON(),timeInfo:(p==null?void 0:p.toJSON())??null,dateFieldsTimeZone:g},E=await this._connection.invoke("load",T,{signal:e});for(const L of E.warnings)fe.getLogger(this.layer).warn("#load()",`${L.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:L});E.featureErrors.length&&fe.getLogger(this.layer).warn("#load()",`Encountered ${E.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:E.featureErrors});const C=E.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(S.inferredGeometryType)&&(C.geometryType=FD.toJSON(S.inferredGeometryType)),this.sourceJSON=C,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),S.finish(E.assignedObjectIds)}};m([sP({Type:Cr,ensureType:Yi(Cr)})],Tp.prototype,"itemType",void 0),m([b()],Tp.prototype,"type",void 0),m([b({constructOnly:!0})],Tp.prototype,"layer",void 0),m([b({readOnly:!0})],Tp.prototype,"_workerGeometryType",null),m([b()],Tp.prototype,"sourceJSON",void 0),Tp=m([G("esri.layers.graphics.sources.MemorySource")],Tp);function K3e(t){return"portalItem"in t}const Y3e=t=>{let e=class extends t{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):K3e(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return m([b({type:String})],e.prototype,"apiKey",null),e=m([G("esri.layers.mixins.APIKeyMixin")],e),e},zee={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Uee=Object.values(zee),Gee=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Uee.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),X3e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Uee.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),Q3e=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function XKe(t){return Gee.test(t)}function Zu(t){if(t==null)return null;const e=Zr(t),i=(e==null?void 0:e.path.match(Gee))||(e==null?void 0:e.path.match(X3e));if(!i)return null;const[,r,n,o,u]=i,p=n.indexOf("/");return{title:z8(p!==-1?n.slice(p+1):n),serverType:zee[o.toLowerCase()],sublayer:u!=null&&u!==""?parseInt(u,10):null,url:{path:r}}}function eSe(t){const e=Zr(t).path.match(Q3e);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function z8(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function tSe(t,e){const i=[];if(t){const r=Zu(t);r!=null&&r.title&&i.push(r.title)}if(e){const r=z8(e);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function Bee(t){let e=Fl(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function iSe(t,e){return t&&OJ(PJ(t,e))}function rSe(t){let{url:e}=t;if(!e)return{url:e};e=PJ(e,t.logger);const i=Zr(e),r=Zu(i.path);let n;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(n=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const o=eSe(i.path);o!=null&&(e=o.serviceUrl,n=o.sublayerId)}return{url:OJ(e),layerId:n}}function nSe(t,e,i,r,n){km(e,r,"url",n),r.url&&t.layerId!=null&&(r.url=ib(r.url,i,t.layerId.toString()))}function QKe(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),o=e.includes("/wmsserver");return i&&(r||n||o)}function eYe(t){var r;if(!t)return!1;const e=new qf(Wo(t)),i=(r=e.authority)==null?void 0:r.toLowerCase();return i==="server.arcgisonline.com"||i==="services.arcgisonline.com"}const sSe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=Zu(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",iSe(i,fe.getLogger(this)))}};return m([b()],e.prototype,"title",null),m([b({type:String})],e.prototype,"url",null),e=m([G("esri.layers.mixins.ArcGISService")],e),e};var tYe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qee(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var CV,AV,Hee={exports:{}};AV=function(){function t(n,o){function u(){this.constructor=n}u.prototype=o.prototype,n.prototype=new u}function e(n,o,u,p){var g=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(g,e.prototype),g.expected=o,g.found=u,g.location=p,g.name="SyntaxError",g}function i(n,o,u){return u=u||" ",n.length>o?n:(o-=n.length,n+(u+=u.repeat(o)).slice(0,o))}function r(n,o){var u,p={},g=(o=o!==void 0?o:{}).grammarSource,w={start:Vr},S=Vr,T="none",E=")",C=",",L="(",R="%",F="px",V="cm",U="mm",W="in",H="pt",J="pc",X="deg",te="rad",oe="grad",pe="turn",de="#",ge=".",we="e",ke=/^[ \t\n\r]/,$e=/^[a-z\-]/,Fe=/^[0-9a-fA-F]/,yt=/^[+\-]/,qe=/^[0-9]/,Ue=Ae("none"),ei=xe("none",!1),jr=xe(")",!1),cs=xe(",",!1),eo=Ae("whitespace"),to=_e([" ","	",`
`,"\r"],!1,!1),On=Ae("function"),Is=xe("(",!1),sa=Ae("identifier"),Ha=_e([["a","z"],"-"],!1,!1),oa=Ae("percentage"),hn=xe("%",!1),Wl=Ae("length"),sg=xe("px",!1),og=xe("cm",!1),Eo=xe("mm",!1),hw=xe("in",!1),n9=xe("pt",!1),s9=xe("pc",!1),pn=Ae("angle"),Y=xe("deg",!1),Ms=xe("rad",!1),WS=xe("grad",!1),Kt=xe("turn",!1),Lr=Ae("number"),Jl=Ae("color"),sc=xe("#",!1),Zl=_e([["0","9"],["a","f"],["A","F"]],!1,!1),oc=_e(["+","-"],!1,!1),Kl=_e([["0","9"]],!1,!1),JS=xe(".",!1),Mh=xe("e",!1),Pe=function(){return[]},cd=function(ne,Se){return{type:"function",name:ne,parameters:Se||[]}},d=function(ne,Se){return Se.length>0?zue(ne,Se,3):[ne]},O=function(ne){return{type:"quantity",value:ne.value,unit:ne.unit}},x=function(ne){return{type:"color",colorType:ne.type,value:ne.value}},h=function(ne){return ne},l=function(){return ve()},s=function(ne){return{value:ne,unit:"%"}},a=function(ne){return{value:ne,unit:"px"}},c=function(ne){return{value:ne,unit:"cm"}},f=function(ne){return{value:ne,unit:"mm"}},y=function(ne){return{value:ne,unit:"in"}},v=function(ne){return{value:ne,unit:"pt"}},_=function(ne){return{value:ne,unit:"pc"}},$=function(ne){return{value:ne,unit:"deg"}},I=function(ne){return{value:ne,unit:"rad"}},k=function(ne){return{value:ne,unit:"grad"}},A=function(ne){return{value:ne,unit:"turn"}},P=function(ne){return{value:ne,unit:null}},D=function(){return{type:"hex",value:ve()}},j=function(ne){return{type:"function",value:ne}},B=function(){return{type:"named",value:ve()}},q=function(){return parseFloat(ve())},z=0,Z=0,ee=[{line:1,column:1}],Q=0,le=[],se=0;if("startRule"in o){if(!(o.startRule in w))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');S=w[o.startRule]}function ve(){return n.substring(Z,z)}function xe(ne,Se){return{type:"literal",text:ne,ignoreCase:Se}}function _e(ne,Se,Oe){return{type:"class",parts:ne,inverted:Se,ignoreCase:Oe}}function je(){return{type:"end"}}function Ae(ne){return{type:"other",description:ne}}function st(ne){var Se,Oe=ee[ne];if(Oe)return Oe;for(Se=ne-1;!ee[Se];)Se--;for(Oe={line:(Oe=ee[Se]).line,column:Oe.column};Se<ne;)n.charCodeAt(Se)===10?(Oe.line++,Oe.column=1):Oe.column++,Se++;return ee[ne]=Oe,Oe}function it(ne,Se,Oe){var It=st(ne),dn=st(Se);return{source:g,start:{offset:ne,line:It.line,column:It.column},end:{offset:Se,line:dn.line,column:dn.column}}}function Ne(ne){z<Q||(z>Q&&(Q=z,le=[]),le.push(ne))}function xi(ne,Se,Oe){return new e(e.buildMessage(ne,Se),ne,Se,Oe)}function Vr(){var ne;return(ne=Ci())===p&&(ne=Jt()),ne}function Ci(){var ne,Se;return se++,ne=z,bt(),n.substr(z,4)===T?(Se=T,z+=4):(Se=p,se===0&&Ne(ei)),Se!==p?(bt(),Z=ne,ne=Pe()):(z=ne,ne=p),se--,ne===p&&se===0&&Ne(Ue),ne}function Jt(){var ne,Se;if(ne=[],(Se=Zt())!==p)for(;Se!==p;)ne.push(Se),Se=Zt();else ne=p;return ne}function Zt(){var ne,Se,Oe,It;return ne=z,bt(),(Se=aa())!==p?(bt(),(Oe=_t())===p&&(Oe=null),bt(),n.charCodeAt(z)===41?(It=E,z++):(It=p,se===0&&Ne(jr)),It!==p?(bt(),Z=ne,ne=cd(Se,Oe)):(z=ne,ne=p)):(z=ne,ne=p),ne}function _t(){var ne,Se,Oe,It,dn,Or,Wa,ZS;if(ne=z,(Se=Qi())!==p){for(Oe=[],It=z,dn=bt(),n.charCodeAt(z)===44?(Or=C,z++):(Or=p,se===0&&Ne(cs)),Or===p&&(Or=null),Wa=bt(),(ZS=Qi())!==p?It=dn=[dn,Or,Wa,ZS]:(z=It,It=p);It!==p;)Oe.push(It),It=z,dn=bt(),n.charCodeAt(z)===44?(Or=C,z++):(Or=p,se===0&&Ne(cs)),Or===p&&(Or=null),Wa=bt(),(ZS=Qi())!==p?It=dn=[dn,Or,Wa,ZS]:(z=It,It=p);Z=ne,ne=d(Se,Oe)}else z=ne,ne=p;return ne}function Qi(){var ne,Se;return ne=z,(Se=hs())===p&&(Se=oi())===p&&(Se=ag())===p&&(Se=lg()),Se!==p&&(Z=ne,Se=O(Se)),(ne=Se)===p&&(ne=z,(Se=ug())!==p&&(Z=ne,Se=x(Se)),ne=Se),ne}function bt(){var ne,Se;for(se++,ne=[],ke.test(n.charAt(z))?(Se=n.charAt(z),z++):(Se=p,se===0&&Ne(to));Se!==p;)ne.push(Se),ke.test(n.charAt(z))?(Se=n.charAt(z),z++):(Se=p,se===0&&Ne(to));return se--,Se=p,se===0&&Ne(eo),ne}function aa(){var ne,Se,Oe;return se++,ne=z,(Se=Ot())!==p?(n.charCodeAt(z)===40?(Oe=L,z++):(Oe=p,se===0&&Ne(Is)),Oe!==p?(Z=ne,ne=h(Se)):(z=ne,ne=p)):(z=ne,ne=p),se--,ne===p&&(Se=p,se===0&&Ne(On)),ne}function Ot(){var ne,Se,Oe;if(se++,ne=z,Se=[],$e.test(n.charAt(z))?(Oe=n.charAt(z),z++):(Oe=p,se===0&&Ne(Ha)),Oe!==p)for(;Oe!==p;)Se.push(Oe),$e.test(n.charAt(z))?(Oe=n.charAt(z),z++):(Oe=p,se===0&&Ne(Ha));else Se=p;return Se!==p&&(Z=ne,Se=l()),se--,(ne=Se)===p&&(Se=p,se===0&&Ne(sa)),ne}function hs(){var ne,Se,Oe;return se++,ne=z,bt(),(Se=ks())!==p?(n.charCodeAt(z)===37?(Oe=R,z++):(Oe=p,se===0&&Ne(hn)),Oe!==p?(Z=ne,ne=s(Se)):(z=ne,ne=p)):(z=ne,ne=p),se--,ne===p&&se===0&&Ne(oa),ne}function oi(){var ne,Se,Oe;return se++,ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===F?(Oe=F,z+=2):(Oe=p,se===0&&Ne(sg)),Oe!==p?(Z=ne,ne=a(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===V?(Oe=V,z+=2):(Oe=p,se===0&&Ne(og)),Oe!==p?(Z=ne,ne=c(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===U?(Oe=U,z+=2):(Oe=p,se===0&&Ne(Eo)),Oe!==p?(Z=ne,ne=f(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===W?(Oe=W,z+=2):(Oe=p,se===0&&Ne(hw)),Oe!==p?(Z=ne,ne=y(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===H?(Oe=H,z+=2):(Oe=p,se===0&&Ne(n9)),Oe!==p?(Z=ne,ne=v(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,bt(),(Se=ks())!==p?(n.substr(z,2)===J?(Oe=J,z+=2):(Oe=p,se===0&&Ne(s9)),Oe!==p?(Z=ne,ne=_(Se)):(z=ne,ne=p)):(z=ne,ne=p)))))),se--,ne===p&&se===0&&Ne(Wl),ne}function ag(){var ne,Se,Oe;return se++,ne=z,(Se=ks())!==p?(n.substr(z,3)===X?(Oe=X,z+=3):(Oe=p,se===0&&Ne(Y)),Oe!==p?(Z=ne,ne=$(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,(Se=ks())!==p?(n.substr(z,3)===te?(Oe=te,z+=3):(Oe=p,se===0&&Ne(Ms)),Oe!==p?(Z=ne,ne=I(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,(Se=ks())!==p?(n.substr(z,4)===oe?(Oe=oe,z+=4):(Oe=p,se===0&&Ne(WS)),Oe!==p?(Z=ne,ne=k(Se)):(z=ne,ne=p)):(z=ne,ne=p),ne===p&&(ne=z,(Se=ks())!==p?(n.substr(z,4)===pe?(Oe=pe,z+=4):(Oe=p,se===0&&Ne(Kt)),Oe!==p?(Z=ne,ne=A(Se)):(z=ne,ne=p)):(z=ne,ne=p)))),se--,ne===p&&(Se=p,se===0&&Ne(pn)),ne}function lg(){var ne,Se;return se++,ne=z,bt(),(Se=ks())!==p?(Z=ne,ne=P(Se)):(z=ne,ne=p),se--,ne===p&&se===0&&Ne(Lr),ne}function ug(){var ne,Se,Oe,It;if(se++,ne=z,n.charCodeAt(z)===35?(Se=de,z++):(Se=p,se===0&&Ne(sc)),Se!==p){if(Oe=[],Fe.test(n.charAt(z))?(It=n.charAt(z),z++):(It=p,se===0&&Ne(Zl)),It!==p)for(;It!==p;)Oe.push(It),Fe.test(n.charAt(z))?(It=n.charAt(z),z++):(It=p,se===0&&Ne(Zl));else Oe=p;Oe!==p?(Z=ne,ne=D()):(z=ne,ne=p)}else z=ne,ne=p;return ne===p&&(ne=z,(Se=Zt())!==p&&(Z=ne,Se=j(Se)),(ne=Se)===p&&(ne=z,(Se=Ot())!==p&&(Z=ne,Se=B()),ne=Se)),se--,ne===p&&(Se=p,se===0&&Ne(Jl)),ne}function ks(){var ne,Se,Oe,It,dn,Or,Wa;for(ne=z,yt.test(n.charAt(z))?(n.charAt(z),z++):se===0&&Ne(oc),Se=z,Oe=[],qe.test(n.charAt(z))?(It=n.charAt(z),z++):(It=p,se===0&&Ne(Kl));It!==p;)Oe.push(It),qe.test(n.charAt(z))?(It=n.charAt(z),z++):(It=p,se===0&&Ne(Kl));if(n.charCodeAt(z)===46?(It=ge,z++):(It=p,se===0&&Ne(JS)),It!==p){if(dn=[],qe.test(n.charAt(z))?(Or=n.charAt(z),z++):(Or=p,se===0&&Ne(Kl)),Or!==p)for(;Or!==p;)dn.push(Or),qe.test(n.charAt(z))?(Or=n.charAt(z),z++):(Or=p,se===0&&Ne(Kl));else dn=p;dn!==p?Se=Oe=[Oe,It,dn]:(z=Se,Se=p)}else z=Se,Se=p;if(Se===p)if(Se=[],qe.test(n.charAt(z))?(Oe=n.charAt(z),z++):(Oe=p,se===0&&Ne(Kl)),Oe!==p)for(;Oe!==p;)Se.push(Oe),qe.test(n.charAt(z))?(Oe=n.charAt(z),z++):(Oe=p,se===0&&Ne(Kl));else Se=p;if(Se!==p){if(Oe=z,n.charCodeAt(z)===101?(It=we,z++):(It=p,se===0&&Ne(Mh)),It!==p){if(yt.test(n.charAt(z))?(dn=n.charAt(z),z++):(dn=p,se===0&&Ne(oc)),dn===p&&(dn=null),Or=[],qe.test(n.charAt(z))?(Wa=n.charAt(z),z++):(Wa=p,se===0&&Ne(Kl)),Wa!==p)for(;Wa!==p;)Or.push(Wa),qe.test(n.charAt(z))?(Wa=n.charAt(z),z++):(Wa=p,se===0&&Ne(Kl));else Or=p;Or!==p?Oe=It=[It,dn,Or]:(z=Oe,Oe=p)}else z=Oe,Oe=p;Oe===p&&(Oe=null),Z=ne,ne=q()}else z=ne,ne=p;return ne}function Vue(ne,Se){return ne.map(function(Oe){return Oe[Se]})}function zue(ne,Se,Oe){return[ne].concat(Vue(Se,Oe))}if((u=S())!==p&&z===n.length)return u;throw u!==p&&z<n.length&&Ne(je()),xi(le,Q<n.length?n.charAt(Q):null,Q<n.length?it(Q,Q+1):it(Q,Q))}return t(e,Error),e.prototype.format=function(n){var o="Error: "+this.message;if(this.location){var u,p=null;for(u=0;u<n.length;u++)if(n[u].source===this.location.source){p=n[u].text.split(/\r\n|\n|\r/g);break}var g=this.location.start,w=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(g):g,S=this.location.source+":"+w.line+":"+w.column;if(p){var T=this.location.end,E=i("",w.line.toString().length," "),C=p[g.line-1],L=(g.line===T.line?T.column:C.length+1)-g.column||1;o+=`
 --> `+S+`
`+E+` |
`+w.line+" | "+C+`
`+E+" | "+i("",g.column-1," ")+i("",L,"^")}else o+=`
 at `+S}return o},e.buildMessage=function(n,o){var u={literal:function(C){return'"'+g(C.text)+'"'},class:function(C){var L=C.parts.map(function(R){return Array.isArray(R)?w(R[0])+"-"+w(R[1]):w(R)});return"["+(C.inverted?"^":"")+L.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(C){return C.description}};function p(C){return C.charCodeAt(0).toString(16).toUpperCase()}function g(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(L){return"\\x0"+p(L)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(L){return"\\x"+p(L)})}function w(C){return C.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(L){return"\\x0"+p(L)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(L){return"\\x"+p(L)})}function S(C){return u[C.type](C)}function T(C){var L,R,F=C.map(S);if(F.sort(),F.length>0){for(L=1,R=1;L<F.length;L++)F[L-1]!==F[L]&&(F[R]=F[L],R++);F.length=R}switch(F.length){case 1:return F[0];case 2:return F[0]+" or "+F[1];default:return F.slice(0,-1).join(", ")+", or "+F[F.length-1]}}function E(C){return C?'"'+g(C)+'"':"end of input"}return"Expected "+T(n)+" but "+E(o)+" found."},{SyntaxError:e,parse:r}},(CV=Hee).exports&&(CV.exports=AV());var oSe=Hee.exports;function U8(t){if(!t||t.length===0)return null;if(typeof t=="string"){const i=LV(t);return i&&i.length!==0?i:null}const e=t.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new re("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:LV(i.value)}});e.sort((i,r)=>r.effects.length-i.effects.length);for(let i=0;i<e.length-1;i++){if(!cK(e[i].effects,e[i+1].effects))throw new re("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[i].effects,b:e[i+1].effects});hK(e[i].effects,e[i+1].effects)}return e.sort((i,r)=>r.scale-i.scale),e}function LV(t){let e;if(!t)return[];try{e=oSe.parse(t)}catch(i){throw new re("effect:invalid-syntax","Invalid effect syntax",{value:t,error:i})}return e.map(i=>aSe(i))}function aSe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return lSe(t);case"opacity":return uSe(t);case"hue-rotate":return cSe(t);case"blur":return hSe(t);case"drop-shadow":return pSe(t);case"bloom":return dSe(t)}}catch(e){throw e.details.filter=t,e}throw new re("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function lSe(t){let e=1;return iw(t.parameters,1),t.parameters.length===1&&(e=Pu(t.parameters[0])),new hC(t.name,e)}function uSe(t){let e=1;return iw(t.parameters,1),t.parameters.length===1&&(e=Pu(t.parameters[0])),new lK(e)}function cSe(t){let e=0;return iw(t.parameters,1),t.parameters.length===1&&(e=bSe(t.parameters[0])),new oK(e)}function hSe(t){let e=0;return iw(t.parameters,1),t.parameters.length===1&&(e=q8(t.parameters[0]),wS(e,t.parameters[0])),new tK(e)}function pSe(t){const e=[];let i=null;for(const r of t.parameters)if(r.type==="color"){if(e.length&&Object.freeze(e),i)throw new re("effect:type-error","Accepts only one color",{});i=wSe(r)}else{const n=q8(r);if(Object.isFrozen(e))throw new re("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(n),e.length===3&&wS(n,r)}if(e.length<2||e.length>3)throw new re("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new nK(e[0],e[1],e[2]||0,i||Wee("black"))}function dSe(t){let e=1,i=0,r=0;return iw(t.parameters,3),t.parameters[0]&&(e=Pu(t.parameters[0])),t.parameters[1]&&(i=q8(t.parameters[1]),wS(i,t.parameters[1])),t.parameters[2]&&(r=Pu(t.parameters[2])),new QZ(e,i,r)}function iw(t,e){if(t.length>e)throw new re("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function fM(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in B8)return"<length>";if(t.unit in G8)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function wS(t,e){if(t<0)throw new re("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function fSe(t){if(t.type!=="quantity"||t.unit!==null)throw new re("effect:type-error",`Expected <double>, Actual: ${fM(t)}`,{term:t})}function ySe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new re("effect:type-error",`Expected <double> or <percentage>, Actual: ${fM(t)}`,{term:t})}const G8={deg:1,grad:.9,rad:180/Math.PI,turn:360};function mSe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&G8[t.unit]!=null))throw new re("effect:type-error",`Expected <angle>, Actual: ${fM(t)}`,{term:t})}const B8={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function gSe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&B8[t.unit]!=null))throw new re("effect:type-error",`Expected <length>, Actual: ${fM(t)}`,{term:t})}function Pu(t){ySe(t);const e=t.value;return wS(e,t),t.unit==="%"?.01*e:e}function vSe(t){return fSe(t),wS(t.value,t),t.value}function bSe(t){return mSe(t),t.value*G8[t.unit]||0}function q8(t){return gSe(t),t.value*B8[t.unit]||0}function wSe(t){switch(t.colorType){case"hex":return i0e(t.value);case"named":return Wee(t.value);case"function":return xSe(t.value)}}function Wee(t){if(!EZ(t))throw new re("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return t0e(t)}const _Se=/^rgba?/i,SSe=/^hsla?/i;function xSe(t){if(iw(t.parameters,4),_Se.test(t.name))return[Pu(t.parameters[0]),Pu(t.parameters[1]),Pu(t.parameters[2]),t.parameters[3]?Pu(t.parameters[3]):1];if(SSe.test(t.name))return IZ(vSe(t.parameters[0]),Pu(t.parameters[1]),Pu(t.parameters[2]),t.parameters[3]?Pu(t.parameters[3]):1);throw new re("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function $3(t,e,i){var r;try{return TSe(t)}catch(n){(r=i==null?void 0:i.messages)==null||r.push(n)}return null}function T3(t,e,i,r){try{const n=$Se(t);Wn(i,n,e)}catch(n){r.messages&&r.messages.push(n)}}function $Se(t){const e=U8(t);return e?Nye(e)?e.map(i=>i.toJSON()):e.map(({scale:i,effects:r})=>({scale:i,value:r.map(n=>n.toJSON())})):null}function TSe(t){if(!t||t.length===0)return null;if(ESe(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:xE(i.value)});return e}return xE(t)}function ESe(t){const e=t[0];return!!e&&"scale"in e}function xE(t){if(!(t!=null&&t.length))return"";const e=[];for(const i of t){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[Ch(i,"amount")];break;case"blur":r=[Ch(i,"radius","pt")];break;case"hue-rotate":r=[Ch(i,"angle","deg")];break;case"drop-shadow":r=[Ch(i,"xoffset","pt"),Ch(i,"yoffset","pt"),Ch(i,"blurRadius","pt"),ISe(i,"color")];break;case"bloom":r=[Ch(i,"strength"),Ch(i,"radius","pt"),Ch(i,"threshold")]}const n=`${i.type}(${r.filter(Boolean).join(" ")})`;U8(n),e.push(n)}return e.join(" ")}function Ch(t,e,i){if(t[e]==null)throw new re("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function ISe(t,e){if(t[e]==null)throw new re("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const MSe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},OV={read:{reader:$3},write:{allowNull:!0,writer:T3}},kSe={json:{read:!1,write:!1,origins:{"web-map":OV,"portal-item":OV}}},Jee=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return m([b(MSe)],e.prototype,"blendMode",void 0),m([b(kSe)],e.prototype,"effect",void 0),e=m([G("esri.layers.mixins.BlendLayer")],e),e},CSe=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return m([b({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],e.prototype,"customParameters",void 0),e=m([G("esri.layers.mixins.CustomParametersMixin")],e),e},ASe="randomUUID"in crypto;function yM(){if(ASe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=i=>t[i].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function PV(){return`{${yM().toUpperCase()}}`}function LSe(){return`{${yM()}}`}const JA=LSe(),Zee=new Map,Kee=new Map;async function iYe(t,e,i){if(!t||!i)return!1;if(!e)return!0;const r=new URL(t).host;let n=Zee.get(r);if(!n){const o=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");n=(await nt(o,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return n===e}async function RV(t,e,i=!1){var o,u,p;if(!t||!e)return!0;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=(o=Kee.get(r))==null?void 0:o.entries();if(n){for(const[g,w]of n)if(w.name===e){const S=!((u=w.stack)!=null&&u.hasForwardEdits());if(!S&&i){const[{deleteForwardEdits:T},{default:E}]=await Promise.all([ie(()=>import("./deleteForwardEdits-r3PHRFy0.js"),[]),ie(()=>import("./DeleteForwardEditsParameters-A4bTt-WE.js"),[])]),C=await T(r,g,new E({sessionId:JA,moment:w.moment}));return C.success&&((p=w.stack)==null||p.clearForwardEdits()),C.success}return S}}return!0}function BT(t,e){var n;if(!t)return!1;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),r=(n=Kee.get(i))==null?void 0:n.entries();if(r){for(const[o,u]of r)if(u.name===e)return u.lockType==="edit"}return!1}const H8=new Ar.EventEmitter;function Yee(t){return H8.on("apply-edits",new WeakRef(t))}function Xee(t){return H8.on("update-moment",new WeakRef(t))}function FV(t,e,i=null,r=!1){const n=os();return r=e==null||r,H8.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:i,mayReceiveServiceEdits:r,result:n.promise}),n}const Qee=Symbol();function rYe(t){return t!=null&&typeof t=="object"&&Qee in t}function $w(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function P2(t,e,i){const r=new URL(t).host,n=Zee.get(r),o=u=>!u||u===n;return o(e)&&o(i)||e===i}const OSe=t=>{var e;let i=class extends t{constructor(...r){super(...r),this[e]=!0,this._applyEditsHandler=n=>{const{serviceUrl:o,layerId:u,gdbVersion:p,mayReceiveServiceEdits:g,result:w}=n,S=o===this.url,T=u!=null&&this.layerId!=null&&u===this.layerId,E=$w(this),C=$w(this)&&P2(o,p,this.gdbVersion);if(!S||E&&!C||!T&&!g)return;const L=w.then(R=>{var U;if(this.lastEditsEventDate=new Date,T&&(R.addedFeatures.length||R.updatedFeatures.length||R.deletedFeatures.length||R.addedAttachments.length||R.updatedAttachments.length||R.deletedAttachments.length))return this.emit("edits",ae(R)),R;const F=(U=R.editedFeatures)==null?void 0:U.find(({layerId:W})=>W===this.layerId);if(F){const{adds:W,updates:H,deletes:J}=F.editedFeatures,X={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:W?W.map(({attributes:te})=>({objectId:this.objectIdField&&te[this.objectIdField],globalId:this.globalIdField&&te[this.globalIdField]})):[],deletedFeatures:J?J.map(({attributes:te})=>({objectId:this.objectIdField&&te[this.objectIdField],globalId:this.globalIdField&&te[this.globalIdField]})):[],updatedFeatures:H?H.map(({current:{attributes:te}})=>({objectId:this.objectIdField&&te[this.objectIdField],globalId:this.globalIdField&&te[this.globalIdField]})):[],editedFeatures:ae(R.editedFeatures),exceededTransferLimit:!1,historicMoment:ae(R.historicMoment)};return this.emit("edits",X),X}const V={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:ae(R.editedFeatures),exceededTransferLimit:!1,historicMoment:ae(R.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(o,p,V.historicMoment)&&this.emit("edits",V),V}).then(R=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(o,p,R.historicMoment)&&(this.historicMoment=R.historicMoment),R));this.emit("apply-edits",{result:L})},this._updateMomentHandler=n=>{const{serviceUrl:o,gdbVersion:u,moment:p}=n,g=o===this.url,w=$w(this),S=$w(this)&&P2(o,u,this.gdbVersion),T=$w(this)&&!P2(o,this.gdbVersion,null);g&&w&&S&&T&&"historicMoment"in this&&this.historicMoment!==p&&(this.historicMoment=p)},this.when().then(()=>{this.addHandles(Yee(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(Xee(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(r,n,o){return"historicMoment"in this&&this.historicMoment!==o&&BT(r,n)}};return e=Qee,m([b()],i.prototype,"lastEditsEventDate",void 0),i=m([G("esri.layers.mixins.EditBusLayer")],i),i};var ZA;let h1=ZA=class extends ye{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new ZA({mapLayerId:t,gdbVersion:e})}};m([ze({mapLayer:"map-layer"})],h1.prototype,"type",void 0),m([b({type:zt,json:{write:!0}})],h1.prototype,"mapLayerId",void 0),m([b({type:String,json:{write:!0}})],h1.prototype,"gdbVersion",void 0),h1=ZA=m([G("esri.layers.support.source.MapLayerSource")],h1);var KA;let Yh=KA=class extends ye{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:r,geometryType:n}=this,o={workspaceId:t,query:e,oidFields:i,spatialReference:(r==null?void 0:r.clone())??void 0,geometryType:n};return new KA(o)}};m([ze({queryTable:"query-table"})],Yh.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],Yh.prototype,"workspaceId",void 0),m([b({type:String,json:{write:!0}})],Yh.prototype,"query",void 0),m([b({type:String,json:{write:!0}})],Yh.prototype,"oidFields",void 0),m([b({type:Ge,json:{write:!0}})],Yh.prototype,"spatialReference",void 0),m([ze($me)],Yh.prototype,"geometryType",void 0),Yh=KA=m([G("esri.layers.support.source.QueryTableDataSource")],Yh);var YA;let p1=YA=class extends ye{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new YA({workspaceId:t,dataSourceName:e})}};m([ze({raster:"raster"})],p1.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],p1.prototype,"dataSourceName",void 0),m([b({type:String,json:{write:!0}})],p1.prototype,"workspaceId",void 0),p1=YA=m([G("esri.layers.support.source.RasterDataSource")],p1);var XA;let fy=XA=class extends ye{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new XA({workspaceId:t,gdbVersion:e,dataSourceName:i})}};m([ze({table:"table"})],fy.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],fy.prototype,"workspaceId",void 0),m([b({type:String,json:{write:!0}})],fy.prototype,"gdbVersion",void 0),m([b({type:String,json:{write:!0}})],fy.prototype,"dataSourceName",void 0),fy=XA=m([G("esri.layers.support.source.TableDataSource")],fy);var QA,eL;const PSe=dt()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let ba=QA=class extends ye{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return NV()(t,e,i)}castLeftTableSource(t){return ch(tL(),t)}readRightTableSource(t,e,i){return NV()(t,e,i)}castRightTableSource(t){return ch(tL(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:r,joinType:n}=this,o={leftTableKey:t,rightTableKey:e,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(r==null?void 0:r.clone())??void 0,joinType:n};return new QA(o)}};m([ze({joinTable:"join-table"})],ba.prototype,"type",void 0),m([b({type:String,json:{write:!0}})],ba.prototype,"leftTableKey",void 0),m([b({type:String,json:{write:!0}})],ba.prototype,"rightTableKey",void 0),m([b({json:{write:!0}})],ba.prototype,"leftTableSource",void 0),m([Me("leftTableSource")],ba.prototype,"readLeftTableSource",null),m([Dt("leftTableSource")],ba.prototype,"castLeftTableSource",null),m([b({json:{write:!0}})],ba.prototype,"rightTableSource",void 0),m([Me("rightTableSource")],ba.prototype,"readRightTableSource",null),m([Dt("rightTableSource")],ba.prototype,"castRightTableSource",null),m([ze(PSe)],ba.prototype,"joinType",void 0),ba=QA=m([G("esri.layers.support.source.JoinTableDataSource")],ba);let Z9=null;function NV(){return Z9||(Z9=zb({types:tL()})),Z9}let K9=null;function tL(){return K9||(K9={key:"type",base:null,typeMap:{"data-layer":Ru,"map-layer":h1}}),K9}const RSe={key:"type",base:null,typeMap:{"join-table":ba,"query-table":Yh,raster:p1,table:fy}};let Ru=eL=class extends ye{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new eL({fields:t,dataSource:e})}};m([ze({dataLayer:"data-layer"})],Ru.prototype,"type",void 0),m([b({type:[dM],json:{write:!0}})],Ru.prototype,"fields",void 0),m([b({types:RSe,json:{write:!0}})],Ru.prototype,"dataSource",void 0),Ru=eL=m([G("esri.layers.support.source.DataLayerSource")],Ru),Ru.from=Yi(Ru);let yy=class extends Gt(ye){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};m([b({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],yy.prototype,"onFields",void 0),m([b({type:String,json:{write:!0}})],yy.prototype,"operator",void 0),m([b({type:String,json:{write:!0}})],yy.prototype,"searchTerm",void 0),m([b({type:String,json:{write:!0}})],yy.prototype,"searchType",void 0),yy=m([G("esri.rest.support.FullTextSearch")],yy);const ete=yy;var iL;const DV=new et({upperLeft:"upper-left",lowerLeft:"lower-left"});let my=iL=class extends ye{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new iL(ae({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};m([b({type:jt,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],my.prototype,"extent",void 0),m([b({type:["view","edit"],json:{write:!0}})],my.prototype,"mode",void 0),m([b({type:String,json:{read:DV.read,write:DV.write}})],my.prototype,"originPosition",void 0),m([b({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],my.prototype,"tolerance",void 0),my=iL=m([G("esri.rest.support.QuantizationParameters")],my);const tte=my,FSe=new et({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var rL;const jV=new et({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let gu=rL=class extends ye{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=ae(t))}clone(){return new rL({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:ae(this.statisticParameters)})}};m([b({type:Number,json:{write:!0}})],gu.prototype,"maxPointCount",void 0),m([b({type:Number,json:{write:!0}})],gu.prototype,"maxRecordCount",void 0),m([b({type:Number,json:{write:!0}})],gu.prototype,"maxVertexCount",void 0),m([b({type:String,json:{write:!0}})],gu.prototype,"onStatisticField",void 0),m([b({type:String,json:{write:!0}})],gu.prototype,"outStatisticFieldName",void 0),m([b({type:String,json:{read:{source:"statisticType",reader:jV.read},write:{target:"statisticType",writer:jV.write}}})],gu.prototype,"statisticType",void 0),m([b({type:Object})],gu.prototype,"statisticParameters",void 0),m([Le("statisticParameters")],gu.prototype,"writeStatisticParameters",null),gu=rL=m([G("esri.rest.support.StatisticDefinition")],gu);const NSe=gu;var qT;const DSe=new et({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let tt=qT=class extends ye{static from(t){return J3(qT,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const r in t){const n=t[r];Array.isArray(n)?i[r]=n.map(o=>o instanceof Date?o.getTime():o):n instanceof Date?i[r]=n.getTime():i[r]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new qT(ae({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};tt.MAX_MAX_RECORD_COUNT_FACTOR=5,m([b({json:{write:!0}})],tt.prototype,"aggregateIds",void 0),m([b({type:Boolean,json:{write:!0}})],tt.prototype,"cacheHint",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"compactGeometryEnabled",void 0),m([b({json:{write:!0}})],tt.prototype,"datumTransformation",void 0),m([Dt("datumTransformation")],tt.prototype,"castDatumTransformation",null),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"defaultSpatialReferenceEnabled",void 0),m([b({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],tt.prototype,"distance",void 0),m([b({type:Ru,json:{write:!0}})],tt.prototype,"dynamicDataSource",void 0),m([b({type:String,json:{write:!0}})],tt.prototype,"formatOf3DObjects",void 0),m([b({type:[ete],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],tt.prototype,"fullText",void 0),m([b({type:String,json:{write:!0}})],tt.prototype,"gdbVersion",void 0),m([b({types:h0,json:{read:dh,write:!0}})],tt.prototype,"geometry",void 0),m([b({type:Number,json:{write:!0}})],tt.prototype,"geometryPrecision",void 0),m([b({type:[String],json:{write:!0}})],tt.prototype,"groupByFieldsForStatistics",void 0),m([b({type:String,json:{write:!0}})],tt.prototype,"having",void 0),m([b({type:Date})],tt.prototype,"historicMoment",void 0),m([Le("historicMoment")],tt.prototype,"writeHistoricMoment",null),m([b({type:Number,json:{write:!0}})],tt.prototype,"maxAllowableOffset",void 0),m([b({type:Number,cast:t=>t<1?1:t>tt.MAX_MAX_RECORD_COUNT_FACTOR?tt.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],tt.prototype,"maxRecordCountFactor",void 0),m([b({type:["xyFootprint"],json:{write:!0}})],tt.prototype,"multipatchOption",void 0),m([b({type:Number,json:{read:{source:"resultRecordCount"}}})],tt.prototype,"num",void 0),m([b({json:{write:!0}})],tt.prototype,"objectIds",void 0),m([b({type:[String],json:{write:!0}})],tt.prototype,"orderByFields",void 0),m([b({type:[String],json:{write:!0}})],tt.prototype,"outFields",void 0),m([b({type:Ge,json:{name:"outSR",write:!0}})],tt.prototype,"outSpatialReference",void 0),m([b({type:[NSe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],tt.prototype,"outStatistics",void 0),m([b({json:{write:!0}})],tt.prototype,"parameterValues",void 0),m([Le("parameterValues")],tt.prototype,"writeParameterValues",null),m([b({type:Ke,json:{write:!0}})],tt.prototype,"pixelSize",void 0),m([b({type:tte,json:{write:!0}})],tt.prototype,"quantizationParameters",void 0),m([b({type:[Object],json:{write:!0}})],tt.prototype,"rangeValues",void 0),m([b({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],tt.prototype,"relationParameter",void 0),m([b({type:String,json:{write:!0}})],tt.prototype,"resultType",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"returnCentroid",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"returnDistinctValues",void 0),m([b({type:Boolean,json:{default:!0,write:!0}})],tt.prototype,"returnExceededLimitFeatures",void 0),m([b({type:Boolean,json:{write:!0}})],tt.prototype,"returnGeometry",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"returnQueryGeometry",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"returnM",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],tt.prototype,"returnZ",void 0),m([b({type:Ge,json:{write:!0}})],tt.prototype,"sourceSpatialReference",void 0),m([ze(FSe,{ignoreUnknown:!1,name:"spatialRel"})],tt.prototype,"spatialRelationship",void 0),m([b({type:Number,json:{read:{source:"resultOffset"}}})],tt.prototype,"start",void 0),m([Le("start"),Le("num")],tt.prototype,"writeStart",null),m([b({type:String,json:{write:!0}})],tt.prototype,"sqlFormat",void 0),m([b({type:String,json:{write:!0}})],tt.prototype,"text",void 0),m([b({type:Di,json:{write:!0}})],tt.prototype,"timeExtent",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],tt.prototype,"timeReferenceUnknownClient",void 0),m([ze(DSe,{ignoreUnknown:!1}),b({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null&&this.distance>0}}}}})],tt.prototype,"units",void 0),m([b({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],tt.prototype,"where",void 0),m([Le("where")],tt.prototype,"writeWhere",null),tt=qT=m([G("esri.rest.support.Query")],tt);const ec=tt;var nL;const Y9=new et({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),X9=new et({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Ec=nL=class extends ye{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:r,timeExtent:n,objectIds:o,units:u,distance:p}=this;return new ec({geometry:ae(i),objectIds:ae(o),spatialRelationship:r,timeExtent:ae(n),where:e,units:u,distance:p,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:r,objectIds:n,units:o,distance:u}=this;return new nL({geometry:ae(e),objectIds:ae(n),spatialRelationship:i,timeExtent:ae(r),where:t,units:o,distance:u})}};m([b({type:String,json:{write:!0}})],Ec.prototype,"where",void 0),m([b({types:h0,json:{write:!0}})],Ec.prototype,"geometry",void 0),m([b({type:Y9.apiValues,json:{name:"spatialRel",read:{reader:Y9.read},write:{allowNull:!1,writer:Y9.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],Ec.prototype,"spatialRelationship",void 0),m([b({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Ec.prototype,"distance",void 0),m([b({type:[Number],json:{write:!0}})],Ec.prototype,"objectIds",void 0),m([b({type:X9.apiValues,json:{read:X9.read,write:{writer:X9.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Ec.prototype,"units",void 0),m([b({type:Di,json:{write:!0}})],Ec.prototype,"timeExtent",void 0),Ec=nL=m([G("esri.layers.support.FeatureFilter")],Ec);const R2=Ec;var sL;const VV={read:{reader:$3},write:{writer:T3,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},zV={read:{reader:$3},write:{writer:T3,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},UV={name:"showExcludedLabels",default:!0};let gy=sL=class extends ye{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var r,n;const i=super.write(t,e);if(e!=null&&e.origin){if(i.filter){const o=Object.keys(i.filter);if(o.length>1||o[0]!=="where")return(r=e.messages)==null||r.push(new re("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return(n=e.messages)==null||n.push(new re("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new sL({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};m([b({type:R2,json:{write:{allowNull:!0,writer(t,e,i,r){const n=t==null?void 0:t.write({},r);n&&Object.keys(n).length!==0?Wn(i,n,e):Wn(i,null,e)}}}})],gy.prototype,"filter",void 0),m([b({json:{read:$3,write:{writer:T3,allowNull:!0},origins:{"web-map":VV,"portal-item":VV}}})],gy.prototype,"includedEffect",void 0),m([b({json:{read:$3,write:{writer:T3,allowNull:!0},origins:{"web-map":zV,"portal-item":zV}}})],gy.prototype,"excludedEffect",void 0),m([b({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":UV,"portal-item":UV}}})],gy.prototype,"excludedLabelsVisible",void 0),gy=sL=m([G("esri.layers.support.FeatureEffect")],gy);const jSe=gy,GV={write:{allowNull:!0}},VSe={type:jSe,json:{origins:{"web-map":GV,"portal-item":GV}}},zSe=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return m([b(VSe)],e.prototype,"featureEffect",void 0),e=m([G("esri.layers.mixins.FeatureEffectLayer")],e),e};var P_;const $E=dt()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),ite=$E.jsonValues.slice();Xue(ite,"orthometric");const F2=dt()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let vu=P_=class extends ye{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return $E.write(t,e,i)}readHeightModel(t,e,i){return $E.read(t)||(i!=null&&i.messages&&i.messages.push(USe(t,{context:i})),null)}readHeightUnit(t,e,i){return F2.read(t)||(i!=null&&i.messages&&i.messages.push(BV(t,{context:i})),null)}readHeightUnitService(t,e,i){return sZ(t)||F2.read(t)||(i!=null&&i.messages&&i.messages.push(BV(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new P_({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=oZ(e);return new P_({heightModel:t.heightModel,heightUnit:i??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new P_;return e.read(t,{origin:"web-scene"}),e}};function BV(t,e){return new Ul("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function USe(t,e){return new Ul("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}m([b({type:$E.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:ite,default:"ellipsoidal"}}}})],vu.prototype,"heightModel",void 0),m([Le("web-scene","heightModel")],vu.prototype,"writeHeightModel",null),m([Me(["web-scene","service"],"heightModel")],vu.prototype,"readHeightModel",null),m([b({type:F2.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:F2.jsonValues,write:F2.write}}}})],vu.prototype,"heightUnit",void 0),m([Me("web-scene","heightUnit")],vu.prototype,"readHeightUnit",null),m([Me("service","heightUnit")],vu.prototype,"readHeightUnitService",null),m([b({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],vu.prototype,"vertCRS",void 0),m([Me("service","vertCRS",["vertCRS","ellipsoid","geoid"])],vu.prototype,"readVertCRS",null),vu=P_=m([G("esri.geometry.HeightModelInfo")],vu);const _S=vu;var oL;let R_=oL=class extends ye{constructor(t){super(t)}async collectRequiredFields(t,e){return Qs(t,e,this.expression)}clone(){return new oL({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};m([b({type:String,json:{write:!0}})],R_.prototype,"expression",void 0),m([b({type:String,json:{write:!0}})],R_.prototype,"title",void 0),R_=oL=m([G("esri.symbols.support.FeatureExpressionInfo")],R_);const qV=R_;function sYe(t){return!!t&&fS[t]!=null}function GSe(t){return 1/(fS[t]||1)}function BSe(){const t=Object.keys(fS);return t.sort(),t}const qSe=BSe();var aL;const kx=dt()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),HV=new et({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Xh=aL=class extends ye{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,i,r){e[i]=t.write({},r),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new aL({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&vce(this.featureExpressionInfo,t.featureExpressionInfo)}};m([b({type:qV,json:{write:!0}})],Xh.prototype,"featureExpressionInfo",void 0),m([Me("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Xh.prototype,"readFeatureExpressionInfo",null),m([Le("featureExpressionInfo",{featureExpressionInfo:{type:qV},"featureExpression.value":{type:[0]}})],Xh.prototype,"writeFeatureExpressionInfo",null),m([b({type:kx.apiValues,nonNullable:!0,json:{type:kx.jsonValues,read:kx.read,write:{writer:kx.write,isRequired:!0}}})],Xh.prototype,"mode",null),m([b({type:Number,json:{write:!0}})],Xh.prototype,"offset",void 0),m([b({type:qSe,json:{type:String,read:HV.read,write:HV.write}})],Xh.prototype,"unit",null),Xh=aL=m([G("esri.symbols.support.ElevationInfo")],Xh);const rte=Xh,HSe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:ss}}},W8={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},J8={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:ss}}},WSe={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:km}}},JSe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:ss}}},ZSe={value:null,type:rte,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:ss}}};function oYe(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const nte={write:{enabled:!0,layerContainerTypes:ss},read:!0},lL={type:Number,json:{origins:{"web-document":nte,"portal-item":{write:!0}}}},KSe={...lL,json:{...lL.json,origins:{"web-document":{...nte,write:{enabled:!0,layerContainerTypes:ss,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>{var r;return i&&i.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?(r=e.layerDefinition)!=null&&r.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?l3(e.layerDefinition.drawingInfo.transparency):void 0:l3(e.drawingInfo.transparency)}}}},aYe={type:jt,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=jt.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(i.spatialReference=Ge.fromJSON(e.spatialReference)),i}}}},read:!1}},YSe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},XSe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:ss}}},name:"layerDefinition.minScale",write:!0}},QSe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:ss}}},name:"layerDefinition.maxScale",write:!0}},ste={json:{write:{ignoreOrigin:!0,layerContainerTypes:ss},origins:{"web-map":{read:!1,write:!1}}}};let Qh=class extends Gt(ye){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};m([b()],Qh.prototype,"creatorField",void 0),m([b()],Qh.prototype,"creationDateField",void 0),m([b()],Qh.prototype,"editorField",void 0),m([b()],Qh.prototype,"editDateField",void 0),m([b()],Qh.prototype,"realm",void 0),m([b(fE("dateFieldsTimeReference",!0))],Qh.prototype,"timeZone",void 0),Qh=m([G("esri.layers.support.EditFieldsInfo")],Qh);const exe=Qh;let Jc=class extends Gt(ye){constructor(e){super(e)}};m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"name",void 0),m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"fields",void 0),m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"isAscending",void 0),m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"indexType",void 0),m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"isUnique",void 0),m([b({constructOnly:!0,json:{write:!0}})],Jc.prototype,"description",void 0),Jc=m([G("esri.layers.support.FeatureIndex")],Jc);async function ote(t,e,i){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=ate(t));const r=txe(t),n=t.capabilities.query.supportsPagination;e.start=0,e.num=r;let o=null;for(;;){const u=await t.source.queryFeaturesJSON(e,i);if(o==null?o=u:o.features=o.features.concat(u.features),o.exceededTransferLimit=u.exceededTransferLimit,!n||!u.exceededTransferLimit)break;e.start+=r}return o}function txe(t){return ate(t)*ixe(t)}function ixe(t){return t.capabilities.query.maxRecordCount||2e3}function ate(t){return t.capabilities.query.supportsMaxRecordCountFactor?ec.MAX_MAX_RECORD_COUNT_FACTOR:1}var uL;let es=uL=class extends ye{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new uL(ae({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};m([b({type:[String],json:{write:!0}})],es.prototype,"attachmentTypes",void 0),m([b({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],es.prototype,"attachmentsWhere",void 0),m([b({type:Boolean,json:{write:!0}})],es.prototype,"cacheHint",void 0),m([b({type:[String],json:{write:!0}})],es.prototype,"keywords",void 0),m([b({type:[Number],json:{write:!0}})],es.prototype,"globalIds",void 0),m([b({json:{write:!0}})],es.prototype,"name",void 0),m([b({type:Number,json:{read:{source:"resultRecordCount"}}})],es.prototype,"num",void 0),m([b({type:[Number],json:{write:!0}})],es.prototype,"objectIds",void 0),m([b({type:Boolean,json:{default:!1,write:!0}})],es.prototype,"returnMetadata",void 0),m([b({type:[Number],json:{write:!0}})],es.prototype,"size",void 0),m([b({type:Number,json:{read:{source:"resultOffset"}}})],es.prototype,"start",void 0),m([Le("start"),Le("num")],es.prototype,"writeStart",null),m([b({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],es.prototype,"where",void 0),es=uL=m([G("esri.rest.support.AttachmentQuery")],es),es.from=Yi(es);const cL=es;var hL;let Sr=hL=class extends ye{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new hL(ae({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};m([b({type:Boolean,json:{write:!0}})],Sr.prototype,"cacheHint",void 0),m([b({type:Ru,json:{write:!0}})],Sr.prototype,"dynamicDataSource",void 0),m([b({type:String,json:{write:!0}})],Sr.prototype,"gdbVersion",void 0),m([b({type:Number,json:{write:!0}})],Sr.prototype,"geometryPrecision",void 0),m([b({type:Date})],Sr.prototype,"historicMoment",void 0),m([Le("historicMoment")],Sr.prototype,"_writeHistoricMoment",null),m([b({type:Number,json:{write:!0}})],Sr.prototype,"maxAllowableOffset",void 0),m([b({json:{write:!0}})],Sr.prototype,"objectIds",void 0),m([b({type:[String],json:{write:!0}})],Sr.prototype,"orderByFields",void 0),m([b({type:[String],json:{write:!0}})],Sr.prototype,"outFields",void 0),m([b({type:Ge,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Sr.prototype,"outSpatialReference",void 0),m([b({json:{write:!0}})],Sr.prototype,"relationshipId",void 0),m([b({type:Number,json:{read:{source:"resultOffset"}}})],Sr.prototype,"start",void 0),m([Le("start"),Le("num")],Sr.prototype,"writeStart",null),m([b({type:Number,json:{read:{source:"resultRecordCount"}}})],Sr.prototype,"num",void 0),m([b({json:{write:!0}})],Sr.prototype,"returnGeometry",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Sr.prototype,"returnM",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Sr.prototype,"returnZ",void 0),m([b({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Sr.prototype,"where",void 0),Sr=hL=m([G("esri.rest.support.RelationshipQuery")],Sr),Sr.from=Yi(Sr);const E3=Sr,cYe=Object.freeze(Object.defineProperty({__proto__:null,default:E3},Symbol.toStringTag,{value:"Module"})),pL=new et({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function rxe(t,e,i,r){const n=await m0(t);if(await Z8(t,e,r),!n.addAttachment)throw new re(r,"Layer source does not support addAttachment capability");return n.addAttachment(e,i)}function Z8(t,e,i){var o,u;const{attributes:r}=e,{objectIdField:n}=t;return(u=(o=t.capabilities)==null?void 0:o.data)!=null&&u.supportsAttachment?e?r?n&&r[n]?Promise.resolve():Promise.reject(new re(i,`feature is missing the identifying attribute ${n}`)):Promise.reject(new re(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new re(i,"A feature is required to add/delete/update attachments")):Promise.reject(new re(i,"this layer doesn't support attachments"))}async function nxe(t,e,i,r,n){const o=await m0(t);if(await Z8(t,e,n),!o.updateAttachment)throw new re(n,"Layer source does not support updateAttachment capability");return o.updateAttachment(e,i,r)}async function sxe(t,e,i){const{applyEdits:r}=await ie(()=>import("./editingSupport-CQxJG2oj.js"),[]),n=await t.load();let o=i;return n.type==="feature"&&n.infoFor3D&&e.deleteFeatures!=null&&n.globalIdField!=null&&(o={...o,globalIdToObjectId:await xxe(n,e.deleteFeatures,n.globalIdField)}),r(n,n.source,e,i)}async function oxe(t,e,i){const{uploadAssets:r}=await ie(()=>import("./editingSupport-CQxJG2oj.js"),[]),n=await t.load();return r(n,n.source,e,i)}async function axe(t,e,i,r){const n=await m0(t);if(await Z8(t,e,r),!n.deleteAttachments)throw new re(r,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(e,i)}async function lxe(t,e,i){const r=(await t.load({signal:e==null?void 0:e.signal})).source;if(!r.fetchRecomputedExtents)throw new re(i,"Layer source does not support fetchUpdates capability");return r.fetchRecomputedExtents(e)}async function uxe(t,e,i,r){var C,L;e=cL.from(e),await t.load();const n=t.source,o=t.capabilities;if(!((C=o==null?void 0:o.data)!=null&&C.supportsAttachment))throw new re(r,"this layer doesn't support attachments");const{attachmentTypes:u,objectIds:p,globalIds:g,num:w,size:S,start:T,where:E}=e;if(!((L=o==null?void 0:o.operations)!=null&&L.supportsQueryAttachments)&&((u==null?void 0:u.length)>0||(g==null?void 0:g.length)>0||(S==null?void 0:S.length)>0||w||T||E))throw new re(r,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(p!=null&&p.length||g!=null&&g.length||E))throw new re(r,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!n.queryAttachments)throw new re(r,"Layer source does not support queryAttachments capability",e);return n.queryAttachments(e)}async function cxe(t,e,i,r){const n=await m0(t);if(!n.queryObjectIds)throw new re(r,"Layer source does not support queryObjectIds capability");return n.queryObjectIds(ec.from(e)??t.createQuery(),i)}async function hxe(t,e,i,r){const n=await m0(t);if(!n.queryFeatureCount)throw new re(r,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount(ec.from(e)??t.createQuery(),i)}async function pxe(t,e,i,r){const n=await m0(t);if(!n.queryExtent)throw new re(r,"Layer source does not support queryExtent capability");return n.queryExtent(ec.from(e)??t.createQuery(),i)}async function dxe(t,e,i,r){const n=await m0(t);if(!n.queryRelatedFeatures)throw new re(r,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(E3.from(e),i)}async function fxe(t,e,i,r){const n=await m0(t);if(!n.queryRelatedFeaturesCount)throw new re(r,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(E3.from(e),i)}async function yxe(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:i,updates:r}=await e.refresh();if(r!=null&&(t.sourceJSON={...t.sourceJSON,...r},t.read(r,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await ZP(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function mxe(t){var u,p;const e=new ec,i=(u=t.capabilities)==null?void 0:u.data,r=(p=t.capabilities)==null?void 0:p.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference),i&&(i.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:n,timeExtent:o}=t;return e.timeExtent=n!=null&&o!=null?o.offset(-n.value,n.unit):o||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function lte(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeGlobalID")return r.name}}function ute(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeOID")return r.name}}function gxe(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function vxe(t,e){const{subtypes:i,subtypeField:r}=t;if(!e||!(i!=null&&i.length)||!r)return null;const n=e.attributes[r];return n==null?null:i.find(o=>o.code===n)}async function m0(t){return(await t.load()).source}async function bxe(t,e){if(!rt||rt.findCredential(t))return;let i;try{const r=await xP(t,e);r&&(i=await rt.checkSignInStatus(`${r}/sharing`))}catch{}if(i)try{const r=e!=null?e.signal:null;await rt.getCredential(t,{signal:r})}catch{}}async function wxe(t,e,i){var n;const r=(n=t.parsedUrl)==null?void 0:n.path;r&&t.authenticationTriggerEvent===e&&await bxe(r,i)}function _xe(t){return!HT(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const Q9=zb({types:uQ});function K8(t,e){var i;if(t.defaultSymbol)return(i=t.types)!=null&&i.length?new F8({defaultSymbol:Q9(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:Q9(r.symbol,r,e)}))}):new tw({symbol:Q9(t.defaultSymbol,t,e)})}function Sxe(t){var r,n,o;let e=(r=t.sourceJSON)==null?void 0:r.cacheMaxAge;if(!e)return!1;const i=(o=(n=t.editingInfo)==null?void 0:n.lastEditDate)==null?void 0:o.getTime();return i==null||(e*=1e3,Date.now()-i<e)}async function xxe(t,e,i){if(e==null)return null;const r=[],{objectIdField:n}=t;if(e.forEach(w=>{let S=null;if("attributes"in w){const{attributes:T}=w;S={globalId:T[i],objectId:T[n]!=null&&T[n]!==-1?T[n]:null}}else S={globalId:w.globalId,objectId:w.objectId!=null&&w.objectId!==-1?w.objectId:null};S.globalId!=null&&(S.objectId!=null&&S.objectId!==-1||r.push(S.globalId))}),r.length===0)return null;const o=t.createQuery();o.where=r.map(w=>`${i}='${w}'`).join(" OR "),o.returnGeometry=!1,o.outFields=[n,i],o.cacheHint=!1;const u=await gde(ote(t,o));if(!u.ok)return null;const p=new Map,g=u.value.features;for(const w of g){const S=w.attributes[i],T=w.attributes[n];S!=null&&T!=null&&T!==-1&&p.set(S,T)}return p}function $xe(t,e,i){if(!e||!i||!t)return null;const r=i.getAttribute(e);return r==null?null:t.find(n=>{const{id:o}=n;return o!=null&&o.toString()===r.toString()})??null}function HT(t){var e;return((e=t.sourceJSON)==null?void 0:e.isMultiServicesView)||Txe(t)}function Txe(t){var e,i;return!!((i=(e=t.sourceJSON)==null?void 0:e.capabilities)!=null&&i.toLowerCase().split(",").map(r=>r.trim()).includes("map"))}let d1=class extends Gt(ye){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};m([b({type:String,json:{read:{source:"shapeAreaFieldName"}}})],d1.prototype,"shapeAreaField",void 0),m([b({type:String,json:{read:{source:"shapeLengthFieldName"}}})],d1.prototype,"shapeLengthField",void 0),m([b({type:String,json:{read:t=>Yde.read(t)||Xde.read(t)}})],d1.prototype,"units",void 0),d1=m([G("esri.layers.support.GeometryFieldsInfo")],d1);const Exe=d1;var dL;let f1=dL=class extends ye{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Ie}clone(){return new dL({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};m([b({type:String,json:{write:!0}})],f1.prototype,"floorField",void 0),m([b({json:{read:!1,write:!1}})],f1.prototype,"viewAllMode",void 0),m([b({json:{read:!1,write:!1}})],f1.prototype,"viewAllLevelIds",void 0),f1=dL=m([G("esri.layers.support.LayerFloorInfo")],f1);const Ixe=f1,WV=new et({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),JV=new et({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let ll=class extends Gt(ye){constructor(e){super(e),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};m([b({json:{read:WV.read,write:WV.write}})],ll.prototype,"cardinality",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"composite",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"id",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"keyField",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"keyFieldInRelationshipTable",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"name",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"relatedTableId",void 0),m([b({json:{read:!0,write:!0}})],ll.prototype,"relationshipTableId",void 0),m([b({json:{read:JV.read,write:JV.write}})],ll.prototype,"role",void 0),ll=m([G("esri.layers.support.Relationship")],ll);const Mxe=ll;function Xe(t,e,i){return!!cte(t,e,i)}function F_(t,e,i){return cte(t,e,i)}function cte(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const kxe={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function Cxe(t){var i;const e=(i=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:i.map(r=>r.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function SS(t,e){var r;const i=(r=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:r.map(n=>n.toLowerCase());return!!(i!=null&&i.includes(e.toLowerCase()))}function hte(t,e){return{analytics:Axe(t),attachment:Lxe(t),data:Oxe(t),metadata:Pxe(t),operations:Rxe(t.capabilities,t,e),query:Fxe(t,e),queryRelated:Nxe(t),queryTopFeatures:Dxe(t),editing:jxe(t)}}function Axe(t){return{supportsCacheHint:SS(t.advancedQueryCapabilities,"queryAnalytics")}}function Lxe(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:SS(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:Xe(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(r=>{const n=kxe[r.name];n&&(i[n]=!!r.isEnabled)}),i}function Oxe(t){return{isVersioned:Xe(t,"isDataVersioned",!1),supportsAttachment:Xe(t,"hasAttachments",!1),supportsM:Xe(t,"hasM",!1),supportsZ:Xe(t,"hasZ",!1)}}function Pxe(t){return{supportsAdvancedFieldProperties:Xe(t,"supportsFieldDescriptionProperty",!1)}}function Rxe(t,e,i){const r=t?t.toLowerCase().split(",").map(E=>E.trim()):[],n=i?Zu(i):null,o=r.includes(n!=null&&n.serverType==="MapServer"?"data":"query"),u=r.includes("editing")&&!e.datesInUnknownTimezone;let p=u&&r.includes("create"),g=u&&r.includes("delete"),w=u&&r.includes("update");const S=r.includes("changetracking"),T=e.advancedQueryCapabilities;return u&&!(p||g||w)&&(p=g=w=!0),{supportsCalculate:Xe(e,"supportsCalculate",!1),supportsTruncate:Xe(e,"supportsTruncate",!1),supportsValidateSql:Xe(e,"supportsValidateSql",!1),supportsAdd:p,supportsDelete:g,supportsEditing:u,supportsChangeTracking:S,supportsQuery:o,supportsQueryAnalytics:Xe(T,"supportsQueryAnalytic",!1),supportsQueryAttachments:Xe(T,"supportsQueryAttachments",!1),supportsQueryTopFeatures:Xe(T,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:Xe(e,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:w,supportsExceedsLimitStatistics:Xe(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:Xe(e,"supportsAsyncConvert3D",!1)}}function Fxe(t,e){const i=t.advancedQueryCapabilities,r=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,o=t.currentVersion,u=e==null?void 0:e.includes("MapServer"),p=!u||o>=me("mapserver-pbf-version-support"),g=Bee(e),w=new Set((t.supportedQueryFormats??"").split(",").map(S=>S.toLowerCase().trim()));return{maxRecordCount:F_(t,"maxRecordCount",void 0),maxRecordCountFactor:F_(t,"maxRecordCountFactor",void 0),standardMaxRecordCount:F_(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:Cxe(i),supportsCacheHint:Xe(i,"supportsQueryWithCacheHint",!1)||SS(i,"query"),supportsCentroid:Xe(i,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:g,supportsDefaultSpatialReference:Xe(i,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:Xe(i,"supportsDisjointSpatialRel",!1),supportsDistance:Xe(i,"supportsQueryWithDistance",!1),supportsDistinct:Xe(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:Xe(i,"supportsReturningQueryExtent",!1),supportsFormatPBF:p&&w.has("pbf"),supportsFullTextSearch:Xe(i,"supportsFullTextSearch",!1),supportsGeometryProperties:Xe(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:Xe(i,"supportsHavingClause",!1),supportsHistoricMoment:Xe(n,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:Xe(i,"supportsMaxRecordCountFactor",!1),supportsOrderBy:Xe(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:Xe(i,"supportsPagination",!1),supportsPercentileStatistics:Xe(i,"supportsPercentileStatistics",!1),supportsQuantization:Xe(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Xe(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:Xe(r,"allowAnonymousToQuery",!0),supportsQueryByOthers:Xe(r,"allowOthersToQuery",!0),supportsQueryGeometry:Xe(t,"supportsReturningQueryGeometry",!1),supportsResultType:Xe(i,"supportsQueryWithResultType",!1),supportsSpatialAggregationStatistics:Xe(i,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:Xe(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Xe(t,"useStandardizedQueries",!1),supportsStatistics:Xe(i,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:Xe(i,"supportsTopFeaturesQuery",!1),tileMaxRecordCount:F_(t,"tileMaxRecordCount",void 0)}}function Nxe(t){const e=t.advancedQueryCapabilities,i=Xe(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Xe(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:SS(e,"queryRelated")}}function Dxe(t){return{supportsCacheHint:SS(t.advancedQueryCapabilities,"queryTopFilter")}}function jxe(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:Xe(t,"allowGeometryUpdates",!0),supportsGlobalId:Xe(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Xe(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Xe(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Xe(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Xe(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Xe(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Xe(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Xe(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Xe(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:Xe(i,"supportsAsyncApplyEdits",!1),zDefault:F_(t,"zDefault",void 0)}}function dYe(t){var e;return{operations:{supportsAppend:Xe(t,"supportsAppend",!1),supportsExportClip:Xe(t,"supportsExportClip",!1),supportsExportFrameset:Xe(t,"supportsExportFrameset",!1),supportsMensuration:Xe(t,"supportsMensuration",!1),supportsUpdate:Xe(t,"supportsUpdate",!1)},query:{supportsCoverageQuery:((e=t==null?void 0:t.playbackInfo)==null?void 0:e.klv["0601"])??!1}}}let ep=class extends Gt(ye){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const i={};for(const r of Object.keys(e))i[r]=pM(e[r]);return i}writeDomains(e,i){var n;if(!e)return;const r={};for(const o of Object.keys(e))e[o]&&(r[o]=(n=e[o])==null?void 0:n.toJSON());i.domains=r}};m([b({type:Number,json:{write:!0}})],ep.prototype,"code",void 0),m([b({type:Object,json:{write:!0}})],ep.prototype,"defaultValues",void 0),m([b({json:{write:!0}})],ep.prototype,"domains",void 0),m([Me("domains")],ep.prototype,"readDomains",null),m([Le("domains")],ep.prototype,"writeDomains",null),m([b({type:String,json:{write:!0}})],ep.prototype,"name",void 0),ep=m([G("esri.layers.support.Subtype")],ep);const fL=ep,Vxe=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(Ie.ofType(Jc)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=Ge.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:n,operations:o,editing:u}=i;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||o.supportsEditing&&!(u.supportsUpdateByOthers&&u.supportsUpdateByAnonymous&&u.supportsDeleteByOthers&&u.supportsDeleteByAnonymous))return"load"}if(this.userHasUpdateItemPrivileges){if(Sxe(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const r=this.editFieldsInfo;return(r!=null&&r.creatorField||r!=null&&r.editorField)&&(i!=null&&i.operations.supportsEditing)?"editing":null}readCapabilitiesFromService(i,r){return hte(r,this.url)}readEditingInfo(i,r){const{editingInfo:n}=r;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const r=ae(i),{operations:n,editing:o}=r;return HT(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),r):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=o.supportsDeleteByOthers=o.supportsGeometryUpdate=o.supportsUpdateByOthers=!0,r):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=o.supportsGeometryUpdate=!0),r)}readGlobalIdFieldFromService(i,r){return lte(r)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||HT(this))return!1;const{operations:r,editing:n}=i;return r.supportsEditing&&!(r.supportsAdd&&r.supportsDelete&&r.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:r,editing:n}=i;return HT(this)?!r.supportsQuery:!(r.supportsAdd&&r.supportsDelete&&r.supportsEditing&&r.supportsQuery&&r.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,r){return r.type==="Table"}readMaxScale(i,r){return r.effectiveMaxScale||i||0}readMinScale(i,r){return r.effectiveMinScale||i||0}readObjectIdFieldFromService(i,r){return ute(r)}readServiceDefinitionExpression(i,r){return r.definitionQuery||r.definitionExpression}set url(i){if(i==null)return void this._set("url",i);const r=rSe({layer:this,url:i,nonStandardUrlAllowed:!0,logger:fe.getLogger(this)});this._set("url",r.url),r.layerId!=null&&this._set("layerId",r.layerId)}writeUrl(i,r,n,o){nSe(this,i,null,r,o)}readVersion(i,r){return gxe(r)}};return m([b({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),m([b({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),m([b({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),m([Me("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),m([b(fE("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),m([b({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),m([b({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),m([b({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),m([b({readOnly:!0,type:exe})],e.prototype,"editFieldsInfo",void 0),m([b({readOnly:!0})],e.prototype,"editingInfo",void 0),m([Me("editingInfo")],e.prototype,"readEditingInfo",null),m([b({readOnly:!0})],e.prototype,"effectiveCapabilities",null),m([b((()=>{const i=ae(ZSe),r=i.json.origins;return r["web-map"]={read:!1,write:!1},r["portal-item"]={read:!1,write:!1},i})())],e.prototype,"elevationInfo",void 0),m([b({type:Ixe,json:{name:"layerDefinition.floorInfo",write:!0,origins:{"web-scene":{name:"layerDefinition.floorInfo",write:{enabled:!0,layerContainerTypes:ss}}}}})],e.prototype,"floorInfo",void 0),m([b({type:jt,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),m([b()],e.prototype,"gdbVersion",void 0),m([b({readOnly:!0,type:Exe,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),m([b({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:pL.read}}}})],e.prototype,"geometryType",void 0),m([b({type:String})],e.prototype,"globalIdField",void 0),m([Me("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),m([b({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),m([b({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),m([b({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),m([b({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),m([b({readOnly:!0,type:_S})],e.prototype,"heightModelInfo",void 0),m([b({type:Date})],e.prototype,"historicMoment",void 0),m([b({type:Ie.ofType(Jc),readOnly:!0})],e.prototype,"indexes",void 0),m([b({readOnly:!0})],e.prototype,"isTable",void 0),m([Me("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),m([b({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),m([b(QSe)],e.prototype,"maxScale",void 0),m([Me("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),m([b(XSe)],e.prototype,"minScale",void 0),m([Me("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),m([b({type:String})],e.prototype,"objectIdField",void 0),m([Me("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),m([b(fE("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),m([b({type:[Mxe],readOnly:!0})],e.prototype,"relationships",void 0),m([b({type:Boolean})],e.prototype,"returnM",void 0),m([b({type:Boolean})],e.prototype,"returnZ",void 0),m([b({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),m([b({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),m([Me("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),m([b({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),m([b()],e.prototype,"sourceJSON",void 0),m([b({type:Ge,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),m([b({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),m([b({type:[fL],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),m([b({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),m([b(WSe)],e.prototype,"url",null),m([Le("url")],e.prototype,"writeUrl",null),m([b({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),m([Me("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=m([G("esri.layers.mixins.FeatureLayerBase")],e),e};let y1=class extends Gt(ye){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};m([b({type:String,json:{write:!0}})],y1.prototype,"expression",void 0),m([b({type:String,json:{write:!0}})],y1.prototype,"title",void 0),m([b({type:String,json:{write:!0}})],y1.prototype,"returnType",void 0),y1=m([G("esri.layers.support.ExpressionInfo")],y1);const Y8=y1;var yL;let tp=yL=class extends ye{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new yL({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:ae(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};m([b({type:Boolean,json:{write:!0}})],tp.prototype,"isAutoGenerated",void 0),m([b({type:String,json:{write:!0}})],tp.prototype,"name",void 0),m([b({type:String,json:{write:!0}})],tp.prototype,"alias",void 0),m([b({type:String,json:{write:!0}})],tp.prototype,"onStatisticField",void 0),m([b({type:Y8,json:{write:!0}})],tp.prototype,"onStatisticExpression",void 0),m([b({type:String,json:{write:!0}})],tp.prototype,"statisticType",void 0),tp=yL=m([G("esri.layers.support.AggregateField")],tp);const Fm=tp;let Hf=class extends ye{constructor(){super(...arguments),this.type=null}};m([b({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Hf.prototype,"type",void 0),Hf=m([G("esri.layers.support.FeatureReduction")],Hf);const X8="__begin__",Q8="__end__",zxe=new RegExp(X8,"ig"),Uxe=new RegExp(Q8,"ig"),ZV=new RegExp("^"+X8,"i"),KV=new RegExp(Q8+"$","i"),TE='"',Gxe=TE+" + ",Bxe=" + "+TE;function qxe(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function Hxe(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function eR(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=qxe(t.labelExpression),e.type="conventional"),e}function Wxe(t){const e=eR(t);if(!e)return null;switch(e.type){case"conventional":return mL(e.expression);case"arcade":return e.expression}return null}function Jxe(t){const e=eR(t);if(!e)return null;switch(e.type){case"conventional":return Kxe(e.expression);case"arcade":return pte(e.expression)}return null}function mL(t){let e;return t?(e=Xu(t,i=>X8+'$feature["'+i+'"]'+Q8),e=ZV.test(e)?e.replace(ZV,""):TE+e,e=KV.test(e)?e.replace(KV,""):e+TE,e=e.replaceAll(zxe,Gxe).replaceAll(Uxe,Bxe)):e='""',e}const Zxe=/^\s*\{([^}]+)\}\s*$/i;function Kxe(t){const e=t==null?void 0:t.match(Zxe);return(e==null?void 0:e[1].trim())||null}const Yxe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,Xxe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Qxe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function pte(t){if(!t)return null;let e=Yxe.exec(t)||Xxe.exec(t);return e?e[1]||e[3]:(e=Qxe.exec(t),e?e[2]:null)}var gL;let qd=gL=class extends ye{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?mL(e.value):t}writeExpression(t,e,i){this.value!=null&&(t=mL(this.value)),t!=null&&(e[i]=t)}clone(){return new gL({expression:this.expression,title:this.title,value:this.value})}};m([b({type:String,json:{write:{writerEnsuresNonNull:!0}}})],qd.prototype,"expression",void 0),m([Me("expression",["expression","value"])],qd.prototype,"readExpression",null),m([Le("expression")],qd.prototype,"writeExpression",null),m([b({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],qd.prototype,"title",void 0),m([b({json:{read:!1,write:!1}})],qd.prototype,"value",void 0),qd=gL=m([G("esri.layers.support.LabelExpressionInfo")],qd);const dte=qd;var vL;const Cx=new et({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function Ax(t,e,i){return{enabled:!$Z(i==null?void 0:i.layer)}}function fte(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function e$e(t){return(t==null?void 0:t.type)==="map-image"}function yte(t){var e,i;return!!e$e(t)&&!!((i=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&i.supportsArcadeExpressionForLabeling)}function t$e(t){return fte(t)||yte(t==null?void 0:t.layer)}let Ur=vL=class extends ye{static evaluateWhere(t,e){const i=(r,n,o)=>{switch(n){case"=":return r==o;case"<>":return r!=o;case">":return r>o;case">=":return r>=o;case"<":return r<o;case"<=":return r<=o}return!1};try{if(t==null)return!0;const r=t.split(" ");if(r.length===3)return i(e[r[0]],r[1],r[2]);if(r.length===7){const n=i(e[r[0]],r[1],r[2]),o=r[3],u=i(e[r[4]],r[5],r[6]);switch(o){case"AND":return n&&u;case"OR":return n||u}}return!1}catch{}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=zwe,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=Hxe(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const r=pte(this.labelExpressionInfo.expression);r&&(t="["+r+"]")}}t!=null&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,r){if(t==null&&this.labelExpression!=null&&fte(r))t=new dte({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(r);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return eR(this)}getLabelExpressionArcade(){return Wxe(this)}getLabelExpressionSingleField(){return Jxe(this)}hash(){return JSON.stringify(this)}clone(){return new vL({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:ae(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:ae(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};m([b({type:String,json:{write:!0}})],Ur.prototype,"name",void 0),m([b({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:Ax}}}}})],Ur.prototype,"allowOverrun",void 0),m([b({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:Ax}}}}})],Ur.prototype,"deconflictionStrategy",void 0),m([b({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&yte(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],Ur.prototype,"labelExpression",void 0),m([Me("labelExpression")],Ur.prototype,"readLabelExpression",null),m([Le("labelExpression")],Ur.prototype,"writeLabelExpression",null),m([b({type:dte,json:{write:{overridePolicy:(t,e,i)=>t$e(i)?{allowNull:!0}:{enabled:!1}}}})],Ur.prototype,"labelExpressionInfo",void 0),m([Le("labelExpressionInfo")],Ur.prototype,"writeLabelExpressionInfo",null),m([b({type:Cx.apiValues,json:{type:Cx.jsonValues,read:Cx.read,write:Cx.write}})],Ur.prototype,"labelPlacement",void 0),m([b({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],Ur.prototype,"labelPosition",void 0),m([b({type:Number})],Ur.prototype,"maxScale",void 0),m([Le("maxScale")],Ur.prototype,"writeMaxScale",null),m([b({type:Number})],Ur.prototype,"minScale",void 0),m([Le("minScale")],Ur.prototype,"writeMinScale",null),m([b({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Ax}}}}})],Ur.prototype,"repeatLabel",void 0),m([b({type:Number,cast:Wt,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Ax}}}}})],Ur.prototype,"repeatLabelDistance",void 0),m([b({types:ewe,json:{origins:{"web-scene":{types:twe,write:Gj,default:null}},write:Gj,default:null}})],Ur.prototype,"symbol",void 0),m([b({type:Boolean,json:{write:!0}})],Ur.prototype,"useCodedValues",void 0),m([b({type:String,json:{write:!0}})],Ur.prototype,"where",void 0),Ur=vL=m([G("esri.layers.support.LabelClass")],Ur);const mM=Ur;var bL;let Ns=bL=class extends Hf{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=Wt("12px"),this.fields=[],this.renderer=null}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Wn(i,r,e)}readRenderer(t,e,i){var n;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return r?_3(r,e,i)??void 0:K8(e,i)}clone(){return new bL({fields:ae(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:ae(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:ae(this.popupTemplate),renderer:ae(this.renderer),binType:ae(this.binType),size:this.size})}};m([ze({binning:"binning"})],Ns.prototype,"type",void 0),m([ze({geohash:"geohash",square:"square"}),b({type:["geohash","square"]})],Ns.prototype,"binType",void 0),m([b({type:Number,json:{write:!0}})],Ns.prototype,"fixedBinLevel",void 0),m([b({type:[mM],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Ns.prototype,"labelingInfo",void 0),m([b(J8)],Ns.prototype,"labelsVisible",void 0),m([b({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Ns.prototype,"maxScale",void 0),m([b(W8)],Ns.prototype,"popupEnabled",void 0),m([b({type:Wm,json:{name:"popupInfo",write:!0}})],Ns.prototype,"popupTemplate",void 0),m([b({type:Number,cast:t=>t==="auto"?t:Wt(t)})],Ns.prototype,"size",void 0),m([b({type:[Fm],json:{write:!0}})],Ns.prototype,"fields",void 0),m([Le("fields")],Ns.prototype,"writeFields",null),m([b({types:cM,json:{write:{target:"drawingInfo.renderer"}}})],Ns.prototype,"renderer",void 0),m([Me("renderer",["drawingInfo.renderer"])],Ns.prototype,"readRenderer",null),Ns=bL=m([G("esri.layers.support.FeatureReductionBinning")],Ns);const mte=Ns;var wL;function YV(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let gn=wL=class extends ye{constructor(t){super(t),this.type="cluster",this.clusterRadius=Wt("80px"),this.clusterMinSize=Wt("12px"),this.clusterMaxSize=Wt("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,i){var n,o;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return(o=r==null?void 0:r.authoringInfo)!=null&&o.isAutoGenerated?null:r?YV(r)?null:_3(r,e,i)??void 0:K8(e,i)}readSymbol(t,e,i){var n,o;const r=(n=e.drawingInfo)==null?void 0:n.renderer;if((o=r==null?void 0:r.authoringInfo)!=null&&o.isAutoGenerated)return null;if(r&&YV(r)){const u=_3(r,e,i);return u==null?void 0:u.symbol}return null}writeSymbol(t,e,i,r){var o,u;const n=(u=(o=this.renderer)==null?void 0:o.authoringInfo)==null?void 0:u.isAutoGenerated;if(!this.renderer||n){const p=new tw({symbol:t});e.drawingInfo={renderer:p.write({},r)}}}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Wn(i,r,e)}readFields(t,e,i){return t.filter(r=>!r.isAutoGenerated).map(r=>Fm.fromJSON(r))}clone(){return new wL({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:ae(this.labelingInfo),labelsVisible:this.labelsVisible,fields:ae(this.fields),maxScale:this.maxScale,renderer:ae(this.renderer),symbol:ae(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:ae(this.popupTemplate)})}};m([b({type:["cluster"],readOnly:!0,json:{write:!0}})],gn.prototype,"type",void 0),m([b({type:Number,cast:t=>t==="auto"?t:Wt(t),json:{write:!0}})],gn.prototype,"clusterRadius",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],gn.prototype,"clusterMinSize",void 0),m([b({type:Number,cast:Wt,json:{write:!0}})],gn.prototype,"clusterMaxSize",void 0),m([b({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],gn.prototype,"maxScale",void 0),m([b(W8)],gn.prototype,"popupEnabled",void 0),m([b({type:Wm,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],gn.prototype,"popupTemplate",void 0),m([b({types:cM,json:{write:{target:"drawingInfo.renderer"}}})],gn.prototype,"renderer",void 0),m([Me("renderer",["drawingInfo.renderer"])],gn.prototype,"readRenderer",null),m([b({types:Xbe})],gn.prototype,"symbol",void 0),m([Me("symbol",["drawingInfo.renderer"])],gn.prototype,"readSymbol",null),m([Le("symbol")],gn.prototype,"writeSymbol",null),m([b({type:[mM],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],gn.prototype,"labelingInfo",void 0),m([b(J8)],gn.prototype,"labelsVisible",void 0),m([b({type:[Fm],json:{write:!0}})],gn.prototype,"fields",void 0),m([Le("fields")],gn.prototype,"writeFields",null),m([Me("fields")],gn.prototype,"readFields",null),gn=wL=m([G("esri.layers.support.FeatureReductionCluster")],gn);const gte=gn;var _L;let WT=_L=class extends Hf{constructor(t){super(t),this.type="selection"}clone(){return new _L}};m([b({type:["selection"]})],WT.prototype,"type",void 0),WT=_L=m([G("esri.layers.support.FeatureReductionSelection")],WT);const XV=WT,QV={key:"type",base:Hf,typeMap:{cluster:gte,binning:mte}},i$e={types:{key:"type",base:Hf,typeMap:{selection:XV,cluster:gte,binning:mte}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:QV},"portal-item":{types:QV},"web-scene":{types:{key:"type",base:Hf,typeMap:{selection:XV}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:ss}}}}},pg={Base64:0,Hex:1,String:2,Raw:3},Av=8,vte=(1<<Av)-1;function Nf(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function r$e(t){const e=[];for(let i=0,r=t.length*Av;i<r;i+=Av)e[i>>5]|=(t.charCodeAt(i/Av)&vte)<<i%32;return e}function n$e(t){const e=[];for(let i=0,r=32*t.length;i<r;i+=Av)e.push(String.fromCharCode(t[i>>5]>>>i%32&vte));return e.join("")}function s$e(t){const e="0123456789abcdef",i=[];for(let r=0,n=4*t.length;r<n;r++)i.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return i.join("")}function o$e(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let n=0,o=4*t.length;n<o;n+=3){const u=(t[n>>2]>>n%4*8&255)<<16|(t[n+1>>2]>>(n+1)%4*8&255)<<8|t[n+2>>2]>>(n+2)%4*8&255;for(let p=0;p<4;p++)8*n+6*p>32*t.length?r.push(e):r.push(i.charAt(u>>6*(3-p)&63))}return r.join("")}function a$e(t,e){return t<<e|t>>>32-e}function gM(t,e,i,r,n,o){return Nf(a$e(Nf(Nf(e,t),Nf(r,o)),n),i)}function Cs(t,e,i,r,n,o,u){return gM(e&i|~e&r,t,e,n,o,u)}function As(t,e,i,r,n,o,u){return gM(e&r|i&~r,t,e,n,o,u)}function Ls(t,e,i,r,n,o,u){return gM(e^i^r,t,e,n,o,u)}function Os(t,e,i,r,n,o,u){return gM(i^(e|~r),t,e,n,o,u)}function l$e(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,r=-271733879,n=-1732584194,o=271733878;for(let u=0;u<t.length;u+=16){const p=i,g=r,w=n,S=o;i=Cs(i,r,n,o,t[u],7,-680876936),o=Cs(o,i,r,n,t[u+1],12,-389564586),n=Cs(n,o,i,r,t[u+2],17,606105819),r=Cs(r,n,o,i,t[u+3],22,-1044525330),i=Cs(i,r,n,o,t[u+4],7,-176418897),o=Cs(o,i,r,n,t[u+5],12,1200080426),n=Cs(n,o,i,r,t[u+6],17,-1473231341),r=Cs(r,n,o,i,t[u+7],22,-45705983),i=Cs(i,r,n,o,t[u+8],7,1770035416),o=Cs(o,i,r,n,t[u+9],12,-1958414417),n=Cs(n,o,i,r,t[u+10],17,-42063),r=Cs(r,n,o,i,t[u+11],22,-1990404162),i=Cs(i,r,n,o,t[u+12],7,1804603682),o=Cs(o,i,r,n,t[u+13],12,-40341101),n=Cs(n,o,i,r,t[u+14],17,-1502002290),r=Cs(r,n,o,i,t[u+15],22,1236535329),i=As(i,r,n,o,t[u+1],5,-165796510),o=As(o,i,r,n,t[u+6],9,-1069501632),n=As(n,o,i,r,t[u+11],14,643717713),r=As(r,n,o,i,t[u],20,-373897302),i=As(i,r,n,o,t[u+5],5,-701558691),o=As(o,i,r,n,t[u+10],9,38016083),n=As(n,o,i,r,t[u+15],14,-660478335),r=As(r,n,o,i,t[u+4],20,-405537848),i=As(i,r,n,o,t[u+9],5,568446438),o=As(o,i,r,n,t[u+14],9,-1019803690),n=As(n,o,i,r,t[u+3],14,-187363961),r=As(r,n,o,i,t[u+8],20,1163531501),i=As(i,r,n,o,t[u+13],5,-1444681467),o=As(o,i,r,n,t[u+2],9,-51403784),n=As(n,o,i,r,t[u+7],14,1735328473),r=As(r,n,o,i,t[u+12],20,-1926607734),i=Ls(i,r,n,o,t[u+5],4,-378558),o=Ls(o,i,r,n,t[u+8],11,-2022574463),n=Ls(n,o,i,r,t[u+11],16,1839030562),r=Ls(r,n,o,i,t[u+14],23,-35309556),i=Ls(i,r,n,o,t[u+1],4,-1530992060),o=Ls(o,i,r,n,t[u+4],11,1272893353),n=Ls(n,o,i,r,t[u+7],16,-155497632),r=Ls(r,n,o,i,t[u+10],23,-1094730640),i=Ls(i,r,n,o,t[u+13],4,681279174),o=Ls(o,i,r,n,t[u],11,-358537222),n=Ls(n,o,i,r,t[u+3],16,-722521979),r=Ls(r,n,o,i,t[u+6],23,76029189),i=Ls(i,r,n,o,t[u+9],4,-640364487),o=Ls(o,i,r,n,t[u+12],11,-421815835),n=Ls(n,o,i,r,t[u+15],16,530742520),r=Ls(r,n,o,i,t[u+2],23,-995338651),i=Os(i,r,n,o,t[u],6,-198630844),o=Os(o,i,r,n,t[u+7],10,1126891415),n=Os(n,o,i,r,t[u+14],15,-1416354905),r=Os(r,n,o,i,t[u+5],21,-57434055),i=Os(i,r,n,o,t[u+12],6,1700485571),o=Os(o,i,r,n,t[u+3],10,-1894986606),n=Os(n,o,i,r,t[u+10],15,-1051523),r=Os(r,n,o,i,t[u+1],21,-2054922799),i=Os(i,r,n,o,t[u+8],6,1873313359),o=Os(o,i,r,n,t[u+15],10,-30611744),n=Os(n,o,i,r,t[u+6],15,-1560198380),r=Os(r,n,o,i,t[u+13],21,1309151649),i=Os(i,r,n,o,t[u+4],6,-145523070),o=Os(o,i,r,n,t[u+11],10,-1120210379),n=Os(n,o,i,r,t[u+2],15,718787259),r=Os(r,n,o,i,t[u+9],21,-343485551),i=Nf(i,p),r=Nf(r,g),n=Nf(n,w),o=Nf(o,S)}return[i,r,n,o]}function bte(t,e=pg.Hex){const i=e||pg.Base64,r=l$e(r$e(t),t.length*Av);switch(i){case pg.Raw:return r;case pg.Hex:return s$e(r);case pg.String:return n$e(r);case pg.Base64:return o$e(r)}}const u$e=()=>fe.getLogger("esri.views.2d.layers.support.clusterUtils");me.add("esri-cluster-arcade-enabled",!0);const c$e=me("esri-cluster-arcade-enabled"),h$e=new Set(["simple-line","simple-fill","picture-fill"]);function ez(t,e){let i=e.clone();if(!p$e(i))return i;if(e.getSymbols().some(r=>h$e.has(r.type))&&(i=new tw({symbol:new kn})),i.authoringInfo||(i.authoringInfo=new b8),i.authoringInfo.isAutoGenerated=!0,"visualVariables"in i){const r=(i.visualVariables||[]).filter(n=>n.valueExpression!=="$view.scale");r.forEach(n=>{n.type==="rotation"?n.field?n.field=T0(t,n.field,"avg_angle","number"):n.valueExpression&&(n.field=Tw(t,n.valueExpression,"avg_angle","number"),n.valueExpression=null):n.normalizationField?(n.field=T0(t,n.field,"avg_norm","number",n.normalizationField),n.normalizationField=null):n.field?n.field=T0(t,n.field,"avg","number"):n.valueExpression&&(n.field=Tw(t,n.valueExpression,"avg","number"),n.valueExpression=null)}),i.visualVariables=r}switch(i.type){case"simple":break;case"pie-chart":for(const r of i.attributes)r.field?r.field=T0(t,r.field,"sum","number"):r.valueExpression&&(r.field=Tw(t,r.valueExpression,"sum","number"),r.valueExpression=null);break;case"unique-value":i.field?i.field=T0(t,i.field,"mode","string"):i.valueExpression&&(i.field=Tw(t,i.valueExpression,"mode","string"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=T0(t,i.field,"avg_norm","number",i.normalizationField),i.normalizationField=null):i.field?i.field=T0(t,i.field,"avg","number"):i.valueExpression&&(i.field=Tw(t,i.valueExpression,"avg","number"),i.valueExpression=null)}return i}const p$e=t=>{const e=i=>u$e().error(new re("Unsupported-renderer",i,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if(i!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!c$e){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function d$e(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const r=i,n="field",o=e.toLowerCase()+",norm:"+n+","+r.toLowerCase();return"cluster_avg_"+bte(o)}}}function Tw(t,e,i,r){const n=bte(e),o=i==="mode"?`cluster_type_${n}`:i==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return t.some(u=>u.name===o)||t.push(new Fm({name:o,isAutoGenerated:!0,onStatisticExpression:new Y8({expression:e,returnType:r}),statisticType:i})),o}function T0(t,e,i,r,n){if(e==="cluster_count"||t.some(u=>u.name===e))return e;const o=d$e(i,e,n);return t.some(u=>u.name===o)||(i==="avg_norm"?t.push(new Fm({name:o,isAutoGenerated:!0,onStatisticExpression:new Y8({expression:`$feature.${e} / $feature.${n}`,returnType:r}),statisticType:"avg"})):t.push(new Fm({name:o,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),o}const f$e=t=>{let e=class extends t{constructor(...i){super(...i),this.addHandles(ce(()=>this.renderer,()=>{if(this.featureReduction){const r=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",r)}},$s))}set featureReduction(i){const r=this._normalizeFeatureReduction(i);this._set("featureReduction",r)}set renderer(i){}_withClusterVariable(i,r,n){const o=i.clone();return"visualVariables"in o&&(o.visualVariables||(o.visualVariables=[]),o.visualVariables.some(u=>u.type==="size")||o.visualVariables.push(new mS({field:"cluster_count",stops:[new ET({value:1}),new ET({useMinValue:!0,size:r}),new ET({useMaxValue:!0,size:n})]}))),o}_normalizeFeatureReduction(i){var T;if((i==null?void 0:i.type)!=="cluster")return i;const r=i.clone(),n=[new Fm({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(r.fields??[]).filter(E=>!E.isAutoGenerated),u=i.renderer&&!((T=i.renderer.authoringInfo)!=null&&T.isAutoGenerated),{clusterMinSize:p,clusterMaxSize:g}=r;if(u){r.fields=[...n,...o];const E=this._withClusterVariable(r.renderer,p,g);return r.effectiveFeatureRenderer=E,r.effectiveClusterRenderer=E,r}if(i.symbol){if(r.fields=[...n,...o],r.renderer=null,!this.renderer)return r.effectiveFeatureRenderer=null,r.effectiveClusterRenderer=null,r;const E=ez(n,this.renderer),C=this._withClusterVariable(E,p,g),L="visualVariables"in C&&C.visualVariables?C.visualVariables:[],R=new tw({symbol:i.symbol,visualVariables:L});return r.fields=[...n,...o],r.effectiveFeatureRenderer=C,r.effectiveClusterRenderer=R,r}if(!this.renderer)return i;const w=ez(n,this.renderer);r.fields=[...n,...o],r.renderer=w;const S=this._withClusterVariable(w,p,g);return r.effectiveFeatureRenderer=S,r.effectiveClusterRenderer=S,r}};return m([b(i$e)],e.prototype,"featureReduction",null),e=m([G("esri.layers.mixins.FeatureReductionLayer")],e),e},tz={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},iz={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},rz={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},y$e={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,Voxel:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":tz,"web-map/basemap":iz,"web-map/tables":rz,"link-chart/operational-layers":{...tz,LinkChartLayer:!0},"link-chart/basemap":iz,"link-chart/tables":rz,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0}},m$e=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,r,n){var o;return((o=n==null?void 0:n.portalItem)==null?void 0:o.type)==="Group Layer"?void 0:i}writeListMode(i,r,n,o){(o&&o.layerContainerType==="ground"||i&&lpe(this,n,{},o))&&(r[n]=i)}writeOperationalLayerType(i,r,n,o){i&&(o==null?void 0:o.layerContainerType)!=="tables"&&(r.layerType=i)}writeTitle(i,r){r.title=i??"Layer"}readTimeExtent(i){return i?Di.fromArray(i):null}writeTimeExtent(i,r,n,o){i&&o.layerContainerType!=="tables"&&(i.isEmpty?o!=null&&o.messages&&o.messages.push(new re("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):r[n]=i.toArray())}read(i,r){r&&(r.layer=this),$J(this,i,n=>super.read(i,n),r)}write(i,r){var u,p;if(!this.persistenceEnabled&&!(r!=null&&r.ignorePersistenceEnabled))return null;if(r!=null&&r.origin){const g=`${r.origin}/${r.layerContainerType||"operational-layers"}`,w=y$e[g];let S=!!(w!=null&&w[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&g==="web-scene/operational-layers"&&(S=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&g==="web-map/operational-layers"&&(S=!1),!S)return(u=r.messages)==null||u.push(new re("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${g}'`,{layer:this})),null}const n=super.write(i,{...r,layer:this}),o=!!r&&!!r.messages&&!!r.messages.filter(g=>g instanceof re&&g.name==="web-document-write:property-required").length;return AI(n==null?void 0:n.url)?((p=r==null?void 0:r.messages)==null||p.push(new re("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:n}beforeSave(){}};return m([b({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),m([Me("id",["id"])],e.prototype,"readId",null),m([b(ste)],e.prototype,"listMode",void 0),m([Le("listMode")],e.prototype,"writeListMode",null),m([b({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:ss}}}}})],e.prototype,"operationalLayerType",void 0),m([Le("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),m([b(lL)],e.prototype,"opacity",void 0),m([b({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),m([b({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),m([Le("title"),Le(["web-scene"],"title")],e.prototype,"writeTitle",null),m([b({type:Di,json:{origins:{"web-scene":{write:{layerContainerTypes:ss}}}}})],e.prototype,"visibilityTimeExtent",void 0),m([Me("visibilityTimeExtent")],e.prototype,"readTimeExtent",null),m([Le(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[zt,Vb]]}})],e.prototype,"writeTimeExtent",null),m([b({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:ss}}},name:"visibility",write:!0}})],e.prototype,"visible",void 0),e=m([G("esri.layers.mixins.OperationalLayer")],e),e};var SL;const Lx=new et({asc:"ascending",desc:"descending"});let m1=SL=class extends ye{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new SL({field:this.field,valueExpression:this.valueExpression,order:this.order})}};m([b({type:String,json:{write:!0}})],m1.prototype,"field",void 0),m([b({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],m1.prototype,"valueExpression",void 0),m([b({type:Lx.apiValues,json:{type:Lx.jsonValues,read:Lx.read,write:Lx.write}})],m1.prototype,"order",void 0),m1=SL=m([G("esri.layers.support.OrderByInfo")],m1);const wte=m1;function g$e(t,e,i){if(!t)return null;const r=t.find(o=>!!o.field);if(!r)return null;const n=new wte;return n.read(r,i),[n]}function v$e(t,e,i,r){const n=t.find(o=>!!o.field);n&&Wn(i,[n.toJSON()],e)}const b$e={type:[wte],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:g$e},write:{writer:v$e}}},w$e=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return m([b(b$e)],e.prototype,"orderBy",void 0),e=m([G("esri.layers.mixins.OrderedLayer")],e),e},go=Math.PI/180,_$e=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,bd=Nr.radius,eu=Nr.eccentricitySquared,S$e={a1:bd*eu,a2:bd*eu*bd*eu,a3:bd*eu*eu/2,a4:bd*eu*bd*eu*2.5,a5:bd*eu+bd*eu*eu/2,a6:1-eu},x$e={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Nr.radius,f:Nr.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Xf.radius,f:Xf.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:ah.radius,f:ah.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:ah.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var ue;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"})(ue||(ue={}));const N_={[ue.WGS84]:{[ue.CGCS2000]:mr,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:mr,[ue.SPHERICAL_ECEF]:D2,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:Lv,[ue.PLATE_CARREE]:Ov,[ue.WGS84]:mr,[ue.WGS84_ECEF]:Fv},[ue.CGCS2000]:{[ue.CGCS2000]:mr,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:mr,[ue.SPHERICAL_ECEF]:D2,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:Lv,[ue.PLATE_CARREE]:Ov,[ue.WGS84]:mr,[ue.WGS84_ECEF]:Fv},[ue.GCSMARS2000]:{[ue.CGCS2000]:null,[ue.GCSMARS2000]:mr,[ue.GCSMOON2000]:null,[ue.LON_LAT]:mr,[ue.SPHERICAL_ECEF]:null,[ue.SPHERICAL_MARS_PCPF]:sz,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:null,[ue.PLATE_CARREE]:null,[ue.WGS84]:null,[ue.WGS84_ECEF]:null},[ue.GCSMOON2000]:{[ue.CGCS2000]:null,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:mr,[ue.LON_LAT]:mr,[ue.SPHERICAL_ECEF]:null,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:nz,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:null,[ue.PLATE_CARREE]:null,[ue.WGS84]:null,[ue.WGS84_ECEF]:null},[ue.WEB_MERCATOR]:{[ue.CGCS2000]:N2,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:N2,[ue.SPHERICAL_ECEF]:$$e,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:mr,[ue.PLATE_CARREE]:I$e,[ue.WGS84]:N2,[ue.WGS84_ECEF]:T$e},[ue.WGS84_ECEF]:{[ue.CGCS2000]:Nv,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:Nv,[ue.SPHERICAL_ECEF]:F$e,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:N$e,[ue.PLATE_CARREE]:M$e,[ue.WGS84]:Nv,[ue.WGS84_ECEF]:mr},[ue.SPHERICAL_ECEF]:{[ue.CGCS2000]:Rv,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:Rv,[ue.SPHERICAL_ECEF]:mr,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:O$e,[ue.PLATE_CARREE]:k$e,[ue.WGS84]:Rv,[ue.WGS84_ECEF]:P$e},[ue.SPHERICAL_MARS_PCPF]:{[ue.CGCS2000]:null,[ue.GCSMARS2000]:az,[ue.GCSMOON2000]:null,[ue.LON_LAT]:az,[ue.SPHERICAL_ECEF]:null,[ue.SPHERICAL_MARS_PCPF]:mr,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:null,[ue.PLATE_CARREE]:null,[ue.WGS84]:null,[ue.WGS84_ECEF]:null},[ue.SPHERICAL_MOON_PCPF]:{[ue.CGCS2000]:null,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:oz,[ue.LON_LAT]:oz,[ue.SPHERICAL_ECEF]:null,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:mr,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:null,[ue.PLATE_CARREE]:null,[ue.WGS84]:null,[ue.WGS84_ECEF]:null},[ue.UNKNOWN]:{[ue.CGCS2000]:null,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:null,[ue.SPHERICAL_ECEF]:null,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:mr,[ue.WEB_MERCATOR]:null,[ue.PLATE_CARREE]:null,[ue.WGS84]:null,[ue.WGS84_ECEF]:null},[ue.LON_LAT]:{[ue.CGCS2000]:mr,[ue.GCSMARS2000]:mr,[ue.GCSMOON2000]:mr,[ue.LON_LAT]:mr,[ue.SPHERICAL_ECEF]:D2,[ue.SPHERICAL_MARS_PCPF]:sz,[ue.SPHERICAL_MOON_PCPF]:nz,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:Lv,[ue.PLATE_CARREE]:Ov,[ue.WGS84]:mr,[ue.WGS84_ECEF]:Fv},[ue.PLATE_CARREE]:{[ue.CGCS2000]:Pv,[ue.GCSMARS2000]:null,[ue.GCSMOON2000]:null,[ue.LON_LAT]:Pv,[ue.SPHERICAL_ECEF]:C$e,[ue.SPHERICAL_MARS_PCPF]:null,[ue.SPHERICAL_MOON_PCPF]:null,[ue.UNKNOWN]:null,[ue.WEB_MERCATOR]:A$e,[ue.PLATE_CARREE]:mr,[ue.WGS84]:Pv,[ue.WGS84_ECEF]:L$e}};function vM(t,e,i=_te()){return t==null||e==null?null:D$e(t,e,i).projector}function EE(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=hr(t,1)),sE(t)?e.spatialReferenceId=ue.SPHERICAL_ECEF:Qf(t)?e.spatialReferenceId=ue.WGS84:ea(t)?e.spatialReferenceId=ue.WEB_MERCATOR:X4(t)?e.spatialReferenceId=ue.PLATE_CARREE:t.wkt===iZ.wkt?e.spatialReferenceId=ue.WGS84_ECEF:t.wkid===$m.CGCS2000?e.spatialReferenceId=ue.CGCS2000:t.wkt===LI.wkt?e.spatialReferenceId=ue.SPHERICAL_MARS_PCPF:t.wkt===OI.wkt?e.spatialReferenceId=ue.SPHERICAL_MOON_PCPF:YJ(t)?e.spatialReferenceId=ue.GCSMARS2000:XJ(t)?e.spatialReferenceId=ue.GCSMOON2000:e.spatialReferenceId=ue.UNKNOWN):ue.UNKNOWN}function mr(t,e,i,r){t!==i&&(i[r++]=t[e++],i[r++]=t[e++],i[r]=t[e])}function N2(t,e,i,r){i[r]=bb*(t[e]/pm),i[r+1]=bb*(xte-2*Math.atan(Math.exp(-t[e+1]/pm))),i[r+2]=t[e+2]}function $$e(t,e,i,r){const n=t[e]/pm,o=xte-2*Math.atan(Math.exp(-t[e+1]/pm)),u=pm+t[e+2],p=Math.cos(o)*u;i[r]=Math.cos(n)*p,i[r+1]=Math.sin(n)*p,i[r+2]=Math.sin(o)*u}function T$e(t,e,i,r){N2(t,e,i,r),Fv(i,r,i,r)}function E$e(t,e,i,r,n){const o=.4999999*bM,u=An(vb*t[e+1],-o,o),p=Math.sin(u);i[r++]=vb*t[e]*n.radius,i[r++]=n.halfSemiMajorAxis*Math.log((1+p)/(1-p)),i[r]=t[e+2]}function Lv(t,e,i,r){E$e(t,e,i,r,Nr)}function Ov(t,e,i,r){i[r]=t[e]*lz,i[r+1]=t[e+1]*lz,i[r+2]=t[e+2]}function Pv(t,e,i,r){i[r]=t[e]*uz,i[r+1]=t[e+1]*uz,i[r+2]=t[e+2]}function I$e(t,e,i,r){N2(t,e,i,r),Ov(i,r,i,r)}function M$e(t,e,i,r){Nv(t,e,i,r),Ov(i,r,i,r)}function k$e(t,e,i,r){Rv(t,e,i,r),Ov(i,r,i,r)}function C$e(t,e,i,r){Pv(t,e,i,r),D2(i,r,i,r)}function A$e(t,e,i,r){Pv(t,e,i,r),Lv(i,r,i,r)}function L$e(t,e,i,r){Pv(t,e,i,r),Fv(i,r,i,r)}function tR(t,e,i,r,n){const o=n+t[e+2],u=vb*t[e+1],p=vb*t[e],g=Math.cos(u)*o;i[r]=Math.cos(p)*g,i[r+1]=Math.sin(p)*g,i[r+2]=Math.sin(u)*o}function nz(t,e,i,r){tR(t,e,i,r,Xf.radius)}function sz(t,e,i,r){tR(t,e,i,r,ah.radius)}function D2(t,e,i,r){tR(t,e,i,r,Nr.radius)}function iR(t,e,i,r,n){const o=t[e],u=t[e+1],p=t[e+2],g=Math.sqrt(o*o+u*u+p*p),w=kP(p/(g===0?1:g)),S=Math.atan2(u,o);i[r++]=bb*S,i[r++]=bb*w,i[r]=g-n}function oz(t,e,i,r){iR(t,e,i,r,Xf.radius)}function az(t,e,i,r){iR(t,e,i,r,ah.radius)}function Rv(t,e,i,r){iR(t,e,i,r,Nr.radius)}function O$e(t,e,i,r){Rv(t,e,i,r),Lv(i,r,i,r)}function P$e(t,e,i,r){Rv(t,e,i,r),Fv(i,r,i,r)}function R$e(t,e,i,r,n){const o=vb*t[e],u=vb*t[e+1],p=t[e+2],g=Math.sin(u),w=Math.cos(u),S=n.radius/Math.sqrt(1-n.eccentricitySquared*g*g);i[r++]=(S+p)*w*Math.cos(o),i[r++]=(S+p)*w*Math.sin(o),i[r++]=(S*(1-n.eccentricitySquared)+p)*g}function Fv(t,e,i,r){R$e(t,e,i,r,Nr)}function Nv(t,e,i,r){const n=S$e,o=t[e],u=t[e+1],p=t[e+2];let g,w,S,T,E,C,L,R,F,V,U,W,H,J,X,te,oe,pe,de,ge,we;g=Math.abs(p),w=o*o+u*u,S=Math.sqrt(w),T=w+p*p,E=Math.sqrt(T),ge=Math.atan2(u,o),C=p*p/T,L=w/T,J=n.a2/E,X=n.a3-n.a4/E,L>.3?(R=g/E*(1+L*(n.a1+J+C*X)/E),de=Math.asin(R),V=R*R,F=Math.sqrt(1-V)):(F=S/E*(1-C*(n.a5-J-L*X)/E),de=Math.acos(F),V=1-F*F,R=Math.sqrt(V)),U=1-Nr.eccentricitySquared*V,W=Nr.radius/Math.sqrt(U),H=n.a6*W,J=S-W*F,X=g-H*R,oe=F*J+R*X,te=F*X-R*J,pe=te/(H/U+oe),de+=pe,we=oe+te*pe/2,p<0&&(de=-de),i[r++]=bb*ge,i[r++]=bb*de,i[r]=we}function F$e(t,e,i,r){Nv(t,e,i,r),D2(i,r,i,r)}function N$e(t,e,i,r){Nv(t,e,i,r),Lv(i,r,i,r)}function D$e(t,e,i){if(t==null||e==null||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const r=EE(t,i.source),n=EE(e,i.dest);return r===ue.UNKNOWN&&n===ue.UNKNOWN?Ki(t,e)?i.projector=mr:i.projector=null:i.projector=N_[r][n],i}function _te(){return{source:{spatialReference:null,spatialReferenceId:ue.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:ue.UNKNOWN,metersPerUnit:1},projector:mr}}const j$e={spatialReference:null,spatialReferenceId:ue.UNKNOWN},V$e={spatialReference:null,spatialReferenceId:ue.UNKNOWN},Ste=_te(),vb=tS(1),bb=GZ(1),bM=Math.PI,xte=.5*bM,pm=Nr.radius,lz=pm*bM/180,uz=180/(pm*bM);function Th(t,e,i,r,n,o,u=1){const p=vM(e,n,Ste);if(p==null)return!1;if(p===mr){if(t===r&&i===o)return!0;const w=i+3*u;for(let S=i,T=o;S<w;S++,T++)r[T]=t[S];return!0}const g=i+3*u;for(let w=i,S=o;w<g;w+=3,S+=3)p(t,w,r,S);return!0}const gYe=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:Th},Symbol.toStringTag,{value:"Module"}));function cz(t,e,i,r,n,o){return Ox[0]=t,Ox[1]=e,Ox[2]=i,Th(Ox,r,0,n,o,0,1)}const Ox=be();let Px=0,ek=class xL{static fromGE(e){const i=new xL;return i._wkt=e.wkt,i._wkid=e.wkid,i._isInverse=e.isInverse,i}constructor(e){this.uid=Px++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=Px++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=Px++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=Px++}getInverse(){const e=new xL;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},IE=class D_{static cacheKey(e,i){var r,n,o,u,p,g;return[((r=e.wkid)==null?void 0:r.toString())??"-1",((n=e.wkt)==null?void 0:n.toString())??"",((o=e.wkt2)==null?void 0:o.toString())??"",((u=i.wkid)==null?void 0:u.toString())??"-1",((p=i.wkt)==null?void 0:p.toString())??"",((g=i.wkt2)==null?void 0:g.toString())??""].join()}static fromGE(e){const i=new D_;let r="";for(const n of e.steps){const o=ek.fromGE(n);i.steps.push(o),r+=o.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e==null?void 0:e.steps)for(const i of e.steps)i instanceof ek?this.steps.push(i):this.steps.push(new ek({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const e=new D_;e.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];e.steps.push(r.getInverse())}return e}getGTListEntry(){let e="";for(const i of this.steps)e+=i.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,i,r){this._cachedProjection[D_.cacheKey(e,i)]=r}getCachedGeTransformation(e,i){let r="";for(const o of this.steps)r+=o.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const n=this._cachedProjection[D_.cacheKey(e,i)];return n===void 0?null:n}},Ku=null,n0=null,j2=null,JT={};const rR=new Gb;function Eh(){return!!Ku&&cP()}function $te(){return!!Eh()||(He(rR),gh(),!1)}function Tte(t,e){return!t||!e||Ba(t,e)||$te()}function z$e(t,e){return!Ba(t,e)&&!Eh()}function gh(t){return j2==null&&(j2=Promise.all([HJ(),ie(()=>Promise.resolve().then(()=>G8e),void 0).then(e=>e.g),ie(()=>Promise.resolve().then(()=>K8e),void 0)])),j2.then(([,e,{hydratedAdapter:i}])=>{At(t),n0=i,Ku=e.default,Ku._enableProjection(Sde),rR.notify()})}function Ts(t,e,i=null,r=null){return Array.isArray(t)?t.length===0?[]:$L(n0,t,t[0].spatialReference,e,i,r):$L(n0,[t],t.spatialReference,e,i,r)[0]}function $L(t,e,i,r,n=null,o=null){if(i==null||r==null)return e;if(Ba(i,r,n))return e.map(u=>ZT(u,i,r));if(n==null&&sE(i))return e.map(u=>ZT(u,i,Ge.WGS84)).map(u=>wb(u,r));if(n==null&&sE(r))return e.map(u=>wb(u,Ge.WGS84)).map(u=>ZT(u,Ge.WGS84,r));if(n==null){const u=IE.cacheKey(i,r);JT[u]!==void 0?n=JT[u]:((n=Mte(i,r,void 0))==null&&(n=new IE),JT[u]=n)}if(Ku==null||t==null)throw new wM;return o!=null?Ku._project(t,e,i,r,n,o):Ku._project(t,e,i,r,n)}function Ete(t,e){const i=Ite([t],e);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function Ite(t,e){if(!Eh()){for(const i of t)if(i!=null&&!Ki(i.spatialReference,e)&&Jo(i.spatialReference)&&Jo(e)&&!Ba(i.spatialReference,e))return He(rR),{pending:gh(),geometries:null}}return{pending:null,geometries:t.map(i=>i==null?null:Ki(i.spatialReference,e)?i:Jo(i.spatialReference)&&Jo(e)?wb(i,e):null)}}function Mte(t,e,i=null){if(t==null||e==null)return null;if(Ku==null||n0==null)throw new wM;const r=Ku._getTransformation(n0,t,e,i,i==null?void 0:i.spatialReference);return r!==null?IE.fromGE(r):null}function U$e(t,e,i=null){if(Ku==null||n0==null)throw new wM;const r=Ku._getTransformationBySuitability(n0,t,e,i,i==null?void 0:i.spatialReference);if(r!==null){const n=[];for(const o of r)n.push(IE.fromGE(o));return n}return[]}let wM=class extends re{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function G$e(){Ku=null,n0=null,j2=null,JT={}}const B$e={get loadPromise(){return j2}};function wb(t,e){try{const i=Ts(t,e);if(i==null)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const r=Vee(i.type,t.spatialReference,e);return r!=null&&r(i),i}catch(i){if(!(i instanceof wM))throw i;return null}}async function q$e(t,e,i){const r=t.spatialReference;return r!=null&&e!=null&&await vh(r,e,null,i),wb(t,e)}function Ba(t,e,i){return!i&&(!!Ki(t,e)||Jo(t)&&Jo(e)&&!!vM(t,e,Ste))}function H$e(t,e){if(Ki(t,e))return!0;if(!Jo(t)||!Jo(e))return!1;const i=Qf(t)||ea(t)||sD(t),r=Qf(e)||ea(e)||sD(e);return i&&r}async function vh(t,e,i,r){if(Eh())return RN(r);if(Array.isArray(t)){for(const{source:n,dest:o,geographicTransformation:u}of t)if(n&&o&&!Ba(n,o,u))return gh(r)}else if(t&&e&&!Ba(t,e,i))return gh(r);return RN(r)}function ZT(t,e,i){return t?"x"in t?kte(t,e,new Ke,i,0):"xmin"in t?Ote(t,e,new jt,i,0):"rings"in t?Lte(t,e,new xo,i,0):"paths"in t?Ate(t,e,new Bn,i,0):"points"in t?Cte(t,e,new lh,i,0):null:null}function W$e(t,e,i=e.spatialReference,r=0){return i!=null&&t.spatialReference!=null&&kte(t,t.spatialReference,e,i,r)!=null}function kte(t,e,i,r,n){qs[0]=t.x,qs[1]=t.y;const o=t.z;return qs[2]=o!==void 0?o:n,Th(qs,e,0,qs,r,0,1)?(i.x=qs[0],i.y=qs[1],i.spatialReference=r,o!==void 0||e0(r)?(i.z=qs[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),t.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function J$e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Cte(t,t.spatialReference,e,i,r)!=null}function Cte(t,e,i,r,n){const{points:o,hasZ:u,hasM:p}=t,g=[],w=o.length,S=[];for(const E of o)S.push(E[0],E[1],u?E[2]:n);if(!Th(S,e,0,S,r,0,w))return null;const T=u||e0(r);for(let E=0;E<w;++E){const C=3*E,L=S[C],R=S[C+1];T&&p?g.push([L,R,S[C+2],o[E][3]]):T?g.push([L,R,S[C+2]]):p?g.push([L,R,o[E][2]]):g.push([L,R])}return i.points=g,i.spatialReference=r,i.hasZ=u,i.hasM=p,i}function Z$e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Ate(t,t.spatialReference,e,i,r)!=null}function Ate(t,e,i,r,n){const{paths:o,hasZ:u,hasM:p}=t,g=[];if(!Pte(o,u??!1,p??!1,e,g,r,n))return null;const w=u||e0(r);return i.paths=g,i.spatialReference=r,i.hasZ=w,i.hasM=p,i}function K$e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Lte(t,t.spatialReference,e,i,r)!=null}function Lte(t,e,i,r,n){const{rings:o,hasZ:u,hasM:p}=t,g=[];if(!Pte(o,u??!1,p??!1,e,g,r,n))return null;const w=u||e0(r);return i.rings=g,i.spatialReference=r,i.hasZ=w,i.hasM=p,i}function Y$e(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Ote(t,t.spatialReference,e,i,r)!=null}function Ote(t,e,i,r,n){const{xmin:o,ymin:u,xmax:p,ymax:g,hasZ:w,hasM:S}=t,T=w?t.zmin:n;if(!cz(o,u,T,e,qs,r))return null;const E=w||e0(r);i.xmin=qs[0],i.ymin=qs[1],E&&(i.zmin=qs[2]);const C=w?t.zmax:n;return cz(p,g,C,e,qs,r)?(i.xmax=qs[0],i.ymax=qs[1],E&&(i.zmax=qs[2]),S&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=r,i):null}function Pte(t,e,i,r,n,o,u=0){const p=new Array;for(const S of t)for(const T of S)p.push(T[0],T[1],e?T[2]:u);if(!Th(p,r,0,p,o,0,p.length/3))return!1;let g=0;n.length=0;const w=e||e0(o);for(const S of t){const T=new Array;for(const E of S)w&&i?T.push([p[g++],p[g++],p[g++],E[3]]):w?T.push([p[g++],p[g++],p[g++]]):i?(T.push([p[g++],p[g++],E[2]]),g++):(T.push([p[g++],p[g++]]),g++);n.push(T)}return!0}const qs=be(),bYe=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:Ba,getTransformation:Mte,getTransformations:U$e,initializeProjection:vh,isEqualBaseGCS:H$e,isLoaded:Eh,isLoadedOrLoad:$te,isLoadedOrLoadFor:Tte,load:gh,project:Ts,projectExtent:Y$e,projectMany:$L,projectMultipoint:J$e,projectOrLoad:Ete,projectOrLoadMany:Ite,projectPoint:W$e,projectPolygon:K$e,projectPolyline:Z$e,projectWithZConversion:q$e,projectWithoutEngine:ZT,requiresLoad:z$e,test:B$e,tryProjectWithZConversion:wb,unload:G$e},Symbol.toStringTag,{value:"Module"}));async function X$e(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return em(t);const i=Ge.WGS84;return await vh(e,i),Ts(t,i)}function Q$e(t,e){if(!Rte(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function Rte(t,e){var i;return!!((i=t.typeKeywords)!=null&&i.includes(e))}function wYe(t){return Rte(t,Fte.HOSTED_SERVICE)}function eTe(t,e){const i=t.typeKeywords;if(i){const r=i.indexOf(e);r>-1&&i.splice(r,1)}}function _Ye(t,e,i){i?Q$e(t,e):eTe(t,e)}async function SYe(t){const e=t.clone().normalize();let i;if(e.length>1)for(const r of e)i?r.width>i.width&&(i=r):i=r;else i=e[0];return X$e(i)}const Fte={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function hz(t){var g;const{portal:e,isOrgItem:i,itemControl:r}=t,n=(g=e.user)==null?void 0:g.privileges;let o=!n||n.includes("features:user:edit"),u=!!i&&!!(n!=null&&n.includes("features:user:fullEdit"));const p=r==="update"||r==="admin";return p?u=o=!0:u&&(o=!0),{features:{edit:o,fullEdit:u},content:{updateItem:p}}}const tTe=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=ot(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,r,n){if(r.itemId)return new Nl({id:r.itemId,portal:n==null?void 0:n.portal})}writePortalItem(i,r){i!=null&&i.id&&(r.itemId=i.id)}async loadFromPortal(i,r){var n;if((n=this.portalItem)!=null&&n.id)try{const{load:o}=await ie(()=>import("./layersLoader-CMEegXUs.js"),__vite__mapDeps([120,8,6,7,5]));return At(r),await o({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},r)}catch(o){throw Cn(o)||fe.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${o}`),o}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(r=>(Ra(r),!0)))}async setUserPrivileges(i,r){if(!Ct.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(r);if(this.url)try{const{features:{edit:n,fullEdit:o},content:{updateItem:u}}=await this._fetchUserPrivileges(i,r);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",o),this._set("userHasUpdateItemPrivileges",u)}catch(n){Ra(n)}}async _fetchUserPrivileges(i,r){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(r);const o=i===n.id;if(o&&n.portal.user)return hz(n);let u,p;if(o)u=n.portal.url;else try{u=await xP(this.url,r)}catch(T){Ra(T)}if(!u||!Ipe(u,n.portal.url))return this._fetchFallbackUserPrivileges(r);try{const T=r!=null?r.signal:null;p=await(rt==null?void 0:rt.getCredential(`${u}/sharing`,{prompt:!1,signal:T}))}catch(T){Ra(T)}const g=!0,w=!1,S=!1;if(!p)return{features:{edit:g,fullEdit:w},content:{updateItem:S}};try{if(o?await n.reload():(n=new Nl({id:i,portal:{url:u}}),await n.load(r)),n.portal.user)return hz(n)}catch(T){Ra(T)}return{features:{edit:g,fullEdit:w},content:{updateItem:S}}}async _fetchFallbackUserPrivileges(i){let r=!0;try{r=await this._fetchUserHasEditingPrivileges(i)}catch(n){Ra(n)}return{features:{edit:r,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const r=this.url?rt==null?void 0:rt.findCredential(this.url):null;if(!r)return!0;const n=Rx.credential===r?Rx.user:await this._fetchEditingUser(i);return Rx.credential=r,Rx.user=n,(n==null?void 0:n.privileges)==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var S,T;const r=(T=(S=this.portalItem)==null?void 0:S.portal)==null?void 0:T.user;if(r)return r;const n=rt==null?void 0:rt.findServerInfo(this.url??"");if(!(n!=null&&n.owningSystemUrl))return null;const o=`${n.owningSystemUrl}/sharing/rest`,u=wr.getDefault();if(u&&u.loaded&&ws(u.restUrl)===ws(o))return u.user;const p=`${o}/community/self`,g=i!=null?i.signal:null,w=await Z3(nt(p,{authMode:"no-prompt",query:{f:"json"},signal:g}));return w.ok?wP.fromJSON(w.value.data):null}read(i,r){r&&(r.layer=this),super.read(i,r)}write(i,r){var u;const n=r==null?void 0:r.portal,o=((u=this.portalItem)==null?void 0:u.id)&&(this.portalItem.portal||wr.getDefault());return n&&o&&!AJ(o.restUrl,n.restUrl)?(r.messages&&r.messages.push(new re("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...r,layer:this})}};return m([b({type:Nl})],e.prototype,"portalItem",null),m([Me("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),m([Le("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),m([b({clonable:!1})],e.prototype,"resourceReferences",void 0),m([b({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),m([b({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),m([b({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=m([G("esri.layers.mixins.PortalLayer")],e),e},Rx={credential:null,user:null};let j_=class extends Te{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};m([b()],j_.prototype,"updating",void 0),m([b()],j_.prototype,"status",void 0),j_=m([G("esri.layers.support.PublishingInfo")],j_);const iTe=j_,rTe=Symbol(),nTe=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const r=this._get("publishingInfo");if(r)return r;const n=new iTe;return this._checkPublishingStatus(n),n}_checkPublishingStatus(r){let u=0;const p=async w=>{let S;r.updating=!0;try{S=await this.fetchPublishingStatus()}catch{S="unavailable"}S!=="published"&&S!=="unavailable"||(r.status==="publishing"&&this.refresh(),g.remove()),r.status=S,r.updating=!1,g.removed||(u=setTimeout(p,w,w+125))},g={removed:!1,remove(){this.removed=!0,clearTimeout(u)}};this.when().catch(()=>g.remove()),p(250),this.addHandles(g)}};return e=rTe,m([b({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=m([G("esri.layers.mixins.PublishableLayer")],i),i},Df=new Ie,V2=new WeakMap;function sTe(t){aTe(t)&&Df.push(new WeakRef(t))}function oTe(t){const e=Df.find(i=>i.deref()===t);e&&Df.remove(e)}function aTe(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function Nte(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:Nte(e,t%e):0}let tk=0,Fx=0;function lTe(){const t=Date.now();let e=!1;for(const i of Df){const r=i.deref();r?r.refreshInterval&&t-(V2.get(r)??0)+5>=6e4*r.refreshInterval&&(V2.set(r,t),r.refresh(t)):e=!0}if(e)for(let i=Df.length-1;i>=0;i--)Df.at(i).deref()||Df.removeAt(i)}eJ(()=>{const t=Date.now();let e=0;for(const i of Df){const r=i.deref();r&&(e=Nte(Math.round(6e4*r.refreshInterval),e),r.refreshInterval?V2.get(r)||V2.set(r,t):V2.delete(r))}if(e!==Fx){if(Fx=e,clearInterval(tk),Fx===0)return void(tk=0);tk=setInterval(lTe,Fx)}});const pz=.1,uTe=t=>{let e=class extends t{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=Da(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||sTe(this)},()=>{})}destroy(){oTe(this)}castRefreshInterval(i){return i>=pz?i:i<=0?0:pz}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){Wu(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:r})},r=>{fe.getLogger(this).error(r),this.emit("refresh",{dataChanged:!1,error:r})})}async hasDataChanged(){return!0}get test(){}};return m([b({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:ss}}}}})],e.prototype,"refreshInterval",void 0),m([Dt("refreshInterval")],e.prototype,"castRefreshInterval",null),m([b({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),m([b({readOnly:!0})],e.prototype,"refreshParameters",null),e=m([G("esri.layers.mixins.RefreshableLayer")],e),e},Dte=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&cTe(i,r.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return m([b({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),m([b({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),m([b({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=m([G("esri.layers.mixins.ScaleRangeLayer")],e),e};function cTe(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const nR=dt()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let V_=class extends Gt(ye){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return YY(this.value,this.unit,"milliseconds")}};m([ze(nR,{nonNullable:!0})],V_.prototype,"unit",void 0),m([b({type:Number,json:{write:!0},nonNullable:!0})],V_.prototype,"value",void 0),V_=m([G("esri.TimeInterval")],V_);const Yp=V_;function dz(t,e){return Yp.fromJSON({value:t,unit:e})}let ps=class extends Gt(ye){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,i){return i.timeExtent&&Array.isArray(i.timeExtent)&&i.timeExtent.length===2?Di.fromArray(i.timeExtent):null}writeFullTimeExtent(e,i){(e==null?void 0:e.start)!=null&&e.end!=null?i.timeExtent=e.toArray():i.timeExtent=null}readInterval(e,i){return i.timeInterval&&i.timeIntervalUnits?dz(i.timeInterval,i.timeIntervalUnits):i.defaultTimeInterval&&i.defaultTimeIntervalUnits?dz(i.defaultTimeInterval,i.defaultTimeIntervalUnits):null}writeInterval(e,i){i.timeInterval=(e==null?void 0:e.toJSON().value)??null,i.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};m([b({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],ps.prototype,"cumulative",void 0),m([b({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],ps.prototype,"endField",void 0),m([b({type:Di,json:{write:{enabled:!0,allowNull:!0}}})],ps.prototype,"fullTimeExtent",void 0),m([Me("fullTimeExtent",["timeExtent"])],ps.prototype,"readFullTimeExtent",null),m([Le("fullTimeExtent")],ps.prototype,"writeFullTimeExtent",null),m([b({type:Boolean,json:{write:!0}})],ps.prototype,"hasLiveData",void 0),m([b({type:Yp,json:{write:{enabled:!0,allowNull:!0}}})],ps.prototype,"interval",void 0),m([Me("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],ps.prototype,"readInterval",null),m([Le("interval")],ps.prototype,"writeInterval",null),m([b({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],ps.prototype,"startField",void 0),m([b(fE("timeReference",!0))],ps.prototype,"timeZone",void 0),m([b({type:String,json:{write:{enabled:!0,allowNull:!0}}})],ps.prototype,"trackIdField",void 0),m([b({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],ps.prototype,"useTime",void 0),m([b({type:[Date],json:{read:!1}})],ps.prototype,"stops",void 0),ps=m([G("esri.layers.support.TimeInfo")],ps);const jte=ps,hTe={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:ss}}},pTe=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,r){const n=r.timeInfo.exportOptions;if(!n)return null;const o=n.timeOffset,u=nR.fromJSON(n.timeOffsetUnits);return o&&u?new Yp({value:o,unit:u}):null}set timeInfo(i){mX(i,this.fieldsIndex),this._set("timeInfo",i)}};return m([b({type:Di,json:{write:!1}})],e.prototype,"timeExtent",void 0),m([b({type:Yp})],e.prototype,"timeOffset",void 0),m([Me("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),m([b({value:null,type:jte,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),m([b(hTe)],e.prototype,"useViewTime",void 0),e=m([G("esri.layers.mixins.TemporalLayer")],e),e},fz=new et({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Hd=class extends Gt(ye){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};m([b({json:{write:!0}})],Hd.prototype,"name",void 0),m([b({json:{write:!0}})],Hd.prototype,"description",void 0),m([b({json:{read:fz.read,write:fz.write}})],Hd.prototype,"drawingTool",void 0),m([b({json:{write:!0}})],Hd.prototype,"prototype",void 0),m([b({json:{write:!0}})],Hd.prototype,"thumbnail",void 0),Hd=m([G("esri.layers.support.FeatureTemplate")],Hd);const sR=Hd;let ip=class extends Gt(ye){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const i={};for(const r of Object.keys(e))i[r]=pM(e[r]);return i}writeDomains(e,i){var n;const r={};for(const o of Object.keys(e))e[o]&&(r[o]=(n=e[o])==null?void 0:n.toJSON());i.domains=r}};m([b({json:{write:!0}})],ip.prototype,"id",void 0),m([b({json:{write:!0}})],ip.prototype,"name",void 0),m([b({json:{write:!0}})],ip.prototype,"domains",void 0),m([Me("domains")],ip.prototype,"readDomains",null),m([Le("domains")],ip.prototype,"writeDomains",null),m([b({type:[sR],json:{write:!0}})],ip.prototype,"templates",void 0),ip=m([G("esri.layers.support.FeatureType")],ip);const Vte=ip;function dTe(){return{fields:{type:[dM],value:null,set:function(t){if(t&&me("big-integer-warning-enabled")){const e=t.filter(i=>i.type==="big-integer"||i.type==="oid"&&(i.length||0)>=8);if(e.length){const i=e.map(r=>`'${r.name}'`).join(", ");fe.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${i}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return RQ.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!(t!=null&&t.length))return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const i of t)((e=this.fieldsIndex)==null?void 0:e.has(i))||fe.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:t});return Hm(this.fieldsIndex,t)}}}}const ik=()=>fe.getLogger("esri.layers.support.labelingInfo"),fTe=/\[([^[\]]+)\]/gi;function rk(t,e,i){return t?t.map(r=>{var o;const n=new mM;if(n.read(r,i),n.labelExpression){const u=e.fields||((o=e.layerDefinition)==null?void 0:o.fields)||this.fields;n.labelExpression=n.labelExpression.replaceAll(fTe,(p,g)=>`[${yTe(g,u)}]`)}return n}):null}function yTe(t,e){if(!e)return t;const i=t.toLowerCase();for(let r=0;r<e.length;r++){const n=e[r].name;if(n.toLowerCase()===i)return n}return t}const mTe={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function MYe(t,e){const i=[];for(const r of t){const n=r.labelPlacement,o=mTe[e];if(!r.symbol)return ik().warn("No ILabelClass symbol specified."),[];if(!o)return ik().error(new re("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(o.includes(n))i.push(r);else{const u=o[0];n&&ik().warn(`Found invalid label placement type ${n} for ${e}. Defaulting to ${u}`);const p=r.clone();p.labelPlacement=u,i.push(p)}}return i}const g1=[];function gTe(t,e){if(Bee(t.url??""))return!0;const{wkid:i}=e;for(const r of g1){if((t.version??0)>=r[0])return!0;if(typeof r[1]=="function"&&(r[1]=r[1]()),r[1].has(i))return!1}return!0}g1.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),g1.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),g1.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),g1.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),g1.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function vTe(t,e,i){const r=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(r&&r.type==="unique-value"&&r.styleOrigin){const n=await Z3(r.populateFromStyle());if(At(i),n.ok===!1){const o=n.error;e!=null&&e.messages&&e.messages.push(new Ul("renderer:style-reference",`Failed to create unique value renderer from style reference: ${o.message}`,{error:o,context:e})),t.clear("renderer",e==null?void 0:e.origin)}}}var TL;let v1=TL=class extends ye{constructor(t){super(t),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new TL({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};m([b({type:[String],json:{write:!0}})],v1.prototype,"groupByFields",void 0),m([b({type:Number,json:{write:!0}})],v1.prototype,"topCount",void 0),m([b({type:[String],json:{write:!0}})],v1.prototype,"orderByFields",void 0),v1=TL=m([G("esri.rest.support.TopFilter")],v1);const bTe=v1;var EL;const yz=new et({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),mz=new et({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let or=EL=class extends ye{constructor(t){super(t),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new EL(ae({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};m([b({type:Boolean,json:{write:!0}})],or.prototype,"cacheHint",void 0),m([b({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],or.prototype,"distance",void 0),m([b({types:h0,json:{read:dh,write:!0}})],or.prototype,"geometry",void 0),m([b({type:Number,json:{write:!0}})],or.prototype,"geometryPrecision",void 0),m([b({type:Number,json:{write:!0}})],or.prototype,"maxAllowableOffset",void 0),m([b({type:Number,json:{read:{source:"resultRecordCount"}}})],or.prototype,"num",void 0),m([b({json:{write:!0}})],or.prototype,"objectIds",void 0),m([b({type:[String],json:{write:!0}})],or.prototype,"orderByFields",void 0),m([b({type:[String],json:{write:!0}})],or.prototype,"outFields",void 0),m([b({type:Ge,json:{read:{source:"outSR"},write:{target:"outSR"}}})],or.prototype,"outSpatialReference",void 0),m([b({type:String,json:{write:!0}})],or.prototype,"resultType",void 0),m([b({json:{write:!0}})],or.prototype,"returnGeometry",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],or.prototype,"returnM",void 0),m([b({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],or.prototype,"returnZ",void 0),m([b({type:Number,json:{read:{source:"resultOffset"}}})],or.prototype,"start",void 0),m([Le("start"),Le("num")],or.prototype,"writeStart",null),m([b({type:String,json:{read:{source:"spatialRel",reader:yz.read},write:{target:"spatialRel",writer:yz.write}}})],or.prototype,"spatialRelationship",void 0),m([b({type:Di,json:{write:!0}})],or.prototype,"timeExtent",void 0),m([b({type:bTe,json:{write:!0}})],or.prototype,"topFilter",void 0),m([b({type:String,json:{read:mz.read,write:{writer:mz.write,overridePolicy(t){return{enabled:t!=null&&this.distance!=null&&this.distance>0}}}}})],or.prototype,"units",void 0),m([b({type:String,json:{write:!0}})],or.prototype,"where",void 0),or=EL=m([G("esri.rest.support.TopFeaturesQuery")],or),or.from=Yi(or);const Nx=or;function wTe({displayField:t,editFieldsInfo:e,fields:i,objectIdField:r,title:n},o){if(!i)return null;const u=$Te({editFieldsInfo:e,fields:i,objectIdField:r},o);if(!u.length)return null;const p=ITe({titleBase:n,fields:i,displayField:t}),g=ETe();return new Wm({title:p,content:g,fieldInfos:u})}const _Te=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):bX(t,e);function STe(t,e){const i=t;return e&&(t=t.filter(r=>!e.includes(r.type))),t===i&&(t=t.slice()),t.sort(xTe),t}function xTe(t,e){return t.type==="oid"?-1:e.type==="oid"?1:gz(t)?-1:gz(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function $Te(t,e){const i=e==null?void 0:e.visibleFieldNames;return STe(t.fields??[],(e==null?void 0:e.ignoreFieldTypes)||MTe).map(r=>new n8({fieldName:r.name,isEditable:Mve(r,t),label:r.alias,format:TTe(r),visible:_Te(r,{...t,visibleFieldNames:i})}))}function TTe(t){switch(t.type){case"small-integer":case"integer":case"single":return new aT({digitSeparator:!0,places:0});case"double":return new aT({digitSeparator:!0,places:2});case"string":return RC(t.name)?new aT({digitSeparator:!0,places:0}):void 0;default:return}}function ETe(){return[new y3,new f3]}function ITe(t){const e=XP(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function gz(t){var i;return(t.name&&t.name.toLowerCase())==="name"?!0:((i=t.alias)==null?void 0:i.toLowerCase())==="name"}const MTe=["geometry","blob","raster","guid","xml"];var nh;(function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"})(nh||(nh={}));const io="FeatureLayer";function Dx(t,e){return new re("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function vz(t){return t&&t instanceof Ie}const nk=dTe();function sk(t,e,i){const r=!!(i!=null&&i.writeLayerSchema);return{enabled:r,ignoreOrigin:r}}let Be=class extends Vxe(f$e(zSe(nTe(OSe(Jee(w$e(pTe(Dte(uTe(sSe(m$e(tTe(XI(CSe(Y3e(Gt(WP))))))))))))))))){constructor(...e){super(...e),this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Ge.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=Da(async(i,r,n)=>{const{save:o,saveAs:u}=await ie(()=>import("./featureLayerUtils-Bg56292n.js"),__vite__mapDeps([121,122,123,124,125,126,8]));switch(i){case nh.SAVE:return o(this,r);case nh.SAVE_AS:return u(this,n,r)}})}destroy(){var e;(e=this.source)==null||e.destroy()}normalizeCtorArgs(e,i){return typeof e=="string"?{url:e,...i}:e}load(e){var n;const i=e!=null?e.signal:null;if((n=this.portalItem)!=null&&n.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(i).then(o=>this.initLayerProperties(o))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},e).catch(Ra).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const o=await this._fetchFirstValidLayerId(i);o!=null&&(this.layerId=o)}if(!this.url&&!this._hasMemorySource())throw new re("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(i))}).then(()=>wxe(this,"load",e));return this.addResolvingPromise(r),Promise.resolve(this)}readCapabilities(e,i){return i=i.layerDefinition||i,hte(i,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var e;return!(this.loaded&&!((e=this.capabilities)!=null&&e.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,i){return this._readEditingEnabled(i,!1)}readEditingEnabledFromWebMap(e,i,r){return this._readEditingEnabled(i,!0,r)}writeEditingEnabled(e,i){this._writeEditingEnabled(e,i,!1)}writeEditingEnabledToWebMap(e,i,r,n){this._writeEditingEnabled(e,i,!0,n)}get effectiveEditingEnabled(){return _xe(this)}readIsTable(e,i){return(i=(i==null?void 0:i.layerDefinition)??i).type==="Table"||!i.geometryType}writeIsTable(e,i,r,n){n!=null&&n.writeLayerSchema&&Wn(r,e?"Table":"Feature Layer",i)}readGlobalIdField(e,i){return lte(i.layerDefinition||i)}readObjectIdField(e,i){return ute(i.layerDefinition||i)}get parsedUrl(){const e=Zr(this.url);return e!=null&&(this.dynamicDataSource!=null?e.path=ib(e.path,"dynamicLayer"):this.layerId!=null&&(e.path=ib(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){xj(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,i,r){var o;i=i.layerDefinition||i;const n=(o=i.drawingInfo)==null?void 0:o.renderer;if(n){const u=_3(n,i,r)??void 0;return u||fe.getLogger(this).error("Failed to create renderer",{rendererDefinition:i.drawingInfo.renderer,layer:this,context:r}),u}return K8(i,r)}set source(e){const i=this._get("source");i!==e&&(vz(i)&&this._resetMemorySource(i),vz(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof Ie?new Tp({layer:this,items:e}):e:null}readSource(e,i){const r=gb.fromJSON(i.featureSet);return new Tp({layer:this,items:(r==null?void 0:r.features)??[]})}readTemplates(e,i){const r=i.editFieldsInfo,n=r==null?void 0:r.creatorField,o=r==null?void 0:r.editorField;return e=e==null?void 0:e.map(u=>sR.fromJSON(u)),this._fixTemplates(e,n),this._fixTemplates(e,o),e}readTitle(e,i){var o,u,p;const r=((o=i.layerDefinition)==null?void 0:o.name)??i.name,n=i.title||((u=i.layerDefinition)==null?void 0:u.title);if(r){const g=(p=this.portalItem)==null?void 0:p.title;if(this.sublayerTitleMode==="item-title")return this.url?tSe(this.url,r):r;let w=r;if(!w&&this.url){const S=Zu(this.url);S!=null&&(w=S.title)}return w?(this.sublayerTitleMode==="item-title-and-service-name"&&g&&g!==w&&(w=g+" - "+w),z8(w)):void 0}if(this.sublayerTitleMode==="item-title"&&n)return n}readTitleFromWebMap(e,i){var r;return i.title||((r=i.layerDefinition)==null?void 0:r.name)}readTypeIdField(e,i){let r=(i=i.layerDefinition||i).typeIdField;if(r&&i.fields){r=r.toLowerCase();const n=i.fields.find(o=>o.name.toLowerCase()===r);n&&(r=n.name)}return r}readTypes(e,i){e=(i=i.layerDefinition||i).types;const r=i.editFieldsInfo,n=r==null?void 0:r.creatorField,o=r==null?void 0:r.editorField;return e==null?void 0:e.map(u=>(u=Vte.fromJSON(u),this._fixTemplates(u.templates,n),this._fixTemplates(u.templates,o),u))}readVisible(e,i){var r;return((r=i.layerDefinition)==null?void 0:r.defaultVisibility)!=null?!!i.layerDefinition.defaultVisibility:i.visibility!=null?!!i.visibility:void 0}async addAttachment(e,i){return rxe(this,e,i,io)}async updateAttachment(e,i,r){return nxe(this,e,i,r,io)}async applyEdits(e,i){return sxe(this,e,i)}async uploadAssets(e,i){return oxe(this,e,i)}on(e,i){return super.on(e,i)}createPopupTemplate(e){return wTe(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:i}=await zl(ie(()=>import("./FeatureLayerSource-Do8053ST.js"),__vite__mapDeps([127,49,51,128,129,130,131,34,33,132,133,60,58,59,14,13,15,134,135,12])),e);return new i({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:e})}createQuery(){const e=mxe(this);e.dynamicDataSource=this.dynamicDataSource;const i=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=aS(this.definitionExpression,i);return e.where=r||"1=1",e}async deleteAttachments(e,i){return axe(this,e,i,io)}async fetchRecomputedExtents(e){return lxe(this,e,io)}getFeatureType(e){return $xe(this.types,this.typeIdField,e)}getFieldDomain(e,i){var u;const r=i==null?void 0:i.feature,n=vxe(this,r);if(n){const p=(u=n.domains)==null?void 0:u[e];return(p==null?void 0:p.type)==="inherited"?this._getLayerDomain(e):p}const o=this.getFeatureType(r);if(o){const p=o.domains&&o.domains[e];if(p&&p.type!=="inherited")return p}return this._getLayerDomain(e)}getField(e){return this.fieldsIndex.get(e)}async queryAttachments(e,i){return uxe(this,e,i,io)}async queryFeatures(e,i){const r=await this.load(),n=await r.source.queryFeatures(ec.from(e)??r.createQuery(),i);if(n!=null&&n.features)for(const o of n.features)o.layer=o.sourceLayer=r;return n}async queryObjectIds(e,i){return cxe(this,e,i,io)}async queryFeatureCount(e,i){return hxe(this,e,i,io)}async queryExtent(e,i){return pxe(this,e,i,io)}async queryRelatedFeatures(e,i){return dxe(this,e,i,io)}async queryRelatedFeaturesCount(e,i){return fxe(this,e,i,io)}async queryTopFeatures(e,i){var u;const{source:r,capabilities:n}=await this.load();if(!r.queryTopFeatures||!((u=n==null?void 0:n.query)!=null&&u.supportsTopFeaturesQuery))throw new re(io,"Layer source does not support queryTopFeatures capability");const o=await r.queryTopFeatures(Nx.from(e),i);if(o!=null&&o.features)for(const p of o.features)p.layer=p.sourceLayer=this;return o}async queryTopObjectIds(e,i){const{source:r,capabilities:n}=await this.load();if(!r.queryTopObjectIds||!(n!=null&&n.query.supportsTopFeaturesQuery))throw new re(io,"Layer source does not support queryTopObjectIds capability");return r.queryTopObjectIds(Nx.from(e),i)}async queryTopFeaturesExtent(e,i){var o;const{source:r,capabilities:n}=await this.load();if(!r.queryTopExtents||!((o=n==null?void 0:n.query)!=null&&o.supportsTopFeaturesQuery))throw new re(io,"Layer source does not support queryTopExtents capability");return r.queryTopExtents(Nx.from(e),i)}async queryTopFeatureCount(e,i){var o;const{source:r,capabilities:n}=await this.load();if(!r.queryTopCount||!((o=n==null?void 0:n.query)!=null&&o.supportsTopFeaturesQuery))throw new re(io,"Layer source does not support queryFeatureCount capability");return r.queryTopCount(Nx.from(e),i)}read(e,i){const r=e.featureCollection;if((r||e.type==="Feature Collection")&&(this.resourceInfo=e),r){const n=r.layers;n&&n.length===1&&(super.read(n[0],i),r.showLegend!=null&&super.read({showLegend:r.showLegend},i))}super.read(e,i),i&&i.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(e,i){i={...i,origin:(i==null?void 0:i.origin)??void 0,writeLayerSchema:(i==null?void 0:i.writeLayerSchema)??this._hasMemorySource()};const{origin:r,layerContainerType:n,messages:o}=i;if(this.dynamicDataSource)return o==null||o.push(Dx(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&n!=="tables")return o==null||o.push(Dx(this,`a table source can only be written to tables, not ${n}`)),null;if(this._hasMemorySource())return o==null||o.push(Dx(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&n==="tables")return o==null||o.push(Dx(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(e,i)}clone(){if(this._hasMemorySource())throw new re(io,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){var i;return!!this.loaded&&(((i=this.source)==null?void 0:i.type)==="memory"||gTe(this,e))}async save(e){return this._debouncedSaveOperations(nh.SAVE,e)}async saveAs(e,i){return this._debouncedSaveOperations(nh.SAVE_AS,i,e)}_readEditingEnabled(e,i,r){var o;let n=(o=e.layerDefinition)==null?void 0:o.capabilities;return n?this._hasEditingCapability(n):(n=e.capabilities,i&&(r==null?void 0:r.origin)==="web-map"&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(i=>i.trim()).includes("editing")}_writeEditingEnabled(e,i,r,n){var o,u;if(!e){const p=(u=(o=this.capabilities)==null?void 0:o.operations)!=null&&u.supportsSync?"Query,Sync":"Query";Wn("layerDefinition.capabilities",p,i),r&&!(n!=null&&n.writeLayerSchema)&&(i.capabilities=p)}}_getLayerDomain(e){const i=this.fieldsIndex.get(e);return i?i.domain:null}_fetchFirstValidLayerId(e){return nt(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(i=>{const r=i.data;if(r)return this.findFirstValidLayerId(r)})}async initLayerProperties(e){var i;return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(i=this.portalItem)==null?void 0:i.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),xj(this.renderer,this.fieldsIndex),mX(this.timeInfo,this.fieldsIndex),vTe(this,{origin:"service"})}async hasDataChanged(){return yxe(this)}async fetchPublishingStatus(){const e=this.source;return e!=null&&e.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}_verifyFields(){var i,r;const e=((i=this.parsedUrl)==null?void 0:i.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||(r=this.fields)!=null&&r.some(n=>n.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,i){e&&e.forEach(r=>{var o;const n=(o=r.prototype)==null?void 0:o.attributes;n&&i&&delete n[i]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new re("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new re("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(i=>{i.layer=this,i.sourceLayer=this}),this.addHandles([e.on("after-add",i=>{i.item.layer=this,i.item.sourceLayer=this}),e.on("after-remove",i=>{i.item.layer=null,i.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(i=>{i.layer=null,i.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(e){return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}};m([Me("service","capabilities")],Be.prototype,"readCapabilities",null),m([b({json:{origins:{"web-scene":{write:!1}},write:!0}})],Be.prototype,"charts",void 0),m([b({readOnly:!0})],Be.prototype,"createQueryVersion",null),m([b({json:{read:{source:"layerDefinition.copyrightText"}}})],Be.prototype,"copyright",void 0),m([b({json:{read:{source:"layerDefinition.displayField"}}})],Be.prototype,"displayField",void 0),m([b({types:zu,readOnly:!0})],Be.prototype,"defaultSymbol",void 0),m([b({type:Ru})],Be.prototype,"dynamicDataSource",void 0),m([b({type:Boolean})],Be.prototype,"editingEnabled",null),m([Me(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Be.prototype,"readEditingEnabled",null),m([Me("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Be.prototype,"readEditingEnabledFromWebMap",null),m([Le(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Be.prototype,"writeEditingEnabled",null),m([Le("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Be.prototype,"writeEditingEnabledToWebMap",null),m([b({readOnly:!0})],Be.prototype,"effectiveEditingEnabled",null),m([b({...nk.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:sk}}}}})],Be.prototype,"fields",void 0),m([b(nk.fieldsIndex)],Be.prototype,"fieldsIndex",void 0),m([b({type:Oee,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Be.prototype,"formTemplate",void 0),m([b({json:{read:{source:"layerDefinition.extent"}}})],Be.prototype,"fullExtent",void 0),m([b({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:sk,writer(t,e,i){const r=t?pL.toJSON(t):null;r&&Wn(i,r,e)}}}},read:{source:"layerDefinition.geometryType",reader:pL.read}}})],Be.prototype,"geometryType",void 0),m([b({json:{read:{source:"layerDefinition.hasM"}}})],Be.prototype,"hasM",void 0),m([b({json:{read:{source:"layerDefinition.hasZ"}}})],Be.prototype,"hasZ",void 0),m([b(YSe)],Be.prototype,"id",void 0),m([b({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Be.prototype,"infoFor3D",void 0),m([b({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Be.prototype,"isTable",void 0),m([Me("service","isTable",["type","geometryType"]),Me("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Be.prototype,"readIsTable",null),m([Le("web-map","isTable")],Be.prototype,"writeIsTable",null),m([b(J8)],Be.prototype,"labelsVisible",void 0),m([b({type:[mM],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:rk,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:rk,write:{enabled:!0,layerContainerTypes:ss}}},name:"layerDefinition.drawingInfo.labelingInfo",read:rk,write:!0}})],Be.prototype,"labelingInfo",void 0),m([b((()=>{const t=ae(KSe);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,i,r){Wn(r,zI(e),i)}}},t})())],Be.prototype,"opacity",void 0),m([b(JSe)],Be.prototype,"legendEnabled",void 0),m([b({type:["show","hide"],json:(()=>{const t=ae(ste.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],Be.prototype,"listMode",void 0),m([Me("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Be.prototype,"readGlobalIdField",null),m([b({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:sk}}}}})],Be.prototype,"objectIdField",void 0),m([Me("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Be.prototype,"readObjectIdField",null),m([b({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Be.prototype,"operationalLayerType",void 0),m([b(nk.outFields)],Be.prototype,"outFields",void 0),m([b({readOnly:!0})],Be.prototype,"parsedUrl",null),m([b({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Be.prototype,"path",void 0),m([b(W8)],Be.prototype,"popupEnabled",void 0),m([b({type:Wm,json:{name:"popupInfo",write:!0}})],Be.prototype,"popupTemplate",void 0),m([b({readOnly:!0})],Be.prototype,"defaultPopupTemplate",null),m([b({types:cM,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:H2e,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:ss,overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}})],Be.prototype,"renderer",null),m([Me("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Me("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Be.prototype,"readRenderer",null),m([b()],Be.prototype,"resourceInfo",void 0),m([b((()=>{const t=ae(HSe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],Be.prototype,"screenSizePerspectiveEnabled",void 0),m([b({clonable:!1})],Be.prototype,"source",null),m([Dt("source")],Be.prototype,"castSource",null),m([Me("portal-item","source",["featureSet"]),Me("web-map","source",["featureSet"])],Be.prototype,"readSource",null),m([b({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Be.prototype,"spatialReference",void 0),m([b({type:Number})],Be.prototype,"subtypeCode",void 0),m([b({type:[sR]})],Be.prototype,"templates",void 0),m([Me("templates",["editFieldsInfo","creatorField","editorField","templates"])],Be.prototype,"readTemplates",null),m([b({type:jte})],Be.prototype,"timeInfo",void 0),m([b()],Be.prototype,"title",void 0),m([Me("service","title",["name"]),Me("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Be.prototype,"readTitle",null),m([Me("web-map","title",["layerDefinition.name","title"])],Be.prototype,"readTitleFromWebMap",null),m([b({type:String})],Be.prototype,"sublayerTitleMode",void 0),m([b({json:{read:!1}})],Be.prototype,"type",void 0),m([b({type:String})],Be.prototype,"typeIdField",void 0),m([Me("service","typeIdField"),Me("typeIdField",["layerDefinition.typeIdField"])],Be.prototype,"readTypeIdField",null),m([b({type:[Vte]})],Be.prototype,"types",void 0),m([Me("service","types",["types"]),Me("types",["layerDefinition.types"])],Be.prototype,"readTypes",null),m([b({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Be.prototype,"visible",void 0),m([Me("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Be.prototype,"readVisible",null),Be=m([G("esri.layers.FeatureLayer")],Be);const oR=Be,kTe=Object.freeze(Object.defineProperty({__proto__:null,default:oR},Symbol.toStringTag,{value:"Module"}));let Ic=class extends ye{constructor(e){super(e),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};m([b({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.moment=t?t.getTime():null}}}})],Ic.prototype,"moment",void 0),m([b({type:Boolean,json:{write:!0}})],Ic.prototype,"fullUpdate",void 0),m([b({type:Boolean,json:{write:!0}})],Ic.prototype,"validateErrorsCreated",void 0),m([b({type:Number,json:{write:!0}})],Ic.prototype,"dirtyAreaCount",void 0),m([b({type:Boolean,json:{write:!0}})],Ic.prototype,"exceededTransferLimit",void 0),m([b({type:[Object],json:{write:!0}})],Ic.prototype,"serviceEdits",void 0),m([b({type:[Object],json:{write:!0}})],Ic.prototype,"discoveredSubnetworks",void 0),Ic=m([G("esri.rest.networks.support.ValidateNetworkTopologyResult")],Ic);const CTe=Ic,ATe=dt()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let Wd=class extends CTe{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:r}=await nt(this.statusUrl,i);return this.read(r),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:r}=e;return new Promise((n,o)=>{this._clearTimer();const u=setInterval(()=>{this._timer||o(ni()),this.checkJobStatus().then(p=>{const{status:g}=p;switch(this.status=g,g){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":r&&r(this)}},p=>{this._clearTimer(),o(p)})},i);this._timer=u})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};m([b()],Wd.prototype,"editsResolver",void 0),m([b({type:String,json:{write:!0}})],Wd.prototype,"statusUrl",void 0),m([ze(ATe)],Wd.prototype,"status",void 0),m([b({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],Wd.prototype,"submissionTime",void 0),m([b({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],Wd.prototype,"lastUpdatedTime",void 0),Wd=m([G("esri.networks.support.TopologyValidationJobInfo")],Wd);const LTe=Wd;async function bz(t,e){if(t==="Utility Network Layer"){const{default:i}=await ie(()=>Promise.resolve().then(()=>JTe),void 0);return new i({layerUrl:e})}return null}async function OTe(t){var u;let e="portalItem"in t?t:{portalItem:t};!e.portalItem||e.portalItem instanceof Nl||(e={...e,portalItem:new Nl(e.portalItem)});const i=e.portalItem;if(await i.load(),i.type!=="Feature Service")throw new re("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const r=i.url,n=await nt(r,{responseType:"json",query:{f:"json"}}),o="Network Layer";if((u=n.data.type)!=null&&u.includes(o))return bz(n.data.type,r);if(n.data.layers){const p=n.data.layers.find(g=>g.type.includes(o));if(p){const g=`${r}/${p.id}`;return bz(p.type,g)}}return null}let Qr=class extends XI(Qo){static fromPortalItem(e){return OTe(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._applyEditsHandler=i=>{const{serviceUrl:r,gdbVersion:n,result:o}=i,u=r===this.featureServiceUrl,p=P2(r,n,this.gdbVersion);u&&p&&o.then(g=>{BT(r,n)&&(this.historicMoment=g.historicMoment)})},this._updateMomentHandler=i=>{const{serviceUrl:r,gdbVersion:n,moment:o}=i,u=r===this.featureServiceUrl,p=P2(r,n,this.gdbVersion);u&&p&&(this.historicMoment=o)},this.when().then(()=>{this.addHandles([Yee(this._applyEditsHandler),Xee(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{Cn(e)||fe.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get datasetName(){var e;return((e=this.dataElement)==null?void 0:e.name)??null}get owner(){var e;return((e=this.dataElement)==null?void 0:e.userIdentity)??null}get schemaGeneration(){var e;return((e=this.dataElement)==null?void 0:e.schemaGeneration)??null}get parsedUrl(){return Zr(this.layerUrl)}get featureServiceUrl(){return Zu(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return Zu(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(this.dataElement){const i=this.dataElement.domainNetworks;for(const r of i){for(const n of r.edgeSources??[])if(n.sourceId===e)return n.layerId;for(const n of r.junctionSources??[])if(n.sourceId===e)return n.layerId}return null}return null}async queryNamedTraceConfigurations(e,i){var p;const[{queryNamedTraceConfigurations:r},{default:n}]=await Promise.all([ie(()=>import("./queryNamedTraceConfigurations-CPanjQTn.js"),[]),ie(()=>import("./QueryNamedTraceConfigurationsParameters-BUAjJKfl.js"),[])]),o=this.networkServiceUrl,u=n.from(e);return(p=await r(o,u,{...i}))==null?void 0:p.namedTraceConfigurations}async validateTopology(e,i){var S,T,E;if(!e.validateArea)throw new re("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:r},{default:n}]=await Promise.all([ie(()=>import("./validateNetworkTopology-DJip-M4o.js"),[]),ie(()=>import("./ValidateNetworkTopologyParameters-BCY2vf5n.js"),[])]),o=n.from(e);BT(this.featureServiceUrl,this.gdbVersion||null)?(o.sessionID=JA,await RV(this.featureServiceUrl,this.gdbVersion,!0)):o.sessionID=null,o.gdbVersion=this.gdbVersion;const u=this.networkServiceUrl,p=this.featureServiceUrl,g=FV(p,null,this.gdbVersion,!0),w=await r(u,o,{...i});if(w!=null&&w.serviceEdits){const C=[];for(const L of w.serviceEdits){const{editedFeatures:R}=L,F=R!=null&&R.spatialReference?new Ge(R.spatialReference):null;C.push({layerId:L.layerId,editedFeatures:{adds:((S=R==null?void 0:R.adds)==null?void 0:S.map(V=>jx(V,F)))||[],updates:((T=R==null?void 0:R.updates)==null?void 0:T.map(V=>({original:jx(V[0],F),current:jx(V[1],F)})))||[],deletes:((E=R==null?void 0:R.deletes)==null?void 0:E.map(V=>jx(V,F)))||[],spatialReference:F}})}g.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:C,exceededTransferLimit:!1,historicMoment:w.moment})}return w}async submitTopologyValidationJob(e,i){let r=null;if(!e.validateArea)throw new re("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const S=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await nt(S,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:n},{default:o}]=await Promise.all([ie(()=>import("./validateNetworkTopology-DJip-M4o.js"),[]),ie(()=>import("./ValidateNetworkTopologyParameters-BCY2vf5n.js"),[])]),u=o.from(e);BT(this.featureServiceUrl,this.gdbVersion||null)?(u.sessionID=JA,await RV(this.featureServiceUrl,this.gdbVersion,!0)):u.sessionID=null,u.gdbVersion=this.gdbVersion||r;const p=this.networkServiceUrl,g=this.featureServiceUrl?FV(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,w=await n(p,u,{...i});return new LTe({statusUrl:w,editsResolver:g})}async _fetchLayerMetaData(e,i){const r=await nt(e,{responseType:"json",query:{f:"json"},...i});this.sourceJSON=r.data,this.read(r.data,{origin:"service"})}async _fetchDataElement(e,i,r){if(this.dataElement)return;const n=await nt(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([i]),f:"json"},...r}).then(o=>{var u;return(u=o.data.layerDataElements)==null?void 0:u[0]});n&&this.read(n,{origin:"service"})}};function jx(t,e){return new Cr({attributes:t.attributes,geometry:dh({...t.geometry,spatialReference:e})})}m([b({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],Qr.prototype,"id",void 0),m([b({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],Qr.prototype,"title",void 0),m([b({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],Qr.prototype,"layerUrl",void 0),m([b({type:Object,json:{origins:{service:{read:!0}},read:!1}})],Qr.prototype,"dataElement",void 0),m([b({type:jt,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],Qr.prototype,"fullExtent",void 0),m([b({type:Ge,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],Qr.prototype,"spatialReference",void 0),m([b({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],Qr.prototype,"type",void 0),m([b({readOnly:!0})],Qr.prototype,"datasetName",null),m([b({readOnly:!0})],Qr.prototype,"owner",null),m([b({readOnly:!0})],Qr.prototype,"schemaGeneration",null),m([b({readOnly:!0})],Qr.prototype,"parsedUrl",null),m([b({readOnly:!0})],Qr.prototype,"featureServiceUrl",null),m([b({readOnly:!0})],Qr.prototype,"networkServiceUrl",null),m([b({readOnly:!0})],Qr.prototype,"layerId",null),m([b()],Qr.prototype,"sourceJSON",void 0),m([b({readOnly:!0})],Qr.prototype,"networkSystemLayers",null),m([b()],Qr.prototype,"gdbVersion",void 0),m([b({type:Date})],Qr.prototype,"historicMoment",void 0),Qr=m([G("esri.networks.Network")],Qr);const PTe=Qr;var kp;(function(t){t[t.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",t[t.RTAttachment=2]="RTAttachment",t[t.RTContainment=3]="RTContainment",t[t.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",t[t.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(kp||(kp={}));const Vx=new et({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),OYe=new et({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),RTe={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},PYe=new et({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let Jd=class extends Um(Qo){constructor(e){super(e),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=nt}initialize(){}async load(e){const i=this.layer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(i),this}getFeatureSQL(e,i){var w,S;const r=e.layerId.toString(),n=(w=e.fieldsIndex)==null?void 0:w.normalizeFieldName("assetGroup"),o=(S=e.fieldsIndex)==null?void 0:S.normalizeFieldName("assetType"),u=n?i.attributes[n]:null,p=o?i.attributes[o]:null,g=this.rulesHash[r];if(g){const T=g.assetGroupHash[u];if(T)return T.assetTypeHash[p]||null}return null}async _initializeRulesTable(){var n,o,u,p,g,w,S,T,E,C,L;const e={};let i;(function(R){R[R.from=0]="from",R[R.to=1]="to",R[R.via=2]="via"})(i||(i={}));const r=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const R of this.rules){if(R.ruleType===kp.RTAttachment){this.rulesCategorized.attachment.push(R);continue}if(R.ruleType===kp.RTContainment){this.rulesCategorized.containment.push(R);continue}if(R.ruleType===kp.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(R);continue}this.rulesCategorized.connectivity.push(R);let F=[[i.from,i.to],[i.to,i.from]];R.ruleType===kp.RTEdgeJunctionEdgeConnectivity&&(F=[[i.from,i.via],[i.via,i.from],[i.to,i.via],[i.via,i.to]]);for(const V of F){const U=V.shift(),W=V.shift();let H=!1;switch(R.ruleType){case kp.RTEdgeJunctionEdgeConnectivity:H=U===i.from||U===i.to;break;case kp.RTJunctionEdgeConnectivity:H=U===i.to}const J=r[U],X=((n=R[J.networkSourceId])==null?void 0:n.layerId.toString())??"",te=(u=(o=R[J.assetGroupId])==null?void 0:o.assetGroupCode)==null?void 0:u.toString(),oe=R[J.assetTypeId],pe=(p=oe==null?void 0:oe.assetTypeCode)==null?void 0:p.toString(),de=r[W],ge=((g=R[de.networkSourceId])==null?void 0:g.layerId.toString())??"",we=(S=(w=R[de.assetGroupId])==null?void 0:w.assetGroupCode)==null?void 0:S.toString(),ke=R[de.assetTypeId],$e=(T=ke==null?void 0:ke.assetTypeCode)==null?void 0:T.toString(),Fe=e[X]??{assetGroupHash:{}};if(!(te&&pe&&we&&$e))continue;const yt=Fe.assetGroupHash[te]??{assetTypeHash:{}},qe=yt.assetTypeHash[pe]??{};if(qe[ge]=qe[ge]??{},H){qe[X]=qe[X]??{};const ei=`(assetgroup = ${te} AND assettype = ${pe})`;qe[X].anyVertex=qe[X].anyVertex?`${qe[X].anyVertex}`:`${ei}`,(ke==null?void 0:ke.connectivityPolicy)==="esriNECPEndVertex"&&(qe[X].endVertex=(E=qe[X])!=null&&E.endVertex?`${qe[X].endVertex}`:`${ei}`)}const Ue=`(assetgroup = ${we} AND assettype = ${$e})`;qe[ge].anyVertex=(C=qe[ge])!=null&&C.anyVertex?`${qe[ge].anyVertex} OR ${Ue}`:`${Ue}`,(ke==null?void 0:ke.connectivityPolicy)==="esriNECPEndVertex"&&(qe[ge].endVertex=(L=qe[ge])!=null&&L.endVertex?`${qe[ge].endVertex} OR ${Ue}`:`${Ue}`),yt.assetTypeHash[pe]=qe,Fe.assetGroupHash[te]=yt,e[X]=Fe}}this.rulesHash=e}};m([b({constructOnly:!0})],Jd.prototype,"layer",void 0),m([b({constructOnly:!0})],Jd.prototype,"rules",void 0),m([b()],Jd.prototype,"rulesHash",void 0),m([b()],Jd.prototype,"rulesCategorized",void 0),m([b({constructOnly:!0})],Jd.prototype,"request",void 0),Jd=m([G("esri.networks.RulesTable")],Jd);const FTe=Jd;let ul=class extends ye{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};m([b({type:[Object],json:{write:!0}})],ul.prototype,"conditionBarriers",void 0),m([b({type:[Object],json:{write:!0}})],ul.prototype,"outputConditions",void 0),m([b({type:[Object],json:{write:!0}})],ul.prototype,"functions",void 0),m([b({type:[Object],json:{write:!0}})],ul.prototype,"functionBarriers",void 0),m([b({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],ul.prototype,"traversabilityScope",void 0),m([b({type:String,json:{write:!0}})],ul.prototype,"shortestPathNetworkAttributeName",void 0),m([b({type:Boolean,json:{write:!0}})],ul.prototype,"includeBarriers",void 0),m([b({type:Boolean,json:{write:!0}})],ul.prototype,"validateConsistency",void 0),m([b({type:Boolean,json:{write:!0}})],ul.prototype,"ignoreBarriersAtStartingPoints",void 0),ul=m([G("esri.networks.support.TraceConfiguration")],ul);const aR=ul;let xr=class extends aR{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};m([b({type:[Object],json:{write:!0}})],xr.prototype,"filterBarriers",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"arcadeExpressionBarrier",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"domainNetworkName",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"filterBitsetNetworkAttributeName",void 0),m([b({type:[Object],json:{write:!0}})],xr.prototype,"filterFunctionBarriers",void 0),m([b({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],xr.prototype,"filterScope",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"includeContainers",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"includeContent",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"includeIsolated",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"includeStructures",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"allowIndeterminateFlow",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"includeUpToFirstSpatialContainer",void 0),m([b({type:Object,json:{write:!0}})],xr.prototype,"nearestNeighbor",void 0),m([b({type:[Object],json:{write:!0}})],xr.prototype,"outputFilterCategories",void 0),m([b({type:[Object],json:{write:!0}})],xr.prototype,"outputFilters",void 0),m([b({type:[Object],json:{write:!0}})],xr.prototype,"propagators",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"subnetworkName",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"targetTierName",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"diagramTemplateName",void 0),m([b({type:String,json:{write:!0}})],xr.prototype,"tierName",void 0),m([b({type:Boolean,json:{write:!0}})],xr.prototype,"validateLocatability",void 0),xr=m([G("esri.networks.support.UNTraceConfiguration")],xr);const NTe=xr;let Oo=class extends kC{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,i){return e.tierName!==void 0?NTe.fromJSON(e):aR.fromJSON(e)}};m([b({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Oo.prototype,"globalId",void 0),m([b({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Oo.prototype,"title",void 0),m([b({type:aR,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"traceConfiguration",void 0),m([Me("service","traceConfiguration")],Oo.prototype,"readTraceConfiguration",null),m([b({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"creationDate",void 0),m([b({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"creator",void 0),m([b({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"description",void 0),m([b({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Oo.prototype,"minStartingPoints",void 0),m([b({json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"resultTypes",void 0),m([b({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Oo.prototype,"tags",void 0),m([b({type:Vx.apiValues,json:{type:Vx.jsonValues,origins:{service:{read:Vx.read,write:Vx.write}},read:!1}})],Oo.prototype,"traceType",void 0),Oo=m([G("esri.networks.support.NamedTraceConfiguration")],Oo);const DTe=Oo;let bu=class extends Te{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};m([b({constructOnly:!0})],bu.prototype,"rulesTableId",void 0),m([b({constructOnly:!0})],bu.prototype,"rulesTableUrl",void 0),m([b({constructOnly:!0})],bu.prototype,"subnetworksTableId",void 0),m([b({constructOnly:!0})],bu.prototype,"subnetworksTableUrl",void 0),m([b({constructOnly:!0})],bu.prototype,"dirtyAreasLayerId",void 0),m([b({constructOnly:!0})],bu.prototype,"dirtyAreasLayerUrl",void 0),m([b({constructOnly:!0})],bu.prototype,"associationsTableId",void 0),m([b({constructOnly:!0})],bu.prototype,"associationsTableUrl",void 0),bu=m([G("esri.networks.support.NetworkSystemLayers")],bu);const jTe=bu;let b1=class extends ye{constructor(e){super(e),this.id=null,this.name=null}};m([b({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],b1.prototype,"id",void 0),m([b({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],b1.prototype,"name",void 0),m([b({type:Boolean,json:{write:!0}})],b1.prototype,"isUpstreamTerminal",void 0),b1=m([G("esri.networks.support.Terminal")],b1);const VTe=b1,zx=new et({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let Zd=class extends ye{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};m([b({type:String,json:{write:!0}})],Zd.prototype,"defaultConfiguration",void 0),m([b({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],Zd.prototype,"id",void 0),m([b({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],Zd.prototype,"name",void 0),m([b({type:[VTe],json:{write:!0}})],Zd.prototype,"terminals",void 0),m([b({type:zx.apiValues,json:{type:zx.jsonValues,read:zx.read,write:zx.write}})],Zd.prototype,"traversabilityModel",void 0),Zd=m([G("esri.networks.support.TerminalConfiguration")],Zd);const wz=Zd;let w1=class extends ye{constructor(e){super(e),this.line=null,this.multipoint=null,this.polygon=null}};m([b({type:Bn,json:{write:!0},readOnly:!0})],w1.prototype,"line",void 0),m([b({type:lh,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],w1.prototype,"multipoint",void 0),m([b({type:xo,json:{write:!0},readOnly:!0})],w1.prototype,"polygon",void 0),w1=m([G("esri.rest.networks.support.AggregatedGeometry")],w1);const zTe=w1;let _1=class extends ye{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};m([b({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],_1.prototype,"functionType",void 0),m([b({type:String,json:{write:!0},readOnly:!0})],_1.prototype,"networkAttributeName",void 0),m([b({type:Number,json:{write:!0},readOnly:!0})],_1.prototype,"result",void 0),_1=m([G("esri.rest.networks.support.FunctionResult")],_1);const UTe=_1;let wu=class extends ye{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};m([b({type:Number,json:{write:!0}})],wu.prototype,"assetGroupCode",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"assetTypeCode",void 0),m([b({type:String,json:{write:!0}})],wu.prototype,"globalId",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"networkSourceId",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"objectId",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"positionFrom",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"positionTo",void 0),m([b({type:Number,json:{write:!0}})],wu.prototype,"terminalId",void 0),wu=m([G("esri.rest.networks.support.NetworkElement")],wu);const GTe=wu;let rp=class extends ye{constructor(e){super(e),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};m([b({type:zTe,json:{write:!0},readOnly:!0})],rp.prototype,"aggregatedGeometry",void 0),m([b({type:[GTe],json:{write:!0},readOnly:!0})],rp.prototype,"elements",void 0),m([b({type:[UTe],json:{write:!0},readOnly:!0})],rp.prototype,"globalFunctionResults",void 0),m([b({type:Boolean,json:{write:!0},readOnly:!0})],rp.prototype,"kFeaturesForKNNFound",void 0),m([b({type:Boolean,json:{write:!0},readOnly:!0})],rp.prototype,"startingPointsIgnored",void 0),m([b({type:[String],json:{write:!0},readOnly:!0})],rp.prototype,"warnings",void 0),rp=m([G("esri.rest.networks.support.TraceResult")],rp);const BTe=rp,qTe=dt()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let vy=class extends BTe{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:r}=await nt(this.statusUrl,i),n=r.traceResults?{...r.traceResults,...r}:r;return this.read(n),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:r}=e;return new Promise((n,o)=>{this._clearTimer();const u=setInterval(()=>{this._timer||o(ni()),this.checkJobStatus().then(p=>{const{status:g}=p;switch(this.status=g,g){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":r&&r(this)}},p=>{this._clearTimer(),o(p)})},i);this._timer=u})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};m([b({type:String,json:{write:!0}})],vy.prototype,"statusUrl",void 0),m([ze(qTe)],vy.prototype,"status",void 0),m([b({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],vy.prototype,"submissionTime",void 0),m([b({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],vy.prototype,"lastUpdatedTime",void 0),vy=m([G("esri.networks.support.TraceJobInfo")],vy);const HTe=vy;let np=class extends PTe{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,i,r,n,o,u,p,g;return new jTe({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(i=this.sourceJSON)==null?void 0:i.systemLayers.rulesTableId}`:null,subnetworksTableId:(r=this.sourceJSON)==null?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(n=this.sourceJSON)==null?void 0:n.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(o=this.sourceJSON)==null?void 0:o.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(u=this.sourceJSON)==null?void 0:u.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:(p=this.sourceJSON)==null?void 0:p.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(g=this.sourceJSON)==null?void 0:g.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(i=>wz.fromJSON(i)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(i=>i.domainNetworkName))||[]}get _utilityLayerList(){var i,r;const e=new Set;return(r=(i=this.dataElement)==null?void 0:i.domainNetworks)==null||r.map(n=>{n.edgeSources.map(o=>{e.add(o.layerId)}),n.junctionSources.map(o=>{e.add(o.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var w,S,T,E;let i=null,r=null;const n=e.layer;let o=null;if((n==null?void 0:n.type)==="feature"){if(o=n.layerId,o===null)return null}else if((n==null?void 0:n.type)!=="subtype-sublayer"||(o=((w=n==null?void 0:n.parent)==null?void 0:w.layerId)??null,o===null))return null;const u=e.attributes;if(u==null)return null;for(const C of Object.keys(u))C.toUpperCase()==="ASSETGROUP"&&(i=e.getAttribute(C)),C.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(C));if(!this.dataElement)return null;let p=null;const g=this.dataElement.domainNetworks;for(const C of g){const L=(S=C.junctionSources)==null?void 0:S.find(R=>R.layerId===o);if(L){const R=(T=L.assetGroups)==null?void 0:T.find(F=>F.assetGroupCode===i);if(R){const F=(E=R.assetTypes)==null?void 0:E.find(V=>V.assetTypeCode===r);if(F){p=F.terminalConfigurationId;break}}}}if(p!=null){const C=this.dataElement.terminalConfigurations,L=C==null?void 0:C.find(R=>R.terminalConfigurationId===p);return L?wz.fromJSON(L):null}return null}getTierNames(e){var r;const i=(r=this.dataElement)==null?void 0:r.domainNetworks.find(n=>n.domainNetworkName===e);return(i==null?void 0:i.tiers.map(n=>n.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}isUtilityLayer(e){var i;return this._utilityLayerList.has(e.layerId)&&(((i=e.url)==null?void 0:i.startsWith(this.featureServiceUrl))??!1)}async queryAssociations(e){const[{queryAssociations:i},{default:r}]=await Promise.all([ie(()=>import("./queryAssociations-Bhax4Dgh.js"),__vite__mapDeps([136,137])),ie(()=>import("./QueryAssociationsParameters-j0e1cfjN.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,(await i(this.networkServiceUrl,n)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:i},{default:r}]=await Promise.all([ie(()=>import("./synthesizeAssociationGeometries-B7BChGLz.js"),__vite__mapDeps([138,137])),ie(()=>import("./SynthesizeAssociationGeometriesParameters-Dx2elOB8.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,i(this.networkServiceUrl,n)}async trace(e){const[{trace:i},{default:r}]=await Promise.all([ie(()=>import("./trace-uUzli2Lg.js"),[]),ie(()=>import("./TraceParameters-Dti7CuI4.js"),[])]),n=r.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,i(this.networkServiceUrl,n)}async submitTraceJob(e){const[{submitTraceJob:i},{default:r}]=await Promise.all([ie(()=>import("./trace-uUzli2Lg.js"),[]),ie(()=>import("./TraceParameters-Dti7CuI4.js"),[])]),n=r.from(e);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;const o=await i(this.networkServiceUrl,n);return new HTe({statusUrl:o})}async canAddAssociation(e){const i=await this.getRulesTable();if(!i)return!1;await i.load();const r=(o,u)=>o?o.terminalId===1?!(u!=null&&u.terminalId)||(u==null?void 0:u.terminalId)===o.terminalId:o.terminalId===(u==null?void 0:u.terminalId):!(u!=null&&u.terminalId),n=(o,u)=>{var p,g,w,S,T,E,C,L,R,F,V,U;return((p=o.fromNetworkSource)==null?void 0:p.sourceId)===((g=u.fromNetworkElement)==null?void 0:g.networkSourceId)&&((w=o.toNetworkSource)==null?void 0:w.sourceId)===((S=u.toNetworkElement)==null?void 0:S.networkSourceId)&&((T=o.fromAssetGroup)==null?void 0:T.assetGroupCode)===((E=u.fromNetworkElement)==null?void 0:E.assetGroupCode)&&((C=o.fromAssetType)==null?void 0:C.assetTypeCode)===((L=u.fromNetworkElement)==null?void 0:L.assetTypeCode)&&((R=o.toAssetGroup)==null?void 0:R.assetGroupCode)===((F=u.toNetworkElement)==null?void 0:F.assetGroupCode)&&((V=o.toAssetType)==null?void 0:V.assetTypeCode)===((U=u.toNetworkElement)==null?void 0:U.assetTypeCode)&&r(o.fromTerminal,u.fromNetworkElement)&&r(o.toTerminal,u.toNetworkElement)};return e.associationType==="containment"?i.rulesCategorized.containment.some(o=>n(o,e)):e.associationType==="attachment"?i.rulesCategorized.attachment.some(o=>n(o,e)):i.rulesCategorized.connectivity.some(o=>{var u,p,g,w,S,T,E,C,L,R,F,V,U,W,H,J,X,te,oe,pe,de,ge,we,ke;return o.viaNetworkSource?((u=o.fromNetworkSource)==null?void 0:u.sourceId)===((p=e.fromNetworkElement)==null?void 0:p.networkSourceId)&&((g=o.viaNetworkSource)==null?void 0:g.sourceId)===((w=e.toNetworkElement)==null?void 0:w.networkSourceId)&&((S=o.fromAssetGroup)==null?void 0:S.assetGroupCode)===((T=e.fromNetworkElement)==null?void 0:T.assetGroupCode)&&((E=o.fromAssetType)==null?void 0:E.assetTypeCode)===((C=e.fromNetworkElement)==null?void 0:C.assetTypeCode)&&((L=o.viaAssetGroup)==null?void 0:L.assetGroupCode)===((R=e.toNetworkElement)==null?void 0:R.assetGroupCode)&&((F=o.viaAssetType)==null?void 0:F.assetTypeCode)===((V=e.toNetworkElement)==null?void 0:V.assetTypeCode)&&r(o.fromTerminal,e.fromNetworkElement)&&r(o.viaTerminal,e.toNetworkElement)||((U=o.viaNetworkSource)==null?void 0:U.sourceId)===((W=e.fromNetworkElement)==null?void 0:W.networkSourceId)&&((H=o.toNetworkSource)==null?void 0:H.sourceId)===((J=e.toNetworkElement)==null?void 0:J.networkSourceId)&&((X=o.viaAssetGroup)==null?void 0:X.assetGroupCode)===((te=e.fromNetworkElement)==null?void 0:te.assetGroupCode)&&((oe=o.viaAssetType)==null?void 0:oe.assetTypeCode)===((pe=e.fromNetworkElement)==null?void 0:pe.assetTypeCode)&&((de=o.toAssetGroup)==null?void 0:de.assetGroupCode)===((ge=e.toNetworkElement)==null?void 0:ge.assetGroupCode)&&((we=o.toAssetType)==null?void 0:we.assetTypeCode)===((ke=e.toNetworkElement)==null?void 0:ke.assetTypeCode)&&r(o.viaTerminal,e.fromNetworkElement)&&r(o.toTerminal,e.toNetworkElement):n(o,e)})}generateAddAssociations(e){return{addFeatures:e.map(i=>{var r,n,o,u,p,g;return new Cr({attributes:{fromnetworksourceid:(r=i.fromNetworkElement)==null?void 0:r.networkSourceId,fromglobalid:(n=i.fromNetworkElement)==null?void 0:n.globalId,fromterminalid:(o=i.fromNetworkElement)==null?void 0:o.terminalId,tonetworksourceid:(u=i.toNetworkElement)==null?void 0:u.networkSourceId,toglobalid:(p=i.toNetworkElement)==null?void 0:p.globalId,toterminalid:(g=i.toNetworkElement)==null?void 0:g.terminalId,associationtype:RTe[i.associationType],iscontentvisible:i.isContentVisible?1:0,percentalong:i.percentAlong,globalid:i.globalId}})}),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(e){return{deleteFeatures:e.map(i=>({globalId:i.globalId})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(e){var n;if(((n=this.sharedNamedTraceConfigurations)==null?void 0:n.length)===0)return;const i=this.sharedNamedTraceConfigurations.map(o=>o.globalId),r=await this.queryNamedTraceConfigurations({globalIds:i},e);for(const o of this.sharedNamedTraceConfigurations){const u=r==null?void 0:r.find(p=>p.globalId===o.globalId);if(u){const p=u.write({},{origin:"service"});o.read(p,{origin:"service"})}}}async _createRulesTable(){var u;const e=this.networkSystemLayers.rulesTableUrl,i=new oR({url:e});await i.load();const r=(u=this.dataElement)==null?void 0:u.domainNetworks;if(!r)return null;const n=r.flatMap(p=>[...p.edgeSources||[],...p.junctionSources||[]]),o=(await WTe(i)).map(p=>this._hydrateRuleInfo(i,n,p));return new FTe({layer:i,rules:o})}_hydrateRuleInfo(e,i,r){const n=e.fieldsIndex,o=n.get("RULETYPE"),u=n.get("CREATIONDATE"),p=n.get("FROMNETWORKSOURCEID"),g=n.get("FROMASSETGROUP"),w=n.get("FROMASSETTYPE"),S=n.get("FROMTERMINALID"),T=n.get("TONETWORKSOURCEID"),E=n.get("TOASSETGROUP"),C=n.get("TOASSETTYPE"),L=n.get("TOTERMINALID"),R=n.get("VIANETWORKSOURCEID"),F=n.get("VIAASSETGROUP"),V=n.get("VIAASSETTYPE"),U=n.get("VIATERMINALID"),W=r.attributes[o.name],H=new Date(r.attributes[u.name]),J=[{networkSourceId:r.attributes[p.name],assetGroupId:r.attributes[g.name],assetTypeId:r.attributes[w.name],terminalId:r.attributes[S.name]},{networkSourceId:r.attributes[T.name],assetGroupId:r.attributes[E.name],assetTypeId:r.attributes[C.name],terminalId:r.attributes[L.name]},{networkSourceId:r.attributes[R.name],assetGroupId:r.attributes[F.name],assetTypeId:r.attributes[V.name],terminalId:r.attributes[U.name]}];let X;(function(oe){oe[oe.from=0]="from",oe[oe.to=1]="to",oe[oe.via=2]="via"})(X||(X={}));const te={ruleType:W,creationDate:H};for(const oe of[X.from,X.to,X.via]){if(W!==kp.RTEdgeJunctionEdgeConnectivity&&oe===X.via)continue;const pe=J[oe],de=i.find(Fe=>Fe.sourceId===pe.networkSourceId),ge=de==null?void 0:de.assetGroups.find(Fe=>Fe.assetGroupCode===pe.assetGroupId),we=ge==null?void 0:ge.assetTypes.find(Fe=>Fe.assetTypeCode===pe.assetTypeId),ke=this._getTerminal(we,pe);let $e="";switch(oe){case X.from:$e="from";break;case X.to:$e="to";break;case X.via:$e="via"}te[`${$e}NetworkSource`]=de,te[`${$e}AssetGroup`]=ge,te[`${$e}AssetType`]=we,te[`${$e}Terminal`]=ke==null?void 0:ke.toJSON()}return te}_getTerminal(e,i){var o,u;const r=e==null?void 0:e.terminalConfigurationId,n=(o=this.terminalConfigurations)==null?void 0:o.find(p=>p.id===r);return((u=n==null?void 0:n.terminals)==null?void 0:u.find(p=>p.id===i.terminalId))??null}};async function WTe(t){const e=new ec({where:"1=1",outFields:["*"]});return(await ote(t,e)).features}m([b({type:[DTe],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],np.prototype,"sharedNamedTraceConfigurations",void 0),m([b({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],np.prototype,"type",void 0),m([b({readOnly:!0})],np.prototype,"serviceTerritoryFeatureLayerId",null),m([b({readOnly:!0})],np.prototype,"networkSystemLayers",null),m([b({readOnly:!0})],np.prototype,"terminalConfigurations",null),m([b({readOnly:!0})],np.prototype,"domainNetworkNames",null),np=m([G("esri.networks.UtilityNetwork")],np);const zte=np,JTe=Object.freeze(Object.defineProperty({__proto__:null,default:zte},Symbol.toStringTag,{value:"Module"}));let Kd=class extends ye{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};m([b({type:String,json:{write:!0}})],Kd.prototype,"facilityIdField",void 0),m([b({type:String,json:{write:!0}})],Kd.prototype,"layerId",void 0),m([b({type:String,json:{write:!0}})],Kd.prototype,"nameField",void 0),m([b({type:String,json:{write:!0}})],Kd.prototype,"siteIdField",void 0),m([b({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],Kd.prototype,"sublayerId",void 0),Kd=m([G("esri.layers.support.FacilityLayerInfo")],Kd);const ZTe=Kd;let _u=class extends ye{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};m([b({type:String,json:{write:!0}})],_u.prototype,"facilityIdField",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"layerId",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"levelIdField",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"levelNumberField",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"longNameField",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"shortNameField",void 0),m([b({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],_u.prototype,"sublayerId",void 0),m([b({type:String,json:{write:!0}})],_u.prototype,"verticalOrderField",void 0),_u=m([G("esri.layers.support.LevelLayerInfo")],_u);const KTe=_u;let by=class extends ye{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};m([b({type:String,json:{write:!0}})],by.prototype,"layerId",void 0),m([b({type:String,json:{write:!0}})],by.prototype,"nameField",void 0),m([b({type:String,json:{write:!0}})],by.prototype,"siteIdField",void 0),m([b({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],by.prototype,"sublayerId",void 0),by=m([G("esri.layers.support.SiteLayerInfo")],by);const YTe=by;let S1=class extends ye{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};m([b({type:KTe,json:{write:!0}})],S1.prototype,"levelLayer",void 0),m([b({type:ZTe,json:{write:!0}})],S1.prototype,"facilityLayer",void 0),m([b({type:YTe,json:{write:!0}})],S1.prototype,"siteLayer",void 0),S1=m([G("esri.support.MapFloorInfo")],S1);const XTe=S1;let x1=class extends Gt(ye){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};m([b({type:String,json:{write:{isRequired:!0}}})],x1.prototype,"expression",void 0),m([b({type:["number","string"],json:{write:!0}})],x1.prototype,"returnType",void 0),m([b({type:String,json:{write:!0}})],x1.prototype,"title",void 0),x1=m([G("esri.webdoc.geotriggersInfo.ExpressionInfo")],x1);const Ute=x1,Ux=new et({deviceLocation:"device-location"});let z_=class extends Gt(ye){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};m([b({type:Ute,json:{write:!0}})],z_.prototype,"filterExpression",void 0),m([b({type:Ux.apiValues,readOnly:!0,json:{type:Ux.jsonValues,read:Ux.read,write:Ux.write}})],z_.prototype,"type",void 0),z_=m([G("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],z_);const QTe=z_;let U_=class extends Gt(ye){constructor(e){super(e),this.geometry=null,this.where=null}};m([b({types:h0,json:{read:dh,write:!0}})],U_.prototype,"geometry",void 0),m([b({type:String,json:{write:!0}})],U_.prototype,"where",void 0),U_=m([G("esri.webdoc.geotriggersInfo.FeatureFilter")],U_);const e5e=U_;let $1=class extends Gt(ye){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};m([b({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],$1.prototype,"layerId",void 0),m([b({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],$1.prototype,"layerUrl",void 0),m([ze({featureLayer:"feature-layer"},{readOnly:!0})],$1.prototype,"type",void 0),$1=m([G("esri.webdoc.geotriggersInfo.FeatureLayerSource")],$1);const t5e=$1;let wy=class extends Gt(ye){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};m([b({type:t5e,json:{write:{isRequired:!0}}})],wy.prototype,"fenceSource",void 0),m([b({type:e5e,json:{write:!0}})],wy.prototype,"filter",void 0),m([b({type:Number,json:{write:!0}})],wy.prototype,"bufferDistance",void 0),m([ze({features:"features"},{readOnly:!0})],wy.prototype,"type",void 0),wy=m([G("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],wy);const i5e=wy;let KT=class extends Gt(ye){constructor(e){super(e),this.type="fence"}};m([ze({fence:"fence"},{readOnly:!0})],KT.prototype,"type",void 0),KT=m([G("esri.webdoc.geotriggersInfo.Geotrigger")],KT);const Gte=KT;let G_=class extends Gt(ye){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};m([b({type:Ute,json:{write:!0}})],G_.prototype,"expressionInfo",void 0),m([b({type:[String],json:{write:!0}})],G_.prototype,"requestedActions",void 0),G_=m([G("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],G_);const r5e=G_,n5e=new et({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),s5e=new et({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),Gx=new et({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let Su=class extends Gte{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};m([ze(n5e)],Su.prototype,"enterExitRule",void 0),m([b({type:QTe,json:{write:{isRequired:!0}}})],Su.prototype,"feed",void 0),m([ze(s5e)],Su.prototype,"feedAccuracyMode",void 0),m([b({type:Gx.apiValues,json:{type:Gx.jsonValues,read:Gx.read,write:{writer:Gx.write,isRequired:!0}}})],Su.prototype,"fenceNotificationRule",void 0),m([b({type:i5e,json:{write:{isRequired:!0}}})],Su.prototype,"fenceParameters",void 0),m([b({type:String,json:{write:!0}})],Su.prototype,"name",void 0),m([b({type:r5e,json:{write:!0}})],Su.prototype,"notificationOptions",void 0),m([ze({fence:"fence"},{readOnly:!0})],Su.prototype,"type",void 0),Su=m([G("esri.webdoc.geotriggersInfo.FenceGeotrigger")],Su);const o5e=Su,a5e={base:Gte,key:"type",typeMap:{fence:o5e}};let YT=class extends Gt(ye){constructor(e){super(e),this.geotriggers=null}};m([b({types:[a5e],json:{write:{isRequired:!0}}})],YT.prototype,"geotriggers",void 0),YT=m([G("esri.webdoc.GeotriggersInfo")],YT);const l5e=YT;var IL;let T1=IL=class extends ye{constructor(t){super(t),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new IL(ae({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};m([b({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],T1.prototype,"activeRange",void 0),m([b({type:[Number],json:{write:!0}})],T1.prototype,"currentRangeExtent",void 0),m([b({type:[Number],json:{write:!0}})],T1.prototype,"fullRangeExtent",void 0),T1=IL=m([G("esri.webdoc.RangeInfo")],T1);const lR=T1;var ML;let Mc=ML=class extends ye{constructor(t){super(t),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new ML(ae({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};m([b({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Mc.prototype,"enabled",void 0),m([b({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Mc.prototype,"longNames",void 0),m([b({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Mc.prototype,"minimized",void 0),m([b({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Mc.prototype,"pinnedLevels",void 0),m([b({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Mc.prototype,"site",void 0),m([b({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Mc.prototype,"facility",void 0),m([b({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Mc.prototype,"level",void 0),Mc=ML=m([G("esri.webdoc.widgets.FloorFilter")],Mc);const u5e=Mc;var kL;const Bx=new et({slider:"slider",picker:"picker"});let E1=kL=class extends ye{constructor(t){super(t),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new kL({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};m([b({type:Bx.apiValues,nonNullable:!0,json:{type:Bx.jsonValues,default:null,read:{reader:Bx.read},write:{isRequired:!0,writer:Bx.write}}})],E1.prototype,"interactionMode",void 0),m([b({type:zt,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const t=this.stopInterval!=null;return{enabled:!t,isRequired:!t}}}}})],E1.prototype,"numStops",void 0),m([b({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],E1.prototype,"stopInterval",void 0),E1=kL=m([G("esri.webdoc.widgets.Range")],E1);const c5e=E1;var CL;let Dn=CL=class extends ye{constructor(t){super(t),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(t){if(!t)return;const e=t[0]!=null?new Date(t[0]):null,i=t[1]!=null?new Date(t[1]):null;return new Di({start:e,end:i})}writeCurrentTimeExtent(t,e,i){t&&Wn(i,[t.start!=null?t.start.getTime():null,t.end!=null?t.end.getTime():null],e)}readFullTimeExtent(t,e){const i=e.properties;if(!i)return;const r=i.endTime!=null?new Date(i.endTime):null,n=i.startTime!=null?new Date(i.startTime):null;return new Di({start:n,end:r})}writeFullTimeExtent(t,e){if(!t)return;const i=e.properties=e.properties||{},r=t.end,n=t.start;r&&(i.endTime=r!=null?r.getTime():null),n&&(i.startTime=n!=null?n.getTime():null)}readStopInterval(t,e,i){return t?Yp.fromJSON({value:t.interval,unit:t.units},i):null}writeStopInterval(t,e,i,r){if(!t)return;const n=t.toJSON(r);Wn("properties.timeStopInterval",{interval:n.value,units:n.unit},e)}readStops(t){return t!=null&&t.length?t.map(e=>new Date(e)):null}writeStops(t,e,i){t!=null&&t.length&&Wn(i,t.map(r=>r.getTime()),e)}clone(){return new CL(ae({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};m([b({type:Di,json:{type:[[zt,Vb]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],Dn.prototype,"currentTimeExtent",void 0),m([Me("currentTimeExtent")],Dn.prototype,"readCurrentTimeExtent",null),m([Le("currentTimeExtent")],Dn.prototype,"writeCurrentTimeExtent",null),m([b({type:Di,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],Dn.prototype,"fullTimeExtent",void 0),m([Me("fullTimeExtent")],Dn.prototype,"readFullTimeExtent",null),m([Le("fullTimeExtent")],Dn.prototype,"writeFullTimeExtent",null),m([b({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],Dn.prototype,"loop",void 0),m([b({type:zt,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var r;const t=!!this.stopInterval,e=!!((r=this.stops)!=null&&r.length),i=!(t||e);return{enabled:i,isRequired:i}}}}})],Dn.prototype,"numStops",void 0),m([b({type:[1,2],nonNullable:!0,json:{type:zt,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],Dn.prototype,"numThumbs",void 0),m([b({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],Dn.prototype,"stopDelay",void 0),m([b({type:Yp,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:nR.jsonValues.filter(t=>t!=="esriTimeUnitsUnknown")}},overridePolicy(){var i;const t=this.numStops!=null,e=!!((i=this.stops)!=null&&i.length);return{enabled:!e,isRequired:!(t||e)}}}}})],Dn.prototype,"stopInterval",void 0),m([Me("stopInterval")],Dn.prototype,"readStopInterval",null),m([Le("stopInterval")],Dn.prototype,"writeStopInterval",null),m([b({type:[Date],json:{type:[zt],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],Dn.prototype,"stops",void 0),m([Me("stops")],Dn.prototype,"readStops",null),m([Le("stops")],Dn.prototype,"writeStops",null),Dn=CL=m([G("esri.webdoc.widgets.TimeSlider")],Dn);const Bte=Dn;var AL;let I1=AL=class extends ye{constructor(t){super(t),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new AL(ae({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};m([b({type:c5e,json:{write:!0}})],I1.prototype,"range",void 0),m([b({type:Bte,json:{write:!0}})],I1.prototype,"timeSlider",void 0),m([b({type:u5e,json:{write:!0}})],I1.prototype,"floorFilter",void 0),I1=AL=m([G("esri.webdoc.Widgets")],I1);const qte=I1,h5e={width:600,height:400},qx=1.5;function p5e(t,e){e=e||h5e;let{width:i,height:r}=e;const n=i/r;return n<qx?r=i/qx:n>qx&&(i=r*qx),i>t.width&&(r*=t.width/i,i=t.width),r>t.height&&(i*=t.height/r,r=t.height),{width:Math.round(i),height:Math.round(r)}}function d5e(t,e){return{...Hte(t,e),readResourcePaths:[]}}function aXe(t,e,i){const r=Zr(t.itemUrl);return{...Hte(t,e),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:r?{rootPath:r.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function Hte(t,e){return{origin:e,url:Zr(t.itemUrl),portal:t.portal||wr.getDefault(),portalItem:t}}function xS(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function Du(t){return typeof t=="string"?Zr(t):ae(t)}function $S(t,e,i){const r={};for(const n in t){if(n==="declaredClass")continue;const o=t[n];if(o!=null&&typeof o!="function")if(Array.isArray(o))r[n]=o.map(u=>$S(u));else if(typeof o=="object")if(o.toJSON){const u=o.toJSON(i==null?void 0:i[n]);r[n]=e?u:JSON.stringify(u)}else r[n]=e?o:JSON.stringify(o);else r[n]=o}return r}function ME(t,e){var i;return t?nP(t)&&(e||Ct.apiKey)?e||Ct.apiKey:(i=rt==null?void 0:rt.findCredential(t))==null?void 0:i.token:null}function f5e(t){return{geometryType:rS(t[0]),geometries:t.map(e=>e.toJSON())}}function Wte(t,e,i){const r=Eme(e);return t.map(n=>{const o=r.fromJSON(n);return o.spatialReference=i,o})}let _y=class extends ye{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),i=this.geometries[0],r={};return r.outSR=nE(this.outSpatialReference),r.inSR=nE(i.spatialReference),r.geometries=JSON.stringify({geometryType:rS(i),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};m([b()],_y.prototype,"geometries",void 0),m([b({json:{read:{source:"outSR"}}})],_y.prototype,"outSpatialReference",void 0),m([b()],_y.prototype,"transformation",void 0),m([b()],_y.prototype,"transformForward",void 0),_y=m([G("esri.rest.support.ProjectParameters")],_y);const uR=_y,y5e=Yi(uR);async function Jte(t,e,i){e=y5e(e);const r=Du(t),n={...r.query,f:"json",...e.toJSON()},o=e.outSpatialReference,u=rS(e.geometries[0]),p=xS(n,i);return nt(r.path+"/project",p).then(({data:{geometries:g}})=>Wte(g,u,o))}function m5e(t,e){var i;return e.resourceInfo?Zte(e,e.resourceInfo,{origin:t.origin}):(i=e.portalItem)!=null&&i.id?g5e(t,e,e.portalItem):Promise.resolve()}function Zte(t,e,i){const r={context:{...i,layerContainerType:"operational-layers"}};return t.portalItem&&(r.context.portal=t.portalItem.portal||wr.getDefault()),ie(()=>import("./layersCreator-DYPEGeb7.js"),__vite__mapDeps([5,6,7,8])).then(({populateOperationalLayers:n})=>{const o=[],u=e.operationalLayers;u!=null&&u.length&&o.push(n(t.layers,u,r));const p={...r,context:{...r.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},g=e.tables;return g!=null&&g.length&&o.push(n(t.tables,g,p)),Promise.allSettled(o).then(()=>{})})}async function g5e(t,e,i){var u;if(await i.load().catch(p=>{throw new re(`${t.name}:load-portal-item`,"Failed to load portal item",{error:p})}),i.type!==t.itemType)throw new re(`${t.name}:invalid-portal-item`,`Invalid portal item type '${i.type}', expected '${t.itemType}'`,{type:i.type});const r=await i.fetchData();e.resourceInfo=r;const n=d5e(i,t.origin);await v5e(t,e,r,n),e.resourceReferences={portalItem:i,paths:n.readResourcePaths};const o=await w5e(e.initialViewProperties,i,fe.getLogger(e));if(o){const p=((u=e.initialViewProperties)==null?void 0:u.clone())??t.createInitialViewProperties();p.viewpoint=o,e.initialViewProperties=p}}function v5e(t,e,i,r){const n=b5e(t,i);return e.read(n,r),Zte(e,n,r)}function b5e(t,e){const i=t.parseVersion(e.version||"",t.name);return t.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}async function w5e(t,e,i){var o;if((o=t==null?void 0:t.viewpoint)==null?void 0:o.targetGeometry)return null;const n=await _5e(t,e,i);return n?new Mn({targetGeometry:n}):null}async function _5e(t,e,i){const r=t==null?void 0:t.spatialReference,n=e==null?void 0:e.extent;if(!r||!n)return null;if(r.isWGS84)return n.clone();if(r.isWebMercator)return Dp(n);const{getGeometryServiceURL:o}=await ie(()=>import("./geometryServiceUtils-hjs3Ep4E.js"),[]);try{const u=await o(e),p=new uR({geometries:[n],outSpatialReference:r});return(await Jte(u,p))[0]}catch(u){i.error("Error projecting item's extent:",u)}return null}function _z(t){return{enabled:!!(t!=null&&t.length)}}var LL;let M1=LL=class extends ye{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new LL({exactMatch:this.exactMatch,type:this.type,name:this.name})}};m([b({type:Boolean,json:{write:!0}})],M1.prototype,"exactMatch",void 0),m([b({type:String,json:{write:!0}})],M1.prototype,"name",void 0),m([ze(V8)],M1.prototype,"type",void 0),M1=LL=m([G("esri.webdoc.applicationProperties.SearchLayerField")],M1);const S5e=M1;var OL;let k1=OL=class extends ye{constructor(t){super(t),this.field=null,this.id=null,this.subLayer=null}clone(){return new OL(ae({field:this.field,id:this.id,subLayer:this.subLayer}))}};m([b({type:S5e,json:{write:{isRequired:!0}}})],k1.prototype,"field",void 0),m([b({type:String,json:{write:{isRequired:!0}}})],k1.prototype,"id",void 0),m([b({type:zt,json:{write:!0}})],k1.prototype,"subLayer",void 0),k1=OL=m([G("esri.webdoc.applicationProperties.SearchLayer")],k1);const x5e=k1;var PL;let C1=PL=class extends ye{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new PL({exactMatch:this.exactMatch,type:this.type,name:this.name})}};m([b({type:Boolean,json:{write:!0}})],C1.prototype,"exactMatch",void 0),m([b({type:String,json:{write:!0}})],C1.prototype,"name",void 0),m([ze(V8)],C1.prototype,"type",void 0),C1=PL=m([G("esri.webdoc.applicationProperties.SearchTableField")],C1);const $5e=C1;var RL;let B_=RL=class extends ye{constructor(t){super(t),this.field=null,this.id=null}clone(){return new RL(ae({field:this.field,id:this.id}))}};m([b({type:$5e,json:{write:{isRequired:!0}}})],B_.prototype,"field",void 0),m([b({type:String,json:{write:{isRequired:!0}}})],B_.prototype,"id",void 0),B_=RL=m([G("esri.webdoc.applicationProperties.SearchTable")],B_);const T5e=B_;var FL;const Kte=Ie.ofType(x5e),Yte=Ie.ofType(T5e);let kc=FL=class extends ye{constructor(t){super(t),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new Kte,this.tables=new Yte}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,e,i){e[i]=!t}clone(){return new FL(ae({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};m([b({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],kc.prototype,"addressSearchEnabled",void 0),m([Me("addressSearchEnabled")],kc.prototype,"readAddressSearchEnabled",null),m([Le("addressSearchEnabled")],kc.prototype,"writeAddressSearchEnabled",null),m([b({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],kc.prototype,"enabled",void 0),m([b({type:String,json:{write:!0}})],kc.prototype,"hintText",void 0),m([b({type:Kte,json:{write:{overridePolicy:_z},origins:{"web-scene":{write:{isRequired:!0}}}}})],kc.prototype,"layers",void 0),m([b({type:Yte,json:{read:!0,write:{overridePolicy:_z}}})],kc.prototype,"tables",void 0),kc=FL=m([G("esri.webdoc.applicationProperties.Search")],kc);const E5e=kc;var NL;let XT=NL=class extends ye{constructor(t){super(t),this.search=null}clone(){return new NL(ae({search:this.search}))}};m([b({type:E5e,json:{write:!0}})],XT.prototype,"search",void 0),XT=NL=m([G("esri.webdoc.applicationProperties.Viewing")],XT);const I5e=XT;var DL;let A1=DL=class extends ye{constructor(t){super(t),this.editing=null,this.offline=null,this.viewing=null}clone(){return new DL(ae({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};m([b({json:{write:!0}})],A1.prototype,"editing",void 0),m([b({json:{write:!0}})],A1.prototype,"offline",void 0),m([b({type:I5e,json:{write:!0}})],A1.prototype,"viewing",void 0),A1=DL=m([G("esri.webmap.ApplicationProperties")],A1);const M5e=A1,k5e="https://.*";function C5e(t){return!!t&&/^https:\/\/.*/i.test(t)}function A5e(t){return!!t&&/data:([-\w]+\/[-+\w.]+)?(;?\w+=[-\w]+)*(;base64)?,.*/gu.test(t)}var jL;let Fa=jL=class extends ye{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return C5e(this.url)}get isDataURI(){return A5e(this.url)}clone(){return new jL({url:this.url})}};m([b({type:String,json:{write:{isRequired:!0}}})],Fa.prototype,"url",void 0),m([b()],Fa.prototype,"isSecureUrl",null),m([b()],Fa.prototype,"isDataURI",null),Fa=jL=m([G("esri.webdoc.support.SlideThumbnail")],Fa);const L5e={type:Di,json:{read:{source:"timeExtent",reader:t=>t?Array.isArray(t)?Di.fromArray(t):Di.fromJSON(t):null},write:{writer:(t,e,i,r)=>{t&&(t.isEmpty?r!=null&&r.messages&&r.messages.push(new re("invalid-timeExtent","TimeExtent cannot be empty")):e[i]=t.toArray())},target:{timeExtent:{type:[[zt,Vb]]}}}}};var VL;let Cc=VL=class extends nc(ye){constructor(t){super(t),this.name=null,this.thumbnail=new Fa,this.timeExtent=null}castThumbnail(t){return typeof t=="string"?new Fa({url:t}):Yi(Fa,t)}set viewpoint(t){const{targetGeometry:e,scale:i}=t;e!=null&&e.type==="point"&&i==null&&fe.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t),this._set("viewpoint",t)}readViewpoint(t,e){const{extent:i,viewpoint:r}=e;return Mn.fromJSON(r||{targetGeometry:i})}writeViewpoint(t,e,i,r){if(!t)return;const{targetGeometry:n}=t;if(n==null||n.type==="extent")n!=null&&(e.extent=n.toJSON()),e[i]=t.toJSON();else{const o="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";r!=null&&r.messages?r.messages.push(new re("property:unsupported",o)):fe.getLogger(this).error(o)}}clone(){return new VL(ae({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};m([b({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Cc.prototype,"name",void 0),m([b({type:Fa,json:{write:{overridePolicy:t=>({enabled:!(!t||!t.url)})}}})],Cc.prototype,"thumbnail",void 0),m([Dt("thumbnail")],Cc.prototype,"castThumbnail",null),m([b(L5e)],Cc.prototype,"timeExtent",void 0),m([b({type:Mn,nonNullable:!0,json:{write:!0}})],Cc.prototype,"viewpoint",null),m([Me("viewpoint",["extent","viewpoint"])],Cc.prototype,"readViewpoint",null),m([Le("viewpoint")],Cc.prototype,"writeViewpoint",null),Cc=VL=m([G("esri.webmap.Bookmark")],Cc);const cR=Cc;var zL;let QT=zL=class extends ye{constructor(t){super(t),this.color=new Ce([0,0,0,1])}clone(){return new zL(ae({color:this.color}))}};m([b({type:Ce,json:{write:!0}})],QT.prototype,"color",void 0),QT=zL=m([G("esri.webmap.background.ColorBackground")],QT);const _M=QT;let Yd=class extends Gt(Te){constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeZone=$o,this.viewpoint=null}};m([b({type:_M})],Yd.prototype,"background",void 0),m([b({type:lR})],Yd.prototype,"rangeInfo",void 0),m([b({type:Ge})],Yd.prototype,"spatialReference",void 0),m([b({nonNullable:!0})],Yd.prototype,"timeZone",void 0),m([b({type:Mn})],Yd.prototype,"viewpoint",void 0),Yd=m([G("esri.webmap.InitialViewProperties")],Yd);const kE=Yd;let Dv=class extends PQ{constructor(e,i){super(e,i,"webmap")}};const z2=new Dv(2,31),O5e="Web Map",P5e="webmap",UL="web-map",Xte=Ie.ofType(cR),R5e=Ie.ofType(zte),F5e=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),N5e="ArcGIS Pro",D5e=Fte.JSAPI,ok={currentVersion:z2,createInitialViewProperties:()=>new kE,parseVersion:Dv.parse,itemType:O5e,name:P5e,origin:UL};let wi=class extends XI(Qo.LoadableMixin(Bb(eX))){constructor(e){super(e),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new Xte,this.floorInfo=null,this.geotriggersInfo=null,this.initialViewProperties=new kE,this.ipsInfo=null,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.utilityNetworks=null,this._debouncedSaveOperations=Da(async(i,r,n)=>{const{save:o,saveAs:u}=await ie(()=>import("./webdocSaveUtils-IWjVZ_dS.js"),__vite__mapDeps([139,122,123,140,141,125,126]));switch(i){case nh.SAVE:return o(ok,this,r);case nh.SAVE_AS:return u(ok,this,n,r)}}),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){if(this.portalItem=ot(this.portalItem),this.utilityNetworks){const e=this.utilityNetworks.removeAll();for(const i of e)i.destroy();this.utilityNetworks.destroy()}}initialize(){if(this.when().catch(e=>{fe.getLogger(this).error("#load()","Failed to load web map",e)}),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(i){return void this.addResolvingPromise(Promise.reject(i))}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,i){e&&this._isAuthoringAppSetByUser?i.authoringApp=e:i.authoringApp=D5e}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,i){e&&this._isAuthoringAppVersionSetByUser?i.authoringAppVersion=e:i.authoringAppVersion=Sn}readInitialViewProperties(e,i){var o;const r=new kE;i.background&&(r.background=_M.fromJSON(i.background));const n=(o=i.initialState)==null?void 0:o.viewpoint;return n&&(n.rotation&&Dv.parse(i.version||"","webmap").lessThan(2,20)&&i.authoringApp===N5e&&(n.rotation*=-1),r.viewpoint=Mn.fromJSON(n)),i.mapRangeInfo&&(r.rangeInfo=lR.fromJSON(i.mapRangeInfo)),i.spatialReference&&(r.spatialReference=Ge.fromJSON(i.spatialReference)),i.timeZone&&(r.timeZone=i.timeZone),r}writeInitialViewProperties(e,i,r,n){var o;e&&((o=e.background)!=null&&o.color&&(i.background=e.background.write({},n)),e.viewpoint&&(i.initialState={viewpoint:e.viewpoint.write({},n)}),e.rangeInfo&&(i.mapRangeInfo=e.rangeInfo.toJSON(n)),e.spatialReference&&(i.spatialReference=e.spatialReference.write({},n)),i.timeZone=e.timeZone)}writeLayers(e,i,r,n){i[r]=this._writeLayers(e,n,"operational-layers")}readSourceVersion(e,i){const[r,n]=i.version.split(".");return new Dv(parseInt(r,10),parseInt(n,10))}writeSourceVersion(e,i,r){i[r]=`${z2.major}.${z2.minor}`}writeTables(e,i,r,n){const o=this._writeLayers(e,n,"tables");o.length&&(i[r]=o)}get thumbnailUrl(){var e;return((e=this.portalItem)==null?void 0:e.thumbnailUrl)||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(e){return this.addResolvingPromise(m5e(ok,this)),Promise.resolve(this)}loadAll(){return lP(this,e=>{e(this.ground,this.basemap,this.layers,this.tables)})}read(e,i){i={...i,origin:UL};const r=this._getAuthoringPropsState();$J(this,e,n=>super.read(e,n),i),this._restoreAuthoringPropsFromState(r)}write(e,i){if(this.loadStatus!=="loaded"){const r=new re("webmap:not-loaded","Web map must be loaded before it can be serialized");throw fe.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),r}return this._removeDanglingLayerRefs(),i={...i,origin:UL,restrictedWebMapWriting:!0,webmap:this},super.write(e,i)}async save(e){return this._debouncedSaveOperations(nh.SAVE,e)}async saveAs(e,i){return this._debouncedSaveOperations(nh.SAVE_AS,i,e)}async updateFrom(e,i){const r=this._updateFromInternal(e,i);this._updateFromPromise=r,await r,r===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){var r,n,o,u;const i=this.resourceInfo;return this._collectAllLayersJSON([...((r=i==null?void 0:i.baseMap)==null?void 0:r.baseMapLayers)||[],...(i==null?void 0:i.operationalLayers)||[],...((u=(o=(n=this.basemap)==null?void 0:n.resourceInfo)==null?void 0:o.data)==null?void 0:u.baseMapLayers)||[]]).find(p=>p.id===e.id)}async updateItemThumbnail(){var e;this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await((e=this.portalItem)==null?void 0:e.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename})),this._clearThumbnailOverride())}getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:RJ(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_collectAllLayersJSON(e){return e.reduce((i,r)=>(i.push(r),r.layerType==="GroupLayer"&&(i=i.concat(this._collectAllLayersJSON(r.layers||[]))),i),[])}_writeLayers(e,i,r){return i={...i,layerContainerType:r},e.map(n=>oC(n,r==="tables"?null:this.getLayerJSONFromResourceInfo(n),i)).filter(Rt).toArray()}_validateJSON(e){const i=Dv.parse(e.version||"","webmap");return z2.validate(i),e.version=`${i.major}.${i.minor}`,e}_removeDanglingLayerRefs(){var o,u,p;const e=this.applicationProperties,i=(o=e==null?void 0:e.viewing)==null?void 0:o.search,r=g=>this.allLayers.some(w=>w.id===g);if(i!=null&&i.layers&&(i.layers=i.layers.filter(g=>r(g.id))),i!=null&&i.tables&&(i.tables=i.tables.filter(g=>this.tables.some(w=>w.id===g.id))),e){const g=(u=e.editing)==null?void 0:u.locationTracking;g!=null&&g.info&&!r(g.info.layerId)&&(e.editing=null)}const n=(p=this.presentation)==null?void 0:p.slides;n&&n.forEach(g=>{g.visibleLayers&&(g.visibleLayers=g.visibleLayers.filter(w=>r(w.id)))})}async _updateFromInternal(e,i){if(i??(i={}),await vr(()=>e.ready),this._updateInitialViewProperties(e,i),e.map===this)for(const r of e.allLayerViews)"visible"in r&&"visible"in r.layer&&r._isOverridden("visible")&&(r.layer.visible=r.visible),"featureEffect"in r&&"featureEffect"in r.layer&&r._isOverridden("featureEffect")&&(r.layer.featureEffect=r.featureEffect);await this._updateThumbnailUrl(e,i)}_updateInitialViewProperties(e,i){var r,n;if(i.backgroundExcluded||(this.initialViewProperties.background=(r=e.background)==null?void 0:r.clone()),this.initialViewProperties.spatialReference=(n=e.spatialReference)==null?void 0:n.clone(),this.initialViewProperties.timeZone=e.timeZone,i.viewpointExcluded||(this.initialViewProperties.viewpoint=new Mn({rotation:e.rotation,scale:i.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!i.widgetsExcluded)for(const o of e.persistableViewModels)o.updateWebDocument(this)}_getViewExtent(e){const i=e.center.clone().normalize(),r=e.extent.clone(),n=r.width/2;return r.xmin=i.x-n,r.xmax=i.x+n,r}async _updateThumbnailUrl(e,i){if(i.thumbnailExcluded)return;const r=p5e(e,i.thumbnailSize),n=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(n.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(l0(e)){const i=xm(e),r=i==null?void 0:i.mediaType,n=r&&F5e.get(r.toLowerCase())||null,o=`thumbnail${Date.now()}`;return n?`${o}.${n}`:o}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(e){const i=e;if(!i)throw new re("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:i})}};wi.VERSION=z2,m([b()],wi.prototype,"_updateFromPromise",void 0),m([b({type:M5e,json:{write:!0}})],wi.prototype,"applicationProperties",void 0),m([b({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],wi.prototype,"authoringApp",null),m([Le("authoringApp")],wi.prototype,"writeAuthoringApp",null),m([b({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],wi.prototype,"authoringAppVersion",null),m([Le("authoringAppVersion")],wi.prototype,"writeAuthoringAppVersion",null),m([b({type:Xte,json:{write:{overridePolicy:t=>({enabled:!!(t&&t.length>0),ignoreOrigin:!0})}}})],wi.prototype,"bookmarks",void 0),m([b({type:XTe,json:{name:"mapFloorInfo",write:!0}})],wi.prototype,"floorInfo",void 0),m([b({type:l5e,json:{write:!0}})],wi.prototype,"geotriggersInfo",void 0),m([b({type:kE,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:_M},"initialState.viewpoint":{type:Mn},mapRangeInfo:{type:lR},spatialReference:{type:Ge},"timeZone:":{type:String}}}}})],wi.prototype,"initialViewProperties",void 0),m([Me("initialViewProperties")],wi.prototype,"readInitialViewProperties",null),m([Le("initialViewProperties")],wi.prototype,"writeInitialViewProperties",null),m([b({json:{write:!0,name:"mapIPSInfo"}})],wi.prototype,"ipsInfo",void 0),m([b({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],wi.prototype,"layers",void 0),m([Le("layers")],wi.prototype,"writeLayers",null),m([b({type:Nl})],wi.prototype,"portalItem",void 0),m([b({json:{write:!0}})],wi.prototype,"presentation",void 0),m([b()],wi.prototype,"resourceInfo",void 0),m([b({readOnly:!0,type:Dv,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],wi.prototype,"sourceVersion",void 0),m([Me("sourceVersion")],wi.prototype,"readSourceVersion",null),m([Le("sourceVersion")],wi.prototype,"writeSourceVersion",null),m([b({json:{read:!1,write:{ignoreOrigin:!0}}})],wi.prototype,"tables",void 0),m([Le("tables")],wi.prototype,"writeTables",null),m([b()],wi.prototype,"thumbnailUrl",null),m([b()],wi.prototype,"updatingFromView",null),m([b({type:qte,json:{write:!0}})],wi.prototype,"widgets",void 0),m([b({type:R5e,json:{read:!0,write:!0}})],wi.prototype,"utilityNetworks",void 0),wi=m([G("esri.WebMap")],wi);const j5e=wi;var GL;let Ac=GL=class extends ye{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new GL({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};m([b({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Ac.prototype,"cols",void 0),m([b({type:zt,json:{write:!0}})],Ac.prototype,"level",void 0),m([b({type:String,json:{write:!0}})],Ac.prototype,"levelValue",void 0),m([b({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Ac.prototype,"origin",void 0),m([b({type:Number,json:{write:!0}})],Ac.prototype,"resolution",void 0),m([b({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Ac.prototype,"rows",void 0),m([b({type:Number,json:{write:!0}})],Ac.prototype,"scale",void 0),Ac=GL=m([G("esri.layers.support.LOD")],Ac);const Ef=Ac;let hR=class{constructor(e,i,r,n,o=void 0){this.id=e,this.level=i,this.row=r,this.col=n,this.extent=o}};var Xd;const Sz=new et({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let ds=Xd=class extends ye{static create(t={}){const{resolutionFactor:e=1,scales:i,size:r=256,spatialReference:n=Ge.WebMercator,numLODs:o=24}=t;if(!Jo(n)){const T=[];if(i)for(let E=0;E<i.length;E++){const C=i[E];T.push(new Ef({level:E,scale:C,resolution:C}))}else{let E=5e-4;for(let C=o-1;C>=0;C--)T.unshift(new Ef({level:C,scale:E,resolution:E})),E*=2}return new Xd({dpi:96,lods:T,origin:new Ke(0,0,n),size:[r,r],spatialReference:n})}const u=_s(n),p=t.origin?new Ke({x:t.origin.x,y:t.origin.y,spatialReference:n}):new Ke(u?{x:u.origin[0],y:u.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),g=96,w=1/(hr(n)*39.37*g),S=[];if(i)for(let T=0;T<i.length;T++){const E=i[T],C=E*w;S.push(new Ef({level:T,scale:E,resolution:C}))}else{let T=u0(n)?512/r*5916575275917094e-7:256/r*591657527591555e-6;const E=Math.ceil(o/e);S.push(new Ef({level:0,scale:T,resolution:T*w}));for(let C=1;C<E;C++){const L=T/2**e,R=L*w;S.push(new Ef({level:C,scale:L,resolution:R})),T=L}}return new Xd({dpi:g,lods:S,origin:p,size:[r,r],spatialReference:n})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=_s(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return Ke.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const r=[],n=this._levelToLOD={};t&&(e=-1/0,i=1/0,t.forEach(o=>{r.push(o.scale),e=o.scale>e?o.scale:e,i=o.scale<i?o.scale:i,n[o.level]=o})),this._set("scales",r),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),r=i+1;return e[i]/(e[i]/e[r])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let r=0;for(;r<i;r++){const n=e[r],o=e[r+1];if(n<=t)return r;if(o===t)return r+1;if(n>t&&o<t)return r+Math.log(n/t)/Math.log(n/o)}return r}tileAt(t,e,i,r){const n=this.lodAt(t);if(!n)return null;let o,u;if(typeof e=="number")o=e,u=i;else if(Ki(e.spatialReference,this.spatialReference))o=e.x,u=e.y,r=i;else{const w=Y3(e,this.spatialReference);if(w==null)return null;o=w.x,u=w.y,r=i}const p=n.resolution*this.size[0],g=n.resolution*this.size[1];return r||(r=new hR(null,0,0,0,bs())),r.level=t,r.row=Math.floor((this.origin.y-u)/g+.001),r.col=Math.floor((o-this.origin.x)/p+.001),this.updateTileInfo(r),r}updateTileInfo(t,e=Xd.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===Xd.ExtrapolateOptions.POWER_OF_TWO){const u=this.lods[this.lods.length-1];u.level<t.level&&(i=u)}if(!i)return;const r=t.level-i.level,n=i.resolution*this.size[0]/2**r,o=i.resolution*this.size[1]/2**r;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=bs()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*o,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+o}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(i==null)return null;const{resolution:r}=i,n=r*this.size[0],o=r*this.size[1];return t[0]=this.origin.x+e.col*n,t[1]=this.origin.y-(e.row+1)*o,t[2]=t[0]+n,t[3]=t[1]+o,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return Xd.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||this.size[0]===256&&t===512)return null;const e=(this.size[0]===512&&t===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&e===0)return this;const i=[],r=this.lods.length-e;for(let n=0;n<r;n++){const o=n+e,{scale:u,resolution:p}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new Ef({level:n,scale:u,resolution:p}))}return new Xd({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const r=t[i];this._upsampleLevels[r.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/r.resolution:0},e=r}}};m([b({type:Number,json:{write:!0}})],ds.prototype,"compressionQuality",void 0),m([b({type:Number,json:{write:!0}})],ds.prototype,"dpi",void 0),m([b({type:String,json:{read:Sz.read,write:Sz.write,origins:{"web-scene":{read:!1,write:!1}}}})],ds.prototype,"format",void 0),m([b({readOnly:!0})],ds.prototype,"isWrappable",null),m([b({type:Ke,json:{write:!0}})],ds.prototype,"origin",void 0),m([Me("origin")],ds.prototype,"readOrigin",null),m([b({type:[Ef],value:null,json:{write:!0}})],ds.prototype,"lods",null),m([b({readOnly:!0})],ds.prototype,"scales",void 0),m([b({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],ds.prototype,"size",void 0),m([Me("size",["rows","cols"])],ds.prototype,"readSize",null),m([Le("size",{cols:{type:zt},rows:{type:zt}})],ds.prototype,"writeSize",null),m([b({type:Ge,json:{write:!0}})],ds.prototype,"spatialReference",void 0),ds=Xd=m([G("esri.layers.support.TileInfo")],ds),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(ds||(ds={}));const V5e=ds,e5={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],r=e[1],n=this.values;return r>=i?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},ak={xsmall:544,small:768,medium:992,large:1200};function z5e(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function lk(t,e){return e?e5[t].valueToClassName[e].split(" "):[]}const U5e=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=ak}initialize(){this.addHandles(ce(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Qe))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!z5e(i)){const r=JSON.stringify(ak,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r),i=ak}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=vo.acquire(),r=vo.acquire();let n,o=!1;for(n in e5){const u=this[n],p=e5[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});u!==p&&(o=!0,this[n]=p,lk(n,u).forEach(g=>r.push(g)),lk(n,p).forEach(g=>i.push(g)))}o&&(this._applyClassNameChanges(i,r),vo.release(i),vo.release(r))}_applyClassNameChanges(i,r){const n=this.container;n&&(r.forEach(o=>n.classList.remove(o)),i.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in e5)lk(r,this[r]).forEach(n=>i.classList.remove(n))}};return m([b()],e.prototype,"breakpoints",null),m([b()],e.prototype,"orientation",void 0),m([b()],e.prototype,"widthBreakpoint",void 0),m([b()],e.prototype,"heightBreakpoint",void 0),e=m([G("esri.views.BreakpointsOwner")],e),e};function pR(t){return typeof t=="string"?document.getElementById(t):t??null}function Qte(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function xz(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function $z(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}let Ua=class extends Te{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,i,r={}){return this._installWatch(e,i,r,ce)}addWhen(e,i,r={}){return this._installWatch(e,i,r,Fr)}addOnCollectionChange(e,i,{initial:r=!1,final:n=!1}={}){const o=++this._handleId;return this.addHandles([gi(e,"after-changes",this._createSyncUpdatingCallback(),$s),gi(e,"change",i,{onListenerAdd:r?u=>i({added:u.toArray(),removed:[]}):void 0,onListenerRemove:n?u=>i({added:[],removed:u.toArray()}):void 0})],o),We(()=>this.removeHandles(o))}addPromise(e){if(e==null)return e;const i=++this._handleId;this.addHandles(We(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(Hx)||this._set("updating",!1))}),i),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this.removeHandles(i);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,i,r={},n){const o=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,o);const u=n(e,i,r);return this.addHandles(u,o),We(()=>this.removeHandles(o))}_installSyncUpdatingWatch(e,i){const r=this._createSyncUpdatingCallback(),n=ce(e,r,{sync:!0,equals:()=>!1});return this.addHandles(n,i),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(Hx),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(jb(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(Hx))}),Hx)}}};m([b({readOnly:!0})],Ua.prototype,"updating",void 0),Ua=m([G("esri.core.support.UpdatingHandles")],Ua);const Hx=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.0.3 - Wed Jul 03 2024 17:50:35 GMT-0400 (Eastern Daylight Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(é›·å®—æ°‘) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var CE=function(){return CE=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},CE.apply(this,arguments)},BL={exports:{}},Dr={},qL={exports:{}},Qm={};function eie(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function G5e(t,e,i){}function B5e(t,e,i){}var q5e=/javascript\s*\:/img;function H5e(t,e){return q5e.test(e)?"":e}Qm.whiteList=eie();Qm.getDefaultWhiteList=eie;Qm.onAttr=G5e;Qm.onIgnoreAttr=B5e;Qm.safeAttrValue=H5e;var W5e={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Ew=W5e;function J5e(t,e){t=Ew.trimRight(t),t[t.length-1]!==";"&&(t+=";");var i=t.length,r=!1,n=0,o=0,u="";function p(){if(!r){var S=Ew.trim(t.slice(n,o)),T=S.indexOf(":");if(T!==-1){var E=Ew.trim(S.slice(0,T)),C=Ew.trim(S.slice(T+1));if(E){var L=e(n,u.length,E,C,S);L&&(u+=L+"; ")}}}n=o+1}for(;o<i;o++){var g=t[o];if(g==="/"&&t[o+1]==="*"){var w=t.indexOf("*/",o+2);if(w===-1)break;o=w+1,n=o+1,r=!1}else g==="("?r=!0:g===")"?r=!1:g===";"?r||p():g===`
`&&p()}return Ew.trim(u)}var Z5e=J5e,Wx=Qm,K5e=Z5e;function Tz(t){return t==null}function Y5e(t){var e={};for(var i in t)e[i]=t[i];return e}function tie(t){t=Y5e(t||{}),t.whiteList=t.whiteList||Wx.whiteList,t.onAttr=t.onAttr||Wx.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Wx.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Wx.safeAttrValue,this.options=t}tie.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onAttr,o=i.onIgnoreAttr,u=i.safeAttrValue,p=K5e(t,function(g,w,S,T,E){var C=r[S],L=!1;if(C===!0?L=C:typeof C=="function"?L=C(T):C instanceof RegExp&&(L=C.test(T)),L!==!0&&(L=!1),T=u(S,T),!!T){var R={position:w,sourcePosition:g,source:E,isWhite:L};if(L){var F=n(S,T,R);return Tz(F)?S+":"+T:F}else{var F=o(S,T,R);if(!Tz(F))return F}}});return p};var X5e=tie;(function(t,e){var i=Qm,r=X5e;function n(u,p){var g=new r(p);return g.process(u)}e=t.exports=n,e.FilterCSS=r;for(var o in i)e[o]=i[o]})(qL,qL.exports);var dR=qL.exports,fR={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,i=e.exec(t);return i?i.index:-1}},Q5e=dR.FilterCSS,eEe=dR.getDefaultWhiteList,AE=fR;function iie(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var rie=new Q5e;function tEe(t,e,i){}function iEe(t,e,i){}function rEe(t,e,i){}function nEe(t,e,i){}function nie(t){return t.replace(oEe,"&lt;").replace(aEe,"&gt;")}function sEe(t,e,i,r){if(i=cie(i),e==="href"||e==="src"){if(i=AE.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(e==="background"){if(Jx.lastIndex=0,Jx.test(i))return""}else if(e==="style"){if(Ez.lastIndex=0,Ez.test(i)||(Iz.lastIndex=0,Iz.test(i)&&(Jx.lastIndex=0,Jx.test(i))))return"";r!==!1&&(r=r||rie,i=r.process(i))}return i=hie(i),i}var oEe=/</g,aEe=/>/g,lEe=/"/g,uEe=/&quot;/g,cEe=/&#([a-zA-Z0-9]*);?/gim,hEe=/&colon;?/gim,pEe=/&newline;?/gim,Jx=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ez=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Iz=/u\s*r\s*l\s*\(.*/gi;function sie(t){return t.replace(lEe,"&quot;")}function oie(t){return t.replace(uEe,'"')}function aie(t){return t.replace(cEe,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function lie(t){return t.replace(hEe,":").replace(pEe," ")}function uie(t){for(var e="",i=0,r=t.length;i<r;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return AE.trim(e)}function cie(t){return t=oie(t),t=aie(t),t=lie(t),t=uie(t),t}function hie(t){return t=sie(t),t=nie(t),t}function dEe(){return""}function fEe(t,e){typeof e!="function"&&(e=function(){});var i=!Array.isArray(t);function r(u){return i?!0:AE.indexOf(t,u)!==-1}var n=[],o=!1;return{onIgnoreTag:function(u,p,g){if(r(u))if(g.isClosing){var w="[/removed]",S=g.position+w.length;return n.push([o!==!1?o:g.position,S]),o=!1,w}else return o||(o=g.position),"[removed]";else return e(u,p,g)},remove:function(u){var p="",g=0;return AE.forEach(n,function(w){p+=u.slice(g,w[0]),g=w[1]}),p+=u.slice(g),p}}}function yEe(t){for(var e="",i=0;i<t.length;){var r=t.indexOf("<!--",i);if(r===-1){e+=t.slice(i);break}e+=t.slice(i,r);var n=t.indexOf("-->",r);if(n===-1)break;i=n+3}return e}function mEe(t){var e=t.split("");return e=e.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}Dr.whiteList=iie();Dr.getDefaultWhiteList=iie;Dr.onTag=tEe;Dr.onIgnoreTag=iEe;Dr.onTagAttr=rEe;Dr.onIgnoreTagAttr=nEe;Dr.safeAttrValue=sEe;Dr.escapeHtml=nie;Dr.escapeQuote=sie;Dr.unescapeQuote=oie;Dr.escapeHtmlEntities=aie;Dr.escapeDangerHtml5Entities=lie;Dr.clearNonPrintableCharacter=uie;Dr.friendlyAttrValue=cie;Dr.escapeAttrValue=hie;Dr.onIgnoreTagStripAll=dEe;Dr.StripTagBody=fEe;Dr.stripCommentTag=yEe;Dr.stripBlankChar=mEe;Dr.cssFilter=rie;Dr.getDefaultCSSWhiteList=eEe;var SM={},If=fR;function gEe(t){var e=If.spaceIndex(t),i;return e===-1?i=t.slice(1,-1):i=t.slice(1,e+1),i=If.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function vEe(t){return t.slice(0,2)==="</"}function bEe(t,e,i){var r="",n=0,o=!1,u=!1,p=0,g=t.length,w="",S="";e:for(p=0;p<g;p++){var T=t.charAt(p);if(o===!1){if(T==="<"){o=p;continue}}else if(u===!1){if(T==="<"){r+=i(t.slice(n,p)),o=p,n=p;continue}if(T===">"){r+=i(t.slice(n,o)),S=t.slice(o,p+1),w=gEe(S),r+=e(o,r.length,w,S,vEe(S)),n=p+1,o=!1;continue}if(T==='"'||T==="'")for(var E=1,C=t.charAt(p-E);C.trim()===""||C==="=";){if(C==="="){u=T;continue e}C=t.charAt(p-++E)}}else if(T===u){u=!1;continue}}return n<t.length&&(r+=i(t.substr(n))),r}var wEe=/[^a-zA-Z0-9\\_:.-]/gim;function _Ee(t,e){var i=0,r=0,n=[],o=!1,u=t.length;function p(E,C){if(E=If.trim(E),E=E.replace(wEe,"").toLowerCase(),!(E.length<1)){var L=e(E,C||"");L&&n.push(L)}}for(var g=0;g<u;g++){var w=t.charAt(g),S,T;if(o===!1&&w==="="){o=t.slice(i,g),i=g+1,r=t.charAt(i)==='"'||t.charAt(i)==="'"?i:xEe(t,g+1);continue}if(o!==!1&&g===r){if(T=t.indexOf(w,g+1),T===-1)break;S=If.trim(t.slice(r+1,T)),p(o,S),o=!1,g=T,i=g+1;continue}if(/\s|\n|\t/.test(w))if(t=t.replace(/\s|\n|\t/g," "),o===!1)if(T=SEe(t,g),T===-1){S=If.trim(t.slice(i,g)),p(S),o=!1,i=g+1;continue}else{g=T-1;continue}else if(T=$Ee(t,g-1),T===-1){S=If.trim(t.slice(i,g)),S=Mz(S),p(o,S),o=!1,i=g+1;continue}else continue}return i<t.length&&(o===!1?p(t.slice(i)):p(o,Mz(If.trim(t.slice(i))))),If.trim(n.join(" "))}function SEe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="="?e:-1}}function xEe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="'"||i==='"'?e:-1}}function $Ee(t,e){for(;e>0;e--){var i=t[e];if(i!==" ")return i==="="?e:-1}}function TEe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function Mz(t){return TEe(t)?t.substr(1,t.length-2):t}SM.parseTag=bEe;SM.parseAttr=_Ee;var EEe=dR.FilterCSS,Ou=Dr,pie=SM,IEe=pie.parseTag,MEe=pie.parseAttr,t5=fR;function Zx(t){return t==null}function kEe(t){var e=t5.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=t5.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";return i&&(t=t5.trim(t.slice(0,-1))),{html:t,closing:i}}function CEe(t){var e={};for(var i in t)e[i]=t[i];return e}function AEe(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map(function(r){return r.toLowerCase()}):e[i.toLowerCase()]=t[i];return e}function die(t){t=CEe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Ou.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=AEe(t.whiteList||t.allowList):t.whiteList=Ou.whiteList,t.onTag=t.onTag||Ou.onTag,t.onTagAttr=t.onTagAttr||Ou.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Ou.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Ou.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Ou.safeAttrValue,t.escapeHtml=t.escapeHtml||Ou.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new EEe(t.css))}die.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onTag,o=i.onIgnoreTag,u=i.onTagAttr,p=i.onIgnoreTagAttr,g=i.safeAttrValue,w=i.escapeHtml,S=e.cssFilter;i.stripBlankChar&&(t=Ou.stripBlankChar(t)),i.allowCommentTag||(t=Ou.stripCommentTag(t));var T=!1;i.stripIgnoreTagBody&&(T=Ou.StripTagBody(i.stripIgnoreTagBody,o),o=T.onIgnoreTag);var E=IEe(t,function(C,L,R,F,V){var U={sourcePosition:C,position:L,isClosing:V,isWhite:Object.prototype.hasOwnProperty.call(r,R)},W=n(R,F,U);if(!Zx(W))return W;if(U.isWhite){if(U.isClosing)return"</"+R+">";var H=kEe(F),J=r[R],X=MEe(H.html,function(te,oe){var pe=t5.indexOf(J,te)!==-1,de=u(R,te,oe,pe);return Zx(de)?pe?(oe=g(R,te,oe,S),oe?te+'="'+oe+'"':te):(de=p(R,te,oe,pe),Zx(de)?void 0:de):de});return F="<"+R,X&&(F+=" "+X),H.closing&&(F+=" /"),F+=">",F}else return W=o(R,F,U),Zx(W)?w(F):W},w);return T&&(E=T.remove(E)),E};var LEe=die;(function(t,e){var i=Dr,r=SM,n=LEe;function o(p,g){var w=new n(g);return w.process(p)}e=t.exports=o,e.filterXSS=o,e.FilterXSS=n,function(){for(var p in i)e[p]=i[p];for(var g in r)e[g]=r[g]}();function u(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}u()&&(self.filterXSS=t.exports)})(BL,BL.exports);var dg=BL.exports,OEe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},PEe=function(){function t(e,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],details:["style"],div:["align","style","aria-label","aria-hidden"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=CE(CE({},dg.getDefaultCSSWhiteList()),{flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,"line-height":!0,"justify-content":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(o,u,p,g){return o==="a"&&u==="href"||(o==="img"||o==="source")&&u==="src"?r.sanitizeUrl(p):dg.safeAttrValue(o,u,p,g)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;e&&!i?n=e:e&&i?(n=Object.create(this.arcgisFilterOptions),n.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(o){if(o==="whiteList")n.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if(o==="css"){var u=e.css.whiteList;u!=null&&e.css instanceof Object&&Object.keys(u).forEach(function(p){return n.css.whiteList[p]=u[p]})}else n[o]=e[o]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList,n.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=n,this._xssFilter=new dg.FilterXSS(n)}return t.prototype.sanitize=function(e,i){switch(i===void 0&&(i={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,i);default:return i.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,i){var r=(i??{}).isProtocolRequired,n=r===void 0?!0:r,o=this._trim(e.substring(0,e.indexOf(":"))),u=e==="/",p=/^#/.test(e),g=o&&this.allowedProtocols.indexOf(o.toLowerCase())>-1;return u||p||g?dg.escapeAttrValue(e):!o&&!n?dg.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,i,r,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,i,r,n):dg.safeAttrValue(e,i,r,n)},t.prototype.validate=function(e,i){i===void 0&&(i={});var r=this.sanitize(e,i);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var i=this;return String(e).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var i=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,n){return i.test(r)?r:"&#x".concat(Number(e.charCodeAt(n)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var i={};return e.forEach(function(r){Object.keys(r).forEach(function(n){Array.isArray(r[n])&&Array.isArray(i[n])?i[n]=i[n].concat(r[n]):i[n]=r[n]})}),i},t.prototype._iterateOverObject=function(e,i){var r=this;i===void 0&&(i={});try{var n=!1,o=void 0;if(Array.isArray(e))o=e.reduce(function(p,g){var w=r.validate(g,i);return w.isValid?p.concat([g]):(n=!0,p.concat([w.sanitized]))},[]);else if(OEe(e)){var u=Object.keys(e);o=u.reduce(function(p,g){var w=e[g],S=r.validate(w,i);return S.isValid?p[g]=w:(n=!0,p[g]=S.sanitized),p},{})}else return i.allowUndefined&&typeof e>"u"?void 0:null;return n?o:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const xM=new Map;function fie(){xM.clear()}function REe(t){return xM.get(t)}function FEe(t,e){xM.set(t,e)}function uk(t){xM.delete(t)}function Uu(...t){const e=vo.acquire();for(let r=0;r<t.length;r++){const n=t[r],o=typeof n;if(o==="string")e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if(o==="object")for(const u in n)n[u]&&e.push(u)}const i=e.join(" ");return vo.release(e),i}const yR=(()=>{const t=new Map,e=new ResizeObserver(r=>{var n;fie();for(const o of r)(n=t.get(o.target))==null||n(o)}),i=(r,n,o)=>(t.set(r,n),e.observe(r,o),We(()=>{e.unobserve(r),t.delete(r)}));return(r,n,o)=>{let u=null;return In([ce(()=>typeof r=="function"?r():r,p=>{u==null||u.remove(),p&&(u=i(p,n,o))},ri),We(()=>u==null?void 0:u.remove())])}})();function Nm(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function kz(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function hv(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const NEe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],DEe=NEe.reduce((t,e)=>(t[e]=[],t),{}),jEe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],mR=new PEe({whiteList:DEe,onTagAttr:(t,e,i)=>{const r=`${e}="${i}"`;if(jEe.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function VEe(t,e){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),n=i.top+i.height,o=r.top+r.height,u=i.top,p=r.top;(n>o||u<p)&&t.scrollIntoView({block:"end"})}function gR(t){return t==="Enter"||t===" "}function zEe(t){return Object.values(t).includes(!0)}const yie="http://www.w3.org/",$M=`${yie}2000/svg`,mie=`${yie}1999/xlink`;let Cz=[],vR=(t,e)=>{let i={};return Object.keys(t).forEach(r=>{i[r]=t[r]}),e&&Object.keys(e).forEach(r=>{i[r]=e[r]}),i},bR=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),gie=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},UEe=(t,e,i)=>{if(e.vnodeSelector!==""){for(let r=i;r<t.length;r++)if(bR(t[r],e))return r}return-1},ck=(t,e,i,r)=>{let n=t[e];if(n.vnodeSelector==="")return;let o=n.properties;if(!(o&&(o.key===void 0?o.bind:o.key))){for(let u=0;u<t.length;u++)if(u!==e){let p=t[u];if(bR(p,n))throw new Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},GEe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},HL=[],WL=!1,vie=t=>{(t.children||[]).forEach(vie),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},Az=()=>{WL=!1,HL.forEach(vie),HL.length=0},Lz=t=>{HL.push(t),WL||(WL=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(Az,{timeout:16}):setTimeout(Az,16))},Oz=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i)return e.style.pointerEvents="none",void i(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),Lz(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),Lz(t))},BEe=(t,e,i)=>{if(!e)return;let r=i.eventHandlerInterceptor,n=Object.keys(e),o=n.length;for(let u=0;u<o;u++){let p=n[u],g=e[p];if(p==="className")throw new Error('Property "className" is not supported, use "class".');if(p==="class")ZL(t,g,!0);else if(p==="classes"){let w=Object.keys(g),S=w.length;for(let T=0;T<S;T++){let E=w[T];g[E]&&t.classList.add(E)}}else if(p==="styles"){let w=Object.keys(g),S=w.length;for(let T=0;T<S;T++){let E=w[T],C=g[E];C&&(gie(C),i.styleApplyer(t,E,C))}}else if(p!=="key"&&g!=null){let w=typeof g;w==="function"?(p.lastIndexOf("on",0)===0&&(r&&(g=r(p,g,t,e)),p==="oninput"&&function(){let S=g;g=function(T){S.apply(this,[T]),T.target["oninput-value"]=T.target.value}}()),t[p]=g):i.namespace===$M?p==="href"?t.setAttributeNS(mie,p,g):t.setAttribute(p,g):w==="string"&&p!=="value"?p==="innerHTML"?t[p]=mR.sanitize(g):JL(t)&&p in t?t[p]=g:t.setAttribute(p,g):t[p]=g}}};function JL(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let LE,qEe=(t,e,i)=>{if(e)for(let r of e)pv(r,t,void 0,i)},bie=(t,e,i)=>{qEe(t,e.children,i),e.text&&(t.textContent=e.text),BEe(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},pv=(t,e,i,r)=>{let n,o=0,u=t.vnodeSelector,p=e.ownerDocument;if(u==="")n=t.domNode=p.createTextNode(t.text),i!==void 0?e.insertBefore(n,i):e.appendChild(n);else{for(let g=0;g<=u.length;++g){let w=u.charAt(g);if(g===u.length||w==="."||w==="#"){let S=u.charAt(o-1),T=u.slice(o,g);S==="."?n.classList.add(T):S==="#"?n.id=T:(T==="svg"&&(r=vR(r,{namespace:$M})),r.namespace!==void 0?n=t.domNode=p.createElementNS(r.namespace,T):(n=t.domNode=t.domNode||p.createElement(T),T==="input"&&t.properties&&t.properties.type!==void 0&&n.setAttribute("type",t.properties.type)),i!==void 0?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),o=g+1}}bie(n,t,r)}},ZL=(t,e,i)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,i)})},HEe=(t,e,i,r)=>{if(!i)return;let n=!1,o=Object.keys(i),u=o.length;for(let p=0;p<u;p++){let g=o[p],w=i[g],S=e[g];if(g==="class")S!==w&&(ZL(t,S,!1),ZL(t,w,!0));else if(g==="classes"){let T=t.classList,E=Object.keys(w),C=E.length;for(let L=0;L<C;L++){let R=E[L],F=!!w[R];F!==!!S[R]&&(n=!0,F?T.add(R):T.remove(R))}}else if(g==="styles"){let T=Object.keys(w),E=T.length;for(let C=0;C<E;C++){let L=T[C],R=w[L];R!==S[L]&&(n=!0,R?(gie(R),r.styleApplyer(t,L,R)):r.styleApplyer(t,L,""))}}else if(w||typeof S!="string"||(w=""),g!=="value"||JL(t)){if(w!==S){let T=typeof w;T==="function"&&r.eventHandlerInterceptor||(r.namespace===$M?g==="href"?t.setAttributeNS(mie,g,w):t.setAttribute(g,w):T==="string"?g==="innerHTML"?t[g]=mR.sanitize(w):g==="role"&&w===""?t.removeAttribute(g):JL(t)&&g in t?t[g]=w:t.setAttribute(g,w):t[g]!==w&&(t[g]=w),n=!0)}}else{let T=t[g];T!==w&&(t["oninput-value"]?T===t["oninput-value"]:w!==S)&&(t[g]=w,t["oninput-value"]=void 0),w!==S&&(n=!0)}}return n},WEe=(t,e,i,r,n)=>{if(i===r)return!1;r=r||Cz;let o,u=(i=i||Cz).length,p=r.length,g=0,w=0,S=!1;for(;w<p;){let T=g<u?i[g]:void 0,E=r[w];if(T!==void 0&&bR(T,E))S=LE(T,E,n)||S,g++;else{let C=UEe(i,E,g+1);if(C>=0){for(o=g;o<C;o++)Oz(i[o]),ck(i,o,t,"removed");S=LE(i[C],E,n)||S,g=C+1}else pv(E,e,g<u?i[g].domNode:void 0,n),GEe(E),ck(r,w,t,"added")}w++}if(u>g)for(o=g;o<u;o++)Oz(i[o]),ck(i,o,t,"removed");return S};LE=(t,e,i)=>{let r=t.domNode,n=!1;if(t===e)return!1;let o=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let u=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(u,r),e.domNode=u,n=!0,n}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(i=vR(i,{namespace:$M})),t.text!==e.text&&(o=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,o=WEe(e,r,t.children,e.children,i)||o,o=HEe(r,t.properties,e.properties,i)||o,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,i,e.vnodeSelector,e.properties,e.children]);return o&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),n};let Iw=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=i,LE(r,i,e)},domNode:t.domNode});const JEe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}};let L1=t=>vR(JEe,t),jf={create:(t,e)=>(e=L1(e),pv(t,document.createElement("div"),void 0,e),Iw(t,e)),append:(t,e,i)=>(i=L1(i),pv(e,t,void 0,i),Iw(e,i)),insertBefore:(t,e,i)=>(i=L1(i),pv(e,t.parentNode,t,i),Iw(e,i)),merge:(t,e,i)=>(i=L1(i),e.domNode=t,bie(t,e,i),Iw(e,i)),replace:(t,e,i)=>(i=L1(i),pv(e,t.parentNode,t,i),t.parentNode.removeChild(t),Iw(e,i))},wie,ZEe=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};wie=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let KEe=(t,e)=>{let i=t;return e.forEach(r=>{i=i&&i.children?wie(i.children,n=>n.domNode===r):void 0}),i},YEe=(t,e,i)=>{let r=function(n){i("domEvent",n);let o=e(),u=ZEe(n.currentTarget,o.domNode);u.reverse();let p,g=KEe(o.getLastRender(),u);return t.scheduleRender(),g&&(p=g.properties[`on${n.type}`].apply(g.properties.bind||this,arguments)),i("domEventProcessed",n),p};return(n,o,u,p)=>r},OE=t=>{let e,i,r=L1(t),n=r.performanceLogger,o=!0,u=!1,p=[],g=[],w=(T,E,C)=>{let L,R=()=>L;r.eventHandlerInterceptor=YEe(e,R,n),L=T(E,C(),r),p.push(L),g.push(C)},S=()=>{if(i=void 0,o){o=!1,n("renderStart",void 0);for(let T=0;T<p.length;T++){let E=g[T]();n("rendered",void 0),p[T].update(E),n("patched",void 0)}n("renderDone",void 0),o=!0}};return e={renderNow:S,scheduleRender:()=>{i||u||(i=requestAnimationFrame(S))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),u=!0},resume:()=>{u=!1,o=!0,e.scheduleRender()},append:(T,E)=>{w(jf.append,T,E)},insertBefore:(T,E)=>{w(jf.insertBefore,T,E)},merge:(T,E)=>{w(jf.merge,T,E)},replace:(T,E)=>{w(jf.replace,T,E)},detach:T=>{for(let E=0;E<g.length;E++)if(g[E]===T)return g.splice(E,1),p.splice(E,1)[0];throw new Error("renderFunction was not found")}},e},Qd=class extends Te{constructor(){super(...arguments),this.items=new Ie,this._watchUpdatingTracking=new Ua,this._callbacks=new Map,this._projector=OE(),this._hiddenProjector=OE()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const r of i.added){const n=()=>r.render();this._callbacks.set(r,n),this._projector.append(this.surface,n)}for(const r of i.removed){const n=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(n.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,r=this._hiddenProjector;let n;const o=()=>(n=e.render(),n);r.append(i,o),r.renderNow();const u={left:0,top:0,right:0,bottom:0};if(n!=null&&n.domNode){const p=n.domNode.getBoundingClientRect();u.left=p.left,u.top=p.top,u.right=p.right,u.bottom=p.bottom}for(r.detach(o);i.firstChild;)i.removeChild(i.firstChild);return u}overlaps(e,i){const r=this.computeBoundingRect(e),n=this.computeBoundingRect(i);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,i){const r=!!(i!=null&&i.disableDecorations);if(!this.items.some(o=>o.visible&&!(r&&o.isDecoration)))return;const n=e.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach(o=>{r&&o.isDecoration||(n.save(),o.renderCanvas(n),n.restore())}),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};m([b({readOnly:!0})],Qd.prototype,"surface",void 0),m([b({readOnly:!0})],Qd.prototype,"items",void 0),m([b({readOnly:!0})],Qd.prototype,"needsRender",null),m([b({readOnly:!0})],Qd.prototype,"_watchUpdatingTracking",void 0),m([b({readOnly:!0})],Qd.prototype,"updating",null),Qd=m([G("esri.views.overlay.ViewOverlay")],Qd);const Pz=Qd,hk=[0,0];function XEe(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return hk[0]=i.left+((e==null?void 0:e.pageXOffset)??0),hk[1]=i.top+((e==null?void 0:e.pageYOffset)??0),hk}function Rz(t){t&&(Qte(t),t.parentNode&&t.parentNode.removeChild(t))}function QEe(t){const e=document.createElement("div");return t.appendChild(e),e}const Mw=16,Kx=750,eIe=512,tIe=2,iIe=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:Mw,time:Kx},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ce(()=>this.cursor,r=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",r)}),ce(()=>this.navigating,r=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",r.toString())})])}initialize(){this.addHandles([ce(()=>this.ui,(i,r)=>this._handleUIChange(i,r),Qe),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=ot(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const r=this._get("container"),n=pR(i);if(n||typeof i!="string"||fe.getLogger(this).error("#container",`element with id '${i}' not found`),r===n)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Rz(this.root),this._set("root",null)),this.userContent&&($z(this.userContent,r),Rz(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",$z(n,o),n.appendChild(o),this._set("userContent",o);const u=document.createElement("div");u.className="esri-view-root",n.insertBefore(u,n.firstChild),this._set("root",u);const p=document.createElement("div");p.className="esri-view-surface",p.setAttribute("role","application"),p.tabIndex=0,u.appendChild(p),this._set("surface",p);const g=new Pz;u.appendChild(g.surface),this._set("overlay",g),this.addHandles(ce(()=>g.needsRender,w=>{w&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=tb({render:()=>{var S;return(S=this.overlay)==null?void 0:S.render()}}):this._overlayRenderTaskHandle=Vi(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,r,n){const o=this.position;return i-=o?o[0]:0,r-=o?o[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}containerToPage(i,r,n){const o=this.position;return i+=o?o[0]:0,r+=o?o[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(ce(()=>this.root,n=>{i.container=n?QEe(n):null},Qe),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=Mw,i.time=Kx,this.addHandles([H3(window,"resize",()=>{i.freq=Mw,i.time=Kx}),tb({prepare:r=>{const n=this._measure(),o=this._freqInfo;if(o.time+=r.deltaTime,n&&(o.freq=Mw,this._get("resizing")||this._set("resizing",!0)),o.time<o.freq)return;o.time=0;const u=this._position();o.freq=u||n?Mw:Math.min(Kx,o.freq*tIe),!n&&o.freq>=eIe&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,n=i?i.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,u=this.height;return r===o&&n===u?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:u,width:r,height:n}),!0)}_position(){const i=this.container,r=this.position,n=i&&XEe(i);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return m([b()],e.prototype,"container",null),m([b({readOnly:!0})],e.prototype,"focused",null),m([b({readOnly:!0})],e.prototype,"height",void 0),m([b()],e.prototype,"messagesCommon",void 0),m([b({type:Pz})],e.prototype,"overlay",void 0),m([b({readOnly:!0})],e.prototype,"position",void 0),m([b({readOnly:!0})],e.prototype,"resizing",void 0),m([b({readOnly:!0})],e.prototype,"root",void 0),m([b({value:null,readOnly:!0})],e.prototype,"size",null),m([b({readOnly:!0})],e.prototype,"surface",void 0),m([b({readOnly:!0})],e.prototype,"suspended",void 0),m([b()],e.prototype,"ui",void 0),m([b({readOnly:!0})],e.prototype,"userContent",void 0),m([b({readOnly:!0})],e.prototype,"width",void 0),m([b()],e.prototype,"widthBreakpoint",void 0),e=m([G("esri.views.DOMContainer")],e),e};let rIe=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in e){const n=e[r],o=new qW(n,void 0,void 0,2,2);this._properties[r]={pool:o,acquired:[]}}this._afterDispatchHandle=mhe(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const r of i.acquired)jN(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),r=this._properties[e];let n=r.pool.acquire();for(r.acquired.push(n);n===i;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const e in this._properties){const i=this._properties[e];let r=0;for(const n of i.acquired)jN(n)?i.acquired[r++]=n:i.pool.release(n);i.acquired.length=r}}};const _ie=me("mac")?"Meta":"Control",nIe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),sIe=t=>nIe.has(t);let oIe=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}},Zn=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,r){let n;typeof i=="function"?(r=i,n=[]):n=i||[];const o=typeof e=="string"?new oIe(e,n):e,u=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},p=S=>{const T=this._incoming[S.match.eventType];if(T){const E=T.indexOf(S);T.splice(E,1),u(),this._manager&&this._manager.updateDependencies()}},g=new aIe(o,r,{onPause:p,onRemove:p,onResume:S=>{const T=this._incoming[S.match.eventType];T&&!T.includes(S)&&(T.push(S),u(),this._manager&&this._manager.updateDependencies())}});let w=this._incoming[o.eventType];return w||(w=[],this._incoming[o.eventType]=w),w.push(g),u(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new lIe(e,{onEmit:(r,n,o,u)=>{var p;(p=this._manager)==null||p.emit(r.eventType,n,o,u)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){var r;const i=this._incoming[e.type];if(i){for(const n of i)if(n.match.matches(e)&&((r=n.callback)==null||r.call(n,e),e.shouldStopPropagation()))break}}},aIe=class{constructor(e,i,r){this.match=e,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},lIe=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,r){this._removed||this._handler.onEmit(this,e,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},uIe=class extends Zn{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=e;i===this._value&&this._x===r&&this._y===n||(this._value=i,this._x=r,this._y=n,this._onChange(i,r,n))}},cIe=class{constructor(e,i){this._observable=new Gb,this._value=e,this._equalityFunction=i}get value(){return He(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function I3(t,e=N7){return new cIe(t,e)}let hIe=class extends Zn{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=I3(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},cl=class extends Te{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=_ie,this._latestPointerType="mouse",this._propertiesPool=new rIe({latestPointerLocation:fIe},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,r=ii.INTERNAL){if(this._nameToGroup[e]||i.length===0)return;const n={name:e,handlers:i.map(o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let o=n.handlers.length-1;o>=0;o--){const u=n.handlers[o];this._handlers.push(u),u.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(p,g,w,S,T)=>{this._emitInputEvent(u.priorityIndex+1,p,g,w,T,S)},setPointerCapture:(p,g)=>{this._setPointerCapture(n,u,p,g)},setEventCallback:p=>{u.eventCallback=p},setUninstallCallback:p=>{u.uninstallCallback=p},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(r=>{var n;r.removed=!0,(n=r.uninstallCallback)==null||n.call(r)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):fe.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers&&this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const n=this._handlersPriority[r];n.priorityIndex=r;let o=n.handler.hasSideEffects;if(!o){for(const u of n.handler.outgoingEventTypes)if(e.has(u)){o=!0;break}}if(o)for(const u of n.handler.incomingEventMatches){e.add(u.eventType);for(const p of u.keyModifiers)sIe(p)||i.add(p)}n.active=o}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,r){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(n==null||n.x!==i||n.y!==r){const o=this._propertiesPool.get("latestPointerLocation");o.x=i,o.y=r,this._set("latestPointerLocation",o)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const o=i;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,i);const r=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,n=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,r,n)}_updateKeyModifiers(e,i){if(!i)return;let r=!1;const n=()=>{if(!r){const p=new Set;this._activeKeyModifiers.forEach(g=>{p.add(g)}),this._activeKeyModifiers=p,r=!0}},o=(p,g)=>{g&&!this._activeKeyModifiers.has(p)?(n(),this._activeKeyModifiers.add(p)):!g&&this._activeKeyModifiers.has(p)&&(n(),this._activeKeyModifiers.delete(p))};if(e==="key-down"||e==="key-up"){const p=i.key;this._keyModifiers.has(p)&&o(p,e==="key-down")}const u=i.native;o("Alt",!(!u||!u.altKey)),o("Control",!(!u||!u.ctrlKey)),o("Ctrl",!(!u||!u.ctrlKey)),o("Shift",!(!u||!u.shiftKey)),o("Meta",!(!u||!u.metaKey)),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new uIe((e,i,r)=>this._setLatestPointer(e,i,r)),this._multiTouchHandler=new hIe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],ii.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,ii.INTERNAL)}_setPointerCapture(e,i,r,n){const o=e.name+"-"+i.priorityIndex,u=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,u),n?(u.add(o),u.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):u.has(o)&&(u.delete(o),u.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,r,n){this._emitInputEvent(0,e,i,r,n)}_emitInputEvent(e,i,r,n,o,u){const p=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),g=o!==void 0&&o,w={event:new pIe(i,r,p,u||this._activeKeyModifiers,g),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(w):this._doNewPropagation(w)}_doNewPropagation(e){this._currentPropagation={events:new mb,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,r,n;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:o,priorityIndex:u}=e.events.pop(),p=(i=o.data)==null?void 0:i.eventId;if(!(p!=null&&this._stoppedPropagationEventIds.has(p)))for(e.currentHandler=this._handlersPriority[u];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!o.shouldStopPropagation()&&((n=(r=e.currentHandler).eventCallback)==null||n.call(r,o)),o.shouldStopPropagation()){p!=null&&this._stoppedPropagationEventIds.add(p);break}if(o.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:o,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new mb;i.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)i.push(r.events.pop());r.events=i,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const n of i.handler.incomingEventMatches){if(r.eventType!==n.eventType)continue;const o=r.keyModifiers.filter(u=>n.keyModifiers.includes(u));if(o.length===r.keyModifiers.length!=(o.length===n.keyModifiers.length))return r.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const r of e){let n=0;for(;n<i.length&&this._compareHandlerPriority(r,i[n])>=0;)n++;i.splice(n,0,r)}return i}get debug(){const e=i=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=r};return{injectEvent:(i,r)=>{e(()=>{this._onEventReceived(i,r)})},disablePointerCapture:e}}};m([b({readOnly:!0})],cl.prototype,"hasPendingInputs",null),m([b({constructOnly:!0})],cl.prototype,"eventSource",void 0),m([b({constructOnly:!0})],cl.prototype,"recognizers",void 0),m([b()],cl.prototype,"_latestPointerType",void 0),m([b()],cl.prototype,"latestPointerType",null),m([b()],cl.prototype,"multiTouchActive",null),m([b({readOnly:!0})],cl.prototype,"latestPointerLocation",void 0),m([b()],cl.prototype,"_paused",void 0),m([b({readOnly:!0})],cl.prototype,"updating",null),cl=m([G("esri.views.input.InputManager")],cl);let pIe=class{constructor(e,i,r,n,o){this.type=e,this.data=i,this.timestamp=r,this.modifiers=n,this.cancelable=o,this._propagationState=Mf.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Mf.STOPPED}shouldStopPropagation(){return!!(this._propagationState&Mf.STOPPED)}async(e){this._propagationState|=Mf.PAUSED;const i=(r,n)=>{this._propagationState&=~Mf.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),n)throw r;return r};return(typeof e=="function"?e():e).then(r=>i(r,!1),r=>i(r,!0))}shouldPausePropagation(e){return!!(this._propagationState&Mf.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Mf;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Mf||(Mf={}));const ii={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let dIe=class{};const fIe=dIe;function Ah(t){return t!=null&&"open"in t&&"declaredClass"in t}function Fz(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const yIe=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ce(()=>[this.ui,this.popup],([i,r],n)=>{const o="popup",u="manual";if(n){const[p,g]=n;p&&Ah(g)&&(g.view=null,Fz(g)&&p.remove(g,o))}i&&Ah(r)&&(r.view=this,Fz(r)&&i.add(r,{key:o,position:u,internal:!0}))},Qe),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Ah(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),Ah(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)}))},ii.WIDGET)]),vr(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{ie(()=>import("./Popup-B2NIVT8N.js"),__vite__mapDeps([142,134,60,58,59,14,13,15]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Ah(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void fe.getLogger(this).error(new re("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),Ah(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,r){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,r),r)}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!Ah(this.popup))return this._popupSetupTask=Sh(async r=>{const{default:n}=await ie(()=>import("./Popup-B2NIVT8N.js"),__vite__mapDeps([142,134,60,58,59,14,13,15]));if(At(r),!this.popup||Ah(this.popup))return;const o=this.popup;delete o.open,delete o.close,this.popup=new n(o)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:r},n){const o=[],u=[];let p=!1;const g=Jce(n,me("popup-view-fetch-timeout")??gIe),w=E=>{const C=new mIe(E);return u.push(C),o.push(C.promise),C},S=E=>{const C=u.at(-1);return C&&C.layerView===E&&!p?C:w(E)};for(const E of r)"graphic"in E?(S(E.layerView).graphics.push(E.graphic),p=!1):(o.push(E.layerView.fetchPopupFeaturesAtLocation(E.mapPoint,g)),p=!0);u.map(E=>E.resolve(g));const T=JW(o).then(E=>E.filter(C=>!!C).flat());return{pendingFeatures:o,allGraphicsPromise:T,location:i}}async _getPopupHits(i,r){const{hits:n,location:o}=await this.popupHitTest(i);At(r);const u=[];for(const p of n)if("graphic"in p){if(this._isValidPopupGraphic(p.graphic,r)){const g=this._isValidPopupGraphicsLayerView(p.layerView)?p.layerView:void 0;u.push({graphic:p.graphic,layerView:g})}}else this._isValidPopupLocationLayerView(p.layerView)&&u.push({mapPoint:p.mapPoint,layerView:p.layerView});return{hits:u,location:o}}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r==null?void 0:r.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return m([b({cast(i){return!i||Ah(i)||typeof i=="object"&&(i.open=r=>(wm(fe.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(r)),i.close=()=>(wm(fe.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],e.prototype,"popup",void 0),m([b()],e.prototype,"popupEnabled",void 0),e=m([G("esri.views.PopupView")],e),e};let mIe=class{constructor(e){this.layerView=e,this._resolver=os(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:i,graphics:r,_resolver:n}=this;if(!i)return n.resolve(r),n.promise;let o;return i.fetchPopupFeaturesFromGraphics(r,e).catch(u=>(o=u,null)).then(u=>{u?n.resolve(u):n.reject(o)}),n.promise}};const gIe=5e3;let U2=class extends Ie{constructor(e){super(e),this.addHandles([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Ie.ofType(this.itemType.Type))(e):new Ie(e)}};function KL(t,e){return{type:t,cast:BJ,set(i){const r=Jp(i,this._get(e),t);r.owner=this,this._set(e,r)}}}m([b()],U2.prototype,"owner",null),U2=m([G("esri.core.support.OwningCollection")],U2);let PE=class extends U2{constructor(e){super(e),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(fe.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};PE=m([G("esri.support.AnalysesCollection")],PE);let dm=class extends U2{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};m([sP({Type:Cr,ensureType:Yi(Cr)})],dm.prototype,"itemType",void 0),dm=m([G("esri.support.GraphicsCollection")],dm);let ef=class extends Te{constructor(e){super(e),this.view=null,this.baseLayerViews=new Ie,this.referenceLayerViews=new Ie,this._loadingHandle=ce(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap},i=>{i&&i.load().catch(()=>{})},Qe)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,r,n;if((i=this.view)!=null&&i.suspended)return!1;const e=(n=(r=this.view)==null?void 0:r.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(o=>o.updating)||this.referenceLayerViews.some(o=>o.updating))}};m([b({constructOnly:!0})],ef.prototype,"view",void 0),m([b({readOnly:!0})],ef.prototype,"baseLayerViews",void 0),m([b({readOnly:!0})],ef.prototype,"referenceLayerViews",void 0),m([b({readOnly:!0})],ef.prototype,"suspended",null),m([b({type:Boolean,readOnly:!0})],ef.prototype,"updating",null),ef=m([G("esri.views.BasemapView")],ef);function vIe(t){return"tryRecycleWith"in t}function bIe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let wIe=class{constructor(e,i,r){this.layer=e,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=os(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Zo(this._controller.signal,()=>{const n=new re("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}tryRecycle(e){if(!this.done||!this.layerView||!vIe(this.layerView))return null;const i=this.layer.type,r=this._controller.signal;for(let n=0;n<e.length;n++){const o=e[n];if(o.type!==i)continue;const u=this.layerView.tryRecycleWith(o,{signal:r});if(u){e.splice(n,1),this.layer=o;const p=this.layerView,g=p.view;return this.promise=Promise.race([u.then(()=>(At(this._controller.signal),o.emit("layerview-destroy",{view:g,layerView:p}),g.emit("layerview-destroy",{view:g,layerView:p}),o.emit("layerview-create",{view:g,layerView:p}),g.emit("layerview-create",{view:g,layerView:p}),p)),new Promise((w,S)=>Zo(this._controller.signal,()=>S(ni())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var n,o;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:r}=this;this._map=r.map;try{let u,p;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),SIe(i))u=await i.createLayerView(r,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new re("layer:view-not-supported","No layerview implementation was found");const S=await this.layerViewImporter.importLayerView(i);At(e),u="default"in S?new S.default({layer:i,view:r}):new S({layer:i,view:r})}const g=()=>{p=Vi(p),u.destroyed||u.destroy(),u.layer=null,u.parent=null,u.view=null,this.done=!0};p=Zo(e,g),At(e);try{await u.when()}catch(S){throw g(),S}if(!((o=(n=this._map)==null?void 0:n.allLayers)==null?void 0:o.includes(i)))return g(),void this._deferred.reject(new re("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=u,i.emit("layerview-create",{view:r,layerView:u}),r.emit("layerview-create",{layer:i,layerView:u}),this.done=!0,this._deferred.resolve(u)}catch(u){i.emit("layerview-create-error",{view:r,error:u}),r.emit("layerview-create-error",{layer:i,error:u}),this.done=!0,this._deferred.reject(new re("layerview:create-error","layerview creation failed",{layer:i,error:u}))}}},hl=class extends Te{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Ua,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const i=(r=this.view.map)==null?void 0:r.allLayers;if(i)for(const n of i)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=os(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(jb(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var g,w,S;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,n=[],o=this.view.ready,u=T=>{if(T!=null){for(const E of T)if(E){r.add(E);const C=this._layerLayerViewInfoMap.get(E);C&&o?C.start():C||this._recyclingInfoMap.has(E)||n.push(E),"layers"in E&&E.layers&&u(E.layers)}}};for(const T of this._rootCollectionNames)u(Ks(this,T));for(const[T,E]of this._layerLayerViewInfoMap)if(!r.has(T)){this._layerLayerViewInfoMap.delete(E.layer);const C=E.tryRecycle(n);C?(this.notifyChange("updating"),this._recyclingInfoMap.set(E.layer,E),C.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(E.layer),this._layerLayerViewInfoMap.set(E.layer,E),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(E.layer),E.destroy(),this._reschedule()})):E.destroy()}for(const[T,E]of this._recyclingInfoMap)r.has(T)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(E.layer),E.destroy());for(const T of n)this._createLayerView(T);this._refreshCollections();const p=[(g=i==null?void 0:i.ground)==null?void 0:g.layers,(w=i==null?void 0:i.basemap)==null?void 0:w.baseLayers,(S=i==null?void 0:i.basemap)==null?void 0:S.referenceLayers,i==null?void 0:i.layers].filter(T=>!!T);r.forEach(T=>"layers"in T&&p.push(T.layers)),this.addHandles(p.map(T=>this._watchUpdatingTracking.addOnCollectionChange(()=>T,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([gi(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ce(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),ri)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),_9(this._recyclingInfoMap),_9(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(ni()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||MI(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(_9(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new re("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,i){var o;this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(e);if(!(r!=null&&r.done))return!0;const n=r.layerView;return!(!n||!i||n.parent===i)||!!(r.done&&n&&"layers"in e&&((o=e.layers)!=null&&o.length))&&e.layers.some(u=>this.isCreatingLayerViewsForLayer(u,n))}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(Ks(this,e),Ks(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,r){if(!e||!i)return void(i&&i.removeAll());let n=0;for(const o of e){const u=this._layerLayerViewInfoMap.get(o);if(!(u!=null&&u.layerView))continue;const p=u.layerView;p.layer=o,p.parent=r,i.at(n)!==p&&i.splice(n,0,p),"layers"in o&&bIe(p)&&this._populateLayerViewsOwners(o.layers,p.layerViews,p),n+=1}n<i.length&&i.splice(n,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new wIe(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),r=>{r&&(Cn(r)||r.name==="cancelled:layerview-create")||fe.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};m([b()],hl.prototype,"_workPromise",void 0),m([b({readOnly:!0})],hl.prototype,"_watchUpdatingTracking",void 0),m([b({readOnly:!0})],hl.prototype,"_layersToLayerViews",null),m([b({readOnly:!0})],hl.prototype,"_rootCollectionNames",null),m([b()],hl.prototype,"layerViewImporter",void 0),m([b()],hl.prototype,"supportsGround",void 0),m([b({readOnly:!0})],hl.prototype,"updating",null),m([b({readOnly:!0})],hl.prototype,"updatingRemaining",null),m([b({constructOnly:!0})],hl.prototype,"view",void 0),hl=m([G("esri.views.LayerViewManager")],hl);const _Ie=hl;function SIe(t){return"createLayerView"in t&&t.createLayerView!=null}let wa=class extends Te{constructor(e){super(e),this.factor=1.5,this.offset=Mr(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};m([b({type:Number})],wa.prototype,"factor",void 0),m([b({nonNullable:!0})],wa.prototype,"offset",void 0),m([b()],wa.prototype,"position",void 0),m([b({type:Number,range:{min:0}})],wa.prototype,"size",void 0),m([b()],wa.prototype,"maskUrl",void 0),m([b()],wa.prototype,"maskEnabled",void 0),m([b()],wa.prototype,"overlayUrl",void 0),m([b()],wa.prototype,"overlayEnabled",void 0),m([b({readOnly:!0})],wa.prototype,"version",null),m([b({type:Boolean})],wa.prototype,"visible",void 0),wa=m([G("esri.views.Magnifier")],wa);const Sie=wa;let fm=class{constructor(e){this._observable=new Gb,this._map=new Map(e)}get size(){return He(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const i=this._map.delete(e);return i&&this._observable.notify(),i}entries(){return He(this._observable),this._map.entries()}forEach(e,i){He(this._observable),this._map.forEach((r,n)=>e.call(i,r,n,this),i)}get(e){return He(this._observable),this._map.get(e)}has(e){return He(this._observable),this._map.has(e)}keys(){return He(this._observable),this._map.keys()}set(e,i){return this._map.set(e,i),this._observable.notify(),this}values(){return He(this._observable),this._map.values()}[Symbol.iterator](){return He(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};function Yx(t){return!!(t!=null&&typeof t=="object"&&"createQuery"in t&&t.createQuery&&"on"in t&&t.on)}let sp=class extends Ar.EventedAccessor{constructor(e){super(e),this._selectionMap=new fm,this._sources=new Ie,this._trashCan=[],this._layerEditHandles=new Ie,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([ce(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),gi(()=>this.sources,"change",i=>{const r=this._selectionMap;for(const n of i.removed)r.delete(n);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new Ie;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(i=>"sublayers"in i&&i.sublayers?i.sublayers:null).forEach(i=>{(Yx(i)&&!sv(i)||U0(i))&&e.add(i)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(Vi)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[i,r]=e;return{layer:i,selection:[...r.selection]}})}get count(){let e=0;for(const i of this._selectionMap.values())e+=i.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Jp(e,this._sources)}async getSelectedFeatures(e,i={},r="layerView"){const{view:n,selections:o}=this,u=(e!==void 0?o.filter(p=>e.includes(p.layer)):o).filter(p=>p.selection.length>0).map(async p=>{const{layer:g,selection:w}=p,S=U0(g)?g.parent:g;if(S==null||!Dz(S))return null;if(r==="layer")return jz(S,w,i);if(Nz(S))return null;const T=await n.whenLayerView(S).catch(()=>null);return T?jz(T,w,i):null});return(await Promise.all(u)).filter(p=>p!=null)}updateSelection(e){const i=new Map;for(const[o,u]of this._selectionMap)i.set(o,[...u.selection]);let r=!1;const n=e.current.concat(e.added);for(const o of n){const u=o.sourceLayer,p=o.getObjectId();if(this.sources.includes(u)&&(Yx(u)||U0(u))&&p!==null){const g=Bf(i,u,()=>[]);g.includes(p)||(g.push(p),r=!0)}}for(const o of e.removed){const u=o.sourceLayer,p=o.getObjectId();if(this.sources.includes(u)&&(Yx(u)||U0(u))&&p!==null){const g=i.get(u),w=g==null?void 0:g.indexOf(p);w!==void 0&&w>=0&&(g==null||g.splice(w,1),r=!0)}}if(r){const{_selectionMap:o,_trashCan:u}=this,p=[];for(const[g,w]of i){const S=o.get(g);S!==void 0&&u.push(S),o.set(g,{selection:w}),p.push({layer:g,selection:w,...w4(S!==void 0?S.selection:[],w)})}this._onSelectionChange(p)}}setSelection(e,i){this._setSelection(e,i)}getSelection(e){const i=this._selectionMap.get(e);return i==null?void 0:i.selection}appendToSelection(e,i){const r=this._selectionMap.get(e),n=r!==void 0?[...r.selection]:[];for(const o of i)n.includes(o)||n.push(o);this._setSelection(e,n)}removeFromSelection(e,i){const r=this._selectionMap.get(e);if(!r)return;const n=[];for(const o of r.selection)i.includes(o)||n.push(o);this._setSelection(e,n)}toggleInSelection(e,i){const r=this._selectionMap.get(e);if(!r||r.selection.length===0)return void this._setSelection(e,i);const n=new Set(r.selection),o=new Set(i),u=lhe(n,o);this._setSelection(e,Array.from(u))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const i=[];for(const[r,n]of this._selectionMap.entries())i.push({layer:r,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var u;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const p=this._trashCan.pop();(u=p==null?void 0:p.highlightHandle)==null||u.remove()}const{sources:e,view:i,_selectionMap:r,showHighlight:n}=this,o=this._vizTaskId;for(const p of e){const g=r.get(p),w=U0(p)?p.parent:p;if(w!=null&&Dz(w)){if(Nz(w))continue;i.whenLayerView(w).then(S=>{var T;(T=g==null?void 0:g.highlightHandle)==null||T.remove(),g!=null&&n&&o===this._vizTaskId&&"highlight"in S&&typeof S.highlight=="function"&&g.selection.length>0&&(g.highlightHandle=S.highlight(g.selection,"selection"))}).catch(()=>{var S;(S=g==null?void 0:g.highlightHandle)==null||S.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(Vi);for(const e of this.sources){const i=U0(e)?e.parent:e;if(i!=null&&Yx(i)){const r=i.on("edits",n=>{this._handleEditChanges(n,e)});this._layerEditHandles.push(r)}}}_handleEditChanges(e,i){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(i)){const r=e.deletedFeatures.filter(n=>n.error==null).map(n=>n.objectId).filter(Rt);this.removeFromSelection(i,r)}}_setSelection(e,i){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const r=this._selectionMap.get(e);if(r===void 0||!$Ie(r,{selection:i})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(e,{selection:[...i]});const n={layer:e,selection:[...i],...w4(r!==void 0?r.selection:[],i)};this._onSelectionChange([n])}}};m([b({readOnly:!0,nonNullable:!0})],sp.prototype,"selections",null),m([b({readOnly:!0,nonNullable:!0})],sp.prototype,"count",null),m([b({constructOnly:!0,nonNullable:!0})],sp.prototype,"view",void 0),m([b({readOnly:!0,nonNullable:!0})],sp.prototype,"hasSelection",null),m([b()],sp.prototype,"showHighlight",void 0),m([b()],sp.prototype,"sources",null),sp=m([G("esri.views.SelectionManager")],sp);const Nz=t=>{var e;return U0(t)?((e=t.parent)==null?void 0:e.isTable)===!0:t.isTable},xIe=t=>t.layer!==void 0,Dz=t=>(t==null?void 0:t.when)!==void 0,$Ie=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],r=[...e.selection];if(i.length!==r.length)return!1;i.sort(),r.sort();for(let n=0;n<i.length;n++)if(i[n]!==r[n])return!1}return!0},jz=async(t,e,i={})=>{let r;if(xIe(t)){const n=t;r=n===void 0?null:await n.queryFeatures(new ec({...i,objectIds:e})).then(o=>({data:o,layer:t.layer}))}else{const n=t;r=n===void 0?null:await n.queryFeatures(new ec({...i,objectIds:e})).then(o=>({data:o,layer:n}))}return r},TIe=sp;let q_=class extends Gt(Te){constructor(e){super(e),this.accentColor=new Ce([255,127,0]),this.textColor=new Ce([255,255,255])}};m([b({type:Ce,nonNullable:!0})],q_.prototype,"accentColor",void 0),m([b({type:Ce,nonNullable:!0})],q_.prototype,"textColor",void 0),q_=m([G("esri.views.Theme")],q_);const YL=q_;var Vz;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(Vz||(Vz={}));const xie=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],$ie={};function Tie(t){return!!$ie[t]}function EIe(t){for(const e of t)if(!Tie(e))return!1;return!0}xie.forEach(t=>{$ie[t]=!0});let IIe=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:r},n)=>{var o;return(o=this.inputManager)==null?void 0:o.installHandlers(n,[i],r)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var r;return(r=this.inputManager)==null?void 0:r.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,r,n){const o=Array.isArray(e)?e:e.split(",");if(!EIe(o))return o.some(Tie)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let u,p;Array.isArray(i)?p=i:(u=i,p=[]),typeof r=="function"?u=r:n=r,n=n??ii.DEFAULT;const g=this._createUniqueGroupName(),w=new MIe(this.view,o,p,u);this._handlers.set(g,{handler:w,priority:n});for(const S of o){const T=this._handlerCounts.get(S)||0;this._handlerCounts.set(S,T+1)}return this.inputManager&&this.inputManager.installHandlers(g,[w],n),We(()=>this._removeHandler(g,o))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of i){const n=this._handlerCounts.get(r);n===void 0||(n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},MIe=class extends Zn{constructor(e,i,r,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of i)switch(o){case"click":this.registerIncoming("click",r,u=>n(AIe(e,u)));break;case"double-click":this.registerIncoming("double-click",r,u=>n(LIe(e,u)));break;case"immediate-click":this.registerIncoming("immediate-click",r,u=>n(OIe(e,u)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,u=>n(PIe(e,u)));break;case"hold":this.registerIncoming("hold",r,u=>n(RIe(e,u)));break;case"drag":this.registerIncoming("drag",r,u=>{const p=this._wrapDrag(u);p&&n(p)});break;case"key-down":this.registerIncoming("key-down",r,u=>n(FIe(u)));break;case"key-up":this.registerIncoming("key-up",r,u=>n(NIe(u)));break;case"pointer-down":this.registerIncoming("pointer-down",r,u=>n(kw(u,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,u=>n(kw(u,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,u=>n(kw(u,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,u=>n(DIe(u)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,u=>n(jIe(u)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,u=>n(kw(u,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,u=>n(kw(u,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,u=>{n(VIe(u))});break;case"focus":this.registerIncoming("focus",r,u=>{n(kIe(u))});break;case"blur":this.registerIncoming("blur",r,u=>{n(CIe(u))})}}_wrapDrag(e){const i=e.data,{x:r,y:n}=i.center,{action:o,pointerType:u,button:p}=i;if(o==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const g=i.pointer.native,w=i.buttons,{cancelable:S,timestamp:T}=e,E={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:r,y:n,origin:E,pointerType:u,button:p,buttons:w,radius:i.radius,angle:GZ(i.angle),native:g,timestamp:T,cancelable:S,stopPropagation:()=>e.stopPropagation(),async:C=>e.async(C),preventDefault:()=>e.preventDefault()}}};function kIe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function CIe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function AIe(t,e){const{pointerType:i,button:r,buttons:n,x:o,y:u,native:p,eventId:g}=e.data,{cancelable:w,timestamp:S}=e;return{type:"click",pointerType:i,button:r,buttons:n,x:o,y:u,native:p,timestamp:S,screenPoint:Mr(o,u),mapPoint:TS(t,o,u),eventId:g,cancelable:w,stopPropagation:()=>e.stopPropagation(),async:T=>e.async(T),preventDefault:()=>e.preventDefault()}}function LIe(t,e){const{pointerType:i,button:r,buttons:n,x:o,y:u,native:p,eventId:g}=e.data,{cancelable:w,timestamp:S}=e;return{type:"double-click",pointerType:i,button:r,buttons:n,x:o,y:u,native:p,timestamp:S,mapPoint:TS(t,o,u),eventId:g,cancelable:w,stopPropagation:()=>e.stopPropagation(),async:T=>e.async(T),preventDefault:()=>e.preventDefault()}}function OIe(t,e){const{pointerType:i,button:r,buttons:n,x:o,y:u,native:p,eventId:g}=e.data,w=p.pointerId,{cancelable:S,timestamp:T}=e;return{type:"immediate-click",pointerId:w,pointerType:i,button:r,buttons:n,x:o,y:u,native:p,timestamp:T,mapPoint:TS(t,o,u),eventId:g,cancelable:S,stopPropagation:()=>e.stopPropagation(),async:E=>e.async(E),preventDefault:()=>e.preventDefault()}}function PIe(t,e){const{pointerType:i,button:r,buttons:n,x:o,y:u,native:p,eventId:g}=e.data,w=p.pointerId,{cancelable:S,timestamp:T}=e;return{type:"immediate-double-click",pointerId:w,pointerType:i,button:r,buttons:n,x:o,y:u,native:p,timestamp:T,mapPoint:TS(t,o,u),eventId:g,cancelable:S,stopPropagation:()=>e.stopPropagation(),async:E=>e.async(E),preventDefault:()=>e.preventDefault()}}function RIe(t,e){const{pointerType:i,button:r,buttons:n,x:o,y:u,native:p}=e.data,{cancelable:g,timestamp:w}=e;return{type:"hold",pointerType:i,button:r,buttons:n,x:o,y:u,native:p,timestamp:w,mapPoint:TS(t,o,u),cancelable:g,stopPropagation:()=>e.stopPropagation(),async:S=>e.async(S),preventDefault:()=>e.preventDefault()}}function TS(t,e,i){return t.toMap(Mr(e,i),{exclude:[]})}function FIe(t){const{key:e,repeat:i,native:r}=t.data,{cancelable:n,timestamp:o}=t;return{type:"key-down",key:e,repeat:i,native:r,timestamp:o,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:u=>t.async(u),preventDefault:()=>t.preventDefault()}}function NIe(t){const{key:e,native:i}=t.data,{cancelable:r,timestamp:n}=t;return{type:"key-up",key:e,native:i,timestamp:n,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}function kw(t,e){const{x:i,y:r,button:n,buttons:o,native:u,eventId:p}=t.data,g=u.pointerId,w=u.pointerType,{cancelable:S,timestamp:T}=t;return{type:e,x:i,y:r,pointerId:g,pointerType:w,button:n,buttons:o,native:u,timestamp:T,eventId:p,cancelable:S,stopPropagation:()=>t.stopPropagation(),async:E=>t.async(E),preventDefault:()=>t.preventDefault()}}function DIe(t){const{x:e,y:i,buttons:r,native:n,eventId:o}=t.data.currentEvent,{button:u}=t.data.startEvent,p=t.data.startEvent.native.pointerId,g=t.data.startEvent.native.pointerType,w=t.data.action,S={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:T,timestamp:E}=t;return{type:"pointer-drag",x:e,y:i,pointerId:p,pointerType:g,button:u,buttons:r,action:w,origin:S,native:n,timestamp:E,eventId:o,cancelable:T,stopPropagation:()=>t.stopPropagation(),async:C=>t.async(C),preventDefault:()=>t.preventDefault()}}function jIe(t){const{cancelable:e,data:i,timestamp:r}=t,{x:n,y:o,deltaY:u,native:p}=i;return{type:"mouse-wheel",x:n,y:o,deltaY:u,native:p,timestamp:r,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:g=>t.async(g),preventDefault:()=>t.preventDefault()}}function VIe(t){const{action:e,state:i,device:r}=t.data,{cancelable:n,timestamp:o}=t,{buttons:u,axes:p}=i;return{type:"gamepad",device:r,timestamp:o,action:e,buttons:u,axes:p,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:g=>t.async(g),preventDefault:()=>t.preventDefault()}}var M3,zz,Uz;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(M3||(M3={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(zz||(zz={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(Uz||(Uz={}));function zIe(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return fe.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function XL(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(M3.USER)&&t.getEditableFlag(M3.MANAGER)}function Sl(t){return Mr(t.x,t.y)}function Eie(t,e){var r;const i=(r=t instanceof HTMLElement?t:t.surface)==null?void 0:r.getBoundingClientRect();return i?Mr(e.clientX-i.left,e.clientY-i.top):Mr(0,0)}function Iie(t,e){return e instanceof Event?Eie(t,e):Sl(e)}function Mie(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let UIe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":Bz(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!qz(e))break;const n=Sl(e),o=fg(n,e.pointerType,i.forEachTool);if(o==null)break;const u=o.manipulator,p=o.tool;u==null||p==null||!u.interactive||u.grabbable&&u.grabbableForEvent(e)||!u.grabbing||u.dragging||this._releaseManipulatorBeforeDragging(u,e,i),u!=null&&p!=null&&u.interactive&&u.grabbable&&u.grabbableForEvent(e)&&!u.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:u,tool:p,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(o.tool)),u.grabbing=!0,u.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!qz(e))break;const n=this._grabbedManipulators.get(e.pointerId),o=n==null?void 0:n.manipulator,u=n==null?void 0:n.tool;if(o==null||u==null)break;const p=Sl(e);p.x=An(p.x,0,i.view.width),p.y=An(p.y,0,i.view.height);const g=n.start,w=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,w?o.events.emit("drag",{action:"update",start:g,screenPoint:p}):o.events.emit("drag",{action:"start",start:g,screenPoint:p,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:u,manipulator:o,start:g}));break;case"end":o.dragging=!1,w&&o.events.emit("drag",{action:"end",start:g,screenPoint:p}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}r();break}case"immediate-click":{const n=Sl(e),o=fg(n,e.pointerType,i.forEachTool);if(GIe(e)||i.forEachTool(w=>{if((o==null||o.tool!==w||w.automaticManipulatorSelection)&&w.manipulators){let S=!1;w.manipulators.forEach(({manipulator:T})=>{T.selected&&(T.selected=!1,S=!0)}),S&&w.onManipulatorSelectionChanged&&w.onManipulatorSelectionChanged()}}),o==null)break;const{manipulator:u,tool:p}=o;if(!u.interactive)break;u.selectable&&p.automaticManipulatorSelection&&(u.selected=!u.selected,p.onManipulatorSelectionChanged&&p.onManipulatorSelectionChanged());const g=e.native.shiftKey;u.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:g,stopPropagation:r}),pk(u,r);break}case"click":{const n=Sl(e),o=fg(n,e.pointerType,i.forEachTool),u=o==null?void 0:o.manipulator;if(u==null||!u.interactive)break;const p=e.native.shiftKey;u.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:p}),r();break}case"double-click":{const n=Sl(e),o=fg(n,e.pointerType,i.forEachTool),u=o!=null?o.manipulator:null;if(u==null||!u.interactive)break;const p=e.native.shiftKey;u.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:p,stopPropagation:r}),pk(u,r);break}case"immediate-double-click":{const n=Sl(e),o=fg(n,e.pointerType,i.forEachTool),u=o!=null?o.manipulator:null;if(u==null||!u.interactive)break;const p=e.native.shiftKey;u.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:p,stopPropagation:r}),pk(u,r);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(e,i,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:Sl(i)}),this._grabbedManipulators.forEach(({manipulator:n},o)=>{n===e&&this._grabbedManipulators.delete(o)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(e,i){var n;const r=(n=this._grabbedManipulators.get(e.pointerId))==null?void 0:n.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Sl(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=Gz(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=Gz(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{i.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),e(n=>{n.hasGrabbedManipulators=i.has(n),n.hasHoveredManipulators=r.has(n);const o=this._grabbedManipulators.values(),u=gce(o,({tool:p})=>p===n);n.firstGrabbedManipulator=u!=null?u.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:r},n=!0,o){const u=(p,g)=>p===e&&(o==null||o===g);this._grabbedManipulators.forEach(({tool:p,manipulator:g,pointerType:w},S)=>{u(p,g)&&(this._grabbedManipulators.delete(S),g.grabbing=!1,g.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:w}))}),this._draggedManipulators.forEach(({tool:p,manipulator:g},w)=>{u(p,g)&&(this._draggedManipulators.delete(w),g.dragging=!1,g.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:p,manipulator:g},w)=>{u(p,g)&&(this._hoveredManipulators.delete(w),g.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Mr(i.x,i.y),r,i.pointerType,e)})}handleHoverEvent(e,i){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!Bz(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Sl(e),e.pointerId,e.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(e,i,r,n){var p;let o=fg(e,r,n);const u=(p=this._hoveredManipulators.get(i))==null?void 0:p.manipulator;o==null||o.manipulator.interactive||(o=null),o!=null&&u===o.manipulator||(u!=null&&(u.hovering=!1),o!=null?(o.manipulator.hovering=!0,this._hoveredManipulators.set(i,o)):this._hoveredManipulators.delete(i),this._onFocusChange(n))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function Gz(t){let e=null;return MI(t,({manipulator:i})=>!(i==null||!i.interactive)&&(i.grabbing&&i.grabCursor?(e=i.grabCursor,!0):!!i.cursor&&(e=i.cursor,!0))),e}function fg(t,e,i){let r=null;return i(n=>{if(n.manipulators==null||!XL(n))return!1;const o=n.manipulators.intersect(t,e);return o!=null&&(r={tool:n,manipulator:o},!0)}),r}function Bz(t){return t==="mouse"}function qz(t){return t.pointerType!=="mouse"||t.button===0}function GIe(t){return!!t.native.shiftKey}function pk(t,e){t!=null&&t.consumesClicks&&e()}const Hz="attached",dk="tools",BIe=1e3;let Lc=class extends Te{constructor(e){super(e),this._updatingHandles=new Ua,this._clock=Nb,this._manipulatorState=new UIe,this.tools=new Ie,this.cursor=null,this._interacting=!1,this._interactingTimeout=BIe,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const r of this.tools.items)if(i(r))return}}initialize(){this.addHandles([this.view.on(xie,e=>{this._handleInputEvent(e)},ii.TOOL),...zIe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void fe.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const n=XL(r);this.activeTool!=null&&n||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Vi(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([ce(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(r=>r.onElevationChange(i)))],Hz):this.addHandles(ce(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Hz),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:r})=>e(r,i))})}_handleInputEvent(e){let i=!1;const r={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(n=>{!i&&n.visible&&n.handleInputEvent(r)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(dk),this._forEachTool(e=>{if(e instanceof Te){const i=ce(()=>[e.cursor,e.visible,e.editable],()=>{XL(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,dk)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],dk)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,M3.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){}};m([b({constructOnly:!0,nonNullable:!0})],Lc.prototype,"view",void 0),m([b({value:null})],Lc.prototype,"activeTool",null),m([b({readOnly:!0,type:Ie})],Lc.prototype,"tools",void 0),m([b({readOnly:!0})],Lc.prototype,"cursor",void 0),m([b({readOnly:!0})],Lc.prototype,"updating",null),m([b()],Lc.prototype,"_interacting",void 0),m([b({readOnly:!0})],Lc.prototype,"interacting",null),Lc=m([G("esri.views.ToolViewManager")],Lc);let O1=class extends Te{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":qIe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return HIe[this.deviceType]}};m([b({nonNullable:!0,readOnly:!0})],O1.prototype,"nativeIndex",void 0),m([b({type:String,readOnly:!0})],O1.prototype,"deviceType",null),m([b({type:Number,readOnly:!0})],O1.prototype,"axisThreshold",null),O1=m([G("esri.views.input.gamepad.GamepadInputDevice")],O1);const wR=O1,qIe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),HIe={standard:.15,spacemouse:.025,unknown:0};let H_=class extends Te{constructor(...e){super(...e),this.devices=new Ie,this.enabledFocusMode="document"}};m([b({type:Ie.ofType(wR),readOnly:!0})],H_.prototype,"devices",void 0),m([b({type:["document","view","none"]})],H_.prototype,"enabledFocusMode",void 0),H_=m([G("esri.views.input.gamepad.GamepadSettings")],H_);const WIe=H_;let i5=class extends Te{constructor(){super(...arguments),this.gamepad=new WIe}};m([b({readOnly:!0})],i5.prototype,"gamepad",void 0),i5=m([G("esri.views.input.Input")],i5);const JIe=i5,kie=()=>Ct.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;let tf=class extends Te{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};m([b({type:Boolean,nonNullable:!0})],tf.prototype,"enabled",void 0),m([b({type:wR})],tf.prototype,"device",void 0),m([b({type:["pan","zoom"],nonNullable:!0})],tf.prototype,"mode",void 0),m([b({type:["forward-down","forward-up"],nonNullable:!0})],tf.prototype,"tiltDirection",void 0),m([b({type:Number,nonNullable:!0})],tf.prototype,"velocityFactor",void 0),tf=m([G("esri.views.navigation.gamepad.GamepadSettings")],tf);const Cie=tf;let Sy=class extends Te{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Cie,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!kie()}};m([b({type:Boolean})],Sy.prototype,"browserTouchPanEnabled",void 0),m([b({type:Cie,nonNullable:!0})],Sy.prototype,"gamepad",void 0),m([b({type:Boolean})],Sy.prototype,"momentumEnabled",void 0),m([b({type:Boolean})],Sy.prototype,"mouseWheelZoomEnabled",void 0),Sy=m([G("esri.views.navigation.Navigation")],Sy);const Aie=Sy;function HXe(t,e,i){const r=Lie(t),n=e,o=ZIe(r,n,i);if(r){const u=_S.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!i&&u!==r.heightUnit){const p=new re("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${u})`,{horizontalUnit:u});return new re("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:p})}}if(!KIe(t)||o===zo.Unsupported)return new re("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(o){case zo.Units:{const u=(r==null?void 0:r.heightUnit)||"unknown",p=(n==null?void 0:n.heightUnit)||"unknown",g=new re("layerview:incompatible-height-unit",`The vertical units of the layer (${u}) must match the vertical units of the scene (${p})`,{layerUnit:u,sceneUnit:p});return new re("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:g})}case zo.HeightModel:{const u=(r==null?void 0:r.heightModel)||"unknown",p=(n==null?void 0:n.heightModel)||"unknown",g=new re("layerview:incompatible-height-model",`The height model of the layer (${u}) must match the height model of the scene (${p})`,{layerHeightModel:u,sceneHeightModel:p});return new re("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:g})}case zo.CRS:{const u=(r==null?void 0:r.vertCRS)||"unknown",p=(n==null?void 0:n.vertCRS)||"unknown",g=new re("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${u}) must match the vertical datum of the scene (${p})`,{layerDatum:u,sceneDatum:p});return new re("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:g})}}return null}function ZIe(t,e,i){if(!Wz(t)||!Wz(e))return zo.Unsupported;if(t==null||e==null)return zo.Ok;if(!i&&t.heightUnit!==e.heightUnit)return zo.Units;if(t.heightModel!==e.heightModel)return zo.HeightModel;switch(t.heightModel){case"gravity-related-height":return zo.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?zo.Ok:zo.CRS;default:return zo.Unsupported}}var zo;function Wz(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function KIe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!Rie(t)}function Lie(t){var r;if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?Zu(t.url):void 0;return!(((r=t.spatialReference)==null?void 0:r.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&Oie(t)&&t.heightModelInfo?t.heightModelInfo:Rie(t)?_S.deriveUnitFromSR(XIe,t.spatialReference):null}function Oie(t){return"heightModelInfo"in t}function Pie(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Rie(t){return Pie(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Fie(t)}function YIe(t){return t.layers!=null||Fie(t)||Pie(t)||Oie(t)}function Fie(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(zo||(zo={}));const XIe=new _S({heightModel:"gravity-related-height"});var Xp;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(Xp||(Xp={}));let QL,fk=null;async function QIe(t){fk||(fk=ie(()=>import("./geometryServiceUtils-hjs3Ep4E.js"),[]).then(e=>QL=e)),await fk,At(t)}async function Nie(t,e,i,r){if(!t)return null;const n=t.spatialReference;return Eh()||Ba(n,e)?Ts(t,e):QL?QL.projectGeometry(t,e,i,r):(await Promise.race([QIe(r),gh(r)]),Nie(t,e,i,r))}let Pi=class extends Te{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=En(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var r,n,o,u;const e=(r=this.map)==null?void 0:r.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(o=e==null?void 0:e.ground)==null?void 0:o.layers},{parent:e==null?void 0:e.basemap,layers:(u=e==null?void 0:e.basemap)==null?void 0:u.referenceLayers}),i}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;let r=null;for(const o of e){const u=this._getSupportedSpatialReferences(o);if(u.length>0){const p=this._narrowDownSpatialReferenceCandidates(r,u);p!=null&&(r=p)}if(r!=null&&r.length===1)break}if(i&&(r==null||r.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(r);return{spatialReference:(n==null?void 0:n.spatialReference)??null,viewingMode:(n==null?void 0:n.viewingMode)??null,updating:!1}}get _tileInfoTask(){var r,n,o,u,p,g,w;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:i}=this._collectLayers([{parent:(n=(r=this.map)==null?void 0:r.call(this))==null?void 0:n.basemap,layers:(p=(u=(o=this.map)==null?void 0:o.call(this))==null?void 0:u.basemap)==null?void 0:p.baseLayers},{layers:(w=(g=this.map)==null?void 0:g.call(this))==null?void 0:w.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const S=e[0].tileInfo;return{tileInfo:S!=null&&S.spatialReference.equals(this.spatialReference)?S:null,updating:!1}}return{updating:i}}get _heightModelInfoTask(){var r,n,o;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;for(const u of e)if(YIe(u)){const p=Lie(u);if(p)return{heightModelInfo:p,vcsWkid:(n=u.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(o=u.spatialReference)==null?void 0:o.latestVcsWkid,updating:!1}}return{updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,i=e.updating,r=[];for(const n of e.layers){const o="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),u=this.requiresExtentInSpatialReference?null:o[0],p=o.find(g=>g.spatialReference.equals(this.spatialReference))??u;if(p)return{candidates:[{extent:p,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const g of o)r.push({extent:g,layer:n})}return{candidates:r,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),n=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=En(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:n.clone(),task:Sh(async o=>{try{const u=await Nie(r.extent,n,"portalItem"in r.layer?r.layer.portalItem:void 0,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:u}}catch{if(Xo(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const r=new Array;for(const n of e)for(const o of i){if(!n.spatialReference.equals(o.spatialReference))continue;const u=tMe(n.viewingMode,o.viewingMode);if(u!==!1){r.push({spatialReference:n.spatialReference,viewingMode:u});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(i))&&(e=e.filter(({spatialReference:r})=>r.equals(i))),e.length>1&&e.some(({viewingMode:r})=>r!==Xp.Local)&&(e=e.filter(({viewingMode:r})=>r!==Xp.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const r=[];for(const n of i){const o=this.getSpatialReferenceSupport(n,e);if(o!=null){const u=o.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:p,viewingMode:g}of u)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!p.equals(this.userSpatialReference)||r.push({spatialReference:p,viewingMode:g})}}return r}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:r})=>i.equals(r.spatialReference))||e[0]}_collectLayers(e){var r;if(this._loadMaybe((r=this.map)==null?void 0:r.call(this))!=="loaded")return{layers:[],updating:!0};const i=new eMe;for(const n of e)if(this._collectCollection(n,i),i.preloading===this.sourcePreloadCount)break;return{layers:i.layers,updating:i.updating}}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const r of e.layers){switch(this._loadMaybe(r)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":i.updating||i.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},i)}if(i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{Cn(i)||console.log(i)}),"loading"):e.loadStatus:"loaded"}};m([b()],Pi.prototype,"required",void 0),m([b({constructOnly:!0})],Pi.prototype,"map",void 0),m([b({constructOnly:!0})],Pi.prototype,"getSpatialReferenceSupport",void 0),m([b()],Pi.prototype,"defaultSpatialReference",void 0),m([b()],Pi.prototype,"userSpatialReference",void 0),m([b()],Pi.prototype,"sourcePreloadCount",void 0),m([b()],Pi.prototype,"priorityCollection",void 0),m([b()],Pi.prototype,"requiresExtentInSpatialReference",void 0),m([b()],Pi.prototype,"suspended",void 0),m([b({readOnly:!0})],Pi.prototype,"ready",null),m([b({readOnly:!0})],Pi.prototype,"heightModelInfoReady",null),m([b({readOnly:!0})],Pi.prototype,"spatialReference",null),m([b({readOnly:!0})],Pi.prototype,"extent",null),m([b({readOnly:!0})],Pi.prototype,"heightModelInfo",null),m([b({readOnly:!0})],Pi.prototype,"vcsWkid",null),m([b({readOnly:!0})],Pi.prototype,"latestVcsWkid",null),m([b({readOnly:!0})],Pi.prototype,"viewingMode",null),m([b({readOnly:!0})],Pi.prototype,"tileInfo",null),m([b({readOnly:!0})],Pi.prototype,"mapCollections",null),m([b({readOnly:!0})],Pi.prototype,"_allLayers",null),m([b({readOnly:!0})],Pi.prototype,"_spatialReferenceTask",null),m([b({readOnly:!0})],Pi.prototype,"_tileInfoTask",null),m([b({readOnly:!0})],Pi.prototype,"_heightModelInfoTask",null),m([b({readOnly:!0})],Pi.prototype,"_extentCandidatesTask",null),m([b()],Pi.prototype,"_extentTask",null),m([b()],Pi.prototype,"_projectExtentTask",void 0),Pi=m([G("esri.views.support.DefaultsFromMap")],Pi);let eMe=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};function tMe(t,e){return t!=null?e!=null?t===e&&t:t:e}var W_;let Ze=W_=class extends Ar.EventedMixin(Bb(Te)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new Fb,this.updatingHandles=new Ua,this.allLayerViews=new c3({getCollections:()=>{var e,i,r;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:rMe}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new dm,this.analyses=new PE,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ie,this.magnifier=new Sie,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new JIe,this.navigation=new Aie,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new IIe(this),this.persistableViewModels=new Ie,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(ce(()=>this.preconditionsReady,e=>{var r,n;const i=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,W_.views.add(this)):(this._lockedSpatialReference=null,W_.views.remove(this)),this.notifyChange("spatialReference"),!e&&i)(r=this.toolViewManager)==null||r.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown();else if(e&&!i){try{this._startup()}catch(o){return void queueMicrotask(()=>{this.fatalError=new re("startup-error",null,o)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},$s))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,vr(()=>this.ready)))),this.basemapView=new ef({view:this}),this.layerViewManager=new _Ie({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Lc({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new TIe({view:this}),this.addHandles([ce(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},ri),ce(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},$s),ce(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},ri)])}_setupSpatialReferenceLogger(){let t=null;this.addHandles([ce(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var r;const i=((r=this.map)==null?void 0:r.allLayers.length)>0;if(e&&!this.spatialReference&&i){if(t!=null)return;const n=We(()=>t=En(t));t=Sh(async o=>{try{await Db(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{t=null}fe.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(n,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var t,e;this.destroyed||(W_.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=ot(this.graphics),this.analyses=ot(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),ot(this.analysisViewManager),this.toolViewManager=ot(this.toolViewManager),this.layerViewManager=ot(this.layerViewManager),this.selectionManager=ot(this.selectionManager),this.basemapView=ot(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=ot(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return fe.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Pi({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Qo.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(fe.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Qo.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get spatialReference(){var e,i;const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)){const r=t.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return t}set spatialReference(t){const e=!Ki(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??$o}set timeZone(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));this._userTimeZone=t,t===$o||t===Kp||e.has(t.toLowerCase())||i.has(t.toLowerCase())||fe.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new YL}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}importLayerView(t){throw new re("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&fe.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(Fr(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};Ze.views=new Ie,m([b()],Ze.prototype,"_userSpatialReference",void 0),m([b()],Ze.prototype,"activeTool",null),m([b({readOnly:!0})],Ze.prototype,"allLayerViews",void 0),m([b()],Ze.prototype,"groundView",void 0),m([b()],Ze.prototype,"animation",null),m([b()],Ze.prototype,"basemapView",void 0),m([b()],Ze.prototype,"center",null),m([b({readOnly:!0})],Ze.prototype,"_defaultsFromMapSettings",null),m([b()],Ze.prototype,"defaultsFromMap",null),m([b()],Ze.prototype,"fatalError",void 0),m([b({type:jt})],Ze.prototype,"extent",null),m([b(KL(dm,"graphics"))],Ze.prototype,"graphics",void 0),m([b(KL(PE,"analyses"))],Ze.prototype,"analyses",void 0),m([b({readOnly:!0,type:_S})],Ze.prototype,"heightModelInfo",null),m([b({readOnly:!0})],Ze.prototype,"interacting",null),m([b({readOnly:!0})],Ze.prototype,"navigating",null),m([b({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Ze.prototype,"preconditionsReady",null),m([b({readOnly:!0})],Ze.prototype,"typeSpecificPreconditionsReady",void 0),m([b({type:Ie,readOnly:!0})],Ze.prototype,"layerViews",void 0),m([b()],Ze.prototype,"resolution",null),m([b({type:Sie})],Ze.prototype,"magnifier",void 0),m([b({value:null,type:eX})],Ze.prototype,"map",null),m([b()],Ze.prototype,"padding",void 0),m([b({readOnly:!0})],Ze.prototype,"ready",void 0),m([b({type:Ge})],Ze.prototype,"spatialReference",null),m([b()],Ze.prototype,"spatialReferenceWarningDelay",void 0),m([b()],Ze.prototype,"stationary",null),m([b({readOnly:!0})],Ze.prototype,"supportsGround",void 0),m([b({type:Di})],Ze.prototype,"timeExtent",void 0),m([b({type:String,nonNullable:!0})],Ze.prototype,"timeZone",null),m([b()],Ze.prototype,"tools",null),m([b()],Ze.prototype,"toolViewManager",void 0),m([b({readOnly:!0})],Ze.prototype,"type",void 0),m([b({type:Number})],Ze.prototype,"scale",void 0),m([b({readOnly:!0})],Ze.prototype,"updating",void 0),m([b({readOnly:!0})],Ze.prototype,"initialExtentRequired",void 0),m([b({readOnly:!0})],Ze.prototype,"initialExtent",null),m([b()],Ze.prototype,"cursor",null),m([b({readOnly:!0})],Ze.prototype,"input",void 0),m([b({type:Aie,nonNullable:!0})],Ze.prototype,"navigation",void 0),m([b()],Ze.prototype,"layerViewManager",void 0),m([b()],Ze.prototype,"analysisViewManager",void 0),m([b()],Ze.prototype,"selectionManager",void 0),m([b()],Ze.prototype,"width",void 0),m([b()],Ze.prototype,"height",void 0),m([b({readOnly:!0})],Ze.prototype,"resizing",void 0),m([b({value:null,readOnly:!0})],Ze.prototype,"size",null),m([b({readOnly:!0})],Ze.prototype,"suspended",void 0),m([b({readOnly:!0})],Ze.prototype,"viewEvents",void 0),m([b({readOnly:!0})],Ze.prototype,"persistableViewModels",void 0),m([b()],Ze.prototype,"_isValid",void 0),m([b()],Ze.prototype,"_readyCycleForced",void 0),m([b()],Ze.prototype,"_lockedSpatialReference",void 0),m([b()],Ze.prototype,"_userTimeZone",void 0),m([b()],Ze.prototype,"_lockedTimeZone",void 0),m([b({type:YL})],Ze.prototype,"theme",void 0),m([b({readOnly:!0,type:YL})],Ze.prototype,"effectiveTheme",null),Ze=W_=m([G("esri.views.View")],Ze);const iMe=Ze;function rMe(t){return t.layerViews}function Nt(){return[0,0]}function nMe(t){return[t[0],t[1]]}function Vp(t,e){return[t,e]}function sMe(t,e=Nt()){const i=Math.min(2,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function oMe(t,e){return new Float64Array(t,e,2)}function Die(){return Nt()}function jie(){return Vp(1,1)}function Vie(){return Vp(1,0)}function zie(){return Vp(0,1)}const Uie=Die(),aMe=jie(),lMe=Vie(),Gie=zie();Object.freeze(Object.defineProperty({__proto__:null,ONES:aMe,UNIT_X:lMe,UNIT_Y:Gie,ZEROS:Uie,clone:nMe,create:Nt,createView:oMe,fromArray:sMe,fromValues:Vp,ones:jie,unitX:Vie,unitY:zie,zeros:Die},Symbol.toStringTag,{value:"Module"}));let rf=class extends Q5{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=os(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new re("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=ed(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};m([b({readOnly:!0})],rf.prototype,"done",null),m([b({readOnly:!0,type:String})],rf.prototype,"state",void 0),m([b()],rf.prototype,"target",void 0),rf=m([G("esri.views.ViewAnimation")],rf),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(rf||(rf={}));const eO=rf;function jv(t,e){return t[0]=e[0],t[1]=e[1],t}function wn(t,e,i){return t[0]=e,t[1]=i,t}function _R(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function Wr(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function Bie(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function qie(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function uMe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function cMe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function hMe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function pMe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function dMe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function rw(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function Dl(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t}function g0(t,e){const i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}function tc(t,e){const i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}function _b(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function bh(t){const e=t[0],i=t[1];return e*e+i*i}function Hie(t,e){return t[0]=-e[0],t[1]=-e[1],t}function fMe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function tO(t,e){const i=e[0],r=e[1];let n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function od(t,e){return t[0]*e[0]+t[1]*e[1]}function Wie(t,e,i){const r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t}function TM(t,e,i,r){const n=e[0],o=e[1];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t}function yMe(t,e){e=e||1;const i=2*eS()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function mMe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n,t[1]=i[1]*r+i[3]*n,t}function th(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n+i[4],t[1]=i[1]*r+i[3]*n+i[5],t}function gMe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[3]*n+i[6],t[1]=i[1]*r+i[4]*n+i[7],t}function vMe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}function bMe(t,e,i,r){const n=e[0]-i[0],o=e[1]-i[1],u=Math.sin(r),p=Math.cos(r);return t[0]=n*p-o*u+i[0],t[1]=n*u+o*p+i[1],t}function Jie(t,e){const i=t[0],r=t[1],n=e[0],o=e[1];let u=i*i+r*r;u>0&&(u=1/Math.sqrt(u));let p=n*n+o*o;p>0&&(p=1/Math.sqrt(p));const g=(i*n+r*o)*u*p;return g>1?0:g<-1?Math.PI:Math.acos(g)}function wMe(t){return"vec2("+t[0]+", "+t[1]+")"}function iO(t,e){return t[0]===e[0]&&t[1]===e[1]}function _Me(t,e){const i=t[0],r=t[1],n=e[0],o=e[1],u=kr();return Math.abs(i-n)<=u*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-o)<=u*Math.max(1,Math.abs(r),Math.abs(o))}function SMe(t,e,i,r,n){let o=e[0]-i[0],u=e[1]-i[1];const p=(r[0]*o+r[1]*u)*(n-1);return o=r[0]*p,u=r[1]*p,t[0]=e[0]+o,t[1]=e[1]+u,t}const xMe=_b,EM=Wr,$Me=Bie,TMe=qie,EMe=g0,IMe=tc,MMe=bh;Object.freeze(Object.defineProperty({__proto__:null,add:_R,angle:Jie,ceil:uMe,copy:jv,cross:Wie,dist:EMe,distance:g0,div:TMe,divide:qie,dot:od,equals:_Me,exactEquals:iO,floor:cMe,inverse:fMe,len:xMe,length:_b,lerp:TM,max:pMe,min:hMe,mul:$Me,multiply:Bie,negate:Hie,normalize:tO,projectAndScale:SMe,random:yMe,rotate:bMe,round:dMe,scale:rw,scaleAndAdd:Dl,set:wn,sqrDist:IMe,sqrLen:MMe,squaredDistance:tc,squaredLength:bh,str:wMe,sub:EM,subtract:Wr,transformMat2:mMe,transformMat2d:th,transformMat3:gMe,transformMat4:vMe},Symbol.toStringTag,{value:"Module"}));function kMe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function IM(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function CMe(t,e,i,r,n,o,u){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=u,t}function SR(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5];let g=i*o-r*n;return g?(g=1/g,t[0]=o*g,t[1]=-r*g,t[2]=-n*g,t[3]=i*g,t[4]=(n*p-o*u)*g,t[5]=(r*u-i*p)*g,t):null}function AMe(t){return t[0]*t[3]-t[1]*t[2]}function Hy(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=i[0],S=i[1],T=i[2],E=i[3],C=i[4],L=i[5];return t[0]=r*w+o*S,t[1]=n*w+u*S,t[2]=r*T+o*E,t[3]=n*T+u*E,t[4]=r*C+o*L+p,t[5]=n*C+u*L+g,t}function ES(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=Math.sin(i),S=Math.cos(i);return t[0]=r*S+o*w,t[1]=n*S+u*w,t[2]=r*-w+o*S,t[3]=n*-w+u*S,t[4]=p,t[5]=g,t}function MM(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=i[0],S=i[1];return t[0]=r*w,t[1]=n*w,t[2]=o*S,t[3]=u*S,t[4]=p,t[5]=g,t}function Sb(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=i[0],S=i[1];return t[0]=r,t[1]=n,t[2]=o,t[3]=u,t[4]=r*w+o*S+p,t[5]=n*w+u*S+g,t}function Zie(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t[4]=0,t[5]=0,t}function Kie(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function xR(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function LMe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function OMe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function PMe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function Yie(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function RMe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function FMe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t}function NMe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function DMe(t,e){const i=t[0],r=t[1],n=t[2],o=t[3],u=t[4],p=t[5],g=e[0],w=e[1],S=e[2],T=e[3],E=e[4],C=e[5],L=kr();return Math.abs(i-g)<=L*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(r-w)<=L*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(n-S)<=L*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(o-T)<=L*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(u-E)<=L*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(p-C)<=L*Math.max(1,Math.abs(p),Math.abs(C))}const jMe=Hy,VMe=Yie;Object.freeze(Object.defineProperty({__proto__:null,add:PMe,copy:kMe,determinant:AMe,equals:DMe,exactEquals:NMe,frob:OMe,fromRotation:Zie,fromScaling:Kie,fromTranslation:xR,identity:IM,invert:SR,mul:jMe,multiply:Hy,multiplyScalar:RMe,multiplyScalarAndAdd:FMe,rotate:ES,scale:MM,set:CMe,str:LMe,sub:VMe,subtract:Yie,translate:Sb},Symbol.toStringTag,{value:"Module"}));function zp(){return[1,0,0,1,0,0]}function zMe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function UMe(t,e,i,r,n,o){return[t,e,i,r,n,o]}function GMe(t,e){return new Float64Array(t,e,6)}const BMe=zp();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:BMe,clone:zMe,create:zp,createView:GMe,fromValues:UMe},Symbol.toStringTag,{value:"Module"}));const Xx={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Bn({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ge.WebMercator}),minus180Line:new Bn({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ge.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Bn({paths:[[[180,-180],[180,180]]],spatialReference:Ge.WGS84}),minus180Line:new Bn({paths:[[[-180,-180],[-180,180]]],spatialReference:Ge.WGS84})}};function sm(t,e){return Math.ceil((t-e)/(2*e))}function Xie(t,e){const i=G2(t);for(const r of i)for(const n of r)n[0]+=e;return t}function G2(t){return xv(t)?t.rings:t.paths}async function qMe(t,e,i,r){const n=Du(t),o=e[0].spatialReference,u={...r,responseType:"json",query:{...n.query,f:"json",sr:nE(o),target:JSON.stringify({geometryType:rS(e[0]),geometries:e}),cutter:JSON.stringify(i)}},p=await nt(n.path+"/cut",u),{cutIndexes:g,geometries:w=[]}=p.data;return{cutIndexes:g,geometries:w.map(S=>{const T=dh(S);return T.spatialReference=o,T})}}async function HMe(t,e,i){const r=typeof t=="string"?Zr(t):t,n=e[0].spatialReference,o=rS(e[0]),u={...i,query:{...r.query,f:"json",sr:nE(n),geometries:JSON.stringify(f5e(e))}},{data:p}=await nt(r.path+"/simplify",u);return Wte(p.geometries,o,n)}const Qie=()=>fe.getLogger("esri.geometry.support.normalizeUtils");function WMe(t){return t.type==="polygon"}function JMe(t){return t[0].type==="polygon"}function ZMe(t){return t[0].type==="polyline"}function Jz(t){const e=[];let i=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];let u=null;for(let p=0;p<o.length;p++)u=o[p],e.push(u),p===0?(i=u[0],r=i):(i=Math.min(i,u[0]),r=Math.max(r,u[0]));u&&e.push([(i+r)/2,0])}return e}function ere(t,e){if(!(t instanceof Bn||t instanceof xo)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw Qie().error(n),new re(n)}const i=G2(t),r=[];for(const n of i){const o=[];r.push(o),o.push([n[0][0],n[0][1]]);for(let u=0;u<n.length-1;u++){const p=n[u][0],g=n[u][1],w=n[u+1][0],S=n[u+1][1],T=Math.sqrt((w-p)*(w-p)+(S-g)*(S-g)),E=(S-g)/T,C=(w-p)/T,L=T/e;if(L>1){for(let U=1;U<=L-1;U++){const W=U*e,H=C*W+p,J=E*W+g;o.push([H,J])}const R=(T+Math.floor(L-1)*e)/2,F=C*R+p,V=E*R+g;o.push([F,V])}o.push([w,S])}}return WMe(t)?new xo({rings:r,spatialReference:t.spatialReference}):new Bn({paths:r,spatialReference:t.spatialReference})}function Zz(t,e,i){if(e){const r=ere(t,1e6);t=em(r,!0)}return i&&(t=Xie(t,i)),t}function Kz(t,e,i){if(Array.isArray(t)){const r=t[0];if(r>e){const n=sm(r,e);t[0]=r+n*(-2*e)}else if(r<i){const n=sm(r,i);t[0]=r+n*(-2*i)}}else{const r=t.x;if(r>e){const n=sm(r,e);t=t.clone().offset(n*(-2*e),0)}else if(r<i){const n=sm(r,i);t=t.clone().offset(n*(-2*i),0)}}return t}function KMe(t,e){let i=-1;for(let r=0;r<e.cutIndexes.length;r++){const n=e.cutIndexes[r],o=e.geometries[r],u=G2(o);for(let p=0;p<u.length;p++){const g=u[p];g.some(w=>{if(w[0]<180)return!0;{let S=0;for(let E=0;E<g.length;E++){const C=g[E][0];S=C>S?C:S}S=Number(S.toFixed(9));const T=-360*sm(S,180);for(let E=0;E<g.length;E++){const C=o.getPoint(p,E);o.setPoint(p,E,C.clone().offset(T,0))}return!0}})}if(n===i){if(JMe(t))for(const p of G2(o))t[n]=t[n].addRing(p);else if(ZMe(t))for(const p of G2(o))t[n]=t[n].addPath(p)}else i=n,t[n]=o}return t}async function tre(t,e,i){if(!Array.isArray(t))return tre([t],e);e&&typeof e!="string"&&Qie().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:(e==null?void 0:e.url)??Ct.geometryServiceUrl;let n,o,u,p,g,w,S,T,E=0;const C=[],L=[];for(const H of t)if(H!=null)if(n||(n=H.spatialReference,o=_s(n),u=n.isWebMercator,w=u?102100:4326,p=Xx[w].maxX,g=Xx[w].minX,S=Xx[w].plus180Line,T=Xx[w].minus180Line),o)if(H.type==="mesh")L.push(H);else if(H.type==="point")L.push(Kz(H.clone(),p,g));else if(H.type==="multipoint"){const J=H.clone();J.points=J.points.map(X=>Kz(X,p,g)),L.push(J)}else if(H.type==="extent"){const J=H.clone()._normalize(!1,!1,o);L.push(J.rings?new xo(J):J)}else if(H.extent){const J=H.extent,X=sm(J.xmin,g)*(2*p);let te=X===0?H.clone():Xie(H.clone(),X);J.offset(X,0);let{xmin:oe,xmax:pe}=J;oe=Number(oe.toFixed(9)),pe=Number(pe.toFixed(9)),J.intersects(S)&&pe!==p?(E=pe>E?pe:E,te=Zz(te,u),C.push(te),L.push("cut")):J.intersects(T)&&oe!==g?(E=pe*(2*p)>E?pe*(2*p):E,te=Zz(te,u,360),C.push(te),L.push("cut")):L.push(te)}else L.push(H.clone());else L.push(H);else L.push(H);let R=sm(E,p),F=-90;const V=R,U=new Bn;for(;R>0;){const H=360*R-180;U.addPath([[H,F],[H,-1*F]]),F*=-1,R--}if(C.length>0&&V>0){const H=KMe(C,await qMe(r,C,U,i)),J=[],X=[];for(let pe=0;pe<L.length;pe++){const de=L[pe];if(de!=="cut")X.push(de);else{const ge=H.shift(),we=t[pe];we!=null&&we.type==="polygon"&&we.rings&&we.rings.length>1&&ge.rings.length>=we.rings.length?(J.push(ge),X.push("simplify")):X.push(u?Dp(ge):ge)}}if(!J.length)return X;const te=await HMe(r,J,i),oe=[];for(let pe=0;pe<X.length;pe++){const de=X[pe];de!=="simplify"?oe.push(de):oe.push(u?Dp(te.shift()):te.shift())}return oe}const W=[];for(let H=0;H<L.length;H++){const J=L[H];if(J!=="cut")W.push(J);else{const X=C.shift();W.push(u===!0?Dp(X):X)}}return W}function YMe(t){if(!t)return null;const e=t.extent;if(!e)return null;const i=t.spatialReference&&_s(t.spatialReference);if(!i)return e;const[r,n]=i.valid,o=2*n,{width:u}=e;let p,{xmin:g,xmax:w}=e;if([g,w]=[w,g],t.type==="extent"||u===0||u<=n||u>o||g<r||w>n)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;p=Jz(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;p=Jz(t.paths);break;case"multipoint":p=t.points}const S=e.clone();for(let T=0;T<p.length;T++){let E=p[T][0];E<0?(E+=n,w=Math.max(E,w)):(E-=n,g=Math.min(E,g))}return S.xmin=g,S.xmax=w,S.width<u?(S.xmin-=n,S.xmax-=n,S):e}function $R(t,e,i){const r=_s(i);if(r==null)return t;const[n,o]=r.valid,u=2*o;let p=0,g=0;e>o?p=Math.ceil(Math.abs(e-o)/u):e<n&&(p=-Math.ceil(Math.abs(e-n)/u)),t>o?g=Math.ceil(Math.abs(t-o)/u):t<n&&(g=-Math.ceil(Math.abs(t-n)/u));let w=t+(p-g)*u;const S=w-e;return S>o?w-=u:S<n&&(w+=u),w}function KXe(t,e){const i=_s(e);if(i){const[r,n]=i.valid,o=n-r;if(t<r)for(;t<r;)t+=o;if(t>n)for(;t>n;)t-=o}return t}const ire=96,rre=39.37,XMe=180/Math.PI;function nre(t){return t.wkid?t:t.spatialReference||Ge.WGS84}function TR(t,e){return e.type?wn(t,e.x,e.y):jv(t,e)}function sre(t){return hr(t)}function kM(t,e,i=0){let r=t.width,n=t.height;if(i!==0){const p=tS(i),g=Math.abs(Math.cos(p)),w=Math.abs(Math.sin(p));r=t.width*g+t.height*w,n=t.width*w+t.height*g}const o=Math.max(1,e[0]),u=Math.max(1,e[1]);return Math.max(r/o,n/u)*s9e(t.spatialReference)}async function J_(t,e,i,r){var p,g;let n,o;if(!t||Array.isArray(t)&&!t.length)return null;if(Ie.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const w=t.every(E=>"attributes"in E),S=t.some(E=>!E.geometry);let T=t;if(w&&S&&e&&e.allLayerViews){const E=new Map;for(const F of t){const V=F.layer,U=E.get(V)||[],W=F.attributes[V.objectIdField];W!=null&&U.push(W),E.set(V,U)}const C=[];E.forEach((F,V)=>{const U=e.allLayerViews.find(W=>W.layer.id===V.id);if(U&&"queryFeatures"in U){const W=V.createQuery();W.objectIds=F,W.returnGeometry=!0,C.push(U.queryFeatures(W))}});const L=await Promise.all(C),R=[];for(const F of L)if(F&&F.features&&F.features.length)for(const V of F.features)V.geometry!=null&&R.push(V.geometry);T=R}for(const E of T)r=await J_(E,e,i,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new Ke(t);else if(t instanceof td)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){const w=t.layer,S=e.allLayerViews.find(T=>T.layer.id===w.id);if(S&&"queryFeatures"in S){const T=w.createQuery();T.objectIds=[t.attributes[w.objectIdField]],T.returnGeometry=!0;const E=await S.queryFeatures(T);n=(g=(p=E==null?void 0:E.features)==null?void 0:p[0])==null?void 0:g.geometry}}}if(n==null)return null;switch(n.type){case"point":o=new jt({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":o=YMe(n);break;default:o=n.extent}if(!o)return null;Eh()||Ba(o.spatialReference,i)||await gh();const u=Ts(o,i);if(!u)return null;if(r){const w=u.center,S=w.clone();S.x=$R(w.x,r.center.x,i),S.x!==w.x&&u.centerAt(S),r=r.union(u)}else r=u;return r}function QMe(t){var e;if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&((e=t.layer)==null?void 0:e.minScale)!=null&&t.layer.maxScale!=null){const i=t.layer;return{min:i.minScale,max:i.maxScale}}if(Array.isArray(t)&&t.length&&t.every(i=>"layer"in i)){let i=0,r=0;for(const n of t){const o=n.layer;o!=null&&o.minScale&&o.maxScale&&(i=o.minScale<i?o.minScale:i,r=o.maxScale>r?o.maxScale:r)}return i&&r?{min:i,max:r}:null}}}function Yz(t,e){return Ki(nre(t),e)?t:Ts(t,e)}async function e9e(t,e){var F;if(!t||!e)return new Mn({targetGeometry:new Ke,scale:0,rotation:0});let i=e.spatialReference;const{constraints:r,padding:n,viewpoint:o,size:u}=e,p=[n?u[0]-n.left-n.right:u[0],n?u[1]-n.top-n.bottom:u[1]];let g=null;t instanceof Mn?g=t:t.viewpoint?g=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(g=t.target);let w=null;g!=null&&g.targetGeometry?w=g.targetGeometry:t instanceof jt?w=t:t instanceof td?w=await J_(t,e,i):t&&(w=await J_(t.center,e,i)||await J_(t.target,e,i)||await J_(t,e,i)),!w&&(o!=null&&o.targetGeometry)?w=o.targetGeometry:!w&&e.extent&&(w=e.extent),i||(i=nre(e.spatialReference||e.extent||w)),Eh()||Ki(w.spatialReference,i)||Ba(w.spatialReference,i)||await gh();const S=Yz(w,i),T="center"in S?S.center:S;e.pickClosestTarget!==!1&&T.type==="point"&&((F=o.targetGeometry)==null?void 0:F.type)==="point"&&(T.x=$R(T.x,o.targetGeometry.x,T.spatialReference));let E=0;g?E=g.rotation:t.hasOwnProperty("rotation")?E=t.rotation:o&&(E=o.rotation);let C=0;C=(g==null?void 0:g.targetGeometry)!=null&&g.targetGeometry.type==="point"?g.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(t.zoom):Array.isArray(w)||w.type==="point"||w.type==="extent"&&w.width===0&&w.height===0?o.scale:kM(Yz(w.extent,i),p,E);const L=QMe(t.target??t);L&&(L.min&&L.min<C?C=L.min:L.max&&L.max>C&&(C=L.max));let R=new Mn({targetGeometry:T,scale:C,rotation:E});return r&&(R=r.fit(R),r.constrainByGeometry(R),r.rotationEnabled||(R.rotation=o.rotation)),R}function Ys(t,e){const i=t.targetGeometry,r=e.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function t9e(t,e,i){return i?wn(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):rw(t,e,.5)}const ore=function(){const t=Nt();return function(e,i,r){const n=i.targetGeometry;TR(t,n);const o=.5*nw(i);return e.xmin=t[0]-o*r[0],e.ymin=t[1]-o*r[1],e.xmax=t[0]+o*r[0],e.ymax=t[1]+o*r[1],e.spatialReference=n.spatialReference,e}}();function i9e(t,e,i,r,n){var o;return rO(t,e,i.center),t.scale=kM(i,r),(o=n==null?void 0:n.constraints)==null||o.constrain(t),t}function r9e(t,e,i,r){return MR(t,e,i,r),SR(t,t)}const are=function(){const t=Nt();return function(e,i,r){return EM(e,o9e(e,i),t9e(t,i,r))}}(),n9e=function(){const t=zp(),e=Nt();return function(i,r,n,o){const u=nw(r),p=ER(r);return wn(e,u,u),Kie(t,e),ES(t,t,p),Sb(t,t,are(e,n,o)),Sb(t,t,[0,o.top-o.bottom]),wn(i,t[4],t[5])}}();function nw(t){var e;return t.scale*lre((e=t.targetGeometry)==null?void 0:e.spatialReference)}function lre(t){return t!=null&&Jo(t)?1/(sre(t)*rre*ire):1}function ER(t){return EP(t.rotation)||0}function s9e(t){return Jo(t)?sre(t)*rre*ire:1}function o9e(t,e){return rw(t,e,.5)}const IR=function(){const t=Nt(),e=Nt(),i=Nt();return function(r,n,o,u,p,g){return Hie(t,n),rw(e,o,.5*g),wn(i,1/u*g,-1/u*g),xR(r,e),p&&ES(r,r,p),MM(r,r,i),Sb(r,r,t),r}}(),MR=function(){const t=Nt();return function(e,i,r,n){const o=nw(i),u=ER(i);return TR(t,i.targetGeometry),IR(e,t,r,o,u,n)}}(),a9e=function(){const t=Nt();return function(e,i,r,n){const o=nw(i);return TR(t,i.targetGeometry),IR(e,t,r,o,0,n)}}();function ure(t){const e=_s(t);return e?e.valid[1]-e.valid[0]:0}function l9e(t,e){return Math.round(ure(t)/e)}const u9e=function(){const t=Nt(),e=Nt(),i=[0,0,0];return function(r,n,o){Wr(t,r,n),tO(t,t),Wr(e,r,o),tO(e,e),Wie(i,t,e);let u=Math.acos(od(t,e)/(_b(t)*_b(e)))*XMe;return i[2]<0&&(u=-u),isNaN(u)&&(u=0),u}}(),c9e=function(){const t=Nt();return function(e,i,r,n){const o=e.targetGeometry;return Ys(e,i),n9e(t,i,r,n),o.x+=t[0],o.y+=t[1],e}}(),rO=function(t,e,i){Ys(t,e);const r=t.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t},h9e=function(){const t=Nt();return function(e,i,r,n,o){o||(o="center"),EM(t,r,n),rw(t,t,.5);const u=t[0],p=t[1];switch(o){case"center":wn(t,0,0);break;case"left":wn(t,-u,0);break;case"top":wn(t,0,p);break;case"right":wn(t,u,0);break;case"bottom":wn(t,0,-p);break;case"top-left":wn(t,-u,p);break;case"bottom-left":wn(t,-u,-p);break;case"top-right":wn(t,u,p);break;case"bottom-right":wn(t,u,-p)}return CM(e,i,t),e}}();function YXe(t,e,i){return Ys(t,e),t.rotation+=i,t}function p9e(t,e,i){return Ys(t,e),t.rotation=i,t}const d9e=function(){const t=Nt();return function(e,i,r,n,o){return Ys(e,i),isNaN(r)||r===0||(hre(t,n,i,o),e.scale=i.scale*r,pre(t,t,e,o),CM(e,e,wn(t,t[0]-n[0],n[1]-t[1]))),e}}();function Xz(t,e,i){return Ys(t,e),t.scale=i,t}const cre=function(){const t=Nt();return function(e,i,r,n,o,u){return Ys(e,i),isNaN(r)||r===0||(hre(t,o,i,u),e.scale=i.scale*r,e.rotation+=n,pre(t,t,e,u),CM(e,e,wn(t,t[0]-o[0],o[1]-t[1]))),e}}(),XXe=function(){const t=Nt(),e=Nt();return function(i,r,n,o,u,p,g){return are(e,p,g),_R(t,u,e),o?cre(i,r,n,o,t,p):d9e(i,r,n,t,p)}}(),hre=function(){const t=zp();return function(e,i,r,n){return th(e,i,r9e(t,r,n,1))}}(),pre=function(){const t=zp();return function(e,i,r,n){return th(e,i,MR(t,r,n,1))}}(),CM=function(){const t=Nt(),e=zp();return function(i,r,n){Ys(i,r);const o=nw(r),u=i.targetGeometry;return Zie(e,ER(r)),MM(e,e,Vp(o,o)),th(t,n,e),u.x+=t[0],u.y+=t[1],i}}();function RE(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function f9e(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function y9e(t,e,i,r,n,o){const u=new Float32Array(6);return u[0]=t,u[1]=e,u[2]=i,u[3]=r,u[4]=n,u[5]=o,u}function m9e(t,e){return new Float32Array(t,e,6)}function dre(t,e,i,r){const n=e[r],o=e[r+1];t[r]=i[0]*n+i[2]*o+i[4],t[r+1]=i[1]*n+i[3]*o+i[5]}function g9e(t,e,i,r=0,n=0,o=2){const u=n||e.length/o;for(let p=r;p<u;p++)dre(t,e,i,p*o)}Object.freeze(Object.defineProperty({__proto__:null,clone:f9e,create:RE,createView:m9e,fromValues:y9e,transform:dre,transformMany:g9e},Symbol.toStringTag,{value:"Module"}));function v9e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function b9e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function fre(t,e,i,r,n,o,u,p,g,w){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=u,t[6]=p,t[7]=g,t[8]=w,t}function yre(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function w9e(t,e){if(t===e){const i=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function _9e(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5],g=e[6],w=e[7],S=e[8],T=S*u-p*w,E=-S*o+p*g,C=w*o-u*g;let L=i*T+r*E+n*C;return L?(L=1/L,t[0]=T*L,t[1]=(-S*r+n*w)*L,t[2]=(p*r-n*u)*L,t[3]=E*L,t[4]=(S*i-n*g)*L,t[5]=(-p*i+n*o)*L,t[6]=C*L,t[7]=(-w*i+r*g)*L,t[8]=(u*i-r*o)*L,t):null}function S9e(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5],g=e[6],w=e[7],S=e[8];return t[0]=u*S-p*w,t[1]=n*w-r*S,t[2]=r*p-n*u,t[3]=p*g-o*S,t[4]=i*S-n*g,t[5]=n*o-i*p,t[6]=o*w-u*g,t[7]=r*g-i*w,t[8]=i*u-r*o,t}function x9e(t){const e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],u=t[5],p=t[6],g=t[7],w=t[8];return e*(w*o-u*g)+i*(-w*n+u*p)+r*(g*n-o*p)}function kR(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=e[6],S=e[7],T=e[8],E=i[0],C=i[1],L=i[2],R=i[3],F=i[4],V=i[5],U=i[6],W=i[7],H=i[8];return t[0]=E*r+C*u+L*w,t[1]=E*n+C*p+L*S,t[2]=E*o+C*g+L*T,t[3]=R*r+F*u+V*w,t[4]=R*n+F*p+V*S,t[5]=R*o+F*g+V*T,t[6]=U*r+W*u+H*w,t[7]=U*n+W*p+H*S,t[8]=U*o+W*g+H*T,t}function nO(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=e[6],S=e[7],T=e[8],E=i[0],C=i[1];return t[0]=r,t[1]=n,t[2]=o,t[3]=u,t[4]=p,t[5]=g,t[6]=E*r+C*u+w,t[7]=E*n+C*p+S,t[8]=E*o+C*g+T,t}function mre(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=e[4],g=e[5],w=e[6],S=e[7],T=e[8],E=Math.sin(i),C=Math.cos(i);return t[0]=C*r+E*u,t[1]=C*n+E*p,t[2]=C*o+E*g,t[3]=C*u-E*r,t[4]=C*p-E*n,t[5]=C*g-E*o,t[6]=w,t[7]=S,t[8]=T,t}function gre(t,e,i){const r=i[0],n=i[1],o=i[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=o*e[6],t[7]=o*e[7],t[8]=o*e[8],t}function $9e(t,e,i){const r=i[0],n=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function T9e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function E9e(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function I9e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function M9e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function FE(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=i+i,p=r+r,g=n+n,w=i*u,S=r*u,T=r*p,E=n*u,C=n*p,L=n*g,R=o*u,F=o*p,V=o*g;return t[0]=1-T-L,t[3]=S-V,t[6]=E+F,t[1]=S+V,t[4]=1-w-L,t[7]=C-R,t[2]=E-F,t[5]=C+R,t[8]=1-w-T,t}function vre(t,e){const i=e[0],r=e[1],n=e[2],o=e[4],u=e[5],p=e[6],g=e[8],w=e[9],S=e[10],T=S*u-p*w,E=-S*o+p*g,C=w*o-u*g,L=i*T+r*E+n*C;if(!L)return null;const R=1/L;return t[0]=T*R,t[1]=(-S*r+n*w)*R,t[2]=(p*r-n*u)*R,t[3]=E*R,t[4]=(S*i-n*g)*R,t[5]=(-p*i+n*o)*R,t[6]=C*R,t[7]=(-w*i+r*g)*R,t[8]=(u*i-r*o)*R,t}function k9e(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=e[4],p=e[5],g=e[6],w=e[7],S=e[8],T=e[9],E=e[10],C=e[11],L=e[12],R=e[13],F=e[14],V=e[15],U=i*p-r*u,W=i*g-n*u,H=i*w-o*u,J=r*g-n*p,X=r*w-o*p,te=n*w-o*g,oe=S*R-T*L,pe=S*F-E*L,de=S*V-C*L,ge=T*F-E*R,we=T*V-C*R,ke=E*V-C*F;let $e=U*ke-W*we+H*ge+J*de-X*pe+te*oe;return $e?($e=1/$e,t[0]=(p*ke-g*we+w*ge)*$e,t[1]=(g*de-u*ke-w*pe)*$e,t[2]=(u*we-p*de+w*oe)*$e,t[3]=(n*we-r*ke-o*ge)*$e,t[4]=(i*ke-n*de+o*pe)*$e,t[5]=(r*de-i*we-o*oe)*$e,t[6]=(R*te-F*X+V*J)*$e,t[7]=(F*H-L*te-V*W)*$e,t[8]=(L*X-R*H+V*U)*$e,t):null}function C9e(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function A9e(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function L9e(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function O9e(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function bre(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function P9e(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function R9e(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t}function F9e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function N9e(t,e){const i=t[0],r=t[1],n=t[2],o=t[3],u=t[4],p=t[5],g=t[6],w=t[7],S=t[8],T=e[0],E=e[1],C=e[2],L=e[3],R=e[4],F=e[5],V=e[6],U=e[7],W=e[8],H=kr();return Math.abs(i-T)<=H*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(r-E)<=H*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(n-C)<=H*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(o-L)<=H*Math.max(1,Math.abs(o),Math.abs(L))&&Math.abs(u-R)<=H*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(p-F)<=H*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(g-V)<=H*Math.max(1,Math.abs(g),Math.abs(V))&&Math.abs(w-U)<=H*Math.max(1,Math.abs(w),Math.abs(U))&&Math.abs(S-W)<=H*Math.max(1,Math.abs(S),Math.abs(W))}function D9e(t){const e=kr(),i=t[0],r=t[1],n=t[2],o=t[3],u=t[4],p=t[5],g=t[6],w=t[7],S=t[8];return Math.abs(1-(i*i+o*o+g*g))<=e&&Math.abs(1-(r*r+u*u+w*w))<=e&&Math.abs(1-(n*n+p*p+S*S))<=e}const j9e=kR,V9e=bre;Object.freeze(Object.defineProperty({__proto__:null,add:O9e,adjoint:S9e,copy:b9e,determinant:x9e,equals:N9e,exactEquals:F9e,frob:L9e,fromMat2d:M9e,fromMat4:v9e,fromQuat:FE,fromRotation:E9e,fromScaling:I9e,fromTranslation:T9e,identity:yre,invert:_9e,isOrthoNormal:D9e,mul:j9e,multiply:kR,multiplyScalar:P9e,multiplyScalarAndAdd:R9e,normalFromMat4:k9e,normalFromMat4Legacy:vre,projection:C9e,rotate:mre,scale:gre,scaleByVec2:$9e,set:fre,str:A9e,sub:V9e,subtract:bre,translate:nO,transpose:w9e},Symbol.toStringTag,{value:"Module"}));function r5(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function z9e(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function U9e(t,e,i,r,n,o,u,p,g){const w=new Float32Array(9);return w[0]=t,w[1]=e,w[2]=i,w[3]=r,w[4]=n,w[5]=o,w[6]=u,w[7]=p,w[8]=g,w}function G9e(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:z9e,create:r5,createView:G9e,fromValues:U9e},Symbol.toStringTag,{value:"Module"}));function wre(){return new Float32Array(2)}function B9e(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function xb(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function q9e(t,e){return new Float32Array(t,e,2)}function _re(){return wre()}function Sre(){return xb(1,1)}function xre(){return xb(1,0)}function $re(){return xb(0,1)}const H9e=_re(),W9e=Sre(),J9e=xre(),Z9e=$re();Object.freeze(Object.defineProperty({__proto__:null,ONES:W9e,UNIT_X:J9e,UNIT_Y:Z9e,ZEROS:H9e,clone:B9e,create:wre,createView:q9e,fromValues:xb,ones:Sre,unitX:xre,unitY:$re,zeros:_re},Symbol.toStringTag,{value:"Module"}));function K9e(t){return t instanceof Float32Array&&t.length>=2}function Y9e(t){return Array.isArray(t)&&t.length>=2}function yk(t){return K9e(t)||Y9e(t)}var sO;const Lh=[0,0];let nf=sO=class extends ye{constructor(t){super(t),this._viewpoint2D={center:Nt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new jt,this.id=0,this.inverseTransform=zp(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=zp(),this.transformNoRotation=zp(),this.displayMat3=r5(),this.displayViewMat3=r5(),this.viewMat3=r5(),this.viewMat2d=RE(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Ys(i,t.viewpoint),this._set("size",jv(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new sO({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return yk(e)?th(t,e,this.inverseTransform):(Lh[0]=e,Lh[1]=i,th(t,Lh,this.inverseTransform))}toScreen(t,e,i){return yk(e)?th(t,e,this.transform):(Lh[0]=e,Lh[1]=i,th(t,Lh,this.transform))}toScreenNoRotation(t,e,i){return yk(e)?th(t,e,this.transformNoRotation):(Lh[0]=e,Lh[1]=i,th(t,Lh,this.transformNoRotation))}wrapMapCoordinate(t,e){jv(t,e);const[i]=e,[r]=this.center,{extent:n,spatialReference:o}=this;let{xmin:u,xmax:p}=n;if(o.isWrappable){const g=ure(o)/2;u=Math.max(u,r-g),p=Math.min(p,r+g)}return(i<u||i>p)&&(t[0]=$R(i,r,o)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return IR(t,i,n,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size"),u=new Mn({targetGeometry:new Ke(t[0],t[1],e),scale:i,rotation:r});if(this._set("viewpoint",u),!o||!e||!i)return;this.resolution=nw(u),this.rotation=r,this.scale=i,this.spatialReference=e,jv(this.center,t);const p=o[0]!==0?2/o[0]:0,g=o[1]!==0?-2/o[1]:0;fre(this.displayMat3,p,0,0,0,g,0,-1,1,1);const w=yre(this.viewMat3),S=xb(o[0]/2,o[1]/2),T=xb(-o[0]/2,-o[1]/2),E=EP(r);nO(w,w,S),mre(w,w,E),nO(w,w,T),kR(this.displayViewMat3,this.displayMat3,w);const C=xR(this.viewMat2d,S);return ES(C,C,E),Sb(C,C,T),ore(this.extent,u,o),MR(this.transform,u,o,n),SR(this.inverseTransform,this.transform),a9e(this.transformNoRotation,u,o,n),this.worldScreenWidth=l9e(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};m([b({readOnly:!0})],nf.prototype,"id",void 0),m([b({value:1,json:{write:!0}})],nf.prototype,"pixelRatio",null),m([b({json:{write:!0}})],nf.prototype,"size",null),m([b()],nf.prototype,"spatialReference",void 0),m([b({type:Mn,json:{write:!0}})],nf.prototype,"viewpoint",null),nf=sO=m([G("esri.views.2d.ViewState")],nf);const Qz=nf;var oO,aO;let Cp=oO=class extends Te{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new oO({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};m([b()],Cp.prototype,"left",void 0),m([b()],Cp.prototype,"top",void 0),m([b()],Cp.prototype,"right",void 0),m([b()],Cp.prototype,"bottom",void 0),Cp=oO=m([G("esri.views.2d.PaddedViewState.Padding")],Cp);let P1=aO=class extends Qz{constructor(...t){super(...t),this.paddedViewState=new Qz,this._updateContent=(()=>{const e=Nt();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const n=this.paddedViewState;wn(e,r.left+r.right,r.top+r.bottom),Wr(e,i,e),jv(n.size,e);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(ce(()=>[this.size,this.padding],()=>this._updateContent(),$s)),this.padding=new Cp,this.size=[0,0]}set padding(t){this._set("padding",t||new Cp)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;const e=this._viewpoint2D;if(this._get("padding")){const i=t.clone();c9e(i,t,this._get("size"),this._get("padding"));const r=i.targetGeometry;e.center[0]=r.x,e.center[1]=r.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=r.spatialReference}else{const i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}}clone(){return new aO({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};m([b()],P1.prototype,"paddedViewState",void 0),m([b({type:Cp})],P1.prototype,"padding",null),m([b()],P1.prototype,"viewpoint",null),P1=aO=m([G("esri.views.2d.PaddedViewState")],P1);const CR=P1;function Wy(t,e,i,r){const n=3*t,o=3*(i-t)-n,u=1-n-o,p=3*e,g=3*(r-e)-p,w=1-p-g;function S(L){return((u*L+o)*L+n)*L}function T(L){return((w*L+g)*L+p)*L}function E(L){return(3*u*L+2*o)*L+n}function C(L,R){let F,V,U,W,H,J;for(U=L,J=0;J<8;J++){if(W=S(U)-L,Math.abs(W)<R)return U;if(H=E(U),Math.abs(H)<1e-6)break;U-=W/H}if(F=0,V=1,U=L,U<F)return F;if(U>V)return V;for(;F<V;){if(W=S(U),Math.abs(W-L)<R)return U;L>W?F=U:V=U,U=.5*(V-F)+F}return U}return function(L,R=1e-6){return T(C(L,R))}}const X9e=/^cubic-bezier\((.*)\)/,Zc={};function Q9e(t){let e=Zc[t]||null;if(!e){const i=X9e.exec(t);if(i){const r=i[1].split(",").map(n=>parseFloat(n.trim()));r.length!==4||r.some(n=>isNaN(n))||(e=Wy.apply(Wy,r))}}return e}Zc.ease=Wy(.25,.1,.25,1),Zc.linear=Wy(0,0,1,1),Zc.easeIn=Zc["ease-in"]=Wy(.42,0,1,1),Zc.easeOut=Zc["ease-out"]=Wy(0,0,.58,1),Zc.easeInOut=Zc["ease-in-out"]=Wy(.42,0,.58,1);let eU=class{constructor(e){this._view=e,this.viewpoint=new Mn({targetGeometry:new Ke,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,i]=this._view.size;return Math.sqrt(e*e+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return lre(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotateAtZoom(e){return this.size/2}compareTo(e,i){i.pan=hZ(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,i.rotate=tS(r),i.sourceZoom=this.scale,i.targetZoom=e.scale}interpolate(e,i,r){const{pan:n,rotate:o,zoom:u,zoomOffset:p}=r,{center:g}=this;g.spatialReference=e.center.spatialReference,g.x=Pf(e.center.x,i.center.x,n),g.y=Pf(e.center.y,i.center.y,n),this.viewpoint.scale=Pf(e.scale,i.scale+p,u);let w=e.rotation;const S=i.rotation;Math.abs(S-w)>=180&&(w+=360*(w<S?1:-1)),this.viewpoint.rotation=Pf(w,S,o)}copyFrom(e){Ys(this.viewpoint,e.viewpoint),this._view=e.view}};const Tre=t=>t*t,eke=t=>1-Tre(1-t),tke=t=>2**(10*(t-1)),ike=t=>1-tke(1-t);function rke(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return r=>r<i?t*r*r:e*r-e+1}function nke(t,e){return(i,r)=>i<e?e*t(i/e,r):1-t((1-i)/(1-e),r)*(1-e)}const tU=nke(rke(1),.5);let ske=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const k3={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},Ere={...k3,maxDuration:4e3};let oke=class Ire{constructor(e){this._createCamera=e,this.compared=new ske,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:k3.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Ire(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,r){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow!=null?r.desiredScreenFlow:k3.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>kr()}get hasFov(){return Math.abs(this.compared.fov)>kr()}get hasRotate(){return this.compared.rotate>kr()}},ake=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},lke=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,i)=>e+i.time,0)}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,n=0;const o=this.definition,u=this.segments.reduce((p,g)=>p||g.definition.hasZoom,!1);for(let p=0;p<this.segments.length;p++){const g=this.segments[p],w=g.definition;if(e<=g.time||p===this.segments.length-1){if(this.segmentInterpolateComponentsAt(g,g.time===0?0:e/g.time,i),o.hasPan&&!isNaN(i.pan)&&isFinite(o.compared.pan)?i.pan=(r+w.compared.pan*i.pan)/o.compared.pan:i.pan=1,o.hasRotate&&!isNaN(i.rotate)&&isFinite(o.compared.rotate)?i.rotate=(n+w.compared.rotate*i.rotate)/o.compared.rotate:i.rotate=1,u&&!isNaN(i.zoom)&&isFinite(w.compared.targetZoom)){const{sourceZoom:S,targetZoom:T}=w.compared,E=i.zoom*(T-S)+S,C=this.segments[0].definition.compared.sourceZoom,L=this.segments[this.segments.length-1].definition.compared.targetZoom,R=Math.abs(T-C)>Math.abs(S-C)?T:S;i.zoomOffset=R-L,i.zoom=(E-C)/(R-C)}else i.zoom=1;return i}e-=g.time,r+=w.compared.pan,n+=w.compared.rotate}}segmentInterpolateComponentsAt(e,i,r){e.interpolateComponentsAt(i,r)}},mk=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,i=e.compared,r=i.sourceZoom,n=i.targetZoom;this._zoomSign=r>n?1:-1,this._panPixelsAtSource=i.pan*e.source.pixelsPerPanAtZoom(r);const o=(e.source.pixelsPerRotateAtZoom(r)+e.target.pixelsPerRotateAtZoom(n))/2;this._rotatePixels=i.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:r,hasPan:n,hasRotate:o}=this.definition;let u=0,p=0;r&&(n&&(u=(i/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),o&&(p=this._zoomSign*(Math.log(e/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const g=this.definition.desiredPixelFlow;if(r&&n&&o){const w=u+p+u*p;this._zoomPixelFlow=u*p/w*g,this._panPixelFlow=p/w*g,this._rotatePixelFlow=u/w*g}else if(r&&n){const w=1+u;this._zoomPixelFlow=u/w*g,this._panPixelFlow=1/w*g}else if(r&&o){const w=1+p;this._zoomPixelFlow=p/w*g,this._rotatePixelFlow=1/w*g}else if(n&&o){const w=this._panPixelsAtSource/this._rotatePixels,S=1+w;this._panPixelFlow=w/S*g,this._rotatePixelFlow=1/S*g}else n?this._panPixelFlow=g:r?this._zoomPixelFlow=g:o&&(this._rotatePixelFlow=g);this._time=this.rotateTime??this.zoomTime??this.panTime??this.fovTime??0}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:null}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:null}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/uke:null}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=e*this._panPixelsAtSource;return Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(i*(i/r)**-e-i)/(r-i)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:r}=this.definition;return i+e*(r-i)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*e*this._time)-1))/(i*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),i.zoom=this._interpolateComponentsZoom(e),i.pan=this._interpolateComponentsPan(e),i.rotate=this._interpolateComponentsRotate(e),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(e)}};const uke=tS(90);function cke(t,e,i){const r=e-t.compared.sourceZoom,n=t.halfWindowPanAtZoom(r);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+n)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*n)}function hke(t,e,i){const r=1/e,n=Math.log(t.compared.sourceZoom*r),o=1/t.desiredPixelFlow,u=1/Math.LN2,p=e-t.compared.sourceZoom,g=1/p,w=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(p))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*o*u*g*w-t.halfWindowSize*n*o*u*g+t.halfWindowSize*n*o*u*w/(p*p)}function pke(t,e,i){const r=e-t.compared.sourceZoom,n=1/r,o=1/e,u=Math.log(t.compared.sourceZoom*o),p=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(r))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*o*p+2*n*u+2*o-2*u*p/(r*r)-p/(e*e))/(t.desiredPixelFlow*Math.LN2)}function dke(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function fke(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function yke(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function mke(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function gke(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function vke(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function bke(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function wke(t,e,i){const r=Math.log(e/t.compared.targetZoom),n=1/t.desiredPixelFlow,o=1/Math.LN2,u=-e+t.compared.targetZoom,p=1/u,g=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*r*n*o*p+t.halfWindowSize*r*n*o*g/(u*u)+t.halfWindowSize*n*o*p*g/e}function _ke(t,e,i){const r=e-t.compared.targetZoom,n=1/r,o=1/e,u=Math.log(e/t.compared.targetZoom),p=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*o*p-2*n*u+2*o+2*u*p/(r*r)-p/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Ske(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function xke(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function $ke(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Tke(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,r=e,n=t.halfWindowPanAtZoom(r),o=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*n);return t.compared.sourceZoom<=t.compared.targetZoom?o*(i-n):o*(i+n)}function Eke(t,e){let i=Ike(t,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},n=r.ascensionFactor===0,o=r.descensionFactor===0,u=n?dke:cke,p=n?fke:hke,g=n?yke:pke,w=o?Ske:bke,S=o?xke:wke,T=o?$ke:_ke,E=H=>u(t,H,r)+mke(t,H,r)+w(t,H,r),C=H=>p(t,H,r)+gke(t,H,r)+S(t,H,r),L=H=>g(t,H,r)+vke(t,H,r)+T(t,H,r);let R=E(i);const F=Tke(t);let V;const U=e.maximumIterations||20,W=e.maximumDistance!=null?e.maximumDistance:1/0;for(V=0;V<U;V++){const H=e.desiredSlope??1e-6;let J=C(i);Math.abs(J)>H&&(J+=H);const X=J/L(i);if(isNaN(X)||i>=W&&X<0){if(!isFinite(W))return null;i=W,R=E(i);break}if(i-=X,i<t.compared.sourceZoom||i<t.compared.targetZoom)return null;const te=E(i);if(Math.abs(te-R)/R<=.005)break;R=te}return R>F*(1-.3)||i<t.compared.sourceZoom||i<t.compared.targetZoom?null:i}function Ike(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),r=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return r<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,r):r}let Mke=class extends lke{constructor(e,i){super(),this._preallocSegments=[new mk,new mk,new mk],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,i)}update(e,i){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const r=i!=null&&i.apex?Eke(e,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,i==null?void 0:i.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,r){e.interpolateComponentsAt(i,r),e===this._ascensionSegment?r.zoom=eke(r.zoom):e===this._descensionSegment&&(r.zoom=Tre(r.zoom))}_updateWithApex(e,i){const[r,n,o]=this._preallocSegments,u=(i==null?void 0:i.ascensionFactor)??.5,p=Math.min(1-u,(i==null?void 0:i.ascensionFactor)!=null&&i.descensionFactor!=null?i.descensionFactor:.5),g=1-u-p;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*u,r.definition.compared.rotate=this.definition.compared.rotate*u,r.definition.segmentEnd=u,r.update(),this._ascensionSegment=r,this.segments.push(r),g>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*g,n.definition.compared.rotate=this.definition.compared.rotate*g,n.definition.segmentStart=r.definition.segmentEnd,n.definition.segmentEnd=r.definition.segmentEnd+g,n.update(),this.segments.push(n)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*p,o.definition.compared.rotate=this.definition.compared.rotate*p,o.definition.segmentStart=u+g,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const kke=new ake;let Cke=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=tU,this.definition=new oke(e),this.path=new Mke}update(e,i,r){this.definition.update(e,i,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(Zce(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?tU:ike)}cameraAt(e,i){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,kke);i.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(e){const i=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-i)/(r-i)}_applyTimeSettings(e,i){const r=i.speedFactor!=null?i.speedFactor:1,n=i.minDuration??k3.minDuration/r,o=i.maxDuration??k3.maxDuration/r;return e=i.duration!=null?i.duration:Math.min(Math.max(e/r,n),o)}};const iU=2e3,Ake=64;let Lke=class{constructor(e){this._view=e,this._animation=new Cke(()=>new eU(this._view)),this._current=new eU(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,i,r={}){Ys(this._current.viewpoint,e),Ys(this._source.viewpoint,e),Ys(this._target.viewpoint,i),this._animation.update(this._source,this._target,r)}applyRatio(e,i){this._animation.cameraAt(i,this._current),Ys(e,this._current.viewpoint)}},R1=class extends Te{constructor(e){super(e),this._animation=null,this._destinationViewState=new CR,this.updateFunction=null,this.easing=Zc.ease,this.viewpoint=new Mn({targetGeometry:new Ke,scale:0,rotation:0}),this._updateTask=tb({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Lke(e.view)}destroy(){this._updateTask=Vi(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,i,r){this.stop();const n=this.viewpoint;Ys(n,i);const o=(typeof(r==null?void 0:r.easing)=="string"?Q9e(r.easing):r==null?void 0:r.easing)||this.easing,u=e.target;this._transition.update(this.viewpoint,u,{apex:{maximumDistance:Math.min(Math.min(i.scale,u.scale)*Ake,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r==null?void 0:r.duration,maxDuration:(r==null?void 0:r.animationMode)==="auto"?1/0:(r==null?void 0:r.maxDuration)??Ere.maxDuration,speedFactor:r==null?void 0:r.speedFactor,easing:typeof o=="function"?g=>o(g):void 0}),(r==null?void 0:r.animationMode)==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=u,Oke(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,u,{duration:0}));const p=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(p,p),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const r=new eO({target:e.clone()}),n=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var r,n;const i=this.animation;if(i&&i.state!==eO.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),(r=this.animation)==null||r.update(this.viewpoint);else{const o=performance.now()-this._startTime,u=this._transition.duration,p=u>0?o/u:1,g=p>=1;this._transition.applyRatio(this.viewpoint,p),g&&((n=this.animation)==null||n.finish())}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Oke(t,e,i,r){if((e==null?void 0:e.duration)!=null)return!0;const{time:n,isLinear:o}=t,u=(e==null?void 0:e.speedFactor)||1,p=(e==null?void 0:e.maxDuration)??Ere.maxDuration/u;if(me("esri-goto-debug")&&(console.log("speed factor:",u),console.log("adjusted duration:		",n),console.log("adjusted max duration:	",p),console.log("is linear:",o)),n>p)return me("esri-goto-debug")&&console.warn(`failed "auto" heuristic: animations must be shorter than ${p/1e3}s`),!1;if(o){const w=Nt(),S=Mr(...r.toScreen(w,...i.center)),T=Mr(...i.toScreen(w,...r.center)),E=T!=null&&T.x>-(1.5-.5)*i.size[0]&&T.x<(1.5+.5)*i.size[0]&&T.y>-(1.5-.5)*i.size[1]&&T.y<(1.5+.5)*i.size[1],C=S!=null&&S.x>-(1.5-.5)*r.size[0]&&S.x<(1.5+.5)*r.size[0]&&S.y>-(1.5-.5)*r.size[1]&&S.y<(1.5+.5)*r.size[1];if(me("esri-goto-debug")&&(console.log(`dest is within ${1.5} screens at start view:`,E),console.log(`start is within ${1.5} screens at dest view:`,C)),n>iU/u&&!E&&!C)return me("esri-goto-debug")&&console.warn(`failed "auto" heuristic: linear animations must be...
  - shorter than ${iU/1e3/u}s, or
  - shorter than ${p/1e3}s and the destination is close enough to the starting screen, or
  - shorter than ${p/1e3}s and the start point is close enough to the destination screen`),!1}return!0}m([b()],R1.prototype,"easing",void 0),m([b()],R1.prototype,"view",void 0),m([b()],R1.prototype,"viewpoint",void 0),R1=m([G("esri.views.2d.AnimationManager")],R1);const Pke=R1;let Rke=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation&&!("then"in this.view.animation.target)&&(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=()=>{var u,p;if(this._updateRequested=!1,(u=this.view)==null?void 0:u.destroyed)return;const{allLayerViews:i,graphicsView:r,labelManager:n,state:{id:o}}=this.view;i.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),r!=null&&(r.lastUpdateId!==o&&(r.viewChange(),r.lastUpdateId=o),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((p=this._frameTaskHandle)==null||p.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new CR,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ce(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=tb(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var n;if(!e.attached)return void this.requestUpdate();const i=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0),r!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((n=e.layerViews)==null||n.forEach(this._updateLayerView,this))}},n5=class extends Te{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,i){if(!e)return void fe.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new eO;this.view.animation=r,await vr(()=>this.view.ready,i);const n={...i,animate:(i==null?void 0:i.animate)??!kie(),animationMode:(i==null?void 0:i.animationMode)??"auto"},{extent:o,spatialReference:u,size:p,viewpoint:g,constraints:w,padding:S,allLayerViews:T}=this.view,E=e9e(e,{extent:o,spatialReference:u,size:p,viewpoint:g,constraints:w,padding:S,allLayerViews:T,pickClosestTarget:(i==null?void 0:i.pickClosestTarget)??!0});return r==null||r.update(E),this._gotoTask={},n.animate?this._gotoAnimated(E,n):this._gotoImmediate(E,n)}_gotoImmediate(e,i){const r=this._gotoTask,n=this.view.animation,o=e.then(u=>{if(At(i),r!==this._gotoTask)throw new re("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=u,n.finish()});return this._cancellableGoTo(r,n,o,i)}_gotoAnimated(e,i){const r=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const o=e.then(u=>{if(At(i),r!==this._gotoTask)throw new re("view:goto-interrupted","Goto was interrupted");return n.update(u),this.view.animationManager.animate(n,this.view.viewpoint,i),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,n,o,i)}_cancellableGoTo(e,i,r,n){const o=()=>e===this._gotoTask;return zl(r,n).finally(()=>{o()&&(i.done||i.stop())})}};m([b({constructOnly:!0})],n5.prototype,"view",void 0),n5=m([G("esri.views.2d.GoToManager")],n5);function ur(){return Promise.all([ie(()=>import("./webglDeps-kz7LeiOp.js"),__vite__mapDeps([143,74,72,45,73,144,145,146])),ie(()=>import("./mapViewDeps-CS44jmb5.js"),__vite__mapDeps([147,81,79,80,14,82,69,83,75,148,108,86,45,76,77,40,72,73,74,71,46,78,87,88,89,149,150,146,151,145,95,117,116,12,13,15,115,143,144,152,92,153,70,30,28,17,154,155,156,157,158,159,59,160,90,161,85,162,163,164,165,166,167,168]))])}const Cw=()=>ur().then(()=>ie(()=>import("./TileLayerView2D-BbiM35U5.js"),__vite__mapDeps([169,82,79,80,81,14,69,83,75,108,149,78,45,72,150,71,73,74,46,146,151,145,95,117,116,88,12,13,15,115,152,92,153,70,76,77,40,30,28,17,59,161,89,86,87,155,162,163,170,171,167,172,173,165,166,174,175,176,177]))),yg=()=>ur().then(()=>ie(()=>import("./FeatureLayerView2D-DgaKD1BR.js").then(t=>t.F),__vite__mapDeps([178,12,13,14,15,179,180,181,78,172,149,69,45,72,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,92,84,79,80,81,82,83,148,108,161,89,182,177,174,175]))),rU={"base-dynamic":()=>ur().then(()=>ie(()=>import("./BaseDynamicLayerView2D-Bsfh8ezB.js"),__vite__mapDeps([183,184,150,69,71,72,45,73,74,46,75,146,151,145,95,149,78,117,116,88,12,13,14,15,172,185,171,174,175]))),"base-tile":Cw,"bing-maps":Cw,catalog:()=>ur().then(()=>ie(()=>import("./CatalogLayerView2D-D6G0KAvs.js"),__vite__mapDeps([186,172,149,78,69,45,72,174]))),"catalog-dynamic-group":()=>ur().then(()=>ie(()=>import("./CatalogDynamicGroupLayerView2D-s2u87Tr1.js"),__vite__mapDeps([187,172,149,78,69,45,72,174]))),"catalog-footprint":()=>ur().then(()=>ie(()=>import("./CatalogFootprintLayerView2D-Ba8ZqbU1.js"),__vite__mapDeps([188,178,12,13,14,15,179,180,181,78,172,149,69,45,72,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,92,84,79,80,81,82,83,148,108,161,89,182,177,174,175]))),csv:yg,"geo-rss":()=>ur().then(()=>ie(()=>import("./GeoRSSLayerView2D-XeofU7NP.js"),__vite__mapDeps([189,172,149,78,69,45,72,164,165,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,12,13,14,15,161,79,80,81,82,83,89,162,70,30,28,17,163,174]))),feature:yg,geojson:yg,graphics:()=>ur().then(()=>ie(()=>import("./GraphicsLayerView2D-_gX72LD0.js"),__vite__mapDeps([190,78,172,149,69,45,72,164,165,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,12,13,14,15,161,79,80,81,82,83,89,162,70,30,28,17,163,182,174]))),group:()=>ur().then(()=>ie(()=>import("./GroupLayerView2D-CdxHeSep.js"),__vite__mapDeps([191,172,149,78,69,45,72,174]))),imagery:()=>ur().then(()=>ie(()=>import("./ImageryLayerView2D-CBNL83ge.js"),__vite__mapDeps([192,193,74,72,45,146,46,99,150,69,71,73,75,151,145,95,149,78,117,116,88,12,13,14,15,172,162,79,80,81,82,83,70,76,77,40,30,28,17,161,89,163,173,165,166,167,184,171,185,102,179,180,181,177,174,175]))),"imagery-tile":()=>ur().then(()=>ie(()=>import("./ImageryTileLayerView2D-B1TCPppt.js"),__vite__mapDeps([194,195,193,74,72,45,146,46,99,150,69,71,73,75,151,145,95,149,78,117,116,88,12,13,14,15,172,196,167,197,102,179,180,181,177,174,175]))),kml:()=>ur().then(()=>ie(()=>import("./KMLLayerView2D-B3CjVcNl.js"),__vite__mapDeps([198,199,171,149,78,69,45,72,184,150,71,73,74,46,75,146,151,145,95,117,116,88,12,13,14,15,172,164,165,166,76,77,40,167,161,79,80,81,82,83,89,162,70,30,28,17,163,174,102,154,143,144,155,153,108,156,196]))),"knowledge-graph":()=>ur().then(()=>ie(()=>import("./KnowledgeGraphLayerView2D-CxNETH5e.js"),__vite__mapDeps([200,172,149,78,69,45,72,174]))),"link-chart":()=>ur().then(()=>ie(()=>import("./KnowledgeGraphLayerView2D-CxNETH5e.js"),__vite__mapDeps([200,172,149,78,69,45,72,174]))),"knowledge-graph-sublayer":yg,"map-image":()=>ur().then(()=>ie(()=>import("./MapImageLayerView2D-DpI0HvyQ.js"),__vite__mapDeps([201,184,150,69,71,72,45,73,74,46,75,146,151,145,95,149,78,117,116,88,12,13,14,15,172,162,79,80,81,82,83,70,76,77,40,30,28,17,161,89,163,173,165,166,167,185,171,174,179,180,181,175,176,177]))),"map-notes":()=>ur().then(()=>ie(()=>import("./MapNotesLayerView2D-DG-EhvKs.js"),__vite__mapDeps([202,78,172,149,69,45,72,164,165,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,12,13,14,15,161,79,80,81,82,83,89,162,70,30,28,17,163,174]))),media:()=>ur().then(()=>ie(()=>import("./MediaLayerView2D-BNX2D3Ag.js"),__vite__mapDeps([203,204,163,82,79,80,81,14,69,83,75,108,149,78,45,72,150,71,73,74,46,146,151,145,95,117,116,88,12,13,15,115,152,92,153,70,76,77,40,30,28,17,59,161,89,86,87,155,162,160,90,205,172,174]))),"ogc-feature":()=>ur().then(()=>ie(()=>import("./OGCFeatureLayerView2D-ZDKlNOql.js"),__vite__mapDeps([206,178,12,13,14,15,179,180,181,78,172,149,69,45,72,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,92,84,79,80,81,82,83,148,108,161,89,182,177,174,175]))),"open-street-map":Cw,"oriented-imagery":yg,route:()=>ur().then(()=>ie(()=>import("./RouteLayerView2D-UhxQhv1w.js"),__vite__mapDeps([207,208,78,172,149,69,45,72,164,165,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,12,13,14,15,161,79,80,81,82,83,89,162,70,30,28,17,163,174]))),stream:()=>ur().then(()=>ie(()=>import("./StreamLayerView2D-DCcYb25H.js"),__vite__mapDeps([209,178,12,13,14,15,179,180,181,78,172,149,69,45,72,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,92,84,79,80,81,82,83,148,108,161,89,182,177,174,175]))),"subtype-group":()=>ur().then(()=>ie(()=>import("./SubtypeGroupLayerView2D-Dmt4-2DR.js"),__vite__mapDeps([210,178,12,13,14,15,179,180,181,78,172,149,69,45,72,166,76,77,40,73,74,71,46,75,167,150,146,151,145,95,117,116,88,92,84,79,80,81,82,83,148,108,161,89,182,177,174,175]))),tile:Cw,"vector-tile":()=>ur().then(()=>ie(()=>import("./VectorTileLayerView2D-CVXviBfi.js"),__vite__mapDeps([211,115,83,45,72,59,159,108,89,82,74,146,116,150,69,71,73,46,75,151,145,95,149,78,117,88,12,13,14,15,167,27,118,119,172,174]))),video:()=>ur().then(()=>ie(()=>import("./VideoLayerView2D-CdApG18_.js"),__vite__mapDeps([212,213,205,95,150,69,71,72,45,73,74,46,75,146,151,145,149,78,117,116,88,12,13,14,15,172,164,165,166,76,77,40,167,161,79,80,81,82,83,89,162,70,30,28,17,163,174]))),wcs:()=>ur().then(()=>ie(()=>import("./ImageryTileLayerView2D-B1TCPppt.js"),__vite__mapDeps([194,195,193,74,72,45,146,46,99,150,69,71,73,75,151,145,95,149,78,117,116,88,12,13,14,15,172,196,167,197,102,179,180,181,177,174,175]))),"web-tile":Cw,wfs:yg,wms:()=>ur().then(()=>ie(()=>import("./WMSLayerView2D-DbmQwIov.js"),__vite__mapDeps([214,184,150,69,71,72,45,73,74,46,75,146,151,145,95,149,78,117,116,88,12,13,14,15,172,185,171,174,175,215,179,180,181]))),wmts:()=>ur().then(()=>ie(()=>import("./WMTSLayerView2D-D_C2zw1x.js"),__vite__mapDeps([216,170,171,149,78,69,45,72,150,71,73,74,46,75,146,151,145,95,117,116,88,12,13,14,15,167,172,174,175]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Fke(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new re(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const nU={hasLayerViewModule:t=>rU[t.type]!=null,importLayerView:t=>{const e=rU[t.type];if(e==null)throw Fke(t);return e(t)}};function Nke(t,e){const{spatialReference:i}=e,r=[e.x,e.y];let n=Number.POSITIVE_INFINITY,o=0,u=0;const p=[0,0],g=t.type==="extent"?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const w of g)for(let S=0;S<w.length-1;S++){eme(p,r,w,S);const T=g0(r,p);T<n&&(n=T,o=p[0],u=p[1])}return{coordinate:new Ke({x:o,y:u,spatialReference:i}),distance:n}}var lO;let Jy=lO=class extends HP(Te){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ts(this.geometry,this.spatialReference)}catch(t){return fe.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?X3(this.normalizedGeometry,i):gP(this.normalizedGeometry,i))return t;const{coordinate:r}=Nke(this.normalizedGeometry,i);return r&&(t.targetGeometry=r),t}clone(){var t,e;return new lO({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};m([b({constructOnly:!0})],Jy.prototype,"geometry",void 0),m([b({readOnly:!0})],Jy.prototype,"normalizedGeometry",null),m([b({constructOnly:!0})],Jy.prototype,"spatialReference",void 0),Jy=lO=m([G("esri.views.2d.constraints.GeometryConstraint")],Jy);var uO;let Z_=uO=class extends HP(Te){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new uO({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};m([b()],Z_.prototype,"enabled",void 0),m([b()],Z_.prototype,"rotationEnabled",void 0),Z_=uO=m([G("esri.views.2d.constraints.RotationConstraint")],Z_);const Mre=Z_;var cO;let Po=cO=class extends HP(Te){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:r,minZoom:n,maxZoom:o}=this,u=-1,p=-1,g=!1,w=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!(e!=null&&e.length))return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);e=e.map(S=>S.clone()),e.sort((S,T)=>T.scale-S.scale),e.forEach((S,T)=>S.level=T);for(const S of e)!g&&i>0&&i>=S.scale&&(u=S.level,g=!0),!w&&r>0&&r>=S.scale&&(p=t?t.level:-1,w=!0),t=S;n===-1&&(n=i===0?0:u),o===-1&&(o=r===0?e.length-1:p),n=Math.max(n,0),n=Math.min(n,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),n>o&&([n,o]=[o,n]),i=e[n].scale,r=e[o].scale,e.splice(0,n),e.splice(o-n+1,e.length),e.forEach((S,T)=>{this._lodByScale[S.scale]=S,this._scales[T]=S.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,r=this.effectiveMaxScale,n=t.targetGeometry,o=e&&e.targetGeometry,u=r!==0&&t.scale<r,p=i!==0&&t.scale>i;if(u||p){const g=p?i:r;if(e&&o){const w=(g-e.scale)/(t.scale-e.scale);n.x=o.x+(n.x-o.x)*w,n.y=o.y+(n.y-o.y)*w}t.scale=g}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),r=Math.ceil(t);return e[i]+(t-i)*(e[r]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],r=e[n+1],r===t)return n+this.effectiveMinZoom+1;if(i>t&&r<t)return n+this.effectiveMinZoom+1-(t-r)/(i-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new cO({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};m([b({readOnly:!0})],Po.prototype,"effectiveLODs",void 0),m([b({readOnly:!0})],Po.prototype,"effectiveMinZoom",void 0),m([b({readOnly:!0})],Po.prototype,"effectiveMaxZoom",void 0),m([b({readOnly:!0})],Po.prototype,"effectiveMinScale",void 0),m([b({readOnly:!0})],Po.prototype,"effectiveMaxScale",void 0),m([b()],Po.prototype,"lods",void 0),m([b()],Po.prototype,"minZoom",void 0),m([b()],Po.prototype,"maxZoom",void 0),m([b()],Po.prototype,"minScale",void 0),m([b()],Po.prototype,"maxScale",void 0),m([b()],Po.prototype,"snapToZoom",void 0),Po=cO=m([G("esri.views.2d.constraints.ZoomConstraint")],Po);const kre=Po,Dke={base:null,key:"type",typeMap:{extent:jt,polygon:xo}};let Gr=class extends Te{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ie}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,r;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _geometry(){var i,r;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new Jy({geometry:this.geometry,spatialReference:(r=this.view)==null?void 0:r.constraintsInfo.spatialReference})}get _rotation(){return new Mre({rotationEnabled:this.rotationEnabled})}get _zoom(){var g;const e=this._get("_zoom"),i=this.lods||((g=this.view)==null?void 0:g.constraintsInfo.lods),r=this.minZoom,n=this.maxZoom,o=this.minScale,u=this.maxScale,p=this.snapToZoom;return e&&e.lods===i&&e.minZoom===r&&e.maxZoom===n&&e.minScale===o&&e.maxScale===u&&e.snapToZoom===p?e:new kre({lods:i,minZoom:r,maxZoom:n,minScale:o,maxScale:u,snapToZoom:p})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(r=>r.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(i=>{var r;return(r=i.applyPanConstraint)==null?void 0:r.call(i,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};m([b({readOnly:!0})],Gr.prototype,"effectiveLODs",null),m([b({readOnly:!0})],Gr.prototype,"effectiveMinScale",null),m([b({readOnly:!0})],Gr.prototype,"effectiveMaxScale",null),m([b({readOnly:!0})],Gr.prototype,"effectiveMinZoom",null),m([b({readOnly:!0})],Gr.prototype,"effectiveMaxZoom",null),m([b({types:Dke,value:null})],Gr.prototype,"geometry",null),m([b({type:[Ef]})],Gr.prototype,"lods",void 0),m([b()],Gr.prototype,"minScale",void 0),m([b()],Gr.prototype,"maxScale",void 0),m([b()],Gr.prototype,"minZoom",void 0),m([b()],Gr.prototype,"maxZoom",void 0),m([b()],Gr.prototype,"rotationEnabled",void 0),m([b()],Gr.prototype,"snapToZoom",void 0),m([b({type:Ie})],Gr.prototype,"customConstraints",void 0),m([b()],Gr.prototype,"view",void 0),m([b({readOnly:!0})],Gr.prototype,"version",null),m([b({type:Jy,readOnly:!0})],Gr.prototype,"_geometry",null),m([b({type:Mre})],Gr.prototype,"_rotation",null),m([b({readOnly:!0,type:kre})],Gr.prototype,"_zoom",null),Gr=m([G("esri.views.2d.MapViewConstraints")],Gr);const Cre=Gr;let s0=class xy{static getId(e,i,r,n){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${i}/${r}/${n}`}constructor(e,i,r,n){this.set(e,i,r,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|e<<8|r}acquire(e,i,r,n){this.set(e,i,r,n)}contains(e){const i=e.level-this.level;return i>=0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}containsChild(e){const i=e.level-this.level;return i>0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new xy(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,i,r,n){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[o,u,p,g]=e.split("/");this.level=parseFloat(o),this.row=parseFloat(u),this.col=parseFloat(p),this.world=parseFloat(g)}else this.level=+e,this.row=+i,this.col=+r,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new xy(this.level-1,this.row>>1,this.col>>1,this.world)}getNeighborId(e,i){return`${this.level}/${this.row+i}/${this.col+e}/${this.world}`}getChildKeys(){const e=this.level+1,i=this.row<<1,r=this.col<<1,n=this.world;return[new xy(e,i,r,n),new xy(e,i,r+1,n),new xy(e,i+1,r,n),new xy(e,i+1,r+1,n)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};s0.pool=new Hp(s0,null,null,25,50);function wd(t,e){return[t,e]}function E0(t,e,i){return t[0]=e,t[1]=i,t}function jke(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}const tu=new s0("0/0/0/0");let Vke=class Are{static create(e,i,r=null){const n=_s(e.spatialReference),o=i.origin||wd(e.origin.x,e.origin.y),u=wd(e.size[0]*i.resolution,e.size[1]*i.resolution),p=wd(-1/0,-1/0),g=wd(1/0,1/0),w=wd(1/0,1/0);r!=null&&(E0(p,Math.max(0,Math.floor((r.xmin-o[0])/u[0])),Math.max(0,Math.floor((o[1]-r.ymax)/u[1]))),E0(g,Math.max(0,Math.floor((r.xmax-o[0])/u[0])),Math.max(0,Math.floor((o[1]-r.ymin)/u[1]))),E0(w,g[0]-p[0]+1,g[1]-p[1]+1));const{cols:S,rows:T}=i;let E,C,L,R;return!r&&S&&T&&(E0(p,S[0],T[0]),E0(g,S[1],T[1]),E0(w,S[1]-S[0]+1,T[1]-T[0]+1)),e.isWrappable?(E=wd(Math.ceil(Math.round((n.valid[1]-n.valid[0])/i.resolution)/e.size[0]),w[1]),C=wd(Math.floor((n.origin[0]-o[0])/u[0]),p[1]),L=wd(E[0]+C[0]-1,g[1]),R=!0):(C=p,L=g,E=w,R=!1),new Are(i.level,i.resolution,i.scale,o,p,g,w,u,C,L,E,R)}constructor(e,i,r,n,o,u,p,g,w,S,T,E){this.level=e,this.resolution=i,this.scale=r,this.origin=n,this.first=o,this.last=u,this.size=p,this.norm=g,this.worldStart=w,this.worldEnd=S,this.worldSize=T,this.wrap=E}normalizeCol(e){if(!this.wrap)return e;const i=this.worldSize[0];return e<0?i-1-Math.abs((e+1)%i):e%i}denormalizeCol(e,i){return this.wrap?this.worldSize[0]*i+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){return this.origin[0]+e*this.norm[0]}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,i,r=!1){tu.set(i);const n=r?tu.col:this.denormalizeCol(tu.col,tu.world),o=tu.row;return jke(e,this.getXForColumn(n),this.getYForRow(o+1),this.getXForColumn(n+1),this.getYForRow(o)),e}getTileCoords(e,i,r=!1){tu.set(i);const n=r?tu.col:this.denormalizeCol(tu.col,tu.world);return Array.isArray(e)?E0(e,this.getXForColumn(n),this.getYForRow(tu.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(tu.row)),e}},C3=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:i,colFrom:r,colTo:n}of this.spans)for(let o=r;o<=n;o++){const u=e.getWorldForColumn(o);yield new s0(e.level,i,e.normalizeCol(o),u)}}forEach(e,i){const{spans:r,lodInfo:n}=this,{level:o}=n;if(r.length!==0)for(const{row:u,colFrom:p,colTo:g}of r)for(let w=p;w<=g;w++)e.call(i,o,u,n.normalizeCol(w),n.getWorldForColumn(w))}};C3.pool=new Hp(C3);let gk=class{constructor(e,i,r){this.row=e,this.colFrom=i,this.colTo=r}};const pr=new s0("0/0/0/0");let zke=class Lre{static create(e,i){e[1]>i[1]&&([e,i]=[i,e]);const[r,n]=e,[o,u]=i,p=o-r,g=u-n,w=g!==0?p/g:0,S=(Math.ceil(n)-n)*w,T=(Math.floor(n)-n)*w;return new Lre(r,Math.floor(n),Math.ceil(u),w,p<0?S:T,p<0?T:S,p<0?o:r,p<0?r:o)}constructor(e,i,r,n,o,u,p,g){this.x=e,this.ymin=i,this.ymax=r,this.invM=n,this.leftAdjust=o,this.rightAdjust=u,this.leftBound=p,this.rightBound=g}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const la=[[0,0],[0,0],[0,0],[0,0]],Uke=1e-6;let Gke=class{constructor(e,i=null,r=e.lods[0].level,n=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const o=e.lods.filter(p=>p.level>=r&&p.level<=n);this.minScale=o[0].scale,this.maxScale=o[o.length-1].scale;const u=this._lodInfos=o.map(p=>Vke.create(e,p,i));o.forEach((p,g)=>{this._infoByLevel[p.level]=u[g],this._infoByScale[p.scale]=u[g],this.scales[g]=p.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,i,r=!1){pr.set(i);const n=this._infoByLevel[pr.level];return n?n.getTileBounds(e,pr,r):e}getTileCoords(e,i,r=!1){pr.set(i);const n=this._infoByLevel[pr.level];return n?n.getTileCoords(e,pr,r):e}getTileCoverage(e,i=192,r=!0,n="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const o=n==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),u=C3.pool.acquire(o),p=this._wrap;let g,w,S,T=1/0,E=-1/0;const C=u.spans;la[0][0]=la[0][1]=la[1][1]=la[3][0]=-i,la[1][0]=la[2][0]=e.size[0]+i,la[2][1]=la[3][1]=e.size[1]+i;for(const V of la)e.toMap(V,V),V[0]=o.getColumnForX(V[0]),V[1]=o.getRowForY(V[1]);const L=[];let R=3;for(let V=0;V<4;V++){if(la[V][1]===la[R][1]){R=V;continue}const U=zke.create(la[V],la[R]);T=Math.min(U.ymin,T),E=Math.max(U.ymax,E),L[U.ymin]===void 0&&(L[U.ymin]=[]),L[U.ymin].push(U),R=V}if(T==null||E==null||E-T>100)return null;let F=[];for(g=T;g<E;){L[g]!=null&&(F=F.concat(L[g])),w=1/0,S=-1/0;for(let V=F.length-1;V>=0;V--){const U=F[V];w=Math.min(w,U.getLeftCol()),S=Math.max(S,U.getRightCol())}if(w=Math.floor(w),S=Math.floor(S),g>=o.first[1]&&g<=o.last[1])if(p)if(o.size[0]<o.worldSize[0]){const V=Math.floor(S/o.worldSize[0]);for(let U=Math.floor(w/o.worldSize[0]);U<=V;U++)C.push(new gk(g,Math.max(o.getFirstColumnForWorld(U),w),Math.min(o.getLastColumnForWorld(U),S)))}else C.push(new gk(g,w,S));else w>o.last[0]||S<o.first[0]||(w=Math.max(w,o.first[0]),S=Math.min(S,o.last[0]),C.push(new gk(g,w,S)));g+=1;for(let V=F.length-1;V>=0;V--){const U=F[V];U.ymax>=g?U.incrRow():F.splice(V,1)}}return u}getTileParentId(e){pr.set(e);const i=this._infoByLevel[pr.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD(pr,this._lodInfos[r],pr),pr.id)}getTileResolution(e){const i=this._infoByLevel[typeof e=="object"?e.level:e];return i?i.resolution:-1}getTileScale(e){const i=this._infoByLevel[e.level];return i?i.scale:-1}intersects(e,i){pr.set(i);const r=this._infoByLevel[pr.level],n=e.lodInfo;if(n.resolution>r.resolution){this._getTileIdAtLOD(pr,n,pr);const u=n.denormalizeCol(pr.col,pr.world);for(const p of e.spans)if(p.row===pr.row&&p.colFrom<=u&&p.colTo>=u)return!0}if(n.resolution<r.resolution){const[u,p,g,w]=e.spans.reduce((R,F)=>(R[0]=Math.min(R[0],F.row),R[1]=Math.max(R[1],F.row),R[2]=Math.min(R[2],F.colFrom),R[3]=Math.max(R[3],F.colTo),R),[1/0,-1/0,1/0,-1/0]),S=r.denormalizeCol(pr.col,pr.world),T=n.getColumnForX(r.getXForColumn(S)),E=n.getRowForY(r.getYForRow(pr.row)),C=n.getColumnForX(r.getXForColumn(S+1))-1,L=n.getRowForY(r.getYForRow(pr.row+1))-1;return!(T>w||C<g||E>p||L<u)}const o=n.denormalizeCol(pr.col,pr.world);return e.spans.some(u=>u.row===pr.row&&u.colFrom<=o&&u.colTo>=o)}normalizeBounds(e,i,r){if(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],this._wrap){const n=_s(this.tileInfo.spatialReference),o=-r*(n.valid[1]-n.valid[0]);e[0]+=o,e[2]+=o}return e}getSmallestInfoForScale(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(e>i[r]+Uke)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(e){const i=this.scales;return this._infoByScale[e]||(e=i.reduce((r,n)=>Math.abs(n-e)<Math.abs(r-e)?n:r,i[0])),this._infoByScale[e]}scaleToLevel(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=i.length-1;r>=0;r--)if(e<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-e)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,i,r){const n=this._infoByLevel[r.level];return e.set(r),i.resolution<n.resolution?null:(i.resolution===n.resolution||(e.level=i.level,e.col=Math.floor(r.col*n.resolution/i.resolution+.01),e.row=Math.floor(r.row*n.resolution/i.resolution+.01)),e)}},Bke=class{constructor(e,i){this.item=e,this.controller=i,this.promise=null}},Ore=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new fm,this._controllers=new fm,this._processingItems=new fm,this._pausedSignal=I3(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new mb(e.peeker),this.process=e.process;const i=e.scheduler;e.priority&&i&&(this._task=i.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Vi(this._schedule),this._task=Vi(this._task)}get updating(){var e;return!!((e=this._task)!=null&&e.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const i=this._controllers.get(e);i&&i.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(i=>e.push(i)),this._controllers.clear(),e.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((i,r)=>e(r))}get(e){const i=this._deferreds.get(e);return i?i.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,i){const r=this.get(e);if(r)return r;const n=new AbortController;let o=null;i&&(o=Zo(i,()=>n.abort()));const u=()=>{const S=this._processingItems.get(e);S&&S.controller.abort(),p(),w.reject(ni())},p=()=>{g.remove(),o!=null&&o.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},g=V7(n.signal,u),w=os();return this._deferreds.set(e,w),this._controllers.set(e,n),w.promise.then(p,p),this._queue.push(e),this._scheduleNext(),w.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){var i;const e=this._queue.popLast();return e&&((i=this._deferreds.get(e))==null||i.reject(ni("Removed from queue")),this._removeItem(e)),e}reset(){const e=[];this._processingItems.forEach(i=>e.push(i)),this._processingItems.clear();for(const i of e)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=jb(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(i))}_processError(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(i))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let i;const r=new AbortController,n=new Bke(e,r);this._processingItems.set(e,n);try{i=this.process(e,r.signal)}catch(o){this._processError(n,o)}ed(i)?(n.promise=i,i.then(o=>this._processResult(n,o),o=>this._processError(n,o))):this._processResult(n,i)}get test(){}};function qke(t,e){return t.length=0,e.forEach(i=>t.push(i)),t}const vk=new Set,Qx=[],mg=new Map,sU=[0,0];let sf=class extends Te{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:i,strategy:r}=this;this._queue=new Ore({concurrency:e,process:(n,o)=>{const u=this._keyToItem.get(n);return i(u,{signal:o})},peeker:r==="scale-first"?n=>this._peekByScaleFirst(n):n=>this._peekByCenterFirst(n)})}destroy(){this.clear(),this._queue=ot(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const i=typeof e=="string"?e:e.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(e){const i=e.key.id;if(this._queue.has(i))return this._queue.get(i);const r=this._queue.push(i),n=()=>{this._keyToItem.delete(i)};return this._keyToItem.set(i,e),r.then(n,n),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;e.forEach(S=>{const T=this._keyToItem.get(S),E=this.tileInfoView.getTileScale(T.key);mg.has(E)||(mg.set(E,[]),r=Math.max(E,r),n=Math.min(E,n)),mg.get(E).push(T.key),vk.add(E)});let o=this.state.scale;mg.has(o)||(qke(Qx,vk),Qx.sort((S,T)=>S-T),o=Qx.reduce((S,T)=>Math.abs(T-o)<Math.abs(S-o)?T:S,Qx[0])),o=Math.min(o,r),o=Math.max(o,n);const u=mg.get(o),p=i.getClosestInfoForScale(o),g=p.getColumnForX(this.state.center[0]),w=p.getRowForY(this.state.center[1]);return u.sort((S,T)=>{const E=p.denormalizeCol(S.col,S.world),C=p.denormalizeCol(T.col,T.world);return Math.sqrt((g-E)*(g-E)+(w-S.row)*(w-S.row))-Math.sqrt((g-C)*(g-C)+(w-T.row)*(w-T.row))}),vk.clear(),mg.clear(),u[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView,r=this.state.center;let n,o=Number.POSITIVE_INFINITY;return e.forEach(u=>{const p=this._keyToItem.get(u);i.getTileCoords(sU,p.key);const g=g0(sU,r);g<o&&(o=g,n=p.key)}),n.id}};m([b({constructOnly:!0})],sf.prototype,"concurrency",void 0),m([b({constructOnly:!0})],sf.prototype,"process",void 0),m([b()],sf.prototype,"state",void 0),m([b({constructOnly:!0})],sf.prototype,"strategy",void 0),m([b({constructOnly:!0})],sf.prototype,"tileInfoView",void 0),sf=m([G("esri.views.2d.tiling.TileQueue")],sf);const gQe=sf;let Hke=class{constructor(e,i,r){this.maxSize=e,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const r=i.key.level,n=this._tileKeysPerLevel[r];oU(this._tilePerId,e);for(let o=0;o<n.length;o++)if(n[o].id===e){n.splice(o,1);break}return i.visible=!0,i}add(e){e.visible=!1;const i=e.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const n=i.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(i)}prune(e,i,r){let n=this._tilePerId.size;if(n<=this.maxSize)return;let o=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&o>=0;)o!==e&&(n=this._pruneAroundCenterTile(n,i,r,o)),o--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,i,r,e))}_pruneAroundCenterTile(e,i,r,n){const o=this._tileKeysPerLevel[n];if(!o||o.length===0)return e;const{size:u,origin:p}=this._tileInfoView.tileInfo,g=r*u[0],w=r*u[1],S=[0,0],T=[0,0];for(o.sort((E,C)=>(S[0]=p.x+g*(E.col+.5),S[1]=p.y-w*(E.row+.5),T[0]=p.x+g*(C.col+.5),T[1]=p.y-w*(C.row+.5),tc(S,i)-tc(T,i)));o.length>0;){const E=o.pop();if(this._removeTile(E.id),--e===this.maxSize)break}return e}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),oU(this._tilePerId,e)}};function oU(t,e){t.delete(e)}const I0=new s0(0,0,0,0),Oh=new Map,M0=[],bk=[];let bQe=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new Hke(e.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(e){var V,U;const{resampling:i,tileIndex:r}=this,{scale:n,center:o,resolution:u}=e.state,{minScale:p,maxScale:g}=this.tileInfoView,w=!e.stationary&&n>this._previousScale;if(this._previousScale=n,!i&&(n>p||n<g))return this.tiles.length=0,void this.clear();const S=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!S)return this.tiles.length=0,void this.clear();const{spans:T,lodInfo:E}=S,{level:C}=E;this.tiles.length=0,r.forEach(W=>W.visible=!0);let L=0,R=0;if(T.length>0)for(const{row:W,colFrom:H,colTo:J}of T)for(let X=H;X<=J;X++){L++;const te=I0.set(C,W,E.normalizeCol(X),E.getWorldForColumn(X)).id;let oe=r.get(te);if(oe)oe.isReady?(Oh.set(te,oe),R++):w||this._addParentTile(te,Oh);else{if((V=this._tileCache)!=null&&V.has(te)){if(oe=this._tileCache.pop(te),this.tileIndex.set(te,oe),oe.isReady){Oh.set(te,oe),R++;continue}}else oe=this.acquireTile(I0),this.tileIndex.set(te,oe);w||this._addParentTile(te,Oh)}}const F=R===L;for(const[W,H]of r){if(Oh.has(W))continue;I0.set(W);const J=this.tileInfoView.intersects(S,I0),X=this.cachePolicy==="purge"?I0.level!==C:I0.level>C;!J||!w&&F?!X&&J||M0.push(H):H.isReady?X&&this.cachePolicy==="purge"&&this._hasReadyAncestor(I0,C)?M0.push(H):bk.push(H):X&&M0.push(H)}for(const W of bk)W.isReady&&Oh.set(W.key.id,W);for(const W of M0)this._tileCache?this._tileCache.add(W):this.releaseTile(W),r.delete(W.key.id);for(const W of Oh.values())this.tiles.push(W);for(const W of r.values())Oh.has(W.key.id)||(W.visible=!1);(U=this._tileCache)==null||U.prune(C,o,u),C3.pool.release(S),bk.length=0,M0.length=0,Oh.clear()}clear(){const{tileIndex:e}=this;for(const i of e.values())this.releaseTile(i);e.clear()}refresh(e){var i;for(const r of this.tileIndex.values())this.tiles.includes(r)?e(r):M0.push(r);for(const r of M0)this.releaseTile(r),this.tileIndex.delete(r.key.id);(i=this._tileCache)==null||i.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,i){var o;let r=e,n=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(n=this.tileIndex.get(r),n==null?void 0:n.isReady){i.has(n.key.id)||i.set(n.key.id,n);break}}else if((o=this._tileCache)!=null&&o.has(r)&&(n=this._tileCache.pop(r),this.tileIndex.set(r,n),n==null?void 0:n.isReady)){i.has(n.key.id)||i.set(n.key.id,n);break}}_hasReadyAncestor(e,i){const r=bs();this.tileInfoView.getTileBounds(r,e,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=i&&n.key.level<e.level){const o=bs();if(this.tileInfoView.getTileBounds(o,n.key,!0),OP(o,r))return!0}return!1}},lo=class extends Te{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ce(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},$s)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new Ke({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void fe.getLogger(this).error(new re("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const r=this.viewpoint;rO(r,r,i),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void fe.getLogger(this).error(new re("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void fe.getLogger(this).error(new re("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const r=this.viewpoint;i9e(r,r,i,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;p9e(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const i=this.viewpoint;Xz(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var o;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,r;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new re("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new re("mapview:invalid-viewpoint","geometry not defined"))}catch(u){r=new re("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:u})}if(r)return void fe.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new Mn({targetGeometry:new Ke,scale:0,rotation:0});Ys(n,i),(o=this.constraints)==null||o.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var n,o;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const u=this._get("extent");return void(u&&(this._set("extent",void 0),this._set("center",u.center)))}const i=((n=this.constraints)==null?void 0:n.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const r=this.viewpoint;Xz(r,r,i),this.viewpoint=r,this._set("zoom",((o=this.constraints)==null?void 0:o.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:r}=this,n=this._get("center"),o=this._get("extent"),u=this._get("scale"),p=this._get("rotation"),g=this._get("viewpoint"),w=this._get("zoom"),S=w!=null&&r!=null&&r.zoomToScale(w)||void 0;let T,E,C;const L=g==null?void 0:g.rotation,R=g==null?void 0:g.targetGeometry;(R==null?void 0:R.type)==="extent"?T=R:(R==null?void 0:R.type)==="point"&&(E=R,C=g==null?void 0:g.scale);const F=o??T;return{center:n??E??(F==null?void 0:F.center),rotation:p??L,scale:(u??S??C??(F&&kM(F,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,r,n){var u;const o=e.targetGeometry;try{this._project(e,r)}catch(p){fe.getLogger(this).warn(new Ul("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:r,error:p})),e.targetGeometry=n||new Ke({x:0,y:0,spatialReference:r})}(u=this.constraints)==null||u.fit(e),this._set("state",new CR({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:r,rotation:n,scale:o}=this.state.paddedViewState,u=new Ke({x:e,y:i,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",u),this._set("zoom",-1),this._set("rotation",n),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){var g;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const w=i.viewpoint.clone();w.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=w}const r=i.clone(),[n,o]=i.center;let u=null;try{u=this._project(new Ke({x:n,y:o,spatialReference:i.spatialReference}),e)}catch(w){cP()||fe.getLogger(this).warn(new Ul("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:u==null?void 0:u.toJSON(),spatialReference:e,error:w}))}u||(u=new Ke({x:0,y:0,spatialReference:e}));const p=rO(new Mn({targetGeometry:new Ke,scale:0,rotation:0}),i.viewpoint,u);r.viewpoint=p;try{const S=[i.size[0]/2,i.size[1]/2],T=[S[0]+20,S[1]],E=i.toMap([0,0],T),{x:C,y:L}=this._project(new Ke({x:E[0],y:E[1],spatialReference:i.spatialReference}),e);E[0]=C,E[1]=L,r.toScreen(E,E);const R=u9e(S,E,T),F=Math.hypot(E[0]-S[0],E[1]-S[1])/20;!Number.isFinite(F)||Math.abs(F)>4?(p.rotation=0,p.targetGeometry=new Ke({x:0,y:0,spatialReference:e})):(p.scale*=F,p.scale>me("mapview-srswitch-adjust-rotation-scale-threshold")?p.rotation=0:p.rotation+=Number.isFinite(R)?R:0)}catch{}(g=this._get("constraints"))==null||g.constrain(p,void 0),this._get("state").viewpoint=p}resize(e,i){var u;if(!this.ready)return;const r=this.state;let n=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.concat();r.size=[e,i],h9e(n,n,o,this.state.paddedViewState.size,this.resizeAlign),n=((u=this.constraints)==null?void 0:u.constrain(n,void 0))??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const i=[0,0],[r,n]=this.state.toMap(i,[e.x,e.y]),o=this.state.spatialReference;return new Ke({x:r,y:n,spatialReference:o})}toScreen(e,i){if(!this.ready)return null;const r=this._project(e,this.state.spatialReference),n=[r.x,r.y];return(i==null?void 0:i.pickClosestTarget)===!1||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),Mr(n[0],n[1])}_project(e,i){var o;const r=(e==null?void 0:e.targetGeometry)||e;if(!i)return e;if(!r)return null;if(i.imageCoordinateSystem||(o=r.spatialReference)!=null&&o.imageCoordinateSystem||Ki(i,r.spatialReference))return e;const n=Ts(r,i);if(!n)throw new re("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:i});return Wke(e)?(e.targetGeometry=n,e):n}};function Wke(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}m([b({type:Ke})],lo.prototype,"center",null),m([b()],lo.prototype,"constraints",void 0),m([b({type:jt})],lo.prototype,"extent",null),m([b({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],lo.prototype,"padding",null),m([b()],lo.prototype,"ready",void 0),m([b()],lo.prototype,"resizeAlign",void 0),m([b({readOnly:!0})],lo.prototype,"resolution",null),m([b({type:Number})],lo.prototype,"rotation",null),m([b({type:Number})],lo.prototype,"scale",null),m([b({readOnly:!0})],lo.prototype,"state",void 0),m([b({type:Mn})],lo.prototype,"viewpoint",null),m([b()],lo.prototype,"zoom",null),lo=m([G("esri.views.2d.ViewStateManager")],lo);function AR(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}let aU=class extends Zn{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(e,i){AR(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Jke=class extends Zn{constructor(e,i,r){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:r}=i;if(r!==this.pointerType)return;e.stopPropagation();const{action:n,delta:o}=i,{view:u}=this,{mapViewNavigation:p}=u;switch(n){case"begin":{const{scale:g}=u;this._startScale=g,this._currentScale=g,this._previousDelta=o,p.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const g=1.015**o.y,w=this._startScale*g,S=w/this._currentScale;p.setViewpointImmediate(S),this._currentScale=w;break}case"end":{const{constraints:g}=u,{effectiveLODs:w,snapToZoom:S}=g;if(!S||!w)return void p.end();const T=g.snapScale(this._currentScale),E=(o.y>0?Math.max(T,g.snapToPreviousScale(this._startScale)):Math.min(T,g.snapToNextScale(this._startScale)))/this._currentScale;p.zoom(E).then(()=>{p.end()});break}}}},AM=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,r;this._startEvent=e,(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Zke=class extends Zn{constructor(e,i,r){super(!0),this.view=e,this.pointerAction=i,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new AM({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&AR(r.data,this.pointerAction)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Kke=class extends Zn{constructor(e,i,r){super(!0),this._view=e,this.pointerAction=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new AM({start:(o,u)=>{n.rotate.begin(this._view,u.data),u.stopPropagation()},update:(o,u)=>{n.rotate.update(this._view,u.data),u.stopPropagation()},end:(o,u)=>{n.rotate.end(),u.stopPropagation()},condition:(o,u)=>o===1&&AR(u.data,this.pointerAction)}),this.registerIncoming("drag",r,o=>this._dragEventSeparator.handle(o))}};function iu(t){let e=t*t;return t<0&&(e*=-1),e}function Yke(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function Xke(t,e,i){const r=i,n=t.state,o=t.device,u=e.tiltDirection==="forward-down"?1:-1,p=1;return o.deviceType==="standard"?(r.translation[0]=iu(n.axes[0]),r.translation[1]=iu(n.axes[1]),r.translation[2]=iu(n.buttons[7])-iu(n.buttons[6]),r.heading=iu(n.axes[2]),r.tilt=iu(n.axes[3])):o.deviceType==="spacemouse"&&(r.translation[0]=1.2*iu(n.axes[0]),r.translation[1]=1.2*iu(n.axes[1]),r.translation[2]=2*-iu(n.axes[2]),r.heading=1.2*iu(n.axes[5]),r.tilt=1.2*iu(n.axes[3])),r.tilt*=u,Mi(r.translation,r.translation,p),r}function Qke(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let e4e=class extends Zn{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Fb,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ce(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=tb({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Qe)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Yke(this._transformation)):(this._currentDevice=e.data.device,Xke(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const i=this._transformation;if(Qke(i))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=i4e*n*e;CM(r,r,[i.translation[0]*o,-i.translation[1]*o]);const u=1+i.translation[2]*r4e*e,p=this._view.constraints.rotationEnabled?-i.heading*t4e*e:0,g=this._view.size,w=[g[0]/2,g[1]];cre(r,r,u,p,w,g);const S=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=S}};const t4e=.06,i4e=.7,r4e=6e-4;function Pre(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),We(()=>document.removeEventListener("visibilitychange",e))}let n4e=class extends Zn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=n=>{const o=this._keyMap[n.data.key];if(n.modifiers.has("Meta")||n.modifiers.has("Control"))return void this._stopMovement();if(o==null)return;n.stopPropagation(),n.preventDefault();const u=n.type==="key-down";if(this._pressedKeys[u?"add":"delete"](o),u){if(this._direction===o)return;this._direction=o,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const p=this._timeout===void 0,g=this._pressedKeys.size>0;p||g?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=Pre(n=>n?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const i=this._currentDirection!=null;if(e!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},s4e=class extends Zn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=Pre(n=>n?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(e.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var dv;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(dv||(dv={}));let o4e=class extends Zn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),i.zoomIn.forEach(n=>this._keysToZoomAction[n]=dv.IN),i.zoomOut.forEach(n=>this._keysToZoomAction[n]=dv.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:o}=this.view;let u=null;switch(n){case dv.IN:u=o.zoomIn();break;case dv.OUT:u=o.zoomOut();break;default:return}o.begin(),u.then(()=>o.end()),e.stopPropagation()}};const a4e=.6;let l4e=class extends Zn{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:n,deltaY:o}=e.data,u=1/a4e**(1/60*o),p=i.zoom(u,[r,n]);p&&(this._canZoom=!1,p.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},u4e=class extends Zn{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new AM({start:(r,n)=>{i.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{i.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{i.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function lU(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>p4e(i,t.axisThreshold))}:{buttons:[],axes:[]}}function c4e(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function h4e(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function p4e(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let d4e=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const u=o.gamepad,p=u.index,g=this._inputDevices[p];g&&(this._emitGamepadEvent(u,lU(g),!1),this._inputDevices.splice(p,1),this._latestUpdate.splice(p,1),this._input.gamepad.devices.remove(g),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(uU(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new wR(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=tb({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;uU(n=>{const o=this._inputDevices[n.index];if(!o)return;const u=this._latestUpdate[n.index],p=lU(o),g=r||h4e(p);u&&(u.timestamp===n.timestamp||!u.active&&g||c4e(u.state,p))||this._emitGamepadEvent(n,p,!g)})}_emitGamepadEvent(e,i,r){const n=this._latestUpdate[e.index],o=n&&n.active;if(!o&&!r)return;const u=!o&&r?"start":o&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:u})}};function f4e(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function uU(t){const e=window.navigator.getGamepads();for(let i=0;i<e.length;i++){const r=e[i];f4e(r)&&t(r)}}const cU=me("edge"),y4e=me("chrome"),m4e=me("ff"),g4e=me("safari"),hU="esri-view-surface",gg={touchNone:`${hU}--touch-none`,touchPan:`${hU}--touch-pan`};let Rre=class Fre{constructor(e,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new d4e(e,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=ot(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const r=this._active[i];this._element.removeEventListener(wk[i],r),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&wk[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(wk[i],r),this._active[i]=r}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,i){i?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?gg.touchNone:gg.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?gg.touchPan:gg.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(gg.touchNone),this._element.classList.remove(gg.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const r=Eie(this._element,e);return Fre.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(e,i){const{key:r}=i;r&&e==="key-up"&&this._keyDownState.delete(r);const n={native:i,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,r)}_handleMouseWheel(e,i){let r=i.deltaY;switch(i.deltaMode){case 0:cU&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}cU?r*=.7:y4e||g4e?r*=.6:m4e&&(r*=1.375);const n=100,o=Math.abs(r);o>n&&(r=r/o*200/(1+Math.exp(-.02*(o-n))));const u=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(e,u)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const r={native:i};i.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Rre.test={disableSubpixelCoordinates:!1};const wk={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let v4e=class extends Zn{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};const vs={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function NE(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function b4e(t,e){const i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)}function w4e(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Mr()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[W,H]=t,[J,X]=[H.x-W.x,H.y-W.y];return e.radius=Math.sqrt(J*J+X*X)/2,e.center.x=(W.x+H.x)/2,e.center.y=(W.y+H.y)/2,e}let i=0,r=0;for(let W=0;W<t.length;W++)i+=t[W].x,r+=t[W].y;i/=t.length,r/=t.length;const n=t.map(W=>W.x-i),o=t.map(W=>W.y-r);let u=0,p=0,g=0,w=0,S=0,T=0,E=0;for(let W=0;W<n.length;W++){const H=n[W],J=o[W],X=H*H,te=J*J;u+=X,p+=te,g+=H*J,w+=X*H,S+=te*J,T+=H*te,E+=J*X}const C=.5*(w+T),L=.5*(S+E),R=u*p-g*g,F=(C*p-L*g)/R,V=(u*L-g*C)/R,U=Mr(F+i,V+r);return{radius:Math.sqrt(F*F+V*V+(u+p)/t.length),center:U}}function ym(t){const{native:e}=t,{pointerId:i,button:r,pointerType:n}=e;return n==="mouse"?`${i}:${r}`:`${n}`}let _4e=class extends Zn{constructor(e=vs.maximumDoubleClickDelay,i=vs.maximumDoubleClickDistance,r=vs.maximumDoubleTouchDelay,n=vs.maximumDoubleTouchDistance,o=Nb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Mr(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new AM({start:(u,p)=>this._dragStart(u,p),update:(u,p)=>this._dragUpdate(p),end:(u,p)=>this._dragEnd(p)}),this.registerIncoming("drag",u=>this._dragEventSeparator.handle(u)),this.registerIncoming("pointer-down",u=>this._handlePointerDown(u)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Vi(e.doubleTapTimeout)})}get hasPendingInputs(){return MI(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=Vi(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=i,{center:o}=r;this._dragStartCenter=o;const u=_k("begin",Mr(0,0),r);this._doubleTapDrag.emit(u,void 0,n),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,o=_k("update",Mr(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(o,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,o=_k("end",Mr(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(o,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,r=ym(i),n=this._pointerState.get(r),{pointerType:o}=i.native;if(n){const u=o==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),NE(n.event.data,i)>u?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:r}=i.native,n=ym(i),o=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,u=this._clock.setTimeout(()=>this._clearPointerDown(n),o);this._pointerState.set(n,{event:e,doubleTapTimeout:u}),this.refreshHasPendingInputs()}};function _k(t,e,i){const{button:r,buttons:n,pointer:o,pointers:u,pointerType:p,timestamp:g}=i;return{action:t,delta:e,button:r,buttons:n,pointer:o,pointers:u,pointerType:p,timestamp:g}}let S4e=class extends Zn{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,r,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:n,pointers:x4e(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const i=e.native.pointerId,r=e$(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,n);const o=s5(n,Nre(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,r=this._activePointerMap.get(i);r?r.event=e:this._addPointer(e)}_removePointer(e){const i=e$(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=e$(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=s5(r,i)-e,r.lastAngle=s5(r,i)-e})}_emitEvent(e,i,r){const n=e$(this._activePointerMap);this._drag.emit(this._createPayload(e,i,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const i=e.data,r=i.currentEvent,n=e.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Nre(t){const e=[];return t.forEach(i=>{e.push(Mr(i.event.x,i.event.y))}),w4e(e)}function e$(t){const e=Nre(t);let i=0;return t.forEach(r=>{let n=s5(r,e),o=n-r.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=r.lastAngle+o,r.lastAngle=n;const u=n-r.initialAngle;i+=u}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function x4e(t){const e=new Map;return t.forEach((i,r)=>e.set(r,i.event)),e}function s5(t,e){const i=t.event,r=i.x-e.center.x,n=i.y-e.center.y;return Math.atan2(n,r)}var pU;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(pU||(pU={}));let $4e=class extends Zn{constructor(e=vs.maximumDoubleClickDelay,i=vs.maximumDoubleClickDistance,r=vs.maximumDoubleTouchDelay,n=vs.maximumDoubleTouchDistance,o=Nb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=ym(i);if(!this._pointerState.has(r)){const n={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,r=ym(i),n=this._pointerState.get(r);if(n&&n.downButton===i.native.button){const o=n.immediateDoubleClick,u=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;o?(o.timeoutHandle.remove(),NE(o,e.data)>u?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(i))):NE(n,e.data)>u?this._removeState(i):this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,i){const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const i=ym(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},T4e=class extends Zn{constructor(e=vs.maximumClickDelay,i=vs.movementUntilMouseDrag,r=vs.movementUntilPenDrag,n=vs.movementUntilTouchDrag,o=vs.holdDelay,u=Nb){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=o,this._clock=u,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",p=>{this._handlePointerLoss(p,"pointer-up")}),this.registerIncoming("pointer-capture-lost",p=>{this._handlePointerLoss(p,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",p=>{this._handlePointerLoss(p,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Vi(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=i.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const u=this._pointerState.get(r);if(u){if(!u.isDragging){const p=u.previousEvent;this._pointerHold.emit(p,void 0,e.modifiers),u.holdEmitted=!0}u.holdTimeout=null}},this._holdDelay));const o={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,o),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const i=e.data,r=i.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(t$("update",n,i),void 0,n.modifiers):b4e(i,n.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),n.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,r=i.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(t$("start",n,i)):this._pointerDrag.emit(t$("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const r=e.data,n=r.native.pointerId,o=this._pointerState.get(n);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(t$("end",o,i==="pointer-up"?r:o.previousEvent),void 0,o.modifiers):i==="pointer-up"&&o.downButton===r.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function t$(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let E4e=class extends Zn{constructor(e=vs.maximumDoubleClickDelay,i=vs.maximumDoubleClickDistance,r=vs.maximumDoubleTouchDelay,n=vs.maximumDoubleTouchDistance,o=Nb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Vi(e.doubleClickTimer))}get hasPendingInputs(){return MI(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,i){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Vi(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const i=e.data,{pointerType:r}=i.native,n=I4e(i);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:u,modifiers:p}=o.event,g=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;NE(u,i)>g?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),o.pointerDownCount===2&&this._doubleClick.emit(u,void 0,p))}_handlePointerDown(e){const i=ym(e.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:r}}=i,n=ym(i),o=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,u=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),o);this._pointerState.set(n,{event:e,doubleClickTimer:u,pointerDownCount:1}),this.refreshHasPendingInputs()}};function I4e(t){const{pointerId:e,pointerType:i,button:r}=t.native;return i==="mouse"?`${e}:${r}`:`${i}`}const i$={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let $y=class extends Te{initialize(){const e=()=>{var i;return(i=this.view)==null?void 0:i.ready};this.addHandles([Fr(()=>!e(),()=>this._disconnect()),Fr(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}isModifierKeyDown(e){var i;return((i=this._inputManager)==null?void 0:i.isModifierKeyDown(e))??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=ot(this._inputManager)}_connect(){const e=this.view.surface,i=new Rre(e,this.view.input),r=[new $4e,new T4e,new E4e,new S4e(this.view.navigation),new _4e],n=new cl({eventSource:i,recognizers:r});n.installHandlers("prevent-context-menu",[new v4e],ii.INTERNAL),n.installHandlers("navigation",[new u4e(this.view),new e4e(this.view),new l4e(this.view),new aU(this.view),new aU(this.view,[i$.counter]),new Zke(this.view,"primary"),new n4e(this.view,i$.pan),new o4e(this.view,i$.zoom),new s4e(this.view,i$.rotate),new Kke(this.view,"secondary"),new Jke(this.view,"touch")],ii.INTERNAL),this.view.viewEvents.connect(n),this._source=i,this._inputManager=n,ce(()=>{var o,u;return(u=(o=this.view)==null?void 0:o.navigation)==null?void 0:u.browserTouchPanEnabled},o=>{this._source&&(this._source.browserTouchPanningEnabled=!o)},Qe)}get test(){}};m([b()],$y.prototype,"view",void 0),m([b()],$y.prototype,"latestPointerType",null),m([b()],$y.prototype,"latestPointerLocation",null),m([b()],$y.prototype,"multiTouchActive",null),$y=m([G("esri.views.2d.input.MapViewInputManager")],$y);const M4e=$y;var dU,fU,yU,Dre={exports:{}};dU=Dre,fU=function(){function t(n,o,u,p,g){e(n,o,u||0,p||n.length-1,g||r)}function e(n,o,u,p,g){for(;p>u;){if(p-u>600){var w=p-u+1,S=o-u+1,T=Math.log(w),E=.5*Math.exp(2*T/3),C=.5*Math.sqrt(T*E*(w-E)/w)*(S-w/2<0?-1:1);e(n,o,Math.max(u,Math.floor(o-S*E/w+C)),Math.min(p,Math.floor(o+(w-S)*E/w+C)),g)}var L=n[o],R=u,F=p;for(i(n,u,o),g(n[p],L)>0&&i(n,u,p);R<F;){for(i(n,R,F),R++,F--;g(n[R],L)<0;)R++;for(;g(n[F],L)>0;)F--}g(n[u],L)===0?i(n,u,F):i(n,++F,p),F<=o&&(u=F+1),o<=F&&(p=F-1)}}function i(n,o,u){var p=n[o];n[o]=n[u],n[u]=p}function r(n,o){return n<o?-1:n>o?1:0}return t},(yU=fU())!==void 0&&(dU.exports=yU);const k4e=qee(Dre.exports);function DE(t,e){if(!(this instanceof DE))return new DE(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function C4e(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function vg(t,e){K_(t,0,t.children.length,e,t)}function K_(t,e,i,r,n){n||(n=F1(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o,u=e;u<i;u++)o=t.children[u],Y_(n,t.leaf?r(o):o);return n}function Y_(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function mU(t,e){return t.minX-e.minX}function gU(t,e){return t.minY-e.minY}function Sk(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function r$(t){return t.maxX-t.minX+(t.maxY-t.minY)}function A4e(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function L4e(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function xk(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function n$(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function F1(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function vU(t,e,i,r,n){for(var o,u=[e,i];u.length;)(i=u.pop())-(e=u.pop())<=r||(o=e+Math.ceil((i-e)/r/2)*r,k4e(t,o,e,i,n),u.push(e,o,o,i))}DE.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!n$(t,e))return i;for(var n,o,u,p,g=[];e;){for(n=0,o=e.children.length;n<o;n++)u=e.children[n],n$(t,p=e.leaf?r(u):u)&&(e.leaf?i.push(u):xk(t,p)?this._all(u,i):g.push(u));e=g.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!n$(t,e))return!1;for(var r,n,o,u,p=[];e;){for(r=0,n=e.children.length;r<n;r++)if(o=e.children[r],n$(t,u=e.leaf?i(o):o)){if(e.leaf||xk(t,u))return!0;p.push(o)}e=p.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=F1([]),this},remove:function(t,e){if(t==null)return this;for(var i,r,n,o,u=this.data,p=this.toBBox(t),g=[],w=[];u||g.length;){if(u||(u=g.pop(),r=g[g.length-1],i=w.pop(),o=!0),u.leaf&&(n=C4e(t,u.children,e))!==-1)return u.children.splice(n,1),g.push(u),this._condense(g),this;o||u.leaf||!xk(u,p)?r?(i++,u=r.children[i],o=!1):u=null:(g.push(u),w.push(i),i=0,r=u,u=u.children[0])}return this},toBBox:function(t){return t},compareMinX:mU,compareMinY:gU,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var n,o=i-e+1,u=this._maxEntries;if(o<=u)return vg(n=F1(t.slice(e,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(o)/Math.log(u)),u=Math.ceil(o/Math.pow(u,r-1))),(n=F1([])).leaf=!1,n.height=r;var p,g,w,S,T=Math.ceil(o/u),E=T*Math.ceil(Math.sqrt(u));for(vU(t,e,i,E,this.compareMinX),p=e;p<=i;p+=E)for(vU(t,p,w=Math.min(p+E-1,i),T,this.compareMinY),g=p;g<=w;g+=T)S=Math.min(g+T-1,w),n.children.push(this._build(t,g,S,r-1));return vg(n,this.toBBox),n},_chooseSubtree:function(t,e,i,r){for(var n,o,u,p,g,w,S,T;r.push(e),!e.leaf&&r.length-1!==i;){for(S=T=1/0,n=0,o=e.children.length;n<o;n++)g=Sk(u=e.children[n]),(w=A4e(t,u)-g)<T?(T=w,S=g<S?g:S,p=u):w===T&&g<S&&(S=g,p=u);e=p||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),o=[],u=this._chooseSubtree(n,this.data,e,o);for(u.children.push(t),Y_(u,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},_split:function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var o=this._chooseSplitIndex(i,n,r),u=F1(i.children.splice(o,i.children.length-o));u.height=i.height,u.leaf=i.leaf,vg(i,this.toBBox),vg(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(i,u)},_splitRoot:function(t,e){this.data=F1([t,e]),this.data.height=t.height+1,this.data.leaf=!1,vg(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,n,o,u,p,g,w,S;for(g=w=1/0,r=e;r<=i-e;r++)u=L4e(n=K_(t,0,r,this.toBBox),o=K_(t,r,i,this.toBBox)),p=Sk(n)+Sk(o),u<g?(g=u,S=r,w=p<w?p:w):u===g&&p<w&&(w=p,S=r);return S},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:mU,n=t.leaf?this.compareMinY:gU;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var n,o,u=this.toBBox,p=K_(t,0,e,u),g=K_(t,i-e,i,u),w=r$(p)+r$(g);for(n=e;n<i-e;n++)o=t.children[n],Y_(p,t.leaf?u(o):o),w+=r$(p);for(n=i-e-1;n>=e;n--)o=t.children[n],Y_(g,t.leaf?u(o):o),w+=r$(g);return w},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)Y_(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():vg(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};let bU=class jre{constructor(e,i){this.key=new s0(0,0,0,0),this.bounds=bs(),this.objectIds=new Set,this.key.set(i);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return jt.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return{$view:{scale:this.scale,timeZone:e}}}createChildTiles(){const e=this.key.getChildKeys(),i=vo.acquire();for(let r=0;r<e.length;r++)i[r]=new jre(this.tileInfoView,e[r]);return i}getQuantizationParameters(){return tte.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const k0={added:[],removed:[]},$k=new Set,O4e=new s0(0,0,0,0);function P4e(t,e){const i=_s(e);if(!i)return null;const[r,n]=i.valid;return t[2]>n?[bs([t[0],t[1],n,t[3]]),bs([r,t[1],r+t[2]-n,t[3]])]:t[0]<r?[bs([r,t[1],t[2],t[3]]),bs([n-(r-t[0]),t[1],n,t[3]])]:null}let R4e=class extends Ar{constructor(e){super(),this._tiles=new Map,this._index=DE(9,me("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||$K(e)===0||TK(e)===0)return[];const i=P4e(e,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const n=new bU(this.tileScheme,r);this._tiles.set(r,n),this._index.insert(n),i.added.push(n)}for(const r of e.removed)if(this.has(r)){const n=this.get(r);this._tiles.delete(r),this._index.remove(n),i.removed.push(n)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:r,lodInfo:n}=i,{level:o}=n;if(r.length>0)for(const{row:u,colFrom:p,colTo:g}of r)for(let w=p;w<=g;w++){const S=O4e.set(o,u,n.normalizeCol(w),n.getWorldForColumn(w)).id;if($k.add(S),!this.has(S)){const T=new bU(this.tileScheme,S);this._tiles.set(S,T),this._index.insert(T),this.tiles.push(T),k0.added.push(T)}}for(let u=this.tiles.length-1;u>=0;u--){const p=this.tiles[u];$k.has(p.id)||(this._tiles.delete(p.id),this.tiles.splice(u,1),this._index.remove(p),k0.removed.push(p))}(k0.added.length||k0.removed.length)&&this.emit("update",k0),C3.pool.release(i),$k.clear(),k0.added.length=0,k0.removed.length=0}},of=class extends Te{constructor(){super(...arguments),this.color=new Ce([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25,this.multiHighlightEnabled=!1}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity&&this.multiHighlightEnabled===e.multiHighlightEnabled}};m([b({type:Ce})],of.prototype,"color",void 0),m([b({type:Ce})],of.prototype,"haloColor",void 0),m([b()],of.prototype,"haloOpacity",void 0),m([b()],of.prototype,"fillOpacity",void 0),m([b()],of.prototype,"multiHighlightEnabled",void 0),of=m([G("esri.views.2d.support.HighlightOptions")],of);const Vre=of,s$=t=>parseFloat(t)/100;function F4e(t,e,i){const r=typeof t.left=="string"?s$(t.left)*e:t.left,n=typeof t.right=="string"?s$(t.right)*e:t.right,o=typeof t.top=="string"?s$(t.top)*i:t.top,u=typeof t.bottom=="string"?s$(t.bottom)*i:t.bottom,p=o;return{xmin:r,xmax:Math.max(e-n,r),ymin:p,ymax:Math.max(i-u,o)}}function N4e(t,e,i,r){switch(e.type){case"rect":{const{width:n,height:o}=t,{xmin:u,xmax:p,ymin:g,ymax:w}=F4e(e,n,o),{x:S,y:T}=i;return S>u&&S<p&&T>g&&T<w}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||vP(e.path,[i.x,i.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?gP(e.geometry,r):X3(e.geometry,r))}}async function D4e(t,e,i){const r=Mie(e)?Iie(t,e):e;if(!t.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let n=new Set;const o=new Set;let u=!1,p=null,g=null;i!=null&&i.include?_U(i.include,wU(t,E=>{n.add(E),Tk(E,C=>o.add(C))},(E,C)=>{o.add(E),n.add(C)},E=>{p||(p=new Set),p.add(E)},E=>n.add(E),()=>u=!0)):(u=!0,n=new Set(t.allLayerViews),n.forEach(E=>{Tk(E,C=>o.add(C))})),i!=null&&i.exclude&&_U(i.exclude,wU(t,E=>{n.delete(E),Tk(E,C=>o.delete(C))},E=>o.delete(E),E=>{g||(g=new Set),g.add(E)}));const w=t.toMap(r),S=t.allLayerViews.filter(E=>!E.suspended&&n.has(E)&&E.clips.every(C=>N4e(t,C,r,w))).reverse();let T=[...u?t.graphicsView.hitTest(w).map(E=>({type:"graphic",graphic:E,layer:null,mapPoint:w})):[],...await Promise.all(S.map(E=>E.hitTest(w,r)).toArray())].filter(Rt).flat().filter(Rt);return T=T.filter(E=>{var C;return E.type!=="graphic"||((C=E.layer)==null?void 0:C.type)!=="subtype-group"||o.has(E.graphic.layer)}),p&&(T=T.filter(E=>!("graphic"in E)||!E.graphic||(p==null?void 0:p.has(hO(E.graphic))))),g&&(T=T.filter(E=>!("graphic"in E)||!E.graphic||!(g!=null&&g.has(hO(E.graphic))))),{screenPoint:r,results:T}}function wU(t,e,i,r,n,o){return u=>{if(u instanceof Cr){if(u.layer===t)o==null||o();else{const p=t.allLayerViews.find(g=>g.layer===u.layer);p&&(n==null||n(p))}r(hO(u))}else if(!("layer"in u&&"element"in u))if(u.type==="subtype-sublayer"){const p=t.allLayerViews.find(g=>g.layer===u.parent);p&&i(u,p)}else{const p=t.allLayerViews.find(g=>g.layer===u);p&&e(p)}}}function _U(t,e){if(t)if(Q2(t))for(const i of t)if(Q2(i))for(const r of i)e(r);else e(i);else e(t)}function hO(t){var i,r;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((r=t.sourceLayer)==null?void 0:r.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function Tk({layer:t},e){(t==null?void 0:t.type)==="subtype-group"&&t.sublayers.forEach(i=>{e(i)})}function j4e(t,e,i){const{ctx:r,canvas:n}=zre(t,i),o=r.getImageData(0,0,t.width,t.height),u=U4e(n,e);return Ure(n),{dataUrl:u,data:o}}function V4e(t,e){const{ctx:i,canvas:r}=zre(t,e),n=i.getImageData(0,0,t.width,t.height);return Ure(r),n}function zre(t,e){const i=z4e();e.premultipliedAlpha&&W4e(t),i.width=t.width,i.height=t.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&H4e(r),{ctx:r,canvas:i}}function Ure(t){t.width=0,t.height=0}function z4e(){return Ek==null&&(Ek=document.createElement("canvas")),Ek}let Ek=null;function U4e(t,e){const i=J4e[e.format],r=e.quality/100;return t.toDataURL(i,r)}function G4e(t,e){const i=q4e(t),r=K4e[i];return{format:i,quality:An(e??r,0,100)}}function B4e(t,e){return e/Math.max(t[0],t[1])}function GQe(t,e,i,r=0,n=0,o=t.width-r,u=t.height-n,p=!1){const{data:g}=t,{width:w,height:S,data:T}=e,E=o/w,C=u/S,L=Math.ceil(E/2),R=Math.ceil(C/2),F=t.width;for(let V=0;V<S;V++)for(let U=0;U<w;U++){const W=4*(U+(p?S-V-1:V)*w);let H=0,J=0,X=0,te=0,oe=0,pe=0;const de=(V+.5)*C;for(let ge=Math.floor(V*C);ge<(V+1)*C;ge++){const we=Math.abs(de-(ge+.5))/R,ke=(U+.5)*E,$e=we*we;for(let Fe=Math.floor(U*E);Fe<(U+1)*E;Fe++){const yt=Math.abs(ke-(Fe+.5))/L,qe=Math.sqrt($e+yt*yt);if(qe>=1)continue;let Ue=2*qe*qe*qe-3*qe*qe+1;const ei=4*(r+Fe+(n+ge)*F);pe+=Ue*g[ei+3],J+=Ue,X+=Ue*g[ei],te+=Ue*g[ei+1],oe+=Ue*g[ei+2],H+=Ue}}T[W]=X/H,T[W+1]=te/H,T[W+2]=oe/H,T[W+3]=pe/J}return e}function q4e(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Z4e}}function H4e(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function W4e(t){const e=t.data,i=e.length;for(let r=0;r<i;r+=4){const n=e[r+3];if(n!==255&&n>0){const o=255/n;e[r]=e[r]*o,e[r+1]=e[r+1]*o,e[r+2]=e[r+2]*o}}}const J4e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},SU=98,Z4e="png",K4e={png:100,jpg:SU,jpeg:SU},Gre={flipY:!0,premultipliedAlpha:!0};async function Y4e(t,e){const i=await Bre(t,e),{format:r,quality:n}=G4e(e==null?void 0:e.format,e==null?void 0:e.quality);return j4e(i,{format:r,quality:n,rotation:0,disableDecorations:!1},Gre)}async function X4e(t,e){const i=await Bre(t,e);return V4e(i,Gre)}function Bre(t,e){const i=tCe(e||{},eCe(t.stage,t.size),t.size,t.padding),r=Q4e(e,t.allLayerViews);return t.stage.takeScreenshot(i,r,t.backgroundColor,e==null?void 0:e.rotation)}function Q4e(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(r=>{const n=e.find(o=>o.layer.id===r.id);n!=null&&n.container&&i.push(n.container)}),i}function eCe(t,e){return Math.min(4,B4e(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function tCe(t,e,i,r){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let n=null;t.width!=null&&t.height!=null?n=[t.width,t.height]:t.width==null&&t.height!=null?n=[t.height,t.height]:t.width!=null&&t.height==null?n=[t.width,t.width]:t.width==null&&t.height==null&&(n=null);const o=i[0]-(r.left+r.right),u=i[1]-(r.top+r.bottom);let p,g,w=t.area||{x:0,y:0,width:o,height:u};if(n){const S=o/u,T=n[0]/n[1];if(T>S){const E=w.width/T;w={x:w.x,y:Math.round(w.y+(w.height-E)/2),width:w.width,height:Math.round(E)}}else{const E=w.height*T;w={x:Math.round(w.x+(w.width-E)/2),y:w.y,width:Math.round(E),height:w.height}}}else n=[w.width,w.height];return n[0]>w.width?(p=Math.min(n[0]/w.width,e),g=n[0]/w.width/p):(p=1,g=n[0]/w.width),{cropArea:{x:Math.round((w.x+r.left)*p),y:Math.round((w.y+r.top)*p),width:Math.round(w.width*p),height:Math.round(w.height*p)},outputScale:g,resolutionScale:p}}const xU=160;let X_=class extends Te{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=xU&&this.clear()},xU))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};m([b()],X_.prototype,"_timer",void 0),m([b()],X_.prototype,"stationary",null),X_=m([G("esri.views.2d.support.StationaryManager")],X_);const iCe=t=>t.includes("Brush");let qre=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),iCe(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function $U(t,e={}){return t.getContext("webgl2",e)||null}let Ik;function rCe(){return Ik||(Ik=oCe()),Ik}let nCe=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}};function sCe(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let i=$U(e,{failIfMajorPerformanceCaveat:!0});if(i==null&&(i=$U(e),i!=null&&(t.majorPerformanceCaveat=!0)),i==null)return i;t.available=!0,t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return r&&(t.supportsHighPrecisionFragment=r.precision>0),i}function oCe(){const t=new nCe,e=sCe(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function aCe(t){const e=rCe();return e.available?t==="3d"&&e.majorPerformanceCaveat?new re("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new re("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new re("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new re("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function lCe(t){return t&&"nodeType"in t}function uCe(t){return t&&typeof t.render=="function"}const TU={component:"esri-component"};let Ty=class extends Te{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,i;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((i=this.node)==null?void 0:i.id)}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(TU.component),i&&i.classList.remove(TU.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||lCe(e)?(this._set("widget",null),pR(e)):(uCe(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};m([b()],Ty.prototype,"id",null),m([b()],Ty.prototype,"node",null),m([Dt("node")],Ty.prototype,"castNode",null),m([b({readOnly:!0})],Ty.prototype,"widget",void 0),Ty=m([G("esri.views.ui.Component")],Ty);const o5=Ty,Hre="calcite-mode-";function cCe(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function Wre(){return cCe().startsWith("dark")}function Jre(){return`${Hre}${Wre()?"dark":"light"}`}function hCe(t){pCe(t),t.classList.add(Jre())}function pCe(t){Array.from(t.classList).forEach(e=>{e.startsWith(Hre)&&t.classList.remove(e)})}const dCe={left:0,top:0,bottom:0,right:0},Zre={bottom:30,top:15,right:15,left:15},Ph="esri-ui",Io={ui:Ph,corner:`${Ph}-corner`,innerContainer:`${Ph}-inner-container`,manualContainer:`${Ph}-manual-container`,cornerContainer:`${Ph}-corner-container`,topLeft:`${Ph}-top-left`,topRight:`${Ph}-top-right`,bottomLeft:`${Ph}-bottom-left`,bottomRight:`${Ph}-bottom-right`};function fCe(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function o$(t){return t===0?"0":`${t}px`}function Mk(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function kk(t,{top:e,bottom:i,left:r,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=r,t.style.right=n}let Oc=class extends Ar.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Ss(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&kk(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&kk(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ce(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,Qe),ce(()=>this.padding,this._applyUIPadding,Qe),ce(()=>[this.container,this._locale],([e,i])=>{e&&e.setAttribute("lang",i)},Qe),FI(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const i=this._get("container");e!==i&&(e&&(e.classList.add(Io.ui),hCe(e),this._attachContainers(e)),i&&(i.classList.remove(Io.ui),kk(i,{top:"",bottom:"",left:"",right:""}),Qte(i)),this._set("container",e))}get height(){var o;const e=((o=this.view)==null?void 0:o.height)??0;if(e===0)return e;const i=this._getViewPadding(),{top:r,bottom:n}=i;return Math.max(e-r-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Zre,...e}}get width(){var o;const e=((o=this.view)==null?void 0:o.width)??0;if(e===0)return e;const i=this._getViewPadding(),{left:r,right:n}=i;return Math.max(e-r-n,0)}add(e,i){let r,n,o;if(Array.isArray(e))return void e.forEach(p=>this.add(p,i));const u=Mk(e);u&&({index:r,position:i,component:e,key:n}=u),i&&typeof i=="object"&&({index:r,key:n,position:i,internal:o}=i),!e||i&&!this._isValidPosition(i)||this._add(e,i,r,n,o)}remove(e,i){var n,o;if(!e)return;if(Array.isArray(e))return e.map(u=>this.remove(u,i));const r=this._find(e);if(r){if(this._componentMap.has(r)&&((n=this._componentMap.get(r))==null?void 0:n.key)!==i)return;const u=this._components.indexOf(r),p=r.node.parentNode;return p==null||p.removeChild(r.node),this._componentMap.delete(r),(o=r.widget)==null||o.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(u,1)[0]}}empty(e,i={removeInternal:!1}){if(Array.isArray(e)){for(const o of e)this.empty(o,i);return}const r=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(r.children).map(o=>this._findByNode(o)).filter(o=>{var u;return o==null?!1:!(((u=this._componentMap.get(o))==null?void 0:u.internal)??!1)||i.removeInternal});for(const o of n)this.remove(o)}move(e,i){if(Array.isArray(e)&&e.forEach(u=>this.move(u,i)),!e)return;let r;const n=Mk(e)||Mk(i);if(n&&(r=n.index,i=n.position,e=n.component||e),i&&!this._isValidPosition(i))return;const o=this.remove(e);o&&this.add(o,{position:i,index:r})}find(e){if(!e)return null;const i=this._findById(e);return i&&(i.widget||i.node)}getComponents(e,i={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,i)):this._getComponentsAtPosition(e,i):this._components.filter(r=>{var n;return i.includeInternal||!((n=this._componentMap.get(r))!=null&&n.internal)}).map(({widget:r,node:n})=>r??n)}getPosition(e){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(e))return i;return null}_add(e,i,r,n,o){e instanceof o5||(e=new o5({node:e}));const{widget:u}=e;u!=null&&u instanceof Te&&u.addHandles(We(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey),this._place({component:e,position:i,index:r}),this._components.push(e),this._componentMap.set(e,{key:n,internal:o})}_find(e){return e?e instanceof o5?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??dCe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Io.innerContainer,Io.cornerContainer);const i=document.createElement("div");i.classList.add(Io.innerContainer,Io.manualContainer);const r=document.createElement("div");r.classList.add(Io.topLeft,Io.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(Io.topRight,Io.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Io.bottomLeft,Io.corner),e.appendChild(o);const u=document.createElement("div");u.classList.add(Io.bottomRight,Io.corner),e.appendChild(u),this._innerContainer=e,this._manualContainer=i;const p=Nm();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":o,"bottom-right":u,"top-leading":p?n:r,"top-trailing":p?r:n,"bottom-leading":p?u:o,"bottom-trailing":p?o:u},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const i=e.position??"manual",{component:r,index:n}=e,o=this._positionNameToContainerLookup[i],u=n!=null&&n>-1;if(fCe(r.widget)&&r.widget.startup(),!u)return void o.appendChild(r.node);const p=Array.from(o.children);if(n===0)return void(o.firstChild?xz(r.node,o.firstChild):o.appendChild(r.node));n>=p.length?o.appendChild(r.node):xz(r.node,p[n])}_toPixelPosition(e){return{top:o$(e.top),left:o$(e.left),right:o$(e.right),bottom:o$(e.bottom)}}_findByComponent(e){return this._components.find(i=>i===e)??null}_findById(e){return this._components.find(({id:i})=>i===e)??null}_findByNode(e){return this._components.find(({node:i})=>i===e)??null}_getComponentsAtPosition(e,i){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(n=>this._findByNode(n)).filter(Rt).filter(n=>{var o;return i.includeInternal||!((o=this._componentMap.get(n))!=null&&o.internal)}).map(({widget:n,node:o})=>n??o)}};m([b()],Oc.prototype,"_locale",void 0),m([b()],Oc.prototype,"container",null),m([b()],Oc.prototype,"height",null),m([b({value:Zre})],Oc.prototype,"padding",null),m([Dt("padding")],Oc.prototype,"castPadding",null),m([b()],Oc.prototype,"view",void 0),m([b()],Oc.prototype,"width",null),Oc=m([G("esri.views.ui.UI")],Oc);const yCe=Oc,mCe={handleInterceptedEvent:(t,e,i,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||i,[r]))},gCe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}},vCe=t=>({...gCe,...t}),bCe=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},wCe=(t,e)=>t.find(e),EU=(t,e,i=!1)=>{let r=t;return e.forEach((n,o)=>{const u=r!=null&&r.children?wCe(r.children,p=>p.domNode===n):void 0;i&&!u&&o!==e.length-1||(r=u)}),r},_Ce=t=>{let e;const i={...mCe,...t},r=vCe(i),n=r.performanceLogger;let o,u=!0,p=!1;const g=[],w=[],S=(E,C,L)=>{var V;let R;r.eventHandlerInterceptor=(U,W,H,J)=>function(X){let te;n("domEvent",X);const oe=bCe(X.currentTarget,R.domNode),pe=oe.some(ge=>{var we;return customElements.get((we=ge==null?void 0:ge.tagName)==null?void 0:we.toLowerCase())});if(X.eventPhase===Event.CAPTURING_PHASE||!pe)oe.reverse(),te=EU(R.getLastRender(),oe);else{const ge=X.composedPath(),we=ge.slice(ge.indexOf(X.currentTarget),ge.indexOf(R.domNode)).reverse();te=EU(R.getLastRender(),we,!0)}let de;return te&&(de=i.handleInterceptedEvent(e,te,this,X)),n("domEventProcessed",X),de},(V=i.postProcessProjectionOptions)==null||V.call(i,r);const F=L();R=E(C,F,r),r.eventHandlerInterceptor=void 0,g.push(R),w.push(L),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(R,F)};let T=()=>{if(o=void 0,u){u=!1,n("renderStart",void 0);for(let E=0;E<g.length;E++){const C=w[E]();n("rendered",void 0),g[E].update(C),n("patched",void 0)}n("renderDone",void 0),u=!0}};return i.modifyDoRenderImplementation&&(T=i.modifyDoRenderImplementation(T,g,w)),e={renderNow:T,scheduleRender:()=>{o||p||(o=requestAnimationFrame(T))},stop:()=>{o&&(cancelAnimationFrame(o),o=void 0),p=!0},resume:()=>{p=!1,u=!0,e.scheduleRender()},append:(E,C)=>{S(jf.append,E,C)},insertBefore:(E,C)=>{S(jf.insertBefore,E,C)},merge:(E,C)=>{S(jf.merge,E,C)},replace:(E,C)=>{S(jf.replace,E,C)},detach:E=>{for(let C=0;C<w.length;C++)if(w[C]===E)return w.splice(C,1),g.splice(C,1)[0];throw new Error("renderFunction was not found")}},e};/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const Kre="calcite-mode-auto",Yre="calcite-mode-dark",SCe="calcite-mode-light",ZQe={autoMode:Kre,darkMode:Yre,lightMode:SCe,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"},KQe={filter:250,nextTick:0,resize:150,reposition:100};var kl={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},xCe=Object.defineProperty,$Ce=(t,e)=>{for(var i in e)xCe(t,i,{get:e[i],enumerable:!0})},Xre=new WeakMap,eg=t=>Xre.get(t),TCe=(t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return Xre.set(t,i)},IU=(t,e)=>e in t,IS=(t,e)=>(0,console.error)(t,e),jE=new Map,ECe=[],ICe="slot-fb{display:contents}slot-fb[hidden]{display:none}",MU="http://www.w3.org/1999/xlink",MS=typeof window<"u"?window:{},Yu=MS.document||{head:{}},YQe=MS.HTMLElement||class{},ls={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,r)=>t.addEventListener(e,i,r),rel:(t,e,i,r)=>t.removeEventListener(e,i,r),ce:(t,e)=>new CustomEvent(t,e)},MCe=(()=>{let t=!1;try{Yu.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),kCe=t=>Promise.resolve(t),CCe=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),pO=!1,dO=[],Qre=[],ene=(t,e)=>i=>{t.push(i),pO||(pO=!0,e&&ls.$flags$&4?ACe(fO):ls.raf(fO))},kU=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(i){IS(i)}t.length=0},fO=()=>{kU(dO),kU(Qre),(pO=dO.length>0)&&ls.raf(fO)},ACe=t=>kCe().then(t),XQe=ene(dO,!1),LCe=ene(Qre,!0),OCe=t=>{const e=new URL(t,ls.$resourcesUrl$);return e.origin!==MS.location.origin?e.href:e.pathname},PCe=t=>ls.$resourcesUrl$=t,CU={},RCe="http://www.w3.org/2000/svg",FCe="http://www.w3.org/1999/xhtml",NCe=t=>t!=null,LR=t=>(t=typeof t,t==="object"||t==="function");function DCe(t){var e,i,r;return(r=(i=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:i.getAttribute("content"))!=null?r:void 0}var jCe={};$Ce(jCe,{err:()=>tne,map:()=>VCe,ok:()=>yO,unwrap:()=>zCe,unwrapErr:()=>UCe});var yO=t=>({isOk:!0,isErr:!1,value:t}),tne=t=>({isOk:!1,isErr:!0,value:t});function VCe(t,e){if(t.isOk){const i=e(t.value);return i instanceof Promise?i.then(r=>yO(r)):yO(i)}if(t.isErr){const i=t.value;return tne(i)}throw"should never get here"}var zCe=t=>{if(t.isOk)return t.value;throw t.value},UCe=t=>{if(t.isErr)return t.value;throw t.value},Dm=(t,e="")=>()=>{},ine=(t,e,...i)=>{let r=null,n=null,o=null,u=!1,p=!1;const g=[],w=T=>{for(let E=0;E<T.length;E++)r=T[E],Array.isArray(r)?w(r):r!=null&&typeof r!="boolean"&&((u=typeof t!="function"&&!LR(r))&&(r=String(r)),u&&p?g[g.length-1].$text$+=r:g.push(u?VE(null,r):r),p=u)};if(w(i),e){e.key&&(n=e.key),e.name&&(o=e.name);{const T=e.className||e.class;T&&(e.class=typeof T!="object"?T:Object.keys(T).filter(E=>T[E]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,g,qCe);const S=VE(t,null);return S.$attrs$=e,g.length>0&&(S.$children$=g),S.$key$=n,S.$name$=o,S},VE=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},GCe={},BCe=t=>t&&t.$tag$===GCe,qCe={forEach:(t,e)=>t.map(AU).forEach(e),map:(t,e)=>t.map(AU).map(e).map(HCe)},AU=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),HCe=t=>{if(typeof t.vtag=="function"){const i={...t.vattrs};return t.vkey&&(i.key=t.vkey),t.vname&&(i.name=t.vname),ine(t.vtag,i,...t.vchildren||[])}const e=VE(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},WCe=t=>ECe.map(e=>e(t)).find(e=>!!e),JCe=(t,e)=>t!=null&&!LR(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,ZCe=t=>t,QQe=(t,e,i)=>{const r=ZCe(t);return{emit:n=>KCe(r,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:n})}},KCe=(t,e,i)=>{const r=ls.ce(e,i);return t.dispatchEvent(r),r},LU=new WeakMap,YCe=(t,e,i)=>{let r=jE.get(t);CCe&&i?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,jE.set(t,r)},XCe=(t,e,i)=>{var r;const n=rne(e,i),o=jE.get(n);if(t=t.nodeType===11?t:Yu,o)if(typeof o=="string"){t=t.head||t;let u=LU.get(t),p;if(u||LU.set(t,u=new Set),!u.has(n)){{p=Yu.createElement("style"),p.innerHTML=o;const g=(r=ls.$nonce$)!=null?r:DCe(Yu);g!=null&&p.setAttribute("nonce",g),(!(e.$flags$&1)||e.$flags$&1&&t.nodeName!=="HEAD")&&t.insertBefore(p,t.querySelector("link"))}e.$flags$&4&&(p.innerHTML+=ICe),u&&u.add(n)}}else t.adoptedStyleSheets.includes(o)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,o]);return n},QCe=t=>{const e=t.$cmpMeta$,i=t.$hostElement$,r=e.$flags$,n=Dm("attachStyles",e.$tagName$),o=XCe(i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);r&10&&r&2&&(i["s-sc"]=o,i.classList.add(o+"-h"),r&2&&i.classList.add(o+"-s")),n()},rne=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),OU=(t,e,i,r,n,o)=>{if(i!==r){let u=IU(t,e),p=e.toLowerCase();if(e==="class"){const g=t.classList,w=PU(i),S=PU(r);g.remove(...w.filter(T=>T&&!S.includes(T))),g.add(...S.filter(T=>T&&!w.includes(T)))}else if(e==="style"){for(const g in i)(!r||r[g]==null)&&(g.includes("-")?t.style.removeProperty(g):t.style[g]="");for(const g in r)(!i||r[g]!==i[g])&&(g.includes("-")?t.style.setProperty(g,r[g]):t.style[g]=r[g])}else if(e!=="key")if(e==="ref")r&&r(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):IU(MS,p)?e=p.slice(2):e=p[2]+e.slice(3),i||r){const g=e.endsWith(nne);e=e.replace(t6e,""),i&&ls.rel(t,e,i,g),r&&ls.ael(t,e,r,g)}}else{const g=LR(r);if((u||g&&r!==null)&&!n)try{if(t.tagName.includes("-"))t[e]=r;else{const S=r??"";e==="list"?u=!1:(i==null||t[e]!=S)&&(t[e]=S)}}catch{}let w=!1;p!==(p=p.replace(/^xlink\:?/,""))&&(e=p,w=!0),r==null||r===!1?(r!==!1||t.getAttribute(e)==="")&&(w?t.removeAttributeNS(MU,e):t.removeAttribute(e)):(!u||o&4||n)&&!g&&(r=r===!0?"":r,w?t.setAttributeNS(MU,e,r):t.setAttribute(e,r))}}},e6e=/\s/,PU=t=>t?t.split(e6e):[],nne="Capture",t6e=new RegExp(nne+"$"),sne=(t,e,i)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,n=t&&t.$attrs$||CU,o=e.$attrs$||CU;for(const u of RU(Object.keys(n)))u in o||OU(r,u,n[u],void 0,i,e.$flags$);for(const u of RU(Object.keys(o)))OU(r,u,n[u],o[u],i,e.$flags$)};function RU(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var N1,mO,$b,zE=!1,UE=!1,OR=!1,Oa=!1,GE=(t,e,i,r)=>{var n;const o=e.$children$[i];let u=0,p,g,w;if(zE||(OR=!0,o.$tag$==="slot"&&(N1&&r.classList.add(N1+"-s"),o.$flags$|=o.$children$?2:1)),o.$text$!==null)p=o.$elm$=Yu.createTextNode(o.$text$);else if(o.$flags$&1)p=o.$elm$=Yu.createTextNode("");else{if(Oa||(Oa=o.$tag$==="svg"),p=o.$elm$=Yu.createElementNS(Oa?RCe:FCe,!zE&&kl.slotRelocation&&o.$flags$&2?"slot-fb":o.$tag$),Oa&&o.$tag$==="foreignObject"&&(Oa=!1),sne(null,o,Oa),!!p.getRootNode().querySelector("body")&&kl.scoped&&NCe(N1)&&p["s-si"]!==N1&&p.classList.add(p["s-si"]=N1),RR(p,r),o.$children$)for(u=0;u<o.$children$.length;++u)g=GE(t,o,u,p),g&&p.appendChild(g);o.$tag$==="svg"?Oa=!1:p.tagName==="foreignObject"&&(Oa=!0)}return p["s-hn"]=$b,o.$flags$&3&&(p["s-sr"]=!0,p["s-cr"]=mO,p["s-sn"]=o.$name$||"",p["s-rf"]=(n=o.$attrs$)==null?void 0:n.ref,w=t&&t.$children$&&t.$children$[i],w&&w.$tag$===o.$tag$&&t.$elm$&&A3(t.$elm$,!1)),p},A3=(t,e)=>{ls.$flags$|=1;const i=Array.from(t.childNodes);if(t["s-sr"]&&kl.experimentalSlotFixes){let r=t;for(;r=r.nextSibling;)r&&r["s-sn"]===t["s-sn"]&&r["s-sh"]===$b&&i.push(r)}for(let r=i.length-1;r>=0;r--){const n=i[r];n["s-hn"]!==$b&&n["s-ol"]&&(Wf(lne(n),n,PR(n)),n["s-ol"].remove(),n["s-ol"]=void 0,n["s-sh"]=void 0,OR=!0),e&&A3(n,e)}ls.$flags$&=-2},one=(t,e,i,r,n,o)=>{let u=t["s-cr"]&&t["s-cr"].parentNode||t,p;for(u.shadowRoot&&u.tagName===$b&&(u=u.shadowRoot);n<=o;++n)r[n]&&(p=GE(null,i,n,t),p&&(r[n].$elm$=p,Wf(u,p,PR(e))))},ane=(t,e,i)=>{for(let r=e;r<=i;++r){const n=t[r];if(n){const o=n.$elm$;hne(n),o&&(UE=!0,o["s-ol"]?o["s-ol"].remove():A3(o,!0),o.remove())}}},i6e=(t,e,i,r,n=!1)=>{let o=0,u=0,p=0,g=0,w=e.length-1,S=e[0],T=e[w],E=r.length-1,C=r[0],L=r[E],R,F;for(;o<=w&&u<=E;)if(S==null)S=e[++o];else if(T==null)T=e[--w];else if(C==null)C=r[++u];else if(L==null)L=r[--E];else if(a$(S,C,n))D1(S,C,n),S=e[++o],C=r[++u];else if(a$(T,L,n))D1(T,L,n),T=e[--w],L=r[--E];else if(a$(S,L,n))(S.$tag$==="slot"||L.$tag$==="slot")&&A3(S.$elm$.parentNode,!1),D1(S,L,n),Wf(t,S.$elm$,T.$elm$.nextSibling),S=e[++o],L=r[--E];else if(a$(T,C,n))(S.$tag$==="slot"||L.$tag$==="slot")&&A3(T.$elm$.parentNode,!1),D1(T,C,n),Wf(t,T.$elm$,S.$elm$),T=e[--w],C=r[++u];else{for(p=-1,g=o;g<=w;++g)if(e[g]&&e[g].$key$!==null&&e[g].$key$===C.$key$){p=g;break}p>=0?(F=e[p],F.$tag$!==C.$tag$?R=GE(e&&e[u],i,p,t):(D1(F,C,n),e[p]=void 0,R=F.$elm$),C=r[++u]):(R=GE(e&&e[u],i,u,t),C=r[++u]),R&&Wf(lne(S.$elm$),R,PR(S.$elm$))}o>w?one(t,r[E+1]==null?null:r[E+1].$elm$,i,r,u,E):u>E&&ane(e,o,w)},a$=(t,e,i=!1)=>t.$tag$===e.$tag$?t.$tag$==="slot"?"$nodeId$"in t&&i&&t.$elm$.nodeType!==8?!1:t.$name$===e.$name$:i?!0:t.$key$===e.$key$:!1,PR=t=>t&&t["s-ol"]||t,lne=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,D1=(t,e,i=!1)=>{const r=e.$elm$=t.$elm$,n=t.$children$,o=e.$children$,u=e.$tag$,p=e.$text$;let g;p===null?(Oa=u==="svg"?!0:u==="foreignObject"?!1:Oa,u==="slot"&&!zE||sne(t,e,Oa),n!==null&&o!==null?i6e(r,n,e,o,i):o!==null?(t.$text$!==null&&(r.textContent=""),one(r,null,e,o,0,o.length-1)):!i&&kl.updatable&&n!==null&&ane(n,0,n.length-1),Oa&&u==="svg"&&(Oa=!1)):(g=r["s-cr"])?g.parentNode.textContent=p:t.$text$!==p&&(r.data=p)},une=t=>{const e=t.childNodes;for(const i of e)if(i.nodeType===1){if(i["s-sr"]){const r=i["s-sn"];i.hidden=!1;for(const n of e)if(n!==i){if(n["s-hn"]!==i["s-hn"]||r!==""){if(n.nodeType===1&&(r===n.getAttribute("slot")||r===n["s-sn"])||n.nodeType===3&&r===n["s-sn"]){i.hidden=!0;break}}else if(n.nodeType===1||n.nodeType===3&&n.textContent.trim()!==""){i.hidden=!0;break}}}une(i)}},Ap=[],cne=t=>{let e,i,r;for(const n of t.childNodes){if(n["s-sr"]&&(e=n["s-cr"])&&e.parentNode){i=e.parentNode.childNodes;const o=n["s-sn"];for(r=i.length-1;r>=0;r--)if(e=i[r],!e["s-cn"]&&!e["s-nr"]&&e["s-hn"]!==n["s-hn"]&&!kl.experimentalSlotFixes)if(FU(e,o)){let u=Ap.find(p=>p.$nodeToRelocate$===e);UE=!0,e["s-sn"]=e["s-sn"]||o,u?(u.$nodeToRelocate$["s-sh"]=n["s-hn"],u.$slotRefNode$=n):(e["s-sh"]=n["s-hn"],Ap.push({$slotRefNode$:n,$nodeToRelocate$:e})),e["s-sr"]&&Ap.map(p=>{FU(p.$nodeToRelocate$,e["s-sn"])&&(u=Ap.find(g=>g.$nodeToRelocate$===e),u&&!p.$slotRefNode$&&(p.$slotRefNode$=u.$slotRefNode$))})}else Ap.some(u=>u.$nodeToRelocate$===e)||Ap.push({$nodeToRelocate$:e})}n.nodeType===1&&cne(n)}},FU=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",hne=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(hne)},Wf=(t,e,i)=>{const r=t==null?void 0:t.insertBefore(e,i);return RR(e,t),r},pne=t=>{const e=[];return t&&e.push(...t["s-scs"]||[],t["s-si"],t["s-sc"],...pne(t.parentElement)),e},RR=(t,e,i=!1)=>{var r;if(t&&e&&t.nodeType===1){const n=new Set(pne(e).filter(Boolean));if(n.size&&((r=t.classList)==null||r.add(...t["s-scs"]=[...n]),t["s-ol"]||i))for(const o of Array.from(t.childNodes))RR(o,t,!0)}},r6e=(t,e,i=!1)=>{var r,n,o,u,p;const g=t.$hostElement$,w=t.$cmpMeta$,S=t.$vnode$||VE(null,null),T=BCe(e)?e:ine(null,null,e);if($b=g.tagName,w.$attrsToReflect$&&(T.$attrs$=T.$attrs$||{},w.$attrsToReflect$.map(([E,C])=>T.$attrs$[C]=g[E])),i&&T.$attrs$)for(const E of Object.keys(T.$attrs$))g.hasAttribute(E)&&!["key","ref","style","class"].includes(E)&&(T.$attrs$[E]=g[E]);T.$tag$=null,T.$flags$|=4,t.$vnode$=T,T.$elm$=S.$elm$=g.shadowRoot||g,N1=g["s-sc"],zE=(w.$flags$&1)!==0,mO=g["s-cr"],UE=!1,D1(S,T,i);{if(ls.$flags$|=1,OR){cne(T.$elm$);for(const E of Ap){const C=E.$nodeToRelocate$;if(!C["s-ol"]){const L=Yu.createTextNode("");L["s-nr"]=C,Wf(C.parentNode,C["s-ol"]=L,C)}}for(const E of Ap){const C=E.$nodeToRelocate$,L=E.$slotRefNode$;if(L){const R=L.parentNode;let F=L.nextSibling;{let V=(r=C["s-ol"])==null?void 0:r.previousSibling;for(;V;){let U=(n=V["s-nr"])!=null?n:null;if(U&&U["s-sn"]===C["s-sn"]&&R===U.parentNode){for(U=U.nextSibling;U===C||U!=null&&U["s-sr"];)U=U==null?void 0:U.nextSibling;if(!U||!U["s-nr"]){F=U;break}}V=V.previousSibling}}(!F&&R!==C.parentNode||C.nextSibling!==F)&&C!==F&&(!C["s-hn"]&&C["s-ol"]&&(C["s-hn"]=C["s-ol"].parentNode.nodeName),Wf(R,C,F),C.nodeType===1&&(C.hidden=(o=C["s-ih"])!=null?o:!1)),C&&typeof L["s-rf"]=="function"&&L["s-rf"](C)}else C.nodeType===1&&(i&&(C["s-ih"]=(u=C.hidden)!=null?u:!1),C.hidden=!0)}}UE&&une(T.$elm$),ls.$flags$&=-2,Ap.length=0}if(kl.experimentalScopedSlotChanges&&w.$flags$&2)for(const E of T.$elm$.childNodes)E["s-hn"]!==$b&&!E["s-sh"]&&(i&&E["s-ih"]==null&&(E["s-ih"]=(p=E.hidden)!=null?p:!1),E.hidden=!0);mO=void 0},n6e=(t,e)=>{},FR=(t,e)=>(t.$flags$|=16,n6e(t,t.$ancestorComponent$),LCe(()=>s6e(t,e))),s6e=(t,e)=>{const i=t.$hostElement$,r=Dm("scheduleUpdate",t.$cmpMeta$.$tagName$),n=i;if(!n)throw new Error(`Can't render component <${i.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let o;return e?o=Vv(n,"componentWillLoad"):o=Vv(n,"componentWillUpdate"),o=NU(o,()=>Vv(n,"componentWillRender")),r(),NU(o,()=>a6e(t,n,e))},NU=(t,e)=>o6e(t)?t.then(e).catch(i=>{console.error(i),e()}):e(),o6e=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",a6e=async(t,e,i)=>{const r=t.$hostElement$,n=Dm("update",t.$cmpMeta$.$tagName$);r["s-rc"],i&&QCe(t);const o=Dm("render",t.$cmpMeta$.$tagName$);l6e(t,e,r,i),o(),n(),u6e(t)},DU=null,l6e=(t,e,i,r)=>{try{DU=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(kl.hasRenderFn||kl.reflect)&&(kl.vdomRender||kl.reflect)&&(kl.hydrateServerSide||r6e(t,e,r))}catch(g){IS(g,t.$hostElement$)}return DU=null,null},u6e=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,r=Dm("postUpdate",e),n=i;t.$ancestorComponent$,Vv(n,"componentDidRender"),t.$flags$&64?(Vv(n,"componentDidUpdate"),r()):(t.$flags$|=64,Vv(n,"componentDidLoad"),r())},eet=t=>{{const e=eg(t),i=e.$hostElement$.isConnected;return i&&(e.$flags$&18)===2&&FR(e,!1),i}},Vv=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(r){IS(r)}},c6e=(t,e)=>eg(t).$instanceValues$.get(e),h6e=(t,e,i,r)=>{const n=eg(t),o=t,u=n.$instanceValues$.get(e),p=n.$flags$,g=o;i=JCe(i,r.$members$[e][0]);const w=Number.isNaN(u)&&Number.isNaN(i);if(i!==u&&!w){n.$instanceValues$.set(e,i);{if(r.$watchers$&&p&128){const T=r.$watchers$[e];T&&T.map(E=>{try{g[E](i,u,e)}catch(C){IS(C,o)}})}if((p&18)===2){if(g.componentShouldUpdate&&g.componentShouldUpdate(i,u,e)===!1)return;FR(n,!1)}}}},p6e=(t,e,i)=>{var r,n;const o=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const u=Object.entries((r=e.$members$)!=null?r:{});u.map(([p,[g]])=>{(g&31||g&32)&&Object.defineProperty(o,p,{get(){return c6e(this,p)},set(w){h6e(this,p,w,e)},configurable:!0,enumerable:!0})});{const p=new Map;o.attributeChangedCallback=function(g,w,S){ls.jmp(()=>{var T;const E=p.get(g);if(this.hasOwnProperty(E))S=this[E],delete this[E];else{if(o.hasOwnProperty(E)&&typeof this[E]=="number"&&this[E]==S)return;if(E==null){const C=eg(this),L=C==null?void 0:C.$flags$;if(L&&!(L&8)&&L&128&&S!==w){const F=this,V=(T=e.$watchers$)==null?void 0:T[g];V==null||V.forEach(U=>{F[U]!=null&&F[U].call(F,S,w,g)})}return}}this[E]=S===null&&typeof this[E]=="boolean"?!1:S})},t.observedAttributes=Array.from(new Set([...Object.keys((n=e.$watchers$)!=null?n:{}),...u.filter(([g,w])=>w[0]&15).map(([g,w])=>{var S;const T=w[1]||g;return p.set(T,g),w[0]&512&&((S=e.$attrsToReflect$)==null||S.push([g,T])),T})]))}}return t},d6e=async(t,e,i,r)=>{let n;if(!(e.$flags$&32)){e.$flags$|=32,i.$lazyBundleId$;{n=t.constructor;const u=t.localName;customElements.whenDefined(u).then(()=>e.$flags$|=128)}if(n&&n.style){let u;typeof n.style=="string"?u=n.style:typeof n.style!="string"&&(e.$modeName$=WCe(t),e.$modeName$&&(u=n.style[e.$modeName$]));const p=rne(i,e.$modeName$);if(!jE.has(p)){const g=Dm("registerStyles",i.$tagName$);YCe(p,u,!!(i.$flags$&1)),g()}}}e.$ancestorComponent$,FR(e,!0)},jU=t=>{},f6e=t=>{if(!(ls.$flags$&1)){const e=eg(t),i=e.$cmpMeta$,r=Dm("connectedCallback",i.$tagName$);e.$flags$&1?(dne(t,e,i.$listeners$),e!=null&&e.$lazyInstance$?jU(e.$lazyInstance$):e!=null&&e.$onReadyPromise$&&e.$onReadyPromise$.then(()=>jU(e.$lazyInstance$))):(e.$flags$|=1,i.$flags$&12&&y6e(t),i.$members$&&Object.entries(i.$members$).map(([n,[o]])=>{if(o&31&&t.hasOwnProperty(n)){const u=t[n];delete t[n],t[n]=u}}),d6e(t,e,i)),r()}},y6e=t=>{const e=t["s-cr"]=Yu.createComment("");e["s-cn"]=!0,Wf(t,e,t.firstChild)},m6e=async t=>{if(!(ls.$flags$&1)){const e=eg(t);e.$rmListeners$&&(e.$rmListeners$.map(i=>i()),e.$rmListeners$=void 0)}},tet=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};i.$members$=e[2],i.$listeners$=e[3],i.$watchers$=t.$watchers$,i.$attrsToReflect$=[];const r=t.prototype.connectedCallback,n=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){TCe(this,i)},connectedCallback(){const o=eg(this);dne(this,o,i.$listeners$),f6e(this),r&&r.call(this)},disconnectedCallback(){m6e(this),n&&n.call(this)},__attachShadow(){if(!this.shadowRoot)this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)});else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${i.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=i.$tagName$,p6e(t,i)},iet=(t,e)=>e,dne=(t,e,i,r)=>{i&&i.map(([n,o,u])=>{const p=v6e(t,n),g=g6e(e,u),w=b6e(n);ls.ael(p,o,g,w),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>ls.rel(p,o,g,w))})},g6e=(t,e)=>i=>{var r;try{kl.lazyLoad||t.$hostElement$[e](i)}catch(n){IS(n)}},v6e=(t,e)=>e&4?Yu:e&8?MS:e&16?Yu.body:t,b6e=t=>MCe?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0;/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const Up=globalThis.calciteConfig,ret=(Up==null?void 0:Up.focusTrapStack)||[],net=(Up==null?void 0:Up.logLevel)||"info",VU="2.13.1",w6e="2024-10-11",_6e="6704555f8";function S6e(){if(Up&&Up.version)return;console.info(`Using Calcite Components ${VU} [Date: ${w6e}, Revision: ${_6e}]`);const t=Up||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:VU,writable:!1}),globalThis.calciteConfig=t}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */const fne=()=>typeof navigator<"u"&&typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;function x6e(){return navigator.userAgentData}function set(){if(!fne())return"";const t=x6e();return t!=null&&t.brands?t.brands.map(({brand:e,version:i})=>`${e}/${i}`).join(" "):navigator.userAgent}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.1
 */function zU(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(Yre)||t.contains(Kre)&&e?"dark":"light",r=u=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:u}})),n=u=>{o!==u&&r(u),o=u};let o=i();r(o),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",u=>n(u.matches?"dark":"light")),new MutationObserver(()=>n(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function $6e(){fne()&&(document.readyState==="interactive"?zU():document.addEventListener("DOMContentLoaded",()=>zU(),{once:!0})),S6e()}const T6e=$6e;T6e();let yne;function E6e(){try{OCe(".")}catch{PCe(Wo(qt(yne)))}}function zi(t){var i;const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push((i=t[r])==null?void 0:i.call(t));return e.length>0?Promise.all(e):null}yne="components/assets";const mne=Symbol("widget"),gne=Symbol("widget-test-data"),I6e=[],M6e={},BE=new WeakMap;function vne(t,e){let i=e.children;if(i!=null&&i.length)for(let n=0;n<i.length;++n)i[n]=vne(t,i[n]);else i=I6e;const r=e.vnodeSelector;if(qE(r)){const n=e.properties||M6e,o=n.key||r;return{vnodeSelector:"div",properties:{key:o,afterCreate:k6e,afterUpdate:C6e,afterRemoved:bne,parentWidget:t,widgetConstructor:r,widgetProperties:{...n,key:o,children:i}},children:void 0,text:void 0,domNode:null}}return e}function k6e(t,e,i,{parentWidget:r,widgetConstructor:n,widgetProperties:o}){var p;const u=new n(o);u.container=t,BE.set(t,u),(p=u.afterCreate)==null||p.call(u,u,t),r.addHandles(We(()=>bne(t))),queueMicrotask(()=>{u[gne].projector.renderNow()})}function C6e(t,e,i,{widgetProperties:r}){var o;const n=BE.get(t);n&&(n.set(r),(o=n.afterUpdate)==null||o.call(n,n,t))}function bne(t){var i;const e=BE.get(t);e&&((i=e.afterRemoved)==null||i.call(e,e,t),e.destroy(),BE.delete(t))}function qE(t){return typeof t=="function"&&t[mne]}const UU=new Set;function A6e(t){UU.add(t),t.finally(()=>UU.delete(t))}var wne;const L6e="esri.widgets.Widget";let O6e=0;function _ne(t,e){const i=Object.prototype.hasOwnProperty;for(const r in e)i.call(e,r)&&i.call(t,r)&&(t[r]!=null&&e[r]!=null&&typeof t[r]=="object"&&typeof e[r]=="object"?_ne(t[r],e[r]):t[r]=e[r]);return t}const P6e=_Ce({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(r,n,o,u)=>{const p=e==null?void 0:e(r,n,o,u),g=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in o)||g){const w=r[2].toLowerCase()+r.slice(3),S=C=>p==null?void 0:p.call(o,C);o.addEventListener(w,S,g);const T=()=>o.removeEventListener(w,S,g),E=u.afterRemoved;u.afterRemoved=C=>{E==null||E(C),T()}}return p}},handleInterceptedEvent(t,e,i,r){const{eventPhase:n,type:o}=r,u=n===Event.CAPTURING_PHASE;let p=`on${o}${u?"capture":""}`;const g=e.properties;(g&&p in g||(p=`on${o[0].toUpperCase()}${o.slice(1)}${u?"Capture":""}`,g&&p in g))&&(fie(),t.scheduleRender(),g[p].call(g.bind||i,r))}});let Ck=!1,jn=class extends Bb(Ar.EventedAccessor){constructor(e,i){super(e,i),this._attached=!1,this._projector=P6e,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=Da(async()=>{var g;if((g=this._messageBundleProps)!=null&&g.length){const w=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:S,propertyName:T})=>{if(this.destroyed)return;let E=await DI(S);this.uiStrings&&Object.keys(this.uiStrings)&&(E=_ne(ae(E),this.uiStrings)),this[T]=E}));if(this.destroyed)return;for(const S of w)S.status==="rejected"&&fe.getLogger(this).error("widget-intl:locale-error",this.declaredClass,S.reason)}await this.loadLocale()}),E6e();const r="esri-widget-uid-"+yM(),n=this.render.bind(this);this._trackingTarget=new II(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const o=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),u=()=>{var T,E;if(!this._readyForTrueRender||this.destroyed)return null;const g=n()??o(),w=g.properties??(g.properties={});if(w.key??(w.key=r),qE(g.vnodeSelector)){if(!this.visible)return o()}else this.visible?w.styles||(w.styles={}):(w.class="",w.styles={display:"none"}),(T=w.styles).display??(T.display="");let S=0;return(E=g.children)==null||E.forEach(C=>{var L;qE(C.vnodeSelector)||(C.properties??(C.properties={}),(L=C.properties).key??(L.key=`${this.id}--${S++}`))}),vne(this,g)};this.render=()=>{if(Ck)return u();let g=REe(this)??null;if(g)return g;this._trackingTarget.clear(),Ck=!0;try{g=Wp(this._trackingTarget,u)}catch(w){throw fe.getLogger(this).error(w),w}finally{Ck=!1}return g&&FEe(this,g),g};const p=this.beforeFirstRender();p?this._resourcesFetch=p.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),A6e(this._resourcesFetch)}normalizeCtorArgs(e,i){const r={...e};return i&&(r.container=i),r}postInitialize(){}beforeFirstRender(){var i;const e=this.loadDependencies();return(i=this._messageBundleProps)!=null&&i.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(D5):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(ot(this._trackingTarget),ot(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,uk(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return pR(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){var e;return this._get("id")||((e=this.container)==null?void 0:e.id)||Date.now().toString(16)+"-widget-"+O6e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(wne=mne,gne)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(uk(this),this._projector.scheduleRender())}own(e){xI(fe.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(e)}classes(...e){return Uu.apply(this,e)}renderNow(){uk(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this.addHandles(ce(()=>this.viewModel,(r,n)=>{n&&this.removeHandles("delegated-events"),r&&TI(r)&&this.addHandles(this._delegatedEventNames.map(o=>H3(r,o,u=>{this.emit(o,u)})),"delegated-events")},ri)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(D5),this.scheduleRender()};this.addHandles([FI(e),ce(()=>this.uiStrings,e),Fr(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=e==null?void 0:e.parentNode)==null||i.removeChild(e)}};jn[wne]=!0,m([b()],jn.prototype,"_readyForTrueRender",void 0),m([b({value:null})],jn.prototype,"container",null),m([Dt("container")],jn.prototype,"castContainer",null),m([b()],jn.prototype,"icon",null),m([b()],jn.prototype,"id",null),m([b()],jn.prototype,"label",null),m([b()],jn.prototype,"renderable",null),m([b()],jn.prototype,"uiStrings",void 0),m([b()],jn.prototype,"viewModel",void 0),m([b({value:!0})],jn.prototype,"visible",null),m([b()],jn.prototype,"key",void 0),m([b()],jn.prototype,"children",void 0),m([b()],jn.prototype,"afterCreate",void 0),m([b()],jn.prototype,"afterUpdate",void 0),m([b()],jn.prototype,"afterRemoved",void 0),jn=m([G(L6e)],jn);const vi=jn,R6e=new Map;function F6e(t){return R6e.get(t)}function GU(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function N6e(t,e){return t.length!==e.length||t.some((i,r)=>i.text!==e[r].text)}function Aw(t,e,i){!i||!e||t.find(r=>r.layerView===e&&r.text===i)||t.push({text:i,layerView:e})}function D6e(t){return t.type==="bing-maps"}const Rh=[];let j1=class extends Te{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ie,this.view=null,this._allLayerViewsChange=i=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const r=(n=this.view)==null?void 0:n.allLayerViews;r&&(this.addHandles(r.map(o=>ce(()=>{var u;return[o.suspended,(u=o.layer)==null?void 0:u.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),r.forEach(o=>{o.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(o.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),i!=null&&i.removed&&i.removed.forEach(o=>{this._pendingAttributions.delete(o),this._fetchedAttributionData.delete(o)}),this._updateAttributionItems()},this.addHandles([gi(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Fr(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var e;return(e=this.view)!=null&&e.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,i=e==null?void 0:e.allLayerViews;if(Rh.length=0,!e||!i)return void this._clear();i.forEach(n=>{var p,g;if(n.suspended||!((p=n.layer)!=null&&p.attributionVisible))return;const o=n.layer;if(GU(o,"user"))return void Aw(Rh,n,o.copyright);if(o.hasAttributionData){if(this._fetchedAttributionData.has(n)){const w=this._fetchedAttributionData.get(n);return void(w?Aw(Rh,n,this._getDynamicAttribution(w,e,o)):GU(o)&&Aw(Rh,n,o.copyright))}return void this._fetchAttributionData(n)}const u="portalItem"in o?(g=o.portalItem)==null?void 0:g.accessInformation:void 0;Aw(Rh,n,u||o.copyright)});const r=i.find(n=>{var o;return((o=n.layer)==null?void 0:o.type)==="integrated-mesh-3dtiles"});if(this.view&&r){const n=F6e(this.view);if(n){const o=n.getAttributionText();for(let u=0;u<o.length;++u)Aw(Rh,r,o[u])}}N6e(this.items,Rh)&&(this.items.removeAll(),this.items.addMany(Rh)),Rh.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const i=await Z3(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const r=i.ok?this._createContributionIndex(i.value,D6e(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,r)}this._updateAttributionItems()}_createContributionIndex(e,i){const r=e.contributors,n={};if(!r)return n;for(let o=0;o<r.length;o++){const u=r[o],p=u.coverageAreas;if(!p)return;for(const g of p){const w=g.bbox,S=g.zoomMin-(i&&g.zoomMin?1:0),T=g.zoomMax-(i&&g.zoomMax?1:0),E=new jt({xmin:w[1],ymin:w[0],xmax:w[3],ymax:w[2],spatialReference:Ge.WGS84}),C={extent:Dp(E),attribution:u.attribution||"",score:g.score!=null?g.score:100,id:o};for(let L=S;L<=T;L++)n[L]??(n[L]=[]),n[L].push(C)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,i,r){var S;const{extent:n,scale:o}=i;let u=((S=r.tileInfo)==null?void 0:S.scaleToZoom(o))??0;if(u=Math.min(e.maxKey??0,Math.round(u)),!n||u==null||u<=-1)return"";const p=e[u],g=Y3(n.center.clone().normalize(),i.spatialReference),w=new Set;return p?p.filter(T=>{const E=T.id,C=!w.has(E)&&g&&T.extent&&X3(T.extent,g);return C&&w.add(E),C}).sort((T,E)=>E.score-T.score||T.objectId-E.objectId).map(T=>T.attribution).join(", "):""}};m([b({readOnly:!0,type:Ie})],j1.prototype,"items",void 0),m([b({readOnly:!0})],j1.prototype,"state",null),m([b()],j1.prototype,"view",void 0),j1=m([G("esri.widgets.Attribution.AttributionViewModel")],j1);const Sne=j1,Ee={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function mm(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:V6e(t[e])}}}function j6e(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function V6e(t){return function(e,...i){j6e(e)?gR(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function vt(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var z6e=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},xne=function(t,e){for(var i=0,r=t.length;i<r;i++){var n=t[i];Array.isArray(n)?xne(n,e):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=z6e(n)),e.push(n))}},U6e=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return xne(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}};function N(t,e,...i){return typeof t!="function"||qE(t)?U6e(t,e,...i):t(e,...i)}function Jf(...t){return t}const bg="esri-attribution",wg={base:bg,poweredBy:`${bg}__powered-by`,sources:`${bg}__sources`,open:`${bg}--open`,sourcesOpen:`${bg}__sources--open`,link:`${bg}__link`};let uo=class extends vi{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Sne}initialize(){this.addHandles(gi(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[wg.open]:this._isOpen};return N("div",{bind:this,class:this.classes(wg.base,Ee.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return N("div",{class:wg.poweredBy},"Powered by"," ",N("a",{class:wg.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,r=i?0:void 0,{attributionText:n}=this,o={[wg.sourcesOpen]:e,[Ee.interactive]:i};return N("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(wg.sources,o),innerHTML:n,tabIndex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:r,clientWidth:n,scrollWidth:o}=e,u=o>n,p=this._attributionTextOverflowed!==u;if(this._attributionTextOverflowed=u,p&&(i=!0),this._isOpen){const g=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,g&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};m([b()],uo.prototype,"_isOpen",void 0),m([b()],uo.prototype,"_isInteractive",null),m([b()],uo.prototype,"_attributionTextOverflowed",void 0),m([b()],uo.prototype,"_prevSourceNodeHeight",void 0),m([b({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],uo.prototype,"attributionText",null),m([b()],uo.prototype,"icon",null),m([b()],uo.prototype,"itemDelimiter",void 0),m([b()],uo.prototype,"label",null),m([b(),vt("esri/widgets/Attribution/t9n/Attribution")],uo.prototype,"messages",void 0),m([b()],uo.prototype,"view",null),m([b({type:Sne})],uo.prototype,"viewModel",void 0),m([mm()],uo.prototype,"_toggleState",null),uo=m([G("esri.widgets.Attribution")],uo);const G6e=uo;function B6e(t){var e,i;return((e=t==null?void 0:t.spatialReference)==null?void 0:e.isWebMercator)||((i=t==null?void 0:t.spatialReference)==null?void 0:i.isGeographic)||!1}const LM=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return a0(r),this.goToOverride?this.goToOverride(r,i):r.goTo(i.target,i.options)}};return m([b()],e.prototype,"goToOverride",void 0),m([b()],e.prototype,"view",void 0),e=m([G("esri.widgets.support.GoTo")],e),e};let Ey=class extends LM(Te){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(ce(()=>this.view,this._updateRotationWatcher,Qe))}destroy(){this.view=null}get canShowNorth(){return B6e(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var e,i;(e=this.view)!=null&&e.ready&&(((i=this.view)==null?void 0:i.type)==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:me("mapview-essential-goto-duration")}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this._set("orientation",{x:0,y:0,z:i})}_updateRotationWatcher(e){this.removeAllHandles(),e&&this.addHandles(e.type==="2d"?ce(()=>e==null?void 0:e.rotation,this._updateForRotation,Qe):ce(()=>e==null?void 0:e.camera,this._updateForCamera,Qe))}};m([b({readOnly:!0})],Ey.prototype,"canShowNorth",null),m([b({readOnly:!0})],Ey.prototype,"orientation",void 0),m([b({readOnly:!0})],Ey.prototype,"state",null),m([b()],Ey.prototype,"view",void 0),Ey=m([G("esri.widgets.Compass.CompassViewModel")],Ey);const $ne=Ey,BU="esri-compass",qU={base:BU,iconContainer:`${BU}__icon-container`};let op=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new $ne,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,{messages:r}=this;return N("div",{class:this.classes(qU.base,Ee.widget)},N("calcite-button",{class:Ee.widgetButton,disabled:i==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},N("div",{"aria-hidden":"true",class:qU.iconContainer,title:r.reset},N("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};m([b()],op.prototype,"goToOverride",null),m([b()],op.prototype,"icon",null),m([b()],op.prototype,"label",null),m([b(),vt("esri/widgets/Compass/t9n/Compass")],op.prototype,"messages",void 0),m([b()],op.prototype,"view",null),m([b({type:$ne})],op.prototype,"viewModel",void 0),op=m([G("esri.widgets.Compass")],op);const Tne=op,HU="esri-navigation-toggle",WU={base:HU,isLayoutHorizontal:`${HU}--horizontal`};let V1=class extends Te{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(Fr(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var e,i;return(e=this.view)!=null&&e.ready&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._setNavigationMode()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_setNavigationMode(){var i;const e=(i=this.view)==null?void 0:i.inputManager;e&&(e.primaryDragAction=this._navigationMode==="pan"?"pan":"rotate")}};m([b({readOnly:!0})],V1.prototype,"state",null),m([b()],V1.prototype,"_navigationMode",void 0),m([b()],V1.prototype,"view",void 0),V1=m([G("esri.widgets.NavigationToggle.NavigationToggleViewModel")],V1);const Ene=V1;let ap=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Ene,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var n;const r=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan"?this._rotateButton:this._panButton;r==null||r.setFocus(),this.toggle()}}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var n,o;const e=((n=this.viewModel)==null?void 0:n.state)==="disabled",i=((o=this.viewModel)==null?void 0:o.navigationMode)==="pan",r=this.messages.toggle;return N("div",{class:this.classes(WU.base,Ee.widget,{[WU.isLayoutHorizontal]:this.layout==="horizontal"})},N("calcite-button",{afterCreate:u=>{this._panButton=u},appearance:i?"outline-fill":"solid",class:Ee.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?void 0:-1,title:r}),N("calcite-button",{afterCreate:u=>{this._rotateButton=u},appearance:i?"solid":"outline-fill",class:Ee.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?-1:void 0,title:r}))}};m([b()],ap.prototype,"icon",null),m([b()],ap.prototype,"label",null),m([b({value:"vertical"})],ap.prototype,"layout",null),m([b(),vt("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ap.prototype,"messages",void 0),m([b()],ap.prototype,"view",null),m([b({type:Ene})],ap.prototype,"viewModel",void 0),ap=m([G("esri.widgets.NavigationToggle")],ap);const q6e=ap;let Iy=class extends Te{get canZoomIn(){var r,n,o;if(!((r=this.view)==null?void 0:r.ready))return!1;const i=(o=(n=this.view)==null?void 0:n.constraints)==null?void 0:o.effectiveMaxScale;return i===0||this._scale>i}get canZoomOut(){var n;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const r=(n=e.constraints)==null?void 0:n.effectiveMinScale;return r===0||this._scale<r}get _scale(){var i,r,n;const e=(r=(i=this.view)==null?void 0:i.animation)==null?void 0:r.target;return(e&&"then"in e||e==null?void 0:e.scale)??((n=this.view)==null?void 0:n.scale)??0}};m([b({readOnly:!0})],Iy.prototype,"canZoomIn",null),m([b({readOnly:!0})],Iy.prototype,"canZoomOut",null),m([b()],Iy.prototype,"view",void 0),m([b()],Iy.prototype,"_scale",null),Iy=m([G("esri.widgets.Zoom.ZoomConditions2D")],Iy);const H6e=Iy;let z1=class extends Te{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};m([b({readOnly:!0})],z1.prototype,"canZoomIn",null),m([b({readOnly:!0})],z1.prototype,"canZoomOut",null),m([b()],z1.prototype,"view",void 0),z1=m([G("esri.widgets.Zoom.ZoomConditions3D")],z1);const W6e=z1;let af=class extends Te{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new H6e({view:e}):e.type==="3d"&&(this._zoomConditions=new W6e({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Wu(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Wu(e.goTo({zoomFactor:.5}))}};m([b()],af.prototype,"_zoomConditions",void 0),m([b()],af.prototype,"canZoomIn",null),m([b()],af.prototype,"canZoomOut",null),m([b({readOnly:!0})],af.prototype,"state",null),m([b()],af.prototype,"view",null),af=m([G("esri.widgets.Zoom.ZoomViewModel")],af);const Ine=af,JU={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let lp=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Ine,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[JU.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:r}=this.viewModel,{zoomIn:n,zoomOut:o}=this.messages;return N("div",{class:this.classes(JU.base,Ee.widget,e)},N("calcite-button",{class:Ee.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),N("calcite-button",{class:Ee.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};m([b()],lp.prototype,"icon",null),m([b()],lp.prototype,"label",null),m([b({value:"vertical"})],lp.prototype,"layout",null),m([b(),vt("esri/widgets/Zoom/t9n/Zoom")],lp.prototype,"messages",void 0),m([b()],lp.prototype,"view",null),m([b({type:Ine})],lp.prototype,"viewModel",void 0),lp=m([G("esri.widgets.Zoom")],lp);const J6e=lp;function Z6e(t){return(t==null?void 0:t.view)!==void 0}let a5=class extends yCe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(r=>{const n=this._find(r),o=n==null?void 0:n.widget;Z6e(o)&&(o.view=i)})},this._componentsWatcher=(i,r)=>{this._removeComponents(r),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([ce(()=>this.components,this._componentsWatcher,Qe),ce(()=>this.view,this._updateViewAwareWidgets,Qe)])}_add(e,i,r,n,o){let u=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;u=this._createComponent(e)}super._add(u,i,r,n,o)}_removeComponents(e){e.forEach(i=>{const r=this._find(i);r&&(this.remove(r),r.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(e){this.constructed&&e.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(e){const i=this._createWidget(e);return new o5({id:e,node:i})}_createWidget(e){const i=this.view;switch(e){case"attribution":return new G6e({view:i});case"compass":return new Tne({view:i});case"navigation-toggle":return new q6e({view:i});case"zoom":return new J6e({view:i})}}};m([b()],a5.prototype,"components",void 0),a5=m([G("esri.views.ui.DefaultUI")],a5);const Mne=a5;let l5=class extends Mne{constructor(e){super(e),this.components=["attribution","zoom"]}};m([b()],l5.prototype,"components",void 0),l5=m([G("esri.views.ui.2d.DefaultUI2D")],l5);const kne=l5;function gO(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}let Cne,Ane,Lne,One,Pne,Rne;async function K6e(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:r,MagnifierView2D:n,Stage:o}]=await Promise.all([ie(()=>import("./webglDeps-kz7LeiOp.js"),__vite__mapDeps([143,74,72,45,73,144,145,146])),ie(()=>import("./mapViewDeps-CS44jmb5.js"),__vite__mapDeps([147,81,79,80,14,82,69,83,75,148,108,86,45,76,77,40,72,73,74,71,46,78,87,88,89,149,150,146,151,145,95,117,116,12,13,15,115,143,144,152,92,153,70,30,28,17,154,155,156,157,158,159,59,160,90,161,85,162,163,164,165,166,167,168]))]);Ane=t,Lne=e,One=i,Pne=r,Rne=n,Cne=o}let ct=class extends U5e(yIe(iIe(iMe))){constructor(e){super(e),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new c3({getCollections:()=>{var i,r;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new n5({view:this}),this.graphicsView=null,this.stateManager=new lo({constraints:new Cre({view:this})}),this.stationaryManager=new X_,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new Rke(this),this.floors=new Ie,this.highlightOptions=new Vre,this.inputManager=new M4e({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new qre,this.type="2d",this.ui=new kne,this.test={takeScreenshot:async i=>X4e(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ce(()=>this.viewpoint,()=>this.stationaryManager.flip(),$s),this.on("resize",i=>this.stateManager.resize(i.width,i.height))]),j3e()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=ot(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new R4e(this.featuresTilingScheme)}get constraintsInfo(){var r,n;const e=(r=this.defaultsFromMap)==null?void 0:r.tileInfo,i=this.spatialReference;return{lods:(n=e==null?void 0:e.spatialReference)!=null&&n.equals(i)?e.lods:null,spatialReference:i}}get state(){return this.stateManager.state}get initialExtentRequired(){var p;if(!this.stateManager)return!1;const{scale:e,constraints:i,center:r,viewpoint:n,extent:o}=this;let u=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((p=this.map.initialViewProperties)!=null&&p.viewpoint))&&!o&&(i!=null&&i.effectiveLODs||(u=-1),(!r||e===0&&u===-1)&&((n==null?void 0:n.targetGeometry)==null||n.targetGeometry.type!=="extent"&&!n.scale))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=e.targetGeometry,r=this.spatialReference;return Tte(i.spatialReference,r)}set animation(e){const i=this._get("animation");if(e===i)return;if(i&&i.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",e),this.frameTask.animationInProgress=!0;const r=()=>{var n;this.destroyed||(e===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask.animationInProgress=!1)};e.when(r,r)}get background(){return gO(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get constraints(){var e;return(e=this.stateManager)==null?void 0:e.constraints}set constraints(e){e.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=e,i==null||i.destroy()}get extent(){var e;return((e=this.stateManager)==null?void 0:e.extent)??null}set extent(e){this.stateManager.extent=e}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=i}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get tileInfo(){var e;return(e=this.featuresTilingScheme)==null?void 0:e.tileInfo}get updating(){var r,n,o,u;const e=!(!this.magnifier.visible||this.magnifier.position===null||!((r=this._magnifierView)!=null&&r.updatingHandles.updating)),i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(p=>!p.destroyed&&!("layerViews"in p)&&p.updating===!0)||e);if(me("esri-2d-log-updating")){const p=this.allLayerViews.reduce((g,w)=>({...g,[`${w.layer.id}(${w.layer.type})`]:!w.destroyed&&!("layerViews"in w)&&w.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(n=this.layerViewManager)==null?void 0:n.updating}
-> labelManager.updating: ${(o=this.labelManager)==null?void 0:o.updating}
-> graphicsView.updating: ${(u=this.graphicsView)==null?void 0:u.updating}
-> allLayerViews: ${JSON.stringify(p)}
-> updatingMagnifier: ${e}
`)}return i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}goTo(e,i){return this.goToManager.goTo(e,i)}async hitTest(e,i){return D4e(this,e,i)}async takeScreenshot(e){return Y4e(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const i=Mie(e)?Iie(this,e):e;return this.stateManager.toMap(i)}toScreen(e,i){return this.stateManager.toScreen(e,i)}on(e,i,r,n){return this.inputManager&&this.viewEvents.on(e,i,r,n)||super.on(e,i)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,i,r;return this.map&&"initialViewProperties"in this.map&&((i=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:i.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}getDefaultTimeZone(){return gO(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(e){return nU.hasLayerViewModule(e)}importLayerView(e){return nU.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(fe.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var w;const i=this.toMap(e),r=await this.hitTest(e),n=this.allLayerViews.toArray().reverse(),o=new globalThis.Map(n.map(S=>[S.layer.uid,S])),u=[];let p=0,g=0;for(;p<r.results.length||g<n.length;){const S=r.results.at(p);if(S&&S.type!=="graphic"){++p;continue}const T=o.get((w=(S==null?void 0:S.layer)??(S==null?void 0:S.graphic.layer))==null?void 0:w.uid);if((!S||T)&&g<n.length&&n.at(g)!==T){const E=n.at(g);"fetchPopupFeaturesAtLocation"in E&&u.push({mapPoint:i,layerView:E}),++g}else S&&(u.push({graphic:S.graphic,layerView:T}),++p)}return{hits:u,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=aCe(this.type);if(me("safari")&&me("safari")<9&&(e=new re("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:me("safari")})),e!=null)throw fe.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return K6e()}_getDefaultViewpoint(){var F;const{constraints:e,initialExtent:i,map:r,padding:n,size:o}=this;if(!e)return null;const u=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,p=this.stateManager.getUserStartupOptions(this.size),g=u==null?void 0:u.viewpoint,w=((F=g==null?void 0:g.targetGeometry)==null?void 0:F.extent)??i,S=w==null?void 0:w.center,T=(g==null?void 0:g.rotation)??0,E=(g==null?void 0:g.scale)||w&&kM(w,[o[0]-n.left-n.right,o[1]-n.top-n.bottom]),C=p.center??S,L=p.rotation??T,R=p.scale??E;return C&&R?new Mn({targetGeometry:C,scale:R,rotation:L}):null}_startup(){var p;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(p=this.defaultsFromMap.extent)==null?void 0:p.center),this.graphics.owner=this;const i=new Cne(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=i,this._magnifierView=new Rne,this._magnifierView.magnifier=this.magnifier;const r=new One({view:this});this._set("labelManager",r);const n=new Pke({view:this});this._set("animationManager",n);const o=new Pne({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",g=>this.fatalError=g.error),ce(()=>this.stationary,g=>i.stationary=g,ri),ce(()=>this.background,g=>{i.backgroundColor=g==null?void 0:g.color,this._magnifierView.backgroundColor=g==null?void 0:g.color},ri),ce(()=>this.magnifier,g=>this._magnifierView.magnifier=g,ri),ce(()=>this.renderingOptions,g=>i.renderingOptions=g,ri),ce(()=>this.highlightOptions,g=>i.highlightOptions=g,ri),ce(()=>this.state.id,()=>i.state=this.state,ri)],"map-view"),this._updateStageChildren();const u=this._resolveWhenReady;this._resolveWhenReady=[],u.forEach(g=>g(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this.stage.addChild(i.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new Gke(V5e.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new Ane({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Lne(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var u;const{allLayerViews:i,padding:r,size:n,stage:o}=this;return{allLayerViews:i,backgroundColor:e!=null&&e.ignoreBackground?null:(u=this.background)==null?void 0:u.color,padding:r,size:n,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};ct.type="2d",m([b({readOnly:!0})],ct.prototype,"animationManager",void 0),m([b({constructOnly:!0})],ct.prototype,"deactivatedWebGLExtensions",void 0),m([b({constructOnly:!0})],ct.prototype,"debugWebGLExtensions",void 0),m([b({readOnly:!0})],ct.prototype,"featuresTilingScheme",void 0),m([b({readOnly:!0})],ct.prototype,"fullOpacity",void 0),m([b()],ct.prototype,"goToManager",void 0),m([b({readOnly:!0})],ct.prototype,"graphicsTileStore",null),m([b()],ct.prototype,"graphicsView",void 0),m([b()],ct.prototype,"stateManager",void 0),m([b()],ct.prototype,"constraintsInfo",null),m([b({readOnly:!0})],ct.prototype,"state",null),m([b()],ct.prototype,"initialExtentRequired",null),m([b()],ct.prototype,"labelManager",void 0),m([b({readOnly:!0})],ct.prototype,"mapViewNavigation",void 0),m([b({constructOnly:!0})],ct.prototype,"renderCanvas",void 0),m([b()],ct.prototype,"renderingOptions",void 0),m([b({constructOnly:!0})],ct.prototype,"supersampleScreenshotsEnabled",void 0),m([b({readOnly:!0})],ct.prototype,"supportsGround",void 0),m([b()],ct.prototype,"_defaultsFromMapSettings",null),m([b({readOnly:!0})],ct.prototype,"typeSpecificPreconditionsReady",null),m([b()],ct.prototype,"animation",null),m([b({type:_M})],ct.prototype,"background",null),m([b()],ct.prototype,"center",null),m([b({type:Cre})],ct.prototype,"constraints",null),m([b()],ct.prototype,"extent",null),m([b()],ct.prototype,"floors",void 0),m([b({type:Vre})],ct.prototype,"highlightOptions",void 0),m([b({readOnly:!0})],ct.prototype,"inputManager",void 0),m([b()],ct.prototype,"map",void 0),m([b()],ct.prototype,"padding",null),m([b({readOnly:!0})],ct.prototype,"rendering",null),m([b()],ct.prototype,"resizeAlign",null),m([b({readOnly:!0})],ct.prototype,"resolution",null),m([b()],ct.prototype,"rotation",null),m([b()],ct.prototype,"scale",null),m([b({constructOnly:!0})],ct.prototype,"spatialReferenceLocked",void 0),m([b()],ct.prototype,"stationary",null),m([b({readOnly:!0})],ct.prototype,"tileInfo",null),m([b({type:qre,readOnly:!0})],ct.prototype,"timeline",void 0),m([b({readOnly:!0})],ct.prototype,"type",void 0),m([b({readOnly:!0})],ct.prototype,"updating",null),m([b()],ct.prototype,"viewpoint",null),m([b()],ct.prototype,"zoom",null),m([b({readOnly:!0})],ct.prototype,"navigating",null),m([b(),Dt(t=>t instanceof Mne?t:J3(kne,t))],ct.prototype,"ui",void 0),ct=m([G("esri.views.MapView")],ct);const Y6e=ct;let xu=class extends Te{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,i,r,n;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.isSecureUrl?(n=(r=this.editedBookmark)==null?void 0:r.thumbnail)==null?void 0:n.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,i,r,n;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.isDataURI?(n=(r=this.editedBookmark)==null?void 0:r.thumbnail)==null?void 0:n.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,i,r,n;return(i=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&i.url?(n=(r=this.editedBookmark)==null?void 0:r.thumbnail)!=null&&n.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};m([b()],xu.prototype,"bookmark",void 0),m([b({readOnly:!0})],xu.prototype,"editedBookmark",null),m([b()],xu.prototype,"customUrl",null),m([b()],xu.prototype,"screenshotUrl",null),m([b()],xu.prototype,"state",null),m([b()],xu.prototype,"thumbnailState",null),m([b()],xu.prototype,"validationState",void 0),m([b()],xu.prototype,"loading",void 0),xu=m([G("esri.widgets.Bookmarks.BookmarksUserState")],xu);const vO=xu,Fne=Ie.ofType(cR),X6e={width:128,height:128,format:"png"},l$={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},ZU={time:!0};let $u=class extends LM(Ar.EventedAccessor){constructor(e){super(e),this.capabilities={...ZU},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castCapabilities(e){return{...ZU,...e}}get bookmarks(){var e,i;return((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.bookmarks)??new Fne}set bookmarks(e){this._overrideIfSome("bookmarks",e)}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...l$,...e})}get defaultCreateOptions(){return l$}set defaultEditOptions(e){this._set("defaultEditOptions",{...l$,...e})}get defaultEditOptions(){return l$}get state(){const{view:e}=this;return e&&!e.ready?"loading":"ready"}async createBookmark(e){const{view:i,defaultCreateOptions:r,capabilities:n}=this;if(!i)throw new re("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:o,screenshotSettings:u,captureViewpoint:p,captureRotation:g,captureScale:w,captureTimeExtent:S}={...r,...e},T=o?await this._createThumbnail(u):void 0,E=n.time&&S&&i.timeExtent!=null?i.timeExtent.clone():void 0;return new cR({...T&&{thumbnail:T},...S&&{timeExtent:E},...p&&{viewpoint:this._createViewpoint({view:i,captureScale:w,captureRotation:g})}})}async editBookmark(e,i){if(!e)return e;const{view:r,defaultEditOptions:n}=this;if(!r)throw new re("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:o,screenshotSettings:u,captureViewpoint:p,captureRotation:g,captureScale:w,captureTimeExtent:S}={...n,...i},T=o?await this._createThumbnail(u):void 0;return T&&(e.thumbnail=T),p&&(e.viewpoint=this._createViewpoint({view:r,captureScale:w,captureRotation:g})),S&&r.timeExtent!=null&&(e.timeExtent=r.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{capabilities:i,view:r}=this;if(!r)throw new re("go-to:invalid-view","Cannot go to a bookmark without a view");const n=e==null?void 0:e.viewpoint;if(!n)throw new re("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});this._set("activeBookmark",e);const o={target:n},u=this.callGoTo(o),p=e==null?void 0:e.timeExtent;return i.time&&p&&(r.timeExtent=p),this.emit("bookmark-select",{bookmark:e}),u.catch(()=>{}).then(()=>this._set("activeBookmark",null)),u}async _createThumbnail(e){const{view:i}=this;if(!i)throw new re("bookmark:invalid-view","Cannot create slide thumbnail without a view");const r=await i.takeScreenshot({...X6e,...e});return new Fa({url:r.dataUrl})}_createViewpoint({view:e,captureRotation:i,captureScale:r}){var o,u;const n=(o=e.viewpoint)==null?void 0:o.clone();return new Mn({targetGeometry:(u=e.extent)==null?void 0:u.clone(),rotation:(i?n==null?void 0:n.rotation:null)??0,scale:(r?n==null?void 0:n.scale:null)??0})}};m([b()],$u.prototype,"capabilities",void 0),m([Dt("capabilities")],$u.prototype,"castCapabilities",null),m([b({readOnly:!0})],$u.prototype,"activeBookmark",void 0),m([b({type:Fne})],$u.prototype,"bookmarks",null),m([b()],$u.prototype,"defaultCreateOptions",null),m([b()],$u.prototype,"defaultEditOptions",null),m([b({readOnly:!0})],$u.prototype,"state",null),m([b()],$u.prototype,"view",void 0),$u=m([G("esri.widgets.Bookmarks.BookmarksViewModel")],$u);const Nne=$u;let _a=class extends Te{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}get addBookmark(){return wo(fe.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton}set addBookmark(e){wo(fe.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton=e}};m([b({type:Boolean,nonNullable:!0})],_a.prototype,"addBookmark",null),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"addBookmarkButton",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"closeButton",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"collapseButton",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"editBookmarkButton",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"filter",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"flow",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"heading",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"thumbnail",void 0),m([b({type:Boolean,nonNullable:!0})],_a.prototype,"time",void 0),_a=m([G("esri.widgets.Bookmarks.BookmarksVisibleElements")],_a);const bO=_a,fo="esri-bookmarks",Ak=`${fo}__authoring`,Lk=`${fo}__bookmark`,Kr={base:fo,noBookmarksHeader:`${fo}__no-bookmarks-heading`,noBookmarksDescription:`${fo}__no-bookmarks-description`,form:`${fo}__form`,list:`${fo}__list`,loader:`${fo}__loader`,filterNoResults:`${fo}__filter-no-results`,formContent:`${fo}__form-content`,addBookmarkButton:`${fo}__add-bookmark-button`,editBookmarkInput:`${fo}__edit-bookmark-input`,addBookmarkInput:`${fo}__add-bookmark-input`,dragEnabled:`${fo}--drag-enabled`,bookmarkImage:`${fo}__image`,bookmarkImageContainer:`${Lk}-image-container`,bookmarkContent:`${Lk}-content`,bookmarkContentLabel:`${Lk}-content-label`,authoring:Ak,authoringImageContainer:`${Ak}-image-container`,authoringRefreshThumbnailButton:`${Ak}-refresh-thumbnail-button`};function jl({level:t,class:e,...i},r){const n=Dne(t);return N(`h${n}`,{...i,"aria-level":String(n),class:Uu(Ee.heading,e),role:"heading"},r)}function Dne(t){return An(Math.ceil(t),1,6)}function zv(t,e=1){return Dne(t+e)}function v0(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,r=Array.isArray(t)?t:Q6e(t);i.push(...r)}}function Q6e(t){return t.split(",").map(e=>e.trim())}let Gi=class extends nc(vi){constructor(e,i){super(e,i),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new Nne,this.visibleElements=new bO,this._onCalciteListOrderChange=r=>{const{_lastDragDetail:n,bookmarks:o}=this,{toEl:u,fromEl:p,dragEl:g,newIndex:w}=r;if(!o.length||!p||!u||(n==null?void 0:n.newIndex)===w&&(n==null?void 0:n.dragEl)===g&&(n==null?void 0:n.toEl)===u&&(n==null?void 0:n.fromEl)===p)return;this._lastDragDetail=r;const S=Array.from(p.children).filter(T=>T==null?void 0:T.matches("calcite-list-item")).map(T=>T.value);o.sort((T,E)=>{const C=S.indexOf(T.uid),L=S.indexOf(E.uid);return C>L?1:C<L?-1:0})}}normalizeCtorArgs(e){return(e==null?void 0:e.editingEnabled)!=null&&e.visibleElements!=null?{...e,visibleElements:new bO({...e.visibleElements,addBookmarkButton:e.editingEnabled,editBookmarkButton:e.editingEnabled})}:e}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),"chip-group":()=>ie(()=>import("./calcite-chip-group-BlfANbY0.js"),__vite__mapDeps([234,220,221,224])),chip:()=>ie(()=>import("./calcite-chip-CizeI5-9.js"),__vite__mapDeps([235,236,220,224,228,225,226,227,221,223,229])),fab:()=>ie(()=>import("./calcite-fab-cnv1QGH6.js"),__vite__mapDeps([237,220,221,224,218,219,222,223,225,226,227,228,229,230])),flow:()=>ie(()=>import("./calcite-flow-CExHLkC9.js"),__vite__mapDeps([238,227,224])),"flow-item":()=>ie(()=>import("./calcite-flow-item-BieRNoUa.js"),__vite__mapDeps([239,220,221,224,225,226,227,228,240,241,242,233,223,229,230,243,244,245,246,247,248,249,250])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),input:()=>ie(()=>import("./calcite-input-Dl0Mk_X_.js"),__vite__mapDeps([251,252,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),"input-message":()=>ie(()=>import("./calcite-input-message-DUzlrVMh.js"),__vite__mapDeps([257,255,220,229,227])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227])),notice:()=>ie(()=>import("./calcite-notice-mqUu1NoI.js"),__vite__mapDeps([266,267,227,220,224,225,226,228,247,223,229])),scrim:()=>ie(()=>import("./calcite-scrim-CBy6Hnad.js"),__vite__mapDeps([268,250,225,220,226,227,228,230])),switch:()=>ie(()=>import("./calcite-switch-Bg2wMLH-.js"),__vite__mapDeps([269,220,219,221,226,222,223,224])),table:()=>ie(()=>import("./calcite-table-Dv69p7Kv.js"),__vite__mapDeps([270,224,228,225,220,226,227,218,219,221,222,223,229,230,236])),"table-cell":()=>ie(()=>import("./calcite-table-cell-C7qVMk8W.js"),__vite__mapDeps([271,272,224,228,225,220,226,227,221])),"table-header":()=>ie(()=>import("./calcite-table-header-aUxVo_Ld.js"),__vite__mapDeps([273,274,224,228,225,220,226,227,223,229])),"table-row":()=>ie(()=>import("./calcite-table-row-DbWHWlj8.js"),__vite__mapDeps([275,220,226,221,223,229,227,272,224,228,225,274]))})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(e){this.viewModel.defaultEditOptions=e}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(e){this.viewModel.bookmarks=e}get editingEnabled(){return wo(fe.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled&&this.visibleElements.editBookmarkButton&&this.visibleElements.addBookmarkButton}set editingEnabled(e){wo(fe.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.visibleElements.editBookmarkButton=e,this.visibleElements.addBookmarkButton=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"bookmark"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){return N("div",{class:this.classes(Kr.base,Ee.widget,Ee.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new vO({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(e){const{messages:i,viewModel:{state:r}}=this;return e.length||r==="loading"?null:N("div",{class:Ee.empty,key:"no-bookmarks"},N("calcite-icon",{icon:"bookmark",scale:"l"}),N(jl,{class:this.classes(Ee.heading,Kr.noBookmarksHeader),level:this.headingLevel},i==null?void 0:i.noBookmarksHeading),N("p",{class:Kr.noBookmarksDescription},i.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:e}=this,i=e==null?void 0:e.editedBookmark;return i&&(e==null?void 0:e.state)==="edit"?this._renderEditingBookmark(i):[]}_renderBookmarkItems(e){return e?e.toArray().map(i=>this._renderBookmark(i)):[]}_handleCalciteListDragEnd(e){const{fromEl:i,dragEl:r,oldIndex:n}=e;i.insertBefore(r,i.children[n])}_renderBookmarksContainer(){const{viewModel:{state:e,bookmarks:i},dragEnabled:r,messages:n,disabled:o,filterPlaceholder:u,filterText:p,visible:g,headingLevel:w,visibleElements:{closeButton:S,collapseButton:T,filter:E,heading:C,flow:L},uid:R}=this,F=i.filter(Rt),V=F.length?N("calcite-list",{class:Kr.list,dragEnabled:r,filterEnabled:E,filterPlaceholder:u,filterText:p,group:`bookmarks-${R}`,key:"bookmark-list",label:n.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:W=>this._handleCalciteListDragEnd(W.detail),onCalciteListFilter:W=>{var H;return this.filterText=((H=W.target)==null?void 0:H.filterText)??""},onCalciteListOrderChange:W=>this._onCalciteListOrderChange(W.detail)},this._renderBookmarkItems(F),E?N("div",{class:Kr.filterNoResults,slot:"filter-no-results"},N("calcite-notice",{kind:"info",open:!0,width:"full"},N("div",{slot:"message"},n.noBookmarksHeading),";")):null):null,U=[N("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:S,closed:!g,collapsible:T,disabled:o,heading:C?n.widgetLabel:void 0,headingLevel:w,loading:e==="loading",onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(F),V,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return g?L?N("calcite-flow",{key:"root-flow"},U):U:null}_renderAddBookmarkButton(){const{messages:e,_userState:i,disabled:r,viewModel:{view:n,state:o},visibleElements:{addBookmarkButton:u}}=this,p=(i==null?void 0:i.loading)??!1;return n&&o!=="loading"&&u?N("calcite-fab",{appearance:"outline-fill",bind:this,class:Kr.addBookmarkButton,disabled:r||p,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:p,onclick:this.startAddBookmark,slot:"fab",text:e.addBookmark,textEnabled:!0,title:e.addBookmark,type:"button"}):null}_renderEditContainer(e){const{messagesCommon:i,visibleElements:{editBookmarkButton:r}}=this,n=`${i.edit} ${this._getBookmarkTitle(e)}`;return r?N("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(e),slot:"actions-end",text:n,title:n}):null}_renderBookmarkImage(e,i){var r;return i?N("img",{alt:"",class:Kr.bookmarkImage,key:"bookmark-image",src:(r=e.thumbnail)==null?void 0:r.url}):null}_renderBookmarkTimeSwitch(e){const{messages:i,viewModel:{view:r}}=this,{timeExtent:n}=e;return(r==null?void 0:r.timeExtent)??n?N("calcite-label",{layout:"inline-space-between"},i.includeTimeExtent,N("calcite-switch",{checked:!!n,onCalciteSwitchChange:o=>{this._editIncludeTimeExtent=!!o.target.checked}})):null}_renderEditBookmarkTimeExtent(e){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(e):null}_getTimeExtentStrings(e){const{visibleElements:i}=this,{timeExtent:r}=e;if(!r)return{};const{start:n,end:o}=r,u=o!=null&&(n==null||n.getTime()!==o.getTime()),p=n?this._formatDate(n):"",g=n&&i.time?this._formatTime(n):"";return u?{startDate:p,startTime:g,endDate:this._formatDate(o),endTime:i.time?this._formatTime(o):""}:{startDate:p,startTime:g}}_renderTimeExtentDescription(e){const{startDate:i,startTime:r,endDate:n,endTime:o}=this._getTimeExtentStrings(e);if(!i)return"";const u=`${i} ${r}`;return n?`${u} - ${`${n} ${o}`}`:u}_renderBookmarkTimeExtent(e,i=!1){const{messages:r}=this,{startDate:n,startTime:o,endDate:u,endTime:p}=this._getTimeExtentStrings(e),g=i?null:N("calcite-table-row",{slot:"table-header"},N("calcite-table-header",{heading:r.startDate}),u?N("calcite-table-header",{heading:r.endDate}):null);return n?N("calcite-table",{caption:r.timeExtent,scale:"s"},g,N("calcite-table-row",null,N("calcite-table-cell",null,n," ",o?[N("br",null),o]:null),u?N("calcite-table-cell",null,u,p?[N("br",null),p]:null):null)):null}_renderBookmarkActiveScrim(e,i){return this.viewModel.activeBookmark===e&&i?N("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(e,i){return this.viewModel.activeBookmark!==e||i?null:N("calcite-loader",{class:Kr.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(e,i){return this.viewModel.activeBookmark===e||i?null:N("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(e){var r;const i=this.visibleElements.thumbnail&&!!((r=e.thumbnail)!=null&&r.url);return N("div",{class:Kr.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(e,i),this._renderBookmarkImage(e,i),this._renderBookmarkActiveLoader(e,i),this._renderBookmarkImageIcon(e,i))}_focusSelectedDragEl(e,i){this._selectedDragBookmarkUid===i.uid&&requestAnimationFrame(()=>e==null?void 0:e.setFocus())}_handleCalciteListItemDragHandleChange(e,i){e.stopPropagation();const r=e.target.dragSelected;this._selectedDragBookmarkUid=r?i.uid:null}_renderBookmark(e){return N("calcite-list-item",{afterCreate:i=>this._focusSelectedDragEl(i,e),afterUpdate:i=>this._focusSelectedDragEl(i,e),class:this.classes({[Kr.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(e),dragSelected:e.uid===this._selectedDragBookmarkUid,key:e.uid,label:this._getBookmarkTitle(e),value:e.uid,onCalciteListItemDragHandleChange:i=>this._handleCalciteListItemDragHandleChange(i,e),onCalciteListItemSelect:()=>this._goToBookmark(e)},this._renderBookmarkThumbnail(e),this._renderBookmarkContent(e),this._renderEditContainer(e))}_renderBookmarkContent(e){return N("div",{class:Kr.bookmarkContent,slot:"content"},N("span",{class:Kr.bookmarkContentLabel},this._getBookmarkTitle(e)),this._renderBookmarkTimeExtent(e,!0))}_renderEditingBookmarkName(e){const{messages:i,_userState:r}=this,n=(r==null?void 0:r.validationState)==="name-required";return N("calcite-label",null,i.title,N("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:Kr.editBookmarkInput,name:"bookmark-name",placeholder:i.titlePlaceholder,required:!0,type:"text",value:e.name}),n?N("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:e,_userState:i}=this,r=i==null?void 0:i.bookmark;return[N("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(r),slot:"footer",type:"button",width:"full"},e.delete),N("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},e.cancel),N("calcite-button",{slot:"footer",type:"submit",width:"full"},e.save)]}_handleUrlEditInputChange(){var o,u;const{_userState:e,_urlEditInputNode:i}=this,r=i==null?void 0:i.value;if(!(e!=null&&e.editedBookmark)||!r)return;e.validationState=void 0,(o=e.editedBookmark.thumbnail)!=null&&o.isDataURI&&(e.screenshotUrl=(u=e.editedBookmark.thumbnail)==null?void 0:u.url);const n=new Fa({url:r});n.isSecureUrl&&(e.customUrl=r,e.editedBookmark.thumbnail=n)}_renderEditingTimeExtent(e){const{capabilities:i,view:r}=this.viewModel,{timeExtent:n}=e;return i.time&&((r==null?void 0:r.timeExtent)??n)?N("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(e),this._renderEditBookmarkTimeExtent(e)):null}_renderEditingBookmarkImage(e){var o,u;const{_userState:i}=this,r=i==null?void 0:i.thumbnailState,n=(o=e.thumbnail)!=null&&o.isSecureUrl?r==="url":(u=e.thumbnail)!=null&&u.isDataURI?r==="screenshot":null;if(n)return this._renderBookmarkImage(e,n)}_renderEditingThumbnail(e){const{_userState:i,visibleElements:r}=this,n=i==null?void 0:i.thumbnailState;return r.thumbnail&&n!=="none"?N("div",{class:Kr.authoringImageContainer},this._renderEditingBookmarkImage(e)):null}_renderUpdateThumbnailButton(){const{visibleElements:e,messages:i,_userState:r}=this,n=r==null?void 0:r.thumbnailState;return e.thumbnail&&n==="screenshot"?N("calcite-button",{appearance:"outline",class:Kr.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"half"},i.updateThumbnail):null}_renderEditingBookmarkUrlInput(e){var g,w;const{messages:i,_userState:r}=this,n=(g=e.thumbnail)==null?void 0:g.url,o=(w=e.thumbnail)!=null&&w.isSecureUrl?n:void 0,u=n&&(r==null?void 0:r.validationState)==="absolute-url-required";return(r==null?void 0:r.thumbnailState)==="url"?N("calcite-label",{key:"thumbnail-url-input"},N("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:k5e,placeholder:i?`https://<${i.imageUrlPlaceholder}>`:void 0,required:!0,title:i.imageUrlTooltip,type:"text",value:o,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),u?N("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:e,messages:i,_userState:r}=this,n=r==null?void 0:r.thumbnailState;return e.thumbnail?N("calcite-label",{key:"thumbnail-chip-group"},i.thumbnail,N("calcite-chip-group",{label:i.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:o=>this._handleThumbnailTypeSelect(o.target.selectedItems[0].value)},N("calcite-chip",{selected:n==="screenshot",value:"screenshot"},i.screenshot),N("calcite-chip",{selected:n==="url",value:"url"},i.url),N("calcite-chip",{selected:n==="none",value:"none"},i.none))):null}_renderEditingBookmark(e){const{disabled:i,messagesCommon:r,headingLevel:n}=this;return e?N("form",{bind:this,class:Kr.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},N("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:i,heading:r.edit,headingLevel:n,key:"edit-bookmark-form",onCalciteFlowItemBack:o=>{o.preventDefault(),this._closeEditBookmarkForm()}},N("div",{class:Kr.formContent},N("div",{class:Kr.authoring},this._renderEditingBookmarkName(e),this._renderThumbnailSelector(),this._renderEditingThumbnail(e),this._renderEditingBookmarkUrlInput(e),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(e))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:e,messages:i}=this,r=(e==null?void 0:e.validationState)==="name-required";return N("calcite-label",null,i.title,N("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:Kr.addBookmarkInput,name:"bookmark-name",placeholder:i.titlePlaceholder,required:!0,type:"text",value:""}),r?N("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},i.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:e}=this;return[N("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"half"},e.cancel),N("calcite-button",{slot:"footer",type:"submit",width:"half"},e.add)]}_renderAddingBookmark(){const{disabled:e,messages:i,headingLevel:r,_userState:n}=this;return(n==null?void 0:n.state)==="add"?N("form",{bind:this,class:Kr.form,disabled:e,onsubmit:this._addBookmarkSubmitClick},N("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:e,heading:i.addBookmark,headingLevel:r,key:"add-bookmark-form",onCalciteFlowItemBack:o=>{o.preventDefault(),this._endAddBookmark()}},N("div",{class:Kr.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(e){return(e==null?void 0:e.name)||this.messagesCommon.untitled}_formatDate(e){var i;return e?ln(e,{...bo("short-date"),timeZone:((i=this.viewModel.view)==null?void 0:i.timeZone)??$o}):""}_formatTime(e){var i;return e?ln(e,{...bo("long-time"),timeZone:((i=this.viewModel.view)==null?void 0:i.timeZone)??$o}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(e){e&&(this._editIncludeTimeExtent=!!e.timeExtent,this._userState=new vO({bookmark:e,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(e))}async _createNewScreenshotUrl(){var i;return((i=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:i.url)??null}_storeCurrentUrl(){var r,n,o,u,p,g;const{_userState:e}=this,i=(n=(r=e==null?void 0:e.editedBookmark)==null?void 0:r.thumbnail)==null?void 0:n.url;i&&((u=(o=e==null?void 0:e.editedBookmark)==null?void 0:o.thumbnail)!=null&&u.isSecureUrl?e.customUrl=i:(g=(p=e==null?void 0:e.editedBookmark)==null?void 0:p.thumbnail)!=null&&g.isDataURI&&(e.screenshotUrl=i))}async _handleThumbnailTypeSelect(e){const{_userState:i}=this;if(!i)return;const{screenshotUrl:r,customUrl:n,editedBookmark:o}=i,u=e==="screenshot"?r??await this._createNewScreenshotUrl():e==="url"&&n?n:null;this._storeCurrentUrl(),o&&u&&(o.thumbnail=new Fa({url:u})),i.validationState=void 0,i.thumbnailState=e}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(e){e.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:e,_userState:i,viewModel:r,viewModel:{bookmarks:n}}=this;if(!i)return;const o=e?e.value.trim():null;if(!o)return void(i.validationState="name-required");i.loading=!0;const u=await r.createBookmark();u.name=o,n.add(u),this._endAddBookmark()}async _editBookmarkAndClose(e,i){const{viewModel:r,viewModel:{defaultEditOptions:n}}=this;await r.editBookmark(e,{...n,...i}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:i,_userState:r,_editIncludeTimeExtent:n,_urlEditInputNode:o}=this;if(!(r!=null&&r.bookmark)||!r.editedBookmark)return;r.validationState=void 0,r.customUrl=void 0,r.screenshotUrl=void 0;const u=i==null?void 0:i.value.trim();if(!u)return void(r.validationState="name-required");r.bookmark.name=u,r.bookmark.thumbnail=r.editedBookmark.thumbnail,n||(r.bookmark.timeExtent=null);const p=r.thumbnailState;if(p==="url"&&o){const g=o.value,w=new Fa({url:g});if(!w.isSecureUrl)return void(r.validationState="absolute-url-required");r.bookmark.thumbnail=w}else p==="none"&&(r.bookmark.thumbnail=null);this._editBookmarkAndClose(r.bookmark,{takeScreenshot:!1,captureTimeExtent:n})}_storeEditInput(e){this._editInputNode=e}_storeAddInput(e){this._addInputNode=e}_storeUrlEditInput(e){this._urlEditInputNode=e}_deleteBookmark(e){this._closeEditBookmarkForm(),e&&(this.viewModel.bookmarks.remove(e),e.destroy())}_goToBookmark(e){e&&(this.endAddBookmark(),this.viewModel.goTo(e))}async _updateThumbnail(){const{_userState:e,viewModel:i}=this;e&&(e.validationState=void 0,await i.editBookmark(e.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusEditFlowItemNode(e){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusAddFlowItemNode(e){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}};m([b()],Gi.prototype,"_editIncludeTimeExtent",void 0),m([b({type:vO})],Gi.prototype,"_userState",void 0),m([b()],Gi.prototype,"_focusRootFlowItem",void 0),m([b()],Gi.prototype,"_focusAddFlowItem",void 0),m([b()],Gi.prototype,"_focusEditFlowItem",void 0),m([b()],Gi.prototype,"defaultCreateOptions",null),m([b()],Gi.prototype,"defaultEditOptions",null),m([b()],Gi.prototype,"bookmarks",null),m([b()],Gi.prototype,"disabled",void 0),m([b()],Gi.prototype,"dragEnabled",void 0),m([b()],Gi.prototype,"editingEnabled",null),m([b()],Gi.prototype,"filterPlaceholder",void 0),m([b()],Gi.prototype,"filterText",void 0),m([b()],Gi.prototype,"headingLevel",void 0),m([b()],Gi.prototype,"goToOverride",null),m([b()],Gi.prototype,"icon",null),m([b()],Gi.prototype,"label",null),m([b(),vt("esri/widgets/Bookmarks/t9n/Bookmarks")],Gi.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Gi.prototype,"messagesCommon",void 0),m([b()],Gi.prototype,"uiStrings",void 0),m([b()],Gi.prototype,"view",null),m([b({type:Nne}),v0(["select-bookmark","bookmark-edit","bookmark-select"])],Gi.prototype,"viewModel",void 0),m([b({type:bO,nonNullable:!0})],Gi.prototype,"visibleElements",void 0),m([b()],Gi.prototype,"endAddBookmark",null),m([b()],Gi.prototype,"startAddBookmark",null),Gi=m([G("esri.widgets.Bookmarks")],Gi);const eAe=Gi;let lf=class extends Te{constructor(e){super(e),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(gi(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:i}=e;i&&i!==this&&i.expanded&&i.group&&i.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){var n;const i=!!e;this._set("expanded",i);const r=(n=this.view)==null?void 0:n.ui;r&&r.emit("expand",{target:this}),this._viewpointHandleChange(i)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&Fr(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?Fr(()=>{var i;return(i=this.view)==null?void 0:i.stationary},()=>{var i;return(i=this._viewpointHandle)==null?void 0:i.resume()},{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this.removeHandles(e),this._viewpointHandle=null;const{autoCollapse:i,view:r}=this;if(!r||!i)return;const n=P0e(()=>r.type==="3d"?r.camera:r.viewpoint,()=>this._collapse());this.addHandles(n,e),this._viewpointHandle=n}_collapse(){this.expanded=!1}};m([b({value:!1})],lf.prototype,"autoCollapse",null),m([b({value:!1})],lf.prototype,"expanded",null),m([b()],lf.prototype,"group",void 0),m([b({readOnly:!0})],lf.prototype,"state",null),m([b({value:null})],lf.prototype,"view",null),lf=m([G("esri.widgets.Expand.ExpandViewModel")],lf);const jne=lf;function B2(t){return t&&typeof t.render=="function"}function tAe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}const Ka="esri-expand",ua={base:Ka,toggle:`${Ka}__toggle`,popoverContent:`${Ka}__popover-content`,panel:`${Ka}__panel`,panelContent:`${Ka}__panel-content`,sheet:`${Ka}__sheet`,panelIconNumber:`${Ka}__panel-icon-number`,contentContainer:`${Ka}__content-container`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconExpanded:`${Ka}__icon--expanded`,iconNumber:`${Ka}__icon-number`,content:`${Ka}__content`,contentExpanded:`${Ka}__content--expanded`},KU="chevrons-left",YU="chevrons-right";let $r=class extends vi{constructor(e,i){super(e,i),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.placement=null,this.viewModel=new jne,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handlePopoverClose=r=>{r.target===this._popoverEl&&(this.viewModel.expanded=r.target.open)},this._handleSheetClose=r=>{this.viewModel.expanded=r.target.open},this._handlePanelClose=r=>{this.viewModel.expanded=!r.target.closed},this._handleKeyDown=r=>{this.viewModel.expanded&&r.key==="Escape"&&!this._willCloseOnEsc(r)&&r.preventDefault()},this._storeToggleButtonEl=r=>{this._toggleButtonEl=r},this._storePopoverEl=r=>{this._popoverEl=r}}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),panel:()=>ie(()=>import("./calcite-panel-D1958UUA.js"),__vite__mapDeps([276,240,220,221,224,227,241,242,226,233,225,223,228,229,230,243,244,245,246,247,248,249,250])),popover:()=>ie(()=>import("./calcite-popover-CjjGVWYj.js"),__vite__mapDeps([277,243,244,220,245,246,247,248,225,226,227,228,224,249,223,233,221,229,230])),sheet:()=>ie(()=>import("./calcite-sheet-BOjPciOX.js"),__vite__mapDeps([278,220,246,224,227,247,230,225,226,250,228]))})}get expandTitle(){const{expanded:e,messagesCommon:i,collapseTooltip:r,expandTooltip:n}=this;return(e?r||(i==null?void 0:i.collapse):n||(i==null?void 0:i.expand))??""}get _displaySheet(){var e;switch(this.mode){case"drawer":return!0;case"auto":return((e=this.viewModel.view)==null?void 0:e.widthBreakpoint)==="xsmall";default:return!1}}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIcon(){return YU}set collapseIcon(e){this._overrideIfSome("collapseIcon",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIcon(){return B2(this.content)?this.content.icon:KU}set expandIcon(e){this._overrideIfSome("expandIcon",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get icon(){return null}get label(){var e;return(B2(this.content)?this.content.label:null)??((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{_displaySheet:e,_toggleButtonEl:i,viewModel:{expanded:r},label:n,placement:o}=this;return N("div",{class:this.classes(ua.base,Ee.widget)},this._renderToggle(),e?N("calcite-sheet",{class:ua.sheet,heightScale:"l",label:n,onkeydown:this._handleKeyDown,open:r,position:"block-end",onCalciteSheetClose:this._handleSheetClose},N("calcite-panel",{class:ua.panel,closable:!0,closed:!r,heading:n,onkeydown:this._handleKeyDown,onCalcitePanelClose:this._handlePanelClose},N("div",{class:ua.panelContent},this._renderContent()))):i?N("calcite-popover",{afterCreate:this._storePopoverEl,afterUpdate:this._storePopoverEl,label:n,onkeydown:this._handleKeyDown,open:r,overlayPositioning:"fixed",placement:o??this._getPlacement(),referenceElement:i,onCalcitePopoverClose:this._handlePopoverClose},N("div",{class:ua.popoverContent},this._renderContent())):null)}_getPlacement(){const{container:e,view:i}=this,r=e&&i?i.ui.getPosition(e):null;if(!r||r==="manual")return"auto";const[n,o]=r.split("-");return`${o==="right"?"left":"right"}-${n==="bottom"?"end":"start"}`}_willCloseOnEsc(e){const{closeOnEsc:i}=this;return typeof i=="function"?i(e):i}_renderBadgeNumber(){const{expanded:e,iconNumber:i}=this;return i&&!e?N("span",{class:ua.iconNumber,key:"expand__icon-number"},i):null}_renderToggleButton(){const{expanded:e,expandTitle:i,expandIcon:r,collapseIcon:n}=this,o=e?n:r,u=o===KU||o===YU;return N("calcite-button",{afterCreate:this._storeToggleButtonEl,afterUpdate:this._storeToggleButtonEl,class:Ee.widgetButton,kind:"neutral",label:i,onclick:this.toggle,scale:"s",title:i},o?N("calcite-icon",{class:this.classes(ua.icon,u&&ua.iconFlip),icon:o,scale:"s"}):null)}_renderToggle(){return N("div",{class:ua.toggle},this._renderToggleButton(),this._renderBadgeNumber())}_renderContent(){const{content:e}=this;return typeof e=="string"?N("div",{class:ua.contentContainer,innerHTML:e,key:"content__string"}):B2(e)?N("div",{class:ua.contentContainer,key:"content__widget"},e.render()):e instanceof HTMLElement?N("div",{afterCreate:this._attachToNode,bind:e,class:ua.contentContainer,key:"content__html-element"}):tAe(e)?N("div",{afterCreate:this._attachToNode,bind:e.domNode,class:ua.contentContainer,key:"content__node"}):null}_attachToNode(e){const i=this;e.appendChild(i)}};m([b({readOnly:!0})],$r.prototype,"expandTitle",null),m([b()],$r.prototype,"_toggleButtonEl",void 0),m([b()],$r.prototype,"_displaySheet",null),m([b()],$r.prototype,"autoCollapse",null),m([b()],$r.prototype,"closeOnEsc",void 0),m([b()],$r.prototype,"collapseIcon",null),m([b()],$r.prototype,"collapseTooltip",void 0),m([b()],$r.prototype,"content",void 0),m([b()],$r.prototype,"expanded",null),m([b()],$r.prototype,"expandIcon",null),m([b()],$r.prototype,"expandTooltip",void 0),m([b()],$r.prototype,"group",null),m([b()],$r.prototype,"icon",null),m([b()],$r.prototype,"iconNumber",void 0),m([b()],$r.prototype,"label",null),m([b(),vt("esri/widgets/Expand/t9n/Expand")],$r.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],$r.prototype,"messagesCommon",void 0),m([b()],$r.prototype,"mode",void 0),m([b()],$r.prototype,"placement",void 0),m([b()],$r.prototype,"view",null),m([b({type:jne})],$r.prototype,"viewModel",void 0),$r=m([G("esri.widgets.Expand")],$r);const Zy=$r;let up=class extends LM(Ar.EventedAccessor){constructor(e){super(e),this._initialViewpoint=null,this._goingHomeController=null,this.go=this.go.bind(this)}destroy(){this._cancelGo(),this.view=null}get state(){var e;return(e=this.view)!=null&&e.ready?this._goingHomeController?"going-home":"ready":"disabled"}set view(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then(()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))})}get viewpoint(){return this._get("viewpoint")||this._initialViewpoint}set viewpoint(e){this._set("viewpoint",e)}async go(){var i,r;if(!((i=this.view)!=null&&i.ready))throw new re("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=new AbortController;this._goingHomeController=e;try{await((r=this.view)==null?void 0:r.when()),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch{}this._goingHomeController=null}cancelGo(){this._cancelGo()}_cancelGo(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null}};m([b()],up.prototype,"_goingHomeController",void 0),m([b({readOnly:!0})],up.prototype,"state",null),m([b()],up.prototype,"view",null),m([b({type:Mn})],up.prototype,"viewpoint",null),m([b()],up.prototype,"go",null),m([b()],up.prototype,"cancelGo",null),up=m([G("esri.widgets.Home.HomeViewModel")],up);const Vne=up,iAe={base:"esri-home"};let pl=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.messagesCommon=null,this.uiStrings=void 0,this.viewModel=new Vne,this._go=()=>{const{viewModel:r}=this;r.state==="going-home"?r.cancelGo():r.go()}}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"home"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewpoint(){return this.viewModel.viewpoint}set viewpoint(e){this.viewModel.viewpoint=e}cancelGo(){this.viewModel.cancelGo()}go(){return this.viewModel.go()}render(){var u;const{messagesCommon:e,messages:i,icon:r}=this,n=(u=this.viewModel)==null?void 0:u.state,o=n==="going-home";return N("div",{class:this.classes(iAe.base,Ee.widget)},N("calcite-button",{class:Ee.widgetButton,disabled:n==="disabled",iconStart:o?void 0:r,kind:"neutral",label:i.widgetLabel,onclick:this._go,scale:o?"s":"m",title:n==="going-home"?e.cancel:i.title},o?N("calcite-loader",{inline:!0,label:""}):null))}};m([b()],pl.prototype,"goToOverride",null),m([b()],pl.prototype,"icon",null),m([b()],pl.prototype,"label",null),m([b(),vt("esri/widgets/Home/t9n/Home")],pl.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],pl.prototype,"messagesCommon",void 0),m([b()],pl.prototype,"uiStrings",void 0),m([b()],pl.prototype,"view",null),m([b({type:Vne}),v0("go")],pl.prototype,"viewModel",void 0),m([b()],pl.prototype,"viewpoint",null),pl=m([G("esri.widgets.Home")],pl);const rAe=pl;function nAe(t,e){return{type:Zp(e),value:t,unit:e}}function Cet(t){return{value:t}}function kS(t,e){return{type:Zp(e),value:t,unit:e}}function sAe(t,e){return{type:Zp(e),value:t,unit:e}}function ic(t,e,i="arithmetic"){return{type:Zp(e),value:t,unit:e,rotationType:i}}function Aet(t,e){const i=NR(t,e);return t.type==="angle"?ic(i,e,t.rotationType):nAe(i,e)}function NR(t,e){return lt(t.value,t.unit,e)}function Let(t,e){return t==null?e:e==null||t.value>lt(e.value,e.unit,t.unit)?t:e}function Oet(t,e){return t==null?null:{...t,value:t.value*e}}function OM(t,e,i){if(e===i)return t;switch(i){case"arithmetic":case"geographic":return 90-t}}const Pet=kS(0,"meters"),Ret=sAe(0,"square-meters");ic(0,"radians");const Fet=ic(0,"degrees"),Net=ic(0,"degrees","geographic");function zne(t,e,i,r){if(Ba(t.spatialReference,i)){u$[0]=t.x,u$[1]=t.y;const o=t.z;return u$[2]=o??r??0,Th(u$,t.spatialReference,0,e,i,0,1)}const n=wb(t,i);return!!n&&(e[0]=n==null?void 0:n.x,e[1]=n==null?void 0:n.y,e[2]=(n==null?void 0:n.z)??r??0,!0)}async function Det(t,e,i,r,n){return await vh(t.spatialReference,i,null,n),zne(t,e,i,r)}const u$=be();function sw(t,e,i,r){return{x:t,y:e,z:i,hasZ:i!=null,hasM:!1,spatialReference:r,type:"point"}}function Une(t,e,i,r,n){t.x=e,t.y=i,t.z=r,t.hasZ=r!=null,t.spatialReference=n}function HE(t,e,i,r,n){return!(e==null||r==null||t.length<2)&&(Lw.x=t[0],Lw.y=t[1],Lw.z=t[2],Lw.spatialReference=e,zne(Lw,i,r,n))}const Lw=sw(0,0,0,Ge.WGS84);function Gne(t){if(!t)return null;if(u0(t)&&t.wkid){const i=x$e[t.wkid];if(i)return i}const e=t.wkt2||t.wkt;if(e){const i=oAe(e);if(i)return i}return null}function oAe(t){const e=_$e.exec(t);if(!e||e.length!==2)return null;const i=e[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),n=parseFloat(i[2]);return isNaN(r)||isNaN(n)?null:{a:r,f:n===0?0:1/n}}function PM(t){const e=Gne(t);if(aAe(e))return e;const i=e.a*(1-e.f);return Object.assign(e,{b:i,eSq:1-(i/e.a)**2,radius:(2*e.a+i)/3,densificationRatio:1e4/((2*e.a+i)/3)})}function aAe(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function c$(t,e,i){const{a:r,eSq:n}=PM(i),o=Math.sqrt(n),u=Math.sin(e[1]*go),p=r*e[0]*go;let g;return n>0?g=r*((1-n)*(u/(1-n*(u*u))-1/(2*o)*Math.log((1-o*u)/(1+o*u))))*.5:g=r*u,t[0]=p,t[1]=g,t}function b0(t){return Gne(t)!==null}function jet(t,e="square-meters"){if(t.some(u=>!b0(u.spatialReference)))throw new re("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let u=0;u<t.length;u++){const p=t[u],g=p.spatialReference,{radius:w,densificationRatio:S}=PM(g),T=w*S;i.push(lAe(p,T))}const r=[],n=[0,0],o=[0,0];for(let u=0;u<i.length;u++){const{rings:p,spatialReference:g}=i[u];let w=0;for(let S=0;S<p.length;S++){const T=p[S];c$(n,T[0],g),c$(o,T[T.length-1],g);let E=o[0]*n[1]-n[0]*o[1];for(let C=0;C<T.length-1;C++)c$(n,T[C+1],g),c$(o,T[C],g),E+=o[0]*n[1]-n[0]*o[1];w+=E}w=lt(w,"square-meters",e),r.push(w/-2)}return r}function DR(t,e="meters"){if(!t)throw new re("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(r=>!b0(r.spatialReference)))throw new re("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<t.length;r++){const n=t[r],{spatialReference:o}=n,u=n.type==="polyline"?n.paths:n.rings;let p=0;for(let g=0;g<u.length;g++){const w=u[g];let S=0;for(let T=1;T<w.length;T++){const E=w[T-1][0],C=w[T][0],L=w[T-1][1],R=w[T][1];if(L!==R||E!==C){const F=new ow;tg(F,[E,L],[C,R],o),S+=F.distance}}p+=S}p=lt(p,"meters",e),i.push(p)}return i}function lAe(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new re("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=t;if(!b0(i))throw new re("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r=t.type==="polyline"?t.paths:t.rings,n=[],o=[0,0],u=new ow;for(const p of r){const g=[];n.push(g),g.push([p[0][0],p[0][1]]);let w,S,T=p[0][0],E=p[0][1];for(let C=0;C<p.length-1;C++){if(w=p[C+1][0],S=p[C+1][1],T===w&&E===S)continue;const L=[T,E];tg(u,[T,E],[w,S],i);const{azimuth:R,distance:F}=u,V=F/e;if(V>1){for(let U=1;U<=V-1;U++)Gp(o,L,R,U*e,i),g.push(o.slice(0));Gp(o,L,R,(F+Math.floor(V-1)*e)/2,i),g.push(o.slice(0))}Gp(o,L,R,F,i),g.push(o.slice(0)),T=o[0],E=o[1]}}return t.type==="polyline"?new Bn({paths:n,spatialReference:i}):new xo({rings:n,spatialReference:i})}let ow=class{constructor(e=0,i=void 0,r=void 0){this.distance=e,this.azimuth=i,this.reverseAzimuth=r}};function Gp(t,e,i,r,n){const o=e[0],u=e[1],p=o*go,g=u*go,w=(i??0)*go,{a:S,b:T,f:E}=PM(n),C=Math.sin(w),L=Math.cos(w),R=(1-E)*Math.tan(g),F=1/Math.sqrt(1+R*R),V=R*F,U=Math.atan2(R,L),W=F*C,H=W*W,J=1-H,X=J*(S*S-T*T)/(T*T),te=1+X/16384*(4096+X*(X*(320-175*X)-768)),oe=X/1024*(256+X*(X*(74-47*X)-128));let pe,de,ge,we,ke=r/(T*te),$e=2*Math.PI;for(;Math.abs(ke-$e)>1e-12;)ge=Math.cos(2*U+ke),pe=Math.sin(ke),de=Math.cos(ke),we=oe*pe*(ge+oe/4*(de*(2*ge*ge-1)-oe/6*ge*(4*pe*pe-3)*(4*ge*ge-3))),$e=ke,ke=r/(T*te)+we;const Fe=V*pe-F*de*L,yt=Math.atan2(V*de+F*pe*L,(1-E)*Math.sqrt(H+Fe*Fe)),qe=Math.atan2(pe*C,F*de-V*pe*L),Ue=E/16*J*(4+E*(4-3*J)),ei=yt/go,jr=(p+(qe-(1-Ue)*E*W*(ke+Ue*pe*(ge+Ue*de*(2*ge*ge-1)))))/go;return t[0]=jr,t[1]=ei,t}function tg(t,e,i,r){const n=e[0]*go,o=e[1]*go,u=i[0]*go,p=i[1]*go,{a:g,b:w,f:S,radius:T}=PM(r),E=u-n,C=Math.atan((1-S)*Math.tan(o)),L=Math.atan((1-S)*Math.tan(p)),R=Math.sin(C),F=Math.cos(C),V=Math.sin(L),U=Math.cos(L);let W,H,J,X,te,oe,pe,de,ge,we,ke=1e3,$e=E;do{if(pe=Math.sin($e),de=Math.cos($e),J=Math.sqrt(U*pe*(U*pe)+(F*V-R*U*de)*(F*V-R*U*de)),J===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;te=R*V+F*U*de,oe=Math.atan2(J,te),ge=F*U*pe/J,H=1-ge*ge,X=te-2*R*V/H,isNaN(X)&&(X=0),we=S/16*H*(4+S*(4-3*H)),W=$e,$e=E+(1-we)*S*ge*(oe+we*J*(X+we*te*(2*X*X-1)))}while(Math.abs($e-W)>1e-12&&--ke>0);if(ke===0){const jr=T,cs=Math.acos(Math.sin(o)*Math.sin(p)+Math.cos(o)*Math.cos(p)*Math.cos(u-n))*jr,eo=u-n,to=Math.sin(eo)*Math.cos(p),On=Math.cos(o)*Math.sin(p)-Math.sin(o)*Math.cos(p)*Math.cos(eo),Is=Math.atan2(to,On);return t.azimuth=Is/go,t.distance=cs,t.reverseAzimuth=void 0,t}const Fe=H*(g*g-w*w)/(w*w),yt=Fe/1024*(256+Fe*(Fe*(74-47*Fe)-128)),qe=w*(1+Fe/16384*(4096+Fe*(Fe*(320-175*Fe)-768)))*(oe-yt*J*(X+yt/4*(te*(2*X*X-1)-yt/6*X*(4*J*J-3)*(4*X*X-3)))),Ue=Math.atan2(U*Math.sin($e),F*V-R*U*Math.cos($e)),ei=Math.atan2(F*Math.sin($e),F*V*Math.cos($e)-R*U);return t.azimuth=Ue/go,t.distance=qe,t.reverseAzimuth=ei/go,t}function wO(t){return b0(t)?t:ea(t)?Ge.WGS84:null}var qo;function uAe(t,e){if(t==null||e==null)return;const i=_O(t,e);return i!=null?ic(i,"radians","geographic"):void 0}(function(t){t.Absolute="absolute",t.Relative="relative",t.RelativeBilateral="relative-bilateral"})(qo||(qo={}));const _O=(()=>{const t=be(),e=be();return(i,r)=>(Qt(t,i.x,i.y,i.z??0),Qt(e,r.x,r.y,r.z??0),L3(t,e,i.spatialReference,r.spatialReference))})(),L3=(()=>{const t=Nt(),e=be(),i=be();return(r,n,o,u)=>{if(Si(r,n))return;const p=wO(o),g=wO(u);if(p&&g&&Ki(p,g)&&HE(r,o,e,p)&&HE(n,u,i,g)){const{azimuth:S}=tg(hAe,e,i,p);return S!=null?lt(S,"degrees","radians"):void 0}t[0]=n[0]-r[0],t[1]=n[1]-r[1];let w=Jie(Gie,t);return t[0]<0&&(w=pAe-w),w}})();function zet(t,e,i,r=qo.Absolute){if(e&&i)switch(r){case qo.Absolute:return uAe(e,i);case qo.Relative:return QU(XU(t,e,i),qo.Relative);case qo.RelativeBilateral:return QU(XU(t,e,i),qo.RelativeBilateral)}}function XU(t,e,i){if(!t||!e||!i)return;const r=_O(t,e),n=_O(e,i);return r!=null&&n!=null?ic(n-r,"radians","geographic"):void 0}function QU(t,e){if(t!=null)switch(e){case qo.Absolute:return cAe(t);case qo.Relative:{const i=WE(t);let r=eG.normalize(i,0,!0);return r===-180&&(r=180),ic(r,"degrees","geographic")}case qo.RelativeBilateral:{const i=WE(t),r=Math.abs(eG.normalize(i,0,!0));return ic(r,"degrees","geographic")}}}function cAe(t){const e=WE(t),i=dAe.normalize(e,0,!0);return ic(i,"degrees","geographic")}const Bne=(()=>{const t=be();return(e,i,r,n,o,u="geodesic")=>{ki(t,i);const p=WE(o);if(u==="geodesic"){const C=wO(r);if(C&&HE(t,r,t,C))return Gp(e,t,p,n,C),e[2]=i[2],!!HE(e,C,e,r)}const g=OM(p,"geographic","arithmetic"),w=lt(g,"degrees","radians"),S=i[0]+n*Math.cos(w),T=i[1]+n*Math.sin(w),E=i[2];return Qt(e,S,T,E),!0}})();function WE(t){if(t!=null)return OM(qne(t),t.rotationType,"geographic")}function Uet(t){if(t!=null)return OM(qne(t),t.rotationType,"arithmetic")}function qne(t){return lt(t.value,t.unit,"degrees")}const hAe=new ow,pAe=2*Math.PI,dAe=JP,eG=new YI(-180,180);let U1=class extends Te{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?qo.RelativeBilateral:qo.Relative;case"absolute":return qo.Absolute}}};m([b({type:String,nonNullable:!0})],U1.prototype,"directionMode",void 0),m([b({type:Boolean,nonNullable:!0})],U1.prototype,"relativeDirectionIsBilateral",void 0),m([b()],U1.prototype,"effectiveDirectionMode",null),U1=m([G("esri.views.interactive.sketch.SketchValueOptions")],U1);const RM=U1;var O3;(function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"})(O3||(O3={}));function jR(t,e,i){return t.units[e][i]}function o0(t,e,i,r=2,n="abbr"){return`${as(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:e>0?"never":"exceptZero"})} ${jR(t,i,n)}`}function FM(t,e,i,r=2,n="abbr"){return`${as(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:"exceptZero"})} ${jR(t,i,n)}`}function Bet(t,e,i,r=2,n="abbr"){const o=dP(e,i);return o0(t,lt(e,i,o),o,r,n)}function qet(t,e,i,r=2,n="abbr"){const o=dP(e,i);return FM(t,lt(e,i,o),o,r,n)}function Het(t,e,i,r=2,n="abbr"){const o=fP(e,i);return o0(t,lt(e,i,o),o,r,n)}function Wet(t,e,i,r=2,n="abbr"){const o=fP(e,i);return FM(t,lt(e,i,o),o,r,n)}function Jet(t,e,i,r=2,n="abbr"){const o=yP(e,i);return o0(t,lt(e,i,o),o,r,n)}function Zet(t,e,i,r=2,n="abbr"){const o=yP(e,i);return FM(t,lt(e,i,o),o,r,n)}function Ket(t,e,i,r=2,n="abbr"){const o=mP(e,i);return o0(t,lt(e,i,o),o,r,n)}function Yet(t,e,i,r=2,n="abbr"){const o=mP(e,i);return FM(t,lt(e,i,o),o,r,n)}function Xet(t,e,i,r=2,n="abbr"){const o=zde(e,i);return o0(t,lt(e,i,o),o,r,n)}function Qet(t,e,i,r=2,n="abbr"){const o=Ude(e,i);return o0(t,lt(e,i,o),o,r,n)}const fAe=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function tG(t,e,i,r,n,o=JP,u=!0){let p=o.normalize(OM(lt(t,e,"degrees"),i,r),0,u);const g=fAe(p,n??2);return p=Hne(p,g),as(p,g)}function ett(t,e,i,r,n){i!==r&&(t=-t);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n=n??2,minimumFractionDigits:n,signDisplay:"exceptZero"};let u=lt(t,e,"degrees")%360;return u=Hne(u,o),as(u,o)}const iG=new Map;function Hne(t,e){const i=JSON.stringify(e);let r=iG.get(i);return r||(r=new Intl.NumberFormat("en-US",e),iG.set(i,r)),/^[-+]?360\.?0*Â°?$/.test(r.format(t))?0:t}const rG=["B","kB","MB","GB","TB"];function yAe(t,e){let i=(e=Math.round(e))===0?0:Math.floor(Math.log(e)/Math.log(O3.KILOBYTES));i=An(i,0,rG.length-1);const r=as(e/O3.KILOBYTES**i,{maximumFractionDigits:2});return Xu(t.units.bytes[rG[i]],{fileSize:r})}function mAe(t){const{exifInfo:e,exifName:i,tagName:r}=t;if(!e||!i||!r)return null;const n=e.find(o=>o.name===i);return n?gAe({tagName:r,tags:n.tags}):null}function gAe(t){const{tagName:e,tags:i}=t;if(!i||!e)return null;const r=i.find(n=>n.name===e);return(r==null?void 0:r.value)||null}var SO;const vAe={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let Ro=SO=class extends ye{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=mAe({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return vAe[e]||null}clone(){return new SO({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};m([b({type:String})],Ro.prototype,"contentType",void 0),m([b()],Ro.prototype,"exifInfo",void 0),m([b({readOnly:!0})],Ro.prototype,"orientationInfo",null),m([b({type:zt})],Ro.prototype,"id",void 0),m([b({type:String})],Ro.prototype,"globalId",void 0),m([b({type:String})],Ro.prototype,"keywords",void 0),m([b({type:String})],Ro.prototype,"name",void 0),m([b({json:{read:!1}})],Ro.prototype,"parentGlobalId",void 0),m([b({json:{read:!1}})],Ro.prototype,"parentObjectId",void 0),m([b({type:zt})],Ro.prototype,"size",void 0),m([b({json:{read:!1}})],Ro.prototype,"url",void 0),Ro=SO=m([G("esri.rest.query.support.AttachmentInfo")],Ro);const bAe=Ro;function P3(t){return e8(t)||Gve(t)||Bve(t)}function VR(t,e){const{format:i,timeZoneOptions:r,fieldType:n}=e??{};let o,u;if(r&&({timeZone:o,timeZoneName:u}=GY(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,bo(i||"short-date-short-time"),n)),typeof t=="string"&&isNaN(Date.parse(n==="time-only"?`1970-01-01T${t}Z`:t)))return t;switch(n){case"date-only":{const p=bo(i||"short-date");return typeof t=="string"?JY(t,{...p}):ln(t,{...p,timeZone:ra})}case"time-only":{const p=bo(i||"short-time");return typeof t=="string"?ZY(t,p):ln(t,{...p,timeZone:ra})}case"timestamp-offset":{if(!o&&typeof t=="string"&&new Date(t).toISOString()!==t)return t;const p=i||r?bo(i||"short-date-short-time"):void 0,g=p?{...p,timeZone:o,timeZoneName:u}:void 0;return typeof t=="string"?KY(t,g):ln(t,g)}default:{const p=i||r?bo(i||"short-date-short-time"):void 0;return ln(typeof t=="string"?new Date(t):t,p?{...p,timeZone:o,timeZoneName:u}:void 0)}}}const wAe="esri.widgets.Feature.support.featureUtils",xO=()=>fe.getLogger(wAe),_Ae=/href=(""|'')/gi,SAe=/(\{([^{\r\n]+)\})/g,xAe=/'/g,Wne=/^\s*expression\//i,$Ae=/(\n)/gi,TAe=/[\u00A0-\u9999<>&]/gim,EAe=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,IAe=/^(?:mailto:|tel:)/,Jne="relationships/",nG=bo("short-date-short-time");function MAe(t){if(t!=null)return(t.sourceLayer||t.layer)??void 0}async function ttt({type:t,value:e,event:i}){try{return typeof e=="function"?e(i):e}catch(r){return void xO().error("error",`An error occurred when calling the "${t}" function`,{error:r,graphic:i.graphic,value:e})}}function itt(t=""){if(t)return!IAe.test(t.trim().toLowerCase())}function kAe(t){return!!t&&Wne.test(t)}function CAe(t,e){if(!e||!kAe(e)||!t)return;const i=e.replace(Wne,"").toLowerCase();return t.find(({name:r})=>r.toLowerCase()===i)}function rtt(t,e){const i=CAe(e,t==null?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function AAe(t,e){const i=e.get(t.toLowerCase());return`{${(i==null?void 0:i.fieldName)||t}}`}function LAe(t){return t.replaceAll(_Ae,"")}function zR(t,e){const i=UR(e,t);return i?i.name:t}function ntt(t,e){return t&&t.map(i=>zR(i,e))}function UR(t,e){return t&&typeof t.getField=="function"&&e?t.getField(e)??null:null}function Zne(t){return`${t}`.trim()}function stt({attributes:t,globalAttributes:e,layer:i,text:r,expressionAttributes:n,fieldInfoMap:o}){return r?OAe({formattedAttributes:e,template:DAe(r,{...e,...n,...t},i),fieldInfoMap:o}):""}function OAe({formattedAttributes:t,template:e,fieldInfoMap:i}){return Zne(LAe(Xu(Xu(e,r=>AAe(r,i)),t)))}function PAe(t,e,i=!1){const r=e[t];if(typeof r=="string"){const n="%27",o=(i?encodeURIComponent(r):r).replaceAll(xAe,n);e[t]=o}}function RAe(t,e=!1){const i={...t};return Object.keys(i).forEach(r=>PAe(r,i,e)),i}function FAe(t,e,i){const r=(e=Zne(e))&&e[0]!=="{";return Xu(t,RAe(i,r||!1))}function NAe(t,e){return t.replaceAll(SAe,(i,r,n)=>{const o=UR(e,n);return o?`{${o.name}}`:r})}function DAe(t,e,i){const r=NAe(t,i);return r&&r.replaceAll(EAe,(n,o,u)=>FAe(n,o||u,e))}function jAe(t,e){if(typeof t=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const i=Number(t);if(!isNaN(i))return i}return t}function VAe(t){return t!=null&&typeof t=="object"&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&(t.type==="feature"||t.type==="scene"||t.type==="sublayer")&&"when"in t}function zAe(t){return t!=null&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function CS(t){return VAe(t)&&zAe(t)}function UAe(t){return!!t&&typeof t=="object"&&"sourceLayer"in t&&CS(t.sourceLayer)}function GAe(t,e){var S;const{fieldInfos:i,fieldName:r,preventPlacesFormatting:n,layer:o,timeZone:u}=e,p=qAe(i,r),g=UR(o,r);if(p&&!RC(r)){const T=g==null?void 0:g.type,E=(S=p.format)==null?void 0:S.dateFormat;if(T==="date"||T==="date-only"||T==="time-only"||T==="timestamp-offset"||E)return VR(t,{format:E,fieldType:T,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:u,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}})}const w=p==null?void 0:p.format;return typeof t=="string"&&RC(r)&&w?BAe(t,w):typeof(t=jAe(t,w))=="string"||t==null||w==null?Kne(t):as(t,n?{...yE(w),minimumFractionDigits:0,maximumFractionDigits:20}:yE(w))}function BAe(t,e){return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?Ok(t,",",", ",e):t.includes(";")?Ok(t,";","; ",e):t.includes(" ")?Ok(t," "," ",e):as(Number(t),yE(e))}function Ok(t,e,i,r){return t.trim().split(e).map(n=>as(Number(n),yE(r))).join(i)}function qAe(t,e){if(t!=null&&t.length&&e)return t.find(i=>{var r;return((r=i.fieldName)==null?void 0:r.toLowerCase())===e.toLowerCase()})}function HAe({fieldName:t,graphic:e,layer:i}){if(Xne(t)||!i||typeof i.getFeatureType!="function")return null;const{typeIdField:r}=i;if(!r||t!==r)return null;const n=i.getFeatureType(e);return n?n.name:null}function WAe({fieldName:t,value:e,graphic:i,layer:r}){if(Xne(t)||!r||typeof r.getFieldDomain!="function")return null;const n=i&&r.getFieldDomain(t,{feature:i});return n&&n.type==="coded-value"?n.getName(e):null}function ott(t,e,i,r){const{creatorField:n,creationDateField:o,editorField:u,editDateField:p}=t;if(!e)return;const g=GY(r&&"preferredTimeZone"in r?r.preferredTimeZone:null,!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone,i,nG,"date"),w={...nG,...g},S=e[p];if(typeof S=="number"){const E=e[u];return{type:"edit",date:ln(S,w),user:E}}const T=e[o];if(typeof T=="number"){const E=e[n];return{type:"create",date:ln(T,w),user:E}}return null}function att(t,e){const i=new Map;if(!t)return i;for(const r of t){if(!r.fieldName)continue;const n=zR(r.fieldName,e);r.fieldName=n,i.set(n.toLowerCase(),r)}return i}function ltt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:r}=t;return i&&e.push(...i),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const o=n==null?void 0:n.fieldInfos;o&&e.push(...o)}}),e}function utt(t){return t.replaceAll(TAe,e=>`&#${e.charCodeAt(0)};`)}function Kne(t){return typeof t=="string"?t.replaceAll($Ae,'<br class="esri-text-new-line" />'):t}function Yne(t){var T;const{value:e,fieldName:i,fieldInfos:r,fieldInfoMap:n,layer:o,graphic:u,timeZone:p}=t;if(e==null)return"";const g=WAe({fieldName:i,value:e,graphic:u,layer:o});if(g)return g;const w=HAe({fieldName:i,graphic:u,layer:o});if(w)return w;if(n.get(i.toLowerCase()))return GAe(e,{fieldInfos:r||Array.from(n.values()),fieldName:i,layer:o,timeZone:p});const S=(T=o==null?void 0:o.fieldsIndex)==null?void 0:T.get(i);return S&&(P3(S)||db(S))?VR(e,{fieldType:S.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:p,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}}):Kne(e)}function ctt({fieldInfos:t,attributes:e,layer:i,graphic:r,fieldInfoMap:n,relatedInfos:o,timeZone:u}){const p={};return o==null||o.forEach(g=>YAe({attributes:p,relatedInfo:g,fieldInfoMap:n,fieldInfos:t,layer:i,timeZone:u})),e&&Object.keys(e).forEach(g=>{const w=e[g];p[g]=Yne({fieldName:g,fieldInfos:t,fieldInfoMap:n,layer:i,value:w,graphic:r,timeZone:u})}),p}async function JAe(t,e){var S,T;const{layer:i,graphic:r,outFields:n,objectIds:o,returnGeometry:u,spatialReference:p}=t,g=o[0];if(typeof g!="number"&&typeof g!="string"){const E="Could not query required fields for the specified feature. The feature's ID is invalid.",C={layer:i,graphic:r,objectId:g,requiredFields:n};return xO().warn(E,C),null}if(!((T=(S=Cm(i))==null?void 0:S.operations)!=null&&T.supportsQuery)){const E="The specified layer cannot be queried. The following fields will not be available.",C={layer:i,graphic:r,requiredFields:n,returnGeometry:u};return xO().warn(E,C),null}const w=i.createQuery();return w.objectIds=o,w.outFields=n!=null&&n.length?n:[i.objectIdField],w.returnGeometry=!!u,w.returnZ=!!u,w.returnM=!!u,w.outSpatialReference=p,(await i.queryFeatures(w,e)).features[0]}async function ZAe(t){var r;if(!((r=t.expressionInfos)!=null&&r.length))return!1;const e=await fh(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function htt({graphic:t,popupTemplate:e,layer:i,spatialReference:r},n){if(!i||!e||(typeof i.load=="function"&&await i.load(n),!t.attributes))return;const o=i.objectIdField,u=t.attributes[o];if(u==null)return;const p=[u],g=await e.getRequiredFields(i.fieldsIndex),w=TX(g,t),S=w?[]:g.includes(o)?g:[...g,o],T=e.returnGeometry||await ZAe(e);if(w&&!T)return;const E=await JAe({layer:i,graphic:t,outFields:S,objectIds:p,returnGeometry:T,spatialReference:r},n);E&&(E.geometry&&(t.geometry=E.geometry),E.attributes&&(t.attributes={...t.attributes,...E.attributes}))}function Xne(t=""){return!!t&&t.includes(Jne)}function KAe(t){return t?`${Jne}${t.layerId}/${t.fieldName}`:""}function sG({attributes:t,graphic:e,relatedInfo:i,fieldInfos:r,fieldInfoMap:n,layer:o,timeZone:u}){t&&e&&i&&Object.keys(e.attributes).forEach(p=>{const g=KAe({layerId:i.relation.id.toString(),fieldName:p}),w=e.attributes[p];t[g]=Yne({fieldName:g,fieldInfos:r,fieldInfoMap:n,layer:o,value:w,graphic:e,timeZone:u})})}function YAe({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:o}){var u,p;t&&e&&((u=e.relatedFeatures)==null||u.forEach(g=>sG({attributes:t,graphic:g,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:o})),(p=e.relatedStatsFeatures)==null||p.forEach(g=>sG({attributes:t,graphic:g,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n,timeZone:o})))}const oG=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Qne=({layer:t,method:e,query:i,definitionExpression:r})=>{var u,p;if(!((p=(u=t.capabilities)==null?void 0:u.query)!=null&&p.supportsCacheHint)||e==="attachments")return;const n=i.where!=null?i.where:null,o=i.geometry!=null?i.geometry:null;oG(r)||oG(n)||(o==null?void 0:o.type)==="extent"||i.resultType==="tile"||(i.cacheHint=!0)},ptt=({query:t,layer:e,method:i})=>{Qne({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})},dtt=({queryPayload:t,layer:e,method:i})=>{Qne({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})};function XAe(t,e,i){var r,n;return t&&e&&i?e.type==="sublayer"?fv({layers:(r=e.layer)==null?void 0:r.sublayers,map:t,relatedLayer:e,relationship:i})||fv({layers:(n=e.layer)==null?void 0:n.subtables,map:t,relatedLayer:e,relationship:i}):fv({layers:t.allLayers,map:t,relatedLayer:e,relationship:i})||fv({layers:t.allTables,map:t,relatedLayer:e,relationship:i}):null}function aG(t,e){return t==null?void 0:t.allTables.find(i=>{var r;return i.type==="feature"&&i.layerId===e.id&&i.url===((r=e.layer)==null?void 0:r.url)})}function fv({map:t,relationship:e,relationship:{relatedTableId:i},relatedLayer:r,layers:n}){var o;if(!n)return null;for(const u of n){if(u.type==="map-image"){const g=fv({layers:u.sublayers,map:t,relatedLayer:r,relationship:e})||fv({layers:u.subtables,map:t,relatedLayer:r,relationship:e});if(g)return g;continue}if(!CS(u))continue;if(r.type==="sublayer"){if(u!==r&&u.id===i)return u.isTable?aG(t,u):u;continue}const p=r.type==="scene"&&r.associatedLayer?r.associatedLayer.url:r.url;if(!p)return null;if(u.type!=="sublayer"){if(u!==r&&u.url===p&&u.layerId===i)return u}else if(u!==r&&((o=u.layer)==null?void 0:o.url)===p&&u.id===i)return u.isTable?aG(t,u):u}return null}function lG(t){const e=t.getObjectId();return e!=null?`oid:${e}`:`uid:${t.uid}`}const uG={editing:!1,operations:{add:!0,update:!0,delete:!0}},ese=Ie.ofType(bAe);let Fo=class extends Te{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.capabilities={...uG},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new ese,this.fileInfos=new Ie,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(ce(()=>this.graphic,()=>this._graphicChanged(),Qe))}destroy(){this._attachmentLayer=null,this.graphic=null}castCapabilities(e){return{...uG,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const i=e.layer||e.sourceLayer;return(i==null?void 0:i.loaded)&&"capabilities"in i&&i.capabilities&&"operations"in i.capabilities&&"supportsResizeAttachments"in i.capabilities.operations&&i.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:i}=this;if(!e||typeof e.queryAttachments!="function")throw new re("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId(),n=new cL({objectIds:[r],returnMetadata:!0}),o=[],u=e.queryAttachments(n).then(g=>g[r]||o).catch(()=>o);this._getAttachmentsPromise=u,this.notifyChange("state");const p=await u;return i.destroyAll(),p.length&&i.addMany(p),this._getAttachmentsPromise=null,this.notifyChange("state"),p}async addAttachment(e,i=this.graphic){var g;const{_attachmentLayer:r,attachmentInfos:n,capabilities:o}=this;if(!i)throw new re("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:i});if(!e)throw new re("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!((g=o.operations)!=null&&g.add))throw new re("invalid-capabilities","addAttachment(): add capabilities are required.");if(!r||typeof r.addAttachment!="function")throw new re("invalid-layer","addAttachment(): A valid layer is required.");const u=r.addAttachment(i,e).then(w=>this._queryAttachment(w.objectId,i)),p=await u;return n.add(p),p}async deleteAttachment(e){var g;const{_attachmentLayer:i,attachmentInfos:r,graphic:n,capabilities:o}=this;if(!e)throw new re("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!((g=o.operations)!=null&&g.delete))throw new re("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!i||typeof i.deleteAttachments!="function")throw new re("invalid-layer","deleteAttachment(): A valid layer is required.");if(!n)throw new re("invalid-graphic","deleteAttachment(): A graphic is required.");const u=i.deleteAttachments(n,[e.id]).then(()=>e),p=await u;return r.remove(p),p.destroy(),p}async updateAttachment(e,i=this.activeAttachmentInfo){var S;const{_attachmentLayer:r,attachmentInfos:n,graphic:o,capabilities:u}=this;if(!e)throw new re("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!i)throw new re("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:i});if(!((S=u.operations)!=null&&S.update))throw new re("invalid-capabilities","updateAttachment(): Update capabilities are required.");const p=n.indexOf(i);if(!r||typeof r.updateAttachment!="function")throw new re("invalid-layer","updateAttachment(): A valid layer is required.");if(!o)throw new re("invalid-graphic","updateAttachment(): A graphic is required.");const g=r.updateAttachment(o,i.id,e).then(T=>this._queryAttachment(T.objectId)),w=await g;return n.splice(p,1,w),w}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,i){if(!e||!i)return null;const r={file:e,form:i};return this.fileInfos.add(r),r}updateFile(e,i,r=this.activeFileInfo){if(!e||!i||!r)return null;const n=this.fileInfos.indexOf(r);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:i}),this.fileInfos.items[n]}deleteFile(e){const i=this.fileInfos.find(r=>r.file===e);return i?(this.fileInfos.remove(i),i):null}async _queryAttachment(e,i){const{_attachmentLayer:r}=this;if(!e||!(r!=null&&r.queryAttachments))throw new re("invalid-attachment-id","Could not query attachment.");const n=this._getObjectId(i),o=new cL({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return r.queryAttachments(o).then(u=>u[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,i=MAe(e);this._attachmentLayer=i?i.type==="scene"&&i.associatedLayer!=null?i.associatedLayer:i:null}};m([b()],Fo.prototype,"capabilities",void 0),m([Dt("capabilities")],Fo.prototype,"castCapabilities",null),m([b()],Fo.prototype,"activeAttachmentInfo",void 0),m([b()],Fo.prototype,"activeFileInfo",void 0),m([b({readOnly:!0,type:ese})],Fo.prototype,"attachmentInfos",void 0),m([b()],Fo.prototype,"fileInfos",void 0),m([b({type:Cr})],Fo.prototype,"graphic",void 0),m([b()],Fo.prototype,"mode",void 0),m([b({readOnly:!0})],Fo.prototype,"state",null),m([b()],Fo.prototype,"filesEnabled",void 0),m([b({readOnly:!0})],Fo.prototype,"supportsResizeAttachments",null),Fo=m([G("esri.widgets.Attachments.AttachmentsViewModel")],Fo);const GR=Fo;function cG(t){const e=t.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function QAe(t){const e=qt("esri/themes/base/images/files/");return t?t==="text/plain"?`${e}text-32.svg`:t==="application/pdf"?`${e}pdf-32.svg`:t==="text/csv"?`${e}csv-32.svg`:t==="application/gpx+xml"?`${e}gpx-32.svg`:t==="application/x-dwf"?`${e}cad-32.svg`:t==="application/postscript"||t==="application/json"||t==="text/xml"||t==="model/vrml"?`${e}code-32.svg`:t==="application/x-zip-compressed"||t==="application/x-7z-compressed"||t==="application/x-gzip"||t==="application/x-tar"||t==="application/x-gtar"||t==="application/x-bzip2"||t==="application/gzip"||t==="application/x-compress"||t==="application/x-apple-diskimage"||t==="application/x-rar-compressed"||t==="application/zip"?`${e}zip-32.svg`:t.includes("image/")?`${e}image-32.svg`:t.includes("audio/")?`${e}sound-32.svg`:t.includes("video/")?`${e}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${e}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${e}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const $n={checkMark:"esri-icon-check-mark",close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",loadingIndicator:"esri-icon-loading-indicator",locateCircled:"esri-icon-locate-circled",minus:"esri-icon-minus",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"},hG={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Yt="esri-attachments",ft={base:Yt,loaderContainer:`${Yt}__loader-container`,loader:`${Yt}__loader`,fadeIn:`${Yt}--fade-in`,container:`${Yt}__container`,containerList:`${Yt}__container--list`,containerPreview:`${Yt}__container--preview`,actions:`${Yt}__actions`,deleteButton:`${Yt}__delete-button`,addAttachmentButton:`${Yt}__add-attachment-button`,errorMessage:`${Yt}__error-message`,items:`${Yt}__items`,item:`${Yt}__item`,itemButton:`${Yt}__item-button`,itemMask:`${Yt}__item-mask`,itemMaskIcon:`${Yt}__item-mask--icon`,itemImage:`${Yt}__image`,itemImageResizable:`${Yt}__image--resizable`,itemLabel:`${Yt}__label`,itemFilename:`${Yt}__filename`,itemChevronIcon:`${Yt}__item-chevron-icon`,itemLink:`${Yt}__item-link`,itemLinkOverlay:`${Yt}__item-link-overlay`,itemLinkOverlayIcon:`${Yt}__item-link-overlay-icon`,itemEditIcon:`${Yt}__item-edit-icon`,itemAddIcon:`${Yt}__item-add-icon`,itemAddButton:`${Yt}__item-add-button`,formNode:`${Yt}__form-node`,fileFieldset:`${Yt}__file-fieldset`,fileLabel:`${Yt}__file-label`,fileName:`${Yt}__file-name`,fileInput:`${Yt}__file-input`,metadata:`${Yt}__metadata`,metadataFieldset:`${Yt}__metadata-fieldset`,progressBar:`${Yt}__progress-bar`},Pk=window.CSS;let fs=class extends vi{constructor(e,i){super(e,i),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=null,this.visibleElements={...hG},this._supportsImageOrientation=Pk&&Pk.supports&&Pk.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}normalizeCtorArgs(e){return e!=null&&e.viewModel||(e={viewModel:new GR,...e}),e}initialize(){this.addHandles([gi(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),gi(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),ce(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),Qe)])}loadDependencies(){return zi({icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227]))})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get icon(){return"attachment"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...hG,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.addAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new re("attachments:add-attachment",this.messages.addErrorMessage,r)),r})}deleteAttachment(e){const{viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.deleteAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new re("attachments:delete-attachment",this.messages.deleteErrorMessage,r)),r})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:i}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(i).then(r=>(this._set("submitting",!1),this._set("error",null),e.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new re("attachments:update-attachment",this.messages.updateErrorMessage,r)),r})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,i=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",i}deleteFile(e){var r;const i=this.viewModel.deleteFile(e||((r=this.viewModel.activeFileInfo)==null?void 0:r.file));return this.viewModel.mode="view",i}render(){const{submitting:e,viewModel:i}=this,{state:r}=i;return N("div",{class:this.classes(ft.base,Ee.widget)},e?this._renderProgressBar():null,r==="loading"?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const{error:e,visibleElements:i}=this;return e&&i.errorMessage?N("div",{class:ft.errorMessage,key:"error-message"},e.message):null}_renderAttachments(){const{activeFileInfo:e,mode:i,activeAttachmentInfo:r}=this.viewModel;return i==="add"?this._renderAddForm():i==="edit"?this._renderDetailsForm(r||e):this._renderAttachmentContainer()}_renderLoading(){return N("div",{class:ft.loaderContainer,key:"loader"},N("div",{class:ft.loader}))}_renderProgressBar(){return this.visibleElements.progressBar?N("div",{class:ft.progressBar,key:"progress-bar"}):null}_renderAddForm(){const{submitting:e,selectedFile:i}=this,r=e||!i,n=this.visibleElements.cancelAddButton?N("button",{bind:this,class:this.classes(Ee.button,Ee.buttonTertiary,Ee.buttonSmall,Ee.buttonHalf,e&&Ee.buttonDisabled),disabled:e,onclick:this._cancelForm,type:"button"},this.messages.cancel):null,o=this.visibleElements.addSubmitButton?N("button",{class:this.classes(Ee.button,Ee.buttonSecondary,Ee.buttonSmall,Ee.buttonHalf,{[Ee.buttonDisabled]:r}),disabled:r,type:"submit"},this.messages.add):null,u=i?N("span",{class:ft.fileName,key:"file-name"},i.name):null,p=N("form",{afterCreate:hv,afterRemoved:kz,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},N("fieldset",{class:ft.fileFieldset},u,N("label",{class:this.classes(ft.fileLabel,Ee.button,Ee.buttonSecondary)},i?this.messages.changeFile:this.messages.selectFile,N("input",{bind:this,class:ft.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),o,n);return N("div",{class:ft.formNode,key:"add-form-container"},p)}_renderDetailsForm(e){var H,J,X;const{visibleElements:i,viewModel:r,selectedFile:n,submitting:o}=this,{capabilities:u}=r,p=o||!n;let g,w,S,T;n?(g=n.type,w=n.name,S=n.size):e&&"file"in e?(g=e.file.type,w=e.file.name,S=e.file.size):e&&"contentType"in e&&(g=e.contentType,w=e.name,S=e.size,T=e.url);const E=u.editing&&((H=u.operations)!=null&&H.delete)&&i.deleteButton?N("button",{bind:this,class:this.classes(Ee.button,Ee.buttonSmall,Ee.buttonTertiary,ft.deleteButton,{[Ee.buttonDisabled]:o}),disabled:o,key:"delete-button",onclick:te=>this._submitDeleteAttachment(te,e),type:"button"},this.messages.delete):void 0,C=u.editing&&((J=u.operations)!=null&&J.update)&&i.updateButton?N("button",{class:this.classes(Ee.button,Ee.buttonSmall,Ee.buttonThird,{[Ee.buttonDisabled]:p}),disabled:p,key:"update-button",type:"submit"},this.messages.update):void 0,L=this.visibleElements.cancelUpdateButton?N("button",{bind:this,class:this.classes(Ee.button,Ee.buttonSmall,Ee.buttonTertiary,Ee.buttonThird,{[Ee.buttonDisabled]:o}),disabled:o,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0,R=u.editing&&((X=u.operations)!=null&&X.update)?N("fieldset",{class:ft.fileFieldset,key:"file"},N("span",{class:ft.fileName,key:"file-name"},w),N("label",{class:this.classes(ft.fileLabel,Ee.button,Ee.buttonSecondary)},this.messages.changeFile,N("input",{bind:this,class:ft.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0,F=N("fieldset",{class:ft.metadataFieldset,key:"size"},N("label",null,yAe(this.messagesUnits,S??0))),V=N("fieldset",{class:ft.metadataFieldset,key:"content-type"},N("label",null,g)),U=T!=null?N("a",{class:ft.itemLink,href:T,rel:"noreferrer",target:"_blank"},this._renderImageMask(e,400),N("div",{class:ft.itemLinkOverlay},N("span",{class:ft.itemLinkOverlayIcon},N("calcite-icon",{icon:"launch"})))):this._renderImageMask(e,400),W=N("form",{afterCreate:hv,afterRemoved:kz,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:te=>this._submitUpdateAttachment(te,e)},N("div",{class:ft.metadata},F,V),R,N("div",{class:ft.actions},E,L,C));return N("div",{class:ft.formNode,key:"edit-form-container"},U,W)}_renderImageMask(e,i){return e?"file"in e?this._renderGenericImageMask(e.file.name,e.file.type):this._renderImageMaskForAttachment(e,i):null}_renderGenericImageMask(e,i){const{supportsResizeAttachments:r}=this.viewModel,n=QAe(i),o={[ft.itemImageResizable]:r};return N("div",{class:this.classes(ft.itemMaskIcon,ft.itemMask),key:n},N("img",{alt:e,class:this.classes(o,ft.itemImage),src:n,title:e}))}_renderImageMaskForAttachment(e,i){const{supportsResizeAttachments:r}=this.viewModel;if(!e)return null;const{contentType:n,name:o,url:u}=e;if(!r||!cG(n))return this._renderGenericImageMask(o,n);const p=this._getCSSTransform(e),g=p?{transform:p,"image-orientation":"none"}:{},w=`${u}${u!=null&&u.includes("?")?"&":"?"}w=${i}`,S={[ft.itemImageResizable]:r};return N("div",{class:this.classes(ft.itemMask),key:w},N("img",{alt:o,class:this.classes(S,ft.itemImage),src:w,styles:g,title:o}))}_renderFile(e){const{file:i}=e;return N("li",{class:ft.item,key:i},N("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:ft.itemButton,key:"details-button",onclick:()=>this._startEditFile(e),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(e),N("label",{class:ft.itemLabel},N("span",{class:ft.itemFilename},i.name||this.messages.noTitle),N("span",{"aria-hidden":"true",class:this.classes(ft.itemChevronIcon,Nm(this.container)?$n.left:$n.right)}))))}_renderAttachmentInfo({attachmentInfo:e,displayType:i}){const{viewModel:r,effectiveDisplayType:n}=this,{capabilities:o,supportsResizeAttachments:u}=r,{contentType:p,name:g,url:w}=e,S=this._renderImageMask(e,i==="list"?48:400),T=o.editing?N("span",{"aria-hidden":"true",class:this.classes(ft.itemChevronIcon,Nm(this.container)?$n.left:$n.right)}):null,E=[S,n==="preview"&&u&&cG(p)?null:N("label",{class:ft.itemLabel},N("span",{class:ft.itemFilename},g||this.messages.noTitle),T)],C=o.editing?N("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:ft.itemButton,"data-attachment-info-id":e.id,key:"details-button",onclick:()=>this._startEditAttachment(e),title:this.messages.attachmentDetails,type:"button"},E):N("a",{class:ft.itemButton,href:w??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},E);return N("li",{class:ft.item,key:e},C)}_renderAttachmentContainer(){var L;const{effectiveDisplayType:e,viewModel:i,visibleElements:r}=this,{attachmentInfos:n,capabilities:o,fileInfos:u}=i,p=!!(n!=null&&n.length),g=!!(u!=null&&u.length),w={[ft.containerList]:e!=="preview",[ft.containerPreview]:e==="preview"},S=o.editing&&((L=o.operations)!=null&&L.add)&&r.addButton?N("button",{bind:this,class:this.classes(Ee.button,Ee.buttonTertiary,ft.addAttachmentButton),onclick:()=>this._startAddAttachment(),type:"button"},N("span",{"aria-hidden":"true",class:this.classes(ft.itemAddIcon,$n.plus)}),this.messages.add):void 0,T=p?N("ul",{class:ft.items,key:"attachments-list"},n.toArray().map(R=>this._renderAttachmentInfo({attachmentInfo:R,displayType:e}))):void 0,E=g?N("ul",{class:ft.items,key:"file-list"},u.toArray().map(R=>this._renderFile(R))):void 0,C=g||p?void 0:N("div",{class:Ee.empty},this.messages.noAttachments);return N("div",{class:this.classes(ft.container,w),key:"attachments-container"},T,E,C,S)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){var n;const i=e.target,r=(n=i.files)==null?void 0:n.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,i){e.preventDefault(),i&&("file"in i?this.deleteFile(i.file):i&&this.deleteAttachment(i))}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,i){e.preventDefault(),i&&"file"in i?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:i}=this;i.activeFileInfo=null,i.activeAttachmentInfo=e,i.mode="edit"}_startEditFile(e){const{viewModel:i}=this;i.activeAttachmentInfo=null,i.activeFileInfo=e,i.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:i}=e;return!this._supportsImageOrientation&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};m([b()],fs.prototype,"capabilities",null),m([b()],fs.prototype,"displayType",void 0),m([b({readOnly:!0})],fs.prototype,"effectiveDisplayType",null),m([b()],fs.prototype,"graphic",null),m([b()],fs.prototype,"icon",null),m([b()],fs.prototype,"label",null),m([b(),vt("esri/widgets/Attachments/t9n/Attachments")],fs.prototype,"messages",void 0),m([b(),vt("esri/core/t9n/Units")],fs.prototype,"messagesUnits",void 0),m([b({readOnly:!0})],fs.prototype,"selectedFile",void 0),m([b({readOnly:!0})],fs.prototype,"submitting",void 0),m([b({readOnly:!0})],fs.prototype,"error",void 0),m([b({type:GR})],fs.prototype,"viewModel",void 0),m([b()],fs.prototype,"visibleElements",void 0),m([Dt("visibleElements")],fs.prototype,"castVisibleElements",null),fs=m([G("esri.widgets.Attachments")],fs);const eLe=fs,BR="exclamation-mark-triangle",_g="esri-editor__prompt",Sg={base:_g,header:`${_g}__header`,heading:`${_g}__header__heading`,message:`${_g}__message`,divider:`${_g}__divider`,actions:`${_g}__actions`},tLe=()=>zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),scrim:()=>ie(()=>import("./calcite-scrim-CBy6Hnad.js"),__vite__mapDeps([268,250,225,220,226,227,228,230])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),"radio-button":()=>ie(()=>import("./calcite-radio-button-CcS5x8sg.js"),__vite__mapDeps([279,242,220,219,221,222,223,224])),"radio-button-group":()=>ie(()=>import("./calcite-radio-button-group-DAXgLR4O.js"),__vite__mapDeps([280,227,220,224,253,229,255]))});function tse({actions:t,context:e,headingLevel:i,message:r,title:n,...o}){const{primary:u,secondary:p}=t;let g;switch(e){case"danger":g="danger";break;case"info":g="brand";break;default:g="neutral"}const w=N("calcite-button",{afterCreate:rLe,appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:g,onclick:u.action,width:p?"half":"full"},u.label),S=p&&N("calcite-button",{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:g,onclick:p.action,width:"half"},p.label);return N("calcite-scrim",{"data-testid":"prompt",key:"prompt"},N("div",{class:`${Sg.base}--${e}`},N("div",{class:Sg.header},N("calcite-icon",{icon:BR}),N(jl,{class:Sg.heading,level:i},n)),N("div",{class:Sg.message},r),iLe(o)??N("div",{class:Sg.divider}),N("div",{class:Sg.actions},S,w)))}function iLe({radios:t,onRadioSelection:e,defaultRadioSelection:i}){return t!=null&&t.length?N("calcite-radio-button-group",{name:"PromptChoiceList"},t.map(r=>N("calcite-label",{layout:"inline"},N("calcite-radio-button",{checked:r.value===i,value:r.value,onCalciteRadioButtonChange:()=>e==null?void 0:e(r.value)}),r.label))):void 0}function rLe(t){requestAnimationFrame(()=>t.setFocus())}const La="esri-feature-form",Rk=`${La}__group`,xg=`${La}__input`,Fk=`${La}__related-records`,Ui={base:La,form:`${La}__form`,formHeader:`${La}__form-header`,label:`${La}__label`,labelTextContent:`${La}__label-text-content`,fieldInput:`${xg}`,inputRadio:`${xg}--radio`,inputRadioGroup:`${xg}--radio-group`,inputRadioLabel:`${xg}--radio-label`,inputDisabled:`${xg}--disabled`,inputSwitch:`${xg}--switch`,centeredButton:`${La}__centered-button`,description:`${La}__description-text`,listObserver:`${La}__list-observer`,relatedRecordsHeader:`${Fk}_header`,relatedRecordsLabel:`${Fk}_label`,relatedRecordsList:`${Fk}_list`,dateInputContainer:`${`${La}__date`}-input-container`,textElement:`${La}__text-element`,group:Rk,groupSequential:`${Rk}--sequential`,groupActive:`${Rk}--active`},Uv=t=>(t==null?void 0:t.type)==="field",Vf=t=>(t==null?void 0:t.type)==="group",JE=t=>(t==null?void 0:t.type)==="relationship",ise=t=>t.type==="text",Nk=t=>!Vf(t)&&t.group!=null,qR=t=>t.reduce((e,i)=>Vf(i)?[...e,...i.inputs]:[...e,i],[]),nLe=t=>qR(t).filter(Uv),sLe=t=>qR(t).filter(JE),pG=t=>t!=null&&(jm(t,"combo-box")||jm(t,"radio-buttons")),jm=(t,e)=>{var i;return t!=null&&((i=t.input)==null?void 0:i.type)===e},dG=t=>t!=null&&(jm(t,"text-box")||jm(t,"text-area")),oLe=({domain:t,inputType:e="text-box",dataType:i})=>i==="number"&&e==="text-box"&&(!t||t.type!=="coded-value"),rse=t=>"items"in t;function R3(t){const{attributes:e,fieldsIndex:i,label:r,timeZone:n}=t;if(!e||typeof e!="object")return r;const o=Object.keys(e).filter(g=>X2(r,g)),u=o.map(g=>e[g]),p=o.map(g=>i.get(g)).filter(Rt);return pLe(r,nse({values:u,fields:p,timeZone:n}))}const ZE="expression/",aLe="expr/",lLe="field/";function uLe(t){const[e,i]=t.split(ZE);return e===""&&i?i:(fe.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${t} is not a valid expression reference of the form '${ZE}/expressionName'`),"")}function fG(t){return`${ZE}${t}`}function yG(t){return`${lLe}${t}`}function cLe(t){return t.startsWith(ZE)}function hLe(t){return t.startsWith(aLe)}function nse(t){const{fields:e,values:i}=t,r=t.timeZone??void 0,n=e.map((o,u)=>{let p=i[u];if(o.domain&&o.domain.type==="coded-value"){const g=o.domain.codedValues.find(w=>w.code===p);g!=null&&g.name&&(p=g.name)}return(P3(o)||db(o))&&(p=uX(o,p,{timeZone:r,...YP(o)})),[o.name,p]});return Object.fromEntries(n)}function pLe(t,e){return Xu(Xu(t,i=>`{${i.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([i,r])=>[i.toLowerCase(),r])))}const KE=t=>{var i,r,n,o;const e={typeFieldName:null,types:[]};return t&&(t.type==="subtype-sublayer"?(e.typeFieldName=(i=t.parent)==null?void 0:i.subtypeField,e.types=((r=t.parent)==null?void 0:r.subtypes)??[]):t.type==="subtype-group"||t.type==="feature"&&((n=t.subtypes)!=null&&n.length)?(e.typeFieldName=t.subtypeField,e.types=t.subtypes??[]):"types"in t&&t.types&&(e.typeFieldName=t.typeIdField,e.types=t.types.map(({id:u,name:p,domains:g})=>({code:u,name:p,domains:g}))),e.typeFieldName!=null&&(e.typeFieldName=((o=t.getField(e.typeFieldName))==null?void 0:o.name)??e.typeFieldName)),e},dLe=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};var Tb;(function(t){t.TOO_SHORT="length-validation-error::too-short",t.TOO_LONG="length-validation-error::too-long"})(Tb||(Tb={}));const mG={type:"number"},gG={type:"number",intlOptions:{notation:"scientific"}};function vG(t){return t>=1e7||t<=-1e7}function fLe(t,{validationErrors:e}){return t.max!=null&&t.min!=null?e.outsideRange:t.max!=null?e.outsideRangeMax:e.outsideRangeMin}const yLe=(t,e,i)=>{const{dataType:r,error:n,minLength:o,value:u,required:p}=t,g=e==null?void 0:e.validationErrors;if(!g||!n)return null;if(p&&u===null)return g.cannotBeNull;if(n===i0.VALUE_OUT_OF_RANGE||n===fb.OUT_OF_RANGE){const{field:w,range:S}=t,T={type:"date",intlOptions:{timeZone:w.type==="date"&&i?i:void 0,...YP(w)}},E=fLe(S,e);return qn(E,S,{format:{max:r==="date"?T:S.max!=null&&vG(S.max)?gG:mG,min:r==="date"?T:S.min!=null&&vG(S.min)?gG:mG}})}return n===i0.INVALID_CODED_VALUE?g.invalidCodedValue:n===yb.INVALID_TYPE?g.invalidType:n===Tb.TOO_SHORT?qn(g.tooShort,{min:o}):(Tb.TOO_LONG,null)},mLe=t=>{var n;if(!t)return;const e=t.layer,i=e&&"geometryType"in e?e.geometryType:void 0,r=(n=t.geometry)==null?void 0:n.type;return r==="polyline"||i==="polyline"?"line":r==="mesh"||i==="mesh"||i==="multipatch"?"cube":r==="multipoint"||i==="multipoint"?"point":r||i||"table"},gLe=t=>{var i;const e=[];if(t.formTemplate){const{description:r,title:n}=t.formTemplate;(i=t.fields)==null||i.forEach(o=>{const u=n&&X2(n,o.name),p=r&&X2(r,o.name);(u||p)&&e.push(o.name)})}return e};function vLe(t,e){var r;const i=e??("formTemplate"in t&&t.formTemplate);return i?(((r=i.elements)==null?void 0:r.filter(D8))??[]).some(({fieldName:n})=>!t.fieldsIndex.get(n)):!1}function bLe(t,e){return t==null||e.onValue!==t&&e.offValue!==t}function wLe(t,e){var i;switch(e.objectType){case"any":return!0;case"null":return t==null;case"code":return t===((i=e.codedValue)==null?void 0:i.code);case"range":return t!=null&&e.minValue!=null&&e.maxValue!=null&&+t>=e.minValue&&+t<=e.maxValue;default:return e.objectType,!1}}function _Le(t,e,i){var o,u;if(!t||!("subtypes"in t))return!1;const r=(o=t.subtypes)==null?void 0:o.find(p=>p.code===i);if(!r)return!1;const n=(u=t.subtypes)==null?void 0:u.find(p=>p.code===e);return!N7(r.defaultValues,n==null?void 0:n.defaultValues)&&Object.values(r.defaultValues).some(p=>p!=null)}let My=class extends Te{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.codedValue=null}};m([b()],My.prototype,"objectType",void 0),m([b()],My.prototype,"maxValue",void 0),m([b()],My.prototype,"minValue",void 0),m([b()],My.prototype,"codedValue",void 0),My=m([G("esri.layers.support.ContingentValue")],My);const rs=My;let ky=class extends Te{constructor(e){super(e),this.isRetired=!1}};m([b()],ky.prototype,"id",void 0),m([b()],ky.prototype,"isRetired",void 0),m([b()],ky.prototype,"subtype",void 0),m([b()],ky.prototype,"values",void 0),ky=m([G("esri.layers.support.Contingency")],ky);const bG=ky;let Q_=class extends Te{constructor(e){super(e)}};m([b()],Q_.prototype,"fieldGroup",void 0),m([b()],Q_.prototype,"type",void 0),Q_=m([G("esri.layers.support.ContingencyConstraintViolation")],Q_);const wG=Q_;let e2=class extends Te{constructor(e){super(e)}};m([b()],e2.prototype,"contingentValuesAllGroups",void 0),m([b()],e2.prototype,"contingentValuesByFieldGroup",void 0),e2=m([G("esri.layers.support.ContingentValuesResult")],e2);const SLe=e2;let Cy=class extends Te{constructor(e){super(e),this.fields=null,this.isEditingRestrictive=!1}};m([b()],Cy.prototype,"name",void 0),m([b()],Cy.prototype,"fields",void 0),m([b()],Cy.prototype,"isEditingRestrictive",void 0),m([b()],Cy.prototype,"contingencies",void 0),Cy=m([G("esri.layers.support.FieldGroup")],Cy);const $O=Cy;var u5;let uf=u5=class extends Um(Qo){constructor(t){super(t),this.request=nt,this.fieldGroups=null,this.fieldGroupDefinitions=null}initialize(){}get subtypeFieldName(){return KE(this.layer).typeFieldName}static async createLoadedLayerContingentValuesCache(t){await t.load();const e=t.sourceJSON;if(t.layerId===void 0)return null;const i=e.hasContingentValuesDefinition;if(i)return new u5({layer:t}).load();if(i===void 0){const r=Zu(t.url);if(r==null)return null;const n=r.url.path;if((await SG(n)).supportsQueryDataElements){const o=t.layerId.toString(),u=await _G(n,o);if(u){const p=u.map(g=>({name:g.name,isEditingRestrictive:g.isEditingRestrictive,fields:g.fieldNames.names.map(w=>t.fieldsIndex.normalizeFieldName(w))}));return new u5({layer:t,fieldGroupDefinitions:p}).load()}}}return null}async load(t){const e=this.layer.load(t).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,t));return this.addResolvingPromise(e),this}validateContingencyConstraints(t,e){const i=Object.keys(t),r=[],n=[];for(const o of this.fieldGroups){const u=o.isEditingRestrictive?"error":"warning";if(e&&!o.fields.some(S=>e.includes(S)))continue;if(!o.fields.every(S=>i.includes(S))){n.push(new wG({fieldGroup:o,type:u}));continue}let p=!1;const g=t[this.subtypeFieldName],w=o.contingencies.filter(S=>!(!S.isRetired&&S.subtype)||S.subtype.code===g);if(w.length!==0){for(const S of w){let T=!0;for(const E in S.values){const C=S.values[E];if(C.objectType!=="any"){if(C.objectType==="null"){if(t[E]!=null){T=!1;break}}else if(C.objectType==="code"){if(t[E]!==C.codedValue.code){T=!1;break}}else if(C.objectType==="range"){const L=t[E];if(L<C.minValue||L>C.maxValue){T=!1;break}}}}if(T){p=!0;break}}p||r.push(new wG({fieldGroup:o,type:u}))}}return{invalid:r,incomplete:n}}getContingentValues(t,e,i=!1){const r=t[this.subtypeFieldName],n=r!=null,o={};let u=[];const p=this.fieldGroups.filter(g=>g.fields.includes(e));u.push(new rs({objectType:"any"}));for(const g of p){let w=[];const S=g.contingencies.filter(C=>!(C.isRetired||C.subtype&&n&&C.subtype.code!==r));let T=!1;const E={};for(const C of S){let L,R=!0;for(const F in C.values){const V=C.values[F];if(e!==F){if(t[F]!==void 0&&V.objectType!=="any"){if(V.objectType==="null")t[F]!==null&&(R=!1);else if(V.objectType==="code")t[F]!==V.codedValue.code&&(R=!1);else if(V.objectType==="range"){const U=t[F];(U<V.minValue||U>V.maxValue)&&(R=!1)}}}else L=V,T=T||V.objectType==="range"}if(L&&R){if(L.objectType==="any"){w.length=0,w.push(L);break}const F=xLe(L);E[F]||w.push(L),E[F]=!0}}T&&(w=$Le(w)),o[g.name]=w,u=i?ILe(u,w):[]}return p.length===1&&i&&(u=[]),new SLe({contingentValuesAllGroups:u,contingentValuesByFieldGroup:o})}async _initializeContingentValues(t,e){const i=t??await this._fetchFieldGroupDefs(e);if(i.length===0)return void(this.fieldGroups=[]);const r=await this._fetchContingentValues(i,e);this.fieldGroups=r}async _fetchFieldGroupDefs(t){if(this.layer.layerId===void 0)return[];const e=this.layer.sourceJSON,i=this.layer.layerId.toString(),r=Zu(this.layer.url).url.path;return e.hasContingentValuesDefinition?(await MLe(r,i,t)).map(n=>({name:n.name,isEditingRestrictive:n.restrictive,fields:n.fields.map(o=>this.layer.fieldsIndex.normalizeFieldName(o))})):e.hasContingentValuesDefinition!==void 0?[]:SG(r,t).then(async n=>n.supportsQueryDataElements?(await _G(r,i,t)).map(o=>({name:o.name,isEditingRestrictive:o.isEditingRestrictive,fields:o.fieldNames.names.map(u=>this.layer.fieldsIndex.normalizeFieldName(u))})):[])}async _fetchContingentValues(t,e){if(this.layer.layerId===void 0)return[];const i=this.layer.sourceJSON,r=this.layer.layerId.toString(),n=Zu(this.layer.url).url.path;if(i.hasContingentValuesDefinition){const u=await CLe(n,r,e);return this._constructFieldGroupsAGOL(t,u)}const o=await kLe(n,r,e);return this._constructFieldGroupsEnterprise(t,o)}_constructFieldGroupsAGOL(t,e){return t.map(i=>{const r=e.contingentValuesDefinition.fieldGroups.find(n=>n.name===i.name);if(r){let n=[];return n=e.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(i,e,r.subTypes):this._parseAGOLFieldGroup(i,e,r.contingentValues),new $O({name:i.name,isEditingRestrictive:i.isEditingRestrictive,fields:i.fields,contingencies:n})}return null}).filter(Rt)}_parseAGOLFieldGroupSubtype(t,e,i){let r=[];return i==null||i.forEach(n=>{const o=this._getSubtypeAGOL(n.name);r=r.concat(this._parseAGOLFieldGroup(t,e,n.contingentValues,o))}),r}_parseAGOLFieldGroup(t,e,i,r=null){const n=[];for(const o of i??[]){const u=this._parseAGOLContingency(o,t,e,r);n.push(u)}return n}_parseAGOLContingency(t,e,i,r){const n=t.id,o=!!t.retired&&t.retired===1,u={};for(let p=0,g=0;p<e.fields.length;p++){const w=e.fields[p],S=i.typeCodes[t.types[p]];if(S==="Code"){let T=t.values[g];g++;const E=this._getDomain(r,w),C=this.layer.getField(w);if((C==null?void 0:C.type)==="string"){const F=i.stringDicts.find(V=>V.domain===(E==null?void 0:E.name));F&&(T=F.entries[T])}const L=E==null?void 0:E.codedValues.find(F=>F.code===T),R=new rs({codedValue:L,objectType:"code"});u[w]=R}else if(S==="Range"){const T=t.values[g];g++;const E=T.range[0],C=T.range[1],L=new rs({minValue:E,maxValue:C,objectType:"range"});u[w]=L}else if(S==="Any"){const T=new rs({objectType:"any"});u[w]=T}else{const T=new rs({objectType:"null"});u[w]=T}}return new bG({id:n,isRetired:o,subtype:r,values:u})}_constructFieldGroupsEnterprise(t,e){const i=e.fieldGroups;return t.map(r=>{const n=i.find(o=>o.name===r.name);if(n){const o=n.contingencies.map(u=>{const p=u.id,g=u.isRetired||!1,w=this._getSubtypeEnterprise(u.subtypeCode),S={};for(let T=0;T<r.fields.length;T++){const E=r.fields[T];let C=u.values[T];if(typeof C=="number"||typeof C=="string"){const L=this._getDomain(w,E),R=this.layer.getField(E);mE(R)?C=e.stringDictionary[C]:e8(R)&&(C=new Date(`${C}+00:00`).getTime());const F=L==null?void 0:L.codedValues.find(U=>U.code===C),V=new rs({codedValue:F,objectType:"code"});S[E]=V}else if(typeof C=="object"){const L=C.minValue,R=C.maxValue,F=new rs({minValue:L,maxValue:R,objectType:"range"});S[E]=F}else if(C){const L=new rs({objectType:"any"});S[E]=L}else{const L=new rs({objectType:"null"});S[E]=L}}return new bG({id:p,isRetired:g,subtype:w,values:S})});return new $O({name:r.name,isEditingRestrictive:r.isEditingRestrictive,fields:r.fields,contingencies:o})}return null}).filter(Rt)}_getSubtypeEnterprise(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.code===t);i=fL.fromJSON(r)}return i||null}_getSubtypeAGOL(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.name===t);i=fL.fromJSON(r)}return i||null}_getDomain(t,e){const i=t?ALe(t,e):this.layer.getFieldDomain(e);return(i==null?void 0:i.type)==="inherited"?this.layer.getFieldDomain(e):i}};function xLe(t){switch(t.objectType){case"any":return"@any@";case"null":return"@null@";case"code":return t.codedValue.name+t.codedValue.code.toString();case"range":return t.minValue.toString()+"-"+t.maxValue.toString()}}function $Le(t){let e,i;t.sort((n,o)=>n.objectType==="null"?-1:o.objectType==="null"?1:n.minValue-o.minValue);const r=[];for(const n of t)n.objectType!=="null"?e!=null&&i!=null?i<n.minValue?(r.push(new rs({objectType:"range",minValue:e,maxValue:i})),e=n.minValue,i=n.maxValue):i<n.maxValue&&(i=n.maxValue):(e=n.minValue,i=n.maxValue):r.push(n);return r.push(new rs({objectType:"range",minValue:e,maxValue:i})),r}function TLe(t,e){const i=[];let r,n=0;for(const o of t)for(;n<e.length;n++){const u=e[n];if(o.objectType==="null"&&u.objectType==="null")i.push(new rs({objectType:"null"}));else{if(o.objectType==="null")break;if(u.objectType==="null")continue}if(o.maxValue<u.minValue)break;if(o.maxValue===u.minValue){i.push(new rs({objectType:"range",minValue:o.maxValue,maxValue:u.minValue}));break}if(!(o.minValue>u.maxValue))if(o.minValue!==u.maxValue){if(r=o.minValue>u.minValue?o.minValue:u.minValue,o.maxValue<u.maxValue){i.push(new rs({objectType:"range",minValue:r,maxValue:o.maxValue}));break}i.push(new rs({objectType:"range",minValue:r,maxValue:u.maxValue}))}else i.push(new rs({objectType:"range",minValue:o.minValue,maxValue:u.maxValue}))}return i}function ELe(t,e){const i=[];for(const r of t)e.some(n=>{if(r.objectType===n.objectType)switch(r.objectType){case"any":case"null":return!0;case"code":return r.codedValue.code===n.codedValue.code&&r.codedValue.name===n.codedValue.name}return!1})&&i.push(r);return i}function ILe(t,e){var n,o;if(t.length===0||e.length===0)return[];if(t[0].objectType==="any")return e;if(e[0].objectType==="any")return t;const i=t[0].objectType==="range"||((n=t[1])==null?void 0:n.objectType)==="range",r=e[0].objectType==="range"||((o=e[1])==null?void 0:o.objectType)==="range";return i||r?TLe(t,e):ELe(t,e)}async function MLe(t,e,i){return nt(`${t}/${e}/fieldgroups`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data.fieldGroups??[])}async function _G(t,e,i){return nt(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return((n=r.data.layerDataElements)==null?void 0:n[0].dataElement.fieldGroups)??[]})}async function SG(t,e){return nt(t,{responseType:"json",query:{f:"json"},...e}).then(i=>i.data)}async function kLe(t,e,i){return nt(`${t}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return(n=r.data.contingentValueSets)==null?void 0:n[0]})}async function CLe(t,e,i){return nt(`${t}/${e}/contingentValues`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data)}function ALe(t,e){const i=t.domains;if(i){const[r,n]=Object.entries(i).find(([o])=>o.trim().toLowerCase()===e.trim().toLowerCase())||[];return n||null}return null}m([b({constructOnly:!0})],uf.prototype,"layer",void 0),m([b({constructOnly:!0})],uf.prototype,"request",void 0),m([b({type:[$O]})],uf.prototype,"fieldGroups",void 0),m([b({constructOnly:!0})],uf.prototype,"fieldGroupDefinitions",void 0),m([b()],uf.prototype,"subtypeFieldName",null),uf=u5=m([G("esri.layers.support.LayerContingentValuesCache")],uf);const LLe=uf;let No=class extends Te{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return(e=this.element)==null?void 0:e.description}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get label(){var e;return(e=this.element)==null?void 0:e.label}get updating(){return!1}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}};m([b({readOnly:!0})],No.prototype,"description",null),m([b({constructOnly:!0})],No.prototype,"element",void 0),m([b()],No.prototype,"evaluatedVisibilityExpression",null),m([b()],No.prototype,"feature",void 0),m([b()],No.prototype,"label",null),m([b()],No.prototype,"layer",void 0),m([b()],No.prototype,"timeZone",void 0),m([b()],No.prototype,"type",void 0),m([b()],No.prototype,"updating",null),m([b()],No.prototype,"visible",null),m([b()],No.prototype,"visibilityExpressionExecutor",void 0),No=m([G("esri.widgets.FeatureForm.InputBase")],No);const HR=No;let cf=class extends HR{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const i=Cm(e),r=i==null?void 0:i.operations.supportsEditing,n=dLe(i,this.arcadeEditType);return!(!r||!n)}};m([b()],cf.prototype,"arcadeEditType",void 0),m([b()],cf.prototype,"editable",null),m([b()],cf.prototype,"editableExpressionExecutor",void 0),m([b()],cf.prototype,"evaluatedEditableExpression",null),m([b()],cf.prototype,"layerAllowsEdits",null),cf=m([G("esri.widgets.FeatureForm.EditableInput")],cf);const sse=cf;var _l;(function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"})(_l||(_l={}));const xG="__internal-type-based-coded-value-domain__";let ht=class extends sse{constructor(e){super(e),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(ce(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=!1,$s))}get _dateFormRange(){const{element:e,field:i}=this;if(this.dataType!=="date")return{};const r=e!=null&&e.domain?av(i,e.domain):null;if(!(e!=null&&e.input))return r??{};const n=e.input,{type:o}=n;let u={};if(o!=="date-picker"&&o!=="time-picker"&&o!=="datetimeoffset-picker"||(u=dX(i,n.max,n.min)),o==="datetime-picker"){const{max:w,min:S}=n;u={max:w!=null&&$G(w)?w.getTime():null,min:S!=null&&$G(S)?S.getTime():null}}const{max:p,min:g}=u;if(r){const{max:w,min:S}=r,T=q0(w)&&(p==null||p!=null&&w<p),E=q0(S)&&(g==null||g!=null&&S>g);return{max:T?w:p??null,min:E?S:g??null,rawMax:T?r.rawMax:(u==null?void 0:u.rawMax)??null,rawMin:E?r.rawMin:(u==null?void 0:u.rawMin)??null}}return{min:g,max:p,rawMax:(u==null?void 0:u.rawMax)??null,rawMin:(u==null?void 0:u.rawMin)??null}}get _dateRange(){const{_dateFormRange:e,field:i}=this;if(this.dataType!=="date")return{};const r=av(i);if(!r)return e;const{max:n,min:o,rawMax:u,rawMin:p}=e;if(i.type==="date"){const{max:g,min:w}=r;return{max:q0(n)&&(g===null||g!=null&&n<g)?n:g??null,min:q0(o)&&(w===null||w!=null&&o>w)?o:w??null}}if(i.type==="date-only"||i.type==="time-only"||i.type==="timestamp-offset"){const{max:g,min:w,rawMax:S,rawMin:T}=r,E=q0(n)&&u&&(g==null||n<g);return{max:E?n:g,min:q0(o)&&p&&(w==null||o>w)?o:w,rawMax:E?u:S,rawMin:E?p:T}}return{max:null,min:null}}get _configAllowsEdits(){var o,u;const{element:e,layer:i,name:r}=this;if(e!=null)return e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1;if(i!=null&&i.userHasUpdateItemPrivileges)return!0;const n=i&&"popupTemplate"in i?(u=(o=i==null?void 0:i.popupTemplate)==null?void 0:o.fieldInfos)==null?void 0:u.find(({fieldName:p})=>p===r):null;return(n==null?void 0:n.isEditable)??!0}get _layerAndFieldAllowEdits(){var e;return this.layerAllowsEdits&&((e=this.field)==null?void 0:e.editable)}get _isVisibleByDefault(){const{field:e,layer:i}=this;return!!(e!=null&&e.visible)&&bX(e,i)}get _isEditTrackingField(){var e;return QP(this.layer).includes((e=this.name)==null?void 0:e.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null}get isSubtypeField(){var i;const{layer:e}=this;if(e&&"subtypeField"in e){const{subtypeField:r,fieldsIndex:n}=e;return(((i=n.get(r))==null?void 0:i.name)??r)===this.name}return!1}get valueIsOutOfDomain(){const{domain:e,value:i,field:r}=this;return!(!e||i==null)&&PC(r,i,e)!==null}get dataType(){const{field:e}=this;return Mv(e)?_l.Number:mE(e)?_l.Text:P3(e)||db(e)?_l.Date:_l.Unsupported}get dateDataType(){if(this.dataType===_l.Date)return this.field.type!=="date"?"string":"number"}get description(){const{element:e,feature:i,layer:r,timeZone:n}=this,o=e==null?void 0:e.description;return r!=null&&o!=null?R3({label:o,attributes:i.attributes,fieldsIndex:r.fieldsIndex,timeZone:n}):o}get domain(){var p;const{layer:e}=this,{typeFieldName:i,types:r}=KE(e);if(this.isSubtypeField&&"subtypes"in e&&e.subtypes)return new SE({name:xG,codedValues:e.subtypes.map(({code:g,name:w})=>new rm({code:g,name:w}))});if(i===this.name&&this.field.domain==null)return new SE({name:xG,codedValues:r.map(({code:g,name:w})=>new rm({code:g,name:w}))});const{feature:n}=this,o=e==null?void 0:e.getFieldDomain(this.name,{feature:n}),u=(p=this.element)==null?void 0:p.domain;return u!=null&&this._isDomainCompatible(u)?u:o}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){var e;return(e=this.element)==null?void 0:e.hint}get includeDate(){return!(this.dataType!==_l.Date||this.field.type==="time-only")}get includeTime(){var n;const{element:e,field:i}=this;if(this.dataType!==_l.Date)return!1;if(i.type==="time-only")return!0;if(i.type==="date-only")return!1;const r=((n=e==null?void 0:e.input)==null?void 0:n.type)==="datetime-picker"?e.input.includeTime:void 0;return r===void 0||r}get includeTimeOffset(){var i;if(this.field.type!=="timestamp-offset")return!1;const e=(i=this.element)==null?void 0:i.input;return!e||e.type==="datetimeoffset-picker"&&e.includeTimeOffset}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){var e,i;return(i=(e=this.element)==null?void 0:e.input)==null?void 0:i.type}get hasInvalidSwitchValue(){const{element:e}=this,i=jm(e,"switch")?e.input:null;return!i||bLe(this.value,i)}get isRelationshipKeyField(){var r;const{field:e,layer:i}=this;return CS(i)&&!!((r=i.relationships)!=null&&r.some(n=>n.keyField===e.name))}get label(){const{element:e,feature:i,field:r,layer:n,timeZone:o}=this;return n!=null&&(e==null?void 0:e.label)!=null?R3({label:e.label,attributes:i.attributes,fieldsIndex:n.fieldsIndex,timeZone:o}):(e==null?void 0:e.label)||r.alias||r.name}get maxLength(){if(this.dataType===_l.Date)return-1;const{field:i,element:r}=this,n=(i==null?void 0:i.length)??-1,o=dG(r)?r.input.maxLength:NaN;return o!=null&&!isNaN(o)&&o>=-1&&(n===-1||o<=n)?o:n}get minLength(){if(this.dataType===_l.Date)return-1;const{field:i,element:r}=this,n=(i==null?void 0:i.length)??-1,o=dG(r)?r.input.minLength:NaN;return o!=null&&!isNaN(o)&&o>=-1&&(n===-1||o<=n)?o:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get range(){const{domain:e,element:i,field:r}=this;if(this.dataType==="date")return this._dateRange;const n=av(r,e)||Hve(r,e),o=(n==null?void 0:n.max)===Number.MAX_VALUE?null:(n==null?void 0:n.max)??null,u=(n==null?void 0:n.min)===-Number.MAX_VALUE?null:(n==null?void 0:n.min)??null;if(!(i!=null&&i.domain)||i.domain.type!=="range")return{max:o,min:u};const{max:p,min:g}=av(r)||{};return{max:p!=null&&(o===null||o!=null&&p<o)?p:o,min:g!=null&&(u===null||u!=null&&g>u)?g:u}}get required(){var u;const{editable:e,evaluatedRequiredExpression:i,field:r,visible:n,isSubtypeField:o}=this;return e?(r==null?void 0:r.nullable)===!1||o?!0:!(!n||((u=this.group)==null?void 0:u.visible)===!1||i==null)&&i:!1}set required(e){this._overrideIfSome("required",e)}get showNoValueOptionEnabled(){const{element:e}=this;return!this.required&&(!pG(e)||e.input.showNoValueOption)}get showNoValueLabel(){const{element:e}=this;return pG(e)?e.input.noValueOptionLabel:null}get submittable(){const{field:e,required:i,valid:r,value:n}=this;return(!i||n!=null)&&(!!r||this.initialFeature.getAttribute(e.name)===n)}get timeResolution(){var i;const e=(i=this.element)==null?void 0:i.input;if(e&&(e.type==="datetimeoffset-picker"||e.type==="time-picker"))return e.timeResolution??"minutes"}get timeStep(){return this.timeResolution!=null?tve.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:i,visibilityExpressionExecutor:r,preservesValueWhenHidden:n}=this;return i!=null&&i.updating||e!=null&&e.updating||n===!1&&r!=null&&r.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){var e,i,r,n;if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&((e=this.group)==null?void 0:e.visible)!==!1,this.preservesValueWhenHidden===!1&&this._fieldInputWasVisibleDuringLifetime&&(((i=this.visibilityExpressionExecutor)==null?void 0:i.lastEvaluatedValue)===!1||((n=(r=this.group)==null?void 0:r.visibilityExpressionExecutor)==null?void 0:n.lastEvaluatedValue)===!1))return this._storedValue!==null&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const o=this.evaluatedValueExpression;return this.dataType===_l.Date?this._arcadeOutputToDateFieldValue(o):o!=null&&typeof o=="object"?o.toString():o}return this._storedValue}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(e){const i=this.field.type;try{if(typeof e=="object"){if(e===null)throw new re("feature-form:invalid-date-value");if(ave(e))return ove(e,i);if("getTime"in e&&typeof e.getTime=="function"&&i==="date")return parseInt(e.getTime(),10);if(i==="date-only"||i==="time-only"||i==="timestamp-offset")return e.toString()}else{if(typeof e=="string")return i==="date"?parseInt(e,10):e;if(typeof e=="number"&&i==="date")return e}throw new re("feature-form:invalid-date-value")}catch{return i==="date"?NaN:""}}_isDomainCompatible(e){const{field:i}=this;if((e==null?void 0:e.type)==="coded-value"){const r=typeof e.codedValues[0].code;if(r==="string"&&mE(i)||r==="number"&&Mv(i))return!0}return!!((e==null?void 0:e.type)==="range"&&Mv(i)||P3(i)||db(i))}_validate(){const{dataType:e,domain:i,field:r,initialFeature:n,minLength:o,range:u,required:p,valid:g,value:w,maxLength:S}=this,T=p&&w==null,E=g!==void 0;if(!T&&n.getAttribute(r.name)===w&&E)return null;if(T)return yb.INVALID_TYPE;if(e==="text"&&typeof w=="string"){if(o>-1&&w.length<o)return Tb.TOO_SHORT;if(S>-1&&w.length>S)return Tb.TOO_LONG}return e!=="date"||w==null||lve({type:r.type,range:u,value:w})?i?w!==null||p?PC(r,w):null:$X(r,w):fb.OUT_OF_RANGE}};m([b()],ht.prototype,"_dateFormRange",null),m([b()],ht.prototype,"_dateRange",null),m([b()],ht.prototype,"_storedValue",void 0),m([b()],ht.prototype,"_configAllowsEdits",null),m([b()],ht.prototype,"_layerAndFieldAllowEdits",null),m([b()],ht.prototype,"_isVisibleByDefault",null),m([b()],ht.prototype,"_isEditTrackingField",null),m([b()],ht.prototype,"_shouldUseValueExpression",null),m([b()],ht.prototype,"isSubtypeField",null),m([b()],ht.prototype,"valueIsOutOfDomain",null),m([b()],ht.prototype,"dataType",null),m([b()],ht.prototype,"dateDataType",null),m([b()],ht.prototype,"description",null),m([b()],ht.prototype,"domain",null),m([b()],ht.prototype,"editable",null),m([b({readOnly:!0})],ht.prototype,"error",void 0),m([b({constructOnly:!0})],ht.prototype,"preservesValueWhenHidden",void 0),m([b()],ht.prototype,"evaluatedRequiredExpression",null),m([b()],ht.prototype,"evaluatedValueExpression",null),m([b()],ht.prototype,"field",void 0),m([b()],ht.prototype,"group",void 0),m([b({readOnly:!0})],ht.prototype,"hint",null),m([b()],ht.prototype,"includeDate",null),m([b()],ht.prototype,"includeTime",null),m([b()],ht.prototype,"includeTimeOffset",null),m([b()],ht.prototype,"initialFeature",null),m([b({readOnly:!0})],ht.prototype,"inputType",null),m([b()],ht.prototype,"hasInvalidSwitchValue",null),m([b()],ht.prototype,"isRelationshipKeyField",null),m([b()],ht.prototype,"label",null),m([b()],ht.prototype,"maxLength",null),m([b()],ht.prototype,"minLength",null),m([b({readOnly:!0})],ht.prototype,"name",null),m([b()],ht.prototype,"range",null),m([b()],ht.prototype,"required",null),m([b()],ht.prototype,"requiredExpressionExecutor",void 0),m([b()],ht.prototype,"showNoValueOptionEnabled",null),m([b()],ht.prototype,"submittable",null),m([b()],ht.prototype,"timeResolution",null),m([b()],ht.prototype,"timeStep",null),m([b({readOnly:!0})],ht.prototype,"type",void 0),m([b()],ht.prototype,"updating",null),m([b()],ht.prototype,"valid",null),m([b({value:null})],ht.prototype,"value",null),m([b()],ht.prototype,"valueExpressionExecutor",void 0),m([b()],ht.prototype,"visible",null),ht=m([G("esri.widgets.FeatureForm.FieldInput")],ht);const $G=t=>t&&!Number.isNaN(t.valueOf()),TG=ht;var YE;(function(t){t.TimeZoneNotRecognized="TimeZoneNotRecognized"})(YE||(YE={}));const OLe={[YE.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let PLe=class ose extends Error{constructor(e,i){super(Xu(OLe[e],i)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,ose)}};function $g(t,e,i){return t<e?t-e:t>i?t-i:0}function Tg(t,e,i){return t<e?e:t>i?i:t}let q2=class en{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,i=1,r=1,n=0,o=0,u=0,p=0,g){if(isNaN(e)||isNaN(i)||isNaN(r)||isNaN(n)||isNaN(o)||isNaN(u)||isNaN(p))return null;const w=De.local(e,i).daysInMonth;let S=De.fromObject({day:Tg(r,1,w),year:e,month:Tg(i,1,12),hour:Tg(n,0,23),minute:Tg(o,0,59),second:Tg(u,0,59),millisecond:Tg(p,0,999)},{zone:Qc(g)});return S=S.plus({months:$g(i,1,12),days:$g(r,1,w),hours:$g(n,0,23),minutes:$g(o,0,59),seconds:$g(u,0,59),milliseconds:$g(p,0,999)}),new en(S)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,i){const r=Qc(i);return e.isUnknownTimeZone||r===Nu.instance?en.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new en(e._date.setZone(r))}static dateJSToArcadeDate(e){return new en(De.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,i="system"){const r=Qc(i);return new en(De.fromJSDate(e,{zone:r}))}static unknownEpochToArcadeDate(e){return new en(De.fromMillis(e,{zone:Nu.instance}))}static unknownDateJSToArcadeDate(e){return new en(De.fromMillis(e.getTime(),{zone:Nu.instance}))}static epochToArcadeDate(e,i="system"){const r=Qc(i);return new en(De.fromMillis(e,{zone:r}))}static dateTimeToArcadeDate(e){return new en(e)}clone(){return new en(this._date)}changeTimeZone(e){const i=Qc(e);return en.dateTimeToArcadeDate(this._date.setZone(i))}static dateTimeAndZoneToArcadeDate(e,i){const r=Qc(i);return e.zone===Nu.instance||r===Nu.instance?en.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new en(e.setZone(r))}static nowToArcadeDate(e){const i=Qc(e);return new en(De.fromJSDate(new Date,{zone:i}))}static nowUTCToArcadeDate(){return new en(De.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===en.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===Nu.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new en(this._date.plus(e))}diff(e,i="milliseconds"){return this._date.diff(e._date,i)[i]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,i){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:i&&!this.isUnknownTimeZone})}toFormat(e,i){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,i)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new en(this._date.toUTC())}toLocal(){return new en(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const i=De.fromISO(e,{setZone:!0});return new en(i)}};function Qc(t,e=!0){if(t instanceof qm)return t;if(t.toLowerCase()==="system")return"system";if(t.toLowerCase()==="utc")return"UTC";if(t.toLowerCase()==="unknown")return Nu.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const r=an.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(r)return r}const i=ia.create(t);if(!i.isValid){if(e)throw new PLe(YE.TimeZoneNotRecognized);return null}return i}let RLe=class{constructor(e=[]){this._elements=e}length(){return this._elements.length}get(e){return this._elements[e]}toArray(){return this.slice()}slice(e=0,i=this.length()){const r=[];for(let n=e;n<i;n++)r.push(this.get(n));return r}};function EG(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const i=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const r of t.match(i)||[])switch(r){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=r;break;default:r.length>=2&&r.slice(0,1)==="["&&r.slice(-1)==="]"?e+=`'${r.slice(1,-1)}'`:e+=`'${r}'`}return e}let IG=class Sa{constructor(e,i,r){this._year=e,this._month=i,this._day=r,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof Sa&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Sa(this._year,this._month,this._day)}toDateTime(e){return De.fromObject({day:this.day,month:this.month,year:this.year},{zone:Qc(e)})}toDateTimeLuxon(e){return De.fromObject({day:this.day,month:this.month,year:this.year},{zone:Qc(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,i=!0){if(e===null||e==="")return this.toString();if(i&&(e=EG(e)),!e)return"";const r=this.toDateTime("unknown");return q2.dateTimeToArcadeDate(r).toFormat(e,{locale:Ss(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return q2.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,i){return Sa.fromDateTime(this.toUTCDateTime().plus({[e]:i}))}toUTCDateTime(){return De.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const i=De.fromMillis(e,{zone:an.utcInstance});return i.isValid?Sa.fromParts(i.year,i.month,i.day):null}static fromSeconds(e){const i=De.fromSeconds(e,{zone:an.utcInstance});return i.isValid?Sa.fromParts(i.year,i.month,i.day):null}static fromReader(e){if(!e)return null;const i=e.split("-");return i.length!==3?null:new Sa(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10))}static fromParts(e,i,r){const n=new Sa(e,i,r);return n.isValid===!1?null:n}static fromDateJS(e){return Sa.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Sa.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,i=null){if(e===""||e===null)return null;const r=[];if(i)(i=EG(i))&&r.push(i);else if(i===null||i===""){const n=De.fromISO(e,{setZone:!0});return n.isValid?Sa.fromParts(n.year,n.month,n.day):null}for(const n of r){const o=De.fromFormat(e,i??n);if(o.isValid)return new Sa(o.year,o.month,o.day)}return null}static fromNow(e="system"){const i=De.fromJSDate(new Date).setZone(Qc(e));return new Sa(i.year,i.month,i.day)}};function Ttt(t){if(t==null)return null;if(typeof t=="number")return t;let e=t.toLowerCase();switch(e=e.replaceAll(/\s/g,""),e=e.replaceAll("-",""),e){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function Ett(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new jt({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function Itt(t){if(t==null)return null;if(typeof t=="number")return t;let e=t.toLowerCase();switch(e=e.replaceAll(/\s/g,""),e=e.replaceAll("-",""),e){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function Mtt(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function h$(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function MG(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let i="";for(const r of t.match(e)||[])switch(r){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":i+=r;break;case"A":case"a":i+="a";break;default:i+=`'${r}'`}return i}let kG=class Pc{constructor(e,i,r,n){this._hour=e,this._minute=i,this._second=r,this._millisecond=n,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof Pc&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new Pc(this.hour,this.minute,this.second,this.millisecond)}isValid(){return h$(this.hour)&&h$(this.minute)&&h$(this.second)&&h$(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=MG(e))?De.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:Ss(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,i,r,n){const o=new Pc(e,i,r,n);return o.isValid()?o:null}static fromReader(e){if(!e)return null;const i=e.split(":");return i.length!==3?null:new Pc(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const i=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),o=Math.floor(e%1e3);return new Pc(n,r,i,o)}static fromDateJS(e){return new Pc(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new Pc(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,i=null){if(e===""||e===null)return null;const r=[];i?(i=MG(i))&&r.push(i):i!==null&&i!==""||(r.push("HH:mm:ss"),r.push("HH:mm:ss.SSS"),r.push("hh:mm:ss a"),r.push("hh:mm:ss.SSS a"),r.push("HH:mm"),r.push("hh:mm a"),r.push("H:mm"),r.push("h:mm a"),r.push("H:mm:ss"),r.push("h:mm:ss a"),r.push("H:mm:ss.SSS"),r.push("h:mm:ss.SSS a"));for(const n of r){const o=De.fromFormat(e,n);if(o.isValid)return new Pc(o.hour,o.minute,o.second,o.millisecond)}return null}plus(e,i){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return Pc.fromDateTime(this.toUTCDateTime().plus({[e]:i}))}return null}toUTCDateTime(){return De.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}},H2=null;function FLe(t,e,i,r={}){const n=e.elementType,o="value",u=n.type==="array"?[{name:o,type:n.type,elementType:n.elementType}]:n.type==="dictionary"?[{name:o,type:n.type,properties:n.properties}]:[{name:o,type:n.type}];return new RLe(t.map(p=>{const g={};return WR(g,u,{[o]:p},i,r),g[o]}))}function NLe(t,e,i={}){const r=t instanceof gb?new oR({source:t.features,geometryType:t.geometryType,fields:t.fields,spatialReference:t.spatialReference}):t;return e.constructFeatureSet(r,i.spatialReference,null,!0,i.lruCache,i.interceptor)}function DLe(t,e,i={}){const{spatialReference:r,interceptor:n,lruCache:o}=i;return typeof t=="string"?e.createFeatureSetCollectionFromService(t,r,o,n):e.createFeatureSetCollectionFromMap(t,r,o,n)}function jLe(t,e,i,r={}){const n={};return WR(n,e.properties,t,i,r),new H2.Dictionary(n)}function WR(t,e,i,r,n={}){const o={};for(const u of Object.keys(i))o[u.toLowerCase()]=i[u];for(const u of e){const p=u.name.toLowerCase();if(n.variablesPreProcessed)t[p]=o[p];else switch(u.type){case"array":{const g=o[p];t[p]=g==null?null:FLe(g,u,r,n);break}case"feature":{const g=o[p];t[p]=g==null?null:H2.Feature.createFromGraphic(g,n==null?void 0:n.timeZone);break}case"featureSet":{const g=o[p];t[p]=g==null?null:r?NLe(g,r,n):null;break}case"featureSetCollection":{const g=o[p];t[p]=g==null?null:r?DLe(g,r,n):null;break}case"dictionary":{const g=o[p];t[p]=g==null?null:jLe(g,u,r,n);break}case"date":{const g=o[p];t[p]=g?g instanceof q2?g:n!=null&&n.timeZone?q2.dateJSAndZoneToArcadeDate(g,n==null?void 0:n.timeZone):q2.dateJSToArcadeDate(g):null;break}case"dateOnly":{const g=o[p];t[p]=g?g instanceof IG?g:IG.fromReader(g):null;break}case"time":{const g=o[p];t[p]=g?g instanceof kG?g:kG.fromReader(g):null;break}case"knowledgeGraph":case"geometry":case"boolean":case"text":case"number":t[p]=o[p]}}}function ase(t,e){for(const i of t)e.push(i),i.type==="dictionary"&&ase(i.properties,e);return e}function CG(t,e,i,r,n){const{spatialReference:o,interceptor:u,lruCache:p,console:g,abortSignal:w,timeZone:S,services:T={portal:wr.getDefault()}}=i,E={vars:{},spatialReference:o,interceptor:u,timeZone:S,lrucache:p,useAsync:n,services:T,console:g,abortSignal:w};return e&&WR(E.vars,t.variables,e,r,i),E}function XE(t,e){switch(e.getArcadeType(t)){case"number":case"text":case"boolean":case"point":case"polygon":case"polyline":case"multipoint":case"extent":return t;case"date":return t.toJSDate();case"time":case"dateOnly":return t.toString();case"feature":{const i=(t.type,t),r="geometry"in i?i.geometry():null,n="readAttributes"in i?i.readAttributes():i.attributes;return new Cr({geometry:r,attributes:n})}case"dictionary":{const i=t,r=i.attributes,n={};for(const o of Object.keys(r))n[o]=XE(i.field(o),e);return n}case"array":return("toArray"in t?t.toArray():t).map(i=>XE(i,e))}return t}const AG={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$userInput",type:"geometry"},{name:"$graph",type:"knowledgeGraph"}]},LG={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},OG=new Map([["aggregate-field",{variables:[{name:"$feature",type:"feature"}]}],["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",AG],["popup-element",AG],["feature-reduction-popup",LG],["feature-reduction-popup-element",LG],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);function lse(t){const e=OG.get(t);if(!e){const i=Array.from(OG.keys()).map(r=>`'${r}'`).join(", ");throw new re("createArcadeProfile:invalid-profile-name",`Invalid profile name '${t}'. You must specify one of the following values: ${i}`)}return ae(e)}async function use(t,e,i={}){H2||(H2=await fh());const{arcade:r,arcadeUtils:n}=H2,{loadScriptDependencies:o,referencesMember:u,scriptIsAsync:p}=r,g=ase(e.variables,[]),w=g.filter(H=>H.type==="featureSet"||H.type==="featureSetCollection").map(H=>H.name.toLowerCase()),S=r.parseScript(t,w);if(!S)throw new re("arcade:invalid-script","Unable to create SyntaxTree");const T=n.extractFieldNames(S),E=r.scriptTouchesGeometry(S),C=g.map(H=>H.name.toLowerCase()).filter(H=>u(S,H)),L=p(S,w);await o(S,L,w);const R={vars:{},spatialReference:null,useAsync:L};for(const H of C)R.vars[H]="any";const{lruCache:F}=i,V=r.compileScript(S,R),U=r.featureSetUtils(),{services:W}=i;return{execute:(H,J={})=>{if(L)throw new re("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");const X=V(CG(e,H,{lruCache:F,...J},U,L));return J.rawOutput?X:XE(X,n)},executeAsync:async(H,J={})=>{const X=await V(CG(e,H,{lruCache:F,services:W,...J},U,L));return J.rawOutput?X:XE(X,n)},isAsync:L,variablesUsed:C,fieldsUsed:T,geometryUsed:E,syntaxTree:S}}const ktt=Object.freeze(Object.defineProperty({__proto__:null,createArcadeExecutor:use,createArcadeProfile:lse},Symbol.toStringTag,{value:"Module"}));var cse;const VLe=Symbol("FormExpressionArcadeExecutor");let co=class extends Te{constructor(e){super(e),this[cse]=!0,this._lastEvaluatedValue=null,this._abortController=new AbortController,this._stale=!1,this._updatingTracking=new Ua,this._executeAsyncDebounced=Da(async(i,r,n)=>{const o=await this.executor.executeAsync(i,{...r,abortSignal:n});return n.aborted?this._lastEvaluatedValue:(this._lastEvaluatedValue=o,this._stale=!1,o)})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(e,i){this._abortController=new AbortController;const r=this.executor.execute(e,{...i,abortSignal:this._abortController.signal});return this._lastEvaluatedValue=r,r}async executeAsync(e,i){return this._abortController=new AbortController,this._updatingTracking.addPromise(this._executeAsyncDebounced(e,i??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort(),this._lastEvaluatedValue=null,this._stale=!1}};cse=VLe,m([b()],co.prototype,"_lastEvaluatedValue",void 0),m([b()],co.prototype,"_stale",void 0),m([b()],co.prototype,"_updatingTracking",void 0),m([b({constructOnly:!0})],co.prototype,"executor",void 0),m([b()],co.prototype,"isAsync",null),m([b()],co.prototype,"fieldsUsed",null),m([b()],co.prototype,"syntaxTree",null),m([b()],co.prototype,"updating",null),m([b()],co.prototype,"stale",null),m([b()],co.prototype,"geometryUsed",null),m([b()],co.prototype,"variablesUsed",null),m([b()],co.prototype,"lastEvaluatedValue",null),co=m([G("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],co);const zLe=async(t,e)=>{const i=lse("form-calculation"),r=await use(t,i,{});return e!=null&&e.fieldsIndex&&(r.fieldsUsed=Hm(e.fieldsIndex,r.fieldsUsed)),new co({executor:r})},Dk="#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY";let Rc=class extends Te{constructor(e){super(e),this._fieldReferencesLookup=new Map,this._fieldsAffectedLookup=new Map,this.preserveFieldValuesWhenHidden=!0,this._latestFieldValues={...e.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}destroy(){this.resetExecutors()}get _asyncExecutors(){return this.executors.filter(e=>e.isAsync)}get _baseContext(){const{editType:e,layer:i,map:r,originalFeature:n,spatialReference:o,timeZone:u}=this.arcadeContextInfo,p=(i==null?void 0:i.type)==="scene"&&i.associatedLayer!=null?i.associatedLayer:i;return[{$originalfeature:n,$editcontext:{editType:e},$layer:p,$featureset:p,$datastore:i==null?void 0:i.url,$map:r},{rawOutput:!0,spatialReference:o??void 0,timeZone:u}]}set feature(e){this._latestFieldValues={...e==null?void 0:e.attributes},this._set("feature",e)}evaluateAll(){return this._evaluate(this.executors)}evaluateAsyncExpressions(){return this._evaluate(this._asyncExecutors)}evaluateExpressions(e){return this._evaluate(e)}evaluateInvalidated(e){const{_fieldReferencesLookup:i,_latestFieldValues:r,feature:n}=this,o=new Set;for(const u of e)if(r[u]=n.getAttribute(u),i.has(u))for(const p of i.get(u))o.add(p);return this._evaluate([...o])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has(Dk))return this._evaluate([...this._fieldReferencesLookup.get(Dk)])}resetExecutors(){for(const e of this.executors)e.reset()}_buildDependencyGraph(){var g;const{_fieldReferencesLookup:e,_fieldsAffectedLookup:i,executors:r,preserveFieldValuesWhenHidden:n}=this,o=new Map(this.fieldInputs.map(w=>[w.name,w])),u=n===!1,p=new Map(r.map(w=>[w,new Array]));for(const w of r){for(const S of w.fieldsUsed){Bf(e,S,()=>new Set).add(w);const T=o.get(S);[T==null?void 0:T.valueExpressionExecutor,T==null?void 0:T.editableExpressionExecutor,u?(g=T==null?void 0:T.group)==null?void 0:g.visibilityExpressionExecutor:null,u?T==null?void 0:T.visibilityExpressionExecutor:null].filter(E=>E!=null&&E!==w).forEach(E=>{p.get(E).push(w),Bf(i,E,()=>new Set).add(T)})}w.geometryUsed&&Bf(e,Dk,()=>new Set).add(w)}return p}async _evaluate(e){const i=new Map,{_dependencyGraph:r,_fieldsAffectedLookup:n,_latestFieldValues:o}=this;for(const p of e)hse(p,i,r);for(const[p,{resolver:g,dependencyPromises:w}]of i)Promise.all(w).then(async()=>{const[S,T]=this._makeContext(o);return p.executeAsync(S,T)}).then(()=>{if(n.has(p))for(const S of n.get(p))this._latestFieldValues[S.name]=S.value;g.resolve()},S=>{!S||Cn(S)||PG(S)||p.markStale(),g.reject(S)});const u=(await Promise.allSettled(Array.from(i.values(),({resolver:p})=>p.promise))).filter(p=>p.status==="rejected"&&!(Cn(p.reason)||PG(p.reason)));if(u.length>0){const p=new AggregateError(u,`One or more expression executions failed. First error message: ${u[0].reason}`);throw fe.getLogger(this).error(p),p}}_makeContext(e){const[i,r]=this._baseContext,n=this.feature.clone();return n.attributes=e,[{...i,$feature:n},r]}get test(){}};m([b()],Rc.prototype,"_asyncExecutors",null),m([b()],Rc.prototype,"_baseContext",null),m([b()],Rc.prototype,"feature",null),m([b({constructOnly:!0})],Rc.prototype,"preserveFieldValuesWhenHidden",void 0),m([b()],Rc.prototype,"executors",void 0),m([b()],Rc.prototype,"fieldInputs",void 0),m([b()],Rc.prototype,"arcadeContextInfo",void 0),Rc=m([G("esri.widgets.FeatureForm.FormExpressionsManager")],Rc);const hse=(t,e,i)=>{if(e.has(t))return;const r=os();e.set(t,{resolver:r,dependencyPromises:[]}),t.abort();const n=i.get(t);for(const o of n)hse(o,e,i),e.get(o).dependencyPromises.push(r.promise)},PG=t=>t&&typeof t=="object"&&"message"in t&&t.message==="Cancelled";let Fc=class extends HR{constructor(e){super(e),this._expressionTrackingHandles=new Map,this.id=Fp().toString(),this.type="group"}initialize(){this.addHandles([ce(()=>[this.visible,this.inputs],([e])=>{const{inputs:i}=this,r=!!e&&void 0;for(const n of i)Uv(n)&&(n.required=r)},{initial:!0,equals:(e,i)=>i[0]===e[0]&&i[1]===e[1]})])}destroy(){for(const e of this._expressionTrackingHandles.values())e.remove()}get initialState(){return this.element.initialState||"expanded"}get inputs(){return this._get("inputs")}set inputs(e){this.removeAllHandles(),e&&this.addHandles(e.map(i=>ce(()=>i.visible,()=>this._dirtyEvaluatedVisibilityExpression()))),this._set("inputs",e)}get label(){return this.element.label}set label(e){const{element:i}=this;i&&(i.label=e)}get open(){return this.initialState==="expanded"}set open(e){this._override("open",e)}get state(){return wo(fe.getLogger(this),"state",{replacement:"open",version:"4.28",warnOnce:!0}),this.open?"expanded":"collapsed"}set state(e){wo(fe.getLogger(this),"state",{replacement:"open",version:"4.28",warnOnce:!0}),this.open=e==="expanded"}get visible(){return this.evaluatedVisibilityExpression!==!1&&this.inputs&&this.inputs.some(e=>e.visible)}_dirtyEvaluatedVisibilityExpression(){const{element:e}=this;e.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};m([b()],Fc.prototype,"id",void 0),m([b()],Fc.prototype,"initialState",null),m([b()],Fc.prototype,"inputs",null),m([b()],Fc.prototype,"label",null),m([b()],Fc.prototype,"open",null),m([b()],Fc.prototype,"type",void 0),m([b()],Fc.prototype,"visible",null),Fc=m([G("esri.widgets.FeatureForm.GroupInput")],Fc);const ULe=Fc,jk=100;let _i=class extends Gt(nc(Te)){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:i}=this;i&&i.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:i}=this;i&&i.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:i}=this;i&&i.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const i=new AbortController;this._queryAbortController=i,await Wu(this._query()),this._queryAbortController===i&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const i=new AbortController;this._queryFeatureCountAbortController=i,await Wu(this._queryFeatureCount()),this._queryFeatureCountAbortController===i&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryPageController=async()=>{const i=new AbortController;this._queryPageAbortController=i,await Wu(this._queryPage()),this._queryPageAbortController===i&&(this._queryPageAbortController=null)},this._queryDebounced=Da(this._queryController,jk),this._queryFeatureCountDebounced=Da(this._queryFeatureCountController,jk),this._queryPageDebounced=Da(this._queryPageController,jk),this._query=async()=>{const{_queryAbortController:i,relatedFeatures:r}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.destroyAll(),this.destroyed||r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:i==null?void 0:i.signal}))))},this.addHandles([ce(()=>{var i;return[this.displayCount,this.graphic,this.layer,(i=this.layer)==null?void 0:i.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount]},()=>this._queryDebounced(),Qe),ce(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),ce(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.destroyAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:i,featureCount:r}=this,n=1,o=Math.ceil(r/i)||1;this._set("featurePage",Math.min(Math.max(e,n),o))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:i}=this;return e&&(i!=null&&i.loaded)?e.map(r=>{const n=r.clone();return n.field=zR(r.field,i),n}):e??[]}get supportsCacheHint(){var e,i,r;return!!((r=(i=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:i.queryRelated)!=null&&r.supportsCacheHint)}get canLoad(){return!!this.map&&this.relationshipId!=null&&typeof this.objectId=="number"}get canQuery(){var i,r;const e=(r=(i=this.layer)==null?void 0:i.capabilities)==null?void 0:r.queryRelated;return!!(this.relatedLayer&&this.relationship&&this.relationshipId!=null&&this.objectId!=null&&(e!=null&&e.supportsCount)&&(e!=null&&e.supportsPagination))}get itemDescriptionFieldName(){var e;return((e=this.orderByFieldsFixedCasing[0])==null?void 0:e.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,i;return(this.objectIdField&&((i=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:i[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new Ie}get relatedLayer(){const{layer:e,map:i,relationship:r}=this;return e!=null&&e.loaded&&i&&r?XAe(i,e,r)??null:null}get relationship(){var r;const{relationshipId:e,layer:i}=this;return e!=null?((r=i==null?void 0:i.relationships)==null?void 0:r.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new Ie}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:i,_queryPageAbortController:r,canQuery:n,_loaded:o,canLoad:u}=this;return i||u&&!o?"loading":e||r?"querying":n?"ready":"disabled"}getRelatedFeatureByObjectId(e){return this.relatedFeatures.find(i=>i.getObjectId()===e)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.destroyAll()}async _queryFeatureCount(){const{layer:e,relatedLayer:i,relationshipId:r,objectId:n,_queryFeatureCountAbortController:o,canQuery:u,supportsCacheHint:p}=this;if(await(e==null?void 0:e.load()),await(i==null?void 0:i.load()),!u||!e||!i||n==null)return void this._set("featureCount",0);const g=i.createQuery(),{historicMoment:w,gdbVersion:S}=e,T=new E3({cacheHint:p,gdbVersion:S,historicMoment:w,relationshipId:r,returnGeometry:!1,objectIds:[n],where:g.where??void 0}),E=await e.queryRelatedFeaturesCount(T,{signal:o==null?void 0:o.signal});this._set("featureCount",E[n]||0)}_sliceFeatures(e){const{showAllEnabled:i,displayCount:r}=this;return i?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:i,showAllEnabled:r,_queryPageAbortController:n,featureCount:o}=this;!r||i<2||!o||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var pe;const{orderByFieldsFixedCasing:i,showAllEnabled:r,featuresPerPage:n,displayCount:o,layer:u,relationshipId:p,featurePage:g,featureCount:w,relatedLayer:S,supportsCacheHint:T}=this,{canQuery:E,objectId:C}=this;if(!E||!u||!S||C==null)return[];const L=r?((g-1)*n+w)%w:0,R=r?n:o,F=S.objectIdField,V=[...i.map(de=>de.field),...gLe(S),F].filter(Rt),U=i.map(de=>`${de.field} ${de.order}`),W=S.createQuery(),{historicMoment:H,gdbVersion:J}=u,X=new E3({orderByFields:U,start:L,num:R,outFields:V,cacheHint:T,historicMoment:H,gdbVersion:J,relationshipId:p,returnGeometry:!1,objectIds:[C],where:W.where??void 0}),te=await u.queryRelatedFeatures(X,{signal:e==null?void 0:e.signal}),oe=((pe=te[C])==null?void 0:pe.features)||[];return oe.forEach(de=>{de.sourceLayer=S,de.layer=S}),oe}};m([b()],_i.prototype,"_loaded",void 0),m([b()],_i.prototype,"_queryAbortController",void 0),m([b()],_i.prototype,"_queryPageAbortController",void 0),m([b()],_i.prototype,"_queryFeatureCountAbortController",void 0),m([b({value:1})],_i.prototype,"featurePage",null),m([b()],_i.prototype,"featuresPerPage",void 0),m([b({readOnly:!0})],_i.prototype,"orderByFieldsFixedCasing",null),m([b({readOnly:!0})],_i.prototype,"supportsCacheHint",null),m([b({readOnly:!0})],_i.prototype,"canLoad",null),m([b({readOnly:!0})],_i.prototype,"canQuery",null),m([b()],_i.prototype,"description",void 0),m([b({readOnly:!0})],_i.prototype,"itemDescriptionFieldName",null),m([b({value:3})],_i.prototype,"displayCount",null),m([b({type:Cr})],_i.prototype,"graphic",void 0),m([b()],_i.prototype,"layer",void 0),m([b()],_i.prototype,"map",void 0),m([b({readOnly:!0})],_i.prototype,"objectId",null),m([b({readOnly:!0})],_i.prototype,"objectIdField",null),m([b()],_i.prototype,"orderByFields",void 0),m([b({readOnly:!0})],_i.prototype,"relatedFeatures",null),m([b({readOnly:!0})],_i.prototype,"relatedLayer",null),m([b({readOnly:!0})],_i.prototype,"relationship",null),m([b()],_i.prototype,"featureCount",void 0),m([b({readOnly:!0})],_i.prototype,"relatedFeatureViewModels",null),m([b()],_i.prototype,"relationshipId",void 0),m([b()],_i.prototype,"showAllEnabled",void 0),m([b()],_i.prototype,"state",null),m([b()],_i.prototype,"title",void 0),_i=m([G("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],_i);const GLe=_i,BLe=3;let ar=class extends sse{constructor(e){super(e),this._relationshipVM=null,this.group=null,this.type="relationship",this.addHandles([ce(()=>({feature:this.feature,element:this.element,layer:this.layer}),i=>this._createRelationshipVM(i),Qe),gi(()=>this.relatedLayer,"edits",()=>{var i;return(i=this._relationshipVM)==null?void 0:i.refresh()})])}destroy(){var e;(e=this._relationshipVM)==null||e.destroy()}get canAddRelatedFeature(){const{editable:e,featureCount:i,relationship:r}=this;if(!r||!this.loaded||!this.relatedLayerAllowsAdds)return!1;const{cardinality:n,role:o}=r;return!(n==="one-to-one"&&i>0)&&n!=="many-to-many"&&!(n==="one-to-many"&&o==="destination"&&i>0)&&e}get displayCount(){return this.element.displayCount??BLe}get displayType(){return this.element.displayType}get editable(){return!!this.relatedLayerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get featureCount(){var e;return((e=this._relationshipVM)==null?void 0:e.featureCount)??0}get loaded(){var e;return((e=this._relationshipVM)==null?void 0:e.state)!=="loading"}get map(){return this._get("map")}set map(e){var i;e&&((i=this._relationshipVM)==null||i.set("map",e)),this._set("map",e)}get orderByFields(){return this.element.orderByFields}get originHasValidKey(){return!(!this.relationship||!this.feature.getAttribute(this.relationship.keyField))}get relationship(){var e;return(e=this._relationshipVM)==null?void 0:e.relationship}get relationshipId(){return this.element.relationshipId}get relatedFeatureInfos(){var p;const{_relationshipVM:e,timeZone:i}=this;if(!((p=e==null?void 0:e.relatedFeatures)!=null&&p.length)||!(e!=null&&e.relatedLayer))return[];const{itemDescriptionFieldName:r,relatedFeatures:n,relatedLayer:o}=e,u=o&&"formTemplate"in o&&o.formTemplate?o.formTemplate.title:void 0;return n.map(g=>{let w;if(r){const S=g.getAttribute(r),T=o.fieldsIndex.get(r);if(T){const E=nse({values:[S],fields:[T],timeZone:i??void 0})[r];E!=null&&(w=E.toString())}}return{feature:g,description:w,title:u?R3({label:u,attributes:g.attributes,fieldsIndex:o.fieldsIndex,timeZone:i}):void 0}}).toArray()}get relatedLayer(){var e;return(e=this._relationshipVM)==null?void 0:e.relatedLayer}get relatedLayerIsTable(){var e;return!!((e=this.relatedLayer)!=null&&e.isTable)}get relatedLayerAllowsAdds(){var r;const{relatedLayer:e}=this;if(!e||!this.relatedLayerAllowsEdits)return!1;const i=Cm(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsAdd)}get relatedLayerAllowsEdits(){var r;const{relatedLayer:e}=this;if(!e)return!1;const i=Cm(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsEditing)}get showAllEnabled(){return this._get("showAllEnabled")}set showAllEnabled(e){var i;(i=this._relationshipVM)==null||i.set("showAllEnabled",e),this._set("showAllEnabled",e)}get showAllActionVisible(){return!this.showAllEnabled&&this.featureCount>0&&this.featureCount>this.displayCount}get visible(){const{relationship:e}=this;if(!e)return!1;const{cardinality:i}=e;return i!=="many-to-many"&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null)}get updating(){var e,i;return((e=this._relationshipVM)==null?void 0:e.state)==="loading"||((i=this._relationshipVM)==null?void 0:i.state)==="querying"}incrementPage(){this._relationshipVM&&this._relationshipVM.featurePage++}getRelatedFeatureByObjectId(e){var i;return(i=this._relationshipVM)==null?void 0:i.getRelatedFeatureByObjectId(e)}_createRelationshipVM(e){var S;const{feature:i,element:r,layer:n}=e;if((S=this._relationshipVM)==null||S.destroy(),!i||!r||!n)return;const{displayCount:o,map:u,orderByFields:p,relationshipId:g,showAllEnabled:w}=this;CS(n)&&(this._relationshipVM=new GLe({graphic:i,displayCount:o,layer:n,map:u,orderByFields:p,relationshipId:g,showAllEnabled:w}))}};m([b()],ar.prototype,"_relationshipVM",void 0),m([b()],ar.prototype,"canAddRelatedFeature",null),m([b()],ar.prototype,"displayCount",null),m([b()],ar.prototype,"displayType",null),m([b()],ar.prototype,"editable",null),m([b()],ar.prototype,"featureCount",null),m([b()],ar.prototype,"group",void 0),m([b()],ar.prototype,"loaded",null),m([b()],ar.prototype,"map",null),m([b()],ar.prototype,"orderByFields",null),m([b()],ar.prototype,"originHasValidKey",null),m([b()],ar.prototype,"relationship",null),m([b()],ar.prototype,"relationshipId",null),m([b()],ar.prototype,"relatedFeatureInfos",null),m([b()],ar.prototype,"relatedLayer",null),m([b()],ar.prototype,"relatedLayerIsTable",null),m([b()],ar.prototype,"relatedLayerAllowsAdds",null),m([b()],ar.prototype,"relatedLayerAllowsEdits",null),m([b()],ar.prototype,"showAllEnabled",null),m([b()],ar.prototype,"showAllActionVisible",null),m([b({readOnly:!0})],ar.prototype,"type",void 0),m([b()],ar.prototype,"visible",null),m([b()],ar.prototype,"updating",null),ar=m([G("esri.widgets.FeatureForm.RelationshipInput")],ar);const qLe=ar;let RG=class{constructor(e){this._observable=new Gb,this._set=new Set(e)}get size(){return He(this._observable),this._set.size}add(e){const i=this._set.size;return this._set.add(e),this._set.size!==i&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const i=this._set.delete(e);return i&&this._observable.notify(),i}entries(){return He(this._observable),this._set.entries()}forEach(e,i){He(this._observable),this._set.forEach((r,n)=>e.call(i,r,n,this),i)}has(e){return He(this._observable),this._set.has(e)}keys(){return He(this._observable),this._set.keys()}values(){return He(this._observable),this._set.values()}[Symbol.iterator](){return He(this._observable),this._set[Symbol.iterator]()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}},TO;const HLe=["blockquote","html","hr","checkbox","table","tablerow","tablecell","image"];async function WLe(t){return TO||await JLe(),TO.parse(t)}async function JLe(){const{Marked:t}=await ie(()=>import("./marked.esm-DUoivBPJ.js"),[]),e=o=>`<span style="text-decoration:line-through;">${o}</span>`,i=(o,u,p)=>`<a${o!=null?` href="${o}"`:""}${u!=null?` title="${u}"`:""} target="_blank">${p??""}</a>`,r=()=>"",n={};for(const o of HLe)n[o]=r;TO=new t({renderer:{del:e,link:i,...n}})}let xa=class extends HR{constructor(e){super(e),this.group=null,this.id=`TextElementInput-${Fp()}`,this.type="text",this._expressionReferences=new fm,this._expressionsUsed=new RG,this._fieldsUsed=new RG,this._literalParts=new Ie,this._templateParts=new Ie,this._updatingHandles=new Ua}initialize(){const{rawText:e}=this;e?this.textFormat==="markdown"?this._updatingHandles.addPromise(WLe(e).then(i=>this._initializeTextParts(i))):this._initializeTextParts(e):this._literalParts.push("")}get expressionsUsed(){return Array.from(this._expressionsUsed)}get fieldsIndex(){return this.layer.fieldsIndex}set fieldsIndex(e){this._overrideIfSome("fieldsIndex",e)}get fieldsUsed(){return Array.from(this._fieldsUsed)}get rawText(){return this.element.text}get text(){const e=this._templateParts.map(i=>{var r;return`${((r=this._expressionReferences.get(i))==null?void 0:r.lastEvaluatedValue)??""}`});return mR.sanitize(KLe(this._literalParts,e))}get textFormat(){return this.element.textFormat}get updating(){return this._updatingHandles.updating||Array.from(this._expressionReferences.values()).some(e=>e==null?void 0:e.updating)}setExpressionExecutor(e,i){this._expressionReferences.set(fG(e),i)}setFieldExecutor(e,i){this._expressionReferences.set(yG(e),i)}_initializeTextParts(e){const{fieldsIndex:i}=this,{literals:r,templates:n}=ZLe(e),o=[],u=[];for(let p=0;p<n.length;p++){const g=r[p],w=i8(n[p])[0];if(cLe(w))this._expressionsUsed.add(uLe(w)),this._expressionReferences.set(w,null),o.push(g),u.push(w);else if(hLe(w)){this._expressionsUsed.add(w);const S=fG(w);this._expressionReferences.set(S,null),o.push(g),u.push(S)}else if(i!=null&&i.has(w)){const S=i.normalizeFieldName(w);this._fieldsUsed.add(S);const T=yG(S);this._expressionReferences.set(T,null),o.push(g),u.push(T)}else r[p+1]=g.concat(w,r[p+1])}o.push(r.at(-1)),this._literalParts.addMany(o),this._templateParts.addMany(u)}};function ZLe(t){const e=/{[^{]+?}/g,i=[...t.matchAll(e)];let r=0;const n=[],o=[];for(const u of i){const p=u[0];n.push(t.slice(r,u.index)),o.push(p),r=u.index+p.length}return n.push(t.slice(r)),{literals:n,templates:o}}function KLe(t,e){return e.reduce((i,r,n)=>i.concat(t.at(n),r),"").concat(t.at(-1))}m([b()],xa.prototype,"expressionsUsed",null),m([b()],xa.prototype,"fieldsIndex",null),m([b()],xa.prototype,"fieldsUsed",null),m([b()],xa.prototype,"group",void 0),m([b()],xa.prototype,"id",void 0),m([b()],xa.prototype,"rawText",null),m([b()],xa.prototype,"text",null),m([b()],xa.prototype,"textFormat",null),m([b()],xa.prototype,"type",void 0),m([b()],xa.prototype,"updating",null),xa=m([G("esri.widgets.FeatureForm.TextElementInput")],xa);const Vk=new Cr({attributes:{}}),YLe={field:["editableExpression","requiredExpression","valueExpression","visibilityExpression"],group:["visibilityExpression"],relationship:["editableExpression","visibilityExpression"],text:["visibilityExpression"]},XLe="#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",Eg="#JSAPI_CONTINGENT_VALUE_ANY_HASH",QLe="#JSAPI_CONTINGENT_VALUE_NULL_HASH",pse="esri.widgets.FeatureForm.FeatureFormViewModel",dse=()=>fe.getLogger(pse);let Ut=class extends Bb(Ar.EventedAccessor){constructor(e){super(e),this._expressionExecutorsInUse=new Set,this._expressionExecutorLookup=new Map,this._expressionsManager=null,this._contingentValuesCache=null,this._featureClone=Vk.clone(),this._initialFeature=Vk.clone(),this._timeZone=null,this._updatingHandles=new Ua,this.arcadeEditType="NA",this.contingencyConstraintViolations=new Map,this.disabled=!1,this.highlightHelper=null,this.inputs=[],this.map=null,this.relatedRecordCallbacks=null,this.strict=!1,this.hasPendingSubtypeChoice=!1}initialize(){const e=ce(()=>{var n;return[this.layer,!!((n=this.layer)!=null&&n.loaded),this.formTemplate,this.feature,this.timeZone,this.arcadeEditType]},async([n,o])=>{n!=null&&(o?this._updatingHandles.addPromise(this._updateInputs()):n.load().catch(()=>{}))},{equals:([n,o,u,p,g,w],[S,T,E,C,L,R])=>n===S&&o===T&&u===E&&p===C&&g===L&&w===R,initial:!0}),i=ce(()=>this._arcadeContextInfo,n=>{this._expressionsManager!=null&&(this._expressionsManager.arcadeContextInfo=n,this._updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())))}),r=ce(()=>this.layer,n=>{const o=(n==null?void 0:n.type)==="subtype-sublayer"?n.parent:(n==null?void 0:n.type)==="feature"?n:null;o&&this.addResolvingPromise(LLe.createLoadedLayerContingentValuesCache(o).then(u=>{this._contingentValuesCache=u,this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.addHandles([e,i,r])}destroy(){var e;this.feature=null,this.layer=null,this._contingentValuesCache=ot(this._contingentValuesCache),(e=this.highlightHelper)==null||e.removeAll(),this._updatingHandles.destroy()}get _expressionInfosLookup(){var e,i;return new Map((i=(e=this.formTemplate)==null?void 0:e.expressionInfos)==null?void 0:i.map(r=>[r.name,r]))}get activeRelationshipInput(){return this.allRelationshipInputs.find(e=>e.relationshipId===this.relationshipId)}get _arcadeContextInfo(){const{_initialFeature:e,arcadeEditType:i,layer:r,map:n,spatialReference:o,timeZone:u}=this;return{layer:h3(r)?r:null,originalFeature:e,editType:i,map:n,spatialReference:o,timeZone:u}}get allFieldInputs(){return nLe(this.inputs)}get allGroupInputs(){return this.inputs.filter(Vf)}get allRelationshipInputs(){return sLe(this.inputs)}get _layerFieldsByName(){var e;return new Map((e=this.layer)==null?void 0:e.fields.map(i=>[i.name,i]))}get feature(){return this._get("feature")}set feature(e){const i=this._get("feature");this._featureClone=e?e.clone():Vk.clone(),this._initialFeature=this._featureClone.clone(),this._expressionsManager&&(this._expressionsManager.feature=this._featureClone),e?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(r=>r.feature=e)):(this.inputs.forEach(r=>r.destroy()),this.inputs.length=0),i!==e&&(this.hasPendingSubtypeChoice=!1),this.contingencyConstraintViolations.clear(),this._set("feature",e)}get fieldsWithContingentValues(){if(this._contingentValuesCache==null)return new Set;const e=this._contingentValuesCache.fieldGroups.flatMap(i=>i.fields);return new Set(e)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(e){e===void 0?this._clearOverride("formTemplate"):this._override("formTemplate",e)}get formDescription(){const{formTemplate:e,layer:i}=this;return e!=null&&e.description&&i?R3({label:e.description,attributes:this.getValues(),fieldsIndex:i.fieldsIndex,timeZone:this.timeZone}):null}get formTitle(){const{formTemplate:e,layer:i}=this;return e!=null&&e.title&&i?R3({label:e.title,attributes:this.getValues(),fieldsIndex:i.fieldsIndex,timeZone:this.timeZone}):null}get formHeaderVisible(){const{activeRelationshipInput:e,formDescription:i,formTitle:r}=this;return!(e||!i&&!r)}get joinedContingentValues(){return this._joinContingentValues()}get layer(){var e;return(e=this.feature)!=null&&e.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(e){this._override("layer",e)}get relationshipId(){return this._get("relationshipId")}set relationshipId(e){const i=this.allRelationshipInputs;if(e!=null&&e===this.relationshipId||i.forEach(r=>r.showAllEnabled=!1),e!=null){const r=i.find(n=>n.relationshipId===e);r&&(r.showAllEnabled=!0)}this._set("relationshipId",e)}get spatialReference(){var e;return((e=this.layer)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){var e;return(e=this.layer)!=null&&e.loaded?"ready":"disabled"}get submittable(){return!!this.valid||this.allFieldInputs.filter(e=>!e.valid).every(({submittable:e})=>e)}get timeZone(){const{layer:e}=this;if(e&&"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone)return ra;const i=e&&"preferredTimeZone"in e&&e.preferredTimeZone;return this._timeZone===Kp?i||ra:this._timeZone||$o}set timeZone(e){this._timeZone=e}get updating(){return this._updatingHandles.updating}get valid(){const e=this.allFieldInputs;return e.length>0&&e.every(({valid:i})=>i)}findField(e){return this.allFieldInputs.find(i=>i.name===e)}getFieldValueOptionsForField(e,i){var p;const r=this.findField(e);if(!r)return[[],[],[]];const n=((p=r.domain)==null?void 0:p.type)==="coded-value"?r.domain.codedValues.map(({name:g,code:w})=>({name:g,value:w})):[],o=r.value==null||n.some(g=>g.value===r.value)?[]:[{name:`${r.value}`,value:r.value}],u=this.fieldsWithContingentValues.has(e)?this._getContingentValueOptionsForField(e,i):[];if(u.length>0){const g=new Set(u.map(w=>w.value));return[u,n.filter(w=>!g.has(w.value)),o]}return[n,[],o]}getValue(e){var r;const i=(r=this.layer)==null?void 0:r.getField(e);if(i!=null)return this._featureClone.getAttribute(i.name)??null}setValue(e,i){const{_featureClone:r,strict:n}=this,o=this.findField(e);i=i===""?null:i,o&&r.getAttribute(e)!==i&&(o.value=i,n&&!o.valid||(this._afterValueChange(o),this._expressionsManager!=null&&this._updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([o.name]).finally(()=>this._afterExpressionsEvaluated()))))}getValues(){return{...this._featureClone.attributes}}overrideInitialFeature(e){this._initialFeature=e}submit(){const e=this.allFieldInputs,i=new Set(e.filter(o=>o.valid).map(({name:o})=>o)),r=e.filter(o=>!o.valid).map(({name:o})=>o),n=this.getValues();if(this.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length>0)for(const[o,u]of this.contingencyConstraintViolations.entries())u.type==="error"&&(i.delete(o),r.push(o));this.emit("submit",{valid:[...i],invalid:r,values:n})}validateContingencyConstraints(e,i){const{_contingentValuesCache:r}=this,n=new Map;if(this.contingencyConstraintViolations=n,r==null)return[];const{invalid:o,incomplete:u}=r.validateContingencyConstraints(e),p=[...o,...i!=null&&i.includeIncompleteViolations?u:[]];for(const g of p)for(const w of g.fieldGroup.fields)n.set(w,g);return p}notifyFeatureGeometryChanged(){const{_expressionsManager:e,feature:i,_featureClone:r}=this;r.geometry=i.geometry,e!=null&&this._updatingHandles.addPromise(e.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))}applySubtypeDefaults(e){const{defaultValues:i}=e,{allFieldInputs:r}=this;for(const{name:n}of r){const o=i[n];o!=null&&this.setValue(n,o)}}_emitChangeEvent({name:e,valid:i,value:r}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:e,value:r,valid:i})}async _updateInputs(){this._stopExpressions();const{_featureClone:e,_initialFeature:i,arcadeEditType:r,formTemplate:n,inputs:o,layer:u,timeZone:p}=this;if(!u)return;const g={arcadeEditType:r,feature:e,initialFeature:i,layer:u,timeZone:p},w=o.slice(),S=n!=null&&n.elements&&n.elements.length>0?await this._updateInputsUsingFormElements(w,n.elements,g):this._updateInputsUsingLayerFields(w,u==null?void 0:u.fields,g);this.inputs=S,await this._startExpressions()}async _updateInputsUsingFormElements(e,i,r){const n=new Map;for(const p of e)if(Vf(p)){n.set(p.element,p);for(const g of p.inputs)g.element&&n.set(g.element,g)}else p.element&&n.set(p.element,p);const o=new Map,u=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:n,updatedElements:i.filter(FG),sharedInitializationProperties:r,group:null,newExpressionExecutorPromises:o});for(const[p,g]of n.entries())n.delete(p),g.destroy();return await Promise.all(Array.from(o.values())),u}async _updateInputsUsingFormElementsRecursive(e){const{existingInputsByElement:i,updatedElements:r,sharedInitializationProperties:n,group:o,newExpressionExecutorPromises:u}=e,p=[];for(const g of r){const w=i.has(g),S=w?i.get(g):this._makeInputFromElement(g,n,o);if(S){if(p.push(S),await vr(()=>!S.updating),this._assignExpressionExecutors(S,g,u),w)if(i.delete(g),Vf(S)){const{feature:T,timeZone:E}=n;S.set({feature:T,timeZone:E})}else if(JE(S)){const T=this.relationshipId===g.relationshipId;S.set(n),S.set({map:this.map,showAllEnabled:T})}else S.set(n);if(UA(g)){const T=g.elements.filter(E=>FG(E));S.inputs=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:i,updatedElements:T,sharedInitializationProperties:n,group:S,newExpressionExecutorPromises:u})}}}return p}_updateInputsUsingLayerFields(e,i,r){var u,p;if(!Array.isArray(i))return dse().warn(this.declaredClass,"No attribute fields found."),[];const n=new Map;for(const g of e)if(Vf(g)){for(const w of g.inputs)w.destroy();g.inputs.length=0,g.destroy()}else JE(g)?g.destroy():Uv(g)&&(g.element!==null?g.destroy():n.set(g.field,g));const o=[];for(const g of i){const w=((u=r.feature)==null?void 0:u.getAttribute(g.name))??null,S=n.get(g)??new TG({field:g,preservesValueWhenHidden:(p=this.formTemplate)==null?void 0:p.preserveFieldValuesWhenHidden});o.push(S.set({...r,value:w})),n.delete(g)}for(const[g,w]of n.entries())n.delete(g),w.destroy();return o}_resetFieldInputValues(e){for(const i of this.allFieldInputs)i.value=e.getAttribute(i.name)}_makeInputFromElement(e,i,r){return UA(e)?eOe(e,i):D8(e)?this._makeFieldInputFromElement(e,i,r):f3e(e)?this._makeRelationshipInputFromElement(e,i,r):Cee(e)?tOe(e,i):void 0}_makeFieldInputFromElement(e,i,r){var T;const{arcadeEditType:n,feature:o,initialFeature:u,layer:p,timeZone:g}=i,{fieldName:w}=e,S=w&&this._layerFieldsByName.get(w);return S?new TG({arcadeEditType:n,element:e,field:S,value:(o==null?void 0:o.getAttribute(e.fieldName))??null,feature:o,initialFeature:u,layer:p,group:r,preservesValueWhenHidden:(T=this.formTemplate)==null?void 0:T.preserveFieldValuesWhenHidden,timeZone:g}):null}_makeRelationshipInputFromElement(e,i,r=null){const{map:n}=this,{feature:o,layer:u,timeZone:p}=i,g=new qLe({element:e,feature:o,group:r,layer:u,map:n,timeZone:p});return g.addHandles(gi(()=>g.relatedLayer,"edits",()=>{var w;return(w=this._expressionsManager)==null?void 0:w.evaluateAsyncExpressions()})),g}_assignExpressionExecutors(e,i,r){var u;const n=YLe[i.type],o=[];for(const p of n){const g=`${p}Executor`;if(e[g]){this._useExecutor(e[g]);continue}const w=i[p];if(w!=null&&w!==""){const S=((u=this._expressionInfosLookup.get(w))==null?void 0:u.expression)??w;o.push(this._getOrCreateExecutorForExpression(S,r).then(T=>{e[g]=this._useExecutor(T)}))}}return ise(e)&&o.push(...this._assignTextElementExpressionExecutors(e,r)),o}_assignTextElementExpressionExecutors(e,i){const{_expressionInfosLookup:r}=this,n=[];for(const o of e.expressionsUsed){const u=r.get(o);u!=null?n.push(this._getOrCreateExecutorForExpression(u.expression,i).then(p=>e.setExpressionExecutor(o,this._useExecutor(p)))):fe.getLogger(this).error("feature-form:expression-not-found",`Could not find expressionInfo object with name '${o}'`)}for(const o of e.fieldsUsed){const u=`return $feature['${o}'];`;n.push(this._getOrCreateExecutorForExpression(u,i).then(p=>e.setFieldExecutor(o,this._useExecutor(p))))}return n}async _getOrCreateExecutorForExpression(e,i){const{_expressionExecutorLookup:r}=this;if(r.has(e))return r.get(e);if(i.has(e))return i.get(e);const n=zLe(e,this.layer);i.set(e,n);const o=await n;return r.set(e,o),o}_createExpressionsManager(e){const{_arcadeContextInfo:i,_featureClone:r,allFieldInputs:n,formTemplate:o}=this;this._expressionsManager=new Rc({executors:e,feature:r,arcadeContextInfo:i,fieldInputs:n,preserveFieldValuesWhenHidden:(o==null?void 0:o.preserveFieldValuesWhenHidden)===!0})}async _startExpressions(){if(this._expressionExecutorsInUse.size===0)return;const e=Array.from(this._expressionExecutorsInUse);this._createExpressionsManager(e),await this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}_stopExpressions(){this._expressionsManager=ot(this._expressionsManager),this._expressionExecutorsInUse.clear()}_useExecutor(e){return this._expressionExecutorsInUse.add(e),e}_afterValueChange(e){var S;const{name:i,value:r}=e,{_featureClone:n,formTemplate:o,layer:u}=this;if(!u)return;const p=n.getAttribute(i);n.setAttribute(i,r);const{typeFieldName:g,types:w}=KE(u);if((e.isSubtypeField||i===g)&&r!==p){if(u.type==="subtype-sublayer"){const E=(S=u.parent)==null?void 0:S.findSublayerForFeature(n);n.sourceLayer=this.feature.sourceLayer=E}const T=new Set;for(const E of w)if(E.domains&&typeof E.domains=="object")for(const C of Object.keys(E.domains))T.add(C);for(const E of T){const C=this.findField(E);C&&C.notifyChange("domain")}this.notifyChange("joinedContingentValues")}if(o!=null){const{description:T,title:E}=o;E&&X2(E,i)&&this.notifyChange("formTitle"),T&&X2(T,i)&&this.notifyChange("formDescription")}this._emitChangeEvent(e)}_afterExpressionsEvaluated(){const{_featureClone:e}=this;for(const i of this.allFieldInputs)i.value!==e.getAttribute(i.name)&&this._afterValueChange(i)}_joinContingentValues(){const e=this._contingentValuesCache;if(e==null)return[];const{typeFieldName:i}=KE(this.layer),r=i?this.getValue(i):null,n=[];for(const p of e.fieldGroups){const{contingencies:g,fields:w,name:S}=p,T=[];for(const E of g)E.isRetired||E.subtype!=null&&E.subtype.code!==r||T.push({values:E.values});T.length>0&&n.push({name:S,fields:w,contingencies:T})}const[o,u]=this._generateJoinPlan(n);return[...o.flatMap(p=>this._joinFieldGroupContingencies(p)),...u.flatMap(p=>p.contingencies)]}_generateJoinPlan(e){const i=new Map,r=[],n=new Set;for(const w of e)for(const S of w.fields)if(i.has(S)){const T=i.get(S),E=w,C=[T.name,E.name].sort().join("|");if(n.has(C))continue;r.push([T,E]),n.add(C),i.set(S,E)}else i.set(S,w);const o=new Set(r.flat()),u=new Set(e);for(const w of o)u.delete(w);const p=new Map,g=new Map;for(const w of new Set(r.flat())){const S=Symbol(w.name);p.set(S,new Set([w])),g.set(w,S)}for(const[w,S]of r){const T=g.get(w),E=g.get(S);if(T===E)continue;const C=p.get(T),L=p.get(E);for(const R of L)C.add(R),g.set(R,T);p.delete(E)}return[[...p.values()].map(w=>[...w]),[...u]]}_joinFieldGroupContingencies(e){var w,S;const i=e.slice(),r=i.shift();let n=i.shift(),o=this._generateJoinKey(r.fields,n.fields),u=new Set([...r.fields,...n.fields]),p=new Map;for(const T of r.contingencies){const[E]=this._hashContingency(T,o.codedValueFields,!0);p.has(E)?(w=p.get(E))==null||w.push(T):p.set(E,[T])}for(;i.length>0;){const T=new Map,E=i.shift(),C=this._generateJoinKey(u,E.fields);for(const L of n.contingencies){const[R,F]=this._hashContingency(L,o.codedValueFields),V=F?this._findMatchingContingenciesWithAnyHashMask(p,R):p.get(R);if(p.has(Eg)&&(V==null||V.push(...this._findMatchingContingenciesContainingAny(L,p.get(Eg),o.codedValueFields))),V!=null)for(const U of V){const W=o.rangeFields.length>0?this._joinContingenciesWithRangeDomains(U,L,o.rangeFields):this._joinContingencies(U,L);if(W==null)break;const[H]=this._hashContingency(W,C.codedValueFields,!0);T.has(H)?(S=T.get(H))==null||S.push(W):T.set(H,[W])}}p=T,n=E,o=C,u=new Set([...u,...n.fields])}const g=[];for(const T of n.contingencies){const[E,C]=this._hashContingency(T,o.codedValueFields),L=C?this._findMatchingContingenciesWithAnyHashMask(p,E):p.get(E);if(p.has(Eg)&&L.push(...this._findMatchingContingenciesContainingAny(T,p.get(Eg),o.codedValueFields)),L!=null)for(const R of L){const F=o.rangeFields.length>0?this._joinContingenciesWithRangeDomains(R,T,o.rangeFields):this._joinContingencies(R,T);F!=null&&g.push(F)}}return g}_joinContingencies(e,i){const r={values:{...e.values,...i.values}};for(const[n,o]of Object.entries(r.values))o.objectType==="any"&&e.values[n]!=null&&(r.values[n]=e.values[n]);return r}_joinContingenciesWithRangeDomains(e,i,r){const n=this._joinContingencies(e,i);for(const o of r){const u=e.values[o],p=i.values[o],{leftIsNull:g,rightIsNull:w,bothAreNull:S,leftIsAny:T,rightIsAny:E,bothAreAny:C,leftIsRange:L,rightIsRange:R}=this._compareObjectTypes(u.objectType,p.objectType);if(S||C)continue;if(g&&E||w&&T){n.values[o]=new rs({objectType:"null"});continue}if(g&&R||w&&L)return null;T?(u.minValue=-1/0,u.maxValue=1/0):E&&(p.minValue=-1/0,p.maxValue=1/0);const F=Math.max(u.minValue,p.minValue),V=Math.min(u.maxValue,p.maxValue);if(F>V)return null;n.values[o]=new rs({objectType:"range",minValue:F,maxValue:V})}return n}_findMatchingContingenciesContainingAny(e,i,r){return i.filter(n=>r.every(o=>{var g,w;const u=n.values[o],p=e.values[o];return u.objectType==="any"||p.objectType==="any"||((g=u.codedValue)==null?void 0:g.code)===((w=p.codedValue)==null?void 0:w.code)}))}_findMatchingContingenciesWithAnyHashMask(e,i){const r=RegExp(`${i}$`),n=[];for(const[o,u]of e){if(o===Eg)break;r.test(o)&&n.push(...u)}return n}_generateJoinKey(e,i){var w;const r=Array.isArray(e)?new Set(e):e,n=Array.isArray(i)?new Set(i):i,o=r.size<n.size?r:n,u=o===r?n:r,p=new Set,g=new Set;for(const S of o)if(u.has(S)){const T=(w=this.layer)==null?void 0:w.getFieldDomain(S,{feature:this.feature});if(T==null)continue;switch(T.type){case"coded-value":p.add(S);break;case"range":g.add(S)}}return{codedValueFields:[...p],rangeFields:[...g]}}_contingencyIsValid(e,i){const r={};for(const{name:n,value:o}of this.allFieldInputs)this.fieldsWithContingentValues.has(n)&&o!=null&&n!==e&&(r[n]=o);return Object.entries(r).every(([n,o])=>!i.values.hasOwnProperty(n)||wLe(o,i.values[n]))}_getContingentValueOptionsForField(e,i){const r=this.joinedContingentValues.slice(),n=new Map,o={code:"",name:i??"No value"};for(const u of r){const p=u.values[e];if((p==null?void 0:p.objectType)==="code"||(p==null?void 0:p.objectType)==="null"){const{code:g,name:w}=p.codedValue&&p.objectType!=="null"?p.codedValue:o;!n.has(g)&&this._contingencyIsValid(e,u)&&n.set(g,{name:w,value:g})}}return[...n.values()]}_hashContingency(e,i,r=!1){var u;if(i.length<1)return[XLe,!1];const n=[];let o=!1;for(const p of i){const g=e.values[p];if(g.objectType==="any"){if(r)return[Eg,!0];o=!0,n.push(`${p}:.*`)}else g.objectType==="null"?n.push(`${p}:${QLe}`):n.push(`${p}:${(u=g.codedValue)==null?void 0:u.code}`)}return[n.sort().join("&"),o]}_compareObjectTypes(e,i){return{leftIsNull:e==="null",rightIsNull:i==="null",bothAreNull:e==="null"&&i==="null",leftIsAny:e==="any",rightIsAny:i==="any",bothAreAny:e==="any"&&i==="any",leftIsRange:e==="range",rightIsRange:i==="range"}}};function FG(t){return t.type==="field"||t.type==="group"||t.type==="relationship"||t.type==="text"||(dse().warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${t.label} has unsupported type '${t.type}'`),!1)}function eOe(t,e){const{feature:i,layer:r}=e;return new ULe({element:t,inputs:[],feature:i,layer:r})}function tOe(t,e,i=null){const{feature:r,layer:n,timeZone:o}=e;return new xa({element:t,feature:r,group:i,layer:n,timeZone:o})}m([b()],Ut.prototype,"_expressionInfosLookup",null),m([b()],Ut.prototype,"_featureClone",void 0),m([b()],Ut.prototype,"_timeZone",void 0),m([b()],Ut.prototype,"activeRelationshipInput",null),m([b()],Ut.prototype,"_arcadeContextInfo",null),m([b()],Ut.prototype,"allFieldInputs",null),m([b()],Ut.prototype,"allGroupInputs",null),m([b()],Ut.prototype,"allRelationshipInputs",null),m([b()],Ut.prototype,"_layerFieldsByName",null),m([b()],Ut.prototype,"arcadeEditType",void 0),m([b()],Ut.prototype,"contingencyConstraintViolations",void 0),m([b()],Ut.prototype,"disabled",void 0),m([b()],Ut.prototype,"feature",null),m([b()],Ut.prototype,"fieldsWithContingentValues",null),m([b({type:Oee})],Ut.prototype,"formTemplate",null),m([b()],Ut.prototype,"formDescription",null),m([b()],Ut.prototype,"formTitle",null),m([b()],Ut.prototype,"formHeaderVisible",null),m([b()],Ut.prototype,"highlightHelper",void 0),m([b()],Ut.prototype,"inputs",void 0),m([b()],Ut.prototype,"joinedContingentValues",null),m([b()],Ut.prototype,"layer",null),m([b()],Ut.prototype,"map",void 0),m([b()],Ut.prototype,"relatedRecordCallbacks",void 0),m([b()],Ut.prototype,"relationshipId",null),m([b()],Ut.prototype,"spatialReference",null),m([b()],Ut.prototype,"state",null),m([b()],Ut.prototype,"strict",void 0),m([b()],Ut.prototype,"submittable",null),m([b()],Ut.prototype,"timeZone",null),m([b()],Ut.prototype,"updating",null),m([b()],Ut.prototype,"valid",null),m([b()],Ut.prototype,"hasPendingSubtypeChoice",void 0),m([b()],Ut.prototype,"getValues",null),m([b()],Ut.prototype,"submit",null),Ut=m([G(pse)],Ut);const JR=Ut,C0="data-field-name";let Bi=class extends vi{constructor(e,i){super(e,i),this._attemptFocusOnNextRender=!1,this._dateComponentMap=new Map,this._inputsWithChanges=new Set,this._focusedFieldName=null,this._pendingSubtypeChoice=null,this._listObserverNode=null,this._listObserver=new IntersectionObserver(r=>{r.length&&r[0].isIntersecting&&this._incrementRelatedRecordPage()},{root:window.document}),this._prompt=null,this.groupDisplay="all",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesFeature=null,this.messagesTemplates=null,this.viewModel=new JR,this._onShowAllRelatedRecordsClick=r=>{const{feature:n,relatedRecordCallbacks:o}=this;n&&(o!=null&&o.showAllRelatedRecords)&&o.showAllRelatedRecords({parentFeature:n,relationshipId:r})},this._onAddRelatedRecordsClick=(r,n)=>{const{feature:o,relatedRecordCallbacks:u}=this;o&&(u!=null&&u.addRelatedRecord)&&u.addRelatedRecord({parentFeature:o,relatedLayer:n,relationshipId:r})},this._onFormKeyDown=this._onFormKeyDown.bind(this),this._onFormSubmit=this._onFormSubmit.bind(this),this._onGroupToggle=this._onGroupToggle.bind(this),this._onComponentBlur=this._onComponentBlur.bind(this),this._onComponentFocus=this._onComponentFocus.bind(this),this._onComponentKeyDown=this._onComponentKeyDown.bind(this),this._afterComponentCreate=this._afterComponentCreate.bind(this),this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this),this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this),this._afterDateComponentCreateOrUpdate=this._afterDateComponentCreateOrUpdate.bind(this),this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([ce(()=>this.feature,()=>{this._inputsWithChanges.clear(),this._dateComponentMap.clear(),vr(()=>!this.viewModel.updating).then(()=>{const e=this._getFocusableInput("forward");this._syncGroupInputStates(),this._focusedFieldName=(e==null?void 0:e.name)||null,this._attemptFocusOnNextRender=!0})}),ce(()=>this.groupDisplay,()=>this._syncGroupInputStates()),this.on("submit",e=>{if(e.invalid.length>0){const[i]=e.invalid;e.invalid.forEach(r=>this._inputsWithChanges.add(r)),this._focusedFieldName=i,this._attemptFocusOnNextRender=!0,this.scheduleRender()}}),ce(()=>[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])}loadDependencies(){return zi({block:()=>ie(()=>import("./calcite-block-DOM6q34Z.js"),__vite__mapDeps([281,267,227,220,221,225,226,228,248,224,247,244,245,233,223,229,230,241,242,243,246,249,264,250])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),combobox:()=>ie(()=>import("./calcite-combobox-DJcusimv.js"),__vite__mapDeps([282,283,262,245,220,244,219,221,222,223,224,225,226,227,247,228,253,284,236,229,285,267,255])),"combobox-item":()=>ie(()=>import("./calcite-combobox-item-C0Ck8epN.js"),__vite__mapDeps([286,285,267,227,220,221,284,223,229])),"combobox-item-group":()=>ie(()=>import("./calcite-combobox-item-group-Vy3aYLmY.js"),__vite__mapDeps([287,288,220,284])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),input:()=>ie(()=>import("./calcite-input-Dl0Mk_X_.js"),__vite__mapDeps([251,252,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),"input-date-picker":()=>ie(()=>import("./calcite-input-date-picker-DnA9GQP_.js"),__vite__mapDeps([289,225,220,226,227,244,245,219,221,222,223,224,247,228,248,229,246,253,254,255,290,256])),"input-message":()=>ie(()=>import("./calcite-input-message-DUzlrVMh.js"),__vite__mapDeps([257,255,220,229,227])),"input-number":()=>ie(()=>import("./calcite-input-number-wv0rR9lK.js"),__vite__mapDeps([291,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),"input-time-picker":()=>ie(()=>import("./calcite-input-time-picker-BrieeaIK.js"),__vite__mapDeps([292,219,220,221,226,222,223,224,225,227,246,228,229,253,254,233,230,255,290,256,243,244,245,247,248,249])),"input-time-zone":()=>ie(()=>import("./calcite-input-time-zone-_W4PHIVg.js"),__vite__mapDeps([293,222,220,223,221,225,226,227,228,224,219,236,229,283,262,245,244,247,253,284,285,267,255,288])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227])),notice:()=>ie(()=>import("./calcite-notice-mqUu1NoI.js"),__vite__mapDeps([266,267,227,220,224,225,226,228,247,223,229])),"radio-button":()=>ie(()=>import("./calcite-radio-button-CcS5x8sg.js"),__vite__mapDeps([279,242,220,219,221,222,223,224])),"radio-button-group":()=>ie(()=>import("./calcite-radio-button-group-DAXgLR4O.js"),__vite__mapDeps([280,227,220,224,253,229,255])),switch:()=>ie(()=>import("./calcite-switch-Bg2wMLH-.js"),__vite__mapDeps([269,220,219,221,226,222,223,224])),"text-area":()=>ie(()=>import("./calcite-text-area-BxSE4CTL.js"),__vite__mapDeps([294,219,220,222,223,225,226,227,224,228,221,253,254,229,255,245]))})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const e=this.relatedRecordCallbacks;return!(!e||!(e.addRelatedRecord||e.editRelatedRecord||e.showAllRelatedRecords))}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get feature(){return this.viewModel.feature}set feature(e){this.viewModel.feature=e}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(e){this.viewModel.formTemplate=e}get icon(){return"form-field"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(e){this.viewModel.relatedRecordCallbacks=e}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(e){this.viewModel.relationshipId=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get strict(){return this.viewModel.strict}set strict(e){this.viewModel.strict=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get showPrompt(){return e=>{var i,r;(r=(i=this._prompt)==null?void 0:i.cancel)==null||r.call(i),this._prompt=e}}set showPrompt(e){this._overrideIfSome("showPrompt",e)}get clearPrompt(){return()=>this._prompt=null}set clearPrompt(e){this._overrideIfSome("clearPrompt",e)}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const{state:e}=this.viewModel;return N("div",{class:this.classes(Ui.base,Ee.widget,Ee.panel)},e==="ready"?this._renderForm():null)}_renderForm(){return N("div",null,N("form",{class:Ui.form,novalidate:!0,onkeydown:this._onFormKeyDown,onsubmit:this._onFormSubmit},this._renderHeader(),this._renderContent()),this._prompt?N(tse,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderHeader(){const e=this.viewModel;if(!e.formHeaderVisible)return;const i=e.formTitle!=null&&N(jl,{key:"title",level:this.headingLevel},e.formTitle),r=e.formDescription!=null&&N("p",{class:Ui.description,key:"description"},e.formDescription);return N("div",{class:Ui.formHeader},i,r)}_renderContent(){const{viewModel:e}=this;return e.activeRelationshipInput?this._renderRelationshipInput(e.activeRelationshipInput):e.inputs.filter(Rt).filter(i=>i.visible).map(i=>this._renderInput(i))}_renderInput(e){return Vf(e)?this._renderGroup(e):Uv(e)?this._renderLabeledField(e):JE(e)?this._renderRelationshipInput(e):ise(e)?this._renderTextElementInput(e):void 0}_renderDescriptionOrEmpty(e,i){return e==null?null:N("div",{class:this.classes(Ui.description),id:i},e)}_renderGroup(e){const{disabled:i,formTemplate:r,headingLevel:n}=this,{description:o,id:u,inputs:p,label:g,open:w}=e,S=p.filter(L=>L.visible),T=this.viewModel.findField(this._focusedFieldName),E=(T==null?void 0:T.group)===e,C=this.groupDisplay==="sequential";return N("calcite-block",{class:this.classes(Ui.group,C?Ui.groupSequential:null,E?Ui.groupActive:null,i?Ui.inputDisabled:null),collapsible:!0,"data-group":e,description:o||void 0,disabled:i,heading:`${g}`,headingLevel:r!=null&&r.title?zv(n):n,id:u,key:u,open:w,onCalciteBlockToggle:({target:L})=>this._onGroupToggle(L,e)},S.map(L=>this._renderInput(L)))}_getFocusableInput(e,i){const r=qR(this.viewModel.inputs);let n;if(e==="backward"&&r.reverse(),i)if(Vf(i)){const o=i.inputs.find(u=>u.visible);n=o?r.indexOf(o):0}else{let o;if(Nk(i)&&!i.group.open){const u=i.group.inputs.filter(Uv);o=e==="forward"?u[u.length-1]:u[0]}else o=i;n=r.indexOf(o)+1}else n=0;for(let o=n;o<r.length;o++){const u=r[o];if(u.visible&&Uv(u))return u}return null}_renderLabeledField(e){var w;const{dataType:i,feature:r,label:n,layer:o,required:u}=e,p={"aria-label":u?qn(this.messages.requiredFieldLabel,{name:n}):n,class:Ui.label,key:`${o.id}-${r.uid}-${e.name}`},g=[N("div",{class:Ui.labelTextContent,key:"labelTextContainer"},n,u?N("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),i!=="unsupported"?this._renderFieldInput(e):this._renderReadOnlyComponent(e),this._renderAuxiliaryText(e)];return i==="date"&&((w=e.domain)==null?void 0:w.type)!=="coded-value"?N("label",{...p},g):N("calcite-label",{...p},g)}_renderFieldInput(e){const{dataType:i,domain:r,inputType:n,name:o}=e,u=this.getCommonInputProps(e);if((r==null?void 0:r.type)==="coded-value"){const p=this.viewModel.getFieldValueOptionsForField(o,this.messages.empty);return n!=="switch"||e.hasInvalidSwitchValue?n==="radio-buttons"?this._renderRadioButtonComponents(e,p.flat(),u):this._renderComboBoxComponent(e,p,u):this._renderSwitchComponent(e,u)}return n==="datetime-picker"||i==="date"?this._renderDateComponents(e,u):i==="number"?this._renderNumberComponent(e,u):this._renderStringComponent(e,u)}_renderStringComponent(e,i){return e.inputType==="text-area"?i.readOnly?N("calcite-input",{...i,loading:e.updating,type:"textarea",onCalciteInputInput:r=>this._saveValueFromComponent(r.target)}):N("calcite-text-area",{...i,resize:"vertical",onCalciteTextAreaInput:r=>this._saveValueFromComponent(r.target)}):N("calcite-input",{...i,loading:e.updating,type:"text",onCalciteInputInput:r=>this._saveValueFromComponent(r.target)})}_renderNumberComponent(e,i){return N("calcite-input-number",{...i,integer:Uve(e.field),loading:e.updating,type:"number",onCalciteInputNumberInput:r=>this._saveValueFromComponent(r.target)})}_renderDateComponents(e,i){const{field:r}=e;switch(r.type){case"date":return this._renderDateFieldComponents(e,i);case"date-only":return this._renderDateOnlyFieldComponent(e,i);case"time-only":return this._renderTimeOnlyFieldComponent(e,i);case"timestamp-offset":return this._renderTimestampOffsetFieldComponents(e,i);default:return this._renderReadOnlyComponent(e,uX(r,i.value,{timeZone:this.timeZone,...YP(r)}))}}_renderDateOnlyFieldComponent(e,i){const{range:r,valid:n,value:o}=e,{class:u,key:p,readOnly:g}=i,{rawMax:w,rawMin:S}=r;return N("calcite-input-date-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!n,class:u,"data-date-part":"date","data-field-name":i[C0],key:`${p}-date-input`,max:pb(w)?w:void 0,min:pb(S)?S:void 0,numberingSystem:n_,onblur:T=>{this._focusedFieldName=null,this._saveValueFromDateComponent(T.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:g,value:o!=null?`${o}`:void 0,onCalciteInputDatePickerChange:T=>this._saveValueFromDateComponent(T.target)})}_renderTimeOnlyFieldComponent(e,i){const{valid:r,value:n}=e,{class:o,key:u,readOnly:p}=i;return N("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!r,class:o,"data-date-part":"time","data-field-name":i[C0],key:`${u}-time-input`,numberingSystem:n_,onblur:g=>{this._focusedFieldName=null,this._saveValueFromDateComponent(g.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:p,step:e.timeStep,value:n!=null?`${n}`:void 0,onCalciteInputTimePickerChange:g=>this._saveValueFromDateComponent(g.target)})}_renderTimestampOffsetFieldComponents(e,i){const{name:r,range:n,timeZone:o,valid:u,value:p}=e,{class:g,key:w,readOnly:S}=i,{rawMax:T,rawMin:E}=n,C={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!u,numberingSystem:n_,overlayPositioning:"fixed",readOnly:S,[C0]:r,onfocus:this._onComponentFocus},L=s_(T,o),R=s_(E,o),F=s_(p,o);return N("div",{class:Ui.dateInputContainer,key:`${w}-date-time-container`},N("calcite-input-date-picker",{...C,class:g,"data-date-part":"date",key:`${w}-date-input`,max:(L==null?void 0:L.date)??void 0,min:(R==null?void 0:R.date)??void 0,onblur:V=>{this._focusedFieldName=null,this._saveValueFromDateComponent(V.target)},value:F.date??void 0,onCalciteInputDatePickerChange:V=>this._saveValueFromDateComponent(V.target)}),N("calcite-input-time-picker",{...C,class:g,"data-date-part":"time",key:`${w}-time-input`,onblur:V=>{this._focusedFieldName=null,this._saveValueFromDateComponent(V.target)},step:e.timeStep,value:F.time??void 0,onCalciteInputTimePickerChange:V=>this._saveValueFromDateComponent(V.target)}),e.includeTimeOffset?N("calcite-input-time-zone",{...C,class:g,"data-date-part":"timeZone",disabled:S,key:`${w}-timezone-input`,onblur:V=>{this._focusedFieldName=null,this._saveValueFromDateComponent(V.target)},value:F.timeZoneOffset??"0",onCalciteInputTimeZoneChange:V=>this._saveValueFromDateComponent(V.target)}):null)}_renderDateFieldComponents(e,i){const{includeTime:r,name:n,valid:o,value:u}=e,{class:p,key:g,max:w,min:S,readOnly:T}=i,{timeZone:E}=this,C={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!o,numberingSystem:n_,overlayPositioning:"fixed",readOnly:T,[C0]:n,onfocus:this._onComponentFocus},L=gx(u,E),R=gx(w,E),F=gx(S,E);return N("div",{class:Ui.dateInputContainer,key:`${g}-date-time-container`},N("calcite-input-date-picker",{...C,class:p,"data-date-part":"date",key:`${g}-date-input`,max:(R==null?void 0:R.date)??void 0,min:(F==null?void 0:F.date)??void 0,onblur:V=>{this._focusedFieldName=null,this._saveValueFromDateComponent(V.target)},value:L.date??void 0,onCalciteInputDatePickerChange:V=>this._saveValueFromDateComponent(V.target)}),r?N("calcite-input-time-picker",{...C,class:p,"data-date-part":"time",key:`${g}-time-input`,onblur:V=>{this._focusedFieldName=null,this._saveValueFromDateComponent(V.target)},step:1,value:L.time??void 0,onCalciteInputTimePickerChange:V=>this._saveValueFromDateComponent(V.target)}):null)}_renderReadOnlyComponent(e,i){const r=this.getCommonInputProps(e);return N("calcite-input",{...r,class:this.classes(Ui.fieldInput,Ui.inputDisabled),readOnly:!0,type:"text",value:i!=null?`${i}`:r.value})}_renderComboBoxComponent(e,i,r){const{value:n,name:o}=e,{viewModel:u,_inputsWithChanges:p}=this,g=u.arcadeEditType==="INSERT",w=p.has(o),S=n==null&&(!g||w),T=g&&e.showNoValueOptionEnabled&&!w?()=>{}:r.onblur;return N("calcite-combobox",{...r,allowCustomValues:!1,clearDisabled:!0,disabled:r.readOnly,onblur:T,overlayPositioning:"fixed",selectionMode:"single",onCalciteComboboxChange:({target:E})=>{S&&E.selectedItems.length===0?this._ignoreDeselectionOfNoValueOption(E):e.isSubtypeField&&E.selectedItems.length===0?E.value=`${e.value}`:this._saveValueFromComponent(E)}},this.renderComboboxOptionsList(e,i))}renderComboboxOptionsList(e,i){const{value:r,name:n}=e,{messages:o,messagesTemplates:u,viewModel:p,_inputsWithChanges:g}=this,[w,S,T]=i.map(F=>F.map(({name:V,value:U})=>N("calcite-combobox-item",{key:`#${U}`,selected:r===U,textLabel:V,value:`${U}`}))),E=[];S.length>0&&E.push(N("calcite-combobox-item-group",{key:"other",label:u.other},S)),T.length>0&&E.push(N("calcite-combobox-item-group",{key:"unsupported",label:o.subtypes.unsupportedDomainGroupTitle},T)),E.length>0?E.unshift(N("calcite-combobox-item-group",{key:"recommended",label:o.recommended},w)):E.push(...w);const C=p.arcadeEditType==="INSERT",L=g.has(n),R=r==null&&(!C||L);return e.showNoValueOptionEnabled&&E.unshift(N("calcite-combobox-item",{key:"empty-option",selected:R,textLabel:e.showNoValueLabel||o.empty,value:""})),E}_renderRadioButtonComponents(e,i,r){const{name:n,value:o}=e,u=i.map(({name:p,value:g})=>this._renderRadioButtonComponent({key:p,label:p,name:n,value:g,selected:g===o,props:r}));if(e.showNoValueOptionEnabled){const p="",g=e.showNoValueLabel||this.messages.empty,w=o===p||o===null;u.unshift(this._renderRadioButtonComponent({key:"empty-option",label:g,name:n,value:p,selected:w,props:r}))}return N("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:Ui.inputRadioGroup,"data-field-name":r[C0],key:`${r.key}-radio-group`,layout:"vertical",name:r.key,required:r.required},u)}_renderSwitchComponent(e,i){const{value:r}=e,n=!!jm(e.element,"switch")&&r===e.element.input.onValue;return N("calcite-switch",{...i,checked:n,class:Ui.inputSwitch,disabled:i.readOnly,onblur:()=>{this._focusedFieldName=null},onCalciteSwitchChange:o=>this._saveValueFromComponent(o.target)})}_renderRadioButtonComponent({key:e,name:i,value:r,selected:n,label:o,props:u}){return N("calcite-label",{class:Ui.inputRadioLabel,key:e,layout:"inline"},N("calcite-radio-button",{...u,afterCreate:void 0,afterUpdate:void 0,checked:n,class:Ui.inputRadio,disabled:u.readOnly,name:i,onblur:()=>{this._focusedFieldName=null},value:r,onCalciteRadioButtonChange:({target:p})=>{p.checked&&this._saveValueFromComponent(p)}}),o)}_renderAuxiliaryText(e){const i=e.name,r=this._inputsWithChanges.has(i)&&!e.valid?yLe(e,this.messages,this.timeZone):this.viewModel.contingencyConstraintViolations.get(i)!=null?this.messages.validationErrors.valuesIncompatible:e.valueExpressionExecutor!=null&&e.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return r!=null?N("calcite-input-message",{icon:!0,status:"invalid"},r):this._inputsWithChanges.has(i)&&e.valueIsOutOfDomain?N("calcite-input-message",{icon:!0,status:"idle"},this.messages.subtypes.fieldOutOfSubtypeDomainWarning):this._renderDescriptionOrEmpty(e.description)}_renderShowAllRelatedRecordsListItem(e){const{featureCount:i,relationshipId:r,showAllActionVisible:n}=e,{relatedRecordCallbacks:o}=this;if(!n||!(o!=null&&o.showAllRelatedRecords))return;const u=this.messages;return N("calcite-list-item",{description:qn(u.totalCount,{count:i}),label:u.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(r)},N("calcite-icon",{icon:"list",scale:"s",slot:"content-end"}))}_renderAddRelatedRecordButton(e){const{canAddRelatedFeature:i,relationshipId:r,relatedLayer:n}=e,{messages:o,relatedRecordCallbacks:u}=this;if(i&&(u!=null&&u.addRelatedRecord)&&n)return N("calcite-button",{alignment:"center",appearance:"outline-fill",class:Ui.centeredButton,disabled:e.updating||!e.originHasValidKey,iconStart:"plus",key:`${r}-add-button`,onclick:()=>{!e.updating&&e.originHasValidKey&&this._onAddRelatedRecordsClick(r,n)},round:!0,scale:"s",width:"half"},e.relatedLayerIsTable?o.addRecord:o.addFeature)}_renderRelatedRecordListItem(e,i){const{feature:r,description:n,title:o}=e,{feature:u,relatedRecordCallbacks:p}=this,{highlightHelper:g}=this.viewModel,w=()=>{g==null||g.removeAll(),p!=null&&p.editRelatedRecord&&u&&p.editRelatedRecord({parentFeature:u,relationshipId:i,relatedFeature:r})},S=g?()=>g.add(r):void 0,T=g?()=>g.remove(r):void 0;return N("calcite-list-item",{bind:this,description:n,key:`${i}-${r.uid}`,label:o,onclick:w,onmouseenter:S,onmouseleave:T,value:o},N("calcite-icon",{icon:mLe(r),slot:"content-start"}),N("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderRelationshipInput(e){if(!this._relatedRecordsEnabled||!e.editable)return;const{featureCount:i,relationshipId:r,showAllEnabled:n}=e,o=n?null:this._renderDescriptionOrEmpty(e.description),u=i>0?this._renderRelatedRecordsList(e):e.loaded?e.originHasValidKey?this._renderNoRelatedRecordsNotice():this._renderNoValidOriginKeyNotice(e):void 0;return N("calcite-label",{class:this.classes(Ui.label,Ui.relatedRecordsLabel),key:`relationship-${r}-container`},N("div",null,this._renderRelatedRecordsHeaderContainer(e),o,u),this._renderAddRelatedRecordButton(e))}_renderRelatedRecordsHeaderContainer(e){var r;const i=e.updating||!e.loaded;return N("div",{class:Ui.relatedRecordsHeader,key:`relationship-${e.relationshipId}-header`},N("span",null,e.label),i?N("calcite-loader",{inline:!0,key:"loader",label:(r=this.messagesCommon)==null?void 0:r.loading,scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(e){const{relationshipId:i}=e;return N("calcite-list",{class:Ui.relatedRecordsList},e.relatedFeatureInfos.map(r=>this._renderRelatedRecordListItem(r,i)),this._renderShowAllRelatedRecordsListItem(e),this._renderObserverNode())}_renderNoValidOriginKeyNotice(e){var w,S,T;const{messages:i}=this,r=e.relatedLayerIsTable?i.noOriginKeyRecord:i.noOriginKeyFeature,n=(w=e.relationship)==null?void 0:w.keyField,o=this.viewModel.findField(n),u=(S=e.layer)==null?void 0:S.fieldsIndex.get(n),p=(o==null?void 0:o.label)||(u==null?void 0:u.alias)||n,g=qn(r,{relatedLayerName:(T=e.relatedLayer)==null?void 0:T.title,originKeyField:p});return N("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},N("div",{slot:"message"},g))}_renderNoRelatedRecordsNotice(){return N("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},N("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){var e;if((e=this.viewModel.activeRelationshipInput)!=null&&e.showAllEnabled)return N("div",{afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved,bind:this,class:Ui.listObserver,key:"feature-observer"})}_renderTextElementInput(e){return N("div",{class:Ui.textElement,innerHTML:e.text,key:e.id})}getCommonInputProps(e){const{disabled:i}=this,{editable:r,hint:n,label:o,maxLength:u,minLength:p,name:g,range:{max:w,min:S},required:T,valid:E,value:C}=e,L=this._inputsWithChanges.has(g),R=!r||i;return{afterCreate:this._afterComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":E?"false":"true",class:this.classes(Ui.fieldInput,R?Ui.inputDisabled:null),status:L&&!E?"invalid":"idle",key:g,label:o,max:w??void 0,min:S??void 0,maxLength:u>-1?u:void 0,minLength:p>-1?p:void 0,placeholder:n??void 0,readOnly:R,required:T,value:C==null?"":`${C}`,onblur:this._onComponentBlur,onfocus:this._onComponentFocus,onkeydown:this._onComponentKeyDown,[C0]:g}}_getFieldInputFromHTMLElement(e){return this.viewModel.findField(e.getAttribute(C0))}_afterDateComponentCreate(e){const i=this._getFieldInputFromHTMLElement(e),r=e.dataset.datePart,n=this._dateComponentMap.get(i.name);if("valueAsDate"in e&&e.value!=null){const o=new ResizeObserver(()=>{switch(e.value=void 0,i.field.type){case"date":e.value=gx(i.value,this.timeZone).date??"";break;case"timestamp-offset":e.value=s_(i.value,this.timeZone).date??"";break;default:e.value=`${i.value}`}o.unobserve(e)});o.observe(e)}if(n!=null)switch(r){case"date":n.date=e;break;case"time":n.time=e;break;case"timeZone":n.timeZone=e}else this._dateComponentMap.set(i.name,{[r]:e});this._afterDateComponentCreateOrUpdate(e)}_afterDateComponentCreateOrUpdate(e){this._afterComponentCreateOrUpdate(e)}_afterComponentCreate(e){const i=this._getFieldInputFromHTMLElement(e);oLe(i)&&e.value!=null&&"setNumberValue"in e&&e.setNumberValue({committing:!1,value:e.value,origin:"direct"}),this._afterComponentCreateOrUpdate(e)}_afterRadioGroupCreateOrUpdate(e){const i=e.selectedItem,r=e.querySelector("calcite-radio-button"),n=i||r;n&&this._afterComponentCreateOrUpdate(n)}_afterComponentCreateOrUpdate(e){const{viewModel:i}=this,r=this._getFieldInputFromHTMLElement(e),n=i.findField(this._focusedFieldName);this._attemptFocusOnNextRender&&n===r&&(this._attemptFocusOnNextRender=!1,Nk(r)&&(r.group.open=!0),e.setFocus())}_onComponentFocus(e){const i=e.target,r=this._getFieldInputFromHTMLElement(i);this._focusedFieldName=r.name}_onComponentBlur(e){const i=e.target;this._focusedFieldName=null,this._saveValueFromComponent(i)}_saveValueFromDateComponent(e){const{timeZone:i}=this,r=this._getFieldInputFromHTMLElement(e),n=r.field.type,{name:o,range:u}=r,p=this._dateComponentMap.get(o);if(!p)return;let g=this.viewModel.getValue(o),w=null;n==="date-only"?w=Array.isArray(e.value)?e.value[0]:e.value:n==="time-only"?(g=OC(g),w=OC(e.value)):w=n==="timestamp-offset"?e.value!=null?nve({dateComponent:p.date,timeComponent:p.time,timeZoneComponent:p.timeZone,oldValue:g,defaultTimeZone:i}):null:e.value!=null?sve({oldValue:g,dateComponent:p.date,timeComponent:p.time,timeZone:i,max:u.max,min:u.min}):null,w!==null&&e.value?g!==w&&this._updateFieldValue(o,w):this._updateFieldValue(o,null)}_saveValueFromComponent(e){const i=this._getFieldInputFromHTMLElement(e),r=this._parseValue(e),n=i.value;i.isSubtypeField&&_Le(this.layer,n,r)?this._pendingSubtypeChoice||r===n||(this._pendingSubtypeChoice=this._handleSubtypeChoice(i,r)):this._updateFieldValue(i.name,r)}async _handleSubtypeChoice(e,i){var R,F;const{value:r,name:n}=e,{layer:o,messages:u,viewModel:p,messagesCommon:g}=this;if(this._updateFieldValue(n,i),!o||!("subtypes"in o)||!((R=o.subtypes)!=null&&R.length))return;const w=o.subtypes.find(V=>V.code===i),S=((F=o.subtypes.find(V=>V.code===r))==null?void 0:F.name)??`${r}`;if(!w)return;p.hasPendingSubtypeChoice=!0;const T=os();let E="update-fields";const C=[{label:u.subtypes.useDefaultValuesOption,value:"update-fields"},{label:u.subtypes.keepCurrentValuesOption,value:"keep-existing"}],L={context:"info",title:u.subtypes.changeWarningTitle,message:qn(u.subtypes.changeWarning,{originalType:S,newType:w.name}),radios:C,defaultRadioSelection:"update-fields",onRadioSelection:V=>E=V,actions:{primary:{label:g.apply,action:()=>T.resolve(E),type:"positive"},secondary:{label:g.cancel,type:"neutral",action:()=>T.resolve("undo")}},cancel:()=>T.reject()};try{switch(this.showPrompt(L),await T.promise){case"update-fields":p.applySubtypeDefaults(w),this._validateContingenciesForNonNullFields();break;case"keep-existing":this._validateContingenciesForNonNullFields();break;case"undo":this._updateFieldValue(e.name,r)}}finally{p.hasPendingSubtypeChoice=!1,this.clearPrompt(),this._pendingSubtypeChoice=null}}_onComponentKeyDown({key:e,target:i}){const r=this._getFieldInputFromHTMLElement(i);e==="Enter"&&Nk(r)&&!r.group.open&&(r.group.open=!0)}_updateFieldValue(e,i){const r=this.viewModel.getValue(e);this.viewModel.setValue(e,i),this._inputsWithChanges.add(e),r!==i&&this.viewModel.fieldsWithContingentValues.has(e)&&this._validateContingenciesForNonNullFields()}_validateContingenciesForNonNullFields(){const e=Object.fromEntries(Object.entries(this.getValues()).filter(([i,r])=>r!=null));this.viewModel.validateContingencyConstraints(e)}_parseValue(e){const i=this._getFieldInputFromHTMLElement(e),r=e.value;return jm(i.element,"switch")?e.checked?i.element.input.onValue:i.element.input.offValue:r==null||r===""?null:i.dataType==="number"?r==="-0"||r==="-0."||r==="-0,"?r:parseFloat(r):i.field.type==="date"?parseFloat(r):r}_ignoreDeselectionOfNoValueOption(e){const{firstChild:i,selectedItems:r}=e;r.length===0&&i&&"selected"in i?i.selected=!0:fe.getLogger(this).warnOnce("Failed to override user attempt to deselect 'No value' option.")}_onGroupToggle(e,i){var r;e.open?(i.open=!0,this._focusedFieldName=((r=this._getFocusableInput("forward",i))==null?void 0:r.name)||null,this._attemptFocusOnNextRender=!0,this.groupDisplay==="sequential"&&this.viewModel.allGroupInputs.forEach(n=>{n!==i&&(n.open=!1)})):i.open=!1,this.scheduleRender()}_onFormSubmit(e){e.preventDefault()}_onFormKeyDown(e){e.key==="Enter"&&this.viewModel.submit()}_afterListObserverCreated(e){this.viewModel.activeRelationshipInput&&(this._listObserverNode=e)}_afterListObserverRemoved(){this._listObserverNode=null}_onObserverChange(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode);const e=this.viewModel.activeRelationshipInput;e&&this._listObserverNode&&e.showAllEnabled&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){const e=this.viewModel.activeRelationshipInput;e==null||e.incrementPage()}_syncGroupInputStates(){if(this.groupDisplay!=="sequential")return;const e=this.viewModel.allGroupInputs;if(!e.length)return;const i=e.filter(r=>r.open);i.length===0?e[0].open=!0:i.length>1&&i.slice(1).forEach(r=>r.open=!1)}get test(){return{inputsWithChanges:this._inputsWithChanges}}};m([b()],Bi.prototype,"_listObserverNode",void 0),m([b()],Bi.prototype,"_relatedRecordsEnabled",null),m([b()],Bi.prototype,"_prompt",void 0),m([b()],Bi.prototype,"disabled",null),m([b()],Bi.prototype,"feature",null),m([b()],Bi.prototype,"formTemplate",null),m([b()],Bi.prototype,"groupDisplay",void 0),m([b()],Bi.prototype,"headingLevel",void 0),m([b()],Bi.prototype,"icon",null),m([b()],Bi.prototype,"label",null),m([b()],Bi.prototype,"layer",null),m([b()],Bi.prototype,"map",null),m([b(),vt("esri/widgets/FeatureForm/t9n/FeatureForm")],Bi.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Bi.prototype,"messagesCommon",void 0),m([b(),vt("esri/widgets/Feature/t9n/Feature")],Bi.prototype,"messagesFeature",void 0),m([b(),vt("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Bi.prototype,"messagesTemplates",void 0),m([b()],Bi.prototype,"relatedRecordCallbacks",null),m([b()],Bi.prototype,"relationshipId",null),m([b()],Bi.prototype,"spatialReference",null),m([b()],Bi.prototype,"strict",null),m([b()],Bi.prototype,"timeZone",null),m([b()],Bi.prototype,"showPrompt",null),m([b()],Bi.prototype,"clearPrompt",null),m([b(),v0(["value-change","submit"])],Bi.prototype,"viewModel",void 0),m([b()],Bi.prototype,"test",null),Bi=m([G("esri.widgets.FeatureForm")],Bi);const iOe=Bi;function fse(t,e,i,r){if(t)if(t.type!=="CIMTextSymbol"){if(t.effects)for(const n of t.effects)sOe(n,e);if(t.symbolLayers)for(const n of t.symbolLayers)switch(n.type){case"CIMPictureMarker":case"CIMVectorMarker":rOe(n,e,r);break;case"CIMPictureStroke":case"CIMSolidStroke":!(r!=null&&r.preserveOutlineWidth)&&n.width&&(n.width*=e);break;case"CIMPictureFill":n.height&&(n.height*=e),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e);break;case"CIMHatchFill":fse(n.lineSymbol,e,!0,{...r,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e),n.separation&&(n.separation*=e)}}else t.height!=null&&(t.height*=e)}function rOe(t,e,i){if(t&&(t.markerPlacement&&nOe(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const r of t.markerGraphics)t.scaleSymbolsProportionally||fse(r.symbol,e,!0,i)}function nOe(t,e){switch(uM(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function sOe(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map(r=>r*e);t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function yse(t){const e=[];return EO(lee(t),e),e.length?new Ce(aee(e[0])):null}function EO(t,e){var n;if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const r=t.type==="CIMPolygonSymbol";if(i!=null&&i.symbolLayers){for(const o of i.symbolLayers)if(!(o.colorLocked||r&&(cee(o)||uee(o)&&o.markerPlacement&&uM(o.markerPlacement))))switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor&&NG(e,o.tintColor);break;case"CIMVectorMarker":(n=o.markerGraphics)==null||n.forEach(u=>{EO(u.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":NG(e,o.color);break;case"CIMHatchFill":EO(o.lineSymbol,e)}}}function NG(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function mse(t,e,i){e instanceof Ce||(e=new Ce(e));const r=lee(t);r&&IO(r,e)}function IO(t,e,i){var o;if(!t)return;let r;r=t.type==="CIMTextSymbol"?t.symbol:t;const n=(r==null?void 0:r.type)==="CIMPolygonSymbol";if(r!=null&&r.symbolLayers)for(const u of r.symbolLayers){if(u.colorLocked||n&&(cee(u)||uee(u)&&u.markerPlacement&&uM(u.markerPlacement)))continue;const p=e.toArray();switch(u.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":u.tintColor=p;break;case"CIMVectorMarker":(o=u.markerGraphics)==null||o.forEach(g=>{IO(g.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":u.color=p;break;case"CIMHatchFill":IO(u.lineSymbol,e)}}}const gse="picture-fill",vse="simple-fill",oOe="simple-line",bse="simple-marker",aOe="text",lOe="cim",DG=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),zk=new $8(1e3);function uOe(t){const e=t.style;let i=null;if(t)switch(t.type){case bse:e!=="cross"&&e!=="x"&&(i=t.color);break;case vse:e&&e!=="solid"?e!=="none"&&(i={type:"pattern",x:0,y:0,src:qt(`esri/symbols/patterns/${e}.png`),width:5,height:5}):i=t.color;break;case gse:i={type:"pattern",src:t.url,width:Zi(t.width)*t.xscale,height:Zi(t.height)*t.yscale,x:Zi(t.xoffset),y:Zi(t.yoffset)};break;case aOe:i=t.color;break;case lOe:i=yse(t)}return i}function cOe(t,e){const i=t+"-"+e;return zk.get(i)!==void 0?Promise.resolve(zk.get(i)):nt(t,{responseType:"image"}).then(r=>{const n=r.data,o=n.naturalWidth,u=n.naturalHeight,p=document.createElement("canvas");p.width=o,p.height=u;const g=p.getContext("2d");g.fillStyle=e,g.fillRect(0,0,o,u),g.globalCompositeOperation="destination-in",g.drawImage(n,0,0);const w=p.toDataURL();return zk.put(i,w),w})}function F3(t){if(!t)return null;let e=null;switch(t.type){case vse:case gse:case bse:e=F3(t.outline);break;case oOe:{const i=Zi(t.width);t.style!=null&&t.style!=="none"&&i!==0&&(e={color:t.color,style:ZR(t.style),width:i,cap:t.cap,join:t.join==="miter"?Zi(t.miterLimit):t.join},e.dashArray=wse(e).join(",")||"none");break}default:e=null}return e}function wse(t){if(!(t!=null&&t.style))return[];const{dashArray:e,style:i,width:r}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map(u=>Number(u));const n=r??0,o=DG.has(i)?DG.get(i).map(u=>u*n):[];if(t.cap!=="butt")for(const[u,p]of o.entries())o[u]=u%2==1?p+n:Math.max(p-n,1);return o}const ZR=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),hOe=new Ce([128,128,128]);var Ln;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(Ln||(Ln={}));const W2={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function pOe(t,e,i){const r=Ln.size;let n=r,o=r;t<1?n*=.75:t>1&&(o*=1.25);const u=0,p=0;let g=r,w=r;return e&&i&&(n=o=g=w=0),[{type:"path",path:[{command:"M",values:[g,u]},{command:"L",values:[i?g:.875*g,u]},{command:"L",values:[i?n-.5*g:p,o-.5*w]},{command:"L",values:[n-.5*g,o-.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[g,u]},{command:"L",values:[g,e?u:.125*w]},{command:"L",values:[n-.5*g,e?o-.5*w:w]},{command:"L",values:[n-.5*g,o-.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n-.5*g,o-.5*w]},{command:"L",values:[i?n-.5*g:p,o-.5*w]},{command:"L",values:[i?n-.5*g:p,e?o-.5*w:w]},{command:"L",values:[n-.5*g,e?o-.5*w:w]},{command:"Z",values:[]}]}]}function dOe(t){const e=Ln.size,i=.5*t,r=0,n=0;return[{type:"path",path:[{command:"M",values:[n,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[n,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,r]},{command:"L",values:[e,r]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[n,.7*e*.5]},{command:"Z",values:[]}]}]}function fOe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function yOe(t,e){let i=e?Ln.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Ln.size?i-=.5*n:i-=n;const o=0,u=0,p=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,o]},{command:"L",values:[i,.5*p]},{command:"L",values:[.5*i,p]},{command:"L",values:[u,.5*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*p]},{command:"L",values:[.5*i,p]},{command:"L",values:[.5*i,r]},{command:"L",values:[u,r-.5*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,p]},{command:"L",values:[.5*i,r]},{command:"L",values:[i,r-.5*p]},{command:"L",values:[i,.5*p]},{command:"Z",values:[]}]}]}function mOe(t,e){let i=e?Ln.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Ln.size?i-=.5*n:i-=n;const o=.5*i,u=.15*i,p=0,g=r-u;return[{type:"ellipse",cx:.5*i,cy:g,rx:o,ry:u},{type:"path",path:[{command:"M",values:[p,u]},{command:"L",values:[p,g]},{command:"L",values:[i,g]},{command:"L",values:[i,u]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:u,rx:o,ry:u}]}function gOe(t,e){let i=e?Ln.tallSymbolWidth:t;const r=t,n=e?4:6;i<=Ln.size?i-=.5*n:i-=n;const o=.15*i,u=r-o;return[{type:"ellipse",cx:.5*i,cy:u,rx:.5*i,ry:o},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,u]},{command:"L",values:[0,u]},{command:"Z",values:[]}]}]}function vOe(t){let e=t;const i=t,r=6;e<Ln.size?e-=.5*r:e-=r;const n=.15*e,o=0;return[{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[e,o]},{command:"L",values:[.5*e,i-n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:o,rx:.5*e,ry:n}]}function bOe(t){let e=t;const i=t,r=4;e<Ln.size?e-=.5*r:e-=r;const n=0,o=0,u=e,p=i,g=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*u,n]},{command:"L",values:[u,.5*p-g]},{command:"L",values:[.45*u-g,.5*p+g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,n]},{command:"L",values:[.45*u-g,.5*p+g]},{command:"L",values:[o,.5*p-g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*p-g]},{command:"L",values:[.45*u-g,.5*p+g]},{command:"L",values:[.45*u,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,i]},{command:"L",values:[u,.5*p-g]},{command:"L",values:[.45*u-g,.5*p+g]},{command:"Z",values:[]}]}]}function wOe(t){const e=t,i=2;let r=t;r<Ln.size?r-=.5*i:r-=i;const n=0,o=0;return[{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[e,r]},{command:"L",values:[.45*e,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[o,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,r]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[e,r]},{command:"Z",values:[]}]}]}function Zf(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function jtt(t,e){if(t==null)return new Ce;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const i=new Ce(t);return new Ce([Zf(i.r,e),Zf(i.g,e),Zf(i.b,e),i.a])}const _Oe="http://www.w3.org/2000/svg";let SOe=0,xOe=0;const jG=me("android"),$Oe=me("chrome")||jG&&jG>=4?"auto":"optimizeLegibility",TOe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},EOe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Ir={},pi={};const IOe=Math.PI;let MOe=1;function yv(t,e){const i=t*(IOe/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function _se(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function KR(t,e,i,r,n){if(t){if(t.type==="circle")return N("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(t.type==="ellipse")return N("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(t.type==="rect")return N("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return N("image",{alt:n||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const o=typeof t.path!="string"?_se(t.path):t.path;return N("path",{d:o,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width})}if(t.type==="text")return a0(r),N("text",{"dominant-baseline":r.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":r.font.family,"font-size":r.font.size,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,kerning:r.kerning,rotate:r.rotate,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,"text-anchor":r.align,"text-decoration":r.decoration,"text-rendering":$Oe,x:t.x,y:t.y},t.text)}return null}function YR(t){const e={fill:"none",pattern:null,linearGradient:null};if(t){if("type"in t&&t.type==="pattern"){const i="patternId-"+ ++SOe;e.fill=`url(#${i})`,e.pattern={id:i,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}}}else if("type"in t&&t.type==="linear"){const i="linearGradientId-"+ ++xOe;e.fill=`url(#${i})`,e.linearGradient={id:i,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(r=>({offset:r.offset,color:r.color&&new Ce(r.color).toString()}))}}else if(t){const i=new Ce(t);e.fill=i.toString()}}return e}function XR(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new Ce(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=wse(t).join(",")||"none")),e}function Sse(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const r=t.alignBaseline,n=r==="baseline"?"auto":r==="top"?"text-top":r==="bottom"?"hanging":r;i.align=t.align,i.dominantBaseline=n,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",a0(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function xse(t){const{pattern:e,linearGradient:i}=t;if(e)return N("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},N("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(i){const r=i.stops.map((n,o)=>N("stop",{key:`${o}-stop`,offset:n.offset,"stop-color":n.color}));return N("linearGradient",{gradientUnits:"userSpaceOnUse",id:i.id,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2},r)}return null}function kOe(t,e){if(!t||t.length===0)return null;const i=[];for(const r of t){const{shape:n,fill:o,stroke:u,font:p}=r,g=YR(o),w=XR(u),S=n.type==="text"?Sse(n,p):null,T=KR(n,g.fill,w,S);T&&i.push(T)}return N("mask",{id:e,maskUnits:"userSpaceOnUse"},N("g",null,i))}function VG(t,e,i){return Sb(t,IM(t),[e,i])}function zG(t,e,i,r,n){return MM(t,IM(t),[e,i]),t[4]=t[4]*e-r*e+r,t[5]=t[5]*i-n*i+n,t}function COe(t,e,i,r){const n=e%360*Math.PI/180;ES(t,IM(t),n);const o=Math.cos(n),u=Math.sin(n),p=t[4],g=t[5];return t[4]=p*o-g*u+r*u-i*o+i,t[5]=g*o+p*u-i*u-r*o+r,t}function ro(t,e){Ir&&"left"in Ir?(Ir.left!=null&&Ir.left>t&&(Ir.left=t),(Ir.right==null||Ir.right<t)&&(Ir.right=t),(Ir.top==null||Ir.top>e)&&(Ir.top=e),(Ir.bottom==null||Ir.bottom<e)&&(Ir.bottom=e)):Ir={left:t,bottom:e,right:t,top:e}}function UG(t){const e=t.args,i=e.length;let r;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<i;r+=2)ro(e[r],e[r+1]);pi.x=e[i-2],pi.y=e[i-1];break;case"H":for(r=0;r<i;++r)ro(e[r],pi.y);pi.x=e[i-1];break;case"V":for(r=0;r<i;++r)ro(pi.x,e[r]);pi.y=e[i-1];break;case"m":{let n=0;for(("x"in pi)||(ro(pi.x=e[0],pi.y=e[1]),n=2),r=n;r<i;r+=2)ro(pi.x+=e[r],pi.y+=e[r+1]);break}case"l":case"t":for(r=0;r<i;r+=2)ro(pi.x+=e[r],pi.y+=e[r+1]);break;case"h":for(r=0;r<i;++r)ro(pi.x+=e[r],pi.y);break;case"v":for(r=0;r<i;++r)ro(pi.x,pi.y+=e[r]);break;case"c":for(r=0;r<i;r+=6)ro(pi.x+e[r],pi.y+e[r+1]),ro(pi.x+e[r+2],pi.y+e[r+3]),ro(pi.x+=e[r+4],pi.y+=e[r+5]);break;case"s":case"q":for(r=0;r<i;r+=4)ro(pi.x+e[r],pi.y+e[r+1]),ro(pi.x+=e[r+2],pi.y+=e[r+3]);break;case"A":for(r=0;r<i;r+=7)ro(e[r+5],e[r+6]);pi.x=e[i-2],pi.y=e[i-1];break;case"a":for(r=0;r<i;r+=7)ro(pi.x+=e[r+5],pi.y+=e[r+6])}}function GG(t,e,i){const r=TOe[t.toLowerCase()];let n;typeof r=="number"&&(r?e.length>=r&&(n={action:t,args:e.slice(0,e.length-e.length%r)},i.push(n),UG(n)):(n={action:t,args:[]},i.push(n),UG(n)))}function AOe(t){const e=(typeof t.path!="string"?_se(t.path):t.path).match(EOe),i=[];if(Ir={},pi={},!e)return null;let r="",n=[];const o=e.length;for(let p=0;p<o;++p){const g=e[p],w=parseFloat(g);isNaN(w)?(r&&GG(r,n,i),n=[],r=g):n.push(w)}GG(r,n,i);const u={x:0,y:0,width:0,height:0};return Ir&&"left"in Ir&&(u.x=Ir.left,u.y=Ir.top,u.width=Ir.right-Ir.left,u.height=Ir.bottom-Ir.top),u}function $se(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const i=AOe(t);e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function Tse(t){const e={x:0,y:0,width:0,height:0};let i=null,r=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(const o of t)i?(i.x=Math.min(i.x,o.x),i.y=Math.min(i.y,o.y),r=Math.max(r,o.x+o.width),n=Math.max(n,o.y+o.height)):(i=e,i.x=o.x,i.y=o.y,r=o.x+o.width,n=o.y+o.height);return i&&(i.width=r-i.x,i.height=n-i.y),i}function MO(t,e,i,r,n,o,u,p,g){let w=(u&&o?yv(o,e):e)/2,S=(u&&o?yv(o,i):i)/2;if(g){const U=g[0],W=g[1];w=(u&&o?yv(o,U):U)/2,S=(u&&o?yv(o,W):W)/2}const T=t.width+r,E=t.height+r,C=RE(),L=RE();let R=!1;if(n&&T!==0&&E!==0){const U=e!==i?e/i:T/E,W=e>i?e:i;let H=1,J=1;isNaN(W)||(U>1?(H=W/T,J=W/U/E):(J=W/E,H=W*U/T)),Hy(L,L,zG(C,H,J,w,S)),R=!0}const F=t.x+(T-r)/2,V=t.y+(E-r)/2;if(Hy(L,L,VG(C,w-F,S-V)),!R&&(T>e||E>i)){const U=T/e>E/i,W=(U?e:i)/(U?T:E);Hy(L,L,zG(C,W,W,F,V))}return o&&Hy(L,L,COe(C,o,F,V)),p&&Hy(L,L,VG(C,p[0],p[1])),`matrix(${L[0]},${L[1]},${L[2]},${L[3]},${L[4]},${L[5]})`}function LOe(t,e,i){const r=t==null?void 0:t.effects.find(w=>w.type==="bloom");if(!r)return null;const{strength:n,radius:o}=r,u=n>0?o:0,p=(n+u)*e,g=4*n+1;return N("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${i}`,width:"300%",x:"-100%",y:"-100%"},N("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(n+.5*u)*(5**(e/100)*(.4+e/100)),result:"dilate"}),N("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:p/25}),N("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:p/50}),N("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},N("feFuncR",{slope:g,type:"linear"}),N("feFuncG",{slope:g,type:"linear"}),N("feFuncB",{slope:g,type:"linear"})),N("feMerge",null,N("feMergeNode",{in:"intensityBlur"}),N("feMergeNode",{in:"intensityBrightness"}),N("feGaussianBlur",{stdDeviation:n/10})))}function Ese(t,e,i,r={}){var S;const n=[],o=[],u=++MOe,p=LOe(r.effectView,e,u);let g=null;if(p){const T=(S=r.effectView)==null?void 0:S.effects.find(R=>R.type==="bloom"),E=(T.strength?T.strength+T.radius/2:0)/3,C=e+e*E,L=i+i*E;g=[Math.max(C,10),Math.max(L,10)]}for(let T=0;T<t.length;T++){const E=t[T],C=[],L=[];let R=0,F=0,V=0;for(const H of E){const{shape:J,fill:X,stroke:te,font:oe,offset:pe}=H;r.ignoreStrokeWidth||J.type==="text"||(R+=(te==null?void 0:te.width)||0);const de=YR(X),ge=XR(te),we=J.type==="text"?Sse(J,oe):null;n.push(xse(de)),C.push(KR(J,de.fill,ge,we,r.ariaLabel)),L.push($se(J)),pe&&(F+=pe[0],V+=pe[1])}const U=MO(Tse(L),e,i,R,r.scale??!1,r.rotation,r.useRotationSize??!1,[F,V],g);let W=null;if(r.masking){const H=`mask-${T}`,J=r.masking[T];n.push(kOe(J,H)),W=`url(#${H})`}o.push(W?N("g",{mask:W},N("g",{transform:U},C)):N("g",{transform:U},C))}return r.useRotationSize&&r.rotation&&(e=yv(r.rotation,e),i=yv(r.rotation,i)),p&&(a0(g),e=g[0],i=g[1]),N("svg",{"aria-label":r.ariaLabel,focusable:!1,height:i,role:"img",style:"display: block;",width:e,xmlns:_Oe},p,N("defs",null,n),p?N("g",{filter:`url(#bloom${u})`},o):o)}const OOe=new Ce("white");function POe(t){var i,r;const e=(i=t.symbolLayers)==null?void 0:i.at(-1);if(e&&"outline"in e)return(r=e==null?void 0:e.outline)==null?void 0:r.size}function ROe(t){var e;if(!t)return 0;if(mh(t)){const i=POe(t);return i??0}return Jn((e=F3(t))==null?void 0:e.width)}function NM(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function FOe(t){var e;return((e=t.resource)==null?void 0:e.href)??""}function Ig(t,e){if(!t)return null;let i=null;return mh(t)?i=NOe(t):rM(t)&&(i=t.type==="cim"?yse(t):t.color?new Ce(t.color):null),i?N3(i,e):null}function NOe(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach(r=>{var n;r.type==="object"&&((n=r.resource)!=null&&n.href)||(i=r.type==="water"?r.color:r.material?r.material.color:null)}),i?new Ce(i):null}function N3(t,e){if(e==null||t==null)return t;const i=t.toRgba();return i[3]=i[3]*e,new Ce(i)}function DOe(t,e,i){const r=t.symbolLayers;if(!r)return;const n=o=>N3(e=e??o??(i!=null?OOe:null),i);r.forEach(o=>{var u,p;if(o.type!=="object"||!((u=o.resource)!=null&&u.href)||e)if(o.type==="water")o.color=n(o.color);else{const g=o.material!=null?o.material.color:null,w=n(g);o.material==null?o.material=new za({color:w}):o.material.color=w,i!=null&&"outline"in o&&((p=o.outline)==null?void 0:p.color)!=null&&(o.outline.color=N3(o.outline.color,i))}})}function jOe(t,e,i){var r;(e=e??t.color)&&(t.color=N3(e,i)),i!=null&&"outline"in t&&((r=t.outline)!=null&&r.color)&&(t.outline.color=N3(t.outline.color,i))}function Uk(t,e,i){t&&(e||i!=null)&&(e&&(e=new Ce(e)),mh(t)?DOe(t,e,i):rM(t)&&jOe(t,e,i))}async function VOe(t,e){const i=t.symbolLayers;i&&await dde(i,async r=>zOe(r,e))}async function zOe(t,e){switch(t.type){case"extrude":GOe(t,e);break;case"icon":case"line":case"text":UOe(t,e);break;case"path":qOe(t,e);break;case"object":await BOe(t,e)}}function UOe(t,e){const i=Ise(e);i!=null&&(t.size=i)}function Ise(t){for(const e of t)if(typeof e=="number")return e;return null}function GOe(t,e){t.size=typeof e[2]=="number"?e[2]:0}async function BOe(t,e){const{resourceSize:i,symbolSize:r}=await HOe(t),n=Mse(e,i,r);t.width=J2(e[0],r[0],i[0],n),t.depth=J2(e[1],r[1],i[1],n),t.height=J2(e[2],r[2],i[2],n)}function qOe(t,e){const i=Mse(e,PZ,[t.width,void 0,t.height]);t.width=J2(e[0],t.width,1,i),t.height=J2(e[2],t.height,1,i)}function Mse(t,e,i){for(let r=0;r<3;r++){const n=t[r];switch(n){case"symbol-value":{const o=i[r];return o!=null?o/e[r]:1}case"proportional":break;default:if(n&&e[r])return n/e[r]}}return 1}async function HOe(t){const{computeObjectLayerResourceSize:e}=await ie(()=>import("./symbolLayerUtils-2oEqaIpv.js"),[]),i=await e(t,10),{width:r,height:n,depth:o}=t,u=[r,o,n];let p=1;for(let g=0;g<3;g++){const w=u[g];if(w!=null){p=w/i[g];break}}for(let g=0;g<3;g++)u[g]==null&&(u[g]=i[g]*p);return{resourceSize:i,symbolSize:u}}function J2(t,e,i,r){switch(t){case"proportional":return i*r;case"symbol-value":return e??i;default:return t}}function WOe(t,e){const i=Ise(e);if(i!=null)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const r=t.width/t.height;r>1?(t.width=i,t.height=i*r):(t.width=i*r,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function JOe(t,e){if(t&&e)return mh(t)?VOe(t,e):void(rM(t)&&WOe(t,e))}function ZOe(t,e,i){if(t&&e!=null)if(mh(t)){const r=t.symbolLayers;r&&r.forEach(n=>{if(n&&n.type==="object")switch(i){case"tilt":n.tilt=(n.tilt??0)+e;break;case"roll":n.roll=(n.roll??0)+e;break;default:n.heading=(n.heading??0)+e}})}else rM(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=e))}function D3(t){if(!t)return null;const e=t.effects.filter(i=>i.type!=="bloom").map(i=>i.toJSON());return xE(e)}function Vtt(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}async function KOe(t,e){return await t.fetchSymbol(e)||t.fetchCIMSymbol(e)}const BG=OE();function YOe(t,e){BG.append(t,e),BG.detach(e)}function AS(t,e,i){const r=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!t.some(u=>!!u.length))return null;const o=(i==null?void 0:i.node)||document.createElement("div");return i.opacity!=null&&(o.style.opacity=i.opacity.toString()),i.effectView!=null&&(o.style.filter=D3(i.effectView)),YOe(o,()=>Ese(t,r,n,i)),o}function XOe(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const r=i.getContext("2d");return r.clearRect(0,0,t,e),r}function QOe(t,e,i){return t?nt(t,{responseType:"image"}).then(r=>{const n=r.data,o=n.width,u=n.height,p=o/u;let g=e;if(i){const w=Math.max(o,u);g=Math.min(g,w)}return{image:n,width:p<=1?Math.ceil(g*p):g,height:p<=1?g:Math.ceil(g/p)}}):Promise.reject(new re("renderUtils: imageDataSize","href not provided."))}function e7e(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function t7e(t,e,i,r,n){switch(n){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const o=lM({r:t[e],g:t[e+1],b:t[e+2]});o.h=r.h,o.s=r.s,o.v=o.v/100*r.v;const u=Xm(o);t[e]=u.r,t[e+1]=u.g,t[e+2]=u.b,t[e+3]*=i[3];break}}}function i7e(t,e,i,r,n){return QOe(t,e,n).then(o=>{const u=o.width??e,p=o.height??e;if(o.image&&e7e(i,r)){let g=o.image.width,w=o.image.height;me("edge")&&/\.svg$/i.test(t)&&(g-=1,w-=1);const S=XOe(u,p);S.drawImage(o.image,0,0,g,w,0,0,u,p);const T=S.getImageData(0,0,u,p),E=[i.r/255,i.g/255,i.b/255,i.a],C=lM(i);for(let L=0;L<T.data.length;L+=4)t7e(T.data,L,E,C,r);S.putImageData(T,0,0),t=S.canvas.toDataURL("image/png")}else{const g=rt==null?void 0:rt.findCredential(t);if(g!=null&&g.token){const w=t.includes("?")?"&":"?";t=`${t}${w}token=${g.token}`}}return{url:t,width:u,height:p}}).catch(()=>({url:t,width:e,height:e}))}const kse="esri-relationship-ramp",Mg=`${kse}--diamond`,_d=`${kse}--square`,r7e="http://www.w3.org/2000/svg",Hi={diamondContainer:`${Mg}__container`,diamondLeftCol:`${Mg}__left-column`,diamondRightCol:`${Mg}__right-column`,diamondMidCol:`${Mg}__middle-column`,diamondMidColLabel:`${Mg}__middle-column--label`,diamondMidColRamp:`${Mg}__middle-column--ramp`,squareTable:`${_d}__table`,squareTableRow:`${_d}__table-row`,squareTableCell:`${_d}__table-cell`,squareTableLabel:`${_d}__table-label`,squareTableLabelLeftBottom:`${_d}__table-label--left-bottom`,squareTableLabelRightBottom:`${_d}__table-label--right-bottom`,squareTableLabelLeftTop:`${_d}__table-label--left-top`,squareTableLabelRightTop:`${_d}__table-label--right-top`};function Cse(t,e,i={}){const{focus:r,labels:n}=t,o=!!r,u=n7e(t,e,i),p={justifyContent:"center"},g=Nm();return o?N("div",{class:Hi.diamondContainer,styles:p},N("div",{class:Hi.diamondLeftCol},g?n.right:n.left),N("div",{class:Hi.diamondMidCol},N("div",{class:Hi.diamondMidColLabel},n.top),u,N("div",{class:Hi.diamondMidColLabel},n.bottom)),N("div",{class:Hi.diamondRightCol},g?n.left:n.right)):N("div",{class:Hi.squareTable},N("div",{class:Hi.squareTableRow},N("div",{class:Uu(Hi.squareTableCell,Hi.squareTableLabel,Hi.squareTableLabelRightBottom)},g?n.top:n.left),N("div",{class:Hi.squareTableCell}),N("div",{class:Uu(Hi.squareTableCell,Hi.squareTableLabel,Hi.squareTableLabelLeftBottom)},g?n.left:n.top)),N("div",{class:Hi.squareTableRow},N("div",{class:Hi.squareTableCell}),u,N("div",{class:Hi.squareTableCell})),N("div",{class:Hi.squareTableRow},N("div",{class:Uu(Hi.squareTableCell,Hi.squareTableLabel,Hi.squareTableLabelRightTop)},g?n.right:n.bottom),N("div",{class:Hi.squareTableCell}),N("div",{class:Uu(Hi.squareTableCell,Hi.squareTableLabel,Hi.squareTableLabelLeftTop)},g?n.bottom:n.right)))}function qG(t,e,i){const r=`${i}_arrowStart`,n=`${i}_arrowEnd`,o=t==="left",u={markerStart:null,markerEnd:null};switch(e){case"HL":o?u.markerStart=`url(#${n})`:u.markerEnd=`url(#${r})`;break;case"LL":u.markerStart=`url(#${n})`;break;case"LH":o?u.markerEnd=`url(#${r})`:u.markerStart=`url(#${n})`;break;default:u.markerEnd=`url(#${r})`}return u}function n7e(t,e,i={}){const{focus:r,numClasses:n,colors:o,rotation:u}=t,{opacity:p,effectList:g,ariaLabel:w}=i,S=i.size??60,T=!!r,E=Math.sqrt(S**2+S**2)+(T?0:5),C=[],L=[],R=[],F=(S||75)/n;for(let we=0;we<n;we++){const ke=we*F;for(let $e=0;$e<n;$e++){const Fe=$e*F,yt=YR(o[we][$e]),qe=XR(null),Ue={type:"rect",x:Fe,y:ke,width:F,height:F},ei=xse(yt);ei&&C.push(ei);const jr=KR(Ue,yt.fill,qe,null);jr&&L.push(jr),R.push($se(Ue))}}const V=10,U=15,W=15,H=10;let J=null;T||(J="margin: -15px -15px -18px -15px");const X=qG("left",r,e),te=qG("right",r,e),oe=Tse(R),pe=MO(oe,E,E,0,!1,u,!1),de=MO(oe,E,E,0,!1,T?-45:null,!1),ge={filter:D3(g)??void 0,opacity:p==null?"":`${p}`};return N("div",{class:T?Hi.diamondMidColRamp:Hi.squareTableCell,styles:ge},N("svg",{"aria-label":w,focusable:!1,height:E,role:"image",style:J,width:E,xmlns:r7e},N("defs",null,N("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},N("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),N("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},N("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),C),N("g",{transform:pe},L),N("g",{transform:de},N("line",{fill:"none","marker-end":X.markerEnd,"marker-start":X.markerStart,stroke:"#555555","stroke-width":"1",x1:-V,x2:-V,y1:S-U,y2:U}),N("line",{fill:"none","marker-end":te.markerEnd,"marker-start":te.markerStart,stroke:"#555555","stroke-width":"1",x1:W,x2:S-W,y1:S+H,y2:S+H}))))}function s7e(t){return t=t||globalThis.location.hostname,o7e.some(e=>(t==null?void 0:t.match(e))!=null)}function HG(t,e){return t&&(e=e||globalThis.location.hostname)?e.match(Ase)!=null||e.match(Ose)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(Lse)!=null||e.match(Pse)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t}const Ase=/^devext\.arcgis\.com$/,Lse=/^qaext\.arcgis\.com$/,Ose=/^[\w-]*\.mapsdevext\.arcgis\.com$/,Pse=/^[\w-]*\.mapsqa\.arcgis\.com$/,o7e=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,Ase,Lse,/^jsapps\.esri\.com$/,Ose,Pse];function Rse(t,e,i,r){const n=t.name;return n==null?Promise.reject(new re("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?a7e(n,e,r):wee(t,e,r).then(o=>Nse(o,n,e,i,z2e,r))}function Fse(t,e){return e.items.find(i=>i.name===t)}function Nse(t,e,i,r,n,o){var C,L;const u=(i==null?void 0:i.portal)!=null?i.portal:wr.getDefault(),p={portal:u,url:Zr(t.baseUrl),origin:"portal-item"},g=Fse(e,t.data);if(!g){const R=`The symbol name '${e}' could not be found`;return Promise.reject(new re("symbolstyleutils:symbol-name-not-found",R,{symbolName:e}))}let w=t0(n(g,r),p),S=((C=g.thumbnail)==null?void 0:C.href)??null;const T=(L=g.thumbnail)==null?void 0:L.imageData;s7e()&&(w=HG(w)??"",S=HG(S));const E={portal:u,url:Zr(iP(w)),origin:"portal-item"};return R8(w,o).then(R=>{const F=r==="cimRef"?_ee(R.data):R.data,V=CQ(F,E);if(V&&mh(V)){if(S){const U=t0(S,p);V.thumbnail=new hm({url:U})}else T&&(V.thumbnail=new hm({url:`data:image/png;base64,${T}`}));t.styleUrl?V.styleOrigin=new m3({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(V.styleOrigin=new m3({portal:i.portal,styleName:t.styleName,name:e}))}return V})}function a7e(t,e,i){const r=U2e.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:wr.getDefault();return R8(r,i).then(o=>{const u=_ee(o.data);return CQ(u,{portal:n,url:Zr(iP(r)),origin:"portal-item"})})}const l7e=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:Nse,getStyleItemFromStyle:Fse,resolveWebStyleSymbol:Rse},Symbol.toStringTag,{value:"Module"})),Ky=Ln.size,c5=Ln.maxSize,QR=Ln.maxOutlineSize,WG=Ln.lineWidth,kO=Ln.tallSymbolWidth;function mv(t){const e=t.outline,i=t.material!=null?t.material.color:null,r=i!=null?i.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&r==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const n=Zi(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(n,QR),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?ZR(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function u7e(t,e){var r,n,o;if((r=t.thumbnail)!=null&&r.url)return t.thumbnail.url;if(e.type==="icon"&&((n=e==null?void 0:e.resource)==null?void 0:n.href))return FOe(e);const i=qt("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const u=await Rse(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch(()=>null);if(u&&"thumbnail"in u&&((o=u.thumbnail)!=null&&o.url))return u.thumbnail.url}return i}function Gk(t,e=1){const i=t.a,r=lM(t),n=r.h,o=r.s/e,u=100-(100-r.v)/e,{r:p,g,b:w}=Xm({h:n,s:o,v:u});return[p,g,w,i]}function QE(t){var e;return t.type==="water"?t.color==null?null:t.color:((e=t.material)==null?void 0:e.color)==null?null:t.material.color}function li(t,e=0){const i=QE(t);if(!i){if(t.type==="fill")return null;const n=hOe.r,o=Zf(n,e);return[o,o,o,100]}const r=i.toRgba();for(let n=0;n<3;n++)r[n]=Zf(r[n],e);return r}async function Dse(t,e){const i=t.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await cOe(qt(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function JG(t){return t.outline?mv(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function eF(t,e){const i=QE(t);if(!i)return null;let r="rgba(";return r+=Zf(i.r,e)+",",r+=Zf(i.g,e)+",",r+=Zf(i.b,e)+",",r+i.a+");"}function CO(t,e){const i=eF(t,e);return i?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:i,width:Math.min(t.size?Zi(t.size):.75,QR),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?ZR(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?Zi(2):t.join:null}:{}}function p$(t,e,i){const r=i!=null?.75*i:0;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function c7e(t){const e=t.depth,i=t.height,r=t.width;return r!==0&&e!==0&&i!==0&&r===e&&r!=null&&i!=null&&r<i}function h7e(t,e,i){var n,o;const r=[];if(!t)return r;switch(t.type){case"icon":{const g=e,w=e;switch(((n=t.resource)==null?void 0:n.primitive)??Dbe){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:li(t,0),stroke:mv(t)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[0,0]},{command:"L",values:[g,0]},{command:"L",values:[g,w]},{command:"Z",values:[]}]},fill:li(t,0),stroke:mv(t)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[.5*g,0]},{command:"L",values:[g,w]},{command:"Z",values:[]}]},fill:li(t,0),stroke:mv(t)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*g,0]},{command:"L",values:[.5*g,w]},{command:"M",values:[0,.5*w]},{command:"L",values:[g,.5*w]}]},stroke:JG(t)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[g,w]},{command:"M",values:[g,0]},{command:"L",values:[0,w]}]},stroke:JG(t)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[.5*g,0]},{command:"L",values:[g,.5*w]},{command:"L",values:[.5*g,w]},{command:"Z",values:[]}]},fill:li(t,0),stroke:mv(t)})}break}case"object":switch(((o=t.resource)==null?void 0:o.primitive)??Ube){case"cone":{const u=p$(li(t,0),li(t,-.6),i?kO:e),p=gOe(e,i);r.push({shape:p[0],fill:u},{shape:p[1],fill:u});break}case"inverted-cone":{const u=li(t,0),p=p$(u,li(t,-.6),e),g=vOe(e);r.push({shape:g[0],fill:p},{shape:g[1],fill:u});break}case"cube":{const u=yOe(e,i);r.push({shape:u[0],fill:li(t,0)},{shape:u[1],fill:li(t,-.3)},{shape:u[2],fill:li(t,-.5)});break}case"cylinder":{const u=p$(li(t,0),li(t,-.6),i?kO:e),p=mOe(e,i);r.push({shape:p[0],fill:u},{shape:p[1],fill:u},{shape:p[2],fill:li(t,0)});break}case"diamond":{const u=bOe(e);r.push({shape:u[0],fill:li(t,-.3)},{shape:u[1],fill:li(t,0)},{shape:u[2],fill:li(t,-.3)},{shape:u[3],fill:li(t,-.7)});break}case"sphere":{const u=p$(li(t,0),li(t,-.6));u.x1=0,u.y1=0,u.x2=.25*e,u.y2=.25*e,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:u});break}case"tetrahedron":{const u=wOe(e);r.push({shape:u[0],fill:li(t,-.3)},{shape:u[1],fill:li(t,0)},{shape:u[2],fill:li(t,-.6)});break}}break}return r}function DM(t){const e=typeof(t==null?void 0:t.size)=="number"?t==null?void 0:t.size:null;return e?Zi(e):null}function p7e(t){return t.type==="icon"?"multiply":"tint"}async function d7e(t,e){const i=DM(e),r=e!=null&&e.maxSize?Zi(e.maxSize):null,n=(e==null?void 0:e.disableUpsampling)??!1,o=t.symbolLayers,u=[];let p=0,g=0;const w=o.at(-1);let S;w&&w.type==="icon"&&(S=w.size&&Zi(w.size)),o.forEach(C=>{var F,V;if(C.type!=="icon"&&C.type!=="object")return;const L=C.type==="icon"?C.size&&Zi(C.size):0,R=i||L?Math.ceil(Math.min(i||L,r||c5)):Ky;if((F=C==null?void 0:C.resource)!=null&&F.href){const U=u7e(t,C).then(W=>{var X;const H=(X=C==null?void 0:C.material)==null?void 0:X.color,J=p7e(C);return i7e(W,R,H,J,n)}).then(W=>{const H=W.width,J=W.height;return p=Math.max(p,H),g=Math.max(g,J),[{shape:{type:"image",x:0,y:0,width:H,height:J,src:W.url},fill:null,stroke:null}]});u.push(U)}else{let U=R;C.type==="icon"&&S&&i&&(U=R*(L/S));const W=(e==null?void 0:e.symbolConfig)==="tall"||((V=e==null?void 0:e.symbolConfig)==null?void 0:V.isTall)||C.type==="object"&&c7e(C);p=Math.max(p,W?kO:U),g=Math.max(g,U),u.push(Promise.resolve(h7e(C,U,W)))}});const T=await Promise.allSettled(u),E=[];return T.forEach(C=>{C.status==="fulfilled"?E.push(C.value):C.reason&&fe.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",C.reason)}),AS(E,[p,g],{node:e==null?void 0:e.node,scale:!1,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function f7e(t,e){const i=t.symbolLayers,r=[],n=NM(t),o=DM(e),u=(e!=null&&e.maxSize?Zi(e.maxSize):null)||QR;let p,g=0,w=0;return i.forEach((S,T)=>{if(!S||S.type!=="line"&&S.type!=="path")return;const E=[];switch(S.type){case"line":{const C=CO(S,0);if(C==null)break;const L=(C==null?void 0:C.width)||0;T===0&&(p=L);const R=Math.min(o||L,u),F=T===0?R:o?R*(L/p):R,V=F>WG/2?2*F:WG;w=Math.max(w,F),g=Math.max(g,V),C.width=F,E.push({shape:{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[g,.5*w]}]},stroke:C});break}case"path":{const C=Math.min(o||Ky,u),L=li(S,0),R=li(S,-.2),F=eF(S,-.4),V=F?{color:F,width:1}:{};if(S.profile==="quad"){const U=S.width,W=S.height,H=pOe(U&&W?U/W:1,W===0,U===0),J={...V,join:"bevel"};E.push({shape:H[0],fill:R,stroke:J},{shape:H[1],fill:R,stroke:J},{shape:H[2],fill:L,stroke:J})}else E.push({shape:W2.pathSymbol3DLayer[0],fill:R,stroke:V},{shape:W2.pathSymbol3DLayer[1],fill:L,stroke:V});w=Math.max(w,C),g=w}}r.push(E)}),Promise.resolve(AS(r,[g,w],{node:e==null?void 0:e.node,scale:n,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel}))}async function y7e(t,e){const i=t.type==="mesh-3d",r=t.symbolLayers,n=DM(e),o=e!=null&&e.maxSize?Zi(e.maxSize):null,u=n||Ky,p=[];let g=0,w=0,S=!1;for(let T=0;T<r.length;T++){const E=r.at(T),C=[];if(!i||E.type==="fill"){switch(E.type){case"fill":{const L=Math.min(u,o||c5);if(g=Math.max(g,L),w=Math.max(w,L),S=!0,i){const R=W2.meshSymbol3DFill,F=eF(E,-.4),V=F?{color:F,width:1,join:"round"}:{};C.push({shape:R[0],fill:li(E,0),stroke:V},{shape:R[1],fill:li(E,-.2),stroke:V},{shape:R[2],fill:li(E,-.6),stroke:V})}else{let R=li(E,0);const F="pattern"in E?E.pattern:null,V=mv(E),U=QE(E);F!=null&&F.type==="style"&&F.style!=="solid"&&U&&(R=await Dse(F,U)),C.push({shape:W2.fill[0],fill:R,stroke:V})}break}case"line":{const L=CO(E,0);if(L==null)break;const R={stroke:L,shape:W2.fill[0]};g=Math.max(g,Ky),w=Math.max(w,Ky),C.push(R);break}case"extrude":{const L={join:"round",width:1,...CO(E,-.4)},R=li(E,0),F=li(E,-.2),V=Math.min(u,o||c5),U=dOe(V);L.width=1,C.push({shape:U[0],fill:F,stroke:L},{shape:U[1],fill:F,stroke:L},{shape:U[2],fill:R,stroke:L});const W=Ky,H=.7*Ky+.5*V;g=Math.max(g,W),w=Math.max(w,H);break}case"water":{const L=QE(E),R=Gk(L),F=Gk(L,2),V=Gk(L,3),U=fOe();S=!0,C.push({shape:U[0],fill:R},{shape:U[1],fill:F},{shape:U[2],fill:V});const W=Math.min(u,o||c5);g=Math.max(g,W),w=Math.max(w,W);break}}p.push(C)}}return AS(p,[g,w],{node:e==null?void 0:e.node,scale:S,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function m7e(t,e){if(t.symbolLayers.length===0)return Promise.reject(new re("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return d7e(t,e);case"line-3d":return f7e(t,e);case"polygon-3d":case"mesh-3d":return y7e(t,e)}return Promise.reject(new re("symbolPreview: swatchInfo3D","symbol not supported."))}const g7e=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:Dse,getSizeFromOptions:DM,getSymbolLayerFill:li,previewSymbol3D:m7e},Symbol.toStringTag,{value:"Module"})),ZG={HH:315,HL:45,LL:135,LH:225},v7e={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function b7e(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return li(t.symbolLayers.at(0));if(e==="simple-line"){const i=F3(t);return i&&i.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const i=F3(t);return i&&i.color}return uOe(t)}function w7e(t,e){const i=e.HH.label,r=e.LL.label,n=e.HL.label,o=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:r,left:n,right:o};case"HL":return{top:n,bottom:o,left:r,right:i};case"LL":return{top:r,bottom:i,left:o,right:n};case"LH":return{top:o,bottom:n,left:i,right:r}}}function _7e(t){const{focus:e,infos:i,numClasses:r}=t,n=v7e[r],o={};i.forEach(p=>{o[p.value]={label:p.label,fill:b7e(p.symbol)}});const u=[];for(let p=0;p<r;p++){const g=[];for(let w=0;w<r;w++){const S=o[n[p][w]];g.push(S.fill)}u.push(g)}return{type:"relationship-ramp",numClasses:r,focus:e,colors:u,labels:w7e(e,o),rotation:jse(e)}}function jse(t){let e=ZG[t];return t&&e==null&&(e=ZG.HH),e||0}let kg=null;const KG=[255,255,255];function YG(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function S7e(t,e,i){const{backgroundColor:r,outline:n,dotSize:o}=t,u=(i==null?void 0:i.swatchSize)||Ln.size,p=.8,g=Math.round(u*u/Math.max(o,.5)**2*p),w=window.devicePixelRatio,S=document.createElement("canvas"),T=u*w;S.width=T,S.height=T,S.style.width=S.width/w+"px",S.style.height=S.height/w+"px";const E=S.getContext("2d");if(r&&(E.fillStyle=r.toCss(!0),E.fillRect(0,0,T,T),E.fill()),E.fillStyle=(e==null?void 0:e.toCss(!0))??"",kg&&kg.length/2===g)for(let L=0;L<2*g;L+=2){const R=kg[L],F=kg[L+1];E.fillRect(R,F,o*w,o*w),E.fill()}else{kg=[];for(let L=0;L<2*g;L+=2){const R=YG(0,T),F=YG(0,T);kg.push(R,F),E.fillRect(R,F,o*w,o*w),E.fill()}}n&&(n.color&&(E.strokeStyle=n.color.toCss(!0)),E.lineWidth=n.width,E.strokeRect(0,0,T,T));const C=new Image(u,u);return C.src=S.toDataURL(),C.ariaLabel=(i==null?void 0:i.ariaLabel)??null,C.alt=(i==null?void 0:i.ariaLabel)??"",C}function x7e(t,e={}){const i=e.radius||40,r=2*Math.PI*i,n=t.length,o=r/n,u=[],p=F3(e.outline);(p==null?void 0:p.width)!=null&&(p.width*=2),(p||e.backgroundColor)&&u.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:p,offset:[0,0]});const g=e.values,w=g&&g.length===n&&g.reduce((L,R)=>L+R,0)===100,S=[0];for(let L=0;L<n;L++){let R=null;w&&(R=g[L]*r/100,S.push(R+S[L])),u.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(R??o)/2} ${r}`,dashoffset:"-"+(w?S[L]/2:L*(o/2)),color:t[L]},offset:[0,0]})}let T=null;const E=2*i+((p==null?void 0:p.width)||0),C=e.holePercentage;if(C){p&&u.push({shape:{type:"circle",cx:i,cy:i,r:i*C},fill:null,stroke:p,offset:[0,0]});const L=E/2;T=[[{shape:{type:"circle",cx:L,cy:L,r:L},fill:KG,stroke:p?{...p,color:KG}:null,offset:[0,0]},{shape:{type:"circle",cx:L,cy:L,r:i*C},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return AS([u],[E,E],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:T,rotation:-90,ariaLabel:e.ariaLabel})}function Ay(t,e={}){const n=e.align==="horizontal",o=n?75:24,u=n?24:75,p=e.width??o,g=e.height??u,w=e.gradient??!0,S=window.devicePixelRatio,T=p*S,E=g*S,C=document.createElement("canvas");C.width=T,C.height=E,C.ariaLabel=e.ariaLabel??null,C.style.width=`${p}px`,C.style.height=`${g}px`;const L=C.getContext("2d"),R=n?T:0,F=n?0:E;if(w){const U=L.createLinearGradient(0,0,R,F),W=t.length,H=W===1?0:1/(W-1);t.forEach((J,X)=>U.addColorStop(X*H,J.toString())),L.fillStyle=U,L.fillRect(0,0,T,E)}else{const U=n?T/t.length:T,W=n?E:E/t.length;let H=0,J=0;for(const X of t)L.fillStyle=X.toString(),L.fillRect(H,J,U,W),H=n?H+U:0,J=n?0:J+W}const V=document.createElement("div");return V.style.width=`${p}px`,V.style.height=`${g}px`,$7e(V,e==null?void 0:e.effectList),V.appendChild(C),V}function $7e(t,e){if(!e)return;t.style.filter=D3(e);const i=e.effects;if(i){for(const r of i)if((r==null?void 0:r.type)==="drop-shadow"){r.offsetX<0?t.style.marginLeft=`${Math.abs(r.offsetX)}px`:t.style.marginRight=`${r.offsetX}px`;break}}}async function tF(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await ie(()=>import("./previewWebStyleSymbol-DJmNax-u.js"),[]);return i(t,tF,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await ie(()=>Promise.resolve().then(()=>g7e),void 0);return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await ie(()=>import("./previewSymbol2D-DsmaHFZP.js"),__vite__mapDeps([295,81]));return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await ie(()=>import("./previewCIMSymbol-BoCrdrpL.js"),__vite__mapDeps([296,79,80,81,14,82,69,83,75,297,157,158]));return i(t,e)}default:return}}function Vse(t){return t&&"opacity"in t?t.opacity*Vse(t.parent):1}async function AO(t,e){var W;if(!t)return;const i=t.sourceLayer,r=(e!=null&&e.useSourceLayer?i:t.layer)??i,n=Vse(r);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const H=t.symbol.type==="web-style"?await KOe(t.symbol,{...e,cache:e!=null?e.webStyleCache:null}):t.symbol.clone();return Uk(H,null,n),H}const o=(e==null?void 0:e.renderer)??T7e(r);let u=o&&"getSymbolAsync"in o?await o.getSymbolAsync(t,e):null;if(!u)return;if(u=u.type==="web-style"?await u.fetchSymbol({...e,cache:e!=null?e.webStyleCache:null}):u.clone(),!o||!("visualVariables"in o)||!((W=o.visualVariables)!=null&&W.length))return Uk(u,null,n),u;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&(e==null?void 0:e.arcade)==null){const H={...e};H.arcade=await fh(),e=H}const{getColor:p,getOpacity:g,getAllSizes:w,getRotationAngle:S}=await ie(()=>Promise.resolve().then(()=>Ym),void 0),T=[],E=[],C=[],L=[];for(const H of o.visualVariables)switch(H.type){case"color":T.push(H);break;case"opacity":E.push(H);break;case"rotation":L.push(H);break;case"size":H.target||C.push(H)}const R=!!T.length&&T[T.length-1],F=R?p(R,t,e):null,V=!!E.length&&E[E.length-1];let U=V?g(V,t,e):null;if(n!=null&&(U=U!=null?U*n:n),Uk(u,F,U),C.length){const H=w(C,t,e);await JOe(u,H)}for(const H of L)ZOe(u,S(H,t,e),H.axis);return u}function T7e(t){if(t)return"renderer"in t?t.renderer:void 0}var LO;let Tu=LO=class extends Te{constructor(t){super(t),this._activeFetchInfo={id:null,request:null},this.disabled=!1,this.layer=null,this.template=null,this.thumbnail=null}initialize(){this.addHandles(ce(()=>{const{layer:t}=this;return[t&&"renderer"in t?t.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null,this._activeFetchInfo.request=null,this._set("thumbnail",null)},Qe))}get description(){var t;return(t=this.template)==null?void 0:t.description}set description(t){this.template&&(this.template.description=t)}get label(){var t;return(t=this.template)==null?void 0:t.name}set label(t){this.template&&(this.template.name=t)}get id(){var t;return`${this.label??""}â€“${(t=this.layer)==null?void 0:t.id}`}get supportsUpload(){var t;return((t=this.layer)==null?void 0:t.type)==="scene"}clone(){const t=this.thumbnail!=null?this.thumbnail.cloneNode(!0):null,e=new LO({layer:this.layer,template:this.template});return e._set("thumbnail",t),e}static async fetchThumbnail(t,e){var n;const i=await E7e(t,e);if(i==null)return null;const r={maxSize:36};return((n=t.renderer)==null?void 0:n.type)==="dictionary"&&(r.fieldMap=t.renderer.fieldMap??void 0,r.feature={attributes:e.prototype.attributes??{}}),await tF(i,r)}};m([b()],Tu.prototype,"description",null),m([b()],Tu.prototype,"disabled",void 0),m([b()],Tu.prototype,"label",null),m([b()],Tu.prototype,"layer",void 0),m([b()],Tu.prototype,"template",void 0),m([b({readOnly:!0})],Tu.prototype,"thumbnail",void 0),m([b()],Tu.prototype,"id",null),m([b()],Tu.prototype,"supportsUpload",null),Tu=LO=m([G("esri.widgets.FeatureTemplates.TemplateItem")],Tu);const OO=Tu;async function E7e(t,e){const{renderer:i}=t;if(i){const r=new Cr({attributes:e.prototype.attributes}),n=await i.getSymbolAsync(r);if(n)return n}return I7e(t)}async function I7e(t){const{geometryType:e}=t,i=e==="point"||e==="multipoint"?await ie(()=>Promise.resolve().then(()=>Ybe),void 0):e==="polyline"?await ie(()=>Promise.resolve().then(()=>vbe),void 0):e==="polygon"||e==="mesh"||e==="multipatch"?await ie(()=>Promise.resolve().then(()=>Kbe),void 0):null;return i?new i.default:null}let G1=class extends nc(Te){constructor(e){super(e),this.items=null,this.label=null}get id(){return this.label}findByTemplate(e){return this.items.find(i=>i.template===e)}};m([b()],G1.prototype,"items",void 0),m([b()],G1.prototype,"label",void 0),m([b()],G1.prototype,"id",null),G1=m([G("esri.widgets.FeatureTemplates.TemplateItemGroup")],G1);const M7e=G1,eI=t=>t==null||typeof t!="object"?[]:[..."templates"in t&&Array.isArray(t.templates)?t.templates:[],..."types"in t&&Array.isArray(t.types)?t.types.flatMap(e=>e.templates):[]];var t2;const k7e=({layer:t})=>({key:t,label:t.title??""}),C7e=({layer:t})=>({key:t.geometryType,label:t.geometryType??""});let Ds=t2=class extends Ar.EventedAccessor{constructor(t){super(t),this._groupPool=new Hp(M7e),this._itemPool=new Hp(OO),this.disabled=!1,this.disabledItemFunction=null,this.filterFunction=null,this.selectedItem=null}initialize(){this._get("groupBy")||(this.groupBy="layer")}get _featureTemplatesByLayer(){if(!this.layers)return new Map;const t=new Map;for(const e of this.layers)if(e.type==="subtype-group")for(const i of e.sublayers)t.set(i,eI(i));else t.set(e,eI(e));return t}set groupBy(t){if(this._set("groupBy",t),typeof t!="function")switch(t){case"layer":this._groupByFunction=k7e;break;case"geometry":this._groupByFunction=C7e;break;default:this._groupByFunction=null}else this._groupByFunction=e=>this._ensureGroupByObject(t(e))}set layers(t){const e="layers";if(this.removeHandles(e),t){const i=()=>this.notifyChange("state");this.addHandles(t.map(r=>Fr(()=>r.loadStatus,i)),e)}this._set("layers",t)}get layers(){return this._get("layers")}get state(){const{layers:t}=this;return t&&t.length!==0?t.some(e=>e.loadStatus==="loading"||e.loadStatus==="not-loaded")?"loading":"ready":"disabled"}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((t,e)=>t+e.length,0)}get items(){var o,u,p;if(this.numberOfFeatureTemplates===0)return this._releasePreviousItems(),[];const t=this._featureTemplatesByLayer,e=[],i=this.filterFunction!=null?this.filterFunction:t2._nullFilterFunction;for(const[g,w]of t)if(g.loaded||g.type==="subtype-sublayer"&&((o=g.parent)!=null&&o.loaded)){const S=(u=Cm(g))==null?void 0:u.operations;if(S!=null&&S.supportsEditing&&(S!=null&&S.supportsAdd))for(const T of w)e.push({layer:g,template:T,matchesFilter:i({label:T.name})})}if(this._groupByFunction==null){const g=e.filter(({matchesFilter:w})=>w).map(({template:w,layer:S})=>this._createItem(w,S));return this._releasePreviousItems(),g}const r=new Map;for(const g of e){const{template:w,layer:S}=g,T=this._groupByFunction({template:w,layer:S}),{key:E,label:C}=T.key!=null?T:t2.nullGroupBy;r.has(E)||r.set(E,{label:C,templateItemInfos:[]}),(p=r.get(E))==null||p.templateItemInfos.push(g)}const n=[];for(const g of r.values()){const{label:w,templateItemInfos:S}=g,T=S.filter(({matchesFilter:C})=>C),E=i({label:w})?S:S.length>0?T:[];if(E.length>0){const C=E.map(({template:L,layer:R})=>this._createItem(L,R));n.push(this._createGroup(w,C))}}return n.length===1&&n[0].label===t2.nullGroupBy.label?(this._releasePreviousItems(),n[0].items):(this._releasePreviousItems(),n)}refresh(){this.notifyChange("items")}select(t,{emit:e=!0}={}){const i=this.selectedItem,r=(t==null?void 0:t.clone())||null;this._set("selectedItem",r),e&&this.emit("select",{item:r,oldItem:i,template:(r==null?void 0:r.template)??null})}_createItem(t,e){var n;const i=this._itemPool.acquire(),r=((n=this.disabledItemFunction)==null?void 0:n.call(this,{template:t,layer:e}))??!1;return i.set({disabled:r,layer:e,template:t}),i}_createGroup(t,e){const i=this._groupPool.acquire();return i.set("label",t),i.items=e,i}_releasePreviousItems(){this._destroyItems(this._get("items"))}_destroyItems(t){t&&(t[0]instanceof OO?t.forEach(e=>this._destroyItem(e)):t.forEach(e=>this._destroyGroup(e)))}_destroyGroup(t){t.items.forEach(e=>this._destroyItem(e)),t.items.length=0,this._groupPool.release(t)}_destroyItem(t){t.layer=null,t.template=null,this._itemPool.release(t)}_ensureGroupByObject(t){return typeof t=="string"?{key:t,label:t}:t}};Ds.nullGroupBy={key:Symbol(),label:"Otherâ€‹"},Ds._nullFilterFunction=t=>!0,m([b()],Ds.prototype,"_featureTemplatesByLayer",null),m([b()],Ds.prototype,"_groupByFunction",void 0),m([b()],Ds.prototype,"disabled",void 0),m([b()],Ds.prototype,"disabledItemFunction",void 0),m([b()],Ds.prototype,"filterFunction",void 0),m([b()],Ds.prototype,"groupBy",null),m([b()],Ds.prototype,"layers",null),m([b()],Ds.prototype,"state",null),m([b({readOnly:!0})],Ds.prototype,"numberOfFeatureTemplates",null),m([b({readOnly:!0})],Ds.prototype,"items",null),m([b({readOnly:!0})],Ds.prototype,"selectedItem",void 0),Ds=t2=m([G("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],Ds);const PO=Ds,hf="esri-item-list",d$=`${hf}__list-item`,sh={base:hf,filterContainerSticky:`${hf}__filter-container--sticky`,group:`${hf}__group`,groupHeader:`${hf}__group__header`,item:d$,itemDisabled:`${d$}--disabled`,itemIcon:`${d$}-icon`,itemContentEnd:`${d$}-content-end`,noMatchesMessage:`${hf}__no-matches-message`,scroller:`${hf}__scroller`,scrollerEnabled:`${hf}__scroller--enabled`},A7e=4;function zse(t){const{disabled:e,filterText:i="",id:r,messages:n,onFilterChange:o,...u}=t;return N("div",{key:r},t.filterEnabled??1?P7e({disabled:e,filterText:i,id:r,messages:n,onFilterChange:o}):null,O7e({...u,disabled:e,enableListScroll:t.enableListScroll??!0,filterText:i,messages:n}))}function L7e(t){return!!t.items}function O7e(t){const{headingLevel:e,items:i,...r}=t;return i.length===0?N("div",{class:sh.noMatchesMessage,key:"no-matches"},t.messages.noMatches):N("div",{class:Uu({[sh.scroller]:!0,[sh.scrollerEnabled]:!!t.enableListScroll}),key:"item-container"},i.map(n=>L7e(n)?R7e({...r,group:n,headingLevel:e}):iF({...r,grouped:!0,item:n})))}function P7e(t){const{disabled:e,messages:i,filterText:r,enableListScroll:n}=t;return N("div",{class:n?void 0:sh.filterContainerSticky,key:"filter"},N("calcite-input",{disabled:e,placeholder:i.filterPlaceholder,type:"search",value:r,onCalciteInputInput:o=>{const u=o.currentTarget;t.onFilterChange&&t.onFilterChange(u.value)}}))}function iF(t){const{disabled:e,grouped:i,identify:r,item:n,onItemMouseEnter:o,onItemMouseLeave:u,onItemSelect:p,renderIcon:g,renderCustomItem:w,renderItemContent:S,renderItemContentEnd:T,renderItemLabel:E,renderItemDescription:C,selectedItem:L}=t,R=XG(n,r),F=R===XG(L,r),V=w==null?void 0:w(t);if(V)return V;const U=S==null?void 0:S(n),W=T==null?void 0:T(n),H=!(!n.disabled&&!e);return N("calcite-list-item",{afterUpdate:J=>{J.selected=F},"aria-level":i?"2":"",class:Uu({[sh.item]:!0,[sh.itemDisabled]:H}),"data-item":n,description:U?void 0:(C==null?void 0:C(n))??void 0,disabled:H,key:R,label:U?void 0:(E==null?void 0:E(n))??n.label??void 0,onmouseenter:J=>o==null?void 0:o(Bk(J)),onmouseleave:J=>u==null?void 0:u(Bk(J)),selected:F,tabIndex:H?-1:0,onCalciteListItemSelect:J=>{J.preventDefault(),p==null||p(Bk(J))}},N("div",{class:sh.itemIcon,key:"content-start",slot:"content-start"},g==null?void 0:g(n)),U?N("div",{key:"content",slot:"content"},U):null,W?N("div",{class:sh.itemContentEnd,key:"content-end",slot:"content-end"},W):null)}function XG(t,e){return t?`${(e==null?void 0:e(t))||t.id}__${t.label}`:""}function Bk(t){return t.currentTarget["data-item"]}function R7e(t){const{disabled:e,group:i,headingLevel:r=A7e,selectionMode:n="none",renderCustomGroupContent:o,...u}=t,p=o==null?void 0:o(t);return N("div",{class:sh.group,key:i.label??void 0},N(jl,{class:sh.groupHeader,level:r},i.label),p||N("calcite-list",{disabled:e,selectionAppearance:"border",selectionMode:n},i.items.map(g=>iF({...u,disabled:e,item:g,grouped:!0}))))}let h5=class extends Te{constructor(e){super(e),this.filter=!0}};m([b({type:Boolean,nonNullable:!0})],h5.prototype,"filter",void 0),h5=m([G("esri.widgets.FeatureTemplates.VisibleElements")],h5);const Use=h5,F7e={base:"esri-feature-templates"};function N7e(t){return t.length>0&&rse(t[0])}function D7e(t){return t.id}let Tr=class extends vi{constructor(e,i){super(e,i),this.enableListScroll=!0,this.filterText="",this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.selectionMode="none",this.viewModel=new PO,this.visibleElements=new Use,this.renderCustomItem=r=>null,this.renderCustomGroupContent=r=>null,this.renderItemLabel=()=>null,this.renderItemDescription=()=>null,this.renderItemContent=r=>null,this.renderItemContentEnd=r=>null,this._iconIntersectionObserver=new IntersectionObserver((r,n)=>{r.forEach(async o=>{if(o.isIntersecting){const u=o.target;if(V7e(u))return void n.unobserve(u);const p=j7e(u),{layer:g,template:w}=p;QG(u,!0);const S=await OO.fetchThumbnail(g,w).catch(()=>(QG(u,!1),null));if(S==null)return;u.appendChild(S)}})}),this._renderItemIcon=r=>um(r.layer)?N("span",{"data-has-icon":!0,"data-item":r,key:"icon"},N("calcite-icon",{icon:"table"})):N("span",{afterCreate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":r,key:"icon"}),this._afterItemCreateOrUpdate=r=>{var n;(n=this._iconIntersectionObserver)==null||n.observe(r)},this._afterItemRemoved=r=>{var n;(n=this._iconIntersectionObserver)==null||n.unobserve(r)}}initialize(){const e=({label:i})=>!this.filterText||!!(i!=null&&i.toLowerCase().includes(this.filterText.toLowerCase()));this.addHandles(ce(()=>this.viewModel,(i,r)=>{i&&!i.filterFunction&&(this.filterFunction=e),r&&r!==i&&r.filterFunction===e&&(r.filterFunction=null)},Qe))}destroy(){var e;(e=this._iconIntersectionObserver)==null||e.disconnect(),this._iconIntersectionObserver=null}loadDependencies(){return zi({icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227])),input:()=>ie(()=>import("./calcite-input-Dl0Mk_X_.js"),__vite__mapDeps([251,252,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),notice:()=>ie(()=>import("./calcite-notice-mqUu1NoI.js"),__vite__mapDeps([266,267,227,220,224,225,226,228,247,223,229]))})}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(e){this.viewModel.filterFunction=e}get groupBy(){return this.viewModel.groupBy}set groupBy(e){this.viewModel.groupBy=e}get icon(){return"list-rectangle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}get selectedItem(){return this.viewModel.selectedItem}select(e,i){return this.viewModel.select(e,i)}render(){const{disabled:e,enableListScroll:i,filterText:r,headingLevel:n,messages:o,viewModel:{items:u,numberOfFeatureTemplates:p,selectedItem:g,state:w}}=this,S=this.visibleElements.filter&&p>1;if(N7e(u)){const T=u.find(E=>E.label===PO.nullGroupBy.label);T&&(T.label=o.other)}return N("div",{"aria-label":o.widgetLabel,class:this.classes(F7e.base,Ee.widget)},w==="loading"?N("calcite-loader",{key:"loader",label:this.messagesCommon.loading,type:"indeterminate"}):w==="ready"?N(zse,{disabled:e,enableListScroll:i,filterEnabled:S,filterText:r,headingLevel:n,id:this.id,identify:D7e,items:u,messages:{filterPlaceholder:o.filterPlaceholder,noItems:o.noItems,noMatches:o.noMatches},renderCustomGroupContent:this.renderCustomGroupContent,renderCustomItem:this.renderCustomItem,renderIcon:this._renderItemIcon,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,selectedItem:g??void 0,selectionMode:this.selectionMode??void 0,onFilterChange:T=>{this.filterText=T,this.viewModel.refresh()},onItemSelect:T=>!rse(T)&&this.viewModel.select(T)}):null)}};function j7e(t){return t==null?void 0:t["data-item"]}function V7e(t){return!!(t!=null&&t["data-has-icon"])}function QG(t,e){t&&(t["data-has-icon"]=e)}m([b()],Tr.prototype,"disabled",null),m([b()],Tr.prototype,"enableListScroll",void 0),m([b()],Tr.prototype,"filterFunction",null),m([b()],Tr.prototype,"filterText",void 0),m([b()],Tr.prototype,"groupBy",null),m([b()],Tr.prototype,"headingLevel",void 0),m([b()],Tr.prototype,"icon",null),m([b()],Tr.prototype,"label",null),m([b()],Tr.prototype,"layers",null),m([b(),vt("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Tr.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Tr.prototype,"messagesCommon",void 0),m([b({readOnly:!0})],Tr.prototype,"selectedItem",null),m([b()],Tr.prototype,"selectionMode",void 0),m([b(),v0("select")],Tr.prototype,"viewModel",void 0),m([b({type:Use,nonNullable:!0})],Tr.prototype,"visibleElements",void 0),m([b()],Tr.prototype,"renderCustomItem",void 0),m([b()],Tr.prototype,"renderCustomGroupContent",void 0),m([b()],Tr.prototype,"renderItemLabel",void 0),m([b()],Tr.prototype,"renderItemDescription",void 0),m([b()],Tr.prototype,"renderItemContent",void 0),m([b()],Tr.prototype,"renderItemContentEnd",void 0),Tr=m([G("esri.widgets.FeatureTemplates")],Tr);const z7e=Tr;let Ly=class extends Ar.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([Fr(()=>{const i=this.screenLocationEnabled?this.view:null;return i?[i.size,i.type==="3d"?i.camera:i.viewpoint]:null},()=>this.notifyChange("screenLocation")),ce(()=>this.screenLocation,(i,r)=>{i!=null&&r!=null&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const{location:e,view:i,screenLocationEnabled:r}=this,n=i==null?void 0:i.spatialReference,o=n?Ete(e,n).geometry:null;return r&&o&&(i!=null&&i.ready)?i.toScreen(o):null}};m([b()],Ly.prototype,"location",void 0),m([b()],Ly.prototype,"screenLocation",null),m([b()],Ly.prototype,"screenLocationEnabled",void 0),m([b()],Ly.prototype,"view",void 0),Ly=m([G("esri.widgets.support.AnchorElementViewModel")],Ly);const U7e=Ly;let p5=class extends U7e{constructor(e){super(e),this.visible=!1}};m([b()],p5.prototype,"visible",void 0),p5=m([G("esri.widgets.Spinner.SpinnerViewModel")],p5);const rF=p5,qk="esri-spinner",Hk={base:qk,spinnerStart:`${qk}--start`,spinnerFinish:`${qk}--finish`};let Oy=class extends vi{constructor(e,i){super(e,i),this._animationDelay=500,this._animationPromise=null,this.viewModel=new rF}initialize(){this.addHandles(ce(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:i,promise:r}=e??{};i&&(this.viewModel.location=i),this.visible=!0;const n=()=>this.hide();r&&r.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:i}=this.viewModel,r=!!i,n=e&&r,o=!e&&r,u={[Hk.spinnerStart]:n,[Hk.spinnerFinish]:o},p=this._getPositionStyles();return N("div",{class:this.classes(Hk.base,u),styles:p})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const i=Db(this._animationDelay);this._animationPromise=i,i.catch(()=>{}).then(()=>{this._animationPromise===i&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:i}=this.viewModel;if(i==null||e==null)return{};const{padding:r}=i;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};m([b()],Oy.prototype,"location",null),m([b()],Oy.prototype,"view",null),m([b({type:rF})],Oy.prototype,"viewModel",void 0),m([b()],Oy.prototype,"visible",null),Oy=m([G("esri.widgets.Spinner")],Oy);const G7e=Oy,Cg="esri-editor",Ag={base:Cg,helpMessage:`${Cg}__help-message`,updateActions:`${Cg}__update-actions`,updateActionsList:`${Cg}__update-actions-list`,featureTemplatesContainer:`${Cg}__feature-templates-container`,templateItemContentEnd:`${Cg}__template-item-content-end`};let cp=class extends Jee(Dte(WP)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new dm,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,i){return super.on(e,i)}graphicChanged(e){this.emit("graphic-update",e)}};m([b({type:rte})],cp.prototype,"elevationInfo",void 0),m([b(KL(dm,"graphics"))],cp.prototype,"graphics",void 0),m([b({type:["show","hide"]})],cp.prototype,"listMode",void 0),m([b()],cp.prototype,"screenSizePerspectiveEnabled",void 0),m([b({readOnly:!0})],cp.prototype,"type",void 0),m([b({constructOnly:!0})],cp.prototype,"internal",void 0),cp=m([G("esri.layers.GraphicsLayer")],cp);const LS=cp;let d5=class extends Te{constructor(e){super(e),this.enabled=!1}};m([b({type:Boolean,nonNullable:!0})],d5.prototype,"enabled",void 0),d5=m([G("esri.views.interactive.sketch.SketchLabelOptions")],d5);const nF=d5;let Z2=class extends Te{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};m([b({type:String,nonNullable:!0})],Z2.prototype,"mode",void 0),Z2=m([G("esri.views.interactive.sketch.SketchTooltipElevationOptions")],Z2);let js=class extends Te{constructor(e){super(e),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};m([b({type:Boolean,nonNullable:!0})],js.prototype,"area",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"coordinates",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"direction",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"distance",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"elevation",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"header",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"helpMessage",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"orientation",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"radius",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"rotation",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"scale",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"size",void 0),m([b({type:Boolean,nonNullable:!0})],js.prototype,"totalLength",void 0),js=m([G("esri.views.interactive.sketch.SketchTooltipVisibleElements")],js);const Gse=js;let $a=class extends Te{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new Z2,this.visibleElements=new Gse,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};m([b({type:Boolean,nonNullable:!0})],$a.prototype,"enabled",void 0),m([b()],$a.prototype,"forceEnabled",void 0),m([b()],$a.prototype,"effectiveEnabled",null),m([b()],$a.prototype,"helpMessage",void 0),m([b()],$a.prototype,"helpMessageIcon",void 0),m([b({type:Boolean,nonNullable:!0})],$a.prototype,"inputEnabled",void 0),m([b({type:Z2,nonNullable:!0})],$a.prototype,"elevation",void 0),m([b({type:Gse,nonNullable:!0})],$a.prototype,"visibleElements",void 0),m([b()],$a.prototype,"visualVariables",void 0),m([b()],$a.prototype,"xyMode",void 0),$a=m([G("esri.views.interactive.sketch.SketchTooltipOptions")],$a);const sF=$a;let B1=class extends Te{constructor(e){super(e),this.labels=new nF,this.tooltips=new sF,this.values=new RM}};m([b({nonNullable:!0,type:nF})],B1.prototype,"labels",void 0),m([b({nonNullable:!0,type:sF})],B1.prototype,"tooltips",void 0),m([b({nonNullable:!0,type:RM})],B1.prototype,"values",void 0),B1=m([G("esri.views.interactive.sketch.SketchOptions")],B1);const w0=B1;function Bse(t){return t?Jr:X7e}function B7e(t,e){return e!=null&&e.mode?e.mode:Bse(t).mode}function q7e(t,e){return e??Bse(t)}function qse(t,e){return B7e(t!=null&&t.hasZ,e)}function Qtt(t,e){return q7e(t!=null&&!!t.hasZ,e)}function H7e(t){const e=Wse(t);return qse(t.geometry,e)}function oF(t){const e=Wse(t),i=qse(t.geometry,e),r=e!=null&&i!=="on-the-ground"?Y7e(e):0,n=e==null?void 0:e.featureExpressionInfo;return{mode:i,offset:r,featureExpressionInfo:n}}function Hse(t){return OS(oF(t))}function eit(t){return OS(t)||W7e(t)}function W7e(t){var e;return((e=t==null?void 0:t.featureExpressionInfo)==null?void 0:e.expression)==="0"}function OS(t){if(!t||t.mode==="on-the-ground")return!1;const e=t!=null&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!e||e==="0")}function Wse(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function jM(t,e){if(!(t!=null&&t.offset))return 0;const{offset:i,unit:r}=t;if(r==="decimal-degrees")return 0;const n=r!=="unknown"&&r?r:"meters",o=Bde(e);return o?lt(i,n,o):0}function tit(t,e,i){if(!(i!=null&&i.mode))return;const r=t.hasZ?t.z:0,n=jM(i,t.spatialReference);switch(i.mode){case"absolute-height":return r-n;case"on-the-ground":return 0;case"relative-to-ground":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"ground")??0)+n);case"relative-to-scene":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"scene")??0)+n)}}function J7e(t,e,i,r=null){return aF(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,i,r)}function Jse(t,e,i,r,n=null){return aF(t,e[0],e[1],e.length>2?e[2]:0,i,r,n)}function aF(t,e,i,r,n,o,u=null){if(o==null)return;const p=u!=null?u.mode:"absolute-height";if(p==="on-the-ground")return 0;const{absoluteZ:g}=Z7e(e,i,r,n,t,o);return K7e(g,e,i,r,n,t,u,p)}function Z7e(t,e,i,r,n,o){const u=jM(o,r);switch(o.mode){case"absolute-height":return{absoluteZ:i+u,elevation:0};case"on-the-ground":{const p=n.elevationProvider.getElevation(t,e,0,r,"ground")??0;return{absoluteZ:p,elevation:p}}case"relative-to-ground":{const p=n.elevationProvider.getElevation(t,e,i,r,"ground")??0;return{absoluteZ:i+p+u,elevation:p}}case"relative-to-scene":{const p=n.elevationProvider.getElevation(t,e,i,r,"scene")??0;return{absoluteZ:i+p+u,elevation:p}}}}function K7e(t,e,i,r,n,o,u,p){const g=jM(u,n);switch(p){case"absolute-height":return t-g;case"relative-to-ground":return t-((o.elevationProvider.getElevation(e,i,r,n,"ground")??0)+g);case"relative-to-scene":return t-((o.elevationProvider.getElevation(e,i,r,n,"scene")??0)+g)}}function iit(t,e){if(e==null)return!1;const{mode:i}=e;return i!=null&&(t==="scene"&&i==="relative-to-scene"||t==="ground"&&i!=="absolute-height")}function rit(t,e,i){return i&&i.mode!==e?`${t} only support ${e} elevation mode`:null}function nit(t,e,i){return(i==null?void 0:i.mode)===e?`${t} do not support ${e} elevation mode`:null}function sit(t,e){return(e==null?void 0:e.featureExpressionInfo)!=null&&e.featureExpressionInfo.expression!=="0"?`${t} do not support featureExpressionInfo`:null}function oit(t,e){e&&t.warn(".elevationInfo=",e)}function Y7e(t){return((t==null?void 0:t.offset)??0)*GSe(t==null?void 0:t.unit)}const Jr={mode:"absolute-height",offset:0},X7e={mode:"on-the-ground",offset:null};var Vm;function Zse(t,e,i){return qa(t,e,i)}function qa(t=0,e=0,i=0){return un(t,e,i)}function ait(t){return t}function lit(t){return t}function rc(t,e,i){return un(t,e,i)}function Eb(t){const[e,i,r]=t;return t.length>3?[e,i,r,t[3]]:[e,i,r]}function Kf(t){return t[3]=((t.length>3?t[3]:void 0)??Vm.NONE)|Vm.TARGET,t}function uit(t){return!!(((t.length>3?t[3]:void 0)??Vm.NONE)&Vm.TARGET)}function Tn(t,e,{coordinateHelper:i,elevationInfo:r},n){return t?i2(i.vectorToDehydratedPoint(t,Q7e),e,r,n):null}function i2(t,e,i,r=qa()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=J7e(e,t,i,Jr)??0),r}function cit(t,e,i){return i?(Une(i,t[0],t[1],t[2],e),i):sw(t[0],t[1],t[2],e)}function eB(t,e,{z:i,m:r},n,o){const{spatialReference:u,elevationInfo:p}=n;let g;i==null&&r==null?g=void 0:e==null||e.type==="2d"?g=i??void 0:g=Jse(e,t,u,Jr,p)??0;const[w,S]=t;return o?Une(o,w,S,g,u):o=sw(w,S,g,u),r!=null&&(o.m=r,o.hasM=!0),o}function hit(t,e,i,r,n=qa()){const[o,u]=t;return n[0]=o,n[1]=u,t.length>3&&(n[3]=t[3]??Vm.NONE),(i==null?void 0:i.type)!=="3d"?(n[2]=e.value,n):(n[2]=aF(i,o,u,e.value,r,e.elevationInfo,Jr)??0,n)}(function(t){t[t.NONE=0]="NONE",t[t.TARGET=1]="TARGET"})(Vm||(Vm={}));const Q7e=sw(0,0,0,null);let Gu=class extends ye{constructor(){super(...arguments),this.enabled=!0}};m([b({type:Boolean})],Gu.prototype,"enabled",void 0),Gu=m([G("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],Gu);let lr=class extends ye{constructor(e){super(e),this.lineSnapper=new Gu,this.parallelLineSnapper=new Gu,this.rightAngleSnapper=new Gu,this.rightAngleTriangleSnapper=new Gu,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new Ce([255,127,0]),this.orangeTransparent=new Ce([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};m([b({type:Gu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],lr.prototype,"lineSnapper",void 0),m([b({type:Gu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],lr.prototype,"parallelLineSnapper",void 0),m([b({type:Gu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],lr.prototype,"rightAngleSnapper",void 0),m([b({type:Gu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],lr.prototype,"rightAngleTriangleSnapper",void 0),m([b({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],lr.prototype,"shortLineThreshold",void 0),m([b({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],lr.prototype,"distance",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],lr.prototype,"pointThreshold",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],lr.prototype,"intersectionParallelLineThreshold",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],lr.prototype,"parallelLineThreshold",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],lr.prototype,"verticalLineThresholdMeters",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],lr.prototype,"touchSensitivityMultiplier",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],lr.prototype,"pointOnLineThreshold",void 0),m([b({type:Ce,nonNullable:!0})],lr.prototype,"orange",void 0),m([b({type:Ce,nonNullable:!0})],lr.prototype,"orangeTransparent",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],lr.prototype,"lineHintWidthReference",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],lr.prototype,"lineHintWidthTarget",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],lr.prototype,"lineHintFadedExtensions",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],lr.prototype,"parallelLineHintWidth",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],lr.prototype,"parallelLineHintLength",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],lr.prototype,"parallelLineHintOffset",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],lr.prototype,"rightAngleHintSize",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],lr.prototype,"rightAngleHintOutlineSize",void 0),m([b({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],lr.prototype,"satisfiesConstraintScreenThreshold",void 0),lr=m([G("esri.views.interactive.snapping.Settings.Defaults")],lr);const Bp=new lr;var Hn;(function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"})(Hn||(Hn={}));function fit(t,e,i){const r=Ft(t,e)/Ft(t,t);return Mi(i,t,r)}function gm(t,e){return Ft(t,e)/cr(t)}function ePe(t,e){const i=Ft(t,e)/(cr(t)*cr(e));return-MP(i)}function aw(){return[1,0,0,0,1,0,0,0,1]}function tPe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function Kse(t,e,i,r,n,o,u,p,g){return[t,e,i,r,n,o,u,p,g]}function iPe(t,e){return new Float64Array(t,e,9)}const rPe=aw();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:rPe,clone:tPe,create:aw,createView:iPe,fromValues:Kse},Symbol.toStringTag,{value:"Module"}));function Bu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function nPe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function sPe(t,e,i,r,n,o,u,p,g,w,S,T,E,C,L,R){return[t,e,i,r,n,o,u,p,g,w,S,T,E,C,L,R]}function oPe(t,e){return new Float64Array(t,e,16)}const lF=Bu();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:lF,clone:nPe,create:Bu,createView:oPe,fromValues:sPe},Symbol.toStringTag,{value:"Module"}));function ad(){return[0,0,0,1]}function aPe(t){return[t[0],t[1],t[2],t[3]]}function lPe(t,e,i,r){return[t,e,i,r]}function uPe(t,e){return new Float64Array(t,e,4)}const uF=ad();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:uF,clone:aPe,create:ad,createView:uPe,fromValues:lPe},Symbol.toStringTag,{value:"Module"}));let lw=class Py{constructor(e){this._create=e,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&eb(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const e=2*this._itemsPtr;this._items.length>e&&(this._items.length=e),this._itemsPtr=0}static createVec2f64(){return new Py(Nt)}static createVec3f64(){return new Py(be)}static createVec4f64(){return new Py($h)}static createMat3f64(){return new Py(aw)}static createMat4f64(){return new Py(Bu)}static createQuatf64(){return new Py(ad)}get test(){}};const yit=lw.createVec2f64(),pt=lw.createVec3f64(),cPe=lw.createVec4f64();lw.createMat3f64();const hPe=lw.createMat4f64(),pPe=lw.createQuatf64();function mit(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],i=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],r=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))}function git(t,e){const i=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),r=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),n=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return Qt(t,i,r,n),t}function cF(t,e,i){Math.abs(t[0])>Math.abs(t[1])?Qt(e,0,1,0):Qt(e,1,0,0),Ko(i,t,e),Ko(e,i,t),ta(i,i),ta(e,e)}function us(t=r2){return[t[0],t[1],t[2],t[3]]}function dPe(t=r2[0],e=r2[1],i=r2[2],r=r2[3]){return hF(t,e,i,r,cPe.get())}function Yse(t,e){return hF(e[0],e[1],e[2],e[3],t)}function vit(t){return t}function hF(t,e,i,r,n=us()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function PS(t,e,i){const r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=-(i[0]*t[0]+i[1]*t[1]+i[2]*t[2]),i}function Xse(t,e,i,r=us()){const n=i[0]-e[0],o=i[1]-e[1],u=i[2]-e[2],p=t[0]-e[0],g=t[1]-e[1],w=t[2]-e[2],S=o*w-u*g,T=u*p-n*w,E=n*g-o*p,C=S*S+T*T+E*E,L=Math.abs(C-1)>1e-5&&C>1e-12?1/Math.sqrt(C):1;return r[0]=S*L,r[1]=T*L,r[2]=E*L,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function Qse(t,e,i,r=0,n=Math.floor(i*(1/3)),o=Math.floor(i*(2/3))){if(i<3)return!1;e(Ow,r);let u=n,p=!1;for(;u<i-1&&!p;)e(Lg,u),u++,p=!Si(Ow,Lg);if(!p)return!1;for(u=Math.max(u,o),p=!1;u<i&&!p;)e(Yy,u),u++,Xi(f$,Ow,Lg),ta(f$,f$),Xi(y$,Lg,Yy),ta(y$,y$),p=!Si(Ow,Yy)&&!Si(Lg,Yy)&&Math.abs(Ft(f$,y$))<fPe;return p?(Xse(Ow,Lg,Yy,t),!0):(r!==0||n!==1||o!==2)&&Qse(t,e,i,0,1,2)}function bit(t,e,i=!0){const r=e.length/3;return Qse(t,(n,o)=>Qt(n,e[3*o+0],e[3*o+1],e[3*o+2]),i?r-1:r)}const fPe=.99619469809,Ow=be(),Lg=be(),Yy=be(),f$=be(),y$=be();function yPe(t,e,i){return e!==t&&Yse(t,e),t[3]=-Ft(t,i),t}function wit(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function RO(t,e,i,r){return Ko(Yy,e,t),PS(i,Yy,r)}function eoe(t,e,i,r){return zM(t,e,Xi(pt.get(),i,e),wPe,r)}function mPe(t,e,i){return e!=null&&zM(t,e.origin,e.direction,_Pe,i)}function gPe(t,e,i){return zM(t,e.origin,e.vector,uh.NONE,i)}function vPe(t,e,i){return zM(t,e.origin,e.vector,uh.CLAMP,i)}function pF(t,e){return VM(t,e)>=0}function _it(t,e){const i=Ft(t,e.ray.direction),r=-VM(t,e.ray.origin);if(i>-1e-6&&i<1e-6)return r>0;const n=r/i;return i>0?n<e.c1&&(e.c1=n):n>e.c0&&(e.c0=n),e.c0<=e.c1}function dF(t,e,i){const r=Mi(pt.get(),t,-t[3]),n=bPe(t,Xi(pt.get(),e,r),pt.get());return nr(i,n,r),i}function Sit(t,e,i,r){const n=t,o=pt.get(),u=pt.get();cF(n,o,u);const p=Xi(pt.get(),i,e),g=gm(o,p),w=gm(u,p),S=gm(n,p);return Qt(r,g,w,S)}function bPe(t,e,i){const r=Mi(pt.get(),t,Ft(t,e));return Xi(i,e,r),i}function FO(t,e){return Math.abs(VM(t,e))}function VM(t,e){return Ft(t,e)+t[3]}function zM(t,e,i,r,n){const o=Ft(t,i);if(o===0)return!1;let u=-(Ft(t,e)+t[3])/o;return r&uh.CLAMP&&(u=An(u,0,1)),!(!(r&uh.INFINITE_MIN)&&u<0||!(r&uh.INFINITE_MAX)&&u>1)&&(nr(n,e,Mi(n,i,u)),!0)}const r2=[0,0,1,0];var uh;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(uh||(uh={}));const wPe=uh.INFINITE_MIN|uh.INFINITE_MAX,_Pe=uh.INFINITE_MAX;let RS=class{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&eb(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*tB);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,tB));e++)this._items.push(this._allocator())}};const tB=1024;function Cl(t){return t?iB(xs(t.origin),xs(t.direction)):iB(be(),be())}function iB(t,e){return{origin:t,direction:e}}function $it(t,e){const i=TPe.get();return i.origin=t,i.direction=e,i}function NO(t,e=Cl()){return SPe(t.origin,t.direction,e)}function fF(t,e,i=Cl()){return ki(i.origin,t),Xi(i.direction,e,t),i}function SPe(t,e,i=Cl()){return ki(i.origin,t),ki(i.direction,e),i}function xPe(t,e){const i=Ko(pt.get(),ta(pt.get(),t.direction),Xi(pt.get(),e,t.origin));return Ft(i,i)}function $Pe(t,e,i){const r=Ft(t.direction,Xi(i,e,t.origin));return nr(i,t.origin,Mi(i,t.direction,r)),i}const TPe=new RS(()=>Cl()),EPe=FS();function FS(){return $h()}const toe=aM,IPe=aM;function ioe(t,e){return v3(e,t)}function roe(t,e){return nd(t[0],t[1],t[2],e)}function MPe(t){return t}function kPe(t){t[0]=t[1]=t[2]=t[3]=0}function CPe(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function UM(t){return t[3]}function APe(t){return t}function LPe(t,e,i,r){return nd(t,e,i,r)}function OPe(t,e,i){return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=t[3]+e,i}function PPe(t,e,i){return t!==i&&ioe(t,i),i}function GM(t,e,i){if(e==null||!soe(t,e,tI))return!1;let{t0:r,t1:n}=tI;if((r<0||n<r&&n>0)&&(r=n),r<0)return!1;if(i){const{origin:o,direction:u}=e;i[0]=o[0]+u[0]*r,i[1]=o[1]+u[1]*r,i[2]=o[2]+u[2]*r}return!0}function noe(t,e,i){const r=fF(e,i);if(!soe(t,r,tI))return[];const{origin:n,direction:o}=r,{t0:u,t1:p}=tI,g=w=>{const S=be();return ji(S,n,o,w),BM(t,S,S)};return Math.abs(u-p)<kr()?[g(u)]:[g(u),g(p)]}const tI={t0:0,t1:0};function soe(t,e,i){const{origin:r,direction:n}=e,o=RPe;o[0]=r[0]-t[0],o[1]=r[1]-t[1],o[2]=r[2]-t[2];const u=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];if(u===0)return!1;const p=2*(n[0]*o[0]+n[1]*o[1]+n[2]*o[2]),g=p*p-4*u*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(g<0)return!1;const w=Math.sqrt(g);return i.t0=(-p-w)/(2*u),i.t1=(-p+w)/(2*u),!0}const RPe=be();function FPe(t,e){return GM(t,e,null)}function NPe(t,e,i){if(GM(t,e,i))return i;const r=ooe(t,e,pt.get());return nr(i,e.origin,Mi(pt.get(),e.direction,Gm(e.origin,r)/cr(e.direction))),i}function ooe(t,e,i){const r=pt.get(),n=hPe.get();Ko(r,e.origin,e.direction);const o=UM(t);Ko(i,r,e.origin),Mi(i,i,1/cr(i)*o);const u=aoe(t,e.origin),p=ePe(e.origin,i);return LP(n,p+u,r),Ll(i,i,n),i}function DPe(t,e,i){return GM(t,e,i)?i:($Pe(e,t,i),BM(t,i,i))}function BM(t,e,i){const r=Xi(pt.get(),e,t),n=Mi(pt.get(),r,t[3]/cr(r));return nr(i,n,t)}function jPe(t,e){const i=Xi(pt.get(),e,t),r=Am(i),n=t[3]*t[3];return Math.sqrt(Math.abs(r-n))}function aoe(t,e){const i=Xi(pt.get(),e,t),r=cr(i),n=UM(t),o=n+Math.abs(n-r);return MP(n/o)}const Wk=be();function loe(t,e,i,r){const n=Xi(Wk,e,t);switch(i){case Ju.X:{const o=SD(n,Wk)[2];return Qt(r,-Math.sin(o),Math.cos(o),0)}case Ju.Y:{const o=SD(n,Wk),u=o[1],p=o[2],g=Math.sin(u);return Qt(r,-g*Math.cos(p),-g*Math.sin(p),Math.cos(u))}case Ju.Z:return ta(r,n);default:return}}function uoe(t,e){const i=Xi(DO,e,t);return cr(i)-t[3]}function VPe(t,e,i,r){const n=uoe(t,e),o=loe(t,e,Ju.Z,DO),u=Mi(DO,o,i-n);return nr(r,e,u)}function zPe(t,e){const i=ph(t,e),r=UM(t);return i<=r*r}function UPe(t,e,i=$h()){const r=Gm(t,e),n=t[3],o=e[3];return r+o<n?(v3(i,t),i):r+n<o?(v3(i,e),i):(VI(i,t,e,(r+o-n)/(2*r)),i[3]=(r+n+o)/2,i)}const DO=be(),GPe=FS();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:EPe,altitudeAt:uoe,angleToSilhouette:aoe,axisAt:loe,clear:kPe,closestPoint:DPe,closestPointOnSilhouette:ooe,containsPoint:zPe,copy:ioe,create:FS,distanceToSilhouette:jPe,elevate:OPe,equals:IPe,exactEquals:toe,fromCenterAndRadius:roe,fromRadius:CPe,fromValues:LPe,getCenter:APe,getRadius:UM,intersectLine:noe,intersectRay:GM,intersectRayClosestSilhouette:NPe,intersectsRay:FPe,projectPoint:BM,setAltitudeAt:VPe,setExtent:PPe,tmpSphere:GPe,union:UPe,wrap:MPe},Symbol.toStringTag,{value:"Module"}));function Jk(t,e){return t[0]*e[1]-t[1]*e[0]}function BPe(t,e,i){const r=od(i,e)/bh(i);return rw(t,i,r)}function jO(t,e,i,r,n=i){return Wr(vm,r,i),Wr(iI,e,n),BPe(Ib,iI,vm),_R(t,n,Ib)}function qPe(t,e,i,r){Wr(vm,e,i);const n=r/_b(vm);return Dl(t,i,vm,n)}function Tit(t,e){const i=t.start,r=t.end,n=e.start,o=e.end,u=Wr(vm,r,i),p=Wr(coe,o,n),g=Jk(u,p);if(Math.abs(g)<=WPe)return[];const w=Wr(iI,i,n),S=Jk(p,w)/g,T=Jk(u,w)/g;if(S>=0){if(T>=0||e.type===br.LINE)return[Dl(Ib,i,u,S)]}else if(t.type===br.LINE&&(T>=0||e.type===br.LINE))return[Dl(Ib,i,u,S)];return[]}function HPe(t,e,i){const r=[],n=Wr(vm,t.end,t.start),o=Wr(coe,t.start,e),u=bh(n),p=2*od(n,o),g=p*p-4*u*(bh(o)-i*i);if(g===0){const w=-p/(2*u);(t.type===br.LINE||w>=0)&&r.push(Dl(Ib,t.start,n,w))}else if(g>0){const w=Math.sqrt(g),S=(-p+w)/(2*u);(t.type===br.LINE||S>=0)&&r.push(Dl(Ib,t.start,n,S));const T=(-p-w)/(2*u);(t.type===br.LINE||T>=0)&&r.push(Dl(iI,t.start,n,T))}return r}var br;(function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"})(br||(br={}));const WPe=1e-6,vm=Nt(),coe=Nt(),iI=Nt(),Ib=Nt();function yF({start:t,end:e,type:i},r,n){const o=[],u=Wr(NS,e,t),p=Wr(qM,t,r),g=bh(u),w=2*od(u,p),S=w*w-4*g*(bh(p)-n*n);if(S===0){const T=-w/(2*g);(i===Ga.PLANE||T>=0)&&o.push(Dl(Nt(),t,u,T))}else if(S>0){const T=Math.sqrt(S),E=(-w+T)/(2*g);(i===Ga.PLANE||E>=0)&&o.push(Dl(Nt(),t,u,E));const C=(-w-T)/(2*g);(i===Ga.PLANE||C>=0)&&o.push(Dl(Nt(),t,u,C))}return o}function hoe(t,e){const i=t.start,r=t.end,n=Wr(NS,r,i),o=Qt(WM,-n[1],n[0],0),u=e.start,p=e.end,g=Js(vF,p,u),w=Ft(g,o),S=Qt(voe,i[0],i[1],0),T=Js(boe,S,u),E=Ft(T,o),C=kr();if(Math.abs(w)<C)return[];const L=ji(woe,u,g,E/w);if(e.type===br.RAY){const R=Js(VO,L,u);if(Ft(R,g)<-C)return[]}if(t.type===Ga.HALF_PLANE){const R=EM(qM,L,i);if(od(R,n)<-C)return[]}return[xs(L)]}function JPe(t,e){return KPe(rI(bF,e[2],t),e)}function poe(t,e){return moe(rI(bF,0,t),rI(e8e,0,e)).map(([r,n])=>Vp(r,n))}function doe(t,e,i){return mF(t,rI(bF,t[2],e),i)}function foe(t,e,i,r=be()){const n=Wr(NS,t,e),o=_b(n);return Dl(r,e,n,o===0?1:i/o),r[2]=t[2],r}function mF(t,{start:e,end:i,type:r},n=be()){const o=Js(HM,t,e),u=Js(WM,i,e),p=Ft(o,u)/Ft(u,u);return ji(n,e,u,r===br.RAY?Math.max(p,0):p)}const ZPe=(()=>{const t=be(),e=be(),i=be();return({start:r,end:n},{center:o,radius:u,normal:p,slicePlane:g})=>{const w=PS(o,p,QPe);if(rr(FO(w,r),0)&&rr(FO(w,n),0)){cF(p,t,e);const T=(L,R)=>(Xi(i,R,o),wn(L,Ft(i,t),Ft(i,e)),L),E=HPe({start:T(NS,r),end:T(qM,n),type:br.LINE},Uie,u),C=[];for(const[L,R]of E){const F=ki(be(),o);ji(F,F,t,L),ji(F,F,e,R),g&&!Yf(g,F)||C.push(F)}return C}const S=be();return eoe(w,r,n,S)?!rr(Gm(S,o),u)||g&&!Yf(g,S)?[]:[S]:[]}})();function yoe({start:t,end:e,type:i},r,n){const o=[],u=Xi(HM,e,t),p=Wr(qM,t,r),g=bh(u),w=2*od(u,p),S=w*w-4*g*(bh(p)-n*n);if(S===0){const T=-w/(2*g);(i===br.LINE||T>=0)&&o.push(ji(be(),t,u,T))}else if(S>0){const T=Math.sqrt(S),E=(-w+T)/(2*g);(i===br.LINE||E>=0)&&o.push(ji(be(),t,u,E));const C=(-w-T)/(2*g);(i===br.LINE||C>=0)&&o.push(ji(be(),t,u,C))}return o}function moe(t,e){const i=t.start,r=t.end,n=e.start,o=e.end,u=Js(HM,r,i),p=Js(WM,o,n),g=Js(vF,n,i),w=Ko(voe,u,p);if(!rr(Ft(g,w),0))return[];const S=a3(w);if(rr(S,0))return[];const T=Ko(boe,g,p),E=Ft(T,w)/S,C=ji(woe,i,u,E);if(t.type===br.RAY){const L=Js(VO,C,i);if(Ft(u,L)<-kr())return[]}if(e.type===br.RAY){const L=Js(VO,C,n);if(Ft(p,L)<-kr())return[]}return[xs(C)]}function KPe({start:t,end:e,type:i},r){const n=Js(HM,r,t),o=Js(WM,e,t),u=Ko(vF,o,n),p=a3(u)/a3(o),g=kr();if(p<g)switch(i){case br.LINE:return[xs(r)];case br.RAY:return Ft(o,n)<-g?[]:[xs(r)]}return[]}function gF(t,e,i,r){const[n,o]=t,[u,p]=i,g=u-n,w=p-o,S=g*g+w*w,T=Math.sqrt(S);if(T>e+r)return[];if(T<Math.abs(e-r))return[];if(rr(T,0)&&rr(e,r))return[];const E=(e*e-r*r+S)/(2*T),C=Math.sqrt(e*e-E*E),L=C*w/T,R=C*g/T,[F,V]=TM(NS,t,i,E/T);return rr(L,R)?[Vp(F,V)]:[Vp(F+L,V-R),Vp(F-L,V+R)]}function rI(t,e,{start:i,end:r,type:n}){return Qt(t.start,i[0],i[1],e),Qt(t.end,r[0],r[1],e),t.type=XPe[n],t}function goe(t,e){return rr(t[2],e[2])}function rr(t,e){return Sv(Math.abs(t-e),0,kr())}function YPe(t,e){return e.filter(i=>Yf(t,i))}function Yf(t,e){return pF(t,e)}var Ga;(function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"})(Ga||(Ga={}));const XPe={[Ga.PLANE]:br.LINE,[Ga.HALF_PLANE]:br.RAY},NS=Nt(),qM=Nt(),HM=be(),WM=be(),vF=be(),voe=be(),boe=be(),woe=be(),VO=be(),QPe=us(),bF={start:be(),end:be(),type:br.LINE},e8e={start:be(),end:be(),type:br.LINE};let Hl=class{intersect(e){return hp(this,e)}closestPoints(e){return[this.closestTo(e)]}},uw=class extends Hl{constructor(e){super(),this.point=e}equals(e){return this===e||Lu(e)&&Si(this.point,e.point)}closestTo(){return Eb(this.point)}},wF=class extends Hl{constructor(e,i,r){super(),this.start=e,this.end=i,this.lineLike={start:e,end:i,type:r}}equals(e){return this===e||Kc(e)&&this.lineLike.type===e.lineLike.type&&Si(this.start,e.start)&&Si(this.end,e.end)}closestTo(e){const i=qa();return mF(e,this.lineLike,i),i}};class _F extends wF{constructor(e,i){super(e,i,br.LINE)}}class t8e extends wF{constructor(e,i){super(e,i,br.RAY)}}class _oe extends Hl{constructor(e){super(),this.constraints=e}equals(e){return this===e||zO(e)&&Rb(this.constraints,e.constraints,(i,r)=>i.equals(r))}closestTo(e){let i,r=1/0;for(const n of this.constraints){const o=n.closestTo(e),u=ph(e,o);u<r&&(r=u,i=o)}return Eb(i??e)}closestPoints(e){return this.constraints.flatMap(i=>i===this?[]:i.closestPoints(e))}}class Soe extends Hl{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||Xc(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const i=qa();return foe(e,this.center,this.radius,i),i}}class SF extends Hl{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||dp(e)&&Si(this.center,e.center)&&this.radius===e.radius}closestTo(e){const i=qa();return foe(e,this.center,this.radius,i),i[2]=this.center[2],i}asCircle(){return new xF(Eb(this.center),this.radius,rc(0,0,1))}}class xF extends Hl{constructor(e,i,r,n=void 0){super(),this.center=e,this.radius=i,this.normal=r,this.slicePlane=n}equals(e){return this===e||pf(e)&&Si(this.center,e.center)&&Si(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:i,radius:r}=this;dF(this.getPlane(i8e),e,Zk);const n=Js(Zk,Zk,i),o=Am(n);if(rr(o,0))return Eb(e);const u=r/Math.sqrt(o),p=qa();ji(p,i,n,u);const{slicePlane:g}=this;if(g&&!Yf(g,p)){const w=TF(g,this);return(w==null?void 0:w.closestTo(e))??Eb(e)}return p}getPlane(e=us()){return PS(this.center,this.normal,e)}}const Zk=be(),i8e=us();class r8e extends Hl{constructor(e){super(),this.z=e}equals(e){return this===e||pp(e)&&this.z===e.z}closestTo(e){return rc(e[0],e[1],this.z)}getPlane(e=us()){return Qt(rB,0,0,this.z),PS(rB,o3,e)}}const rB=be();class $F extends Hl{constructor(e,i,r){super(),this.start=e,this.end=i,this.planeLike={start:e,end:i,type:r}}equals(e){return this===e||Yc(e)&&this.planeLike.type===e.planeLike.type&&Si(this.start,e.start)&&Si(this.end,e.end)}closestTo(e){const i=qa();return doe(e,this.planeLike,i),i}closestEndTo(e){const{start:i,end:r}=this.planeLike;return Math.sign(od(Wr(n8e,r,i),Wr(s8e,e,i)))>0?this.end:this.start}getPlane(e=us()){const i=ki(nB,this.end);return i[2]+=1,Xse(this.start,this.end,i,e)}getSlicePlane(e=us()){const{start:i,end:r,type:n}=this.planeLike;if(n===Ga.PLANE)return;const o=Qt(nB,i[0],i[1],0),u=Qt(sB,r[0],r[1],0),p=Xi(sB,u,o);return PS(o,p,e),e}}const n8e=Nt(),s8e=Nt(),nB=be(),sB=be();class xoe extends $F{constructor(e,i){super(e,i,Ga.HALF_PLANE)}}class $oe extends $F{constructor(e,i){super(e,i,Ga.PLANE)}}class o8e extends Hl{constructor(e,i){super(),this.sphere=roe(e,i)}equals(e){return this===e||fp(e)&&toe(this.sphere,e.sphere)}closestTo(e){const i=qa();return BM(this.sphere,e,i),i}get center(){return this.sphere}get radius(){return this.sphere[3]}}class Toe extends Hl{constructor(e,i,r){super(),this.start=e,this.end=i,this.getZ=r,this.planeLike={start:e,end:i,type:Ga.PLANE}}equals(e){return this===e||nI(e)&&Si(this.start,e.start)&&Si(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return p8e(this,e)}addIfOnTheGround(e,i){for(const r of i){const n=this.getZ(r[0],r[1])??0;rr(r[2],n)&&(r[2]=n,e.push(r))}}}class a8e extends Hl{constructor(e,i,r){super(),this._x=e,this._y=i,this._z=r}equals(e){return this===e||M8e(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,i,r]){return Zse(this._x??e,this._y??i,this._z??r)}}class l8e extends Hl{constructor(e,i,r,n,o){super(),this._origin=e,this._spatialReference=i,this._distanceMeters=r,this._elevationMeters=n,this._directionDegrees=o}equals(e){return this===e||I8e(e)&&iO(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._elevationMeters===e._elevationMeters&&this._directionDegrees===e._directionDegrees}closestTo([e,i,r]){return wn(Pw,e,i),iO(Pw,this._origin)||this._applyDirectionAndDistance(Pw),Zse(Pw[0],Pw[1],this._elevationMeters??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Gp(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)c8e(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:i}=tg(u8e,this._origin,e,this._spatialReference);Gp(e,this._origin,i??0,this._distanceMeters,this._spatialReference)}}}const Pw=[0,0],u8e=new ow;function c8e(t,e,i,r,n){let{azimuth:o,distance:u}=tg(h8e,e,r,n);o??(o=0);let p=u*Math.cos((o-i)*go);p=Math.max(0,p),Gp(t,e,i,p,n)}const h8e=new ow;function p8e(t,e){const i=qa();return doe(e,t.planeLike,i),i[2]=t.getZ(i[0],i[1])??Ioe,i}function hp(t,e){if(zO(t)){const i=[];for(const r of t.constraints){const n=r.intersect(e);n&&i.push(n)}return EF(i)}if(zO(e))return hp(e,t);if(nI(t))return oB(t,e);if(nI(e))return oB(e,t);if(Lu(t)){const{point:i}=t;if(Lu(e))return Si(i,e.point)?t:void 0;const r=e.closestTo(i);return VZ(r,i)?t:void 0}if(Kc(t)){if(Lu(e))return hp(e,t);if(Kc(e))return qu(moe(t.lineLike,e.lineLike));if(pp(e))return d8e(t,e);if(Yc(e))return qu(hoe(e.planeLike,t.lineLike));if(Xc(e))return qu(yoe(t.lineLike,e.center,e.radius));if(pf(e))return qu(ZPe(t.lineLike,e));if(dp(e))return f8e(t,e);if(fp(e))return y8e(t,e)}else if(pp(t)){if(Lu(e)||Kc(e))return hp(e,t);if(pp(e))return m8e(t,e);if(Yc(e))return g8e(t,e);if(Xc(e))return v8e(t,e);if(pf(e))return w8e(t,e);if(dp(e))return b8e(t,e);if(fp(e))return _8e(t,e)}else if(Yc(t)){if(Lu(e)||Kc(e)||pp(e))return hp(e,t);if(Yc(e))return Kk(poe(t.planeLike,e.planeLike));if(Xc(e))return Kk(yF(t.planeLike,e.center,e.radius));if(pf(e))return x8e(t,e);if(dp(e))return S8e(t,e);if(fp(e))return $8e(t,e)}else if(Xc(t)){if(Lu(e)||Kc(e)||pp(e)||Yc(e))return hp(e,t);if(Xc(e))return Kk(gF(t.center,t.radius,e.center,e.radius));if(pf(e))return void 0;if(dp(e))return T8e(t,e);if(fp(e))return void 0}else if(pf(t)){if(Lu(e)||Kc(e)||pp(e)||Yc(e)||Xc(e))return hp(e,t);if(pf(e))return void 0;if(dp(e))return e.asCircle(),void 0;if(fp(e))return void 0}else if(dp(t)){if(Lu(e)||Kc(e)||pp(e)||Yc(e)||Xc(e)||pf(e))return hp(e,t);if(dp(e))return E8e(e,t);if(fp(e))return void 0}else if(fp(t)){if(Lu(e)||Kc(e)||pp(e)||Yc(e)||Xc(e)||dp(e))return hp(e,t);if(fp(e))return void 0}}const d8e=(()=>{const t=us();return(e,i)=>{const{start:r,end:n}=e;if(goe(r,n)&&rr(r[2],i.z))return e;const o=qa();return eoe(i.getPlane(t),r,n,o)?new uw(o):void 0}})();function f8e({lineLike:t},{center:e,radius:i}){const r=e[2];return qu(yoe(t,e,i).filter(n=>rr(n[2],r)))}function y8e({lineLike:t},{sphere:e}){return qu(noe(e,t.start,t.end))}const TF=(()=>{const t=$h(),e=be(),i=be();return(r,n,o)=>{const{normal:u,center:p,radius:g}=n;cF(u,e,i);const w=r,S=g*Ft(w,e),T=g*Ft(w,i);T8(t,p[0],p[1],p[2],1);const E=M8(r,t),C=Math.hypot(S,T),L=rr(C,0);if(rr(FO(r,p),0)){if(L)return n;if(rr(g,0))return!o||Yf(o,p)?new uw(Eb(p)):void 0;Ko(e,w,u),ta(e,e);const X=new Array,te=xs(p);ji(te,te,e,g),o&&!Yf(o,te)||X.push(te);const oe=xs(p);return ji(oe,oe,e,-g),o&&!Yf(o,oe)||X.push(oe),qu(X)}if(L)return;const R=-E/C;if(Math.abs(R)>1||rr(R,1))return;const F=Math.atan(S/T),V=kP(R)-F,U=Math.PI-V,W=new Array,H=be();ji(H,p,e,g*Math.cos(V)),ji(H,H,i,g*Math.sin(V)),W.push(H);const J=be();return ji(J,p,e,g*Math.cos(U)),ji(J,J,i,g*Math.sin(U)),W.push(J),qu(o?YPe(o,W):W)}})();function m8e(t,e){return rr(t.z,e.z)?t:void 0}function g8e({z:t},{planeLike:e}){const[i,r]=e.start,[n,o]=e.end,u=rc(i,r,t),p=rc(n,o,t);return e.type===Ga.PLANE?new _F(u,p):new t8e(u,p)}function v8e(t,e){const[i,r]=e.center;return new SF(rc(i,r,t.z),e.radius)}function b8e(t,e){return rr(e.center[2],t.z)?e:void 0}const w8e=(()=>{const t=us();return(e,i)=>TF(e.getPlane(t),i,i.slicePlane)})();function _8e(t,{center:e,radius:i}){const r=Math.abs(e[2]-t.z);if(r>i&&!rr(r,i))return;const n=rc(e[0],e[1],t.z),o=Math.sqrt(i**2-r**2);return rr(o,0)?void 0:new SF(n,o)}const S8e=(()=>{const t=us();return(e,{center:i,radius:r})=>{const n=yF(e.planeLike,i,r),o=i[2];e.getSlicePlane(t);const u=new Array;for(const[p,g]of n){const w=[p,g,o];Yf(t,w)&&u.push(w)}return qu(u)}})(),x8e=(()=>{const t=us(),e=us();return(i,r)=>TF(i.getPlane(t),r,i.getSlicePlane(e))})(),$8e=(()=>{const t=us();return(e,{center:i,radius:r})=>{const n=e.getPlane(t),o=VM(n,i),u=Math.abs(o);if(u>r&&!rr(u,r))return;const p=Math.sqrt(r**2-o**2);if(rr(p,0)){const S=qa();return dF(n,i,S),new uw(S)}const g=qa(),w=xs(n);return ji(g,i,w,o),new xF(g,p,w,e.getSlicePlane())}})();function T8e(t,e){const i=tc(t.center,e.center);return rr(i,0)&&rr(t.radius,e.radius)?e:Eoe(gF(t.center,t.radius,e.center,e.radius),e.center[2])}function E8e(t,e){if(!goe(t.center,e.center))return;const i=tc(t.center,e.center);return rr(i,0)&&rr(t.radius,e.radius)?t:Eoe(gF(t.center,t.radius,e.center,e.radius),t.center[2])}function oB(t,e){const{planeLike:i,getZ:r}=t,n=new Array;if(Lu(e))t.addIfOnTheGround(n,JPe(i,e.point));else if(Kc(e))t.addIfOnTheGround(n,hoe(i,e.lineLike));else if(Xc(e))for(const[o,u]of yF(i,e.center,e.radius)){const p=r(o,u);p!=null&&n.push(un(o,u,p))}else if(Yc(e)||nI(e))for(const[o,u]of poe(i,e.planeLike)){const p=r(o,u)??Ioe;n.push(un(o,u,p))}return qu(n)}function Kk(t){return EF(t.map(([e,i])=>{const r=rc(e,i,0),n=rc(e,i,1);return new _F(r,n)}))}function qu(t){return EF(t.map(e=>e?new uw(e):void 0))}function Eoe(t,e){return qu(t.map(([i,r])=>[i,r,e]))}function EF(t){if(t.length!==0)return t.length===1?t[0]??void 0:new _oe(t.filter(Rt))}function zO(t){return t instanceof _oe}function Lu(t){return t instanceof uw}function Kc(t){return t instanceof wF}function pp(t){return t instanceof r8e}function Yc(t){return t instanceof $F}function Xc(t){return t instanceof Soe}function dp(t){return t instanceof SF}function pf(t){return t instanceof xF}function fp(t){return t instanceof o8e}function nI(t){return t instanceof Toe}function I8e(t){return t instanceof l8e}function M8e(t){return t instanceof a8e}const Ioe=0;function Moe(t){var i;const e=t.layer;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)&&"floors"in t.view?koe(t.view.floors,e.floorInfo.floorField):null}function aB(t,e){var i;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)?koe(t,e.floorInfo.floorField):null}function koe(t,e){if(!(t!=null&&t.length))return null;const i=t.filter(r=>r!=="").map(r=>`'${r}'`);return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}const Coe="z",Aoe="r",zr={redo:Aoe,undo:Coe,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},lB={toggle:"Control"},kit={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Cit={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:_ie,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:Coe,redo:Aoe};let Ait=class{constructor(){this._bindings=new Map}add(e,i){return this.addToggle(e,r=>{r.type==="key-down"&&i(r)})}addToggle(e,i){const r=k8e.fromDefinition(e,i),n=Bf(this._bindings,r.key,()=>[]);return n.push(r),We(()=>L5(n,r))}register(e,i=ii.WIDGET){return In([e.on("key-down",r=>this.dispatch(e.inputManager,r),i),e.on("key-up",r=>this.dispatch(e.inputManager,r),i)])}dispatch(e,i){const r=i.key,n=this._bindings.get(r);if(n)for(const o of n)o.process(e,i)}},k8e=class UO{constructor(e,i,r,n,o){this.key=e,this.modifiers=i,this.repeats=r,this.continuePropagation=n,this.callback=o}process(e,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(e,i){if(typeof e=="string")return new UO(e,[],!1,!1,i);const{key:r,modifier:n,repeats:o,continuePropagation:u}=e;return new UO(r,n?Array.isArray(n)?n:[n]:[],!!o,!!u,i)}};function ig(t,e){const i=t.x-e.x,r=t.y-e.y;return i*i+r*r}function C8e(t,e){return Math.sqrt(ig(t,e))}function IF(t,e){e.sort((i,r)=>ph(i.targetPoint,t)-ph(r.targetPoint,t))}var ql;function Oit({point:t,distance:e,returnEdge:i,vertexMode:r,coordinateHelper:{spatialReference:n},filter:o},u,p){return p=p!=null?p.clone():new ec({where:"1=1"}),o&&(p.geometry=o.geometry,p.distance=o.distance,p.spatialRelationship=o.spatialRelationship,p.where=aS(p.where,o.where),p.timeExtent=N1e(p.timeExtent,o.timeExtent),p.objectIds=A8e(p.objectIds,o.objectIds)),{point:sw(t[0],t[1],t[2],n.toJSON()),mode:u,distance:e,returnEdge:i,vertexMode:r,query:p.toJSON()}}function A8e(t,e){return t||e?e?t?Array.from(YW(new Set(t),new Set(e))):e:t:null}function sI(t,e,i){return{left:Tn(t.leftVertex.pos,e,i),right:Tn(t.rightVertex.pos,e,i)}}function Pit(t){return t.createQuery()}(function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(ql||(ql={}));const uB=Symbol("snapping-toggle");function L8e(t,e=()=>{}){const i=ce(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:n})=>{if(t.removeHandles(uB),!r||!n)return;const o=ii.TOOL,u=[r.on("key-down",p=>{p.key!==lB.toggle||p.repeat||(n.enabledToggled=!0,e())},o),r.on("key-up",p=>{p.key===lB.toggle&&(n.enabledToggled=!1,e())},o),r.on("pointer-move",p=>{const g=p.native.ctrlKey;n.enabledToggled!==g&&(n.enabledToggled=g,e())},o)];t.addHandles(u,uB)},ri);t.addHandles(i)}function cB(t){var e;return gO(t)&&"utilityNetworks"in t&&!!((e=t.utilityNetworks)!=null&&e.length)}function MF(t){return t&&typeof t.highlight=="function"}function Loe(t,e,i){return t==null||t>=i&&(e===0||t<=e)}function O8e(t,e){if(e&&t){const{minScale:i,maxScale:r}=t;if(P8e(i,r))return Loe(e,i,r)}return!0}function P8e(t,e){return t!=null&&t>0||e!=null&&e>0}function Rit(t){return!(t!=null&&t.minScale)||!t.maxScale||t.minScale>=t.maxScale}let Ta=class extends Te{set attributeRulesEnabled(e){this._set("attributeRulesEnabled",e),e&&this.loadRules()}get layerView(){var e,i;return(i=(e=this.view)==null?void 0:e.allLayerViews)==null?void 0:i.find(r=>r.layer===this.layer)}get valid(){const{_valid:e,snappingSource:i,layer:r}=this;return!(!i||!r)&&e}get subtypeFilter(){var o,u;const{layer:e,snappingSource:i}=this;if(!sv(e)||!((o=e.subtypes)!=null&&o.length)||!i)return{mode:"not-in-use",filter:null};const r=i.layerSource.sublayerSources.filter(p=>{var g;return p.enabled&&p.layer.visible&&Loe((g=this.view)==null?void 0:g.scale,p.layer.effectiveScaleRange.minScale,p.layer.effectiveScaleRange.maxScale)}).map(p=>p.layer.subtypeCode);if(!r.length)return{mode:"none-visible",filter:null};if(r.length===e.subtypes.length)return{mode:"all-visible",filter:null};const n=((u=e.fieldsIndex.get(e.subtypeField))==null?void 0:u.name)??e.subtypeField;return r.length===1?{mode:"in-use",filter:`${n} = ${r.getItemAt(0)}`}:{mode:"in-use",filter:`${n} IN (${r.join(", ")})`}}get floorFilter(){const{view:e,layer:i}=this;return e&&i?Moe({view:e,layer:i}):null}constructor(e){super(e),this.layer=null,this.snappingSource=null,this.rulesTable=null,this._valid=null}initialize(){if(!this.snappingSource||!this.layer)return void(this._valid=!1);const{layer:e,snappingSource:i}=this;if("refresh"in e){const r=e;this.addHandles(r.on("refresh",()=>i.refresh()))}this.loadRules(),this.addHandles([ce(()=>i.updating,r=>i.layerSource.updating=r,ri),ce(()=>i.availability,r=>i.layerSource.availability=r,ri)])}getFetchCandidatesParameters(e,i,r){var E,C,L,R,F;if(!this.valid)return[];const{layer:n,layerView:o,floorFilter:u,rulesTable:p,subtypeFilter:g}=this,w={distance:r,mode:((E=this.view)==null?void 0:E.type)??"2d",point:e,coordinateHelper:i.coordinateHelper,...R8e(),filter:o&&"filter"in o?o.filter:null};if(u&&(w.filter=Yk(w.filter,u)),g.mode!=="not-in-use"&&g.mode!=="all-visible"){if(g.mode==="none-visible")return[];w.filter?w.filter.where=aS(w.filter.where,g.mode):w.filter=new R2({where:g.filter})}if(!this.attributeRulesEnabled)return[w];const S=i.feature,T=((C=S==null?void 0:S.sourceLayer)==null?void 0:C.type)==="subtype-sublayer"?S.sourceLayer.parent:S==null?void 0:S.sourceLayer;if(p&&S&&cB((L=this.view)==null?void 0:L.map)&&(w2(n)||sv(n))&&n.layerId&&(w2(T)||sv(T))&&((R=this.view.map.utilityNetworks)!=null&&R.find(V=>V.isUtilityLayer(T)))){if(p.loadStatus!=="loaded")return[];const V=[],U=n.layerId,W=(F=p.getFeatureSQL(T,S))==null?void 0:F[U];if(!W)return[];const H=W.anyVertex;let J=W.endVertex;return J&&H&&J===H&&(J=""),J&&V.push({...w,returnEdge:!1,vertexMode:"ends",filter:Yk(w.filter,J)}),H&&V.push({...w,returnEdge:!1,vertexMode:"all",filter:Yk(w.filter,H)}),V}return[w]}async loadRules(){var n,o,u;this._valid=null;const{layer:e,view:i,attributeRulesEnabled:r}=this;if(r&&e&&i&&cB(i==null?void 0:i.map)&&(w2(e)||sv(e)))try{await Promise.allSettled(((n=i.map.utilityNetworks)==null?void 0:n.map(g=>g.load()))??[]);const p=(o=i.map.utilityNetworks)==null?void 0:o.find(g=>g.isUtilityLayer(e));p&&(this.rulesTable=await p.getRulesTable(),await((u=this.rulesTable)==null?void 0:u.load()))}catch{return this._valid=!1,void fe.getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",e.title)}this._valid=!0}remove(){this.destroy()}destroy(){var e;(e=this.snappingSource)==null||e.destroy()}};function R8e(){return{returnEdge:!0,vertexMode:"all"}}function Yk(t,e){return t==null?new R2({where:e}):t.where?new R2({where:aS(t.where,e)}):new R2({where:e})}m([b({constructOnly:!0})],Ta.prototype,"layer",void 0),m([b({constructOnly:!0})],Ta.prototype,"snappingSource",void 0),m([b({constructOnly:!0})],Ta.prototype,"view",void 0),m([b({value:!1})],Ta.prototype,"attributeRulesEnabled",null),m([b()],Ta.prototype,"layerView",null),m([b()],Ta.prototype,"rulesTable",void 0),m([b()],Ta.prototype,"valid",null),m([b()],Ta.prototype,"subtypeFilter",null),m([b()],Ta.prototype,"floorFilter",null),m([b()],Ta.prototype,"_valid",void 0),Ta=m([G("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],Ta);let cw=class{constructor(e,i,r,n){this.targetPoint=e,this.constraint=i,this.isDraped=r,this.domain=n}},kF=class extends cw{constructor({targetPoint:e,objectId:i,constraint:r,isDraped:n}){super(e,r,n,Hn.FEATURE),this.objectId=i}},JM=class{constructor(e,i){this.isDraped=e,this.domain=i}},wh=class Ooe extends JM{constructor(e,i,r,n,o=Hn.ALL,u=!0,p=!0){super(n,o),this.type=e,this.lineStart=i,this.lineEnd=r,this.fadeLeft=u,this.fadeRight=p}equals(e){return e instanceof Ooe&&this.type===e.type&&Si(this.lineStart,e.lineStart)&&Si(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return Gm(this.lineStart,this.lineEnd)}},Poe=class extends kF{constructor(e){super({...e,isDraped:!0,constraint:new Toe(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new wh(ql.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Roe=class extends kF{constructor(e){super({...e,constraint:new _F(e.edgeStart,e.edgeEnd)})}get hints(){return[new wh(ql.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Foe=class Noe extends JM{constructor(e,i,r,n,o=Hn.ALL){super(n,o),this.previousVertex=e,this.centerVertex=i,this.nextVertex=r}equals(e){return e instanceof Noe&&Si(this.previousVertex,e.previousVertex)&&Si(this.centerVertex,e.centerVertex)&&Si(this.nextVertex,e.nextVertex)}},CF=class extends cw{constructor({targetPoint:e,constraint:i,previousVertex:r,otherVertex:n,otherVertexType:o,isDraped:u,selfSnappingType:p,objectId:g,domain:w}){super(e,i,u,w??Hn.SELF),this.previousVertex=r,this.otherVertex=n,this.otherVertexType=o,this.selfSnappingType=p??zf.None,this.objectId=g??null}get hints(){const e=this.previousVertex,i=this.otherVertexType===Mb.CENTER?this.otherVertex:this.targetPoint,r=this.otherVertexType===Mb.CENTER?this.targetPoint:this.otherVertex;return[new wh(ql.TARGET,i,r,this.isDraped,this.domain),new wh(ql.REFERENCE,e,i,this.isDraped,this.domain),new Foe(this.previousVertex,i,r,this.isDraped,this.domain)]}};var Mb,zf;(function(t){t[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER"})(Mb||(Mb={})),function(t){t[t.None=0]="None",t[t.LastVertex=1]="LastVertex",t[t.FirstVertex=2]="FirstVertex",t[t.ExistingEdge=3]="ExistingEdge"}(zf||(zf={}));function F8e(t,e,i,r,n=be()){const o=ki(GO,t);return o[2]=Jse(r,o,e,i)||0,r.renderCoordsHelper.toRenderCoords(o,e,n),n}function Xs(t,e,i,r){return r.type==="2d"?(m$.x=t[0],m$.y=t[1],m$.spatialReference=e,r.toScreen(m$)):(F8e(t,e,i,r,GO),r.state.camera.projectToScreen(GO,Xk),Mr(Xk[0],Xk[1]))}const m$=sw(0,0,0,null),GO=be(),Xk=V0e();let df=class extends Te{get updating(){return this._snappingSources.some(e=>{var i;return(e==null?void 0:e.valid)==null||e.valid===!0&&((i=e.snappingSource)==null?void 0:i.updating)===!0})||this._updatingHandles.updating}constructor(e){super(e),this.options=null,this._domain=Hn.FEATURE,this._updatingHandles=new Ua,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const e=F0e(()=>{var i;return(i=this.options)==null?void 0:i._effectiveFeatureSources},(i,r)=>this._createSourceInfo(i,r));this._snappingSources=e,this.addHandles([PW(e),ce(()=>{var i;return{rulesEnabled:!!((i=this.options)!=null&&i.attributeRulesEnabled),sources:this._snappingSources.filter(Rt)}},({rulesEnabled:i,sources:r})=>{for(const n of r)n.attributeRulesEnabled=i},$s)])}destroy(){this._set("options",null),this._updatingHandles.destroy()}async fetchCandidates(e,i,r,n){var g,w,S;if(!(i&this._domain&&this.options!=null&&this.options.effectiveFeatureEnabled))return[];const o=[],u=this._computeScreenSizeDistanceParameters(e,r);for(const T of this._snappingSources){if(!(T!=null&&T.valid)||!((w=(g=T.snappingSource)==null?void 0:g.layerSource)!=null&&w.enabled)||(S=T.layerView)!=null&&S.suspended)continue;const E=T.getFetchCandidatesParameters(e,r,u);for(const C of E)o.push(T.snappingSource.fetchCandidates(C,n).then(L=>L.filter(R=>!this._candidateIsExcluded(T.snappingSource,R,r.excludeFeature))))}const p=(await JW(o)).flat();return this._addRightAngleCandidates(p,e,u,r),At(n),IF(e,p),p}_addRightAngleCandidates(e,i,r,n){var T,E,C,L,R,F,V,U;const o=n.vertexHandle!=null?(E=(T=n.vertexHandle.rightEdge)==null?void 0:T.rightVertex)==null?void 0:E.pos:n.editGeometryOperations!=null&&n.editGeometryOperations.data.type==="polygon"?(L=(C=n.editGeometryOperations.data.components[0])==null?void 0:C.getFirstVertex())==null?void 0:L.pos:null,u=n.vertexHandle!=null?(F=(R=n.vertexHandle.leftEdge)==null?void 0:R.leftVertex)==null?void 0:F.pos:n.editGeometryOperations!=null?(U=(V=n.editGeometryOperations.data.components[0])==null?void 0:V.getLastVertex())==null?void 0:U.pos:null,{view:p}=this,g=Tn(o,p,n),w=Tn(u,p,n),S=e.length;for(let W=0;W<S;W++)this._addRightAngleCandidate(e[W],w,i,r,e),this._addRightAngleCandidate(e[W],g,i,r,e)}_addRightAngleCandidate(e,i,r,n,o){if(i==null||!N8e(e))return;const u=e.constraint.closestTo(i),p=(u[0]-r[0])/n.x,g=(u[1]-r[1])/n.y,{start:w,end:S}=e.constraint;if(p*p+g*g<=1){const T=tc(u,w)>tc(u,S)?w:S,E=new CF({targetPoint:Kf(u),otherVertex:i,otherVertexType:Mb.NEXT,previousVertex:T,constraint:new xoe(i,u),objectId:e.objectId,isDraped:e.isDraped,domain:Hn.FEATURE});o.push(E)}}_computeScreenSizeDistanceParameters(e,i){let r=this.options!=null?this.options.distance*(i.pointer==="touch"?this.options.touchSensitivityMultiplier:1):0;return this.view==null?{x:r,y:r,z:r,distance:r}:this.view.type==="2d"?(r*=this.view.resolution,{x:r,y:r,z:r,distance:r}):this._computeScreenSizeDistanceParameters3D(e,r,this.view,i)}_computeScreenSizeDistanceParameters3D(e,i,r,n){const{spatialReference:o}=n;r.renderCoordsHelper.toRenderCoords(e,o,hB);const u=r.state.camera.computeScreenPixelSizeAt(hB),p=u*r.renderCoordsHelper.unitInMeters,g=p/hr(o),w=p/Gl(o),S=i*g,T=i*w,E=Xs(e,o,Jr,r),C=E?Qk(E,e,g,0,0,r,n):0,L=E?Qk(E,e,0,g,0,r,n):0,R=E?Qk(E,e,0,0,w,r,n):0;return{x:C===0?0:S/C,y:L===0?0:S/L,z:R===0?0:T/R,distance:u*i}}_candidateIsExcluded(e,i,r){if(r==null)return!1;const n=this._getCandidateObjectId(i);if(n==null)return!1;const o=e.layerSource.layer;return o.type==="graphics"?r.uid===n:r.sourceLayer===o&&!(!r.attributes||!("objectIdField"in o))&&r.attributes[o.objectIdField]===n}_getCandidateObjectId(e){return e instanceof kF?e.objectId:null}async _createSourceInfo(e,i){const r=e.layer;r.loaded||(await r.load(),At(i));const{view:n}=this,o=await this._createFeatureSnappingSourceType(e);return At(i),new Ta(o==null?{}:{snappingSource:o,view:n,layer:r})}async _createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}async _createFeatureSnappingSourceSceneLayer(e){const{view:i}=this;return i==null||i.type!=="3d"?null:new(await this._getSourceModule("scene")).SceneLayerSnappingSource({layerSource:e,view:i})}async _createFeatureSnappingSourceFeatureLayer(e){var i;switch((i=e.layer.source)==null?void 0:i.type){case"feature-layer":case"oriented-imagery":return new(await this._getSourceModule("featureService")).FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e});case"memory":case"csv":case"geojson":case"wfs":return e.layer.geometryType==="mesh"?null:new(await this._getSourceModule("featureCollection")).FeatureCollectionSnappingSource({layerSource:e,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(e){return new(await this._getSourceModule("graphics")).GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _createFeatureSnappingSourceMapNotesLayer(e){return new(await this._getSourceModule("notes")).GraphicsSnappingSource({getGraphicsLayers:()=>{var i;return((i=e.layer.sublayers)==null?void 0:i.toArray())??[]},spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _getSourceModule(e){const i=this._sourceModules[e];if(i.loader==null){const r=this._loadSourceModule(e),n={module:null,loader:r};this._sourceModules[e]=n;const o=await r,u={module:o,loader:r};return this._sourceModules[e]=u,o}return i.module==null?i.loader:i.module}_loadSourceModule(e){const i=this._updatingHandles;switch(e){case"featureService":return i.addPromise(ie(()=>import("./FeatureServiceSnappingSource-DrgyL8xV.js"),__vite__mapDeps([298,299,300,301,4])));case"featureCollection":return i.addPromise(ie(()=>import("./FeatureCollectionSnappingSource-DVHHzaaC.js"),__vite__mapDeps([302,299,300,301,57])));case"graphics":case"notes":return i.addPromise(ie(()=>import("./GraphicsSnappingSource-BOzEOAxq.js"),__vite__mapDeps([303,163,12,13,14,15,25,26,27,28,17,29,30,31,32,33,19,20,21,299,300,301,57])));case"scene":return i.addPromise(ie(()=>import("./SceneLayerSnappingSource-CLC8NkqL.js"),__vite__mapDeps([304,4,36,37,38,39,40,41,42,43,44,45,46,47,300,301])))}}get test(){}};function N8e(t){return(t instanceof Roe||t instanceof Poe)&&!D8e(t)}function D8e({constraint:{start:t,end:e}}){const i=ph(t,e),r=tc(t,e);return i<kr()||r/i<V8e}function Qk(t,e,i,r,n,o,{spatialReference:u}){const p=ki(j8e,e);p[0]+=i,p[1]+=r,p[2]+=n;const g=Xs(p,u,Jr,o);return g?C8e(g,t):1/0}m([b({constructOnly:!0})],df.prototype,"spatialReference",void 0),m([b({constructOnly:!0})],df.prototype,"view",void 0),m([b()],df.prototype,"options",void 0),m([b({readOnly:!0})],df.prototype,"updating",null),m([b()],df.prototype,"_snappingSources",void 0),df=m([G("esri.views.interactive.snapping.FeatureSnappingEngine")],df);const hB=be(),j8e=be(),V8e=1e-4;let ZM=class{constructor(e,i){this.view=e,this.options=i,this.squaredShortLineThreshold=Bp.shortLineThreshold*Bp.shortLineThreshold}snap(e,i){return i.vertexHandle!=null?i.vertexHandle.type!=="vertex"?[]:this.snapExistingVertex(e,i):this.snapNewVertex(e,i)}edgeExceedsShortLineThreshold(e,i){return this.exceedsShortLineThreshold(Tn(e.leftVertex.pos,this.view,i),Tn(e.rightVertex.pos,this.view,i),i)}exceedsShortLineThreshold(e,i,{spatialReference:r}){return this.squaredShortLineThreshold===0||ig(Xs(i,r,Jr,this.view),Xs(e,r,Jr,this.view))>this.squaredShortLineThreshold}isVertical(e,i,{spatialReference:r}){const n=hr(r);return g0(e,i)*n<Bp.verticalLineThresholdMeters}squaredProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,r=e*i;return r*r}},Doe=class extends cw{constructor({lineStart:e,lineEnd:i,targetPoint:r,isDraped:n}){super(r,new $oe(e,i),n,Hn.SELF),this._referenceLineHint=new wh(ql.REFERENCE_EXTENSION,e,i,n,this.domain)}get hints(){return[this._referenceLineHint,new wh(ql.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}};function z8e(t,e){for(var i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in t)){const o=Object.getOwnPropertyDescriptor(r,n);o&&Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var joe={exports:{}};(function(t,e){function i(){function n(d){if(typeof d=="number")return Y.Tc.Zg(d);if(d==null)return null;if(Kl[d]!=null)return Y.Tc.Zg(Kl[d]);throw Error("Unrecognised Unit Type")}function o(d){if(typeof d=="number")return Y.Tc.Zg(d);if(d==null)return null;if(JS[d]!=null)return Y.Tc.Zg(JS[d]);throw Error("Unrecognised Unit Type")}function u(d){if(d)switch(d){case"loxodrome":return 1;case"great-elliptic":return 2;case"normal-section":return 3;case"shape-preserving":return 4}return 0}function p(d,O,x,h){if(x==null||x.B())return null;switch(x.getType()){case Y.qn.Point:return d.exportPoint(O,x,h);case Y.qn.Polygon:return d.exportPolygon(O,x,h);case Y.qn.Polyline:return d.exportPolyline(O,x,h);case Y.qn.MultiPoint:return d.exportMultipoint(O,x,h);case Y.qn.Envelope:return d.exportExtent(O,x,h)}return null}function g(d,O,x,h){if(x.getType()!==Y.qn.Point)throw Error("Geometry not Point");return d.exportPoint(O,x,h)}function w(d,O,x){return d.convertToGEGeometry(O,x)}function S(d){var O=d.wkid;d=d.wkt2||d.wkt;var x=Mh.get(O||d);return x==null&&(O!==-1&&O!=null?(x=Y.Eg.create(O),Mh.set(O,x)):d&&(x=Y.Eg.qP(d),Mh.set(d,x)),cd.has(O||d)&&x.VW(cd.get(O||d))),x}function T(d){var O,x,h;if(d==null)return null;var l=S(d);return d=l.Hd(),l=l.Kn(),(O={}).tolerance=l,O.unitType=d==null?-1:d.od,O.unitID=d==null?-1:d.Ec(),O.unitBaseFactor=d==null?0:d.ai,O.unitSquareDerivative=d==null?0:(h=(x=Y.Tc.aG(d))===null||x===void 0?void 0:x.Ec())!==null&&h!==void 0?h:0,O}function E(d,O,x,h){return x==null?null:(x=Y.$b.clip(w(d,Pe,x),w(d,Pe,h),S(O)),p(d,Pe,x,O))}function C(d,O,x,h){x=Y.$b.dl(w(d,Pe,x),w(d,Pe,h),S(O)),h=[];for(var l=0;l<x.length;l++)h.push(p(d,Pe,x[l],O));return h}function L(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.contains(w(d,Pe,x),w(d,Pe,h),S(O))}function R(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.BP(w(d,Pe,x),w(d,Pe,h),S(O))}function F(d,O,x,h,l){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.tb(w(d,Pe,x),w(d,Pe,h),S(O),n(l))}function V(d,O,x,h){return!(x==null&&h!=null||h==null&&x!=null)&&Y.$b.Nb(w(d,Pe,x),w(d,Pe,h),S(O))}function U(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.TS(w(d,Pe,x),w(d,Pe,h),S(O))}function W(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.touches(w(d,Pe,x),w(d,Pe,h),S(O))}function H(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.qY(w(d,Pe,x),w(d,Pe,h),S(O))}function J(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.TP(w(d,Pe,x),w(d,Pe,h),S(O))}function X(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.DU(w(d,Pe,x),w(d,Pe,h),S(O))}function te(d,O,x,h,l){if(x==null||h==null)throw Error("Illegal Argument Exception");return Y.$b.yB(w(d,Pe,x),w(d,Pe,h),S(O),l)}function oe(d,O,x){if(x==null)throw Error("Illegal Argument Exception");return Y.$b.dT(w(d,Pe,x),S(O))}function pe(d,O,x){if(x==null)throw Error("Illegal Argument Exception");return x=Y.$b.eC(w(d,Pe,x),S(O)),p(d,Pe,x,O)}function de(d,O,x,h){if(h===void 0&&(h=!1),x==null)throw Error("Illegal Argument Exception");if(Array.isArray(x)){var l=h,s=[];for(h=0;h<x.length;h++)s.push(w(d,Pe,x[h]));for(x=Y.$b.jP(s,l),l=Array(x.length),h=0;h<x.length;h++)l[h]=p(d,Pe,x[h],O);return l}return h=Y.$b.iP(w(d,Pe,x),S(O)),p(d,Pe,h,O)}function ge(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");if(Array.isArray(x)){for(var l=[],s=0;s<x.length;s++)l.push(w(d,Pe,x[s]));for(x=Y.$b.QP(l,w(d,Pe,h),S(O)),h=Array(x.length),s=0;s<x.length;s++)h[s]=p(d,Pe,x[s],O);return h}return s=Y.$b.im(w(d,Pe,x),w(d,Pe,h),S(O)),p(d,Pe,s,O)}function we(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");if(Array.isArray(x)){for(var l=[],s=0;s<x.length;s++)l.push(w(d,Pe,x[s]));for(x=Y.$b.VX(l,w(d,Pe,h),S(O)),h=Array(x.length),s=0;s<x.length;s++)h[s]=p(d,Pe,x[s],O);return h}return s=Y.$b.ep(w(d,Pe,x),w(d,Pe,h),S(O)),p(d,Pe,s,O)}function ke(d,O,x,h){if(x==null||h==null)throw Error("Illegal Argument Exception");if(Array.isArray(x)){for(var l=[],s=0;s<x.length;s++)l.push(w(d,Pe,x[s]));for(x=Y.$b.RS(l,w(d,Pe,h),S(O)),h=Array(x.length),s=0;s<x.length;s++)h[s]=p(d,Pe,x[s],O);return h}return s=Y.$b.Ea(w(d,Pe,x),w(d,Pe,h),S(O)),p(d,Pe,s,O)}function $e(d,O,x,h){if(x==null)return null;var l=[];if(Array.isArray(x)){if(x.length===0)return null;for(h=0;h<x.length;h++)l.push(w(d,Pe,x[h]))}else l.push(w(d,Pe,x)),h!=null&&l.push(w(d,Pe,h));return p(d,Pe,Y.$b.jY(l,S(O)),O)}function Fe(d,O,x,h,l,s,a,c){var f=0;if(s!=null)switch(s){case"round":f=0;break;case"bevel":f=1;break;case"miter":f=2;break;case"square":f=3}if(Array.isArray(x)){if(x==null)d=null;else if(x.length===0)d=[];else{var y=[];for(s=0;s<x.length;s++)y.push(w(d,Pe,x[s]));for(x=Y.$b.BU(y,S(O),h,f,a,c,n(l)),h=Array(x.length),s=0;s<x.length;s++)h[s]=p(d,Pe,x[s],O);d=h}return d}return x=Y.$b.offset(w(d,Pe,x),S(O),h,f,a,c,n(l)),p(d,Pe,x,O)}function yt(d,O,x,h,l,s){if(s===void 0&&(s=!1),Array.isArray(x)){if(!Array.isArray(h)){for(var a=[],c=0;c<x.length;c++)a.push(h);h=a}if(h.length!=x.length){if(h.length==0)throw Error("Illegal Argument Exception");a=[];var f=0;for(c=0;c<x.length;c++)h[c]===void 0?a.push(f):(a.push(h[c]),f=h[c]);h=a}return Ue(d,O,x,h,l,!1,s,"geodesic",NaN)}return x=Y.$b.buffer(w(d,Pe,x),S(O),h,n(l),!1,0,NaN),p(d,Pe,x,O)}function qe(d,O,x,h,l,s,a,c){if(Array.isArray(x)){if(!Array.isArray(h)){for(var f=[],y=0;y<x.length;y++)f.push(h);h=f}if(h.length!==x.length){if(h.length===0)throw Error("Illegal Argument Exception");f=[];var v=0;for(y=0;y<x.length;y++)h[y]===void 0?f.push(v):(f.push(h[y]),v=h[y]);h=f}return Ue(d,O,x,h,l,!0,s,a,c)}return a===void 0&&(a=NaN),x=Y.$b.buffer(w(d,Pe,x),S(O),h,n(l),!0,u(s),a),p(d,Pe,x,O)}function Ue(d,O,x,h,l,s,a,c,f){if(f===void 0&&(f=NaN),x==null)return null;if(x.length===0)return[];for(var y=[],v=0;v<x.length;v++)y.push(w(d,Pe,x[v]));for(x=Y.$b.MN(y,S(O),h,n(l),s,a,u(c),f),h=Array(x.length),v=0;v<x.length;v++)h[v]=p(d,Pe,x[v],O);return h}function ei(d,O,x,h,l){var s;return l===void 0&&(l=!0),x=Y.$b.nz(w(d,Pe,x),w(d,Pe,h),l),(s={}).coordinate=g(d,Pe,x.fz(),O),s.distance=x.hz(),s.isRightSide=x.Sz(),s.vertexIndex=x.Ua(),s.isEmpty=x.B(),s}function jr(d,O,x,h){var l;return x=Y.$b.oz(w(d,Pe,x),w(d,Pe,h)),(l={}).coordinate=g(d,Pe,x.fz(),O),l.distance=x.hz(),l.isRightSide=x.Sz(),l.vertexIndex=x.Ua(),l.isEmpty=x.B(),l}function cs(d,O,x,h,l,s){var a;for(x=Y.$b.pz(w(d,Pe,x),w(d,Pe,h),l,s),h=[],l=0;l<x.length;l++)x[l].B()===!1&&h.push(((a={}).coordinate=g(d,Pe,x[l].fz(),O),a.distance=x[l].hz(),a.isRightSide=x[l].Sz(),a.vertexIndex=x[l].Ua(),a.isEmpty=x[l].B(),a));return h}function eo(d,O,x,h,l,s){return x=Y.$b.QQ(w(d,Pe,x),S(O),h,l,n(s)),p(d,Pe,x,O)}function to(d,O,x,h,l){return x=Y.$b.Qr(w(d,Pe,x),S(O),h,n(l)),p(d,Pe,x,O)}function On(d,O,x,h,l,s){return s===void 0&&(s=0),x=Y.$b.Wy(w(d,Pe,x),S(O),h,n(l),s),p(d,Pe,x,O)}function Is(d,O,x,h){if(x==null)throw Error("Illegal Argument Exception");return Y.$b.JU(w(d,Pe,x),S(O),o(h))}function sa(d,O,x,h){if(x==null)throw Error("Illegal Argument Exception");return Y.$b.KU(w(d,Pe,x),S(O),n(h))}function Ha(d,O,x,h,l){if(x==null)throw Error("Illegal Argument Exception");return Y.$b.WQ(w(d,Pe,x),S(O),o(h),u(l))}function oa(d,O,x,h,l){if(x==null)throw Error("Illegal Argument Exception");return Y.$b.ZQ(w(d,Pe,x),S(O),n(h),u(l))}function hn(d){Y.NL.bind(d)}function Wl(d,O,x,h,l){var s=null,a=null;if(h){if(!l)throw Y.i.N("AOI missing Spatial Reference");s=w(d,Pe,h),a=S(l).fh()}return(d=Y.gu.XR(S(O).fh(),S(x).fh(),s,a))!==null?d:null}function sg(d,O,x,h,l){var s=null,a=null;if(h){if(!l)throw Y.i.N("AOI missing Spatial Reference");s=w(d,Pe,h),a=S(l).fh()}return Y.gu.YR(S(O).fh(),S(x).fh(),s,a)}function og(d,O,x,h,l,s){if(l===void 0&&(l=null),s===void 0&&(s=null),s){var a=new Y.yC;a.Vu=s.densificationStep,a.Jr=s.centralMeridianOfOutputGCS,s.clipWithInputHorizon&&a.PW(s.clipWithInputHorizon),s.clipWithOutputHorizon&&a.QW(s.clipWithOutputHorizon)}if(this.KY===!1)throw Error("Projection Engine must be enabled using enableProjection");if(O.length===0)return[];if(l){if(!(s=l.getCachedGeTransformation(x,h)))e:{if(s=l,l=null,s){var c=s.getGTListEntry();if(c!==null){l=new Y.wC(null);for(var f=0,y=c.steps;f<y.length;f++){c=y[f];var v=new Y.Dx(c.geogtran);c.isInverse&&v.Qz(),l.add(v)}a=Y.vr.Nr(S(x).fh(),S(h).fh(),l,a),s.assignCachedGe(x,h,a),s=a;break e}}if(l===null&&s&&s.steps&&0<s.steps.length){for(l=new Y.wC(null),f=0,y=s.steps;f<y.length;f++)(c=y[f]).wkid!=-1&&c.wkid!=null?l.add(Y.Dx.create(c.wkid,c.isInverse)):l.add(Y.Dx.uP(c.wkt,c.isInverse));a=Y.vr.Nr(S(x).fh(),S(h).fh(),l,a),s.assignCachedGe(x,h,a),s=a}else s=Y.vr.Nr(S(x).fh(),S(h).fh(),l,a)}for(x=[],l=0;l<O.length;l++)a=O[l],x.push(Eo(d,a,h,s))}else for(s=Y.vr.Nr(S(x).fh(),S(h).fh(),null),x=[],l=0;l<O.length;l++)a=O[l],x.push(Eo(d,a,h,s));return x}function Eo(d,O,x,h){return O=Y.$b.zh(w(d,Pe,O),h),p(d,Pe,O,x)}function hw(d,O){d!=null&&(d=d.wkid||d.wkt2||d.wkt,cd.has(d),cd.set(d,O),Mh.has(d)&&Mh.delete(d))}function n9(d){d!=null&&(d=d.wkid||d.wkt2||d.wkt,cd.has(d)&&(cd.delete(d),Mh.has(d)&&Mh.delete(d)))}function s9(d,O,x,h){if(x==null||h==null)return[];var l=[],s=0;for(x=Y.$b.QS(w(d,Pe,x),w(d,Pe,h),S(O))||[];s<x.length;s++)l.push(p(d,Pe,x[s],O));return l}var pn,Y,Ms,WS,Kt=this&&this.__extends||function(){function d(O,x){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,l){h.__proto__=l}||function(h,l){for(var s in l)l.hasOwnProperty(s)&&(h[s]=l[s])})(O,x)}return function(O,x){function h(){this.constructor=O}d(O,x),O.prototype=x===null?Object.create(x):(h.prototype=x.prototype,new h)}}();(function(d){var O;(O=d.qn||(d.qn={}))[O.Unknown=0]="Unknown",O[O.Point=33]="Point",O[O.Line=322]="Line",O[O.Envelope=197]="Envelope",O[O.MultiPoint=550]="MultiPoint",O[O.Polyline=1607]="Polyline",O[O.Polygon=1736]="Polygon",function(h){h[h.enumMild=0]="enumMild",h[h.enumMedium=1]="enumMedium",h[h.enumHot=2]="enumHot"}(d.YK||(d.YK={}));var x=function(){function h(){this.description=null,this.VA=0}return h.prototype.getType=function(){return 0},h.prototype.Db=function(){return-1},h.prototype.Nf=function(l){this.vc(),l!=this.description&&this.sn(l)},h.prototype.sn=function(){},h.prototype.Jl=function(l){this.vc(),l!=this.description&&(l=d.ee.CR(this.description,l))!=this.description&&this.sn(l)},h.prototype.hasAttribute=function(l){return this.description.hasAttribute(l)},h.prototype.re=function(l){this.vc(),this.description.hasAttribute(l)||(l=d.ee.BR(this.description,l),this.sn(l))},h.prototype.Tg=function(){return null},h.prototype.bn=function(){},h.prototype.A=function(){},h.prototype.Qo=function(){},h.prototype.xc=function(l){this.A(l)},h.prototype.B=function(){return!0},h.prototype.Oa=function(){},h.prototype.Oc=function(){},h.prototype.Ia=function(){return null},h.prototype.copyTo=function(){},h.prototype.Ke=function(){return 0},h.prototype.Qb=function(){return 0},h.prototype.iG=function(){return this.hasAttribute(1)},h.tf=function(l){return 1+((192&l)>>6)>>1},h.Rn=function(l){return!!(32&l)},h.US=function(l){return!!(128&l)},h.yd=function(l){return!!(256&l)},h.xj=function(l){return!!(512&l)},h.Hc=function(l){return!!(1024&l)},h.prototype.Of=function(){var l=this.Ia();return this.copyTo(l),l},h.prototype.mg=function(){return null},h.jg=function(l){var s=l.Ia();return l.copyTo(s),s},h.prototype.vc=function(){0<=this.VA&&(this.VA+=2147483649)},h.Ax=function(l){var s=l.getType();if(h.xj(s))return l.I();if(l.B())return 0;if(s==197)return 4;if(s==33)return 1;if(h.yd(s))return 2;throw d.i.fa("missing type")},h}();d.aa=x})(Y||(Y={})),Ms=Y||(Y={}),WS=function(){function d(){this.y=this.x=0}return d.construct=function(O,x){var h=new d;return h.x=O,h.y=x,h},d.al=function(O){var x=new d;return x.x=O.x,x.y=O.y,x},d.prototype.ma=function(O,x){this.x=O,this.y=x},d.prototype.L=function(O){this.x=O.x,this.y=O.y},d.prototype.fq=function(O,x){return this.x===O&&this.y===x},d.prototype.Rz=function(O){return 2220446049250313e-31>=Math.abs(this.x-O.x)&&2220446049250313e-31>=Math.abs(this.y-O.y)},d.prototype.qb=function(O){return this.x===O.x&&this.y===O.y},d.prototype.Nb=function(O){return O==this||O instanceof d&&this.x==O.x&&this.y==O.y},d.prototype.sub=function(O){this.x-=O.x,this.y-=O.y},d.prototype.uc=function(O,x){this.x=O.x-x.x,this.y=O.y-x.y},d.prototype.add=function(O,x){x!==void 0?(this.x=O.x+x.x,this.y=O.y+x.y):(this.x+=O.x,this.y+=O.y)},d.prototype.Sq=function(){this.x=-this.x,this.y=-this.y},d.prototype.mt=function(O){this.x=-O.x,this.y=-O.y},d.prototype.NS=function(O,x,h){this.x=O.x*(1-h)+x.x*h,this.y=O.y*(1-h)+x.y*h},d.prototype.Ct=function(O,x){this.x=this.x*O+x.x,this.y=this.y*O+x.y},d.prototype.HW=function(O,x,h){this.x=x.x*O+h.x,this.y=x.y*O+h.y},d.prototype.scale=function(O){this.x*=O,this.y*=O},d.prototype.compare=function(O){return this.y<O.y?-1:this.y>O.y?1:this.x<O.x?-1:this.x>O.x?1:0},d.prototype.normalize=function(){var O=this.length();O==0&&(this.x=1,this.y=0),this.x/=O,this.y/=O},d.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},d.prototype.Sk=function(){return this.x*this.x+this.y*this.y},d.tb=function(O,x){return Math.sqrt(this.yc(O,x))},d.Oy=function(O,x,h,l){return O-=h,x-=l,Math.sqrt(O*O+x*x)},d.prototype.Qh=function(O){return this.x*O.x+this.y*O.y},d.prototype.fD=function(O){return Math.abs(this.x*O.x)+Math.abs(this.y*O.y)},d.prototype.wi=function(O){return this.x*O.y-this.y*O.x},d.prototype.Bt=function(O,x){var h=-this.x*x+this.y*O;this.x=this.x*O+this.y*x,this.y=h},d.prototype.Hv=function(){var O=this.x;this.x=-this.y,this.y=O},d.prototype.MG=function(O){this.x=-O.y,this.y=O.x},d.prototype.ar=function(){var O=this.x;this.x=this.y,this.y=-O},d.prototype.qu=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:this.x==0?4:3},d.nu=function(O,x){var h=O.qu(),l=x.qu();return l==h?0>(O=O.wi(x))?1:0<O?-1:0:h<l?-1:1},d.yc=function(O,x){var h=O.x-x.x;return h*h+(O=O.y-x.y)*O},d.prototype.toString=function(){return"("+this.x+" , "+this.y+")"},d.prototype.Rc=function(){this.y=this.x=NaN},d.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)},d.prototype.offset=function(O,x){var h=d.tb(O,x),l=d.construct(this.x,this.y);if(h==0)return d.tb(l,O);var s=new d;return s.L(x),s.sub(O),l.sub(O),l.wi(s)/h},d.Uq=function(O,x,h){var l=new Ms.Wb;l.set(x.x),l.sub(O.x);var s=new Ms.Wb;s.set(h.y),s.sub(O.y);var a=new Ms.Wb;a.set(x.y),a.sub(O.y);var c=new Ms.Wb;return c.set(h.x),c.sub(O.x),l.Ag(s),a.Ag(c),l.sub(a),l.ps()?(l=new Ms.hp(x.x),s=new Ms.hp(O.x),a=new Ms.hp(O.y),l=l.jt(s),O=(O=new Ms.hp(h.y)).jt(a),x=(x=new Ms.hp(x.y)).jt(a),h=(h=new Ms.hp(h.x)).jt(s),l=l.lr(O),x=x.lr(h),(l=l.lr(x)).nT()?-1:l.fS()?1:0):0>(h=l.value())?-1:0<h?1:0},d.prototype.cc=function(){return Ms.O.uj(Ms.O.uj())},d}(),Ms.h=WS,function(d){var O=function(){function x(h){this.Fy=this.Mt=0,this.OX=h}return x.prototype.reset=function(){this.Fy=this.Mt=0},x.prototype.add=function(h){h-=this.Fy;var l=this.Mt+h;this.Fy=l-this.Mt-h,this.Mt=l},x.prototype.sub=function(h){this.add(-h)},x.prototype.rm=function(){return this.OX+this.Mt},x}();d.Fx=O,d.lc=function(){function x(){}return x.Cn=function(h,l){return 0<=l?Math.abs(h):-Math.abs(h)},x.sign=function(h){return 0>h?-1:0<h?1:0},x.RK=function(h){return h-360*Math.floor(h/360)},x.round=function(h){return Math.floor(h+.5)},x.ox=function(h){return h*h},x.hq=function(h,l,s){return .5>=s?h+(l-h)*s:l-(l-h)*(1-s)},x.OG=function(h,l,s,a){.5>=s?(a.x=h.x+(l.x-h.x)*s,a.y=h.y+(l.y-h.y)*s):(a.x=l.x-(l.x-h.x)*(1-s),a.y=l.y-(l.y-h.y)*(1-s))},x.lT=function(h,l,s,a,c,f){.5>=c?(f.x=h+(s-h)*c,f.y=l+(a-l)*c):(f.x=s-(s-h)*(1-c),f.y=a-(a-l)*(1-c))},x}()}(Y||(Y={})),function(d){var O=function(x){function h(){var l=x.call(this)||this;return l.sa=0,l.na=0,l.pa=0,l.la=0,l.ka=null,l}return Kt(h,x),h.prototype.ac=function(){return d.h.construct(this.sa,this.na)},h.prototype.Yp=function(l){l.x=this.sa,l.y=this.na},h.prototype.Dc=function(l){this.em(0,l)},h.prototype.ZB=function(l,s){this.em(0,d.h.construct(l,s))},h.prototype.To=function(l){this.hD(0,l)},h.prototype.setStart=function(l){this.uD(0,l)},h.prototype.wv=function(l,s){return this.Od(0,l,s)},h.prototype.YB=function(l,s,a){this.tn(0,l,s,a)},h.prototype.wc=function(){return d.h.construct(this.pa,this.la)},h.prototype.Tr=function(l){l.x=this.pa,l.y=this.la},h.prototype.Qc=function(l){this.em(1,l)},h.prototype.Ql=function(l,s){this.em(1,d.h.construct(l,s))},h.prototype.Po=function(l){this.hD(1,l)},h.prototype.setEnd=function(l){this.uD(1,l)},h.prototype.gv=function(l,s){return this.Od(1,l,s)},h.prototype.OB=function(l,s,a){this.tn(1,l,s,a)},h.prototype.Db=function(){return 1},h.prototype.B=function(){return this.Ac()},h.prototype.Oa=function(){},h.prototype.Ke=function(){return 0},h.prototype.Ea=function(l,s,a,c,f){return this.KM(l,s,a,c,f)},h.prototype.isIntersecting=function(l,s){return this.zr(l,s,!1)!=0},h.prototype.qs=function(l,s){return this.ru(l,s,!1)},h.prototype.ru=function(){return null},h.prototype.Ac=function(){return!1},h.prototype.ay=function(l){if(this.vc(),this.ka==null&&0<l)this.ka=d.O.lg(2*l);else if(this.ka!=null&&this.ka.length<2*l){for(var s=this.ka.slice(0),a=this.ka.length;a<2*l;a++)s[a]=0;this.ka=s}},h.gM=function(l,s,a){if(0<a)var c=0;for(var f=0;f<a;f++)s[0+c]=l[0],c++},h.prototype.em=function(l,s){l!=0?(this.pa=s.x,this.la=s.y):(this.sa=s.x,this.na=s.y)},h.prototype.sn=function(l){if(this.ka!=null){for(var s=d.ee.Iw(l,this.description),a=[],c=h.Gg(this.description,0),f=h.Gg(this.description,1),y=h.Gg(l,0),v=h.Gg(l,1),_=0,$=1,I=l.Aa;$<I;$++){var k=l.kd($),A=d.ra.Va(k);if(s[$]==-1){var P=d.ra.se(k);for(k=0;k<A;k++)a[y+_]=P,a[v+_]=P,_++}else for(P=this.description.$j(s[$])-2,k=0;k<A;k++)a[y+_]=this.ka[c+P],a[v+_]=this.ka[f+P],_++,P++}this.ka=a}this.description=l},h.prototype.hD=function(l,s){if(this.Ac())throw d.i.fa("empty geometry");s.Nf(this.description),s.Ac()&&s.un();for(var a=0;a<this.description.Aa;a++)for(var c=this.description.Ed(a),f=0,y=d.ra.Va(c);f<y;f++){var v=this.Od(l,c,f);s.setAttribute(c,f,v)}},h.prototype.uD=function(l,s){if(this.vc(),s.Ac())throw d.i.fa("empty geometry");for(var a=s.description,c=0,f=a.Aa;c<f;c++)for(var y=a.Ed(c),v=d.ra.Va(y),_=0;_<v;_++){var $=s.Uc(y,_);this.tn(l,y,_,$)}},h.prototype.Od=function(l,s,a){if(this.Ac())throw d.i.fa("This operation was performed on an Empty Geometry.");if(s==0)return l!=0?a!=0?this.la:this.pa:a!=0?this.na:this.sa;if(a>=d.ra.Va(s))throw d.i.ce();var c=this.description.Pf(s);return 0<=c?(this.ka!=null&&this.ay(this.description.Ae.length-2),this.ka[h.Gg(this.description,l)+this.description.$j(c)-2+a]):d.ra.se(s)},h.prototype.tn=function(l,s,a,c){if(this.vc(),a>=d.ra.Va(s))throw d.i.ce();var f=this.description.Pf(s);0>f&&(this.re(s),f=this.description.Pf(s)),s==0?l!=0?a!=0?this.la=c:this.pa=c:a!=0?this.na=c:this.sa=c:(this.ka==null&&this.ay(this.description.Ae.length-2),this.ka[h.Gg(this.description,l)+this.description.$j(f)-2+a]=c)},h.prototype.copyTo=function(l){if(l.getType()!=this.getType())throw d.i.N();l.description=this.description,l.ay(this.description.Ae.length-2),h.gM(this.ka,l.ka,2*(this.description.Ae.length-2)),l.sa=this.sa,l.na=this.na,l.pa=this.pa,l.la=this.la,l.vc(),this.op(l)},h.prototype.Tg=function(l,s){var a=new d.Nc;return this.Ac()?(a.Oa(),a):(a.oa=this.Od(0,l,s),a.va=a.oa,a.Lk(this.Od(1,l,s)),a)},h.prototype.ZI=function(l){this.Ac()?l.Oa():(l.oa=this.Od(0,0,0),l.va=l.oa,l.Lk(this.Od(1,0,0)))},h.prototype.Tw=function(l,s){s.Nf(this.description),s.Cb(this.hc(l));for(var a=1,c=this.description.Aa;a<c;a++)for(var f=this.description.Ed(a),y=d.ra.Va(f),v=0;v<y;v++){var _=this.Uc(l,f,v);s.setAttribute(f,v,_)}},h.prototype.FM=function(l){if(this.description!=l.description||this.sa!=l.sa||this.pa!=l.pa||this.na!=l.na||this.la!=l.la)return!1;for(var s=0;s<2*(this.description.Ae.length-2);s++)if(this.ka[s]!=l.ka[s])return!1;return!0},h.prototype.BG=function(){return this.sa==this.pa&&this.na==this.la},h.prototype.reverse=function(){var l=this.sa;this.sa=this.pa,this.pa=l,l=this.na,this.na=this.la,this.la=l,l=1;for(var s=this.description.Aa;l<s;l++)for(var a=this.description.kd(l),c=0,f=d.ra.Va(a);c<f;c++){var y=this.Od(0,a,c),v=this.Od(1,a,c);this.tn(0,a,c,v),this.tn(1,a,c,y)}},h.prototype.zr=function(l,s,a){var c=this.getType(),f=l.getType();if(c===322){if(f==322)return d.yb.OM(this,l,s,a);throw d.i.Qa()}throw d.i.Qa()},h.prototype.KM=function(l,s,a,c,f){var y=this.getType(),v=l.getType();if(y===322){if(v==322)return d.yb.Zx(this,l,s,a,c,f);throw d.i.Qa()}throw d.i.Qa()},h.prototype.Tx=function(){return null},h.Gg=function(l,s){return s*(l.Ae.length-2)},h.prototype.hc=function(l,s){if(s===void 0)return s=new d.h,this.hc(l,s),s;d.lc.lT(this.sa,this.na,this.pa,this.la,l,s)},h.prototype.fe=function(){return null},h.prototype.eG=function(){return null},h.prototype.cq=function(){return null},h.prototype.Bi=function(){return null},h.prototype.Pn=function(){return null},h.prototype.kg=function(){return null},h.prototype.Ux=function(l,s){return s!==void 0?this.vx(s)-this.vx(l):this.vx(l)},h.prototype.op=function(){},h.prototype.dl=function(){return null},h.prototype.ah=function(){},h.prototype.Uc=function(){return null},h.prototype.Pe=function(){return null},h.prototype.vx=function(){return null},h.prototype.NG=function(){return null},h.prototype.tb=function(l,s){if(!s&&this.zr(l,0,!1)!=0)return 0;s=17976931348623157e292;var a=this.ac(),c=l.fe(a,!1);return a.sub(l.hc(c)),(a=a.length())<s&&(s=a),a=this.wc(),c=l.fe(a,!1),a.sub(l.hc(c)),(a=a.length())<s&&(s=a),a=l.ac(),c=this.fe(a,!1),a.sub(this.hc(c)),(a=a.length())<s&&(s=a),a=l.wc(),c=this.fe(a,!1),a.sub(this.hc(c)),(a=a.length())<s&&(s=a),s},h.prototype.mg=function(){return d.pi.gm(this,null)},h}(d.aa);d.SC=O}(Y||(Y={})),new Y.h,function(d){var O;(O=d.$K||(d.$K={}))[O.Unknown=-1]="Unknown",O[O.Not=0]="Not",O[O.Weak=1]="Weak",O[O.Strong=2]="Strong",function(h){h[h.DirtyIsKnownSimple=1]="DirtyIsKnownSimple",h[h.IsWeakSimple=2]="IsWeakSimple",h[h.IsStrongSimple=4]="IsStrongSimple",h[h.DirtyOGCFlags=8]="DirtyOGCFlags",h[h.DirtyVerifiedStreams=32]="DirtyVerifiedStreams",h[h.DirtyExactIntervals=64]="DirtyExactIntervals",h[h.DirtyLooseIntervals=128]="DirtyLooseIntervals",h[h.DirtyIntervals=192]="DirtyIntervals",h[h.DirtyIsEnvelope=256]="DirtyIsEnvelope",h[h.DirtyLength2D=512]="DirtyLength2D",h[h.DirtyRingAreas2D=1024]="DirtyRingAreas2D",h[h.DirtyCoordinates=1993]="DirtyCoordinates",h[h.DirtyAllInternal=65535]="DirtyAllInternal",h[h.DirtyAll=16777215]="DirtyAll"}(d.MK||(d.MK={}));var x=function(h){function l(){var s=h.call(this)||this;return s.Hm=65535,s.wa=0,s.Pg=-1,s.Bb=null,s}return Kt(l,h),l.prototype.op=function(){},l.prototype.$x=function(){},l.prototype.iy=function(){},l.prototype.I=function(){return this.wa},l.prototype.B=function(){return this.Ac()},l.prototype.Ac=function(){return this.wa==0},l.prototype.ak=function(s){return!!(this.Hm&s)},l.prototype.Lf=function(s,a){this.Hm=a?this.Hm|s:this.Hm&~s},l.prototype.mc=function(){this.ak(32)&&this.bN()},l.prototype.wx=function(){if(this.Ac())throw d.i.fa("This operation was performed on an Empty Geometry.")},l.prototype.ve=function(s,a){if(0>s||s>=this.wa)throw d.i.fa("index out of bounds");this.mc(),a.Nf(this.description),a.B()&&a.un();for(var c=0;c<this.description.Aa;c++)for(var f=this.description.Ed(c),y=0,v=d.ra.Va(f);y<v;y++){var _=this.za[c].eg(v*s+y);a.setAttribute(f,y,_)}},l.prototype.Ht=function(s,a){this.mc();for(var c=a.description,f=0;f<c.Aa;f++)for(var y=c.Ed(f),v=d.ra.Va(y),_=0;_<v;_++){var $=a.Uc(y,_);this.setAttribute(y,s,_,$)}},l.prototype.D=function(s,a){if(0>s||s>=this.I())throw d.i.ce();this.mc(),this.za[0].tc(2*s,a)},l.prototype.Na=function(s){var a=new d.h;return this.D(s,a),a},l.prototype.Gc=function(s,a){this.za[0].tc(2*s,a)},l.prototype.Cb=function(s,a,c){if(0>s||s>=this.wa)throw d.i.ce();this.mc();var f=this.za[0];c!==void 0?(f.write(2*s,a),f.write(2*s+1,c)):f.Tt(2*s,a),this.Pc(1993)},l.prototype.Cz=function(){if(void 0>=this.I())throw d.i.ce();this.mc();var s=this.za[0],a=new d.Nd;return a.x=s.read(NaN),a.y=s.read(NaN),a.z=this.hasAttribute(1)?this.za[1].eg():d.ra.se(1),a},l.prototype.dC=function(s){if(0>s||s>=this.I())throw d.i.ce();this.re(1),this.mc(),this.Pc(1993);var a=this.za[0];a.write(2*s,(void 0).x),a.write(2*s+1,(void 0).y),this.za[1].pr(s,(void 0).z)},l.prototype.Uc=function(s,a,c){if(0>a||a>=this.wa)throw d.i.ce();var f=d.ra.Va(s);if(c>=f)throw d.i.ce();this.mc();var y=this.description.Pf(s);return 0<=y?this.za[y].eg(a*f+c):d.ra.se(s)},l.prototype.yF=function(s,a){return this.Uc(s,a)},l.prototype.setAttribute=function(s,a,c,f){if(0>a||a>=this.wa)throw d.i.ce();var y=d.ra.Va(s);if(c>=y)throw d.i.ce();this.re(s),this.mc(),s=this.description.Pf(s),this.Pc(1993),this.za[s].pr(a*y+c,f)},l.prototype.ub=function(s){return this.wx(),this.re(s),this.mc(),this.za[this.description.Pf(s)]},l.prototype.hn=function(s,a){if(a!=null&&d.ra.Tp(s)!=a.Tp())throw d.i.N();this.re(s),s=this.description.Pf(s),this.za==null&&(this.za=d.Yc.qI(this.description.Aa)),this.za[s]=a,this.Pc(16777215)},l.prototype.sn=function(s){var a=null;if(this.za!=null){var c=d.ee.Iw(s,this.description);a=[];for(var f=0,y=s.Aa;f<y;f++)c[f]!=-1&&(a[f]=this.za[c[f]])}this.description=s,this.za=a,this.Pg=-1,this.Pc(16777215)},l.prototype.AD=function(s){this.wu(!0),s instanceof d.l?this.$.A(s):this.$.Qo(s)},l.prototype.aN=function(s){this.wu(!1),s instanceof d.l?this.$.A(s):this.$.Qo(s)},l.prototype.bn=function(s){this.wu(!0),this.$.copyTo(s)},l.prototype.A=function(s){this.AD(s)},l.prototype.Qo=function(s){this.AD(s)},l.prototype.xc=function(s){this.aN(s)},l.prototype.Tg=function(s,a){var c=new d.Nc;return this.Ac()?(c.Oa(),c):(this.wu(!0),this.$.Tg(s,a))},l.prototype.cc=function(){var s=this.description.cc();if(!this.Ac())for(var a=this.I(),c=0,f=this.description.Aa;c<f;c++)s=this.za[c].An(s,0,a*d.ra.Va(this.description.Ed(c)));return s},l.prototype.Nb=function(s){if(s==this)return!0;if(!(s instanceof l&&this.description.Nb(s.description))||this.Ac()!=s.Ac())return!1;if(this.Ac())return!0;var a=this.I();if(a!=s.I())return!1;for(var c=0;c<this.description.Aa;c++){var f=this.description.kd(c),y=this.ub(f),v=s.ub(f);if(!y.Nb(v,0,a*d.ra.Va(f)))return!1}return!0},l.prototype.copyTo=function(s){if(s.getType()!=this.getType())throw d.i.N();this.dD(s)},l.prototype.dD=function(s){this.mc(),s.description=this.description,s.za=null;var a=this.description.Aa,c=null;if(this.za!=null){c=[];for(var f=0;f<a;f++)this.za[f]!=null&&(c[f]=this.za[f].GB(this.I()*d.ra.Va(this.description.Ed(f))))}this.$!=null?(s.$=this.$.Ia(),this.$.copyTo(s.$)):s.$=null,s.wa=this.wa,s.Hm=this.Hm,s.za=c;try{this.op(s)}catch{throw s.Oa(),d.i.fu()}},l.prototype.wD=function(){this.wa=0,this.Pg=-1,this.za=null,this.Pc(16777215)},l.prototype.Pc=function(s){s==16777215&&(this.Pg=-1,this.$x()),this.Hm|=s,this.lM(),this.vc()},l.prototype.wu=function(s){if(this.mc(),this.ak(192))if(this.$==null?this.$=new d.Fh(this.description):this.$.Nf(this.description),this.B())this.$.Oa();else{this.hy(s);for(var a=1;a<this.description.Aa;a++)for(var c=this.description.Ed(a),f=d.ra.Va(c),y=this.za[a],v=0;v<f;v++){var _=new d.Nc;_.Oa();for(var $=0;$<this.wa;$++){var I=y.eg($*f+v);_.Zb(I)}this.$.setInterval(c,v,_)}s&&this.Lf(192,!1)}},l.prototype.hy=function(){this.$.Oa();for(var s=this.za[0],a=new d.h,c=0;c<this.wa;c++)s.tc(2*c,a),this.$.Zb(a)},l.prototype.yp=function(s){s.Oa();for(var a=this.za[0],c=new d.h,f=0;f<this.wa;f++)a.tc(2*f,c),s.Zb(c)},l.prototype.bN=function(){if(this.Pg<this.wa){this.za==null&&(this.za=d.Yc.qI(this.description.Aa)),this.Pg=2147483647;for(var s=0;s<this.description.Aa;s++){var a=this.description.Ed(s);if(this.za[s]!=null){var c=d.ra.Va(a),f=d.O.truncate(this.za[s].size/c);f<this.wa&&(f=d.O.truncate(this.Pg>this.wa+5?(5*this.wa+3)/4:this.wa),this.za[s].resize(f*c,d.ra.se(a))),f<this.Pg&&(this.Pg=f)}else this.za[s]=d.Yc.YE(a,this.wa),this.Pg=this.wa}}this.iy(),this.Lf(32,!1)},l.prototype.dm=function(s){if(0>s)throw d.i.N();s!=this.wa&&(this.wa=s,this.Pc(65535))},l.prototype.om=function(s){if(!this.ak(1)){if(!this.ak(2))return 0;if(this.QT>=s)return this.ak(8)?1:2}return-1},l.prototype.Ch=function(s,a){if(this.QT=a,s==-1)this.Lf(1,!0),this.Lf(8,!0);else if(this.Lf(1,!1),this.Lf(8,!0),s==0)this.Lf(2,!1),this.Lf(4,!1);else if(s==1)this.Lf(2,!0),this.Lf(4,!1);else{if(s!=2)throw d.i.fa("internal error.");this.Lf(2,!0),this.Lf(4,!0)}},l.prototype.lM=function(){this.Bb!=null&&(this.Bb=null)},l.prototype.kD=function(s,a,c,f){if(0>s||s>=this.wa||0>a||a>=this.wa)throw d.i.fa("index out of bounds");this.mc(),f.Nf(this.description),f.B()&&f.un();for(var y=0;y<this.description.Aa;y++)for(var v=this.description.Ed(y),_=0,$=d.ra.Va(v);_<$;_++){var I=this.za[y].eg($*s+_),k=this.za[y].eg($*a+_);f.setAttribute(v,_,d.lc.hq(I,k,c))}},l.prototype.yr=function(s,a){var c=this.za[0].o,f=c[2*s]-c[2*a];return s=c[2*s+1]-c[2*a+1],Math.sqrt(f*f+s*s)},l.prototype.KR=function(s){if(0>s||s>=this.wa)throw d.i.ce();this.mc();var a=new d.Sa;a.Nf(this.description),a.B()&&a.un();for(var c=0;c<this.description.Aa;c++)for(var f=this.description.kd(c),y=0,v=d.ra.Va(f);y<v;y++){var _=this.za[c].eg(v*s+y);a.setAttribute(f,y,_)}return a},l.prototype.Dh=function(s,a){if(0>s||s>=this.wa)throw d.i.ce();if(a.B())throw d.i.N();this.mc();for(var c=a.description,f=0;f<c.Aa;f++)for(var y=c.kd(f),v=d.ra.Va(y),_=0;_<v;_++){var $=a.Uc(y,_);this.setAttribute(y,s,_,$)}},l.prototype.lu=function(){return null},l.prototype.fj=function(){return null},l}(d.aa);d.Gx=x}(Y||(Y={})),function(d){var O=function(){function x(){this.ob=this.Zn=null,this.Tm=124234251,this.Rv=!0,this.Qe=-1,this.ob=new d.$c(7),this.Zn=null}return x.prototype.Vo=function(h){this.Zn=h},x.prototype.RP=function(){this.Rv=!1},x.prototype.De=function(h){this.ob.De(h)},x.prototype.Pr=function(h){var l=this.ob.Ce();return this.rX(l),this.uX(h,l),l},x.prototype.MP=function(h){this.ob.jd(h)},x.prototype.addElement=function(h,l){return l==-1&&(this.Qe==-1&&(this.Qe=this.Pr(-1)),l=this.Qe),this.FD(h,0,l)},x.prototype.KD=function(h){return this.Qe==-1&&(this.Qe=this.Pr(-1)),this.FD(h,1,this.Qe)},x.prototype.xn=function(h){this.Qe==-1&&(this.Qe=this.Pr(-1));var l=this.Qe,s=this.ob.o;if(l==-1||s[7*l]==-1)return h=this.ob.Ll([-1,-1,-1,h,this.gl(),-1,-1]),(s=this.ob.o)[7*l]=h,this.vp(-1,h,l,s),h;var a=l==-1?-1:s[7*l+2];return h=this.ob.Ll([-1,-1,a,h,this.gl(),-1,-1]),(s=this.ob.o)[7*a+1]=h,this.oy(h,s),s[7*h+2]===-1&&(s[7*l]=h),this.vp(-1,h,l,s),h},x.prototype.zu=function(h,l,s,a){var c=-1;c==-1&&(this.Qe==-1&&(this.Qe=this.Pr(-1)),c=this.Qe);var f=this.ob.o;if(c==-1||f[7*c]==-1)return s=this.ob.Ll([-1,-1,-1,s,this.gl(),-1,-1]),(f=this.ob.o)[7*c]=s,this.vp(-1,s,c,f),s;if(a){a=l!=-1?this.Zn.compare(this,s,l):-1;var y=h!=-1?this.Zn.compare(this,s,h):1}else a=-1,y=1;if(a==0||y==0)return f[7*c+3]=a==0?l:h,-1;for((l!=-1&&h!=-1?this.Tm>d.O.bB(this.Tm)>>1:l!=-1)?h=l:a=y,l=!0;;){if(0>a){if((y=f[7*h])==-1){a=h,s=this.ob.Ll([-1,-1,h,s,this.gl(),-1,-1]),(f=this.ob.o)[7*h]=s;break}h=y}else{if((y=f[7*h+1])==-1){a=f[7*h+6],s=this.ob.Ll([-1,-1,h,s,this.gl(),-1,-1]),(f=this.ob.o)[7*h+1]=s;break}h=y}l&&(a*=-1,l=!1)}return this.oy(s,f),f[7*s+2]===-1&&(f[7*c]=s),this.vp(a,s,c,f),s},x.prototype.FF=function(){return this.iR(this.Qe)},x.prototype.vd=function(h,l){l=l==-1?this.Qe:l,this.Rv?this.LP(h,l):this.iY(h,l)},x.prototype.search=function(h,l){for(l=this.sv(l);l!=-1;){var s=this.Zn.compare(this,h,l);if(s==0)return l;l=0>s?this.ll(l):this.Xp(l)}return-1},x.prototype.IW=function(h){for(var l=this.sv(-1),s=-1;l!=-1;){var a=h.compare(this,l);if(a==0)return l;0>a?l=this.ll(l):(s=l,l=this.Xp(l))}return s},x.prototype.uJ=function(h){for(var l=this.sv(-1),s=-1;l!=-1;){var a=h.compare(this,l);if(a==0)return l;0>a?(s=l,l=this.ll(l)):l=this.Xp(l)}return s},x.prototype.ja=function(h){return this.ob.T(h,3)},x.prototype.ll=function(h){return this.ob.T(h,0)},x.prototype.Xp=function(h){return this.ob.T(h,1)},x.prototype.getParent=function(h){return this.ob.T(h,2)},x.prototype.lb=function(h){return this.ob.T(h,6)},x.prototype.we=function(h){return this.ob.T(h,5)},x.prototype.rc=function(h){return h==-1?this.kl(this.Qe):this.kl(h)},x.prototype.Fc=function(h){return h==-1?this.Zr(this.Qe):this.Zr(h)},x.prototype.ZR=function(h){return h==-1?this.bG(this.Qe):this.bG(h)},x.prototype.Sj=function(h,l){this.NB(h,l)},x.prototype.sv=function(h){return h==-1?this.YF(this.Qe):this.YF(h)},x.prototype.clear=function(){this.ob.mj(!1),this.Qe=-1},x.prototype.size=function(h){return h==-1?this.$F(this.Qe):this.$F(h)},x.prototype.KN=function(h,l){for(var s=l[7*h],a=l[7*h+1],c=l[7*h+4];s!=-1||a!=-1;){var f=s!=-1?l[7*s+4]:2147483647;if(a=a!=-1?l[7*a+4]:2147483647,c<=Math.min(f,a))break;f<=a?this.sJ(s,l):this.rJ(h,l),s=l[7*h],a=l[7*h+1]}},x.prototype.oy=function(h,l){if(this.Rv)for(var s=l[7*h+4],a=l[7*h+2];a!=-1&&l[7*a+4]>s;)l[7*a]==h?this.sJ(h,l):this.rJ(a,l),a=l[7*h+2]},x.prototype.rJ=function(h,l){var s=l[7*h+1];l[7*s+2]=l[7*h+2],l[7*h+2]=s;var a=l[7*s];l[7*h+1]=a,a!=-1&&(l[7*a+2]=h),l[7*s]=h,(a=l[7*s+2])!=-1&&(l[7*a]==h?l[7*a]=s:l[7*a+1]=s)},x.prototype.sJ=function(h,l){var s=l[7*h+2];l[7*h+2]=l[7*s+2],l[7*s+2]=h;var a=l[7*h+1];l[7*s]=a,a!=-1&&(l[7*a+2]=s),l[7*h+1]=s,(a=l[7*h+2])!=-1&&(l[7*a]===s?l[7*a]=h:l[7*a+1]=h)},x.prototype.Pk=function(h,l){this.ob.S(h,2,l)},x.prototype.TB=function(h,l){this.ob.S(h,0,l)},x.prototype.XB=function(h,l){this.ob.S(h,1,l)},x.prototype.WB=function(h,l){this.ob.S(h,5,l)},x.prototype.ex=function(h,l){this.ob.S(h,6,l)},x.prototype.XJ=function(h,l){this.ob.S(l,0,h)},x.prototype.rX=function(h){this.ob.S(h,4,0)},x.prototype.uX=function(h,l){this.ob.S(l,5,h)},x.prototype.YF=function(h){return h==-1?-1:this.ob.T(h,0)},x.prototype.kl=function(h){return h==-1?-1:this.ob.T(h,1)},x.prototype.Zr=function(h){return h==-1?-1:this.ob.T(h,2)},x.prototype.iR=function(h){return h==-1?-1:this.ob.T(h,3)},x.prototype.$F=function(h){return h==-1?0:this.ob.T(h,4)},x.prototype.bG=function(h){return this.ob.T(h,5)},x.prototype.Pw=function(){return this.ob.Ll([-1,-1,-1,void 0,this.gl(),-1,-1])},x.prototype.fl=function(h){h!=-1&&this.ob.jd(h)},x.prototype.gl=function(){return this.Tm=d.O.bB(this.Tm),1073741823&this.Tm},x.prototype.FD=function(h,l,s){var a=this.ob.o;if(s==-1||a[7*s]==-1)return h=this.ob.Ll([-1,-1,-1,h,this.gl(),-1,-1]),(a=this.ob.o)[7*s]=h,this.vp(-1,h,s,a),h;for(var c=s==-1?-1:a[7*s];;){var f=l==-1?1:this.Zn.compare(this,h,c);if(0>f){if((f=this.ll(c))==-1){l=c,h=this.ob.Ll([-1,-1,c,h,this.gl(),-1,-1]),(a=this.ob.o)[7*c]=h;break}c=f}else{if(l==1&&f==0)return a[7*s+3]=c,-1;if((f=a[7*c+1])==-1){l=a[7*c+6],h=this.ob.Ll([-1,-1,c,h,this.gl(),-1,-1]),(a=this.ob.o)[7*c+1]=h;break}c=f}}return this.oy(h,a),a[7*h+2]===-1&&(a[7*s]=h),this.vp(l,h,s,a),h},x.prototype.vp=function(h,l,s,a){if(h!=-1){var c=a[7*h+5];a[7*h+5]=l}else c=s==-1?-1:a[7*s+2];a[7*l+5]=c,c!=-1&&(a[7*c+6]=l),a[7*l+6]=h,h==(s==-1?-1:a[7*s+1])&&(a[7*s+1]=l),h==-1&&(a[7*s+2]=l),a[7*s+4]=(s==-1?0:a[7*s+4])+1},x.prototype.AB=function(h,l){var s=this.ob.o,a=s[7*h+5];h=s[7*h+6],a!=-1?s[7*a+6]=h:s[7*l+1]=h,h!=-1?s[7*h+5]=a:s[7*l+2]=a,s[7*l+4]=l===-1?-1:s[7*l+4]-1},x.prototype.iY=function(h,l){this.AB(h,l);var s=this.ll(h),a=this.Xp(h),c=this.getParent(h),f=h;if(s!=-1&&a!=-1){this.Tm=d.O.bB(this.Tm);var y=1073741823<this.Tm?this.lb(h):this.we(h),v=this.getParent(y)==h;this.ob.gC(h,y,0),this.ob.gC(h,y,1),this.ob.gC(h,y,2),c!=-1?this.ll(c)==h?this.TB(c,y):this.XB(c,y):this.XJ(y,l),v?(s==y?(this.TB(y,h),this.Pk(a,y)):a==y&&(this.XB(y,h),this.Pk(s,y)),this.Pk(h,y),c=y):(this.Pk(s,y),this.Pk(a,y),c=this.getParent(h),f=y),s=this.ll(h),a=this.Xp(h),s!=-1&&this.Pk(s,h),a!=-1&&this.Pk(a,h)}s=s!=-1?s:a,c==-1?this.XJ(s,l):this.ll(c)==f?this.TB(c,s):this.XB(c,s),s!=-1&&this.Pk(s,c),this.fl(h)},x.prototype.LP=function(h,l){var s=this.ob.o;s[7*h+4]=2147483647;var a=-1,c=-1,f=l===-1?-1:s[7*l],y=f==h;if(y&&(a=s[7*f],c=s[7*f+1],a==-1&&c==-1))return this.AB(f,l),this.fl(f),void(s[7*l]=-1);this.KN(h,s),(f=s[7*h+2])!=-1&&(s[7*f]==h?s[7*f]=-1:s[7*f+1]=-1),this.AB(h,l),this.fl(h),y&&(s[7*l]=a==-1||s[7*a+2]!=-1?c:a)},x.prototype.NB=function(h,l){this.ob.S(h,3,l)},x}();d.Yj=O}(Y||(Y={})),function(d){var O=function(){function x(h,l){h!==void 0&&this.K(h,l)}return x.prototype.K=function(h,l){this.oa=h,this.va=l,this.normalize()},x.prototype.isIntersecting=function(h){return this.oa<=h.oa?this.va>=h.oa:h.va>=this.oa},x.prototype.move=function(h){this.B()||(this.oa+=h,this.va+=h)},x.prototype.normalize=function(){if(!isNaN(this.oa)){if(this.oa>this.va){var h=this.oa;this.oa=this.va,this.va=h}isNaN(this.va)&&this.Oa()}},x.prototype.Oa=function(){this.va=this.oa=NaN},x.prototype.B=function(){return isNaN(this.oa)},x.prototype.Zb=function(h){typeof h=="number"?this.B()?this.va=this.oa=h:this.Lk(h):h.B()||(this.B()?(this.oa=h.oa,this.va=h.va):(this.oa>h.oa&&(this.oa=h.oa),this.va<h.va&&(this.va=h.va),this.oa>this.va&&this.Oa()))},x.prototype.Lk=function(h){h<this.oa?this.oa=h:h>this.va&&(this.va=h)},x.prototype.contains=function(h){return typeof h=="number"?h>=this.oa&&h<=this.va:h.oa>=this.oa&&h.va<=this.va},x.prototype.Ea=function(h){this.B()||h.B()?this.Oa():(this.oa<h.oa&&(this.oa=h.oa),this.va>h.va&&(this.va=h.va),this.oa>this.va&&this.Oa())},x.prototype.W=function(h){this.B()||(this.oa-=h,this.va+=h,this.va<this.oa&&this.Oa())},x.prototype.xr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.oa)+Math.abs(this.va)+1)},x.prototype.KB=function(h,l){h>l?(this.oa=l,this.va=h):(this.oa=h,this.va=l)},x.prototype.It=function(h){return d.O.Rk(h,this.oa,this.va)},x.prototype.R=function(){return this.va-this.oa},x.prototype.sf=function(){return .5*(this.oa+this.va)},x.prototype.Nb=function(h){return h==this||h instanceof x&&(!(!this.B()||!h.B())||this.oa==h.oa&&this.va==h.va)},x.prototype.cc=function(){return d.O.uj(d.O.uj())},x}();d.Nc=O}(Y||(Y={})),function(d){var O=new d.Nc,x=new d.Nc,h=function(){this.ne=null,this.pb=-1,this.sb=new d.yb,this.qA=55555555,this.Tv=this.Vv=!1,this.Uf=new d.Nc,this.Uf.KB(0,0)};d.IY=h;var l=function(){function s(a,c,f){this.g=a,this.Hk=NaN,this.NH=this.Kq=0,this.OH=NaN,this.qa=c,this.Nq=10*c,this.PH=this.QH=NaN,this.rg=!1,this.Dm=this.gt=this.Lo=this.Xs=this.Ws=-1,this.gA=f,this.TA=new h,this.YH=new h,d.O.truncate(3*a.fd/2)}return s.prototype.mG=function(a,c,f,y){a.ne=y===null?null:y[f[5*c]],a.Tv=a.ne!=null,a.Tv||((y=f[5*c+2])!==-1&&this.g.mW(f[5*c],f[5*y],a.sb),a.ne=a.sb,a.Uf.KB(a.sb.sa,a.sb.pa),a.Uf.va+=this.qa,a.sb.rI(),a.Vv=a.sb.la==a.sb.na,a.Vv||(a.qA=(a.sb.pa-a.sb.sa)/(a.sb.la-a.sb.na)))},s.prototype.OO=function(a,c){var f=a.zr(c,this.qa,!0);return f!=0?f==2?this.Qy():this.xi():(a.Yp(Jl),a.Tr(sc),c.Yp(Zl),c.Tr(oc),Lr.ma(this.Kq,this.Hk),Jl.qb(Zl)&&this.Hk==Jl.y?0>sc.compare(oc)?Lr.L(sc):Lr.L(oc):Jl.qb(oc)&&this.Hk==Jl.y?0>sc.compare(Zl)?Lr.L(sc):Lr.L(Zl):Zl.qb(sc)&&this.Hk==Zl.y?0>Jl.compare(oc)?Lr.L(Jl):Lr.L(oc):sc.qb(oc)&&this.Hk==sc.y&&(0>Jl.compare(Zl)?Lr.L(Jl):Lr.L(Zl)),a.Pe(Lr.y,Lr.x)<c.Pe(Lr.y,Lr.x)?-1:1)},s.prototype.MO=function(a,c){if(a.sb.na==c.sb.na&&a.sb.sa==c.sb.sa)return a.sb.la==c.sb.la&&a.sb.pa==c.sb.pa?this.gA?this.Qy():0:this.PE(a,c);if(a.sb.la==c.sb.la&&a.sb.pa==c.sb.pa)return this.OE(a,c);var f=this.OE(a,c);return a=this.PE(a,c),0>f&&0>a?-1:0<f&&0<a?1:this.xi()},s.prototype.IO=function(a,c){if(a.pa>c.pa){if(c.pa>c.sa&&c.la-c.na<2*this.qa&&a.vi(c.pa,c.la,this.qa))return this.xi()}else if((c.la-c.na)/(c.pa-c.sa)*(a.pa-a.sa)<this.Nq&&c.vi(a.pa,a.la,this.qa))return this.xi();return 1},s.prototype.JO=function(a,c){if(a.sa<c.sa){if(c.pa>c.sa&&c.la-c.na<2*this.qa&&a.vi(c.pa,c.la,this.qa))return this.xi()}else if((c.la-c.na)/(c.pa-c.sa)*(a.sa-a.pa)<this.Nq&&c.vi(a.sa,a.na,this.qa))return this.xi();return-1},s.prototype.KO=function(a,c){var f=new d.h;f.uc(c.wc(),c.ac()),f.ar(),f.normalize();var y=new d.h;y.uc(a.ac(),c.ac());var v=new d.h;v.uc(a.wc(),c.ac()),y=y.Qh(f),f=v.Qh(f),v=Math.abs(y);var _=Math.abs(f);if(v<_){if(v<this.Nq&&c.vi(a.sa,a.na,this.qa))return this.xi()}else if(_<this.Nq&&c.vi(a.pa,a.la,this.qa))return this.xi();return 0>y&&0>f?-1:0<y&&0<f?1:this.xi()},s.prototype.NE=function(a,c){return a.na==c.na&&a.sa==c.sa?this.IO(a,c):a.la==c.la&&a.pa==c.pa?this.JO(a,c):this.KO(a,c)},s.prototype.LO=function(a,c){return a.la==c.la&&a.pa==c.pa&&a.na==c.na&&a.sa==c.sa?this.gA?this.Qy():0:this.xi()},s.prototype.OE=function(a,c){var f=1;if(a.sb.na<c.sb.na){f=-1;var y=a;a=c,c=y}a=a.sb,y=c.sb;var v=a.sa-y.sa;c=c.qA*(a.na-y.na);var _=this.Nq;return v<c-_?-f:v>c+_?f:y.vi(a.sa,a.na,this.qa)?this.xi():v<c?-f:f},s.prototype.PE=function(a,c){var f=1;if(c.sb.la<a.sb.la){f=-1;var y=a;a=c,c=y}a=a.sb,y=c.sb;var v=a.pa-y.sa;c=c.qA*(a.la-y.na);var _=this.Nq;return v<c-_?-f:v>c+_?f:y.vi(a.pa,a.la,this.qa)?this.xi():v<c?-f:f},s.prototype.Qy=function(){return this.rg=!0,this.Ni=new d.Md(5,this.Lo,this.gt),-1},s.prototype.xi=function(){return this.rg=!0,this.gA?this.Ni=new d.Md(4,this.Lo,this.gt):this.gt=this.Lo=this.Xs=this.Ws=-1,-1},s.prototype.NO=function(a,c,f,y){if(this.rg)return-1;var v=this.OH==this.Hk&&this.NH==this.Kq;if(v&&a==this.Ws)var _=this.PH;else _=NaN,this.Ws=-1;return v&&c==this.Xs?v=this.QH:(v=NaN,this.Xs=-1),f.ne.ZI(O),y.ne.ZI(x),O.va<x.oa?-1:x.va<O.oa?1:(this.OH=this.Hk,this.NH=this.Kq,isNaN(_)&&(this.Ws=a,this.PH=_=a=f.ne.Pe(this.Hk,this.Kq)),isNaN(v)&&(this.Xs=c,this.QH=v=a=y.ne.Pe(this.Hk,this.Kq)),Math.abs(_-v)<=this.qa?this.OO(f.ne,y.ne):_<v?-1:_>v?1:0)},s.prototype.Kr=function(){this.rg=!1},s.prototype.rm=function(){return this.Ni},s.prototype.$J=function(a,c){this.Hk=a,this.Kq=c,this.gt=this.Lo=this.Xs=this.Ws=-1},s.prototype.compare=function(a,c,f){return this.rg?-1:(a=a.ja(f),this.Dm=f,this.RE(c,c,a,a))},s.prototype.RE=function(a,c,f,y){if(this.Lo==c)var v=this.TA;else this.Lo=c,v=this.TA,this.TA.pb=a,this.mG(v,c,this.g.td.o,this.g.We);if(_==null){this.gt=y;var _=this.YH;this.YH.pb=f,this.mG(_,y,this.g.td.o,this.g.We)}return v.Tv||_.Tv?this.NO(c,y,v,_):v.Uf.va<_.Uf.oa?-1:_.Uf.va<v.Uf.oa?1:(a=v.Vv?1:0,(a|=_.Vv?2:0)==0?this.MO(v,_):a==1?this.NE(v.sb,_.sb):a==2?-1*this.NE(_.sb,v.sb):this.LO(v.sb,_.sb))},s}();d.UC=l}(Y||(Y={})),function(d){var O=function(){function x(h,l){this.g=h,this.qa=l,this.rg=!1,this.Lo=-1,this.Uf=new d.Nc,this.Gq=new d.h,this.Gq.Rc(),this.ie=new d.yb,this.Dm=-1,this.BA=17976931348623157e292}return x.prototype.Kr=function(){this.rg=!1,this.BA=17976931348623157e292},x.prototype.Dh=function(h){this.Gq.L(h)},x.prototype.compare=function(h,l){return this.SE(l,h.ja(l))},x.prototype.SE=function(h,l){var s=this.g.bc(l)!=null;if(s||(this.g.ed(l,this.ie),this.Uf.KB(this.ie.sa,this.ie.pa)),s)throw d.i.fa("not implemented");if(this.Gq.x+this.qa<this.Uf.oa)return-1;if(this.Gq.x-this.qa>this.Uf.va)return 1;if(this.ie.na==this.ie.la)return this.Dm=h,this.rg=!0,0;this.ie.rI(),s=this.ie.ac(),(l=new d.h).uc(this.ie.wc(),s),l.ar();var a=new d.h;return a.uc(this.Gq,s),s=l.Qh(a),(s/=l.length())<10*-this.qa?-1:s>10*this.qa?1:this.ie.qs(this.Gq,this.qa)&&((l=Math.abs(s))<this.BA&&(this.Dm=h,this.BA=l),this.rg=!0,l<.25*this.qa)?0:0>s?-1:1},x}();d.aM=O}(Y||(Y={})),function(d){function O(h,l,s,a){s=new Float64Array(h.subarray(s,a)),h.set(s,l)}var x=function(){function h(l){this.Pb=this.pk=!1,this.o=null;var s=l;2>s&&(s=2),this.o=new Float64Array(s),this.size=l}return h.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.fa("invalid_call");if(s<l||s>a||l>a)throw d.i.N();l!=s&&a!=s&&(this.ni(l,s-l,1),this.ni(s,a-s,1),this.ni(l,a-l,1))},h.qf=function(l,s){var a=new h(l),c=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)c[f]=s;return a},h.Bn=function(l){var s=new h(0);return s.o=new Float64Array(l.o),s.size=l.size,s},h.Lr=function(l,s){var a=new h(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Float64Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},h.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Float64Array(l):l<=this.o.length||(0<this.o.length?((l=new Float64Array(l)).set(this.o),this.o=l):this.o=new Float64Array(l)))},h.prototype.read=function(l){return this.o[l]},h.prototype.tc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},h.prototype.get=function(l){return this.o[l]},h.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.Tt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},h.prototype.GB=function(l){return h.Lr(this,l)},h.prototype.eg=function(l){return this.read(l)},h.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Float64Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.O.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Float64Array(a)).set(this.o),this.o=a),a=this.o;for(var c=this.size;c<l;c++)a[c]=s}this.size=l},h.prototype.Bh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},h.prototype.pr=function(l,s){this.write(l,s)},h.prototype.An=function(l,s,a){for(var c=this.size;s<c&&s<a;s++)l=d.O.uj(this.read(s));return l},h.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof h))return!1;var c=this.size,f=l.size;if(a>c||a>f&&c!=f)return!1;for(a>c&&(a=c);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},h.prototype.addRange=function(l,s,a,c,f){if(this.Pb)throw d.i.Hb();if(!c&&(1>f||a%f!=0))throw d.i.N();var y=this.size;if(this.resize(y+a),c)this.o.set(l.o.subarray(s,s+a),y);else{c=a;for(var v=0;v<a;v+=f){c-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+c+_]}}},h.prototype.Mn=function(l,s,a,c,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||c%y!=0))throw d.i.N();var _=this.size-v;if(_<c&&this.resize(this.size+c-_),O(this.o,l+c,l,l+(v-l)),this.o==s.o&&l<a&&(a+=c),f)this.o.set(s.o.subarray(a,a+c),l);else for(f=c,v=0;v<c;v+=y)for(f-=y,_=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]},h.prototype.Iz=function(l,s,a,c,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*c>this.o.length?this.resize(this.size+2*c):this.size+=2*c,O(this.o,l+2*c,l,l+(y-l)),f)for(f=0;f<c;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=c-1;f<c;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},h.prototype.Ln=function(l,s,a,c){if(this.Pb)throw d.i.Hb();for(c-=l,O(this.o,l+c,l,l+c),c=0;c<a;c++)this.o[l+c]=s},h.prototype.vj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.Ut=function(l,s,a,c,f,y){if(0>l||0>s||0>c||!f&&(0>=y||s%y!=0)||a.size<c+s)throw d.i.N();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Ar(l,s,c,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c++;else if(c=c+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c--;else for(f=0,s=d.O.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[c+v];l+=y,c-=y}},h.prototype.En=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},h.prototype.ni=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var c=s>>1,f=0;f<c;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},h.prototype.Wj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.N();for(var c=s;c<s+a;c++)this.o[c]=l},h.prototype.Ar=function(l,s,a,c,f){if(!(c&&l==a||(this.o.set(this.o.subarray(a,a+s),l),c)))for(a=l,l=l+s-f,c=0,s=d.O.truncate(s/2);c<s;c++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},h.prototype.vC=function(l,s,a,c,f){if(0>l||0>s||0>c)throw d.i.N();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=c;c<s;c++)this.o[l]=a[c].x,this.o[l+1]=a[c].y,l+=f},h.prototype.uC=function(l,s,a){if(0>l||0>s)throw d.i.N();if(s!=0){this.size<(s<<1)+l&&this.resize((s<<1)+l),s+=0;for(var c=0;c<s;c++)this.o[l]=a[c][0],this.o[l+1]=a[c][1],l+=2}},h.prototype.Vw=function(l,s,a,c,f){if(0>l||0>s||0>c||this.size<s+l)throw d.i.N();if(f)for(f=0;f<s;f++)a[c+f]=this.o[l+f];else for(c=c+s-1;l<s;l++)a[c]=this.o[l],c--},h.prototype.uB=function(l,s,a){if(0>l||0>s||this.size<(s>>1)+l)throw d.i.N();if(s!=0){s=0+s;for(var c=0;c<s;c++)a[c][0]=this.o[l],a[c][1]=this.o[l+1],l+=2}},h.prototype.clear=function(l){l?this.resize(0):this.Bh(0)},h.prototype.ix=function(){this.pk=this.Pb=!0},h.prototype.Vd=function(l,s,a){Array.prototype.sort.call(this.o.subarray(l,s),a)},h.prototype.Tp=function(){return 1},h}();d.be=x}(Y||(Y={})),function(d){function O(h,l,s,a){s=new Int32Array(h.subarray(s,a)),h.set(s,l)}d.rY=function(){this.random=1973};var x=function(){function h(l){this.Pb=this.pk=!1,this.o=null;var s=l;2>s&&(s=2),this.o=new Int32Array(s),this.size=l}return h.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.fa("invalid_call");if(s<l||s>a||l>a)throw d.i.N();l!=s&&a!=s&&(this.ni(l,s-l,1),this.ni(s,a-s,1),this.ni(l,a-l,1))},h.qf=function(l,s){var a=new h(l),c=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)c[f]=s;return a},h.Bn=function(l){var s=new h(0);return s.o=new Int32Array(l.o),s.size=l.size,s},h.Lr=function(l,s){var a=new h(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Int32Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},h.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Int32Array(l):l<=this.o.length||(0<this.o.length?((l=new Int32Array(l)).set(this.o),this.o=l):this.o=new Int32Array(l)))},h.prototype.read=function(l){return this.o[l]},h.prototype.tc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},h.prototype.get=function(l){return this.o[l]},h.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.Tt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},h.prototype.GB=function(l){return h.Lr(this,l)},h.prototype.eg=function(l){return this.read(l)},h.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Int32Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.O.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Int32Array(a)).set(this.o),this.o=a),a=this.o;for(var c=this.size;c<l;c++)a[c]=s}this.size=l},h.prototype.Bh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},h.prototype.pr=function(l,s){this.write(l,s)},h.prototype.An=function(l,s,a){for(var c=this.size;s<c&&s<a;s++)l=d.O.Th(this.read(s),l);return l},h.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof h))return!1;var c=this.size,f=l.size;if(a>c||a>f&&c!=f)return!1;for(a>c&&(a=c);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},h.prototype.addRange=function(l,s,a,c,f){if(this.Pb)throw d.i.Hb();if(!c&&(1>f||a%f!=0))throw d.i.N();var y=this.size;if(this.resize(y+a),c)this.o.set(l.o.subarray(s,s+a),y);else{c=a;for(var v=0;v<a;v+=f){c-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+c+_]}}},h.prototype.Mn=function(l,s,a,c,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||c%y!=0))throw d.i.N();if(O(this.o,l+c,l,l+(v-l)),this.o==s.o&&l<a&&(a+=c),f)this.o.set(s.o.subarray(a,a+c),l);else for(f=c,v=0;v<c;v+=y){f-=y;for(var _=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]}},h.prototype.Iz=function(l,s,a,c,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*c>this.o.length?this.resize(this.size+2*c):this.size+=2*c,O(this.o,l+2*c,l,l+(y-l)),f)for(f=0;f<c;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=c-1;f<c;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},h.prototype.Ln=function(l,s,a,c){if(this.Pb)throw d.i.Hb();for(c-=l,O(this.o,l+c,l,l+c),c=0;c<a;c++)this.o[l+c]=s},h.prototype.vj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.Ut=function(l,s,a,c,f,y){if(0>l||0>s||0>c||!f&&(0>=y||s%y!=0)||a.size<c+s)throw d.i.N();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Ar(l,s,c,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c++;else if(c=c+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c--;else for(f=0,s=d.O.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[c+v];l+=y,c-=y}},h.prototype.En=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},h.prototype.ni=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var c=s>>1,f=0;f<c;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},h.prototype.Wj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.N();for(var c=s;c<s+a;c++)this.o[c]=l},h.prototype.Ar=function(l,s,a,c,f){if(!(c&&l==a||(this.o.set(this.o.subarray(a,a+s),l),c)))for(a=l,l=l+s-f,c=0,s=d.O.truncate(s/2);c<s;c++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},h.prototype.vC=function(l,s,a,c,f){if(0>l||0>s||0>c)throw d.i.N();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=c;c<s;c++)this.o[l]=a[c].x,this.o[l+1]=a[c].y,l+=f},h.prototype.Vw=function(l,s,a,c,f){if(0>l||0>s||0>c||this.size<s+l)throw d.i.N();if(f)for(f=0;f<s;f++)a[c+f]=this.o[l+f];else for(c=c+s-1;l<s;l++)a[c]=this.o[l],c--},h.prototype.clear=function(l){l?this.resize(0):this.Bh(0)},h.prototype.ix=function(){this.pk=this.Pb=!0},h.prototype.Vd=function(l,s,a){10>s-l?h.rG(this.o,l,s,a):h.qB(this.o,l,s-1,a)},h.prototype.Tp=function(){return 2},h.prototype.Fc=function(){return this.o[this.size-1]},h.prototype.If=function(){this.resize(this.size-1)},h.prototype.bX=function(l){this.o[this.size-1]=l},h.prototype.SV=function(l){l<this.size-1&&(this.o[l]=this.o[this.size-1]),this.resize(this.size-1)},h.prototype.lF=function(l){for(var s=0,a=this.size;s<a;s++)if(this.o[s]==l)return s;return-1},h.prototype.hG=function(l){return 0<=this.lF(l)},h.rG=function(l,s,a,c){for(var f=s;f<a;f++){for(var y=l[f],v=f-1;v>=s&&0<c(l[v],y);)l[v+1]=l[v],v--;l[v+1]=y}},h.tx=function(l,s,a){var c=l[a];l[a]=l[s],l[s]=c},h.qB=function(l,s,a,c){if(!(s>=a))for(;;){if(9>a-s){h.rG(l,s,a+1,c);break}var f=l[s];h.tx(l,s,a);for(var y=s,v=s;v<a;v++)0>=c(l[v],f)&&(h.tx(l,y,v),y+=1);h.tx(l,y,a),y-s<a-y?(h.qB(l,s,y-1,c),s=y+1):(h.qB(l,y+1,a,c),a=y-1)}},h}();d.ia=x}(Y||(Y={})),function(d){function O(h,l,s,a){s=new Int8Array(h.subarray(s,a)),h.set(s,l)}var x=function(){function h(l){this.o=null;var s=l;2>s&&(s=2),this.o=new Int8Array(s),this.size=l}return h.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.fa("invalid_call");if(s<l||s>a||l>a)throw d.i.N();l!=s&&a!=s&&(this.ni(l,s-l,1),this.ni(s,a-s,1),this.ni(l,a-l,1))},h.qf=function(l,s){var a=new h(l),c=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)c[f]=s;return a},h.Bn=function(l){var s=new h(0);return s.o=new Int8Array(l.o),s.size=l.size,s},h.Lr=function(l,s){var a=new h(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Int8Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},h.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Int8Array(l):l<=this.o.length||(0<this.o.length?((l=new Int8Array(l)).set(this.o),this.o=l):this.o=new Int8Array(l)))},h.prototype.read=function(l){return this.o[l]},h.prototype.tc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},h.prototype.get=function(l){return this.o[l]},h.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},h.prototype.Tt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},h.prototype.GB=function(l){return h.Lr(this,l)},h.prototype.eg=function(l){return this.read(l)},h.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Int8Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.O.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Int8Array(a)).set(this.o),this.o=a),a=this.o;for(var c=this.size;c<l;c++)a[c]=s}this.size=l},h.prototype.Bh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.pk)throw d.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},h.prototype.pr=function(l,s){this.write(l,s)},h.prototype.An=function(l,s,a){for(var c=this.size;s<c&&s<a;s++)l=d.O.Th(this.read(s),l);return l},h.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof h))return!1;var c=this.size,f=l.size;if(a>c||a>f&&c!=f)return!1;for(a>c&&(a=c);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},h.prototype.addRange=function(l,s,a,c,f){if(this.Pb)throw d.i.Hb();if(!c&&(1>f||a%f!=0))throw d.i.N();var y=this.size;if(this.resize(y+a),c)this.o.set(l.o.subarray(s,s+a),y);else{c=a;for(var v=0;v<a;v+=f){c-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+c+_]}}},h.prototype.Mn=function(l,s,a,c,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||c%y!=0))throw d.i.N();if(O(this.o,l+c,l,l+(v-l)),this.o==s.o&&l<a&&(a+=c),f)this.o.set(s.o.subarray(a,a+c),l);else for(f=c,v=0;v<c;v+=y){f-=y;for(var _=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]}},h.prototype.Ln=function(l,s,a,c){if(this.Pb)throw d.i.Hb();for(c-=l,O(this.o,l+c,l,l+c),c=0;c<a;c++)this.o[l+c]=s},h.prototype.Iz=function(l,s,a,c,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*c>this.o.length?this.resize(this.size+2*c):this.size+=2*c,O(this.o,l+2*c,l,l+(y-l)),f)for(f=0;f<c;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=c-1;f<c;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},h.prototype.vj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},h.prototype.Ut=function(l,s,a,c,f,y){if(0>l||0>s||0>c||!f&&(0>=y||s%y!=0)||a.size<c+s)throw d.i.N();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Ar(l,s,c,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c++;else if(c=c+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[c],l++,c--;else for(f=0,s=d.O.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[c+v];l+=y,c-=y}},h.prototype.En=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},h.prototype.ni=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var c=s>>1,f=0;f<c;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},h.prototype.Wj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.N();for(var c=s;c<s+a;c++)this.o[c]=l},h.prototype.Ar=function(l,s,a,c,f){if(!(c&&l==a||(this.o.set(this.o.subarray(a,a+s),l),c)))for(a=l,l=l+s-f,c=0,s=d.O.truncate(s/2);c<s;c++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},h.prototype.vC=function(l,s,a,c,f){if(0>l||0>s||0>c)throw d.i.N();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=c;c<s;c++)this.o[l]=a[c].x,this.o[l+1]=a[c].y,l+=f},h.prototype.Vw=function(l,s,a,c,f){if(0>l||0>s||0>c||this.size<s+l)throw d.i.N();if(f)for(f=0;f<s;f++)a[c+f]=this.o[l+f];else for(c=c+s-1;l<s;l++)a[c]=this.o[l],c--},h.prototype.clear=function(l){l?this.resize(0):this.Bh(0)},h.prototype.ix=function(){this.pk=this.Pb=!0},h.prototype.Vd=function(l,s,a){s=this.o.subarray(l,s),Array.prototype.sort.call(s,a),this.o.set(s,l)},h.prototype.zJ=function(l,s){if(this.Pb)throw d.i.fa("invalid call. Attribute Stream is read only.");this.o[l]|=s},h.prototype.KE=function(l,s){if(this.Pb)throw d.i.fa("invalid call. Attribute Stream is read only.");this.o[l]&=~s},h.prototype.Tp=function(){return 1},h}();d.pn=x}(Y||(Y={})),function(d){d.Yc=function(){function O(){}return O.Mr=function(x,h){return d.pn.qf(x,h)},O.Dn=function(x,h){return d.be.qf(x,h)},O.pP=function(x,h,l){switch(x){case 1:x=d.be.qf(h,l);break;case 2:x=d.ia.qf(h,l);break;case 4:x=d.pn.qf(h,l);break;default:throw d.i.Qa()}return x},O.YE=function(x,h){return O.pP(d.ra.Tp(x),h*d.ra.Va(x),d.ra.se(x))},O.Oh=function(x,h){return d.ia.qf(x,h)},O.qI=function(x){var h,l=[];for(h=0;h<x;h++)l.push(null);return l},O}()}(Y||(Y={})),function(d){d.ga=function(O){O===void 0&&(O=0),this.u=O}}(Y||(Y={})),function(d){d.NL=function(){function O(){}return O.bind=function(x){d.Sc=x.PeDefs,d.pf=x.PeFactory,d.NC=x.PeVertcs,d.ej=x.PeCSTransformations,d.MC=x.PeGTTransformations,d.LL=x.PeGeogtran,d.KL=x.PeFactoryCodechange,d.LC=x.PeGCSExtent,d.Cg=x.PePCSInfo,d.ML=x.PeHorizon,d.JL=x.PeCoordsys,d.lp=x.PeGTlistExtended,d.lp.PE_GTLIST_OPTS_USE_DEFAULT=128,d.pf.initialize(null),d.Mx=x.PeGTlistExtendedEntry,d.pf.fromString(d.Sc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')},O}(),d.pf=null,d.NC=null,d.JL=null,d.ML=null,d.Cg=null,d.lp=null,d.Mx=null,d.LC=null,d.KL=null,d.LL=null,d.Sc=null,d.MC=null,d.ej=null}(Y||(Y={})),function(d){var O=function(){function x(){}return x.Mb=function(h,l){return 0<=l?x.P(h):-x.P(h)},x.P=function(h){return 0>h?-h:h},x.ti=function(h){return 3552713678800501e-30>h},x.KC=function(h,l,s){return x.P(h-l)<=s*(1+(x.P(h)+x.P(l))/2)},x.Y=function(h,l){return x.KC(h,l,3552713678800501e-30)},x.FL=function(h){return 3552713678800501e-30>=x.P(h)},x.Cd=function(h){return x.FL(h)},x}();d.s=O,d.F=function(){function x(){}return x.gp=function(h,l){var s=0;return(h=O.P(h))+(l=O.P(l))!=0&&(h>l?(s=l/h,s=h*Math.sqrt(1+s*s)):(s=h/l,s=l*Math.sqrt(1+s*s))),s},x.Wq=function(h,l,s,a,c){for(var f=[0,0,0],y=[0,0,0],v=0;2>=v;v++)l[v]-=h[v],s[v]-=l[v];s=f[1]*y[2]-f[2]*y[1],l=f[2]*y[0]-f[0]*y[2],f=f[0]*y[1]-f[1]*y[0],h=-1*(s*h[0]+l*h[1]+f*h[2]),a[0]=s,a[1]=l,a[2]=f,a[3]=h,y=x.on(a),a[0]/=y,a[1]/=y,a[2]/=y,a[3]/=y,c!=0&&(y=O.Cd(f)?O.Cd(h)?O.Mb(1,l):-O.Mb(1,h):O.Mb(1,f),y*=O.Mb(1,c),a[0]*=y,a[1]*=y,a[2]*=y,a[3]*=y)},x.zx=function(h,l,s){s[0]=h[1]*l[2]-l[1]*h[2],s[1]=h[2]*l[0]-l[2]*h[0],s[2]=h[0]*l[1]-l[0]*h[1]},x.St=function(h,l){return h[0]*l[0]+h[1]*l[1]+h[2]*l[2]},x.on=function(h){return x.gp(x.gp(h[0],h[1]),h[2])},x.cl=function(h,l,s,a,c,f,y,v){h=x.n(h,l,s);var _=Math.cos(s);f.u=(h+c)*_*Math.cos(a),y.u=(h+c)*_*Math.sin(a),v.u=(h*(1-l)+c)*Math.sin(s)},x.jO=function(h,l,s,a,c,f,y){var v=x.gp(l,s),_=1*Math.sqrt(1-h),$=_/1;if(O.Y(v,0))f.u=0,c.u=O.Mb(1.570796326794897,a),y.u=O.P(a)-_;else{f.u=Math.atan2(s,l),s=Math.atan2(1*a,_*v),f=Math.cos(s);var I=Math.sin(s);l=_*h/(1-h),h*=1,s=Math.atan2(a+l*I*I*I,v-h*f*f*f),3.141592653589793<O.P(s)&&(s=O.Mb(3.141592653589793,s)-s),s=Math.atan($*Math.tan(s)),I=Math.sin(s),f=Math.cos(s),c.u=Math.atan2(a+l*I*I*I,v-h*f*f*f),1.570796326794897<O.P(c.u)&&(c.u=O.Mb(3.141592653589793,c.u)-c.u),s=Math.atan($*Math.tan(c.u)),I=Math.sin(s),f=Math.cos(s),y.u=(a-_*I)*Math.sin(c.u)+(v-1*f)*Math.cos(c.u)}},x.n=function(h,l,s){return s=Math.sin(s),h/Math.sqrt(1-l*s*s)},x.ot=function(h,l){return Math.atan2(Math.sin(l)*(1-h),Math.cos(l))},x.Qj=function(h,l){return Math.atan2(Math.sin(l),Math.cos(l)*(1-h))},x.Rq=function(h,l){if(O.ti(h)||l==0||O.Y(O.P(l),1.570796326794897))return l;if(.006884661117170036>h){var s=Math.sqrt(1-h),a=(1-s)/(1+s),c=a*a,f=a*c,y=a*f,v=a*y,_=a*v,$=a*_,I=1.572916666666667*f-3.2578125*v+4.295068359375*$;h=2.142578125*y-6.071484375*_,s=3.129296875*v-11.249837239583334*$;var k=4.775276692708333*_,A=7.958636765252976*$,P=Math.cos(2*l);return l+Math.sin(2*l)*(1.5*a-.84375*f+.525390625*v-.2688395182291667*$-I+s-A+P*(2*(1.3125*c-1.71875*y+1.650146484375*_)-4*h+6*k+P*(4*I-12*s+24*A+P*(8*h-32*k+P*(16*s-80*A+P*(32*k+64*P*A))))))}for(s=1-h,a=h/2,f=(c=O.P(l))*x.Zu(h)/(1.570796326794897*s),y=9999,_=c,c=0;1e-16<y&&50>c;c++)$=x.w(h,_),v=_-(I=(v=(x.kG(_,h)-a*Math.sin(2*_)/$)/s-f)/($=1/($*$*$))),y=O.P(I),_=v;return 0<=l?_:-_},x.qW=function(h,l){return O.ti(l)?h:h*x.Zu(l)/1.570796326794897},x.ba=function(h){return 0>(h=x.pF(h,6.283185307179586))?h+6.283185307179586:3.141592653589793>O.P(h)||O.Y(O.P(h),3.141592653589793)?h:h-6.283185307179586},x.pF=function(h,l){return h-Math.floor(h/l)*l},x.Ah=function(h,l){if(.006884661117170036>l){var s=(l=(1-(l=Math.sqrt(1-l)))/(1+l))*l,a=s*s;return h/(1+l)*(1+.25*s+.015625*a+.00390625*s*a)*1.570796326794897}return h*x.Zu(l)},x.Vq=function(h,l){var s=O.Mb(1,Math.sin(l));return l=1.570796326794897>=(l=O.P(x.pF(l,3.141592653589793)))?l:3.141592653589793-l,(O.Y(l,1.570796326794897)?l:Math.atan(Math.sqrt(1-h)*Math.tan(l)))*s},x.q=function(h,l,s){if(.006884661117170036>l){var a=(l=(1-(l=Math.sqrt(1-l)))/(1+l))*l,c=l*a,f=l*c,y=l*f,v=l*y,_=l*v,$=-.7291666666666666*c+.2278645833333333*y+.03987630208333334*_,I=.615234375*f-.21533203125*v,k=-.54140625*y+.20302734375*_,A=.48876953125*v,P=-.4488699776785715*_,D=Math.cos(2*s);return h/(1+l)*((1+.25*a+.015625*f+.00390625*v)*s+Math.sin(2*s)*(-1.5*l+.1875*c+.0234375*y+.00732421875*_-$+k-P+D*(2*(.9375*a-.234375*f-.03662109375*v)-4*I+6*A+D*(4*$-12*k+24*P+D*(8*I-32*A+D*(16*k-80*P+D*(32*A+64*D*P)))))))}return h*(x.kG(s,l)-.5*l*Math.sin(2*s)/x.w(l,s))},x.w=function(h,l){return l=Math.sin(l),Math.sqrt(1-h*l*l)},x.Zu=function(h){return O.KC(h,1,2220446049250313e-31)?1:1>h?x.Xw(0,1-h)-h/3*x.Uw(0,1-h):NaN},x.kG=function(h,l){var s=O.Mb(1,h);h=O.P(h);var a=Math.floor(h/1.570796326794897);if(1<l)l=h==0?0:NaN;else if(O.Cd(a))l=(h=x.sin(h))*x.Xw(1-h*h,1-l*h*h)-l/3*h*h*h*x.Uw(1-h*h,1-l*h*h);else{var c=d.O.truncate(a%2),f=x.Zu(l);0<c?(h=1.570796326794897*(a+1)-h,l=f*(a+1)-(l=(h=Math.sin(h))*x.Xw(1-h*h,1-l*h*h)-l/3*h*h*h*x.Uw(1-h*h,1-l*h*h))):(h-=1.570796326794897*a,l=f*a+(l=(h=Math.sin(h))*x.Xw(1-h*h,1-l*h*h)-l/3*h*h*h*x.Uw(1-h*h,1-l*h*h)))}return l*s},x.sin=function(h){h=x.ba(h);var l=O.Mb(1,h);return h=O.P(h),O.Y(h,3.141592653589793)?0:O.Y(h,1.570796326794897)?1*l:Math.sin(h)*l},x.Uw=function(h,l){var s,a,c,f,y=h,v=l,_=1;for(l=0,h=1;a=((s=.2*(y+v+3*_))-y)/s,c=(s-v)/s,f=(s-_)/s,!(1e-4>O.P(a)&&1e-4>O.P(c)&&1e-4>O.P(f));)f=Math.sqrt(v),l+=h/((s=Math.sqrt(_))*(_+(f=Math.sqrt(y)*(f+s)+f*s))),h*=.25,y=.25*(y+f),v=.25*(v+f),_=.25*(_+f);return v=(y=a*c)-(_=f*f),3*l+h*(1+(_=y-6*_)*(.10227272727272728*_-.2142857142857143-.1730769230769231*f*(a=_+v+v))+f*(.1666666666666667*a+f*(-.4090909090909091*v+.1153846153846154*f*y)))/(s*Math.sqrt(s))},x.Xw=function(h,l){for(var s,a,c,f,y=1;a=2-((s=(h+l+y)/3)+h)/s,c=2-(s+l)/s,f=2-(s+y)/s,!(1e-4>O.P(a)&&1e-4>O.P(c)&&1e-4>O.P(f));y=.25*(y+s))s=Math.sqrt(l),a=Math.sqrt(y),h=.25*(h+(s=Math.sqrt(h)*(s+a)+s*a)),l=.25*(l+s);return(1+(.04166666666666666*(h=a*c-f*f)-.1-.06818181818181818*(l=a*c*f))*h+.07142857142857142*l)/Math.sqrt(s)},x.Qw=function(h,l){if(O.ti(h)||l==0||O.Y(O.P(l),1.570796326794897))return l;if(.006884661117170036>h){var s=h*h,a=h*s,c=h*a,f=h*c,y=h*f,v=h*y,_=-(.02708333333333333*a+.03430059523809524*c+.03149181547619048*f+.02634359154541446*y+.02156896735835538*v),$=.007669890873015873*c+.01299603174603175*f+.0148051353064374*y+.01454454953803912*v,I=-(.002275545634920635*f+.004830845032667949*y+.006558395368616723*v),k=.0006957236677288761*y+.001775193002406544*v,A=-.000217324089394402*v,P=Math.cos(2*l);return l+Math.sin(2*l)*(-(.5*h+.2083333333333333*s+.09375*a+.04878472222222222*c+.02916666666666667*f+.01938905423280423*y+.01388255931712963*v)-_+I-A+P*(2*(.1041666666666667*s+.0875*a+.06050347222222222*c+.04151785714285714*f+.02958958540013228*y+.02203667534722222*v)-4*$+6*k+P*(4*_-12*I+24*A+P*(8*$-32*k+P*(16*I-80*A+P*(32*k+64*P*A))))))}return l==0||O.Y(O.P(l),1.570796326794897)?s=l:(c=(a=Math.sqrt(h))*Math.sin(l),s=Math.tan(.7853981633974483+l/2)*Math.pow((1-c)/(1+c),a/2),s=2*Math.atan(s)-1.570796326794897),s},x.yO=function(h,l){if(O.ti(h)||l==0||O.Y(O.P(l),1.570796326794897))return l;if(.006884661117170036>h){var s=h*(k=h*(I=h*(P=h*h))),a=h*(A=h*s),c=.05833333333333333*I+.07232142857142858*k+.05634300595238095*s+.0355325796406526*A+.020235546186067*a,f=.02653149801587302*k+.04379960317460317*s+.0429211791776896*A+.03255384637546096*a,y=.01294022817460318*s+.02668104344536636*A+.03155651254609588*a,v=.00659454790965208*A+.0163075268674227*a,_=.003463473736911237*a,$=Math.cos(2*l);return l+Math.sin(2*l)*(.5*h+.2083333333333333*P+.08333333333333333*I+.03611111111111111*k+.01875*s+.01195601851851852*A+.008863673941798942*a-c+y-_+$*(2*(.1458333333333333*P+.1208333333333333*I+.07039930555555556*k+.03616071428571429*s+.01839451058201058*A+.01017113095238095*a)-4*f+6*v+$*(4*c-12*y+24*_+$*(8*f-32*v+$*(16*y-80*_+$*(32*v+64*$*_))))))}var I=Math.sqrt(h),k=I/2,A=Math.tan(.7853981633974483+l/2);h=0,c=1;for(var P=l;c!=0;P=a)s=I*Math.sin(P),a=A*Math.pow((1+s)/(1-s),k),a=2*Math.atan(a)-1.570796326794897,h++,(O.Y(a,P)||3e4<h)&&(c=0);return P},x}()}(Y||(Y={})),function(d){var O=function(){function x(h){this.ul=this.Us=null,this.Iv=!1,this.GA=this.HA=0,this.HH=new d.h,this.XH=new d.h,this.KA=!1,this.vq=new d.l,this.wH=this.sw=0,this.tw=null,this.zl=!1,this.Eo=null,this.bA=0,this.Ue=h,this.As=d.zb.xv(this.Ue,0,!0),this.HH.Rc(),this.XH.Rc(),this.RH=NaN;var l=h.getCode();0<l?(this.Kk=l,d.pf.getCode(h)):this.Kk=d.pf.getCode(h),0>this.Kk&&(this.Kk=0);var s=this.Ue.getType();if(this.jH=s==d.Sc.PE_TYPE_PROJCS?2:1,s==d.Sc.PE_TYPE_PROJCS&&!h.loadConstants())throw d.i.N("PeProjcs.loadConstants failed");l=s==d.Sc.PE_TYPE_GEOGCS?this.Ue:this.Ue.getGeogcs(),s!=d.Sc.PE_TYPE_GEOGCS&&d.pf.getCode(l),this.Eo=h.getUnit(),this.RH=l.getPrimem().getLongitude(),this.wH=h=l.getUnit().getUnitFactor(),h=Math.PI/(180*h),1e-10>Math.abs(h-1)&&(h=1),this.GA=h,s&d.Sc.PE_TYPE_PROJCS?(l=this.Ue,this.HA=1/l.getUnit().getUnitFactor(),this.sw=.001/this.Ue.getUnit().getUnitFactor(),this.tw=d.Cg.generate(l,d.Cg.PE_PCSINFO_OPTION_NONE),this.zl=this.tw.isPannableRectangle(),this.bA=d.zb.qN(this.tw.getCentralMeridian(),this.GA)):(this.KA=this.zl=!0,this.HA=0,s=1/l.getUnit().getUnitFactor(),this.sw=.001/l.getDatum().getSpheroid().getAxis()*s,this.bA=0),this.zl&&(this.xx(),this.DK(),this.nY(),this.CK(),this.lY(),this.mY())}return x.prototype.$r=function(){return this.Kk},x.prototype.kk=function(){return this.tw},x.Py=function(h,l){return h==l||h!=null&&l!=null&&h.Kk==0&&l.Kk==0&&h.As===l.As},x.prototype.Wc=function(){return this.zl},x.prototype.gh=function(h){h.K(this.so)},x.prototype.pv=function(){return this.so.v},x.prototype.ov=function(){return this.so.C},x.prototype.GR=function(h){h.K(this.uw)},x.prototype.lY=function(){var h=this.Ue.getType();if(h==d.Sc.PE_TYPE_PROJCS){h=this.Ue;var l=this.kk().getCentralMeridian(),s=h.getGeogcs();if(s==null)throw d.i.fa("internal error");l=[[l+(s=1/s.getUnit().getUnitFactor()*Math.PI),0]],d.ej.geogToProj(h,1,l),l=l[0][0],s=h.getParameters()[d.Sc.PE_PARM_X0].getValue();var a=this.ml();h=new d.l,a.A(h),l=(a=Math.abs(l-s))+s,s=-1*a+s,a=h.H,h=h.G;var c=new d.l;c.K(s,h,l,a),this.so==null&&(this.so=c)}else{if(h!=d.Sc.PE_TYPE_GEOGCS)throw d.i.fa("internal error");s=1/this.Ue.getUnit().getUnitFactor()*Math.PI,(h=new d.l).K(-s,-s/2,s,s/2),this.so==null&&(this.so=h)}},x.prototype.mY=function(){var h=this.Ue.getType();if(h==d.Sc.PE_TYPE_PROJCS){var l=this.Ue;if(h=this.kk().getCentralMeridian(),(l=l.getGeogcs())==null)throw d.i.fa("internal error");l=1/l.getUnit().getUnitFactor()*Math.PI;var s=this.Vr(),a=new d.l;s.A(a),(s=new d.l).K(h-l,a.G,h+l,a.H),this.uw==null&&(this.uw=s)}else{if(h!=d.Sc.PE_TYPE_GEOGCS)throw d.i.fa("internal error");l=1/this.Ue.getUnit().getUnitFactor()*Math.PI,(h=new d.l).K(-l,-l/2,l,l/2),this.uw==null&&(this.uw=h)}},x.prototype.bf=function(){return this.GA},x.prototype.pm=function(){return this.HA},x.prototype.Vr=function(){if(this.zl)return this.ul;var h=this.ul;return h??(this.xx(),this.ul)},x.prototype.Wr=function(){return this.zl?null:(this.ul!=null||this.xx(),this.YG)},x.prototype.xx=function(){if(this.Ue.getType()==d.Sc.PE_TYPE_PROJCS){var h=this.Ue,l=h.getGeogcs(),s=h.horizonGcsGenerate();if(s!=null){var a=s[0].getNump(),c=s[0].getKind();h=0<s[0].getInclusive();var f=this.bf(),y=90*f,v=360*f,_=370*f,$=180*f*d.Sc.PE_HORIZON_DELTA/Math.PI,I=new d.l,k=null;if(1<a){for(var A=1;A<a;A++)if(s[A].getKind()==d.Sc.PE_HORIZON_LINE){k==null&&(k=new d.Ta);var P=s[A].getCoord();k.sx(P[0][0],P[0][1]),k.yj(P[1][0],P[1][1])}}if(c==d.Sc.PE_HORIZON_RECT)s=s[0].getCoord(),I.K(s[0][0],s[0][1]),I.Zb(s[1][0],s[1][1]),Math.abs(I.H-y)<1e-7*$&&(I.H=y),Math.abs(I.G+y)<1e-7*$&&(I.G=-y),I.R()>_&&(s=-400*f,I.K(s,I.G,s+5*v,I.H)),s=new d.Fh(I),this.ul==null&&(this.ul=s,this.Iv=h);else{if(_=new d.Da,v=this.kk().isGcsHorizonMultiOverlap(),I=d.gu.bF(l,d.hu.Integer64),v){for(_=new d.gL,$=d.Gh.local().V(_,I,null),A=0;A<a;A++)if(s[A].getKind()==d.Sc.PE_HORIZON_POLY){for(l=s[A].getSize(),f=s[A].getCoord(),c=[],y=0;y<l;y++)c[y]=d.h.construct(f[y][0],f[y][1]);s[A].getInclusive(),v&&((f=new d.Da).Yk(c,l-1),_.ZX(f),$.qe())}_=$.next()}else for(A=0;A<a;A++)if(s[A].getKind()==d.Sc.PE_HORIZON_POLY){for(l=s[A].getSize(),f=s[A].getCoord(),v=[],y=0;y<l;y++)v[y]=d.h.construct(f[y][0],f[y][1]);s[A].getInclusive(),_.Yk(v,l-1)}h?d.Xj.local().wn(_,I,1):d.kp.local().wn(_,I,1),d.dj.local().wn(_,I,1),this.ul==null&&(this.ul=_,this.Iv=h,this.YG=k)}}}},x.prototype.hv=function(){return this.zl||this.ul==null&&this.xx(),this.Iv},x.prototype.DK=function(){if(this.jH==2){var h=this.Ue.horizonPcsGenerate();if(h!=null){var l=h[0].getKind();h[0].getInclusive();var s=h[0].getNump(),a=!1;if(l==d.Sc.PE_HORIZON_RECT)h=h[0].getCoord(),(s=new d.l).K(h[0][0],h[0][1]),s.Zb(h[1][0],h[1][1]),h=new d.Fh(s);else{for(l=-1,a=0;a<s;a++)h[a].getKind()==d.Sc.PE_HORIZON_POLY&&(l=a);for(a=h[l].getSize()-1,h=h[l].getCoord(),s=[],l=0;l<a;l++)s[l]=d.h.construct(h[l][0],h[l][1]);h=l=new d.Da,l.Yk(s,a),a=!0}this.kk().isDensificationNeeded()&&(s=1e5*this.pm(),h=d.Xl.local().V(h,s,null)),a&&(a=new d.Fh,h.bn(a),h.Ke(),h.Qb(),h.qR(),d.Xj.local().wn(h,null,1)),this.Us==null&&(this.Us=h)}}},x.prototype.ml=function(){if(this.zl)return this.Us;var h=this.Us;return h??(this.DK(),this.Us)},x.prototype.nY=function(){if(this.Ue.getType()==d.Sc.PE_TYPE_PROJCS){var h=90*this.bf();h=[[0,h],[0,-h]],d.ej.geogToProj(this.Ue,2,h);var l=this.kk(),s=l.getNorthPoleLocation()!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY;l=l.getSouthPoleLocation()!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY,this.KA||(s&&this.HH.ma(h[0][0],h[0][1]),l&&this.XH.ma(h[1][0],h[1][1]))}this.KA=!0},x.prototype.CK=function(){if(this.jH==1){var h=400*this.bf();this.vq.K(-h,-h,h,h)}else h=d.Cg.generate(this.Ue,d.Cg.PE_PCSINFO_OPTION_DOMAIN),h=d.l.construct(h.getDomainMinx(),h.getDomainMiny(),h.getDomainMaxx(),h.getDomainMaxy()),this.vq.B()&&this.vq.K(h)},x.prototype.hR=function(h){this.zl&&h.K(this.vq),this.vq.B()&&this.CK(),h.K(this.vq)},x.prototype.Up=function(){return this.RH},x.prototype.zi=function(){return this.bA},x.prototype.Hd=function(){return this.Eo},x.prototype.Xr=function(){return this.wH},x}();d.OC=O}(Y||(Y={})),function(d){var O=function(){function x(h){this.KT=h,this.As=d.zb.xv(h,0,!0);var l=h.getCode();this.ss=0<l?l:d.pf.getCode(h),0>this.ss&&(this.ss=0),this.Eo=l=this.KT.getUnit(),this.IH=1/l.getUnitFactor(),d.pf.getCode(h)}return x.Py=function(h,l){return h==l||h!=null&&l!=null&&h.ss==0&&l.ss==0&&h.As===l.As},x.prototype.$r=function(){return this.ss},x}();d.PL=O}(Y||(Y={})),function(d){d.Yg=function(){function O(){}return O.tb=function(x,h,l,s,a,c,f,y){if(c!=null||f!=null||y!=null){s=d.F.ba(s),h=d.F.ba(h),l=d.F.ba(l),a=d.F.ba(a),1.570796326794897<d.s.P(l)&&(l=d.s.Mb(3.141592653589793,l)-l,h=d.F.ba(h+3.141592653589793)),1.570796326794897<d.s.P(a)&&(a=d.s.Mb(3.141592653589793,a)-a,s=d.F.ba(s+3.141592653589793));var v=d.F.ba(s-h);if(d.s.Y(l,a)&&(d.s.Y(h,s)||d.s.Y(d.s.P(l),1.570796326794897)))c!=null&&(c.u=0),f!=null&&(f.u=0),y!=null&&(y.u=0);else{if(d.s.Y(l,-a)){if(d.s.Y(d.s.P(l),1.570796326794897))return c!=null&&(c.u=3.141592653589793*x),f!=null&&(f.u=0<l?d.F.ba(3.141592653589793-d.F.ba(s)):d.F.ba(s)),void(y!=null&&(y.u=0<l?d.F.ba(s):d.F.ba(3.141592653589793-d.F.ba(s))));if(d.s.Y(d.s.P(v),3.141592653589793))return c!=null&&(c.u=3.141592653589793*x),f!=null&&(f.u=0),void(y!=null&&(y.u=0))}var _=d.s.P(l)==1.570796326794897?0:Math.cos(l),$=Math.sin(l),I=d.s.P(a)==1.570796326794897?0:Math.cos(a),k=Math.sin(a),A=d.s.P(v)==1.570796326794897?0:Math.cos(v),P=d.s.P(v)==3.141592653589793?0:Math.sin(v);if(c!=null){var D=Math.sin((a-l)/2);v=Math.sin(v/2),c.u=2*Math.asin(Math.sqrt(D*D+_*I*v*v))*x}f!=null&&(f.u=d.s.Y(d.s.P(l),1.570796326794897)?0>l?s:d.F.ba(3.141592653589793-s):Math.atan2(I*P,_*k-$*I*A)),y!=null&&(d.s.Y(d.s.P(a),1.570796326794897)?y.u=0>a?h:d.F.ba(3.141592653589793-h):(y.u=Math.atan2(_*P,k*_*A-I*$),y.u=d.F.ba(y.u+3.141592653589793)))}}},O.rf=function(x,h,l,s,a,c,f){if(c!=null||f!=null){h=d.F.ba(h),l=d.F.ba(l),1.570796326794897<d.s.P(l)&&(l=d.s.Mb(3.141592653589793,l)-l,h=d.F.ba(h+3.141592653589793)),d.s.Y(d.s.P(l),1.570796326794897)&&(h=0),a=d.F.ba(a);var y=d.s.Y(d.s.P(a),1.570796326794897)?0:Math.cos(a),v=d.s.Y(d.s.P(a),3.141592653589793)?0:Math.sin(a),_=d.s.Y(d.s.P(l),1.570796326794897)?0:Math.cos(l),$=Math.sin(l);x=s/x,s=d.s.Y(d.s.P(x),1.570796326794897)?0:Math.cos(x);var I=d.s.Y(d.s.P(x),3.141592653589793)?0:Math.sin(x),k=Math.asin($*s+_*I*y);f!=null&&(f.u=k),c!=null&&(c.u=d.s.Y(d.s.P(k),1.570796326794897)?d.s.Y(l,-k)?0>k?a:d.F.ba(3.141592653589793-a):h:d.s.Y(d.s.P(l),1.570796326794897)&&d.s.Y(x,3.141592653589793)?0>l?a:d.F.ba(3.141592653589793-a):d.F.ba(h+Math.atan2(I*v,_*s-$*I*y)))}},O}()}(Y||(Y={})),function(d){d.Wk=function(){function O(){}return O.tb=function(x,h,l,s,a,c,f,y,v){var _=new d.ga(0),$=new d.ga(0),I=[0,0,0],k=[0,0,0],A=[0,0,0],P=new d.ga(0),D=new d.ga(0),j=new d.ga(0),B=new d.ga(0),q=new d.ga(0);if(f!=null||y!=null||v!=null)if(d.s.ti(h))d.Yg.tb(x,l,s,a,c,f,y,v);else{a=d.F.ba(a),l=d.F.ba(l);var z=d.F.ba(a-l);if(d.s.Y(s,c)&&(d.s.Y(l,a)||d.s.Y(d.s.P(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.Y(s,-c)){if(d.s.Y(d.s.P(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0<s?d.F.ba(3.141592653589793-d.F.ba(a)):d.F.ba(a)),void(v!=null&&(v.u=0<s?d.F.ba(a):d.F.ba(3.141592653589793-d.F.ba(a))));d.s.Y(d.s.P(z),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else(d.s.Y(d.s.P(s),1.570796326794897)||d.s.Y(d.s.P(c),1.570796326794897))&&(d.s.Y(d.s.P(s),1.570796326794897)?l=a:a=l);var Z=0;if(0>z){Z=1;var ee=l;l=a,a=ee,ee=s,s=c,c=ee}z=d.F.ot(h,s);var Q=d.F.ot(h,c);y==null&&v==null||(d.Yg.tb(x,l,z,a,Q,null,_,$),_=Math.atan2(Math.sin(_.u)*Math.cos(s-z),Math.cos(_.u)),$=Math.atan2(Math.sin($.u)*Math.cos(c-Q),Math.cos($.u)),Z!=0&&(ee=_,_=$,$=ee),y!=null&&(y.u=_),v!=null&&(v.u=$)),f!=null&&(d.F.cl(1,h,s,l,0,j,B,q),I[0]=j.u,I[1]=B.u,I[2]=q.u,d.F.cl(1,h,c,a,0,j,B,q),k[0]=j.u,k[1]=B.u,k[2]=q.u,A[0]=I[1]*k[2]-k[1]*I[2],A[1]=-(I[0]*k[2]-k[0]*I[2]),A[2]=I[0]*k[1]-k[0]*I[1],h=1-d.F.w(h,d.F.Vq(h,d.F.Qj(h,Math.acos(A[2]/Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]))))),h*=2-h,y=Math.atan2(-A[1],-A[0]),A=d.F.ba(y-1.570796326794897),y=d.F.ba(y+1.570796326794897),A=d.s.P(d.F.ba(l-A))<=d.s.P(d.F.ba(l-y))?A:y,d.Yg.tb(1,A,0,l,z,P,null,null),d.Yg.tb(1,A,0,a,Q,D,null,null),3.141592653589793<P.u+D.u&&(A=d.F.ba(A+3.141592653589793),d.Yg.tb(1,A,0,l,z,P,null,null),d.Yg.tb(1,A,0,a,Q,D,null,null)),P.u*=d.s.Mb(1,s),D.u*=d.s.Mb(1,c),P.u=d.F.Qj(h,P.u),D.u=d.F.Qj(h,D.u),l=d.F.q(x,h,P.u),x=d.F.q(x,h,D.u),f.u=d.s.P(x-l))}}},O.rf=function(x,h,l,s,a,c,f,y){var v=0,_=new d.ga(0),$=new d.ga(0),I=[0,0,0],k=[0,0,0],A=new d.ga(0),P=new d.ga(0),D=new d.ga(0);if(f!=null||y!=null)if(d.s.ti(h))d.Yg.rf(x,l,s,a,c,f,y);else if(d.s.Cd(a))f!=null&&(f.u=l),y!=null&&(y.u=s);else if(c=d.F.ba(c),0>a&&(a=d.s.P(a),c=d.F.ba(c+3.141592653589793)),l=d.F.ba(l),s=d.F.ba(s),1.570796326794897<d.s.P(s)&&(l=d.F.ba(l+3.141592653589793),s=d.s.Mb(3.141592653589793,s)-s),d.s.Y(d.s.P(s),1.570796326794897)&&(l=0),d.s.Cd(s)){var j=d.s.P(1.570796326794897-d.s.P(c));j=d.F.Qj(h,j),j=1-d.F.w(h,d.F.Vq(h,j)),j*=2-j,x=a/d.F.Ah(x,j)*1.570796326794897,x=d.F.Rq(j,x),x=d.F.ot(j,x),d.Yg.rf(1,l,s,x,c,f,_),y!=null&&(v=_.u),y!=null&&(y.u=d.F.Qj(h,v))}else if(d.s.Y(d.s.P(s),1.570796326794897))_=2*(v=d.F.Ah(x,h)),c=0<(x=d.s.Mb(1.570796326794897,s))?d.F.ba(3.141592653589793-c):c,s=v-a,d.s.P(s)<=v?f!=null&&(f.u=c):(s=Math.floor(a/_),d.O.truncate(s%2)==0?(f!=null&&(f.u=c),a-=s*_):(f!=null&&(f.u=d.F.ba(c+3.141592653589793)),a=(s+1)*_-a),s=v-a),y!=null&&(y.u=d.F.Rq(h,s/v*x));else{j=d.F.ot(h,s),c=Math.atan2(Math.sin(c),Math.cos(c)*Math.cos(s-j));var B=d.O.truncate(d.s.Mb(1,j))*(1.570796326794897>=d.s.P(c)?1:-1);c=d.F.ba(l+Math.atan(Math.tan(c)*-Math.sin(j))),d.Yg.tb(x,c,0,l,j,null,$,null),j=d.s.P(1.570796326794897-d.s.P($.u)),j=d.F.Qj(h,j),j=1-d.F.w(h,d.F.Vq(h,j)),j*=2-j,d.F.cl(1,h,0,c,0,A,P,D),I[0]=A.u,I[1]=P.u,I[2]=D.u,d.F.cl(1,h,s,l,0,A,P,D),k[0]=A.u,k[1]=P.u,k[2]=D.u,s=Math.acos((I[0]*k[0]+I[1]*k[1]+I[2]*k[2])/Math.sqrt(k[0]*k[0]+k[1]*k[1]+k[2]*k[2])),s=d.F.Qj(j,s),a=0<(s=d.F.q(x,j,s)+a*B)?$.u:d.F.ba($.u+3.141592653589793),x=d.s.P(s)/d.F.Ah(x,j)*1.570796326794897,x=d.F.Rq(j,x),x=d.F.ot(j,x),d.Yg.rf(1,c,0,x,a,f,_),y!=null&&(v=_.u),y!=null&&(y.u=d.F.Qj(h,v))}},O}()}(Y||(Y={})),function(d){d.cu=function(){function O(){}return O.tb=function(x,h,l,s,a,c,f,y,v){var _=0,$=0,I=0;if(f!=null||y!=null||v!=null)if(d.s.ti(h))d.Yg.tb(x,l,s,a,c,f,y,v);else{var k=d.F.ba(a-l);if(d.s.Y(s,c)&&(d.s.Cd(k)||d.s.Y(d.s.P(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.Y(s,-c)){if(d.s.Y(d.s.P(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0<s?d.F.ba(3.141592653589793-d.F.ba(a)):d.F.ba(a)),void(v!=null&&(v.u=0<s?d.F.ba(a):d.F.ba(3.141592653589793-d.F.ba(a))));d.s.Y(d.s.P(k),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else if(d.s.Y(d.s.P(s),1.570796326794897)||d.s.Y(d.s.P(c),1.570796326794897)||d.s.Cd(k)||d.s.Y(d.s.P(k),3.141592653589793))return void d.Wk.tb(x,h,l,s,a,c,f,y,v);var A=1-Math.sqrt(1-h),P=h/(1-h),D=x*(1-A);x=d.F.Vq(h,s);var j=d.F.Vq(h,c);h=d.s.P(x)==1.570796326794897?0:Math.cos(x);var B=Math.sin(x),q=d.s.P(j)==1.570796326794897?0:Math.cos(j),z=Math.sin(j),Z=k,ee=Math.cos(Z),Q=Math.sin(Z),le=1,se=0;do{var ve=Z,xe=Math.sqrt(Math.pow(q*Q,2)+Math.pow(h*z-B*q*ee,2)),_e=B*z+h*q*ee,je=Math.atan2(xe,_e);if(xe==0){le=0;break}var Ae=h*q*Q/xe;if(_=Math.cos(Math.asin(Ae)),$=_e-2*B*z/(_*=_),1<d.s.P($)&&($=d.s.Mb(1,$)),Z=k+(1-(Z=A/16*_*(4+A*(4-3*_))))*A*Ae*(je+Z*xe*($+Z*_e*(2*(I=$*$)-1))),ee=Math.cos(Z),Q=Math.sin(Z),se++,3.141592653589793<d.s.P(Z)&&30<se){le=0;break}}while(5e3>=se&&!d.s.Y(ve,Z));if(le!=0)A=(P*=_)*(256+P*(P*(74-47*P)-128))/1024,f!=null&&(f.u=D*(1+P*(4096+P*(P*(320-175*P)-768))/16384)*(je-A*xe*($+A/4*(_e*(2*I-1)-A/6*$*(4*xe*xe-3)*(4*I-3))))),y!=null&&(y.u=d.s.Y(d.s.P(s),1.570796326794897)?0>s?a:d.F.ba(3.141592653589793-a):Math.atan2(q*Q,h*z-B*q*ee)),v!=null&&(d.s.Y(d.s.P(c),1.570796326794897)?v.u=0>c?l:d.F.ba(3.141592653589793-l):(v.u=Math.atan2(h*Q,h*z*ee-B*q),v.u=d.F.ba(v.u+3.141592653589793)));else{Z=d.s.Mb(3.141592653589793,k),_e=B*z-h*q,je=Math.acos(_e),xe=Math.sin(je),_=1,se=Ae=0;do I=Ae,ee=1-.25*(Ae=A*(_*=_)*(1+A+A*A))+.1875*($=A*A*(ee=_*_)*(1+2.25*A))-.1953125*(le=A*A*A*ee*_),Ae=.25*Ae-.25*$+.29296875*le,Q=.03125*$-.05859375*le,le*=.00651041666666667,$=_e-2*B*z/_,1<d.s.P($)&&($=d.s.Mb(1,$)),_=Math.acos($),_e=Math.cos(2*_),ve=Math.cos(3*_),Q=(Ae=d.s.Y(s,-c)?d.F.ba(3.141592653589793-k)/(3.141592653589793*A*ee):d.F.ba(Z-k)/(A*(ee*je+Ae*xe*$+Q*Math.sin(2*je)*_e+le*Math.sin(3*je)*ve)))*xe/(h*q),Z=1.570796326794897<d.s.P(k)?d.s.Mb(3.141592653589793,Q)-Math.asin(Q):Math.asin(Q),ee=Math.cos(Z),xe=Math.sqrt(Math.pow(q*Q,2)+Math.pow(h*z-B*q*ee,2)),je=3.141592653589793-Math.asin(d.s.P(xe)),_e=Math.cos(je),_=Math.cos(Math.asin(Ae)),se++;while(70>=se&&!d.s.Y(I,Ae));f!=null&&(ee=1+(P*=_*=_)*(4096+P*(P*(320-175*P)-768))/16384,d.s.Y(s,-c)?f.u=3.141592653589793*D*ee:($=_e-2*B*z/_,_=Math.acos($),_e=Math.cos(2*_),ve=Math.cos(3*_),f.u=D*(ee*je+P*(P*(128+P*(35*P-60))-512)/2048*xe*$+P*(5*P-4)/6144*P*P*Math.sin(2*je)*_e+le*Math.sin(3*je)*ve+-762939453125e-16*P*P*P*P*Math.sin(4*je)*Math.cos(4*_)))),y!=null&&(d.s.Cd(s)&&d.s.Cd(c)?(_=Math.sqrt(1-Ae*Ae),y.u=Math.acos(_),0>k&&(y.u*=-1)):d.s.Y(d.s.P(s),1.570796326794897)?y.u=0>s?a:d.F.ba(3.141592653589793-a):(f=Ae/h,D=Math.sqrt(1-f*f),0>h*z-B*q*Math.cos(Z)&&(D*=-1),y.u=Math.atan2(f,D),d.s.Y(s,-c)&&d.s.P(d.F.ba(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(0<s&&1.570796326794897>d.s.P(y.u)||0>s&&1.570796326794897<d.s.P(y.u))&&(y.u=d.s.Mb(3.141592653589793,y.u)-y.u))),v!=null&&(d.s.Cd(s)&&d.s.Cd(c)?(_=Math.sqrt(1-Ae*Ae),v.u=Math.acos(_),0<=k&&(v.u*=-1)):d.s.Y(d.s.P(c),1.570796326794897)?v.u=0>c?l:d.F.ba(3.141592653589793-l):(k=Ae/q,f=Math.sqrt(1-k*k),D=Math.sin(Z/2),0>Math.sin(j-x)-2*h*z*D*D&&(f*=-1),v.u=Math.atan2(k,f),v.u=d.F.ba(v.u+3.141592653589793),d.s.Y(s,-c)&&!d.s.Cd(s)&&!d.s.Y(d.s.P(s),1.570796326794897)&&d.s.P(d.F.ba(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(y!=null?D=y.u:(f=Ae/h,D=Math.sqrt(1-f*f),0>h*z-B*q*Math.cos(Z)&&(D*=-1),D=Math.atan2(f,D),d.s.Y(s,-c)&&d.s.P(d.F.ba(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(0<s&&1.570796326794897>d.s.P(D)||0>s&&1.570796326794897<d.s.P(D))&&(D=d.s.Mb(3.141592653589793,D)-D)),1.570796326794897>=d.s.P(D)&&1.570796326794897<d.s.P(v.u)||1.570796326794897<=d.s.P(D)&&1.570796326794897>d.s.P(v.u))&&(v.u=-1*d.F.ba(v.u+3.141592653589793))))}}}},O.rf=function(x,h,l,s,a,c,f,y){if(f!=null||y!=null)if(d.s.ti(h))d.Yg.rf(x,l,s,a,c,f,y);else if(c=d.F.ba(c),d.s.Y(d.s.P(s),1.570796326794897)||d.s.Cd(c)||d.s.Y(d.s.P(c),3.141592653589793))d.Wk.rf(x,h,l,s,a,c,f,y);else{var v=d.s.P(c)==1.570796326794897?0:Math.cos(c),_=d.s.P(c)==3.141592653589793?0:Math.sin(c);d.s.Y(d.s.P(s),1.570796326794897)&&(l=0),c=1-Math.sqrt(1-h);var $=d.F.Vq(h,s);s=d.s.P($)==1.570796326794897?0:Math.cos($);var I=Math.sin($);$=Math.atan2(Math.tan($),v);var k=s*_,A=k*k,P=1-A,D=h/(1-h)*P,j=(h=D*(256+D*(D*(74-47*D)-128))/1024)/4,B=h/6,q=a/(x*(1-c)*(1+D*(4096+D*(D*(320-175*D)-768))/16384)),z=q;do{var Z=z;a=d.s.P(z)==1.570796326794897?0:Math.cos(z);var ee=(D=d.s.P(z)==3.141592653589793?0:Math.sin(z))*D;z=h*D*((x=Math.cos(2*$+z))+j*(a*(2*(z=x*x)-1)-B*x*(4*ee-3)*(4*z-3)))+q}while(!d.s.Y(Z,z));a=d.s.P(z)==1.570796326794897?0:Math.cos(z),D=d.s.P(z)==3.141592653589793?0:Math.sin(z),f!=null&&(_=Math.atan2(D*_,s*a-I*D*v),P=c/16*P*(4+c*(4-3*P)),x=Math.cos(2*$+z),f.u=d.F.ba(l+(_-(1-P)*c*k*(z+P*D*(x+P*a*(2*x*x-1)))))),y!=null&&(P=I*D-s*a*v,P=(1-c)*Math.sqrt(A+P*P),y.u=Math.atan2(I*a+s*D*v,P))}},O}()}(Y||(Y={})),function(d){d.PC=function(){function O(){}return O.tb=function(x,h,l,s,a,c,f,y,v){var _=d.F.ba(a-l),$=d.s.Y(d.s.P(s),1.570796326794897),I=d.s.Y(d.s.P(c),1.570796326794897);if(d.s.Y(s,c)&&(d.s.Cd(_)||$))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.ti(h)){var k=Math.sin(s),A=Math.sin(c);k=Math.sqrt((1+k)/(1-k)),A=Math.sqrt((1+A)/(1-A)),k=Math.log(A)-Math.log(k),k=Math.atan2(_,k),f!=null&&(f.u=d.s.Y(s,c)?d.s.P(x*Math.cos(s)*_):d.s.P((x*c-x*s)/Math.cos(k)))}else A=d.F.Qw(h,c),k=Math.sin(d.F.Qw(h,s)),A=Math.sin(A),k=Math.sqrt((1+k)/(1-k)),A=Math.sqrt((1+A)/(1-A)),k=Math.log(A)-Math.log(k),k=Math.atan2(_,k),f!=null&&(d.s.Y(s,c)?f.u=d.s.P(x*_*Math.cos(s)/d.F.w(h,s)):(_=d.F.q(x,h,s),x=d.F.q(x,h,c),f.u=d.s.P((x-_)/Math.cos(k))));y==null&&v==null||(f=d.F.ba(k+3.141592653589793),$&&I||!$&&!I||($?k=0>s?a:d.F.ba(3.141592653589793-a):I&&(f=0>c?l:d.F.ba(3.141592653589793-l))),y!=null&&(y.u=k),v!=null&&(v.u=f))}},O.rf=function(x,h,l,s,a,c,f,y){c=d.F.ba(c),0>a&&(a=d.s.P(a),c=d.F.ba(c+3.141592653589793)),d.s.ti(h)?d.s.Y(d.s.P(s),1.570796326794897)?(l=0>s?c:d.F.ba(3.141592653589793-c),3.141592653589793>=(c=a/x%6.283185307179586)?x=s-d.s.Mb(c,s):(l=d.F.ba(l+3.141592653589793),x=-s+d.s.Mb(c-3.141592653589793,s))):d.s.Y(d.s.P(c),1.570796326794897)?(l=d.F.ba(l+d.s.Mb(a,c)/(x*Math.cos(s))),x=s):(x=s+a*Math.cos(c)/x,1.570796326794897<d.s.P(x)&&(x=1.570796326794897),d.s.Y(d.s.P(x),1.570796326794897)&&(d.s.Cd(c)||d.s.Y(d.s.P(c),3.141592653589793))||(1.570796316258184<d.s.P(x)&&(x=d.s.Mb(1.570796316258184,x)),h=Math.sin(s),s=Math.sin(x),h=Math.sqrt((1+h)/(1-h)),s=Math.sqrt((1+s)/(1-s)),h=Math.log(s)-Math.log(h),l=d.F.ba(l+Math.tan(c)*h))):d.s.Y(d.s.P(s),1.570796326794897)?(l=0>s?c:d.F.ba(3.141592653589793-c),c=a/d.F.qW(x,h),3.141592653589793>=(c%=6.283185307179586)?x=s-d.s.Mb(c,s):(l=d.F.ba(l+3.141592653589793),x=-s+d.s.Mb(c-3.141592653589793,s)),x=d.F.Rq(h,x)):d.s.Y(d.s.P(c),1.570796326794897)?(l=d.F.ba(l+d.s.Mb(a,c)*d.F.w(h,s)/(x*Math.cos(s))),x=s):(x=1.570796326794897*(a*Math.cos(c)+d.F.q(x,h,s))/d.F.Ah(x,h),1.570796326794897<d.s.P(x)&&(x=d.s.Mb(1.570796326794897,x)),x=d.F.Rq(h,x),d.s.Y(d.s.P(x),1.570796326794897)&&(d.s.Cd(c)||d.s.Y(d.s.P(c),3.141592653589793))||(a=d.F.Qw(h,s),s=d.F.Qw(h,x),1.570796316258184<d.s.P(s)&&(s=d.s.Mb(1.570796316258184,x),x=d.F.yO(h,s)),h=Math.sin(a),s=Math.sin(s),h=Math.sqrt((1+h)/(1-h)),s=Math.sqrt((1+s)/(1-s)),h=Math.log(s)-Math.log(h),l=d.F.ba(l+Math.tan(c)*h))),f!=null&&(f.u=l),y!=null&&(y.u=x)},O}()}(Y||(Y={})),function(d){d.kb=function(){function O(){}return O.Xy=function(x,h,l,s,a,c,f){d.cu.tb(x,h,l,s,a,c,null,f,null)},O.yi=function(x,h,l,s,a,c,f,y){d.cu.rf(x,h,l,s,a,c,f,y)},O.wd=function(x,h,l,s,a,c,f,y,v,_){switch(_){case 2:d.Wk.tb(x,h,l,s,a,c,f,y,v);break;case 3:d.QC.tb(x,h,l,s,a,c,f,y,v);break;case 1:d.PC.tb(x,h,l,s,a,c,f,y,v);break;default:d.cu.tb(x,h,l,s,a,c,f,y,v)}},O.oj=function(x,h,l,s,a,c,f,y,v){switch(v){case 2:d.Wk.rf(x,h,l,s,a,c,f,y);break;case 3:d.QC.rf(x,h,l,s,a,c,f,y);break;case 1:d.PC.rf(x,h,l,s,a,c,f,y);break;default:d.cu.rf(x,h,l,s,a,c,f,y)}},O}()}(Y||(Y={})),function(d){var O=function(){function h(){this.y=this.x=null}return h.construct=function(l){var s=new h;return s.x=new d.Wb,s.x.set(l.x),s.y=new d.Wb,s.y.set(l.y),s},h.VE=function(l,s){var a=new h;return a.x=new d.Wb,a.x.set(l),a.y=new d.Wb,a.y.set(s),a},h.prototype.qg=function(){return this.x.qg()&&this.y.qg()},h.prototype.value=function(){return d.h.construct(this.x.value(),this.y.value())},h}();d.vY=O;var x=function(){function h(){this.z=this.y=this.x=null}return h.construct=function(l){var s=new h;return s.x=new d.Wb,s.x.set(l.x),s.y=new d.Wb,s.y.set(l.y),s.z=new d.Wb,s.z.set(l.z),s},h.VE=function(l,s,a){var c=new h;return c.x=new d.Wb,c.x.set(l),c.y=new d.Wb,c.y.set(s),c.z=new d.Wb,c.z.set(a),c},h.prototype.qg=function(){return this.x.qg()&&this.y.qg()&&this.z.qg()},h.prototype.value=function(){return new d.Nd(this.x.value(),this.y.value(),this.z.value())},h.prototype.Qh=function(l){var s=new d.Wb,a=new d.Wb,c=new d.Wb;return s.Kl(this.x,l.x),a.Kl(this.y,l.y),c.Kl(this.z,l.z),(l=new d.Wb).dN(s,a),l.add(c),l},h.prototype.cF=function(l){var s=new h;s.x.Kl(this.y,l.z),s.y.Kl(this.z,l.x),s.z.Kl(this.x,l.y);var a=new d.Wb,c=new d.Wb,f=new d.Wb;return a.Kl(this.z,l.y),c.Kl(this.x,l.z),f.Kl(this.y,l.x),s.x.sub(a),s.y.sub(c),s.z.sub(f),s},h}();d.wY=x,d.Ox=function(){function h(){}return h.EP=function(l,s,a){var c=s.x;s=s.y,h.cl(1,l,Math.cos(c),Math.sin(c),Math.cos(s),Math.sin(s),a)},h.DP=function(l,s){var a=new d.Nd;return h.EP(l,s,a),a},h.cl=function(l,s,a,c,f,y,v){l/=Math.sqrt(1-s*y*y),v.K(l*f*a,l*f*c,l*(1-s)*y)},h.Yu=function(l,s){var a=new d.Wb,c=new d.Wb,f=new d.Wb,y=new d.Wb;a.cos(s.x),c.sin(s.x),f.cos(s.y),y.sin(s.y);var v=new d.Wb;return v.set(y),v.Ag(y),v.No(l),v.No(-1),v.kN(),v.sqrt(),(s=new d.Wb).set(1),s.jm(v),(v=new d.Wb).set(s),v.Ag(f),v.Ag(a),(a=new d.Wb).set(s),a.Ag(f),a.Ag(c),(c=new d.Wb).set(s),c.No(1-l),c.Ag(y),x.VE(v,a,c)},h.SS=function(l,s,a,c){if(Math.abs(s.x-a.x)>Math.PI||Math.abs(s.y)>.5*Math.PI||Math.abs(a.y)>.5*Math.PI||(Math.abs(s.y)==.5*Math.PI||Math.abs(a.y)==.5*Math.PI)&&s.x!=a.x)return NaN;if(c=h.cB(c,Math.min(s.x,a.x),Math.max(s.x,a.x)),!new d.Nc(s.x,a.x).contains(c))return NaN;var f=O.construct(s);if(a=O.construct(a),f=h.Yu(l,f),a=h.Yu(l,a),(a=f.cF(a)).z.qg())return s.y;var y=new d.Wb;y.set(a.x),y.jm(a.z),y.No(-1);var v=new d.Wb;v.set(a.y),v.jm(a.z),v.No(-1);var _=new d.Wb;return _.set(v),_.Ag(v),(f=new d.Wb).set(y),f.Ag(y),f.add(_),f.sqrt(),f.qg()||y.qg()&&v.qg()?s.y:(s=Math.atan2(v.value(),y.value()),s=Math.atan2(f.value()*Math.cos(s-c),1-l),c=h.DP(l,d.h.construct(c,s)),l=new d.Nd(c.x,c.y,-c.z),c=a.value().Qh(c),l=a.value().Qh(l),Math.abs(l)<Math.abs(c)&&(s=-s),s)},h.Oz=function(l,s,a,c,f){if(f[0]=NaN,f[1]=NaN,Math.abs(s.x-a.x)>Math.PI||Math.abs(s.y)>.5*Math.PI||Math.abs(a.y)>.5*Math.PI||(Math.abs(s.y)==.5*Math.PI||Math.abs(a.y)==.5*Math.PI)&&s.x!=a.x||Math.abs(c)>=.5*Math.PI||0<s.y&&0<a.y&&s.y>c&&a.y>c||0>s.y&&0>a.y&&s.y<c&&a.y<c)return 0;var y=O.construct(s),v=O.construct(a);y=h.Yu(l,y),v=h.Yu(l,v);var _=y.cF(v);if(_.z.qg())return new d.Nc(s.y,a.y).contains(c)?(f[0]=s.x,1):0;(v=new d.Wb).set(_.x),v.jm(_.z),v.No(-1),(y=new d.Wb).set(_.y),y.jm(_.z),y.No(-1),(_=new d.Wb).set(y),_.Ag(y);var $=new d.Wb;return $.set(v),$.Ag(v),$.add(_),$.sqrt(),$.qg()||v.qg()&&y.qg()?c==0?(f[0]=s.x,f[1]=a.x,2):0:(l=(1-l)*Math.tan(c)/$.value(),1<Math.abs(l)?0:(l=Math.acos(l),_=Math.atan2(y.value(),v.value()),v=Math.min(s.x,a.x),y=Math.max(s.x,a.x),a=h.cB(_-l,v,y),l=c!=0?h.cB(_+l,v,y):a,c=0,v<=a&&a<=y&&(f[c]=a,c++),l!=a&&v<=l&&l<=y&&(f[c]=l,++c==2&&Math.abs(f[0]-s.x)>Math.abs(f[1]-s.x)&&(s=f[0],f[0]=f[1],f[1]=s)),c))},h.cB=function(l,s,a){return l>a?l-=2*(s=Math.ceil((l-a)/(2*Math.PI)))*Math.PI:l<s&&(l+=2*(s=Math.ceil((s-l)/(2*Math.PI)))*Math.PI),l},h}()}(Y||(Y={})),function(d){d.XK=function(){function O(){}return O.$X=function(x,h){var l=8,s=[0,0,0,0],a=new d.h;a.L(h),a.scale(d.cb.sc(x).Hd().Ec()==9102?1:d.cb.sc(x).Hd().ai/3.141592653589793*180),-180>a.x?(a.x-=a.x%360,-180>a.x&&(a.x+=360)):180<a.x&&(a.x-=a.x%360,180<a.x&&(a.x-=360)),90<a.y&&(a.y=90),-90>a.y&&(a.y=-90);for(var c=-180,f=180,y=(x=5*l)-1,v=(h=(x+31)/32)-1;0<=v;v--)for(var _=y-32*v,$=Math.min(32,x-32*v),I=1;I<$;I+=2){var k=.5*(f+c);a.x>=k?(s[v]|=1<<_,c=k):f=k,_-=2,y-=2}for(c=-90,f=90,y=x-2,v=h-1;0<=v;v--)for(_=y-32*v,$=Math.min(32,x-32*v),I=0;I<$;I+=2)k=.5*(f+c),a.y>=k?(s[v]|=1<<_,c=k):f=k,_-=2,y-=2;return O.$P(s,l,l)},O.$P=function(x,h,l){for(var s=[],a=0;a<h;a++)s[a]="";for(var c=a=0,f=0;f<h;f++){var y=x[a]>>c&31;if(31<(c+=5)){var v=37-c;y&=(1<<v)-1,c-=32,y|=(x[++a]&(1<<c)-1)<<v}s[h-1-f]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[y]}if(l>h)for(f=0;f<l-h;f++)s.push("0");else l<h&&(s.length=l);return s.join("")},O}()}(Y||(Y={})),function(d){var O={gcstol:[0,2e-9,1,2241706620489156e-24,2,2313672246530541e-24,3,898240164660333e-23,4,8982433838020134e-24,5,8982439417325895e-24,6,8982466029667677e-24,7,8982476760268133e-24,8,8982492642167149e-24,9,898251968292634e-23,10,898253685210448e-23,11,8982546725256576e-24,12,8982557456049832e-24,13,898257333682596e-23,14,8982575482995276e-24,15,8982578488197342e-24,16,8982579775336987e-24,17,89825840676828e-22,18,8982599090925448e-24,19,8982605529473397e-24,20,8982609220517402e-24,21,8982611968030573e-24,22,8982616260407152e-24,23,8982620552787834e-24,24,8982633429954492e-24,25,8982637722351582e-24,26,898264416095491e-23,27,8982646307158072e-24,28,8982654891980968e-24,29,8982667769246082e-24,30,8982674207892485e-24,31,8982680646548117e-24,32,8982682792768713e-24,33,8982685798042582e-24,34,8982689231436652e-24,35,898269137766135e-23,36,898269266624163e-23,37,8982705114087017e-24,38,8982706830791106e-24,39,8982711958374661e-24,40,8982712839964735e-24,41,8982717991496125e-24,42,8982721424914803e-24,43,8982723571154887e-24,44,8982727863638127e-24,45,8982730868942154e-24,46,8982734302370678e-24,47,8982745033612112e-24,48,8982751472369276e-24,49,8982755764879183e-24,50,8982762203651733e-24,51,8982764776628385e-24,52,8982766496171896e-24,53,898277722749025e-23,54,898278152002477e-23,55,898279933943848e-23,56,89829143024805e-22,57,8982922161948598e-24,58,898292327314211e-23,59,8982925667349601e-24,60,8982932222965576e-24,61,8982961298941316e-24,62,8982965524049989e-24,63,8982994818246099e-24,64,8982994895706967e-24,65,898299489597736e-23,66,8983000733443498e-24,67,8983055097289157e-24,68,8983064111047368e-24,69,8983111996941178e-24,70,8983120447446023e-24,71,898312748954554e-23,72,8983134531656096e-24,73,8983141573777694e-24,74,8983148615910332e-24,75,8983152841195215e-24,76,8983153545409748e-24,77,8983153827095593e-24,78,898315396793852e-23,79,8983154249624393e-24,80,8983155658054012e-24,81,8983960794340072e-24,82,8984061344391998e-24,83,8984072829255685e-24,84,8984194981201908e-24,85,8984275233099427e-24,86,8984326127007554e-24,87,8984330099816539e-24,88,898433275258421e-23,89,8984333047023206e-24,90,8984333885258723e-24,91,8984337959508212e-24,92,8984365176209457e-24,93,8984727360418079e-24,94,8984901041679577e-24,95,898542662091587e-23,96,898610024130669e-23,97,8992894229037531e-24,98,8993203677616635e-24,99,8993206178094346e-24,100,8993216059187305e-24,101,899322029394808e-23,102,8994627867045891e-24,103,9467559984315793e-24,104,946881168618118e-23,105,9980888154931644e-24,106,9981105353606775e-24,107,9983807356573187e-24,108,1687060485811522e-23,109,1688447560354875e-23,110,2176606011487185e-23,111,2225078816042032e-23,112,2348476432064694e-23,113,2348765250187846e-23,114,2378108974103778e-23,115,314559636297708e-22,116,3297788621680806e-23,117,3667892343788279e-23,118,4235973644320739e-23,119,4794625900676345e-23,120,7262742998235812e-23,121,7499447580246377e-23,122,7525056410964318e-23,123,7979913581209237e-23,124,9662020153976783e-23,125,9799175562353741e-23,126,9897353517547472e-23,127,102313891987647e-21,128,1081460541960784e-22,129,121905913857622e-21,130,2246893314238523e-22,131,2297344808062643e-22,132,242984645941825e-21,133,2754604784282804e-22,134,2884548130346993e-22,135,3370339971357784e-22,136,4307953346848296e-22,137,5208707228462029e-22,138,5509209568565608e-22,139,6452227422644406e-22,140,6740679942715567e-22,141,6861770001566745e-22,142,7252630318111686e-22,143,7441010326374328e-22,144,7742672907173287e-22,145,9629542775307953e-22,146,1061032953945969e-21,147,1143628333594458e-21,148,1162186197019925e-21,149,136418522650196e-20,150,1367441038498385e-21,151,1432394487827058e-21,152,1736235742820677e-21,153,1848250952034914e-21,154,1909859317102744e-21,155,1975716534933873e-21,156,2122065907891938e-21,157,272837045300392e-20,158,3183098861837907e-21,159,3580986219567645e-21,160,3819718634205488e-21,161,409255567950588e-20,162,4407367654852486e-21,163,4774648292756861e-21,164,5161781938115525e-21,165,520870722846203e-20,166,5729577951308232e-21,167,6031134685587613e-21,168,6987290184522236e-21,169,9241254760174569e-21,170,1145915590261646e-20],pcstol:[0,6666666666666667e-24,1,2e-8,2,4970973863636364e-20,3,4970978156565657e-20,4,4970980410559237e-20,5,.001,6,.001093615055555556,7,.001093615194444445,8,.001093619003239988,9,.001093623110088878,10,.003280833333333333,11,.003280839895013123,12,.003280843014596366,13,.003280845583333334,14,.003280869330266636,15,.00497101413676763],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3389,2577,3390,2694,3400,102184,3401,102185,3404,3359,3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,6207,104256,6244,102769,6245,102790,6246,102770,6247,102771,6248,102793,6249,102796,6250,102772,6251,102788,6252,102775,6253,102795,6254,102781,6255,102767,6256,102774,6257,102768,6258,102797,6259,102789,6260,102780,6261,102783,6262,102787,6263,102791,6264,102777,6265,102798,6266,102779,6267,102784,6268,102792,6269,102782,6270,102785,6271,102794,6272,102773,6273,102778,6274,102786,6275,102776,6311,104141,6318,104145,6322,104287,6325,104286,6328,102046,6329,102047,6330,102048,6331,102049,6332,102050,6333,102051,6334,102052,6335,102053,6336,102054,6337,102055,6338,102056,6339,102057,6340,102058,6341,102059,6342,102382,6343,102383,6344,102384,6345,102385,6346,102386,6347,102387,6348,102388,6350,102965,6355,102975,6356,102976,6391,6141,6393,102966,6394,102977,6395,102978,6396,102979,6397,102980,6398,102981,6399,102982,6400,102983,6401,102984,6402,102985,6403,102986,6404,102988,6405,102991,6406,102987,6407,102990,6408,102989,6409,102992,6410,102993,6411,102995,6412,102994,6413,102996,6414,102962,6415,102997,6416,103003,6417,102998,6418,103004,6419,102999,6420,103005,6421,103e3,6422,103006,6423,103001,6424,103007,6425,103002,6426,103008,6427,103010,6428,103013,6429,103009,6430,103012,6431,103011,6432,103014,6433,103015,6434,103016,6435,103017,6436,103018,6437,103019,6438,103022,6439,102967,6440,103021,6441,103024,6442,103020,6443,103023,6444,103025,6445,103027,6446,103026,6447,103028,6448,103030,6449,103033,6450,103029,6451,103032,6452,103031,6453,103034,6454,103035,6455,103037,6456,103036,6457,103038,6458,103039,6459,103041,6460,103040,6461,103042,6462,103043,6463,103045,6464,103044,6465,103046,6466,103047,6467,103049,6468,103048,6469,103050,6470,103051,6471,103052,6472,103053,6473,103054,6474,103055,6475,103056,6476,103057,6477,103059,6478,103058,6479,103060,6480,103066,6481,103065,6482,103067,6483,103061,6484,103063,6485,103062,6486,103064,6487,103068,6488,103069,6489,103071,6490,103073,6491,103070,6492,103072,6493,103075,6494,103078,6495,103074,6496,103077,6497,102968,6498,103076,6499,103079,6500,103081,6501,103084,6502,103080,6503,103083,6504,103082,6505,103085,6506,103086,6507,103088,6508,102963,6509,103087,6510,103089,6511,103091,6512,103090,6513,103092,6514,103093,6515,103094,6516,103095,6518,103098,6519,103101,6520,103097,6521,103100,6522,103099,6523,103102,6524,103103,6525,103104,6526,103105,6527,103106,6528,103108,6529,103111,6530,103107,6531,103110,6532,103109,6533,103112,6534,103114,6535,103118,6536,103113,6537,103117,6538,103116,6539,103120,6540,103115,6541,103119,6542,103121,6543,103122,6544,103123,6545,103125,6546,103124,6547,103126,6548,103127,6549,103129,6550,103128,6551,103130,6552,103131,6553,103133,6554,103132,6555,103134,6556,102969,6557,102970,6558,103135,6559,103137,6560,103136,6561,103138,6562,103139,6563,103140,6564,103141,6565,103142,6566,103200,6567,103143,6568,103144,6569,103145,6570,103146,6571,103147,6572,103149,6573,103148,6574,103150,6575,103151,6576,103152,6577,103155,6578,103160,6579,102971,6580,102972,6581,103153,6582,103158,6583,103154,6584,103159,6585,103157,6586,103162,6587,103156,6588,103161,6589,103172,6590,103173,6592,103174,6593,103176,6594,103175,6595,103177,6596,103178,6597,103180,6598,103179,6599,103181,6600,103182,6601,103184,6602,103183,6603,103185,6605,103190,6606,103186,6607,103189,6608,103188,6609,103191,6610,102973,6611,103192,6612,103196,6613,103193,6614,103197,6615,103195,6616,103199,6617,103194,6618,103198,6619,103164,6620,103163,6621,103165,6625,103170,6626,103169,6627,103171,6628,102520,6629,102521,6630,102522,6631,102523,6632,102524,6633,102527,6634,102493,6635,102494,6636,102496,6637,102495,6668,104020,6669,102610,6670,102611,6671,102612,6672,102613,6673,102614,6674,102615,6675,102616,6676,102617,6677,102618,6678,102619,6679,102620,6680,102621,6681,102622,6682,102623,6683,102624,6684,102625,6685,102626,6686,102627,6687,102628,6688,102593,6689,102594,6690,102595,6691,102596,6692,102597,6783,104223,6784,102530,6785,102500,6788,102532,6789,102502,6792,102533,6793,102503,6796,102531,6797,102501,6800,102534,6801,102504,6804,102535,6805,102505,6808,102536,6809,102506,6812,102537,6813,102507,6816,102538,6817,102508,6820,102539,6821,102509,6824,102540,6825,102510,6828,102541,6829,102511,6832,102542,6833,102512,6836,102543,6837,102513,6840,102544,6841,102514,6844,102546,6845,102516,6848,102545,6849,102515,6852,102547,6853,102517,6856,102548,6857,102518,6860,102549,6861,102519,6867,102380,6868,102381,6879,103187,6880,103096,6884,102376,6885,102378,6886,102377,6887,102379,7136,6980,7139,6987,7142,102706,7692,102557,7693,102558,7694,102559,7695,102560,7696,102561,8090,103318,8091,103418,8092,103317,8093,103417,8095,103371,8096,103471,8097,103369,8098,103469,8099,103368,8100,103468,8101,103367,8102,103467,8103,103366,8104,103466,8105,103365,8106,103465,8107,103364,8108,103464,8109,103363,8110,103463,8111,103362,8112,103462,8113,103361,8114,103461,8115,103360,8116,103460,8117,103359,8118,103459,8119,103357,8120,103457,8121,103356,8122,103456,8123,103355,8124,103455,8125,103354,8126,103454,8127,103353,8128,103453,8129,103352,8130,103452,8131,103350,8132,103450,8133,103349,8134,103449,8135,103348,8136,103448,8139,103343,8140,103443,8141,103342,8142,103442,8143,103341,8144,103441,8145,103339,8146,103439,8147,103337,8148,103437,8149,103336,8150,103436,8151,103334,8152,103434,8153,103333,8154,103433,8155,103331,8156,103431,8161,103326,8162,103426,8163,103325,8164,103425,8165,103324,8166,103424,8171,103321,8172,103421,8173,103320,8177,103420,8179,103316,8180,103416,8181,103315,8182,103415,8184,103314,8185,103414,8191,103312,8193,103412,8196,103311,8197,103411,8198,103310,8200,103410,8201,103309,8202,103409,8203,103308,8204,103408,8207,103306,8208,103406,8209,103305,8210,103405,8212,103304,8213,103404,8214,103303,8216,103403,8218,103302,8220,103402,8222,103301,8224,103401,8431,104248,8441,102590,8693,102449,8826,102605,8857,54035,8858,54036,8859,54037,8860,8449,8988,104115,8989,104116,8990,104117,8991,104118,8992,104119,8993,104120,8994,104121,8995,104122,8996,104123,8997,104124,8998,104896,8999,104257,9e3,104019,9014,104010,9019,104021,9053,104011,9054,104012,9055,104013,9056,104014,9057,104015,9059,104258,9060,104179,9061,104180,9062,104181,9063,104182,9064,104183,9065,104184,9066,104185,9067,104186,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077,102550,2181,102551,2182,102552,2183,102553,2184,102554,2185,102555,2186,102556,2187],pcsid:[2066,15,2136,12,2155,10,2157,5,2158,5,2159,12,2160,12,2219,5,2220,5,2244,10,2245,10,2256,11,2265,11,2266,11,2269,11,2270,11,2273,11,2290,5,2291,5,2294,5,2295,5,2313,5,2314,14,2899,10,2900,10,2901,11,2909,11,2910,11,2911,10,2912,10,2913,11,2914,11,2964,10,2967,10,2968,10,2991,5,2992,11,2993,5,2994,11,3073,5,3076,5,3079,5,3091,10,3106,5,3108,5,3109,5,3141,5,3142,5,3167,4,3337,5,3347,5,3348,5,3359,10,3360,5,3361,11,3362,5,3363,10,3364,5,3365,10,3366,14,3402,5,3403,5,3405,5,3406,5,3439,5,3440,5,3447,5,3449,5,3450,5,3453,10,3454,10,3460,5,3479,11,3480,5,3481,11,3482,5,3483,11,3484,5,3485,10,3486,5,3487,10,3488,5,3489,5,3490,10,3491,5,3492,10,3493,5,3494,10,3495,5,3496,10,3497,5,3498,10,3499,5,3500,10,3501,5,3502,10,3503,5,3504,10,3505,5,3506,10,3507,5,3508,10,3509,5,3510,10,3511,5,3512,10,3513,5,3514,5,3515,10,3516,5,3517,10,3518,5,3519,10,3520,5,3521,10,3522,5,3523,10,3524,5,3525,10,3526,5,3527,10,3528,5,3529,10,3530,5,3531,10,3532,5,3533,10,3534,5,3535,10,3536,5,3537,10,3538,5,3539,10,3540,5,3541,10,3542,5,3543,10,3544,5,3545,10,3546,5,3547,10,3548,5,3549,10,3550,5,3551,10,3552,5,3553,10,3582,10,3583,5,3584,10,3585,5,3586,10,3587,5,3588,11,3589,5,3590,11,3591,5,3592,5,3593,11,3598,10,3599,5,3600,10,3605,11,3606,5,3607,5,3608,10,3609,5,3610,10,3611,5,3612,10,3613,5,3614,10,3615,5,3616,10,3617,5,3618,10,3619,5,3620,10,3621,5,3622,10,3623,5,3624,10,3625,5,3626,10,3627,5,3628,10,3629,5,3630,10,3631,5,3632,10,3633,5,3634,11,3635,5,3636,11,3640,10,3641,5,3642,10,3643,5,3644,11,3645,5,3646,11,3647,5,3648,11,3649,5,3650,10,3651,5,3652,10,3653,5,3654,10,3655,5,3656,11,3657,5,3658,10,3659,5,3660,10,3661,5,3662,10,3663,5,3664,10,3668,10,3669,5,3670,10,3671,5,3672,10,3673,5,3674,10,3675,5,3676,11,3677,10,3678,5,3679,11,3680,10,3681,5,3682,11,3683,10,3684,5,3685,5,3686,10,3687,5,3688,10,3689,5,3690,10,3691,5,3692,10,3696,10,3697,5,3698,10,3699,5,3700,10,3740,5,3749,5,3783,5,3784,5,3793,5,3794,5,3802,5,3816,5,3829,5,3854,5,3911,5,3912,5,3920,5,3978,5,3979,5,3991,10,3992,10,4026,5,4037,5,4038,5,4087,5,4088,5,4217,10,4438,10,4439,10,4467,5,4471,5,4474,5,4559,5,4822,5,4839,5,5018,5,5048,5,5167,5,5168,5,5223,5,5234,5,5235,5,5243,5,5266,5,5316,5,5320,5,5321,5,5330,5,5331,5,5337,5,5361,5,5362,5,5382,5,5383,5,5396,5,5456,5,5457,5,5469,5,5472,9,5490,5,5518,5,5523,5,5559,5,5588,11,5589,14,5596,5,5627,5,5629,5,5641,5,5643,5,5644,5,5654,10,5655,10,5659,5,5700,5,5825,5,5836,5,5837,5,5842,5,5844,5,5880,5,5887,5,5890,5,6128,11,6129,11,6141,11,6204,5,6210,5,6211,5,6307,5,6312,5,6316,5,6362,5,6591,5,6646,5,6703,5,6786,5,6787,11,6790,5,6791,11,6794,5,6795,11,6798,5,6799,11,6802,5,6803,11,6806,5,6807,11,6810,5,6811,11,6814,5,6815,11,6818,5,6819,11,6822,5,6823,11,6826,5,6827,11,6830,5,6831,11,6834,5,6835,11,6838,5,6839,11,6842,5,6843,11,6846,5,6847,11,6850,5,6851,11,6854,5,6855,11,6858,5,6859,11,6862,5,6863,11,6870,5,6875,5,6876,5,6915,5,6922,5,6923,10,6924,5,6925,10,6962,5,6984,5,6991,5,7128,10,7131,5,7132,10,7257,5,7258,10,7259,5,7260,10,7261,5,7262,10,7263,5,7264,10,7265,5,7266,10,7267,5,7268,10,7269,5,7270,10,7271,5,7272,10,7273,5,7274,10,7275,5,7276,10,7277,5,7278,10,7279,5,7280,10,7281,5,7282,10,7283,5,7284,10,7285,5,7286,10,7287,5,7288,10,7289,5,7290,10,7291,5,7292,10,7293,5,7294,10,7295,5,7296,10,7297,5,7298,10,7299,5,7300,10,7301,5,7302,10,7303,5,7304,10,7305,5,7306,10,7307,5,7308,10,7309,5,7310,10,7311,5,7312,10,7313,5,7314,10,7315,5,7316,10,7317,5,7318,10,7319,5,7320,10,7321,5,7322,10,7323,5,7324,10,7325,5,7326,10,7327,5,7328,10,7329,5,7330,10,7331,5,7332,10,7333,5,7334,10,7335,5,7336,10,7337,5,7338,10,7339,5,7340,10,7341,5,7342,10,7343,5,7344,10,7345,5,7346,10,7347,5,7348,10,7349,5,7350,10,7351,5,7352,10,7353,5,7354,10,7355,5,7356,10,7357,5,7358,10,7359,5,7360,10,7361,5,7362,10,7363,5,7364,10,7365,5,7366,10,7367,5,7368,10,7369,5,7370,10,7877,5,7878,5,7882,5,7883,5,7887,5,7899,5,7991,5,7992,5,8035,10,8036,10,8058,5,8059,5,8082,5,8083,5,8088,5,8137,5,8138,10,8157,5,8158,10,8159,5,8160,10,8167,5,8168,10,8169,5,8170,10,8187,5,8189,10,8205,5,8206,10,8225,5,8226,10,8311,5,8312,11,8313,5,8314,11,8315,5,8316,11,8317,5,8318,11,8319,5,8320,11,8321,5,8322,11,8323,5,8324,11,8325,5,8326,11,8327,5,8328,11,8329,5,8330,11,8331,5,8332,11,8333,5,8334,11,8335,5,8336,11,8337,5,8338,11,8339,5,8340,11,8341,5,8342,11,8343,5,8344,11,8345,5,8346,11,8347,5,8348,11,8352,5,8353,5,8379,5,8380,10,8381,5,8382,10,8383,5,8384,10,8385,5,8387,10,8391,5,8395,5,8433,5,8455,5,8456,5,8531,10,8682,5,8687,5,8692,5,8903,5,8950,5,8951,5,9039,5,9040,5,9141,5,9149,5,9150,5,9191,5,9221,5,9222,5,20499,5,20538,5,20539,5,20790,5,20791,5,21291,5,21292,5,21500,5,21817,5,21818,5,22032,5,22033,5,22091,5,22092,5,22332,5,22391,5,22392,5,22700,5,22770,5,22780,5,22832,5,23090,5,23095,5,23239,5,23240,5,23433,5,23700,5,24047,5,24048,5,24100,14,24200,5,24305,5,24306,5,24382,6,24383,5,24500,5,24547,5,24548,5,24571,2,24600,5,25e3,5,25231,5,25884,5,25932,5,26237,5,26331,5,26332,5,26591,5,26592,5,26632,5,26692,5,26855,10,26856,10,27120,5,27200,5,27291,7,27292,7,27429,5,27492,5,27500,5,27700,5,28232,5,28600,5,28991,5,28992,5,29100,5,29220,5,29221,5,29333,5,29635,5,29636,5,29701,5,29738,5,29739,5,29849,5,29850,5,29871,3,29872,13,29873,5,29900,5,29901,5,29903,5,30200,15,30339,5,30340,5,30791,5,30792,5,31028,5,31121,5,31154,5,31170,5,31171,5,31370,5,31528,5,31529,5,31600,5,31700,5,31838,5,31839,5,31901,5,32061,5,32062,5,32098,5,32099,10,32100,5,32104,5,32161,5,32766,5,53048,5,53049,5,54090,5,54091,5,65061,10,65062,10,65161,5,65163,5,102041,10,102064,8,102068,1,102069,0,102118,10,102119,11,102120,10,102121,10,102217,10,102218,5,102219,10,102220,10,102378,11,102379,11,102380,5,102381,11,102498,5,102499,5,102589,10,102590,5,102599,10,102600,10,102604,10,102605,5,102606,5,102647,5,102704,10,102705,10,102706,5,102733,10,102761,10,102762,5,102763,10,102764,5,102765,5,102766,10,102962,5,102963,5,102970,11,102974,10,102993,5,102994,5,102995,10,102996,10,103015,5,103016,10,103017,5,103018,10,103025,5,103026,5,103027,10,103028,10,103035,5,103036,5,103037,10,103038,10,103039,5,103040,5,103041,10,103042,10,103043,5,103044,5,103045,10,103046,10,103047,5,103048,5,103049,10,103050,10,103051,5,103052,10,103053,5,103054,10,103055,5,103056,10,103057,5,103058,5,103059,10,103060,10,103061,5,103062,5,103063,10,103064,10,103069,10,103070,5,103071,5,103072,10,103073,10,103086,5,103087,5,103088,10,103089,10,103094,11,103095,5,103096,10,103103,5,103104,10,103105,5,103106,10,103121,5,103122,10,103123,5,103124,5,103125,11,103126,11,103127,5,103128,5,103129,10,103130,10,103131,5,103132,5,103133,10,103134,10,103135,5,103136,5,103137,11,103138,11,103139,5,103140,10,103141,5,103142,10,103143,5,103144,10,103145,5,103146,11,103147,5,103148,5,103149,10,103150,10,103151,5,103152,10,103172,5,103173,10,103174,5,103175,5,103176,10,103177,10,103178,5,103179,5,103180,10,103181,10,103182,5,103183,5,103184,10,103185,10,103228,5,103229,5,103230,10,103231,10,103250,5,103251,10,103252,5,103253,10,103260,5,103261,5,103262,10,103263,10,103270,5,103271,5,103272,10,103273,10,103274,5,103275,5,103276,10,103277,10,103278,5,103279,5,103280,10,103281,10,103282,5,103283,5,103284,10,103285,10,103286,5,103287,10,103288,5,103289,10,103290,5,103291,10,103292,5,103293,5,103294,10,103295,10,103296,5,103297,5,103298,10,103299,10,103376,10,103377,5,103378,5,103379,10,103380,10,103393,5,103394,5,103395,10,103396,10,103472,5,103473,11,103474,5,103475,10,103482,5,103483,10,103484,5,103485,10,103500,5,103501,10,103502,5,103503,5,103504,11,103505,11,103506,5,103507,5,103508,10,103509,10,103510,5,103511,5,103512,10,103513,10,103514,5,103515,10,103516,5,103517,10,103518,5,103519,10,103520,5,103521,11,103522,5,103523,5,103524,10,103525,10,103526,5,103527,10,103561,10,103562,10,103563,5,103564,5,103565,10,103566,10,103567,5,103568,5,103569,10,103570,10,103585,10,103586,5,103587,10,103588,11,103589,5,103590,10,103591,11,103592,5,103593,10,103594,11,103695,10,103846,5,103946,10],pcsidc:[[2e3,2045,5],[2056,2065,5],[2067,2135,5],[2137,2153,5],[2161,2170,5],[2172,2193,5],[2196,2198,5],[2200,2203,5],[2206,2217,5],[2222,2224,11],[2251,2253,11],[2280,2282,11],[2308,2311,5],[2315,2325,5],[2327,2394,5],[2400,2491,5],[2494,2758,5],[2867,2869,11],[2870,2888,10],[2891,2895,10],[2896,2898,11],[2902,2908,10],[2915,2920,10],[2921,2923,11],[2924,2930,10],[2931,2941,5],[2969,2973,5],[2975,2982,5],[2984,2988,5],[2995,3002,5],[3006,3051,5],[3054,3059,5],[3061,3066,5],[3068,3071,5],[3084,3087,5],[3112,3118,5],[3120,3138,5],[3146,3151,5],[3153,3157,5],[3161,3166,5],[3168,3172,5],[3174,3203,5],[3294,3313,5],[3315,3335,5],[3339,3345,5],[3350,3358,5],[3367,3369,5],[3374,3388,5],[3391,3399,5],[3408,3416,5],[3425,3432,10],[3441,3446,10],[3456,3459,10],[3465,3478,5],[3554,3559,5],[3561,3565,10],[3568,3570,10],[3571,3581,5],[3594,3597,5],[3601,3604,5],[3637,3639,5],[3665,3667,5],[3693,3695,5],[3701,3727,5],[3728,3733,10],[3744,3747,5],[3753,3758,10],[3761,3763,5],[3765,3769,5],[3779,3781,5],[3788,3791,5],[3797,3799,5],[3832,3841,5],[3844,3852,5],[3873,3885,5],[3890,3893,5],[3942,3950,5],[3968,3970,5],[3973,3976,5],[3986,3989,5],[3994,3997,5],[4390,4398,5],[4399,4413,10],[4418,4433,10],[4491,4554,5],[4568,4589,5],[4652,4656,5],[4766,4800,5],[5069,5072,5],[5105,5130,5],[5180,5184,5],[5253,5259,5],[5269,5275,5],[5292,5311,5],[5343,5349,5],[5355,5357,5],[5387,5389,5],[5459,5463,5],[5479,5482,5],[5530,5539,5],[5550,5552,5],[5562,5583,5],[5623,5625,10],[5631,5639,5],[5649,5653,5],[5663,5680,5],[5682,5685,5],[5875,5877,5],[5896,5899,5],[5921,5940,5],[6050,6125,5],[6351,6354,5],[6366,6372,5],[6381,6387,5],[6622,6624,5],[6707,6709,5],[6720,6723,5],[6732,6738,5],[6931,6933,5],[7005,7007,5],[7057,7070,10],[7074,7082,5],[7109,7118,5],[7119,7127,11],[7374,7376,5],[7528,7586,5],[7587,7645,10],[7755,7787,5],[7791,7795,5],[7799,7801,5],[7803,7805,5],[7825,7831,5],[7845,7859,5],[8013,8032,5],[8065,8068,11],[8518,8529,10],[8533,8536,10],[8538,8540,10],[8677,8679,5],[8836,8840,5],[8908,8910,5],[9154,9159,5],[9205,9218,5],[20002,20032,5],[20062,20092,5],[20135,20138,5],[20248,20258,5],[20348,20358,5],[20436,20440,5],[20822,20824,5],[20934,20936,5],[21035,21037,5],[21095,21097,5],[21148,21150,5],[21413,21423,5],[21473,21483,5],[21780,21782,5],[21891,21894,5],[22171,22177,5],[22181,22187,5],[22191,22197,5],[22234,22236,5],[22521,22525,5],[22991,22994,5],[23028,23038,5],[23830,23853,5],[23866,23872,5],[23877,23884,5],[23886,23894,5],[23946,23948,5],[24311,24313,5],[24342,24347,5],[24370,24374,6],[24375,24381,5],[24718,24721,5],[24817,24821,5],[24877,24882,5],[24891,24893,5],[25391,25395,5],[25828,25838,5],[26191,26195,5],[26391,26393,5],[26703,26722,5],[26729,26760,10],[26766,26798,10],[26860,26870,10],[26891,26899,5],[26903,26923,5],[26929,26946,5],[26948,26998,5],[27037,27040,5],[27205,27232,5],[27258,27260,5],[27391,27398,5],[27561,27564,5],[27571,27574,5],[27581,27584,5],[27591,27594,5],[28191,28193,5],[28348,28358,5],[28402,28432,5],[28462,28492,5],[29118,29122,5],[29177,29185,5],[30161,30179,5],[30491,30494,5],[30729,30732,5],[31251,31259,5],[31265,31268,5],[31275,31278,5],[31288,31297,5],[31461,31465,5],[31491,31495,5],[31917,31922,5],[31965,31985,5],[31992,32e3,5],[32001,32003,10],[32005,32031,10],[32033,32060,10],[32074,32077,10],[32081,32086,5],[32107,32130,5],[32133,32158,5],[32164,32167,10],[32180,32199,5],[32201,32260,5],[32301,32360,5],[32601,32662,5],[32664,32667,10],[32701,32761,5],[53001,53004,5],[53008,53019,5],[53021,53032,5],[53034,53037,5],[53042,53046,5],[53074,53080,5],[54001,54004,5],[54008,54019,5],[54021,54032,5],[54034,54037,5],[54042,54046,5],[54048,54053,5],[54074,54080,5],[54098,54101,5],[102001,102040,5],[102042,102063,5],[102065,102067,5],[102070,102112,5],[102114,102117,5],[102122,102208,5],[102210,102216,5],[102221,102300,5],[102304,102377,5],[102382,102388,5],[102389,102398,10],[102399,102444,5],[102445,102447,10],[102448,102458,5],[102459,102468,10],[102469,102496,5],[102500,102519,11],[102520,102524,5],[102525,102529,10],[102530,102549,5],[102557,102588,5],[102593,102598,5],[102601,102603,5],[102608,102628,5],[102629,102646,10],[102648,102672,10],[102675,102700,10],[102701,102703,5],[102707,102730,10],[102735,102758,10],[102767,102900,5],[102965,102969,5],[102971,102973,5],[102975,102989,5],[102990,102992,11],[102997,103002,5],[103003,103008,10],[103009,103011,5],[103012,103014,10],[103019,103021,5],[103022,103024,10],[103029,103031,5],[103032,103034,10],[103065,103068,5],[103074,103076,5],[103077,103079,11],[103080,103082,5],[103083,103085,10],[103090,103093,5],[103097,103099,5],[103100,103102,10],[103107,103109,5],[103110,103112,10],[103113,103116,5],[103117,103120,10],[103153,103157,5],[103158,103162,10],[103163,103165,5],[103166,103168,11],[103169,103171,10],[103186,103188,5],[103189,103191,10],[103192,103195,5],[103196,103199,10],[103200,103224,5],[103225,103227,11],[103232,103237,5],[103238,103243,10],[103244,103246,5],[103247,103249,10],[103254,103256,5],[103257,103259,10],[103264,103266,5],[103267,103269,10],[103300,103375,5],[103381,103383,5],[103384,103386,11],[103387,103389,5],[103390,103392,10],[103397,103399,5],[103400,103471,10],[103476,103478,5],[103479,103481,10],[103486,103488,5],[103489,103491,10],[103492,103495,5],[103496,103499,10],[103539,103543,5],[103544,103548,10],[103549,103551,5],[103552,103554,11],[103555,103557,10],[103558,103560,5],[103571,103573,5],[103574,103576,10],[103577,103580,5],[103581,103583,10],[103595,103597,5],[103600,103694,5],[103696,103698,5],[103700,103793,10],[103794,103799,5]],gcsid:[4001,81,4002,85,4003,70,4004,84,4005,82,4006,83,4007,60,4008,67,4009,39,4010,57,4011,63,4012,64,4013,64,4014,63,4015,92,4016,90,4018,86,4019,75,4020,68,4021,70,4022,55,4023,75,4024,66,4025,73,4027,95,4028,59,4029,58,4031,75,4032,78,4033,77,4034,65,4035,100,4036,70,4042,88,4044,87,4045,89,4046,75,4047,99,4052,101,4053,97,4054,61,4075,75,4081,75,4120,84,4121,75,4122,80,4123,55,4124,84,4126,75,4130,75,4131,92,4132,64,4133,75,4134,64,4140,75,4141,75,4142,64,4143,64,4144,92,4145,87,4146,89,4147,66,4148,75,4149,84,4150,84,4151,75,4152,75,4153,55,4154,55,4155,63,4156,84,4157,60,4162,84,4163,75,4164,66,4165,55,4166,75,4168,58,4170,75,4172,75,4173,75,4174,58,4175,64,4176,75,4178,66,4179,66,4180,75,4188,81,4190,75,4191,66,4192,55,4193,63,4198,64,4199,55,4200,66,4201,64,4202,70,4203,70,4204,55,4205,66,4206,63,4207,55,4208,55,4209,64,4210,64,4211,84,4212,64,4213,63,4214,66,4215,55,4216,67,4218,55,4219,84,4220,64,4221,55,4222,64,4224,55,4225,55,4229,68,4230,55,4231,55,4232,64,4234,64,4235,55,4236,55,4237,70,4238,70,4239,92,4240,92,4241,65,4242,67,4243,88,4244,92,4245,86,4246,64,4250,64,4251,64,4252,63,4253,67,4254,55,4255,55,4256,64,4257,84,4258,75,4259,55,4260,64,4261,106,4262,84,4263,64,4265,55,4266,63,4267,67,4269,75,4270,64,4271,55,4272,55,4273,82,4274,55,4275,63,4276,73,4280,84,4281,57,4282,63,4283,75,4284,66,4285,55,4286,68,4288,55,4289,84,4291,70,4292,55,4293,83,4294,84,4295,84,4296,63,4297,55,4298,90,4299,85,4300,85,4301,84,4302,60,4303,68,4306,84,4307,64,4308,84,4309,55,4310,63,4311,55,4312,84,4313,55,4314,84,4315,63,4316,55,4317,66,4318,75,4319,75,4322,80,4324,80,4326,75,4466,75,4469,75,4475,55,4483,75,4490,75,4555,66,4558,75,4608,67,4609,67,4610,74,4614,55,4619,75,4624,75,4625,55,4627,75,4636,55,4637,55,4638,67,4639,55,4657,93,4659,75,4660,55,4661,75,4666,84,4667,75,4670,75,4671,63,4674,75,4679,64,4680,64,4682,92,4683,67,4686,75,4687,75,4693,75,4694,75,4695,67,4696,64,4697,64,4702,75,4703,64,4704,55,4705,55,4706,68,4718,55,4720,80,4721,55,4723,67,4726,67,4737,75,4738,60,4740,79,4741,55,4742,75,4743,64,4744,64,4745,84,4746,84,4747,75,4748,56,4749,75,4750,75,4751,91,4752,56,4753,55,4754,55,4759,75,4761,75,4801,84,4802,55,4803,55,4804,84,4805,84,4806,55,4807,106,4808,84,4809,55,4810,105,4811,106,4816,106,4817,82,4818,84,4820,84,4821,106,4823,55,4824,55,4901,107,4902,107,4903,59,4904,84,5228,84,5229,84,5233,92,5252,75,5264,75,5340,75,5354,75,5360,75,5371,75,5373,75,5381,75,5393,75,5464,60,5467,67,5489,75,5524,55,5527,70,5546,75,5561,66,5593,75,5681,84,5886,75,6135,75,6365,75,6706,75,6881,64,6882,64,6883,55,6892,64,6894,64,6980,75,6983,75,6987,75,6990,75,7035,75,7037,75,7039,75,7041,75,7073,75,7084,75,7086,75,7133,75,7373,75,7683,76,7798,75,7844,75,7881,75,7886,75,8042,96,8043,96,8086,75,8232,75,8237,75,8240,75,8246,75,8249,75,8252,75,8255,75,8351,84,8427,75,8428,55,8449,75,8545,75,8685,75,8694,64,8699,75,8818,75,8888,75,8900,75,8902,75,8907,75,8949,75,9003,75,9006,75,9009,75,9012,75,9017,75,9068,75,9069,75,9140,75,9148,75,9153,75,37001,73,37002,69,37003,72,37004,71,37005,62,37006,91,37007,94,37008,101,37201,55,37202,92,37203,87,37204,55,37205,55,37206,64,37207,71,37208,64,37211,64,37220,67,37221,55,37222,55,37223,63,37224,55,37225,106,37226,55,37227,55,37228,64,37229,62,37230,55,37231,70,37232,55,37233,55,37235,55,37237,55,37238,55,37239,67,37240,64,37241,55,37242,55,37243,67,37252,67,37253,55,37254,64,37255,84,37257,66,37259,55,37260,67,104017,79,104018,79,104024,75,104027,75,104047,98,104050,75,104100,75,104101,84,104102,84,104103,64,104104,55,104105,84,104106,55,104107,75,104108,75,104109,67,104110,75,104111,75,104112,67,104113,67,104128,102,104129,75,104130,55,104131,84,104132,67,104133,75,104134,75,104135,66,104136,70,104137,75,104138,55,104139,106,104140,106,104223,75,104248,55,104256,92,104261,63,104286,75,104287,75,104304,63,104700,49,104701,9,104702,24,104703,15,104704,28,104705,32,104706,53,104707,46,104708,37,104709,54,104710,11,104711,14,104712,30,104713,52,104714,4,104715,4,104716,23,104717,14,104718,48,104719,29,104720,22,104721,21,104722,35,104723,21,104724,46,104725,22,104726,49,104727,45,104728,52,104729,10,104730,10,104731,21,104732,31,104733,26,104734,40,104735,19,104736,30,104737,34,104738,27,104739,46,104740,5,104741,12,104742,50,104743,9,104744,43,104745,21,104746,26,104747,25,104748,21,104749,7,104750,53,104751,6,104752,33,104753,29,104754,19,104755,41,104756,31,104757,3,104758,41,104759,25,104760,49,104761,41,104762,44,104763,50,104764,46,104765,6,104766,40,104767,16,104768,8,104769,17,104770,48,104771,42,104772,50,104773,25,104774,29,104775,25,104776,32,104777,13,104778,36,104779,47,104780,14,104781,29,104782,23,104783,38,104784,42,104785,18,104786,20,104808,51,104896,75,104900,112,104901,104,104902,103,104903,116,104904,109,104905,108,104906,169,104907,164,104908,0,104909,168,104910,141,104911,166,104912,114,104913,160,104914,151,104915,117,104916,110,104917,140,104918,115,104919,170,104920,163,104921,154,104922,158,104923,161,104924,148,104925,0,104926,159,104927,167,104928,127,104929,131,104930,145,104931,159,104932,136,104933,123,104934,139,104935,134,104936,166,104937,150,104938,137,104939,147,104940,121,104941,165,104942,128,104943,111,104944,1,104945,126,104946,152,104947,157,104948,162,104949,153,104950,156,104951,149,104952,132,104953,122,104954,160,104955,146,104956,143,104957,156,104958,120,104959,125,104960,2,104961,144,104962,142,104963,138,104964,155,104965,135,104966,133,104967,151,104968,118,104969,119,104970,124,104971,108,104972,129,104973,130,104974,113,104975,0,104990,84,104991,75,104992,84],gcsidc:[[4127,4129,67],[4135,4139,67],[4158,4161,55],[4181,4185,55],[4194,4196,55],[4226,4228,63],[4247,4249,55],[4277,4279,81],[4600,4607,64],[4621,4623,55],[4628,4633,55],[4641,4646,55],[4662,4665,55],[4676,4678,66],[4688,4692,55],[4699,4701,64],[4755,4757,75],[4763,4765,75],[4813,4815,84],[8972,8987,75],[37212,37219,55],[37245,37247,55],[37249,37251,55],[104009,104015,75],[104019,104022,75],[104114,104124,75],[104125,104127,55],[104141,104145,75],[104179,104186,75],[104257,104260,75]]},x={c:[[2e3,2035,9001],[2039,2045,9001],[2056,2062,9001],[2067,2090,9001],[2093,2135,9001],[2161,2165,9001],[2172,2180,9001],[2188,2193,9001],[2195,2198,9001],[2200,2203,9001],[2205,2213,9001],[2215,2217,9001],[2222,2224,9002],[2225,2243,9003],[2246,2250,9003],[2251,2253,9002],[2257,2264,9003],[2274,2279,9003],[2280,2282,9002],[2283,2289,9003],[2308,2313,9001],[2315,2491,9001],[2494,2576,9001],[2578,2599,9001],[2601,2693,9001],[2695,2866,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2933,9001],[2935,2962,9001],[2964,2968,9003],[2969,2973,9001],[2975,2978,9001],[2984,2988,9001],[2995,3051,9001],[3054,3072,9001],[3077,3079,9001],[3081,3088,9001],[3092,3101,9001],[3106,3138,9001],[3146,3151,9001],[3153,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3348,9001],[3350,3358,9001],[3367,3403,9001],[3408,3416,9001],[3417,3438,9003],[3441,3446,9003],[3447,3450,9001],[3451,3453,9003],[3455,3459,9003],[3460,3478,9001],[3554,3559,9001],[3560,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3739,9003],[3740,3751,9001],[3753,3760,9003],[3761,3773,9001],[3775,3777,9001],[3779,3781,9001],[3788,3791,9001],[3797,3802,9001],[3814,3816,9001],[3825,3829,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4048,4051,9001],[4052,4054,9102],[4056,4063,9001],[4093,4096,9001],[4120,4124,9102],[4127,4139,9102],[4141,4176,9102],[4178,4185,9102],[4188,4216,9102],[4218,4232,9102],[4235,4260,9102],[4265,4267,9102],[4269,4286,9102],[4292,4304,9102],[4306,4319,9102],[4390,4398,9001],[4399,4413,9003],[4418,4433,9003],[4455,4457,9003],[4484,4489,9001],[4491,4554,9001],[4568,4589,9001],[4600,4630,9102],[4636,4639,9102],[4641,4646,9102],[4652,4656,9001],[4657,4680,9102],[4682,4684,9102],[4686,4765,9102],[4766,4800,9001],[4801,4806,9102],[4813,4815,9102],[5014,5016,9001],[5069,5072,9001],[5105,5130,9001],[5173,5188,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5329,5331,9001],[5343,5349,9001],[5355,5357,9001],[5459,5463,9001],[5479,5482,9001],[5518,5520,9001],[5533,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[5896,5899,9001],[5921,5940,9001],[6050,6125,9001],[6244,6275,9001],[6328,6348,9001],[6350,6356,9001],[6366,6372,9001],[6381,6387,9001],[6393,6404,9001],[6480,6483,9001],[6511,6514,9001],[6579,6581,9001],[6619,6624,9001],[6625,6627,9003],[6628,6632,9001],[6634,6637,9001],[6669,6692,9001],[6707,6709,9001],[6720,6723,9001],[6732,6738,9001],[6881,6883,9102],[6931,6933,9001],[7005,7007,9001],[7057,7070,9003],[7074,7082,9001],[7109,7118,9001],[7119,7127,9002],[7374,7376,9001],[7528,7586,9001],[7587,7645,9003],[7692,7696,9001],[7755,7787,9001],[7791,7795,9001],[7799,7801,9001],[7803,7805,9001],[7825,7831,9001],[7845,7859,9001],[8013,8032,9001],[8065,8068,9002],[8518,8529,9003],[8533,8536,9003],[8538,8540,9003],[8677,8679,9001],[8836,8840,9001],[8857,8859,9001],[8908,8910,9001],[8972,9e3,9102],[9053,9057,9102],[9059,9069,9102],[9154,9159,9001],[9205,9218,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21896,21899,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26701,26722,9001],[26729,26746,9003],[26748,26760,9003],[26766,26799,9003],[26847,26870,9003],[26891,26899,9001],[26901,26923,9001],[26929,26946,9001],[26948,26978,9001],[26980,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29168,29172,9001],[29187,29195,9001],[29901,29903,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31277,9001],[31281,31290,9001],[31466,31469,9001],[31491,31495,9001],[31965,32e3,9001],[32001,32003,9003],[32005,32017,9003],[32019,32028,9003],[32033,32035,9003],[32037,32060,9003],[32064,32067,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37002,37008,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53034,53037,9001],[53042,53046,9001],[53074,53080,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[54074,54080,9001],[54098,54101,9001],[102001,102005,9001],[102007,102039,9001],[102042,102045,9001],[102060,102063,9001],[102070,102079,9001],[102096,102099,9001],[102101,102109,9001],[102114,102117,9001],[102132,102138,9001],[102141,102144,9001],[102156,102166,9001],[102173,102179,9001],[102191,102198,9001],[102221,102228,9001],[102231,102233,9001],[102237,102240,9001],[102364,102375,9001],[102389,102398,9003],[102399,102419,9001],[102421,102438,9001],[102445,102447,9003],[102450,102458,9001],[102459,102462,9003],[102470,102489,9001],[102550,102556,9001],[102562,102588,9001],[102629,102640,9003],[102648,102650,9003],[102688,102690,9003],[102696,102700,9003],[102701,102703,9001],[102799,102900,9001],[103166,103168,9002],[103220,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103327,103330,9001],[103344,103347,9001],[103372,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103427,103430,9003],[103444,103447,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103595,103597,9001],[103600,103694,9001],[103696,103698,9001],[103700,103793,9003],[104101,104103,9102],[104126,104131,9102],[104259,104261,9102],[104700,104786,9102],[104900,104975,9102]],nc:[2065,9001,2066,9039,2136,9094,2137,9001,2138,9001,2154,9001,2157,9001,2158,9001,2159,9094,2160,9094,2169,9001,2170,9001,2204,9003,2219,9001,2220,9001,2254,9003,2255,9003,2256,9002,2265,9002,2266,9002,2267,9003,2268,9003,2269,9002,2270,9002,2271,9003,2272,9003,2273,9002,2290,9001,2294,9001,2295,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2980,9001,2981,9001,2991,9001,2992,9002,2993,9001,2994,9002,3074,9001,3075,9001,3080,9002,3089,9003,3090,9001,3091,9003,3102,9003,3141,9001,3142,9001,3167,9301,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3404,9003,3405,9001,3406,9001,3407,9005,3439,9001,3440,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3783,9001,3784,9001,3793,9001,3794,9001,3812,9001,3819,9102,3821,9102,3824,9102,3854,9001,3857,9001,3889,9102,3906,9102,3911,9001,3912,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4071,9001,4075,9102,4081,9102,4082,9001,4083,9001,4087,9001,4088,9001,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4322,9102,4324,9102,4326,9102,4414,9001,4415,9001,4417,9001,4434,9001,4437,9001,4438,9003,4439,9003,4462,9001,4463,9102,4467,9001,4470,9102,4471,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4632,9102,4633,9102,4647,9001,4807,9105,4808,9102,4809,9102,4810,9105,4811,9105,4816,9105,4817,9102,4818,9102,4820,9102,4821,9105,4822,9001,4823,9102,4824,9102,4826,9001,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5013,9102,5018,9001,5048,9001,5167,9001,5168,9001,5221,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5246,9102,5247,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5324,9102,5325,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5365,9102,5367,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5387,9001,5389,9001,5393,9102,5396,9001,5451,9102,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5513,9001,5514,9001,5523,9001,5524,9102,5527,9102,5530,9001,5531,9001,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5646,9003,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5839,9001,5842,9001,5844,9001,5858,9001,5879,9001,5880,9001,5886,9102,5887,9001,5890,9001,6128,9002,6129,9002,6135,9102,6204,9001,6207,9102,6210,9001,6211,9001,6307,9001,6311,9102,6312,9001,6316,9001,6318,9102,6322,9102,6325,9102,6362,9001,6365,9102,6391,9002,6405,9002,6406,9001,6407,9002,6408,9001,6409,9002,6410,9001,6411,9003,6412,9001,6413,9003,6414,9001,6415,9001,6416,9003,6417,9001,6418,9003,6419,9001,6420,9003,6421,9001,6422,9003,6423,9001,6424,9003,6425,9001,6426,9003,6427,9001,6428,9003,6429,9001,6430,9003,6431,9001,6432,9003,6433,9001,6434,9003,6435,9001,6436,9003,6437,9001,6438,9003,6439,9001,6440,9001,6441,9003,6442,9001,6443,9003,6444,9001,6445,9003,6446,9001,6447,9003,6448,9001,6449,9003,6450,9001,6451,9003,6452,9001,6453,9003,6454,9001,6455,9003,6456,9001,6457,9003,6458,9001,6459,9003,6460,9001,6461,9003,6462,9001,6463,9003,6464,9001,6465,9003,6466,9001,6467,9003,6468,9001,6469,9003,6470,9001,6471,9003,6472,9001,6473,9003,6474,9001,6475,9003,6476,9001,6477,9003,6478,9001,6479,9003,6484,9003,6485,9001,6486,9003,6487,9001,6488,9003,6489,9001,6490,9003,6491,9001,6492,9003,6493,9001,6494,9002,6495,9001,6496,9002,6497,9001,6498,9001,6499,9002,6500,9001,6501,9003,6502,9001,6503,9003,6504,9001,6505,9003,6506,9001,6507,9003,6508,9001,6509,9001,6510,9003,6515,9002,6516,9001,6518,9001,6519,9003,6520,9001,6521,9003,6522,9001,6523,9003,6524,9001,6525,9003,6526,9001,6527,9003,6528,9001,6529,9003,6530,9001,6531,9003,6532,9001,6533,9003,6534,9001,6535,9003,6536,9001,6537,9003,6538,9001,6539,9003,6540,9001,6541,9003,6542,9001,6543,9003,6544,9001,6545,9002,6546,9001,6547,9002,6548,9001,6549,9003,6550,9001,6551,9003,6552,9001,6553,9003,6554,9001,6555,9003,6556,9001,6557,9002,6558,9001,6559,9002,6560,9001,6561,9002,6562,9001,6563,9003,6564,9001,6565,9003,6566,9001,6567,9001,6568,9003,6569,9001,6570,9002,6571,9001,6572,9003,6573,9001,6574,9003,6575,9001,6576,9003,6577,9001,6578,9003,6582,9003,6583,9001,6584,9003,6585,9001,6586,9003,6587,9001,6588,9003,6589,9001,6590,9003,6591,9001,6592,9001,6593,9003,6594,9001,6595,9003,6596,9001,6597,9003,6598,9001,6599,9003,6600,9001,6601,9003,6602,9001,6603,9003,6605,9003,6606,9001,6607,9003,6608,9001,6609,9003,6610,9001,6611,9001,6612,9003,6613,9001,6614,9003,6615,9001,6616,9003,6617,9001,6618,9003,6633,9003,6646,9001,6668,9102,6703,9001,6706,9102,6783,9102,6784,9001,6785,9002,6786,9001,6787,9002,6788,9001,6789,9002,6790,9001,6791,9002,6792,9001,6793,9002,6794,9001,6795,9002,6796,9001,6797,9002,6798,9001,6799,9002,6800,9001,6801,9002,6802,9001,6803,9002,6804,9001,6805,9002,6806,9001,6807,9002,6808,9001,6809,9002,6810,9001,6811,9002,6812,9001,6813,9002,6814,9001,6815,9002,6816,9001,6817,9002,6818,9001,6819,9002,6820,9001,6821,9002,6822,9001,6823,9002,6824,9001,6825,9002,6826,9001,6827,9002,6828,9001,6829,9002,6830,9001,6831,9002,6832,9001,6833,9002,6834,9001,6835,9002,6836,9001,6837,9002,6838,9001,6839,9002,6840,9001,6841,9002,6842,9001,6843,9002,6844,9001,6845,9002,6846,9001,6847,9002,6848,9001,6849,9002,6850,9001,6851,9002,6852,9001,6853,9002,6854,9001,6855,9002,6856,9001,6857,9002,6858,9001,6859,9002,6860,9001,6861,9002,6862,9001,6863,9002,6867,9001,6868,9002,6870,9001,6875,9001,6876,9001,6879,9001,6880,9003,6884,9001,6885,9002,6886,9001,6887,9002,6892,9102,6894,9102,6915,9001,6922,9001,6923,9003,6924,9001,6925,9003,6962,9001,6983,9102,6984,9001,6990,9102,6991,9001,7035,9102,7037,9102,7039,9102,7041,9102,7073,9102,7084,9102,7086,9102,7128,9003,7131,9001,7132,9003,7133,9102,7136,9102,7139,9102,7142,9001,7257,9001,7258,9003,7259,9001,7260,9003,7261,9001,7262,9003,7263,9001,7264,9003,7265,9001,7266,9003,7267,9001,7268,9003,7269,9001,7270,9003,7271,9001,7272,9003,7273,9001,7274,9003,7275,9001,7276,9003,7277,9001,7278,9003,7279,9001,7280,9003,7281,9001,7282,9003,7283,9001,7284,9003,7285,9001,7286,9003,7287,9001,7288,9003,7289,9001,7290,9003,7291,9001,7292,9003,7293,9001,7294,9003,7295,9001,7296,9003,7297,9001,7298,9003,7299,9001,7300,9003,7301,9001,7302,9003,7303,9001,7304,9003,7305,9001,7306,9003,7307,9001,7308,9003,7309,9001,7310,9003,7311,9001,7312,9003,7313,9001,7314,9003,7315,9001,7316,9003,7317,9001,7318,9003,7319,9001,7320,9003,7321,9001,7322,9003,7323,9001,7324,9003,7325,9001,7326,9003,7327,9001,7328,9003,7329,9001,7330,9003,7331,9001,7332,9003,7333,9001,7334,9003,7335,9001,7336,9003,7337,9001,7338,9003,7339,9001,7340,9003,7341,9001,7342,9003,7343,9001,7344,9003,7345,9001,7346,9003,7347,9001,7348,9003,7349,9001,7350,9003,7351,9001,7352,9003,7353,9001,7354,9003,7355,9001,7356,9003,7357,9001,7358,9003,7359,9001,7360,9003,7361,9001,7362,9003,7363,9001,7364,9003,7365,9001,7366,9003,7367,9001,7368,9003,7369,9001,7370,9003,7373,9102,7683,9102,7798,9102,7844,9102,7877,9001,7878,9001,7881,9102,7882,9001,7883,9001,7886,9102,7887,9001,7899,9001,7991,9001,7992,9001,8035,9003,8036,9003,8042,9102,8043,9102,8058,9001,8059,9001,8082,9001,8083,9001,8086,9102,8088,9001,8090,9001,8091,9003,8092,9001,8093,9003,8095,9001,8096,9003,8097,9001,8098,9003,8099,9001,8100,9003,8101,9001,8102,9003,8103,9001,8104,9003,8105,9001,8106,9003,8107,9001,8108,9003,8109,9001,8110,9003,8111,9001,8112,9003,8113,9001,8114,9003,8115,9001,8116,9003,8117,9001,8118,9003,8119,9001,8120,9003,8121,9001,8122,9003,8123,9001,8124,9003,8125,9001,8126,9003,8127,9001,8128,9003,8129,9001,8130,9003,8131,9001,8132,9003,8133,9001,8134,9003,8135,9001,8136,9003,8137,9001,8138,9003,8139,9001,8140,9003,8141,9001,8142,9003,8143,9001,8144,9003,8145,9001,8146,9003,8147,9001,8148,9003,8149,9001,8150,9003,8151,9001,8152,9003,8153,9001,8154,9003,8155,9001,8156,9003,8157,9001,8158,9003,8159,9001,8160,9003,8161,9001,8162,9003,8163,9001,8164,9003,8165,9001,8166,9003,8167,9001,8168,9003,8169,9001,8170,9003,8171,9001,8172,9003,8173,9001,8177,9003,8179,9001,8180,9003,8181,9001,8182,9003,8184,9001,8185,9003,8187,9001,8189,9003,8191,9001,8193,9003,8196,9001,8197,9003,8198,9001,8200,9003,8201,9001,8202,9003,8203,9001,8204,9003,8205,9001,8206,9003,8207,9001,8208,9003,8209,9001,8210,9003,8212,9001,8213,9003,8214,9001,8216,9003,8218,9001,8220,9003,8222,9001,8224,9003,8225,9001,8226,9003,8232,9102,8237,9102,8240,9102,8246,9102,8249,9102,8252,9102,8255,9102,8311,9001,8312,9002,8313,9001,8314,9002,8315,9001,8316,9002,8317,9001,8318,9002,8319,9001,8320,9002,8321,9001,8322,9002,8323,9001,8324,9002,8325,9001,8326,9002,8327,9001,8328,9002,8329,9001,8330,9002,8331,9001,8332,9002,8333,9001,8334,9002,8335,9001,8336,9002,8337,9001,8338,9002,8339,9001,8340,9002,8341,9001,8342,9002,8343,9001,8344,9002,8345,9001,8346,9002,8347,9001,8348,9002,8351,9102,8352,9001,8353,9001,8379,9001,8380,9003,8381,9001,8382,9003,8383,9001,8384,9003,8385,9001,8387,9003,8391,9001,8395,9001,8427,9102,8428,9102,8431,9102,8433,9001,8441,9001,8455,9001,8456,9001,8531,9003,8545,9102,8682,9001,8685,9102,8687,9001,8692,9001,8693,9001,8694,9102,8699,9102,8818,9102,8826,9001,8860,9102,8888,9102,8900,9102,8902,9102,8903,9001,8907,9102,8949,9102,8950,9001,8951,9001,9003,9102,9006,9102,9009,9102,9012,9102,9014,9102,9017,9102,9019,9102,9039,9001,9040,9001,9140,9102,9141,9001,9148,9102,9149,9001,9150,9001,9153,9102,9191,9001,9221,9001,9222,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25e3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27493,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29101,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,30200,9039,30339,9001,30340,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31279,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32030,9003,32031,9003,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37202,9102,37203,9102,37206,9102,37207,9102,37218,9102,37221,9102,37225,9105,37240,9102,37241,9102,37243,9102,37245,9102,37249,9102,37257,9102,37260,9102,53048,9001,53049,9001,54034,9001,54090,9001,54091,9001,65061,9003,65062,9003,65161,9001,102041,9003,102064,9085,102068,109030,102069,109031,102093,9001,102094,9001,102118,9003,102120,9003,102121,9003,102122,9001,102150,9001,102168,9001,102204,9001,102212,9001,102213,9001,102215,9001,102216,9001,102217,9003,102218,9001,102219,9003,102220,9003,102247,9001,102299,9001,102306,9001,102319,9001,102328,9001,102329,9001,102359,9001,102360,9001,102440,9001,102448,9001,102464,9003,102465,9003,102491,9001,102492,9001,102498,9001,102499,9001,102525,9003,102526,9003,102528,9003,102529,9003,102589,9003,102598,9001,102599,9003,102600,9003,102604,9003,102661,9003,102662,9003,102664,9003,102665,9003,102705,9003,102720,9003,102721,9003,102726,9003,102727,9003,102733,9003,102761,9003,102766,9003,102974,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103300,9001,103307,9001,103313,9001,103319,9001,103322,9001,103323,9001,103332,9001,103335,9001,103338,9001,103340,9001,103351,9001,103358,9001,103370,9001,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103400,9003,103407,9003,103413,9003,103419,9003,103422,9003,103423,9003,103432,9003,103435,9003,103438,9003,103440,9003,103451,9003,103458,9003,103470,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103586,9001,103587,9003,103588,9002,103589,9001,103590,9003,103591,9002,103592,9001,103593,9003,103594,9002,103695,9003,103846,9001,103946,9003,104009,9102,104017,9102,104018,9102,104022,9102,104024,9102,104027,9102,104047,9102,104050,9102,104105,9102,104106,9102,104109,9102,104112,9102,104113,9102,104134,9102,104135,9102,104138,9102,104139,9105,104140,9105,104808,9102]};d.wr=function(){function h(){}return h.Sy=function(l){h.xp===!1&&h.yt();var s=h.FQ(l);if(s==-1){var a=h.Bx(l);a!=l&&(s=h.Sy(a))}return s==-1&&(a=h.FK(l))!=l&&(s=h.Sy(a)),s},h.FQ=function(l){return h.Fw[l]!==void 0?h.Fw[l]:-1},h.CQ=function(l){h.xp===!1&&h.yt();var s=h.nF(l);if(s==1e38){var a=h.Bx(l);if(a!=l&&(s=h.nF(a)),s==1e38)return 1e-10}return s},h.ZS=function(l){if(h.Is[l]!==void 0)return!0;var s=h.Bx(l);return s!=l&&h.Is[s]!==void 0},h.aT=function(l){if(h.xo[l]!==void 0)return!0;var s=h.Bx(l);return s!=l&&h.xo[s]!==void 0},h.nF=function(l){return h.xp===!1&&h.yt(),h.Is[l]!==void 0?h.Is[l]:h.xo[l]!==void 0?h.xo[l]:1e38},h.FK=function(l){return h.xp===!1&&h.yt(),h.WA[l]!==void 0?h.WA[l]:l},h.Bx=function(l){return h.xp===!1&&h.yt(),h.XA[l]!==void 0?h.XA[l]:l},h.yt=function(){for(var l,s=O,a=0;a<s.pcsid.length;a+=2)h.xo[s.pcsid[a]]=s.pcstol[2*s.pcsid[a+1]+1];for(a=0;a<s.pcsidc.length;a+=1)for(var c=(l=s.pcsidc[a])[0];c<=l[1];c++)h.xo[c]=s.pcstol[2*l[2]+1];for(a=0;a<s.gcsid.length;a+=2)h.Is[s.gcsid[a]]=s.gcstol[2*s.gcsid[a+1]+1];for(a=0;a<s.gcsidc.length;a+=1)for(c=(l=s.gcsidc[a])[0];c<=l[1];c++)h.xo[c]=s.gcstol[2*l[2]+1];for(a=0;a<x.c.length;a+=1)for(c=(l=x.c[a])[0];c<=l[1];c++)h.Fw[c]=l[2];for(a=0;a<x.nc.length;a+=2)h.Fw[x.nc[a]]=x.nc[a+1];for(x=null,a=0;a<s.newtoold.length;a+=2)h.WA[s.newtoold[a+1]]=s.newtoold[a],h.XA[s.newtoold[a]]=s.newtoold[a+1];O=null,h.xp=!0},h.xp=!1,h.Is=[],h.xo=[],h.WA=[],h.XA=[],h.Fw=[],h}()}(Y||(Y={})),function(d){function O(h){return h.length===0?'""':h[0]=='"'||h[0]=="."||"0"<=h[0]&&"9">=h[0]?h:'"'+h.trim()+'"'}var x=[];d.XC=function(){function h(){}return h.EQ=function(l){try{for(var s=0;s<x.length;s++)if(x[s].wkttext===l)return x[s].unit;for(var a,c=s="",f=!1,y=0;y<l.length;y++){var v=l[y];f===!0?v=='"'?l[y+1]=='"'?s+=v:f=f=!1:s+=v:/[\s]/.test(v)||(v==","?(c=s!==""?c+(O(s)+","):c+",",s=""):v==")"||v=="]"?(c=s!==""?c+(O(s)+"]}"):c+"]}",s=""):v=="("||v=="["?(c+='{ "entity": "'+s.toUpperCase().trim()+'", "values":[',s=""):v=='"'?(f=!0,s=""):s+=v)}a=JSON.parse(c);var _=h.mF(a);if(_===null)return null;for(a=null,v=0;v<_.values.length;v++)if(typeof _.values[v]=="object"&&(_.values[v].entity==="UNIT"||_.values[v].entity==="ANGLEUNIT"||_.values[v].entity==="LENGTHUNIT")){a=_.values[v];break}if(a===null)return null;var $=d.Tc.ZO(_.entity==="GEOGCS"||_.entity==="GEOGCRS"?1:0,a.values[1],a.values[2]);return x.push({wkttext:l,unit:$}),10<x.length&&x.shift(),$}catch{return null}},h.mF=function(l){if(l===null)return null;switch(l.entity){case"GEOGCRS":case"GEOGCS":case"PROJCRS":case"PROJCS":return l}for(var s=[],a=0;a<l.values.length;a++)if(typeof l.values[a]=="object"&&l.values[a].entity!==void 0)switch(l.values[a].entity){case"GEOGCRS":case"GEOGCS":case"PROJCRS":case"PROJCS":return l.values[a];default:s.push(l.values[a])}for(l=0;l<s.length;l++)if((a=h.mF(s[l]))!==null)return a;return null},h.DQ=function(l){var s=-1;if(l!=null&&0<l.length){var a=l.search(/PROJCR?S/);if(0<=a){var c=0;if(0<=(a=l.lastIndexOf("UNIT"))&&0<(a=l.indexOf(",",a+4))){a++;var f=l.indexOf("]",a+1);if(0<f)try{c=parseFloat(l.substring(a,f))}catch{c=0}}0<c&&(s=.001/c)}else if(0<=(a=l.search(/GEOGCR?S/))){var y=0;if(c=0,(a=l.indexOf("SPHEROID",a+6))===-1&&(a=l.indexOf("ELLIPSOID",a+7)),0<a&&0<(a=l.indexOf(",",a+8))){if(a++,0<(f=l.indexOf(",",a+1)))try{y=parseFloat(l.substring(a,f))}catch{y=0}if(0<y&&((a=l.lastIndexOf("ANGLEUNIT",f+1))===-1&&(a=l.lastIndexOf("UNIT",f+1)),0<=a&&0<(a=l.indexOf(",",a+4))&&(a++,0<(f=l.indexOf("]",a+1)))))try{c=parseFloat(l.substring(a,f))}catch{c=0}}0<y&&0<c&&(s=.001/(y*c))}}return s},h}()}(Y||(Y={})),function(d){var O;(O=d.eL||(d.eL={}))[O.NONE=0]="NONE",O[O.LINEAR=1]="LINEAR",O[O.ANGULAR=2]="ANGULAR",function(h){h[h.enumFloat=0]="enumFloat",h[h.enumDouble=1]="enumDouble",h[h.enumInt32=2]="enumInt32",h[h.enumInt64=3]="enumInt64",h[h.enumInt8=4]="enumInt8",h[h.enumInt16=5]="enumInt16"}(d.QL||(d.QL={})),function(h){h[h.POSITION=0]="POSITION",h[h.Z=1]="Z",h[h.M=2]="M",h[h.ID=3]="ID",h[h.NORMAL=4]="NORMAL",h[h.TEXTURE1D=5]="TEXTURE1D",h[h.TEXTURE2D=6]="TEXTURE2D",h[h.TEXTURE3D=7]="TEXTURE3D",h[h.ID2=8]="ID2",h[h.MAXSEMANTICS=10]="MAXSEMANTICS"}(d.Ih||(d.Ih={}));var x=function(){function h(l,s){if(this.Vs=this.Ae=null,this.Oq=this.Aa=0,this.uh=this.bg=null,this.wl=0,s!==void 0){for(this.Aa=s.Aa,this.Oq=s.Oq,this.bg=s.bg.slice(0),this.uh=s.uh.slice(0),this.wl=s.wl,this.Vs=[],l=s=0;l<this.Aa;l++)this.Vs[l]=s,s+=h.Va(this.bg[l]);for(this.Oq=s,this.Ae=[],l=0;l<this.Aa;l++){s=h.Va(this.kd(l));for(var a=h.se(this.kd(l)),c=0;c<s;c++)this.Ae[this.Vs[l]+c]=a}}else this.Oq=this.Aa=0}return h.prototype.kd=function(l){if(0>l||l>this.Aa)throw d.i.N();return this.bg[l]},h.prototype.Pf=function(l){return this.uh[l]},h.lz=function(l){return h.JM[l]},h.Tp=function(l){return h.SM[l]},h.Va=function(l){return h.rM[l]},h.prototype.hasAttribute=function(l){return 0<=this.uh[l]},h.prototype.iG=function(){return this.hasAttribute(1)},h.se=function(l){return h.eD[l]},h.prototype.LR=function(l){return this.Vs[l]},h.DG=function(l,s){return h.eD[l]===s},h.prototype.Nb=function(l){return this===l},h.prototype.An=function(){for(var l=d.O.Th(this.bg[0]),s=1;s<this.Aa;s++)l=d.O.Th(this.bg[s],l);return l},h.prototype.$j=function(l){return this.Vs[l]},h.prototype.cc=function(){return this.wl},h.prototype.Ed=function(l){return this.bg[l]},h.eD=[0,0,NaN,0,0,0,0,0,0],h.JM=[1,1,1,0,2,1,1,1,0],h.SM=[1,1,1,2,0,0,0,0,2],h.rM=[2,1,1,1,3,1,2,3,2],h}();d.ra=x}(Y||(Y={})),function(d){function O(f,y,v){var _=y-(f=new c(f)).e,$=f.c;for($.length>++y&&x(f,_,c.eu),$[0]?v?_=y:($=f.c,_=f.e+_+1):++_;$.length<_;$.push(0));return _=f.e,v===1||v&&(y<=_||_<=l)?(0>f.Bd&&$[0]?"-":"")+(1<$.length?$[0]+"."+$.join("").slice(1):$[0])+(0>_?"e":"e+")+_:f.toString()}function x(f,y,v,_){var $=f.c,I=f.e+y+1;if(v===1?_=5<=$[I]:v===2?_=5<$[I]||$[I]==5&&(_||0>I||$[I+1]!==void 0||1&$[I-1]):v===3?_=_||$[I]!==void 0||0>I:(_=!1,v!==0&&h("!Big.RM!")),1>I||!$[0])_?(f.e=-y,f.c=[1]):f.c=[f.e=0];else{if($.length=I--,_)for(;9<++$[I];)$[I]=0,I--||(++f.e,$.unshift(1));for(I=$.length;!$[--I];$.pop());}return f}function h(f){throw(f=Error(f)).name="BigError",f}var l=-7,s=21,a=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,c=function(){function f(y){if(y instanceof f)this.Bd=y.Bd,this.e=y.e,this.c=y.c.slice();else{var v,_,$;for(y===0&&0>1/y?y="-0":a.test(y+="")||h(NaN),this.Bd=y.charAt(0)=="-"?(y=y.slice(1),-1):1,-1<(v=y.indexOf("."))&&(y=y.replace(".","")),0<(_=y.search(/e/i))?(0>v&&(v=_),v+=+y.slice(_+1),y=y.substring(0,_)):0>v&&(v=y.length),_=0;y.charAt(_)=="0";_++);if(_==($=y.length))this.c=[this.e=0];else{for(;y.charAt(--$)=="0";);for(this.e=v-_-1,this.c=[],v=0;_<=$;this.c[v++]=+y.charAt(_++));}}}return f.prototype.abs=function(){var y=new f(this);return y.Bd=1,y},f.prototype.cmp=function(y){var v=this.c,_=(y=new f(y)).c,$=this.Bd,I=y.Bd,k=this.e,A=y.e;if(!v[0]||!_[0])return v[0]?$:_[0]?-I:0;if($!=I)return $;if(y=0>$,k!=A)return k>(A^y)?1:-1;for($=-1,I=(k=v.length)<(A=_.length)?k:A;++$<I;)if(v[$]!=_[$])return v[$]>(_[$]^y)?1:-1;return k==A?0:k>(A^y)?1:-1},f.prototype.jm=function(y){var v=this.c,_=(y=new f(y)).c,$=this.Bd==y.Bd?1:-1,I=f.rr;if((I!==~~I||0>I||1e6<I)&&h("!Big.DP!"),!v[0]||!_[0])return v[0]==_[0]&&h(NaN),_[0]||h($/0),new f(0*$);var k,A,P=_.slice(),D=k=_.length,j=v.length,B=v.slice(0,k),q=B.length,z=y,Z=z.c=[],ee=0,Q=I+(z.e=this.e-y.e)+1;for(z.Bd=$,$=0>Q?0:Q,P.unshift(0);q++<k;B.push(0));do{for(A=0;10>A;A++){if(k!=(q=B.length))var le=k>q?1:-1;else{var se=-1;for(le=0;++se<k;)if(_[se]!=B[se]){le=_[se]>B[se]?1:-1;break}}if(!(0>le))break;for(y=q==k?_:P;q;){if(B[--q]<y[q]){for(se=q;se&&!B[--se];B[se]=9);--B[se],B[q]+=10}B[q]-=y[q]}for(;!B[0];B.shift());}Z[ee++]=le?A:++A,B[0]&&le?B[q]=v[D]||0:B=[v[D]]}while((D++<j||B[0]!==void 0)&&$--);return Z[0]||ee==1||(Z.shift(),z.e--),ee>Q&&x(z,I,f.eu,B[0]!==void 0),z},f.prototype.fS=function(){return 0<this.cmp(0)},f.prototype.nT=function(){return 0>this.cmp(0)},f.prototype.jt=function(y){var v,_=this.Bd,$=(y=new f(y)).Bd;if(_!=$)return y.Bd=-$,this.tI(y);var I=this.c.slice(),k=this.e,A=y.c,P=y.e;if(!I[0]||!A[0])return A[0]?(y.Bd=-$,y):new f(I[0]?this:0);if(_=k-P){for((v=0>_)?(_=-_,k=I):(P=k,k=A),k.reverse(),$=_;$--;k.push(0));k.reverse()}else for(k=((v=I.length<A.length)?I:A).length,_=$=0;$<k;$++)if(I[$]!=A[$]){v=I[$]<A[$];break}if(v&&(k=I,I=A,A=k,y.Bd=-y.Bd),0<($=(k=A.length)-(v=I.length)))for(;$--;I[v++]=0);for($=v;k>_;){if(I[--k]<A[k]){for(v=k;v&&!I[--v];I[v]=9);--I[v],I[k]+=10}I[k]-=A[k]}for(;I[--$]==0;I.pop());for(;I[0]==0;)I.shift(),--P;return I[0]||(y.Bd=1,I=[P=0]),y.c=I,y.e=P,y},f.prototype.tI=function(y){var v=this.Bd,_=(y=new f(y)).Bd;if(v!=_)return y.Bd=-_,this.jt(y);_=this.e;var $=this.c,I=y.e,k=y.c;if(!$[0]||!k[0])return k[0]?y:new f($[0]?this:0*v);if($=$.slice(),v=_-I){for(0<v?(I=_,_=k):(v=-v,_=$),_.reverse();v--;_.push(0));_.reverse()}for(0>$.length-k.length&&(_=k,k=$,$=_),v=k.length,_=0;v;)_=($[--v]=$[v]+k[v]+_)/10|0,$[v]%=10;for(_&&($.unshift(_),++I),v=$.length;$[--v]==0;$.pop());return y.c=$,y.e=I,y},f.prototype.pow=function(y){var v=this,_=new f(1),$=_,I=0>y;for((y!==~~y||-1e6>y||1e6<y)&&h("!pow!"),y=I?-y:y;1&y&&($=$.lr(v)),y>>=1;)v=v.lr(v);return I?_.jm($):$},f.prototype.round=function(y,v){var _=this;return y==null?y=0:(y!==~~y||0>y||1e6<y)&&h("!round!"),x(_=new f(_),y,v??f.eu),_},f.prototype.sqrt=function(){var y=this.c,v=this.Bd,_=this.e,$=new f("0.5");if(!y[0])return new f(this);0>v&&h(NaN),(v=Math.sqrt(this.toString()))==0||v==1/0?((v=y.join("")).length+_&1||(v+="0"),(y=new f(Math.sqrt(v).toString())).e=((_+1)/2|0)-(0>_||1&_)):y=new f(v.toString()),v=y.e+(f.rr+=4);do _=y,y=$.lr(_.tI(this.jm(_)));while(_.c.slice(0,v).join("")!==y.c.slice(0,v).join(""));return x(y,f.rr-=4,f.eu),y},f.prototype.lr=function(y){var v=this.c,_=(y=new f(y)).c,$=v.length,I=_.length,k=this.e,A=y.e;if(y.Bd=this.Bd==y.Bd?1:-1,!v[0]||!_[0])return new f(0*y.Bd);if(y.e=k+A,$<I){var P=v;v=_,_=P,A=$,$=I,I=A}for(P=Array(A=$+I);A--;P[A]=0);for(k=I;k--;){for(I=0,A=$+k;A>k;)I=P[A]+_[k]*v[A-k-1]+I,P[A--]=I%10,I=I/10|0;P[A]=(P[A]+I)%10}for(I&&++y.e,P[0]||P.shift(),k=P.length;!P[--k];P.pop());return y.c=P,y},f.prototype.toString=function(){var y=this.e,v=this.c.join(""),_=v.length;if(y<=l||y>=s)v=v.charAt(0)+(1<_?"."+v.slice(1):"")+(0>y?"e":"e+")+y;else if(0>y){for(;++y;v="0"+v);v="0."+v}else if(0<y)if(++y>_)for(y-=_;y--;v+="0");else y<_&&(v=v.slice(0,y)+"."+v.slice(y));else 1<_&&(v=v.charAt(0)+"."+v.slice(1));return 0>this.Bd&&this.c[0]?"-"+v:v},f.prototype.toExponential=function(y){return y==null?y=this.c.length-1:(y!==~~y||0>y||1e6<y)&&h("!toExp!"),O(this,y,1)},f.prototype.toFixed=function(y){var v=l,_=s;if(l=-(s=1/0),y==null)var $=this.toString();else y===~~y&&0<=y&&1e6>=y&&($=O(this,this.e+y),0>this.Bd&&this.c[0]&&0>$.indexOf("-")&&($="-"+$));return l=v,s=_,$||h("!toFix!"),$},f.prototype.toPrecision=function(y){return y==null?this.toString():((y!==~~y||1>y||1e6<y)&&h("!toPre!"),O(this,y-1,2))},f.rr=20,f.eu=1,f}();d.hp=c}(Y||(Y={})),function(d){var O=function(){function x(h){this.lf=h}return x.prototype.nr=function(h,l,s){var a=new d.h,c=new d.h,f=this.lf;s.Vd(h,l,function(y,v){return f.tc(2*y,a),f.tc(2*v,c),a.compare(c)})},x.prototype.$p=function(h){return this.lf.read(2*h+1)},x}();d.pi=function(){function x(){}return x.aq=function(h){if(h.B())return!1;var l=h.getType();return l==1736?h.Ke()!=0:l==1607?(l=[!1],x.sE(h,!0,l),l[0]):!(l!=197&&(!d.aa.yd(l)||h.BG()))},x.gm=function(h){var l=h.getType();if(l==1736)return l=new d.Ta(h.description),h.B()||h.dD(l),l;if(l==1607)return x.sE(h,!1,null);if(l==197)return l=new d.Ta(h.description),h.B()||l.ad(h,!1),l;if(d.aa.yd(l)){if(l=new d.de(h.description),!h.B()&&!h.BG()){var s=new d.Sa;h.To(s),l.add(s),h.Po(s),l.add(s)}return l}if(d.aa.Rn(l))return null;throw d.i.N()},x.sE=function(h,l,s){s!=null&&(s[0]=!1);var a=null;if(l||(a=new d.de(h.description)),!h.B()){var c=new d.ia(0);c.Jb(2*h.da());for(var f=0,y=h.da();f<y;f++)if(0<h.Ja(f)&&!h.Nn(f)){var v=h.Ba(f);c.add(v),v=h.Vc(f)-1,c.add(v)}if(0<c.size){y=new d.Xt,f=h.ub(0),y.sort(c,0,c.size,new O(f)),y=new d.h,f.tc(2*c.get(0),y),v=0;for(var _=1,$=new d.Sa,I=new d.h,k=1,A=c.size;k<A;k++)if(f.tc(2*c.get(k),I),I.qb(y))c.get(v)>c.get(k)?(c.set(v,2147483647),v=k):c.set(k,2147483647),_++;else{if(1&_){if(l)return s!=null&&(s[0]=!0),null}else c.set(v,2147483647);y.L(I),v=k,_=1}if(1&_){if(l)return s!=null&&(s[0]=!0),null}else c.set(v,2147483647);if(!l)for(c.Vd(0,c.size,function(P,D){return P-D}),k=0,A=c.size;k<A&&c.get(k)!=2147483647;k++)h.ve(c.get(k),$),a.add($)}}return l?null:a},x}()}(Y||(Y={})),function(d){var O=function(){function x(){this.yf=new d.ia(0),this.ys=new d.ia(0),this.EH=1,this.Es=NaN}return x.prototype.sort=function(h,l,s,a){if(32>s-l)a.nr(l,s,h);else{var c=!0;try{for(var f=1/0,y=-1/0,v=l;v<s;v++){var _=a.$p(h.get(v));_<f&&(f=_),_>y&&(y=_)}if(this.reset(s-l,f,y,s-l)){for(v=l;v<s;v++){var $=h.get(v);_=a.$p($);var I=this.zF(_);this.yf.set(I,this.yf.get(I)+1),this.ys.write(v-l,$)}var k=this.yf.get(0);this.yf.set(0,0),v=1;for(var A=this.yf.size;v<A;v++){var P=this.yf.get(v);this.yf.set(v,k),k+=P}for(v=l;v<s;v++){$=this.ys.read(v-l),_=a.$p($),I=this.zF(_);var D=this.yf.get(I);h.set(D+l,$),this.yf.set(I,D+1)}c=!1}}catch{this.yf.resize(0),this.ys.resize(0)}if(c)a.nr(l,s,h);else{for(v=s=0,A=this.yf.size;v<A;v++)c=s,(s=this.yf.get(v))>c&&a.nr(l+c,l+s,h);100<this.yf.size&&(this.yf.resize(0),this.ys.resize(0))}}},x.prototype.reset=function(h,l,s,a){return!(2>h||s==l)&&(h=Math.min(x.hL,h),this.yf.Jb(h),this.yf.resize(h),this.yf.Wj(0,0,this.yf.size),this.EH=l,this.ys.resize(a),this.Es=(s-l)/(h-1),!0)},x.prototype.zF=function(h){return d.O.truncate((h-this.EH)/this.Es)},x.hL=65536,x}();d.Xt=O}(Y||(Y={})),function(d){var O,x;(x=O||(O={}))[x.enum_line=1]="enum_line",x[x.enum_arc=2]="enum_arc",x[x.enum_dummy=4]="enum_dummy",x[x.enum_concave_dip=8]="enum_concave_dip",x[x.enum_connection=3]="enum_connection";var h=function(){function f(){}return f.Qu=function(y,v,_,$,I,k){var A=new f;return A.Im=new d.h,A.Vm=new d.h,A.aw=new d.h,A.Im.L(y),A.Vm.L(v),A.aw.L(_),A.Co=$,A.qh=I,A.sh=k,A},f.construct=function(y,v,_,$){var I=new f;return I.Im=new d.h,I.Vm=new d.h,I.aw=new d.h,I.Im.L(y),I.Vm.L(v),I.aw.Rc(),I.Co=4,I.qh=_,I.sh=$,I},f}(),l=function(){function f(y,v,_,$,I,k){this.Yv=null,this.ya=0,this.EA=y,this.bI=this.$H=0,this.Ka=v,this.Mj=_,this.vk=$,this.Dq=I,this.Ub=k}return f.prototype.next=function(){for(var y=new d.Sa;;){if(this.ya==this.EA.I())return null;if(this.EA.ve(this.ya,y),this.ya++,!y.B())break}var v=!1;if(this.Yv==null&&(this.$H=y.Lg(),this.bI=y.ih(),this.Yv=c.buffer(y,this.Ka,this.Mj,this.vk,this.Dq,this.Ub),v=!0),this.ya<this.EA.I()){var _=new d.Da;this.Yv.copyTo(_)}else _=this.Yv;if(!v){v=new d.Dd;var $=y.Lg()-this.$H;y=y.ih()-this.bI,v.gg($,y),_.Oc(v)}return _},f.prototype.La=function(){return 0},f.prototype.qe=function(){},f}(),s=function(){function f(y,v){this.Wa=y,this.ya=0,this.oq=v}return f.prototype.next=function(){var y=this.Wa.X;if(this.ya<y.da()){var v=this.ya;if(this.ya++,!y.Nn(v))for(var _=y.Na(y.Vc(v)-1);this.ya<y.da();){var $=y.Na(y.Ba(this.ya));if(y.Nn(this.ya)||$!=_)break;_=y.Na(y.Vc(this.ya)-1),this.ya++}if(this.ya-v==1)return this.Wa.kE(this.Wa.X,v,this.oq);for((_=new d.Ta(this.Wa.X.description)).addPath(this.Wa.X,v,!0),v+=1;v<this.ya;v++)_.Dr(this.Wa.X,v,0,y.rv(v),!1);return this.Wa.kE(_,0,this.oq)}return null},f.prototype.La=function(){return 0},f.prototype.qe=function(){},f}(),a=function(){function f(y){this.Wa=y,this.ya=0}return f.prototype.next=function(){var y=this.Wa.X;if(this.ya<y.da()){var v=this.ya;for(y.Ir(this.ya),this.ya++;this.ya<y.da()&&!(0<y.Ir(this.ya));)this.ya++;return v==0&&this.ya==y.da()?this.Wa.py(y,0,y.da()):this.Wa.py(y,v,this.ya)}return null},f.prototype.La=function(){return 0},f.prototype.qe=function(){},f}(),c=function(){function f(y){this.Ks=this.lw=this.Ls=this.Id=null,this.Zd=[],this.Ub=y,this.rb=this.Kv=this.JT=this.Ka=this.tA=this.ct=this.qa=0,this.oA=this.vk=-1,this.oq=!0}return f.buffer=function(y,v,_,$,I,k){if(y==null||0>$)throw d.i.N();if(y.B())return new d.Da(y.description);var A=new d.l;return y.xc(A),0<v&&A.W(v,v),(k=new f(k)).Mj=_,k.X=y,k.qa=d.ta.Wd(_,A,!0),k.ct=d.ta.Wd(null,A,!0),k.Ka=v,k.JT=y.getType(),0>=I&&(I=96),k.rb=Math.abs(k.Ka),k.Kv=k.rb!=0?1/k.rb:0,isNaN($)||$==0?$=1e-5*k.rb:$>.5*k.rb&&($=.5*k.rb),12>I&&(I=12),(y=Math.abs(v)*(1-Math.cos(Math.PI/I)))>$?$=y:(y=Math.PI/Math.acos(1-$/Math.abs(v)))<I-1&&12>(I=d.O.truncate(y))&&(I=12,$=Math.abs(v)*(1-Math.cos(Math.PI/I))),k.vk=$,k.Dq=I,k.tA=Math.min(k.ct,.25*$),k.lE()},f.prototype.cv=function(){if(this.Id==null)this.Id=[];else if(this.Id.length!==0)return;var y=this.qE();y=d.O.truncate((y+3)/4);var v=.5*Math.PI/y;this.oA=v;for(var _=0;_<4*y;_++)this.Id.push(null);var $=Math.cos(v);v=Math.sin(v);var I=d.h.construct(0,1);for(_=0;_<y;_++)this.Id[_+0*y]=d.h.construct(I.y,-I.x),this.Id[_+1*y]=d.h.construct(-I.x,-I.y),this.Id[_+2*y]=d.h.construct(-I.y,I.x),this.Id[_+3*y]=I,(I=d.h.construct(I.x,I.y)).Bt($,v)},f.prototype.lE=function(){var y=this.X.getType();if(d.aa.yd(y))return(y=new d.Ta(this.X.description)).oc(this.X,!0),this.X=y,this.lE();if(this.Ka<=this.qa){if(!d.aa.US(y))return new d.Da(this.X.description);if(0>=this.Ka&&(y=new d.l,this.X.A(y),y.R()<=2*-this.Ka||y.ca()<=2*this.Ka))return new d.Da(this.X.description)}switch(this.X.getType()){case 33:return this.PN();case 550:return this.ON();case 1607:return this.RN();case 1736:return this.QN();case 197:return this.LN();default:throw d.i.Qa()}},f.prototype.RN=function(){if(this.EG(this.X)){var y=new d.Sa;this.X.ve(0,y);var v=new d.l;return this.X.A(v),y.Cb(v.sf()),this.Gu(y)}return this.X=this.WV(this.X),y=new s(this,this.oq),d.Gh.local().V(y,this.Mj,this.Ub).next()},f.prototype.QN=function(){if(this.Ka==0)return this.X;var y=d.Yl.local();if(this.cv(),this.X=y.V(this.X,null,!1,this.Ub),0>this.Ka){var v=this.X;return v=this.py(v,0,v.da()),y.V(v,this.Mj,!1,this.Ub)}return this.EG(this.X)?(y=new d.Sa,this.X.ve(0,y),v=new d.l,this.X.A(v),y.Cb(v.sf()),this.Gu(y)):(y=new a(this),d.Gh.local().V(y,this.Mj,this.Ub).next())},f.prototype.py=function(y,v,_){for(var $=new d.Da(y.description);v<_;v++)if(!(1>y.Ja(v))){var I=y.Ir(v),k=new d.l;if(y.Rj(v,k),0<this.Ka){if(0<I)if(this.FG(y,v))I=new d.Sa,y.ve(y.Ba(v),I),I.Cb(k.sf()),this.yu($,I);else{var A=I=new d.Ta(y.description);A=d.Zt.JG(this.X,v)||this.zn(this.X,v,A,!0,1)==2?this.jE(y,v):this.yn(I),$.add(A,!1)}else if(!(k.R()+this.qa<=2*this.rb||k.ca()+this.qa<=2*this.rb||(A=I=new d.Ta(y.description),this.zn(this.X,v,A,!0,1),I.B()))){var P=new d.l;for(P.K(k),P.W(this.rb,this.rb),A.tp(P),k=1,I=(A=this.yn(I)).da();k<I;k++)$.addPath(A,k,!0)}}else if(0<I){if(!(k.R()+this.qa<=2*this.rb||k.ca()+this.qa<=2*this.rb||(A=I=new d.Ta(y.description),this.zn(this.X,v,A,!0,-1),I.B())))for(P=new d.l,A.xc(P),P.W(this.rb,this.rb),A.tp(P),k=1,I=(A=this.yn(I)).da();k<I;k++)$.addPath(A,k,!0)}else for(A=I=new d.Ta(y.description),this.zn(this.X,v,A,!0,-1),k=0,I=(A=this.yn(I)).da();k<I;k++)$.addPath(A,k,!0)}if(0<this.Ka)return 1<$.da()?$=this.yn($):f.kx($);if(y=new d.l,$.xc(y),$.B())return f.kx($);for(y.W(this.rb,this.rb),$.tp(y),$=this.yn($),y=new d.Da($.description),k=1,I=$.da();k<I;k++)y.addPath($,k,!1);return f.kx(y)},f.prototype.PN=function(){return this.Gu(this.X)},f.prototype.Gu=function(y){var v=new d.Da(this.X.description);return this.yu(v,y),this.sX(v)},f.prototype.ON=function(){var y=new l(this.X,this.Ka,this.Mj,this.vk,this.Dq,this.Ub);return d.Gh.local().V(y,this.Mj,this.Ub).next()},f.prototype.LN=function(){var y=new d.Da(this.X.description);if(0>=this.Ka){if(this.Ka==0)y.ad(this.X,!1);else{var v=new d.Fh;this.X.bn(v),v.W(this.Ka,this.Ka),y.ad(v,!1)}return y}return y.ad(this.X,!1),this.X=y,this.jE(y,0)},f.prototype.jE=function(y,v){this.cv();var _=new d.Da(y.description),$=new d.h,I=new d.h,k=new d.h,A=new d.h,P=new d.h,D=new d.h,j=new d.h,B=new d.h,q=y.Ja(v),z=y.Ba(v),Z=0;for(v=y.Ja(v);Z<v;Z++){if(y.D(z+Z,I),y.D(z+(Z+1)%q,A),y.D(z+(Z+2)%q,D),j.uc(A,I),j.length()==0||(j.Hv(),j.normalize(),j.scale(this.rb),$.add(j,I),k.add(j,A),Z==0?_.Lt($):_.Ci($),_.Ci(k),B.uc(D,A),B.length()==0))throw d.i.Qa();B.Hv(),B.normalize(),B.scale(this.rb),P.add(B,A),this.GD(_,A,k,P,!1)}return f.kx(_)},f.prototype.kE=function(y,v,_){if(this.cv(),1>y.Ja(v))return null;if(this.FG(y,v)&&0<this.Ka){_=new d.Sa,y.ve(y.Ba(v),_);var $=new d.l;return y.Rj(v,$),_.Cb($.sf()),this.Gu(_)}if($=new d.Ta(y.description),y.Nn(v))this.zn(y,v,$,_,1),this.zn(y,v,$,_,-1);else{var I=new d.Ta(y.description);I.addPath(y,v,!1),I.Dr(y,v,0,y.rv(v),!1),this.zn(I,0,$,_,1)}return this.yn($)},f.prototype.Xq=function(){if(this.Ys++,this.Ys%1024==0&&this.Ub!=null&&!this.Ub.progress(-1,-1))throw d.i.fu("user_canceled")},f.prototype.yn=function(y){return d.Fg.Mk(y,this.ct,!0,!0,this.Ub)},f.prototype.qE=function(){if(this.vk==0)return this.Dq;var y=1-this.vk*Math.abs(this.Kv);return 4>(y=-1>y?4:2*Math.PI/Math.acos(y)+.5)?y=4:y>this.Dq&&(y=this.Dq),d.O.truncate(y)},f.prototype.GD=function(y,v,_,$,I){this.cv();var k=new d.h;k.uc(_,v),k.scale(this.Kv);var A=new d.h;A.uc($,v),A.scale(this.Kv),0>(k=Math.atan2(k.y,k.x)/this.oA)&&(k=this.Id.length+k),k=this.Id.length-k,0>(A=Math.atan2(A.y,A.x)/this.oA)&&(A=this.Id.length+A),(A=this.Id.length-A)<k&&(A+=this.Id.length);var P=d.O.truncate(A);A=d.O.truncate(Math.ceil(k)),(k=new d.h).L(this.Id[A%this.Id.length]),k.Ct(this.rb,v);var D=10*this.qa;for(k.sub(_),k.length()<D&&(A+=1),k.L(this.Id[P%this.Id.length]),k.Ct(this.rb,v),k.sub($),k.length()<D&&--P,_=P-A,_++,P=0,A%=this.Id.length;P<_;P++,A=(A+1)%this.Id.length)k.L(this.Id[A]),k.Ct(this.rb,v),y.Ci(k),this.Xq();I&&y.Ci($)},f.prototype.zn=function(y,v,_,$,I){var k=new d.gd,A=k.mN(y,v);if(k.Gp(this.tA,!1,!1),2>k.I(A))return 0>I||(I=y,k=new d.Sa,I.ve(I.Ba(v),k),this.yu(_,k)),1;var P=k.Na(k.Xa(k.Ob(A))),D=new d.Dd;if(D.gg(-P.x,-P.y),k.Oc(D),$&&(this.tQ(k,A,I),2>k.I(A)))return 0>I||(I=y,k=new d.Sa,I.ve(I.Ba(v),k),this.yu(_,k)),1;this.Zd.length=0;var j=k.Ob(A);v=k.Xa(j);var B=I==1?k.Ma(v):k.U(v);y=I==1?k.U(v):k.Ma(v);var q=!0;$=new d.h,A=new d.h;var z=new d.h,Z=new d.h,ee=new d.h,Q=new d.h,le=new d.h,se=new d.h,ve=new d.h,xe=new d.h,_e=this.rb;j=k.Ja(j);for(var je=0;je<j;je++)k.D(y,A),q&&(k.D(v,$),k.D(B,z),se.uc($,z),se.normalize(),xe.MG(se),xe.scale(_e),Z.add(xe,$)),le.uc(A,$),le.normalize(),ve.MG(le),ve.scale(_e),ee.add($,ve),B=se.wi(le),q=se.Qh(le),0>B||0>q&&B==0?this.Zd.push(h.Qu(Z,ee,$,2,this.Zd.length+1,this.Zd.length-1)):Z.qb(ee)||(this.Zd.push(h.construct(Z,$,this.Zd.length+1,this.Zd.length-1,"dummy")),this.Zd.push(h.construct($,ee,this.Zd.length+1,this.Zd.length-1,"dummy"))),Q.add(A,ve),this.Zd.push(h.Qu(ee,Q,$,1,this.Zd.length+1,this.Zd.length-1)),Z.L(Q),xe.L(ve),z.L($),$.L(A),se.L(le),B=v,v=y,q=!1,y=I==1?k.U(v):k.Ma(v);return this.Zd[this.Zd.length-1].qh=0,this.Zd[0].sh=this.Zd.length-1,this.YV(_),D.gg(P.x,P.y),_.YD(D,_.da()-1),1},f.prototype.YV=function(y){for(var v=this.zO(),_=!0,$=v+1,I=v;$!=v;I=$){var k=this.Zd[I];$=k.qh!=-1?k.qh:(I+1)%this.Zd.length,k.Co!=0&&(_&&y.Lt(k.Im),k.Co==2?this.GD(y,k.aw,k.Im,k.Vm,!0):y.Ci(k.Vm),_=!1)}},f.prototype.zO=function(){this.Ks==null&&(this.Ks=[null,null,null,null,null,null,null,null,null]);for(var y=0,v=0,_=this.Zd.length;v<_;){var $=this.Zd[v];if(3&$.Co){y=v;break}v=$.qh}for(_=y+1,v=y;_!=y;v=_){_=($=this.Zd[v]).qh;for(var I=1,k=null;_!=v&&!(3&(k=this.Zd[_]).Co);)_=k.qh,I++;I!=1&&($.Co&k.Co)==1&&(this.Ls==null&&(this.Ls=new d.yb,this.lw=new d.yb),this.Ls.Dc($.Im),this.Ls.Qc($.Vm),this.lw.Dc(k.Im),this.lw.Qc(k.Vm),this.Ls.Ea(this.lw,this.Ks,null,null,this.ct)==1&&($.Vm.L(this.Ks[0]),k.Im.L(this.Ks[0]),$.qh=_,k.sh=v))}return y},f.prototype.Fv=function(y,v,_){var $=new d.h;if($.uc(_,y),_=$.length(),0<(_=this.rb*this.rb-_*_*.25)){_=Math.sqrt(_),$.normalize(),$.ar();var I=new d.h;if(I.uc(v,y),I.Qh($)+_>=this.rb)return!0}return!1},f.prototype.tQ=function(y,v,_){for(var $=0;1>$;$++){var I=!1,k=y.Ob(v),A=y.Ja(k);if(A==0)break;var P=A;if(3>A)break;!y.dc(k)&&(P=A-1),k=y.Xa(k),A=0<_?y.Ma(k):y.U(k);for(var D=0<_?y.U(k):y.Ma(k),j=A,B=!0,q=new d.h,z=new d.h,Z=new d.h,ee=new d.h,Q=new d.h,le=d.h.construct(0,0),se=new d.h,ve=new d.h,xe=new d.h,_e=new d.h,je=this.rb,Ae=0,st=0;st<P&&(y.D(D,z),B&&(y.D(k,q),y.D(A,Z),j=A),ve.uc(q,Z),ve.normalize(),se.uc(z,q),se.normalize(),j!=D);){var it=ve.wi(se),Ne=ve.Qh(se),xi=!0;if(0>it||0>Ne&&it==0||!this.Fv(Z,q,z)||(le.L(z),xi=!1,++Ae,I=!0),xi){if(0<Ae)for(;(it=0<_?y.Ma(j):y.U(j))!=k;){if(y.D(it,ee),!this.Fv(ee,Z,le)){it!=D&&this.Fv(ee,Z,z)&&this.Fv(ee,q,z)&&(Z.L(ee),j=it,xi=!1,++Ae);break}Z.L(ee),j=it,xi=!1,++Ae}if(!xi)continue;if(0<Ae){for(j=0<_?y.Ma(A):y.U(A),B=1;B<Ae;B++)xi=0<_?y.Ma(j):y.U(j),y.pd(j,!0),j=xi;xe.uc(q,Z),Ae=je*je-(Ae=xe.length())*Ae*.25,je-(Ae=Math.sqrt(Ae))>.5*this.vk?(Q.add(Z,q),Q.scale(.5),xe.normalize(),xe.ar(),_e.L(xe),_e.scale(je-Ae),Q.add(_e),y.mf(A,Q)):y.pd(A,!0),Ae=0}Z.L(q),j=k}q.L(z),A=k,k=D,D=0<_?y.U(k):y.Ma(k),st++,B=!1}if(0<Ae){for(j=0<_?y.Ma(A):y.U(A),B=1;B<Ae;B++)xi=0<_?y.Ma(j):y.U(j),y.pd(j,!0),j=xi;Q.add(Z,q),Q.scale(.5),xe.uc(q,Z),Ae=je*je-(Ae=xe.length())*Ae*.25,Ae=Math.sqrt(Ae),xe.normalize(),xe.ar(),_e.L(xe),_e.scale(je-Ae),Q.add(_e),y.mf(A,Q)}if(y.Gp(this.tA,!1,!1),!I)break}},f.prototype.FG=function(y,v){if(y.Ja(v)==1)return!0;var _=new d.l;return y.Rj(v,_),Math.max(_.R(),_.ca())<.5*this.vk},f.prototype.EG=function(y){var v=new d.l;return y.A(v),Math.max(v.R(),v.ca())<.5*this.vk},f.prototype.WV=function(y){for(var v=0,_=0,$=(y=d.EC.local().V(y,.25*this.vk,!1,this.Ub)).da();_<$;_++)v=Math.max(y.Ja(_),v);return 32>v?(this.oq=!1,y):(this.oq=!0,d.Fg.Mk(y,this.ct,!1,!0,this.Ub))},f.prototype.yu=function(y,v){if(v=v.D(),this.Id!=null&&this.Id.length!==0){var _=new d.h;_.L(this.Id[0]),_.Ct(this.rb,v),y.Lt(_);for(var $=1,I=this.Id.length;$<I;$++)_.L(this.Id[$]),_.Ct(this.rb,v),y.Ci(_)}else{$=this.qE(),_=d.O.truncate(($+3)/4),$=.5*Math.PI/_,I=Math.cos($);for(var k=Math.sin($),A=new d.h,P=3;0<=P;P--){switch(A.ma(0,this.rb),P){case 0:for($=0;$<_;$++)y.yj(A.x+v.x,A.y+v.y),A.Bt(I,k);break;case 1:for($=0;$<_;$++)y.yj(-A.y+v.x,A.x+v.y),A.Bt(I,k);break;case 2:for($=0;$<_;$++)y.yj(-A.x+v.x,-A.y+v.y),A.Bt(I,k);break;default:for(y.sx(A.y+v.x,-A.x+v.y),$=1;$<_;$++)A.Bt(I,k),y.yj(A.y+v.x,-A.x+v.y)}this.Xq()}}},f.kx=function(y){return y.Ch(1,0),y},f.prototype.sX=function(y){return y.Ch(2,this.qa),y.fm(),y},f}();d.HK=c}(Y||(Y={})),function(d){var O=function(){function x(h){this.Ca=h,this.g=new d.gd,this.dd=new d.ia(0)}return x.prototype.Lh=function(h,l,s){switch(l){case 0:if(h.v<s&&h.C<=s)break;return h.v>=s?1:-1;case 1:if(h.G<s&&h.H<=s)break;return h.G>=s?1:-1;case 2:if(h.v>=s&&h.C>s)break;return h.C<=s?1:-1;case 3:if(!(h.G>=s&&h.H>s))return h.H<=s?1:-1}return 0},x.prototype.Ay=function(h,l){return h.getType()==1736?this.Cy(h,l):this.Dy(h)},x.prototype.Cy=function(h,l){if(this.Ca.R()==0||this.Ca.ca()==0)return h.Ia();var s=new d.l;h.xc(s),this.X=this.g.Ib(h);var a=new d.l,c=new d.l,f=new d.h,y=new d.h,v=[0,0,0,0,0,0,0,0,0],_=[0,0,0,0,0,0,0,0,0];new d.ig;var $=new d.yb,I=new d.ia(0);I.Jb(Math.min(100,h.I()));for(var k=!1,A=0;!k&&4>A;A++){var P=!1,D=!!(1&A),j=0;switch(A){case 0:j=this.Ca.v,P=s.v<=j&&s.C>=j;break;case 1:j=this.Ca.G,P=s.G<=j&&s.H>=j;break;case 2:j=this.Ca.C,P=s.v<=j&&s.C>=j;break;case 3:j=this.Ca.H,P=s.G<=j&&s.H>=j}if(P)for(k=!0,P=this.g.Ob(this.X);P!=-1;){var B=-1,q=-1,z=this.g.Xa(P),Z=z;do{var ee=this.g.bc(Z);ee==null&&(ee=$,this.g.D(Z,f),ee.Dc(f),this.g.D(this.g.U(Z),y),ee.Qc(y)),ee.A(a);var Q=this.Lh(a,A,j),le=0,se=-1;if(Q==-1){le=0<(ee=ee.cq(D,j,v,_))?this.g.Ul(Z,_,ee):0,le+=1;var ve=Z,xe=this.g.U(ve);for(ee=0;ee<le;ee++){if(this.g.D(ve,f),this.g.D(xe,y),(se=this.g.bc(ve))==null&&((se=$).Dc(f),se.Qc(y)),se.A(c),(se=this.Lh(c,A,j))==-1){if(D)(se=Math.abs(f.y-j))<(_e=Math.abs(y.y-j))?(f.y=j,this.g.mf(ve,f)):(y.y=j,this.g.mf(xe,y));else{se=Math.abs(f.x-j);var _e=Math.abs(y.x-j);se<_e?(f.x=j,this.g.mf(ve,f)):(y.x=j,this.g.mf(xe,y))}(se=this.g.bc(ve))==null&&((se=$).Dc(f),se.Qc(y)),se.A(c),se=this.Lh(c,A,j)}_e=B,B=se,q==-1&&(q=B),_e==0&&B==1||_e==1&&B==0||_e!=0||B!=0||I.add(ve),B==1&&(k=!1),se=ve=xe,xe=this.g.U(xe)}}le==0&&(_e=B,B=Q,q==-1&&(q=B),_e==0&&B==1||_e==1&&B==0||_e!=0||B!=0||I.add(Z),B==1&&(k=!1),se=this.g.U(Z)),Z=se}while(Z!=z);for(q==0&&B==0&&I.add(z),ee=0,B=I.size;ee<B;ee++)q=I.get(ee),this.g.pd(q,!1);I.clear(!1),P=3>this.g.Ja(P)?this.g.Zq(P):this.g.Rb(P)}}return k?h.Ia():(this.FB(),0<l&&this.My(l),this.g.Ne(this.X))},x.prototype.Dy=function(h){var l=new d.l,s=new d.l,a=[0,0,0,0,0,0,0,0,0],c=[0,0,0,0,0,0,0,0,0],f=new d.ig,y=h,v=new d.l;h.xc(v);for(var _=0;4>_;_++){var $=!1,I=!!(1&_),k=0;switch(_){case 0:k=this.Ca.v,$=v.v<=k&&v.C>=k;break;case 1:k=this.Ca.G,$=v.G<=k&&v.H>=k;break;case 2:k=this.Ca.C,$=v.v<=k&&v.C>=k;break;case 3:k=this.Ca.H,$=v.G<=k&&v.H>=k}if($){$=y,y=h.Ia(),($=$.Ga()).Zi();for(var A,P=new d.h;$.$a();)for(var D,j=!0;$.Ha();){var B=$.ha();B.A(l);var q=this.Lh(l,_,k);if(q==-1){if(0<(q=B.cq(I,k,a,c))){var z=0;A=B.ac();for(var Z=0;Z<=q;Z++)if(z!=(D=Z<q?c[Z]:1)){B.ah(z,D,f);var ee=f.get();ee.Dc(A),Z<q&&(I?(P.x=a[Z],P.y=k):(P.x=k,P.y=a[Z]),ee.Qc(P)),ee.A(s);var Q=this.Lh(s,_,k);if(Q==-1){if(A=ee.ac(),z=ee.wc(),I)(Q=Math.abs(A.y-k))<(le=Math.abs(z.y-k))?(A.y=k,ee.Dc(A)):(z.y=k,ee.Qc(z));else{Q=Math.abs(A.x-k);var le=Math.abs(z.x-k);Q<le?(A.x=k,ee.Dc(A)):(z.x=k,ee.Qc(z))}ee.A(s),Q=this.Lh(s,_,k)}A=ee.wc(),z=D,(D=Q)==1?(y.oc(ee,j),j=!1):j=!0}}}else(D=q)==1?(y.oc(B,j),j=!1):j=!0}}}return y},x.prototype.FB=function(){this.ji=-1,this.Vl(!1,this.Ca.v),this.Vl(!1,this.Ca.C),this.Vl(!0,this.Ca.G),this.Vl(!0,this.Ca.H),this.dd.resize(0),this.dd.Jb(100),this.ji=this.g.Gd();for(var h=new d.h,l=this.g.Ob(this.X);l!=-1;l=this.g.Rb(l))for(var s=this.g.Xa(l),a=0,c=this.g.Ja(l);a<c;a++,s=this.g.U(s))this.g.D(s,h),(this.Ca.v==h.x||this.Ca.C==h.x||this.Ca.G==h.y||this.Ca.H==h.y)&&(this.g.Ra(s,this.ji,this.dd.size),this.dd.add(s));this.Nl(!1,this.Ca.v),this.Nl(!1,this.Ca.C),this.Nl(!0,this.Ca.G),this.Nl(!0,this.Ca.H),this.Ty()},x.prototype.My=function(h){for(var l=new d.h,s=new d.h,a=d.O.lg(2048,0),c=this.g.Ob(this.X);c!=-1;c=this.g.Rb(c)){var f=this.g.Xa(c),y=f;do{var v=this.g.U(y);this.g.D(y,l);var _=-1;if(l.x==this.Ca.v?(this.g.D(v,s),s.x==this.Ca.v&&(_=1)):l.x==this.Ca.C&&(this.g.D(v,s),s.x==this.Ca.C&&(_=1)),l.y==this.Ca.G?(this.g.D(v,s),s.y==this.Ca.G&&(_=0)):l.y==this.Ca.H&&(this.g.D(v,s),s.y==this.Ca.H&&(_=0)),_!=-1&&(_=d.h.tb(l,s),!(1>=(_=d.O.truncate(Math.min(Math.ceil(_/h),2048)))))){for(var $=1;$<_;$++)a[$-1]=1*$/_;this.g.Ul(y,a,_-1)}y=v}while(y!=f)}},x.prototype.Vl=function(h,l){var s=this.g.Gd(),a=new d.h,c=new d.ia(0);c.Jb(100);for(var f=this.g.Ob(this.X);f!=-1;f=this.g.Rb(f))for(var y=this.g.Xa(f),v=0,_=this.g.Ja(f);v<_;v++){var $=this.g.U(y);this.g.D(y,a),(h?a.y==l:a.x==l)&&(this.g.D($,a),(h?a.y==l:a.x==l)&&(this.g.Pa(y,s)!=1&&(c.add(y),this.g.Ra(y,s,1)),this.g.Pa($,s)!=1&&(c.add($),this.g.Ra($,s,1)))),y=$}if(this.g.Td(s),!(3>c.size)){var I=this;c.Vd(0,c.size,function(Q,le){return I.Mh(Q,le)}),s=new d.h,f=new d.h,y=new d.h,f.Rc();var k=-1;v=new d.ia(0),_=new d.ia(0),$=this.g.Gd();for(var A=this.g.Gd(),P=0,D=c.size;P<D;P++){var j=c.get(P);if(this.g.D(j,a),!a.qb(f)){if(k!=-1){for(var B=k;B<P;B++){k=c.get(B);var q=this.g.U(k);j=this.g.Ma(k);var z=!1;0>this.Mh(k,q)&&(this.g.D(q,s),h?s.y==l:s.x==l)&&(v.add(k),z=!0,this.g.Ra(k,A,1)),0>this.Mh(k,j)&&(this.g.D(j,s),h?s.y==l:s.x==l)&&(z||v.add(k),this.g.Ra(k,$,1))}for(B=0,z=v.size;B<z;B++){if(k=v.get(B),j=this.g.Pa(k,$),q=this.g.Pa(k,A),j==1){j=this.g.Ma(k),this.g.D(j,y);var Z=[0];if(Z[0]=0,!y.qb(a)){var ee=d.h.tb(f,y);Z[0]=d.h.tb(y,a)/ee,Z[0]==0?Z[0]=2220446049250313e-31:Z[0]==1&&(Z[0]=.9999999999999998),this.g.Ul(j,Z,1),j=this.g.Ma(k),this.g.mf(j,a),_.add(j),this.g.Ra(j,$,1),this.g.Ra(j,A,-1)}}q==1&&(q=this.g.U(k),this.g.D(q,y),(Z=[0])[0]=0,y.qb(a)||(ee=d.h.tb(f,y),Z[0]=d.h.tb(f,a)/ee,Z[0]==0?Z[0]=2220446049250313e-31:Z[0]==1&&(Z[0]=.9999999999999998),this.g.Ul(k,Z,1),j=this.g.U(k),this.g.mf(j,a),_.add(j),this.g.Ra(j,$,-1),this.g.Ra(j,A,1)))}k=v,v=_,(_=k).clear(!1)}k=P,f.L(a)}}this.g.Td($),this.g.Td(A)}},x.prototype.Nl=function(h,l){var s=new d.h,a=new d.ia(0);a.Jb(100);for(var c=this.g.Gd(),f=0,y=this.dd.size;f<y;f++){var v=this.dd.get(f);if(v!=-1){var _=this.g.U(v);this.g.D(v,s),(h?s.y==l:s.x==l)&&(this.g.D(_,s),(h?s.y==l:s.x==l)&&(this.g.Pa(v,c)!=-2&&(a.add(v),this.g.Ra(v,c,-2)),this.g.Pa(_,c)!=-2&&(a.add(_),this.g.Ra(_,c,-2))))}}if(a.size!=0){var $=this;for(a.Vd(0,a.size,function(le,se){return $.Mh(le,se)}),f=0,y=a.size;f<y;f++){var I=a.get(f);this.g.Ra(I,c,f)}v=new d.h,(_=new d.h).Rc();var k=-1;for(f=0,y=a.size;f<y;f++)if((I=a.get(f))!=-1&&(this.g.D(I,s),!s.qb(_))){if(k!=-1)for(;;){I=!1;for(var A=1<f-k?f-1:f,P=k;P<A;P++){var D=a.get(P);if(D!=-1){var j=-1,B=this.g.U(D);0>this.Mh(D,B)&&(this.g.D(B,v),h?v.y==l:v.x==l)&&(j=B),B=-1;var q=this.g.Ma(D);if(0>this.Mh(D,q)&&(this.g.D(q,v),h?v.y==l:v.x==l)&&(B=q),j!=-1&&B!=-1)this.Kh(D,a,c),this.g.pd(D,!1),this.Kh(j,a,c),this.g.pd(j,!1),I=!0;else if(j!=-1||B!=-1){for(q=P+1;q<f;q++){var z=a.get(q);if(z!=-1){var Z=this.g.U(z),ee=-1;0>this.Mh(z,Z)&&(this.g.D(Z,v),h?v.y==l:v.x==l)&&(ee=Z),Z=this.g.Ma(z);var Q=-1;if(0>this.Mh(z,Z)&&(this.g.D(Z,v),h?v.y==l:v.x==l)&&(Q=Z),ee!=-1&&Q!=-1){this.Kh(z,a,c),this.g.pd(z,!1),this.Kh(ee,a,c),this.g.pd(ee,!1),I=!0;break}if(j!=-1&&Q!=-1){this.zt(a,D,j,z,Q,c),I=!0;break}if(B!=-1&&ee!=-1){this.zt(a,z,ee,D,B,c),I=!0;break}}}if(I)break}}}if(!I)break}k=f,_.L(s)}}this.g.Td(c)},x.prototype.Kh=function(h,l,s){s=this.g.Pa(h,s),l.set(s,-1),s=this.g.Pa(h,this.ji),this.dd.set(s,-1),(l=this.g.bd(h))!=-1&&this.g.Xa(l)==h&&(this.g.Jf(l,-1),this.g.Wg(l,-1))},x.prototype.zt=function(h,l,s,a,c,f){this.g.Bc(l,a),this.g.Cc(a,l),this.g.Cc(s,c),this.g.Bc(c,s),this.Kh(a,h,f),this.g.mi(a,!1),this.Kh(c,h,f),this.g.mi(c,!0)},x.prototype.Ty=function(){for(var h=0,l=this.dd.size;h<l;h++){var s=this.dd.get(h);s!=-1&&this.g.aj(s,-1)}for(var a=0,c=0,f=this.g.Ob(this.X);f!=-1;){var y=this.g.Xa(f);if(y==-1||f!=this.g.bd(y)){var v=f;f=this.g.Rb(f),this.g.Jf(v,-1),this.g.$q(v)}else{s=y,v=0;do this.g.aj(s,f),v++,s=this.g.U(s);while(s!=y);2>=v?(s=this.g.Pa(y,this.ji),this.dd.set(s,-1),y=this.g.pd(y,!1),v==2&&(s=this.g.Pa(y,this.ji),this.dd.set(s,-1),this.g.pd(y,!1)),v=f,f=this.g.Rb(f),this.g.Jf(v,-1),this.g.$q(v)):(this.g.cp(f,!1),this.g.Wg(f,this.g.Ma(y)),this.g.Vj(f,v),c+=v,a++,f=this.g.Rb(f))}}for(h=0,l=this.dd.size;h<l;h++)if((s=this.dd.get(h))!=-1&&(f=this.g.bd(s))==-1){f=this.g.vf(this.X,-1),v=0,y=s;do this.g.aj(s,f),v++,s=this.g.U(s);while(s!=y);2>=v?(s=this.g.Pa(y,this.ji),this.dd.set(s,-1),y=this.g.pd(y,!1),v==2&&(0<=(s=this.g.Pa(y,this.ji))&&this.dd.set(s,-1),this.g.pd(y,!1)),v=f,this.g.Jf(v,-1),this.g.$q(v)):(this.g.kn(f,!0),this.g.Vj(f,v),this.g.Jf(f,y),this.g.Wg(f,this.g.Ma(y)),this.g.cp(f,!1),c+=v,a++)}for(this.g.Rl(this.X,a),this.g.Tj(this.X,c),h=0,l=this.g.ld;l!=-1;l=this.g.ue(l))h+=this.g.I(l);this.g.bC(h)},x.By=function(h,l,s){return new x(l).Ay(h,s)},x.clip=function(h,l,s,a){if(h.B())return h;if(l.B())return h.Ia();if((s=h.getType())==33)return a=h.D(),l.contains(a)?h:h.Ia();if(s==197)return a=new d.l,h.A(a),a.Ea(l)?(l=new d.Fh,h.copyTo(l),l.Xo(a),l):h.Ia();var c=new d.l;if(h.xc(c),l.contains(c))return h;if(!l.isIntersecting(c))return h.Ia();if((c=h.Bb)!=null&&(c=c.Fk)!=null){if((c=c.Ro(l))==1){if(s!=1736)throw d.i.Qa();return(h=new d.Da(h.description)).tp(l),h}if(c==0)return h.Ia()}switch(s){case 550:s=null,c=h.I();for(var f=h.ub(0),y=0,v=0;v<c;v++)a=new d.h,f.tc(2*v,a),l.contains(a)||(y==0&&(s=h.Ia()),y<v&&s.Fd(h,y,v),y=v+1);return 0<y&&s.Fd(h,y,c),y==0?h:s;case 1736:case 1607:return x.By(h,l,a);default:throw d.i.Qa()}},x.prototype.Mh=function(h,l){var s=new d.h;return this.g.D(h,s),h=new d.h,this.g.D(l,h),s.compare(h)},x}();d.Ud=O}(Y||(Y={})),function(d){var O=function(){function x(h,l){this.Ca=h,this.g=new d.gd,this.dd=new d.ia(0),this.nd=l}return x.prototype.Lh=function(h,l,s){switch(l){case 0:if(h.v<s&&h.C<=s)break;return h.v>=s?1:-1;case 1:if(h.G<s&&h.H<=s)break;return h.G>=s?1:-1;case 2:if(h.v>=s&&h.C>s)break;return h.C<=s?1:-1;case 3:if(!(h.G>=s&&h.H>s))return h.H<=s?1:-1}return 0},x.prototype.Ay=function(h,l){return h.getType()==1736?this.Cy(h,l):this.Dy(h)},x.prototype.Cy=function(h,l){if(this.Ca.R()==0||this.Ca.ca()==0)return h.Ia();var s=new d.l;h.xc(s),this.X=this.g.Ib(h);var a=new d.l,c=new d.l,f=new d.h,y=new d.h,v=[0,0,0,0,0,0,0,0,0],_=[0,0,0,0,0,0,0,0,0],$=new d.yb,I=new d.ia(0);I.Jb(256);for(var k=!1,A=0;!k&&4>A;A++){var P=!1,D=!!(1&A),j=0;switch(A){case 0:j=this.Ca.v,P=s.v<=j&&s.C>=j;break;case 1:j=this.Ca.G,P=s.G<=j&&s.H>=j;break;case 2:j=this.Ca.C,P=s.v<=j&&s.C>=j;break;case 3:j=this.Ca.H,P=s.G<=j&&s.H>=j}if(P)for(k=!0,P=this.g.Ob(this.X);P!=-1;){var B=!0,q=-1,z=-1,Z=this.g.Xa(P),ee=Z;do{var Q=this.g.bc(ee);Q==null&&(Q=$,this.g.D(ee,f),Q.Dc(f),this.g.D(this.g.U(ee),y),Q.Qc(y)),Q.A(a);var le=this.Lh(a,A,j),se=0,ve=-1;if(le==-1){se=0<(Q=Q.cq(D,j,v,_))?this.g.LX(ee,_,Q):0,se+=1;var xe=ee,_e=this.g.U(xe);for(Q=0;Q<se;Q++){if(this.g.D(xe,f),this.g.D(_e,y),(ve=this.g.bc(xe))==null&&((ve=$).Dc(f),ve.Qc(y)),ve.A(c),(ve=this.Lh(c,A,j))==-1){if(D)(ve=Math.abs(f.y-j))<(je=Math.abs(y.y-j))?(f.y=j,this.g.mf(xe,f)):(y.y=j,this.g.mf(_e,y));else{ve=Math.abs(f.x-j);var je=Math.abs(y.x-j);ve<je?(f.x=j,this.g.mf(xe,f)):(y.x=j,this.g.mf(_e,y))}(ve=this.g.bc(xe))==null&&((ve=$).Dc(f),ve.Qc(y)),ve.A(c),ve=this.Lh(c,A,j)}je=q,q=ve,z==-1&&(z=q),je==0&&q==1||je==1&&q==0||je!=0||q!=0||I.add(xe),q==1&&(B=k=!1),ve=xe=_e,_e=this.g.U(_e)}}if(se==0&&(je=q,q=le,z==-1&&(z=q),je==0&&q==1||je==1&&q==0||je!=0||q!=0||I.add(ee),q==1&&(B=k=!1),ve=this.g.U(ee)),ee=ve,256<=I.size){for(Q=1,le=I.size-1;Q<le;Q++)se=I.get(Q),this.g.pd(se,!1);I.set(1,I.Fc()),I.Bh(2)}}while(ee!=Z);if(!B)for(z==0&&q==0&&I.add(Z),Q=0,le=I.size;Q<le;Q++)se=I.get(Q),this.g.pd(se,!1);I.clear(!1),P=B||this.g.Ja(P)==0?this.g.Zq(P):this.g.Rb(P)}}return k?h.Ia():(this.FB(),0<l&&this.My(l),this.g.Ne(this.X))},x.prototype.Dy=function(h){var l=new d.l,s=new d.l,a=[0,0,0,0,0,0,0,0,0],c=[0,0,0,0,0,0,0,0,0],f=new d.ig,y=h,v=new d.l;h.xc(v);for(var _=new d.h,$=new d.h,I=null,k=null,A=0;4>A;A++){var P=!1,D=!!(1&A),j=0;switch(A){case 0:j=this.Ca.v,P=v.v<=j&&v.C>=j;break;case 1:j=this.Ca.G,P=v.G<=j&&v.H>=j;break;case 2:j=this.Ca.C,P=v.v<=j&&v.C>=j;break;case 3:j=this.Ca.H,P=v.G<=j&&v.H>=j}if(P)for(P=y,y=h.Ia(),(P=P.Ga()).Zi();P.$a();)for(var B,q=!0;P.Ha();){var z=P.ha();z.A(l);var Z=this.Lh(l,A,j);if(Z==-1){if(0<(Z=z.cq(D,j,a,c))){var ee=0;z.Yp(_);for(var Q=0;Q<=Z;Q++)if(ee!=(B=Q<Z?c[Q]:1)){z.ah(ee,B,f);var le=f.get();le.Dc(_),Q<Z&&(D?($.x=a[Q],$.y=j):($.x=j,$.y=a[Q]),le.Qc($)),le.A(s);var se=this.Lh(s,A,j);se==-1&&(I==null&&(I=new d.h),k==null&&(k=new d.h),le.Yp(I),le.Tr(k),D?(ee=Math.abs(I.y-j))<(se=Math.abs(k.y-j))?(I.y=j,le.Dc(I)):(k.y=j,le.Qc(k)):(ee=Math.abs(I.x-j))<(se=Math.abs(k.x-j))?(I.x=j,le.Dc(I)):(k.x=j,le.Qc(k)),le.A(s),se=this.Lh(s,A,j)),le.Tr(_),ee=B,(B=se)==1?(y.oc(le,q),q=!1):q=!0}}}else(B=Z)==1?(y.oc(z,q),q=!1):q=!0}}return y},x.prototype.FB=function(){this.ji=-1,this.Vl(!1,this.Ca.v),this.Vl(!1,this.Ca.C),this.Vl(!0,this.Ca.G),this.Vl(!0,this.Ca.H),this.dd.resize(0),this.dd.Jb(100),this.ji=this.g.Gd();for(var h=new d.h,l=this.g.Ob(this.X);l!=-1;l=this.g.Rb(l))for(var s=this.g.Xa(l),a=0,c=this.g.Ja(l);a<c;a++,s=this.g.U(s))this.g.D(s,h),(this.Ca.v==h.x||this.Ca.C==h.x||this.Ca.G==h.y||this.Ca.H==h.y)&&(this.g.Ra(s,this.ji,this.dd.size),this.dd.add(s));this.Nl(!1,this.Ca.v),this.Nl(!1,this.Ca.C),this.Nl(!0,this.Ca.G),this.Nl(!0,this.Ca.H),this.Ty()},x.prototype.My=function(h){for(var l=new d.h,s=new d.h,a=null,c=null,f=d.O.lg(2048,0),y=this.g.Ob(this.X);y!=-1;y=this.g.Rb(y)){var v=this.g.Xa(y),_=v;do{var $=this.g.U(_);this.g.D(_,l);var I=-1;if(l.x==this.Ca.v?(this.g.D($,s),s.x==this.Ca.v&&(I=1)):l.x==this.Ca.C&&(this.g.D($,s),s.x==this.Ca.C&&(I=1)),l.y==this.Ca.G?(this.g.D($,s),s.y==this.Ca.G&&(I=0)):l.y==this.Ca.H&&(this.g.D($,s),s.y==this.Ca.H&&(I=0)),I!=-1){if(a==null&&(a=new d.h),c==null&&(c=new d.h),a.L(l),c.ma(0,0),I==0){var k=l.x-this.Ca.v;c.x=d.lc.sign(s.x-l.x),a.x=h*d.lc.Cn(Math.floor(Math.abs(k/h)),k)+this.Ca.v,0>a.x&&(a.x+=h)}else k=l.y-this.Ca.G,c.y=d.lc.sign(s.y-l.y),a.y=h*d.lc.Cn(Math.floor(Math.abs(k/h)),k)+this.Ca.G,0>a.y&&(a.y+=h);k=I!=0?s.y-l.y:s.x-l.x;var A=Math.abs(k);if(65536<A/h)throw d.i.fa("internal error");if(0<A){A=d.O.truncate(A/h)+2,f.length<A&&(f=d.O.lg(A));for(var P=A=0;;P++){var D=new d.h;if(D.x=a.x+c.x*P*h,D.y=a.y+c.y*P*h,1<=(D=(I!=0?D.y-l.y:D.x-l.x)/k))break;0>=D||(f[A]=D,A++)}A!=0&&this.g.Ul(_,f,A)}}_=$}while(_!=v)}},x.prototype.Vl=function(h,l){for(var s=-1,a=new d.h,c=null,f=this.g.Ob(this.X);f!=-1;f=this.g.Rb(f))for(var y=this.g.Xa(f),v=0,_=this.g.Ja(f);v<_;v++){var $=this.g.U(y);this.g.D(y,a),(h?a.y==l:a.x==l)&&(this.g.D($,a),(h?a.y==l:a.x==l)&&(s==-1&&(s=this.g.Gd()),c==null&&(c=new d.ia(0)).Jb(100),this.g.Pa(y,s)!=1&&(c.add(y),this.g.Ra(y,s,1)),this.g.Pa($,s)!=1&&(c.add($),this.g.Ra($,s,1)))),y=$}if(s!=-1&&this.g.Td(s),!(c==null||3>c.size)){var I=this;c.Vd(0,c.size,function(Q,le){return I.Mh(Q,le)}),s=new d.h,f=new d.h,y=new d.h,f.Rc();var k=-1;v=new d.ia(0),_=new d.ia(0),$=null;for(var A=this.g.Gd(),P=this.g.Gd(),D=0,j=c.size;D<j;D++){var B=c.get(D);if(this.g.D(B,a),!a.qb(f)){if(k!=-1){for(var q=k;q<D;q++){k=c.get(q);var z=this.g.U(k);B=this.g.Ma(k);var Z=!1;this.g.D(z,s),0>f.compare(s)&&(h?s.y==l:s.x==l)&&(v.add(k),Z=!0,this.g.Ra(k,P,1)),this.g.D(B,s),0>f.compare(s)&&(h?s.y==l:s.x==l)&&(Z||v.add(k),this.g.Ra(k,A,1))}for(q=0,Z=v.size;q<Z;q++){if(k=v.get(q),B=this.g.Pa(k,A),z=this.g.Pa(k,P),B==1&&(B=this.g.Ma(k),this.g.D(B,y),!y.qb(a))){$==null&&($=[]);var ee=d.h.tb(f,y);$[0]=d.h.tb(y,a)/ee,$[0]==0?$[0]=2220446049250313e-31:$[0]==1&&($[0]=.9999999999999998),this.g.Ul(B,$,1),B=this.g.Ma(k),this.g.mf(B,a),_.add(B),this.g.Ra(B,A,1),this.g.Ra(B,P,-1)}z==1&&(z=this.g.U(k),this.g.D(z,y),y.qb(a)||($==null&&($=[]),ee=d.h.tb(f,y),$[0]=d.h.tb(f,a)/ee,$[0]==0?$[0]=2220446049250313e-31:$[0]==1&&($[0]=.9999999999999998),this.g.Ul(k,$,1),B=this.g.U(k),this.g.mf(B,a),_.add(B),this.g.Ra(B,A,-1),this.g.Ra(B,P,1)))}k=v,v=_,(_=k).clear(!1)}k=D,f.L(a)}}this.g.Td(A),this.g.Td(P)}},x.prototype.Nl=function(h,l){for(var s=new d.h,a=null,c=-1,f=0,y=this.dd.size;f<y;f++){var v=this.dd.get(f);if(v!=-1){var _=this.g.U(v);this.g.D(v,s),(h?s.y==l:s.x==l)&&(this.g.D(_,s),(h?s.y==l:s.x==l)&&(c==-1&&(c=this.g.Gd()),a==null&&(a=new d.ia(0)).Jb(100),this.g.Pa(v,c)!=-2&&(a.add(v),this.g.Ra(v,c,-2)),this.g.Pa(_,c)!=-2&&(a.add(_),this.g.Ra(_,c,-2))))}}if(a==null)c!=-1&&this.g.Td(c);else{var $=this;for(a.Vd(0,a.size,function(le,se){return $.Mh(le,se)}),f=0,y=a.size;f<y;f++){var I=a.get(f);this.g.Ra(I,c,f)}v=new d.h,(_=new d.h).Rc();var k=-1;for(f=0,y=a.size;f<y;f++)if((I=a.get(f))!=-1&&(this.g.D(I,s),!s.qb(_))){if(k!=-1)for(;;){I=!1;for(var A=1<f-k?f-1:f,P=k;P<A;P++){var D=a.get(P);if(D!=-1){var j=-1,B=this.g.U(D);this.g.D(B,v),0>_.compare(v)&&(h?v.y==l:v.x==l)&&(j=B),B=-1;var q=this.g.Ma(D);if(this.g.D(q,v),0>_.compare(v)&&(h?v.y==l:v.x==l)&&(B=q),j!=-1&&B!=-1)this.Kh(D,a,c),this.g.pd(D,!1),this.Kh(j,a,c),this.g.pd(j,!1),I=!0;else if(j!=-1||B!=-1){for(q=P+1;q<f;q++){var z=a.get(q);if(z!=-1){var Z=this.g.U(z),ee=-1;this.g.D(Z,v),0>_.compare(v)&&(h?v.y==l:v.x==l)&&(ee=Z),Z=this.g.Ma(z);var Q=-1;if(this.g.D(Z,v),0>_.compare(v)&&(h?v.y==l:v.x==l)&&(Q=Z),ee!=-1&&Q!=-1){this.Kh(z,a,c),this.g.pd(z,!1),this.Kh(ee,a,c),this.g.pd(ee,!1),I=!0;break}if(j!=-1&&Q!=-1){this.zt(a,D,j,z,Q,c),I=!0;break}if(B!=-1&&ee!=-1){this.zt(a,z,ee,D,B,c),I=!0;break}}}if(I)break}}}if(!I)break}k=f,_.L(s)}this.g.Td(c)}},x.prototype.Kh=function(h,l,s){s=this.g.Pa(h,s),l.set(s,-1),s=this.g.Pa(h,this.ji),this.dd.set(s,-1),(l=this.g.bd(h))!=-1&&this.g.Xa(l)==h&&(this.g.Jf(l,-1),this.g.Wg(l,-1))},x.prototype.zt=function(h,l,s,a,c,f){this.g.Bc(l,a),this.g.Cc(a,l),this.g.Cc(s,c),this.g.Bc(c,s),this.Kh(a,h,f),this.g.mi(a,!1),this.Kh(c,h,f),this.g.mi(c,!0)},x.prototype.Ty=function(){for(var h=0,l=this.dd.size;h<l;h++){var s=this.dd.get(h);s!=-1&&this.g.aj(s,-1)}for(var a=0,c=0,f=this.g.Ob(this.X);f!=-1;){var y=this.g.Xa(f);if(y==-1||f!=this.g.bd(y)){var v=f;f=this.g.Rb(f),this.g.Jf(v,-1),this.g.$q(v)}else{s=y,v=0;do this.g.aj(s,f),v++,s=this.g.U(s);while(s!=y);this.g.cp(f,!1),this.g.Wg(f,this.g.Ma(y)),this.g.Vj(f,v),c+=v,a++,f=this.g.Rb(f)}}for(h=0,l=this.dd.size;h<l;h++)if((s=this.dd.get(h))!=-1&&(f=this.g.bd(s))==-1){f=this.g.vf(this.X,-1),v=0,y=s;do this.g.aj(s,f),v++,s=this.g.U(s);while(s!=y);2>=v?(s=this.g.Pa(y,this.ji),this.dd.set(s,-1),y=this.g.pd(y,!1),v==2&&(0<=(s=this.g.Pa(y,this.ji))&&this.dd.set(s,-1),this.g.pd(y,!1)),v=f,this.g.Jf(v,-1),this.g.$q(v)):(this.g.kn(f,!0),this.g.Vj(f,v),this.g.Jf(f,y),this.g.Wg(f,this.g.Ma(y)),this.g.cp(f,!1),c+=v,a++)}for(this.g.Rl(this.X,a),this.g.Tj(this.X,c),h=0,l=this.g.ld;l!=-1;l=this.g.ue(l))h+=this.g.I(l);this.g.bC(h)},x.By=function(h,l,s,a){return new x(l,a).Ay(h,s)},x.clip=function(h,l,s,a,c){return x.Nu(h,l,null,s,a,c)},x.Nu=function(h,l,s,a,c,f){var y=h.getType();if(y==33)return c=h.D(),l.contains(c)?h:h.Ia();if(y==197)return c=new d.l,h.A(c),c.Ea(l)?(l=new d.Fh,h.copyTo(l),l.Xo(c),l):h.Ia();if(h.B())return h;if(l.B())return h.Ia();var v=new d.l;if(h.xc(v),l.contains(v))return h;if(!l.isIntersecting(v))return h.Ia();if((s!=null||isNaN(a))&&d.ta.ty(s,l,!1),!d.aa.xj(y))throw d.i.N();if((s=h.Bb)!=null&&(s=s.Fk)!=null){if((s=s.Ro(l))==1){if(y!=1736)throw d.i.fa("internal error");return(h=new d.Da(h.description)).tp(l),h}if(s==0)return h.Ia()}switch(y){case 550:for(f=null,y=h.I(),s=h.ub(0),a=0,c=new d.h,v=0;v<y;v++)s.tc(2*v,c),l.contains(c)||(a==0&&(f=h.Ia()),a<v&&f.Fd(h,a,v),a=v+1);return 0<a&&f.Fd(h,a,y),a==0?h:f;case 1736:case 1607:return x.By(h,l,c,f);default:throw d.i.fa("internal error")}},x.prototype.Mh=function(h,l){var s=new d.h;return this.g.D(h,s),h=new d.h,this.g.D(l,h),s.compare(h)},x}();d.ri=O}(Y||(Y={})),function(d){var O=new d.h,x=function(){function l(s,a,c,f,y){this.Pm=new d.h,this.Dk=new d.h,this.Pi=new d.h,this.g=s,this.Aw=c,this.no=f,this.Pm=a,this.yl=y,this.Dk.Rc(),this.Pi.Rc()}return l.prototype.xE=function(s){this.g.D(s,this.Dk),s=d.O.truncate((this.Dk.x-this.Pm.x)*this.no+.5);var a=d.O.truncate((this.Dk.y-this.Pm.y)*this.no+.5);return h.jG(s,a)},l.prototype.jz=function(s){return this.g.Pa(s,this.yl)},l.prototype.Py=function(s,a){return this.g.D(s,this.Dk),this.g.D(a,this.Pi),h.Cv(this.Dk.x,this.Dk.y,this.Pi.x,this.Pi.y,this.Aw)},l}();d.sY=function(){};var h=function(){function l(){this.Pm=new d.h,this.pq=[0,0,0,0],this.xs=[0,0,0,0],this.qo=this.yl=-1}return l.iQ=function(s,a){var c=new l;return c.g=s,c.qa=a,c.Aw=a*a,c.$v=2*a,c.no=1/c.$v,c.BO()},l.Cv=function(s,a,c,f,y){return(s-=c)*s+(a-=f)*a<=y},l.jG=function(s,a){return d.O.Th(a,d.O.Th(s))},l.prototype.DO=function(s,a){this.g.Gc(s,O);for(var c=(O.y-this.Pm.y)*this.no,f=d.O.truncate((O.x-this.Pm.x)*this.no),y=d.O.truncate(c),v=c=0;1>=v;v+=1)for(var _=0;1>=_;_+=1){var $=l.jG(f+v,y+_),I=this.xl.rR($);I!=-1&&(this.pq[c]=I,this.xs[c]=$,c++)}for(f=c-1;1<=f;f--)for(I=this.pq[f],y=f-1;0<=y;y--)if(I==this.pq[y]){this.xs[y]=-1,f!=--c&&(this.xs[f]=this.xs[c],this.pq[f]=this.pq[c]);break}for(y=0;y<c;y++)this.EO(s,this.xs[y],O,this.pq[y],a)},l.prototype.EO=function(s,a,c,f,y){for(var v=new d.h;f!=-1;f=this.xl.ER(f)){var _=this.xl.ja(f);s==_||a!=-1&&this.g.Pa(_,this.yl)!=a||(this.g.Gc(_,v),l.Cv(c.x,c.y,v.x,v.y,this.Aw)&&y.add(f))}},l.prototype.Xm=function(s,a,c){var f=this.g.Pa(s,this.qo),y=this.g.Pa(a,this.qo);return f==-1&&(f=this.zd.Ph(),this.zd.addElement(f,s),this.g.Ra(s,this.qo,f)),y==-1?this.zd.addElement(f,a):this.zd.Hy(f,y),this.g.Ra(a,this.qo,-2),a=this.YT(s,a),c&&(c=this.kw.xE(s),this.g.Ra(s,this.yl,c)),a},l.WT=function(s,a,c){s.Nb(a),c=s;var f=new d.h;l.XT(s.D(),a.D(),f),c.Cb(f)},l.XT=function(s,a,c){var f=s.x;s.x!=a.x&&(f=(1*s.x+1*a.x)/2);var y=s.y;s.y!=a.y&&(y=(1*s.y+1*a.y)/2),c.ma(f,y)},l.prototype.YT=function(s,a){var c=new d.h;this.g.D(s,c);var f=new d.h;this.g.D(a,f);var y=this.g.cG(s),v=y+(a=this.g.cG(a)),_=0,$=c.x;c.x!=f.x&&($=(c.x*y+f.x*a)/v,_++);var I=c.y;return c.y!=f.y&&(I=(c.y*y+f.y*a)/v,_++),0<_&&this.g.Cb(s,$,I),this.g.vX(s,v),_!=0},l.prototype.BO=function(){var s=this.g.fd,a=this.g.IF();for(this.Pm=a.mz(),a=Math.max(a.ca(),a.R())/2147483646,this.$v<a&&(this.$v=a,this.no=1/this.$v),this.zd=new d.au,this.zd.At(d.O.truncate(this.g.fd/3+1)),this.zd.fn(d.O.truncate(this.g.fd/3+1)),this.yl=this.g.Gd(),this.qo=this.g.Gd(),this.kw=new x(this.g,this.Pm,this.Aw,this.no,this.yl),this.xl=new d.dL(d.O.truncate(4*s/3),this.kw),this.xl.AW(this.g.fd),s=!1,a=this.g.ld;a!=-1;a=this.g.ue(a))for(var c=this.g.Ob(a);c!=-1;c=this.g.Rb(c))for(var f=this.g.Xa(c),y=0,v=this.g.Ja(c);y<v;y++){var _=this.kw.xE(f);this.g.Ra(f,this.yl,_),this.xl.addElement(f,_),f=this.g.U(f)}var $=new d.ia(0);for($.Jb(10),a=this.g.ld;a!=-1;a=this.g.ue(a))for(c=this.g.Ob(a);c!=-1;c=this.g.Rb(c))for(f=this.g.Xa(c),y=0,v=this.g.Ja(c);y<v;y++){if(this.g.Pa(f,this.qo)!=-2)for(_=this.g.Pa(f,this.yl),this.xl.jd(f,_);this.DO(f,$),$.size!=0;){_=!1;for(var I=0,k=$.size;I<k;I++){var A=$.get(I),P=this.xl.ja(A);this.xl.vd(A),_=this.Xm(f,P,I+1==k)||_}if(s=s||_,$.clear(!1),!_)break}f=this.g.U(f)}return s&&this.vN(),this.kw=this.xl=null,this.g.Td(this.yl),this.g.Td(this.qo),s},l.prototype.vN=function(){for(var s=new d.h,a=this.zd.je;a!=-1;a=this.zd.qz(a)){var c=this.zd.rc(a);for(this.g.D(this.zd.ja(c),s),c=this.zd.lb(c);c!=-1;c=this.zd.lb(c))this.g.mf(this.zd.ja(c),s)}},l}();d.Yt=h}(Y||(Y={})),function(d){var O=function(){function x(h){h===void 0&&(h=null),this.yg=null,this.Pb=!1,this.yg=h===null?[]:h}return x.prototype.copyTo=function(h){if(h.Pb)throw d.i.fa("CompositeGeographicTransformation is read-only");for(var l=0;l<this.yg.length;l++)h.yg.push(this.yg[l].Of())},x.prototype.count=function(){return this.yg.length},x.prototype.add=function(h){if(this.Pb)throw d.i.fa("CompositeGeographicTransformation is read-only");this.yg.push(h.Of())},x.prototype.clear=function(){if(this.Pb)throw d.i.fa("CompositeGeographicTransformation is read-only");this.yg.length=0},x.prototype.remove=function(h){if(this.Pb)throw d.i.fa("CompositeGeographicTransformation is read-only");this.yg.splice(h,1)},x.prototype.jg=function(){var h=new x;return this.copyTo(h),h},x.prototype.Of=function(){return this.jg()},x.prototype.transform=function(h,l,s,a){if(h.length<l)throw d.i.fa("invalid Argument");var c=s;for(s=0;s<this.yg.length;s++){var f=this.yg[s];if(f.qm()!=null){var y=f.Un,v=y?1:0,_=y?f.qm().getGeogcs2():f.qm().getGeogcs1();if(_=c/(_=_.getUnit().getUnitFactor()),3552713678800501e-30<Math.abs(_-1))for(c=0;c<l;c++)h[c][0]*=_,h[c][1]*=_;d.MC.geogToGeog(f.qm(),l,h,null,v),c=(y?f.qm().getGeogcs1():f.qm().getGeogcs2()).getUnit().getUnitFactor()}}if(_=c/a,3552713678800501e-30<Math.abs(_-1))for(c=0;c<l;c++)h[c][0]*=_,h[c][1]*=_;return l},x.prototype.Nb=function(h){if(h==this)return!0;if(!(h instanceof x)||this.yg.length!=h.yg.length)return!1;for(var l=0;l<this.yg.length;l++)if(!this.yg[l].Nb(h.yg[l]))return!1;return!0},x.prototype.ix=function(){this.Pb=!0},x.prototype.toString=function(){for(var h="CGT ("+this.count()+") ",l=0,s=this.count();l<s;++l)h+=this.yg[l].toString()+", ";return 200<h.length?h.substring(0,197)+"... ("+h.length.toString()+" characters)":h},x.create=function(){return new x},x}();d.wC=O}(Y||(Y={})),function(d){var O,x=Math.PI,h=2*Math.PI,l=Math.PI/2,s=function(){function f(){}return f.TO=function(y,v){var _=new f;return _.x=y,_.y=v,_.type=0,_.Uh=0,_},f.al=function(y){var v=new f;return v.x=y.x,v.y=y.y,v.type=0,v.Uh=0,v},f.SO=function(y){var v=new f;return v.x=y.x,v.y=y.y,v.type=y.type,v.Uh=y.Uh,v},f.Pd=function(y,v,_){var $=new f;return $.x=y.x+v*Math.cos(_),$.y=y.y+v*Math.sin(_),$.type=y.type,$.Uh=y.Uh,$},f.Pu=function(y,v){var _=new f;return _.x=.5*(y.x+v.x),_.y=.5*(y.y+v.y),_.type=y.type,_.Uh=y.Uh,_},f.TE=function(y,v){var _=new f;return _.x=y.x+.001*(v.x-y.x),_.y=y.y+.001*(v.y-y.y),_.type=y.type,_.Uh=y.Uh,_},f}(),a=function(){};(O=d.fL||(d.fL={}))[O.Round=0]="Round",O[O.Bevel=1]="Bevel",O[O.Miter=2]="Miter",O[O.Square=3]="Square";var c=function(){function f(y){this.NA=this.Yb=this.wg=null,this.nd=y}return f.V=function(y,v,_,$,I,k){if(y==null||1>y.Db())throw d.i.N();return v==0||y.B()?y:((k=new f(k)).ko=y,k.Ka=v,k.qa=I,k.Ki=_,k.CA=$,k.Rx())},f.prototype.eM=function(){var y=this.ko,v=y.ac(),_=y.wc(),$=new d.h;return $.uc(_,v),$.normalize(),$.Hv(),$.scale(this.Ka),v.add($),_.add($),$=y.Ia(),y.Dc(v),y.Qc(_),$},f.prototype.dM=function(){var y=this.ko;if(0<this.Ka&&this.Ki!=2){var v=new d.Da;return v.ad(y,!1),this.ko=v,this.Rx()}return(y=new d.Fh(y.$)).W(this.Ka,this.Ka),y},f.prototype.tJ=function(y,v,_,$){return(v.x-y.x)*($.x-_.x)+(v.y-y.y)*($.y-_.y)},f.prototype.fc=function(y,v){if(v===void 0)this.Yb.push(y),this.gf++;else if(this.gf==0)this.fc(y);else{var _=this.Bw,$=this.wg[v==0?_-1:v-1],I=this.wg[v],k=this.tJ($,I,this.Yb[this.gf-1],y);0<k?this.fc(y):0>k&&(0<this.tJ($,I,I,this.Yb[this.gf-1])?(I=this.wg[v==0?_-2:v==1?_-1:v-2],_=s.Pd($,this.Ka,Math.atan2($.y-I.y,$.x-I.x)-l),this.Yb[this.gf-1]=_,this.Ki==1||this.Ki==2?(_=s.Pu(_,$),this.fc(_),_=s.Pd($,this.Ka,this.Jv+l),($=s.Pu(_,$)).type|=256,this.fc($)):(_=s.Pd($,this.Ka,this.Jv+l)).type|=256,this.fc(_),this.fc(y,v)):(_=s.Pd(I,this.Ka,this.Jv+l),this.fc(_),this.Ki==1||this.Ki==2?(_=s.Pu(_,I),this.fc(_),_=s.Pd(I,this.Ka,this.aA-l),($=s.Pu(_,I)).type|=256,this.fc($)):(_=s.Pd(I,this.Ka,this.aA-l)).type|=256,this.fc(_)))}},f.prototype.mE=function(){var y,v=this.Bw;this.gf=0;var _=.5*this.qa,$=0,I=0;for(y=0;y<v;y++){var k=this.wg[y],A=y==0?this.wg[v-1]:this.wg[y-1],P=y==v-1?this.wg[0]:this.wg[y+1],D=A.x-k.x,j=A.y-k.y,B=P.x-k.x,q=P.y-k.y,z=Math.atan2(j,D),Z=Math.atan2(q,B);if(this.Jv=z,this.aA=Z,y==0&&($=z,I=Z),D=D*q-B*j,j=Z,Z<z&&(Z+=h),0<D*this.Ka)this.Ki==1||this.Ki==2?(z=s.Pd(k,this.Ka,z+l),this.fc(z),z=s.TE(k,z),this.fc(z),z=s.Pd(k,this.Ka,Z-l),(k=s.TE(k,z)).type|=256,this.fc(k),this.fc(z)):(D=.5*(Z-z),D=this.Ka/Math.abs(Math.sin(D)),z=s.Pd(k,D,.5*(z+Z)),this.fc(z,y));else if(512&k.type){for(D=1-_/Math.abs(this.Ka),A=1,P=0>this.Ka?-x:x,-1<D&&1>D&&(.017453292519943295>(j=2*Math.acos(D))&&(j=.017453292519943295),1<(A=d.O.truncate(x/j+1.5))&&(P/=A)),j=z+l,z=s.Pd(k,this.Ka,j),y==0&&(z.type|=1024),this.fc(z,y),D=this.Ka/Math.cos(P/2),j+=P/2,(z=s.Pd(k,D,j)).type|=1024,this.fc(z);0<--A;)j+=P,(z=s.Pd(k,D,j)).type|=1024,this.fc(z);(z=s.Pd(k,this.Ka,Z-l)).type|=1024,this.fc(z)}else if(this.Ki==1)z=s.Pd(k,this.Ka,z+l),this.fc(z,y),z=s.Pd(k,this.Ka,Z-l),this.fc(z);else if(this.Ki==0)for(D=1-_/Math.abs(this.Ka),A=1,P=Z-l-(z+l),-1<D&&1>D&&(.017453292519943295>(j=2*Math.acos(D))&&(j=.017453292519943295),1<(A=d.O.truncate(Math.abs(P)/j+1.5))&&(P/=A)),D=this.Ka/Math.cos(.5*P),j=z+l+.5*P,z=s.Pd(k,D,j),this.fc(z,y);0<--A;)j+=P,z=s.Pd(k,D,j),this.fc(z);else this.Ki==2?(D=A.x-k.x,j=A.y-k.y,.99999999<(A=(D*(B=P.x-k.x)+j*(q=P.y-k.y))/Math.sqrt(D*D+j*j)/Math.sqrt(B*B+q*q))?(z=s.Pd(k,1.4142135623730951*this.Ka,Z-.25*x),this.fc(z,y),z=s.Pd(k,1.4142135623730951*this.Ka,Z+.25*x),this.fc(z)):(A=Math.abs(this.Ka/Math.sin(.5*Math.acos(A))))>(P=Math.abs(this.CA*this.Ka))?(D=.5*(Z-z),D=this.Ka/Math.abs(Math.sin(D)),z=s.Pd(k,D,.5*(z+Z)),Z=d.h.construct(z.x,z.y),z=d.h.construct(k.x,k.y),(k=new d.h).uc(Z,z),(Z=new d.h).HW(P/k.length(),k,z),z=(A-P)*Math.abs(this.Ka)/Math.sqrt(A*A-this.Ka*this.Ka),0<this.Ka?k.Hv():k.ar(),k.scale(z/k.length()),(z=new d.h).add(Z,k),(A=new d.h).uc(Z,k),z=s.al(z),this.fc(z,y),z=s.al(A),this.fc(z)):(D=.5*(Z-z),D=this.Ka/Math.abs(Math.sin(D)),z=s.Pd(k,D,.5*(z+Z)),this.fc(z,y))):(Z=j,0<this.Ka?(Z>z&&(Z-=h),A=z-Z<l):(Z<z&&(Z+=h),A=Z-z<l),A?(j=0>(D=1.4142135623730951*this.Ka)?z+.25*x:z+.75*x,z=s.Pd(k,D,j),this.fc(z,y),j=0>D?Z-.25*x:Z-.75*x,z=s.Pd(k,D,j),this.fc(z)):(D=.5*(Z-z),D=this.Ka/Math.abs(Math.sin(D)),Z<z&&(Z+=h),z=s.Pd(k,D,(z+Z)/2),this.fc(z,y)))}return this.Jv=$,this.aA=I,this.fc(this.Yb[0],0),k=s.SO(this.Yb[this.gf-1]),this.Yb[0]=k,this.wW()},f.prototype.Au=function(y,v){if(!(2>v))for(var _=0;_<v;_++){var $=this.Yb[y+_];_!=0?this.NA.Ci(d.h.construct($.x,$.y)):this.NA.Lt(d.h.construct($.x,$.y))}},f.prototype.fM=function(y,v,_){var $=y.Ba(v),I=y.Vc(v);if(this.Yb=[],this.NA=_,y.dc(v)){for(v=y.Na($);y.Na(I-1).qb(v);)I--;if(2<=I-$){for(this.Bw=I-$,this.wg=[],v=$;v<I;v++)this.wg.push(s.al(y.Na(v)));this.mE()&&this.Au(0,this.gf-1)}}else{for(v=y.Na($);$<I&&y.Na($+1).qb(v);)$++;for(v=y.Na(I-1);$<I&&y.Na(I-2).qb(v);)I--;if(2<=I-$){for(this.Bw=2*(I-$)-2,this.wg=[],(_=s.al(y.Na($))).type|=1536,this.wg.push(_),v=$+1;v<I-1;v++)_=s.al(y.Na(v)),this.wg.push(_);for((_=s.al(y.Na(I-1))).type|=512,this.wg.push(_),v=I-2;v>=$+1;v--)(_=s.al(y.Na(v))).type|=1024,this.wg.push(_);if(this.mE())if(2<=this.Yb.length){for(y=-1,(I=!!(1024&this.Yb[this.gf-1].type))||(y=0),v=1;v<this.gf;v++)($=!!(1024&this.Yb[v].type))?I||1<(I=v-1)-y+1&&this.Au(y,I-y+1):I&&(y=v-1),I=$;I||1<(I=this.gf-1)-y+1&&this.Au(y,I-y+1)}else y=0,I=this.gf-1,0<=y&&1<=I-y&&this.Au(y,I-y+1)}}this.wg=null,this.Bw=0,this.Yb=null,this.gf=0},f.prototype.wW=function(){for(var y=!1,v=0;v<this.gf;v++){var _=this.Yb[v];_.qh=v+1,_.sh=v-1,this.Yb[v]=_}for((_=this.Yb[0]).sh=this.gf-2,this.Yb[0]=_,(_=this.Yb[this.gf-2]).qh=0,this.Yb[this.gf-2]=_,v=_=0;v<this.gf;v++)if(256&this.Yb[_].type){var $=this.GP(_);if($==-1){y=!0;break}_=$}else _=this.Yb[_].qh;return!y&&(this.QO(_),!0)},f.prototype.GP=function(y){for(var v,_,$=this.gf-1,I=y,k=1;k<=$-2;k++){v=I=this.Yb[I].qh,_=y;for(var A=1;A<=k;A++){if(_=this.Yb[_].sh,!(256&this.Yb[_].type||256&this.Yb[v].type)){var P=this.gS(_,v);if(P!=-1)return P}v=this.Yb[v].sh}}return-1},f.prototype.gS=function(y,v){var _=this.Yb[this.Yb[y].sh],$=this.Yb[y],I=this.Yb[this.Yb[v].sh],k=this.Yb[v];if(!this.JW(_,$,I,k))return-1;var A=new a;return this.xQ(_,$,I,k,A)&&!A.bE&&d.O.bK(($.x-_.x)*(k.y-I.y)-($.y-_.y)*(k.x-I.x))!=d.O.bK(this.Ka)?(_=this.Yb[y].sh,A.an.type=$.type,A.an.qh=v,A.an.sh=_,this.Yb[y]=A.an,A.an=this.Yb[v],A.an.sh=y,this.Yb[v]=A.an,v):-1},f.prototype.JW=function(y,v,_,$){return Math.max(y.x,v.x)>=Math.min(_.x,$.x)&&Math.max(_.x,$.x)>=Math.min(y.x,v.x)&&Math.max(y.y,v.y)>=Math.min(_.y,$.y)&&Math.max(_.y,$.y)>=Math.min(y.y,v.y)},f.prototype.xQ=function(y,v,_,$,I){I.bE=!1;var k=(v.y-y.y)*($.x-_.x)-(v.x-y.x)*($.y-_.y),A=(_.y-y.y)*(v.x-y.x)-(_.x-y.x)*(v.y-y.y);if(0<=(k=k==0?2:A/k)&&1>=k){var P=k;if(k=($.y-_.y)*(v.x-y.x)-($.x-_.x)*(v.y-y.y),A=(y.y-_.y)*($.x-_.x)-(y.x-_.x)*($.y-_.y),0<=(k=k==0?2:A/k)&&1>=k)return I.an=s.TO(y.x+k*(v.x-y.x),y.y+k*(v.y-y.y)),I.an.Uh=_.Uh+P*($.Uh-_.Uh),P!=0&&P!=1||k!=0&&k!=1||(I.bE=!0),I.VY=k,I.WY=P,!((P==0||P==1)&&0<k&&1>k||(k==0||k==1)&&0<P&&1>P)}return!1},f.prototype.QO=function(y){for(;this.Yb[y].sh<y;)y=this.Yb[y].sh;var v=0,_=y;do _=this.Yb[_],this.Yb[v]=_,_=_.qh,v++;while(_!=y);this.Yb[v]=this.Yb[0],this.gf=v+1},f.prototype.$C=function(y){var v=this.ko,_=v.Ga();if(_!=null){_.Zi();for(var $=-1;_.$a();)$++,this.fM(v,$,y)}},f.prototype.Rx=function(){var y=this.ko.getType();return y==322?this.eM():y==197?this.dM():d.aa.yd(y)?((y=new d.Ta).oc(this.ko,!0),this.ko=y,this.Rx()):y==1607?(y=new d.Ta,this.$C(y),y):y==1736?(y=new d.Da,this.$C(y),y):null},f}();d.IK=c}(Y||(Y={})),function(d){var O=function(){function s(a){this.qk=a}return s.prototype.D=function(a,c){this.qk.g.D(a,c)},s.prototype.vd=function(a){var c=this.qk.Fa.ja(a);this.qk.Fa.vd(a,-1),this.qk.g.pd(c,!1)},s}(),x=function(){function s(a){this.qk=a}return s.prototype.D=function(a,c){this.qk.IT.D(a,c)},s.prototype.vd=function(a){this.qk.Fa.vd(a,-1)},s}(),h=function(){function s(a){this.qk=a}return s.prototype.D=function(a,c){c.L(this.qk.LT[a])},s.prototype.vd=function(a){this.qk.Fa.vd(a,-1)},s}(),l=function(){function s(a){a===void 0?(this.Fa=new d.Yj,this.Fa.De(20),this.g=new d.gd,this.xT=this.g.Ig(550),this.Ss=this.g.vf(this.xT,-1),this.Xh=new O(this)):a instanceof Array?(this.Fa=new d.Yj,this.Fa.De(20),this.LT=a,this.Xh=new h(this)):(this.Fa=new d.Yj,this.Fa.De(20),this.IT=a,this.Xh=new x(this))}return s.prototype.Ib=function(a){var c=a.getType();if(d.Gx.xj(c))this.jN(a);else if(d.Vk.yd(c))this.oN(a);else if(c==197)this.gN(a);else{if(c!=33)throw d.i.N("invalid shape type");this.nN(a)}},s.prototype.cR=function(){var a=new d.Sa,c=this.Fa.rc(-1),f=new d.Da(this.g.ht);for(this.g.Vi(this.Fa.ja(c),a),f.nf(a),c=this.Fa.lb(c);c!=-1;c=this.Fa.lb(c))this.g.Vi(this.Fa.ja(c),a),f.lineTo(a);return f},s.RO=function(a){var c=new s(a),f=a.I(),y=1,v=new d.h,_=new d.h,$=new d.h;for(a.D(0,v);a.D(y,_),_.Rz(v)&&y<f-1;)y++;for(c.Fa.addElement(0,-1),c.Fa.xn(y),f=y+1;f<a.I();f++)a.D(f,$),(y=c.pC($))!=-1&&c.Fa.Sj(y,f);for($=new d.Sa,y=c.Fa.rc(-1),f=new d.Da(a.description),a.ve(c.Fa.ja(y),$),f.nf($),y=c.Fa.lb(y);y!=-1;y=c.Fa.lb(y))a.ve(c.Fa.ja(y),$),f.lineTo($);return f},s.construct=function(a,c,f){for(var y=new s(a),v=1,_=a[0];a[v].Rz(_)&&v<c-1;)v++;for(y.Fa.addElement(0,-1),y.Fa.xn(v),v+=1;v<c;v++)(_=y.pC(a[v]))!=-1&&y.Fa.Sj(_,v);for(a=0,c=y.Fa.rc(-1);c!=-1;c=y.Fa.lb(c))f[a++]=y.Fa.ja(c);return a},s.JG=function(a,c){var f=a.Ba(c),y=a.Vc(c);if(c=!a.dc(c)&&a.Nn(c),a=a.ub(0),y*=2,c&&(y-=2),6>y-(f*=2))return!0;c=new d.h;var v=new d.h,_=new d.h;a.tc(f,c),a.tc(f+2,v),a.tc(f+4,_);var $=s.Wu(v,_,c);if($.ps()||!s.um($.value()))return!1;var I=d.h.construct(v.x,v.y),k=new d.h;for(f+=6;f<y;f+=2)if(k.L(v),v.L(_),a.tc(f,_),($=s.Wu(v,_,c)).ps()||!s.um($.value())||($=s.Wu(I,_,c)).ps()||!s.um($.value())||($=s.Wu(v,_,k)).ps()||!s.um($.value()))return!1;return!0},s.prototype.jN=function(a){for(var c=new d.Sa,f=new d.h,y=0;y<a.I();y++){a.D(y,f);var v=this.Cr(f);if(v!=-1){a.ve(y,c);var _=this.g.fc(this.Ss,c);this.Fa.Sj(v,_)}}},s.prototype.gN=function(a){for(var c=new d.Sa,f=new d.h,y=0;4>y;y++){a.mB(y,f);var v=this.Cr(f);if(v!=-1){a.Hf(y,c);var _=this.g.fc(this.Ss,c);this.Fa.Sj(v,_)}}},s.prototype.oN=function(a){var c=new d.Sa,f=a.ac();if((f=this.Cr(f))!=-1){a.To(c);var y=this.g.fc(this.Ss,c);this.Fa.Sj(f,y)}f=a.wc(),(f=this.Cr(f))!=-1&&(a.Po(c),a=this.g.fc(this.Ss,c),this.Fa.Sj(f,a))},s.prototype.nN=function(a){var c=a.D();(c=this.Cr(c))!=-1&&(a=this.g.fc(this.Ss,a),this.Fa.Sj(c,a))},s.prototype.Cr=function(a){var c=-1;if(this.Fa.size(-1)==0)return this.Fa.addElement(-4,-1);if(this.Fa.size(-1)==1){var f=this.g.Na(this.Fa.ja(this.Fa.rc(-1)));return a.Rz(f)||(c=this.Fa.xn(-5)),c}return this.pC(a)},s.prototype.pC=function(a){var c=-1;do{var f=this.Fa.rc(-1),y=this.Fa.Fc(-1),v=this.Fa.ja(f),_=this.Fa.ja(y),$=new d.h,I=new d.h;if(this.Xh.D(v,$),this.Xh.D(_,I),v=d.h.Uq(I,a,$),s.um(v))c=this.Fa.xn(-1),($=this.nC(a,y,f))!=f&&this.oC(a,f,this.Fa.we($));else if(s.CG(v)){I=this.Fa.sv(-1);var k=this.Fa.rc(-1),A=this.Fa.Fc(-1);for(v=new d.h,_=new d.h;k!=this.Fa.we(A);){var P=this.Fa.ja(I);this.Xh.D(P,v),P=d.h.Uq(v,a,$),s.CG(P)?(A=I,I=this.Fa.ll(I)):(k=I,I=this.Fa.Xp(I))}if(I=A,$=k,P=this.Fa.ja(I),k=this.Fa.ja($),this.Xh.D(P,v),this.Xh.D(k,_),$!=f&&(v=d.h.Uq(_,a,v),!s.um(v)))continue;c=this.Fa.zu($,I,-2,!1),this.oC(a,I,y),this.nC(a,$,f)}else this.sb==null&&(this.sb=new d.yb),this.sb.Dc(I),this.sb.Qc($),0>($=this.sb.fe(a,!0))?($=this.Fa.we(y),this.Fa.vd(y,-1),c=this.Fa.xn(-3),this.nC(a,$,f)):1<$&&($=this.Fa.lb(f),this.Fa.vd(f,-1),c=this.Fa.zu(-1,$,-3,!1),this.oC(a,$,y))}while(!1);return c},s.prototype.oC=function(a,c,f){if(c!=f){var y=this.Fa.ja(c),v=this.Fa.lb(c),_=new d.h,$=new d.h;for(this.Xh.D(y,_);c!=f&&2<this.Fa.size(-1)&&(this.Xh.D(this.Fa.ja(v),$),y=d.h.Uq($,a,_),!s.um(y));)y=c,c=v,_.L($),v=this.Fa.lb(c),this.Xh.vd(y)}},s.prototype.nC=function(a,c,f){if(c==f)return f;var y=this.Fa.ja(c),v=this.Fa.we(c),_=new d.h,$=new d.h;for(this.Xh.D(y,_);c!=f&&2<this.Fa.size(-1)&&(this.Xh.D(this.Fa.ja(v),$),y=d.h.Uq(_,a,$),!s.um(y));)y=c,c=v,_.L($),v=this.Fa.we(c),this.Xh.vd(y);return c},s.Wu=function(a,c,f){var y=new d.Wb;y.set(c.x),y.sub(a.x);var v=new d.Wb;v.set(f.y),v.sub(a.y);var _=new d.Wb;return _.set(c.y),_.sub(a.y),(c=new d.Wb).set(f.x),c.sub(a.x),y.Ag(v),_.Ag(c),y.sub(_),y},s.um=function(a){return 0>a},s.CG=function(a){return 0<a},s}();d.Zt=l}(Y||(Y={})),function(d){var O=function(){function x(h){this.g=null,this.tH=!0,this.nd=h}return x.zU=function(h,l,s){return h=d.ta.Er(h),d.Yt.Cv(l.Lg(),l.ih(),s.Lg(),s.ih(),d.lc.ox(h))},x.CO=function(h,l){var s=new d.Sa;return d.Yt.WT(h,l,s),s},x.V=function(h,l,s,a){return(s=new x(s)).g=h,s.qa=l,s.tH=a,s.EM()},x.prototype.nM=function(h){return d.Yt.iQ(this.g,h)},x.prototype.sM=function(h){return d.$t.V(this.g,h,this.nd)},x.prototype.EM=function(){var h=this.qa,l=d.ta.Er(h),s=1.00001*(h=d.ta.rN(h));h*=1.000001;for(var a=!1,c=30<this.g.fd+10?1e3:(this.g.fd+10)*(this.g.fd+10),f=0,y=this.g.jS();;f++){if(f>c)throw d.i.fa("Internal Error: max number of iterations exceeded");var v=this.nM(l);if(a=a||v,this.tH&&(v=this.g.Gp(l,!0,!1)!=0,a=a||v),v=!1,(f==0||y||d.$t.kI(!0,this.g,h,null,this.nd))&&(v=this.sM(s),a=a||v),!v)break;d.mp.zp(this.nd)}return a},x}();d.Tk=O}(Y||(Y={})),function(d){var O=function(){function h(l){this.$d=this.Mc=null,this.Ys=0,this.Ub=l,this.cA=!0}return h.prototype.uv=function(l,s){var a=this.g.bc(l);if(a==null){if(!this.g.ed(l,s))return null;a=s}return a},h.prototype.Xq=function(){var l;l===void 0&&(l=!1),this.Ys++,!l&&4095&this.Ys||(this.Ys=0,d.mp.zp(this.Ub))},h.prototype.nP=function(){var l=this.g.Yq(!1),s=!1,a=new d.yb,c=new d.yb,f=new d.l;f.Oa();var y=new d.l;y.Oa();for(var v=new d.Sa,_=new d.TC,$=l.next();$!=-1;$=l.next()){d.mp.zp(this.Ub);var I=null,k=!1;if(!d.aa.Rn(this.g.ic(l.ck))){if((I=this.uv($,a))==null)continue;if(I.A(f),f.W(this.qa,this.qa),I.Bi(this.qa)){if(!I.Bi(0))continue;k=!0,I=null}}var A=this.g.Yq(l),P=A.next();for(P!=-1&&(P=A.next());P!=-1;P=A.next()){var D=null,j=!1;if(!d.aa.Rn(this.g.ic(A.ck))){if((D=this.uv(P,c))==null)continue;if(D.A(y),D.Bi(this.qa)){if(!D.Bi(0))continue;j=!0,D=null}}var B=0,q=0;if(I!=null&&D!=null)f.HG(y)&&(_.Oo(I),_.Oo(D),_.Ea(this.qa,!1),0<(B=_.ol(0))+(q=_.ol(1))&&(this.g.jr($,_,0,!0),this.g.jr(P,_,1,!0)),_.clear());else if(I!=null){var z=new d.h;if(this.g.D(P,z),f.contains(z)){if(_.Oo(I),this.g.Vi(P,v),_.Kz(this.qa,v,!1),0<(B=_.ol(0)))if(this.g.jr($,_,0,!0),j){for(j=-1,z=this.g.U(P);z!=-1&&z!=P&&(j=z,(D=this.uv(z,c))!=null&&D.Bi(0));z=this.g.U(z));for(z=P;z!=-1&&(this.g.Dh(z,_.Bf),z!=j);z=this.g.U(z));}else this.g.Dh(P,_.Bf);_.clear()}}else{if(D==null)continue;if(z=new d.h,this.g.D($,z),y.W(this.qa,this.qa),y.contains(z)){if(_.Oo(D),this.g.Vi($,v),_.Kz(this.qa,v,!1),0<(q=_.ol(0)))if(this.g.jr(P,_,0,!0),k){for(j=-1,z=this.g.U($);z!=-1&&z!=$&&(j=z,(D=this.uv(z,c))!=null&&D.Bi(0));z=this.g.U(z));for(z=$;z!=-1&&(this.g.Dh(z,_.Bf),z!=j);z=this.g.U(z));}else this.g.Dh($,_.Bf);_.clear()}}if(B+q!=0){if(B!=0){if((I=this.g.bc($))==null){if(!this.g.ed($,a))continue;I=a,a.A(f)}else I.A(f);if(I.Bi(this.qa))break}s=!0}}}return s},h.prototype.oP=function(){return this.QU()},h.prototype.QU=function(){return new d.RC().PX(this.g,this.qa)},h.prototype.lI=function(){var l=!1;this.Mc==null&&(this.Mc=new d.Yj);var s=new d.ia(0);s.Jb(this.g.fd+1);for(var a=this.g.Yq(),c=a.next();c!=-1;c=a.next())s.add(c);this.g.nx(s,s.size),s.add(-1),a=this.g.Gd(),c=this.g.Gd(),this.$d=new d.UC(this.g,this.qa,!this.cA),this.Mc.Vo(this.$d);var f=new d.ia(0),y=new d.ia(0),v=0;new d.h;var _=this.g.td;this.g.vb.mc();for(var $,I,k=this.g.vb.za[0].o,A=s.get(v++);A!=-1;){var P=$=k[2*(I=_.T(A,0))],D=I=k[2*I+1];do{var j=_.T(A,2),B=_.T(A,1);if(j!=-1){var q=_.T(j,0),z=k[2*q];0>(D<(q=k[2*q+1])?-1:D>q?1:P<z?-1:P>z?1:0)&&(y.add(A),y.add(j))}B!=-1&&(z=k[2*(q=_.T(B,0))],0>(D<(q=k[2*q+1])?-1:D>q?1:P<z?-1:P>z?1:0)&&(y.add(B),y.add(B))),(z=this.g.Pa(A,a))!=-1&&(f.add(z),this.g.Ra(A,a,-1)),(z=this.g.Pa(A,c))!=-1&&(f.add(z),this.g.Ra(A,c,-1)),(A=s.get(v++))!==-1&&(P=k[2*(D=_.T(A,0))],D=k[2*D+1])}while(A!=-1&&P===$&&D===I);for(P=f.size==1&&y.size==2,z=D=-1,j=0,B=f.size;j<B;j++){q=f.get(j);var Z=this.Mc.we(q);if(Z==-1||f.hG(Z)||(D=Z),(q=this.Mc.lb(q))==-1||f.hG(q)||(z=q),D!=-1&&z!=-1)break}for(this.$d.$J(I,$),j=0,B=f.size;j<B;j++)q=f.get(j),this.Mc.vd(q,-1);if(f.clear(!1),!P&&D!=-1&&z!=-1&&this.qO(D,z)){l=!0,this.Ni=this.$d.rm();break}for(j=0,B=y.size;j<B;j+=2){if(I=y.get(j),$=y.get(j+1),P?(I=this.Mc.zu(D,z,I,!0),P=!1):I=this.Mc.addElement(I,-1),this.$d.rg){this.Ni=this.$d.rm(),l=!0;break}this.g.Pa($,a)==-1?this.g.Ra($,a,I):this.g.Ra($,c,I)}if(l)break;y.Bh(0)}return this.g.Td(a),this.g.Td(c),l},h.prototype.qO=function(l,s){return this.$d.compare(this.Mc,this.Mc.ja(l),s),l=this.$d.rg,this.$d.Kr(),l},h.yE=function(l){for(var s=l.ld;s!=-1;s=l.ue(s))if(d.aa.Hc(l.ic(s)))return!0;return!1},h.fQ=function(l,s,a,c){return!!h.yE(l)&&((s=new h(c)).g=l,s.qa=a,15>l.fd?l=s.nP():s.oP())},h.V=function(l,s,a){return h.fQ(l,l.IF(),s,a)},h.kI=function(l,s,a,c,f){if(!h.yE(s))return!1;var y=new h(f);if(y.g=s,y.qa=a,y.cA=l,y.lI())return c!=null&&c.Wt(y.Ni),!0;var v=new d.Dd;return v.$B(),s.Oc(v),(y=new h(f)).g=s,y.qa=a,y.cA=l,l=y.lI(),v.$B(),s.Oc(v),!!l&&(c!=null&&c.Wt(y.Ni),!0)},h.Ml=function(l,s){return!(16>(l=l.I()))&&2*l+Math.log(l)*Math.LOG10E/Math.log(2)*s<1*l*s},h.lP=function(l,s,a,c){var f=s.getType();if(d.aa.Hc(f))return new h(c).mP(l,s,a);throw d.i.fa("crack_A_with_B")},h.prototype.mP=function(l,s,a){var c=new d.l;l.xc(c);var f=new d.l;if(s.xc(f),f.W(a,a),!f.isIntersecting(c))return l;var y=l.Bb,v=null;y!=null&&(v=y.Fb),h.Ml(l,l.I())&&(v=d.ta.jj(l,f));var _=v!=null?v.getIterator():null,$=s.Ga();s=l.Ga();var I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(f=[];$.$a();)for(;$.Ha();){var k=$.ha();if(v!=null){for(_.Uo(k,a),y=_.next();y!=-1;y=_.next())if(this.Xq(),s.Vb(v.ja(y),-1),s.Ha()){var A=(y=s.ha()).Ea(k,null,I,null,a);for(y=0;y<A;++y){var P=I[y];if(P!=0&&P!=1){var D=s.wb(),j=new x;j.t=P,j.index=D,f.push(j)}}}}else{var B=new d.l;if(k.xc(B),B.W(a,a),c.isIntersecting(B)){for(s.Zi();s.$a();)for(;s.Ha();)if(this.Xq(),y=s.ha(),P=new d.l,y.xc(P),P.isIntersecting(B))for(A=y.Ea(k,null,I,null,a),y=0;y<A;++y)(P=I[y])!=0&&P!=1&&(D=s.wb(),(j=new x).t=P,j.index=D,f.push(j))}}}if(f.length==0)return l;for(f=f.sort(x.Ey),l=l.Ia(),s.Zi();s.$a()&&!s.Ha(););for(a=s.ha(),c=new d.ig,v=-1,y=0,_=f.length;y<_;){for(I=f[y].index,$=y+1;$<_&&f[$].index==I;)++$;for(;s.wb()<I;){if(this.Xq(),k=s.Ha(),P=s.gb,(B=k||!s.On()||s.Pn())&&l.oc(a,v!=P),v=P,!k)for(;s.$a()&&!s.Ha(););a=s.ha()}for(I=0;y<$;y++)(P=f[y].t)!=I&&(a.ah(I,P,c),I=P,P=s.gb,l.oc(c.get(),v!=P),v=P);if((B=(k=s.Ha())||!s.On()||s.Pn())&&(a.ah(I,1,c),l.oc(c.get(),!1)),k)a=s.ha();else{for(;s.$a()&&!s.Ha(););a=s.Ha()?s.ha():null}y=$}for(a!=null&&(P=s.gb,(B=(k=s.Ha())||!s.On()||s.Pn())&&l.oc(a,v!=P),v=P),k=s.Ha();;){if(!k){for(;s.$a()&&!(k=s.Ha()););if(!k)break}a=s.ha(),P=s.gb,(B=(k=s.Ha())||!s.On()||s.Pn())&&l.oc(a,v!=P),v=P}return l},h}();d.$t=O;var x=function(){function h(){}return h.Ey=function(l,s){return l.index==s.index?l.t>s.t?1:l.t<s.t?-1:0:l.index>s.index?1:-1},h}()}(Y||(Y={})),function(d){var O;(O=d.KK||(d.KK={}))[O.Left=0]="Left",O[O.Right=1]="Right",O[O.Coincident=2]="Coincident",O[O.Undefined=3]="Undefined",O[O.Uncut=4]="Uncut";var x=function(s,a,c,f,y,v,_,$,I,k,A){this.X=s,this.bt=a,this.Ns=c,this.tg=f,this.Lm=k,this.Al=A};d.uY=x;var h=function(){function s(a,c){this.JH=a,this.Hi=c}return s.prototype.qM=function(a,c){var f=new d.h;this.Hi.D(a,f);var y=new d.h;return this.Hi.D(c,y),(f=f.compare(y))!=0?f:(a=this.Hi.Pa(a,this.JH))<(c=this.Hi.Pa(c,this.JH))?-1:a==c?0:1},s}(),l=function(s,a,c,f,y,v,_,$,I){this.tg=s,this.Ns=a,this.OA=c,this.UH=f,this.Ei=y,this.Al=v,this.Lm=_,this.VH=$,this.OT=I};d.tY=l,d.LK=function(){function s(){}return s.JK=function(a,c,f,y,v,_){if(c.B())a=new x(c,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1),v.push(a);else if(f.B())a=new x(c,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1),v.push(a);else{var $=new d.gd;if($.Ib(c),$.Ib(f),d.Tk.V($,y,_,!0),$.fd==0)a=new x(c.Ia(),4,-1,-1,NaN,4,-1,-1,NaN,-1,-1),v.push(a);else{for(c=0,f=$.Gd(),y=$.ld;y!=-1;y=$.ue(y))for(_=$.Ob(y);_!=-1;_=$.Rb(_))for(var I=$.Xa(_),k=0,A=$.Ja(_);k<A;I=$.U(I),k++)$.Ra(I,f,c++);c=s.HM(f,$),s.cM(a,c,$,v)}}},s.HM=function(a,c){for(var f=c.fd,y=new d.ia(0),v=c.ld;v!=-1;v=c.ue(v))for(var _=c.Ob(v);_!=-1;_=c.Rb(_))for(var $=c.Xa(_),I=0,k=c.Ja(_);I<k;$=c.U($),I++)y.add($);var A=new h(a,c);y.Vd(0,f,function(xe,_e){return A.qM(xe,_e)}),a=[];var P=[],D=c.Gd(),j=c.Gd();v=c.ld,_=c.ue(v),k=new d.h;var B=new d.h,q=y.get(0),z=c.bd(q),Z=c.Qf(z);c.D(q,k);var ee=1;for($=0;ee<f-1;){var Q=!1;for(I=ee;I<f;I++)if(I!=$){var le=y.get(I),se=c.bd(le),ve=c.Qf(se);if(c.D(le,B),!k.qb(B))break;Z==v&&ve==_&&(Q=s.uM(D,j,c,a,P,z,q,se,le))}if(Q||$==ee-1){if(Q&&$==ee-1&&ee--,++$==f)break;q=y.get($),z=c.bd(q),Z=c.Qf(z),c.D(q,k)}Q||(ee=$+1)}for(f=[],v=c.ld;v!=-1;v=c.ue(v))for(_=c.Ob(v);_!=-1;_=c.Rb(_))for(y=c.Xa(_),I=0,k=c.Ja(_);I<k;y=c.U(y),I++){if(0<=($=c.Pa(y,j)))for(;$<P.length&&P[$].tg==y;)f.push(P[$++]);if(0<=($=c.Pa(y,D)))for(;$<a.length&&a[$].tg==y;)f.push(a[$++])}return c.Td(D),c.Td(j),f},s.uM=function(a,c,f,y,v,_,$,I,k){var A=f.rj(_),P=f.rj(I),D=f.Xa(_),j=f.Xa(I),B=f.Ma($),q=f.Ma(k),z=!1,Z=!1,ee=!1,Q=!1;return $!=D&&(k!=j&&(z=s.vM(a,f,y,_,B,I,q)),k!=P&&(Z=s.wM(a,f,y,_,B,I,k))),$!=A&&(k!=j&&(ee=s.xM(c,f,v,_,$,I,q,D)),k!=P&&(Q=s.yM(c,f,v,_,$,I,k,D))),z&&Z&&ee?(a=y.length-1,v[Q?v.length-2:v.length-1].Ei==2&&(y[a-1]=y[a],--y.length)):z&&Z&&Q&&v[v.length-1].Ei==2&&(v=y[y.length-1],--y.length,f.Pa(v.tg,a)==y.length&&f.Ra(v.tg,a,-1)),z||Z||ee||Q},s.vM=function(a,c,f,y,v,_,$){var I=new d.yb,k=new d.yb,A=[0,0],P=[0,0],D=c.bc(v);return D==null&&(c.ed(v,I),D=I),(I=c.bc($))==null&&(c.ed($,k),I=k),2>(D=D.Ea(I,null,A,P,0))&&(y=new l(v,y,A[0],NaN,D,$,_,P[0],NaN),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1)),!0},s.wM=function(a,c,f,y,v,_,$){var I=new d.yb,k=new d.yb,A=[0,0],P=[0,0],D=c.bc(v);return D==null&&(c.ed(v,I),D=I),(I=c.bc($))==null&&(c.ed($,k),I=k),2>(D=D.Ea(I,null,A,P,0))&&(y=new l(v,y,A[0],NaN,D,$,_,P[0],NaN),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1),!0)},s.xM=function(a,c,f,y,v,_,$,I){var k=new d.yb,A=new d.yb,P=[0,0],D=[0,0],j=c.bc(v);return j==null&&(c.ed(v,k),j=k),(k=c.bc($))==null&&(c.ed($,A),k=A),(j=j.Ea(k,null,P,D,0))==2?(y=new l(v,y,P[0],P[1],j,$,_,D[0],D[1]),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1),!0):(A=!1,v==I&&(y=new l(v,y,P[0],NaN,j,$,_,D[0],NaN),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1),A=!0),A)},s.yM=function(a,c,f,y,v,_,$,I){var k=new d.yb,A=new d.yb,P=[0,0],D=[0,0],j=c.bc(v);return j==null&&(c.ed(v,k),j=k),(k=c.bc($))==null&&(c.ed($,A),k=A),(j=j.Ea(k,null,P,D,0))==2?(y=new l(v,y,P[0],P[1],j,$,_,D[0],D[1]),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1),!0):(A=!1,v==I&&(y=new l(v,y,P[0],NaN,j,$,_,D[0],NaN),f.push(y),0>(y=c.Pa(v,a))&&c.Ra(v,a,f.length-1),A=!0),A)},s.cM=function(a,c,f,y){var v=[];v[0]=new d.h,v[1]=new d.h,v[2]=new d.h,v[3]=new d.h;var _=new d.h,$=new d.h,I=new d.h,k=new d.h,A=null;y!=null&&(A=new d.ig).Or();var P=0,D=null,j=new d.yb;new d.yb;for(var B=f.Ob(f.ld);B!=-1;B=f.Rb(B)){for(var q=4,z=-1,Z=-1,ee=-1,Q=-1,le=NaN,se=!0,ve=!1,xe=!0,_e=!0,je=!0,Ae=0,st=B,it=0,Ne=f.Xa(B),xi=f.Ja(B),Vr=0;Vr<xi;Ne=f.U(Ne),Vr++){var Ci=f.bc(Ne);if(Ci==null){if(!f.ed(Ne,j))continue;Ci=j}Z==-1&&(Z=Ne);for(var Jt=0;P<c.length&&Ne==c[P].tg;){z=c[P].Ns;var Zt=c[P].tg,_t=c[P].OA,Qi=c[P].Lm,bt=c[P].Al,aa=c[P].VH;if(c[P].Ei==2){if(ve||(st=z,Z=Zt,it=_t,ee=Qi,Q=bt,le=aa,q=2,y!=null?D=new d.Ta:Ae=0,je=!1,_e=!0),_t=c[P].UH,aa=c[P].OT,y!=null?(Ci.ah(Jt,c[P].UH,A),D.oc(A.get(),_e)):Ae++,Jt=_t,ve=!0,_e=se=!1,P+1==c.length||c[P+1].Ei!=2||c[P+1].tg==Zt&&c[P+1].OA!=Jt){if(y!=null){var Ot=new x(D,2,z,Zt,_t,q,st,Z,it,Qi,bt);y.push(Ot)}else null.add(Ae);st=z,Z=Zt,it=_t,ee=Qi,Q=bt,le=aa,q=2,ve=se=!1,_e=je=!0}}else{var hs=f.U(Zt);if(P<c.length-1&&c[P+1].tg==hs&&c[P+1].Al==bt&&c[P+1].Ei==2)_t!=Jt&&(je&&(y!=null?D=new d.Ta:Ae=0),se=0<P&&c[P-1].Ns==z?q==1?0:q==0?1:3:3,y!=null?(Ci.ah(Jt,_t,A),D.oc(A.get(),_e),Ot=new x(D,se,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):(Ae++,null.add(Ae)),Jt=_t,st=z,Z=Zt,it=_t,ee=Qi,Q=bt,le=aa,q=se,se=xe=!1,_e=je=!0);else if(!s.CM(a,f,c,P,_,$)){s.zM(f,c,P,B,Ne,I,k);var oi=!1;if(hs=!1,Ot=!0,!(_.qb(I)||$.qb(I)||_.qb(k)||$.qb(k))){v[0].L(_),v[1].L($),v[2].L(I),v[3].L(k),v.sort(d.h.nu);var ag=v[0],lg=v[1],ug=v[2],ks=v[3];ag.qb(_)?lg.qb($)?a?(hs=oi=!0,Ot=!1):oi=!1:ks.qb($)?a?Ot=hs=oi=!0:oi=!1:(oi=!0,Ot=lg.qb(I)):lg.qb(_)?ug.qb($)?a?(hs=oi=!0,Ot=!1):oi=!1:ag.qb($)?a?Ot=hs=oi=!0:oi=!1:(oi=!0,Ot=ug.qb(I)):ug.qb(_)?ks.qb($)?a?(hs=oi=!0,Ot=!1):oi=!1:lg.qb($)?a?Ot=hs=oi=!0:oi=!1:(oi=!0,Ot=ks.qb(I)):ag.qb($)?a?(hs=oi=!0,Ot=!1):oi=!1:ug.qb($)?a?Ot=hs=oi=!0:oi=!1:(oi=!0,Ot=ag.qb(I))}oi&&(oi=Ne==Zt,(_t!=Jt||oi&&Jt==0)&&(je&&(y!=null?D=new d.Ta:Ae=0),y!=null?(Ci.ah(Jt,_t,A),D.oc(A.get(),_e)):Ae++),Ot?q!=1?((_t!=Jt||oi&&Jt==0)&&(y!=null?(Ot=new x(D,1,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae)),hs?(P>=c.length-2||c[P+2].Ns!=z)&&(q=0):q=1):((_t!=Jt||oi&&Jt==0)&&(y!=null?(Ot=new x(D,3,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae)),q=1):q!=0?((_t!=Jt||oi&&Jt==0)&&(y!=null?(Ot=new x(D,0,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae)),hs?(P>=c.length-2||c[P+2].Ns!=z)&&(q=1):q=0):((_t!=Jt||oi&&Jt==0)&&(y!=null?(Ot=new x(D,3,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae)),q=0),(_t!=Jt||oi&&Jt==0)&&(Jt=_t,st=z,Z=Zt,it=_t,ee=Qi,Q=bt,le=aa,se=xe=!1,_e=je=!0))}}P++}Jt!=1&&(je&&(y!=null?D=new d.Ta:Ae=0),y!=null?(Ci.ah(Jt,1,A),D.oc(A.get(),_e)):Ae++,_e=je=!1,xe=!0)}xe&&(_t=1,Zt=f.rj(B),Zt=f.Ma(Zt),bt=Qi=-1,aa=NaN,se?y!=null?(Ot=new x(D,4,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae):(se=q==1?0:q==0?1:3,y!=null?(Ot=new x(D,se,z,Zt,_t,q,st,Z,it,Qi,bt),y.push(Ot)):null.add(Ae)))}},s.CM=function(a,c,f,y,v,_){var $=f[y].VH;if($==1)return s.AM(a,c,f,y,v,_);if($==0)return s.BM(a,c,f,y,v,_);throw d.i.Qa()},s.AM=function(a,c,f,y,v,_){var $=new d.yb,I=f[y].tg,k=f[y].Lm,A=f[y].Al,P=-1,D=-1,j=-1,B=-1;if(!a&&0<y){var q=f[y-1];P=q.tg,D=q.Lm,j=q.Al,B=q.Ei}var z=-1,Z=-1,ee=-1,Q=-1;y<f.length-1&&(z=(q=f[y+1]).tg,Z=q.Lm,ee=q.Al,Q=q.Ei);var le=c.U(I);return q=c.U(A),a?y==f.length-1||z!=I||Z!=k||ee!=q||Q==2?((a=c.bc(A))==null&&(c.ed(A,$),a=$),_.L(a.kg()),v.mt(_),_.normalize(),v.normalize(),!1):((a=c.bc(A))==null&&(c.ed(A,$),a=$),v.L(a.kg()),(a=c.bc(q))==null&&(c.ed(q,$),a=$),_.L(a.kg()),v.Sq(),_.normalize(),v.normalize(),!1):0<y&&P==I&&D==k&&j==q&&B==2||y<f.length-1&&z==le&&Z==k&&ee==q&&Q==2?((a=c.bc(A))==null&&(c.ed(A,$),a=$),_.L(a.kg()),v.mt(_),_.normalize(),v.normalize(),!1):!(y<f.length-1&&z==I&&Z==k&&ee==q)||((a=c.bc(A))==null&&(c.ed(A,$),a=$),v.L(a.kg()),(a=c.bc(q))==null&&(c.ed(q,$),a=$),_.L(a.kg()),v.Sq(),_.normalize(),v.normalize(),!1)},s.BM=function(a,c,f,y,v,_){var $=new d.yb,I=f[y].tg,k=f[y].Lm,A=f[y].Al,P=-1,D=-1,j=-1,B=-1;if(!a&&y<f.length-1){var q=f[y+1];P=q.tg,D=q.Lm,j=q.Al,B=q.Ei}var z=-1,Z=-1,ee=-1;q=-1,0<y&&(z=(q=f[y-1]).tg,Z=q.Lm,ee=q.Al,q=q.Ei);var Q=c.U(I),le=c.Ma(A);return a?y!=0&&z==I&&Z==k&&ee==le&&q!=2||((a=c.bc(A))==null&&(c.ed(A,$),a=$),_.L(a.kg()),v.mt(_),_.normalize(),v.normalize(),!1):!(0<y&&z==I&&Z==k&&ee==le&&q==2||y<f.length-1&&P==Q&&D==k&&j==le&&B==2)||((a=c.bc(A))==null&&(c.ed(A,$),a=$),_.L(a.kg()),v.mt(_),_.normalize(),v.normalize(),!1)},s.zM=function(a,c,f,y,v,_,$){var I=new d.yb,k=a.bc(v);if(k==null&&(a.ed(v,I),k=I),c=(f=c[f]).tg,f=f.OA,v=a.U(c),f==1)_.L(k.kg()),v!=-1&&v!=a.rj(y)?((k=a.bc(v))==null&&(a.ed(v,I),k=I),$.L(k.kg()),(k=a.bc(c))==null&&a.ed(c,I)):$.L(_),_.Sq(),$.normalize(),_.normalize();else{if(f!=0)throw d.i.Qa();$.L(k.kg()),_.mt($),$.normalize(),_.normalize()}},s}()}(Y||(Y={})),function(d){var O;(O=d.bM||(d.bM={}))[O.Linear=0]="Linear",O[O.Angular=1]="Angular",O[O.Area=2]="Area";var x=function(){function y(v,_,$){this.od=_,this.ai=$,this.vA=v}return y.prototype.Nb=function(v){return v instanceof y&&this.ai===v.ai},y.aG=function(v){return v.od!==0?null:v.vA===-1?new y(-1,2,v.ai*v.ai):y.Zg(c[v.vA])},y.Zg=function(v){return(v=a[v])===void 0?null:v},y.ZO=function(v,_,$){var I=null;if($!=null)try{$.values[0]==="EPSG"&&(I=y.Zg(parseInt($.values[1])))}catch{}return I===null&&(I=new y(-1,v,_)),I},y.prototype.Ec=function(){return this.vA},y.prototype.CF=function(v){if(v.od!=this.od)throw d.i.Hb();return this.ai/v.ai},y.Nh=function(v,_,$){return _.CF($)*v},y.XE=function(v,_,$,I,k){for($=$.CF(I),I=0;I<_;I++)k[I]=v[I]*$},y}();d.Tc=x;for(var h=[109401,1e4,109402,4046.8564224,109403,4046.87260987425,109404,1,109405,.09290304,109406,.09290341161327487,109407,.09290137299531805,109408,3.34450944,109409,3429904,109410,1.000027193184865,109411,404.6872609874253,109412,.04046872609874253,109413,2.5899984703195216e6,109414,1e6,109415,.8361123569578626,109416,404.67838076760535,109417,.04046783807676053,109418,.8361244606523066,109419,.09290271785025629,109420,404.68423895571647,109421,.04046842389557164,109422,.83612589696064,109423,.0929028774400711,109424,404.6849341289498,109425,.04046849341289498,109426,.836125904805842,109427,.09290287831176021,109428,404.68493792602754,109429,.04046849379260275,109430,.09290354800069446,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109439,2589988110336e-6,109440,.09290286332673177,109441,.09290349665192114,109442,.83612736,109443,.8361307045194736,109444,404.68564224000005,109445,.04046856422400001,109446,.8361237024040001,109447,.0929026336004445,109448,404.683871963536,109449,.0404683871963536,109450,.01,109451,1e-4,109452,1e-6,109453,64516e-8,109454,.0006451625806477421,109455,25.292852640000003,109456,25.29295381171408,109457,3.4345281495040003e6,109458,3434290937856e-6,109459,2.89612324,109460,25e8,109461,225e8,109462,.7168473118308245,109463,100,109464,1244521604938272e-22,109465,1e-12,109466,1e-18],l=[1031,484813681109536e-23,9101,1,9102,.0174532925199433,9103,.0002908882086657216,9104,484813681109536e-20,9105,.01570796326794897,9106,.01570796326794897,9109,1e-6,9112,.0001570796326794897,9113,1570796326794897e-21,9114,.0009817477042468104],s=[1025,.001,109452,1033,.01,109451,9001,1,109404,9002,.3048,109405,9003,.3048006096012192,109406,9005,.3047972654,109407,9014,1.8288,109408,9030,1852,109409,9031,1.0000135965,109410,9033,20.11684023368047,109411,9034,.2011684023368047,109412,9035,1609.3472186944375,109413,9036,1e3,109414,9037,.9143917962000001,109415,9038,20.1166195164,109416,9039,.201166195164,109417,9040,.9143984146160287,109418,9041,.304799471538676,109419,9042,20.116765121552632,109420,9043,.2011676512155263,109421,9050,.9143992,109422,9051,.3047997333333333,109423,9052,20.1167824,109424,9053,.201167824,109425,9060,.9143992042898124,109426,9061,.3047997347632708,109427,9062,20.116782494375872,109428,9063,.2011678249437587,109429,9070,.3048008333333334,109430,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9093,1609.344,109439,9094,.3047997101815088,109440,9095,.3048007491,109441,9096,.9144,109442,9097,20.1168,109444,9098,.201168,109445,9099,.914398,109446,9300,.3047993333333334,109447,9301,20.116756,109448,9302,.20116756,109449,109001,.9144,109442,109002,.9144018288036576,109443,109003,20.1168,109444,109004,.201168,109445,109005,.1,109450,109006,.01,109451,109007,.001,109452,109008,.0254,109453,109009,.0254000508001016,109454,109010,5.0292,109455,109011,5.029210058420118,109456,109012,1853.248,109457,109013,1853.184,109458,109014,1.7018,109459,109015,.8466683600033867,109462,109016,.0003527777777777778,109464,109017,1e-6,109465,109018,1e-9,109466,109030,5e4,109460,109031,15e4,109461],a=[],c=[],f=0;f<h.length;f+=2)a[h[f]]=new x(h[f],2,h[f+1]);for(h=null,f=0;f<l.length;f+=2)a[l[f]]=new x(l[f],1,l[f+1]);for(l=null,f=0;f<s.length;f+=3)a[s[f]]=new x(s[f],0,s[f+1]),c[s[f]]=s[f+2];s=null}(Y||(Y={})),function(d){var O=function(){function x(){this.xb=this.pb=0}return x.prototype.set=function(h,l){l!==void 0?(this.pb=h,this.xb=l):typeof h=="number"?(this.pb=h,this.xb=0):(this.pb=h.pb,this.xb=h.xb)},x.prototype.value=function(){return this.pb},x.prototype.add=function(h){var l=this.pb+h.pb;h=this.xb+h.xb+2220446049250313e-31*Math.abs(l),this.pb=l,this.xb=h},x.prototype.kN=function(){var h=this.pb+1,l=this.xb+2220446049250313e-31*Math.abs(h);this.pb=h,this.xb=l},x.prototype.dN=function(h,l){this.pb=h.pb+l.pb,this.xb=h.xb+l.xb+2220446049250313e-31*Math.abs(this.pb)},x.prototype.sub=function(h){if(typeof h=="number"){var l=this.pb-h;h=this.xb+2220446049250313e-31*Math.abs(l)}else l=this.pb-h.pb,h=this.xb+h.xb+2220446049250313e-31*Math.abs(l);this.pb=l,this.xb=h},x.prototype.Ag=function(h){var l=this.pb*h.pb;this.xb=this.xb*Math.abs(h.pb)+h.xb*Math.abs(this.pb)+this.xb*h.xb+2220446049250313e-31*Math.abs(l),this.pb=l},x.prototype.No=function(h){var l=this.pb*h;this.xb=this.xb*Math.abs(h)+2220446049250313e-31*Math.abs(l),this.pb=l},x.prototype.Kl=function(h,l){var s=Math.abs(h.pb)*Math.abs(l.pb);this.xb=h.xb*Math.abs(l.pb)+l.xb*Math.abs(h.pb)+h.xb*l.xb+2220446049250313e-31*Math.abs(s),this.pb=s},x.prototype.jm=function(h){var l=Math.abs(h.pb),s=this.pb/h.pb,a=(this.xb+Math.abs(s)*h.xb)/l;h.xb>.01*l&&(a*=1+(1+(h=h.xb/l))*h),this.pb=s,this.xb=a+2220446049250313e-31*Math.abs(s)},x.prototype.sqrt=function(){if(0<=this.pb){var h=Math.sqrt(this.pb),l=this.pb>10*this.xb?.5*this.xb/h:this.pb>this.xb?h-Math.sqrt(this.pb-this.xb):Math.max(h,Math.sqrt(this.pb+this.xb)-h);l+=2220446049250313e-31*Math.abs(h)}else this.pb<-1*this.xb?l=h=NaN:(h=0,l=Math.sqrt(this.xb));this.pb=h,this.xb=l},x.prototype.sin=function(h){var l=Math.sin(h.pb),s=Math.cos(h.pb);this.pb=l,l=Math.abs(l),this.xb=(Math.abs(s)+.5*l*h.xb)*h.xb+2220446049250313e-31*l},x.prototype.cos=function(h){var l=Math.sin(h.pb),s=Math.cos(h.pb);this.pb=s,s=Math.abs(s),this.xb=(Math.abs(l)+.5*s*h.xb)*h.xb+2220446049250313e-31*s},x.prototype.qg=function(){return Math.abs(this.pb)<=this.xb},x.prototype.ps=function(){return this.qg()&&this.xb!=0},x}();d.Wb=O}(Y||(Y={}));var Lr=new Y.h,Jl=new Y.h,sc=new Y.h,Zl=new Y.h,oc=new Y.h;(function(d){var O,x;(x=O||(O={}))[x.closedPath=1]="closedPath",x[x.exteriorPath=2]="exteriorPath",x[x.ringAreaValid=4]="ringAreaValid";var h=function(){function l(s,a,c,f,y,v,_){a!==void 0?(this.ib=s,this.ck=a,this.bl=c,this.ii=f,this.ya=v,this.hA=_,this.ew=y):(this.ib=s.ib,this.ck=s.ck,this.bl=s.bl,this.ii=s.ii,this.ya=s.ya,this.hA=s.hA,this.ew=s.ew),this.bH=!0}return l.prototype.next=function(){return this.bH?(this.bH=!1,this.ii):this.ii!=-1?(this.ii=this.ib.U(this.ii),this.ya++,this.ii!=-1&&this.ii!=this.ew?this.ii:this.$T()):-1},l.prototype.$T=function(){for(this.bl=this.ib.Rb(this.bl),this.ya=0;this.ck!=-1;){for(;this.bl!=-1;this.bl=this.ib.Rb(this.bl))if(this.ew=this.ii=this.ib.Xa(this.bl),this.ii!=-1)return this.ii;if(this.ck=this.ib.ue(this.ck),this.ck==-1)break;this.hA&&!d.aa.Hc(this.ib.ic(this.ck))||(this.bl=this.ib.Ob(this.ck))}return-1},l.AP=function(s,a,c,f,y,v,_){return new l(s,a,c,f,y,v,_)},l}();d.zY=h,O=function(){function l(){this.jo=this.Am=this.wk=this.cd=this.Ck=this.vo=this.Oi=this.md=this.bi=this.Sg=this.We=this.Il=null,this.qw=this.ld=-1,this.fd=0,this.fA=!1,this.ht=this.it=this.vb=null}return l.prototype.Sh=function(s){return this.We!=null?this.We[s]:null},l.prototype.Xg=function(s,a){if(this.We==null){if(a==null)return;this.We=[];for(var c=0,f=this.vb.I();c<f;c++)this.We.push(null)}this.We[s]=a},l.prototype.bp=function(s,a){this.md.S(s,1,a)},l.prototype.ap=function(s,a){this.md.S(s,2,a)},l.prototype.VB=function(s,a){this.md.S(s,6,a)},l.prototype.Sp=function(s){return this.md.T(s,6)},l.prototype.gx=function(s,a){this.md.S(s,7,a)},l.prototype.qv=function(s){return this.md.T(s,0)},l.prototype.OJ=function(s,a){this.cd.S(s,1,a)},l.prototype.SJ=function(s,a){this.cd.S(s,0,a)},l.prototype.JF=function(s){return this.cd.T(s,7)},l.prototype.Zo=function(s,a){this.cd.S(s,3,a)},l.prototype.$o=function(s,a){this.cd.S(s,4,a)},l.prototype.uU=function(s){this.cd==null&&(this.cd=new d.$c(8));var a=this.cd.Ce();return this.cd.S(a,2,s),this.cd.S(a,5,0),this.cd.S(a,6,0),this.cd.S(a,7,a),a},l.prototype.OQ=function(s){this.cd.jd(s)},l.prototype.wU=function(s){this.md==null&&(this.md=new d.$c(8),this.td=new d.$c(5),this.Oi=new d.be(0),this.vo=new d.be(0));var a=this.md.Ce();return this.md.S(a,0,a),this.md.S(a,3,0),this.md.S(a,6,0),this.gx(a,s),a>=this.Oi.size&&(s=16>a?16:d.O.truncate(3*a/2),this.Oi.resize(s),this.vo.resize(s)),this.Oi.set(a,0),this.vo.set(a,0),a},l.prototype.sF=function(s){this.md.jd(s)},l.prototype.Vy=function(s){this.td.jd(s),this.fd--},l.prototype.oI=function(s){this.md==null&&(this.md=new d.$c(8),this.td=new d.$c(5),this.Oi=new d.be(0),this.vo=new d.be(0));var a=this.td.Ce(),c=0<=s?s:a;if(this.td.S(a,0,c),0>s){if(c>=this.vb.I()){if(s=16>c?16:d.O.truncate(3*c/2),this.vb.resize(s),this.We!=null)for(var f=0;f<s;f++)this.We.push(null);this.Sg!=null&&this.Sg.resize(s),this.it=this.vb.ub(0)}this.vb.Cb(c,-1e38,-1e38),this.We!=null&&(this.We[c]=null),this.Sg!=null&&this.Sg.write(c,1)}return this.td.S(a,4,2*c),this.fd++,a},l.prototype.wj=function(s,a,c){var f=a!=-1?this.Ma(a):this.rj(s),y=f!=-1?this.U(f):-1,v=this.oI(c==null?this.fd:-1),_=this.Ua(v);return c!=null&&this.vb.Ht(_,c),this.aj(v,s),this.Bc(v,y),this.Cc(v,f),y!=-1&&this.Cc(y,v),f!=-1&&this.Bc(f,v),c=this.dc(s),f=this.Xa(s),a==-1&&this.Wg(s,v),a==f&&this.Jf(s,v),c&&y==-1&&(this.Bc(v,v),this.Cc(v,v)),this.Vj(s,this.Ja(s)+1),s=this.Qf(s),this.Tj(s,this.I(s)+1),v},l.prototype.nm=function(){return this.jo==null&&(this.jo=new d.Sa(this.vb.description)),this.jo},l.prototype.Yo=function(s,a){this.cd.S(s,2,-134217729&this.cd.T(s,2)||(a==1?134217728:0))},l.prototype.In=function(s){return 134217728&this.cd.T(s,2)?1:0},l.prototype.hN=function(s){var a=this.Ig(s.getType(),s.description);return s.getType()==1736&&this.Yo(a,s.In()),this.UD(a,s),a},l.prototype.iN=function(s){var a=this.Ig(s.getType(),s.description);return this.VD(a,s),a},l.prototype.XV=function(s,a){this.md==null&&(this.md=new d.$c(8),this.td=new d.$c(5),this.Oi=new d.be(0),this.vo=new d.be(0)),this.md.De(this.md.Hg+s),this.td.De(this.td.Hg+a),this.Oi.Jb(this.Oi.size+s),this.vo.Jb(this.vo.size+s)},l.prototype.UD=function(s,a){this.XV(a.da(),a.I()),this.Il.Fd(a,0,a.I()),this.it=this.vb.ub(0);for(var c=this.We!=null&&a.Ve!=null,f=0,y=a.da();f<y;f++)if(!(2>a.Ja(f))){var v=this.vf(s,-1);this.kn(v,a.dc(f));for(var _=a.Ba(f),$=a.Vc(f);_<$;_++){var I=this.wj(v,-1,null);if(c)if(I=this.Ua(I),1&a.ZF(_))this.Xg(I,null);else{var k=new d.ig;a.bc(_,k,!0),this.Xg(I,k.get())}}}},l.prototype.VD=function(s,a){this.Il.Fd(a,0,a.I()),this.it=this.vb.ub(0),s=this.vf(s,-1);var c=0;for(a=a.I();c<a;c++)this.wj(s,-1,null)},l.prototype.NX=function(s,a,c){var f=this.U(s);if(f==-1)throw d.i.Qa();for(var y=this.nm(),v=this.bd(s),_=0,$=a.ol(c);_<$;_++){var I=this.Ua(s),k=this.U(s),A=a.Vp(c,_);_==0&&(A.To(y),this.Dh(s,y)),A.getType()==322?this.Xg(I,null):this.Xg(I,d.aa.jg(A)),A.Po(y),_<$-1?s=this.wj(v,k,y):this.Dh(f,y)}},l.prototype.MX=function(s,a,c){var f=this.U(s);if(f==-1)throw d.i.Qa();for(var y=this.nm(),v=this.bd(s),_=0,$=a.ol(c);_<$;_++){var I=this.Ua(s),k=this.U(s),A=a.Vp(c,$-_-1);_==0&&(A.Po(y),this.Dh(s,y)),A.getType()==322?this.Xg(I,null):this.Xg(I,d.aa.jg(A)),A.To(y),_<$-1?s=this.wj(v,k,y):this.Dh(f,y)}},l.prototype.IF=function(){var s=new d.l;s.Oa();for(var a=this.Yq(),c=new d.h,f=!0,y=a.next();y!=-1;y=a.next())this.D(y,c),f?s.Zb(c.x,c.y):s.Lk(c.x,c.y),f=!1;return s},l.prototype.Ib=function(s){var a=s.getType();if(d.aa.Hc(a))return this.hN(s);if(a==550)return this.iN(s);throw d.i.Qa()},l.prototype.uN=function(s,a){var c=a.getType();if(d.aa.Hc(c))this.UD(s,a);else{if(c!=550)throw d.i.Qa();this.VD(s,a)}},l.prototype.mN=function(s,a){var c=this.Ig(1736,s.description);if(2>s.Ja(a))return c;this.Il.Fd(s,s.Ba(a),s.Vc(a)),this.it=this.vb.ub(0);var f=this.vf(c,-1);this.kn(f,s.dc(a)||!0);var y=this.We!=null&&s.Ve!=null,v=s.Ba(a);for(a=s.Vc(a);v<a;v++){var _=this.wj(f,-1,null);if(y)if(_=this.Ua(_),1&s.ZF(v))this.Xg(_,null);else{var $=new d.ig;s.bc(v,$,!0),this.Xg(_,$.get())}}return c},l.prototype.Ne=function(s){var a=this.ic(s),c=d.ZK.Ig(a,this.Il.description),f=this.I(s);if(f==0)return c;if(d.aa.Hc(a)){a=this.da(s);for(var y=d.Yc.Oh(a+1),v=d.Yc.Mr(a+1,0),_=c.description,$=0,I=_.Aa;$<I;$++){for(var k=_.kd($),A=d.ra.Va(k),P=d.Yc.YE(k,f),D=this.vb.ub(k),j=0,B=0,q=0,z=this.Ob(s);z!=-1;z=this.Rb(z)){var Z=0;this.dc(z)&&(Z|=1),this.YS(z)&&(Z|=4),Z!=0&&v.zJ(B,Z);var ee=this.Ja(z);if(y.write(B++,q),q+=ee,k==0){ee=D;var Q=P,le=new d.h;for(Z=this.Xa(z);j<q;Z=this.U(Z),j++){var se=this.Ua(Z);ee.tc(2*se,le),Q.Tt(2*j,le)}}else for(Z=this.Xa(z);j<q;Z=this.U(Z),j++)for(se=this.Ua(Z),Q=0;Q<A;Q++)le=D.eg(se*A+Q),P.pr(j*A+Q,le)}c.hn(k,P),y.write(a,f)}c.PJ(v),c.QJ(y),c.Pc(16777215)}else if(a==550){for(_=c.description,c.resize(f),$=0,I=_.Aa;$<I;$++){for(k=_.kd($),A=d.ra.Va(k),P=c.ub(k),D=this.vb.ub(k),j=0,z=this.Ob(s),ee=this.Ja(z),Z=this.Xa(z);j<ee;Z=this.U(Z),j++)for(se=this.Ua(Z),Q=0;Q<A;Q++)le=D.eg(se*A+Q),P.pr(j*A+Q,le);c.hn(k,P)}c.Pc(16777215)}return c},l.prototype.BB=function(s){for(var a=this.Ob(s);a!=-1;a=this.Zq(a));a=this.PR(s);var c=this.ue(s);a!=-1?this.OJ(a,c):this.ld=c,c!=-1?this.SJ(c,a):this.qw=a,this.OQ(s)},l.prototype.Ig=function(s,a){return a===void 0?this.$E(s,d.ee.og()):this.$E(s,a)},l.prototype.$E=function(s,a){return s=this.uU(s),this.vb==null?this.vb=this.Il=new d.de(a):this.Il.Jl(a),this.ht=this.Il.description,this.fA=1<this.ht.Aa,this.ld==-1?this.ld=s:(this.SJ(s,this.qw),this.OJ(this.qw,s)),this.qw=s},l.prototype.ue=function(s){return this.cd.T(s,1)},l.prototype.PR=function(s){return this.cd.T(s,0)},l.prototype.ic=function(s){return 2147483647&this.cd.T(s,2)},l.prototype.HJ=function(s,a,c){a=this.wk[a],(s=this.JF(s))>=a.size&&a.resize(Math.max(d.O.truncate(1.25*s),16),-1),a.write(s,c)},l.prototype.KF=function(s,a){return(s=this.JF(s))<(a=this.wk[a]).size?a.read(s):-1},l.prototype.aF=function(){this.wk==null&&(this.wk=[]);for(var s=0;s<this.wk.length;s++)if(this.wk[s]==null)return this.wk[s]=d.Yc.Oh(0),s;return this.wk.push(d.Yc.Oh(0)),this.wk.length-1},l.prototype.xW=function(s){this.wk[s]=null},l.prototype.Ob=function(s){return this.cd.T(s,3)},l.prototype.kv=function(s){return this.cd.T(s,4)},l.prototype.I=function(s){return this.cd.T(s,5)},l.prototype.da=function(s){return this.cd.T(s,6)},l.prototype.Gp=function(s,a,c){for(var f=0,y=this.ld;y!=-1;y=this.ue(y)){var v=this.ic(y);if(d.aa.Hc(v)&&(!c||v==1736)){v=this.ic(y)==1736;for(var _=this.Ob(y);_!=-1;){for(var $=0,I=this.Xa(_);$<d.O.truncate(this.Ja(_)/2);){var k=this.U(I);if(k==-1)break;var A=this.Ua(I),P=this.Sh(A);P!=null?A=P.Qb():(P=this.Ua(k),A=this.vb.yr(A,P)),A<=s?(A==0?f==0&&(f=-1):f=1,k!=this.rj(_)&&(this.lC(k,I),this.pd(k,!0))):I=this.U(I),$++}for($=this.Xa(_),I=this.dc(_)?$:this.rj(_);0<this.Ja(_);){if((k=this.Ma(I))==-1){this.pd(I,!0),f==0&&(f=-1);break}var D=this.Ua(k);if((P=this.Sh(D))!=null?A=P.Qb():(A=this.Ua(I),A=this.vb.yr(A,D)),A<=s)A==0?f==0&&(f=-1):f=1,this.lC(k,I),this.pd(k,!1),$==k&&($=this.Xa(_));else if((I=this.Ma(I))==$)break}I=this.Ja(_),a&&(v?3>I:2>I)?(_=this.Zq(_),f=0<I?1:f==0?-1:f):_=this.Rb(_)}}}return f},l.prototype.lC=function(s,a){var c=this.Ua(s),f=this.Ua(a);if(this.Sg!=null&&(c=this.Sg.read(c),this.Sg.write(f,c)),this.bi!=null){for(f=0,c=this.bi.length;f<c;f++)if(this.bi[f]!=null){var y=this.Pa(s,f);y!=-1&&this.Ra(a,f,y)}}},l.prototype.Ul=function(s,a,c){var f=0,y=this.U(s);if(y==-1)throw d.i.Qa();for(var v=this.Ua(s),_=this.Ua(y),$=this.Sh(v),I=$==null?this.vb.yr(v,_):$.Qb(),k=0;k<c;k++){var A=a[k];if(0<A&&1>A){var P=A;$!=null&&(P=0<I?$.Ux(A)/I:0),this.vb.kD(v,_,P,this.nm());var D=this.wj(this.bd(s),y,this.nm());if(f++,$!=null){var j=$.dl(0,A);P=this.Ua(this.Ma(D)),this.Xg(P,j),this.mf(D,j.wc()),k!=c-1&&a[k+1]!=1||(A=$.dl(A,1),this.Xg(P,A))}}}return f},l.prototype.LX=function(s,a,c){var f=0,y=this.U(s);if(y==-1)throw d.i.fa("internal error");var v=this.Ua(s),_=this.Ua(y),$=this.Sh(v),I=$==null?this.vb.yr(v,_):$.Qb(),k=0;s=this.bd(s);for(var A=0;A<c;A++){var P=a[A];if(k<P&&1>P){var D=P;if($!=null&&(D=0<I?$.Ux(P)/I:0),this.vb.kD(v,_,D,this.nm()),D=this.yS(s,y,this.nm()),f++,$!=null){k=$.dl(k,P);var j=this.Ua(this.Ma(D));this.Xg(j,k),this.Cb(D,k.pa,k.la),A!=c-1&&a[A+1]!=1||(k=$.dl(P,1),D=this.Ua(D),this.Xg(D,k))}}k=P}return f},l.prototype.yS=function(s,a,c){var f=a!=-1?this.Ma(a):this.rj(s),y=f!=-1?this.U(f):-1,v=this.oI(c==null?this.fd:-1),_=this.Ua(v);return c!=null&&this.vb.Ht(_,c),this.aj(v,s),this.Bc(v,y),this.Cc(v,f),y!=-1&&this.Cc(y,v),f!=-1&&this.Bc(f,v),c=this.dc(s),f=this.Xa(s),a==-1&&this.Wg(s,v),a==f&&(c&&f!=-1||this.Jf(s,v)),c&&y==-1&&(this.Bc(v,v),this.Cc(v,v)),this.Vj(s,this.Ja(s)+1),s=this.Qf(s),this.Tj(s,this.I(s)+1),v},l.prototype.uE=function(s,a,c){var f=this.Ua(a),y=this.Ua(c);if(0>f||y>this.fd-1)throw d.i.N("invalid call");if(f>y&&!this.dc(s))throw d.i.N("cannot iterate across an open path");for(s=0;a!=c;a=this.U(a))f=this.Ua(a),(y=this.Sh(f))!=null?s+=y.Qb():(y=this.Ua(this.U(a)),s+=this.vb.yr(f,y));return s},l.prototype.Dh=function(s,a){var c=this.Ua(s);this.vb.Ht(c,a),(c=this.Sh(c))!=null&&c.setStart(a),(s=this.Ma(s))!=-1&&(s=this.Ua(s),this.Sh(s)!=null&&c.setEnd(a))},l.prototype.Vi=function(s,a){s=this.Ua(s),this.vb.ve(s,a)},l.prototype.mf=function(s,a){this.Cb(s,a.x,a.y)},l.prototype.Cb=function(s,a,c){var f=this.Ua(s);this.vb.Cb(f,a,c),(f=this.Sh(f))!=null&&f.ZB(a,c),(s=this.Ma(s))!=-1&&(s=this.Ua(s),this.Sh(s)!=null&&f.Ql(a,c))},l.prototype.D=function(s,a){this.vb.D(this.td.T(s,0),a)},l.prototype.Gc=function(s,a){this.vb.za[0].tc(2*this.td.T(s,0),a)},l.prototype.Na=function(s){var a=new d.h;return this.vb.D(this.td.T(s,0),a),a},l.prototype.dG=function(s,a){this.it.tc(2*s,a)},l.prototype.Uc=function(s,a,c){return this.vb.Uc(s,this.Ua(a),c)},l.prototype.setAttribute=function(s,a,c,f){this.vb.setAttribute(s,this.Ua(a),c,f)},l.prototype.Ua=function(s){return this.td.T(s,0)},l.prototype.ih=function(){var s=new d.h;return this.D(void 0,s),s.y},l.prototype.fq=function(s,a){s=this.Ua(s),a=this.Ua(a);var c=this.vb.za[0].o;return c[2*s]===c[2*a]&&c[2*s+1]===c[2*a+1]},l.prototype.Dv=function(s,a){s=this.Ua(s);var c=this.vb.za[0].o;return c[2*s]===a.x&&c[2*s+1]===a.y},l.prototype.vX=function(s,a){if(1>a&&(a=1),this.Sg==null){if(a==1)return;this.Sg=d.Yc.Dn(this.vb.I(),1)}(s=this.Ua(s))>=this.Sg.size&&this.Sg.resize(s+1,1),this.Sg.write(s,a)},l.prototype.cG=function(s){return s=this.Ua(s),this.Sg==null||s>=this.Sg.size?1:this.Sg.read(s)},l.prototype.Ra=function(s,a,c){a=this.bi[a],s=this.Ua(s),a.size<this.vb.I()&&a.resize(this.vb.I(),-1),a.write(s,c)},l.prototype.Pa=function(s,a){return(s=this.Ua(s))<(a=this.bi[a]).size?a.read(s):-1},l.prototype.Gd=function(){this.bi==null&&(this.bi=[]);for(var s=0;s<this.bi.length;s++)if(this.bi[s]==null)return this.bi[s]=d.Yc.Oh(0,-1),s;return this.bi.push(d.Yc.Oh(0,-1)),this.bi.length-1},l.prototype.Td=function(s){this.bi[s]=null},l.prototype.bc=function(s){return this.We!=null?(s=this.Ua(s),this.We[s]):null},l.prototype.ed=function(s,a){var c=this.td.T(s,2);if(c==-1)return!1;if(this.fA){var f=new d.Sa;this.Vi(s,f),a.setStart(f),this.Vi(c,f),a.setEnd(f)}else this.vb.Gc(this.td.T(s,0),Lr),a.em(0,Lr),this.vb.Gc(this.td.T(c,0),Lr),a.em(1,Lr);return!0},l.prototype.mW=function(s,a,c){if(this.fA){var f=new d.Sa;this.Vi(s,f),c.setStart(f),this.Vi(a,f),c.setEnd(f)}else this.vb.Gc(s,Lr),c.em(0,Lr),this.vb.Gc(a,Lr),c.em(1,Lr)},l.prototype.vf=function(s,a){if(a!=-1){if(s!=this.Qf(a))throw d.i.Qa();var c=this.cs(a)}else c=this.kv(s);var f=this.wU(s);return a!=-1&&this.bp(a,f),this.ap(f,a),this.bp(f,c),c!=-1?this.ap(c,f):this.Zo(s,f),a==-1&&this.$o(s,f),this.Rl(s,this.da(s)+1),f},l.prototype.nG=function(s,a,c,f){s=this.vf(s,-1);for(var y=0,v=a,_=!1;v==c&&(_=!0),this.aj(v,s),y++,(v=this.U(v))!=a;);return this.kn(s,!0),this.Vj(s,y),_&&(a=c),this.Jf(s,a),this.Wg(s,this.Ma(a)),this.cp(s,!1),f!=null&&(f[0]=_),s},l.prototype.Zq=function(s){var a=this.cs(s),c=this.Rb(s),f=this.Qf(s);return a!=-1?this.ap(a,c):this.Zo(f,c),c!=-1?this.bp(c,a):this.$o(f,a),this.AO(s),this.Rl(f,this.da(f)-1),this.sF(s),c},l.prototype.AO=function(s){var a=this.Xa(s);if(a!=-1){for(var c=0,f=this.Ja(s);c<f;c++){var y=a;a=this.U(a),this.Vy(y)}a=this.Qf(s),this.Tj(a,this.I(a)-this.Ja(s))}this.Vj(s,0)},l.prototype.Rb=function(s){return this.md.T(s,2)},l.prototype.cs=function(s){return this.md.T(s,1)},l.prototype.Ja=function(s){return this.md.T(s,3)},l.prototype.dc=function(s){return!!(1&this.Sp(s))},l.prototype.kn=function(s,a){if(this.dc(s)!=a){if(0<this.Ja(s)){var c=this.Xa(s),f=this.rj(s);a?(this.Bc(f,c),this.Cc(c,f),c=this.Ua(f)):(this.Bc(f,-1),this.Cc(c,-1),c=this.Ua(f)),this.Xg(c,null)}this.VB(s,(1|this.Sp(s))-1|(a?1:0))}},l.prototype.Qf=function(s){return this.md.T(s,7)},l.prototype.YS=function(s){return!!(2&this.Sp(s))},l.prototype.PB=function(s,a){this.VB(s,(2|this.Sp(s))-2|(a?2:0))},l.prototype.wz=function(s){if(this.cT(s))return this.Oi.get(this.qv(s));var a=new d.yb,c=this.Xa(s);if(c==-1)return 0;var f=new d.h;this.D(c,f);for(var y=0,v=0,_=this.Ja(s);v<_;v++,c=this.U(c)){var $=this.bc(c);if($==null){if(!this.ed(c,a))continue;$=a}y+=$.Tx(f.x,f.y)}return this.cp(s,!0),this.Oi.set(this.qv(s),y),y},l.prototype.gr=function(s,a,c){a=this.Ck[a],s=this.qv(s),a.size<this.Oi.size&&a.resize(this.Oi.size,-1),a.write(s,c)},l.prototype.sj=function(s,a){return(s=this.qv(s))<(a=this.Ck[a]).size?a.read(s):-1},l.prototype.Ky=function(){this.Ck==null&&(this.Ck=[]);for(var s=0;s<this.Ck.length;s++)if(this.Ck[s]==null)return this.Ck[s]=d.Yc.Oh(0),s;return this.Ck.push(d.Yc.Oh(0)),this.Ck.length-1},l.prototype.CB=function(s){this.Ck[s]=null},l.prototype.ZT=function(s,a,c){if(c==-1)throw d.i.N();if(a!=c){var f=this.Rb(c),y=this.cs(c),v=this.Qf(c);y==-1?this.Zo(v,f):this.ap(y,f),f==-1?this.$o(v,y):this.bp(f,y),this.Tj(v,this.I(v)-this.Ja(c)),this.Rl(v,this.da(v)-1),y=a==-1?this.kv(s):this.cs(a),this.bp(c,y),this.ap(c,a),a==-1?this.$o(s,c):this.bp(a,c),y==-1?this.Zo(s,c):this.ap(y,c),this.Tj(s,this.I(s)+this.Ja(c)),this.Rl(s,this.da(s)+1),this.gx(c,s)}},l.prototype.ij=function(s,a){this.vb.ve(this.Ua(a),this.nm()),this.wj(s,-1,this.nm())},l.prototype.pd=function(s,a){var c=this.bd(s),f=this.Ma(s),y=this.U(s);f!=-1&&this.Bc(f,y);var v=this.Ja(c);if(s==this.Xa(c)&&this.Jf(c,1<v?y:-1),y!=-1&&this.Cc(y,f),s==this.rj(c)&&this.Wg(c,1<v?f:-1),f!=-1&&y!=-1){f=this.Ua(f);var _=this.Ua(y);a?(a=this.Sh(f))!=null&&(f=new d.h,this.vb.D(_,f),a.Qc(f)):(_=this.Ua(s),a=this.Sh(_),this.Xg(f,a),a!=null&&(f=this.vb.Na(f),a.Dc(f)))}return this.Vj(c,v-1),c=this.Qf(c),this.Tj(c,this.I(c)-1),this.Vy(s),y},l.prototype.Xa=function(s){return this.md.T(s,4)},l.prototype.rj=function(s){return this.md.T(s,5)},l.prototype.U=function(s){return this.td.T(s,2)},l.prototype.Ma=function(s){return this.td.T(s,1)},l.prototype.bd=function(s){return this.td.T(s,3)},l.prototype.fc=function(s,a){return this.wj(s,-1,a)},l.prototype.Yq=function(s){if(s===void 0)return this.Yq(!1);if(s instanceof h)return new h(s);var a,c=-1,f=-1,y=-1,v=0,_=!1;for(a=this.ld;a!=-1;a=this.ue(a))if(!s||d.aa.Hc(this.ic(a))){for(c=this.Ob(a);c!=-1;c=this.Rb(c))if(y=f=this.Xa(c),v=0,f!=-1){_=!0;break}if(_)break}return h.AP(this,a,c,f,y,v,s)},l.prototype.Oc=function(s){if(this.Il.Oc(s),this.We!=null)for(var a=0,c=this.We.length;a<c;a++)this.We[a]!=null&&this.We[a].Oc(s)},l.prototype.jr=function(s,a,c,f){f?this.NX(s,a,c):this.MX(s,a,c)},l.prototype.Cc=function(s,a){this.td.S(s,1,a)},l.prototype.Bc=function(s,a){this.td.S(s,2,a)},l.prototype.aj=function(s,a){this.td.S(s,3,a)},l.prototype.Vj=function(s,a){this.md.S(s,3,a)},l.prototype.Jf=function(s,a){this.md.S(s,4,a)},l.prototype.Wg=function(s,a){this.md.S(s,5,a)},l.prototype.Rl=function(s,a){this.cd.S(s,6,a)},l.prototype.Tj=function(s,a){this.cd.S(s,5,a)},l.prototype.pJ=function(s){var a=s;do{var c=this.U(a);this.Bc(a,this.Ma(a)),this.Cc(a,c),a=c}while(a!=s)},l.prototype.bC=function(s){this.fd=s},l.prototype.$q=function(s){var a=this.cs(s),c=this.Rb(s),f=this.Qf(s);a!=-1?this.ap(a,c):this.Zo(f,c),c!=-1?this.bp(c,a):this.$o(f,a),this.Jf(s,-1),this.Wg(s,-1),this.sF(s)},l.prototype.mi=function(s,a){var c=this.Ma(s),f=this.U(s);if(c!=-1&&this.Bc(c,f),f!=-1&&this.Cc(f,c),c!=-1&&f!=-1)if(c=this.Ua(c),f=this.Ua(f),a){if((a=this.Sh(c))!=null){var y=new d.h;this.vb.D(f,y),a.Qc(y)}}else a=this.Ua(s),a=this.Sh(a),this.Xg(c,a),a!=null&&(y=new d.h,this.vb.D(c,y),a.Dc(y));this.Vy(s)},l.prototype.cT=function(s){return!!(4&this.Sp(s))},l.prototype.cp=function(s,a){this.VB(s,(4|this.Sp(s))-4|(a?4:0))},l.prototype.nx=function(s,a){var c=this.td.o;this.vb.mc();var f=this.vb.za[0].o;s.Vd(0,a,function(y,v){var _=c[5*y];y=c[5*v],v=f[2*_],_=f[2*_+1];var $=f[2*y];return _<(y=f[2*y+1])?-1:_>y?1:v<$?-1:v>$?1:0})},l.prototype.jS=function(){for(var s=this.ld;s!=-1;s=this.ue(s))if(!d.aa.Hc(this.ic(s)))return!0;return!1},l.prototype.hC=function(s,a){for(var c=this.Ob(s),f=this.Ob(a),y=this.kv(s),v=this.kv(a),_=this.Ob(s);_!=-1;_=this.Rb(_))this.gx(_,a);for(_=this.Ob(a);_!=-1;_=this.Rb(_))this.gx(_,s);this.Zo(s,f),this.Zo(a,c),this.$o(s,v),this.$o(a,y),c=this.I(s),f=this.da(s),y=this.da(a),this.Tj(s,this.I(a)),this.Tj(a,c),this.Rl(s,y),this.Rl(a,f),c=this.cd.T(s,2),this.cd.S(s,2,this.cd.T(a,2)),this.cd.S(a,2,c)},l}(),d.gd=O})(Y||(Y={})),function(d){var O=function(x){function h(l,s,a,c){var f=x.call(this)||this;return f.$=new d.l,l===void 0?f.UE():typeof l=="number"?f.VO(l,s,a,c):l instanceof d.Sa?s!==void 0?f.Qu(l,s,a):f.WO(l):l instanceof d.ra?s!==void 0?f.YO(l,s):f.XO(l):l instanceof d.l?f.UO(l):f.UE(),f}return Kt(h,x),h.prototype.Qu=function(l,s,a){this.description=d.ee.og(),this.$.Oa(),l.B()||this.tu(l,s,a)},h.prototype.UO=function(l){this.description=d.ee.og(),this.$.K(l),this.$.normalize()},h.prototype.XO=function(l){if(l==null)throw d.i.N();this.description=l,this.$.Oa()},h.prototype.YO=function(l,s){if(l==null)throw d.i.N();this.description=l,this.$.K(s),this.$.normalize()},h.prototype.UE=function(){this.description=d.ee.og(),this.$.Oa()},h.prototype.WO=function(l){this.description=d.ee.og(),this.$.Oa(),l.B()||this.tu(l)},h.prototype.VO=function(l,s,a,c){this.description=d.ee.og(),this.K(l,s,a,c)},h.prototype.K=function(l,s,a,c){if(this.vc(),typeof l=="number")this.$.K(l,s,a,c);else for(this.Oa(),s=0,a=l.length;s<a;s++)this.Zb(l[s])},h.prototype.Xo=function(l){if(this.vc(),!l.fT())throw d.i.N();this.$.K(l)},h.prototype.Oa=function(){this.vc(),this.$.Oa()},h.prototype.B=function(){return this.$.B()},h.prototype.R=function(){return this.$.R()},h.prototype.ca=function(){return this.$.ca()},h.prototype.gk=function(){return this.$.gk()},h.prototype.Jp=function(){return this.$.Jp()},h.prototype.Ip=function(){return this.$.sf()},h.prototype.Zb=function(l){if(l instanceof d.h)this.vc(),this.$.Zb(l);else if(l instanceof d.l)this.vc(),this.$.Zb(l);else if(l instanceof d.Sa){if(this.vc(),!l.Ac()){var s=l.description;if(this.description!=s&&this.Jl(s),this.B())this.tu(l);else{this.$.Zb(l.D());for(var a=1,c=s.Aa;a<c;a++)for(var f=s.Ed(a),y=d.ra.Va(f),v=0;v<y;v++){var _=l.Uc(f,v),$=this.Tg(f,v);$.Zb(_),this.setInterval(f,v,$)}}}}else if(l instanceof h&&!l.B())for((s=l.description)!=this.description&&this.Jl(s),this.$.Zb(l.$),a=1,c=s.Aa;a<c;a++)for(f=s.kd(a),y=d.ra.Va(f),v=0;v<y;v++)_=l.Tg(f,v),($=this.Tg(f,v)).Zb(_),this.setInterval(f,v,$)},h.prototype.tu=function(l,s,a){if(s!==void 0){this.$.K(l.D(),s,a),a=1;for(var c=(s=l.description).Aa;a<c;a++)for(var f=s.Ed(a),y=d.ra.Va(f),v=0;v<y;v++){var _=l.Uc(f,v);this.setInterval(f,v,_,_)}}else for(this.$.K(l.ka[0],l.ka[1]),a=1,c=(s=l.description).Aa;a<c;a++)for(f=s.Ed(a),y=d.ra.Va(f),v=0;v<y;v++)_=l.Uc(f,v),this.setInterval(f,v,_,_)},h.prototype.setInterval=function(l,s,a,c){if(a=typeof a=="number"?new d.Nc(a,c):a,this.vc(),l==0)if(s==0)this.$.v=a.oa,this.$.C=a.va;else{if(s!=1)throw d.i.ce();this.$.G=a.oa,this.$.H=a.va}else this.vD(0,l,s,a.oa),this.vD(1,l,s,a.va)},h.prototype.W=function(l,s){this.vc(),this.$.W(l,s)},h.prototype.Oc=function(l){if(l instanceof d.Dd)this.vc(),l.mC(this.$);else if(this.vc(),!this.$.B()){var s=new d.OK;this.Qo(s),s.XS()?s.Oa():l.mC(s)}},h.prototype.copyTo=function(l){if(l.getType()!=this.getType())throw d.i.N();if(l.vc(),l.description=this.description,l.$.K(this.$),l.ka=null,this.ka!=null){l.ou();for(var s=0;s<2*(this.description.Ae.length-2);s++)l.ka[s]=this.ka[s]}},h.prototype.Ia=function(){return new h(this.description)},h.prototype.Ke=function(){return this.$.wF()},h.prototype.Qb=function(){return this.$.yR()},h.prototype.getType=function(){return 197},h.prototype.Db=function(){return 2},h.prototype.bn=function(l){this.copyTo(l)},h.prototype.A=function(l){l.v=this.$.v,l.G=this.$.G,l.C=this.$.C,l.H=this.$.H},h.prototype.Qo=function(l){l.v=this.$.v,l.G=this.$.G,l.C=this.$.C,l.H=this.$.H,l.K(this.$.v,this.$.G,this.Od(0,1,0),this.$.C,this.$.H,this.Od(1,1,0))},h.prototype.Tg=function(l,s){var a=new d.Nc;return a.K(this.Od(0,l,s),this.Od(1,l,s)),a},h.prototype.Hf=function(l,s){s.Nf(this.description);var a=this.description.Aa-1;switch(l){case 0:for(l=0;l<a;l++)for(var c=this.description.kd(l),f=d.ra.Va(c),y=0;y<f;y++)s.setAttribute(c,y,this.Od(0,c,y));s.Cb(this.$.v,this.$.G);break;case 1:for(l=0;l<a;l++)for(c=this.description.kd(l),f=d.ra.Va(c),y=0;y<f;y++)s.setAttribute(c,y,this.Od(1,c,y));s.Cb(this.$.v,this.$.H);break;case 2:for(l=0;l<a;l++)for(c=this.description.kd(l),f=d.ra.Va(c),y=0;y<f;y++)s.setAttribute(c,y,this.Od(0,c,y));s.Cb(this.$.C,this.$.H);break;case 3:for(l=0;l<a;l++)for(c=this.description.kd(l),f=d.ra.Va(c),y=0;y<f;y++)s.setAttribute(c,y,this.Od(1,c,y));s.Cb(this.$.C,this.$.G);break;default:throw d.i.ce()}},h.prototype.mB=function(l,s){l=this.$.mB(l),s.ma(l.x,l.y)},h.prototype.kR=function(l,s){return s*(l.Oq-2)},h.prototype.xF=function(l,s,a){if(this.$.B())throw d.i.fa("empty geometry");if(s==0)return l!=0?a!=0?this.$.H:this.$.C:a!=0?this.$.G:this.$.v;if(a>=d.ra.Va(s))throw d.i.N();var c=this.description.Pf(s);return this.ou(),0<=c?this.ka[this.kR(this.description,l)+this.description.LR(c)-2+a]:d.ra.se(s)},h.prototype.ou=function(){if(this.vc(),this.ka==null&&2<this.description.Ae.length){this.ka=[];for(var l=h.Gg(this.description,0),s=h.Gg(this.description,1),a=0,c=1,f=this.description.Aa;c<f;c++){var y=this.description.kd(c),v=d.ra.Va(y);y=d.ra.se(y);for(var _=0;_<v;_++)this.ka[l+a]=y,this.ka[s+a]=y,a++}}},h.prototype.sn=function(l){if(this.ka!=null)if(2<l.Ae.length){for(var s=d.ee.Iw(l,this.description),a=[],c=h.Gg(this.description,0),f=h.Gg(this.description,1),y=h.Gg(l,0),v=h.Gg(l,1),_=0,$=1,I=l.Aa;$<I;$++){var k=l.kd($),A=d.ra.Va(k);if(s[$]==-1){var P=d.ra.se(k);for(k=0;k<A;k++)a[y+_]=P,a[v+_]=P,_++}else for(P=this.description.$j(s[$])-2,k=0;k<A;k++)a[y+_]=this.ka[c+P],a[v+_]=this.ka[f+P],_++,P++}this.ka=a}else this.ka=null;this.description=l},h.prototype.Od=function(l,s,a){if(this.$.B())throw d.i.fa("This operation was performed on an Empty Geometry.");if(s==0)return l!=0?a!=0?this.$.H:this.$.C:a!=0?this.$.G:this.$.v;if(a>=d.ra.Va(s))throw d.i.ce();var c=this.description.Pf(s);return 0<=c?(this.ou(),this.ka[h.Gg(this.description,l)+this.description.$j(c)-2+a]):d.ra.se(s)},h.prototype.vD=function(l,s,a,c){if(this.vc(),s==0)l!=0?a!=0?this.$.H=c:this.$.C=c:a!=0?this.$.G=c:this.$.v=c;else{if(a>=d.ra.Va(s))throw d.i.ce();if(!this.hasAttribute(s)){if(d.ra.DG(s,c))return;this.re(s)}s=this.description.Pf(s),this.ou(),this.ka[h.Gg(this.description,l)+this.description.$j(s)-2+a]=c}},h.Gg=function(l,s){return s*(l.Ae.length-2)},h.prototype.Ea=function(l){this.vc();var s=new d.l;return l.A(s),this.$.Ea(s)},h.prototype.isIntersecting=function(l){return l instanceof d.l?this.$.isIntersecting(l):this.$.isIntersecting(l.$)},h.prototype.Ju=function(l,s){this.vc(),l.B()?this.Oa():s!==void 0?this.tu(l,s):this.$.Ju(l.Lg(),l.ih())},h.prototype.offset=function(l,s){this.vc(),this.$.offset(l,s)},h.prototype.normalize=function(){this.vc(),this.$.normalize()},h.prototype.sf=function(l){if(l===void 0){if(l=new d.Sa(this.description),this.B())return l;for(s=this.description.Aa,a=1;a<s;a++)for(c=this.description.Ed(a),f=d.ra.Va(c),y=0;y<f;y++)v=.5*(this.Od(0,c,y)+this.Od(1,c,y)),l.setAttribute(c,y,v);return l.Cb(this.$.gk(),this.$.Jp()),l}if(l.Nf(this.description),this.B())l.Oa();else{for(var s=this.description.Aa,a=1;a<s;a++)for(var c=this.description.kd(a),f=d.ra.Va(c),y=0;y<f;y++){var v=.5*(this.xF(0,c,y)+this.xF(1,c,y));l.setAttribute(c,y,v)}l.Cb(this.$.sf())}},h.prototype.mz=function(){return new d.Sa(this.$.mz())},h.prototype.contains=function(l){return l instanceof d.Sa?!l.B()&&this.$.contains(l.Lg(),l.ih()):this.$.contains(l.$)},h.prototype.dP=function(l){return this.$.contains(l)},h.prototype.Nb=function(l){if(l==this)return!0;if(!(l instanceof h)||this.description!=l.description)return!1;if(this.B())return!!l.B();if(!this.$.Nb(l.$))return!1;for(var s=0,a=2*(this.description.Ae.length-2);s<a;s++)if(this.ka[s]!=l.ka[s])return!1;return!0},h.prototype.cc=function(){var l=this.description.cc();if(l=d.O.Th(l,this.$.cc()),!this.B()&&this.ka!=null)for(var s=0,a=2*(this.description.Ae.length-2);s<a;s++)l=d.O.Th(l,this.ka[s]);return l},h.prototype.es=function(){return this.$.v},h.prototype.gs=function(){return this.$.G},h.prototype.ds=function(){return this.$.C},h.prototype.fs=function(){return this.$.H},h.prototype.mg=function(){return d.pi.gm(this,null)},h.prototype.toString=function(){return this.B()?"Envelope: []":"Envelope: ["+this.$.v+", "+this.$.G+", "+this.$.C+", "+this.$.H+"]"},h}(d.aa);d.Fh=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a){h===void 0?this.Oa():(this.v=h,this.G=l,this.C=s,this.H=a)}return x.construct=function(h,l,s,a){var c=new x;return c.v=h,c.G=l,c.C=s,c.H=a,c},x.prototype.K=function(h,l,s,a){typeof h=="number"?s!==void 0?(this.v=h,this.G=l,this.C=s,this.H=a,this.normalize()):(this.v=h,this.G=l,this.C=h,this.H=l):h instanceof d.h?l!==void 0?(this.v=h.x-.5*l,this.C=this.v+l,this.G=h.y-.5*s,this.H=this.G+s,this.normalize()):(this.v=h.x,this.G=h.y,this.C=h.x,this.H=h.y):h instanceof x?this.K(h.v,h.G,h.C,h.H):h instanceof d.Nc&&(h.B()||l.B()?this.Oa():(this.v=h.oa,this.C=h.va,this.G=l.oa,this.H=l.va))},x.prototype.Zw=function(h,l){if(l!==void 0)if(l==0)this.Oa();else{this.v=h[0].x,this.G=h[0].y,this.C=this.v,this.H=this.G;for(var s=1;s<l;s++){var a=h[s];a.x<this.v?this.v=a.x:a.x>this.C&&(this.C=a.x),a.y<this.G?this.G=a.y:a.y>this.H&&(this.H=a.y)}}else if(h==null||h.length==0)this.Oa();else for(a=h[0],this.K(a.x,a.y),s=1;s<h.length;s++)l=h[s],this.Lk(l.x,l.y)},x.prototype.Oa=function(){this.H=this.C=this.G=this.v=NaN},x.prototype.B=function(){return isNaN(this.v)},x.prototype.Zb=function(h,l){typeof h=="number"?this.B()?(this.v=h,this.G=l,this.C=h,this.H=l):(this.v>h?this.v=h:this.C<h&&(this.C=h),this.G>l?this.G=l:this.H<l&&(this.H=l)):h instanceof d.h||h instanceof d.Nd?this.Zb(h.x,h.y):h instanceof x&&!h.B()&&(this.Zb(h.v,h.G),this.Zb(h.C,h.H))},x.prototype.Lk=function(h,l){this.v>h?this.v=h:this.C<h&&(this.C=h),this.G>l?this.G=l:this.H<l&&(this.H=l)},x.prototype.W=function(h,l){this.B()||(this.v-=h,this.C+=h,this.G-=l,this.H+=l,(this.v>this.C||this.G>this.H)&&this.Oa())},x.prototype.scale=function(h){0>h&&this.Oa(),this.B()||(this.v*=h,this.C*=h,this.G*=h,this.H*=h)},x.prototype.zoom=function(h,l){this.B()||this.K(this.sf(),h*this.R(),l*this.ca())},x.prototype.isIntersecting=function(h){return!this.B()&&!h.B()&&(this.v<=h.v?this.C>=h.v:h.C>=this.v)&&(this.G<=h.G?this.H>=h.G:h.H>=this.G)},x.prototype.HG=function(h){return(this.v<=h.v?this.C>=h.v:h.C>=this.v)&&(this.G<=h.G?this.H>=h.G:h.H>=this.G)},x.prototype.Ea=function(h){return!this.B()&&!h.B()&&(h.v>this.v&&(this.v=h.v),h.C<this.C&&(this.C=h.C),h.G>this.G&&(this.G=h.G),h.H<this.H&&(this.H=h.H),(h=this.v<=this.C&&this.G<=this.H)||this.Oa(),h)},x.prototype.mB=function(h){switch(h){case 0:return d.h.construct(this.v,this.G);case 1:return d.h.construct(this.v,this.H);case 2:return d.h.construct(this.C,this.H);case 3:return d.h.construct(this.C,this.G);default:throw d.i.ce()}},x.prototype.nB=function(h){if(h==null||4>h.length)throw d.i.N();h[0]!=null?h[0].ma(this.v,this.G):h[0]=d.h.construct(this.v,this.G),h[1]!=null?h[1].ma(this.v,this.H):h[1]=d.h.construct(this.v,this.H),h[2]!=null?h[2].ma(this.C,this.H):h[2]=d.h.construct(this.C,this.H),h[3]!=null?h[3].ma(this.C,this.G):h[3]=d.h.construct(this.C,this.G)},x.prototype.wF=function(){return this.B()?0:this.R()*this.ca()},x.prototype.yR=function(){return this.B()?0:2*(this.R()+this.ca())},x.prototype.gk=function(){return(this.C+this.v)/2},x.prototype.Jp=function(){return(this.H+this.G)/2},x.prototype.R=function(){return this.C-this.v},x.prototype.ca=function(){return this.H-this.G},x.prototype.move=function(h,l){this.B()||(this.v+=h,this.G+=l,this.C+=h,this.H+=l)},x.prototype.Ju=function(h,l){if(l!==void 0)this.move(h-this.gk(),l-this.Jp());else if(h instanceof d.h)this.Ju(h.x,h.y);else{if(!(h instanceof d.Sa))throw d.i.N();l=(this.C-this.v)/2;var s=(this.H-this.G)/2;this.v=h.Lg()-l,this.C=h.Lg()+l,this.G=h.ih()-s,this.H=h.ih()+s}},x.prototype.offset=function(h,l){this.v+=h,this.C+=h,this.G+=l,this.H+=l},x.prototype.normalize=function(){if(!this.B()){var h=Math.min(this.v,this.C),l=Math.max(this.v,this.C);this.v=h,this.C=l,h=Math.min(this.G,this.H),l=Math.max(this.G,this.H),this.G=h,this.H=l}},x.prototype.dn=function(h){h.ma(this.v,this.G)},x.prototype.$I=function(h){h.ma(this.C,this.G)},x.prototype.cJ=function(h){h.ma(this.v,this.H)},x.prototype.en=function(h){h.ma(this.C,this.H)},x.prototype.fT=function(){return this.B()||this.v<=this.C&&this.G<=this.H},x.prototype.sf=function(){return d.h.construct((this.C+this.v)/2,(this.H+this.G)/2)},x.prototype.mz=function(){return d.h.construct(this.v,this.G)},x.prototype.contains=function(h,l){if(l!==void 0)return h>=this.v&&h<=this.C&&l>=this.G&&l<=this.H;if(h instanceof d.Sa)return this.contains(h.Lg(),h.ih());if(h instanceof d.h)return this.contains(h.x,h.y);if(h instanceof x)return h.v>=this.v&&h.C<=this.C&&h.G>=this.G&&h.H<=this.H;throw d.i.N()},x.prototype.hm=function(h,l){if(l!==void 0)return h>this.v&&h<this.C&&l>this.G&&l<this.H;if(h instanceof d.h)return this.hm(h.x,h.y);if(h instanceof x)return h.v>this.v&&h.C<this.C&&h.G>this.G&&h.H<this.H;throw d.i.N()},x.prototype.Nb=function(h){return h==this||h instanceof x&&(!(!this.B()||!h.B())||this.v==h.v&&this.G==h.G&&this.C==h.C&&this.H==h.H)},x.prototype.cc=function(){var h=this.v;h=d.O.truncate(h^h>>>32);var l=d.O.Th(h);return h=this.C,h=d.O.truncate(h^h>>>32),l=d.O.Th(h,l),h=this.G,h=d.O.truncate(h^h>>>32),l=d.O.Th(h,l),h=this.H,h=d.O.truncate(h^h>>>32),d.O.Th(h,l)},x.prototype.xr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.v)+Math.abs(this.C)+Math.abs(this.G)+Math.abs(this.H)+1)},x.prototype.zy=function(h,l){var s=this.Zj(h),a=this.Zj(l);if(s&a)return 0;if(!(s|a))return 4;var c=(s!=0?1:0)|(a!=0?2:0);do{var f=l.x-h.x,y=l.y-h.y;if(f>y?s&x.YC?(s&x.ju?(h.y+=y*(this.v-h.x)/f,h.x=this.v):(h.y+=y*(this.C-h.x)/f,h.x=this.C),s=this.Zj(h)):a&x.YC?(a&x.ju?(l.y+=y*(this.v-l.x)/f,l.x=this.v):(l.y+=y*(this.C-l.x)/f,l.x=this.C),a=this.Zj(l)):s!=0?(s&x.ku?(h.x+=f*(this.G-h.y)/y,h.y=this.G):(h.x+=f*(this.H-h.y)/y,h.y=this.H),s=this.Zj(h)):(a&x.ku?(l.x+=f*(this.G-l.y)/y,l.y=this.G):(l.x+=f*(this.H-l.y)/y,l.y=this.H),a=this.Zj(l)):s&x.ZC?(s&x.ku?(h.x+=f*(this.G-h.y)/y,h.y=this.G):(h.x+=f*(this.H-h.y)/y,h.y=this.H),s=this.Zj(h)):a&x.ZC?(a&x.ku?(l.x+=f*(this.G-l.y)/y,l.y=this.G):(l.x+=f*(this.H-l.y)/y,l.y=this.H),a=this.Zj(l)):s!=0?(s&x.ju?(h.y+=y*(this.v-h.x)/f,h.x=this.v):(h.y+=y*(this.C-h.x)/f,h.x=this.C),s=this.Zj(h)):(a&x.ju?(l.y+=y*(this.v-l.x)/f,l.x=this.v):(l.y+=y*(this.C-l.x)/f,l.x=this.C),a=this.Zj(l)),s&a)return 0}while(s|a);return c},x.prototype.Zj=function(h){return(h.x<this.v?1:0)|(h.x>this.C?1:0)<<1|(h.y<this.G?1:0)<<2|(h.y>this.H?1:0)<<3},x.prototype.Bi=function(h){return!this.B()&&(this.R()<=h||this.ca()<=h)},x.prototype.tb=function(h){return h instanceof d.h?Math.sqrt(this.iK(h)):Math.sqrt(this.px(h))},x.prototype.px=function(h){var l=0,s=0,a=this.v-h.C;return a>l&&(l=a),(a=this.G-h.H)>s&&(s=a),(a=h.v-this.C)>l&&(l=a),(a=h.G-this.H)>s&&(s=a),l*l+s*s},x.prototype.iK=function(h){var l=0,s=0,a=this.v-h.x;return a>l&&(l=a),(a=this.G-h.y)>s&&(s=a),(a=h.x-this.C)>l&&(l=a),(a=h.y-this.H)>s&&(s=a),l*l+s*s},x.prototype.cn=function(h){this.B()?h.Oa():h.K(this.v,this.C)},x.ju=1,x.ku=4,x.YC=3,x.ZC=12,x}();d.l=O}(Y||(Y={})),function(d){var O,x;(x=O||(O={}))[x.initialize=0]="initialize",x[x.initializeRed=1]="initializeRed",x[x.initializeBlue=2]="initializeBlue",x[x.initializeRedBlue=3]="initializeRedBlue",x[x.sweep=4]="sweep",x[x.sweepBruteForce=5]="sweepBruteForce",x[x.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce",x[x.sweepRedBlue=7]="sweepRedBlue",x[x.sweepRed=8]="sweepRed",x[x.sweepBlue=9]="sweepBlue",x[x.iterate=10]="iterate",x[x.iterateRed=11]="iterateRed",x[x.iterateBlue=12]="iterateBlue",x[x.iterateBruteForce=13]="iterateBruteForce",x[x.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce",x[x.resetRed=15]="resetRed",x[x.resetBlue=16]="resetBlue";var h=function(){function l(s,a){this.ci=s,this.dH=a}return l.prototype.nr=function(s,a,c){this.ci.JX(c,s,a,this.dH)},l.prototype.$p=function(s){return this.ci.Rr(s,this.dH)},l}();O=function(){function l(){this.ow=this.oo=this.ff=this.rd=null,this.wq=new d.l,this.Am=this.Hj=this.Ij=this.Ad=this.Ef=this.Ld=this.cw=this.fo=this.qd=this.Eb=null,this.Xb=-1,this.qa=0,this.Nk()}return l.prototype.kr=function(){this.Nk(),this.Pv=!0,this.Eb==null?(this.fo=new d.ia(0),this.Eb=[]):(this.fo.Bh(0),this.Eb.length=0)},l.prototype.ad=function(s,a){if(!this.Pv)throw d.i.Hb();var c=new d.l;c.K(a),this.fo.add(s),this.Eb.push(c)},l.prototype.Fp=function(){if(!this.Pv)throw d.i.Hb();this.Pv=!1,this.Eb!=null&&0<this.Eb.length&&(this.Xb=0,this.Ic=!1)},l.prototype.pK=function(){this.Nk(),this.Ov=!0,this.Eb==null?(this.fo=new d.ia(0),this.Eb=[]):(this.fo.Bh(0),this.Eb.length=0)},l.prototype.JD=function(s,a){if(!this.Ov)throw d.i.Hb();var c=new d.l;c.K(a),this.fo.add(s),this.Eb.push(c)},l.prototype.iF=function(){if(!this.Ov)throw d.i.Hb();this.Ov=!1,this.Eb!=null&&0<this.Eb.length&&this.qd!=null&&0<this.qd.length&&(this.Xb==-1||this.Xb==2?this.Xb=3:this.Xb!=3&&(this.Xb=1),this.Ic=!1)},l.prototype.oK=function(){this.Nk(),this.Nv=!0,this.qd==null?(this.cw=new d.ia(0),this.qd=[]):(this.cw.Bh(0),this.qd.length=0)},l.prototype.ED=function(s,a){if(!this.Nv)throw d.i.Hb();var c=new d.l;c.K(a),this.cw.add(s),this.qd.push(c)},l.prototype.hF=function(){if(!this.Nv)throw d.i.Hb();this.Nv=!1,this.Eb!=null&&0<this.Eb.length&&this.qd!=null&&0<this.qd.length&&(this.Xb==-1||this.Xb==1?this.Xb=3:this.Xb!=3&&(this.Xb=2),this.Ic=!1)},l.prototype.next=function(){if(this.Ic)return!1;for(var s=!0;s;)switch(this.Xb){case 0:s=this.Gz();break;case 1:s=this.rS();break;case 2:s=this.oS();break;case 3:s=this.qS();break;case 4:s=this.UX();break;case 5:s=this.QX();break;case 6:s=this.RX();break;case 7:s=this.SX();break;case 8:s=this.ux();break;case 9:s=this.iC();break;case 10:s=this.Uz();break;case 11:s=this.jT();break;case 12:s=this.gT();break;case 13:s=this.hT();break;case 14:s=this.iT();break;case 15:s=this.kJ();break;case 16:s=this.jJ();break;default:throw d.i.Qa()}return!this.Ic},l.prototype.aC=function(s){this.qa=s},l.prototype.uz=function(s){return this.Eb[s]},l.prototype.az=function(s){return this.qd[s]},l.prototype.nl=function(s){return this.fo.read(s)},l.prototype.hl=function(s){return this.cw.read(s)},l.Tz=function(s){return!(1&~s)},l.eq=function(s){return!(1&s)},l.prototype.Nk=function(){this.Pv=this.Nv=this.Ov=!1,this.Cf=this.Df=this.Rg=this.pe=-1,this.Ic=!0},l.prototype.Gz=function(){if(this.Af=this.Vf=-1,10>this.Eb.length)return this.pe=this.Eb.length,this.Xb=5,!0;this.rd==null&&(this.rd=new d.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new d.ia(0)),this.rd.kr();for(var s=0;s<this.Eb.length;s++){var a=this.Eb[s];this.rd.Br(a.v,a.C)}for(this.rd.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ld.resize(0),s=0;s<2*this.Eb.length;s++)this.Ld.add(s);return this.Kt(this.Ld,2*this.Eb.length,!0),this.pe=2*this.Eb.length,this.Xb=4,!0},l.prototype.rS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;this.rd==null&&(this.rd=new d.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new d.ia(0)),this.rd.kr();for(var s=0;s<this.Eb.length;s++){var a=this.Eb[s];this.rd.Br(a.v,a.C)}for(this.rd.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ld.resize(0),s=0;s<2*this.Eb.length;s++)this.Ld.add(s);return this.Kt(this.Ld,this.Ld.size,!0),this.pe=this.Ld.size,this.Df!=-1&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),this.Xb=7,this.jJ()},l.prototype.oS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;this.ff==null&&(this.ff=new d.sr(!0),this.ow=this.ff.getIterator(),this.Ef=new d.ia(0)),this.ff.kr();for(var s=0;s<this.qd.length;s++){var a=this.qd[s];this.ff.Br(a.v,a.C)}for(this.ff.Fp(),this.Ef.Jb(2*this.qd.length),this.Ef.resize(0),s=0;s<2*this.qd.length;s++)this.Ef.add(s);return this.Kt(this.Ef,this.Ef.size,!1),this.Rg=this.Ef.size,this.Cf!=-1&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Xb=7,this.kJ()},l.prototype.qS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;this.rd==null&&(this.rd=new d.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new d.ia(0)),this.ff==null&&(this.ff=new d.sr(!0),this.ow=this.ff.getIterator(),this.Ef=new d.ia(0)),this.rd.kr();for(var s=0;s<this.Eb.length;s++){var a=this.Eb[s];this.rd.Br(a.v,a.C)}for(this.rd.Fp(),this.ff.kr(),s=0;s<this.qd.length;s++)a=this.qd[s],this.ff.Br(a.v,a.C);for(this.ff.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ef.Jb(2*this.qd.length),this.Ld.resize(0),this.Ef.resize(0),s=0;s<2*this.Eb.length;s++)this.Ld.add(s);for(s=0;s<2*this.qd.length;s++)this.Ef.add(s);return this.Kt(this.Ld,this.Ld.size,!0),this.Kt(this.Ef,this.Ef.size,!1),this.pe=this.Ld.size,this.Rg=this.Ef.size,this.Df!=-1&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),this.Cf!=-1&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Xb=7,!0},l.prototype.UX=function(){var s=this.Ld.get(--this.pe),a=s>>1;return l.eq(s)?(this.rd.remove(a),this.pe!=0||(this.Af=this.Vf=-1,this.Ic=!0,!1)):(this.oo.EB(this.Eb[a].v,this.Eb[a].C,this.qa),this.Vf=a,this.Xb=10,!0)},l.prototype.QX=function(){return--this.pe==-1?(this.Af=this.Vf=-1,this.Ic=!0,!1):(this.Rg=this.Vf=this.pe,this.Xb=13,!0)},l.prototype.RX=function(){return--this.pe==-1?(this.Af=this.Vf=-1,this.Ic=!0,!1):(this.Vf=this.pe,this.Rg=this.qd.length,this.Xb=14,!0)},l.prototype.SX=function(){var s=this.Ld.get(this.pe-1),a=this.Ef.get(this.Rg-1),c=this.Rr(s,!0),f=this.Rr(a,!1);return c>f?this.ux():c<f?this.iC():l.Tz(s)?this.ux():l.Tz(a)?this.iC():this.ux()},l.prototype.ux=function(){var s=this.Ld.get(--this.pe),a=s>>1;if(l.eq(s))return this.Df!=-1&&this.Ij.get(a)!=-1?(this.Ad.jd(this.Df,this.Ij.get(a)),this.Ij.set(a,-1)):this.rd.remove(a),this.pe!=0||(this.Af=this.Vf=-1,this.Ic=!0,!1);if(this.Cf!=-1&&0<this.Ad.bs(this.Cf))for(s=this.Ad.rc(this.Cf);s!=-1;){var c=this.Ad.getData(s);this.ff.vj(c),this.Hj.set(c,-1),c=this.Ad.lb(s),this.Ad.jd(this.Cf,s),s=c}return 0<this.ff.size()?(this.ow.EB(this.Eb[a].v,this.Eb[a].C,this.qa),this.Vf=a,this.Xb=12):(this.Df==-1&&(this.Ad==null&&(this.Ad=new d.jp),this.Ij=new d.ia(0),this.Ij.resize(this.Eb.length,-1),this.Ij.Wj(-1,0,this.Eb.length),this.Df=this.Ad.Ph(1)),this.Ij.set(a,this.Ad.addElement(this.Df,a)),this.Xb=7),!0},l.prototype.iC=function(){var s=this.Ef.get(--this.Rg),a=s>>1;if(l.eq(s))return this.Cf!=-1&&this.Hj.get(a)!=-1?(this.Ad.jd(this.Cf,this.Hj.get(a)),this.Hj.set(a,-1)):this.ff.remove(a),this.Rg!=0||(this.Af=this.Vf=-1,this.Ic=!0,!1);if(this.Df!=-1&&0<this.Ad.bs(this.Df))for(s=this.Ad.rc(this.Df);s!=-1;){var c=this.Ad.getData(s);this.rd.vj(c),this.Ij.set(c,-1),c=this.Ad.lb(s),this.Ad.jd(this.Df,s),s=c}return 0<this.rd.size()?(this.oo.EB(this.qd[a].v,this.qd[a].C,this.qa),this.Af=a,this.Xb=11):(this.Cf==-1&&(this.Ad==null&&(this.Ad=new d.jp),this.Hj=new d.ia(0),this.Hj.resize(this.qd.length,-1),this.Hj.Wj(-1,0,this.qd.length),this.Cf=this.Ad.Ph(0)),this.Hj.set(a,this.Ad.addElement(this.Cf,a)),this.Xb=7),!0},l.prototype.Uz=function(){if(this.Af=this.oo.next(),this.Af!=-1)return!1;var s=this.Ld.get(this.pe)>>1;return this.rd.vj(s),this.Xb=4,!0},l.prototype.jT=function(){if(this.Vf=this.oo.next(),this.Vf!=-1)return!1;this.Af=this.Vf=-1;var s=this.Ef.get(this.Rg)>>1;return this.ff.vj(s),this.Xb=7,!0},l.prototype.gT=function(){if(this.Af=this.ow.next(),this.Af!=-1)return!1;var s=this.Ld.get(this.pe)>>1;return this.rd.vj(s),this.Xb=7,!0},l.prototype.hT=function(){if(--this.Rg==-1)return this.Xb=5,!0;this.wq.K(this.Eb[this.pe]);var s=this.Eb[this.Rg];return this.wq.W(this.qa,this.qa),!this.wq.isIntersecting(s)||(this.Af=this.Rg,!1)},l.prototype.iT=function(){if(--this.Rg==-1)return this.Xb=6,!0;this.wq.K(this.Eb[this.pe]);var s=this.qd[this.Rg];return this.wq.W(this.qa,this.qa),!this.wq.isIntersecting(s)||(this.Af=this.Rg,!1)},l.prototype.kJ=function(){return this.rd==null?(this.Ic=!0,!1):(this.pe=this.Ld.size,0<this.rd.size()&&this.rd.reset(),this.Df!=-1&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),this.Ic=!1,!0)},l.prototype.jJ=function(){return this.ff==null?(this.Ic=!0,!1):(this.Rg=this.Ef.size,0<this.ff.size()&&this.ff.reset(),this.Cf!=-1&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Ic=!1,!0)},l.prototype.Kt=function(s,a,c){this.Am==null&&(this.Am=new d.Xt),c=new h(this,c),this.Am.sort(s,0,a,c)},l.prototype.JX=function(s,a,c,f){var y=this;s.Vd(a,c,function(v,_){var $=y.Rr(v,f),I=y.Rr(_,f);return $<I||$==I&&l.eq(v)&&l.Tz(_)?-1:1})},l.prototype.Rr=function(s,a){var c=.5*this.qa;return a?(a=this.Eb[s>>1],l.eq(s)?a.G-c:a.H+c):(a=this.qd[s>>1],l.eq(s)?a.G-c:a.H+c)},l}(),d.xC=O}(Y||(Y={})),function(d){var O=function(){function x(){}return x.construct=function(h,l,s,a,c,f){var y=new x;return y.v=h,y.G=l,y.Ye=s,y.C=a,y.H=c,y.Bg=f,y},x.prototype.Oa=function(){this.Ye=this.v=NaN},x.prototype.B=function(){return isNaN(this.v)},x.prototype.XS=function(){return isNaN(this.Ye)},x.prototype.K=function(h,l,s,a,c,f){a!==void 0?typeof h=="number"?(this.v=h,this.G=l,this.Ye=s,this.C=a,this.H=c,this.Bg=f):(this.v=h.x-.5*l,this.C=this.v+l,this.G=h.y-.5*s,this.H=this.G+s,this.Ye=h.z-.5*a,this.Bg=this.Ye+a):(this.v=h,this.G=l,this.Ye=s,this.C=h,this.H=l,this.Bg=s)},x.prototype.move=function(h){this.v+=h.x,this.G+=h.y,this.Ye+=h.z,this.C+=h.x,this.H+=h.y,this.Bg+=h.z},x.prototype.copyTo=function(h){h.v=this.v,h.G=this.G,h.C=this.C,h.H=this.H},x.prototype.Lk=function(h,l,s){this.v>h?this.v=h:this.C<h&&(this.C=h),this.G>l?this.G=l:this.H<l&&(this.H=l),isNaN(this.Ye)==0?this.Ye>s?this.Ye=s:this.Bg<s&&(this.Bg=s):this.Bg=this.Ye=s},x.prototype.Zb=function(h,l,s){if(typeof h=="number")this.B()?(this.v=h,this.G=l,this.Ye=s,this.C=h,this.H=l,this.Bg=s):this.Lk(h,l,s);else if(h instanceof d.Nd)this.Zb(h.x,h.y,h.z);else{if(!(h instanceof x))throw d.i.N();h.B()||(this.Zb(h.v,h.G,h.Ye),this.Zb(h.C,h.H,h.Bg))}},x.prototype.construct=function(h,l,s){h.B()||l.B()?this.Oa():(this.v=h.oa,this.C=h.va,this.G=l.oa,this.H=l.va,this.Ye=s.oa,this.Bg=s.va)},x.prototype.nB=function(h){if(h==null||8>h.length)throw d.i.N();h[0]=new d.Nd(this.v,this.G,this.Ye),h[1]=new d.Nd(this.v,this.H,this.Ye),h[2]=new d.Nd(this.C,this.H,this.Ye),h[3]=new d.Nd(this.C,this.G,this.Ye),h[4]=new d.Nd(this.v,this.G,this.Bg),h[5]=new d.Nd(this.v,this.H,this.Bg),h[6]=new d.Nd(this.C,this.H,this.Bg),h[7]=new d.Nd(this.C,this.G,this.Bg)},x.prototype.Zw=function(h){if(h==null||h.length==0)this.Oa();else{var l=h[0];for(this.K(l.x,l.y,l.z),l=1;l<h.length;l++){var s=h[l];this.Lk(s.x,s.y,s.z)}}},x}();d.OK=O}(Y||(Y={})),function(d){(function(O){O.Qa=function(){var x=Error();return x.message="Internal Error",x},O.Ie=function(){var x=Error();return x.message="Not Implemented",x},O.Xk=function(){var x=Error();return x.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular",x},O.Hb=function(){var x=Error();return x.message="Invalid Call",x},O.N=function(x){var h=Error();return h.message="Illegal Argument Exception",x!==void 0&&(h.message+=": "+x),h},O.fu=function(x){var h=Error();return h.message=x!==void 0?"Runtime Exception: "+x:"Runtime Exception.",h},O.fa=function(x){var h=Error();return h.message="Geometry Exception: "+x,h},O.GK=function(){var x=Error();return x.message="Assert Failed Exception",x},O.ce=function(){var x=Error();return x.message="IndexOutOfBoundsException",x},O.WC=function(){var x=Error();return x.message="UserCancelException",x}})(d.i||(d.i={}))}(Y||(Y={})),function(d){(d=d.bm||(d.bm={}))[d.forward=0]="forward",d[d.reverse=1]="reverse"}(Y||(Y={})),function(d){var O=function(){function l(s,a){this.Wa=s,this.FH=a,this.LH=-1,this.sl=!1}return l.prototype.qe=function(){},l.prototype.next=function(){if(++this.LH==this.FH.I())return null;var s=this.FH.Na(this.LH);s.scale(this.Wa.ec);var a=new d.Da;return this.Wa.sy(s,this.sl,a),a},l.prototype.La=function(){return 0},l}(),x=function(){function l(s,a,c){this.Wa=s,this.rw=a,this.Xn=!1,this.co=c,this.bw=[0],this.sk=[0],this.Nj=[0],this.Gs=[0],this.sl=!1,this.qq=new d.Da,this.uk=[]}return l.prototype.qe=function(){},l.prototype.next=function(){if(this.Xn){this.Xn=!1,this.sd.ha();var s=d.aa.jg(this.qq);return d.Fg.Mk(s,this.Wa.Aq,!0,!0,this.Wa.Ub)}if(this.sd==null&&(this.sd=this.rw.Ga(),this.sd.$a(),this.co!=null&&this.co.Yk(null,0)),!this.sd.Ha()){if(!this.sd.$a())return null;this.co!=null&&this.co.Yk(null,0)}s=null,this.sk[0]=0,this.FA=this.bw[0]=0,this.di=NaN,this.Xn=!1;for(var a=this.uk.length=0,c=new d.h,f=new d.h,y=[0];this.sd.Ha()&&8>this.FA;){var v=this.sd.ha();if(c.L(v.ac()),f.L(v.wc()),c.scale(this.Wa.ec),f.scale(this.Wa.ec),d.cj.Mu(c,f)?c.x=f.x:d.cj.Ku(c,f)&&(f.x=c.x),this.uk.length=0,d.cj.tF(this.Wa.Tb,this.Wa.kc,this.Wa.ze,c,f,this.Wa.QA,this.Wa.Zs,y,this.Nj,this.Gs,this.uk,this.bw),this.co!=null&&(v=this.uk.slice(0),this.co.qG(this.co.da()-1,v,v.length-1)),d.cj.Lu(c,f)?(this.qq.Oa(),this.Wa.sy(c,this.sl,this.qq),this.Xn=!0):(this.qq.Oa(),this.Xn=this.xy(y[0],this.qq)),this.Xn){if(this.sd.li(),this.sd.Ez()){this.sd.li(),this.sd.ha();break}this.sd.DW();break}s==null&&(s=new d.Da).Yk(null,0),this.OD(s),a++}if(this.bw[0]=0,0<a){for(y=this.sd.wb();0<a;)this.sd.li(),c.L(this.rw.Na(this.sd.wb())),f.L(this.rw.Na(this.sd.ik())),c.scale(this.Wa.ec),f.scale(this.Wa.ec),this.sl&&(d.cj.Mu(c,f)?c.x=f.x:d.cj.Ku(c,f)&&(f.x=c.x)),this.uk.length=0,d.cj.tF(this.Wa.Tb,this.Wa.kc,this.Wa.ze,f,c,this.Wa.QA,this.Wa.Zs,null,this.Nj,this.Gs,this.uk,this.bw),this.OD(s),a--;return c.L(this.rw.Na(this.sd.wb())),c.scale(this.Wa.ec),h.Hr(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,c,this.di+1.570796326794897,this.di+4.71238898038469,this.Wa.ao,this.sl,this.sk,s,NaN,NaN),this.sd.Vb(y),this.sd.ha(),a=d.ta.kj(null,s,!0),d.Fg.Mk(s,a,!0,!0,this.Wa.Ub)}return this.Xn=!1,this.sd.ha(),s=d.aa.jg(this.qq),d.Fg.Mk(s,this.Wa.Aq,!0,!0,this.Wa.Ub)},l.prototype.OD=function(s){var a=this.uk[0],c=this.Nj[0]-1.570796326794897,f=this.Gs[0]+1.570796326794897;if(!isNaN(this.di)){if(this.di>=this.Nj[0]){var y=this.di+1.570796326794897;c=y+3.141592653589793-(this.di-this.Nj[0])}else c=(y=this.di+1.570796326794897)+3.141592653589793-(6.283185307179586-(this.Nj[0]-this.di));var v=!(this.di>=this.Nj[0]&&3.141592653589793>=this.di-this.Nj[0])&&!(this.di<this.Nj[0]&&3.141592653589793<=this.Nj[0]-this.di),_=!1;if(Math.abs(c-y)<=.5*this.Wa.ao)if(v){var $=s.Na(s.I()-2);$.scale(this.Wa.ec);var I=new d.ga(0);for(d.kb.Xy(this.Wa.Tb,this.Wa.kc,a.x,a.y,$.x,$.y,I),$=I.u;$<=y;)$+=6.283185307179586;for(;$>y;)$-=6.283185307179586;$<c&&(_=!0)}else _=!0;_?(s.DB(0,s.I()-1),this.sl||((a=new d.h).L(s.Na(s.I()-1)),a.scale(this.Wa.ec),-3.141592653589793>a.x-this.sk[0]?this.sk[0]-=6.283185307179586:3.141592653589793<a.x-this.sk[0]&&(this.sk[0]+=6.283185307179586)),v||(c=.5*(c+y))):(v?((y=new d.h).L(a),y.scale(1/this.Wa.ec),s.wf(0,-1,y)):h.Hr(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,this.uk[0],y,c,this.Wa.ao,this.sl,this.sk,s,NaN,NaN),this.FA+=1)}h.qy(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,this.Wa.ze,this.uk,c,f,this.sl,this.sk,s),this.di=this.Gs[0]},l.prototype.xy=function(s,a){return this.Wa.xy(this.uk,s,this.Nj[0],this.Gs[0],this.sl,a)},l.prototype.La=function(){return 0},l}(),h=function(){function l(){}return l.buffer=function(s,a,c,f,y,v){if(s==null)throw d.i.N("Geometry::Geodesic_bufferer::buffer");if(s.B())return new d.Da(s.description);var _=new l;_.Qg=a,_.Jc=d.cb.sc(a);var $=d.cb.vv(_.Jc);if(_.Ub=v,_.Tb=d.cb.ev(_.Jc),_.kc=$*(2-$),_.ec=_.Jc.Hd().ai,_.qa=_.Qg.Kn(),_.Aq=_.Jc.Kn(),_.Zs=_.Aq*_.ec,_.zq=1.570796326794897/_.ec,_.OY=3.141592653589793/_.ec,_.Js=6.283185307179586/_.ec,_.PY=_.Js/6,_.LA=0,_.NY=1.5707963267948966*_.Tb/_.LA,c==4?(_.ze=2,_.Wv=!0):(_.ze=c,_.Wv=!1),_.Ka=f,_.rb=Math.abs(f),isNaN(y)||.001>y?_.xX():_.$n=y,c=s.getType(),d.aa.yd(c)?((c=new d.Ta(s.description)).oc(s,!0),s=c,c=1607):c==197&&(c=new d.l,s.A(c),c.R()<=_.qa||c.ca()<=_.qa?((c=new d.Ta(s.description)).ad(s,!1),s=c,c=1607):((c=new d.Da(s.description)).ad(s,!1),s=c,c=1736)),_.yX(),d.aa.Rn(c)||_.zX(),_.rb<=.5*_.$n)return c!=1736?new d.Da(s.description):_.Wv?s:d.cj.Qr(s,_.Qg,_.ze,_.QA,-1,v);if(0>_.Ka&&c!=1736)return new d.Da(s.description);if(_.Wv&&d.aa.Hc(c)?(a=d.cj.Qr(s,a,4,NaN,_.$n,v),s=d.cb.zh(a,_.Qg,_.Jc)):s=d.cb.zh(s,_.Qg,_.Jc),(s=d.Hh.lj(s,_.Jc)).B())return new d.Da(s.description);switch(!_.Wv&&d.aa.Hc(c)&&(s=d.cj.pI(_.ec,s)),s=l.KX(s,_.Jc),c){case 1736:a=_.UN(s);break;case 1607:a=_.VN(s);break;case 550:a=_.SN(s);break;case 33:a=_.TN(s);break;default:throw d.i.fa("corrupted_geometry")}return(_=d.cb.zh(a,_.Jc,_.Qg)).Jl(s.description),_},l.prototype.UN=function(s){var a=new d.Da;s=new x(this,s,a),s=d.Gh.local().V(s,this.Jc,this.Ub).next(),s=d.ip.nj(s,this.Jc,2);var c=new d.Dd;return c.scale(1/this.ec,1/this.ec),a.Oc(c),a=d.ip.nj(a,this.Jc,2),0<=this.Ka?d.Gh.local().V(a,s,this.Jc,this.Ub):d.kp.local().V(a,s,this.Jc,this.Ub)},l.prototype.VN=function(s){return s=new x(this,s,null),s=d.Gh.local().V(s,this.Jc,this.Ub).next(),d.ip.nj(s,this.Jc,2)},l.prototype.SN=function(s){return s=new O(this,s),s=d.Gh.local().V(s,this.Jc,this.Ub).next(),d.ip.nj(s,this.Jc,2)},l.prototype.TN=function(s){(s=s.D()).scale(this.ec);var a=new d.Da;return this.sy(s,!1,a),d.ip.nj(a,this.Jc,2)},l.prototype.xy=function(s,a,c,f,y,v){var _=s[0],$=s[s.length-1],I=_.y>$.y?_.y:$.y,k=d.F.q(this.Tb,this.kc,_.y<$.y?_.y:$.y);if(I=d.F.q(this.Tb,this.kc,I),.001<this.LA-(k+a+this.rb)&&.001<this.LA+(I-a-this.rb))return!1;k=(a=c-1.570796326794897)-3.141592653589793,I=a+3.141592653589793;var A=(c=f+1.570796326794897)+3.141592653589793,P=[NaN],D=[NaN],j=[NaN],B=[NaN];if(f=!1,l.dJ(this.Tb,this.kc,this.rb,_,a,k,$,c,P,D),l.dJ(this.Tb,this.kc,this.rb,$,A,c,_,k,j,B),(c<P[0]&&P[0]<A||c<D[0]&&D[0]<A)&&(f=!0),f||(k<j[0]&&j[0]<a||k<B[0]&&B[0]<a)&&(f=!0),!f&&y)return!1;for(var q=[],z=s.length-1;0<=z;z--)q.push(s[z]);return v.Oa(),v.Yk(null,0),z=[0],l.qy(this.Tb,this.kc,this.ec,this.rb,this.ze,s,a,c,y,z,v),l.Hr(this.Tb,this.kc,this.ec,this.rb,$,c,A,this.ao,y,z,v,P[0],D[0]),l.qy(this.Tb,this.kc,this.ec,this.rb,this.ze,q,A,I,y,z,v),l.Hr(this.Tb,this.kc,this.ec,this.rb,_,k,a,this.ao,y,z,v,j[0],B[0]),s=!1,y||(s=this.IE(this.ec,v)),f||s},l.prototype.sy=function(s,a,c){c.Oa(),c.Yk(null,0),l.Hr(this.Tb,this.kc,this.ec,this.rb,s,-this.ao,6.283185307179586,this.ao,a,[0],c,NaN,NaN),a||this.IE(this.ec,c)},l.prototype.IE=function(s,a){var c=this.vO(s,a);return s=this.wO(s,a),c||s},l.prototype.vO=function(s,a){var c=a.I(),f=!1,y=new d.l;if(a.A(y),!d.s.Y(y.H*s,1.570796326794897)&&!d.s.Y(y.G*s,-1.570796326794897))return!1;var v=new d.h;for(--c;0<=c;c--)a.D(c,v),(v.y==y.H&&d.s.Y(v.y*s,1.570796326794897)||v.y==y.G&&d.s.Y(v.y*s,-1.570796326794897))&&(f=!0,this.OI(v,c,a));return f},l.prototype.wO=function(s,a){var c=a.Na(0),f=a.Na(a.I()-1);return 3.141592653589793<Math.abs(c.x-f.x)*s?(this.VV(a),!0):this.uO(a)},l.prototype.uO=function(s){return 0>s.Ke()&&(this.UV(s),!0)},l.prototype.OI=function(s,a,c){var f=c.I(),y=0<a?a-1:f-1;if(f=c.Na(a<f-1?a+1:0),y=c.Na(y),!d.s.Y(f.y,s.y)&&!d.s.Y(f.x,s.x)){var v=new d.h;v.ma(f.x,s.y),c.Cb(a,v)}d.s.Y(y.y,s.y)||d.s.Y(y.x,s.x)||((f=new d.h).ma(y.x,s.y),c.wf(0,a,f))},l.prototype.VV=function(s){var a=new d.Da,c=new d.Da,f=new d.Dd,y=s.Na(0),v=s.Na(s.I()-1),_=new d.h;y.x>v.x?(v=this.zq,f.gg(-this.Js,0)):(v=-this.zq,f.gg(this.Js,0)),a.add(s,!1),s.Oa(),c.add(a,!1),c.Oc(f),y=new d.l,c.A(y),y.W((this.Js-y.R())/2,0),y.G=-this.zq,y.H=this.zq;for(var $=0;$<c.I();$++)c.D($,_),a.wf(0,-1,_);for(c.Oc(f),$=0;$<c.I();$++)c.D($,_),a.wf(0,-1,_);c=a.Na(0),f=a.Na(a.I()-1),_.ma(f.x,v),a.wf(0,-1,_),_.ma(.5*(f.x+c.x),v),a.wf(0,-1,_),_.ma(c.x,v),a.wf(0,-1,_),a=d.Hh.ks(a,this.Jc,2,!0,y.v),a=d.Hh.ks(a,this.Jc,2,!0,y.C),a=d.Ud.clip(a,y,this.Aq,NaN),s.add(a,!1)},l.prototype.UV=function(s){var a=new d.l;s.A(a),a.W((this.Js-a.R())/2,0),a.G=-this.zq,a.H=this.zq,s.Yk(null,0);var c=new d.h;c.ma(a.v,a.G),s.wf(1,-1,c),c.ma(a.v,a.H),s.wf(1,-1,c),c.ma(.5*(a.v+a.C),a.H),s.wf(1,-1,c),c.ma(a.C,a.H),s.wf(1,-1,c),c.ma(a.C,a.G),s.wf(1,-1,c),c.ma(.5*(a.v+a.C),a.G),s.wf(1,-1,c)},l.qy=function(s,a,c,f,y,v,_,$,I,k,A){var P=null;I||((P=new d.h).Rc(),0<A.I()&&(P.L(A.Na(A.I()-1)),P.scale(c)));var D=new d.ga(0),j=new d.ga(0),B=new d.ga(0),q=new d.h,z=new d.h,Z=v[v.length-1];c=1/c;for(var ee=0;ee<v.length;ee++){var Q=v[ee];if(ee==0)var le=_;else ee==v.length-1?le=$:(d.kb.wd(s,a,Z.x,Z.y,Q.x,Q.y,null,null,D,y),le=D.u-1.570796326794897);d.kb.yi(s,a,Q.x,Q.y,f,le,j,B),I?z.ma(j.u,B.u):(q.ma(j.u,B.u),l.gJ(Q.x,q.x,P.x,k),z.ma(k[0]+q.x,q.y),P.L(z)),z.scale(c),A.wf(0,-1,z)}},l.Hr=function(s,a,c,f,y,v,_,$,I,k,A,P,D){if(!(_-v<$)){var j=new d.ga(0),B=new d.ga(0),q=new d.h,z=new d.h,Z=null;I||((Z=new d.h).Rc(),0<A.I()&&(Z.L(A.Na(A.I()-1)),Z.scale(c)));var ee=d.O.truncate(Math.ceil(v/$)),Q=ee++*$;for(Q==v&&(Q=ee++*$),c=1/c;Q<_+$&&(v<P&&P<Q?(Q=P,ee--):v<D&&D<Q&&(Q=D,ee--),!(Q>=_));)d.kb.yi(s,a,y.x,y.y,f,Q,j,B),I?z.ma(j.u,B.u):(q.ma(j.u,B.u),l.gJ(y.x,q.x,Z.x,k),z.ma(k[0]+q.x,q.y),Z.L(z)),z.scale(c),A.wf(0,-1,z),v=Q,Q=ee++*$}},l.dJ=function(s,a,c,f,y,v,_,$,I,k){var A=new d.h,P=new d.h,D=new d.ga(0),j=new d.ga(0);for(d.kb.yi(s,a,f.x,f.y,c,y,D,j),A.ma(D.u,j.u),d.kb.yi(s,a,f.x,f.y,c,v,D,j),P.ma(D.u,j.u),c=new d.ga(0),d.kb.Xy(s,a,_.x,_.y,A.x,A.y,c),I[0]=c.u,d.kb.Xy(s,a,_.x,_.y,P.x,P.y,c),k[0]=c.u;I[0]<=k[0];)I[0]+=6.283185307179586;for(;I[0]>k[0];)I[0]-=6.283185307179586;for(;I[0]>=$;)I[0]-=6.283185307179586,k[0]-=6.283185307179586;for(;I[0]<$;)I[0]+=6.283185307179586,k[0]+=6.283185307179586},l.gJ=function(s,a,c,f){if(isNaN(c)){for(;3.141592653589793<f[0]+a-s;)f[0]-=6.283185307179586;for(;3.141592653589793<s-(f[0]+a);)f[0]+=6.283185307179586}else 3.141592653589793<f[0]+a-c?f[0]-=6.283185307179586:3.141592653589793<c-(f[0]+a)&&(f[0]+=6.283185307179586)},l.KX=function(s,a){var c=s.getType(),f=d.aa.Hc(c)?s.da():c==550?s.I():1;if(f==1)return s;var y=new d.ia(0);y.resize(f);for(var v=[],_=new d.l,$=0;$<f;$++){if(y.write($,$),d.aa.Hc(c)){s.Rj($,_);var I=_.sf()}else I=s.Na($);I=d.XK.$X(a,I),v[$]=I}for(y.Vd(0,y.size,function(k,A){return v[k]<v[A]?-1:v[k]>v[A]?1:0}),a=s.Ia(),$=0;$<f;$++)_=y.read($),d.aa.Hc(c)?a.addPath(s,_,!0):a.Fd(s,_,_+1);return a},l.prototype.yX=function(){var s=Math.min(3.141592653589793*this.Tb-this.rb,this.rb);s=Math.min(s,.39269908169872414*this.Tb);var a=new d.h;a.ma(0,10*this.ec);var c=45*this.ec,f=new d.ga(0),y=new d.ga(0),v=new d.ga(0),_=new d.ga(0),$=new d.ga(0),I=new d.ga(0),k=new d.ga(0),A=new d.ga(0),P=new d.h,D=new d.h,j=new d.h,B=new d.h;d.kb.yi(this.Tb,this.kc,a.x,a.y,s,0,f,y),P.ma(f.u,y.u),d.kb.yi(this.Tb,this.kc,a.x,a.y,s,c,v,_),D.ma(v.u,_.u),f=new d.ga(0),y=new d.ga(0);for(var q=new d.ga(0);d.kb.yi(this.Tb,this.kc,a.x,a.y,s,.5*(0+c),$,I),j.ma($.u,I.u),d.kb.wd(this.Tb,this.kc,P.x,P.y,D.x,D.y,f,y,null,2),d.kb.oj(this.Tb,this.kc,P.x,P.y,.5*f.u,y.u,k,A,2),B.ma(k.u,A.u),d.kb.wd(this.Tb,this.kc,j.x,j.y,B.x,B.y,q,null,null,2),!(q.u<=this.$n);)c*=.9,d.kb.yi(this.Tb,this.kc,a.x,a.y,s,c,v,_),D.ma(v.u,_.u);this.ao=6.283185307179586/Math.ceil(6.283185307179586/(c-0))},l.prototype.zX=function(){var s=Math.min(3.141592653589793*this.Tb-this.rb,this.rb);s=Math.min(s,.39269908169872414*this.Tb);var a=new d.h,c=new d.h;a.ma(0,10*this.ec),c.ma(10*this.ec,10*this.ec);var f=new d.ga(0),y=new d.ga(0),v=new d.ga(0);d.kb.wd(this.Tb,this.kc,a.x,a.y,c.x,c.y,v,f,y,this.ze);var _=new d.ga(0),$=new d.ga(0),I=new d.ga(0),k=new d.ga(0),A=new d.h,P=new d.ga(0),D=new d.ga(0),j=new d.ga(0),B=new d.ga(0),q=new d.ga(0),z=new d.ga(0),Z=new d.ga(0),ee=new d.ga(0),Q=new d.ga(0),le=new d.h,se=new d.h,ve=new d.h,xe=new d.h,_e=1;f=f.u,y=y.u+1.570796326794897,v=v.u,d.kb.yi(this.Tb,this.kc,a.x,a.y,s,f-1.570796326794897,D,j),le.ma(D.u,j.u),d.kb.yi(this.Tb,this.kc,c.x,c.y,s,y,B,q),se.ma(B.u,q.u),D=new d.ga(0),j=new d.ga(0),y=new d.ga(0);for(var je=new d.ga(0);d.kb.oj(this.Tb,this.kc,a.x,a.y,.5*(0+_e)*v,f,_,$,this.ze),A.ma(_.u,$.u),d.kb.wd(this.Tb,this.kc,a.x,a.y,A.x,A.y,null,null,P,this.ze),d.kb.yi(this.Tb,this.kc,A.x,A.y,s,P.u+1.570796326794897,z,Z),ve.ma(z.u,Z.u),d.kb.wd(this.Tb,this.kc,le.x,le.y,se.x,se.y,D,j,null,2),d.kb.oj(this.Tb,this.kc,le.x,le.y,.5*D.u,j.u,ee,Q,2),xe.ma(ee.u,Q.u),d.kb.wd(this.Tb,this.kc,ve.x,ve.y,xe.x,xe.y,y,null,null,2),!(y.u<=this.$n);)_e*=.9,d.kb.oj(this.Tb,this.kc,a.x,a.y,_e*v,f,I,k,this.ze),c.ma(I.u,k.u),d.kb.wd(this.Tb,this.kc,a.x,a.y,c.x,c.y,null,null,je,this.ze),d.kb.yi(this.Tb,this.kc,c.x,c.y,s,je.u+1.570796326794897,B,q),se.ma(B.u,q.u);1e5<(s=_e*v)&&(s=1e5),this.QA=s},l.prototype.xX=function(){var s=5e4<this.rb?100:1e4<this.rb?10:1;500>this.rb/s&&(s=this.rb/500),.01>s&&(s=.01),this.$n=s},l}();d.VK=h}(Y||(Y={})),function(d){var O=function(){function x(){}return x.Mf=function(h,l){var s=new d.h;s.L(l),h.push(s)},x.up=function(h,l){h.add(l.x),h.add(l.y)},x.hB=function(h){h.Bh(h.size-2)},x.oB=function(h,l){l.ma(h.get(h.size-2),h.get(h.size-1))},x.Qr=function(h,l,s,a,c,f){if(h==null)throw d.i.N();var y=h.getType();if(h.B()||d.aa.Rn(y))return h;var v=new x;v.Qg=l,v.Jc=d.cb.sc(l);var _=d.cb.vv(v.Jc);if(v.Ub=f,v.Tb=d.cb.ev(v.Jc),v.kc=_*(2-_),v.ec=v.Jc.Hd().ai,v.Aq=v.Jc.Kn(),v.Zs=v.Aq*v.ec,v.AA=a,v.zA=c,v.ze=s,y==197?(s=new d.Da(h.description)).ad(h,!1):d.aa.yd(y)?(s=new d.Ta(h.description)).oc(h,!0):s=h,v.ze!=4){if((l=v.Qg.Nb(v.Jc)==0?d.cb.zh(s,v.Qg,v.Jc):d.Hh.lj(s,v.Jc)).B())return l;l=x.pI(v.ec,l),l=v.Zy(l),l=d.ip.nj(l,v.Jc,v.ze),v=d.cb.zh(l,v.Jc,v.Qg)}else{if(d.Eg.Sb(l)==2?(h=d.cb.ml(),(l=d.Xj.local().V(s,h,l,f))==h&&(l=new d.Da,h.copyTo(l))):l=d.Hh.lj(s,v.Jc),l.B())return l;v=v.CX(l)}return v},x.pI=function(h,l){var s=new d.l;if(l.xc(s),3.141592653589793>s.R()*h)return l;var a=!1;s=l.Ga();for(var c=new d.h,f=new d.h;s.$a();)for(;s.Ha();){var y=s.ha();if(c.L(y.ac()),f.L(y.wc()),c.scale(h),f.scale(h),3.141592653589793<Math.abs(c.x-f.x)){var v=x.Lu(c,f);if(!v){a=!0;break}if(6.283185307179586<Math.abs(c.x-f.x)){a=!0;break}}}if(!a)return l;a=l.Ia();var _=1<l.description.Aa,$=new d.h,I=new d.h,k=new d.h,A=new d.h,P=new d.Sa;for(s.Zi();s.$a();)for(var D=NaN,j=[0];s.Ha();){if(y=s.ha(),c.L(y.ac()),f.L(y.wc()),c.scale(h),f.scale(h),isNaN(D)?(x.Wi(c.x,NaN,j),I.L(c)):I.L(k),D=I.x,v=x.Lu(c,f)){if(6.283185307179586<f.x-c.x)for(;6.283185307179586<f.x-c.x;)f.x-=6.283185307179586;if(-6.283185307179586>f.x-c.x)for(;-6.283185307179586>f.x-c.x;)f.x+=6.283185307179586;x.Wi(f.x,NaN,j),k.L(f)}else $.L(f),x.AU($),x.Wi($.x,D,j),k.ma(j[0]+$.x,$.y);.5>Math.abs(k.x-f.x)&&k.L(f),_?(y.Tw(0,P),A.L(I),A.scale(1/h),P.Cb(A),(v=s.vm())?a.nf(P):a.lineTo(P),s.Qn()&&!l.dc(s.gb)&&(y.Tw(1,P),A.L(k),A.scale(1/h),P.Cb(A),a.lineTo(P))):((v=s.vm())&&a.Hz(null,0),y=a.da()-1,A.L(I),A.scale(1/h),a.wf(y,-1,A),s.Qn()&&!l.dc(s.gb)&&(A.L(k),A.scale(1/h),a.wf(y,-1,A)))}return a},x.tF=function(h,l,s,a,c,f,y,v,_,$,I,k){var A=new d.h,P=new d.h,D=0<a.compare(c);x.fJ(D,a,c,A,P),x.uF(h,l,s,A,P,f,NaN,y,v,_,$,null,I,k),D&&x.fC(_,$,null,I)},x.prototype.Zy=function(h){var l=h.Ia(),s=h.Ga(),a=[],c=null,f=null,y=1<h.description.Aa;y&&(c=new d.be(0),f=new d.ig);for(var v=[0],_=new d.h,$=new d.h,I=new d.h,k=new d.h;s.$a();)for(v[0]=0;s.Ha();){var A=s.ha();_.L(A.ac()),$.L(A.wc()),_.scale(this.ec),$.scale(this.ec);var P=0<_.compare($);x.fJ(P,_,$,I,k),a.length=0,c!=null&&c.Bh(0),0<this.AA?x.uF(this.Tb,this.kc,this.ze,I,k,this.AA,this.zA,this.Zs,null,null,null,y?c:null,a,v):x.aR(this.Tb,this.kc,this.ze,I,k,this.zA,this.Zs,y?c:null,a,v),P&&x.fC(null,null,y?c:null,a),a[0].L(A.ac()),a[a.length-1].L(A.wc());for(var D=1;D<a.length-1;D++)a[D].scale(1/this.ec);y?(P=x.eJ(P,A,f),x.TD(s.vm(),s.Qn()&&!h.dc(s.gb),A,P,c,a,l)):x.SD(s.vm(),s.Qn()&&!h.dc(s.gb),a,l)}return l},x.prototype.CX=function(h){var l=h.Ia(),s=h.Ga(),a=[],c=null,f=new d.ig,y=1<h.description.Aa;for(y&&(c=new d.be(0));s.$a();)for(;s.Ha();){var v=s.ha(),_=v.ac(),$=v.wc();_=0<_.compare($),$=x.eJ(_,v,f),a.length=0,c!=null&&c.Bh(0),x.BX(this.Tb,this.kc,this.ec,$,this.Qg,this.AA,this.zA,y?c:null,a),_&&x.fC(null,null,y?c:null,a),y?x.TD(s.vm(),s.Qn()&&!h.dc(s.gb),v,$,c,a,l):x.SD(s.vm(),s.Qn()&&!h.dc(s.gb),a,l)}return l},x.SD=function(h,l,s,a){h&&a.Hz(null,0),h=a.da()-1;var c=s.slice(0);a.qG(h,c,c.length-1),l&&a.wf(h,-1,s[s.length-1])},x.TD=function(h,l,s,a,c,f,y){var v=new d.Sa;if(s.To(v),h?y.nf(v):y.lineTo(v),2<f.length){h=a.Qb();for(var _=1;_<f.length-1;_++){var $=a.NG(c.get(_)*h);a.Tw($,v),v.Cb(f[_]),y.lineTo(v)}}l&&(s.Po(v),y.lineTo(v))},x.uF=function(h,l,s,a,c,f,y,v,_,$,I,k,A,P){var D=new d.ga(0),j=new d.ga(0),B=new d.ga(0);d.kb.wd(h,l,a.x,a.y,c.x,c.y,B,D,j,s),B=B.u;var q=D=D.u;0>q&&(q+=6.283185307179586),0>(j=j.u)&&(j+=6.283185307179586),_!=null&&(_[0]=B),$!=null&&($[0]=q),I!=null&&(I[0]=j),$=_=NaN,k!=null&&(_=(($=d.F.Ah(h,l))-(I=d.F.q(h,l,a.y)))/B,$=($+I)/B),I=x.Mu(a,c),j=x.Ku(a,c),q=I||j;var z=x.FE(a,c,v),Z=new d.ga(0),ee=new d.ga(0),Q=new d.h,le=new d.h,se=new d.h;x.Wi(a.x,NaN,P);var ve=[P[0]];if(B<=f)x.Mf(A,a),x.Wi(c.x,NaN,P),k!=null&&k.add(0),q?(I&&x.kB(a,c,k,A),j&&x.iB(a,c,k,A)):z?x.jB(a,c,D,_,$,k,A):0<y&&(le.ma(a.x-ve[0],a.y),Q.ma(c.x-P[0],c.y),x.Yy(h,l,s,a,B,D,le,Q,0,1,y,k,A,ve)),x.Mf(A,c);else{var xe=B/((f=1+d.O.truncate(Math.ceil(B/f)))-1),_e=new d.h,je=0;x.Mf(A,a),_e.L(a),le.ma(a.x-P[0],a.y),k!=null&&k.add(0);for(var Ae=1;Ae<f;Ae++){if(Ae<f-1){d.kb.oj(h,l,a.x,a.y,Ae*xe,D,Z,ee,s),Q.ma(Z.u,ee.u),x.Wi(Q.x,_e.x,P),se.ma(P[0]+Q.x,Q.y);var st=Ae/(f-1)}else x.Wi(c.x,NaN,P),Q.ma(c.x-P[0],c.y),se.L(c),st=1;q?(Ae==1&&I&&x.kB(a,se,k,A),Ae==f-1&&j&&x.iB(_e,c,k,A)):z?x.EE(_e,se,v)&&(a.x<c.x?_e.x>se.x&&(P[0]+=6.283185307179586,se.ma(P[0]+Q.x,Q.y)):_e.x<se.x&&(P[0]-=6.283185307179586,se.ma(P[0]+Q.x,Q.y)),x.jB(_e,se,D,_,$,k,A)):0<y&&x.Yy(h,l,s,a,B,D,le,Q,je,st,y,k,A,ve),x.Mf(A,se),k!=null&&k.add(st),_e.L(se),le.L(Q),ve[0]=P[0],je=st}}},x.aR=function(h,l,s,a,c,f,y,v,_,$){var I=new d.ga(0),k=new d.ga(0),A=new d.ga(0);d.kb.wd(h,l,a.x,a.y,c.x,c.y,A,I,k,s),k=A.u,I=I.u;var P=A=NaN;if(v!=null){P=d.F.Ah(h,l);var D=d.F.q(h,l,a.y);A=(P-D)/k,P=(P+D)/k}D=x.Mu(a,c);var j=x.Ku(a,c),B=D||j;y=x.FE(a,c,y);var q=x.Lu(a,c);q=B||y||q,x.Wi(a.x,NaN,$);var z=new d.h;x.Mf(_,a),z.L(a),v!=null&&v.add(0),q?(B?(D&&x.kB(a,c,v,_),j&&x.iB(a,c,v,_)):y&&x.jB(a,c,I,A,P,v,_),x.Wi(c.x,NaN,$),x.Mf(_,c)):k<=f?(x.Wi(c.x,NaN,$),x.Mf(_,c)):(A=new d.h,y=new d.h,A.L(a),y.L(c),A.x-=$[0],y.x-=$[0],-3.141592653589793>y.x?y.x+=6.283185307179586:3.141592653589793<y.x&&(y.x-=6.283185307179586),x.Yy(h,l,s,a,k,I,A,y,0,1,f,v,_,$),x.Mf(_,c),x.Wi(c.x,NaN,$)),v!=null&&v.add(1)},x.Yy=function(h,l,s,a,c,f,y,v,_,$,I,k,A,P){var D=new d.h,j=new d.h;D.ma(y.x+P[0],y.y),new d.ga(0),new d.ga(0),new d.ga(0),new d.ga(0);var B=new d.ga(0),q=new d.ga(0),z=new d.ga(0),Z=new d.h,ee=new d.h,Q=new d.h,le=new d.h;Z.L(y),ee.L(v),y=new d.be(0),v=new d.be(0),x.up(y,ee),v.add($);var se=new d.h,ve=new d.yb,xe=[];for(x.YJ(4,xe);0<y.size;){for(var _e,je=!1,Ae=NaN,st=0;3>st;st++)if(_e=xe[st]*$+(1-xe[st])*_,d.kb.oj(h,l,a.x,a.y,_e*c,f,B,q,s),Q.ma(B.u,q.u),st==0&&(Ae=_e,le.L(Q)),x.WW(Z,Q,ee,ve),ve.hc(ve.fe(Q,!0),se),d.kb.wd(h,l,Q.x,Q.y,se.x,se.y,z,null,null,2),z.u>I){je=!0;break}je?(ee.L(le),$=Ae,x.up(y,ee),v.add($)):(x.hB(y),v.En(v.size-1,1,v.size-1),0<y.size&&(x.Wi(ee.x,D.x,P),j.ma(P[0]+ee.x,ee.y),x.Mf(A,j),D.L(j),k!=null&&k.add($),Z.L(ee),_=$,x.oB(y,ee),$=v.get(v.size-1)))}},x.BX=function(h,l,s,a,c,f,y,v,_){var $=new d.h,I=new d.h,k=new d.h,A=new d.h,P=new d.h,D=new d.h,j=new d.h,B=new d.h,q=new d.h,z=new d.h,Z=new d.ga(0),ee=new d.ga(0),Q=new d.h,le=[[],[]],se=d.Eg.Sb(c)==1;c=c.Xd(0);var ve=a.ac(),xe=a.wc();se?(D.ma(ve.x*s,ve.y*s),j.ma(xe.x*s,xe.y*s)):(le[0][0]=ve.x,le[0][1]=ve.y,le[1][0]=xe.x,le[1][1]=xe.y,d.cb.vt(),D.x=le[0][0]*s,D.y=le[0][1]*s,j.x=le[1][0]*s,j.y=le[1][1]*s);var _e=0,je=0,Ae=1,st=a.Pn();$.L(ve),I.L(xe),xe=new d.be(0);var it=new d.be(0),Ne=new d.be(0);x.up(xe,I),x.up(it,j),Ne.add(Ae),x.Mf(_,$),v!=null&&v.add(je);var xi=[],Vr=0<y?st?5:3:st?5:1;x.YJ(Vr,xi);for(var Ci=new d.ga(0),Jt=new d.ga(0),Zt=new d.ga(0),_t=new d.ga(0),Qi=new d.ga(0),bt=new d.ga(0),aa=new d.ga(0);0<it.size;){var Ot=!1,hs=NaN;for(d.kb.wd(h,l,D.x,D.y,j.x,j.y,Ci,Jt,null,2),ve=0;ve<Vr&&!(ve==0&&(!st&&0>=y&&Ci.u<=f&&3.141592653589793>Math.abs(D.x-j.x)||a.Ux(je,Ae)<=c));ve++){var oi=xi[ve]*Ae+(1-xi[ve])*je;if(a.hc(oi,k),se?B.ma(k.x*s,k.y*s):(le[0][0]=k.x,le[0][1]=k.y,d.cb.vt(),B.x=le[0][0]*s,B.y=le[0][1]*s),ve==0&&(hs=oi,P.L(k),z.L(B),0<f&&(Ci.u>f||3.141592653589793<=Math.abs(D.x-j.x)))){Ot=!0;break}if(st&&0<f){if(d.kb.wd(h,l,D.x,D.y,B.x,B.y,Zt,null,null,2),Zt.u>f||3.141592653589793<=Math.abs(D.x-B.x)){Ot=!0;break}}else if(0<y){if(st?(A.NS($,I,xi[ve]),se?q.ma(A.x*s,A.y*s):(le[0][0]=A.x,le[0][1]=A.y,d.cb.vt(),q.x=le[0][0]*s,q.y=le[0][1]*s)):(A.L(k),q.L(B)),d.kb.wd(h,l,D.x,D.y,q.x,q.y,_t,null,null,2),!(_t.u<=Ci.u)){Ot=!0;break}if(d.kb.oj(h,l,D.x,D.y,_t.u,Jt.u,Z,ee,2),Q.ma(Z.u,ee.u),d.kb.wd(h,l,Q.x,Q.y,B.x,B.y,Qi,null,null,2),Qi.u>y){Ot=!0;break}if(st){if(d.kb.wd(h,l,Q.x,Q.y,q.x,q.y,bt,null,null,2),bt.u>y){Ot=!0;break}if(d.kb.wd(h,l,q.x,q.y,B.x,B.y,aa,null,null,2),aa.u>y){Ot=!0;break}}}}Ot?(I.L(P),j.L(z),Ae=hs,x.up(xe,I),x.up(it,j),Ne.add(Ae)):(x.hB(xe),x.hB(it),Ne.En(Ne.size-1,1,Ne.size-1),x.Mf(_,I),_e+=Ci.u,v!=null&&v.add(_e),0<it.size&&($.L(I),D.L(j),je=Ae,x.oB(xe,I),x.oB(it,j),Ae=Ne.get(Ne.size-1)))}if(v!=null)for(h=1/_e,ve=0;ve<v.size;ve++)v.write(ve,v.read(ve)*h)},x.fC=function(h,l,s,a){a.reverse(),s!=null&&s.ni(0,s.size,1),s=h!=null?h[0]:NaN,a=l!=null?l[0]:NaN,h!=null&&(h[0]=a),l!=null&&(l[0]=s)},x.fJ=function(h,l,s,a,c){h?(a.L(s),c.L(l)):(a.L(l),c.L(s))},x.eJ=function(h,l,s){return h?(s.create(l.getType()),l.copyTo(s.get()),s.get().reverse(),s.get()):l},x.Wi=function(h,l,s){if(isNaN(l)){for(;3.141592653589793<s[0]-h;)s[0]-=6.283185307179586;for(;3.141592653589793<h-s[0];)s[0]+=6.283185307179586}else 3.141592653589793<s[0]+h-l?s[0]-=6.283185307179586:3.141592653589793<l-(s[0]+h)&&(s[0]+=6.283185307179586)},x.WW=function(h,l,s,a){3.141592653589793>Math.abs(l.x-h.x)?(a.Dc(h),3.141592653589793<=s.x-h.x?a.Ql(s.x-6.283185307179586,s.y):3.141592653589793<=h.x-s.x?a.Ql(s.x+6.283185307179586,s.y):a.Ql(s.x,s.y)):(a.Dc(s),3.141592653589793<=h.x-s.x?a.Ql(h.x-6.283185307179586,h.y):3.141592653589793<=s.x-h.x?a.Ql(h.x+6.283185307179586,h.y):a.Ql(h.x,h.y))},x.YJ=function(h,l){for(var s=0;s<h;s++){var a=Math.ceil(s/2)/(h+1);s%2!=0&&(a=-a),l[s]=.5+a}},x.Mu=function(h,l){return!!(d.s.Y(h.y,1.570796326794897)&&!d.s.Y(l.y,1.570796326794897)||d.s.Y(h.y,-1.570796326794897)&&!d.s.Y(l.y,-1.570796326794897))},x.Ku=function(h,l){return!!(d.s.Y(l.y,1.570796326794897)&&!d.s.Y(h.y,1.570796326794897)||d.s.Y(l.y,-1.570796326794897)&&!d.s.Y(h.y,-1.570796326794897))},x.FE=function(h,l,s){return!(!x.EE(h,l,s)||d.s.Y(h.y,1.570796326794897)||d.s.Y(h.y,-1.570796326794897)||d.s.Y(l.y,1.570796326794897)||d.s.Y(l.y,-1.570796326794897))},x.EE=function(h,l,s){return Math.abs(Math.abs(h.x-l.x)-3.141592653589793)<=s},x.Lu=function(h,l){return!!(d.s.Y(h.y,1.570796326794897)&&d.s.Y(l.y,1.570796326794897)||d.s.Y(h.y,-1.570796326794897)&&d.s.Y(l.y,-1.570796326794897))},x.kB=function(h,l,s,a){if(0<h.y){var c=new d.h;c.ma(l.x,1.570796326794897)}else(c=new d.h).ma(l.x,-1.570796326794897);d.s.Y(h.x,c.x)||d.s.Y(l.y,c.y)||(x.Mf(a,c),s!=null&&s.add(0))},x.iB=function(h,l,s,a){if(0<l.y){var c=new d.h;c.ma(h.x,1.570796326794897)}else(c=new d.h).ma(h.x,-1.570796326794897);d.s.Y(l.x,c.x)||d.s.Y(h.y,c.y)||(x.Mf(a,c),s!=null&&s.add(1))},x.jB=function(h,l,s,a,c,f,y){d.s.Cd(s)?(0<1.570796326794897-h.y&&((s=new d.h).ma(h.x,1.570796326794897),x.Mf(y,s),f!=null&&f.add(a)),0<1.570796326794897-l.y&&((s=new d.h).ma(l.x,1.570796326794897),x.Mf(y,s),f!=null&&f.add(a))):(0<1.570796326794897+h.y&&((s=new d.h).ma(h.x,-1.570796326794897),x.Mf(y,s),f!=null&&f.add(c)),0<1.570796326794897+l.y&&((s=new d.h).ma(l.x,-1.570796326794897),x.Mf(y,s),f!=null&&f.add(c)))},x.AU=function(h){if(-3.141592653589793>h.x)for(;-3.141592653589793>h.x;)h.x+=6.283185307179586;if(3.141592653589793<h.x)for(;3.141592653589793<h.x;)h.x-=6.283185307179586},x}();d.cj=O}(Y||(Y={})),function(d){d.ip=function(){function O(){}return O.nj=function(x,h,l){if(x==null||h==null||!d.cb.Wc(h))throw d.i.N();if(x.B())return x;var s=x,a=s.getType();if(d.aa.Hc(a)){s=d.Hh.lj(x,h),x=new d.l,s.A(x),a=d.ta.Wd(h,x,!1);for(var c=d.cb.gh(h),f=Math.floor((x.v-c.v)/c.R())*c.R()+c.v;f<x.C;)f>x.v+a&&f<x.C-a&&(s=d.Hh.ks(s,h,l,!0,f)),f+=c.R()}else{if(a==197)return(x=new d.Da(s.description)).ad(s,!1),O.nj(x,h,l);if(d.aa.yd(a))return(x=new d.Ta(s.description)).oc(s,!0),O.nj(x,h,l)}return O.Uy(s,h)},O.Uy=function(x,h){if(x==null||h==null||!d.cb.Wc(h))throw d.i.N();if(x.B())return x;var l=x.getType();return l==197?(l=new d.Da(x.description)).ad(x,!1):d.aa.yd(l)?(l=new d.Ta(x.description)).oc(x,!0):l=x,(l=d.Hh.lj(l,h)).B()?l:d.Eg.Sb(h)==1?d.Hh.Fn(l,h,0,l!=x,0):O.NQ(l,h,l!=x)},O.NQ=function(x,h,l){if(!d.cb.Wc(h))throw d.i.N();if(x.B())return x;var s=d.cb.bf(h),a=-180*s;return s*=360,d.Eg.Sb(h)==2&&(s=(a=d.cb.gh(h)).C,s-=a=a.v),d.Hh.Hp(x,a,s,h,l,0,!0)},O}()}(Y||(Y={})),function(d){d.BY=function(){function O(){}return O.P=function(x){return 0>x?-x:x},O.Mb=function(x,h){return 0<=h?O.P(x):-O.P(x)},O.Y=function(x,h){return x==h||O.P(x-h)<=O.JC*(1+(O.P(x)+O.P(h))/2)},O.Cd=function(x){return x==0||O.P(x)<=O.JC},O.Ah=function(x,h){var l=(h=(1-(h=Math.sqrt(1-h)))/(1+h))*h;return x/(1+h)*(1+l*(.25+l*(.015625+1/256*l)))*O.EL},O.EL=1.5707963267948966,O.JC=3552713678800501e-30,O}()}(Y||(Y={})),function(d){var O=function(h){this.Wf=h,this.Kk=this.Wf.getCode(),0>this.Kk&&(this.Kk=0)};d.DY=O;var x=function(){function h(l){l===void 0&&(l=null),this.Cj=null,this.Un=!1,l!==null&&(this.Cj=new O(l))}return h.prototype.Ec=function(){return this.Cj!=null?this.Cj.Kk:0},h.prototype.Of=function(){var l=new h;return this.copyTo(l),l},h.prototype.copyTo=function(l){l.Cj=this.Cj,l.Un=this.Un},h.prototype.Qz=function(){this.Un=!this.Un},h.prototype.qm=function(){return this.Cj!=null?this.Cj.Wf:null},h.prototype.LJ=function(l){if(0>=l)throw d.i.N();if(l!=this.Ec()){if((l=d.pf.geogtran(l))==null)throw d.i.N("Geogtran not found.");this.Cj=new O(l)}},h.prototype.Bz=function(){return this.Cj==null?null:this.Cj.Wf.toString()},h.prototype.tX=function(l){if(l==null)throw d.i.N();var s=null;try{s=d.pf.fromString(d.Sc.PE_TYPE_GEOGTRAN,l)}catch{throw d.i.N()}this.Cj=new O(s)},h.prototype.Nb=function(l){return l==this||!(!(l instanceof h)||(0>=this.Ec()||this.Ec()!=l.Ec())&&!this.qm().isEqual(l.qm()))&&this.Un==l.Un},h.prototype.toString=function(){var l="GeographicTransformation: "+this.Bz();return 200<l.length?l.substring(0,197)+"... ("+l.length.toString()+" characters)":l},h.create=function(l,s){var a=new h;return a.LJ(l),s&&a.Qz(),a},h.uP=function(l,s){var a=new h;return a.tX(l),s&&a.Qz(),a},h}();d.Dx=x}(Y||(Y={})),function(d){var O=function(){function h(){}return h.construct=function(l,s,a,c){var f=new h;return f.hw=l,f.iw=s,f.QY=a,f.RY=c,f},h.Ey=function(l,s){return l.hw==s.hw?l.iw==s.iw?0:l.iw<s.iw?-1:1:l.hw<s.hw?-1:1},h}(),x=function(){function h(){this.yT=[],this.zT=[],this.qp()}return h.kz=function(){return h.jK==null&&(h.jK=new h),h.jK},h.prototype.qp=function(){this.iD(this.yT),this.iD(this.zT)},h.prototype.iD=function(l){try{var s=[];s=s.sort(O.Ey);for(var a=0;a<s.length;a++)l.push(s[a])}catch{}},h}();d.CY=x}(Y||(Y={})),function(d){var O=function(){function x(){}return x.prototype.yD=function(h){this.Fk=h},x.prototype.WM=function(h){this.Fb=h},x.prototype.xD=function(h){this.zo=h},x.CE=function(h){return!(h.B()||h.getType()!=1607&&h.getType()!=1736)},x.AE=function(h){return!(h.B()||h.getType()!=1607&&h.getType()!=1736||20>h.I())},x.BE=function(h){return!(h.B()||h.getType()!=1607&&h.getType()!=1736||20>h.I())},x}();d.Uk=O}(Y||(Y={})),function(d){d.$b=function(){function O(){}return O.TT=function(x){var h=new d.Da;return h.sx(x.es(),x.gs()),h.yj(x.es(),x.fs()),h.yj(x.ds(),x.fs()),h.yj(x.ds(),x.gs()),h},O.zh=function(x,h){return x===null?null:d.Hx.local().V(x,h,null)},O.jY=function(x,h){var l=d.Gh.local();return x=new d.Zc(x),l.V(x,h,null).next()},O.im=function(x,h,l){return d.kp.local().V(x,h,l,null)},O.ep=function(x,h,l){return d.Kx.local().V(x,h,l,null)},O.VX=function(x,h,l){var s=d.Kx.local();for(x=new d.Zc(x),h=new d.Zc(h),l=s.V(x,h,l,null),s=[];(h=l.next())!=null;)s.push(h);return s},O.Nb=function(x,h,l){return d.dj.local().V(3,x,h,l,null)},O.TP=function(x,h,l){return d.dj.local().V(4,x,h,l,null)},O.RS=function(x,h,l){var s=d.Xj.local();for(x=new d.Zc(x),h=new d.Zc(h),l=s.V(x,h,l,null),s=[];(h=l.next())!=null;)s.push(h);return s},O.QP=function(x,h,l){var s=d.kp.local();for(x=new d.Zc(x),h=new d.Zc(h),l=s.V(x,h,l,null),s=[];(h=l.next())!=null;)s.push(h);return s},O.Ea=function(x,h,l){return d.Xj.local().V(x,h,l,null)},O.QS=function(x,h,l){if((x=d.Xj.local().V(x,h,l,null,1))===null)return[];if(x.getType()===550){for(h=[],l=0;l<x.wa;l++)h.push(x.KR(l));return h}return x.getType()===33?[x]:[]},O.qY=function(x,h,l){return d.dj.local().V(2,x,h,l,null)},O.contains=function(x,h,l){return d.dj.local().V(1,x,h,l,null)},O.BP=function(x,h,l){return d.dj.local().V(16,x,h,l,null)},O.touches=function(x,h,l){return d.dj.local().V(8,x,h,l,null)},O.DU=function(x,h,l){return d.dj.local().V(32,x,h,l,null)},O.TS=function(x,h,l){return d.dj.local().V(1073741824,x,h,l,null)},O.yB=function(x,h,l,s){return d.zL.local().V(x,h,l,s,null)},O.tb=function(x,h,l,s){var a=null;if(l!=null){if(a=l.Hd(),s!=null&&a.Ec()!=s.Ec()&&a.od!=s.od)throw d.i.Xk()}else if(s!=null)throw d.i.N();return x=d.rL.local().V(x,h,null),a!==null&&s!==null&&(x=d.Tc.Nh(x,a,s)),x},O.clip=function(x,h,l){return d.kL.local().V(x,d.l.construct(h.es(),h.gs(),h.ds(),h.fs()),l,null)},O.dl=function(x,h,l){if(x==null||h==null)return null;for(x=d.mL.local().V(!0,x,h,l,null),h=[];(l=x.next())!=null;)l.B()||h.push(l);return h.slice(0)},O.MN=function(x,h,l,s,a,c,f,y){if(a===!0)return O.NN(x,h,l,s,c,f,y);if(a=l,h!=null){if(f=h.Hd(),s!=null&&f.Ec()!=s.Ec()){if(f.od!=s.od)throw d.i.Xk();a=[],d.Tc.XE(l,l.length,s,f,a)}}else if(s!=null)throw d.i.N();if(l=d.AC.local(),c){for(x=new d.Zc(x),h=l.V(x,h,a,c,null),x=[];(c=h.next())!=null;)x.push(c);c=x.slice(0)}else for(c=[],s=0;s<x.length;s++)c[s]=l.V(x[s],h,a[s],null);return c},O.NN=function(x,h,l,s,a,c,f){if(h===null||(s==null&&(s=h.Ec()!==4326?h.Hd():d.Tc.Zg(9001)),s.od!==0))throw d.i.N();if(d.Tc.XE(l,l.length,s,d.Tc.Zg(9001),l),s=d.FC.local(),a){for(x=new d.Zc(x),h=s.V(x,h,c,l,f,!1,a,null),l=[];(c=h.next())!=null;)l.push(c);a=l.slice(0)}else{a=[];for(var y=0;y<x.length;y++)a[y]=s.V(x[y],h,c,l[y],f,!1,null)}return a},O.buffer=function(x,h,l,s,a,c,f){var y=l;if(a===!1){if(h!=null){if(a=h.Hd(),s!=null&&a.Ec()!=s.Ec()){if(a.od!=s.od)throw d.i.Xk();y=d.Tc.Nh(l,s,a)}}else if(s!=null)throw d.i.N();x=d.AC.local().V(x,h,y,null)}else{if(h===null||(s==null&&(s=h.Ec()!==4326?h.Hd():d.Tc.Zg(9001)),s.od!==0))throw d.i.N();y=d.Tc.Nh(l,s,d.Tc.Zg(9001)),x=d.FC.local().V(x,h,c,y,f,!1,null)}return x},O.BU=function(x,h,l,s,a,c,f){if(h!=null){var y=h.Hd();if(f!=null&&y.Ec()!=f.Ec()){if(y.od!=f.od)throw d.i.Xk();l=d.Tc.Nh(l,f,y)}}else if(f!=null)throw d.i.N();for(x=new d.Zc(x),h=d.IC.local().V(x,h,l,s,a,c,null),l=[];(s=h.next())!=null;)l.push(s);return l.slice(0)},O.offset=function(x,h,l,s,a,c,f){if(h!=null){var y=h.Hd();if(f!=null&&y.Ec()!=f.Ec()){if(y.od!=f.od)throw d.i.Xk();l=d.Tc.Nh(l,f,y)}}else if(f!=null)throw d.i.N();return d.IC.local().V(x,h,l,s,a,c,null)},O.iP=function(x){return d.CC.local().V(x,null)},O.jP=function(x,h){var l=d.CC.local();for(x=new d.Zc(x),h=l.V(x,h,null),l=[];(x=h.next())!=null;)l.push(x);return l},O.nz=function(x,h,l){return d.Ix.local().nz(x,h,l)},O.oz=function(x,h){return d.Ix.local().oz(x,h)},O.pz=function(x,h,l,s){return d.Ix.local().pz(x,h,l,s)},O.eC=function(x,h){return d.Yl.local().V(x,h,!1,null)},O.dT=function(x,h){return d.Yl.local().rs(x,h,null)},O.QQ=function(x,h,l,s,a){var c=d.EC.local();if(h!=null){if(h=h.Hd(),a!=null&&h.Ec()!=a.Ec()){if(h.od!=a.od)throw d.i.Xk();l=d.Tc.Nh(l,a,h)}}else if(a!=null)throw d.i.N();return c.V(x,l,s,null)},O.Qr=function(x,h,l,s){var a=d.Xl.local();if(h!=null){if(h=h.Hd(),s!=null&&h.Ec()!=s.Ec()){if(h.od!=s.od)throw d.i.Xk();l=d.Tc.Nh(l,s,h)}}else if(s!=null)throw d.i.N();return a.V(x,l,null)},O.Wy=function(x,h,l,s,a){a===void 0&&(a=0);var c=d.tL.local();if(a==4||a!==0)throw d.i.Ie();if(s!==null){if(s.od!==0)throw d.i.N("Unit must be a linear unit type");l=d.Tc.Nh(l,s,d.Tc.Zg(9001))}return c.V(x,l,h,a,null)},O.WQ=function(x,h,l,s){if(x===null)return 0;if(s==4||s!==0)throw d.i.Ie();if(x.getType()==197)x=O.TT(x);else if(x.getType()!=1736)return 0;if(s=d.cb.sc(h),x=d.cb.zh(x,h,s),x=d.UK.XQ([x])[0],l!==null){if(l.od!==2)throw d.i.N("Unit must be a area unit type");x=d.Tc.Nh(x,d.Tc.Zg(109404),l)}return x},O.ZQ=function(x,h,l,s){if(x=d.vL.local().V(x,h,s,null),l!==null){if(l.od!==0)throw d.i.N("Unit must be a linear unit type");x=d.Tc.Nh(x,d.Tc.Zg(9001),l)}return x},O.JU=function(x,h,l){if(x===null)return 0;var s=null;if(h!=null){if((s=h.Hd()).od==0&&(s=d.Tc.aG(s))==null&&l!==null)throw d.i.N();if(l!=null&&s.Ec()!=l.Ec()&&s.od!=l.od)throw d.i.Xk()}else if(l!=null)throw d.i.N();return x.getType()==1736||x.getType()==197?(x=x.Ke(),l!==null?d.Tc.Nh(x,s,l):x):0},O.KU=function(x,h,l){if(x===null||x.B()||1>x.Db())return 0;var s=null;if(h!=null){if(s=h.Hd(),l!=null&&s.Ec()!=l.Ec()&&s.od!=l.od)throw d.i.Xk()}else if(l!=null)throw d.i.N();x.getType()==1736||x.getType()==197?h=x.mg():d.aa.yd(x.getType())?(h=new d.Ta(x.description)).oc(x,!0):h=x,x=0,h=h.Ga();for(var a=new d.h,c=new d.h;h.$a();)for(;h.Ha();){var f=h.ha();f.Yp(a),f.Tr(c),x+=d.h.tb(a,c)}return s!==null&&l!==null&&(x=d.Tc.Nh(x,s,l)),x},O.fP=function(x){return x.points!==void 0?O.mS(x,x.hasZ!==void 0&&x.hasZ,x.hasM!==void 0&&x.hasM):x.rings!==void 0?O.lG(x.rings,x.hasZ!==void 0&&x.hasZ,x.hasM!==void 0&&x.hasM,"P"):x.paths!==void 0?O.lG(x.paths,x.hasZ!==void 0&&x.hasZ,x.hasM!==void 0&&x.hasM,"L"):x.x!==void 0?O.nS(x):x.xmin!==void 0?O.lS(x):null},O.nS=function(x){if(x.x==null||x.x=="NaN")return new d.Sa;var h=new d.Sa(x.x,x.y);return x.z!==void 0&&x.z!==null&&h.wX(x.z),x.m!==void 0&&x.m!==null&&h.hX(x.m),h},O.lS=function(x){if(x.xmin==null||x.xmin=="NaN")return new d.Fh;var h=new d.Fh(x.xmin,x.ymin,x.xmax,x.ymax);return x.zmin!==void 0&&x.zmin!==null&&h.setInterval(1,0,x.zmin,x.zmax),x.mmin!==void 0&&x.mmin!==null&&h.setInterval(2,0,x.mmin,x.mmax),h},O.mS=function(x,h,l){var s=0,a=new d.de,c=3*x.points.length;c%2!=0&&c++,2>c&&(c=2);var f=d.O.truncate(3*x.points.length/2);4>f?f=4:16>f&&(f=16),c=d.Yc.Dn(c,0);var y=d.Yc.Dn(f);f=d.Yc.Dn(f);for(var v=0;v<x.points.length;v++)c.write(2*v,x.points[v][0]),c.write(2*v+1,x.points[v][1]),y.write(v,h||l?x.points[v][2]:NaN),f.write(v,l&&h?x.points[v][3]:NaN),s++;return s!=0&&(a.resize(s),a.hn(0,c)),h&&(a.re(1),a.hn(1,y)),l&&(a.re(2),a.hn(2,h==0?y:f)),a.Pc(16777215),a},O.lG=function(x,h,l,s){var a=0,c=2;if(s=="P"){var f=new d.Da;a=1,c=3}else f=new d.Ta;for(var y=d.Yc.Oh(0),v=d.Yc.Mr(0),_=0,$=0,I=[],k=[],A=0;A<x.length;A++){var P=x[A].length;if(I[A]=!1,s==="P"&&x[A][0][0]===x[A][x[A].length-1][0]&&x[A][0][1]===x[A][x[A].length-1][1]){var D=l==0||x[A][0][3]===x[A][x[A].length-1][3]||x[A][0][3]===void 0&&x[A][x[A].length-1][3]===void 0;(h==0||x[A][0][2]===x[A][x[A].length-1][2]||x[A][0][2]===void 0&&x[A][x[A].length-1][2]===void 0)&&D&&(I[A]=!0,--P)}P>=c?(k[A]=!1,$+=1,y.add(_),v.add(a),_+=P):k[A]=!0}for((s=3*_)%2!=0&&s++,2>s&&(s=2),4>(A=d.O.truncate(3*_/2))?A=4:16>A&&(A=16),s=d.Yc.Dn(s,0),a=d.Yc.Dn(A),c=d.Yc.Dn(A),A=P=0;A<x.length;A++)if(k[A]===!1)for(D=0;D<x[A].length;D++){var j=!1;D===x[A].length-1&&I[A]===!0&&(j=!0),j||(s.write(2*P,x[A][D][0]),s.write(2*P+1,x[A][D][1]),a.write(P,h||l?x[A][D][2]:NaN),c.write(P,l&&h?x[A][D][3]:NaN),P++)}return _!=0&&(x=f,y.resize($),v.resize($),0<_&&(y.add(_),v.add(0)),x.hn(0,s),x.PJ(v),x.QJ(y)),h&&(f.re(1),f.hn(1,a)),l&&(f.re(2),f.hn(2,h==0?a:c)),f.Pc(16777215),f},O}()}(Y||(Y={})),function(d){d.Ex=function(){function O(){}return O.br=function(x){var h,l=0,s=x.length,a=x[0];for(h=0;h<s-1;h++){var c=x[h+1];l+=(c[0]-a[0])*(c[1]+a[1]),a=c}return 0<=l},O.rotate=function(x,h,l){h=h*Math.PI/180;var s=Math.cos(h),a=Math.sin(h);if(x.paths!==void 0){h={paths:[]};for(var c=0;c<x.paths.length;c++){for(var f=x.paths[c],y=[],v=0;v<f.length;v++){var _=f[v].slice(0);y.push(_);var $=s*(f[v][0]-l.x)-a*(f[v][1]-l.y)+l.x,I=a*(f[v][0]-l.x)+s*(f[v][1]-l.y)+l.y;_[0]=$,_[1]=I}h.paths.push(y),x.hasZ!==void 0&&(h.hasZ=x.hasZ),x.hasM!==void 0&&(h.hasM=x.hasM)}return h}if(x.rings!==void 0){for(h={rings:[]},c=0;c<x.rings.length;c++){f=x.rings[c],y=[];var k=O.br(f);for(v=0;v<f.length;v++)_=f[v].slice(0),y.push(_),$=s*(f[v][0]-l.x)-a*(f[v][1]-l.y)+l.x,I=a*(f[v][0]-l.x)+s*(f[v][1]-l.y)+l.y,_[0]=$,_[1]=I;O.br(y)!==k&&y.reverse(),h.rings.push(y),x.hasZ!==void 0&&(h.hasZ=x.hasZ),x.hasM!==void 0&&(h.hasM=x.hasM)}return h}if(x.x!==void 0)return h={x:s*(x.x-l.x)-a*(x.y-l.y)+l.x,y:a*(x.x-l.x)+s*(x.y-l.y)+l.y},x.z!==void 0&&(h.z=x.z),x.m!==void 0&&(h.m=x.m),x.hasZ!==void 0&&(h.hasZ=x.hasZ),x.hasM!==void 0&&(h.hasM=x.hasM),h;if(x.points!==void 0){for(h={points:[]},c=x.points,v=0;v<c.length;v++)(f=c[v].slice(0))[0]=s*(c[v][0]-l.x)-a*(c[v][1]-l.y)+l.x,f[1]=a*(c[v][0]-l.x)+s*(c[v][1]-l.y)+l.y,h.points.push(f);return x.hasZ!==void 0&&(h.hasZ=x.hasZ),x.hasM!==void 0&&(h.hasM=x.hasM),h}return null},O.JQ=function(x,h){if(x.paths!==void 0){for(var l={paths:[]},s=0;s<x.paths.length;s++){for(var a=x.paths[s],c=[],f=0;f<a.length;f++){var y=a[f].slice(0);c.push(y);var v=h.x-a[f][0];y[0]=a[f][0]+2*v}l.paths.push(c)}return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}if(x.rings!==void 0){for(l={rings:[]},s=0;s<x.rings.length;s++){a=x.rings[s];var _=O.br(a);for(c=[],f=0;f<a.length;f++)y=a[f].slice(0),c.push(y),v=h.x-a[f][0],y[0]=a[f][0]+2*v;O.br(c)!==_&&c.reverse(),l.rings.push(c)}return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}if(x.x!==void 0)return v=h.x-x.x,l={x:x.x+2*v,y:x.y},x.z!==void 0&&(l.z=x.z),x.m!==void 0&&(l.m=x.m),x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l;if(x.points!==void 0){for(l={points:[]},s=x.points,f=0;f<s.length;f++)a=s[f].slice(0),v=h.x-a[0],a[0]+=2*v,l.points.push(a);return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}return x.xmin!==void 0?(l={v:x.xmin,G:x.ymin,C:x.xmax,H:x.ymax},x.zmin!==void 0&&(l.zmin=x.zmin,l.zmax=x.zmax),x.mmin!==void 0&&(l.mmin=x.mmin,l.mmax=x.mmax),v=h.x-x.xmin,l.xmax=x.xmin+2*v,v=h.x-x.xmax,l.xmin=x.xmax+2*v,x.zmin!==void 0&&(l.zmin=x.zmin),x.zmax!==void 0&&(l.zmax=x.zmax),x.mmin!==void 0&&(l.mmin=x.mmin),x.mmax!==void 0&&(l.mmax=x.mmax),x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l):null},O.KQ=function(x,h){if(x.paths!==void 0){for(var l={paths:[]},s=0;s<x.paths.length;s++){for(var a=x.paths[s],c=[],f=0;f<a.length;f++){var y=a[f].slice(0);c.push(y);var v=h.y-a[f][1];y[1]=a[f][1]+2*v}l.paths.push(c)}return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}if(x.rings!==void 0){for(l={rings:[]},s=0;s<x.rings.length;s++){a=x.rings[s];var _=O.br(a);for(c=[],f=0;f<a.length;f++)y=a[f].slice(0),c.push(y),v=h.y-a[f][1],y[1]=a[f][1]+2*v;O.br(c)!==_&&c.reverse(),l.rings.push(c)}return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}if(x.x!==void 0)return v=h.y-x.y,l={y:x.y+2*v,x:x.x},x.z!==void 0&&(l.z=x.z),x.m!==void 0&&(l.m=x.m),x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l;if(x.points!==void 0){for(l={points:[]},s=x.points,f=0;f<s.length;f++)a=s[f].slice(0),v=h.y-a[1],a[1]+=2*v,l.points.push(a);return x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l}return x.xmin!==void 0?(l={v:x.xmin,G:x.ymin,C:x.xmax,H:x.ymax},x.zmin!==void 0&&(l.zmin=x.zmin,l.zmax=x.zmax),x.mmin!==void 0&&(l.mmin=x.mmin,l.mmax=x.mmax),v=h.y-x.ymin,l.ymax=x.ymin+2*v,v=h.y-x.ymax,l.ymin=x.ymax+2*v,x.zmin!==void 0&&(l.zmin=x.zmin),x.zmax!==void 0&&(l.zmax=x.zmax),x.mmin!==void 0&&(l.mmin=x.mmin),x.mmax!==void 0&&(l.mmax=x.mmax),x.hasZ!==void 0&&(l.hasZ=x.hasZ),x.hasM!==void 0&&(l.hasM=x.hasM),l):null},O}()}(Y||(Y={})),function(d){d.ZK=function(){function O(){}return O.Ig=function(x,h){switch(h==null&&(h=d.ee.og()),x){case 33:return new d.Sa(h);case 322:return new d.yb(h);case 197:return new d.Fh(h);case 550:return new d.de(h);case 1607:return new d.Ta(h);case 1736:return new d.Da(h);default:throw d.i.fa("invalid argument.")}},O}()}(Y||(Y={})),function(d){var O=function(){function x(h,l){this.Te=d.ia.qf(h,-1),this.ua=new d.au,this.wl=l}return x.prototype.AW=function(h){this.ua.At(Math.min(this.Te.size,h)),this.ua.fn(h)},x.prototype.addElement=function(h,l){if(l===void 0)return this.eN(h);l=d.O.truncate(l%this.Te.size);var s=this.Te.get(l);return s==-1&&(s=this.ua.Ph(),this.Te.set(l,s)),this.ua.addElement(s,h)},x.prototype.eN=function(h){var l=this.wl.jz(h);l=d.O.truncate(l%this.Te.size);var s=this.Te.get(l);return s==-1&&(s=this.ua.Ph(),this.Te.set(l,s)),this.ua.addElement(s,h)},x.prototype.jd=function(h,l){if(l===void 0)this.KP(h);else{l=d.O.truncate(l%this.Te.size);var s=this.Te.get(l);if(s==-1)throw d.i.N();for(var a=this.ua.rc(s),c=-1;a!=-1;){var f=this.ua.lb(a);this.ua.ja(a)==h?(this.ua.jd(s,c,a),this.ua.rc(s)==-1&&(this.ua.bh(s),this.Te.set(l,-1))):c=a,a=f}}},x.prototype.KP=function(h){var l=this.wl.jz(h);l=d.O.truncate(l%this.Te.size);var s=this.Te.get(l);if(s==-1)throw d.i.N();for(var a=this.ua.rc(s),c=-1;a!=-1;){var f=this.ua.lb(a);this.ua.ja(a)==h?(this.ua.jd(s,c,a),this.ua.rc(s)==-1&&(this.ua.bh(s),this.Te.set(l,-1))):c=a,a=f}},x.prototype.rR=function(h){return h=d.O.truncate(h%this.Te.size),(h=this.Te.get(h))==-1?-1:this.ua.rc(h)},x.prototype.ER=function(h){return this.ua.lb(h)},x.prototype.vd=function(h){var l=this.wl.jz(this.ja(h));l=d.O.truncate(l%this.Te.size);var s=this.Te.get(l);if(s==-1)throw d.i.N();for(var a=this.ua.rc(s),c=-1;a!=-1;){if(a==h)return this.ua.jd(s,c,a),void(this.ua.rc(s)==-1&&(this.ua.bh(s),this.Te.set(l,-1)));c=a,a=this.ua.lb(a)}throw d.i.N()},x.prototype.ja=function(h){return this.ua.ja(h)},x.prototype.clear=function(){this.Te=d.ia.qf(this.Te.size,-1),this.ua.clear()},x.prototype.size=function(){return this.ua.TF()},x}();d.dL=O}(Y||(Y={})),function(d){var O=function(){function x(){this.Li=new d.$c(3),this.ua=new d.$c(6),this.sT=!1,this.je=-1}return x.prototype.fl=function(h){this.Li.jd(h)},x.prototype.Pw=function(){return this.Li.Ce()},x.prototype.bv=function(h){this.ua.jd(h)},x.prototype.$A=function(){return this.ua.Ce()},x.prototype.WB=function(h,l){this.Li.S(h,1,l)},x.prototype.ex=function(h,l){this.Li.S(h,2,l)},x.prototype.gX=function(h,l){this.Li.S(h,3,l)},x.prototype.UB=function(h,l){this.ua.S(h,4,l)},x.prototype.jX=function(h,l){this.ua.S(h,3,l)},x.prototype.TJ=function(h,l){this.ua.S(h,2,l)},x.prototype.Ph=function(h){var l=this.$A();return this.ua.S(l,3,this.je),this.ua.S(l,4,0),this.ua.S(l,5,h),this.je!=-1&&this.TJ(this.je,l),this.je=l},x.prototype.bh=function(h){this.LE(h);var l=this.ua.T(h,2),s=this.ua.T(h,3);return l!=-1?this.jX(l,s):this.je=s,s!=-1&&this.TJ(s,l),this.bv(h),s},x.prototype.At=function(h){this.ua.De(h)},x.prototype.PF=function(h){return this.ua.T(h,5)},x.prototype.fX=function(h,l){this.ua.S(h,5,l)},x.prototype.addElement=function(h,l){return this.tS(h,l)},x.prototype.tS=function(h,l){var s=this.Pw();this.ex(s,-1),this.ua.T(h,0)==-1&&this.ua.S(h,0,s);var a=this.ua.T(h,1);return this.WB(s,a),a!=-1&&this.ex(a,s),this.ua.S(h,1,s),this.setData(s,l),this.UB(h,this.bs(h)+1),this.sT&&this.gX(s,h),s},x.prototype.jd=function(h,l){var s=this.we(l),a=this.lb(l);return s!=-1?this.ex(s,a):this.ua.S(h,0,a),a!=-1?this.WB(a,s):this.ua.S(h,1,s),this.fl(l),this.UB(h,this.bs(h)-1),a},x.prototype.fn=function(h){this.Li.De(h)},x.prototype.getData=function(h){return this.Li.T(h,0)},x.prototype.setData=function(h,l){this.Li.S(h,0,l)},x.prototype.lb=function(h){return this.Li.T(h,2)},x.prototype.we=function(h){return this.Li.T(h,1)},x.prototype.rc=function(h){return this.ua.T(h,0)},x.prototype.Fc=function(h){return this.ua.T(h,1)},x.prototype.clear=function(){for(var h=this.je;h!=-1;)h=this.bh(h)},x.prototype.LE=function(h){for(var l=this.Fc(h);l!=-1;){var s=l;l=this.we(s),this.fl(s)}this.ua.S(h,0,-1),this.ua.S(h,1,-1),this.UB(h,0)},x.prototype.B=function(){return this.Li.size==0},x.prototype.TF=function(){return this.Li.size},x.prototype.bs=function(h){return this.ua.T(h,4)},x.prototype.qz=function(h){return this.ua.T(h,3)},x}();d.jp=O}(Y||(Y={})),function(d){var O=function(){function x(h){h===void 0?(this.ug=new d.$c(2),this.ua=new d.$c(4),this.je=-1,this.Qv=!0):(this.ug=new d.$c(2),this.ua=new d.$c(h?4:2),this.je=-1,this.Qv=h)}return x.prototype.fl=function(h){this.ug.jd(h)},x.prototype.Pw=function(){return this.ug.Ce()},x.prototype.bv=function(h){this.ua.jd(h)},x.prototype.$A=function(){return this.ua.Ce()},x.prototype.Ph=function(){var h=this.$A();return this.Qv&&(this.ua.S(h,3,this.je),this.je!=-1&&this.ua.S(this.je,2,h),this.je=h),h},x.prototype.bh=function(h){for(var l=this.rc(h);l!=-1;){var s=l;l=this.lb(l),this.fl(s)}this.Qv&&(l=this.ua.T(h,2),s=this.ua.T(h,3),l!=-1?this.ua.S(l,3,s):this.je=s,s!=-1&&this.ua.S(s,2,l)),this.bv(h)},x.prototype.At=function(h){this.ua.De(h)},x.prototype.addElement=function(h,l){var s=this.ua.T(h,1),a=this.Pw();return s!=-1?this.ug.S(s,1,a):this.ua.S(h,0,a),this.ua.S(h,1,a),this.ug.S(a,0,l),a},x.prototype.fn=function(h){this.ug.De(h)},x.prototype.jd=function(h,l,s){l!=-1?(this.ug.S(l,1,this.ug.T(s,1)),this.ua.T(h,1)==s&&this.ua.S(h,1,l)):(this.ua.S(h,0,this.ug.T(s,1)),this.ua.T(h,1)==s&&this.ua.S(h,1,-1)),this.fl(s)},x.prototype.Hy=function(h,l){var s=this.ua.T(h,1),a=this.ua.T(l,0);a!=-1&&(s!=-1?this.ug.S(s,1,a):this.ua.S(h,0,a),this.ua.S(h,1,this.ua.T(l,1))),this.Qv&&(h=this.ua.T(l,2),s=this.ua.T(l,3),h!=-1?this.ua.S(h,3,s):this.je=s,s!=-1&&this.ua.S(s,2,h)),this.bv(l)},x.prototype.ja=function(h){return this.ug.T(h,0)},x.prototype.Sj=function(h,l){this.ug.S(h,0,l)},x.prototype.lb=function(h){return this.ug.T(h,1)},x.prototype.rc=function(h){return this.ua.T(h,0)},x.prototype.Jn=function(h){return this.ja(this.rc(h))},x.prototype.clear=function(){this.ug.mj(!0),this.ua.mj(!0),this.je=-1},x.prototype.B=function(){return this.ug.size==0},x.prototype.TF=function(){return this.ug.size},x.prototype.qz=function(h){return this.ua.T(h,3)},x}();d.au=O}(Y||(Y={})),function(d){d.ta=function(){function O(){}return O.Wd=function(x,h,l){return h=h.xr(),x=x!=null&&x.Xd!==void 0?x.Xd(0):0,l&&(h*=4,x*=1.1),Math.max(x,h)},O.Er=function(x){return 2*Math.sqrt(2)*x},O.rN=function(x){return Math.sqrt(2)*x},O.kj=function(x,h,l){var s=new d.l;return h.A(s),O.Wd(x,s,l)},O.wE=function(x,h,l){return h=h.Tg(1,0).xr(),x=x!=null?x.Xd(1):0,l&&(h*=4,x*=1.1),Math.max(x,h)},O.mv=function(x,h){var l=new d.l;return x.xc(l),x=new d.l,h.xc(x),l.Zb(x),l},O.YN=function(x){var h=new d.l;if(x.xc(h),h.B())return null;var l=new d.du(h,8),s=-1,a=new d.l,c=!1;do for(var f=0,y=x.da();f<y;f++){if(x.Rj(f,a),(s=l.Jz(f,a,s))==-1){if(c)throw d.i.fa("internal error");x.yp(h,!1),c=!0,l.reset(h,8);break}c=!1}while(c);return l},O.nE=function(x){var h=new d.l;x.xc(h);for(var l=new d.du(h,8),s=-1,a=x.Ga(),c=new d.l,f=!1;a.$a();)for(;a.Ha();){var y=a.ha(),v=a.wb();if(y.A(c),(s=l.Jz(v,c,s))==-1){if(f)throw d.i.Qa();x.yp(h,!1),f=!0,l.reset(h,8),a.Zi();break}}return l},O.jj=function(x,h){var l=new d.l;x.xc(l);for(var s=new d.du(l,8),a=-1,c=new d.l,f=x.Ga(),y=!1;f.$a();)for(;f.Ha();){var v=f.ha(),_=f.wb();if(v.A(c),c.isIntersecting(h)&&(a=s.Jz(_,c,a))==-1){if(y)throw d.i.fa("internal error.");x.yp(l,!1),y=!0,s.reset(l,8),f.Zi();break}}return s},O.oE=function(x,h){for(var l=new d.du(h,8),s=new d.h,a=!1,c=new d.l,f=0;f<x.I();f++)if(x.D(f,s),h.contains(s)&&(c.K(s),l.vj(f,c)==-1)){if(a)throw d.i.Qa();a=!0,f=new d.l,x.yp(f,!1),l.reset(f,8),f=-1}return l},O.lR=function(x,h,l){var s=new d.l,a=new d.l;x.xc(s),h.xc(a),s.W(l,l),a.W(l,l);var c=new d.l;c.K(s),c.Ea(a),x=x.Ga(),h=h.Ga();var f=new d.xC;f.aC(l);var y=!1;for(f.pK();x.$a();)for(;x.Ha();)x.ha().A(s),s.isIntersecting(c)&&(y=!0,(l=new d.l).K(s),f.JD(x.wb(),l));if(f.iF(),!y)return null;for(s=!1,f.oK();h.$a();)for(;h.Ha();)h.ha().A(a),a.isIntersecting(c)&&(s=!0,(l=new d.l).K(a),f.ED(h.wb(),l));return f.hF(),s?f:null},O.mR=function(x,h,l,s,a){var c=x.getType(),f=h.getType(),y=new d.l,v=new d.l;x.xc(y),h.xc(v),y.W(l,l),v.W(l,l);var _=new d.l;_.K(y),_.Ea(v);var $=new d.xC;$.aC(l);var I=!1;$.pK();var k=0;for(l=x.da();k<l;k++)s&&c==1736&&!x.Ev(k)||(x.Rj(k,y),y.isIntersecting(_)&&(I=!0,$.JD(k,y)));if($.iF(),!I)return null;for(x=!1,$.oK(),s=0,l=h.da();s<l;s++)a&&f==1736&&!h.Ev(s)||(h.Rj(s,v),v.isIntersecting(_)&&(x=!0,$.ED(s,v)));return $.hF(),x?$:null},O.Ru=function(x,h,l){if(x!=h)for(var s=0;s<l;s++)x[s]==null?x[s]=d.h.al(h[s]):x[s].L(h[s])},O.Jy=function(x,h,l,s){var a=0;for(s+=0;a<s;l++,a++)x[a]==null&&(x[a]=[0,0]),x[a][0]=h[l].x,x[a][1]=h[l].y},O.Iy=function(x,h,l,s){var a=h,c=0;for(h=s+h;a<h;c++,a++)x[a]==null?x[a]=d.h.construct(l[c][0],l[c][1]):x[a].ma(l[c][0],l[c][1])},O.kP=function(x,h,l){if(x!=h)for(var s=0;s<l;s++)x[s]==null?x[s]=new d.Sa(h[s]):h[s].copyTo(x[s])},O.vE=function(x,h,l,s){var a=0;return x!=null&&(a=x.Xd(0),s&&!l||x==null||(a+=1.01*x.vz(0))),l&&(h*=4,a*=1.01),Math.max(a,h)},O.ty=function(x,h,l){return O.vE(x,h.xr(),l,!1)},O.gO=function(x,h){var l=new d.l;return h.A(l),O.ty(x,l,!0)},O.uy=function(x,h){return O.vE(x,h.xr(),!1,!0)},O.Hu=function(x,h){var l=new d.l;return h.A(l),O.uy(x,l)},O.AG=function(x,h,l,s){s*=s;var a=new d.h;if(a.uc(x,h),(x=new d.h).uc(l,h),h=a.Sk(),l=x.Sk(),h<=s&&l<=s)return!0;var c=d.lc.ox(a.wi(x));return(c<=s*h||c<=s*l)&&0<=a.Qh(x)},O.dK=function(x,h,l,s){for(var a=0;a<h;a++){var c=x[a].y,f=d.O.Rk(c,l,s);f!=c&&(x[a].y=f)}},O}()}(Y||(Y={})),function(d){var O,x,h=function(){function c(f){this.Ya=f}return c.prototype.compare=function(f,y,v){f=f.ja(v),v=this.Ya.nk(y);var _=this.Ya.nk(f);return v<_?-1:v==_?a.gq(y)&&a.Gv(f)?-1:a.gq(f)&&a.Gv(y)?1:0:1},c}(),l=function(){function c(f){this.Ya=f}return c.prototype.nr=function(f,y,v){this.Ya.GX(v,f,y)},c.prototype.$p=function(f){return this.Ya.nk(f)},c}();(x=O||(O={}))[x.initialize=0]="initialize",x[x.pIn=1]="pIn",x[x.pL=2]="pL",x[x.pR=3]="pR",x[x.pT=4]="pT",x[x.right=5]="right",x[x.left=6]="left",x[x.all=7]="all";var s=function(){function c(){this.Ya=null,this.Qi=new d.Nc,this.hi=new d.ia(0),this.sg=[0,0]}return c.prototype.Xi=function(f,y){this.Qi.oa=f.oa-y,this.Qi.va=f.va+y,this.hi.resize(0),this.he=0,this.sg[0]=0},c.prototype.EB=function(f,y,v){if(f>y)throw d.i.N();this.Qi.oa=f-v,this.Qi.va=y+v,this.hi.resize(0),this.he=0,this.sg[0]=0},c.prototype.Uo=function(f,y){this.Qi.oa=f-y,this.Qi.va=f+y,this.hi.resize(0),this.he=0,this.sg[0]=0},c.prototype.next=function(){if(!this.Ya.lq)throw d.i.Hb();if(0>this.he)return-1;for(var f=!0;f;)switch(this.sg[this.he]){case 1:f=this.FU();break;case 2:f=this.GU();break;case 3:f=this.HU();break;case 4:f=this.IU();break;case 5:f=this.GW();break;case 6:f=this.kT();break;case 7:f=this.tN();break;case 0:f=this.Gz();break;default:throw d.i.Qa()}return this.Og!=-1?this.Mp()>>1:-1},c.construct=function(f){var y=new c;return y.Ya=f,y.hi.Jb(20),y.he=-1,y},c.prototype.Gz=function(){return this.Og=this.vH=this.Mi=this.Lc=-1,this.Ya.me!=null&&0<this.Ya.me.size?(this.sg[0]=1,this.Mi=this.Ya.kf,!0):(this.he=-1,!1)},c.prototype.FU=function(){if(this.Lc=this.Mi,this.Lc==-1)return this.Og=this.he=-1,!1;var f=this.Ya.Np(this.Lc);return this.Qi.va<f?(f=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=6),!0):f<this.Qi.oa?(f=this.Ya.mk(this.Lc),this.Mi=this.Ya.lk(this.Lc),f!=-1&&(this.ei=this.Ya.Zr(f),this.sg[++this.he]=5),!0):(this.sg[this.he]=2,this.vH=this.Lc,f=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=7),!0)},c.prototype.GU=function(){if(this.Lc=this.Mi,this.Lc==-1)return this.sg[this.he]=3,this.Mi=this.Ya.lk(this.vH),!0;if(this.Ya.Np(this.Lc)<this.Qi.oa){var f=this.Ya.mk(this.Lc);return this.Mi=this.Ya.lk(this.Lc),f!=-1&&(this.ei=this.Ya.Zr(f),this.sg[++this.he]=5),!0}return f=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=7),(f=this.Ya.lk(this.Lc))!=-1&&this.hi.add(f),!0},c.prototype.HU=function(){if(this.Lc=this.Mi,this.Lc==-1)return this.sg[this.he]=4,!0;if(this.Qi.va<this.Ya.Np(this.Lc)){var f=this.Ya.mk(this.Lc);return this.Mi=this.Ya.qj(this.Lc),f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=6),!0}return f=this.Ya.mk(this.Lc),this.Mi=this.Ya.lk(this.Lc),f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=7),(f=this.Ya.qj(this.Lc))!=-1&&this.hi.add(f),!0},c.prototype.IU=function(){if(this.hi.size==0)return this.Og=this.he=-1,!1;this.Lc=this.hi.get(this.hi.size-1),this.hi.resize(this.hi.size-1);var f=this.Ya.mk(this.Lc);return f!=-1&&(this.ei=this.Ya.kl(f),this.sg[++this.he]=7),this.Ya.qj(this.Lc)!=-1&&this.hi.add(this.Ya.qj(this.Lc)),this.Ya.lk(this.Lc)!=-1&&this.hi.add(this.Ya.lk(this.Lc)),!0},c.prototype.kT=function(){return this.Og=this.ei,this.Og!=-1&&a.gq(this.Mp())&&this.Ya.nk(this.Mp())<=this.Qi.va?(this.ei=this.SF(),!1):(this.he--,!0)},c.prototype.GW=function(){return this.Og=this.ei,this.Og!=-1&&a.Gv(this.Mp())&&this.Ya.nk(this.Mp())>=this.Qi.oa?(this.ei=this.QR(),!1):(this.he--,!0)},c.prototype.tN=function(){return this.Og=this.ei,this.Og!=-1&&a.gq(this.Mp())?(this.ei=this.SF(),!1):(this.he--,!0)},c.prototype.SF=function(){return this.Ya.Sf?this.Ya.$f.lb(this.Og):this.Ya.Ti.lb(this.Og)},c.prototype.QR=function(){return this.Ya.Sf?this.Ya.$f.we(this.Og):this.Ya.Ti.we(this.Og)},c.prototype.Mp=function(){return this.Ya.Sf?this.Ya.$f.ja(this.Og):this.Ya.Ti.getData(this.Og)},c}();d.EY=s;var a=function(){function c(f){this.Am=this.$h=this.$f=this.Ti=this.Km=this.Ej=this.me=this.Fj=null,this.Sf=f,this.lq=this.Sv=!1}return c.prototype.kr=function(){this.Nk(!0)},c.prototype.Br=function(f,y){if(!this.Sv)throw d.i.Hb();this.Fj.push(new d.Nc(f,y))},c.prototype.Fp=function(){if(!this.Sv)throw d.i.fa("invalid call");this.Sv=!1,this.lq=!0,this.Sf||(this.vS(),this.Zv=this.Fj.length)},c.prototype.vj=function(f){if(!this.Sf||!this.lq)throw d.i.N("invalid call");if(this.kf==-1){var y=this.Fj.length;if(this.iA){var v=new d.ia(0);v.Jb(2*y),this.bJ(v),this.$h.Jb(2*y),this.$h.resize(0),this.aJ(v),this.Km.resize(y,-1),this.Km.Wj(-1,0,y),this.iA=!1}else this.Km.Wj(-1,0,y);this.kf=this.Tu()}y=this.pG(f<<1,this.kf),v=this.$f.addElement(1+(f<<1),this.xz(y)),this.VJ(y,v),this.Km.set(f,y),this.Zv++},c.prototype.remove=function(f){if(!this.Sf||!this.lq)throw d.i.fa("invalid call");var y=this.Km.get(f);if(y==-1)throw d.i.N("the interval does not exist in the interval tree");this.Km.set(f,-1),this.Zv--;var v=this.xz(y),_=this.$f.ZR(v);this.$f.vd(this.wR(y),v),this.$f.vd(this.TR(y),v),(f=this.$f.size(v))==0&&(this.$f.MP(v),this.ZJ(_,-1)),this.Ej.jd(y),v=this.UF(_);var $=this.qj(_),I=this.lk(_);for(y=0;!(0<f||_==this.kf||$!=-1&&I!=-1);)_==this.qj(v)?$!=-1?(this.Ok(v,$),this.Uj($,v),this.Ok(_,-1)):I!=-1?(this.Ok(v,I),this.Uj(I,v),this.Qk(_,-1)):this.Ok(v,-1):$!=-1?(this.Qk(v,$),this.Uj($,v),this.Ok(_,-1)):I!=-1?(this.Qk(v,I),this.Uj(I,v),this.Qk(_,-1)):this.Qk(v,-1),this.Uj(_,-1),y++,_=v,f=(v=this.mk(_))!=-1?this.$f.size(v):0,$=this.qj(_),I=this.lk(_),v=this.UF(_)},c.prototype.reset=function(){if(!this.Sf||!this.lq)throw d.i.N("invalid call");this.Nk(!1)},c.prototype.size=function(){return this.Zv},c.prototype.getIterator=function(){return s.construct(this)},c.prototype.bJ=function(f){for(var y=this.Fj.length,v=0;v<2*y;v++)f.add(v);this.HX(f,2*y)},c.prototype.aJ=function(f){for(var y=NaN,v=0;v<f.size;v++){var _=f.get(v),$=this.nk(_);$!=y&&(this.$h.add(_),y=$)}},c.prototype.vS=function(){var f=this.Fj.length,y=new d.ia(0);y.Jb(2*f),this.bJ(y),this.$h.Jb(2*f),this.$h.resize(0),this.aJ(y),this.Ej.De(f),this.Ti.fn(2*f);var v=d.Yc.Oh(f);for(v.Wj(-1,0,f),this.kf=this.Tu(),f=0;f<y.size;f++){var _=y.get(f),$=v.get(_>>1);$!=-1?this.VJ($,this.Ti.addElement(this.xz($),_)):($=this.pG(_,this.kf),v.set(_>>1,$))}},c.prototype.pG=function(f,y){var v=y,_=y,$=-1,I=0,k=this.$h.size-1,A=0,P=f>>1,D=NaN,j=NaN,B=!0,q=this.DR(P);for(P=this.AR(P);B;){I<k?(A=I+d.O.truncate((k-I)/2),this.gz(v)==-1&&this.FJ(v,this.$h.get(A),this.$h.get(A+1))):this.gz(v)==-1&&this.FJ(v,this.$h.get(I),this.$h.get(I));var z=this.Np(v);if(P<z)y!=-1&&(y==v?(_=v,D=z,j=(y=this.qj(v))!=-1?this.Np(y):NaN):j>z&&(z<D?this.Ok(_,v):this.Qk(_,v),this.Qk(v,y),this.Sf&&(this.Uj(v,_),this.Uj(y,v)),_=v,D=z,y=-1,j=NaN)),(k=this.xR(v))==-1&&(k=this.Tu(),this.dX(v,k)),v=k,k=A;else if(q>z)y!=-1&&(y==v?(_=v,D=z,j=(y=this.lk(v))!=-1?this.Np(y):NaN):j<z&&(z<D?this.Ok(_,v):this.Qk(_,v),this.Ok(v,y),this.Sf&&(this.Uj(v,_),this.Uj(y,v)),_=v,D=z,y=-1,j=NaN)),(I=this.UR(v))==-1&&(I=this.Tu(),this.oX(v,I)),v=I,I=A+1;else{(B=this.mk(v))==-1&&(B=this.zP(v),this.ZJ(v,B));var Z=this.fN(B,f);$=this.xP(),this.qX($,B),this.cX($,Z),v!=y&&(z<D?this.Ok(_,v):this.Qk(_,v),this.Sf&&this.Uj(v,_),y!=-1&&(j<z?this.Ok(v,y):this.Qk(v,y),this.Sf&&this.Uj(y,v))),B=!1}}return $},c.prototype.Tu=function(){return this.me.Ce()},c.prototype.zP=function(f){return this.Sf?this.$f.Pr(f):this.Ti.Ph(f)},c.prototype.xP=function(){return this.Ej.Ce()},c.prototype.Nk=function(f){f?(this.Sv=this.iA=!0,this.lq=!1,this.$h==null?this.$h=d.Yc.Oh(0):this.$h.resize(0),this.Fj==null?this.Fj=[]:this.Fj.length=0):this.iA=!1,this.Sf?this.Km==null?(this.Km=d.Yc.Oh(0),this.$f=new d.Yj,this.$f.Vo(new h(this))):this.$f.clear():this.Ti==null?this.Ti=new d.jp:this.Ti.clear(),this.me==null?(this.Ej=new d.$c(3),this.me=new d.$c(this.Sf?8:7)):(this.Ej.mj(!1),this.me.mj(!1)),this.kf=-1,this.Zv=0},c.prototype.FJ=function(f,y,v){this.XW(f,y),this.YW(f,v)},c.prototype.Np=function(f){var y=this.gz(f);return y==-1?NaN:(y=this.nk(y))==(f=this.nk(this.gR(f)))?y:.5*(y+f)},c.prototype.XW=function(f,y){this.me.S(f,0,y)},c.prototype.YW=function(f,y){this.me.S(f,1,y)},c.prototype.dX=function(f,y){this.me.S(f,3,y)},c.prototype.oX=function(f,y){this.me.S(f,4,y)},c.prototype.ZJ=function(f,y){this.me.S(f,2,y)},c.prototype.Ok=function(f,y){this.me.S(f,5,y)},c.prototype.Qk=function(f,y){this.me.S(f,6,y)},c.prototype.Uj=function(f,y){this.me.S(f,7,y)},c.prototype.qX=function(f,y){this.Ej.S(f,0,y)},c.prototype.fN=function(f,y){return this.Sf?this.$f.addElement(y,f):this.Ti.addElement(f,y)},c.prototype.cX=function(f,y){this.Ej.S(f,1,y)},c.prototype.VJ=function(f,y){this.Ej.S(f,2,y)},c.prototype.kl=function(f){return this.Sf?this.$f.rc(f):this.Ti.rc(f)},c.prototype.Zr=function(f){return this.Sf?this.$f.Fc(f):this.Ti.Fc(f)},c.gq=function(f){return!(1&f)},c.Gv=function(f){return!(1&~f)},c.prototype.gz=function(f){return this.me.T(f,0)},c.prototype.gR=function(f){return this.me.T(f,1)},c.prototype.mk=function(f){return this.me.T(f,2)},c.prototype.xR=function(f){return this.me.T(f,3)},c.prototype.UR=function(f){return this.me.T(f,4)},c.prototype.qj=function(f){return this.me.T(f,5)},c.prototype.lk=function(f){return this.me.T(f,6)},c.prototype.UF=function(f){return this.me.T(f,7)},c.prototype.xz=function(f){return this.Ej.T(f,0)},c.prototype.wR=function(f){return this.Ej.T(f,1)},c.prototype.TR=function(f){return this.Ej.T(f,2)},c.prototype.DR=function(f){return this.Fj[f].oa},c.prototype.AR=function(f){return this.Fj[f].va},c.prototype.HX=function(f,y){this.Am==null&&(this.Am=new d.Xt);var v=new l(this);this.Am.sort(f,0,y,v)},c.prototype.GX=function(f,y,v){var _=this;f.Vd(y,v,function($,I){var k=_.nk($),A=_.nk(I);return k<A||k==A&&c.gq($)&&c.Gv(I)?-1:1})},c.prototype.nk=function(f){var y=this.Fj[f>>1];return c.gq(f)?y.oa:y.va},c}();d.sr=a}(Y||(Y={})),function(d){var O=function(){function x(h){if(h==null)throw d.i.fa("Invalid arguement");this.hf=h;var l=h.nR();l.hS()?h.ef.IG()?this.lo=d.si.PannableFold:this.lo=d.si.Clip:this.lo=d.si.DontClip,l.iS()?h.Yf.IG()?this.Qm=d.si.PannableFold:this.Qm=d.si.Clip:this.Qm=d.si.DontClip,this.Bm=l.Jr,this.mH=l.Vu,h=this.hf.sH,this.aH=h.hs(2147483648),this.Uv=h.hs(1073741824)}return x.zh=function(h,l,s){return l.ww.zh(h,s)},x.Rt=function(h,l,s,a){return h.ww.Rt(l,s,a)},x.Qt=function(h,l,s,a){if(s=0>s?l.length:s,(h=h.ww.Rt(l,s,a))==s)return h;for(var c=l=0;c<s;c++){var f=a[c];f.isNaN()||(l<c&&a[l].L(f),l++)}for(;l<s;l++)a[l].Rc();return h},x.transform=function(h,l,s,a,c){if(h.isIdentity())return d.ta.kP(a,l,s),s;for(var f=[],y=0,v=0;v<s;){for(var _=Math.min(f.length,s-v),$=v,I=0;$<_;$++,I++)f[I]==null?f[I]=l[$].D():l[$].D(f[I]);var k=c?x.Qt(h,f,_,f):x.Rt(h,f,_,f);for(I=$=0;$<k;$++,I++)a[v]==null&&(a[v]=new d.Sa(l[v])),a[v].Cb(f[I]);v+=_,y+=k}return y},x.prototype.Rt=function(h,l,s){if(this.hf.isIdentity())return h!=s&&d.ta.Ru(s,h,l),l;var a=this.hf.ef,c=this.hf.Yf,f=a.Sb(),y=c.Sb();if(f==0&&f===y){var v=a.Qp();return c=v/(c=c.Qp()),(v=new d.Dd).setScale(c,c),v.eY(h,l,s),l}if(v=d.O.Fu(Math.min(l,64)),f==3){var _=a.Ji;f=(a=_.fk()).Sb(),s!=h&&d.ta.Ru(s,h,l),d.zb.$k(_,s,l,!0),_.Qt(d.bm.forward,s,l),d.zb.Zk(_,s,l,!0)}if(f==3||y===3)throw d.i.fa("image: transform_in_place_");if(f==2)this.lo==d.si.Clip?(s!=h&&d.ta.Ru(s,h,l),h=a.ml(),d.zb.OS(h,a,s,l)):(s!=h&&d.ta.Ru(s,h,l),a.Wc()&&(f=a.Xd(0),_=a.Oe(),d.zb.EX(s,l,_,f),d.zb.qF(s,l,a,0))),d.zb.IL(a,s,l,v);else for(f=a.Xd(0),_=a.Oe(),a=0;a<l;a++)d.zb.FX(h[a],_,f,s[a]);for(d.zb.GL(this.hf,s,l,v),h=0,(y=y==2)?h=c.zi():isNaN(this.Bm)||(h=this.Bm),y&&this.Qm!=d.si.Clip||d.zb.qF(s,l,c.sc(),h),y&&(d.zb.yG(s,l,c,this.Qm),d.zb.HL(c,s,l,v)),h=l,a=0;a<l;++a)s[a].isNaN()&&h--;return h},x.prototype.zh=function(h,l){if(this.hf.isIdentity()||h.B())return h;if(h.getType()==33)return this.XI(h);var s=this.hf.ef,a=this.hf.Yf,c=s.Sb(),f=a.Sb();if(c==0&&c==f)return l=s.Qp(),l/=a=a.Qp(),(a=new d.Dd).setScale(l,l),(h=d.aa.jg(h)).Oc(a),h;switch(h.getType()){case 1607:case 1736:h=this.VI(h,l);break;case 550:h=this.fW(h,l);break;case 197:h=this.eW(h,l);break;default:throw d.i.fa("")}return h},x.prototype.XI=function(h){var l=h.D(),s=[];return s[0]=l,this.Rt(s,1,s),(h=new d.Sa(h)).Cb(s[0]),h},x.prototype.VI=function(h,l){if(h.tm())throw d.i.fa("curves not supported");var s=h.getType();if(s==1736)return this.gW(h,l);if(s==1607)return this.hW(h,l);throw d.i.fa("projectMultiPath")},x.prototype.gW=function(h,l){var s=this.hf.ef,a=this.hf.Yf,c=s.Sb(),f=a.Sb(),y=d.O.Fu(Math.min(h.I(),64)),v=d.Da.jg(h);c==3&&(c=(s=(h=s.Ji).fk()).Sb(),v=h.$k(v,!0),this.wp(h,d.bm.forward,v),v=h.Zk(v,!0)),h=null,f==3&&(f=(a=(h=a.Ji).fk()).Sb());var _=c==2,$=f==2,I=$?a.sc():a,k=!$&&!this.Uv;f=!1;var A=v;if(_){if((A=d.zb.UI(A,s,this.lo,l)).B())return A}else{if(v=new d.l,A.xc(v),c=s.Oe(),v.G<c.G||v.H>c.H){var P=d.l.construct(v.v-1,c.G,v.C+1,c.H);if((A=d.ri.Nu(A,P,s,NaN,0,l)).B())return A}v.R()>2*c.R()&&(A=d.zb.Hp(A,-2*c.R(),2*c.R(),s,!0,0,!0,l))}v=this.mH,(c=!isNaN(v))&&(A=d.Xl.local().V(A,v,l)),P=$?a.kk():null;var D=NaN;_&&(D=s.zi());var j=a.Wr()!=null;if(this.aH)_&&(d.zb.ur(s,D,A,y),c&&(_=s.hh(),v*=(D=s.sc().hh())/_)),d.zb.tr(this.hf,A,k,y),c&&(_=s.sc().hh(),v*=(D=a.sc().hh())/_),s=A;else{var B=new d.Ta(A.description);B.DD(A),_&&(d.zb.ur(s,D,B,y),c&&(_=s.hh(),v*=(D=s.sc().hh())/_)),d.zb.tr(this.hf,B,k,y),c&&(_=s.sc().pm(),v*=(D=a.sc().pm())/_),k=NaN,$?(P=a.kk(),k=a.zi()):isNaN(this.Bm)||(k=this.Bm),_=x.tv(s)|x.tv(a),D=10*I.Xd(0),this.Uv&&(_=3,D=0),s=d.zb.UQ(A,s,B,I,k,l,_,D)}return j&&(s=d.zb.XD(s,a,l)),$&&(f||($=I.Oe().R(),s.Tg(0,0).R()>=$-I.Xd(0)&&(I=P.getNorthPoleLocation(),$=P.getSouthPoleLocation(),A=P.getNorthPoleGeometry(),P=P.getSouthPoleGeometry(),k=0,A==d.Cg.PE_POLE_POINT&&I!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(k=1),P==d.Cg.PE_POLE_POINT&&$!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(k|=2),k!==0&&(f=!0))),s=d.zb.Mz(s,a,this.Qm,l),c&&(s=d.Xl.local().V(s,v,l)),d.zb.Lx(a,s,y)),s.B()||(f&&(s=d.Yl.local().V(s,a,!1,l)),h!=null&&(s=h.Zk(s,!1),this.wp(h,d.bm.reverse,s),s=h.$k(s,!1))),s},x.tv=function(h){if(h.Sb()!=2)return 0;var l=0,s=h.kk();h=s.getNorthPoleLocation();var a=s.getSouthPoleLocation(),c=s.getNorthPoleGeometry();return s=s.getSouthPoleGeometry(),c==d.Cg.PE_POLE_POINT&&h!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(l=1),s==d.Cg.PE_POLE_POINT&&a!=d.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(l|=2),l},x.prototype.hW=function(h,l){var s=this.hf.ef,a=this.hf.Yf,c=s.Sb(),f=a.Sb(),y=d.O.Fu(Math.min(h.I(),64)),v=d.Ta.jg(h);c==3&&(c=(s=(h=s.Ji).fk()).Sb(),v=h.$k(v,!0),this.wp(h,d.bm.forward,v),v=h.Zk(v,!0)),h=null,f==3&&(f=(a=(h=a.Ji).fk()).Sb());var _=c==2;c=(f=f==2)?a.sc():a;var $=!f&&!this.Uv;if(_){if((v=d.zb.UI(v,s,this.lo,l)).B())return v}else{var I=new d.l;v.xc(I);var k=s.Oe();if((I.G<k.G||I.H>k.H)&&(I=d.l.construct(I.v-1,k.G,I.C+1,k.H),(v=d.ri.Nu(v,I,s,NaN,0,l)).B()))return v}var A=NaN;_&&(A=s.zi()),I=a.Wr()!=null,k=this.mH;var P=!isNaN(k);if(P&&(v=d.Xl.local().V(v,k,l)),this.aH)_&&d.zb.ur(s,A,v,y),P&&(_=s.hh(),k*=(A=s.sc().hh())/_),d.zb.tr(this.hf,v,$,y),P&&(_=s.sc().hh(),k*=(A=a.sc().hh())/_),s=v;else{var D=new d.Ta(v.description);D.DD(v),_&&(d.zb.ur(s,A,D,y),P&&(_=s.hh(),k*=(A=s.sc().hh())/_)),d.zb.tr(this.hf,D,$,y),P&&(_=s.sc().hh(),k*=(A=a.sc().hh())/_),$=NaN,f?$=a.zi():isNaN(this.Bm)||($=this.Bm),_=x.tv(s)|x.tv(a),A=10*c.Xd(0),this.Uv&&(_=3,A=0),s=d.zb.VQ(v,s,D,c,$,l,_,A)}return I&&(s=d.zb.XD(s,a,l)),f&&(s=d.zb.Mz(s,a,this.Qm,l),P&&(s=d.Xl.local().V(s,k,l)),d.zb.Lx(a,s,y)),s.B()||h!=null&&(s=h.Zk(s,!1),this.wp(h,d.bm.reverse,s),s=h.$k(s,!1)),s},x.prototype.eW=function(h,l){var s=(h.ca()+h.R())/400;return s!=0?(s=d.Xl.local().V(h,s,l),s=this.VI(s,l),l=h.Ia(),s.bn(l)):(l=new d.Sa(h.Ip()),s=this.XI(l),l=h.Ia(),s.B()?l.Oa():(h.copyTo(l),h=s.D(),l.K(h.x,h.y,h.x,h.y))),l},x.prototype.fW=function(h,l){h=d.aa.jg(h);var s=this.hf.ef,a=this.hf.Yf,c=s.Sb(),f=a.Sb(),y=d.O.Fu(Math.min(h.I(),64));if(c==3){var v=s.Ji;c=(s=v.fk()).Sb(),h=v.Zk(h,!0),this.wp(v,d.bm.forward,h),h=v.$k(h,!0)}if(c==2){if(this.lo==d.si.Clip?h=d.Xj.local().V(h,s.ml(),s,l):s.Wc()&&(c=new d.l,h.xc(c),s.Oe().contains(c)||(this.lo==d.si.PannableFold&&(h=d.zb.lj(h,s)),d.zb.Jt(h,s.Oe(),s.Xd(0),!0),h=d.zb.Fn(h,s,0,!0,0,l))),h.B())return h;d.zb.ur(s,0,h,y)}else d.zb.Jt(h,s.Oe(),s.Xd(0),!0);return d.zb.tr(this.hf,h,!1,y),s=0,c=!1,v=null,f==3&&(c=!0,f=(a=(v=a.Ji).fk()).Sb()),(f=f==2)?s=a.zi():isNaN(this.Bm)||(s=this.Bm),f&&this.Qm!=d.si.Clip||(h=d.zb.Fn(h,a.sc(),s,!1,0,l)),f&&(h=d.zb.Mz(h,a,this.Qm,l),d.zb.Lx(a,h,y),h.B())||c&&(h=v.Zk(h,!0),this.wp(v,d.bm.reverse,h),h=v.$k(h,!0)),h},x.prototype.wp=function(h,l,s){var a=s.I();if(a!=0){for(var c=s.ub(0),f=d.O.lg(200,0),y=[],v=0;v<a;){var _=Math.min(100,a-v);c.Vw(2*v,2*_,f,2,!0);for(var $=0;$<_;++$)y[$]=d.h.construct(f[2*v],f[2*v+1]);h.Qt(l,y,_),v+=_}s.Pc(1993)}},x.Uy=function(h,l,s){if(h==null||l==null||!l.Wc())throw d.i.fa("Invalid Arguement");if(h.B())return h;var a=h.getType();return a==197?(a=new d.Da(h.description)).ad(h,!1):d.aa.yd(a)?(a=new d.Ta(h.description)).oc(h,!0):a=h,(a=d.zb.lj(a,l)).B()?a:d.zb.Fn(a,l,0,a!=h,0,s)},x.nj=function(h,l,s,a){if(h==null||l==null||!l.Wc())throw d.i.fa("Invalid Arguement");if(h.B())return h;var c=h.getType();if(d.aa.Hc(c)){h=d.zb.lj(h,l),c=new d.l,h.A(c);for(var f=d.ta.ty(l,c,!1),y=l.gh(),v=Math.floor((c.v-y.v)/y.R())*y.R()+y.v;v<c.C;)v>c.v+f&&v<c.C-f&&(h=d.zb.uS(h,l,s,v)),v+=y.R()}else{if(c==197)return(c=new d.Da(h.description)).ad(h,!1),x.nj(c,l,s,a);if(d.aa.yd(c))return(c=new d.Ta(h.description)).oc(h,!0),x.nj(c,l,s,a)}return x.Uy(h,l,a)},x}();d.bu=O}(Y||(Y={})),function(d){var O=function(x){function h(l,s,a,c){var f=x.call(this)||this;return l===void 0?f.description=d.ee.og():a===void 0?f.description=l:(f.description=d.ee.og(),f.ZB(l,s),f.Ql(a,c)),f}return Kt(h,x),h.prototype.getType=function(){return 322},h.prototype.Qb=function(){var l=this.sa-this.pa,s=this.na-this.la;return Math.sqrt(l*l+s*s)},h.prototype.Bi=function(l){var s=this.sa-this.pa,a=this.na-this.la;return Math.sqrt(s*s+a*a)<=l},h.prototype.Pn=function(){return!1},h.prototype.kg=function(){var l=new d.h;return l.uc(this.wc(),this.ac()),l},h.cP=function(l,s){return new h(l.x,l.y,s.x,s.y)},h.prototype.bn=function(l){l.Oa(),l.Nf(this.description);var s=new d.l;this.A(s),l.Xo(s),s=1;for(var a=this.description.Aa;s<a;s++)for(var c=this.description.kd(s),f=d.ra.Va(c);s<f;s++){var y=this.Tg(c,0);l.setInterval(c,0,y)}},h.prototype.A=function(l){l.K(this.sa,this.na,this.pa,this.la),l.normalize()},h.prototype.Qo=function(l){l.Oa(),l.Zb(this.sa,this.na,this.Od(0,1,0)),l.Zb(this.pa,this.la,this.Od(1,1,0))},h.prototype.Oc=function(l){if(l instanceof d.Dd){this.vc();var s=new d.h;s.x=this.sa,s.y=this.na,l.Eh(s,s),this.sa=s.x,this.na=s.y,s.x=this.pa,s.y=this.la,l.Eh(s,s),this.pa=s.x,this.la=s.y}else this.vc(),(s=new d.Nd).x=this.sa,s.y=this.na,s.z=this.Od(0,1,0),s=l.fp(s),this.sa=s.x,this.na=s.y,this.tn(0,1,0,s.z),s.x=this.pa,s.y=this.la,s.z=this.Od(1,1,0),s=l.fp(s),this.pa=s.x,this.la=s.y,this.tn(1,1,0,s.z)},h.prototype.Ia=function(){return new h(this.description)},h.prototype.Tx=function(l,s){return(this.pa-l-(this.sa-l))*(this.la-s+(this.na-s))*.5},h.prototype.vx=function(l){return l*this.Qb()},h.prototype.NG=function(l){return l/this.Qb()},h.prototype.DF=function(l){return d.lc.hq(this.sa,this.pa,l)},h.prototype.fR=function(l){return d.lc.hq(this.na,this.la,l)},h.prototype.dl=function(l,s){var a=new d.ig;return this.ah(l,s,a),a.get()},h.prototype.ah=function(l,s,a){if(a==null)throw d.i.N();a.Or(),(a=a.get()).Nf(this.description);var c=new d.h;this.hc(l,c),a.ZB(c.x,c.y),this.hc(s,c),a.Ql(c.x,c.y),c=1;for(var f=this.description.Aa;c<f;c++)for(var y=this.description.Ed(c),v=d.ra.Va(y),_=0;_<v;_++){var $=this.Uc(l,y,_);a.YB(y,_,$),$=this.Uc(s,y,_),a.OB(y,_,$)}},h.prototype.Uc=function(l,s,a){if(s==0)return a==0?this.hc(l).x:this.hc(l).y;switch(d.ra.lz(s)){case 0:return .5>l?this.wv(s,a):this.gv(s,a);case 1:var c=this.wv(s,a);return s=this.gv(s,a),d.lc.hq(c,s,l);case 2:throw d.i.fa("not implemented")}throw d.i.Qa()},h.prototype.fe=function(l,s){var a=this.pa-this.sa,c=this.la-this.na,f=a*a+c*c;return f==0?.5:(l=((l.x-this.sa)*a+(l.y-this.na)*c)/f,s||(0>l?l=0:1<l&&(l=1)),l)},h.prototype.cq=function(l,s,a,c){if(l){if((l=this.la-this.na)==0)return s==this.la?-1:0;if(0>(s=(s-this.na)/l)||1<s)return 0;a!=null&&(a[0]=this.DF(s))}else{if((l=this.pa-this.sa)==0)return s==this.pa?-1:0;if(0>(s=(s-this.sa)/l)||1<s)return 0;a!=null&&(a[0]=this.fR(s))}return c!=null&&(c[0]=s),1},h.prototype.Pe=function(l,s){var a=this.la-this.na;return a==0?l==this.la?s:NaN:(l=(l-this.na)/a,s=this.DF(l),l==1&&(s=this.pa),s)},h.prototype.ru=function(l,s,a){return 0<=this.rp(l.x,l.y,s,a)},h.prototype.vi=function(l,s,a){return 0<=this.rp(l,s,a,!0)},h.prototype.qs=function(l,s){return this.ru(l,s,!1)},h.prototype.rI=function(){if(this.la<this.na||this.la==this.na&&this.pa<this.sa){var l=this.sa;this.sa=this.pa,this.pa=l,l=this.na,this.na=this.la,this.la=l,l=0;for(var s=this.description.Oq-2;l<s;l++){var a=this.ka[l];this.ka[l]=this.ka[l+s],this.ka[l+s]=a}}},h.prototype.uu=function(l,s){(s=d.h.construct(l,s)).sub(this.ac());var a=new d.h;return a.uc(this.wc(),this.ac()),(l=a.wi(s))>(s=8881784197001252e-31*(Math.abs(a.x*s.y)+Math.abs(a.y*s.x)))?-1:l<-s?1:0},h.prototype.rp=function(l,s,a,c){var f=this.sa,y=this.na,v=l-f,_=s-y;if((v=Math.sqrt(v*v+_*_))<=Math.max(a,6661338147750939e-31*v))return c&&v==0?NaN:0;if(v=l-this.pa,_=s-this.la,(v=Math.sqrt(v*v+_*_))<=Math.max(a,6661338147750939e-31*v))return c&&v==0?NaN:1;if(v=this.pa-this.sa,_=this.la-this.na,0<(c=Math.sqrt(v*v+_*_))){var $=1/c,I=l-f,k=s-y,A=I*(v*=$)+k*(_*=$),P=17763568394002505e-31*(Math.abs(I*v)+Math.abs(k*_)),D=v;if(v=-_,_=D,A<-(P=Math.max(a,P))||A>c+P)return NaN;if(Math.abs(I*v+k*_)<=Math.max(a,17763568394002505e-31*(Math.abs(I*v)+Math.abs(k*_)))&&(.5>=(v=d.O.Rk(A*$,0,1))?(_=this.sa+(this.pa-this.sa)*v,c=this.na+(this.la-this.na)*v):(_=this.pa-(this.pa-this.sa)*(1-v),c=this.la-(this.la-this.na)*(1-v)),d.h.Oy(_,c,l,s)<=a)){if(.5>v){if(d.h.Oy(_,c,f,y)<=a)return 0}else if(d.h.Oy(_,c,this.pa,this.la)<=a)return 1;return v}}return NaN},h.prototype.Nb=function(l){return l!=null&&(l==this||l.constructor===this.constructor&&this.FM(l))},h.prototype.rD=function(l,s,a){var c=a?this.sa:this.pa;a=a?this.na:this.la;var f=new d.h;return f.x=l.pa-c,f.y=l.la-a,!(s.Qh(f)>6661338147750939e-31*s.fD(f))||(f.x=l.sa-c,f.y=l.na-a,s.Qh(f)<=6661338147750939e-31*s.fD(f))},h.prototype.qD=function(l){var s=new d.h;return s.x=this.pa-this.sa,s.y=this.la-this.na,!!this.rD(l,s,!1)&&(s.Sq(),!!this.rD(l,s,!0))},h.NM=function(l,s){var a=l.uu(s.sa,s.na),c=l.uu(s.pa,s.la);return!(0>a&&0>c||0<a&&0<c)&&(a=s.uu(l.sa,l.na),c=s.uu(l.pa,l.la),!(0>a&&0>c||0<a&&0<c)&&((a=l.Qb())>(c=s.Qb())?l.qD(s):s.qD(l)))},h.LM=function(l,s,a){var c=d.h.construct(NaN,NaN),f=l.pa-l.sa,y=l.la-l.na,v=s.pa-s.sa,_=s.la-s.na,$=v*y-f*_;if($==0)return c;var I=8881784197001252e-31*(Math.abs(v*y)+Math.abs(f*_)),k=s.sa-l.sa,A=s.na-l.na,P=v*A-k*_,D=P/$,j=Math.abs($);return D<-(v=(8881784197001252e-31*(Math.abs(v*A)+Math.abs(k*_))*j+I*Math.abs(P))/($*$)+2220446049250313e-31*Math.abs(D))||D>1+v||(v=(_=f*A-k*y)/$)<-(f=(8881784197001252e-31*(Math.abs(f*A)+Math.abs(k*y))*j+I*Math.abs(_))/($*$)+2220446049250313e-31*Math.abs(v))||v>1+f||(D=d.O.Rk(D,0,1),f=d.O.Rk(v,0,1),y=l.hc(D),$=s.hc(f),(I=new d.h).uc(y,$),I.length()>a&&(I.add(y,$),I.scale(.5),D=l.fe(I,!1),f=s.fe(I,!1),l=l.hc(D),s=s.hc(f),l.sub(s),l.length()>a)||c.ma(D,f)),c},h.OM=function(l,s,a,c){var f=0;if((l.sa==s.sa&&l.na==s.na||l.sa==s.pa&&l.na==s.la)&&(f++,!c))return 1;if(l.pa==s.sa&&l.la==s.na||l.pa==s.pa&&l.la==s.la){if(++f==2)return 2;if(!c)return 1}return s.vi(l.sa,l.na,a)||s.vi(l.pa,l.la,a)||l.vi(s.sa,s.na,a)||l.vi(s.pa,s.la,a)?1:c&&f!=0||h.NM(l,s)==0?0:1},h.Zx=function(l,s,a,c,f,y){var v=0,_=l.rp(s.sa,s.na,y,!1),$=l.rp(s.pa,s.la,y,!1),I=s.rp(l.sa,l.na,y,!1),k=s.rp(l.pa,l.la,y,!1);return isNaN(_)||(c!=null&&(c[v]=_),f!=null&&(f[v]=0),a!=null&&(a[v]=d.h.construct(s.sa,s.na)),v++),isNaN($)||(c!=null&&(c[v]=$),f!=null&&(f[v]=1),a!=null&&(a[v]=d.h.construct(s.pa,s.la)),v++),v==2||isNaN(I)||_==0&&I==0||$==0&&I==1||(c!=null&&(c[v]=0),f!=null&&(f[v]=I),a!=null&&(a[v]=d.h.construct(l.sa,l.na)),v++),v==2||isNaN(k)||_==1&&k==0||$==1&&k==1||(c!=null&&(c[v]=1),f!=null&&(f[v]=k),a!=null&&(a[v]=d.h.construct(s.pa,s.la)),v++),0<v?(v==2&&c!=null&&c[0]>c[1]&&(l=c[0],c[0]=c[1],c[1]=l,f!=null&&(c=f[0],f[0]=f[1],f[1]=c),a!=null&&(f=d.h.construct(a[0].x,a[0].y),a[0]=a[1],a[1]=f)),v):(v=h.LM(l,s,y),isNaN(v.x)?0:(a!=null&&(a[0]=l.hc(v.x)),c!=null&&(c[0]=v.x),f!=null&&(f[0]=v.y),1))},h.prototype.eG=function(){return 0},h.prototype.op=function(){},h.prototype.toString=function(){return"Line: ["+this.sa.toString()+", "+this.na.toString()+", "+this.pa.toString()+", "+this.la.toString()+"]"},h}(d.SC);d.yb=O}(Y||(Y={})),function(d){var O=function(){function x(){this.Jm=[],this.ya=-1}return x.prototype.La=function(){return this.ya},x.prototype.next=function(){if(this.Jm!=null&&this.Jm.length!=0){this.ya++;var h=this.Jm[0];return this.Jm=1>=this.Jm.length?[]:this.Jm.slice(1),h}return this.Jm=null},x.prototype.ZX=function(h){this.Jm.push(h)},x.prototype.qe=function(){},x}();d.gL=O}(Y||(Y={})),function(d){var O;(O=d.SL||(d.SL={}))[O.enumFillRuleOddEven=0]="enumFillRuleOddEven",O[O.enumFillRuleWinding=1]="enumFillRuleWinding";var x=function(h){function l(s,a){var c=h.call(this)||this;if(c.xf=!1,c.Eq=null,c.sq=0,c.rq=0,c.Aj=null,c.Mg=!1,c.nb=null,c.mb=null,c.Ve=null,c.Lj=null,c.Sd=null,c.tq=0,c.gb=0,c.xq=0,a===void 0)c.xf=s,c.Mg=!1,c.tq=0,c.sq=0,c.rq=0,c.wa=0,c.description=d.ee.og();else{if(a==null)throw d.i.N();c.xf=s,c.Mg=!1,c.tq=0,c.sq=0,c.rq=0,c.wa=0,c.description=a}return c.Aj=null,c.gb=0,c}return Kt(l,h),l.prototype.tm=function(){return 0<this.tq},l.prototype.Yx=function(){this.vc(),this.Eq==null?this.Eq=new d.Sa(this.description):this.Eq.Nf(this.description)},l.prototype.sx=function(s,a){var c=new d.h;c.x=s,c.y=a,this.Lt(c)},l.prototype.Lt=function(s){this.Yx(),this.Eq.Cb(s),this.Mg=!0},l.prototype.nf=function(s){if(s.B())throw d.i.N();this.Jl(s.description),this.Yx(),s.copyTo(this.Eq),this.Mg=!0},l.prototype.Sx=function(){var s=1;this.Mg&&(this.Yx(),this.nb==null?(this.nb=d.Yc.Oh(2),this.nb.write(0,0),this.mb=d.Yc.Mr(2,0)):(this.nb.resize(this.nb.size+1,0),this.mb.resize(this.mb.size+1,0)),this.xf&&this.mb.write(this.mb.size-2,1),s++);var a=this.wa;this.nb.write(this.nb.size-1,this.wa+s),this.dm(a+s),this.mb.write(this.nb.size-1,0),this.Mg&&(this.Ht(a,this.Eq),this.Mg=!1)},l.prototype.yj=function(s,a){this.Sx(),this.Cb(this.wa-1,s,a)},l.prototype.Ci=function(s){this.Sx(),this.Cb(this.wa-1,s)},l.prototype.lineTo=function(s){this.Sx(),this.Ht(this.wa-1,s)},l.prototype.CU=function(s){if(this.vc(),this.xf)throw d.i.Qa();var a=this.da();if(s>a)throw d.i.Qa();if(this.dc(s)){if(this.mb==null)throw d.i.Qa();var c=this.wa,f=this.Ba(s),y=this.Vc(s);this.dm(this.wa+1),this.mc();for(var v=0,_=this.description.Aa;v<_;v++)if(this.za[v]!=null){var $=d.ra.Va(this.description.Ed(v));this.za[v].Mn($*y,this.za[v],$*f,$,!0,1,$*c)}for(;a>s;a--)c=this.nb.read(a),this.nb.write(a,c+1);this.mb.KE(s,1)}},l.prototype.Ap=function(){if(this.wx(),s===void 0){this.Mg=!1;var s=this.da()-1}var a=this.mb.read(s);this.mb.write(s,1|a),this.Ve!=null&&(s=this.Vc(s)-1,this.Ve.write(s,1),this.Lj.write(s,-1))},l.prototype.dc=function(s){return!!(1&this.mb.read(s))},l.prototype.Nn=function(s){if(this.dc(s))return!0;var a=this.Ba(s);return!(a>(s=this.Vc(s)-1))&&(a=this.Na(a),s=this.Na(s),a.qb(s))},l.prototype.yv=function(s){return!!(2&this.mb.read(s))},l.prototype.oc=function(s,a){if(this.Jl(s.description),s.getType()!=322)throw d.i.Qa();var c=new d.Sa;(a||this.B())&&(s.To(c),this.nf(c)),s.Po(c),this.lineTo(c)},l.prototype.tp=function(s){var a=this.wa==0;this.sx(s.v,s.G),this.yj(s.v,s.H),this.yj(s.C,s.H),this.yj(s.C,s.G),this.Ap(),this.Mg=!1,a&&this.Lf(256,!1)},l.prototype.ad=function(s,a){if(!s.B()){for(var c=this.wa==0,f=new d.Sa(this.description),y=0;4>y;y++)s.Hf(a?4-y-1:y,f),y==0?this.nf(f):this.lineTo(f);this.Ap(),this.Mg=!1,c&&!a&&this.Lf(256,!1)}},l.prototype.add=function(s,a){for(var c=0;c<s.da();c++)this.addPath(s,c,!a)},l.prototype.addPath=function(s,a,c){this.vf(-1,s,a,c)},l.prototype.Yk=function(s,a){this.Hz(s,a)},l.prototype.Dr=function(s,a,c,f,y){if(y||this.da()!=0||(y=!0),0>a&&(a=s.da()-1),a>=s.da()||0>c||0>f||f>s.rv(a))throw d.i.fa("index out of bounds");if(f!=0){var v=s.dc(a)&&c+f==s.rv(a);if(!v||f!=1){if(this.Mg=!1,this.Jl(s.description),c=s.Ba(a)+c+1,y&&(f++,c--),v&&f--,v=this.wa,this.dm(this.wa+f),this.mc(),y){if(f==0)return;this.nb.add(this.wa),y=s.mb.read(a),y&=-5,this.xf&&(y|=1),this.mb.write(this.mb.size-1,y),this.mb.add(0)}else this.nb.write(this.mb.size-1,this.wa);y=0;for(var _=this.description.Aa;y<_;y++){var $=this.description.kd(y),I=d.ra.Va($),k=s.description.Pf($);0>k||s.za[k]==null?this.za[y].Ln(I*v,d.ra.se($),f*I,I*v):this.za[y].Mn(I*v,s.za[k],I*c,f*I,!0,I,I*v)}if(this.tm()||s.yv(a))throw d.i.Qa();this.Pc(1993)}}},l.prototype.oJ=function(){for(var s=0,a=this.da();s<a;s++)this.FW(s)},l.prototype.FW=function(s){if(this.mc(),s>=this.da())throw d.i.N();var a=this.Ba(s),c=this.Ja(s);s=this.dc(s)?1:0;for(var f=0,y=this.description.Aa;f<y;f++)if(this.za[f]!=null){var v=d.ra.Va(this.description.Ed(f));this.za[f].ni(v*(a+s),v*(c-s),v)}this.Pc(1993)},l.prototype.Zq=function(s){this.mc();var a=this.da();if(0>s&&(s=a-1),s>=a)throw d.i.N();for(var c=this.Ba(s),f=this.Ja(s),y=0,v=this.description.Aa;y<v;y++)if(this.za[y]!=null){var _=d.ra.Va(this.description.Ed(y));this.za[y].En(_*c,_*f,_*this.wa)}for(c=s+1;c<=a;c++)y=this.nb.read(c),this.nb.write(c-1,y-f);if(this.mb==null)for(c=s+1;c<=a;c++)s=this.mb.read(c),this.mb.write(c-1,s);this.nb.resize(a),this.mb.resize(a),this.wa-=f,this.Pg-=f,this.Pc(1993)},l.prototype.vf=function(s,a,c,f){if(a==this||c>=a.da())throw d.i.N();var y=this.da();if(s>y)throw d.i.N();0>s&&(s=y),0>c&&(c=a.da()-1),this.Mg=!1,this.Jl(a.description),a.mc();var v=a.Ba(c),_=a.Ja(c),$=this.wa,I=a.dc(c)&&!f?1:0;this.dm(this.wa+_),this.mc();for(var k=s<y?this.Ba(s):$,A=0,P=this.description.Aa;A<P;A++){var D=this.description.Ed(A),j=a.description.Pf(D),B=d.ra.Va(D);0<=j&&a.za[j]!=null?(I!=0&&this.za[A].Mn(k*B,a.za[j],B*v,B,!0,B,B*$),this.za[A].Mn((k+I)*B,a.za[j],B*(v+I),B*(_-I),f,B,B*($+I))):this.za[A].Ln(k*B,d.ra.se(D),B*_,B*$)}for(this.nb.add($+_),f=y;f>=s+1;f--)v=this.nb.read(f-1),this.nb.write(f,v+_);for(a.yv(c),this.mb.add(0),f=y-1;f>=s+1;f--)y=this.mb.read(f),y&=-5,this.mb.write(f+1,y);y=a.JR().read(c),y&=-5,this.xf&&(y|=1),this.mb.write(s,y)},l.prototype.Hz=function(s,a){var c=-1,f=this.da();if(c>f)throw d.i.N();0>c&&(c=f),this.Mg=!1;var y=this.wa;this.dm(this.wa+a),this.mc();var v=c<f?this.Ba(c):y;if(s!=null)this.za[0].Iz(2*v,s,0,a,!0,2*y);else{var _=d.ra.se(0);this.za[0].Ln(2*v,_,2*a,2*y)}s=1;for(var $=this.description.Aa;s<$;s++){_=this.description.kd(s);var I=d.ra.Va(_);_=d.ra.se(_),this.za[s].Ln(v*I,_,I*a,I*y)}for(this.nb.add(this.wa),y=f;y>=c+1;y--)v=this.nb.read(y-1),this.nb.write(y,v+a);for(this.mb.add(0),y=f-1;y>=c+1;y--)a=this.mb.read(y),a&=-5,this.mb.write(y+1,a);this.xf&&this.mb.write(c,1)},l.prototype.qG=function(s,a,c){var f=-1;if(0>s&&(s=this.da()),s>this.da()||f>this.Ja(s)||c>a.length)throw d.i.fa("index out of bounds");if(c!=0){s==this.da()&&(this.nb.add(this.wa),this.xf?this.mb.add(1):this.mb.add(0)),0>f&&(f=this.Ja(s)),this.mc();var y=this.wa;this.dm(this.wa+c),this.mc();for(var v=0,_=this.description.Aa;v<_;v++){var $=this.description.Ed(v),I=d.ra.Va($);this.za[v].Ut(I*(this.Ba(s)+f+c),(y-this.Ba(s)-f)*I,this.za[v],I*(this.Ba(s)+f),!0,I),v==0?this.za[v].vC(I*(this.Ba(s)+f),c,a,0,!0):this.za[v].Wj(d.ra.se($),(this.Ba(s)+f)*I,c*I)}for(this.tm()&&(this.Ve.Ut(this.Ba(s)+f+c,y-this.Ba(s)-f,this.Ve,this.Ba(s)+f,!0,1),this.Lj.Ut(this.Ba(s)+f+c,y-this.Ba(s)-f,this.Lj,this.Ba(s)+f,!0,1),this.Ve.Wj(1,this.Ba(s)+f,c),this.Lj.Wj(-1,this.Ba(s)+f,c)),s+=1,a=this.da();s<=a;s++)this.nb.write(s,this.nb.read(s)+c)}},l.prototype.wf=function(s,a,c){var f=this.da();if(0>s&&(s=this.da()),s>=f||a>this.Ja(s))throw d.i.fa("index out of bounds");s==this.da()&&(this.nb.add(this.wa),this.xf?this.mb.add(1):this.mb.add(0)),0>a&&(a=this.Ja(s));var y=this.wa;this.dm(this.wa+1),this.mc();var v=this.Ba(s);this.za[0].vj(2*(v+a),c,2*y),c=1;for(var _=this.description.Aa;c<_;c++){var $=this.description.Ed(c),I=d.ra.Va($);this.za[c].Ln(I*(v+a),d.ra.se($),I,I*y)}for(s+=1;s<=f;s++)this.nb.write(s,this.nb.read(s)+1)},l.prototype.DB=function(s,a){var c=this.da();if(0>s&&(s=c-1),s>=c||a>=this.Ja(s))throw d.i.fa("index out of bounds");this.mc();var f=this.Ba(s);0>a&&(a=this.Ja(s)-1),a=f+a,f=0;for(var y=this.description.Aa;f<y;f++)if(this.za[f]!=null){var v=d.ra.Va(this.description.Ed(f));this.za[f].En(v*a,v,v*this.wa)}for(;c>=s+1;c--)a=this.nb.read(c),this.nb.write(c,a-1);this.wa--,this.Pg--,this.Pc(1993)},l.prototype.uE=function(s,a,c){var f=this.Ba(s)+a;if((c=this.Ba(c)+void 0)<f||0>f||c>this.I()-1)throw d.i.N();a=0,(s=this.Ga()).Vb(f);do{for(;s.Ha()&&(f=s.ha(),s.wb()!=c);)a+=f=f.Qb();if(s.wb()==c)break}while(s.$a());return a},l.prototype.fO=function(s,a,c){if(a=this.Ba(s)+a,c=this.Ba(s)+c,0>a||c>this.I()-1)throw d.i.N();var f=this.Ga();if(a>c){if(!this.dc(s))throw d.i.N("cannot iterate across an open path");f.JB()}var y=s=0;f.Vb(a);do y+=s,s=f.ha().Qb();while(f.wb()!=c);return y},l.prototype.mg=function(){return d.pi.gm(this,null)},l.prototype.KS=function(s,a,c){for(var f=s;f<c-1;f++)if(this.dc(f))throw d.i.N("cannot interpolate across closed paths");if((f=this.description.Aa)!=1){var y=this.uE(s,a,c);if(y!=0)for(var v=1;v<f;v++){var _=this.description.kd(v);if(d.ra.lz(_)!=2)for(var $=d.ra.Va(_),I=0;I<$;I++)this.MS(_,s,a,c,y,I)}}},l.prototype.JS=function(s,a,c){var f=this.description.Aa;if(f!=1){var y=this.fO(s,a,c);if(y!=0)for(var v=1;v<f;v++){var _=this.description.kd(v);if(d.ra.lz(_)!=2)for(var $=d.ra.Va(_),I=0;I<$;I++)this.LS(_,s,a,c,y,I)}}},l.prototype.MS=function(s,a,c,f,y,v){var _=this.Ga(),$=this.Ba(a)+c;f=this.Ba(f)+void 0,a=this.Uc(s,$,v),c=this.Uc(s,f,v);var I=a,k=0;_.Vb($);do if(_.Ha()){if(_.ha(),_.wb()==f)break;this.setAttribute(s,_.wb(),v,I),_.li();do{if($=_.ha(),_.ik()==f)return;k+=$=$.Qb(),I=d.lc.hq(a,c,k/y),_.On()||this.setAttribute(s,_.ik(),v,I)}while(_.Ha())}while(_.$a())},l.prototype.LS=function(s,a,c,f,y,v){var _=this.Ga(),$=this.Ba(a)+c;if((a=this.Ba(a)+f)!=$){f=this.Uc(s,$,v),c=this.Uc(s,a,v);var I=0;_.Vb($),_.JB(),$=f;do{var k=_.ha();this.setAttribute(s,_.wb(),v,$),I+=$=k.Qb(),$=d.lc.hq(f,c,I/y)}while(_.ik()!=a)}},l.prototype.Oa=function(){this.tq=0,this.Mg=!1,this.Sd=this.Ve=this.Lj=this.mb=this.nb=null,this.wD()},l.prototype.Oc=function(s){s instanceof d.Dd?this.YD(s,-1):this.wN(s)},l.prototype.YD=function(s,a){if(!this.B()&&!s.isIdentity()){this.mc();var c=this.za[0],f=new d.h,y=new d.h;if(0>a){var v=this.tm(),_=0;a=this.wa}else v=this.yv(a),_=this.Ba(a),a=this.Vc(a);for(;_<a;_++){if(f.x=c.read(2*_),f.y=c.read(2*_+1),v){var $=this.Lj.read(_);if(0<=$)switch(7&this.Ve.read(_)){case 2:y.x=this.Sd.read($),y.y=this.Sd.read($+1),s.Eh(y,y),this.Sd.write($,y.x),this.Sd.write($+1,y.y),y.x=this.Sd.read($+3),y.y=this.Sd.read($+4),s.Eh(y,y),this.Sd.write($+3,y.x),this.Sd.write($+4,y.y);break;case 4:throw d.i.Qa()}}s.Eh(f,f),c.write(2*_,f.x),c.write(2*_+1,f.y)}this.Pc(1993)}},l.prototype.wN=function(s){if(!this.B()){this.re(1),this.mc();for(var a=this.za[0],c=this.za[1],f=new d.Nd,y=new d.Nd,v=this.tm(),_=0;_<this.wa;_++){if(f.x=a.read(2*_),f.y=a.read(2*_+1),f.z=c.read(_),v){var $=this.Lj.read(_);if(0<=$)switch(7&this.Ve.read(_)){case 2:y.x=this.Sd.read($),y.y=this.Sd.read($+1),y.z=this.Sd.read($+2),y=s.fp(y),this.Sd.write($,y.x),this.Sd.write($+1,y.y),this.Sd.write($+1,y.z),y.x=this.Sd.read($+3),y.y=this.Sd.read($+4),y.z=this.Sd.read($+5),y=s.fp(y),this.Sd.write($+3,y.x),this.Sd.write($+4,y.y),this.Sd.write($+5,y.z);break;case 4:throw d.i.Qa()}}f=s.fp(f),a.write(2*_,f.x),a.write(2*_+1,f.y),c.write(_,f.z)}this.Pc(1993)}},l.prototype.iy=function(){this.nb==null&&(this.nb=d.Yc.Oh(1,0),this.mb=d.Yc.Mr(1,0)),this.Ve!=null&&(this.Ve.resize(this.Pg,1),this.Lj.resize(this.Pg,-1))},l.prototype.op=function(s){s.Mg=!1,s.tq=this.tq,s.xq=this.xq,s.nb=this.nb!=null?d.ia.Bn(this.nb):null,s.mb=this.mb!=null?d.pn.Bn(this.mb):null,s.Lj=this.Lj!=null?d.ia.Bn(this.Lj):null,s.Ve=this.Ve!=null?d.pn.Bn(this.Ve):null,s.Sd=this.Sd!=null?d.be.Bn(this.Sd):null,s.sq=this.sq,s.rq=this.rq,s.Aj=this.ak(1024)?null:this.Aj},l.prototype.Qb=function(){if(!this.ak(512))return this.sq;for(var s=this.Ga(),a=new d.Fx(0);s.$a();)for(;s.Ha();)a.add(s.ha().Qb());return this.sq=a.rm(),this.Lf(512,!1),a.rm()},l.prototype.Nb=function(s){if(s==this)return!0;if(!(s instanceof l&&h.prototype.Nb.call(this,s)))return!1;var a=this.da();return!(a!=s.da()||this.nb!=null&&!this.nb.Nb(s.nb,0,a+1)||this.xq!=s.xq||this.mb!=null&&!this.mb.Nb(s.mb,0,a))&&h.prototype.Nb.call(this,s)},l.prototype.Ga=function(){return new d.YL(this)},l.prototype.hy=function(s){if(h.prototype.hy.call(this,s),this.tm())for(s=this.Ga();s.$a();)s.Ha()},l.prototype.yp=function(s,a){if(h.prototype.yp.call(this,s,a),this.tm())for(s=this.Ga();s.$a();)s.Ha()},l.prototype.$x=function(){this.wa=this.nb==null||this.nb.size==0?0:this.nb.read(this.nb.size-1)},l.prototype.Ke=function(){return this.xf?(this.xu(),this.rq):0},l.prototype.Ev=function(s){return!!this.xf&&(this.ak(8)?(this.xu(),0<this.Aj.read(s)):!!(4&this.mb.read(s)))},l.prototype.Ir=function(s){return this.xf?(this.xu(),this.Aj.read(s)):0},l.prototype.xu=function(){if(this.ak(1024)){var s=this.da();this.Aj==null?this.Aj=new d.be(s):this.Aj.size!=s&&this.Aj.resize(s),s=new d.Fx(0);for(var a=new d.Fx(0),c=new d.h,f=0,y=this.Ga();y.$a();){for(a.reset(),this.D(this.Ba(y.gb),c);y.Ha();)a.add(y.ha().Tx(c.x,c.y));s.add(a.rm());var v=f++;this.Aj.write(v,a.rm())}this.rq=s.rm(),this.Lf(1024,!1)}},l.prototype.FR=function(){if(this.xf){this.fm();for(var s=this.da(),a=0;a<s;a++)4&this.mb.read(a)}},l.prototype.fm=function(){if(this.ak(8)){this.xu();var s=this.da();(this.mb==null||this.mb.size<s)&&(this.mb=d.Yc.Mr(s+1));for(var a=1,c=0;c<s;c++){var f=this.Aj.read(c);c==0&&(a=0<f?1:-1),0<f*a?this.mb.zJ(c,4):this.mb.KE(c,4)}this.Lf(8,!1)}},l.prototype.sz=function(s){var a=this.gb,c=this.da();if(0<=a&&a<c){if(s<this.Vc(a)){if(s>=this.Ba(a))return a;a--}else a++;if(0<=a&&a<c&&s>=this.Ba(a)&&s<this.Vc(a))return this.gb=a}if(5>c){for(a=0;a<c;a++)if(s<this.Vc(a))return this.gb=a;throw d.i.fa("corrupted geometry")}for(a=0,--c;c>a;){var f=a+(c-a>>1);if(s<this.Ba(f))c=f-1;else{if(!(s>=(a=this.Vc(f))))return this.gb=f;a=f+1}}return this.gb=a},l.prototype.yz=function(){var s=this.I();if(!this.xf){s-=this.da();for(var a=0,c=this.da();a<c;a++)this.dc(a)&&s++}return s},l.prototype.rv=function(s){var a=this.Ja(s);return this.dc(s)||a--,a},l.prototype.Ia=function(){return new l(this.xf,this.description)},l.prototype.Db=function(){return this.xf?2:1},l.prototype.getType=function(){return this.xf?1736:1607},l.prototype.QJ=function(s){this.nb=s,this.Pc(16777215)},l.prototype.VR=function(){return this.wx(),this.Ve},l.prototype.JR=function(){return this.wx(),this.mb},l.prototype.PJ=function(s){this.mb=s,this.Pc(16777215)},l.prototype.da=function(){return this.nb!=null?this.nb.size-1:0},l.prototype.Vc=function(s){return this.nb.read(s+1)},l.prototype.Ja=function(s){return this.nb.read(s+1)-this.nb.read(s)},l.prototype.Ba=function(s){return this.nb.read(s)},l.prototype.lu=function(s,a){this.Bb==null&&(this.Bb=new d.Uk),a=d.Nx.pW(a);var c=this.Bb.Fk;if(c!=null){if(!(c.Ik<s||a>c.RR()))return!0;this.Bb.yD(null)}return c=d.Nx.create(this,s,a),this.Bb.yD(c),!0},l.prototype.cc=function(){var s=h.prototype.cc.call(this);if(!this.Ac()){var a=this.da();this.nb!=null&&this.nb.An(s,0,a+1),this.mb!=null&&this.mb.An(s,0,a)}return s},l.prototype.ZF=function(s){return this.Ve!=null?this.Ve.read(s):1},l.prototype.bc=function(s,a,c){var f=this.sz(s);if(s==this.Vc(f)-1&&!this.dc(f))throw d.i.fa("index out of bounds");this.mc();var y=this.Ve,v=1;if(y!=null&&(v=7&y.read(s)),v!==1)throw d.i.Qa();if(a.Or(),a=a.get(),c?a.Nf(d.ee.og()):a.Nf(this.description),f=s==this.Vc(f)-1&&this.dc(f)?this.Ba(f):s+1,y=new d.h,this.D(s,y),a.Dc(y),this.D(f,y),a.Qc(y),!c)for(c=1,y=this.description.Aa;c<y;c++){v=this.description.Ed(c);for(var _=d.ra.Va(v),$=0;$<_;$++){var I=this.Uc(v,s,$);a.YB(v,$,I),I=this.Uc(v,f,$),a.OB(v,$,I)}}},l.prototype.Rj=function(s,a){if(s>=this.da())throw d.i.N();if(this.B())a.Oa();else{if(this.yv(s))throw d.i.fa("not implemented");var c=this.ub(0),f=new d.h,y=new d.l;y.Oa();var v=this.Ba(s);for(s=this.Vc(s);v<s;v++)c.tc(2*v,f),y.Zb(f);a.K(y)}},l.prototype.fj=function(s){return this.Bb==null&&(this.Bb=new d.Uk),!(s==0||16>this.I())&&(s=d.ta.nE(this),this.Bb.WM(s),!0)},l.prototype.hM=function(){if(this.Bb==null&&(this.Bb=new d.Uk),this.Bb.zo==null){this.Bb.xD(null);var s=d.ta.YN(this);this.Bb.xD(s)}},l.prototype.Yo=function(s){this.xq=s},l.prototype.In=function(){return this.xq},l.prototype.DD=function(s){if(this==s)throw d.i.fa("MultiPathImpl.add");for(var a=this.da(),c=0;c<s.da();c++)this.addPath(s,c,!0),this.CU(a),a++},l.prototype.kO=function(s){var a=this.sz(s),c=this.Ba(a);if(c!=s){if(s>=(a=this.Vc(a))||s<c)throw d.i.fa("change_ring_start_point");for(var f=0,y=this.description.Aa;f<y;f++){var v=this.description.kd(f);v=d.ra.Va(v),this.za[f].rotate(c*v,s*v,a*v)}}},l}(d.Gx);d.Vk=x}(Y||(Y={})),function(d){var O=function(x){function h(l){var s=x.call(this)||this;if(l!==void 0){if(l==null)throw d.i.N();s.description=l}else s.description=d.ee.og();return s.wa=0,s}return Kt(h,x),h.prototype.Ia=function(){return new h(this.description)},h.prototype.add=function(l){this.resize(this.wa+1),this.Dh(this.wa-1,l)},h.prototype.Bu=function(l,s){this.resize(this.wa+1);var a=new d.h;a.ma(l,s),this.Cb(this.wa-1,a)},h.prototype.Fd=function(l,s,a){if(a=0>a?l.I():a,0>s||s>l.I()||a<s)throw d.i.N();if(s!=a){this.Jl(l.description),a-=s;var c=this.wa;this.resize(this.wa+a),this.mc();for(var f=0,y=l.description.Aa;f<y;f++){var v=l.description.Ed(f),_=d.ra.Va(v),$=this.ub(v);v=l.ub(v),$.Mn(c*_,v,s*_,a*_,!0,1,c*_)}}},h.prototype.HD=function(l,s){var a=l.length;if(s=0>s?a:s,0>a||0>s)throw d.i.N();if(s!=0){a=s-0,s=this.wa,this.resize(this.wa+a);for(var c=0;c<a;c++)this.Cb(s+c,l[0+c])}},h.prototype.DB=function(l){if(0>l||l>=this.I())throw d.i.fa("index out of bounds");this.mc();for(var s=0,a=this.description.Aa;s<a;s++)if(this.za[s]!=null){var c=d.ra.Va(this.description.Ed(s));this.za[s].En(c*l,c,c*this.wa)}this.wa--,this.Pg--,this.Pc(1993)},h.prototype.resize=function(l){this.dm(l)},h.prototype.op=function(){},h.prototype.Oa=function(){x.prototype.wD.call(this)},h.prototype.Oc=function(l){if(l instanceof d.Dd){if(this.B())return;this.mc();for(var s=this.za[0],a=new d.h,c=0;c<this.wa;c++)a.x=s.read(2*c),a.y=s.read(2*c+1),l.Eh(a,a),s.write(2*c,a.x),s.write(2*c+1,a.y)}else{if(this.B())return;this.mc(),this.re(1),this.mc(),s=this.za[0],a=this.za[1];var f=new d.Nd;for(c=0;c<this.wa;c++){f.x=s.read(2*c),f.y=s.read(2*c+1),f.z=a.read(c);var y=l.fp(f);s.write(2*c,y.x),s.write(2*c+1,y.y),a.write(c,y.z)}}this.Pc(1993)},h.prototype.Db=function(){return 0},h.prototype.getType=function(){return 550},h.prototype.Ke=function(){return 0},h.prototype.Qb=function(){return 0},h.prototype.Nb=function(l){return l==this||l instanceof h&&x.prototype.Nb.call(this,l)},h.prototype.lW=function(l,s){var a=this.wa;if(a=Math.min(a,s+1e3),0>s||s>=this.wa||a<s||l.length!=1e3)throw d.i.N();var c=a-s,f=[];for(this.ub(0).Vw(2*s,2*c,f,0,!0),s=0;s<c;s++)l[s]=d.h.construct(f[2*s],f[2*s+1]);return a},h.prototype.$x=function(){},h.prototype.iy=function(){},h.prototype.lu=function(){return!1},h.prototype.fj=function(){return!1},h.prototype.mg=function(){return null},h}(d.Gx);d.de=O}(Y||(Y={})),function(d){var O;(O=d.iL||(d.iL={}))[O.NotDetermined=0]="NotDetermined",O[O.Structure=1]="Structure",O[O.DegenerateSegments=2]="DegenerateSegments",O[O.Clustering=3]="Clustering",O[O.Cracking=4]="Cracking",O[O.CrossOver=5]="CrossOver",O[O.RingOrientation=6]="RingOrientation",O[O.RingOrder=7]="RingOrder",O[O.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency",O[O.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency",O[O.OGCDisconnectedInterior=10]="OGCDisconnectedInterior";var x=function(){function h(l,s,a){l===void 0?(this.Jj=0,this.Ko=this.Jo=-1):(this.Jj=l,this.Jo=s,this.Ko=a)}return h.prototype.Wt=function(l){this.Jj=l.Jj,this.Jo=l.Jo,this.Ko=l.Ko},h}();d.Md=x}(Y||(Y={})),function(d){d.O=function(){function O(){}return O.assert=function(x){if(x===!1)throw d.i.GK()},O.bK=function(x){return isNaN(x)?NaN:x===0?x:0<x?1:-1},O.Fu=function(x){var h;h===void 0&&(h=0);for(var l=[],s=0;s<x;s++)l[s]=O.lg(2,h);return l},O.lg=function(x,h){h===void 0&&(h=0);for(var l=[],s=0;s<x;s++)l[s]=h;return l},O.$u=function(x,h){var l,s;for(l===void 0&&(l=0),s===void 0&&(s=x.length-1);l<=s;l++)x[l]=h},O.Rk=function(x,h,l){return x<h?h:x>l?l:x},O.Th=function(x,h){var l=5381;return((l=((l=((l=h!==void 0?(h<<5)+h+(255&x):(l<<5)+l+(255&x))<<5)+l+(x>>8&255))<<5)+l+(x>>16&255))<<5)+l+(x>>24&255)&2147483647},O.uj=function(){throw Error("Not Implemented")},O.bB=function(x){return O.aU(x)+12345&2147483647},O.XG=function(x){var h=32,l=x%O.Qx|0,s=x/O.Qx|0;return(h&=63)==0?x:(32>h?(x=l>>>h|s<<32-h,h=s>>h):(x=s>>h-32,h=0<=s?0:-1),h*O.Qx+(x>>>0))},O.aU=function(x){var h=1103515245,l=65535&h;return((h-l)*(x|=0)|0)+(l*x|0)|0},O.truncate=function(x){return 0>x?-1*Math.floor(Math.abs(x)):Math.floor(x)},O.MAX_SAFE_INTEGER=Math.pow(2,53)-1,O.MIN_SAFE_INTEGER=-O.MAX_SAFE_INTEGER,O.VC=65536,O.Qx=O.VC*O.VC,O}()}(Y||(Y={})),function(d){var O;(O=d.CL||(d.CL={}))[O.Project=0]="Project",O[O.Union=1]="Union",O[O.Difference=2]="Difference",O[O.Proximity2D=3]="Proximity2D",O[O.Relate=4]="Relate",O[O.Equals=5]="Equals",O[O.Disjoint=6]="Disjoint",O[O.Intersects=7]="Intersects",O[O.Within=8]="Within",O[O.Contains=9]="Contains",O[O.Crosses=10]="Crosses",O[O.Touches=11]="Touches",O[O.Overlaps=12]="Overlaps",O[O.Buffer=13]="Buffer",O[O.Distance=14]="Distance",O[O.Intersection=15]="Intersection",O[O.Clip=16]="Clip",O[O.Cut=17]="Cut",O[O.DensifyByLength=18]="DensifyByLength",O[O.DensifyByAngle=19]="DensifyByAngle",O[O.LabelPoint=20]="LabelPoint",O[O.GeodesicBuffer=21]="GeodesicBuffer",O[O.GeodeticDensifyByLength=22]="GeodeticDensifyByLength",O[O.ShapePreservingDensify=23]="ShapePreservingDensify",O[O.GeodeticLength=24]="GeodeticLength",O[O.GeodeticArea=25]="GeodeticArea",O[O.Simplify=26]="Simplify",O[O.SimplifyOGC=27]="SimplifyOGC",O[O.Offset=28]="Offset",O[O.Generalize=29]="Generalize",O[O.SymmetricDifference=30]="SymmetricDifference",O[O.ConvexHull=31]="ConvexHull",O[O.Boundary=32]="Boundary",O[O.SimpleRelation=33]="SimpleRelation";var x=function(){function h(){}return h.prototype.getType=function(){return null},h.prototype.wn=function(){},h.prototype.Iu=function(){return!1},h}();d.Je=x}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 13},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c,f){return l instanceof d.aa?(f=new d.Zc(l),this.V(f,s,[a],!1,c).next()):c===!0?(a=new d.BC(l,s,a,!1,f),d.Gh.local().V(a,s,f)):new d.BC(l,s,a,!1,f)},h.instance=null,h}(d.Je);d.AC=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c){this.ya=-1,this.Rd=h,this.$z=l,this.Cs=s,this.tT=new d.l,this.tT.Oa(),this.eo=-1,this.Ub=c}return x.prototype.next=function(){for(var h;(h=this.Rd.next())!=null;)return this.ya=this.Rd.La(),this.eo+1<this.Cs.length&&this.eo++,this.buffer(h,this.Cs[this.eo]);return null},x.prototype.La=function(){return this.ya},x.prototype.buffer=function(h,l){return d.HK.buffer(h,l,this.$z,NaN,96,this.Ub)},x.prototype.qe=function(){},x}();d.BC=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 16},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c){return l instanceof d.aa?(l=new d.Zc(l),this.V(l,s,a,c).next()):new d.lL(l,s,a,c)},h.instance=null,h}(d.Je);d.kL=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s){if(this.ya=-1,h==null)throw d.i.N();this.$=l,this.yk=h,this.qa=d.ta.Wd(s,l,!1)}return x.prototype.next=function(){var h;return(h=this.yk.next())!=null?(this.ya=this.yk.La(),d.Ud.clip(h,this.$,this.qa,0)):null},x.prototype.La=function(){return this.ya},x.prototype.qe=function(){},x}();d.lL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 31},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a){return l instanceof d.aa?d.DC.rE(l):new d.DC(s,l,a)},h.instance=null,h}(d.Je);d.CC=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s){if(this.uA=new d.Zt,this.ya=-1,l==null)throw d.i.N();this.cH=h,this.Ic=!1,this.yk=l,this.Ub=s}return x.prototype.next=function(){if(this.cH){if(!this.Ic){var h=this.dO(this.yk);return this.Ic=!0,h}return null}if(!this.Ic){if((h=this.yk.next())!=null)return this.ya=this.yk.La(),x.rE(h);this.Ic=!0}return null},x.prototype.La=function(){return this.ya},x.prototype.dO=function(h){for(var l;(l=h.next())!=null;)this.uA.Ib(l);return this.uA.cR()},x.prototype.qe=function(){if(!this.Ic){if(!this.cH)throw d.i.fa("Invalid call for non merging convex hull.");var h=this.yk.next();if(h==null)throw d.i.fa("Expects a non-null geometry.");this.uA.Ib(h)}},x.rE=function(h){if(x.VS(h))return h;var l=h.getType();if(d.Vk.yd(l))return(l=new d.Ta(h.description)).oc(h,!0),l;if(l==550&&h.I()==2){var s=new d.Sa;return l=new d.Ta(h.description),h.ve(0,s),l.nf(s),h.ve(1,s),l.lineTo(s),l}return d.Zt.RO(h)},x.VS=function(h){if(h.B())return!0;var l=h.getType();return l==33||l==197||!d.Vk.yd(l)&&(l==550?h.I()==1:l==1607?h.da()==1&&2>=h.I():h.da()==1&&(2>=h.I()||d.Zt.JG(h,0)))},x}();d.DC=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 17},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c,f){return new d.nL(l,s,a,c,f)},h.instance=null,h}(d.Je);d.mL=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c){if(this.Tf=null,l==null||s==null)throw d.i.fa("invalid argument");this.qT=h,this.nA=l,this.lH=s,h=d.ta.mv(l,s),this.qa=d.ta.Wd(a,h,!0),this.kH=-1,this.nd=c}return x.prototype.La=function(){return 0},x.prototype.next=function(){return this.RQ(),++this.kH<this.Tf.length?this.Tf[this.kH]:null},x.prototype.RQ=function(){if(this.Tf==null)switch(this.Tf=[],this.nA.getType()){case 1607:this.TQ();break;case 1736:this.SQ()}},x.prototype.TQ=function(){var h=new d.Ta,l=new d.Ta,s=new d.Ta;this.Tf.push(h),this.Tf.push(l);var a=[];d.LK.JK(this.qT,this.nA,this.lH,this.qa,a,this.nd);for(var c=0;c<a.length;c++){var f=a[c];if(f.bt==0)h.add(f.X,!1);else if(f.bt==1||f.bt==2)l.add(f.X,!1);else if(f.bt==3)this.Tf.push(f.X);else{if(f.bt!=4)throw d.i.fa("internal");s.add(f.X,!1)}}s.B()||h.B()&&l.B()&&!(3<=this.Tf.length)||this.Tf.push(s),h.B()&&l.B()&&3>this.Tf.length&&(this.Tf.length=0)},x.prototype.SQ=function(){var h=new d.ia(0),l=new d.gd,s=l.aF(),a=l.Ib(this.nA),c=l.Ib(this.lH),f=new d.Fg;try{f.Ft(l,this.qa,this.nd),f.dl(s,a,c,h);var y=l.Ne(a),v=new d.Da,_=new d.Da;for(this.Tf.length=0,this.Tf.push(v),this.Tf.push(_),a=0;a<h.size;a++){var $=new d.gd,I=$.Ib(y),k=$.Ib(l.Ne(h.get(a)));f.dr($,this.nd);var A=f.Av(I,k),P=$.Ne(A);if(!P.B()){var D=l.KF(h.get(a),s);D==2?v.add(P,!1):D==1?_.add(P,!1):this.Tf.push(P);var j=new d.gd;I=j.Ib(y),k=j.Ib(l.Ne(h.get(a))),f.dr(j,this.nd),y=j.Ne(f.im(I,k))}}!y.B()&&0<h.size&&this.Tf.push(y),v.B()&&_.B()&&(this.Tf.length=0)}finally{f.Ug()}},x.prototype.qe=function(){},x}();d.nL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 18},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a){if(l instanceof d.aa)return l=new d.Zc(l),this.V(l,s,a).next();if(0>=s)throw d.i.N();return new d.oL(l,s,a)},h.instance=null,h}(d.Je);d.Xl=O}(Y||(Y={})),function(d){var O=function(){function x(h,l){this.ya=-1,this.Rd=h,this.Ps=l}return x.prototype.La=function(){return this.ya},x.prototype.next=function(){var h;return(h=this.Rd.next())!=null?(this.ya=this.Rd.La(),this.NP(h)):null},x.prototype.NP=function(h){if(h.B()||1>h.Db())return h;var l=h.getType();if(l==1736||l==1607)return this.Ny(h);if(d.aa.yd(l))return this.PP(h);if(l==197)return this.OP(h);throw d.i.Qa()},x.prototype.PP=function(h){if(h.Qb()<=this.Ps)return h;var l=new d.Ta(h.description);return l.oc(h,!0),this.Ny(l)},x.prototype.OP=function(h){var l=new d.Da(h.description);l.ad(h,!1);var s=new d.l;return h.A(s),h=s.ca(),s.R()<=this.Ps&&h<=this.Ps?l:this.Ny(l)},x.prototype.Ny=function(h){for(var l=h.Ia(),s=h.Ga();s.$a();)for(var a=!0;s.Ha();){var c=s.ha();if(c.getType()!=322)throw d.i.fa("not implemented");var f=s.On(),y=c.Qb();if(y>this.Ps){var v=Math.ceil(y/this.Ps);y=new d.Sa(h.description),a&&(c.To(y),l.nf(y));var _=a=1/v,$=0;for(--v;$<v;$++)c.Tw(_,y),l.lineTo(y),_+=a;f?l.Ap():(c.Po(y),l.lineTo(y))}else f?l.Ap():l.oc(c,a);a=!1}return l},x.prototype.qe=function(){},x}();d.oL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.getType=function(){return 2},h.prototype.V=function(l,s,a,c){return l instanceof d.aa?(l=new d.Zc(l),s=new d.Zc(s),this.V(l,s,a,c).next()):new d.qL(l,s,a,c)},h.im=function(l,s,a,c){if(l.B()||s.B())return l;var f=l.Db(),y=s.Db();if(f>y)return l;var v=l.getType(),_=s.getType(),$=new d.l,I=new d.l,k=new d.l;l.A($),s.A(I),k.K($),k.Zb(I);var A=(k=d.ta.Wd(a,k,!0))*Math.sqrt(2)*1.00001,P=new d.l;if(P.K($),P.W(A,A),!P.isIntersecting(I))return l;if(f==1&&y==2)return h.KV(l,s,_,a,c);if(v==33)switch(d.Vk.yd(_)?(a=new d.Ta(s.description),a.oc(s,!0)):a=s,_){case 1736:return h.XU(l,a,k);case 1607:return h.YU(l,a,k);case 550:return h.VU(l,a,k);case 197:return h.UU(l,a,k);case 33:return h.WU(l,a,k);default:throw d.i.N()}else if(v==550)switch(_){case 1736:return h.nU(l,s,k);case 197:return h.lU(l,s,k);case 33:return h.mU(l,s,k)}return d.Fg.im(l,s,a,c)},h.XU=function(l,s,a){return d.hd.KG(s,l,a)==0?l:l.Ia()},h.YU=function(l,s,a){var c=l.D();s=s.Ga();for(var f=a*Math.sqrt(2)*1.00001,y=f*f,v=new d.l;s.$a();)for(;s.Ha();){var _=s.ha();if(_.A(v),v.W(f,f),v.contains(c)){if(_.qs(c,a))return l.Ia();var $=_.ac();if(d.h.yc(c,$)<=y||($=_.wc(),d.h.yc(c,$)<=y))return l.Ia()}}return l},h.VU=function(l,s,a){var c=s.ub(0);s=s.I();var f=l.D(),y=new d.h;a=a*Math.sqrt(2)*1.00001,a*=a;for(var v=0;v<s;v++)if(c.tc(2*v,y),d.h.yc(y,f)<=a)return l.Ia();return l},h.UU=function(l,s,a){var c=new d.l;return s.A(c),c.W(a,a),s=l.D(),c.contains(s)?l.Ia():l},h.WU=function(l,s,a){a=a*Math.sqrt(2)*1.00001,a*=a;var c=l.D();return s=s.D(),d.h.yc(c,s)<=a?l.Ia():l},h.nU=function(l,s,a){var c=new d.l;s.A(c),c.W(a,a);for(var f=l.I(),y=!1,v=[],_=0;_<f;_++)v[_]=!1;var $=new d.h;for(_=0;_<f;_++)l.D(_,$),c.contains($)&&d.hd.Yd(s,$,a)!=0&&(y=!0,v[_]=!0);if(!y)return l;for(s=l.Ia(),_=0;_<f;_++)v[_]||s.Fd(l,_,_+1);return s},h.lU=function(l,s,a){var c=new d.l;s.A(c),c.W(a,a),s=l.I();var f=!1;a=[];for(var y=0;y<s;y++)a[y]=!1;var v=new d.h;for(y=0;y<s;y++)l.D(y,v),c.contains(v)&&(f=!0,a[y]=!0);if(!f)return l;for(c=l.Ia(),y=0;y<s;y++)a[y]||c.Fd(l,y,y+1);return c},h.mU=function(l,s,a){var c=l.ub(0),f=l.I(),y=s.D(),v=new d.h,_=!1;s=[];for(var $=0;$<f;$++)s[$]=!1;for(a=($=a*Math.sqrt(2)*1.00001)*$,$=0;$<f;$++)c.tc(2*$,v),d.h.yc(v,y)<=a&&(_=!0,s[$]=!0);if(!_)return l;for(c=l.Ia(),$=0;$<f;$++)s[$]||c.Fd(l,$,$+1);return c},h.KV=function(l,s,a,c,f){var y=new d.Fh;l.bn(y);var v=new d.l;return s.A(v),y.Zb(v),y.W(.1*y.R(),.1*y.ca()),(v=new d.Da).ad(y,!1),a==1736?v.add(s,!0):v.ad(s,!0),d.Xj.local().V(l,v,c,f)},h.instance=null,h}(d.Je);d.kp=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a){this.ts=l==null,this.ya=-1,this.Rd=h,this.$z=s,this.wT=l.next(),this.Ub=a}return x.prototype.next=function(){return this.ts?null:(h=this.Rd.next())!=null?(this.ya=this.Rd.La(),d.kp.im(h,this.wT,this.$z,this.Ub)):null;var h},x.prototype.La=function(){return this.ya},x.prototype.qe=function(){},x}();d.qL=O}(Y||(Y={})),function(d){var O=function(){function h(l){this.nd=l,this.Bj=new d.l,this.Bj.Oa(),this.oh=new d.l,this.oh.Oa()}return h.prototype.Nt=function(){var l=this.Bj.v;this.Bj.v=this.oh.v,this.oh.v=l,l=this.Bj.C,this.Bj.C=this.oh.C,this.oh.C=l,l=this.Bj.G,this.Bj.G=this.oh.G,this.oh.G=l,l=this.Bj.H,this.Bj.H=this.oh.H,this.oh.H=l},h.prototype.eQ=function(l,s){if(this.nd!=null&&!this.nd.progress(-1,-1))throw d.i.fu("user_canceled");var a=!this.Bj.isIntersecting(this.oh);return d.aa.Hc(l.getType())&&d.aa.Hc(s.getType())?l.I()>s.I()?this.gE(l,s,a):(this.Nt(),l=this.gE(s,l,a),this.Nt(),l):l.getType()==550&&d.aa.Hc(s.getType())?(l=this.hE(s,l,a),this.Nt(),l):s.getType()==550&&d.aa.Hc(l.getType())?this.hE(l,s,a):l.getType()==550&&s.getType()==550?l.I()>s.I()?this.iE(l,s):(this.Nt(),l=this.iE(s,l),this.Nt(),l):0},h.prototype.gE=function(l,s,a){var c=l.Ga(),f=s.Ga(),y=new d.l,v=new d.l,_=17976931348623157e292;if(!a&&this.pY(l,s,c,f))return 0;for(;c.$a();)for(;c.Ha();)if((l=c.ha()).A(y),!(y.px(this.oh)>_)){for(;f.$a();)for(;f.Ha();)if((s=f.ha()).A(v),y.px(v)<_&&(s=l.tb(s,a),(s*=s)<_)){if(s==0)return 0;_=s}f.Zi()}return Math.sqrt(_)},h.prototype.hE=function(l,s,a){var c=l.Ga(),f=new d.l,y=17976931348623157e292,v=new d.h,_=s.I();for(a=!a&&l.getType()==1736;c.$a();)for(;c.Ha();){var $=c.ha();if($.A(f),!(1<_&&f.px(this.oh)>y)){for(var I=0;I<_;I++){if(s.D(I,v),a&&d.hd.Yd(l,v,0)!=0)return 0;var k=$.fe(v,!1);if(v.sub($.hc(k)),(k=v.Sk())<y){if(k==0)return 0;y=k}}a=!1}}return Math.sqrt(y)},h.prototype.iE=function(l,s){for(var a,c=17976931348623157e292,f=new d.h,y=new d.h,v=l.I(),_=s.I(),$=0;$<v;$++)if(l.D($,f),!(1<_&&this.oh.iK(f)>c)){for(var I=0;I<_;I++)if(s.D(I,y),(a=d.h.yc(f,y))<c){if(a==0)return 0;c=a}}return Math.sqrt(c)},h.prototype.pY=function(l,s,a,c){if(l.getType()==1736){for(;c.$a();)if(c.Ha()){var f=c.ha();if(d.hd.Yd(l,f.wc(),0)!=0)return!0}c.Zi()}if(s.getType()==1736){for(;a.$a();)if(a.Ha()&&(l=a.ha(),d.hd.Yd(s,l.wc(),0)!=0))return!0;a.Zi()}return!1},h.prototype.gm=function(l,s){return l.B()||s.B()?NaN:(l.A(this.Bj),s.A(this.oh),this.eQ(l,s))},h}(),x=function(h){function l(){return h!==null&&h.apply(this,arguments)||this}return Kt(l,h),l.prototype.V=function(s,a,c){if(s==null||a==null)throw d.i.N();if(s.B()||a.B())return NaN;var f=s.getType(),y=a.getType();if(f==33){if(y==33)return d.h.tb(s.D(),a.D());if(y==197)return c=new d.l,a.A(c),c.tb(s.D());(f=new d.de).add(s),s=f}else if(f==197){if(y==197)return y=new d.l,s.A(y),c=new d.l,a.A(c),c.tb(y);(f=new d.Da).ad(s,!1),s=f}return y==33?((y=new d.de).add(a),a=y):y==197&&((y=new d.Da).ad(a,!1),a=y),new O(c).gm(s,a)},l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.getType=function(){return 14},l.instance=null,l}(d.Je);d.rL=x}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a){this.zH=h,this.DH=l,this.nd=a,this.$G=s}return x.prototype.next=function(){var h=this.zH.next();return h==null?null:this.zC(h)},x.prototype.La=function(){return this.zH.La()},x.prototype.zC=function(h){var l=h.getType();if(d.aa.Rn(l))return h;if(l==197)return(l=new d.Da(h.description)).ad(h,!1),this.zC(l);if(h.B())return h;if(h==null)throw d.i.Qa();l=h.Ia();for(var s=new d.yb,a=0,c=h.da();a<c;a++)this.TK(h,a,l,s);return l},x.prototype.TK=function(h,l,s,a){if(!(2>h.Ja(l))){var c=h.Ba(l),f=h.Vc(l)-1,y=h.ub(0),v=h.dc(l),_=new d.ia(0);_.Jb(h.Ja(l)+1);var $=new d.ia(0);for($.Jb(h.Ja(l)+1),_.add(v?c:f),_.add(c),c=new d.h;1<_.size;){var I=_.Fc();_.If();var k=_.Fc();h.D(I,c),a.Dc(c),h.D(k,c),a.Qc(c),0<=(k=this.SK(a,c,y,I,k,f))?(_.add(k),_.add(I)):$.add(I)}if(v||$.add(_.get(0)),$.size==_.size)s.addPath(h,l,!0);else if(2<=$.size&&(!this.$G||$.size!=2||!(v||d.h.tb(h.Na($.get(0)),h.Na($.get(1)))<=this.DH))){for(l=new d.Sa,a=0,f=$.size;a<f;a++)h.ve($.get(a),l),a==0?s.nf(l):s.lineTo(l);v&&(this.$G||$.size!=2||s.lineTo(l),s.Ap())}}},x.prototype.SK=function(h,l,s,a,c,f){var y=c-1;for(c<=a&&(y=f),f=c=-1,a+=1;a<=y;a++){s.tc(2*a,l);var v=l.x,_=l.y;h.hc(h.fe(l,!1),l),l.x-=v,l.y-=_,(v=l.length())>this.DH&&v>f&&(c=a,f=v)}return c},x.prototype.qe=function(){},x}();d.sL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 29},h.prototype.V=function(l,s,a,c){return l instanceof d.aa?(l=new d.Zc(l),this.V(l,s,a,c).next()):new d.sL(l,s,a,c)},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.instance=null,h}(d.Je);d.EC=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 21},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c,f,y,v,_){return l instanceof d.aa?(_=new d.Zc(l),this.V(_,s,a,[c],f,y,!1,v).next()):v===!0?(a=new d.GC(l,s,a,c,f,!1,!1,_),d.Gh.local().V(a,s,_)):new d.GC(l,s,a,c,f,!1,!1,_)},h.instance=null,h}(d.Je);d.FC=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c,f,y,v){if(f)throw d.i.Ie();if(l==null)throw d.i.N();this.ya=-1,this.Ms=h,this.vg=l,this.ze=s,this.Cs=a,this.$n=c,this.eo=-1,this.Ub=v,this.uT=new d.l,this.uT.Oa()}return x.prototype.next=function(){for(var h;(h=this.Ms.next())!=null;)return this.ya=this.Ms.La(),this.eo+1<this.Cs.length&&this.eo++,this.$Q(h,this.Cs[this.eo]);return null},x.prototype.La=function(){return this.ya},x.prototype.$Q=function(h,l){return d.VK.buffer(h,this.vg,this.ze,l,this.$n,this.Ub)},x.prototype.qe=function(){},x}();d.GC=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 24},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a){if(s==null)throw d.i.N();if(l.B()||1>l.Db())return 0;if(a==4)throw d.i.Ie();var c=d.cb.sc(s),f=d.cb.vv(c),y=d.cb.ev(c);f*=2-f;var v=c.Hd().ai,_=l.getType();if(_==1736||_==197)var $=l.mg();else d.aa.yd(_)?($=new d.Ta(l.description)).oc(l,!0):$=l;if(c.Nb(s)==0){if(d.cb.Wc(s)){$=d.Hh.lj($,s),_==1607&&$==l&&($=d.aa.jg(l)),l=new d.Nc,d.cb.gh(s).cn(l),_=0;for(var I=$.I();_<I;_++){var k=$.Na(_);k.x=d.Hh.Zm(k.x,l),$.Cb(_,k)}}l=$.Ia(),$=d.Hh.WI(s,c,$,l)?l:d.cb.zh($,s,c)}return this.hQ($,a,y,f,v)},h.prototype.hQ=function(l,s,a,c,f){var y=new d.ga(0),v=0;for(l=l.Ga();l.$a();)for(;l.Ha();){var _=l.ha(),$=_.ac();_=_.wc(),$.scale(f),_.scale(f),d.kb.wd(a,c,$.x,$.y,_.x,_.y,y,null,null,s),v+=y.u}return v},h.instance=null,h}(d.Je);d.vL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 18},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c,f){return l instanceof d.aa?(l=new d.Zc(l),this.V(l,s,a,c,f).next()):new d.uL(l,a,c,s,-1,-1,f)},h.instance=null,h}(d.Je);d.tL=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c,f){if(0<f||s!=4&&0<c)throw d.i.Ie();if(l==null)throw d.i.N();this.ya=-1,this.Ms=h,this.vg=l,this.ze=s,this.DT=a,this.CT=c}return x.prototype.next=function(){for(var h;(h=this.Ms.next())!=null;)return this.ya=this.Ms.La(),this.Zy(h);return null},x.prototype.La=function(){return this.ya},x.prototype.Zy=function(h){return d.cj.Qr(h,this.vg,this.ze,this.DT,this.CT,this.Ub)},x.prototype.qe=function(){},x}();d.uL=O}(Y||(Y={})),function(d){(function(O){O[O.Unknown=0]="Unknown",O[O.Contains=1]="Contains",O[O.Within=2]="Within",O[O.Equals=3]="Equals",O[O.Disjoint=4]="Disjoint",O[O.Touches=8]="Touches",O[O.Crosses=16]="Crosses",O[O.Overlaps=32]="Overlaps",O[O.NoThisRelation=64]="NoThisRelation",O[O.Intersects=1073741824]="Intersects",O[O.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(d.cL||(d.cL={})),d.wL=function(){function O(){}return O.nW=function(x,h){var l=x.getType(),s=h.getType();if(d.aa.xj(l)){var a=x.Bb;if(a!=null&&(a=a.Fk)!=null){if(s==33){var c=h.D();a=a.So(c.x,c.y)}else c=new d.l,h.A(c),a=a.Ro(c);if(a==1)return 1;if(a==0)return 4}}if(d.aa.xj(s)&&(a=h.Bb)!=null&&(a=a.Fk)!=null){if(l==33?(x=x.D(),a=a.So(x.x,x.y)):(h=new d.l,x.A(h),a=a.Ro(h)),a==1)return 2;if(a==0)return 4}return 0},O}()}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.getType=function(){return 15},h.prototype.V=function(l,s,a,c,f){return l instanceof d.aa?(l=new d.Zc(l),s=new d.Zc(s),this.V(l,s,a,c,f===void 0?-1:f).next()):f===void 0?new d.HC(l,s,a,c,-1):new d.HC(l,s,a,c,f)},h.prototype.wn=function(l,s,a){this.Iu(l)&&(s=d.ta.kj(s,l,!1),l.fj(a)||l.lu(s,a))},h.prototype.Iu=function(l){return d.Nx.zE(l)},h.instance=null,h}(d.Je);d.Xj=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c){if(this.ts=l==null,this.ya=-1,this.Rd=h,this.vg=s,this.Se=l.next(),this.Dj=this.Se.getType(),this.Ub=a,this.Fi=c,this.Fi!=-1&&(0>=this.Fi||7<this.Fi))throw d.i.N("bad dimension mask")}return x.prototype.next=function(){if(this.ts)return null;if(this.zw!=null){var h=this.zw.next();if(h!=null)return h;this.zw=null}for(;(h=this.Rd.next())!=null;)return this.ya=this.Rd.La(),this.Fi==-1?h=this.Ea(h):(this.zw=this.PS(h),h=this.zw.next()),h;return null},x.prototype.La=function(){return this.ya},x.prototype.Ea=function(h){var l=this.zK(h);if(l!=null)return l;l=d.ta.mv(this.Se,h);var s=d.ta.Wd(this.vg,l,!0);l=new d.l,this.Se.A(l);var a=new d.l;return h.A(a),l.W(2*s,2*s),l.Ea(a),l.W(100*s,100*s),s=d.Ud.clip(this.Se,l,0,0),h=d.Ud.clip(h,l,0,0),d.Fg.Av(h,s,this.vg,this.Ub)},x.prototype.QI=function(h,l,s){var a=0;if(1&l)s[0]==null&&(s[0]=new d.de(h)),a++;else for(var c=0;c<s.length-1;c++)s[c]=s[c+1];if(2&l)s[a]==null&&(s[a]=new d.Ta(h)),a++;else for(c=a;c<s.length-1;c++)s[c]=s[c+1];if(4&l)s[a]==null&&(s[a]=new d.Da(h)),a++;else for(c=a;c<s.length-1;c++)s[c]=s[c+1];if(a!=3){for(h=[],c=0;c<a;c++)h[c]=s[c];return new d.Zc(h)}return new d.Zc(s)},x.prototype.PS=function(h){var l=this.zK(h);if(l!=null){var s=[null,null,null];return s[l.Db()]=l,this.QI(h.description,this.Fi,s)}l=d.ta.mv(this.Se,h),s=d.ta.Wd(this.vg,l,!0),l=new d.l,this.Se.A(l),l.W(2*s,2*s);var a=new d.l;return h.A(a),l.Ea(a),l.W(100*s,100*s),s=d.Ud.clip(this.Se,l,0,0),l=d.Ud.clip(h,l,0,0),s=d.Fg.Pz(l,s,this.vg,this.Ub),this.QI(h.description,this.Fi,s)},x.prototype.zK=function(h){var l=d.ta.mv(h,this.Se),s=d.ta.Wd(this.vg,l,!0);l=h.getType();var a=h.B(),c=this.Se.B();if(!(c=a||c)){c=new d.l,h.A(c);var f=new d.l;this.Se.A(f),f.W(2*s,2*s),c=!c.isIntersecting(f)}if(!c)if((f=d.wL.nW(this.Se,h))==4)c=!0;else{if(2&f)return this.Se;if(1&f)return h}if(c)return(s=d.aa.tf(l))<(c=d.aa.tf(this.Dj))?x.HB(h,a):s>c||s==0&&l==550&&this.Dj==33?this.nJ():x.HB(h,a);if((this.Fi==-1||this.Fi==4)&&l==197&&this.Dj==197)return s=this.Se,l=new d.l,h.A(l),a=new d.l,s.A(a),l.Ea(a),s=new d.Fh,h.copyTo(s),s.Xo(l),s;if(l==197&&d.aa.tf(this.Dj)==0||this.Dj==197&&d.aa.tf(l)==0)return a=l==197?h:this.Se,h=l==197?this.Se:h,l=new d.l,a.A(l),d.Ud.clip(h,l,s,0);if(d.aa.tf(l)==0&&0<d.aa.tf(this.Dj)||0<d.aa.tf(l)&&d.aa.tf(this.Dj)==0){if(s=d.ta.kj(this.vg,h,!1),l==550||l==33)return d.Fg.zG(h,this.Se,s);if(this.Dj==550||this.Dj==33)return d.Fg.zG(this.Se,h,s);throw d.i.Qa()}return this.Fi!=-1&&this.Fi!=2||l!=1607||this.Dj!=1736?this.Fi!=-1&&this.Fi!=2||l!=1736||this.Dj!=1607?null:this.wK(this.Se,h):this.wK(h,this.Se)},x.prototype.wK=function(h,l){var s=h,a=l,c=d.ta.kj(this.vg,l,!1),f=new d.l;a.A(f);var y=new d.l;s.A(y),y.W(2*c,2*c),f.Ea(y),f.W(10*c,10*c),s=h=d.Ud.clip(h,f,0,0),y=new d.ia(0);var v=-1,_=a.Bb;if(_!=null){var $=_.Fk;if($!=null){v=0,y.Jb(s.I()+s.da());for(var I=new d.l,k=s.Ga();k.$a();)for(;k.Ha();){k.ha().A(I);var A=$.Ro(I);A==1?y.add(1):A==0?y.add(0):(y.add(-1),v++)}}}if(5<l.I()&&(_=(a=l=d.Ud.clip(l,f,0,0)).Bb),0>v&&(v=s.yz()),f=s.I()+a.I(),v*a.I()>Math.log(f)*f*4)return null;f=null,v=a.Ga(),_!=null&&_.Fb!=null&&(f=_.Fb),f==null&&20<a.I()&&(f=d.ta.nE(a)),h=h.Ia(),a=null,_=s.Ga(),$=[0,0,0,0,0,0,0,0,0],I=new d.be(0),k=new d.ig,A=-1;for(var P=0,D=0,j=0<y.size,B=-1;_.$a();){B=_.gb;var q=0;for(A=-1,P=0;_.Ha();){var z=j?d.O.truncate(y.get(D)):-1;D++;var Z=_.ha();if(0>z){if(f!=null)for(a==null?a=f.vR(Z,c):a.Uo(Z,c),z=a.next();z!=-1;z=a.next()){v.Vb(f.ja(z)),z=v.ha();var ee=Z.Ea(z,null,$,null,c);for(z=0;z<ee;z++)I.add($[z])}else for(v.Zi();v.$a();)for(;v.Ha();)for(z=v.ha(),ee=Z.Ea(z,null,$,null,c),z=0;z<ee;z++)I.add($[z]);if(0<I.size){I.Vd(0,I.size,function(xe,_e){return xe-_e});var Q=0;I.add(1),ee=-1,z=0;for(var le=I.size;z<le;z++){var se=I.get(z);if(se!=Q){var ve=!1;if(Q!=0||se!=1?(Z.ah(Q,se,k),Q=k.get()):(Q=Z,ve=!0),2<=q){if(h.Dr(s,B,A,P,q==3),this.QD(l,Q.ac(),c)!=1&&this.RD(l,Q,c)!=1)return null;h.oc(Q,!1),q=1,P=0}else switch(ee=this.RD(l,Q,c),ee){case 1:ve?2>q?(A=_.wb()-s.Ba(B),P=1,q=q==0?3:2):P++:(h.oc(Q,q==0),q=1);break;case 0:q=0,A=-1,P=0;break;default:return null}Q=se}}}else{if(0>(z=this.QD(l,Z.ac(),c)))return null;z==1?(2>q&&(A=_.wb()-s.Ba(B),q=q==0?3:2),P++):(A=-1,P=0)}I.clear(!1)}else z!=0&&z==1&&(q==0?(q=3,A=_.wb()-s.Ba(B)):q==1?(q=2,A=_.wb()-s.Ba(B)):P++)}2<=q&&(h.Dr(s,B,A,P,q==3),A=-1)}return h},x.prototype.QD=function(h,l,s){return d.Dg.wm(h,l,s)},x.prototype.RD=function(h,l,s){var a=l.ac();l=l.wc();var c=d.Dg.wm(h,a,s),f=d.Dg.wm(h,l,s);return c==1&&f==0||c==0&&f==1?-1:c==0||f==0?0:c==1||f==1?1:((c=new d.h).add(a,l),c.scale(.5),(h=d.Dg.wm(h,c,s))==0?0:h==1?1:-1)},x.HB=function(h,l){return l?h:h.Ia()},x.prototype.nJ=function(){return this.yH==null&&(this.yH=this.Se.Ia()),this.yH},x.prototype.qe=function(){},x}();d.HC=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 28},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c,f,y,v){return l instanceof d.aa?(l=new d.Zc(l),this.V(l,s,a,c,f,y,v).next()):new d.xL(l,s,a,c,f,y,v)},h.instance=null,h}(d.Je);d.IC=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a,c,f,y){this.ya=-1,this.Rd=h,this.Mj=l,this.Ka=s,this.Ki=a,this.CA=c,this.uH=f,this.nd=y}return x.prototype.next=function(){var h=this.Rd.next();return h!=null?(this.ya=this.Rd.La(),this.jL(h)):null},x.prototype.La=function(){return this.ya},x.prototype.jL=function(h){var l=0>=this.uH?d.ta.kj(this.Mj,h,!1):this.uH;return d.IK.V(h,this.Ka,this.Ki,this.CA,l,this.nd)},x.prototype.qe=function(){},x}();d.xL=O}(Y||(Y={})),function(d){var O;(O=d.NK||(d.NK={}))[O.clipToDomainOnly=1]="clipToDomainOnly",O[O.clipWithHorizon=2]="clipWithHorizon",O[O.foldAndClipWithHorizon=3]="foldAndClipWithHorizon";var x=function(h){function l(){return h!==null&&h.apply(this,arguments)||this}return Kt(l,h),l.prototype.getType=function(){return 0},l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.V=function(s,a,c){return s instanceof d.aa?(s=new d.Zc(s),this.V(s,a,c).next()):new d.yL(s,a,c)},l.prototype.transform=function(s,a,c,f){return d.bu.transform(s,a,c,f,!0)},l.prototype.Qt=function(s,a,c,f){return d.bu.Qt(s,a,c,f)},l.instance=null,l}(d.Je);d.Hx=x}(Y||(Y={})),function(d){var O=function(){function x(h,l,s){this.ya=-1,this.Rd=h,this.MT=l,this.nd=s}return x.prototype.next=function(){var h=this.Rd.next();return h!=null?(this.ya=this.Rd.La(),d.bu.zh(h,this.MT,this.nd)):null},x.prototype.La=function(){return this.ya},x.prototype.qe=function(){},x}();d.yL=O}(Y||(Y={})),function(d){var O=function(){function h(){}return h.prototype.reset=function(){this.ph=this.xk=-1,this.us=this.kq=!1},h.prototype.AQ=function(l,s,a){for(l.Vb(s,a);l.Ha();){var c=l.ha();if((c=c.Qb())!=0)return l.wb()}for(l.Vb(s,a);l.Ez();)if((c=(c=l.li()).Qb())!=0)return l.wb();return-1},h.prototype.BQ=function(l,s){for(l.Vb(s,-1);l.Ez();)if(l.li().Qb()!=0)return l.wb();return-1},h.prototype.zQ=function(l,s){for(l.Vb(s,-1),l.ha();l.Ha();)if(l.ha().Qb()!=0)return l.wb();return-1},h.prototype.yQ=function(l,s,a,c){if(this.xk=this.AQ(s,a,c),this.xk!=-1){s.Vb(this.xk,-1);var f=s.ha(),y=f.hc(f.fe(l,!1));if(a=d.h.yc(y,l),(c=new d.h).L(y),c.sub(f.ac()),(y=new d.h).L(l),y.sub(f.ac()),this.kq=0>c.wi(y),this.ph=this.zQ(s,this.xk),this.ph!=-1){s.Vb(this.ph,-1);var v=(f=s.ha()).fe(l,!1);v=f.hc(v);var _=d.h.yc(v,l);_>a?this.ph=-1:(c.L(v),c.sub(f.ac()),y.L(l),y.sub(f.ac()),this.us=0>c.wi(y))}this.ph==-1&&(this.ph=this.BQ(s,this.xk),this.ph!=-1&&(s.Vb(this.ph,-1),v=(f=s.ha()).fe(l,!1),v=f.hc(v),(_=d.h.yc(v,l))>a?this.ph=-1:(c.L(v),c.sub(f.ac()),y.L(l),y.sub(f.ac()),this.us=0>c.wi(y),l=this.xk,this.xk=this.ph,this.ph=l,l=this.kq,this.kq=this.us,this.us=l)))}},h.prototype.cO=function(l,s,a,c,f){return a=a.Ga(),this.yQ(l,a,c,f),this.xk!=-1&&this.ph==-1?this.kq:this.xk!=-1&&this.ph!=-1?this.kq==this.us?this.kq:(a.Vb(this.xk,-1),l=a.ha().kg(),a.Vb(this.ph,-1),s=a.ha().kg(),0<=l.wi(s)):s},h}(),x=function(h){function l(){return h!==null&&h.apply(this,arguments)||this}return Kt(l,h),l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.getType=function(){return 3},l.prototype.nz=function(s,a,c){var f;if(f===void 0&&(f=!1),s.B())return new d.$l;a=a.D();var y=s,v=s.getType();switch(v==197&&((y=new d.Da).ad(s,!1),v=1736),v){case 33:return this.xI(y,a);case 550:return this.jI(y,a);case 1607:case 1736:return this.bU(y,a,c,f);default:throw d.i.fa("not implemented")}},l.prototype.oz=function(s,a){if(s.B())return new d.$l;a=a.D();var c=s,f=s.getType();switch(f==197&&((c=new d.Da).ad(s,!1),f=1736),f){case 33:return this.xI(c,a);case 550:case 1607:case 1736:return this.jI(c,a);default:throw d.i.fa("not implemented")}},l.prototype.pz=function(s,a,c,f){if(0>f)throw d.i.N();if(s.B())return[];a=a.D();var y=s,v=s.getType();switch(v==197&&((y=new d.Da).ad(s,!1),v=1736),v){case 33:return this.TU(y,a,c,f);case 550:case 1607:case 1736:return this.tU(y,a,c,f);default:throw d.i.fa("not implemented")}},l.prototype.bU=function(s,a,c,f){if(s.getType()==1736&&c&&(c=new d.l,s.A(c),c=d.ta.Wd(null,c,!1),(f?d.hd.Yd(s,a,0):d.hd.Yd(s,a,c))!=0)){var y=new d.$l(a,0,0);return f&&y.WJ(!0),y}var v=s.Ga();y=new d.h;for(var _=c=-1,$=17976931348623157e292,I=0;v.$a();)for(;v.Ha();){var k=v.ha();k=k.hc(k.fe(a,!1));var A=d.h.yc(k,a);A<$?(I=1,y=k,c=v.wb(),_=v.gb,$=A):A==$&&I++}return y=new d.$l(y,c,Math.sqrt($)),f&&(v.Vb(c,_),k=v.ha(),f=0>d.h.Uq(a,k.ac(),k.wc()),1<I&&((I=new O).reset(),f=I.cO(a,f,s,c,_)),y.WJ(f)),y},l.prototype.xI=function(s,a){return s=s.D(),a=d.h.tb(s,a),new d.$l(s,0,a)},l.prototype.jI=function(s,a){for(var c=s.ub(0),f=s.I(),y=s=0,v=0,_=17976931348623157e292,$=0;$<f;$++){var I=new d.h;c.tc(2*$,I);var k=d.h.yc(I,a);k<_&&(y=I.x,v=I.y,s=$,_=k)}return(a=new d.$l).ey(y,v,s,Math.sqrt(_)),a},l.prototype.TU=function(s,a,c,f){return f==0?[]:(c*=c,s=s.D(),(a=d.h.yc(s,a))<=c?(c=[],(f=new d.$l).ey(s.x,s.y,0,Math.sqrt(a)),c[0]=f):c=[],c)},l.prototype.tU=function(s,a,c,f){if(f==0)return[];var y=s.ub(0),v=s.I();s=[],c*=c;for(var _=0;_<v;_++){var $=y.read(2*_),I=y.read(2*_+1),k=a.x-$,A=a.y-I;(k=k*k+A*A)<=c&&((A=new d.$l).ey($,I,_,Math.sqrt(k)),s.push(A))}return a=s.length,s.sort(function(P,D){return P.Ka<D.Ka?-1:P.Ka==D.Ka?0:1}),f>=a||(s.length=f),s.slice(0)},l.instance=null,l}(d.Je);d.Ix=x}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 4},h.prototype.V=function(l,s,a,c,f){return d.am.yB(l,s,a,c,f)},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.Iu=function(l){return d.Vt.wy(l)},h.prototype.wn=function(l,s,a){d.Vt.CD(l,s,a)},h.instance=null,h}(d.Je);d.zL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 33},h.prototype.V=function(l,s,a,c,f){return l===1073741824?!d.ud.zB(s,a,c,4,f):d.ud.zB(s,a,c,l,f)},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.Iu=function(l){return d.Vt.wy(l)},h.prototype.wn=function(l,s,a){d.Vt.CD(l,s,a)},h.instance=null,h}(d.Je);d.dj=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a){if(this.nd=a,this.rT=s,this.ya=-1,h==null)throw d.i.N();this.yk=h,this.Mj=l}return x.prototype.next=function(){var h;if((h=this.yk.next())!=null){if(this.ya=this.yk.La(),this.nd!=null&&!this.nd.progress(-1,-1))throw d.i.fu("user_canceled");return this.eC(h)}return null},x.prototype.La=function(){return this.ya},x.prototype.eC=function(h){if(h==null)throw d.i.N();return d.Jx.cK(h,this.Mj,this.rT,this.nd)},x.prototype.qe=function(){},x}();d.AL=O}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 26},h.prototype.V=function(l,s,a,c){return l instanceof d.aa?(l=new d.Zc(l),this.V(l,s,a,c).next()):new d.AL(l,s,a,c)},h.prototype.rs=function(l,s,a,c,f){return 0<(c!==void 0?d.Jx.rs(l,s,a,c,f):d.Jx.rs(l,s,!1,null,a))},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.instance=null,h}(d.Je);d.Yl=O}(Y||(Y={})),function(d){var O=function(){function f(){this.yq=0}return f.prototype.nX=function(y){this.yq&=-2,this.yq|=y?1:0},f.prototype.Wp=function(){return!!(1&this.yq)},f.prototype.XF=function(){return this.Wp()?0:1},f}();d.xY=O;var x=function(){},h=function(f,y,v,_){this.x=f,this.y=y,this.Ai=v,this.xm=_},l=function(){function f(y){this.Be=y}return f.prototype.compare=function(y,v,_){return y=y.ja(_),v=this.Be.lf.read(2*v),0>(v-=y=this.Be.lf.read(2*y))?-1:0<v?1:0},f}(),s=function(){function f(y){this.Be=y}return f.prototype.compare=function(y,v,_){v=this.Be.hb[v],y=this.Be.hb[y.ja(_)];var $=v.Wp(),I=y.Wp();_=v.ne.Pe(this.Be.Mo,0);var k=y.ne.Pe(this.Be.Mo,0);return _==k&&(($=.5*((_=Math.min($?v.ne.na:v.ne.la,I?y.ne.na:y.ne.la))-this.Be.Mo)+this.Be.Mo)==this.Be.Mo&&($=_),_=v.ne.Pe($,0),k=y.ne.Pe($,0)),_<k?-1:_>k?1:0},f}(),a=function(){function f(y,v){this.YI=new d.h,this.parent=y,this.dS=v}return f.prototype.nr=function(y,v,_){var $=this.parent,I=this.dS;_.Vd(y,v,function(k,A){return $.Mh(k,A,I)})},f.prototype.$p=function(y){return y=this.parent.gi.get(y),this.parent.lf.tc(2*(y>>1),this.YI),this.YI.y+(1&y?this.parent.Oj:-this.parent.Oj)},f}(),c=function(){function f(y,v,_,$,I){this.nH=y.description,this.X=y,this.Qg=v,this.Oj=d.ta.kj(this.Qg,y,!1),this.Bo=d.ta.kj(this.Qg,y,!0),this.xA=_,this.oT=this.nH.Aa,this.hb=[],this.po=[],this.mh=new d.jp,this.fb=new d.Yj,this.ke=new d.Md,this.ZG=this.ql=I}return f.prototype.eT=function(){return this.ZG=!0,(!d.aa.Hc(this.X.getType())||this.GE()&&this.DE(!1))&&this.mO()?d.aa.Hc(this.X.getType())?this.pO()?this.X.getType()==1607?this.rO()?2:0:this.sO()?this.tO():0:0:2:0},f.prototype.kC=function(y,v){var _=this.lf.read(2*y);y=this.lf.read(2*y+1);var $=this.lf.read(2*v);v=this.lf.read(2*v+1);var I=!d.Yt.Cv(_,y,$,v,this.Oj*this.Oj);return I||this.X.Db()!=0&&_==$&&y==v},f.prototype.GE=function(){for(var y=this.X,v=y.xf?3:2,_=0,$=y.da();_<$;_++)if(y.Ja(_)<v)return this.ke=new d.Md(1,_,0),!1;return!0},f.prototype.DE=function(y){var v=this.X,_=v.Ga(),$=v.hasAttribute(1);for(v=$?d.ta.wE(this.Qg,v,!1):0;_.$a();)for(;_.Ha();){var I=_.ha();if(!(I.Qb()>this.Oj)){if(y&&$){var k=I.wv(1,0);if(I=I.wv(1,0),Math.abs(I-k)>v)continue}return this.ke=new d.Md(2,_.wb(),-1),!1}}return!0},f.prototype.mO=function(){var y=this.X,v=null;d.aa.Hc(this.X.getType())&&(v=this.X);var _=(this.ZG||this.ql)&&v!=null,$=y.I();this.lf=y.ub(0),this.gi=new d.ia(0),this.gi.Jb(2*$),this.fi=new d.ia(0),this.fi.Jb(2*$),_&&(this.Fl==null&&(this.Fl=new d.ia(0)),this.Fl.Jb($));for(var I=y=0;I<$;I++)if(this.gi.add(2*I),this.gi.add(2*I+1),this.fi.add(2*I),this.fi.add(2*I+1),_){for(;I>=v.Vc(y);)y++;this.Fl.add(y)}for(new d.Xt().sort(this.fi,0,2*$,new a(this,_)),this.fb.clear(),this.fb.Vo(new l(this)),this.fb.De($),v=0,$*=2;v<$;v++)if(_=this.fi.get(v),_=(y=this.gi.get(_))>>1,1&y){if(y=this.fb.search(_,-1),I=this.fb.we(y),k=this.fb.lb(y),this.fb.vd(y,-1),I!=-1&&k!=-1&&!this.kC(this.fb.ja(I),this.fb.ja(k)))return this.ke=new d.Md(3,this.fb.ja(I),this.fb.ja(k)),!1}else{if(y=this.fb.addElement(_,-1),(I=this.fb.we(y))!=-1&&!this.kC(this.fb.ja(I),_))return this.ke=new d.Md(3,_,this.fb.ja(I)),!1;var k=this.fb.lb(y);if(k!=-1&&!this.kC(this.fb.ja(k),_))return this.ke=new d.Md(3,_,this.fb.ja(k)),!1}return!0},f.prototype.pO=function(){return 10>this.X.I()?this.nO():this.oO()},f.prototype.oO=function(){var y=new d.gd;y.Ib(this.X);var v=new d.Md;return!d.$t.kI(!1,y,this.Oj,v,this.nd)||(v.Jo=y.Ua(v.Jo),v.Ko=y.Ua(v.Ko),this.ke.Wt(v),!1)},f.prototype.nO=function(){var y=this.X,v=y.Ga();for(y=y.Ga();v.$a();)for(;v.Ha();){var _=v.ha();if(!v.Qn()||!v.$S()){y.BW(v);do for(;y.Ha();){var $=y.ha();if(($=_.zr($,this.Oj,!0))!=0)return this.ke=new d.Md($==2?5:4,v.wb(),y.wb()),!1}while(y.$a())}}return!0},f.prototype.sO=function(){var y=this.X;this.hb.length=0,this.po.length=0,this.Zf=y.Ga(),this.Zf.JB();var v=new d.ia(0);v.Jb(10);var _=NaN,$=0,I=0;for(y=2*y.I();I<y;I++){var k=this.fi.get(I);if(!(1&(k=this.gi.get(k)))){k>>=1;var A=this.lf.read(2*k),P=this.lf.read(2*k+1);if(v.size!=0&&(A!=_||P!=$)){if(!this.RI(v))return!1;v!=null&&v.clear(!1)}v.add(k),_=A,$=P}}return!!this.RI(v)},f.prototype.rO=function(){for(var y=this.X,v=Array(y.da()),_=0,$=y.da();_<$;_++)v[_]=y.Nn(_);$=new x;var I=new d.h;_=this.fi.get(0);var k=(_=this.gi.get(_))>>1;this.lf.tc(2*k,I);var A=v[_=this.Fl.get(k)],P=y.Ba(_),D=y.Vc(_)-1;$.el=k==P||k==D,$.ny=this.ql?!A&&$.el:$.el,$.Ai=_,$.x=I.x,$.y=I.y,$.xm=k;for(var j=new x,B=1,q=this.fi.size;B<q;B++)if(_=this.fi.get(B),!(1&(_=this.gi.get(_)))){k=_>>1,this.lf.tc(2*k,I),(_=this.Fl.get(k))!=$.Ai&&(A=v[_],P=y.Ba(_),D=y.Vc(_)-1);var z=k==P||k==D,Z=this.ql?!A&&$.el:$.el;if(j.x=I.x,j.y=I.y,j.Ai=_,j.xm=k,j.ny=Z,j.el=z,j.x==$.x&&j.y==$.y){if(this.ql){if(!(j.ny&&$.ny||j.Ai==$.Ai&&(j.el||$.el)))return this.ke=new d.Md(8,j.xm,$.xm),!1}else if(!j.el||!$.el)return this.ke=new d.Md(5,j.xm,$.xm),!1}_=$,$=j,j=_}return!0},f.prototype.JE=function(){for(var y=this.X,v=[],_=-1,$=!1,I=0,k=y.da();I<k;I++)y.Ev(I)&&($=!1,_++,I<k-1&&(y.Ev(I+1)||($=!0))),v[I]=$?_:-1;$=new d.h,I=this.fi.get(0);var A=(I=this.gi.get(I))>>1;this.lf.tc(2*A,$),I=this.Fl.get(A),_=new h($.x,$.y,I,A,v[I]),y=[];var P=1;for(k=this.fi.size;P<k;P++)if(I=this.fi.get(P),!(1&(I=this.gi.get(I)))){if(A=I>>1,this.lf.tc(2*A,$),I=this.Fl.get(A),(I=new h($.x,$.y,I,A,v[I])).x==_.x&&I.y==_.y){if(I.Ai==_.Ai)return this.ke=new d.Md(9,I.xm,_.xm),!1;0<=v[I.Ai]&&v[I.Ai]==v[_.Ai]&&(y.length!=0&&y[y.length-1]==_||y.push(_),y.push(I))}_=I}if(y.length==0)return!0;for(I=new d.jp(!0),d.O.$u(v,-1),$=-1,(P=new d.h).Rc(),_=0,k=y.length;_<k;_++){(A=y[_]).x==P.x&&A.y==P.y||($=I.Ph(0),P.x=A.x,P.y=A.y);var D=v[A.Ai];D==-1&&(D=I.Ph(2),v[A.Ai]=D),I.addElement(D,$),I.addElement($,D)}for((k=new d.ia(0)).Jb(10),_=I.je;_!=-1;_=I.qz(_))if(!(1&(y=I.PF(_)))&&2&y){for(y=-1,k.add(_),k.add(-1);0<k.size;){if($=k.Fc(),k.If(),P=k.Fc(),k.If(),1&(A=I.PF(P))){y=2&A?P:$;break}for(I.fX(P,1|A),A=I.rc(P);A!=-1;A=I.lb(A))(D=I.getData(A))!=$&&(k.add(D),k.add(P))}if(y!=-1){for(I=-1,_=0,k=v.length;_<k;_++)if(v[_]==y){I=_;break}return this.ke=new d.Md(10,I,-1),!1}}return!0},f.prototype.tO=function(){var y=this.X;if(0>=y.Ke())return this.ke=new d.Md(6,y.da()==1?1:-1,-1),0;if(y.da()==1)return this.ql&&!this.JE()?0:2;this.to=d.ia.qf(y.da(),0),this.JA=d.ia.qf(y.da(),-1);for(var v=-1,_=0,$=0,I=y.da();$<I;$++){var k=y.Ir($);if(this.to.write($,0>k?0:256),0<k)v=$,_=k;else{if(k==0)return this.ke=new d.Md(6,$,-1),0;if((0>v||_<Math.abs(k))&&(this.ke=new d.Md(7,$,-1),this.ql))return 0;this.JA.write($,v)}}for(this.dt=y.da(),this.Om=new d.ia(0),this.Om.Jb(10),I=y.I(),this.Mo=NaN,(y=new d.ia(0)).Jb(10),this.Qq=d.ia.qf(I,-1),this.Hw=d.ia.qf(I,-1),this.zj!=null?this.zj.clear(!1):this.zj=new d.ia(0),this.zj.Jb(10),this.fb.clear(),this.fb.Vo(new s(this)),v=0,I*=2;0<this.dt&&v<I;v++)if(_=this.fi.get(v),!(1&(_=this.gi.get(_)))){if(_>>=1,($=this.lf.read(2*_+1))!=this.Mo&&y.size!=0){if(!this.ut(y))return 0;y!=null&&y.clear(!1)}y.add(_),this.Mo=$}return 0<this.dt&&!this.ut(y)?0:this.ql?this.ke.Jj==0&&this.JE()?2:0:this.ke.Jj==0?2:1},f.prototype.RI=function(y){if(y.size==1)return!0;for(var v=0,_=y.size;v<_;v++){var $=y.get(v);this.Zf.Vb($);var I=this.Zf.li();this.hb.push(this.Su(I,$,this.Zf.gb,!0)),this.Zf.ha(),I=this.Zf.ha(),this.hb.push(this.Su(I,$,this.Zf.gb,!1))}var k=this;for(this.hb.sort(function(D,j){return k.XP(D,j)}),($=this.mh.je)==-1&&($=this.mh.Ph(0)),this.mh.fn(this.hb.length),v=0,_=this.hb.length;v<_;v++)this.mh.addElement($,v);v=!0;for(var A=_=-1;v&&(v=!1,(I=this.mh.rc($))!=-1);)for(var P=this.mh.lb(I);P!=-1;)if(_=this.mh.getData(I),A=this.mh.getData(P),(_=this.hb[_].Io)!=(A=this.hb[A].Io))I=P,P=this.mh.lb(I);else if(v=!0,this.mh.jd($,I),I=this.mh.we(P),(P=this.mh.jd($,P))==-1||I==-1)break;if(v=this.mh.bs($),this.mh.LE($),0<v)return this.ke=new d.Md(5,_,A),!1;for(v=0,_=y.size;v<_;v++)this.vB(this.hb[v]);return this.hb.length=0,!0},f.prototype.ut=function(y){for(var v=0,_=y.size;v<_;v++){var $=y.get(v),I=this.Qq.read($);if(I!=-1){var k=this.fb.ja(I);this.zj.add(k),this.fb.vd(I,-1),this.vB(this.hb[k]),this.hb[k]=null,this.Qq.write($,-1)}(I=this.Hw.read($))!=-1&&(k=this.fb.ja(I),this.zj.add(k),this.fb.vd(I,-1),this.vB(this.hb[k]),this.hb[k]=null,this.Hw.write($,-1))}for(v=0,_=y.size;v<_;v++){if($=y.get(v),this.Zf.Vb($),(I=this.Zf.li()).na>I.la){var A=this.Zf.wb(),P=this.Su(I,$,this.Zf.gb,!0);0<this.zj.size?(k=this.zj.Fc(),this.zj.If(),this.hb[k]=P):(k=this.hb.length,this.hb.push(P)),I=this.fb.addElement(k,-1),this.Qq.read(A)==-1?this.Qq.write(A,I):this.Hw.write(A,I),!(3&this.to.read(this.Zf.gb))&&this.Om.add(I)}this.Zf.ha(),(I=this.Zf.ha()).na<I.la&&(A=this.Zf.ik(),P=this.Su(I,$,this.Zf.gb,!1),0<this.zj.size?(k=this.zj.Fc(),this.zj.If(),this.hb[k]=P):(k=this.hb.length,this.hb.push(P)),I=this.fb.addElement(k,-1),this.Qq.read(A)==-1?this.Qq.write(A,I):this.Hw.write(A,I),!(3&this.to.read(this.Zf.gb))&&this.Om.add(I))}for(v=0,_=this.Om.size;v<_&&0<this.dt;v++)if(I=this.Om.get(v),!(3&this.to.read(this.hb[this.fb.ja(I)].IA))){y=-1,$=this.fb.we(I);var D=I;P=null,k=-1;for(var j=0;$!=-1&&(k=this.fb.ja($),k=(P=this.hb[k]).IA,!(3&(j=this.to.read(k))));)D=$,$=this.fb.we($);$==-1?(A=1,$=D):(y=(3&j)==1?k:this.JA.read(k),A=P.XF()!=0?0:1,$=this.fb.lb($));do{if(k=this.fb.ja($),k=(P=this.hb[k]).IA,!(3&(D=this.to.read(k)))){if(A!=P.XF())return this.ke=new d.Md(6,k,-1),!1;if(D=252&D|(j=A==0||P.Wp()?2:1),this.to.write(k,j),j==2&&this.ke.Jj==0&&this.JA.read(k)!=y&&(this.ke=new d.Md(7,k,-1),this.ql))return!1;if(this.dt--,this.dt==0)return!0}(3&D)==1&&(y=k),D=$,$=this.fb.lb($),A=A!=0?0:1}while(D!=I)}return this.Om!=null?this.Om.clear(!1):this.Om=new d.ia(0),!0},f.prototype.Su=function(y,v,_,$){if(y.getType()!=322)throw d.i.Qa();return(y=this.sP(y)).Io=v,y.IA=_,y.yq=0,y.nX($),y},f.prototype.sP=function(y){if(0<this.po.length){var v=this.po[this.po.length-1];--this.po.length,y.copyTo(v.ne)}else(v=new O).ne=d.SC.jg(y);return v},f.prototype.vB=function(y){y.ne.getType()==322&&this.po.push(y)},f.prototype.kU=function(){for(var y=this.X.I(),v=new d.ia(0),_=0;_<y;_++)v.add(_);var $=this;for(v.Vd(0,y,function(I,k){return $.Ou(I,k)}),_=1;_<y;_++)if(this.Ou(v.get(_-1),v.get(_))==0)return this.ke=new d.Md(3,v.get(_-1),v.get(_)),0;return 2},f.prototype.JV=function(){return this.GE()&&this.DE(!0)?2:0},f.prototype.oV=function(){return this.eT()},f.prototype.pU=function(){for(var y=this.X.I(),v=new d.ia(0),_=0;_<y;_++)v.add(_);var $=this;v.Vd(0,y,function(D,j){return $.PO(D,j)});var I=Array(y);for(d.O.$u(I,!1),I[v.get(0)]=!0,_=1;_<y;_++){var k=v.get(_-1),A=v.get(_);this.Ou(k,A)==0?I[A]=!1:I[A]=!0}v=this.X.Ia(),k=this.X,A=0;var P=1;for(_=0;_<y;_++)I[_]?P=_+1:(A<P&&v.Fd(k,A,P),A=_+1);return A<P&&v.Fd(k,A,P),v.Ch(2,this.Bo),v},f.prototype.NV=function(){var y=this.X,v=y.Ga(),_=y.Ga(),$=this.X.Ia(),I=this.X,k=y.hasAttribute(1),A=k?d.ta.wE(this.Qg,y,!0):0,P=new d.ia(0),D=new d.ia(0);for(P.Jb(d.O.truncate(y.I()/2+1)),D.Jb(d.O.truncate(y.I()/2+1));v.$a();)if(_.$a(),!(2>y.Ja(v.gb))){_.EW();for(var j,B,q=!0;v.Ha();){var z=v.ha(),Z=_.li();if(v.wb()>_.wb())break;q&&(P.add(v.wb()),D.add(_.ik()),q=!1),B=P.Fc();var ee=v.ik();if(1<ee-B){var Q=new d.h;Q.uc(y.Na(B),y.Na(ee)),j=Q.length()}else j=z.Qb();B=D.Fc(),1<(ee=_.wb())-B?((Q=new d.h).uc(y.Na(B),y.Na(ee)),B=Q.length()):B=Z.Qb(),j>this.Bo?P.add(v.ik()):k&&(j=y.Uc(1,P.Fc(),0),z=z.gv(1,0),Math.abs(z-j)>A&&P.add(v.ik())),B>this.Bo?D.add(_.wb()):k&&(j=y.Uc(1,D.Fc(),0),z=Z.gv(1,0),Math.abs(z-j)>A&&D.add(_.wb()))}if(P.Fc()<D.Fc()?P.size>D.size?P.If():D.If():(P.Fc()!=D.Fc()&&D.If(),D.If()),2<=D.size+P.size){for(q=new d.Sa,Z=0,z=P.size;Z<z;Z++)I.ve(P.get(Z),q),Z==0?$.nf(q):$.lineTo(q);for(Z=D.size-1;0<Z;Z--)I.ve(D.get(Z),q),$.lineTo(q);I.dc(v.gb)?$.Ap():0<D.size&&(I.ve(D.get(0),q),$.lineTo(q))}P!=null&&P.clear(!1),D!=null&&D.clear(!1)}return $.Ch(2,this.Bo),$},f.prototype.rV=function(){return this.DX()},f.prototype.DX=function(){return this.X.getType()==1736&&this.X.In()==1?d.Fg.Mk(this.X,this.Bo,!0,!1,this.nd):(this.Hi=new d.gd,this.Hi.Ib(this.X),this.Hi.fd!=0&&(this.xA!=1&&d.Tk.V(this.Hi,this.Bo,this.nd,!0),this.X.getType()==1736&&d.rn.V(this.Hi,this.Hi.ld,this.xA,!1,this.nd)),this.X=this.Hi.Ne(this.Hi.ld),this.X.getType()==1736&&(this.X.fm(),this.X.Yo(0)),this.X.Ch(2,this.Bo),this.X)},f.rs=function(y,v,_,$,I){if($!=null&&($.Jj=0,$.Jo=-1,$.Ko=-1),y.B())return 1;var k=y.getType();if(k==33)return 1;var A=d.ta.kj(v,y,!1);if(k==197)return v=new d.l,y.A(v),v.Bi(A)?($!=null&&($.Jj=2,$.Jo=-1,$.Ko=-1),0):1;if(d.aa.yd(k))return(A=new d.Ta(y.description)).oc(y,!0),f.rs(A,v,_,$,I);var P=y.om(A);if((_=_?-1:P)!=-1)return _;if(v=new f(y,v,_,I,!1),k==550)_=v.kU();else if(k==1607)_=v.JV();else{if(k!=1736)throw d.i.Qa();_=v.oV()}return y.Ch(_,A),$!=null&&_==0&&$.Wt(v.ke),_},f.cK=function(y,v,_,$){if(y.B())return y;var I=y.getType();if(I==33)return y;var k=d.ta.kj(v,y,!1);if(I==197)return v=new d.l,y.A(v),v.Bi(k)?y.Ia():y;if(d.aa.yd(I))return(I=new d.Ta(y.description)).oc(y,!0),f.cK(I,v,_,$);if(k=y.om(k),(_=_?-1:k)==2)return y;if(y=new f(y,v,_,$,!1),I==550)y=y.pU();else if(I==1607)y=y.NV();else{if(I!=1736)throw d.i.Qa();y=y.rV()}return y},f.prototype.Mh=function(y,v,_){if(y==v)return 0;y=this.gi.get(y);var $=this.gi.get(v);v=y>>1;var I=$>>1,k=new d.h,A=new d.h;return this.lf.tc(2*v,k),k.y+=1&y?this.Oj:-this.Oj,this.lf.tc(2*I,A),A.y+=1&$?this.Oj:-this.Oj,(y=k.compare(A))==0&&_?0>(_=this.Fl.get(v)-this.Fl.get(I))?-1:0<_?1:0:y},f.prototype.Ou=function(y,v){if(y==v)return 0;var _=this.X,$=_.Na(y),I=_.Na(v);if($.x<I.x)return-1;if($.x>I.x)return 1;if($.y<I.y)return-1;if($.y>I.y)return 1;for($=1;$<this.oT;$++){I=this.nH.kd($);for(var k=d.ra.Va(I),A=0;A<k;A++){var P=_.Uc(I,y,A),D=_.Uc(I,v,A);if(P<D)return-1;if(P>D)return 1}}return 0},f.prototype.PO=function(y,v){var _=this.Ou(y,v);return _==0?y<v?-1:1:_},f.prototype.XP=function(y,v){if(y===v)return 0;var _=y.ne.kg();y.Wp()&&_.Sq(),y=v.ne.kg(),v.Wp()&&y.Sq(),v=_.qu();var $=y.qu();return $==v?(v=_.wi(y),Math.abs(v)<=8881784197001252e-31*(Math.abs(y.x*_.y)+Math.abs(y.y*_.x))&&(v--,v++),0>v?1:0<v?-1:0):v<$?-1:1},f}();d.Jx=c}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 30},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.prototype.V=function(l,s,a,c){return l instanceof d.aa?(l=new d.Zc(l),s=new d.Zc(s),this.V(l,s,a,c).next()):new d.BL(l,s,a,c)},h.ep=function(l,s,a,c){var f=l.Db(),y=s.Db();if(l.B()&&s.B())return f>y?l:s;if(l.B())return s;if(s.B())return l;var v=new d.l,_=new d.l,$=new d.l;return l.A(v),s.A(_),$.K(v),$.Zb(_),v=d.ta.Wd(a,$,!0),_=l.getType(),$=s.getType(),_==33&&$==33?h.aV(l,s,v):_!=$?0<f||0<y?f>y?l:s:_==550?h.iI(l,s,v):h.iI(s,l,v):d.Fg.ep(l,s,a,c)},h.aV=function(l,s,a){a=a*Math.sqrt(2)*1.00001,a*=a;var c=l.D(),f=s.D(),y=new d.de(l.description);return d.h.yc(c,f)>a&&(y.add(l),y.add(s)),y},h.iI=function(l,s,a){var c=l.ub(0),f=l.I(),y=s.D(),v=l.Ia();a=a*Math.sqrt(2)*1.00001;var _=new d.l;if(l.A(_),_.W(a,a),_.contains(y)){a*=a,_=!1;for(var $=[],I=0;I<f;I++)$[I]=!1;for(I=0;I<f;I++){var k=c.read(2*I),A=c.read(2*I+1);(k-=y.x)*k+(A-=y.y)*A<=a&&(_=!0,$[I]=!0)}if(_)for(I=0;I<f;I++)$[I]||v.Fd(l,I,I+1);else v.Fd(l,0,f),v.add(s)}else v.Fd(l,0,f),v.add(s);return v},h.instance=null,h}(d.Je);d.Kx=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s,a){this.ts=l==null,this.ya=-1,this.Rd=h,this.vg=s,this.NT=l.next(),this.Ub=a}return x.prototype.next=function(){return this.ts?null:(h=this.Rd.next())!=null?(this.ya=this.Rd.La(),d.Kx.ep(h,this.NT,this.vg,this.Ub)):null;var h},x.prototype.La=function(){return this.ya},x.prototype.qe=function(){},x}();d.BL=O}(Y||(Y={})),function(d){var O=function(){function l(){}return l.prototype.Fz=function(){this.$y=null,this.Ax=-1,this.AK=!1},l}(),x=function(){function l(){this.Gr=0,this.pj=[]}return l.prototype.pN=function(s){this.Gr+=s.Ax,this.pj.push(s)},l.prototype.TV=function(){this.Gr-=this.pj[this.pj.length-1].Ax,--this.pj.length},l.prototype.my=function(){return this.pj[this.pj.length-1]},l.prototype.Nb=function(s){return s===this},l}(),h=function(){function l(s,a,c){this.ya=-1,this.Ic=!1,this.AH=[!1,!1,!1,!1],this.uq=[0,0,0,0],this.jA=!1,this.zk=-1,this.iq=0,this.bo=-1,this.Do=[],this.Rd=s,this.vg=a,this.Ub=c}return l.dE=function(s){var a=[],c=0;for(s=Object.keys(s);c<s.length;c++)a.push(Number(s[c]));return a.sort(function(f,y){return f-y}),a},l.prototype.fG=function(s){var a=this.Do[s],c=l.dE(a)[0],f=a[c],y=f.my().$y;return f=f.my().AK,delete a[c],f&&(y=d.Yl.local().V(y,this.vg,!1,this.Ub),s==0&&y.getType()==33&&(s=new d.de(y.description),y.B()||s.add(y),y=s)),y},l.prototype.next=function(){if(this.Ic&&this.bo==this.zk)return null;for(;!this.qK(););if(this.zk==-1)return null;if(this.jA){for(this.bo++;;){if(this.bo>this.zk||0>this.bo)throw d.i.Qa();if(this.AH[this.bo])break}return this.ya++,this.fG(this.bo)}return this.ya=0,this.bo=this.zk,this.fG(this.zk)},l.prototype.La=function(){return this.ya},l.prototype.qK=function(){if(this.Ic)return!0;var s=null;if(this.Rd!=null&&(s=this.Rd.next())==null&&(this.Ic=!0,this.Rd=null),d.mp.zp(this.Ub),s!=null){var a=s.Db();this.AH[a]=!0,a>=this.zk&&!this.jA&&(this.ND(a,!1,s),a>this.zk&&!this.jA&&this.zW(a))}if(0<this.iq)for(a=0;a<=this.zk;a++)for(;1<this.uq[a]&&(s=this.FO(a)).length!=0;)s=d.Fg.VP(s,this.vg,this.Ub),this.ND(a,!0,s);return this.Ic},l.prototype.FO=function(s){for(var a=[],c=[],f=this.Do[s],y=l.dE(f),v=0;v<y.length;v++){var _=y[v],$=f[_];if(this.Ic||1e4<$.Gr&&1<$.pj.length){for(this.uq[s]-=$.pj.length,this.iq-=$.pj.length;0<$.pj.length;)a.push($.my().$y),$.TV();c.push(_)}}for(v=0;v<c.length;v++)delete f[c[v]];return a},l.prototype.zW=function(s){for(var a=0;a<s;a++)this.Do[a]=[],this.iq-=this.uq[a],this.uq[a]=0},l.prototype.ND=function(s,a,c){var f=new O;if(f.Fz(),f.$y=c,c=l.eS(c),f.Ax=c,c=l.cS(c),s+1>this.Do.length)for(var y=0,v=Math.max(2,s+1);y<v;y++)this.Do.push([]);(y=this.Do[s][c])===void 0&&(y=new x,this.Do[s][c]=y),f.AK=a,y.pN(f),this.uq[s]++,this.iq++,this.zk=Math.max(this.zk,s)},l.cS=function(s){return 0<s?d.O.truncate(Math.log(s)/Math.log(4)+.5):0},l.eS=function(s){var a=s.getType();if(d.aa.xj(a))return s.I();if(a==33)return 1;if(a==197)return 4;if(d.aa.yd(a))return 2;throw d.i.Qa()},l.prototype.qe=function(){this.qK()},l}();d.DL=h}(Y||(Y={})),function(d){var O=function(x){function h(){return x!==null&&x.apply(this,arguments)||this}return Kt(h,x),h.prototype.getType=function(){return 1},h.prototype.V=function(l,s,a,c){return c===void 0?new d.DL(l,s,a):this.gQ(l,s,a,c)},h.prototype.gQ=function(l,s,a,c){return l=new d.Zc([l,s]),this.V(l,a,c).next()},h.local=function(){return h.instance===null&&(h.instance=new h),h.instance},h.instance=null,h}(d.Je);d.Gh=O}(Y||(Y={})),function(d){var O,x;(x=O||(O={}))[x.nextPath=0]="nextPath",x[x.nextSegment=1]="nextSegment",x[x.iterate=2]="iterate",O=function(){function h(l,s,a,c){this.Ts=new d.l,this.GT=l,this.HT=s,this.mq=c,this.uo=-1,this.rl=!1;var f=l.Bb;f!=null&&(f=c?f.zo:f.Fb)!=null&&(this.Ic=!1,this.qa=a,this.Fb=f,this.xw=this.Fb.getIterator(),this.nq=this.rl=!0,this.Xb=0,c?this.uo=s.da():this.sd=s.Ga()),this.rl||(f=s.Bb)!=null&&(f=c?f.zo:f.Fb)!=null&&(this.Ic=!1,this.qa=a,this.Fb=f,this.xw=this.Fb.getIterator(),this.rl=!0,this.nq=!1,this.Xb=0,c?this.uo=l.da():this.sd=l.Ga()),this.rl||(this.ci=c?d.ta.mR(l,s,a,1<=l.om(0),1<=s.om(0)):d.ta.lR(l,s,a))}return h.prototype.next=function(){if(this.rl){if(this.Ic)return!1;for(var l=!0;l;)switch(this.Xb){case 0:l=this.xU();break;case 1:l=this.yU();break;case 2:l=this.Uz();break;default:throw d.i.fa("internal error")}return!this.Ic}return this.ci!=null&&this.ci.next()},h.prototype.nl=function(){return this.rl?this.nq?this.Fb.ja(this.Fs):this.mq?this.uo:this.sd.wb():this.ci.nl(this.ci.Vf)},h.prototype.hl=function(){return this.rl?this.nq?this.mq?this.uo:this.sd.wb():this.Fb.ja(this.Fs):this.ci.hl(this.ci.Af)},h.prototype.uz=function(){if(!this.mq)throw d.i.fa("internal error");return this.rl?this.nq?this.Fb.GF(this.Fs):this.Ts:this.ci.uz(this.ci.Vf)},h.prototype.az=function(){if(!this.mq)throw d.i.fa("internal error");return this.rl?this.nq?this.Ts:this.Fb.GF(this.Fs):this.ci.az(this.ci.Af)},h.prototype.xU=function(){return this.mq?--this.uo==-1?(this.Ic=!0,!1):(this.nq?this.HT.Rj(this.uo,this.Ts):this.GT.Rj(this.uo,this.Ts),this.xw.Xi(this.Ts,this.qa),this.Xb=2,!0):this.sd.$a()?(this.Xb=1,!0):(this.Ic=!0,!1)},h.prototype.yU=function(){if(!this.sd.Ha())return this.Xb=0,!0;var l=this.sd.ha();return this.xw.Uo(l,this.qa),this.Xb=2,!0},h.prototype.Uz=function(){return this.Fs=this.xw.next(),this.Fs==-1&&(this.Xb=this.mq?0:1,!0)},h}(),d.Zl=O}(Y||(Y={})),function(d){(d=d.OL||(d.OL={}))[d.enumClosed=1]="enumClosed",d[d.enumHasNonlinearSegments=2]="enumHasNonlinearSegments",d[d.enumOGCStartPolygon=4]="enumOGCStartPolygon",d[d.enumCalcMask=4]="enumCalcMask"}(Y||(Y={})),function(d){d.QC=function(){function O(){}return O.tb=function(x,h,l,s,a,c,f,y,v){var _=[0,0,0],$=[0,0,0],I=[0,0,0],k=[0,0,0,0],A=new d.ga(0),P=new d.ga(0),D=new d.ga(0);if(f!=null||y!=null||v!=null)if(d.s.ti(h))d.Yg.tb(x,l,s,a,c,f,y,v);else{a=d.F.ba(a),l=d.F.ba(l);var j=d.F.ba(a-l);if(d.s.Y(s,c)&&(d.s.Y(l,a)||d.s.Y(d.s.P(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.Y(s,-c)){if(d.s.Y(d.s.P(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0<s?d.F.ba(3.141592653589793-d.F.ba(a)):d.F.ba(a)),void(v!=null&&(v.u=0<s?d.F.ba(a):d.F.ba(3.141592653589793-d.F.ba(a))));d.s.Y(d.s.P(j),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ah(x,h)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else if(d.s.Y(d.s.P(s),1.570796326794897)||d.s.Y(d.s.P(c),1.570796326794897)||d.s.Y(l,a)||d.s.Y(d.s.P(j),3.141592653589793)||d.s.Cd(s))return void d.Wk.tb(x,h,l,s,a,c,f,y,v);var B=Math.sqrt(1-h);a=d.F.ba(a-l),l=0,d.F.cl(1,h,s,l,0,A,P,D),_[0]=A.u,_[1]=P.u,_[2]=D.u,d.F.cl(1,h,c,a,0,A,P,D),$[0]=A.u,$[1]=P.u,$[2]=D.u,I[0]=0,I[1]=0,I[2]=-1*h*d.F.n(1,h,s)*Math.sin(s),0>a?d.F.Wq(I,$,_,k,0):d.F.Wq(I,_,$,k,0),P=[0,0,0],D=[0,0,0];var q=[0,0,0];_=[0,0,0],A=[0,0,0];var z=Math.acos(k[2]/1),Z=1-h,ee=Math.tan(z),Q=1+ee*ee/Z,le=2*I[2]*ee/Z;for(Z=(-le+(ee=Math.sqrt(le*le-4*Q*(I[2]*I[2]/Z-1))))/(Q*=2),le=(-le-ee)/Q,ee=Math.tan(z),z=(Z+le)/2,I=((Q=ee*Z+I[2])+(ee*le+I[2]))/2,ee=d.F.gp(Z-z,Q-I),Z=I/B*1.570796326794897,le=0;100>le&&(Q=(Q=d.F.w(h,Z))*Q/Math.cos(Z)*(Math.sin(Z)-I*Q/(1-h)),!d.s.Cd(Q));le++)Z-=Q;I=d.F.n(1,h,Z)*Math.cos(Z),ee=1-ee/(I=Math.sqrt((I-z)*(I+z))),ee*=2-ee,Q=d.F.on(P),z=d.F.on(D),Z=d.F.on(q);var se=d.F.St(q,P);le=d.F.St(q,D),d.F.zx(q,P,_),d.F.zx(q,D,A),P=Math.acos(se/(Z*Q)),D=Math.acos(le/(Z*z)),D*=d.s.Mb(1,d.F.St(_,A)),(1.570796326794897<=d.s.P(P)&&1.570796326794897<=d.s.P(D)||3.141592653589793<d.s.P(P-D))&&(P=(3.141592653589793-d.s.P(P))*d.s.Mb(1,P),D=(3.141592653589793-d.s.P(D))*d.s.Mb(1,D)),_=d.F.Qj(ee,D),A=d.F.q(I,ee,d.F.Qj(ee,P)),_=d.F.q(I,ee,_),_=d.s.P(_-A)*x,P=new d.ga(0),D=new d.ga(0),q=k[1]/1,q*=-d.s.Mb(1,j),A=Math.acos(q)*d.s.Mb(1,j),O.rf(x,h,l,s,_,A,P,D),d.s.Y(a,P.u)&&d.s.Y(c,D.u)||(ee=d.F.gp(d.F.ba(a-P.u),c-D.u),O.rf(x,h,l,s,_,d.F.ba(A+3.141592653589793),P,D),(Q=d.F.gp(d.F.ba(a-P.u),c-D.u))<ee&&(A=d.F.ba(A+3.141592653589793))),P=[0,0,0,0],D=[0,0,0,0],ee=[0,0,0],x=[0,0,0],l=[0,0,0],s=[0,0,0],q=[0,0,0],(I=[0,0,0])[0]=0,I[1]=0,I[2]=B,ee[0]=0,ee[1]=0,ee[2]=0,d.F.Wq(ee,I,$,P,0),d.s.Cd(c)?(x[0]=$[0],x[1]=$[1],x[2]=1,l[0]=1*Math.cos(a)-1*Math.sin(a),l[1]=1*Math.sin(a)+1*Math.cos(a)):(h=d.F.n(1,h,c)*Math.cos(c),x[0]=0,x[1]=0,$[2]+=Math.tan(1.570796326794897-d.s.P(c))*h*d.s.Mb(1,c),l[0]=h*Math.cos(a)-h*Math.sin(a),l[1]=h*Math.sin(a)+h*Math.cos(a)),l[2]=$[2],d.F.Wq($,l,x,D,1),d.F.zx(D,P,s),d.F.zx(D,k,q),q=d.F.St(s,q)/(d.F.on(s)*d.F.on(q)),q*=d.s.Mb(1,j),a=Math.acos(q)*-d.s.Mb(1,j),(0<A&&0<a||0>A&&0>a)&&(a=d.F.ba(a+3.141592653589793)),f!=null&&(f.u=_),y!=null&&(y.u=A),v!=null&&(v.u=a)}}},O.rf=function(x,h,l,s,a,c,f,y){var v=[0,0,0],_=[0,0,0],$=[0,0,0],I=[0,0,0],k=[0,0,0],A=[0,0,0],P=[0,0,0],D=[0,0,0,0],j=new d.ga(0),B=new d.ga(0),q=new d.ga(0),z=new d.ga(0),Z=new d.ga(0),ee=new d.ga(0);if(f!=null&&y!=null)if(d.s.ti(h))d.Yg.rf(x,l,s,a,c,f,y);else if(d.s.Cd(a))f!=null&&(f.u=l),y!=null&&(y.u=s);else if(c=d.F.ba(c),0>a&&(a=d.s.P(a),c=d.F.ba(c+3.141592653589793)),l=d.F.ba(l),s=d.F.ba(s),1.570796326794897<d.s.P(s)&&(l=d.F.ba(l+3.141592653589793),s=d.s.Mb(3.141592653589793,s)-s),d.s.Y(d.s.P(s),1.570796326794897)||d.s.Cd(s)||d.s.Cd(c)||d.s.Y(d.s.P(c),3.141592653589793))d.Wk.rf(x,h,l,s,a,c,f,y);else{var Q=Math.sqrt(1-h);for(x=a/x,d.F.cl(1,h,s,0,0,z,Z,ee),v[0]=z.u,v[1]=Z.u,v[2]=Z.u,P[0]=0,P[1]=0,P[2]=-1*h*d.F.n(1,h,s)*Math.sin(s),z=d.F.n(1,h,s),Z=d.F.ba(1.570796326794897-c),ee=Math.sin(Z),a=Math.cos(s),s=Math.sin(s),k[0]=z*a-s*ee,k[1]=Math.cos(Z),k[2]=(1-h)*z*s+a*ee,0>c?d.F.Wq(P,k,v,D,0):d.F.Wq(P,v,k,D,0),v=Math.acos(D[2]/1),D=Math.atan2(-D[1],-D[0]),s=1-h,Z=1+(k=Math.tan(v))*k/s,s=(-(z=2*P[2]*k/s)+(k=Math.sqrt(z*z-4*Z*(P[2]*P[2]/s-1))))/(Z*=2),z=(-z-k)/Z,k=Math.tan(v),v=(s+z)/2,P=((Z=k*s+P[2])+(k*z+P[2]))/2,k=d.F.gp(s-v,Z-P),Q=P/Q*1.570796326794897,s=0;100>s&&(z=(z=d.F.w(h,Q))*z/Math.cos(Q)*(Math.sin(Q)-P*z/(1-h)),!d.s.Cd(z));s++)Q-=z;Q=d.F.n(1,h,Q)*Math.cos(Q),P=1-k/(Q=Math.sqrt((Q-v)*(Q+v))),P*=2-P,A=Math.acos(d.F.St(A,_)/(d.F.on(A)*d.F.on(_))),A*=d.s.Mb(1,_[0]),c=(d.F.q(Q,P,d.F.Qj(P,A))+x*d.s.Mb(1,c))/d.F.Ah(Q,P),c=d.F.ba(1.570796326794897*c),c=d.F.Rq(P,c),d.F.n(Q,P,c),k=d.F.ba(D+l),l=Math.cos(k),c=Math.sin(k),$[0]=I[0]*l+I[1]*-c,$[1]=I[0]*c+I[1]*l,$[2]=I[2],d.F.jO(h,$[0],$[1],$[2],q,B,j),f!=null&&(f.u=B.u),y!=null&&(y.u=q.u)}},O}()}(Y||(Y={})),function(d){var O=function(){function a(c){this.Ya=null,this.wt=new d.h,this.xt=new d.h,this.g=c}return a.prototype.compare=function(c,f,y){return this.g.Gc(f,this.wt),this.g.Gc(c.ja(y),this.xt),this.wt.compare(this.xt)},a}(),x=function(){function a(c){this.Bf=new d.h,this.Dk=new d.h,this.g=c}return a.prototype.Dh=function(c){this.Bf.L(c)},a.prototype.compare=function(c,f){return this.g.Gc(c.ja(f),this.Dk),this.Bf.compare(this.Dk)},a}(),h=function(a){function c(f){var y=a.call(this,f.g,f.qa,!1)||this;return y.ib=f,y}return Kt(c,a),c.prototype.compare=function(f,y,v){if(this.rg)return-1;var _=this.ib.Qd.Jn(this.ib.Rh(y));f=f.ja(v);var $=this.ib.Qd.Jn(this.ib.Rh(f));return this.Dm=v,this.RE(y,_,f,$)},c}(d.UC),l=function(a){function c(f){var y=a.call(this,f.g,f.qa)||this;return y.ib=f,y}return Kt(c,a),c.prototype.compare=function(f,y){return this.rg?-1:(f=this.ib.Qd.Jn(this.ib.Rh(f.ja(y))),this.Dm=y,this.SE(y,f))},c}(d.aM),s=function(){function a(){this.Mc=this.df=this.jo=this.Qd=this.lh=this.zd=this.hb=this.g=null,this.Ng=!1,this.vh=this.Nm=this.ie=this.Gk=this.nh=this.Ak=this.Ff=this.$d=null,this.xh=this.Jq=this.UA=this.qa=0,this.Xv=this.Wn=!1,this.yo=new d.h,this.Pi=new d.h,this.hb=new d.$c(8),this.zd=new d.$c(5),this.lh=new d.au,this.Qd=new d.au,this.Ng=!1,this.vh=new d.h,this.vh.ma(0,0),this.qa=0,this.xh=-1,this.Wn=!1,this.g=null,this.df=new d.Yj,this.Mc=new d.Yj,this.nh=new d.ia(0),this.Gk=new d.TC,this.Ff=new d.ia(0),this.Ak=new d.ia(0),this.jo=new d.Sa}return a.prototype.PX=function(c,f){var y=new d.Dd;return y.$B(),c.Oc(y),this.er(c),this.Wn=!1,this.qa=f,this.UA=f*f,f=this.jC(),c.Oc(y),f||(this.qQ(),f||this.jC()),this.xh!=-1&&(this.g.Td(this.xh),this.xh=-1),this.g=null,this.Wn},a.prototype.TX=function(c,f){this.er(c),this.Wn=!1,this.qa=f,this.UA=f*f,this.Ng=!1,this.jC(),this.Ng||(this.Ng=c.Gp(f,!0,!1)==1),this.xh!=-1&&(this.g.Td(this.xh),this.xh=-1),this.g=null},a.prototype.pg=function(c,f){return this.hb.T(c,0+f)},a.prototype.LB=function(c,f,y){this.hb.S(c,0+f,y)},a.prototype.Rh=function(c){return this.hb.T(c,2)},a.prototype.ZW=function(c,f){this.hb.S(c,2,f)},a.prototype.RF=function(c,f){return this.hb.T(c,3+f)},a.prototype.Pp=function(c){return this.hb.T(c,7)},a.prototype.Pl=function(c,f){this.hb.S(c,7,f)},a.prototype.Rp=function(c,f){return this.hb.T(c,3+this.Op(c,f))},a.prototype.fr=function(c,f,y){this.hb.S(c,3+this.Op(c,f),y)},a.prototype.NR=function(c,f){return this.hb.T(c,5+this.Op(c,f))},a.prototype.hr=function(c,f,y){this.hb.S(c,5+this.Op(c,f),y)},a.prototype.Sr=function(c){return this.zd.T(c,0)},a.prototype.UW=function(c,f){this.zd.S(c,0,f)},a.prototype.ez=function(c){return this.zd.T(c,4)},a.prototype.cr=function(c,f){this.zd.S(c,4,f)},a.prototype.il=function(c){return this.zd.T(c,1)},a.prototype.ln=function(c,f){this.zd.S(c,1,f)},a.prototype.dz=function(c){return this.zd.T(c,3)},a.prototype.Et=function(c,f){this.zd.S(c,3,f)},a.prototype.Ym=function(c){var f=this.zd.Ce(),y=this.lh.Ph();return this.UW(f,y),c!=-1?(this.lh.addElement(y,c),this.g.Ra(c,this.xh,f),this.cr(f,this.g.Ua(c))):this.cr(f,-1),f},a.prototype.HP=function(c){this.zd.jd(c)},a.prototype.LD=function(c,f){this.lh.addElement(this.Sr(c),f),this.g.Ra(f,this.xh,c)},a.prototype.nt=function(c){var f=this.hb.Ce(),y=this.Qd.Ph();return this.ZW(f,y),c!=-1&&this.Qd.addElement(y,c),f},a.prototype.MD=function(c,f){this.Qd.addElement(this.Rh(c),f)},a.prototype.Uu=function(c){this.hb.jd(c),0<=(c=this.nh.lF(c))&&this.nh.SV(c)},a.prototype.hj=function(c,f){if(this.pg(c,0)==-1)this.LB(c,0,f);else{if(this.pg(c,1)!=-1)throw d.i.Qa();this.LB(c,1,f)}this.ky(c,f)},a.prototype.ky=function(c,f){var y=this.il(f);if(y!=-1){var v=this.Rp(y,f);this.hr(v,f,c),this.fr(c,f,v),this.fr(y,f,c),this.hr(c,f,y)}else this.hr(c,f,c),this.fr(c,f,c),this.ln(f,c)},a.prototype.Op=function(c,f){return this.pg(c,0)==f?0:1},a.prototype.Xm=function(c,f){var y,v=this.dz(f);if(v!=-1&&(this.df.vd(v,-1),this.Et(f,-1)),(v=this.il(f))!=-1){var _=y=v;do{var $=!1,I=this.Op(y,f),k=this.RF(y,I);if(this.pg(y,I+1&1)==c){if(this.Xu(y),this.Qd.bh(this.Rh(y)),this.Uu(y),y==k){v=-1;break}v==y&&(v=this.il(f),_=k,$=!0)}y=k}while(y!=_||$);if(v!=-1){do I=this.Op(y,f),k=this.RF(y,I),this.LB(y,I,c),y=k;while(y!=_);(y=this.il(c))!=-1?(_=this.Rp(y,c),$=this.Rp(v,c),_==y?(this.ln(c,v),this.ky(y,c),this.ln(c,y)):$==v&&this.ky(v,c),this.fr(v,c,_),this.hr(_,c,v),this.fr(y,c,$),this.hr($,c,y)):this.ln(c,v)}}for(v=this.Sr(c),y=this.Sr(f),_=this.lh.rc(y);_!=-1;_=this.lh.lb(_))this.g.Ra(this.lh.ja(_),this.xh,c);this.lh.Hy(v,y),this.HP(f)},a.prototype.UT=function(c,f){var y=this.pg(c,0),v=this.pg(c,1),_=this.pg(f,0),$=this.pg(f,1);this.Qd.Hy(this.Rh(c),this.Rh(f)),f==this.il(y)&&this.ln(y,c),f==this.il(v)&&this.ln(v,c),this.Xu(f),this.Uu(f),y==_&&v==$||v==_&&y==$||(this.Hn(y,this.yo),this.Hn(_,this.Pi),this.yo.qb(this.Pi)?(y!=_&&this.Xm(y,_),v!=$&&this.Xm(v,$)):(v!=_&&this.Xm(v,_),y!=$&&this.Xm(y,$)))},a.prototype.Xu=function(c){var f=this.pg(c,1);this.dF(c,this.pg(c,0)),this.dF(c,f)},a.prototype.dF=function(c,f){var y=this.Rp(c,f),v=this.NR(c,f),_=this.il(f);y!=c?(this.fr(v,f,y),this.hr(y,f,v),_==c&&this.ln(f,y)):this.ln(f,-1)},a.prototype.WD=function(c,f,y){var v=this.Qd.rc(c),_=this.Qd.ja(v);c=this.Le(_);var $=this.Le(this.g.U(_));for(this.g.jr(_,f,y,!0),v=this.Qd.lb(v);v!=-1;v=this.Qd.lb(v)){_=this.Qd.ja(v);var I=this.Le(_)==c;this.g.jr(_,f,y,I)}v=f.Vp(y,0).ac(),f=f.Vp(y,f.ol(y)-1).wc(),this.BK(c,v),this.BK($,f)},a.prototype.ZE=function(c,f,y){var v=this.Rh(c),_=this.pg(c,0),$=this.pg(c,1),I=this.nt(-1);for(this.nh.add(I),this.Pl(I,-3),this.Ff.add(I),this.hj(I,_),c=1,f=f.ol(y);c<f;c++)y=this.Ym(-1),this.Ak.add(y),this.Ff.add(y),this.hj(I,y),I=this.nt(-1),this.nh.add(I),this.Pl(I,-3),this.Ff.add(I),this.hj(I,y);for(this.hj(I,$),v=this.Qd.rc(v);v!=-1;v=this.Qd.lb(v))if($=this.Qd.ja(v),this.Le($)==_){c=0;do 0<c&&(I=this.Ff.get(c-1),this.LD(I,$),this.ez(I)==-1&&this.cr(I,this.g.Ua($))),I=this.Ff.get(c),c+=2,this.MD(I,$),$=this.g.U($);while(c<this.Ff.size)}else{c=this.Ff.size-1;do c<this.Ff.size-2&&(I=this.Ff.get(c+1),this.LD(I,$),0>this.ez(I)&&this.cr(I,this.g.Ua($))),I=this.Ff.get(c),c-=2,this.MD(I,$),$=this.g.U($);while(0<=c)}this.Ff.clear(!1)},a.prototype.Le=function(c){return this.g.Pa(c,this.xh)},a.prototype.TI=function(c,f,y){var v=this.pg(f,0),_=new d.h;this.Hn(v,_);var $=new d.h,I=this.pg(f,1);this.Hn(I,$);var k=y.ol(c),A=y.Vp(c,0),P=new d.h;if(A.Yp(P),!_.qb(P)){if(!this.Ng){var D=_.compare(this.vh);0>D*(P=P.compare(this.vh))&&(this.Ng=!0)}this.vF(v,this.Ff),this.Ak.add(v)}for(!this.Ng&&1<k&&(D=_.compare($),A=A.wc(),(_.compare(A)!=D||A.compare($)!=D||0>A.compare(this.vh))&&(this.Ng=!0)),c=(A=y.Vp(c,k-1)).wc(),$.qb(c)||(this.Ng||0>(D=$.compare(this.vh))*(P=c.compare(this.vh))&&(this.Ng=!0),this.vF(I,this.Ff),this.Ak.add(I)),this.Ff.add(f),$=0,I=this.Ff.size;$<I;$++)c=this.Ff.get($),y=this.Pp(c),d.$c.LG(y)&&(this.Mc.vd(y,-1),this.Pl(c,-1)),c!=f&&this.Pp(c)!=-3&&(this.nh.add(c),this.Pl(c,-3));this.Ff.clear(!1)},a.prototype.lO=function(c,f){this.$d.compare(this.Mc,this.Mc.ja(c),f),this.$d.rg&&(this.$d.Kr(),this.oF(c,f))},a.prototype.oF=function(c,f){this.Wn=!0,c=this.Mc.ja(c),f=this.Mc.ja(f);var y=this.Qd.Jn(this.Rh(c)),v=this.Qd.Jn(this.Rh(f)),_=this.g.bc(y);_==null&&(this.ie==null&&(this.ie=new d.yb),this.g.ed(y,this.ie),_=this.ie),(y=this.g.bc(v))==null&&(this.Nm==null&&(this.Nm=new d.yb),this.g.ed(v,this.Nm),y=this.Nm),this.Gk.Oo(_),this.Gk.Oo(y),this.Gk.Ea(this.qa,!0)&&(this.Ng=!0),this.hK(c,f,-1,this.Gk),this.Gk.clear()},a.prototype.GQ=function(c,f){this.Wn=!0,f=this.Mc.ja(f);var y=this.Qd.Jn(this.Rh(f)),v=this.g.bc(y);v==null&&(this.ie==null&&(this.ie=new d.yb),this.g.ed(y,this.ie),v=this.ie),y=this.BF(c),this.Gk.Oo(v),this.g.Vi(y,this.jo),this.Gk.Kz(this.qa,this.jo,!0),this.hK(f,-1,c,this.Gk),this.Gk.clear()},a.prototype.xS=function(){if(this.nh.size!=0)for(;this.nh.size!=0;){if(this.nh.size>Math.max(100,this.g.fd)){this.nh.clear(!1),this.Ng=!0;break}var c=this.nh.Fc();this.nh.If(),this.Pl(c,-1),this.WS(c)!=-1&&this.wS(c),this.Vn=!1}},a.prototype.wS=function(c){if(this.Vn){var f=this.Mc.zu(this.MH,this.GH,c,!0);this.Vn=!1}else f=this.Mc.KD(c);f==-1?this.UT(this.Mc.ja(this.Mc.FF()),c):(this.Pl(c,f),this.$d.rg&&(this.$d.Kr(),this.oF(this.$d.Dm,f)))},a.prototype.WS=function(c){var f=this.pg(c,0);if(c=this.pg(c,1),this.Hn(f,this.yo),this.Hn(c,this.Pi),d.h.yc(this.yo,this.Pi)<=this.UA)return this.Ng=!0,-1;var y=this.yo.compare(this.vh),v=this.Pi.compare(this.vh);return 0>=y&&0<v?c:0>=v&&0<y?f:-1},a.prototype.oQ=function(){var c=new d.ia(0);c.Jb(this.g.fd);for(var f=this.g.Yq(),y=f.next();y!=-1;y=f.next())this.g.Pa(y,this.xh)!=-1&&c.add(y);this.g.nx(c,c.size),this.pQ(c)},a.prototype.pQ=function(c){this.df.clear(),this.df.De(c.size),this.df.Vo(new O(this.g));var f=new d.h;f.Rc();for(var y=-1,v=new d.h,_=0,$=c.size;_<$;_++){var I=c.get(_);this.g.Gc(I,v),v.qb(f)?(I=this.g.Pa(I,this.xh),this.Xm(y,I)):(y=this.Le(I),this.g.Gc(I,f),I=this.df.xn(I),this.Et(y,I))}},a.prototype.qQ=function(){var c=new d.ia(0);c.Jb(this.g.fd);for(var f=this.df.rc(-1);f!=-1;f=this.df.lb(f))c.add(this.df.ja(f));this.df.clear(),this.g.nx(c,c.size),f=0;for(var y=c.size;f<y;f++){var v=c.get(f),_=this.Le(v);v=this.df.xn(v),this.Et(_,v)}},a.prototype.vF=function(c,f){var y=this.il(c);if(y!=-1){var v=y;do d.$c.LG(this.Pp(v))&&f.add(v),v=this.Rp(v,c);while(v!=y)}},a.prototype.BK=function(c,f){for(c=this.lh.rc(this.Sr(c));c!=-1;c=this.lh.lb(c))this.g.mf(this.lh.ja(c),f)},a.prototype.hK=function(c,f,y,v){this.Xu(c),f!=-1&&this.Xu(f),this.TI(0,c,v),f!=-1&&this.TI(1,f,v),y!=-1&&(v.Bf.D(this.yo),this.Hn(y,this.Pi),this.Pi.qb(this.yo)||this.Ak.add(y)),y=0;for(var _=this.Ak.size;y<_;y++){var $=this.Ak.get(y),I=this.dz($);I!=-1&&(this.df.vd(I,-1),this.Et($,-1))}for(y=this.Rh(c),_=f!=-1?this.Rh(f):-1,this.WD(y,v,0),f!=-1&&this.WD(_,v,1),this.ZE(c,v,0),f!=-1&&this.ZE(f,v,1),this.Qd.bh(y),this.Uu(c),f!=-1&&(this.Qd.bh(_),this.Uu(f)),y=0,_=this.Ak.size;y<_;y++)($=this.Ak.get(y))==this.Jq&&(this.Xv=!0),(I=this.dz($))==-1&&((I=this.df.KD(this.BF($)))==-1?(c=this.Le(this.df.ja(this.df.FF())),this.Xm(c,$)):this.Et($,I));this.Ak.clear(!1)},a.prototype.Hn=function(c,f){this.g.dG(this.ez(c),f)},a.prototype.BF=function(c){return this.lh.Jn(this.Sr(c))},a.prototype.jC=function(){this.Xv=!1,this.Jq=-1,this.$d==null&&(this.Mc.Rv=!1,this.$d=new h(this),this.Mc.Zn=this.$d);var c=new d.ia(0),f=null,y=null;this.GH=this.MH=-1,this.Vn=!1;for(var v=this.df.rc(-1);v!=-1;){this.Vn=!1;var _=this.df.ja(v);this.Jq=this.Le(_),this.g.Gc(_,this.vh),this.$d.$J(this.vh.y,this.vh.x);var $=this.il(this.Jq),I=$==-1;if(!I){_=$;do{var k=this.Pp(_);k==-1?(this.nh.add(_),this.Pl(_,-3)):k!=-3&&c.add(k),_=this.Rp(_,this.Jq)}while(_!=$)}if(0<c.size){for(this.Vn=c.size==1&&this.nh.size==1,I=0,$=c.size;I<$;I++)_=this.Mc.ja(c.get(I)),this.Pl(_,-2);var A=-2,P=-2;for(I=0,$=c.size;I<$;I++){if(k=c.get(I),A==-2){var D=this.Mc.we(k);D!=-1?(_=this.Mc.ja(D),(_=this.Pp(_))!=-2&&(A=D)):A=-1}if(P==-2&&((k=this.Mc.lb(k))!=-1?(_=this.Mc.ja(k),(_=this.Pp(_))!=-2&&(P=k)):P=-1),A!=-2&&P!=-2)break}for(I=0,$=c.size;I<$;I++)k=c.get(I),_=this.Mc.ja(k),this.Mc.vd(k,-1),this.Pl(_,-1);c.clear(!1),this.MH=A!=-1?A:-1,this.GH=P!=-1?P:-1,A!=-1&&P!=-1?this.Vn||this.lO(A,P):A==-1&&P==-1&&(this.Vn=!1)}else I&&(f==null&&(f=new l(this)),f.Dh(this.vh),this.Mc.uJ(f),f.rg&&(f.Kr(),this.GQ(this.Jq,f.Dm)));this.xS(),this.Xv?(this.Xv=!1,y==null&&(y=new x(this.g)),y.Dh(this.vh),v=this.df.uJ(y)):v=this.df.lb(v)}return this.Wn},a.prototype.er=function(c){for(this.g=c,this.xh=this.g.Gd(),this.hb.De(c.fd+32),this.zd.De(c.fd),this.lh.At(c.fd),this.lh.fn(c.fd),this.Qd.At(c.fd+32),this.Qd.fn(c.fd+32),c=this.g.ld;c!=-1;c=this.g.ue(c))if(d.aa.Hc(this.g.ic(c)))for(k=this.g.Ob(c);k!=-1;k=this.g.Rb(k)){var f=this.g.Ja(k),y=this.g.Xa(k),v=this.Ym(y),_=this.nt(y);for(this.hj(_,v),A=this.g.U(y),y=0,f-=2;y<f;y++){var $=this.g.U(A),I=this.Ym(A);this.hj(_,I),_=this.nt(A),this.hj(_,I),A=$}this.g.dc(k)?(I=this.Ym(A),this.hj(_,I),_=this.nt(A),this.hj(_,I),this.hj(_,v)):(I=this.Ym(A),this.hj(_,I))}else for(var k=this.g.Ob(c);k!=-1;k=this.g.Rb(k)){var A=this.g.Xa(k);for(v=0,f=this.g.Ja(k);v<f;v++)this.Ym(A),A=this.g.U(A)}this.oQ()},a}();d.RC=s}(Y||(Y={})),function(d){var O=function(x){function h(l,s,a){var c=x.call(this)||this;if(l!==void 0)if(a!==void 0){c.description=d.ee.og();var f=new d.Nd;f.K(l,s,a),c.dC(f)}else if(s!==void 0)c.description=d.ee.og(),c.Cb(l,s);else if(l instanceof d.ra)c.description=l;else if(l instanceof d.h)c.description=d.ee.og(),c.Cb(l);else{if(!(l instanceof h))throw d.i.N();c.description=l.description,c.Cb(l.Lg(),l.ih()),l.ka!==null&&(c.ka=l.ka.slice(0))}else c.description=d.ee.og();return c}return Kt(h,x),h.prototype.D=function(l){if(l===void 0){if(this.Ac())throw d.i.fa("This operation should not be performed on an empty geometry.");return(l=new d.h).ma(this.ka[0],this.ka[1]),l}if(this.Ac())throw d.i.fa("This operation should not be performed on an empty geometry.");l.ma(this.ka[0],this.ka[1])},h.prototype.Cb=function(l,s){typeof l=="number"?(this.vc(),this.ka==null&&this.un(),this.ka[0]=l,this.ka[1]=s):(this.vc(),this.Cb(l.x,l.y))},h.prototype.Cz=function(){if(this.Ac())throw d.i.fa("This operation should not be performed on an empty geometry.");var l=new d.Nd;return l.x=this.ka[0],l.y=this.ka[1],l.z=this.description.iG()?this.ka[2]:d.ra.se(1),l},h.prototype.dC=function(l){this.vc();var s=this.hasAttribute(1);s||d.ra.DG(1,l.z)||(this.re(1),s=!0),this.ka==null&&this.un(),this.ka[0]=l.x,this.ka[1]=l.y,s&&(this.ka[2]=l.z)},h.prototype.Lg=function(){if(this.Ac())throw d.i.fa("This operation should not be performed on an empty geometry.");return this.ka[0]},h.prototype.cC=function(l){this.setAttribute(0,0,l)},h.prototype.ih=function(){if(this.Ac())throw d.i.fa("This operation should not be performed on an empty geometry.");return this.ka[1]},h.prototype.aK=function(l){this.setAttribute(0,1,l)},h.prototype.bS=function(){return this.Uc(1,0)},h.prototype.wX=function(l){this.setAttribute(1,0,l)},h.prototype.zR=function(){return this.Uc(2,0)},h.prototype.hX=function(l){this.setAttribute(2,0,l)},h.prototype.Ec=function(){return this.yF(3,0)},h.prototype.LJ=function(l){this.setAttribute(3,0,l)},h.prototype.Uc=function(l,s){var a=this.description.Pf(l);return 0<=a?this.ka[this.description.$j(a)+s]:d.ra.se(l)},h.prototype.yF=function(l,s){var a=this.description.Pf(l);return 0<=a?this.ka[this.description.$j(a)+s]:d.ra.se(l)},h.prototype.setAttribute=function(l,s,a){this.vc();var c=this.description.Pf(l);0>c&&(this.re(l),c=this.description.Pf(l)),this.ka==null&&this.un(),this.ka[this.description.$j(c)+s]=a},h.prototype.getType=function(){return 33},h.prototype.Db=function(){return 0},h.prototype.Oa=function(){this.vc(),this.ka!=null&&(this.ka[0]=NaN,this.ka[1]=NaN)},h.prototype.sn=function(l){if(this.ka!=null){for(var s=d.ee.Iw(l,this.description),a=[],c=0,f=0,y=l.Aa;f<y;f++){var v=l.kd(f),_=d.ra.Va(v);if(s[f]==-1){var $=d.ra.se(v);for(v=0;v<_;v++)a[c]=$,c++}else for($=this.description.$j(s[f]),v=0;v<_;v++)a[c]=this.ka[$],c++,$++}this.ka=a}this.description=l},h.prototype.un=function(){this.lJ(this.description.Ae.length),h.cE(this.description.Ae,this.ka,this.description.Ae.length),this.ka[0]=NaN,this.ka[1]=NaN},h.prototype.Oc=function(l){if(l instanceof d.Dd){if(!this.Ac()){var s=this.D();l.Eh(s,s),this.Cb(s)}}else this.Ac()||(this.re(1),s=this.Cz(),this.dC(l.fp(s)))},h.prototype.copyTo=function(l){if(l.getType()!=33)throw d.i.N();l.vc(),this.ka==null?(l.Oa(),l.ka=null,l.Nf(this.description)):(l.Nf(this.description),l.lJ(this.description.Ae.length),h.cE(this.ka,l.ka,this.description.Ae.length))},h.prototype.Ia=function(){return new h(this.description)},h.prototype.B=function(){return this.Ac()},h.prototype.Ac=function(){return this.ka==null||isNaN(this.ka[0])||isNaN(this.ka[1])},h.prototype.bn=function(l){l.Oa(),this.description!=l.description&&l.Nf(this.description),l.Zb(this)},h.prototype.A=function(l){this.Ac()?l.Oa():(l.v=this.ka[0],l.G=this.ka[1],l.C=this.ka[0],l.H=this.ka[1])},h.prototype.Qo=function(l){if(this.Ac())l.Oa();else{var s=this.Cz();l.v=s.x,l.G=s.y,l.Ye=s.z,l.C=s.x,l.H=s.y,l.Bg=s.z}},h.prototype.Tg=function(l,s){var a=new d.Nc;return this.Ac()?(a.Oa(),a):(l=this.Uc(l,s),a.oa=l,a.va=l,a)},h.prototype.lJ=function(l){if(this.ka==null)this.ka=d.O.lg(l);else if(this.ka.length<l){for(var s=this.ka.slice(0),a=this.ka.length;a<l;a++)s[a]=0;this.ka=s}},h.cE=function(l,s,a){if(0<a)for(a=0;a<l.length;a++)s[a]=l[a]},h.prototype.Nb=function(l){if(l==this)return!0;if(!(l instanceof h)||this.description!=l.description)return!1;if(this.Ac())return!!l.Ac();for(var s=0,a=this.description.Ae.length;s<a;s++)if(this.ka[s]!=l.ka[s])return!1;return!0},h.prototype.cc=function(){var l=this.description.cc();if(!this.Ac())for(var s=0,a=this.description.Ae.length;s<a;s++){var c=this.ka[s];c=d.O.truncate(c^c>>>32),l=d.O.Th(c,l)}return l},h.prototype.mg=function(){return null},h}(d.aa);d.Sa=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s){h!==void 0&&(this.x=h,this.y=l,this.z=s)}return x.construct=function(h,l,s){var a=new x;return a.x=h,a.y=l,a.z=s,a},x.prototype.K=function(h,l,s){this.x=h,this.y=l,this.z=s},x.prototype.lx=function(){this.z=this.y=this.x=0},x.prototype.normalize=function(){var h=this.length();h==0&&(this.x/=h,this.y/=h,this.z/=h)},x.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},x.prototype.sub=function(h){return new x(this.x-h.x,this.y-h.y,this.z-h.z)},x.prototype.Ag=function(h){new x(this.x*h,this.y*h,this.z*h)},x.prototype.Qh=function(h){return this.x*h.x+this.y*h.y+this.z*h.z},x}();d.Nd=O}(Y||(Y={})),function(d){var O=function(){function x(h,l,s){this.Gw=this.DA=null,this.Xf=l,this.FT=l.y-s,this.ET=l.y+s,this.Ew=0,this.dA=h,this.qa=s,this.RT=s*s,this.eA=s!=0,this.Lv=!1}return x.prototype.result=function(){return this.Ew!=0?1:0},x.prototype.ZM=function(h){return h=h.hc(h.fe(this.Xf,!1)),d.h.yc(h,this.Xf)<=this.RT},x.prototype.fF=function(h){if(!this.eA&&(this.dA&&this.Xf.qb(h.ac())||this.Xf.qb(h.wc())))this.Lv=!0;else if(h.na==this.Xf.y&&h.na==h.la){if(this.dA&&!this.eA){var l=Math.max(h.sa,h.pa);this.Xf.x>Math.min(h.sa,h.pa)&&this.Xf.x<l&&(this.Lv=!0)}}else{var s=!1;if(l=Math.max(h.sa,h.pa),this.Xf.x>l?s=!0:this.Xf.x>=Math.min(h.sa,h.pa)&&(s=0<h.cq(!0,this.Xf.y,this.Gw,null)&&this.Gw[0]<=this.Xf.x),s){if(this.Xf.y==h.ac().y){if(this.Xf.y<h.wc().y)return}else if(this.Xf.y==h.wc().y&&this.Xf.y<h.ac().y)return;this.Ew=this.dA?1^this.Ew:this.Ew+(h.ac().y>h.wc().y?1:-1)}}},x.prototype.SI=function(h){var l=h.Tg(0,1);if(l.oa>this.ET||l.va<this.FT)return!1;if(this.eA&&this.ZM(h))return!0;if(l.oa>this.Xf.y||l.va<this.Xf.y)return!1;if(this.DA==null&&(this.DA=[null,null,null,null,null]),this.Gw==null&&(this.Gw=[0,0,0]),0<(l=h.eG()))for(h=0;h<l;h++){var s=this.DA[h].get();if(this.fF(s),this.Lv)return!0}else if(this.fF(h),this.Lv)return!0;return!1},x.PM=function(h,l,s){for(l=new x(h.In()==0,l,s),h=h.Ga();h.$a();)for(;h.Ha();)if(s=h.ha(),l.SI(s))return-1;return l.result()},x.QM=function(h,l,s,a){var c=new d.l;h.xc(c),c.W(a,a);var f=new x(h.In()==0,s,a);h=h.Ga();var y=new d.l;for(y.K(c),y.C=s.x+a,y.G=s.y-a,y.H=s.y+a,a=(s=l.MF(y,a)).next();a!=-1;a=s.next())if(h.Vb(l.ja(a)),h.Ha()&&(a=h.ha(),f.SI(a)))return-1;return f.result()},x.wm=function(h,l,s){if(h.B())return 0;var a=new d.l;if(h.xc(a),a.W(s,s),!a.contains(l))return 0;if((a=h.Bb)!=null){var c=a.Fk;if(c!=null){if((c=c.So(l.x,l.y))==1)return 1;if(c==0)return 0}if((a=a.Fb)!=null)return x.QM(h,a,l,s)}return x.PM(h,l,s)},x.bT=function(h,l,s){return l.B()?0:x.wm(h,l.D(),s)},x.Ml=function(h,l){return!(16>(h=h.I()))&&2*h+Math.log(h)/Math.log(2)*l<1*h*l},x}();d.Dg=O}(Y||(Y={})),function(d){var O=function(x){function h(l){return x.call(this,!0,l)||this}return Kt(h,x),h.prototype.Ia=function(){return new h(this.description)},h.prototype.Db=function(){return 2},h.prototype.getType=function(){return 1736},h.prototype.xG=function(l,s,a){this.JS(l,s,a)},h.prototype.qR=function(){this.FR()},h}(d.Vk);d.Da=O}(Y||(Y={})),function(d){(function(O){O[O.PiPOutside=0]="PiPOutside",O[O.PiPInside=1]="PiPInside",O[O.PiPBoundary=2]="PiPBoundary"})(d.RL||(d.RL={})),d.hd=function(){function O(){}return O.KG=function(x,h,l){return(x=d.Dg.bT(x,h,l))==0?0:x==1?1:2},O.Yd=function(x,h,l){return(x=d.Dg.wm(x,h,l))==0?0:x==1?1:2},O.WX=function(x,h,l,s,a){if(h.length<l||a.length<l)throw d.i.N();for(var c=0;c<l;c++)a[c]=O.Yd(x,h[c],s)},O.sK=function(x,h,l,s,a){if(x.getType()==1736)O.WX(x,h,l,s,a);else{if(x.getType()!=197)throw d.i.fa("invalid_call");var c=new d.l;x.A(c),O.$M(c,h,l,s,a)}},O.$M=function(x,h,l,s,a){if(h.length<l||a.length<l)throw d.i.N();if(x.B())for(s=0;s<l;s++)a[s]=0;else for(x.W(.5*-s,.5*-s),x.W(.5*s,.5*s),s=0;s<l;s++)x.contains(h[s])?a[s]=1:x.contains(h[s])?a[s]=2:a[s]=0},O.YX=function(x,h,l,s,a){for(var c=0;c<l;c++)a[c]=x.qs(h[c],s)?2:0},O.XX=function(x,h,l,s,a){var c=x.Bb,f=null;c!=null&&(f=c.Fk),c=l;for(var y=0;y<l;y++)if(a[y]=1,f!=null){var v=h[y];f.So(v.x,v.y)==0&&(a[y]=0,c--)}if(c!=0)for(x=x.Ga();x.$a()&&c!=0;)for(;x.Ha()&&c!=0;)for(f=x.ha(),y=0;y<l&&c!=0;y++)a[y]==1&&f.qs(h[y],s)&&(a[y]=2,c--);for(y=0;y<l;y++)a[y]==1&&(a[y]=0)},O.tK=function(x,h,l,s,a){var c=x.getType();if(c==1607)O.XX(x,h,l,s,a);else{if(!d.aa.yd(c))throw d.i.fa("Invalid call.");O.YX(x,h,l,s,a)}},O}()}(Y||(Y={})),function(d){var O=function(x){function h(l,s){if(arguments.length==2){var a=x.call(this,!1,l.description)||this;a.nf(l),a.lineTo(s)}else a=x.call(this,!1,l)||this;return a}return Kt(h,x),h.prototype.Ia=function(){return new h(this.description)},h.prototype.Db=function(){return 1},h.prototype.getType=function(){return 1607},h.prototype.xG=function(l,s,a){this.KS(l,s,a)},h}(d.Vk);d.Ta=O}(Y||(Y={})),function(d){var O=function(){function x(){}return x.prototype.progress=function(){return!0},x.zp=function(h){if(h!=null&&!h.progress(-1,-1))throw d.i.WC()},x}();d.mp=O}(Y||(Y={})),function(d){var O;(O=d.PK||(d.PK={}))[O.clipWithInputHorizon=1]="clipWithInputHorizon",O[O.clipWithOutputHorizon=2]="clipWithOutputHorizon";var x=function(){function s(){this.Kg=3,this.Vu=this.Jr=NaN}return s.prototype.PW=function(a){this.QB(1,a)},s.prototype.QW=function(a){this.QB(2,a)},s.prototype.hS=function(){return this.hs(1)},s.prototype.iS=function(){return this.hs(2)},s.prototype.QB=function(a,c){this.Kg=c?this.Kg|a:this.Kg&~a},s.prototype.hs=function(a){return!!(this.Kg&a)},s.prototype.Of=function(){var a=new s;return a.Jr=this.Jr,a.Vu=this.Vu,a.Kg=this.Kg,a},s}();d.yC=x,function(s){s[s.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon",s[s.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"}(d.QK||(d.QK={}));var h=function(){function s(){this.Kg=0}return s.prototype.QB=function(a,c){this.Kg=c?this.Kg|a:this.Kg&~a},s.prototype.hs=function(a){return!!(this.Kg&a)},s.jg=function(a){var c=new s;return c.Kg=a.Kg,c},s.prototype.mM=function(a){this.Kg=a.Kg},s}();d.AY=h;var l=function(){function s(a,c,f){this.ef=a,this.Yf=c,this.Uf=new d.l,this.Uf.K(f),this.AT=a.cc()+c.cc()+this.Uf.cc().toString()}return s.prototype.cc=function(){return this.AT},s.prototype.Nb=function(a){return this==a||this.ef.Nb(a.ef)&&this.Yf.Nb(a.Yf)&&this.Uf.Nb(a.Uf)},s}();d.FY=l,l=function(){function s(){this.Yf=this.ef=null,this.rH=new x,this.sH=new h,this.ww=this.Wf=null,this.mw=this.Tn=!0}return s.Nr=function(a,c,f,y){var v;y===void 0&&(y=null),v===void 0&&(v=null);var _=new s;return _.qp(a,c,f,y,v),_},s.prototype.qp=function(a,c,f,y,v){if(a==null||c==null)throw d.i.fa("invalidArgument");if(this.ef=a,this.Yf=c,this.mw=this.Tn=!1,y!=null&&(this.rH=y.Of()),v!=null&&this.sH.mM(v),v=!1,c.Sb()==1&&y!=null&&(y=y.Jr,isNaN(y)||y==0||(v=!0)),a==c)this.Tn=!v,this.mw=!0;else{y=a.Sb();var _=c.Sb();if(y==0||_==0){if(f!=null)throw d.i.N();a.Hd()!=null&&c.Hd()!=null&&(this.Tn=a.Hd().Nb(c.Hd()))}else y==3||_==3?this.Tn=a.Nb(c):this.ef.kS(this.Yf)?this.Tn=!v:this.Tn=!1,this.Wf=f,this.Wf!=null&&this.Wf.ix(),this.mw=(this.Wf==null||this.Wf.count()==0)&&this.ef.sc().Nb(this.Yf.sc())}this.oY()},s.prototype.isIdentity=function(){return this.Tn},s.prototype.nR=function(){return this.rH.Of()},s.prototype.Nb=function(a){return a==this||!!(a instanceof s&&this.ef.Nb(a.ef)&&this.Yf.Nb(a.Yf))&&(this.Wf==a.Wf||!(this.Wf==null||a.Wf==null||!this.Wf.Nb(a.Wf)))},s.prototype.oY=function(){this.ww=new d.bu(this)},s}(),d.vr=l}(Y||(Y={})),function(d){var O=function(){function x(){}return x.Cp=function(h){return h*x.oW},x.mx=function(h,l){return x.gP(l-h)},x.hP=function(h){return-360<=h&&720>h?(0>h?h+=360:360<=h&&(h-=360),h):(0>(h=d.lc.RK(h))&&(h+=360),h)},x.gP=function(h){return 180<(h=x.hP(h))&&(h-=360),h},x.oW=57.29577951308232,x}();d.qr=O,d.Hh=function(){function x(){}return x.lj=function(h,l){var s=new d.l;h.A(s);var a=d.cb.gh(l),c=new d.l;return c.K(a),c.v=s.v,c.C=s.C,c.W(.01*c.ca(),0),l=d.ta.Wd(l,s,!1),c.contains(s)?h:d.Ud.clip(h,c,l,0)},x.ks=function(h,l,s,a,c){if(!d.cb.Wc(l))throw d.i.N();var f=d.ta.kj(l,h,!1),y=d.cb.gh(l),v=d.cb.sc(l),_=v.Hd().ai,$=d.cb.vv(v);v=d.cb.ev(v),$*=2-$;var I=new d.Nc;y.cn(I);var k=[[0,0],[0,0]];if(d.Eg.Sb(l)==2?a?(k[0][0]=x.Zm(c,I),k[0][1]=y.Jp(),d.cb.vt(),y=k[0][0]*_):(k[0][0]=y.gk(),k[0][1]=c,d.cb.vt(),y=k[0][1]*_):y=c*_,!a&&y!=0)throw d.i.N();var A=new d.ga,P=new d.gd;h=P.Ib(h);for(var D=[0],j=new d.h,B=new d.h,q=new d.h,z=new d.h,Z=new d.h,ee=new d.h,Q=P.Ob(h);Q!=-1;Q=P.Rb(Q)){var le=P.Xa(Q);P.D(le,q);for(var se=!1,ve=le=P.U(le);ve!=-1;ve=P.U(ve)){if(ve==le){if(se)break;se=!0}if(P.D(ve,z),a&&f<c-q.x&&z.x-c>f||f<c-z.x&&q.x-c>f||!a&&f<-q.y&&z.y>f||f<-z.y&&q.y>f)do if(!(Math.abs(q.x-z.x)>=.5*I.R())){if(d.Eg.Sb(l)==2?(k[0][0]=x.Zm(q.x,I),k[0][1]=q.y,k[1][0]=x.Zm(z.x,I),k[1][1]=z.y,d.cb.dW(),Z.x=k[0][0]*_,Z.y=k[0][1]*_,ee.x=k[1][0]*_,ee.y=k[1][1]*_):(Z.x=q.x*_,Z.y=q.y*_,ee.x=z.x*_,ee.y=z.y*_),ee.x=6.283185307179586*(z.x-q.x)/I.R()+Z.x,a){if(B.x=y,B.y=x.Nz(v,$,Z,ee,y,s),isNaN(B.y))break}else{if(B.x=x.Lz(v,$,Z,ee,s),isNaN(B.x))break;B.y=0}d.kb.wd(v,$,Z.x,Z.y,ee.x,ee.y,A,null,null,s);var xe=A.u;d.kb.wd(v,$,Z.x,Z.y,B.x,B.y,A,null,null,s);var _e=A.u;d.Eg.Sb(l)==2?(k[0][0]=B.x/_,k[0][1]=B.y/_,d.cb.bR(),a?(j.y=k[0][1],j.x=c):(j.x=x.os(k[0][0],q.x,z.x,I),j.y=c)):a?(j.x=c,j.y=B.y/_):(j.x=x.os(B.x/_,q.x,z.x,I),j.y=c),D[0]=0<xe?d.O.Rk(_e/xe,0,1):.5,D[0]!=0&&D[0]!=1&&(xe=P.Ma(ve),P.Ul(xe,D,1),P.Cb(P.U(xe),j.x,j.y))}while(!1);q.L(z)}}return P.Ne(h)},x.Fn=function(h,l,s,a,c){if(h.B())return h;var f=d.cb.bf(l);return x.Hp(h,s-180*f,360*f,l,a,c,!0)},x.Nz=function(h,l,s,a,c,f){if(3.141592653589793<=Math.abs(s.x-a.x)||!x.Sn(s.x,a.x,c))return NaN;if(s.x>a.x)var y=a;else y=s,s=a;a=new d.ga(0);var v=new d.ga(0),_=new d.ga(0);d.kb.wd(h,l,y.x,y.y,s.x,s.y,v,a,null,f);var $=v.u,I=0,k=1,A=new d.h;for(A.L(y);$*(k-I)>1e-12*h;){var P=.5*(I+k);if(d.kb.oj(h,l,y.x,y.y,$*P,a.u,v,_,f),A.x=v.u,A.y=_.u,A.x==c)break;if(x.Sn(y.x,A.x,c))k=P;else{if(!x.Sn(s.x,A.x,c))return NaN;I=P}}return A.y},x.Sn=function(h,l,s){return h=O.Cp(h),l=O.mx(h,O.Cp(l)),(s=O.mx(h,O.Cp(s)))==0||0<l&&0<s&&s<=l||0>l&&0>s&&s>=l},x.Zm=function(h,l){var s=l.va-l.oa;return l.It(h-Math.floor((h-l.oa)/s)*s)},x.os=function(h,l,s,a){var c=new d.Nc;for(c.K(l,s),s=a.R(),h=Math.floor((h-l)/s)*s+h,c=c.sf();Math.abs(h-c)>Math.abs(h+s-c);)h+=s;return h},x.Lz=function(h,l,s,a,c){if(s.y>a.y)var f=a;else f=s,s=a;if((a=new d.Nc).K(f.y,s.y),!a.contains(0)||3.141592653589793<=Math.abs(f.x-s.x))return NaN;if(f.x==s.x)return f.x;var y=new d.ga(0),v=new d.ga(0),_=new d.ga(0);d.kb.wd(h,l,f.x,f.y,s.x,s.y,v,y,null,c);var $=v.u,I=0,k=1,A=new d.h;for(A.L(f);$*(k-I)>1e-12*h;){var P=.5*(I+k);if(d.kb.oj(h,l,f.x,f.y,$*P,y.u,v,_,c),A.x=v.u,A.y=_.u,a.K(f.y,A.y),A.y==0)break;if(a.contains(0))k=P;else{if(a.K(s.y,A.y),!a.contains(0))return NaN;I=P}}return A.x},x.Hp=function(h,l,s,a,c,f,y){var v=new d.l;if(h.A(v),v.B())return h;var _=new d.Nc;v.cn(_);var $=new d.Nc;if($.K(l,l+s),$.contains(_)&&$.va!=_.va)return h;var I=new d.l;I.K(v);var k=h.getType();if(k==33)return((v=(I=c?h:h.Of()).Lg())<$.oa||v>=$.va||y&&v==$.va)&&(v+=Math.ceil(($.oa-v)/s)*s,v=$.It(v),I.cC(v)),I;if(k==550){for(a=(I=c?h:h.Of()).ub(0),k=2*I.I(),h=!1,c=0;c<k;c+=2)((v=a.read(c))<$.oa||v>=$.va||y&&v==$.va)&&(h=!0,v+=Math.ceil(($.oa-v)/s)*s,v=$.It(v),a.write(c,v));return h&&I.Pc(1993),I}if($.contains(_))return h;if(k==197)return s=c?h:h.Of(),v.Ea(I),s.Xo(v),s;var A=.1*Math.max(v.ca(),v.R());for(I.W(0,A),y=h,$=a.Xd(0),h=d.Gh.local(),c=new d.Dd;;){var P=Math.floor((_.oa-l)/s),D=Math.ceil((_.va-l)/s);if(!(3<D-P))break;P=Math.floor(.5*(D+P)),I.v=v.v-A,I.C=l+s*P;var j=d.Ud.clip(y,I,$,f);I.v=I.C,I.C=v.C+A;var B=d.Ud.clip(y,I,$,f);c.gg((P-D)*s,0),B.Oc(c),k==1736?y=h.V(j,B,a,null):(y=j).add(B,!1),y.A(v),v.cn(_)}for(I.v=l,I.C=l+s,(l=new d.l).K(I),l.W($,0),(l=Math.floor((v.v-I.v)/s)*s)!=0?(I.move(l,0),c.gg(-l,0)):c.RB(),l=k==1607?new d.Ta(y.description):new d.Da(y.description),f=new d.l,_=new d.l;v.C>I.v;)(A=d.Ud.clip(y,I,$,0)).A(_),(k==1607?!A.B()&&(_.R()>$||_.ca()>$):!A.B()&&(k!=1736||_.R()>$))&&(A.Oc(c),A.A(_),l.A(f),f.W($,$),f.isIntersecting(_)&&k==1736?l=h.V(l,A,a,null):l.add(A,!1)),I.move(s,0),c.shift(-s,0);return l},x.WI=function(h,l,s,a){var c=new d.de(s.description);c.Fd(s,0,-1),c=d.cb.zh(c,h,l);var f=s.I();if(a.Oa(),!d.cb.Wc(h)||f!=c.I())return!1;var y=new d.l;s.A(y);var v=new d.l;if(c.A(v),y=y.R(),v=v.R(),y!=0&&v!=0){if(v/=y,h=d.cb.gh(l).R()/d.cb.gh(h).R(),1e-10<Math.abs(v/h-1))return!1}else if(y!=0||v!=0)return!1;for(a.add(s,!1),s=0;s<f;s++)h=c.Na(s),a.Cb(s,h);return!0},x.Oz=function(){throw d.i.Ie()},x}()}(Y||(Y={})),function(d){var O,x,h;(x=O=d.si||(d.si={}))[x.Clip=0]="Clip",x[x.DontClip=1]="DontClip",x[x.PannableFold=2]="PannableFold",function(l){l[l.Geodesic=0]="Geodesic",l[l.Loxodrome=1]="Loxodrome",l[l.GreatElliptic=2]="GreatElliptic",l[l.NormalSection=3]="NormalSection",l[l.ShapePreserving=4]="ShapePreserving"}(h=d.WK||(d.WK={})),d.zb=function(){function l(){}return l.xv=function(s,a,c){if(c||0<a){for(s=s.toString(d.Sc.PE_STR_NAME_CANON|d.Sc.PE_STR_AUTH_NONE),a=[],c=0;c<s.length;c++)a[c]="a"<=s[c]&&"z">=s[c]?a[c]=s[c].toUpperCase():s[c];return a.join()}return s.toString(d.Sc.PE_STR_AUTH_TOP)},l.ur=function(s,a,c,f){var y=f.length,v=c.I();if(v!=0){var _=c.ub(0),$=Math.min(v,y),I=0,k=s.eh();isNaN(a)&&(a=0);for(var A=s.Wc(),P=179*(s=A?s.sc().Oe().R():0)/360;0<v;){if(_.uB(I<<1,$,f),d.ej.projToGeogCenter(k,$,f,a),A)for(var D=0;D<$;D++){var j=f[D][0]-a,B=d.lc.sign(j),q=_.read(2*(I+D));0>B*d.lc.sign(q)&&Math.abs(j)>P&&(f[D][0]+=-B*s)}_.uC(I<<1,$,f),I+=$,v-=$,$=Math.min(v,y)}c.Pc(1993)}},l.IL=function(s,a,c,f){var y=0,v=s.eh();isNaN(y)&&(y=0);var _=s.Wc(),$=s.bf();s=360*$,$*=179;for(var I=f.length,k=0;k<c;){for(var A=k;A<c&&a[A].isNaN();++A)k++;var P=Math.min(I,c-k);if(0<P){A=1;for(var D=k+1;A<P;++A,++D)if(a[D].isNaN()){P=A;break}if(d.ta.Jy(f,a,k,P),d.ej.projToGeogCenter(v,P,f,y),_)for(A=0,D=k;A<P;++A,++D){var j=a[D].x,B=f[A][0]-y,q=d.lc.sign(B);0>q*d.lc.sign(j)&&Math.abs(B)>$&&(f[A][0]-=q*s)}d.ta.Iy(a,k,f,P),k+=P}}},l.Lx=function(s,a,c){var f=c.length,y=a.I();if(!(1>y)){var v=a.ub(0),_=Math.min(y,f),$=0,I=s.eh(),k=s.Wc(),A=k?s.Oe().R():0,P=179*A/360,D=0;for(k&&(D=s.zi());0<y;){if(v.uB($<<1,_,c),d.ej.geogToProj(I,_,c),k)for(s=0;s<_;s++){var j=c[s][0],B=d.lc.sign(j),q=v.read(2*($+s))-D;0>B*d.lc.sign(q)&&Math.abs(j)>P&&(c[s][0]+=-B*A)}v.uC($<<1,_,c),$+=_,y-=_,_=Math.min(y,f)}a.Pc(1993)}},l.HL=function(s,a,c,f){if(c!=0){var y=s.eh(),v=s.Wc(),_=v?s.Oe().R():0,$=179*_/360,I=0;for(v&&(I=s.zi()),s=0;s<c;){for(var k=s;k<c&&a[k].isNaN();++k)s++;var A=Math.min(f.length,c-s);if(0<A){k=1;for(var P=s+1;k<A;++k,++P)if(a[P].isNaN()){A=k;break}if(d.ta.Jy(f,a,s,A),d.ej.geogToProj(y,A,f),v)for(k=0,P=s;k<A;k++){var D=f[k][0],j=d.lc.sign(D);0>j*d.lc.sign(a[P].x-I)&&Math.abs(D)>$&&(f[k][0]-=j*_)}d.ta.Iy(a,s,f,A),s+=A}}}},l.tr=function(s,a,c,f){var y=a.I();if(y!=0){var v=a.ub(0),_=s.ef,$=s.Yf,I=_.sc().Qp(),k=$.sc().Qp(),A=_.bf(),P=$.bf();if((s=s.Wf)==null||s.count()==0){for(c=I/k,f=(_.Up()-$.Up())*P,k=-90*A,s=90*A,I=!1,P=1,_=2*y;P<_;)A=v.get(P),($=d.O.Rk(A,k,s))!=A&&(v.set(P,$),I=!0),P+=2;if(f!=0||c!=1)for(I=!0,k=new d.h,P=0;P<y;P++)v.tc(2*P,k),k.x*=c,k.x+=f,k.y*=c,v.Tt(2*P,k);I&&a.Pc(1993)}else{_=f.length,$=Math.min(y,_);var D=d.O.lg($),j=null,B=0,q=NaN,z=NaN,Z=360*P,ee=P/A;c&&(z=90*P,q=89.9*A,j=d.O.lg($));for(var Q=!0,le=0;y!=0;){for(A=!1,v.uB(B<<1,$,f),P=0;P<$;P++)D[P]=f[P][0];if(c)for(P=0;P<$;P++){var se=Math.abs(f[P][1])-q;0<se&&(A=f[P][1],f[P][1]=d.lc.Cn(q,A),j[P]=d.lc.Cn(se,A),A=!0)}for(P=f[0][0],s.transform(f,$,I,k),Q&&(le=f[0][0]-ee*P,Q=!1),P=0;P<$;P++)se=f[P][0]-D[P]*ee-le,200<Math.abs(se)&&(f[P][0]=0<se?f[P][0]-Z:f[P][0]+Z);if(A){for(P=0;P<$;P++)j[P]!=0&&(f[P][1]+=ee*j[P],f[P][1]>z?f[P][1]=z:f[P][1]<-z&&(f[P][1]=-z));for(A=0;A<$;A++)j[A]=0}v.uC(B<<1,$,f),B+=$,y-=$,$=Math.min(y,_)}a.Pc(1993)}}},l.GL=function(s,a,c,f){if(s.mw)f=90*s.ef.bf(),d.ta.dK(a,c,-f,f);else{var y=s.Wf,v=s.ef,_=s.Yf;s=v.Xr();var $=_.Xr(),I=v.bf(),k=90*I,A=_.bf();if(y==null||y.count()==0){if(f=s/$,y=(v.Up()-_.Up())*A,d.ta.dK(a,c,-k,k),y!=0||f!=1)for(A=0;A<c;A++)a[A].x*=f,a[A].x+=y,a[A].y*=f}else{v=Math.min(c,f.length),k=d.O.lg(v),_=360*A,I=A/I;for(var P=!0,D=0,j=0;c!=0;){for(A=0;A<v;A++)k[A]=a[A+j].x;for(A=a[0].x,d.ta.Jy(f,a,j,v),y.transform(f,v,s,$),d.ta.Iy(a,j,f,v),P&&(D=a[0].x-I*A,P=!1),A=0;A<v;A++){var B=a[j+A].x-k[A]*I-D;200<Math.abs(B)&&(a[j+A].x=0<B?a[j+A].x-_:a[j+A].x+_)}j+=v,c-=v,v=Math.min(c,f.length)}}}},l.dv=function(s,a){return s=s.gh(),isNaN(a)||s.Ju(a,0),s},l.UQ=function(s,a,c,f,y,v,_,$){for(var I=l.dv(f,y),k=I.R(),A=k/360,P=l.pE*A,D=s.ub(0),j=a.Wc(),B=j?k/a.Oe().R():0,q=!1,z=new d.Da(c.description),Z=0,ee=c.da();Z<ee;++Z){var Q=j,le=new d.Ta(c.description);if(le.addPath(c,Z,!0),_!=0){var se=l.PD(!0,le,I.H-$,I.H,_);(q=q||se)&&(Q=!1)}var ve=-1;Q&&(ve=s.Ba(Z));var xe=le.ub(0),_e=le.I(),je=0,Ae=xe.read(0),st=0;se=3*f.Xd(0);var it=!1,Ne=new d.h;Ne.Rc();var xi=new d.h;xi.Rc();for(var Vr=!1,Ci=1;Ci<_e;++Ci){var Jt=d.h.construct(xe.eg(2*Ci),xe.eg(2*Ci+1)),Zt=Jt.x,_t=Zt+je,Qi=_t-Ae;if(Jt.x=_t,Math.abs(Qi)>P){if(Q){var bt=ve+(Ci+1<_e?Ci:0),aa=D.read(2*(ve+Ci-1));bt=(D.read(2*bt)-aa)*B,Math.abs(Qi-bt)>1*A&&(Q=!1)}Q||(_t=Zt+(je-=d.lc.Cn(k,_t-Ae)),++st,Vr=je!=0,Jt.x=_t)}else it||d.ta.AG(xi,Ne,Jt,se)&&(it=!0);Vr&&xe.write(2*Ci,_t),Ae=_t,xi.L(Ne),Ne.L(Jt)}0<st&&le.Pc(1993),Q=le.Na(0),_e=le.Na(_e-1),le=d.h.tb(Q,_e)<se?l.uQ(le,f,y,v,it):l.vQ(s,Z,le,f,y),z.add(le,!1)}return y=f.Xd(0),c=I.R()/180,l.Jt(z,I,.1*y,!1),z=z!=(y=d.ri.clip(z,I,y,c,v)),s=s.Ke(),_=0,0<($=y.Ke())&&0>s?_=1:0>=$&&0<s&&($==0?($=NaN,a.Sb()==2?$=a.ml().Ke():a.Sb()==1&&($=a.Oe().wF()),s>.99*$&&(_=-1)):_=-1),_!=0&&((a=new d.Da(y.description)).tp(I),(a=d.Xl.local().V(a,c,v)).add(y,!1),z=!0,y=a),z&&(y=d.Yl.local().V(y,f,!1,v)),y},l.vQ=function(s,a,c,f,y){var v=c.I(),_=c.Na(0),$=c.Na(v-1);y=(f=l.dv(f,y)).R(),_=d.lc.sign($.x-_.x);var I=new d.l;c.xc(I);var k=f.gk();if($=k-y,k+=y,0<=_){var A=Math.ceil(($-I.v)/y);for(A*=y;$>I.v+A;)A+=y;for(;$<I.C+A;)A-=y;var P=A;720<I.R()&&(k=$+360*Math.ceil(I.R()/360))}else{for(A=Math.ceil((k-I.C)/y),A*=y;k<I.C+A;)A-=y;for(;k>I.v+A;)A+=y;P=A,720<I.R()&&($=k-360*Math.ceil(I.R()/360))}A=_*y;var D=d.l.construct(I.v,I.G,I.C,I.H);D.move(P,0);var j=new d.Dd;j.gg(P,0),c.Oc(j),(I=new d.Ta(c.description)).add(c,!1),P=c.Na(v-1),y=0;for(var B=I.Na(0).x,q=0;0<_?D.C<k:D.v>$;)1024<=q&&(q=0),D.move(A,0),j.Gb=A,c.Oc(j),B+=A,f.v<=B&&f.C>=B&&(y=I.I()-1),c.Cb(0,P),P=c.Na(v-1),I.Dr(c,0,0,v-1,!1);return c=new d.Da(I.description),v=0<s.Ir(a),c.add(I,!1),s=I.Na(0),$=I.Na(I.I()-1),a=c.da()-1,(0>_?v:!v)?(_=d.h.construct($.x,f.H),c.Ci(_),_=d.h.construct(f.gk(),f.H),c.Ci(_),f=d.h.construct(s.x,f.H)):(_=d.h.construct($.x,f.G),c.Ci(_),_=d.h.construct(f.gk(),f.G),c.Ci(_),f=d.h.construct(s.x,f.G)),c.Ci(f),c.xG(0,a,0),c.kO(y),c},l.uQ=function(s,a,c,f,y){var v=new d.Da(s.description);v.add(s,!1),v.DB(0,v.I()-1);var _=new d.l;v.xc(_);var $=(c=l.dv(a,c)).R(),I=Math.ceil((c.v-_.v)/$);for(I*=$;c.v>_.v+I;)I+=$;for(;c.v<_.C+I;)I-=$;if((I+=$)!=0){_.move(I,0);var k=new d.Dd;k.gg(I,0),v.Oc(k)}if(c.v<=_.v&&c.C>_.C)return y&&(y=v.Ke(),a=(v=d.Yl.local().V(v,a,!0,f)).Ke(),(a=d.lc.sign(y)!=d.lc.sign(a))&&v.oJ()),v;for((s=new d.Da(s.description)).add(v,!1),y=y||_.R()>$-a.Xd(0);_.v<c.C;)_.move($,0),(k=new d.Dd).gg($,0),v.Oc(k),s.add(v,!1);return y&&(y=s.Ke(),s.Yo(1),a=(s=d.Yl.local().V(s,a,!0,f)).Ke(),(a=d.lc.sign(y)!=d.lc.sign(a))&&s.oJ()),s},l.PD=function(s,a,c,f,y){for(var v=a.ub(0),_=a.I(),$=!1,I=0;I<_;I++){var k=d.h.construct(v.eg(2*I),v.eg(2*I+1));if(1&y&&k.y>=c){$=!0;break}if(2&y&&k.y<=-c){$=!0;break}}if(!$)return!1;v=!1,s&&(v=a.Nn(0)),_=(s=new d.gd).Ib(a),$=s.Ob(_);var A=-1,P=!0,D=new d.h;D.Rc(),I=new d.Sa;for(var j=-1,B=s.Xa($);B!=-1;B=s.U(B)){k=s.Na(B);var q=1&y&&90<=k.y?1:0;if(q|=2&y&&k.y<=-c?2:0,0<A&&A!=q){if(D.x!=k.x){D.x=k.x,s.Vi(s.Ma(B),I);var z=s.wj($,B,I);s.mf(z,D)}if(v)for(j=j!=-1?s.U(j):s.Xa($),z=s.Ma(B);j!=z;)j=s.pd(j,!1);j=-1}0<q&&(k.y=d.lc.Cn(f,k.y),s.mf(B,k),P||A==q||(k.x!=D.x?(s.Vi(B,I),z=s.wj($,B,I),s.Cb(z,D.x,k.y),j=z):j=B)),A=q,D=k,P=!1}if(v){if(j!=-1)for(j=s.U(j);j!=-1;)j=s.pd(j,!1);c=s.Xa($),s.fq(c,s.rj($))||(s.Vi(c,I),s.wj($,-1,I))}return s.Ne(_).copyTo(a),!0},l.Mz=function(s,a,c,f){var y=s;if(y.B()||c==O.DontClip)return y;var v=y.getType();if(v==33)return y=[(f=y).D()],l.yG(y,1,a,c),y[0].isNaN()?f.Oa():f.Cb(y[0]),s;var _=(s=a.sc()).bf(),$=90*_,I=180*_,k=360*_,A=a.zi(),P=.5*_,D=new d.l;y.A(D);var j=a.Vr(),B=a.PQ(),q=j.getType()==197;if(a=new d.l,j.A(a),c==O.PannableFold&&(c=s.Oe().R(),a.v=A-.5*c,a.C=a.v+c),D.G<-$||D.H>$){if(new d.l().K(D.v-_,-$,D.C+_,$),(y=d.ri.Nu(y,a,s,NaN,0,f)).B())return y;y.A(D)}if(B&&(a.H<D.G||a.G>D.H))return y.Ia();if(D.R()>k&&(y=l.Hp(y,A-I,k,s,!0,0,!0,f)).A(D),($=l.eO(D.v,D.C,a.v,a.C,k))!=0&&D.move($,0),D.C>a.C||D.v<a.v){if(D.C>a.C)for(;D.v>=a.C;)D.move(-k,0),$-=k;for(;D.v<a.C-k;)D.move(k,0),$+=k}if(c=d.ta.Hu(s,j),$!=0&&((_=new d.Dd).gg($,0),y.Oc(_)),B){if(q&&a.contains(D))return y;for(B=[null,null],$=0;2>$;$++){if(q?_=d.aa.Hc(v)?d.ri.clip(y,a,c,P,f):d.ri.clip(y,a,c,0,f):(_=d.Xj.local().V(y,j,s,f))==j&&(_=d.aa.jg(_)),a.v<=D.v&&a.C>=D.C||a.v>=D.v&&a.C<=D.C)return _;B[$]=_,$==0&&(D.move(-k,0),(_=new d.Dd).gg(-k,0),y.Oc(_))}if(v==550)B[0].Fd(B[1],0,-1);else if(d.aa.Hc(v))B[0].add(B[1],!1);else{if(v!=33)throw d.i.fa("intersect_with_GCS_horizon: unexpected geometry type");B[0].B()&&(B[0]=B[1])}return B[0]}if(a.H<D.G||a.G>D.H)return y;for(v=0;!y.B()&&D.C>a.v;)v!=0&&((_=new d.Dd).gg(v,0),y.Oc(_)),d.dj.local().V(4,y,j,s,f)||j==(y=d.kp.local().V(y,j,s,f))&&(y=d.aa.jg(y)),v!=0&&((P=new d.Dd).gg(-v,0),y.Oc(P)),v-=k,D.move(-k,0);return y},l.yG=function(s,a,c,f){if(a!=0&&f!=O.DontClip)if(f==O.PannableFold){f=c.HR();for(var y=a,v=0;v<a;v++)(s[v].y>f.H||s[v].y<f.G)&&(s[v].Rc(),y--);y!=0&&l.av(s,a,f.v,f.R())}else{var _=90*(f=c.bf()),$=180*f;for(f*=360,y=a,v=0;v<a;v++)(s[v].y>_||s[v].y<-_)&&(s[v].Rc(),y--);if(y!=0){(y=new d.l).Zw(s,a),_=c.Vr();var I=c.hv();v=_.getType()==197;var k=new d.l;if(_.A(k),!I||!(k.H<y.G||k.G>y.H))if(I)if(l.av(s,a,k.gk()-$,f),y=a,v)for(v=0;v<a;v++)k.contains(s[v])||(s[v].Rc(),y--);else for(c=d.ta.Hu(c.sc(),_),v=0;v<a;v++)($=d.hd.Yd(_,s[v],c)!=0)||(s[v].Rc(),y--);else for(l.av(s,a,-$,f),y=a,c=d.ta.Hu(c.sc(),_),v=0;v<a;v++)($=s[v]).isNaN()&&y--,I=l.tE($.x,k.v,k.C,f),$.x+=I,($=d.hd.Yd(_,$,c)!=0)&&(s[v].Rc(),y--)}}},l.Hp=function(s,a,c,f,y,v,_,$){var I=s.getType(),k=a+c;if(I===33){var A=(f=y?s:s.Of()).Lg();return(A<a||A>=k||_&&A==k)&&(A+=Math.ceil((a-A)/c)*c,A=d.O.Rk(A,a,k),f.cC(A)),f}if(s.B()||(A=new d.l,s.A(A),A.B()))return s;var P=new d.Nc;A.cn(P);var D=new d.Nc;if(D.K(a,k),D.contains(P))return s;if((k=new d.l).K(A),I===550){for($=(f=y?s:s.Of()).ub(0),I=2*f.I(),k=!1,a=0;a<I;a+=2)((A=$.read(a))<D.oa||A>=D.va||_&&A==D.va)&&(k=!0,A+=Math.ceil((D.oa-A)/c)*c,A=D.It(A),$.write(a,A));return k&&f.Pc(1993),f}if(I==197)return c=y?s:s.Of(),A.Ea(k),c.Xo(A),c;var j=.1*Math.max(A.ca(),A.R());for(k.W(0,j),_=s,D=f.Xd(0),s=d.Gh.local(),y=new d.Dd;;){var B=Math.floor((P.oa-a)/c),q=Math.ceil((P.va-a)/c);if(!(3<q-B))break;B=Math.floor(.5*(q+B)),k.v=A.v-j,k.C=a+c*B;var z=d.ri.clip(_,k,D,v,$);k.v=k.C,k.C=A.C+j;var Z=d.ri.clip(_,k,D,v,$);y.gg((B-q)*c,0),Z.Oc(y),I==1736?_=s.V(z,Z,f,null):(_=z).add(Z,!1),_.A(A),A.cn(P)}for(k.v=a,k.C=a+c,(a=new d.l).K(k),a.W(D,0),(a=Math.floor((A.v-k.v)/c)*c)!=0?(k.move(a,0),y.gg(-a,0)):y.RB(),a=I==1607?new d.Ta(_.description):new d.Da(_.description),v=new d.l,P=new d.l;A.C>k.v;)(j=d.ri.clip(_,k,D,0,$)).A(P),(I==1607?!j.B()&&(P.R()>D||P.ca()>D):!j.B()&&(I!=1736||P.R()>D))&&(j.Oc(y),j.A(P),a.A(v),v.W(D,D),v.isIntersecting(P)&&I==1736?a=s.V(a,j,f,null):a.add(j,!1)),k.move(c,0),y.shift(-c,0);return a},l.av=function(s,a,c,f){for(var y=c+f,v=0;v<a;v++){var _=s[v].x;c<=_&&_<y||!(_<c||_>y||_==y)||(_+=Math.ceil((c-_)/f)*f,_=d.O.Rk(_,c,y),s[v].x=_)}},l.Fn=function(s,a,c,f,y,v){if(!a.Wc())throw d.i.fa("fold_into_360_degree_range");if(s.B())return s;if(a.Sb()==2){c=a.pv();var _=a.ov()-c}else{var $=a.bf();_=360*$,c-=180*$}return l.Hp(s,c,_,a,f,y,!0,v)},l.qF=function(s,a,c,f){if(c.Sb()==2)f=c.pv(),c=c.ov()-f;else{var y=c.bf();c=360*y,f-=180*y}l.av(s,a,f,c)},l.lj=function(s,a){var c=a.Oe();if(s.getType()==33){var f=s.ih();return c.G<=f&&f<=c.H?s:s.Ia()}f=new d.l,s.A(f);var y=new d.l;return y.K(c),y.v=f.v,y.C=f.C,y.W(.01*y.ca(),0),c=d.ta.uy(a,f),y.contains(f)?s:d.ri.clip(s,y,c,0,null)},l.ir=function(s,a,c){return s>a.C&&s-a.C<c?a.C:s<a.v&&a.v-s<c?a.v:s},l.FX=function(s,a,c,f){f.x=l.ir(s.x,a,c),f.y=s.y},l.EX=function(s,a,c,f){for(var y=0;y<a;y++)s[y].y<c.G||s[y].y>c.H?s[y].Rc():s[y].x=l.ir(s[y].x,c,f)},l.Jt=function(s,a,c,f){if(!s.B()){var y=s.getType();if(!f||y!=1736)if(d.aa.xj(y)){f=s.ub(0),y=0;for(var v=s.I();y<v;y++){var _=f.read(2*y),$=l.ir(_,a,c);$!=_&&f.write(2*y,$)}s.Pc(1993)}else if(y==197)f=new d.l,s.A(f),f.v=l.ir(f.v,a,c),f.C=l.ir(f.C,a,c),s.Xo(f);else{if(y!=33)throw d.i.fa("internal error");s.cC(l.ir(s.Lg(),a,c))}}},l.uS=function(s,a,c,f){var y=new d.gd,v=y.Ib(s);return s=d.ta.Hu(a,s),l.ks(y,v,a,s,c,!0,f),y.Ne(v)},l.ks=function(s,a,c,f,y,v,_){if(!c.Wc())throw d.i.N("invalid call");var $=c.Oe(),I=c.sc(),k=I.eh().getDatum().getSpheroid();I=I.Hd().ai;var A=k.getFlattening();k=k.getAxis(),A*=2-A;var P=new d.Nc;$.cn(P);var D=null,j=[[0,0],[0,0]];if(c.Sb()==2?(D=c.eh(),v?(j[0][0]=l.Zm(_,P),j[0][1]=$.Jp(),d.ej.projToGeog(D,1,j),$=j[0][0]*I):(j[0][0]=$.gk(),j[0][1]=_,d.ej.projToGeog(D,1,j),$=j[0][1]*I)):$=_*I,!v&&$!=0&&y!=h.GreatElliptic)throw d.i.fa("invalid argument");var B=new d.ga,q=[0],z=new d.h,Z=new d.h,ee=new d.h,Q=[null,null],le=new d.h,se=new d.h,ve=new d.h,xe=new d.h;for(a=s.Ob(a);a!=-1;a=s.Rb(a)){var _e=s.Xa(a);s.D(_e,le);for(var je=!1,Ae=_e=s.U(_e);Ae!=-1;Ae=s.U(Ae)){if(Ae==_e){if(je)break;je=!0}if(s.D(Ae,se),v&&(f<_-le.x&&se.x-_>f||f<_-se.x&&le.x-_>f)||!v&&(_!=0||f<-le.y&&se.y>f||f<-se.y&&le.y>f))do if(!(Math.abs(le.x-se.x)>=.5*P.R())){if(c.Sb()==2?(j[0][0]=l.Zm(le.x,P),j[0][1]=le.y,j[1][0]=l.Zm(se.x,P),j[1][1]=se.y,d.ej.projToGeogCenter(D,2,j,0),ve.x=j[0][0]*I,ve.y=j[0][1]*I,xe.y=j[1][1]*I):(ve.x=le.x*I,ve.y=le.y*I,xe.y=se.y*I),xe.x=2*(se.x-le.x)*Math.PI/P.R()+ve.x,v){if(Z.x=$,Z.y=l.Nz(k,A,ve,xe,$,y),isNaN(Z.y))break;Q[0]=Z;var st=1}else if(y==h.GreatElliptic){var it=[0,0];if((st=d.Ox.Oz(A,ve,xe,$,it))==0)break;Z.x=it[0],Z.y=$,Q[0]=Z,st==2&&(ee.x=it[1],ee.y=$,Q[1]=ee)}else{if(Z.x=l.Lz(k,A,ve,xe,y),isNaN(Z.x))break;Z.y=0,Q[0]=Z,st=1}var Ne=-1;for(it=0;it<st;it++){d.kb.wd(k,A,ve.x,ve.y,xe.x,xe.y,B,null,null,y);var xi=B.u;d.kb.wd(k,A,ve.x,ve.y,Q[it].x,Q[it].y,B,null,null,y);var Vr=B.u;if(c.Sb()==2?(j[0][0]=Q[it].x/I,j[0][1]=Q[it].y/I,d.ej.geogToProj(D,1,j),v?(z.y=j[0][1],z.x=_):(z.x=l.os(j[0][0],le.x,se.x,P),z.y=_)):v?(z.x=_,z.y=Q[it].y/I):(z.x=l.os(Q[it].x/I,le.x,se.x,P),z.y=_),q[0]=0<xi?d.O.Rk(Vr/xi,0,1):.5,q[0]==0||q[0]==1)break;Ne>q[0]||(Ne=s.Ma(Ae),s.Ul(Ne,q,1),s.Cb(s.U(Ne),z.x,z.y),Ne=q[0])}}while(!1);le.L(se)}}},l.Zm=function(s,a){var c=a.va-a.oa;return a.It(s-Math.floor((s-a.oa)/c)*c)},l.os=function(s,a,c,f){var y=new d.Nc;for(y.K(a,c),c=f.R(),s=Math.floor((s-a)/c)*c+s,y=y.sf();Math.abs(s-y)>Math.abs(s+c-y);)s+=c;return s},l.Sn=function(s,a,c){return s=d.qr.Cp(s),a=d.qr.mx(s,d.qr.Cp(a)),(c=d.qr.mx(s,d.qr.Cp(c)))==0||0<a&&0<c&&c<=a||0>a&&0>c&&c>=a},l.Nz=function(s,a,c,f,y,v){if(v==h.GreatElliptic)return d.Ox.SS(a,c,f,y);if(Math.abs(c.x-f.x)>=Math.PI||!l.Sn(c.x,f.x,y))return NaN;if(c.x>f.x)var _=f;else _=c,c=f;f=new d.ga;var $=new d.ga,I=new d.ga;d.kb.wd(s,a,_.x,_.y,c.x,c.y,$,f,null,v);var k=$.u,A=0,P=1,D=new d.h;for(D.L(_);k*(P-A)>1e-12*s;){var j=.5*(A+P);if(d.kb.oj(s,a,_.x,_.y,k*j,f.u,$,I,v),D.x=$.u,D.y=I.u,D.x==y)break;if(l.Sn(_.x,D.x,y))P=j;else{if(!l.Sn(c.x,D.x,y))return NaN;A=j}}return D.y},l.Lz=function(s,a,c,f,y){if(y==h.GreatElliptic)return s=[0,0],d.Ox.Oz(a,c,f,0,s),s[0];if(c.y>f.y)var v=f;else v=c,c=f;if((f=new d.Nc).K(v.y,c.y),!f.contains(0)||Math.abs(v.x-c.x)>=Math.PI)return NaN;if(v.x==c.x)return v.x;var _=new d.ga,$=new d.ga,I=new d.ga;d.kb.wd(s,a,v.x,v.y,c.x,c.y,$,_,null,y);var k=$.u,A=0,P=1,D=new d.h;for(D.L(v);k*(P-A)>1e-12*s;){var j=.5*(A+P);if(d.kb.oj(s,a,v.x,v.y,k*j,_.u,$,I,y),D.x=$.u,D.y=I.u,f.K(v.y,D.y),D.y==0)break;if(f.contains(0))P=j;else{if(f.K(c.y,D.y),!f.contains(0))return NaN;A=j}}return D.x},l.WI=function(s,a,c,f){if(!s.ef.Wc())return!1;var y=new d.de(a.description);if(y.Fd(a,0,-1),f=d.Hx.local().V(y,s,f),y=a.I(),c.Oa(),y!=f.I())return!1;var v=new d.l;a.A(v);var _=new d.l;if(f.A(_),v=v.R(),_=_.R(),v!=0&&_!=0){if(_/=v,s=s.Yf.gh().R()/s.ef.gh().R(),1e-10<Math.abs(_/s-1))return!1}else if(v!=0||_!=0)return!1;for(c.add(a,!1),a=new d.h,s=0;s<y;s++)f.D(s,a),c.Cb(s,a);return!0},l.qN=function(s,a){return(s%=360*a)>=180*a&&(s-=360*a),s},l.UI=function(s,a,c,f){if(c==O.Clip){var y=a.ml();y.getType()==197?(c=new d.l,y.A(c),y=d.ta.uy(a,c),s=d.ri.clip(s,c,y,5e4*a.pm(),f)):d.dj.local().V(1,y,s,a,f)||(s=d.Xj.local().V(s,y,a,f))==y&&(s=d.Vk.jg(s))}else a.Wc()&&(f=new d.l,s.xc(f),a.Oe().contains(f)||(l.Jt(s,a.Oe(),a.Xd(0),!0),c==O.PannableFold&&(s=l.lj(s,a)),s=l.Fn(s,a,0,!0,1e5*a.pm(),null)));return s},l.XD=function(s,a,c){var f=a.Wr();if(f==null)return s;var y=(a=a.sc()).Oe().R(),v=new d.l;s.xc(v);var _=new d.Nc;v.cn(_),v=f.Ga(),f=null;for(var $=new d.Dd;v.$a();)for(;v.Ha();){var I=v.ha(),k=I.Tg(0,0),A=new d.Nc;for(A.K(k.oa,k.va),k=0;A.va>_.oa;)A.move(-y),--k;for(;A.oa<=_.va;){if(A.isIntersecting(_)){f==null&&(f=new d.Ta);var P=d.yb.cP(I.ac(),I.wc());k!=0&&($.gg(k*y,0),P.Oc($)),f.oc(P,!0)}A.move(y),++k}}return f!=null?(a=d.ta.gO(a,f),a=d.ta.Er(a),d.$t.lP(s,f,a,c)):s},l.eO=function(s,a,c,f,y){return s>=c&&a<=f?0:l.tE(.5*(a+s),c,f,y)},l.tE=function(s,a,c,f){return d.lc.round((.5*(c+a)-s)/f)*f},l.VQ=function(s,a,c,f,y,v,_,$){var I=l.dv(f,y),k=I.R(),A=k/360,P=l.pE*A,D=s.ub(0),j=a.Wc(),B=j?k/a.Oe().R():0;a=s.Ia();for(var q=0,z=c.da();q<z;++q){var Z=j,ee=new d.Ta(c.description);ee.addPath(c,q,!0);var Q=c.dc(q);_!=0&&(Q=l.PD(Q,ee,I.H-$,I.H,_))&&(Z=!1);var le=-1;Q=ee.I();var se=!1;Z&&(le=s.Ba(q),se=s.dc(q));var ve=ee.ub(0),xe=0,_e=ve.read(0),je=0,Ae=3*f.Xd(0),st=!1,it=new d.h;it.Rc();var Ne=new d.h;Ne.Rc();for(var xi=!1,Vr=1;Vr<Q;++Vr){var Ci=d.h.construct(ve.eg(2*Vr),ve.eg(2*Vr+1)),Jt=Ci.x,Zt=Jt+xe,_t=Zt-_e;if(Ci.x=Zt,Math.abs(_t)>P){if(Z){var Qi=le+Vr-1,bt=le;(!se||Vr+1<Q)&&(bt+=Vr),Qi=D.read(2*Qi),bt=(D.read(2*bt)-Qi)*B,Math.abs(_t-bt)>1*A&&(j=!1)}Z||(Zt=Jt+(xe-=d.lc.Cn(k,Zt-_e)),++je,xi=xe!=0,Ci.x=Zt)}else st||d.ta.AG(it,Ne,Ci,Ae)&&(st=!0);xi&&ve.write(2*Vr,Zt),_e=Zt,it.L(Ne),Ne.L(Ci)}je!=0&&ee.Pc(1993),Z=ee.Na(0),Q=ee.Na(Q-1),d.h.tb(Z,Q),ee=l.wQ(ee,f,isNaN(y)?0:y,v),a.add(ee,!1)}return s=f.Xd(0),c=I.R()/180,l.Jt(a,I,.1*s,!1),d.ri.clip(a,I,s,c,v)},l.wQ=function(s,a,c,f){return l.Fn(s,a,c,!0,0,f)},l.OS=function(s,a,c,f){var y=s.getType();if(y==1736)for(a=a!=null?a.Xd(0):0,y=0;y<f;y++)d.hd.Yd(s,c[y],a)!=1&&c[y].Rc();else{if(y!=197)throw d.i.N();for(y=0;y<f;y++)s.dP(c[y])||c[y].Rc()}},l.$k=function(s,a,c,f){if(32>c)for(var y=new d.Sa,v=0;v<c;v++)y.Cb(a[v]),s.$k(y,f).D(a[v]);else{var _=new d.de;for(_.re(3),_.HD(a,c),y=_.ub(3),v=0;v<c;v++)y.write(v,v);for(v=s.$k(_,f),s=v.ub(0),y=v.ub(3),f=d.h.construct(NaN,NaN),_=0;_<c;_++)a[_]=f;for(c=v.I(),v=0;v<c;v++)f=y.read(v),s.tc(2*v,a[f])}},l.Zk=function(s,a,c,f){if(32>c)for(var y=new d.Sa,v=0;v<c;v++)y.Cb(a[v]),s.Zk(y,f).D(a[v]);else{var _=new d.de;for(_.re(3),_.HD(a,c),y=_.ub(3),v=0;v<c;v++)y.write(v,v);for(v=s.Zk(_,f),s=v.ub(0),y=v.ub(3),f=d.h.construct(NaN,NaN),_=0;_<c;_++)a[_]=f;for(c=v.I(),v=0;v<c;v++)f=y.read(v),s.tc(2*v,a[f])}},l.pE=210,l}()}(Y||(Y={})),function(d){var O;(O=d.UL||(d.UL={}))[O.rightSide=1]="rightSide";var x=function(){function h(l,s,a){this.Bs=new d.h,l===void 0?this.Io=-1:(this.Bs.L(l),this.Io=s,this.Ka=a,this.nw=0)}return h.prototype.WJ=function(l){this.nw=l?1|this.nw:-2&this.nw},h.prototype.B=function(){return 0>this.Io},h.prototype.fz=function(){if(this.B())throw d.i.fa("invalid call");return new d.Sa(this.Bs.x,this.Bs.y)},h.prototype.Ua=function(){if(this.B())throw d.i.fa("invalid call");return this.Io},h.prototype.hz=function(){if(this.B())throw d.i.fa("invalid call");return this.Ka},h.prototype.Sz=function(){return!!(1&this.nw)},h.prototype.ey=function(l,s,a,c){this.Bs.x=l,this.Bs.y=s,this.Io=a,this.Ka=c},h}();d.$l=x}(Y||(Y={})),function(d){var O=function(){function h(){}return h.prototype.Uo=function(l,s){if(this.th.resize(0),this.Ii.length=0,this.tk=-1,l.xc(this.Ek),this.Ek.W(s,s),this.Ek.isIntersecting(this.Fb.Ca)){var a=l.getType();(this.vs=d.aa.yd(a))?(this.TH=l.ac(),this.SH=l.wc(),this.qa=s):this.qa=NaN,this.th.add(this.Fb.kf),this.Ii.push(this.Fb.Ca),this.Qs=this.Fb.Ur(this.Fb.kf)}else this.Qs=-1},h.prototype.Xi=function(l,s){this.th.resize(0),this.Ii.length=0,this.tk=-1,this.Ek.K(l),this.Ek.W(s,s),this.qa=NaN,this.Ek.isIntersecting(this.Fb.Ca)?(this.th.add(this.Fb.kf),this.Ii.push(this.Fb.Ca),this.Qs=this.Fb.Ur(this.Fb.kf),this.vs=!1):this.Qs=-1},h.prototype.next=function(){if(this.th.size==0)return-1;this.tk=this.Qs;var l=null,s=null,a=null,c=null;this.vs&&(l=new d.h,s=new d.h,a=new d.l);for(var f=!1;!f;){for(;this.tk!=-1;){var y=this.Fb.bz(this.Fb.fv(this.tk));if(y.isIntersecting(this.Ek)){if(!this.vs){f=!0;break}if(l.L(this.TH),s.L(this.SH),a.K(y),a.W(this.qa,this.qa),0<a.zy(l,s)){f=!0;break}}this.tk=this.Fb.nv(this.tk)}if(this.tk==-1){y=this.th.Fc();var v=this.Ii[this.Ii.length-1];for(c==null&&((c=[])[0]=new d.l,c[1]=new d.l,c[2]=new d.l,c[3]=new d.l),x.EJ(v,c),this.th.If(),--this.Ii.length,v=0;4>v;v++){var _=this.Fb.Lp(y,v);if(_!=-1&&0<this.Fb.WR(_)&&c[v].isIntersecting(this.Ek))if(this.vs){if(l.L(this.TH),s.L(this.SH),a.K(c[v]),a.W(this.qa,this.qa),0<a.zy(l,s)){var $=new d.l;$.K(c[v]),this.th.add(_),this.Ii.push($)}}else($=new d.l).K(c[v]),this.th.add(_),this.Ii.push($)}if(this.th.size==0)return-1;this.tk=this.Fb.Ur(this.th.get(this.th.size-1))}}return this.Qs=this.Fb.nv(this.tk),this.tk},h.bP=function(l,s,a){var c=new h;return c.Fb=l,c.Ek=new d.l,c.th=new d.ia(0),c.Ii=[],c.Uo(s,a),c},h.aP=function(l,s,a){var c=new h;return c.Fb=l,c.Ek=new d.l,c.th=new d.ia(0),c.Ii=[],c.Xi(s,a),c},h.$O=function(l){var s=new h;return s.Fb=l,s.Ek=new d.l,s.th=new d.ia(0),s.Ii=[],s},h}();d.GY=O;var x=function(){function h(l,s){this.jf=new d.$c(11),this.Zh=new d.$c(5),this.ws=[],this.gw=new d.ia(0),this.Ca=new d.l,this.Nk(l,s)}return h.prototype.reset=function(l,s){this.jf.mj(!1),this.Zh.mj(!1),this.ws.length=0,this.gw.clear(!1),this.Nk(l,s)},h.prototype.vj=function(l,s){return this.zv(l,s,0,this.Ca,this.kf,!1,-1)},h.prototype.Jz=function(l,s,a){a=a==-1?this.kf:this.WF(a);var c=this.ca(a),f=this.oR(a);return this.zv(l,s,c,f,a,!1,-1)},h.prototype.ja=function(l){return this.jR(l)},h.prototype.GF=function(l){return this.bz(this.fv(l))},h.prototype.ca=function(l){return this.jv(l)},h.prototype.oR=function(l){var s=new d.l;s.K(this.Ca);var a=this.jv(l);l=this.QF(l);for(var c=0;c<2*a;c+=2){var f=d.O.truncate(3&l>>c);f==0?(s.v=.5*(s.v+s.C),s.G=.5*(s.G+s.H)):f==1?(s.C=.5*(s.v+s.C),s.G=.5*(s.G+s.H)):(f==2?s.C=.5*(s.v+s.C):s.v=.5*(s.v+s.C),s.H=.5*(s.G+s.H))}return s},h.prototype.WR=function(l){return this.Az(l)},h.prototype.vR=function(l,s){return O.bP(this,l,s)},h.prototype.MF=function(l,s){return O.aP(this,l,s)},h.prototype.getIterator=function(){return O.$O(this)},h.prototype.Nk=function(l,s){if(0>s||32<2*s)throw d.i.N("invalid height");this.BT=s,this.Ca.K(l),this.kf=this.jf.Ce(),this.jx(this.kf,0),this.ax(this.kf,0),this.NJ(this.kf,0),this.KJ(this.kf,0)},h.prototype.zv=function(l,s,a,c,f,y,v){if(!c.contains(s))return a==0?-1:this.zv(l,s,0,this.Ca,this.kf,y,v);if(!y)for(var _=f;_!=-1;_=this.IR(_))this.jx(_,this.Az(_)+1);(_=new d.l).K(c),c=f;var $=[];for($[0]=new d.l,$[1]=new d.l,$[2]=new d.l,$[3]=new d.l;a<this.BT&&this.iO(c);a++){h.EJ(_,$);for(var I=!1,k=0;4>k;k++)if($[k].contains(s)){I=!0;var A=this.Lp(c,k);A==-1&&(A=this.rP(c,k)),this.jx(A,this.Az(A)+1),c=A,_.K($[k]);break}if(!I)break}return this.sS(l,s,a,_,c,y,f,v)},h.prototype.sS=function(l,s,a,c,f,y,v,_){var $=this.NF(f);if(y){if(f==v)return _;this.SP(_),y=_}else y=this.tP(),this.NB(y,l),this.KW(this.fv(y),s);return this.mX(y,f),$!=-1?(this.hx(y,$),this.bx($,y)):this.GJ(f,y),this.SB(f,y),this.ax(f,this.lv(f)+1),this.hO(f)&&this.MQ(a,c,f),y},h.prototype.SP=function(l){var s=this.WF(l),a=this.NF(s),c=this.OR(l),f=this.nv(l);this.Ur(s)==l?(f!=-1?this.hx(f,-1):this.SB(s,-1),this.GJ(s,f)):a==l?(this.bx(c,-1),this.SB(s,c)):(this.hx(f,c),this.bx(c,f)),this.hx(l,-1),this.bx(l,-1),this.ax(s,this.lv(s)-1)},h.EJ=function(l,s){var a=.5*(l.v+l.C),c=.5*(l.G+l.H);s[0].K(a,c,l.C,l.H),s[1].K(l.v,c,a,l.H),s[2].K(l.v,l.G,a,c),s[3].K(a,l.G,l.C,c)},h.prototype.hO=function(l){return this.lv(l)==8&&!this.gG(l)},h.prototype.MQ=function(l,s,a){var c=this.Ur(a);do{var f=this.fv(c),y=this.Zh.T(c,0);f=this.bz(f),this.zv(y,f,l,s,a,!0,c),c=y=this.nv(c)}while(c!=-1)},h.prototype.iO=function(l){return 8<=this.lv(l)||this.gG(l)},h.prototype.gG=function(l){return this.Lp(l,0)!=-1||this.Lp(l,1)!=-1||this.Lp(l,2)!=-1||this.Lp(l,3)!=-1},h.prototype.rP=function(l,s){var a=this.jf.Ce();return this.OW(l,s,a),this.jx(a,0),this.ax(a,0),this.Pk(a,l),this.KJ(a,this.jv(l)+1),this.NJ(a,s<<2*this.jv(l)|this.QF(l)),a},h.prototype.tP=function(){var l=this.Zh.Ce();if(0<this.gw.size){var s=this.gw.Fc();this.gw.If()}else s=this.ws.length,this.ws.push(new d.l);return this.LW(l,s),l},h.prototype.Lp=function(l,s){return this.jf.T(l,s)},h.prototype.OW=function(l,s,a){this.jf.S(l,s,a)},h.prototype.Ur=function(l){return this.jf.T(l,4)},h.prototype.GJ=function(l,s){this.jf.S(l,4,s)},h.prototype.NF=function(l){return this.jf.T(l,5)},h.prototype.SB=function(l,s){this.jf.S(l,5,s)},h.prototype.QF=function(l){return this.jf.T(l,6)},h.prototype.NJ=function(l,s){this.jf.S(l,6,s)},h.prototype.lv=function(l){return this.jf.T(l,7)},h.prototype.Az=function(l){return this.jf.T(l,8)},h.prototype.ax=function(l,s){this.jf.S(l,7,s)},h.prototype.jx=function(l,s){this.jf.S(l,8,s)},h.prototype.IR=function(l){return this.jf.T(l,9)},h.prototype.Pk=function(l,s){this.jf.S(l,9,s)},h.prototype.jv=function(l){return this.jf.T(l,10)},h.prototype.KJ=function(l,s){this.jf.S(l,10,s)},h.prototype.jR=function(l){return this.Zh.T(l,0)},h.prototype.NB=function(l,s){this.Zh.S(l,0,s)},h.prototype.OR=function(l){return this.Zh.T(l,1)},h.prototype.nv=function(l){return this.Zh.T(l,2)},h.prototype.hx=function(l,s){this.Zh.S(l,1,s)},h.prototype.bx=function(l,s){this.Zh.S(l,2,s)},h.prototype.WF=function(l){return this.Zh.T(l,3)},h.prototype.mX=function(l,s){this.Zh.S(l,3,s)},h.prototype.fv=function(l){return this.Zh.T(l,4)},h.prototype.LW=function(l,s){this.Zh.S(l,4,s)},h.prototype.bz=function(l){return this.ws[l]},h.prototype.KW=function(l,s){this.ws[l].K(s)},h}();d.du=x}(Y||(Y={})),function(d){var O;(O=d.aL||(d.aL={}))[O.Outside=0]="Outside",O[O.Inside=1]="Inside",O[O.Border=2]="Border";var x=function(){function l(s,a){this.PT=a,this.Vh=s}return l.prototype.setColor=function(s,a){this.iH!=a&&s.flush(),this.iH=a},l.prototype.gF=function(s,a){for(var c=0;c<a;)for(var f=s[c++],y=s[c++],v=s[c++]*this.PT;f<y;f++)this.Vh[v+(f>>4)]|=this.iH<<2*(15&f)},l}();d.HY=x;var h=function(){function l(s,a,c){this.Vh=null,this.SA=this.Ik=this.cI=this.aI=this.Es=this.qH=this.Gf=this.Um=0,this.Ri=this.Jk=this.vl=null,this.Fz(s,a,c)}return l.create=function(s,a,c){if(!l.zE(s))throw d.i.N();return l.wP(s,a,c)},l.pW=function(s){switch(s){case 0:s=1024;break;case 1:s=16384;break;case 2:s=262144;break;default:throw d.i.fa("Internal Error")}return s},l.zE=function(s){return!(s.B()||s.getType()!=1607&&s.getType()!=1736)},l.prototype.rQ=function(s,a){a=a.Ga();for(var c=new d.h,f=new d.h;a.$a();)for(;a.Ha();){var y=a.ha();if(y.getType()!=322)throw d.i.fa("Internal Error");s.Eh(y.ac(),c),s.Eh(y.wc(),f),this.Ri.jy(c.x,c.y,f.x,f.y)}this.Ri.iJ(d.Px.Cx)},l.prototype.sQ=function(){throw d.i.fa("Internal Error")},l.prototype.Ry=function(s,a){for(var c=1;4>c;c++)s.jy(a[c-1].x,a[c-1].y,a[c].x,a[c].y);s.jy(a[3].x,a[3].y,a[0].x,a[0].y),this.Ri.iJ(d.Px.Cx)},l.prototype.rK=function(s,a,c){for(var f=[null,null,null,null],y=0;y<f.length;y++)f[y]=new d.h;a=a.Ga(),c=this.Jk.dY(c)+1.5,y=new d.h;for(var v=new d.h,_=new d.h,$=new d.h,I=new d.h,k=new d.l,A=new d.h;a.$a();){var P=!1,D=!0;for(A.ma(0,0);a.Ha();){var j=a.ha();if($.x=j.sa,$.y=j.na,I.x=j.pa,I.y=j.la,k.Oa(),k.Zb($.x,$.y),k.Lk(I.x,I.y),this.vl.HG(k)){this.Jk.Eh(I,I),D?(this.Jk.Eh($,$),A.L($),D=!1):$.L(A),y.uc(I,$);var B=.5>(j=y.length());j==0?y.ma(1,0):(B||A.L(I),y.scale(c/j),v.ma(-y.y,y.x),_.ma(y.y,-y.x),$.sub(y),I.add(y),f[0].add($,v),f[1].add($,_),f[2].add(I,_),f[3].add(I,v),B?P=!0:this.Ry(s,f))}else P&&(this.Ry(s,f),P=!1),D=!0}P&&this.Ry(s,f)}},l.prototype.sC=function(s){return d.O.truncate(s*this.qH+this.aI)},l.prototype.tC=function(s){return d.O.truncate(s*this.Es+this.cI)},l.wP=function(s,a,c){return new l(s,a,c)},l.prototype.Fz=function(s,a,c){this.Gf=Math.max(d.O.truncate(2*Math.sqrt(c)+.5),64),this.Um=d.O.truncate((2*this.Gf+31)/32),this.vl=new d.l,this.Ik=a,c=0;for(var f=this.Gf,y=this.Um;8<=f;)c+=f*y,f=d.O.truncate(f/2),y=d.O.truncate((2*f+31)/32);this.Vh=d.O.lg(c,0),this.Ri=new d.Px,c=new x(this.Vh,this.Um,this),this.Ri.AX(this.Gf,this.Gf,c),s.A(this.vl),this.vl.W(a,a),f=new d.l;var v=a*(y=d.l.construct(1,1,this.Gf-2,this.Gf-2)).R();switch(a*=y.ca(),f.K(this.vl.sf(),Math.max(v,this.vl.R()),Math.max(a,this.vl.ca())),this.SA=this.Ik,this.Jk=new d.Dd,this.Jk.pS(f,y),new d.Dd,s.getType()){case 550:c.setColor(this.Ri,2),this.sQ();break;case 1607:c.setColor(this.Ri,2),this.rK(this.Ri,s,this.SA);break;case 1736:c.setColor(this.Ri,1),this.rQ(this.Jk,s),c.setColor(this.Ri,2),this.rK(this.Ri,s,this.SA)}this.qH=this.Jk.bb,this.Es=this.Jk.ab,this.aI=this.Jk.Gb,this.cI=this.Jk.Lb,this.XN()},l.prototype.XN=function(){this.Ri.flush();for(var s=0,a=this.Gf*this.Um,c=this.Gf,f=d.O.truncate(this.Gf/2),y=this.Um,v=d.O.truncate((2*f+31)/32);8<c;){for(c=0;c<f;c++)for(var _=2*c,$=2*c+1,I=0;I<f;I++){var k=2*I,A=2*I+1,P=k>>4;k=2*(15&k);var D=A>>4;A=2*(15&A);var j=this.Vh[s+y*_+P]>>k&3;j|=this.Vh[s+y*_+D]>>A&3,j|=this.Vh[s+y*$+P]>>k&3,j|=this.Vh[s+y*$+D]>>A&3,this.Vh[a+v*c+(I>>4)]|=j<<2*(15&I)}c=f,y=v,s=a,f=d.O.truncate(c/2),v=d.O.truncate((2*f+31)/32),a=s+y*c}},l.prototype.So=function(s,a){return this.vl.contains(s,a)?(s=this.sC(s),a=this.tC(a),0>s||s>=this.Gf||0>a||a>=this.Gf||(a=this.Vh[this.Um*a+(s>>4)]>>2*(15&s)&3)==0?0:a==1?1:2):0},l.prototype.Ro=function(s){if(!s.Ea(this.vl))return 0;var a=this.sC(s.v),c=this.sC(s.C),f=this.tC(s.G);if(s=this.tC(s.H),0>a&&(a=0),0>f&&(f=0),c>=this.Gf&&(c=this.Gf-1),s>=this.Gf&&(s=this.Gf-1),a>c||f>s)return 0;for(var y=Math.max(c-a,1)*Math.max(s-f,1),v=0,_=this.Um,$=this.Gf,I=0;;){if(32>y||16>$){for(y=f;y<=s;y++)for(var k=a;k<=c;k++)if(1<(I=this.Vh[v+_*y+(k>>4)]>>2*(15&k)&3))return 2;if(I==0)return 0;if(I==1)return 1}v+=_*$,$=d.O.truncate($/2),_=d.O.truncate((2*$+31)/32),a=d.O.truncate(a/2),f=d.O.truncate(f/2),c=d.O.truncate(c/2),s=d.O.truncate(s/2),y=Math.max(c-a,1)*Math.max(s-f,1)}},l.prototype.RR=function(){return this.Gf*this.Um},l}();d.Nx=h}(Y||(Y={})),function(d){var O;(O=d.VL||(d.VL={}))[O.contains=1]="contains",O[O.within=2]="within",O[O.equals=3]="equals",O[O.disjoint=4]="disjoint",O[O.touches=8]="touches",O[O.crosses=16]="crosses",O[O.overlaps=32]="overlaps",O[O.unknown=0]="unknown",O[O.intersects=1073741824]="intersects";var x=function(){function l(){}return l.construct=function(s,a,c,f,y,v,_,$){var I=new l;return I.pw=s,I.Mm=a,I.Kj=c,I.Si=f,I.BH=y,I.SY=v,I.TY=_,I.UY=$,I},l}();d.Vt=function(){function l(){}return l.CD=function(s,a,c){if(l.wy(s)){var f=d.ta.kj(a,s,!1);a=!1,d.Uk.CE(s)&&(a=a||s.lu(f,c)),(f=s.getType())!=1736&&f!=1607||!d.Uk.AE(s)||c==0||(a=a||s.fj(c)),f!=1736&&f!=1607||!d.Uk.BE(s)||c==0||a||s.hM()}},l.wy=function(s){return d.Uk.CE(s)||d.Uk.AE(s)||d.Uk.BE(s)},l}();var h=function(){function l(){this.rh=[]}return l.zB=function(s,a,c,f,y){var v=s.getType(),_=a.getType();if(v==197){if(_==197)return l.tW(s,a,c,f);if(_==33)return f==2?f=1:f==1&&(f=2),l.hJ(a,s,c,f)}else if(v==33){if(_==197)return l.hJ(s,a,c,f);if(_==33)return l.vW(s,a,c,f)}if(s.B()||a.B())return f==4;var $=new d.l;s.A($);var I=new d.l;a.A(I);var k=new d.l;if(k.K($),k.Zb(I),c=d.ta.Wd(c,k,!1),l.dk($,I,c))return f==4;switch($=!1,d.Vk.yd(v)&&((v=new d.Ta(s.description)).oc(s,!0),s=v,v=1607),d.Vk.yd(_)&&((_=new d.Ta(a.description)).oc(a,!0),a=_,_=1607),v!=197&&_!=197?(s.Db()<a.Db()||v==33&&_==550)&&(f==2?f=1:f==1&&(f=2)):v!=1736&&_!=197&&(f==2?f=1:f==1&&(f=2)),v){case 1736:switch(_){case 1736:$=l.rt(s,a,c,f,y);break;case 1607:$=l.$m(s,a,c,f,y);break;case 33:$=l.qt(s,a,c,f);break;case 550:$=l.pt(s,a,c,f,y);break;case 197:$=l.GI(s,a,c,f,y)}break;case 1607:switch(_){case 1736:$=l.$m(a,s,c,f,y);break;case 1607:$=l.gB(s,a,c,f,y);break;case 33:$=l.tt(s,a,c,f,y);break;case 550:$=l.st(s,a,c,f,y);break;case 197:$=l.MI(s,a,c,f)}break;case 33:switch(_){case 1736:$=l.qt(a,s,c,f);break;case 1607:$=l.tt(a,s,c,f,y);break;case 550:$=l.lt(a,s,c,f)}break;case 550:switch(_){case 1736:$=l.pt(a,s,c,f,y);break;case 1607:$=l.st(a,s,c,f,y);break;case 550:$=l.ZA(s,a,c,f,y);break;case 33:$=l.lt(s,a,c,f);break;case 197:$=l.hI(s,a,c,f)}break;case 197:switch(_){case 1736:$=l.GI(a,s,c,f,y);break;case 1607:$=l.MI(a,s,c,f);break;case 550:$=l.hI(a,s,c,f)}}return $},l.tW=function(s,a,c,f){if(s.B()||a.B())return f==4;var y=new d.l,v=new d.l,_=new d.l;switch(s.A(y),a.A(v),_.K(y),_.Zb(v),s=d.ta.Wd(c,_,!1),f){case 4:return l.dk(y,v,s);case 2:return l.jF(v,y,s);case 1:return l.jF(y,v,s);case 3:return l.ek(y,v,s);case 8:return l.cQ(y,v,s);case 32:return l.bQ(y,v,s);case 16:return l.aQ(y,v,s)}return!1},l.hJ=function(s,a,c,f){if(s.B()||a.B())return f==4;s=s.D();var y=new d.l,v=new d.l;switch(a.A(y),v.K(s),v.Zb(y),a=d.ta.Wd(c,v,!1),f){case 4:return l.Rw(s,y,a);case 2:return l.eB(s,y,a);case 1:return l.RU(s,y,a);case 3:return l.vI(s,y,a);case 8:return l.dB(s,y,a)}return!1},l.vW=function(s,a,c,f){if(s.B()||a.B())return f==4;s=s.D(),a=a.D();var y=new d.l;switch(y.K(s),y.Zb(a),c=d.ta.Wd(c,y,!1),f){case 4:return l.SU(s,a,c);case 2:return l.uI(a,s,c);case 1:return l.uI(s,a,c);case 3:return l.wI(s,a,c)}return!1},l.rt=function(s,a,c,f,y){switch(f){case 4:return l.kV(s,a,c);case 2:return l.Sw(a,s,c,y);case 1:return l.Sw(s,a,c,y);case 3:return l.nV(s,a,c);case 8:return l.vV(s,a,c);case 32:return l.qV(s,a,c,y)}return!1},l.$m=function(s,a,c,f,y){switch(f){case 4:return l.lV(s,a,c);case 1:return l.fB(s,a,c,y);case 8:return l.wV(s,a,c,y);case 16:return l.gV(s,a,c)}return!1},l.qt=function(s,a,c,f){switch(f){case 4:return l.jV(s,a,c);case 1:return l.dV(s,a,c);case 8:return l.uV(s,a,c)}return!1},l.pt=function(s,a,c,f){switch(f){case 4:return l.iV(s,a,c);case 1:return l.cV(s,a,c);case 8:return l.tV(s,a,c);case 16:return l.fV(s,a,c)}return!1},l.GI=function(s,a,c,f,y){if(l.hV(s,a,c))return f==4;if(f==4)return!1;switch(f){case 2:return l.xV(s,a,c);case 1:return l.bV(s,a,c);case 3:return l.mV(s,a,c);case 8:return l.sV(s,a,c,y);case 32:return l.pV(s,a,c,y);case 16:return l.eV(s,a,c,y)}return!1},l.gB=function(s,a,c,f){switch(f){case 4:return l.GV(s,a,c);case 2:return l.KI(a,s,c);case 1:return l.KI(s,a,c);case 3:return l.IV(s,a,c);case 8:return l.NI(s,a,c);case 32:return l.MV(s,a,c);case 16:return l.LI(s,a,c)}return!1},l.tt=function(s,a,c,f){switch(f){case 4:return l.FV(s,a,c);case 1:return l.AV(s,a,c);case 8:return l.QV(s,a,c)}return!1},l.st=function(s,a,c,f){switch(f){case 4:return l.EV(s,a,c);case 1:return l.zV(s,a,c);case 8:return l.PV(s,a,c);case 16:return l.CV(s,a,c)}return!1},l.MI=function(s,a,c,f){if(l.DV(s,a,c))return f==4;if(f==4)return!1;switch(f){case 2:return l.RV(s,a,c);case 1:return l.yV(s,a,c);case 3:return l.HV(s,a,c);case 8:return l.OV(s,a,c);case 32:return l.LV(s,a,c);case 16:return l.BV(s,a,c)}return!1},l.ZA=function(s,a,c,f){switch(f){case 4:return l.gU(s,a,c);case 2:return l.eI(a,s,c);case 1:return l.eI(s,a,c);case 3:return l.iU(s,a,c);case 32:return l.oU(s,a,c)}return!1},l.lt=function(s,a,c,f){switch(f){case 4:return l.fI(s,a,c);case 2:return l.sU(s,a,c);case 1:return l.dU(s,a,c);case 3:return l.Nw(s,a,c)}return!1},l.hI=function(s,a,c,f){switch(f){case 4:return l.fU(s,a,c);case 2:return l.rU(s,a,c);case 1:return l.cU(s,a,c);case 3:return l.hU(s,a,c);case 8:return l.qU(s,a,c);case 16:return l.eU(s,a,c)}return!1},l.nV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.ek(f,y,c)&&(f=l.qc(s,a,!1))!=4&&f!=1&&f!=2&&(!!l.dI(s,a,c)||(f=s.Qb(),y=a.Qb(),!(Math.abs(f-y)>4*Math.max(s.I(),a.I())*c)&&l.Wz(s,a,c,!0)))},l.kV=function(s,a,c){var f=l.qc(s,a,!0);return f==4||f!=1&&f!=2&&f!=1073741824&&l.EI(s,a,c)},l.vV=function(s,a,c){var f=l.qc(s,a,!1);return f!=4&&f!=1&&f!=2&&l.II(s,a,c,null)},l.qV=function(s,a,c,f){var y=l.qc(s,a,!1);return y!=4&&y!=1&&y!=2&&l.FI(s,a,c,f)},l.Sw=function(s,a,c,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!!l.zc(y,v,c)&&(y=l.qc(s,a,!1))!=4&&y!=2&&(y==1||l.BI(s,a,c,f))},l.lV=function(s,a,c){var f=l.qc(s,a,!0);return f==4||f!=1&&f!=1073741824&&l.EI(s,a,c)},l.wV=function(s,a,c,f){var y=l.qc(s,a,!1);return y!=4&&y!=1&&l.JI(s,a,c,f)},l.gV=function(s,a,c){var f=l.qc(s,a,!1);return f!=4&&f!=1&&l.DI(s,a,c,null)},l.fB=function(s,a,c,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!!l.zc(y,v,c)&&(y=l.qc(s,a,!1))!=4&&(y==1||l.CI(s,a,c,f))},l.jV=function(s,a,c){return d.hd.KG(s,a,c)==0},l.uV=function(s,a,c){return a=a.D(),l.HI(s,a,c)},l.dV=function(s,a,c){return a=a.D(),l.AI(s,a,c)},l.iV=function(s,a,c){var f=l.qc(s,a,!1);if(f==4)return!0;if(f==1)return!1;f=new d.l,s.A(f),f.W(c,c);for(var y=new d.h,v=0;v<a.I();v++)if(a.D(v,y),f.contains(y)){var _=d.hd.Yd(s,y,c);if(_==1||_==2)return!1}return!0},l.tV=function(s,a,c){var f=this.qc(s,a,!1);if(f==4||f==1)return!1;f=new d.l,s.A(f),f.W(c,c);for(var y=!1,v=s,_=!1,$=0;$<a.I();$++){var I=a.Na($);if(f.contains(I)){if((I=d.hd.Yd(v,I,c))==2)y=!0;else if(I==1)return!1}_||(!d.Dg.Ml(s,a.I()-1)||s.Bb!=null&&s.Bb.Fb!=null?v=s:(v=new d.Da,s.copyTo(v),v.fj(1)),_=!0)}return!!y},l.fV=function(s,a,c){var f=this.qc(s,a,!1);if(f==4||f==1)return!1;var y=new d.l;f=new d.l;var v=new d.l;s.A(y),a.A(v),f.K(y),f.W(c,c),v=y=!1;for(var _=s,$=!1,I=0;I<a.I();I++){var k=a.Na(I);if(f.contains(k)?(k=d.hd.Yd(_,k,c))==0?v=!0:k==1&&(y=!0):v=!0,y&&v)return!0;$||(!d.Dg.Ml(s,a.I()-1)||s.Bb!=null&&s.Bb.Fb!=null?_=s:(_=new d.Da,s.copyTo(_),_.fj(1)),$=!0)}return!1},l.cV=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!this.zc(f,y,c)||(y=this.qc(s,a,!1))==4)return!1;if(y==1)return!0;y=!1;for(var v=s,_=!1,$=0;$<a.I();$++){var I=a.Na($);if(!f.contains(I))return!1;if((I=d.hd.Yd(v,I,c))==1)y=!0;else if(I==0)return!1;_||(!d.Dg.Ml(s,a.I()-1)||s.Bb!=null&&s.Bb.Fb!=null?v=s:(v=new d.Da,s.copyTo(v),v.fj(1)),_=!0)}return y},l.mV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.ek(f,y,c)&&((f=new d.Da).ad(a,!1),l.Wz(s,f,c,!0))},l.hV=function(s,a,c){var f=l.qc(s,a,!1);if(f==4)return!0;if(f==1||f==2)return!1;var y=new d.l;if(f=new d.l,s.A(y),a.A(f),l.zc(f,y,c)||(y=new d.h,f.dn(y),(a=d.hd.Yd(s,y,c))!=0)||(f.$I(y),(a=d.hd.Yd(s,y,c))!=0)||(f.en(y),(a=d.hd.Yd(s,y,c))!=0)||(f.cJ(y),(a=d.hd.Yd(s,y,c))!=0))return!1;a=s.ub(0),(y=new d.l).K(f),y.W(c,c);for(var v=0,_=s.I();v<_;v++){var $=a.read(2*v),I=a.read(2*v+1);if(y.contains($,I))return!1}return!l.TG(s,f,c)},l.sV=function(s,a,c,f){var y=l.qc(s,a,!1);if(y==4||y==1||y==2)return!1;y=new d.l;var v=new d.l;return s.A(y),a.A(v),!l.zc(v,y,c)&&(v.R()<=c&&v.ca()<=c?(a=a.Ip(),l.HI(s,a,c)):v.R()<=c||v.ca()<=c?(y=new d.Ta,v=new d.Sa,a.Hf(0,v),y.nf(v),a.Hf(2,v),y.lineTo(v),l.JI(s,y,c,f)):((y=new d.Da).ad(a,!1),l.II(s,y,c,f)))},l.pV=function(s,a,c,f){var y=l.qc(s,a,!1);if(y==4||y==1||y==2)return!1;y=new d.l;var v=new d.l;return s.A(y),a.A(v),!(l.zc(v,y,c)||v.R()<=c||v.ca()<=c)&&((y=new d.Da).ad(a,!1),l.FI(s,y,c,f))},l.xV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),l.zc(y,f,c)},l.bV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.zc(f,y,c)&&(f=l.qc(s,a,!1))!=4&&f!=2&&(f==1||(y.R()<=c&&y.ca()<=c?(a=a.Ip(),l.AI(s,a,c)):y.R()<=c||y.ca()<=c?(y=new d.Ta,f=new d.Sa,a.Hf(0,f),y.nf(f),a.Hf(2,f),y.lineTo(f),l.CI(s,y,c,null)):((y=new d.Da).ad(a,!1),l.BI(s,y,c,null))))},l.eV=function(s,a,c,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!(l.zc(v,y,c)||v.ca()>c&&v.R()>c||v.ca()<=c&&v.R()<=c)&&(y=new d.Ta,v=new d.Sa,a.Hf(0,v),y.nf(v),a.Hf(2,v),y.lineTo(v),l.DI(s,y,c,f))},l.IV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.ek(f,y,c)||l.qc(s,a,!1)==4)&&(!!l.dI(s,a,c)||l.Wz(s,a,c,!1))},l.GV=function(s,a,c){return this.qc(s,a,!1)==4||!!new d.Zl(s,a,c,!0).next()&&!this.UG(s,a,c)},l.NI=function(s,a,c){if(l.qc(s,a,!1)==4)return!1;var f=new d.be(0);if(l.Xz(s,a,c,f)!=0)return!1;for(var y=new d.de,v=0;v<f.size;v+=2){var _=f.read(v),$=f.read(v+1);y.Bu(_,$)}return s=s.mg(),a=a.mg(),s.Fd(a,0,a.I()),l.Mw(s,y,c)},l.LI=function(s,a,c){if(l.qc(s,a,!1)==4)return!1;var f=new d.be(0);if(l.Xz(s,a,c,f)!=0)return!1;for(var y=new d.de,v=0;v<f.size;v+=2){var _=f.read(v),$=f.read(v+1);y.Bu(_,$)}return s=s.mg(),a=a.mg(),s.Fd(a,0,a.I()),!l.Mw(s,y,c)},l.MV=function(s,a,c){return l.qc(s,a,!1)!=4&&l.WG(s,a,c)},l.KI=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.zc(f,y,c)||l.qc(s,a,!1)==4)&&l.ym(a,s,c,!1)},l.FV=function(s,a,c){return l.qc(s,a,!1)==4||(a=a.D(),!l.Yz(s,a,c))},l.QV=function(s,a,c){return l.qc(s,a,!1)!=4&&(a=a.D(),l.Zz(s,a,c))},l.AV=function(s,a,c){return l.qc(s,a,!1)!=4&&(a=a.D(),l.SG(s,a,c))},l.EV=function(s,a,c){return l.qc(s,a,!1)==4||!l.VG(s,a,c,!1)},l.PV=function(s,a,c){if(this.qc(s,a,!1)==4)return!1;var f=s.Ga(),y=new d.l,v=new d.l,_=new d.l;s.A(y),a.A(v),y.W(c,c),v.W(c,c),_.K(y),_.Ea(v),y=null;var $=s.Bb;if($!=null){var I=$.Fb;y=$.zo,I==null&&(I=$=d.ta.jj(s,_))}else I=$=d.ta.jj(s,_);var k=I.getIterator(),A=null;y!=null&&(A=y.getIterator());var P=new d.h,D=new d.h,j=!1,B=c*c;for(y=new d.pn(a.I()),$=0;$<a.I();$++)y.write($,0);for($=0;$<a.I();$++)if(a.D($,P),_.contains(P)){if(v.K(P.x,P.y,P.x,P.y),A!=null&&(A.Xi(v,c),A.next()==-1))continue;k.Xi(v,c);for(var q=k.next();q!=-1;q=k.next())if(f.Vb(I.ja(q)),(q=f.ha()).hc(q.fe(P,!1),D),d.h.yc(P,D)<=B){y.write($,1),j=!0;break}}if(!j)return!1;for(s=s.mg(),f=new d.de,v=new d.h,$=0;$<a.I();$++)y.read($)!=0&&(a.D($,v),f.Bu(v.x,v.y));return this.Mw(s,f,c)},l.CV=function(s,a,c){if(this.qc(s,a,!1)==4)return!1;var f=s.Ga(),y=new d.l,v=new d.l,_=new d.l;s.A(y),a.A(v),y.W(c,c),v.W(c,c),_.K(y),_.Ea(v),y=null;var $=s.Bb;if($!=null){var I=$.Fb;y=$.zo,I==null&&(I=$=d.ta.jj(s,_))}else I=$=d.ta.jj(s,_);var k=I.getIterator(),A=null;y!=null&&(A=y.getIterator());var P=new d.h,D=new d.h,j=!1,B=!1,q=c*c;for(y=new d.pn(a.I()),$=0;$<a.I();$++)y.write($,0);for($=0;$<a.I();$++)if(a.D($,P),_.contains(P)){if(v.K(P.x,P.y,P.x,P.y),A!=null&&(A.Xi(v,c),A.next()==-1)){B=!0;continue}k.Xi(v,c);for(var z=!1,Z=k.next();Z!=-1;Z=k.next())if(f.Vb(I.ja(Z)),(Z=f.ha()).hc(Z.fe(P,!1),D),d.h.yc(P,D)<=q){y.write($,1),z=j=!0;break}z||(B=!0)}else B=!0;if(!j||!B)return!1;for(s=s.mg(),f=new d.de,v=new d.h,$=0;$<a.I();$++)y.read($)!=0&&(a.D($,v),f.Bu(v.x,v.y));return!this.Mw(s,f,c)},l.zV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.zc(f,y,c)||l.qc(s,a,!1)==4||!l.VG(s,a,c,!0))&&(s=s.mg(),!l.gI(s,a,c))},l.HV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(y.ca()>c&&y.R()>c)&&l.ek(f,y,c)},l.DV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!l.zc(y,f,c)&&!l.TG(s,y,c)},l.OV=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),y.ca()<=c&&y.R()<=c)return y=a.Ip(),l.Zz(s,y,c);if(y.ca()<=c||y.R()<=c)return y=new d.Ta,f=new d.Sa,a.Hf(0,f),y.nf(f),a.Hf(2,f),y.lineTo(f),l.NI(s,y,c);s=s.Ga(),a=new d.l,f=new d.l,a.K(y),f.K(y),a.W(-c,-c),f.W(c,c),y=!1;for(var v=new d.l,_=new d.l;s.$a();)for(;s.Ha();){if(s.ha().A(v),_.K(a),_.Ea(v),!_.B()&&(_.ca()>c||_.R()>c))return!1;_.K(f),_.Ea(v),_.B()||(y=!0)}return y},l.LV=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(l.zc(f,y,c)||l.zc(y,f,c)||l.zc(y,f,c)||y.ca()>c&&y.R()>c||y.ca()<=c&&y.R()<=c)&&(f=new d.Ta,y=new d.Sa,a.Hf(0,y),f.nf(y),a.Hf(2,y),f.lineTo(y),l.WG(s,f,c))},l.RV=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!l.zc(y,f,c)||y.ca()<=c&&y.R()<=c)return!1;if(y.ca()<=c||y.R()<=c)return l.zc(y,f,c);s=s.Ga(),(a=new d.l).K(y),a.W(-c,-c),y=!1,f=new d.l;for(var v=new d.l;s.$a();)for(;s.Ha();)s.ha().A(f),a.hm(f)?y=!0:(v.K(a),v.Ea(f),!v.B()&&(v.ca()>c||v.R()>c)&&(y=!0));return y},l.yV=function(s,a,c){var f=new d.l,y=new d.l;return a.A(y),s.A(f),!(!l.zc(f,y,c)||y.ca()>c&&y.R()>c)&&(y.ca()<=c&&y.R()<=c?(a=a.Ip(),l.SG(s,a,c)):(f=new d.Ta,y=new d.Sa,a.Hf(0,y),f.nf(y),a.Hf(2,y),f.lineTo(y),l.ym(f,s,c,!1)))},l.BV=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.zc(y,f,c)||y.ca()<=c&&y.R()<=c)return!1;if(y.ca()<=c||y.R()<=c)return f=new d.Ta,y=new d.Sa,a.Hf(0,y),f.nf(y),a.Hf(2,y),f.lineTo(y),l.LI(s,f,c);s=s.Ga(),a=new d.l,(f=new d.l).K(y),a.K(y),f.W(-c,-c),a.W(c,c);for(var v=y=!1,_=new d.l,$=new d.l;s.$a();)for(;s.Ha();)if(s.ha().A(_),v||a.contains(_)||(v=!0),y||($.K(f),$.Ea(_),!$.B()&&($.ca()>c||$.R()>c)&&(y=!0)),y&&v)return!0;return!1},l.iU=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.ek(f,y,c)&&(!!l.jU(s,a,c)||l.YA(s,a,c,!1,!0,!1))},l.gU=function(s,a,c){return!l.gI(s,a,c)},l.oU=function(s,a,c){return l.YA(s,a,c,!1,!1,!0)},l.eI=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.zc(f,y,c)&&l.YA(a,s,c,!0,!1,!1)},l.Mw=function(s,a,c){c*=c;for(var f=new d.h,y=new d.h,v=0;v<a.I();v++){a.D(v,y);for(var _=!1,$=0;$<s.I();$++)if(s.D($,f),d.h.yc(f,y)<=c){_=!0;break}if(!_)return!1}return!0},l.Nw=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),l.ek(f,y,c)},l.fI=function(s,a,c){return a=a.D(),l.kt(s,a,c)},l.sU=function(s,a,c){return l.Nw(s,a,c)},l.dU=function(s,a,c){return!l.fI(s,a,c)},l.hU=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(y.ca()>c||y.R()>c)&&l.ek(f,y,c)},l.fU=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.zc(y,f,c))return!1;for((a=new d.l).K(y),a.W(c,c),c=new d.h,y=0;y<s.I();y++)if(s.D(y,c),a.contains(c))return!1;return!0},l.qU=function(s,a,c){var f=new d.l,y=new d.l,v=new d.l;if(a.A(f),f.ca()<=c&&f.R()<=c)return!1;if(f.ca()<=c||f.R()<=c){a=new d.h;var _=!1;y.K(f),v.K(f),y.W(c,c),f.ca()>c?v.W(0,-c):v.W(-c,0);for(var $=0;$<s.I();$++)if(s.D($,a),y.contains(a)){if(f.ca()>c){if(a.y>v.G&&a.y<v.H)return!1}else if(a.x>v.v&&a.x<v.C)return!1;_=!0}return _}for(y.K(f),v.K(f),y.W(c,c),v.W(-c,-c),a=new d.h,_=!1,$=0;$<s.I();$++)if(s.D($,a),y.contains(a)){if(v.hm(a))return!1;_=!0}return _},l.rU=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!l.zc(y,f,c))return!1;if(y.ca()<=c&&y.R()<=c)return l.ek(f,y,c);if(y.ca()<=c||y.R()<=c){a=!1,f=new d.l;var v=new d.l;f.K(y),v.K(y),y.ca()>c?f.W(0,-c):f.W(-c,0),v.W(c,c);for(var _=new d.h,$=0;$<s.I();$++){if(s.D($,_),!v.contains(_))return!1;y.ca()>c?_.y>f.G&&_.y<f.H&&(a=!0):_.x>f.v&&_.x<f.C&&(a=!0)}return a}for(a=!1,f=new d.l,v=new d.l,f.K(y),v.K(y),f.W(-c,-c),v.W(c,c),_=new d.h,$=0;$<s.I();$++){if(s.D($,_),!v.contains(_))return!1;f.hm(_)&&(a=!0)}return a},l.cU=function(s,a,c){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.zc(f,y,c)||y.ca()>c||y.R()>c)&&(a=a.Ip(),!l.kt(s,a,c))},l.eU=function(s,a,c){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.zc(y,f,c)||y.ca()<=c&&y.R()<=c)return!1;if(y.ca()<=c||y.R()<=c){a=new d.l,f=new d.l,a.K(y),y.ca()>c?a.W(0,-c):a.W(-c,0),f.K(y),f.W(c,c);for(var v=new d.h,_=!1,$=!1,I=0;I<s.I();I++)if(s.D(I,v),_||(y.ca()>c?v.y>a.G&&v.y<a.H&&(_=!0):v.x>a.v&&v.x<a.C&&(_=!0)),$||f.contains(v)||($=!0),_&&$)return!0;return!1}for(a=new d.l,f=new d.l,a.K(y),a.W(-c,-c),f.K(y),f.W(c,c),v=new d.h,$=_=!1,I=0;I<s.I();I++)if(s.D(I,v),!_&&a.hm(v)&&(_=!0),$||f.contains(v)||($=!0),_&&$)return!0;return!1},l.wI=function(s,a,c){return d.h.yc(s,a)<=c*c},l.SU=function(s,a,c){return d.h.yc(s,a)>c*c},l.uI=function(s,a,c){return l.wI(s,a,c)},l.vI=function(s,a,c){var f=new d.l;return f.K(s),l.ek(f,a,c)},l.Rw=function(s,a,c){var f=new d.l;return f.K(a),f.W(c,c),!f.contains(s)},l.dB=function(s,a,c){if(a.ca()<=c&&a.R()<=c)return!1;var f=new d.l,y=new d.l;if(f.K(a),f.W(c,c),!f.contains(s))return!1;if(a.ca()<=c||a.R()<=c){if(y.K(a),a.ca()>c?y.W(0,-c):y.W(-c,0),a.ca()>c){if(s.y>y.G&&s.y<y.H)return!1}else if(s.x>y.v&&s.x<y.C)return!1;return!0}return y.K(a),y.W(-c,-c),!y.hm(s)},l.eB=function(s,a,c){if(a.ca()<=c&&a.R()<=c)return!0;if(a.ca()<=c||a.R()<=c){var f=new d.l;f.K(a),a.ca()>c?f.W(0,-c):f.W(-c,0);var y=!1;return a.ca()>c?s.y>f.G&&s.y<f.H&&(y=!0):s.x>f.v&&s.x<f.C&&(y=!0),y}return(f=new d.l).K(a),f.W(-c,-c),f.hm(s)},l.RU=function(s,a,c){return l.vI(s,a,c)},l.ek=function(s,a,c){return l.zc(s,a,c)&&l.zc(a,s,c)},l.dk=function(s,a,c){var f=new d.l;return f.K(a),f.W(c,c),!s.isIntersecting(f)},l.cQ=function(s,a,c){if(s.ca()<=c&&s.R()<=c){var f=s.sf();return l.dB(f,a,c)}if(a.ca()<=c&&a.R()<=c)return f=a.sf(),l.dB(f,s,c);if(s.ca()>c&&s.R()>c&&(a.ca()<=c||a.R()<=c)?f=a:(f=s,s=a),f.ca()<=c||f.R()<=c){if(s.ca()<=c||s.R()<=c){a=new d.yb;var y=new d.yb,v=[0,0],_=[0,0],$=new d.h;return f.dn($),a.Dc($),f.en($),a.Qc($),s.dn($),y.Dc($),s.en($),y.Qc($),a.Ea(y,null,v,_,c),a.Ea(y,null,null,null,c)==1&&(v[0]==0||v[1]==1||_[0]==0||_[1]==1)}return a=new d.l,y=new d.l,a.K(s),a.W(-c,-c),y.K(a),y.Ea(f),!(!y.B()&&(y.ca()>c||y.R()>c))}return s.W(c,c),(y=new d.l).K(f),y.Ea(s),!(y.B()||!y.B()&&y.ca()>c&&y.R()>c)},l.bQ=function(s,a,c){if(l.zc(s,a,c)||l.zc(a,s,c)||s.ca()<=c&&s.R()<=c||a.ca()<=c&&a.R()<=c)return!1;if(s.ca()<=c||s.R()<=c){if(a.ca()>c&&a.R()>c)return!1;var f=new d.yb,y=new d.yb,v=[0,0],_=[0,0],$=new d.h;return s.dn($),f.Dc($),s.en($),f.Qc($),a.dn($),y.Dc($),a.en($),y.Qc($),f.Ea(y,null,v,_,c),f.Ea(y,null,null,null,c)==2&&(0<v[0]||1>v[1])&&(0<_[0]||1>_[1])}return!(a.ca()<=c||a.R()<=c)&&((f=new d.l).K(s),f.Ea(a),!(f.B()||f.ca()<=c||f.R()<=c))},l.jF=function(s,a,c){if(!l.zc(s,a,c))return!1;if(s.ca()<=c&&s.R()<=c)return s=s.sf(),l.eB(s,a,c);if(a.ca()<=c&&a.R()<=c)return a=a.sf(),l.eB(a,s,c);if(s.ca()<=c||s.R()<=c)return l.zc(s,a,c);if(a.ca()<=c||a.R()<=c){var f=new d.l;return f.K(s),f.W(-c,-c),f.hm(a)?!0:((s=new d.l).K(f),s.Ea(a),!(s.B()||s.ca()<=c&&s.R()<=c))}return l.zc(s,a,c)},l.aQ=function(s,a,c){if(l.zc(s,a,c)||l.zc(a,s,c)||s.ca()<=c&&s.R()<=c||a.ca()<=c&&a.R()<=c||a.ca()>c&&a.R()>c&&s.ca()>c&&s.R()>c)return!1;if(s.ca()>c&&s.R()>c)var f=a;else f=s,s=a;if(s.ca()>c&&s.R()>c){a=new d.l;var y=new d.l;return y.K(s),y.W(-c,-c),a.K(y),a.Ea(f),!(a.B()||a.ca()<=c&&a.R()<=c)}a=new d.yb,y=new d.yb;var v=[0,0],_=[0,0],$=new d.h;return f.dn($),a.Dc($),f.en($),a.Qc($),s.dn($),y.Dc($),s.en($),y.Qc($),a.Ea(y,null,v,_,c),a.Ea(y,null,null,null,c)==1&&0<v[0]&&1>v[1]&&0<_[0]&&1>_[1]},l.EI=function(s,a,c){var f=new d.l,y=new d.l,v=new d.Zl(s,a,c,!0);if(!v.next())return!0;if(this.UG(s,a,c))return!1;var _=s,$=null;a.getType()==1736&&($=a);var I=!1,k=!1;do{var A=v.nl(),P=v.hl();if(P=a.Na(a.Ba(P)),f.K(v.uz()),f.W(c,c),f.contains(P)&&(P=d.hd.Yd(_,P,0))!=0||a.getType()==1736&&(A=s.Na(s.Ba(A)),y.K(v.az()),y.W(c,c),y.contains(A)&&(P=d.hd.Yd($,A,0))!=0))return!1;I||(!d.Dg.Ml(s,a.da()-1)||s.Bb!=null&&s.Bb.Fb!=null?_=s:(_=new d.Da,s.copyTo(_),_.fj(1)),I=!0),a.getType()!=1736||k||(k=a,!d.Dg.Ml(k,s.da()-1)||a.Bb!=null&&a.Bb.Fb!=null?$=a:($=new d.Da,k.copyTo($),$.fj(1)),k=!0)}while(v.next());return!0},l.zc=function(s,a,c){var f=new d.l;return f.K(s),f.W(c,c),f.contains(a)},l.ls=function(s,a,c){var f=new d.l;return f.K(a),f.W(c,c),a=new d.h,s.dn(a),!f.contains(a)||(s.$I(a),!f.contains(a)||(s.cJ(a),!f.contains(a)||(s.en(a),!f.contains(a))))},l.dI=function(s,a,c){if(s.da()!=a.da()||s.I()!=a.I())return!1;var f=new d.h,y=new d.h,v=!0;c*=c;for(var _=0;_<s.da();_++){if(s.Vc(_)!=a.Vc(_)){v=!1;break}for(var $=s.Ba(_);$<a.Vc(_);$++)if(s.D($,f),a.D($,y),d.h.yc(f,y)>c){v=!1;break}if(!v)break}return!!v},l.jU=function(s,a,c){if(s.I()!=a.I())return!1;var f=new d.h,y=new d.h,v=!0;c*=c;for(var _=0;_<s.I();_++)if(s.D(_,f),a.D(_,y),d.h.yc(f,y)>c){v=!1;break}return!!v},l.YA=function(s,a,c,f,y,v){var _=!1;if(s.I()>a.I()){f&&(f=!1,_=!0);var $=a}else $=s,s=a;if(a=null,y||v||_){a=new d.pn(s.I());for(var I=0;I<s.I();I++)a.write(I,0)}I=new d.l;var k=new d.l,A=new d.l;$.A(I),s.A(k),I.W(c,c),k.W(c,c),A.K(I),A.Ea(k),k=new d.h;for(var P=new d.h,D=!0,j=d.ta.oE(s,A),B=j.getIterator(),q=c*c,z=0;z<$.I();z++)if($.D(z,k),A.contains(k)){var Z=!1;I.K(k.x,k.y,k.x,k.y),B.Xi(I,c);for(var ee=B.next();ee!=-1&&(ee=j.ja(ee),s.D(ee,P),!(d.h.yc(k,P)<=q&&((y||v||_)&&a.write(ee,1),Z=!0,f)));ee=B.next());if(!Z&&(D=!1,y||f))return!1}else{if(y||f)return!1;D=!1}if(v&&D)return!1;if(f)return!0;for(I=0;I<s.I();I++)if(a.read(I)==1){if(v)return!0}else if(y||_)return!1;return!v},l.gI=function(s,a,c){if(s.I()>a.I())var f=a;else f=s,s=a;a=new d.l;var y=new d.l,v=new d.l;f.A(a),s.A(y),a.W(c,c),y.W(c,c),v.K(a),v.Ea(y),y=new d.h;for(var _=new d.h,$=c*c,I=d.ta.oE(s,v),k=I.getIterator(),A=0;A<f.I();A++)if(f.D(A,y),v.contains(y)){a.K(y.x,y.y,y.x,y.y),k.Xi(a,c);for(var P=k.next();P!=-1;P=k.next())if(s.D(I.ja(P),_),d.h.yc(y,_)<=$)return!0}return!1},l.Wz=function(s,a,c,f){return l.ym(s,a,c,f)&&l.ym(a,s,c,f)},l.ym=function(s,a,c,f){function y(je,Ae){return P.QE(je,Ae)}var v,_=!0,$=[0,0],I=[0,0],k=0,A=new d.ia(0),P=new l,D=new d.l,j=new d.l,B=new d.l;s.A(D),a.A(j),D.W(c,c),j.W(c,c),B.K(D),B.Ea(j),s=s.Ga(),j=a.Ga();var q=null,z=q=null,Z=a.Bb;for(Z!=null?(q=Z.Fb,z=Z.zo,q==null&&(q=d.ta.jj(a,B))):q=d.ta.jj(a,B),a=q.getIterator(),Z=null,z!=null&&(Z=z.getIterator());s.$a();)for(;s.Ha();){var ee=!1,Q=s.ha();if(Q.A(D),!D.isIntersecting(B)||Z!=null&&(Z.Xi(D,c),Z.next()==-1))return!1;for(z=Q.Qb(),a.Uo(Q,c),v=a.next();v!=-1;v=a.next()){j.Vb(q.ja(v)),v=j.ha();var le=Q.Ea(v,null,$,I,c);if(le==2&&(!f||I[0]<=I[1])){le=$[0];var se=$[1],ve=I[0],xe=I[1];if(le*z<=c&&(1-se)*z<=c){ee=!0,k=0,A.resize(0),P.rh.length=0;var _e=s.wb();for(ve=!0;ve;){if(s.Ha()){if(z=(Q=s.ha()).Qb(),(le=Q.Ea(v,null,$,I,c))==2&&(!f||I[0]<=I[1])&&(le=$[0],se=$[1],le*z<=c&&(1-se)*z<=c)){_e=s.wb();continue}if(j.Ha()&&(v=j.ha(),(le=Q.Ea(v,null,$,I,c))==2&&(!f||I[0]<=I[1])&&(le=$[0],se=$[1],le*z<=c&&(1-se)*z<=c))){_e=s.wb();continue}}ve=!1}_e!=s.wb()&&(s.Vb(_e),s.ha());break}_e=s.wb(),v=x.construct(_e,s.gb,le,se,j.wb(),j.gb,ve,xe),P.rh.push(v),A.add(A.size)}}if(!ee){if(k==P.rh.length)return!1;for(1<A.size-k&&A.Vd(k,A.size,y),ee=0;k<P.rh.length;k++)if(!((v=P.rh[A.get(k)]).Kj<ee&&v.Si<ee)){if(z*(v.Kj-ee)>c)return!1;if(z*(1-(ee=v.Si))<=c||ee==1)break}if(z*(1-ee)>c)return!1;k=0,A.resize(0),P.rh.length=0}}return _},l.WG=function(s,a,c){if(1>l.Xz(s,a,c,null))return!1;var f=new d.l,y=new d.l;s.A(f),a.A(y);var v=l.ls(f,y,c);return f=l.ls(y,f,c),!(!v||!f)||(v&&!f?!l.ym(a,s,c,!1):f&&!v?!l.ym(s,a,c,!1):!l.ym(s,a,c,!1)&&!l.ym(a,s,c,!1))},l.Xz=function(s,a,c,f){function y(Ne,xi){return D.QE(Ne,xi)}if(s.yz()>a.yz())var v=a,_=s;else v=s,_=a;s=v.Ga(),a=_.Ga();var $=[0,0],I=[0,0],k=-1,A=0,P=new d.ia(0),D=new l,j=new d.l,B=new d.l,q=new d.l;v.A(j),_.A(B),j.W(c,c),B.W(c,c),q.K(j),q.Ea(B),v=null,f!=null&&(v=new d.h);var z=B=B=null,Z=_.Bb;for(Z!=null?(B=Z.Fb,z=Z.zo,B==null&&(B=d.ta.jj(_,q))):B=d.ta.jj(_,q),_=B.getIterator(),Z=null,z!=null&&(Z=z.getIterator());s.$a();)for(z=0;s.Ha();){var ee=s.ha();if(ee.A(j),j.isIntersecting(q)){if(Z!=null&&(Z.Xi(j,c),Z.next()==-1))continue;var Q=ee.Qb();_.Uo(ee,c);for(var le=_.next();le!=-1;le=_.next()){var se=B.ja(le);a.Vb(se);var ve=a.ha(),xe=ve.Qb(),_e=ee.Ea(ve,null,$,I,c);if(0<_e){le=$[0],k=I[0];var je=_e==2?$[1]:NaN,Ae=_e==2?I[1]:NaN;if(_e==2){if(Q*(je-le)>c)return 1;var st=Q*(je-le);if(a.Ha()){if(ve=a.ha(),(_e=ee.Ea(ve,null,$,null,c))==2){_e=$[0];var it=$[1];if(st+(_e=Q*(it-_e))>c)return 1}a.Vb(se),a.ha()}if(!a.vm()){if(a.li(),ve=a.li(),(_e=ee.Ea(ve,null,$,null,c))==2&&(_e=$[0],st+(_e=Q*((it=$[1])-_e))>c))return 1;a.Vb(se),a.ha()}if(s.Ha()){if(se=s.wb(),(_e=(ee=s.ha()).Ea(ve,null,$,null,c))==2&&(_e=$[0],st+(_e=Q*((it=$[1])-_e))>c))return 1;s.Vb(se),s.ha()}if(!s.vm()){if(se=s.wb(),s.li(),(_e=(ee=s.li()).Ea(ve,null,$,null,c))==2&&(_e=$[0],st+(_e=xe*((it=$[1])-_e))>c))return 1;s.Vb(se),s.ha()}ve=x.construct(s.wb(),s.gb,le,je,a.wb(),a.gb,k,Ae),D.rh.push(ve),P.add(P.size)}k=0,f!=null&&(ee.hc(le,v),f.add(v.x),f.add(v.y))}}if(A<D.rh.length){for(P.Vd(A,P.size,y),ee=0,le=D.rh[P.get(A)].Mm;A<D.rh.length;A++)if(!((ve=D.rh[P.get(A)]).Kj<ee&&ve.Si<ee))if(Q*(ve.Kj-ee)>c)z=Q*(ve.Si-ve.Kj),ee=ve.Si,le=ve.Mm;else{if(ve.Mm!=le?(z=Q*(ve.Si-ve.Kj),le=ve.Mm):z+=Q*(ve.Si-ve.Kj),z>c)return 1;if((ee=ve.Si)==1)break}Q*(1-ee)>c&&(z=0),A=0,P.resize(0),D.rh.length=0}}}return k},l.UG=function(s,a,c){var f=s.Ga(),y=a.Ga();for(s=new d.Zl(s,a,c,!1);s.next();){a=s.nl();var v=s.hl();if(f.Vb(a),y.Vb(v),a=f.ha(),0<y.ha().Ea(a,null,null,null,c))return!0}return!1},l.VG=function(s,a,c,f){var y=s.Ga(),v=new d.l,_=new d.l,$=new d.l;s.A(v),a.A(_),v.W(c,c),v.contains(_),_.W(c,c),$.K(v),$.Ea(_),(v=s.Bb)!=null?(v=v.Fb)==null&&(v=d.ta.jj(s,$)):v=d.ta.jj(s,$),s=v.getIterator();for(var I=new d.h,k=new d.h,A=c*c,P=0;P<a.I();P++)if(a.D(P,I),$.contains(I)){_.K(I.x,I.y,I.x,I.y),s.Xi(_,c);for(var D=!1,j=s.next();j!=-1;j=s.next())if(y.Vb(v.ja(j)),(j=y.ha()).hc(j.fe(I,!1),k),d.h.yc(k,I)<=A){D=!0;break}if(f){if(!D)return!1}else if(D)return!0}return!!f},l.Yz=function(s,a,c){var f=new d.h,y=c*c,v=s.Ga();if((s=s.Bb)!=null&&(s=s.Fb)!=null){var _=new d.l;for(_.K(a),_=(c=s.MF(_,c)).next();_!=-1;_=c.next())if(v.Vb(s.ja(_)),v.Ha()){var $=(_=v.ha()).fe(a,!1);if(_.hc($,f),d.h.yc(a,f)<=y)return!0}return!1}for(s=new d.l;v.$a();)for(;v.Ha();)if((_=v.ha()).A(s),s.W(c,c),s.contains(a)&&($=_.fe(a,!1),_.hc($,f),d.h.yc(a,f)<=y))return!0;return!1},l.SG=function(s,a,c){return l.Yz(s,a,c)&&!l.Zz(s,a,c)},l.Zz=function(s,a,c){return s=s.mg(),!l.kt(s,a,c)},l.TG=function(s,a,c){if(s.tm()){var f=new d.yb(a.v,a.G,a.v,a.H),y=new d.yb(a.v,a.H,a.C,a.H),v=new d.yb(a.C,a.H,a.C,a.G);for(a=new d.yb(a.C,a.G,a.v,a.G),s=s.Ga();s.$a();)for(;s.Ha();){var _=s.ha();if(_.isIntersecting(f,c)||_.isIntersecting(y,c)||_.isIntersecting(v,c)||_.isIntersecting(a,c))return!0}}else{(f=new d.l).K(a),f.W(c,c),c=s.ub(0),y=new d.h,v=new d.h,a=new d.h,_=new d.h;for(var $=0,I=s.da();$<I;$++)for(var k=!0,A=s.Ba($),P=s.Vc($);A<P;A++)if(k)c.tc(2*A,v),k=!1;else{if(c.tc(2*A,y),a.L(v),_.L(y),f.zy(a,_)!=0)return!0;v.L(y)}}return!1},l.qc=function(s,a,c){var f=s.getType(),y=a.getType();if(d.aa.xj(f)){var v=s.Bb;if(v!=null&&(v=v.Fk)!=null)if(y==33){var _=a.D();if((_=v.So(_.x,_.y))==1)return 1;if(_==0)return 4}else{if(_=new d.l,a.A(_),(_=v.Ro(_))==1)return 1;if(_==0)return 4;if(c&&d.aa.xj(y)&&l.HE(a,v))return 1073741824}}if(d.aa.xj(y)&&(v=a.Bb)!=null&&(v=v.Fk)!=null)if(f==33){if(s=s.D(),(_=v.So(s.x,s.y))==1)return 2;if(_==0)return 4}else{if(a=new d.l,s.A(a),(_=v.Ro(a))==1)return 2;if(_==0)return 4;if(c&&d.aa.xj(f)&&l.HE(s,v))return 1073741824}return 0},l.HE=function(s,a){for(var c=s.I(),f=new d.h,y=0;y<c;y++)if(s.D(y,f),a.So(f.x,f.y)==1)return!0;return!1},l.II=function(s,a,c,f){for(var y=1<=s.om(0)&&1<=a.om(0),v=s.Ga(),_=a.Ga(),$=[0,0],I=[0,0],k=new d.Zl(s,a,c,!1),A=!1;k.next();){var P=k.nl(),D=k.hl();if(v.Vb(P),_.Vb(D),P=v.ha(),(D=_.ha().Ea(P,null,I,$,c))==2){if(A=$[0],D=$[1],P=P.Qb(),y&&(D-A)*P>c)return!1;A=!0}else if(D!=0){if(A=$[0],P=I[0],0<A&&1>A&&0<P&&1>P)return!1;A=!0}}return!!A&&(v=new d.l,_=new d.l,y=new d.l,s.A(v),a.A(_),v.W(1e3*c,1e3*c),_.W(1e3*c,1e3*c),y.K(v),y.Ea(_),!(10<s.I()&&(s=d.Ud.clip(s,y,c,0),s.B())||10<a.I()&&(a=d.Ud.clip(a,y,c,0),a.B()))&&d.am.rt(s,a,c,"F********",f))},l.FI=function(s,a,c,f){var y=1<=s.om(0)&&1<=a.om(0),v=new d.l,_=new d.l,$=new d.l;s.A(v),a.A(_);for(var I=!1,k=l.ls(v,_,c),A=l.ls(_,v,c),P=s.Ga(),D=a.Ga(),j=[0,0],B=[0,0],q=new d.Zl(s,a,c,!1);q.next();){var z=q.nl(),Z=q.hl();if(P.Vb(z),D.Vb(Z),Z=P.ha(),(z=D.ha().Ea(Z,null,B,j,c))==2){z=j[0];var ee=j[1];if(Z=Z.Qb(),y&&(ee-z)*Z>c&&(I=!0,k&&A))return!0}else if(z!=0&&(z=j[0],Z=B[0],0<z&&1>z&&0<Z&&1>Z))return!0}if(y=new d.l,P=new d.l,y.K(v),y.W(1e3*c,1e3*c),P.K(_),P.W(1e3*c,1e3*c),$.K(y),$.Ea(P),v="",v=I?v+"**":v+"T*",k){if(10<a.I()&&(a=d.Ud.clip(a,$,c,0)).B())return!1;v+="****"}else v+="T***";if(A){if(10<s.I()&&(s=d.Ud.clip(s,$,c,0)).B())return!1;v+="***"}else v+="T**";return d.am.rt(s,a,c,v.toString(),f)},l.BI=function(s,a,c,f){var y=[!1],v=l.zI(s,a,c,y);return y[0]?v:(y=new d.l,a.A(y),y.W(1e3*c,1e3*c),!(10<s.I()&&(s=d.Ud.clip(s,y,c,0),s.B()))&&d.am.Sw(s,a,c,f))},l.zI=function(s,a,c,f){f[0]=!1;for(var y=s.Ga(),v=a.Ga(),_=[0,0],$=[0,0],I=new d.Zl(s,a,c,!1),k=!1;I.next();){var A=I.nl(),P=I.hl();if(y.Vb(A,-1),v.Vb(P,-1),A=y.ha(),(A=v.ha().Ea(A,null,$,_,c))!=0&&(k=!0,A==1&&(A=_[0],P=$[0],0<A&&1>A&&0<P&&1>P)))return f[0]=!0,!1}if(!k){for(f[0]=!0,_=new d.l,s.A(_),_.W(c,c),I=s,k=!1,$=new d.l,f=0,y=a.da();f<y;f++)if(0<a.Ja(f)){if(a.Rj(f,$),!_.isIntersecting($)||(v=a.Na(a.Ba(f)),(v=d.Dg.wm(I,v,0))==0))return!1;k||(!d.Dg.Ml(s,a.da()-1)||s.Bb!=null&&s.Bb.Fb!=null?I=s:(v=new d.Da,s.copyTo(v),v.fj(1),I=v),k=!0)}if(s.da()==1||a.getType()==1607)return!0;for(_=new d.l,a.A(_),_.W(c,c),$=a,I=!1,c=new d.l,f=0,y=s.da();f<y;f++)if(0<s.Ja(f)){if(s.Rj(f,c),_.isIntersecting(c)&&(v=s.Na(s.Ba(f)),(v=d.Dg.wm($,v,0))==1))return!1;I||(!d.Dg.Ml(a,s.da()-1)||a.Bb!=null&&a.Bb.Fb!=null?$=a:(v=new d.Da,a.copyTo(v),v.fj(1),$=v),I=!0)}return!0}return!1},l.JI=function(s,a,c,f){for(var y=s.Ga(),v=a.Ga(),_=[0,0],$=[0,0],I=new d.Zl(s,a,c,!1),k=!1;I.next();){var A=I.nl(),P=I.hl();if(y.Vb(A),v.Vb(P),A=y.ha(),(A=v.ha().Ea(A,null,$,_,c))==2)k=!0;else if(A!=0){if(k=_[0],A=$[0],0<k&&1>k&&0<A&&1>A)return!1;k=!0}}return!!k&&(v=new d.l,_=new d.l,y=new d.l,s.A(v),a.A(_),v.W(1e3*c,1e3*c),_.W(1e3*c,1e3*c),y.K(v),y.Ea(_),!(10<s.I()&&(s=d.Ud.clip(s,y,c,0),s.B())||10<a.I()&&(a=d.Ud.clip(a,y,c,0),a.B()))&&d.am.$m(s,a,c,"F********",f))},l.DI=function(s,a,c,f){for(var y=s.Ga(),v=a.Ga(),_=[0,0],$=[0,0],I=new d.Zl(s,a,c,!1),k=!1;I.next();){var A=I.nl(),P=I.hl();if(y.Vb(A),v.Vb(P),A=y.ha(),(A=v.ha().Ea(A,null,$,_,c))==2)k=!0;else if(A!=0){if(k=_[0],A=$[0],0<k&&1>k&&0<A&&1>A)return!0;k=!0}}return!!k&&(v=new d.l,_=new d.l,$=new d.l,I=new d.l,y=new d.l,s.A(v),a.A(_),l.ls(_,v,c)?($.K(v),$.W(1e3*c,1e3*c),I.K(_),I.W(1e3*c,1e3*c),y.K($),y.Ea(I),!(10<s.I()&&(s=d.Ud.clip(s,y,c,0),s.B())||10<a.I()&&(a=d.Ud.clip(a,y,c,0),a.B()))&&(c=d.am.$m(s,a,c,"T********",f))):c=d.am.$m(s,a,c,"T*****T**",f))},l.CI=function(s,a,c,f){var y=[!1],v=l.zI(s,a,c,y);return y[0]?v:(y=new d.l,a.A(y),y.W(1e3*c,1e3*c),!(10<s.I()&&(s=d.Ud.clip(s,y,c,0),s.B()))&&d.am.fB(s,a,c,f))},l.AI=function(s,a,c){return d.hd.Yd(s,a,c)==1},l.HI=function(s,a,c){return d.hd.Yd(s,a,c)==2},l.kt=function(s,a,c){var f=new d.h;c*=c;for(var y=0;y<s.I();y++)if(s.D(y,f),d.h.yc(f,a)<=c)return!1;return!0},l.prototype.QE=function(s,a){return s=this.rh[s],a=this.rh[a],s.Mm<a.Mm||s.Mm==a.Mm&&(s.pw<a.pw||s.pw==a.pw&&(s.Kj<a.Kj||s.Kj==a.Kj&&(s.Si<a.Si||s.Si==a.Si&&s.BH<a.BH)))?-1:1},l}();d.ud=h}(Y||(Y={})),function(d){var O,x,h;(x=O||(O={}))[x.InteriorInterior=0]="InteriorInterior",x[x.InteriorBoundary=1]="InteriorBoundary",x[x.InteriorExterior=2]="InteriorExterior",x[x.BoundaryInterior=3]="BoundaryInterior",x[x.BoundaryBoundary=4]="BoundaryBoundary",x[x.BoundaryExterior=5]="BoundaryExterior",x[x.ExteriorInterior=6]="ExteriorInterior",x[x.ExteriorBoundary=7]="ExteriorBoundary",x[x.ExteriorExterior=8]="ExteriorExterior",function(l){l[l.AreaAreaPredicates=0]="AreaAreaPredicates",l[l.AreaLinePredicates=1]="AreaLinePredicates",l[l.LineLinePredicates=2]="LineLinePredicates",l[l.AreaPointPredicates=3]="AreaPointPredicates",l[l.LinePointPredicates=4]="LinePointPredicates",l[l.PointPointPredicates=5]="PointPointPredicates"}(h||(h={})),O=function(){function l(){this.le=0,this.j=new d.iu,this.J=[0,0,0,0,0,0,0,0,0],this.Za=[0,0,0,0,0,0,0,0,0],this.ea=[!1,!1,!1,!1,!1,!1,!1,!1,!1],this.Sm=this.vw=-1}return l.yB=function(s,a,c,f,y){if(f.length!=9)throw d.i.fa("relation string length has to be 9 characters");for(var v=0;9>v;v++){var _=f.charAt(v);if(_!="*"&&_!="T"&&_!="F"&&_!="0"&&_!="1"&&_!="2")throw d.i.fa("relation string")}if((v=this.MR(f,s.Db(),a.Db()))!=0)return d.ud.zB(s,a,c,v,y);v=new d.l,s.A(v),_=new d.l,a.A(_);var $=new d.l;if($.K(v),$.Zb(_),c=d.ta.Wd(c,$,!1),s=this.WE(s,c),a=this.WE(a,c),s.B()||a.B())return this.uW(s,a,f);switch(v=s.getType(),_=a.getType(),$=!1,v){case 1736:switch(_){case 1736:$=this.rt(s,a,c,f,y);break;case 1607:$=this.$m(s,a,c,f,y);break;case 33:$=this.qt(s,a,c,f);break;case 550:$=this.pt(s,a,c,f,y)}break;case 1607:switch(_){case 1736:$=this.$m(a,s,c,this.Zp(f),y);break;case 1607:$=this.gB(s,a,c,f,y);break;case 33:$=this.tt(s,a,c,f,y);break;case 550:$=this.st(s,a,c,f,y)}break;case 33:switch(_){case 1736:$=this.qt(a,s,c,this.Zp(f));break;case 1607:$=this.tt(a,s,c,this.Zp(f),y);break;case 33:$=this.$U(s,a,c,f);break;case 550:$=this.lt(a,s,c,this.Zp(f))}break;case 550:switch(_){case 1736:$=this.pt(a,s,c,this.Zp(f),y);break;case 1607:$=this.st(a,s,c,this.Zp(f),y);break;case 550:$=this.ZA(s,a,c,f,y);break;case 33:$=this.lt(s,a,c,f)}break;default:$=!1}return $},l.rt=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.xJ();var _=new d.l,$=new d.l;return s.A(_),a.A($),f=!1,d.ud.dk(_,$,c)&&(v.Cu(s,a),f=!0),f||((_=d.ud.qc(s,a,!1))==4?(v.Cu(s,a),f=!0):_==1?(v.ly(a),f=!0):_==2&&(v.ZD(s),f=!0)),f||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.Bp(s,a),v.j.Ug()),l.fg(v.J,v.Xc)},l.Sw=function(s,a,c,f){var y=new l;y.Yi(),y.bj("T*****F**"),y.xJ();var v=new d.l,_=new d.l;s.A(v),a.A(_);var $=!1;return d.ud.dk(v,_,c)&&(y.Cu(s,a),$=!0),$||((v=d.ud.qc(s,a,!1))==4?(y.Cu(s,a),$=!0):v==1?(y.ly(a),$=!0):v==2&&(y.ZD(s),$=!0)),$?this.fg(y.J,y.Xc):(s=($=new d.gd).Ib(s),v=$.Ib(a),d.Tk.V($,c,f,!1),c=$.Ne(v).mg(),$.Gp(0,!0,!0),d.rn.V($,s,-1,!1,f),$.I(s)!=0&&(d.rn.V($,v,-1,!1,f),y.er($,f),(a=$.I(v)==0)||(y.Bp(s,v),y.j.Ug(),v=this.fg(y.J,y.Xc))?(s=$.Ne(s),s=($=new d.gd).Ib(s),v=$.Ib(c),y.er($,f),y.le=0,y.Yi(),y.bj(a?"T*****F**":"******F**"),y.IB(),y.Bp(s,v),y.j.Ug(),this.fg(y.J,y.Xc)):v))},l.$m=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.IB();var _=new d.l,$=new d.l;return s.A(_),a.A($),f=!1,d.ud.dk(_,$,c)&&(v.Du(s,a),f=!0),f||((_=d.ud.qc(s,a,!1))==4?(v.Du(s,a),f=!0):_==1&&(v.$D(a),f=!0)),f||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.kh=v.j.Dp(),l.Jw(a,v.j,v.kh),v.Bp(s,a),v.j.Ep(v.kh),v.j.Ug()),l.fg(v.J,v.Xc)},l.fB=function(s,a,c,f){var y=new l;y.Yi(),y.bj("T*****F**"),y.IB();var v=new d.l,_=new d.l;s.A(v),a.A(_);var $=!1;return d.ud.dk(v,_,c)&&(y.Du(s,a),$=!0),$||((v=d.ud.qc(s,a,!1))==4?(y.Du(s,a),$=!0):v==1&&(y.$D(a),$=!0)),$?this.fg(y.J,y.Xc):(s=($=new d.gd).Ib(s),a=$.Ib(a),y.Wo($,c,f),$.I(s)!=0&&(y.Bp(s,a),y.j.Ug(),this.fg(y.J,y.Xc)))},l.pt=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.yJ();var _=new d.l,$=new d.l;return s.A(_),a.A($),f=!1,d.ud.dk(_,$,c)&&(v.Eu(s),f=!0),f||((_=d.ud.qc(s,a,!1))==4?(v.Eu(s),f=!0):_==1&&(v.zN(),f=!0)),f||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.Gy(s,a),v.j.Ug()),l.fg(v.J,v.Xc)},l.gB=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.eX(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var $=!1;return d.ud.dk(f,_,c)&&(v.PG(s,a),$=!0),$||d.ud.qc(s,a,!1)!=4||(v.PG(s,a),$=!0),$||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.Yh=v.j.Dp(),v.kh=v.j.Dp(),l.Jw(s,v.j,v.Yh),l.Jw(a,v.j,v.kh),v.Bp(s,a),v.j.Ep(v.Yh),v.j.Ep(v.kh),v.j.Ug()),l.fg(v.J,v.Xc)},l.st=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.MJ(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var $=!1;return d.ud.dk(f,_,c)&&(v.Vz(s),$=!0),$||d.ud.qc(s,a,!1)!=4||(v.Vz(s),$=!0),$||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.Yh=v.j.Dp(),l.Jw(s,v.j,v.Yh),v.Gy(s,a),v.j.Ep(v.Yh),v.j.Ug()),l.fg(v.J,v.Xc)},l.ZA=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.RJ(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var $=!1;return d.ud.dk(f,_,c)&&(v.yI(),$=!0),$||(s=(f=new d.gd).Ib(s),a=f.Ib(a),v.Wo(f,c,y),v.Gy(s,a),v.j.Ug()),l.fg(v.J,v.Xc)},l.qt=function(s,a,c,f){var y=new l;y.Yi(),y.bj(f),y.yJ();var v=new d.l;s.A(v),a=a.D();var _=!1;return d.ud.Rw(a,v,c)&&(y.Eu(s),_=!0),_||((c=d.hd.Yd(s,a,c))==1?(y.J[0]=0,y.J[2]=2,y.J[3]=-1,y.J[5]=1,y.J[6]=-1):c==2?(y.J[6]=-1,s.Ke()!=0?(y.J[0]=-1,y.J[3]=0,y.J[2]=2,y.J[5]=1):(y.J[0]=0,y.J[3]=-1,y.J[5]=-1,c=new d.l,s.A(c),y.J[2]=c.ca()==0&&c.R()==0?-1:1)):y.Eu(s)),this.fg(y.J,f)},l.tt=function(s,a,c,f,y){var v=new l;v.Yi(),v.bj(f),v.MJ();var _=new d.l;s.A(_),f=a.D();var $=!1;if(d.ud.Rw(f,_,c)&&(v.Vz(s),$=!0),!$){_=null;var I=$=!1;(v.ea[0]||v.ea[6])&&(d.ud.Yz(s,f,c)?(v.ea[0]&&(_=d.pi.gm(s,y),I=!d.ud.kt(_,f,c),$=!0,v.J[0]=I?-1:0),v.J[6]=-1):(v.J[0]=-1,v.J[6]=0)),v.ea[3]&&(_!=null&&_.B()?v.J[3]=-1:($||(_==null&&(_=d.pi.gm(s,y)),I=!d.ud.kt(_,f,c),$=!0),v.J[3]=I?0:-1)),v.ea[5]&&(_!=null&&_.B()?v.J[5]=-1:$&&!I?v.J[5]=0:(_==null&&(_=d.pi.gm(s,y)),y=d.ud.Nw(_,a,c),v.J[5]=y?-1:0)),v.ea[2]&&(s.Qb()!=0?v.J[2]=1:((y=new d.de(s.description)).Fd(s,0,s.I()),s=d.ud.Nw(y,a,c),v.J[2]=s?-1:0))}return this.fg(v.J,v.Xc)},l.lt=function(s,a,c,f){var y=new l;y.Yi(),y.bj(f),y.RJ();var v=new d.l;s.A(v),a=a.D();var _=!1;if(d.ud.Rw(a,v,c)&&(y.yI(),_=!0),!_){v=!1,_=!0,c*=c;for(var $=0;$<s.I();$++){var I=s.Na($);if(d.h.yc(I,a)<=c?v=!0:_=!1,v&&!_)break}v?(y.J[0]=0,y.J[2]=_?-1:0,y.J[6]=-1):(y.J[0]=-1,y.J[2]=0,y.J[6]=0)}return l.fg(y.J,f)},l.$U=function(s,a,c,f){s=s.D(),a=a.D();for(var y=[],v=0;9>v;v++)y[v]=-1;return d.h.yc(s,a)<=c*c?y[0]=0:(y[2]=0,y[6]=0),y[8]=2,l.fg(y,f)},l.fg=function(s,a){for(var c=0;9>c;c++)switch(a.charAt(c)){case"T":if(s[c]==-1)return!1;break;case"F":if(s[c]!=-1)return!1;break;case"0":if(s[c]!=0)return!1;break;case"1":if(s[c]!=1)return!1;break;case"2":if(s[c]!=2)return!1}return!0},l.uW=function(s,a,c){var f=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(s.B()&&a.B()){for(var y=0;9>y;y++)f[y]=-1;return this.fg(f,c)}return y=!1,s.B()&&(s=a,y=!0),f[0]=-1,f[1]=-1,f[3]=-1,f[4]=-1,f[6]=-1,f[7]=-1,f[8]=2,a=s.getType(),d.aa.Hc(a)?a==1736?s.Ke()!=0?(f[2]=2,f[5]=1):(f[5]=-1,a=new d.l,s.A(a),f[2]=a.ca()==0&&a.R()==0?0:1):(a=s.Qb()!=0,f[2]=a?1:0,f[5]=d.pi.aq(s)?0:-1):(f[2]=0,f[5]=-1),y&&this.vK(f),this.fg(f,c)},l.MR=function(s,a,c){return l.dQ(s)?3:l.UP(s)?4:l.cY(s,a,c)?8:l.CP(s,a,c)?16:l.eP(s)?1:l.EU(s,a,c)?32:0},l.dQ=function(s){return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="F"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="F"&&s.charAt(6)=="F"&&s.charAt(7)=="F"&&s.charAt(8)=="*"},l.UP=function(s){return s.charAt(0)=="F"&&s.charAt(1)=="F"&&s.charAt(2)=="*"&&s.charAt(3)=="F"&&s.charAt(4)=="F"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"},l.cY=function(s,a,c){return(a!=0||c!=0)&&((a!=2||c!=2)&&(s.charAt(0)=="F"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="T"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"||a==1&&c==1&&s.charAt(0)=="F"&&s.charAt(1)=="T"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*")||c!=0&&s.charAt(0)=="F"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="T"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*")},l.CP=function(s,a,c){return a>c?s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*":a==1&&c==1&&s.charAt(0)=="0"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"},l.eP=function(s){return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="F"&&s.charAt(7)=="F"&&s.charAt(8)=="*"},l.EU=function(s,a,c){if(a==c){if(a!=1)return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="T"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*";if(s.charAt(0)=="1"&&s.charAt(1)=="*"&&s.charAt(2)=="T"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*")return!0}return!1},l.Jw=function(s,a,c){s=a.La(s);for(var f=a.Re;f!=-1;f=a.Rf(f))if(a.xd(f)&s){var y=a.Me(f);if(y==-1)a.nn(f,c,0);else{var v=y,_=0;do a.dh(v)&s&&_++,v=a.jc(a.xa(v));while(v!=y);a.nn(f,c,_)}}},l.Zp=function(s){var a=""+s.charAt(0);return a+=s.charAt(3),a+=s.charAt(6),a+=s.charAt(1),a+=s.charAt(4),a+=s.charAt(7),a+=s.charAt(2),(a+=s.charAt(5))+s.charAt(8)},l.prototype.Yi=function(){for(var s=0;9>s;s++)this.J[s]=-2,this.Za[s]=-2},l.vK=function(s){var a=s[1],c=s[2],f=s[5];s[1]=s[3],s[2]=s[6],s[5]=s[7],s[3]=a,s[6]=c,s[7]=f},l.prototype.bj=function(s){for(this.Xc=s,s=0;9>s;s++)this.Xc.charAt(s)!="*"?(this.ea[s]=!0,this.le++):this.ea[s]=!1},l.prototype.UJ=function(){for(var s=0;9>s;s++)this.ea[s]&&this.J[s]==-2&&(this.J[s]=-1,this.ea[s]=!1)},l.prototype.pc=function(s){return this.J[s]!=-2&&(this.J[s]==-1?(this.ea[s]=!1,this.le--,!0):this.Xc.charAt(s)!="T"&&this.Xc.charAt(s)!="F"?!(this.J[s]<this.Za[s])&&(this.ea[s]=!1,this.le--,!0):(this.ea[s]=!1,this.le--,!0))},l.prototype.xJ=function(){this.vw=0,this.Za[0]=2,this.Za[1]=1,this.Za[2]=2,this.Za[3]=1,this.Za[4]=1,this.Za[5]=1,this.Za[6]=2,this.Za[7]=1,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.IB=function(){this.vw=1,this.Sm=3,this.Za[0]=1,this.Za[1]=0,this.Za[2]=2,this.Za[3]=1,this.Za[4]=0,this.Za[5]=1,this.Za[6]=1,this.Za[7]=0,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.eX=function(){this.vw=2,this.Sm=4,this.Za[0]=1,this.Za[1]=0,this.Za[2]=1,this.Za[3]=0,this.Za[4]=0,this.Za[5]=0,this.Za[6]=1,this.Za[7]=0,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.yJ=function(){this.Sm=3,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=2,this.Za[3]=0,this.Za[4]=-1,this.Za[5]=1,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.MJ=function(){this.Sm=4,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=1,this.Za[3]=0,this.Za[4]=-1,this.Za[5]=0,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.RJ=function(){this.Sm=5,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=0,this.Za[3]=-1,this.Za[4]=-1,this.Za[5]=-1,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[3]&&(this.J[3]=-1,this.ea[3]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[5]&&(this.J[5]=-1,this.ea[5]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},l.prototype.xN=function(s,a,c){var f=!0;return this.ea[0]&&(this.CS(s,a,c),f=f&&this.pc(0)),this.ea[1]&&(this.sG(s,a,1),f=f&&this.pc(1)),this.ea[2]&&(this.tG(s,a,c,2),f=f&&this.pc(2)),this.ea[3]&&(this.sG(s,c,3),f=f&&this.pc(3)),this.ea[4]&&(this.BN(s,a,c),f=f&&this.pc(4)),this.ea[5]&&(this.eE(s,c,5),f=f&&this.pc(5)),this.ea[6]&&(this.tG(s,c,a,6),f=f&&this.pc(6)),this.ea[7]&&(this.eE(s,a,7),f=f&&this.pc(7)),f},l.prototype.Cu=function(s,a){this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.Fr(s,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5)),this.Fr(a,this.ea[6]?6:-1,this.Xc.charAt(6),this.ea[7]?7:-1,this.Xc.charAt(7))},l.prototype.Fr=function(s,a,c,f,y){a==-1&&f==-1||((c!="T"&&c!="F"&&a!=-1||y!="T"&&y!="F"&&f!=-1)&&s.Ke()==0?(f!=-1&&(this.J[f]=-1),a!=-1&&(c=new d.l,s.A(c),this.J[a]=c.ca()==0&&c.R()==0?0:1)):(a!=-1&&(this.J[a]=2),f!=-1&&(this.J[f]=1)))},l.prototype.ly=function(s){this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1,this.Fr(s,this.ea[0]?0:-1,this.Xc.charAt(0),this.ea[1]?1:-1,this.Xc.charAt(1))},l.prototype.ZD=function(s){this.ly(s),l.vK(this.J)},l.prototype.Du=function(s,a){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.ea[6]){var c=this.Xc.charAt(6);c=c=="T"||c=="F"||a.Qb()!=0,this.J[6]=c?1:0}this.ea[7]&&(a=d.pi.aq(a),this.J[7]=a?0:-1),this.Fr(s,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5))},l.prototype.$D=function(s){if(this.ea[0]){var a=this.Xc.charAt(0);a=a=="T"||a=="F"||s.Qb()!=0,this.J[0]=a?1:0}this.ea[1]&&(s=d.pi.aq(s),this.J[1]=s?0:-1),this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1},l.prototype.Eu=function(s){this.J[0]=-1,this.J[3]=-1,this.J[6]=0,this.Fr(s,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5))},l.prototype.zN=function(){this.J[0]=0,this.J[2]=2,this.J[3]=-1,this.J[5]=1,this.J[6]=-1},l.prototype.PG=function(s,a){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.ea[2]){var c=this.Xc.charAt(2);c=c=="T"||c=="F"||s.Qb()!=0,this.J[2]=c?1:0}this.ea[5]&&(s=d.pi.aq(s),this.J[5]=s?0:-1),this.ea[6]&&(c=(c=this.Xc.charAt(6))=="T"||c=="F"||a.Qb()!=0,this.J[6]=c?1:0),this.ea[7]&&(a=d.pi.aq(a),this.J[7]=a?0:-1)},l.prototype.Vz=function(s){if(this.J[0]=-1,this.J[3]=-1,this.ea[2]){var a=this.Xc.charAt(2);a=a=="T"||a=="F"||s.Qb()!=0,this.J[2]=a?1:0}this.ea[5]&&(s=d.pi.aq(s),this.J[5]=s?0:-1),this.J[6]=0},l.prototype.yI=function(){this.J[0]=-1,this.J[2]=0,this.J[6]=0},l.prototype.yN=function(s,a,c){var f=!0;return this.ea[0]&&(this.DS(s,a),f=f&&this.pc(0)),this.ea[1]&&(this.zS(s,a,c,this.kh),f=f&&this.pc(1)),this.ea[2]&&(this.AS(s,a),f=f&&this.pc(2)),this.ea[3]&&(this.FN(s,a,c,this.kh),f=f&&this.pc(3)),this.ea[4]&&(this.CN(s,a,c,this.kh),f=f&&this.pc(4)),this.ea[5]&&(this.DN(s,a,c),f=f&&this.pc(5)),this.ea[6]&&(this.lQ(s,a),f=f&&this.pc(6)),this.ea[7]&&(this.kQ(s,a,c,this.kh),f=f&&this.pc(7)),f},l.prototype.mT=function(s,a,c){var f=!0;return this.ea[0]&&(this.GS(s,a,c,this.Yh,this.kh),f=f&&this.pc(0)),this.ea[1]&&(this.uG(s,a,c,this.Yh,this.kh,1),f=f&&this.pc(1)),this.ea[2]&&(this.vG(s,a,c,2),f=f&&this.pc(2)),this.ea[3]&&(this.uG(s,c,a,this.kh,this.Yh,3),f=f&&this.pc(3)),this.ea[4]&&(this.HN(s,a,c,this.Yh,this.kh),f=f&&this.pc(4)),this.ea[5]&&(this.fE(s,c,this.Yh,5),f=f&&this.pc(5)),this.ea[6]&&(this.vG(s,c,a,6),f=f&&this.pc(6)),this.ea[7]&&(this.fE(s,a,this.kh,7),f=f&&this.pc(7)),f},l.prototype.aE=function(s,a,c){var f=!0;return this.ea[0]&&(this.ES(s,a),f=f&&this.pc(0)),this.ea[2]&&(this.BS(s,a),f=f&&this.pc(2)),this.ea[3]&&(this.GN(s,a,c),f=f&&this.pc(3)),this.ea[5]&&(this.EN(s,a),f=f&&this.pc(5)),this.ea[6]&&(this.mQ(s,a),f=f&&this.pc(6)),f},l.prototype.QG=function(s,a,c){var f=!0;return this.ea[0]&&(this.HS(s,a,c,this.Yh),f=f&&this.pc(0)),this.ea[2]&&(this.FS(s,c),f=f&&this.pc(2)),this.ea[3]&&(this.JN(s,a,c,this.Yh),f=f&&this.pc(3)),this.ea[5]&&(this.IN(s,a,c,this.Yh),f=f&&this.pc(5)),this.ea[6]&&(this.nQ(s,a,c),f=f&&this.pc(6)),f},l.prototype.ZU=function(s,a,c){var f=!0;return this.ea[0]&&(this.IS(s,a,c),f=f&&this.pc(0)),this.ea[2]&&(this.wG(s,a,c,2),f=f&&this.pc(2)),this.ea[6]&&(this.wG(s,c,a,6),f=f&&this.pc(6)),f},l.prototype.CS=function(s,a,c){this.J[0]!=2&&(s=this.j.af(s))&a&&s&c&&(this.J[0]=2)},l.prototype.sG=function(s,a,c){if(this.J[c]!=1){var f=this.j.af(this.j.xa(s));this.j.af(s)&a&&f&a&&(this.J[c]=1)}},l.prototype.tG=function(s,a,c,f){this.J[f]!=2&&(s=this.j.af(s))&a&&!(s&c)&&(this.J[f]=2)},l.prototype.BN=function(s,a,c){if(this.J[4]!=1){var f=this.j.dh(s);f&a&&f&c?this.J[4]=1:this.J[4]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1&&(s=this.j.xd(this.j.uf(s)))&a&&s&c&&(this.J[4]=0)}},l.prototype.eE=function(s,a,c){if(this.J[c]!=1){var f=this.j.af(this.j.xa(s));!(this.j.af(s)&a)&&!(f&a)&&(this.J[c]=1)}},l.prototype.DS=function(s,a){if(this.J[0]!=1){var c=this.j.af(this.j.xa(s));this.j.af(s)&a&&c&a&&(this.J[0]=1)}},l.prototype.zS=function(s,a,c,f){if(this.J[1]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1){var y=this.j.uf(s),v=this.j.xd(y);!(v&a)&&this.j.af(s)&a&&(s=this.j.ng(y,f),v&c&&s%2!=0&&(this.J[1]=0))}},l.prototype.AS=function(s,a){this.J[2]!=2&&this.j.dh(s)&a&&(this.J[2]=2)},l.prototype.FN=function(s,a,c,f){if(this.J[3]!=1){var y=this.j.dh(s);y&a&&y&c?this.J[3]=1:this.J[3]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1&&(y=this.j.uf(s),(s=this.j.xd(y))&a&&(a=this.j.ng(y,f),s&c&&a%2==0&&(this.J[3]=0)))}},l.prototype.CN=function(s,a,c,f){if(this.J[4]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1){var y=this.j.uf(s);(s=this.j.xd(y))&a&&(a=this.j.ng(y,f),s&c&&a%2!=0&&(this.J[4]=0))}},l.prototype.DN=function(s,a,c){this.J[5]!=1&&(s=this.j.dh(s))&a&&!(s&c)&&(this.J[5]=1)},l.prototype.lQ=function(s,a){if(this.J[6]!=1){var c=this.j.af(this.j.xa(s));!(this.j.af(s)&a)&&!(c&a)&&(this.J[6]=1)}},l.prototype.kQ=function(s,a,c,f){if(this.J[7]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1){var y=this.j.uf(s),v=this.j.xd(y);!(v&a)&&!(this.j.af(s)&a)&&(s=this.j.ng(y,f),v&c&&s%2!=0&&(this.J[7]=0))}},l.prototype.GS=function(s,a,c,f,y){if(this.J[0]!=1){var v=this.j.dh(s);v&a&&v&c?this.J[0]=1:this.J[0]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1&&(s=this.j.uf(s),(v=this.j.xd(s))&a&&v&c&&(a=this.j.ng(s,f),y=this.j.ng(s,y),a%2==0&&y%2==0&&(this.J[0]=0)))}},l.prototype.uG=function(s,a,c,f,y,v){if(this.J[v]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1){s=this.j.uf(s);var _=this.j.xd(s);_&a&&_&c&&(a=this.j.ng(s,f),y=this.j.ng(s,y),a%2==0&&y%2!=0&&(this.J[v]=0))}},l.prototype.vG=function(s,a,c,f){this.J[f]!=1&&(s=this.j.dh(s))&a&&!(s&c)&&(this.J[f]=1)},l.prototype.HN=function(s,a,c,f,y){if(this.J[4]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1){s=this.j.uf(s);var v=this.j.xd(s);v&a&&v&c&&(a=this.j.ng(s,f),y=this.j.ng(s,y),a%2!=0&&y%2!=0&&(this.J[4]=0))}},l.prototype.fE=function(s,a,c,f){this.J[f]!=0&&this.j.Ab(this.j.te(this.j.xa(s)),this.Ui)!=1&&(s=this.j.uf(s),!(this.j.xd(s)&a)&&this.j.ng(s,c)%2!=0&&(this.J[f]=0))},l.prototype.ES=function(s,a){this.J[0]!=0&&!(this.j.xd(s)&a)&&this.j.hk(this.j.cz(s))&a&&(this.J[0]=0)},l.prototype.BS=function(s,a){this.J[2]!=2&&this.j.xd(s)&a&&(this.J[2]=2)},l.prototype.GN=function(s,a,c){this.J[3]!=0&&(s=this.j.xd(s))&a&&s&c&&(this.J[3]=0)},l.prototype.EN=function(s,a){this.J[5]!=1&&this.j.xd(s)&a&&(this.J[5]=1)},l.prototype.mQ=function(s,a){this.J[6]!=0&&!(this.j.xd(s)&a)&&!(this.j.hk(this.j.cz(s))&a)&&(this.J[6]=0)},l.prototype.HS=function(s,a,c,f){if(this.J[0]!=0){var y=this.j.xd(s);y&a&&y&c&&this.j.ng(s,f)%2==0&&(this.J[0]=0)}},l.prototype.FS=function(s,a){this.J[2]!=1&&(this.j.Me(s)!=-1?this.J[2]=1:this.J[2]!=0&&!(this.j.xd(s)&a)&&(this.J[2]=0))},l.prototype.JN=function(s,a,c,f){if(this.J[3]!=0){var y=this.j.xd(s);y&a&&y&c&&this.j.ng(s,f)%2!=0&&(this.J[3]=0)}},l.prototype.IN=function(s,a,c,f){if(this.J[5]!=0){var y=this.j.xd(s);y&a&&!(y&c)&&this.j.ng(s,f)%2!=0&&(this.J[5]=0)}},l.prototype.nQ=function(s,a,c){this.J[6]!=0&&!((s=this.j.xd(s))&a)&&s&c&&(this.J[6]=0)},l.prototype.IS=function(s,a,c){this.J[0]!=0&&(s=this.j.xd(s))&a&&s&c&&(this.J[0]=0)},l.prototype.wG=function(s,a,c,f){this.J[f]!=0&&(s=this.j.xd(s))&a&&!(s&c)&&(this.J[f]=0)},l.prototype.Bp=function(s,a){var c=!1;s=this.j.La(s),a=this.j.La(a),this.Ui=this.j.$g();for(var f=this.j.Re;f!=-1;f=this.j.Rf(f)){var y=this.j.Me(f);if(y==-1){if(this.Sm!=-1)switch(this.Sm){case 3:c=this.aE(f,s,a);break;case 4:c=this.QG(f,s,a);break;default:throw d.i.fa("internal error")}}else{var v=y;do{var _=v;if(this.j.Ab(_,this.Ui)!=1)do{switch(this.vw){case 0:c=this.xN(_,s,a);break;case 1:c=this.yN(_,s,a);break;case 2:c=this.mT(_,s,a);break;default:throw d.i.fa("internal error")}if(c)break;this.j.Kb(_,this.Ui,1),_=this.j.jc(_)}while(_!=v&&!c);if(c)break;v=this.j.jc(this.j.xa(_))}while(v!=y);if(c)break}}c||this.UJ(),this.j.Jg(this.Ui)},l.prototype.Gy=function(s,a){var c=!1;s=this.j.La(s),a=this.j.La(a);for(var f=this.j.Re;f!=-1;f=this.j.Rf(f)){switch(this.Sm){case 3:c=this.aE(f,s,a);break;case 4:c=this.QG(f,s,a);break;case 5:c=this.ZU(f,s,a);break;default:throw d.i.Qa()}if(c)break}c||this.UJ()},l.prototype.er=function(s,a){this.j.dr(s,a)},l.prototype.Wo=function(s,a,c){this.YP(s,a,c),this.er(s,c)},l.prototype.YP=function(s,a,c){for(d.Tk.V(s,a,c,!1),s.Gp(0,!0,!0),a=s.ld;a!=-1;a=s.ue(a))s.ic(a)==1736&&d.rn.V(s,a,-1,!1,c)},l.WE=function(s,a){var c=s.getType();return d.aa.yd(c)?((a=new d.Ta(s.description)).oc(s,!0),a):c==197?(c=new d.l,s.A(c),c.ca()<=a&&c.R()<=a?(a=new d.Sa(s.description),s.sf(a),a):c.ca()<=a||c.R()<=a?(a=new d.Ta(s.description),c=new d.Sa,s.Hf(0,c),a.nf(c),s.Hf(2,c),a.lineTo(c),a):((a=new d.Da(s.description)).ad(s,!1),a)):s},l}(),d.am=O}(Y||(Y={})),function(d){var O=function(){function l(s){this.Em=new d.ia(0),this.dw=new d.ia(0),this.wt=new d.h,this.xt=new d.h,this.g=s,this.Hs=-1}return l.prototype.bc=function(s){return this.g.bc(this.zz(s))},l.prototype.Bv=function(s){var a=this.iz(s);if(s=this.HF(s),this.g.Ma(a)==s){var c=a;a=s,s=c}return this.g.Gc(a,this.wt),this.g.Gc(s,this.xt),this.wt.y<this.xt.y},l.prototype.zz=function(s){var a=this.iz(s);return s=this.HF(s),this.g.U(a)==s?a:s},l.prototype.iz=function(s){return this.Em.get(s)},l.prototype.HF=function(s){return this.dw.get(s)},l.prototype.rF=function(s){this.Em.set(s,this.Hs),this.Hs=s},l.prototype.nI=function(s){if(this.Hs!=-1){var a=this.Hs;return this.Hs=this.Em.get(a),this.Em.set(a,s),this.dw.set(a,this.g.U(s)),a}return this.Em==null&&(this.Em=new d.ia(0),this.dw=new d.ia(0)),a=this.Em.size,this.Em.add(s),this.dw.add(this.g.U(s)),a},l.prototype.rz=function(s){return this.g.bd(this.iz(s))},l}();d.yY=O;var x=function(){function l(s){this.Be=s,this.ie=new d.yb,this.Nm=new d.yb,this.CH=0,this.Ao=null,this.yA=-1}return l.prototype.compare=function(s,a,c){c=s.ja(c);var f=this.Be.hb;if(this.yA==a)var y=this.CH;else this.Ao=f.bc(a),this.Ao==null?((s=f.g).ed(f.zz(a),this.ie),this.Ao=this.ie,y=this.ie.Pe(this.Be.yh,0)):y=this.Ao.Pe(this.Be.yh,0),this.CH=y,this.yA=a;if((s=f.bc(c))==null){(s=f.g).ed(f.zz(c),this.Nm),s=this.Nm;var v=this.Nm.Pe(this.Be.yh,0)}else v=s.Pe(this.Be.yh,0);return y==v&&(a=f.Bv(a),c=f.Bv(c),(a=.5*((c=Math.min(a?this.Ao.la:this.Ao.na,c?s.la:s.na))+this.Be.yh))==this.Be.yh&&(a=c),y=this.Ao.Pe(a,0),v=s.Pe(a,0)),y<v?-1:y>v?1:0},l.prototype.reset=function(){this.yA=-1},l}(),h=function(){function l(){this.Wm=this.Gl=null,this.fb=new d.Yj,this.fb.RP(),this.$d=new x(this),this.fb.Vo(this.$d)}return l.prototype.HQ=function(){var s=!1;if(this.fw&&(s=this.IQ()),this.g.da(this.X)==1){var a=this.g.Ob(this.X);return s=this.g.wz(a),this.g.PB(a,!0),0>s&&(s=this.g.Xa(a),this.g.pJ(s),this.g.Wg(a,this.g.Ma(s)),!0)}for(this.El=this.g.Ky(),this.wo=this.g.Ky(),a=this.g.Ob(this.X);a!=-1;a=this.g.Rb(a))this.g.gr(a,this.El,0),this.g.gr(a,this.wo,-1);a=new d.ia(0),this.yh=NaN;var c=new d.h;this.et=this.g.da(this.X),this.ro=this.g.Gd(),this.Rs=this.g.Gd();for(var f=this.Gl.rc(this.Gl.je);f!=-1;f=this.Gl.lb(f)){var y=this.Gl.getData(f);if(this.g.Gc(y,c),c.y!=this.yh&&a.size!=0&&(s=this.ut(a)||s,this.$d.reset(),a.clear(!1)),a.add(y),this.yh=c.y,this.et==0)break}for(0<this.et&&(s=this.ut(a)||s,a.clear(!1)),this.g.Td(this.ro),this.g.Td(this.Rs),a=this.g.Ob(this.X);a!=-1;)if(this.g.sj(a,this.El)==3){for(this.g.PB(a,!0),c=a,a=this.g.sj(a,this.wo);a!=-1;)f=this.g.sj(a,this.wo),this.g.ZT(this.X,this.g.Rb(c),a),c=a,a=f;a=this.g.Rb(c)}else this.g.PB(a,!1),a=this.g.Rb(a);return this.g.CB(this.El),this.g.CB(this.wo),s},l.prototype.ut=function(s){return this.$V(s)},l.prototype.$V=function(s){var a=!1;this.hb==null&&(this.hb=new O(this.g)),this.Wm==null?(this.Wm=new d.ia(0),this.Wm.Jb(16)):this.Wm.clear(!1),this.ZV(s);for(var c=0,f=s.size;c<f;c++){var y=s.get(c);y!=-1&&this.oG(y,-1)}for(c=0;c<this.Wm.size&&0<this.et;c++)if(s=this.Wm.get(c),y=this.hb.rz(this.fb.ja(s)),f=-1,this.g.sj(y,this.El)==0){y=this.fb.we(s);for(var v,_=s;y!=-1;){var $=this.fb.ja(y),I=this.hb.rz($),k=this.g.sj(I,this.El);if(k!=0){f=I;break}_=y,y=this.fb.we(y)}y==-1?(v=!0,y=_):($=this.fb.ja(y),v=this.hb.Bv($),y=this.fb.lb(y),v=!v);do{if($=this.fb.ja(y),I=this.hb.rz($),(k=this.g.sj(I,this.El))==0&&(v!=this.hb.Bv($)&&(a=this.g.Xa(I),this.g.pJ(a),this.g.Wg(I,this.g.Ma(a)),a=!0),this.g.gr(I,this.El,v?3:2),v||(_=this.g.sj(f,this.wo),this.g.gr(f,this.wo,I),this.g.gr(I,this.wo,_)),this.et--,this.et==0))return a;f=I,_=y,y=this.fb.lb(y),v=!v}while(_!=s)}return a},l.prototype.ZV=function(s){for(var a=0,c=s.size;a<c;a++){var f=s.get(a),y=this.g.Pa(f,this.ro),v=this.g.Pa(f,this.Rs);if(y!=-1){var _=this.fb.ja(y);this.hb.rF(_),this.g.Ra(f,this.ro,-1)}v!=-1&&(_=this.fb.ja(v),this.hb.rF(_),this.g.Ra(f,this.Rs,-1)),_=-1,y!=-1&&v!=-1?(this.fb.vd(y,-1),this.fb.vd(v,-1),s.set(a,-1)):_=y!=-1?y:v,_!=-1&&(this.oG(f,_)||this.fb.vd(_,-1),s.set(a,-1))}},l.prototype.oG=function(s,a){var c=new d.h,f=new d.h;this.g.Gc(s,c);var y=this.g.U(s);this.g.Gc(y,f);var v=!1;if(c.y<f.y){v=!0;var _=this.hb.nI(s);if(a==-1)var $=this.fb.addElement(_,-1);else $=a,this.fb.Sj($,_);(_=this.g.Pa(y,this.ro))==-1?this.g.Ra(y,this.ro,$):this.g.Ra(y,this.Rs,$),y=this.g.bd(s),this.g.sj(y,this.El)==0&&this.Wm.add($)}return y=this.g.Ma(s),this.g.Gc(y,f),c.y<f.y&&(v=!0,_=this.hb.nI(y),a==-1?$=this.fb.addElement(_,-1):($=a,this.fb.Sj($,_)),(_=this.g.Pa(y,this.ro))==-1?this.g.Ra(y,this.ro,$):this.g.Ra(y,this.Rs,$),y=this.g.bd(s),this.g.sj(y,this.El)==0&&this.Wm.add($)),v},l.V=function(s,a,c,f){var y=new l;return y.g=s,y.X=a,y.Gl=c,y.fw=f,y.HQ()},l.prototype.IQ=function(){var s=new d.ia(0),a=new d.ia(0),c=-1,f=-1,y=new d.h;y.Rc();for(var v=-1,_=-1,$=-1,I=new d.h,k=this.Gl.rc(this.Gl.je);k!=-1;k=this.Gl.lb(k)){var A=this.Gl.getData(k);this.g.Gc(A,I);var P=this.g.bd(A);y.qb(I)&&_==P?(f==-1&&(c=this.g.Ky(),f=this.g.Gd()),$==-1&&($=a.size,this.g.Ra(v,f,$),a.add(1),this.g.sj(P,c)==-1&&(this.g.gr(P,c,v),s.add(P))),this.g.Ra(A,f,$),a.bX(a.Fc()+1)):($=-1,y.L(I)),v=A,_=P}if(s.size==0)return!1;for(y=new d.ia(0),v=new d.ia(0),_=0,$=s.size;_<$;_++){P=s.get(_);var D=this.g.sj(P,c);for(A=this.g.Pa(D,f),y.clear(!1),v.clear(!1),y.add(D),v.add(A),A=this.g.U(D);A!=D;A=this.g.U(A)){var j=A;if((I=this.g.Pa(j,f))!=-1)if(v.size==0)v.add(I),y.add(j);else if(v.Fc()==I){k=y.Fc();var B=this.g.U(k);D=this.g.U(j),this.g.Bc(k,D),this.g.Cc(D,k),this.g.Bc(j,B),this.g.Cc(B,j),j=[!1],B=this.g.nG(this.X,B,this.g.Xa(P),j),this.g.Ra(A,f,-1),j[0]&&this.g.Jf(P,D),A=this.g.Ja(P),A-=D=this.g.Ja(B),this.g.Vj(P,A),a.set(I,a.get(I)-1),a.get(I)==1&&(a.set(I,0),v.If(),y.If()),A=D=k}else y.add(A),v.add(I)}}return this.g.CB(c),this.g.Td(f),!0},l}();d.WL=h}(Y||(Y={})),function(d){var O=function(){function x(){}return x.prototype.ig=function(){this.PA=this.sb=null},x.prototype.get=function(){return this.PA},x.prototype.set=function(h){if(this.PA=h,h!=null)throw h.getType()==322&&(this.sb=h),d.i.Qa()},x.prototype.create=function(h){if(h!=322)throw d.i.fa("Not Implemented");this.Or()},x.prototype.Or=function(){this.sb==null&&(this.sb=new d.yb),this.PA=this.sb},x}();d.ig=O}(Y||(Y={})),function(d){(d=d.XL||(d.XL={}))[d.enumLineSeg=1]="enumLineSeg",d[d.enumBezierSeg=2]="enumBezierSeg",d[d.enumArcSeg=4]="enumArcSeg",d[d.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask",d[d.enumSegmentMask=7]="enumSegmentMask",d[d.enumDensified=8]="enumDensified"}(Y||(Y={})),function(d){var O=function(h){this.$i=h,this.qC=this.rC=1,this.sB=this.rB=this.tB=0},x=function(){function h(){this.Fq=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Bk=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Bf=new d.Sa,this.qa=this.Cw=0,this.mo=[],this.$s=[],this.yw=[],this.Iq=[],this.MA=[]}return h.prototype.wB=function(l){if(l!=null){for(var s=0,a=l.length;s<a;s++)this.rW(l[s]);l.length=0}},h.prototype.rW=function(l){l.$i=null,this.Iq.push(l)},h.prototype.Ow=function(l){if(this.Iq.length===0)var s=new O(l);else(s=this.Iq[this.Iq.length-1]).$i=l,--this.Iq.length;return s},h.prototype.SR=function(l,s){return l==0?this.$s[s]:this.yw[s]},h.prototype.aB=function(){this.Cw>=this.MA.length&&this.MA.push(new d.ig);var l=this.MA[this.Cw];return this.Cw++,l},h.prototype.clear=function(){this.wB(this.mo),this.wB(this.$s),this.wB(this.yw),this.Cw=0},h.prototype.Oo=function(l){this.mo.push(this.Ow(l))},h.prototype.ol=function(l){return l==0?this.$s.length:this.yw.length},h.prototype.Vp=function(l,s){return this.SR(l,s).$i},h.prototype.Ea=function(l,s){if(this.mo.length!=2)throw d.i.Qa();this.qa=l;var a=d.lc.ox(.01*l),c=!1,f=this.mo[0],y=this.mo[1];if(s||5&f.$i.zr(y.$i,l,!0)){if(f.$i.getType()==322){var v=f.$i;if(y.$i.getType()==322){s=y.$i;var _=d.yb.Zx(v,s,null,this.Fq,this.Bk,l);if(_==0)throw d.yb.Zx(v,s,null,this.Fq,this.Bk,l),d.i.Qa();l=Array(9),d.O.$u(l,null);for(var $=0;$<_;$++){var I=this.Fq[$],k=this.Bk[$],A=f.sB,P=1;I==0?(A=f.tB,P=f.rC):I==1&&(A=f.rB,P=f.qC);var D=y.sB,j=1;k==0?(D=y.tB,j=y.rC):k==1&&(D=y.rB,j=y.qC);var B=new d.h;A==D?(A=new d.h,v.hc(I,A),I=new d.h,s.hc(k,I),j/=k=P+j,d.lc.OG(A,I,j,B),d.h.yc(B,A)+d.h.yc(B,I)>a&&(c=!0)):A>D?(v.hc(I,B),I=new d.h,s.hc(k,I),d.h.yc(B,I)>a&&(c=!0)):(s.hc(k,B),A=new d.h,v.hc(I,A),d.h.yc(B,A)>a&&(c=!0)),l[$]=B}for(f=0,y=-1,$=0;$<=_;$++)(j=$<_?this.Fq[$]:1)!=f&&(a=this.aB(),v.ah(f,j,a),y!=-1&&a.get().Dc(l[y]),$!=_&&a.get().Qc(l[$]),f=j,this.$s.push(this.Ow(a.get()))),y=$;for(v=[0,0,0,0,0,0,0,0,0],$=0;$<_;$++)v[$]=$;for(1<_&&this.Bk[0]>this.Bk[1]&&(j=this.Bk[0],this.Bk[0]=this.Bk[1],this.Bk[1]=j,$=v[0],v[0]=v[1],v[1]=$),f=0,y=-1,$=0;$<=_;$++)(j=$<_?this.Bk[$]:1)!=f&&(a=this.aB(),s.ah(f,j,a),y!=-1&&(f=v[y],a.get().Dc(l[f])),$!=_&&(f=v[$],a.get().Qc(l[f])),f=j,this.yw.push(this.Ow(a.get()))),y=$;return c}}throw d.i.Qa()}return!1},h.prototype.Kz=function(l,s,a){if(s.copyTo(this.Bf),this.mo.length!=1)throw d.i.Qa();this.qa=l;var c=this.mo[0];if(a||c.$i.ru(s.D(),l,!0)){if(c.$i.getType()!=322)throw d.i.Qa();var f=(l=c.$i).fe(s.D(),!1);this.Fq[0]=f;var y=c.sB;for(a=1,f==0?(y=c.tB,a=c.rC):f==1&&(y=c.rB,a=c.qC),c=new d.h,y==0?(y=new d.h,l.hc(f,y),s=s.D(),d.lc.OG(y,s,1/(a+1),c)):0<y?(c=new d.h,l.hc(f,c)):c=s.D(),a=0,f=-1,y=0;1>=y;y++){if((s=1>y?this.Fq[y]:1)!=a){var v=this.aB();l.ah(a,s,v),f!=-1&&v.get().Dc(c),y!=1&&v.get().Qc(c),a=s,this.$s.push(this.Ow(v.get()))}f=y}this.Bf.Cb(c)}},h}();d.TC=x}(Y||(Y={})),function(d){var O=function(){function x(h){this.Ds=this.rk=this.sb=null,this.ag=0,this.zm=!1,this.zf=-1,this.Cl=this.Jd=0,this.gb=-1,this.ib=h,this.ag=this.Wx(this.Cl),this.zm=!1,this.rk=null,this.Ds=new d.h}return x.prototype.BW=function(h){if(this.ib!=h.ib)throw d.i.Hb();this.zf=h.zf,this.Jd=h.Jd,this.gb=h.gb,this.Cl=h.Cl,this.ag=h.ag,this.zm=h.zm,this.rk=null},x.prototype.ha=function(){if(this.zf!=this.Jd&&this.BD(),this.zm)this.Jd=(this.Jd+1)%this.ag;else{if(this.Jd==this.ag)throw d.i.ce();this.Jd++}return this.rk},x.prototype.li=function(){if(this.zm)this.Jd=(this.ag+this.Jd-1)%this.ag;else{if(this.Jd==0)throw d.i.ce();this.Jd--}return this.Jd!=this.zf&&this.BD(),this.rk},x.prototype.DW=function(){this.zf=-1,this.Jd=0},x.prototype.EW=function(){this.Jd=this.ag,this.zf=-1},x.prototype.Vb=function(h,l){if(l===void 0&&(l=-1),0<=this.gb&&this.gb<this.ib.da()){var s=this.IM();if(h>=s&&h<this.ib.Vc(this.gb))return this.zf=-1,void(this.Jd=h-s)}l=0<=l&&l<this.ib.da()&&h>=this.ib.Ba(l)&&h<this.ib.Vc(l)?l:this.ib.sz(h),this.Cl=l+1,this.gb=l,this.zf=-1,this.Jd=h-this.ib.Ba(l),this.ag=this.Wx(l),this.ib.Ba(this.gb),this.ib.dc(this.gb)},x.prototype.$a=function(){return this.gb=this.Cl,!(this.gb>=this.ib.da())&&(this.zf=-1,this.Jd=0,this.ag=this.Wx(this.gb),this.ib.Ba(this.gb),this.ib.dc(this.gb),this.Cl++,!0)},x.prototype.Zi=function(){this.ag=this.Jd=this.zf=-1,this.Cl=0,this.gb=-1},x.prototype.Wx=function(h){if(this.ib.Ac())return 0;var l=1;return this.ib.dc(h)&&(l=0),this.ib.Ja(h)-l},x.prototype.On=function(){return this.zf==this.ag-1&&this.ib.dc(this.gb)},x.prototype.JB=function(){this.zm=!0},x.prototype.wb=function(){return this.ib.nb.o[this.gb]+this.zf},x.prototype.IM=function(){return this.ib.Ba(this.gb)},x.prototype.ik=function(){return this.On()?this.ib.Ba(this.gb):this.wb()+1},x.prototype.vm=function(){return this.zf==0},x.prototype.Qn=function(){return this.zf==this.ag-1},x.prototype.Ha=function(){return this.Jd<this.ag},x.prototype.Ez=function(){return 0<this.Jd},x.prototype.Of=function(){var h=new x(this.ib);return h.zf=this.zf,h.Jd=this.Jd,h.ag=this.ag,h.gb=this.gb,h.Cl=this.Cl,h.ib=this.ib,h.zm=this.zm,h},x.prototype.BD=function(){if(0>this.Jd||this.Jd>=this.ag)throw d.i.ce();this.zf=this.Jd;var h=this.wb();this.ib.mc();var l=this.ib.Ve,s=1;switch(l!=null&&(s=7&l.read(h)),l=this.ib.description,s){case 1:this.sb==null&&(this.sb=new d.yb),this.rk=this.sb;break;case 2:throw d.i.fa("internal error");default:throw d.i.Qa()}this.rk.Nf(l),s=this.ik(),this.ib.Gc(h,this.Ds),this.rk.Dc(this.Ds),this.ib.Gc(s,this.Ds),this.rk.Qc(this.Ds);for(var a=1,c=l.Aa;a<c;a++)for(var f=l.kd(a),y=d.ra.Va(f),v=0;v<y;v++){var _=this.ib.Uc(f,h,v);this.rk.YB(f,v,_),_=this.ib.Uc(f,s,v),this.rk.OB(f,v,_)}},x.prototype.$S=function(){return this.gb==this.ib.da()-1},x.prototype.Pn=function(){var h=this.ib.VR();return h!=null&&(7&h.read(this.zf))!=1},x}();d.YL=O}(Y||(Y={})),function(d){var O=function(){function x(h){h instanceof d.aa?(this.xH=h,this.ya=-1,this.Ei=1):(this.vT=h.slice(0),this.ya=-1,this.Ei=h.length)}return x.prototype.La=function(){return this.ya},x.prototype.next=function(){return this.ya<this.Ei-1?(this.ya++,this.xH!=null?this.xH:this.vT[this.ya]):null},x.prototype.qe=function(){},x}();d.Zc=O}(Y||(Y={})),function(d){var O=function(){this.next=null},x=function(){function h(){this.Tq=this.Kw=this.Lw=0,this.kF=!1,this.gK=0,this.gn=this.Kf=this.Wl=this.Jh=null,this.Ol=0,this.vy=null,this.pl=this.oi=-1}return h.prototype.AX=function(l,s,a){this.oi=l,this.pl=s,this.Jh=this.Wl=null,this.Tq=0,this.vy=a,this.gn==null&&(this.gn=d.O.lg(384,0)),this.nK()},h.prototype.R=function(){return this.oi},h.prototype.ca=function(){return this.pl},h.prototype.flush=function(){0<this.Ol&&(this.vy.gF(this.gn,this.Ol),this.Ol=0)},h.prototype.nK=function(){if(0<this.Tq){for(var l=0;l<this.pl;l++){for(var s=this.Wl[l];s!=null;){var a=s;s=s.next,a.next=null}this.Wl[l]=null}this.Jh=null}this.Lw=this.pl,this.Kw=-1,this.Tq=0},h.prototype.iJ=function(l){for(this.kF=l==h.Cx,l=this.Lw;l<=this.Kw;l++)this.sN(),this.lN(l),this.ZP();this.nK()},h.prototype.jy=function(l,s,a,c){if(s!=c){var f=1;if(s>c&&(f=l,l=a,a=f,f=s,s=c,c=f,f=-1),!(0>c||s>=this.pl)){0>l&&0>a?a=l=-1:l>=this.oi&&a>=this.oi&&(a=l=this.oi);var y=(a-l)/(c-s);c>this.pl&&(a=y*((c=this.pl)-s)+l),0>s&&(l=y*(0-s)+l,s=0);var v=Math.max(this.oi+1,8388607);-8388607>l?(s=(0-l)/y+s,l=0):l>v&&(s=(this.oi-l)/y+s,l=this.oi),-8388607>a?c=(0-l)/y+s:a>v&&(c=(this.oi-l)/y+s),(s=d.O.truncate(s))!=(c=d.O.truncate(c))&&((a=new O).x=d.O.truncate(4294967296*l),a.y=s,a.H=c,a.WP=d.O.truncate(4294967296*y),a.dir=f,this.Wl==null&&(this.Wl=d.O.lg(this.pl,null)),a.next=this.Wl[a.y],this.Wl[a.y]=a,a.y<this.Lw&&(this.Lw=a.y),a.H>this.Kw&&(this.Kw=a.H),this.Tq++)}}},h.prototype.sN=function(){if(this.Jh!=null){for(var l=!1,s=null,a=this.Jh;a!=null;)if(a.y++,a.y==a.H){var c=a;a=a.next,s!=null?s.next=a:this.Jh=a,c.next=null}else a.x+=a.WP,s!=null&&s.x>a.x&&(l=!0),s=a,a=a.next;l&&(this.Jh=this.fK(this.Jh))}},h.prototype.lN=function(l){if(!(l>=this.pl)){var s=this.Wl[l];if(s!=null){this.Wl[l]=null,s=this.fK(s),this.Tq-=this.gK,l=this.Jh;for(var a=!0,c=s,f=null;l!=null&&c!=null;)l.x>c.x?(a&&(this.Jh=c),a=c.next,c.next=l,f!=null&&(f.next=c),f=c,c=a):(a=l.next,l.next=c,f!=null&&(f.next=l),f=l,l=a),a=!1;this.Jh==null&&(this.Jh=s)}}},h.eK=function(l,s){return 0>l?0:l>s?s:l},h.prototype.ZP=function(){if(this.Jh!=null){for(var l=0,s=this.Jh,a=d.O.truncate(d.O.XG(s.x)),c=s.next;c!=null;c=c.next)if(l=this.kF?1^l:l+c.dir,c.x>s.x){var f=d.O.truncate(d.O.XG(c.x));l!=0&&(s=h.eK(a,this.oi),(a=h.eK(f,this.oi))>s&&s<this.oi&&(this.gn[this.Ol++]=s,this.gn[this.Ol++]=a,this.gn[this.Ol++]=c.y,this.Ol==this.gn.length&&(this.vy.gF(this.gn,this.Ol),this.Ol=0))),s=c,a=f}}},h.prototype.fK=function(l){for(var s=0,a=l;a!=null;a=a.next)s++;if(this.gK=s,s==1)return l;this.Kf==null?this.Kf=d.O.lg(Math.max(s,16),null):this.Kf.length<s&&(this.Kf=d.O.lg(Math.max(s,2*this.Kf.length),null));var c=0;for(a=l;a!=null;a=a.next)this.Kf[c++]=a;for(s==2?this.Kf[0].x>this.Kf[1].x&&(l=this.Kf[0],this.Kf[0]=this.Kf[1],this.Kf[1]=l):h.AN(this.Kf,s,function(f,y){return f==y?0:f.x<y.x?-1:f.x>y.x?1:0}),l=this.Kf[0],this.Kf[0]=null,a=l,c=1;c<s;c++)a.next=this.Kf[c],a=this.Kf[c],this.Kf[c]=null;return a.next=null,l},h.AN=function(l,s,a){if(s==l.length)l.sort(a);else{var c=l.slice(0,0),f=l.slice(s);s=l.slice(0,s).sort(a),l.length=0,l.push.apply(l,c.concat(s).concat(f))}},h.Cx=0,h}();d.Px=x}(Y||(Y={})),function(d){var O=function(){function x(){}return x.prototype.ui=function(h,l){var s=this.g.Pa(h,this.Pq);if(this.Dl==s&&(this.Dl=this.oe.lb(this.Dl)),this.ho==s&&(this.ho=this.oe.lb(this.ho)),this.oe.jd(this.RA,s),this.bk(h),l&&(l=this.g.bd(h))!=-1&&this.g.Xa(l)==h){var a=this.g.U(h);if(a!=h){if((s=this.g.bd(a))==l)return void this.g.Jf(l,a);if((a=this.g.Ma(h))!=h&&(s=this.g.bd(a))==l)return void this.g.Jf(l,a)}this.g.Jf(l,-1),this.g.Wg(l,-1)}},x.prototype.pD=function(){for(var h=!1,l=new d.h;;){this.Wh==null?(this.Wh=new d.ia(0),this.zs=new d.ia(0),this.xe=new d.ia(0)):(this.Wh.clear(!1),this.zs.clear(!1),this.xe.clear(!1));for(var s=this.ho,a=0,c=!0;s!=this.Dl;){var f=this.oe.getData(s),y=new d.h;this.g.Gc(f,y),c&&(this.g.Gc(f,l),c=!1),y=this.g.Ma(f);var v=this.g.U(f);this.g.Pa(y,this.zg)!=-559038737&&(this.Wh.add(y),this.g.Ra(y,this.zg,-559038737),this.zs.add(f),this.xe.add(a++)),this.g.Pa(v,this.zg)!=-559038737&&(this.Wh.add(v),this.g.Ra(v,this.zg,-559038737),this.zs.add(f),this.xe.add(a++)),s=this.oe.lb(s)}if(2>this.Wh.size)break;var _=this;for(this.xe.Vd(0,this.xe.size,function($,I){return _.pM($,I)}),s=0,a=this.xe.size;s<a;s++)c=this.xe.get(s),c=this.Wh.get(c),this.g.Ra(c,this.zg,s),y=new d.h,this.g.Gc(c,y);for(y=this.TM(l),s=0,a=this.xe.size;s<a;s++)(c=this.xe.get(s))!=-1&&(c=this.Wh.get(c),this.g.Ra(c,this.zg,-1));if(!y)break;h=!0}return h},x.prototype.TM=function(h){for(var l=!1,s=!0;s;){s=!1;var a=0;this.xe.get(a)==-1&&(a=this.cm(a));for(var c=this.cm(a),f=0,y=this.xe.size;f<y&&a!=-1&&c!=-1&&a!=c;f++){var v=this.xe.get(a);c=this.xe.get(c),v=this.Wh.get(v),c=this.Wh.get(c);var _=this.g.U(v);this.g.Dv(_,h)||(_=this.g.Ma(v));var $=this.g.U(c);this.g.Dv($,h)||($=this.g.Ma(c));var I=this.pu(_,v),k=this.pu($,c),A=I?this.g.Ma(_):this.g.U(_),P=k?this.g.Ma($):this.g.U($),D=!1;(this.sp(_)||this.sp($)||this.sp(v)||this.sp(c)||this.sp(A)||this.sp(P))&&(D=!0),!D&&this.g.fq(v,c)&&(D=!0,this.tD(I,k,_,v,$,c)),!D&&this.g.fq(A,P)&&(D=!0,this.tD(!I,!k,_,A,$,P)),D&&(l=!0),s=s||D,a=this.cm(a),c=this.cm(a)}}if(!l)for(a=0,this.xe.get(a)==-1&&(a=this.cm(a)),c=this.cm(a),f=0,y=this.xe.size;f<y&&a!=-1&&c!=-1&&a!=c;f++)v=this.xe.get(a),c=this.xe.get(c),v=this.Wh.get(v),c=this.Wh.get(c),_=this.g.U(v),this.g.Dv(_,h)||(_=this.g.Ma(v)),$=this.g.U(c),this.g.Dv($,h)||($=this.g.Ma(c)),I=this.pu(_,v),k=this.pu($,c),A=I?this.g.Ma(_):this.g.U(_),P=k?this.g.Ma($):this.g.U($),this.DM(I,k,v,_,A,c,$,P)&&(l=!0),a=this.cm(a),c=this.cm(a);return l},x.prototype.XM=function(){this.g.ic(this.X)==1736&&this.g.In(this.X)==1&&new d.Fg().MU(this.fw,this.g,this.X,this.nd);var h=!1,l=!0;this.zg=this.Pq=-1;var s=this.g.I(this.X),a=new d.ia(0);a.Jb(s);for(var c=this.g.Ob(this.X);c!=-1;c=this.g.Rb(c))for(var f=this.g.Xa(c),y=0,v=this.g.Ja(c);y<v;y++)a.add(f),f=this.g.U(f);var _=this.g.td.o,$=this.g.td.stride;this.g.vb.mc();var I=this.g.vb.za[0].o;for(a.Vd(0,s,function(A,P){var D=_[$*A],j=_[$*P],B=I[2*D];D=I[2*D+1];var q=I[2*j];return(B=D<(j=I[2*j+1])?-1:D>j?1:B<q?-1:B>q?1:0)==0&&(B=(A=_[$*A+3])<(P=_[$*P+3])?-1:A==P?0:1),B}),this.Pq=this.g.Gd(),this.oe=new d.jp,this.RA=this.oe.Ph(0),this.oe.fn(s),c=0;c<s;c++)f=a.get(c),y=this.oe.addElement(this.RA,f),this.g.Ra(f,this.Pq,y);for(this.zg=this.g.Gd(),this.Dl=-1,this.cD()&&(h=!0);l;){l=!1,s=0,a=!1;do{a=!1,this.ho=-1,v=0,c=new d.h,y=new d.h;for(var k=this.oe.rc(this.RA);k!=-1;)f=this.oe.getData(k),this.ho!=-1?(this.g.Gc(f,y),c.qb(y)?v++:(c.L(y),this.Dl=k,0<v&&(f=this.pD())&&(a=!0,this.Dl!=-1&&(f=this.oe.getData(this.Dl),this.g.Gc(f,c))),this.ho=k=this.Dl,v=0)):(this.ho=k,this.g.Gc(this.oe.getData(k),c),v=0),k!=-1&&(k=this.oe.lb(k));if(this.Dl=-1,0<v&&(f=this.pD())&&(a=!0),10<s++)throw d.i.Qa();a&&this.GM(),this.cD()&&(a=!0),l=l||a&&!1,h=h||a}while(a)}return this.g.Td(this.Pq),this.g.Td(this.zg),d.WL.V(this.g,this.X,this.oe,this.fw)||h},x.prototype.pu=function(h,l){return this.g.U(l)!=h},x.prototype.DM=function(h,l,s,a,c,f,y,v){if(a==y)return this.bk(s),this.bk(f),!1;var _=this.g.Pa(s,this.zg),$=this.g.Pa(c,this.zg),I=this.g.Pa(f,this.zg),k=this.g.Pa(v,this.zg),A=[0,0,0,0];for((s=[0,0,0,0,0,0,0,0])[0]=0,A[0]=_,s[1]=0,A[1]=$,s[2]=1,A[2]=I,s[3]=1,A[3]=k,_=1;4>_;_++){for($=A[_],I=s[_],k=_-1;0<=k&&A[k]>$;)A[k+1]=A[k],s[k+1]=s[k],k--;A[k+1]=$,s[k+1]=I}return A=0,s[0]!=0&&(A|=1),s[1]!=0&&(A|=2),s[2]!=0&&(A|=4),s[3]!=0&&(A|=8),(A==5||A==10)&&(h==l?h?(this.g.Bc(v,a),this.g.Cc(a,v),this.g.Bc(c,y),this.g.Cc(y,c)):(this.g.Cc(v,a),this.g.Bc(a,v),this.g.Cc(c,y),this.g.Bc(y,c)):h?(this.g.Cc(a,f),this.g.Bc(f,a),this.g.Cc(y,c),this.g.Bc(c,y)):(this.g.Bc(a,f),this.g.Cc(f,a),this.g.Bc(y,c),this.g.Cc(c,y)),!0)},x.prototype.tD=function(h,l,s,a,c,f){this.MY?this.VM():this.UM(h,l,s,a,c,f)},x.prototype.VM=function(){throw d.i.fa("not implemented.")},x.prototype.UM=function(h,l,s,a,c,f){if(h!=l)h?(this.g.Bc(s,c),this.g.Cc(c,s),this.g.Bc(f,a),this.g.Cc(a,f),this.vn(c,s),this.ui(c,!0),this.g.mi(c,!0),this.bk(s),this.vn(f,a),this.ui(f,!0),this.g.mi(f,!1)):(this.g.Bc(c,s),this.g.Cc(s,c),this.g.Bc(a,f),this.g.Cc(f,a),this.vn(c,s),this.ui(c,!0),this.g.mi(c,!1),this.bk(s),this.vn(f,a),this.ui(f,!0),this.g.mi(f,!0)),this.bk(a);else{var y=h?s:a,v=l?c:f;for(h=h?a:s,l=l?f:c,c=!1,this.g.Bc(y,v),this.g.Bc(v,y),this.g.Cc(h,l),this.g.Cc(l,h),f=l;f!=v;)s=this.g.Ma(f),a=this.g.U(f),this.g.Cc(f,a),this.g.Bc(f,s),c=c||f==y,f=a;c||(s=this.g.Ma(v),a=this.g.U(v),this.g.Cc(v,a),this.g.Bc(v,s)),this.vn(v,y),this.ui(v,!0),this.g.mi(v,!1),this.bk(y),this.vn(l,h),this.ui(l,!0),this.g.mi(l,!1),this.bk(h)}},x.prototype.cD=function(){for(var h=!1,l=this.g.Ob(this.X);l!=-1;){for(var s=this.g.Xa(l),a=0,c=this.g.Ja(l);a<c&&1<c;){var f=this.g.Ma(s),y=this.g.U(s);this.g.fq(f,y)?(h=!0,this.ui(s,!1),this.g.pd(s,!0),this.ui(y,!1),this.g.pd(y,!0),s=f,a=0,c=this.g.Ja(l)):(s=y,a++)}if(2>this.g.Ja(l)){for(h=this.g.Xa(l),a=0,c=this.g.Ja(l);a<c;a++)this.ui(h,!1),h=this.g.U(h);l=this.g.Zq(l),h=!0}else l=this.g.Rb(l)}return h},x.prototype.sp=function(h){for(var l=!1;;){var s=this.g.U(h),a=this.g.Ma(h);if(s==h)return this.ui(h,!0),this.g.mi(h,!1),!0;if(!this.g.fq(s,a)||(l=!0,this.bk(a),this.bk(s),this.ui(h,!0),this.g.mi(h,!1),this.vn(s,a),this.ui(s,!0),this.g.mi(s,!0),s==a))break;h=a}return l},x.prototype.GM=function(){for(var h=0,l=this.oe.rc(this.oe.je);l!=-1;l=this.oe.lb(l)){var s=this.oe.getData(l);this.g.aj(s,-1)}for(var a=0,c=this.g.Ob(this.X);c!=-1;)if((l=this.g.Xa(c))==-1||this.g.bd(l)!=-1)s=c,c=this.g.Rb(c),this.g.$q(s);else{this.g.aj(l,c);var f=1;for(s=this.g.U(l);s!=l;s=this.g.U(s))this.g.aj(s,c),f++;this.g.cp(c,!1),this.g.Vj(c,f),this.g.Wg(c,this.g.Ma(l)),a+=f,h++,c=this.g.Rb(c)}for(l=this.oe.rc(this.oe.je);l!=-1;l=this.oe.lb(l))s=this.oe.getData(l),this.g.bd(s)==-1&&(c=this.g.nG(this.X,s,s,null),a+=this.g.Ja(c),h++);for(this.g.Rl(this.X,h),this.g.Tj(this.X,a),h=0,a=this.g.ld;a!=-1;a=this.g.ue(a))h+=this.g.I(a);this.g.bC(h)},x.prototype.cm=function(h){for(var l=0,s=this.xe.size-1;l<s;l++)if(h=(h+1)%this.xe.size,this.xe.get(h)!=-1)return h;return-1},x.prototype.vn=function(h,l){var s=this.g.Pa(l,this.Pq),a=this.g.Pa(l,this.zg);this.g.lC(h,l),this.g.Ra(l,this.Pq,s),this.g.Ra(l,this.zg,a)},x.prototype.bk=function(h){var l=this.g.Pa(h,this.zg);l!=-1&&(this.xe.set(l,-1),this.g.Ra(h,this.zg,-1))},x.V=function(h,l,s,a,c){var f=new x;return f.g=h,f.X=l,f.xA=s,f.fw=a,f.nd=c,f.XM()},x.prototype.pM=function(h,l){var s=this.Wh.get(h),a=new d.h;this.g.Gc(s,a),s=new d.h;var c=this.Wh.get(l);return this.g.Gc(c,s),a.qb(s)?0:(c=this.zs.get(h),h=new d.h,this.g.Gc(c,h),c=this.zs.get(l),l=new d.h,this.g.Gc(c,l),(c=new d.h).uc(a,h),(a=new d.h).uc(s,l),d.h.nu(c,a))},x}();d.rn=O}(Y||(Y={})),function(d){var O;(O=d.$L||(d.$L={}))[O.Local=0]="Local",O[O.Geographic=1]="Geographic",O[O.Projected=2]="Projected",O[O.Image=3]="Image",O[O.Unknown=4]="Unknown",function(h){h[h.Integer32=0]="Integer32",h[h.Integer64=1]="Integer64",h[h.FloatingPoint=2]="FloatingPoint"}(d.TL||(d.TL={}));var x=function(){function h(){this.mA=null,this.pp="",this.su=null,this.dg=0,this.ZH=this.Ho=-1,this.wh=null}return h.prototype.Ec=function(){return this.dg},h.prototype.VF=function(){return 1},h.prototype.VW=function(l){this.mA=l},h.prototype.Xd=function(){if(this.mA!==null)return this.mA;var l=.001;return this.dg!=0?l=d.wr.CQ(this.dg):this.wh!=null&&(l=d.XC.DQ(this.wh)),l},h.prototype.Bz=function(){return this.wh},h.prototype.Hd=function(){return this.dg!=0?d.Tc.Zg(d.wr.Sy(this.dg)):this.wh!=null?d.XC.EQ(this.wh):void 0},h.Sb=function(l){if(l.dg!=0){if(d.wr.ZS(l.dg)===!0)return 1;if(d.wr.aT(l.dg)===!0)return 2}return 4},h.prototype.$r=function(){var l=this.Ec();return this.Ho!=-1?this.Ho:(this.Ho=d.wr.FK(l),this.Ho!=-1?this.Ho:l)},h.create=function(l){if(0>=l)throw d.i.N("Invalid or unsupported wkid: "+l);var s=new h;return s.dg=l,s},h.qP=function(l){if(l==null||l.length==0)throw d.i.N("Cannot create SpatialReference from null or empty text.");var s=new h;return s.wh=l,s},h.prototype.Nb=function(l){return this==l||l!=null&&this.constructor==l.constructor&&this.dg==l.dg&&(this.dg!=0||this.wh===l.wh)},h.prototype.toString=function(){return"[ tol: "+this.Kn()+"; wkid: "+this.Ec()+"; wkt: "+this.Bz()+"]"},h.prototype.cc=function(){if(this.pp!=="")return this.pp;var l=this.toString();if(Array.prototype.reduce)return this.pp="S"+l.split("").reduce(function(c,f){return 0|(c=(c<<5)-c+f.charCodeAt(0))},0);var s=0;if(l.length===0)return"";for(var a=0;a<l.length;a++)s=(s<<5)-s+l.charCodeAt(a),s&=s;return this.pp="S"+s},h.prototype.Kn=function(){return this.Xd(0)},h.prototype.fh=function(){return this.su!==null?this.su:this.su=d.gu.yP(this)},h.ZN=2147483645,h.$N=9007199254740990,h}();d.Eg=x}(Y||(Y={})),function(d){var O=function(x){function h(){var l=x!==null&&x.apply(this,arguments)||this;return l.Ji=null,l.ST=null,l.Hq=new d.ZL,l.Eo=null,l.jw=null,l}return Kt(h,x),h.yP=function(l){var s=new h;if(s.dg=l.dg,s.Ho=l.Ho,s.ZH=l.ZH,s.wh=l.wh,s.wh!==""&&s.wh!==null){l=h.kM(s.wh);var a=h.iM(s.wh);s.Hq.Xx(l,a,d.hu.Integer64),s.by(l),s.gy(a),s.dg=l.$r()}else l=h.jM(s.dg),s.by(l),s.gy(null),s.Hq.Xx(l,null,d.hu.Integer64);return s},h.prototype.Xd=function(l){return this.Hq.Kn(l)},h.iM=function(l){if(0>=l.length)throw d.i.N();var s=null;try{s=d.NC.fromString(l)}catch{s=null}return s==null?null:h.bD(s,!0)},h.prototype.by=function(l){this.Kd=l,this.Eo=this.Kd.Hd()},h.prototype.gy=function(l){this.KH=l,this.ST=this.KH!=null?this.KH.Eo:null},h.prototype.Wc=function(){return this.Sb()!=0&&this.Sb()!=3&&this.Kd.Wc()},h.prototype.IG=function(){return this.Sb()!=0&&(this.Sb()==3?this.Ji.fk().Wc():this.Kd.Wc())},h.prototype.eh=function(){return this.Kd!=null?this.Kd.Ue:null},h.prototype.pm=function(){return this.Kd.pm()},h.prototype.bf=function(){return this.Kd.bf()},h.prototype.hh=function(){return this.Kd!=null?this.Kd.sw:NaN},h.prototype.Up=function(){return this.Kd.Up()},h.prototype.Wr=function(){return this.Kd.Wr()},h.prototype.kk=function(){return this.Kd.kk()},h.prototype.kS=function(l){return d.OC.Py(this.Kd,l.Kd)},h.prototype.ml=function(){return this.Kd.ml()},h.prototype.Vr=function(){return this.Kd.Vr()},h.prototype.zi=function(){return this.Sb()==3?this.Ji.fk().zi():this.Kd.zi()},h.prototype.gh=function(){if(!this.Wc())throw d.i.N("!isPannable()");var l=new d.l;return this.Kd.gh(l),l},h.prototype.Oe=function(){if(!this.Wc())throw d.i.N("!isPannable()");return this.Kd.so},h.prototype.HR=function(){if(!this.Wc())throw d.i.N("!isPannable()");var l=new d.l;return this.Kd.GR(l),l},h.prototype.pv=function(){if(!this.Wc())throw d.i.N("!isPannable()");return this.Kd.pv()},h.prototype.ov=function(){if(!this.Wc())throw d.i.N("!isPannable()");return this.Kd.ov()},h.prototype.Xr=function(){return this.Ji!=null?this.Ji.fk().Xr():this.Kd.Xr()},h.prototype.PQ=function(){return this.Kd.hv()},h.prototype.Qp=function(){return this.Eo.getUnitFactor()},h.prototype.vz=function(l){return this.Hq.vz(l)},h.prototype.sc=function(){var l=this.Sb();if(l==1)return this;if(l==3)return this.Ji.fk().sc();if(l==0||l===4)throw d.i.fa("invalid call");if(this.jw!==null)return this.jw;if((l=this.eh().getGeogcs())==null)throw d.i.Qa();return this.jw=h.bF(l,this.Hq.VF())},h.bF=function(l,s){if(l==null)throw d.i.N("null pointer.");var a=new h;return l=h.mu(l,!0),a.Hq.Xx(l,null,s),a.by(l),a.gy(null),a.dg=l.$r(),a},h.prototype.Sb=function(){var l=this.eh();if(l!=null)switch(l.getType()){case d.Sc.PE_TYPE_GEOGCS:return 1;case d.Sc.PE_TYPE_PROJCS:return 2}return 4},h.prototype.hv=function(){return this.Kd.hv()},h.mu=function(l,s){var a=l.getCode();if(0>=a&&0<(a=d.pf.getCode(l))){if((l=d.pf.coordsys(a))==null)throw d.i.N("Text to wkid mapping had failed: "+a);return h.mu(l,s)}if(s&&0<a&&(s=h.qx[a]))return s;s=d.zb.xv(l,a,!1);var c=h.lK[s];return c||(l=0>=a?l:d.pf.coordsys(a),l=new d.OC(l),h.lK[s]=l,0<a&&(h.qx[a]=l),l)},h.jM=function(l){if(0>=l)throw d.i.N("Invalid or unsupported wkid: "+l);var s=h.qx[l];if(s!=null)return s;if((s=d.pf.coordsys(l))==null)throw d.i.N("Invalid or unsupported wkid: "+l);return(s=h.mu(s,!1)).$r()!=l&&(h.qx[l]=s),s},h.kM=function(l){if(l==null||l===void 0||l.length==0)throw d.i.N("Cannot create SpatialReference from null or empty text.");var s=null;try{s=d.pf.fromString(d.Sc.PE_TYPE_COORDSYS,l)}catch(a){throw d.i.N("Cannot create SpatialReference from text. "+a.message)}if(s===null)throw d.i.N("Cannot create SpatialReference from text. ");return h.mu(s,!0)},h.bD=function(l,s){var a,c=l.getCode();if(0>=c&&0<(c=d.pf.getCode(l))){if((c=d.pf.vertcs(c))===null)throw d.i.N();return h.bD(c,s)}if(s&&0<c&&(s=h.kK[c])||(l=d.zb.xv(l,c,!1),s=h.mK[l]))return s;if(0>=c||(a=d.pf.vertcs(c)),a===null)throw d.i.N();return a=new d.PL(a),h.mK[l]=a,0<c&&(h.kK[c]=a),a},h.sI=function(l,s){if(s===null||s.B())return null;var a=new d.l;if(s!==null&&l.Sb()!=1){var c=l.sc(),f=c.eh();l=d.vr.Nr(l,c,null,null),(s=d.Hx.local().V(s,l,null)).A(a)}else f=l.eh(),s.A(a);return s=f.getPrimem().getLongitude(),f=f.getUnit().getUnitFactor(),new d.LC(a.v,a.G,a.C,a.H,s,f)},h.lD=function(l){var s={name:"",steps:[],_pt:null,_entry:null},a=0;for(l=l.getEntries();a<l.length;a++){var c=l[a],f={LY:!1,ZY:"",YY:-1,geogtran:null};c.getDirection()===0?f.isInverse=!1:f.isInverse=!0;var y=c.getGeogtran().getCode();-1<y?f.wkid=y:f.wkt=c.getGeogtran().toString(),s.steps.push(f)}return s},h.XR=function(l,s,a,c){return a===void 0&&(a=null),a=h.sI(c,a),l=d.lp.getGTlist(l.eh(),s.eh(),2,d.lp.PE_GTLIST_OPTS_COMMON,a,1),s=null,l&&0<l.length&&(s=this.lD(l[0]),d.Mx.destroy(l)),a!==null&&a.destroy(),s},h.YR=function(l,s,a,c){var f;if(a===void 0&&(a=null),c===void 0&&(c=null),f===void 0&&(f=30),a=h.sI(c,a),l=d.lp.getGTlist(l.eh(),s.eh(),2,d.lp.PE_GTLIST_OPTS_COMMON,a,f),s=[],l&&0<l.length){for(f=0;f<l.length;f++)s.push(this.lD(l[f]));d.Mx.destroy(l)}return a!==null&&a.destroy(),s},h.qx={},h.lK={},h.kK={},h.mK={},h}(d.Eg);d.gu=O}(Y||(Y={})),function(d){var O,x;(x=O=d.hu||(d.hu={}))[x.Integer32=0]="Integer32",x[x.Integer64=1]="Integer64",x[x.FloatingPoint=2]="FloatingPoint";var h=function(){function l(){this.qp()}return l.prototype.assign=function(s){this.Fm=s.Fm,this.Gm=s.Gm,this.Pj=s.Pj,this.sA=s.sA,this.Fo=s.Fo,this.rA=s.rA,this.Ik=s.Ik,this.Mq=s.Mq,this.Lq=s.Lq,this.Rm=s.Rm},l.prototype.VF=function(){return this.Rm},l.prototype.qp=function(){this.Gm=this.Fm=0,this.Pj=1,this.sA=0,this.Fo=1,this.rA=0,this.Lq=this.Mq=this.Ik=2220446049250313e-29,this.Rm=O.FloatingPoint},l.prototype.Xx=function(s,a,c){if(this.qp(),this.Rm=c,c!=O.FloatingPoint){var f=new d.l;s.hR(f),this.Fm=f.v,this.Gm=f.G}else this.Gm=this.Fm=-17976931348623157e292;(f=s.Ue.getType())==d.Sc.PE_TYPE_GEOGCS?(f=(c==O.Integer64?1e-9:1/18e5)*s.bf(),this.Pj=1/f):f==d.Sc.PE_TYPE_PROJCS&&(f=(c==O.Integer64?1e-4:.001)*s.pm(),this.Pj=1/f),a!=null?(f=(c==O.Integer32?.001:1e-4)*a.IH,this.Fo=1/f):this.Fo=1e4,this.YM(),this.Ik=s.sw,this.Mq=a!=null?.001*a.IH:.001,this.Lq=2220446049250313e-29},l.prototype.YM=function(){if(this.Rm!=O.FloatingPoint){var s=this.Rm==O.Integer64?d.Eg.$N:d.Eg.ZN,a=s/this.Pj,c=this.Fm+a,f=d.O.truncate((c-this.Fm)*this.Pj);f>s&&(this.Pj=s/(c-this.Fm)),a=this.Gm+a,(f=d.O.truncate((a-this.Gm)*this.Pj))>s&&(this.Pj=s/(a-this.Gm))}},l.prototype.aC=function(s){switch(s){case 0:this.Ik=void 0;case 1:this.Mq=void 0;case 2:this.Lq=void 0}},l.prototype.Kn=function(s){switch(s){case 0:return this.Ik;case 1:return this.Mq;case 2:return this.Lq}return 0},l.prototype.vz=function(s){if(this.Rm==O.FloatingPoint)return 0;switch(s){case 0:return 1/this.Pj;case 1:case 2:return 1/this.Fo;default:return 0}},l.prototype.toString=function(){var s="SRPD [m_toleranceXY: "+this.Ik.toString();return(s=(s=(s=(s=(s=(s=(s=(s=(s=s+";m_falseX: "+this.Fm.toString())+";m_falseY: "+this.Gm.toString())+";m_unitsXY: "+this.Pj.toString())+";m_falseZ: "+this.sA.toString())+";m_unitsZ: "+this.Fo.toString())+";m_falseM: "+this.rA.toString())+";m_toleranceZ: "+this.Mq.toString())+";m_toleranceM: "+this.Lq.toString())+";m_precision: "+this.Rm.toString())+"] "},l}();d.ZL=h}(Y||(Y={})),function(d){function O(c,f){return 89.99999<f?f=89.99999:-89.99999>f&&(f=-89.99999),f*=.017453292519943,[111319.49079327169*c,31890685e-1*Math.log((1+Math.sin(f))/(1-Math.sin(f)))]}function x(c,f,y){return c=c/6378137*57.29577951308232,y?[c,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*f/6378137)))]:[c-360*Math.floor((c+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*f/6378137)))]}function h(c,f,y){var v=c.Of();if(c.getType()===33)f=f(v.Lg(),v.ih()),v.Cb(f[0],f[1]);else if(c.getType()===197){var _=f(c.es(),c.gs(),y);f=f(c.ds(),c.fs(),y),v.K(_[0],_[1],f[0],f[1])}else for(_=new d.h,c=0;c<v.I();c++){v.D(c,_);var $=f(_.x,_.y,y);_.ma($[0],$[1]),v.Cb(c,_)}return v}function l(c){return h(c,x,!0)}function s(c){return h(c,O,!0)}var a=Math.PI/180;d.UK=function(){function c(){}return c.vu=function(f){var y=Math.sqrt(.006694379990197414),v=Math.sin(f.y*a);return d.h.construct(6378137*f.x*a,3.1677196636462314e6*(v/(1-.006694379990197414*v*v)-1/(2*y)*Math.log((1-y*v)/(1+y*v))))},c.Vx=function(f,y,v,_){var $=.0033528106647474805,I=Math.sin(v);v=Math.cos(v);var k=(1-$)*Math.tan(f),A=k*(f=1/Math.sqrt(1+k*k)),P=Math.atan2(k,v),D=(k=f*I)*k,j=1-D,B=27233160610754688e-5*j/4040829998466145e-2,q=1+B/16384*(4096+B*(B*(320-175*B)-768)),z=B/1024*(256+B*(B*(74-47*B)-128));B=_/(635675231424518e-8*q);for(var Z,ee,Q,le=2*Math.PI;1e-12<Math.abs(B-le);)Q=Math.cos(2*P+B),le=B,B=_/(635675231424518e-8*q)+z*(Z=Math.sin(B))*(Q+z/4*((ee=Math.cos(B))*(2*Q*Q-1)-z/6*Q*(4*Z*Z-3)*(4*Q*Q-3)));return _=A*Z-f*ee*v,j=$/16*j*(4+$*(4-3*j)),d.h.construct((y+(Math.atan2(Z*I,f*ee-A*Z*v)-(1-j)*$*k*(B+j*Z*(Q+j*ee*(2*Q*Q-1)))))/a,Math.atan2(A*ee+f*Z*v,(1-$)*Math.sqrt(D+_*_))/a)},c.MM=function(f,y,v,_){var $=.0033528106647474805,I=_-y,k=Math.atan((1-$)*Math.tan(f)),A=Math.atan((1-$)*Math.tan(v)),P=Math.sin(k);k=Math.cos(k);var D=Math.sin(A);A=Math.cos(A);var j=I,B=1e3;do{var q=Math.sin(j),z=Math.cos(j),Z=Math.sqrt(A*q*A*q+(k*D-P*A*z)*(k*D-P*A*z));if(Z===0)return 0;z=P*D+k*A*z;var ee=Math.atan2(Z,z),Q=k*A*q/Z,le=1-Q*Q;q=z-2*P*D/le,isNaN(q)&&(q=0);var se=$/16*le*(4+$*(4-3*le)),ve=j;j=I+(1-se)*$*Q*(ee+se*Z*(q+se*z*(2*q*q-1)))}while(1e-12<Math.abs(j-ve)&&0<--B);return B===0?(P=_-y,{azimuth:Math.atan2(Math.sin(P)*Math.cos(v),Math.cos(f)*Math.sin(v)-Math.sin(f)*Math.cos(v)*Math.cos(P)),geodesicDistance:6371008771415059e-9*Math.acos(Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos(_-y))}):(y=(f=27233160610754688e-5*le/4040829998466145e-2)/1024*(256+f*(f*(74-47*f)-128)),{azimuth:Math.atan2(A*Math.sin(j),k*D-P*A*Math.cos(j)),YQ:635675231424518e-8*(1+f/16384*(4096+f*(f*(320-175*f)-768)))*(ee-y*Z*(q+y/4*(z*(2*q*q-1)-y/6*q*(4*Z*Z-3)*(4*q*q-3)))),XY:Math.atan2(k*Math.sin(j),k*D*Math.cos(j)-P*A)})},c.jQ=function(f){var y=f.hasAttribute(1),v=f.hasAttribute(2),_=[],$=f.da(),I=null,k=null;y&&(I=f.ub(1)),v&&(k=f.ub(2));for(var A=new d.h,P=0;P<$;P++){for(var D=f.Ba(P),j=f.Ja(P),B=0,q=0,z=NaN,Z=NaN,ee=NaN,Q=NaN,le=f.dc(P),se=[],ve=D;ve<D+j;ve++){f.D(ve,A),Q=ee=NaN;var xe=[A.x,A.y];y&&(ee=I.get(ve),xe.push(ee)),v&&($=k.get(ve),xe.push(Q)),ve==D&&le&&(B=A.x,q=A.y,z=ee,Z=Q),se.push(xe)}!le||B==A.x&&q==A.y&&(!y||isNaN(z)&&isNaN(ee)||z==ee)&&(!v||isNaN(Z)&&isNaN(Q)||Z==Q)||se.push(se[0].slice(0)),_.push(se)}return _},c.Wy=function(f,y){f=c.jQ(f),637.100877141506>y&&(y=637.100877141506);for(var v,_=[],$=0;$<f.length;$++){var I,k,A=f[$];_.push(v=[]),v.push([A[0][0],A[0][1]]);var P=A[0][0]*a,D=A[0][1]*a;for(I=0;I<A.length-1;I++){var j=A[I+1][0]*a,B=A[I+1][1]*a;if(P!==j||D!==B){j=(B=c.MM(D,P,B,j)).azimuth;var q=(B=B.YQ)/y;if(1<q){for(k=1;k<=q-1;k++){var z=c.Vx(D,P,j,k*y);v.push([z.x,z.y])}k=c.Vx(D,P,j,(B+Math.floor(q-1)*y)/2),v.push([k.x,k.y])}D=c.Vx(D,P,j,B),v.push([D.x,D.y]),P=D.x*a,D=D.y*a}}}return{qJ:_}},c.XQ=function(f){for(var y=[],v=0;v<f.length;v++){var _=f[v];_=c.Wy(_,1e4),y.push(_)}f=[];for(var $=0;$<y.length;$++){_=y[$];var I=0;for(v=0;v<_.qJ.length;v++){var k,A=_.qJ[v],P=c.vu(d.h.construct(A[0][0],A[0][1])),D=c.vu(d.h.construct(A[A.length-1][0],A[A.length-1][1])),j=D.x*P.y-P.x*D.y;for(k=0;k<A.length-1;k++)P=c.vu(d.h.construct(A[k+1][0],A[k+1][1])),j+=(D=c.vu(d.h.construct(A[k][0],A[k][1]))).x*P.y-P.x*D.y;I+=j}I/=1,f.push(I/-2)}return f},c}(),d.cb=function(){function c(){}return c.xB=function(f,y,v,_,$,I,k){c.gD[f.cc()]=y,isNaN(v)==0&&(c.mD[f.cc()]=v),isNaN(_)==0&&(c.zD[f.cc()]=_),isNaN($)==0&&(c.aD[f.cc()]=$),c.nD[f.cc()]=I,k!==null&&(c.oD[f.cc()]=k)},c.Ww=function(f,y,v){c.sD[f.cc()+"-"+y.cc()]=v},c.sc=function(f){if((f=c.gD[f.cc()])==null)throw d.i.Ie();return f},c.bf=function(f){if((f=c.mD[f.cc()])==null)throw d.i.Ie();return f},c.vv=function(f){if((f=c.zD[f.cc()])==null)throw d.i.Ie();return f},c.ev=function(f){if((f=c.aD[f.cc()])==null)throw d.i.Ie();return f},c.gh=function(f){if((f=c.oD[f.cc()])==null)throw d.i.Ie();return d.l.construct(f[0],f[1],f[2],f[3])},c.Wc=function(f){if((f=c.nD[f.cc()])==null)throw d.i.Ie();return f},c.zh=function(f,y,v){if(y.Nb(v))return f;var _=c.sD[y.cc()+"-"+v.cc()];if(_!==void 0)return _(f,y,v);throw d.i.Ie()},c.vt=function(){throw d.i.Ie()},c.bR=function(){throw d.i.Ie()},c.dW=function(){throw d.i.Ie()},c.ml=function(){throw d.i.Ie()},c.sW=function(){var f=d.Eg.create(102100),y=d.Eg.create(3857),v=d.Eg.create(4326);d.cb.xB(f,v,NaN,NaN,NaN,!1,null),d.cb.xB(v,v,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]),d.cb.xB(y,v,NaN,NaN,NaN,!1,null),d.cb.Ww(f,v,l),d.cb.Ww(v,f,s),d.cb.Ww(y,v,l),d.cb.Ww(v,y,s)},c.gD=[],c.mD=[],c.zD=[],c.aD=[],c.nD=[],c.oD=[],c.sD=[],c}()}(Y||(Y={})),Y.cb.sW(),function(d){var O=function(){function x(h){this.o=new Int32Array(0),this.io=-1,this.Hg=this.size=this.Bl=0,this.stride=h}return x.prototype.jd=function(h){h<this.Bl?(this.o[h*this.stride]=this.io,this.io=h):this.Bl--,this.size--},x.prototype.T=function(h,l){return this.o[h*this.stride+l]},x.prototype.S=function(h,l,s){this.o[h*this.stride+l]=s},x.prototype.Ce=function(){var h=this.io;if(h==-1){if(this.Bl==this.Hg){if(2147483647<(h=this.Hg!=0?d.O.truncate(3*(this.Hg+1)/2):1)&&(h=2147483647),h==this.Hg)throw d.i.ce();this.Dz(h)}h=this.Bl,this.Bl++}else this.io=this.o[h*this.stride];this.size++;for(var l=h*this.stride;l<h*this.stride+this.stride;l++)this.o[l]=-1;return h},x.prototype.Ll=function(h){var l=this.io;if(l==-1){if(this.Bl==this.Hg){if(2147483647<(l=this.Hg!=0?d.O.truncate(3*(this.Hg+1)/2):1)&&(l=2147483647),l==this.Hg)throw d.i.ce();this.Dz(l)}l=this.Bl,this.Bl++}else this.io=this.o[l*this.stride];this.size++;for(var s=l*this.stride,a=0;a<h.length;a++)this.o[s+a]=h[a];return l},x.prototype.mj=function(h){this.io=-1,this.size=this.Bl=0,h&&(this.o=null,this.Hg=0)},x.prototype.De=function(h){h>this.Hg&&this.Dz(h)},x.prototype.tx=function(h,l){h*=this.stride,l*=this.stride;for(var s=0;s<this.stride;s++){var a=this.o[l+s];this.o[l+s]=this.o[h+s],this.o[h+s]=a}},x.prototype.gC=function(h,l,s){var a=this.o[this.stride*l+s];this.o[this.stride*l+s]=this.o[this.stride*h+s],this.o[this.stride*h+s]=a},x.LG=function(h){return 0<=h},x.prototype.Dz=function(h){this.o==null&&(this.o=new Int32Array(0));var l=new Int32Array(this.stride*h);l.set(this.o,0),this.o=l,this.Hg=h},x}();d.$c=O}(Y||(Y={})),function(d){var O,x;(x=O||(O={}))[x.enumInputModeBuildGraph=0]="enumInputModeBuildGraph",x[x.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate",x[x.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding",x[x.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon";var h=function(){function s(a){this.Be=a,this.yh=NaN,this.eH=new d.ig,this.fH=new d.ig,this.ms=new d.Nc,this.ns=new d.Nc}return s.prototype.compare=function(a,c,f){if(a=a.ja(f),this.Be.pB(c,this.eH),this.Be.pB(a,this.fH),c=this.eH.get(),a=this.fH.get(),this.ms.K(c.sa,c.pa),this.ns.K(a.sa,a.pa),this.ms.va<this.ns.oa)return-1;if(this.ms.oa>this.ns.va)return 1;f=c.na==c.la;var y=a.na==a.la;if(f||y){if(f&&y)return 0;if(c.na==a.na&&c.sa==a.sa)return f?1:-1;if(c.la==a.la&&c.pa==a.pa)return f?-1:1}return(f=c.Pe(this.yh,this.ms.oa))==(y=a.Pe(this.yh,this.ns.oa))&&((y=.5*((f=Math.min(c.la,a.la))+this.yh))==this.yh&&(y=f),f=c.Pe(y,this.ms.oa),y=a.Pe(y,this.ns.oa)),f<y?-1:f>y?1:0},s.prototype.aK=function(a){this.yh=a},s}(),l=function(){function s(a){this.ib=a,this.WH=new d.ig,this.Bf=new d.h,this.wA=new d.Nc}return s.prototype.kX=function(a){this.Bf.L(a)},s.prototype.compare=function(a,c){return this.ib.pB(a.ja(c),this.WH),a=this.WH.get(),this.wA.K(a.sa,a.pa),this.Bf.x<this.wA.oa?-1:this.Bf.x>this.wA.va?1:(a=a.Pe(this.Bf.y,this.Bf.x),this.Bf.x<a?-1:this.Bf.x>a?1:0)},s}();O=function(){function s(){this.hH=this.Di=this.Gi=this.kA=this.Yn=this.ye=this.Kc=this.jh=this.ge=null,this.Go=this.xg=-1,this.gH=!0,this.pA=!1,this.lA=NaN,this.Ni=new d.Md,this.bO=2147483647,this.aO=d.O.truncate(-2147483648),this.cg=this.ae=this.Hl=this.Cq=this.Cm=this.Bq=this.Os=this.Re=-1,this.wa=0}return s.prototype.yy=function(a){this.lA=a},s.prototype.Ym=function(){this.ge==null&&(this.ge=new d.$c(8));var a=this.ge.Ce();return this.ge.S(a,1,0),a},s.prototype.vU=function(){this.Kc==null&&(this.Kc=new d.$c(8));var a=this.Kc.Ce();this.Kc.S(a,2,0),this.Kc.S(a,3,0);var c=this.Kc.Ce();return this.Kc.S(c,2,0),this.Kc.S(c,3,0),this.JJ(a,c),this.JJ(c,a),a},s.prototype.mI=function(){this.ye==null&&(this.ye=new d.$c(8));var a=this.ye.Ce();return this.ye.S(a,2,0),a},s.prototype.TW=function(a,c){this.ge.S(a,7,c)},s.prototype.mn=function(a,c){this.ge.S(a,2,c)},s.prototype.SW=function(a,c){this.ge.S(a,1,c)},s.prototype.lX=function(a,c){this.ge.S(a,3,c)},s.prototype.iX=function(a,c){this.ge.S(a,4,c)},s.prototype.cr=function(a,c){this.ge.S(a,5,c)},s.prototype.eR=function(a){return this.ge.T(a,5)},s.prototype.RW=function(a,c){this.ge.S(a,6,c)},s.prototype.cN=function(a,c){this.RW(c,a)},s.prototype.IJ=function(a,c){this.Kc.S(a,1,c)},s.prototype.JJ=function(a,c){this.Kc.S(a,4,c)},s.prototype.Tl=function(a,c){this.Kc.S(a,5,c)},s.prototype.Sl=function(a,c){this.Kc.S(a,6,c)},s.prototype.$W=function(a,c){this.Kc.S(a,2,c)},s.prototype.$w=function(a,c){this.Kc.S(a,3,c)},s.prototype.LF=function(a){return this.Kc.T(a,3)},s.prototype.Gt=function(a,c){this.Kc.S(a,7,c)},s.prototype.EK=function(a,c){if(this.mm(a)!=-1)for(c=c?-1:a,a=this.mm(a);a!=-1;a=this.js(a))this.g.Ra(this.tj(a),this.Cq,c)},s.prototype.yx=function(a,c){a!=-1&&(this.EK(a,c),this.EK(this.xa(a),c))},s.prototype.Dt=function(a,c){this.ye.S(a,1,c)},s.prototype.Vg=function(a,c){this.ye.S(a,2,c)},s.prototype.jn=function(a,c){this.ye.S(a,3,c),this.NW(a,this.dR(c)),this.MW(c,a)},s.prototype.MW=function(a,c){this.ye.S(a,4,c)},s.prototype.NW=function(a,c){this.ye.S(a,5,c)},s.prototype.DJ=function(a,c){this.ye.S(a,6,c)},s.prototype.BJ=function(a,c){this.ye.S(a,7,c)},s.prototype.AJ=function(a,c){this.Yn.write(a,c)},s.prototype.CJ=function(a,c){this.kA.write(a,c)},s.prototype.kY=function(a){var c=0,f=0,y=this.AF(a),v=new d.h,_=new d.h,$=new d.h;this.Yr(y,v),_.L(v);var I=y;do this.lm(I,$),f+=d.h.tb(_,$),this.$e(this.xa(I))!=a&&(c+=($.x-v.x-(_.x-v.x))*($.y-v.y+(_.y-v.y))*.5),_.L($),I=this.jc(I);while(I!=y);this.Yn.write(a,c),this.kA.write(a,f)},s.prototype.PU=function(a,c){var f=new h(this),y=new d.Yj;y.De(d.O.truncate(this.wa/2)),y.Vo(f);for(var v=new d.ia(0),_=this.$g(),$=null,I=0,k=new d.h,A=this.Re;A!=-1;A=this.Rf(A)){if(!(255&++I||c==null||c.progress(-1,-1)))throw d.i.WC();var P=this.Me(A);if(P!=-1){if(v.Bh(0),!this.gY(y,_,v,P)){this.D(A,k),f.aK(k.y);var D=P;do{var j=this.Ab(D,_);j!=-1&&(y.vd(j,-1),this.Kb(D,_,-2)),D=this.jc(this.xa(D))}while(P!=D);D=P;do(j=this.Ab(D,_))==-1&&(j=y.addElement(D,-1),v.add(j)),D=this.jc(this.xa(D));while(P!=D)}for(P=v.size-1;0<=P;P--)j=v.get(P),D=y.ja(j),this.Kb(this.xa(D),_,j),this.OU(y,j,a)}else this.cz(A)==-1&&($==null&&($=new l(this)),this.D(A,k),$.kX(k),D=y.IW($),P=this.Hl,D!=-1&&(j=y.ja(D),this.$e(j)==this.$e(this.xa(j))&&(j=this.OF(y,D)),j!=-1&&(P=this.$e(j))),this.cN(P,A))}this.Jg(_)},s.prototype.OU=function(a,c,f){var y=a.ja(c),v=this.$e(y);if(this.Gn(v)==-1){var _=this.OF(a,c),$=this.xa(y),I=this.$e($);this.Kp(v),this.Kp(I);var k=this.Gn(v),A=this.Gn(I);if(_==-1&&k==-1&&(I==v?(this.jn(I,this.Hl),k=A=this.Hl):(A==-1&&(this.jn(I,this.Hl),A=this.Hl),this.jn(v,I),k=I)),_!=-1){var P=this.$e(_);A==-1&&(0>=this.Kp(P)?(A=this.Gn(P),this.jn(I,A)):(this.jn(I,P),A=P),I==v&&(k=A))}k==-1&&this.hY(v,I),f==0?this.jW(a,c,y,_,v,I):f==5?this.kW(a,c,y,$,v,I):f==4&&this.iW(y,_,v,I)}},s.prototype.jW=function(a,c,f,y,v,_){var $=this.hk(v);if(y!=-1){var I=this.hk(_),k=this.hk(this.$e(y));y=$&I&k,k^=k&this.dh(f),(k|=y)!=0&&(this.Vg(_,I|k),this.Vg(v,k|$),$=$||k)}for(c=a.lb(c);c!=-1&&(y=a.ja(c),f=this.$e(this.xa(y)),v=this.hk(f),_=this.dh(y),I=this.$e(y),y=v&(k=this.hk(I))&$,$^=$&_,($|=y)!=0);c=a.lb(c))this.Vg(f,v|$),this.Vg(I,k|$)},s.prototype.kW=function(a,c,f,y,v,_){if(v!=_){f=this.Ab(f,this.cg),f+=this.Ab(y,this.cg),y=0;var $=new d.ia(0),I=new d.ia(0);I.add(0);for(var k=a.rc(-1);k!=c;k=a.lb(k)){var A=a.ja(k),P=this.xa(A),D=this.$e(A),j=this.$e(P);if(D!=j){if(A=this.Ab(A,this.cg),y+=A+=this.Ab(P,this.cg),P=!1,$.size!=0&&$.Fc()==j&&(I.If(),$.If(),P=!0),this.Gn(j)==-1)throw d.i.Qa();P&&this.Gn(j)==D||(I.add(y),$.add(D))}}y+=f,$.size!=0&&$.Fc()==_&&(I.If(),$.If()),y!=0?I.Fc()==0&&(a=this.g.ld,a=this.La(a),this.Vg(v,a)):I.Fc()!=0&&(a=this.g.ld,a=this.La(a),this.Vg(v,a))}},s.prototype.iW=function(a,c,f,y){var v=this.La(this.g.ld);if(c==-1)this.Vg(y,this.Go),1&(a=this.Ab(a,this.xg))?this.Vg(f,v):this.Vg(f,this.Go);else{var _=this.hk(y);_==0?(_=this.hk(this.$e(c)),this.Vg(y,_),1&(a=this.Ab(a,this.xg))?this.Vg(f,_==v?this.Go:v):this.Vg(f,_)):1&(a=this.Ab(a,this.xg))?this.Vg(f,_==v?this.Go:v):this.Vg(f,_)}},s.prototype.gY=function(a,c,f,y){var v=y,_=-1,$=-1,I=0;do{if(I==2)return!1;var k=this.Ab(v,c);if(k!=-1){if(_!=-1)return!1;_=k}else{if($!=-1)return!1;$=v}I++,v=this.jc(this.xa(v))}while(y!=v);return $!=-1&&_!=-1&&(this.Kb(a.ja(_),c,-2),a.Sj(_,$),f.add(_),!0)},s.prototype.hY=function(a,c){var f=this.Kp(a);if(f!=0){var y=this.Kp(c);0<f&&0>y||0>f&&0<y?this.jn(a,c):(c=this.Gn(c))!=-1&&this.jn(a,c)}},s.prototype.vP=function(a,c){this.Cq=this.g.Gd();for(var f=0,y=c.size;f<y;f++){var v=c.get(f),_=this.g.Pa(v,this.Cm),$=this.g.Qf(this.g.bd(v)),I=this.g.ic($);if(d.aa.Hc(I)){var k=this.g.U(v);if(k!=-1){var A=this.g.Pa(k,this.Cm);if(_!=A){var P=this.vU(),D=this.xa(P),j=this.jh.Ce();this.jh.S(j,0,v),this.jh.S(j,1,-1),this.Gt(P,j),this.IJ(P,_),(j=this.Me(_))==-1?(this.mn(_,P),this.Tl(P,D),this.Sl(D,P)):(_=this.te(j),this.Tl(j,D),this.Sl(D,j),this.Sl(_,P),this.Tl(P,_)),this.IJ(D,A),(_=this.Me(A))==-1?(this.mn(A,D),this.Sl(P,D),this.Tl(D,P)):(A=this.te(_),this.Tl(_,P),this.Sl(P,_),this.Sl(A,D),this.Tl(D,A)),$=this.La($),a==0?(this.Kb(D,this.ae,0),this.Kb(P,this.ae,I==1736?$:0)):a==5?(A=new d.h,this.g.D(v,A),v=new d.h,this.g.D(k,v),_=k=0,0>A.compare(v)?k=1:_=-1,this.Kb(D,this.ae,0),this.Kb(P,this.ae,0),this.Kb(P,this.cg,k),this.Kb(D,this.cg,_)):a==7?(this.Kb(D,this.ae,this.Go),this.Kb(P,this.ae,I==1736?$:0)):a==4&&(this.Kb(D,this.ae,0),this.Kb(P,this.ae,0),this.Kb(P,this.xg,1),this.Kb(D,this.xg,1)),I=I==1736?this.aO:0,this.$w(P,$|I),this.$w(D,$|I)}}}}},s.prototype.VT=function(a,c){var f=this.mm(c);if(f!=-1){var y=this.mm(a);this.jh.S(f,1,y),this.Gt(a,f),this.Gt(c,-1)}a=this.xa(a),c=this.xa(c),(f=this.mm(c))!=-1&&(y=this.mm(a),this.jh.S(f,1,y),this.Gt(a,f),this.Gt(c,-1))},s.prototype.IX=function(a){function c(ee,Q){return y.HO(ee,Q)}var f=new d.ia(0);f.Jb(10);for(var y=this,v=this.Re;v!=-1;v=this.Rf(v)){f.clear(!1);var _=this.Me(v);if(_!=-1){var $=_;do f.add($),$=this.jc(this.xa($));while($!=_);if(1<f.size){if($=!0,2<f.size)f.Vd(0,f.size,c),f.add(f.get(0));else if(0<this.GO(f.get(0),f.get(1))){var I=f.get(0);f.set(0,f.get(1)),f.set(1,I)}else $=!1;for(var k=I=f.get(0),A=this.uf(k),P=this.xa(k),D=-1,j=1,B=f.size;j<B;j++){var q=f.get(j),z=this.xa(q),Z=this.jk(z);if(Z==A&&q!=k){if(a==0)D=this.LF(k)|this.LF(q),this.$w(k,D),this.$w(P,D),this.Kb(k,this.ae,this.Ab(k,this.ae)|this.Ab(q,this.ae)),this.Kb(P,this.ae,this.Ab(P,this.ae)|this.Ab(z,this.ae));else if(this.cg!=-1)D=this.Ab(k,this.cg)+this.Ab(q,this.cg),z=this.Ab(P,this.cg)+this.Ab(z,this.cg),this.Kb(k,this.cg,D),this.Kb(P,this.cg,z);else{if(a==7)return void(this.Ni=new d.Md(5,v,-1));this.xg!=-1&&(D=this.Ab(k,this.xg)+this.Ab(q,this.xg),z=this.Ab(P,this.xg)+this.Ab(z,this.xg),this.Kb(k,this.xg,D),this.Kb(P,this.xg,z))}this.VT(k,q),this.Ly(q),D=k,f.set(j,-1),q==I&&(f.set(0,-1),I=-1)}else this.yx(D,!1),D=-1,k=q,A=Z,P=z}if(this.yx(D,!1),D=-1,$){for(I=-1,j=0,B=f.size;j<B;j++)if((q=f.get(j))!=-1){if(I==-1)k=I=q,A=this.uf(k),P=this.xa(k);else if(q!=k&&(z=this.xa(q),Z=this.jk(z),this.Sl(P,q),this.Tl(q,P),k=q,A=Z,P=z,a==7&&(this.Ab(q,this.ae)|this.Ab(this.te(q),this.ae))==(1|this.Go)))return void(this.Ni=new d.Md(5,v,-1))}this.mn(v,I)}else{for(I=-1,j=0,B=f.size;j<B;j++)if((q=f.get(j))!=-1){I=q;break}_!=I&&this.mn(v,I)}}}}},s.prototype.WN=function(){for(var a=-1,c=this.$g(),f=this.Re;f!=-1;f=this.Rf(f)){var y=this.Me(f);if(y!=-1){var v=y;do{if(this.Ab(v,c)!=1){var _=this.mI();this.Dt(_,v),this.BJ(_,a),a!=-1&&this.DJ(a,_),a=_;var $=0,I=v;do $|=this.Ab(I,this.ae),this.$W(I,_),this.Kb(I,c,1),I=this.jc(I);while(I!=v);this.Vg(_,$)}v=this.jc(this.xa(v))}while(v!=y)}}_=this.mI(),this.Dt(_,-1),this.BJ(_,a),a!=-1&&this.DJ(a,_),this.Hl=_,this.Yn=d.be.qf(this.ye.size,NaN),this.kA=d.be.qf(this.ye.size,NaN),this.AJ(this.Hl,1/0),this.CJ(this.Hl,1/0),this.Jg(c)},s.prototype.sR=function(a,c,f){if((c=c!=-1?c:this.Me(a))==-1)return-1;for(a=c;;){if(this.Ab(c,f)!=1)return c;if((c=this.jc(this.xa(c)))==a)return-1}},s.prototype.yW=function(){for(var a=this.$g(),c=this.Re;c!=-1;c=this.Rf(c))for(var f=-1;;){var y=this.sR(c,f,a);if(y==-1)break;f=this.jc(this.xa(y));for(var v=y;;){var _=this.jc(v),$=this.te(v),I=this.xa(v);if($==I){if(this.IP(v),f!=v&&f!=I||(f=-1),v==y||$==y){if(v==(y=_)||$==y)break;v=_;continue}}else this.Kb(v,a,1);if((v=_)==y)break}}this.Jg(a)},s.prototype.MB=function(a,c,f,y,v){this.Ug(),this.gH=v,this.g=a,this.Bq=this.g.aF(),(a=new d.ia(0)).Jb(f!=null?this.g.I(f.get(0)):this.g.fd);var _=0,$=1,I=f!=null?f.get(0):this.g.ld;for(v=1;I!=-1;){this.g.HJ(I,this.Bq,$),$<<=1;for(var k=this.g.Ob(I);k!=-1;k=this.g.Rb(k))for(var A=this.g.Xa(k),P=0,D=this.g.Ja(k);P<D;P++)a.add(A),A=this.g.U(A);d.aa.Rn(this.g.ic(I))||(_+=this.g.da(I)),f!=null?(I=v<f.size?f.get(v):-1,v++):I=this.g.ue(I)}for(this.Go=$,this.wa=a.size,this.g.nx(a,this.wa),this.jh==null&&(this.jh=new d.$c(2),this.ge=new d.$c(8),this.Kc=new d.$c(8),this.ye=new d.$c(8)),this.jh.De(this.wa),d.mp.zp(y),this.ge.De(this.wa+10),this.Kc.De(2*this.wa+32),this.ye.De(Math.max(32,_)),this.Cm=this.g.Gd(),f=new d.h,v=0,_=new d.h,f.Rc(),$=0;$<=this.wa;$++)if($<this.wa?(A=a.get($),this.g.D(A,_)):_.Rc(),!f.qb(_)){if(v<$){for(A=this.Ym(),D=P=-1;v<$;v++)D=a.get(v),this.g.Ra(D,this.Cm,A),I=this.jh.Ce(),this.jh.S(I,0,D),this.jh.S(I,1,P),P=I,k=this.g.bd(D),I=this.g.Qf(k),I=this.La(I),this.SW(A,this.xd(A)|I);this.TW(A,P),this.cr(A,this.g.Ua(D)),this.Os!=-1&&this.iX(this.Os,A),this.lX(A,this.Os),this.Os=A,this.Re==-1&&(this.Re=A)}v=$,f.L(_)}d.mp.zp(y),this.ae=this.$g(),c==5&&(this.cg=this.$g()),c==4&&(this.xg=this.$g()),this.vP(c,a),this.Ni.Jj==0&&(this.IX(c),this.Ni.Jj==0&&(isNaN(this.lA)||this.xO()?(this.WN(),this.Ni.Jj==0&&(this.Jg(this.ae),this.ae=-1,this.gH&&this.PU(c,y))):this.pA=!0))},s.prototype.Ly=function(a){var c=this.jc(a),f=this.te(a),y=this.xa(a),v=this.jc(y),_=this.te(y);c!=y&&(this.Sl(_,c),this.Tl(c,_)),f!=y&&(this.Sl(f,v),this.Tl(v,f)),f=this.jk(a),this.Me(f)==a&&(v!=a?this.mn(f,v):this.mn(f,-1)),v=this.jk(y),this.Me(v)==y&&(c!=y?this.mn(v,c):this.mn(v,-1)),this.Kc.jd(a),this.Kc.jd(y)},s.prototype.OF=function(a,c){for(;;){if((c=a.we(c))==-1)return-1;var f=a.ja(c);if(this.$e(f)!=this.$e(this.xa(f)))return f}},s.prototype.dr=function(a,c){var f;f===void 0&&(f=!0),this.MB(a,0,null,c,f)},s.prototype.vJ=function(a,c,f){var y=new d.ia(0);y.add(c),this.MB(a,4,y,f,a.ic(c)==1736)},s.prototype.wJ=function(a,c,f){var y=new d.ia(0);y.add(c),this.MB(a,5,y,f,!0)},s.prototype.Ug=function(){this.g!=null&&(this.Bq!=-1&&(this.g.xW(this.Bq),this.Bq=-1),this.Cm!=-1&&(this.g.Td(this.Cm),this.Cm=-1),this.Cq!=-1&&(this.g.Td(this.Cq),this.Cq=-1),this.ae!=-1&&(this.Jg(this.ae),this.ae=-1),this.cg!=-1&&(this.Jg(this.cg),this.cg=-1),this.xg!=-1&&(this.Jg(this.xg),this.xg=-1),this.g=null,this.ge.mj(!0),this.jh.mj(!0),this.Os=this.Re=-1,this.Kc!=null&&this.Kc.mj(!0),this.Gi!=null&&(this.Gi.length=0),this.Di!=null&&(this.Di.length=0),this.hH!=null&&(this.hH.length=0),this.ye!=null&&this.ye.mj(!0),this.Hl=-1,this.Yn=null)},s.prototype.Me=function(a){return this.ge.T(a,2)},s.prototype.D=function(a,c){this.g.dG(this.eR(a),c)},s.prototype.xd=function(a){return this.ge.T(a,1)},s.prototype.Rf=function(a){return this.ge.T(a,4)},s.prototype.cz=function(a){return this.ge.T(a,6)},s.prototype.km=function(a){return this.ge.T(a,7)},s.prototype.js=function(a){return this.jh.T(a,1)},s.prototype.tj=function(a){return this.jh.T(a,0)},s.prototype.ng=function(a,c){return(c=this.Di[c]).size<=a?-1:c.read(a)},s.prototype.nn=function(a,c,f){(c=this.Di[c]).size<=a&&c.resize(this.ge.size,-1),c.write(a,f)},s.prototype.Dp=function(){this.Di==null&&(this.Di=[]);for(var a=d.ia.qf(this.ge.Hg,-1),c=0,f=this.Di.length;c<f;c++)if(this.Di[c]==null)return this.Di[c]=a,c;return this.Di.push(a),this.Di.length-1},s.prototype.Ep=function(a){this.Di[a]=null},s.prototype.jk=function(a){return this.Kc.T(a,1)},s.prototype.uf=function(a){return this.jk(this.xa(a))},s.prototype.xa=function(a){return this.Kc.T(a,4)},s.prototype.te=function(a){return this.Kc.T(a,5)},s.prototype.jc=function(a){return this.Kc.T(a,6)},s.prototype.$e=function(a){return this.Kc.T(a,2)},s.prototype.af=function(a){return this.hk(this.Kc.T(a,2))},s.prototype.mm=function(a){return this.Kc.T(a,7)},s.prototype.Yr=function(a,c){this.D(this.jk(a),c)},s.prototype.lm=function(a,c){this.D(this.uf(a),c)},s.prototype.dh=function(a){return this.Kc.T(a,3)&this.bO},s.prototype.Ab=function(a,c){return(c=this.Gi[c]).size<=a?-1:c.read(a)},s.prototype.Kb=function(a,c,f){(c=this.Gi[c]).size<=a&&c.resize(this.Kc.size,-1),c.write(a,f)},s.prototype.$g=function(){this.Gi==null&&(this.Gi=[]);for(var a=d.ia.qf(this.Kc.Hg,-1),c=0,f=this.Gi.length;c<f;c++)if(this.Gi[c]==null)return this.Gi[c]=a,c;return this.Gi.push(a),this.Gi.length-1},s.prototype.Jg=function(a){this.Gi[a]=null},s.prototype.IP=function(a){var c=this.$e(a),f=this.xa(a),y=this.jc(a);y==f&&(y=this.jc(y))==a&&(y=-1);var v=this.AF(c);v!==a&&v!=f||this.Dt(c,y),f=this.Yn.read(c),isNaN(f)||(this.AJ(c,NaN),this.CJ(c,NaN)),this.yx(a,!0),this.Ly(a)},s.prototype.JP=function(a){for(var c=0,f=a.size;c<f;c++){var y=a.get(c),v=this.$e(this.xa(y));this.Dt(this.$e(y),-1),this.Dt(v,-1),this.yx(y,!0),this.Ly(y)}},s.prototype.AF=function(a){return this.ye.T(a,1)},s.prototype.hk=function(a){return this.ye.T(a,2)},s.prototype.Gn=function(a){return this.ye.T(a,3)},s.prototype.dR=function(a){return this.ye.T(a,4)},s.prototype.Kp=function(a){var c=this.Yn.read(a);return isNaN(c)&&(this.kY(a),c=this.Yn.read(a)),c},s.prototype.La=function(a){return this.g.KF(a,this.Bq)},s.prototype.Le=function(a){return this.g.Pa(a,this.Cm)},s.prototype.uR=function(a){return this.g.Pa(a,this.Cq)},s.prototype.tR=function(a,c){var f=this.Me(a);if(f==-1)return-1;var y=f,v=-1,_=-1;do{if(this.uf(y)==c)return y;if(v==-1){if((v=this.Me(c))==-1)break;_=v}if(this.uf(_)==a)return this.xa(_);y=this.jc(this.xa(y)),_=this.jc(this.xa(_))}while(y!=f&&_!=v);return-1},s.prototype.pB=function(a,c){c.Or(),c=c.get();var f=new d.h;this.Yr(a,f),c.Dc(f),this.lm(a,f),c.Qc(f)},s.prototype.HO=function(a,c){if(a==c)return 0;var f=new d.h;this.lm(a,f);var y=new d.h;return this.lm(c,y),f.qb(y)?0:(c=new d.h,this.Yr(a,c),(a=new d.h).uc(f,c),(f=new d.h).uc(y,c),d.h.nu(a,f))},s.prototype.GO=function(a,c){if(a==c)return 0;var f=new d.h;this.lm(a,f);var y=new d.h;return this.lm(c,y),f.qb(y)?0:(c=new d.h,this.Yr(a,c),(a=new d.h).uc(f,c),(f=new d.h).uc(y,c),0<=f.y&&0<a.y?d.h.nu(a,f):0)},s.prototype.xO=function(){for(var a=d.lc.ox(this.lA),c=new d.h,f=new d.h,y=new d.h,v=new d.h,_=new d.h,$=this.Re;$!=-1;$=this.Rf($)){var I=this.Me($);if(I!=-1){var k=I;this.Yr(k,c),this.lm(k,f),_.uc(f,c);var A=_.Sk();do{var P=k;if((k=this.jc(this.xa(k)))!=P){this.lm(k,y),v.uc(y,c),P=v.Sk();var D=v.wi(_);if(D*D/(P*A)*Math.min(P,A)<=a)return!1;_.L(v),A=P,f.L(y)}}while(k!=I)}}return!0},s}(),d.iu=O}(Y||(Y={})),function(d){var O=function(){function x(){this.j=null,this.oH=new d.h,this.pH=new d.h,this.Gj=null,this.Mv=!1,this.tl=-1}return x.prototype.cf=function(h){return h<this.Gj.length&&this.Gj[h]},x.prototype.dl=function(h,l,s,a){var c=d.aa.tf(this.j.g.ic(s));if(d.aa.tf(this.j.g.ic(l))!=2||c!=1)throw d.i.Qa();this.FP(h,l,s,a)},x.prototype.dr=function(h,l){this.j==null&&(this.j=new d.iu),this.j.dr(h,l)},x.prototype.Ft=function(h,l,s){for(d.Tk.V(h,l,s,!0),l=h.ld;l!=-1;l=h.ue(l))h.ic(l)==1736&&d.rn.V(h,l,-1,this.Mv,s);this.dr(h,s)},x.prototype.ME=function(h,l,s,a,c){var f=this.j.g;if(f.ic(h)==1736)for(h=f.Ob(h);h!=-1;h=f.Rb(h)){var y=f.Xa(h);this.j.Le(y),this.j.Le(f.U(y));var v=this.j.uR(y);if(v!=-1){var _=this.j.Ab(v,s);if(_!=1&&_!=2)if(this.cf(this.j.af(v))){this.j.Kb(v,s,1),_=f.vf(l,-1);var $=v,I=this.j.Le(y),k=1;do{var A=this.sm(y,c);f.ij(_,A),a!=-1&&this.j.nn(I,a,1),this.j.Kb($,s,1),$=this.j.jc($);do var P=(A=k==1?f.U(y):f.Ma(y))!=-1?this.j.Le(A):-1;while(P==I);var D=this.j.jk($);if(D!=P){do P=(A=k==1?f.Ma(y):f.U(y))!=-1?this.j.Le(A):-1;while(P==I);D!=P?(P=D,A=this.j.tj(this.j.km(P))):k=-k}I=P,y=A}while($!=v);f.kn(_,!0)}else this.j.Kb(v,s,2)}}},x.prototype.eF=function(){for(var h=this.j.$g(),l=new d.ia(0),s=this.j.Re;s!=-1;s=this.j.Rf(s)){var a=this.j.Me(s),c=a;if(a!=-1)do{if(this.j.Ab(c,h)!=1){var f=this.j.xa(c);this.j.Kb(f,h,1),this.j.Kb(c,h,1),this.cf(this.j.af(c))&&this.cf(this.j.af(f))&&l.add(c)}c=this.j.jc(this.j.xa(c))}while(c!=a)}this.j.Jg(h),this.j.JP(l)},x.prototype.sm=function(h,l){return l==-1?h:this.aS(h,l)},x.prototype.aS=function(h,l){var s=this.j.g,a=this.j.km(this.j.Le(h));do{var c=this.j.tj(a);if(s.Qf(s.bd(c))==l)return c;a=this.j.js(a)}while(a!=-1);return h},x.prototype.Ot=function(h,l,s){this.eF();var a=this.j.g,c=a.Ig(1736),f=this.j.$g();return this.uK(h,l,c,s,f,-1),this.j.Jg(f),d.rn.V(a,c,1,this.Mv,null),c},x.prototype.uK=function(h,l,s,a,c,f){for(this.ME(h,s,c,f,a),l!=-1&&this.ME(l,s,c,f,a),h=this.j.g,l=this.j.Re;l!=-1;l=this.j.Rf(l)){var y=this.j.Me(l);if(y!=-1){var v=y;do{var _=this.j.Ab(v,c);if(_!=1&&_!=2)if(this.cf(this.j.af(v))){_=h.vf(s,-1);var $=v;do{var I=this.j.mm($);I!=-1?I=this.j.tj(I):(I=this.j.tj(this.j.mm(this.j.xa($))),I=this.j.g.U(I)),I=this.sm(I,a),h.ij(_,I),this.j.Kb($,c,1),f!=-1&&(I=this.j.Le(I),this.j.nn(I,f,1)),$=this.j.jc($)}while($!=v);h.kn(_,!0)}else this.j.Kb(v,c,2);v=this.j.jc(this.j.xa(v))}while(v!=y)}}},x.prototype.aY=function(h,l,s){var a=this.j.g,c=a.Ig(1736),f=a.Ig(1607),y=a.Ig(550);this.eF();var v=-1,_=this.j.$g(),$=this.j.Dp();for(this.uK(h,l,c,s,_,$),h=this.j.Re;h!=-1;h=this.j.Rf(h))if((l=this.j.Me(h))!=-1){var I=l;do{var k=this.j.Ab(I,_),A=this.j.Ab(this.j.xa(I),_);if((k|=A)==2)if(k=this.j.dh(I),this.cf(k)){var P=a.vf(f,-1),D=I;k=this.Yw(h,a),k=this.sm(k,s),a.ij(P,k),this.j.nn(h,$,1);do{if(k=this.j.uf(D),A=this.Yw(k,a),A=this.sm(A,s),a.ij(P,A),this.j.Kb(D,_,1),this.j.Kb(this.j.xa(D),_,1),this.j.nn(k,$,1),D=this.j.jc(D),k=this.j.Ab(D,_),(k|=A=this.j.Ab(this.j.xa(D),_))!=2)break;if(k=this.j.dh(D),!this.cf(k)){this.j.Kb(D,_,1),this.j.Kb(this.j.xa(D),_,1);break}}while(D!=I)}else this.j.Kb(I,_,1),this.j.Kb(this.j.xa(I),_,1);I=this.j.jc(this.j.xa(I))}while(I!=l)}for(h=this.j.Re;h!=-1;h=this.j.Rf(h))(k=this.j.ng(h,$))!=1&&(k=this.j.xd(h),this.cf(k)&&(v==-1&&(v=a.vf(y,-1)),(l=this.j.km(h))!=-1&&(l=this.j.tj(l),k=this.sm(l,s),a.ij(v,k))));return this.j.Ep($),this.j.Jg(_),d.rn.V(a,c,1,this.Mv,null),(s=[])[0]=y,s[1]=f,s[2]=c,s},x.prototype.Yw=function(h,l){var s=-1;for(h=this.j.km(h);h!=-1;h=this.j.js(h)){var a=this.j.tj(h);s==-1&&(s=a);var c=this.j.La(l.Qf(l.bd(a)));if(this.cf(c)){s=a;break}}return s},x.prototype.lB=function(h,l){for(var s=this.jl(l),a=this.j.jk(l),c=this.j.uf(l),f=0,y=0,v=this.j.km(a);v!=-1;v=this.j.js(v)){var _=this.j.tj(v),$=h.bd(_),I=this.j.La(h.Qf($));$=h.Xa($),(I=!!(I&s))&&$==_&&(this.tl=l);var k=h.U(_);k!=-1&&this.j.Le(k)==c?(f++,I&&(this.tl===-1&&$==k&&(_=this.j.jc(l),this.cf(this.jl(_))&&(this.tl=_)),y++)):(_=h.Ma(_))!=-1&&this.j.Le(_)==c&&(f--,I&&(this.tl===-1&&$===_&&(_=this.j.jc(l),this.cf(this.jl(_))&&(this.tl=_)),y--))}return this.j.D(a,this.oH),this.j.D(c,this.pH),(y!=0?y:f)*(h=d.h.tb(this.oH,this.pH))},x.prototype.jl=function(h){return this.j.dh(h)|this.j.af(h)|this.j.af(this.j.xa(h))},x.prototype.xK=function(h){for(var l=this.j.xa(this.j.te(h)),s=-1;l!=h;){if(this.cf(this.jl(l))){if(s!=-1)return-1;s=l}l=this.j.xa(this.j.te(l))}return s!=-1?this.j.xa(s):-1},x.prototype.yK=function(h){for(var l=this.j.xa(this.j.jc(h)),s=-1;l!=h;){if(this.cf(this.jl(l))){if(s!=-1)return-1;s=l}l=this.j.xa(this.j.jc(l))}return s!=-1?this.j.xa(s):-1},x.prototype.mJ=function(h,l,s,a,c){var f=this.j.g,y=h,v=this.j.xa(y);this.j.Kb(y,s,1),this.j.Kb(v,s,1),this.tl=-1;for(var _=this.lB(f,y),$=y,I=-1,k=!1,A=1;;){var P=this.j.te(y);if(P==v)break;if(v=this.j.jc(v),this.j.xa(P)!=v){if((y=this.xK(y))==-1){k=!0;break}v=this.j.xa(y)}else y=P;if(y==h){I=h;break}if(P=this.jl(y),!this.cf(P))break;this.j.Kb(y,s,1),this.j.Kb(v,s,1),$=y,_+=this.lB(f,y),A++}if(I==-1)for(y=h,v=this.j.xa(y),I=y;(h=this.j.jc(y))!=v;){if(v=this.j.te(v),this.j.xa(h)!=v){if((y=this.yK(y))==-1){k=!0;break}v=this.j.xa(y)}else y=h;if(P=this.jl(y),!this.cf(P))break;this.j.Kb(y,s,1),this.j.Kb(v,s,1),I=y,_+=this.lB(f,y),A++}else if(this.tl!=-1&&($=this.tl,I=this.j.te(this.tl),this.j.xa(I)!=this.j.jc(this.j.xa($))&&(I=this.xK($))==-1))throw d.i.Qa();for(0<=_||(y=I,I=this.j.xa($),$=this.j.xa(y)),s=f.vf(l,-1),y=$,$=this.j.jk($),k=this.j.uf(I)==$&&k,_=this.Yw($,f),_=this.sm(_,c),f.ij(s,_),a!=-1&&this.j.nn($,a,1),$=0,A=k?d.O.truncate((A+1)/2):-1;h=this.j.uf(y),_=this.Yw(h,f),_=this.sm(_,c),f.ij(s,_),$++,a!=-1&&this.j.nn(h,a,1),k&&$==A&&(s=f.vf(l,-1),f.ij(s,_)),y!=I;)if(h=this.j.jc(y),this.j.te(this.j.xa(y))!=this.j.xa(h)){if((y=this.yK(y))==-1)throw d.i.Qa()}else y=h},x.prototype.Pt=function(h){for(var l=this.j.g.Ig(1607),s=this.j.$g(),a=this.j.Re;a!=-1;a=this.j.Rf(a)){var c=this.j.Me(a),f=c;do this.j.Ab(f,s)!=1&&this.cf(this.jl(f))&&this.mJ(f,l,s,-1,h),f=this.j.jc(this.j.xa(f));while(f!=c)}return this.j.Jg(s),l},x.prototype.bY=function(h){for(var l=this.j.g,s=l.Ig(1607),a=l.Ig(550),c=this.j.$g(),f=this.j.Dp(),y=-1,v=this.j.Re;v!=-1;v=this.j.Rf(v)){var _=this.j.Me(v),$=_;do{var I=this.j.Ab($,c);I!=1&&(I=this.jl($),this.cf(I)&&this.mJ($,s,c,f,h)),$=this.j.jc(this.j.xa($))}while($!=_)}for(v=this.j.Re;v!=-1;v=this.j.Rf(v))(I=this.j.ng(v,f))!=1&&(I=this.j.xd(v),this.cf(I)&&(y==-1&&(y=l.vf(a,-1)),(_=this.j.km(v))!=-1&&(_=this.j.tj(_),_=this.sm(_,h),l.ij(y,_))));return this.j.Jg(c),this.j.Ep(f),(h=[])[0]=a,h[1]=s,h},x.prototype.mr=function(){for(var h=this.j.g,l=h.Ig(550),s=h.vf(l,-1),a=this.j.Re;a!=-1;a=this.j.Rf(a))if(this.cf(this.j.xd(a))){for(var c=-1,f=this.j.km(a);f!=-1;f=this.j.js(f)){var y=this.j.tj(f);c==-1&&(c=y);var v=this.j.La(h.Qf(h.bd(y)));if(this.cf(v)){c=y;break}}h.ij(s,c)}return l},x.prototype.bq=function(h){this.Gj=[];for(var l=0;l<h;l++)this.Gj[l]=!1},x.aW=function(h,l,s){var a=h.Ia(),c=Array(1e3);d.O.$u(c,null);var f=d.O.lg(1e3,0),y=h.I(),v=!0,_=l.Db()==2;if(l.Db()!=1&&l.Db()!=2)throw d.i.Qa();for(var $=0;$<y;){var I=d.O.truncate(h.lW(c,$)-$);_?d.hd.sK(l,c,I,s,f):d.hd.tK(l,c,I,s,f);for(var k=0,A=0;A<I;A++)f[A]==0&&(v&&(v=!1,a.Fd(h,0,$)),k!=A&&a.Fd(h,$+k,$+A),k=A+1);v||k==I||a.Fd(h,$+k,$+I),$+=I}return v?h:a},x.zG=function(h,l,s){return h instanceof d.de?x.aW(h,l,s):l instanceof d.Sa?h.B()||l.B()?h.Ia():d.Tk.zU(s,h,l)?d.Tk.CO(h,l):h.Ia():x.bW(h,l,s)},x.Av=function(h,l,s,a){var c=new d.l;h.A(c);var f=new d.l;l.A(f);var y=new d.l;if(y.K(c),y.Zb(f),s=d.ta.Wd(s,y,!0),(y=new d.l).K(f),f=d.ta.Er(s),y.W(f,f),!c.isIntersecting(y)){if(h.Db()<=l.Db())return x.ki(x.Xe(h.Ia()),h,"&");if(h.Db()>l.Db())return x.ki(x.Xe(l.Ia()),h,"&")}return f=new x,y=(c=new d.gd).Ib(x.Xe(h)),l=c.Ib(x.Xe(l)),f.Ft(c,s,a),a=f.Av(y,l),h=x.ki(c.Ne(a),h,"&"),d.aa.Hc(h.getType())&&(h.Ch(2,s),h.getType()==1736&&h.fm()),h},x.bW=function(h,l,s){if(h.B()||l.B())return h.Ia();var a=[null],c=[0],f=l.Db()==2;if(l.Db()!=1&&l.Db()!=2)throw d.i.Qa();return a[0]=h.D(),f?d.hd.sK(l,a,1,s,c):d.hd.tK(l,a,1,s,c),c[0]==0?h.Ia():h},x.prototype.LU=function(h,l,s,a,c){if(h.B())return h;var f=new d.gd;return h=f.Ib(h),this.Mk(f,h,l,s,a,c)},x.prototype.NU=function(h,l,s,a,c,f){if(c&&h.ic(l)!=550){var y=new d.RC;y.TX(h,s),y.Ng?(d.Tk.V(h,s,f,!0),c=!1):this.j.yy(s)}else d.Tk.V(h,s,f,!0),c=!1;if(a&&h.ic(l)!=550?this.j.wJ(h,l,f):this.j.vJ(h,l,f),this.j.pA)return this.j.Ug(),this.j=null,this.Mk(h,l,s,a,!1,f);if(this.j.yy(NaN),f=this.j.La(l),this.bq(f+1),this.Gj[f]=!0,h.ic(l)==1736||a&&h.ic(l)!=550)return h.Yo(l,0),l=this.Ot(l,-1,-1),(h=h.Ne(l)).Yo(0),c?h.Ch(1,0):(h.Ch(2,s),h.fm()),h;if(h.ic(l)==1607)return l=this.Pt(-1),h=h.Ne(l),c||h.Ch(2,s),h;if(h.ic(l)==550)return l=this.mr(),h=h.Ne(l),c||h.Ch(2,s),h;throw d.i.Qa()},x.prototype.Mk=function(h,l,s,a,c,f){this.j=new d.iu;try{return this.NU(h,l,s,a,c,f)}finally{this.j.Ug()}},x.Mk=function(h,l,s,a,c){return new x().LU(h,l,s,a,c)},x.prototype.MU=function(h,l,s,a){this.Mv=h,this.j=new d.iu,h=l.In(s);var c=l.ic(s);if(h!=1||c==550?this.j.vJ(l,s,a):this.j.wJ(l,s,a),!this.j.pA)if(this.j.yy(NaN),a=this.j.La(s),this.bq(a+1),this.Gj[a]=!0,l.ic(s)==1736||h==1&&l.ic(s)!=550)l.Yo(s,0),a=this.Ot(s,-1,-1),l.hC(a,s),l.BB(a);else if(l.ic(s)==1607)a=this.Pt(-1),l.hC(a,s),l.BB(a);else{if(l.ic(s)!=550)throw d.i.fa("internal error");a=this.mr(),l.hC(a,s),l.BB(a)}},x.prototype.im=function(h,l){var s=d.aa.tf(this.j.g.ic(h)),a=d.aa.tf(this.j.g.ic(l));if(s>a)return h;var c=this.j.La(h),f=this.j.La(l);if(this.bq(1+(c|f)),this.Gj[this.j.La(h)]=!0,s==2&&a==2)return this.Ot(h,l,-1);if(s==1&&a==2||s==1&&a==1)return this.Pt(-1);if(s==0)return this.mr();throw d.i.Qa()},x.prototype.Av=function(h,l){var s=d.aa.tf(this.j.g.ic(h)),a=d.aa.tf(this.j.g.ic(l)),c=this.j.La(h),f=this.j.La(l);if(this.bq(1+(c|f)),this.Gj[this.j.La(h)|this.j.La(l)]=!0,c=-1,1<this.j.g.ht.Aa&&(c=h),s==2&&a==2)return this.Ot(h,l,c);if(s==1&&0<a||a==1&&0<s)return this.Pt(c);if(s==0||a==0)return this.mr();throw d.i.Qa()},x.prototype.Pz=function(h,l){var s=d.aa.tf(this.j.g.ic(h)),a=d.aa.tf(this.j.g.ic(l)),c=this.j.La(h),f=this.j.La(l);if(this.bq(1+(c|f)),this.Gj[this.j.La(h)|this.j.La(l)]=!0,c=-1,1<this.j.g.ht.Aa&&(c=h),s==2&&a==2)return this.aY(h,l,c);if(s==1&&0<a||a==1&&0<s)return this.bY(c);if(s==0||a==0)return(h=[])[0]=this.mr(),h;throw d.i.Qa()},x.prototype.ep=function(h,l){var s=d.aa.tf(this.j.g.ic(h)),a=d.aa.tf(this.j.g.ic(l)),c=this.j.La(h),f=this.j.La(l);if(this.bq(1+(c|f)),this.Gj[this.j.La(h)]=!0,this.Gj[this.j.La(l)]=!0,s==2&&a==2)return this.Ot(h,l,-1);if(s==1&&a==1)return this.Pt(-1);if(s==0&&a==0)return this.mr();throw d.i.Qa()},x.Xe=function(h){var l=h.getType();return l==197?(l=new d.Da(h.description),h.B()||l.ad(h,!1),l):l==33?(l=new d.de(h.description),h.B()||l.add(h),l):l==322?(l=new d.Ta(h.description),h.B()||l.oc(h,!0),l):h},x.ki=function(h,l,s){var a=h.getType();return a==197?(l=new d.Da(h.description),h.B()||l.ad(h,!1),l):a!=33||s!="|"&&s!="^"?a==322?(l=new d.Ta(h.description),h.B()||l.oc(h,!0),l):a==33&&s=="-"&&l.getType()==33||a==550&&s=="&"&&l.getType()==33?(l=new d.Sa(h.description),h.B()||h.ve(0,l),l):h:(l=new d.de(h.description),h.B()||l.add(h),l)},x.im=function(h,l,s,a){if(h.B()||l.B()||h.Db()>l.Db())return x.ki(x.Xe(h),h,"-");var c=new d.l;h.A(c);var f=new d.l;if(l.A(f),!c.isIntersecting(f))return x.ki(x.Xe(h),h,"-");var y=new d.l;return y.K(c),y.Zb(f),s=d.ta.Wd(s,y,!0),f=new x,y=(c=new d.gd).Ib(x.Xe(h)),l=c.Ib(x.Xe(l)),f.Ft(c,s,a),a=f.im(y,l),a=c.Ne(a),h=x.ki(a,h,"-"),d.aa.Hc(h.getType())&&(h.Ch(2,s),h.getType()==1736&&h.fm()),h},x.VP=function(h,l,s){if(2>h.length)throw d.i.N("not enough geometries to dissolve");for(var a=0,c=0,f=h.length;c<f;c++)a=Math.max(h[c].Db(),a);var y=new d.l;y.Oa();var v=new d.gd,_=-1,$=0,I=-1;for(c=0,f=h.length;c<f;c++)if(h[c].Db()==a)if(h[c].B())I==-1&&(I=c);else{I=c,_==-1?_=v.Ib(x.Xe(h[c])):v.uN(_,x.Xe(h[c]));var k=new d.l;h[c].xc(k),y.Zb(k),$++}return 2>$?x.Xe(h[I]):(h=a==2,l=d.ta.Wd(a==0?l:null,y,!0),new x().Mk(v,_,l,h,!0,s))},x.Pz=function(h,l,s,a){var c=[null,null,null],f=new d.l;h.A(f);var y=new d.l;l.A(y);var v=new d.l;if(v.K(f),v.Zb(y),s=d.ta.Wd(s,v,!0),(v=new d.l).K(y),y=d.ta.Er(s),v.W(y,y),!f.isIntersecting(v)){if(h.Db()<=l.Db())return c[(h=x.ki(x.Xe(h.Ia()),h,"&")).Db()]=h,c;if(h.Db()>l.Db())return c[(h=x.ki(x.Xe(l.Ia()),h,"&")).Db()]=h,c}for(y=new x,v=(f=new d.gd).Ib(x.Xe(h)),l=f.Ib(x.Xe(l)),y.Ft(f,s,a),a=y.Pz(v,l),l=0;l<a.length;l++)y=x.ki(f.Ne(a[l]),h,"&"),d.aa.Hc(y.getType())&&(y.Ch(2,s),y.getType()==1736&&y.fm()),c[y.Db()]=y;return c},x.ep=function(h,l,s,a){if(h.Db()>l.Db())return x.ki(x.Xe(h),h,"^");if(h.Db()<l.Db()||h.B())return x.ki(x.Xe(l),h,"^");if(l.B())return x.ki(x.Xe(h),h,"^");var c=new d.l;h.A(c);var f=new d.l;l.A(f);var y=new d.l;return y.K(c),y.Zb(f),s=d.ta.Wd(s,y,!0),f=new x,y=(c=new d.gd).Ib(x.Xe(h)),l=c.Ib(x.Xe(l)),f.Ft(c,s,a),a=f.ep(y,l),h=x.ki(c.Ne(a),h,"^"),d.aa.Hc(h.getType())&&(h.Ch(2,s),h.getType()==1736&&h.fm()),h},x.prototype.LQ=function(h,l){var s=this.j.g;h=s.vf(h,-1);for(var a=l.size,c=0;c<a;c++){var f=l.get(c);s.ij(h,f)}s.kn(h,!0)},x.prototype.aX=function(h,l){for(var s=this.j.g,a=s.ld;a!=-1;a=s.ue(a))if(a==l)for(var c=s.Ob(a);c!=-1;c=s.Rb(c)){var f=s.Xa(c);if(f!=-1)for(var y=s.U(f);y!=-1;){f=this.j.Le(f);var v=this.j.Le(y);(f=this.j.tR(f,v))!=-1&&(v=this.j.xa(f),this.j.Kb(f,h,1),this.j.Kb(v,h,2)),f=y,y=s.U(f)}}},x.prototype.cW=function(h,l,s,a){s=this.j.La(s),a=this.j.La(a);var c=new d.ia(0);c.Jb(256);for(var f=this.j.g,y=this.j.$g(),v=this.j.Re;v!=-1;v=this.j.Rf(v)){var _=this.j.Me(v);if(_!=-1){var $=_;do{if(this.j.Ab($,y)!=1){var I=$,k=$,A=!1,P=0;do{if(this.j.Kb(I,y,1),!A){var D=this.j.dh(I);D&a&&this.j.af(I)&s&&(k=I,A=!0)}A&&(c.add(this.j.tj(this.j.km(this.j.jk(I)))),h!=-1&&(D=this.j.dh(I))&a&&(P|=D=this.j.Ab(I,h))),I=this.j.jc(I)}while(I!=k);A&&0<this.j.Kp(this.j.$e(k))&&(I=f.Ig(1736),this.LQ(I,c),l!=-1&&f.HJ(I,l,P)),c.clear(!1)}$=this.j.jc(this.j.xa($))}while($!=_)}}this.j.Jg(y)},x.prototype.FP=function(h,l,s,a){this.j.yW();var c=-1;h!=-1&&(c=this.j.$g(),this.aX(c,s)),this.cW(c,h,l,s),c!=-1&&(this.j.Jg(c),c=-1);var f=this.j.g;for(h=0,c=f.ld;c!=-1;c=f.ue(c))c!=l&&c!=s&&(a.add(c),h++);a.Vd(0,h,function(y,v){return(y=f.wz(f.Ob(y)))<(v=f.wz(f.Ob(v)))?-1:y==v?0:1})},x.prototype.Ug=function(){this.j!=null&&(this.j.Ug(),this.j=null)},x}();d.Fg=O}(Y||(Y={})),function(d){var O=function(){function x(h){h!==void 0?this.setScale(h):this.RB()}return x.prototype.lx=function(){this.Lb=this.Gb=this.jb=this.eb=this.ab=this.bb=0},x.prototype.Nb=function(h){return this==h||h instanceof x&&this.bb==h.bb&&this.eb==h.eb&&this.Gb==h.Gb&&this.jb==h.jb&&this.ab==h.ab&&this.Lb==h.Lb},x.prototype.cc=function(){return d.O.uj(),d.O.uj(),d.O.uj(),d.O.uj(),d.O.uj(),d.O.uj()},x.prototype.Eh=function(h,l){var s=this.jb*h.x+this.ab*h.y+this.Lb;l.x=this.bb*h.x+this.eb*h.y+this.Gb,l.y=s},x.prototype.eY=function(h,l,s){for(var a=0;a<l;a++){var c=h[a].x,f=h[a].y,y=this.bb*c+this.eb*f+this.Gb;c=this.jb*c+this.ab*f+this.Lb,s[a]!=null?s[a].ma(y,c):s[a]=d.h.construct(y,c)}},x.prototype.multiply=function(h){x.multiply(this,h,this)},x.multiply=function(h,l,s){var a=h.bb*l.bb+h.jb*l.eb,c=h.eb*l.bb+h.ab*l.eb,f=h.Gb*l.bb+h.Lb*l.eb+l.Gb,y=h.bb*l.jb+h.jb*l.ab,v=h.eb*l.jb+h.ab*l.ab;h=h.Gb*l.jb+h.Lb*l.ab+l.Lb,s.bb=a,s.eb=c,s.Gb=f,s.jb=y,s.ab=v,s.Lb=h},x.prototype.Of=function(){var h=new x;return h.bb=this.bb,h.eb=this.eb,h.Gb=this.Gb,h.jb=this.jb,h.ab=this.ab,h.Lb=this.Lb,h},x.prototype.mC=function(h){if(!h.B()){for(var l=[],s=0;4>s;s++)l[s]=new d.h;h.nB(l),this.fY(l,l),h.Zw(l,4)}},x.prototype.fY=function(h,l){for(var s=0;s<h.length;s++){var a=new d.h,c=h[s];a.x=this.bb*c.x+this.eb*c.y+this.Gb,a.y=this.jb*c.x+this.ab*c.y+this.Lb,l[s]=a}},x.prototype.pS=function(h,l){h.B()||l.B()||h.R()==0||h.ca()==0?this.lx():(this.eb=this.jb=0,this.bb=l.R()/h.R(),this.ab=l.ca()/h.ca(),this.Gb=l.v-h.v*this.bb,this.Lb=l.G-h.G*this.ab)},x.prototype.dY=function(h){var l=new d.h,s=new d.h;l.ma(this.bb,this.jb),s.ma(this.eb,this.ab),l.sub(l);var a=.5*l.Sk();return l.ma(this.bb,this.jb),s.ma(this.eb,this.ab),l.add(s),h*(a>(l=.5*l.Sk())?Math.sqrt(a):Math.sqrt(l))},x.prototype.RB=function(){this.bb=1,this.jb=this.Gb=this.eb=0,this.ab=1,this.Lb=0},x.prototype.isIdentity=function(h){if(h!==void 0){var l=d.h.construct(0,1);return this.Eh(l,l),l.sub(d.h.construct(0,1)),l.Sk()>h*h?!1:(l.ma(0,0),this.Eh(l,l),!(l.Sk()>h*h)&&(l.ma(1,0),this.Eh(l,l),l.sub(d.h.construct(1,0)),l.Sk()<=h*h))}return this.bb==1&&this.ab==1&&this.eb==0&&this.Gb==0&&this.jb==0&&this.Lb==0},x.prototype.Bi=function(h){return Math.abs(this.bb*this.ab-this.jb*this.eb)<=2*h*(Math.abs(this.bb*this.ab)+Math.abs(this.jb*this.eb))},x.prototype.gg=function(h,l){this.bb=1,this.eb=0,this.Gb=h,this.jb=0,this.ab=1,this.Lb=l},x.prototype.setScale=function(h,l){l!==void 0?(this.bb=h,this.jb=this.Gb=this.eb=0,this.ab=l,this.Lb=0):this.setScale(h,h)},x.prototype.$B=function(){this.bb=0,this.eb=1,this.Gb=0,this.jb=1,this.Lb=this.ab=0},x.prototype.setRotate=function(h){this.pX(Math.cos(h),Math.sin(h))},x.prototype.pX=function(h,l){this.bb=h,this.eb=-l,this.Gb=0,this.jb=l,this.ab=h,this.Lb=0},x.prototype.shift=function(h,l){this.Gb+=h,this.Lb+=l},x.prototype.scale=function(h,l){this.bb*=h,this.eb*=h,this.Gb*=h,this.jb*=l,this.ab*=l,this.Lb*=l},x.prototype.flipX=function(h,l){this.bb=-this.bb,this.eb=-this.eb,this.Gb=h+l-this.Gb},x.prototype.flipY=function(h,l){this.jb=-this.jb,this.ab=-this.ab,this.Lb=h+l-this.Lb},x.prototype.rotate=function(h){var l=new x;l.setRotate(h),this.multiply(l)},x.prototype.inverse=function(h){if(h!==void 0){var l=this.bb*this.ab-this.eb*this.jb;l==0?h.lx():(l=1/l,h.Gb=(this.eb*this.Lb-this.Gb*this.ab)*l,h.Lb=(this.Gb*this.jb-this.bb*this.Lb)*l,h.bb=this.ab*l,h.eb=-this.eb*l,h.jb=-this.jb*l,h.ab=this.bb*l)}else this.inverse(this)},x}();d.Dd=O}(Y||(Y={})),function(d){var O=function(){function x(){}return x.prototype.lx=function(){this.hg=this.Lb=this.Gb=this.He=this.Fe=this.Ee=this.Ge=this.ab=this.eb=this.Ze=this.jb=this.bb=0},x.prototype.setScale=function(h,l,s){this.bb=h,this.eb=this.Ze=this.jb=0,this.ab=l,this.Fe=this.Ee=this.Ge=0,this.He=s,this.hg=this.Lb=this.Gb=0},x.prototype.setTranslate=function(h,l,s){this.bb=1,this.eb=this.Ze=this.jb=0,this.ab=1,this.Fe=this.Ee=this.Ge=0,this.He=1,this.Gb=h,this.Lb=l,this.hg=s},x.prototype.translate=function(h,l,s){this.Gb+=h,this.Lb+=l,this.hg+=s},x.prototype.mC=function(h){if(!h.B()){for(var l=new d.Nd[8],s=0;8>s;s++)l[s]=new d.Nd;h.nB(l),this.transform(l,8,l),h.Zw(l)}},x.prototype.transform=function(h,l,s){for(var a=0;a<l;a++){var c=new d.Nd,f=h[a];c.x=this.bb*f.x+this.eb*f.y+this.Ee*f.z+this.Gb,c.y=this.jb*f.x+this.ab*f.y+this.Fe*f.z+this.Lb,c.z=this.Ze*f.x+this.Ge*f.y+this.He*f.z+this.hg,s[a]=c}},x.prototype.fp=function(h){var l=new d.Nd;return l.x=this.bb*h.x+this.eb*h.y+this.Ee*h.z+this.Gb,l.y=this.jb*h.x+this.ab*h.y+this.Fe*h.z+this.Lb,l.z=this.Ze*h.x+this.Ge*h.y+this.He*h.z+this.hg,l},x.prototype.Ag=function(h){x.multiply(this,h,this)},x.multiply=function(h,l,s){var a=h.bb*l.bb+h.jb*l.eb+h.Ze*l.Ee,c=h.bb*l.jb+h.jb*l.ab+h.Ze*l.Fe,f=h.bb*l.Ze+h.jb*l.Ge+h.Ze*l.He,y=h.eb*l.bb+h.ab*l.eb+h.Ge*l.Ee,v=h.eb*l.jb+h.ab*l.ab+h.Ge*l.Fe,_=h.eb*l.Ze+h.ab*l.Ge+h.Ge*l.He,$=h.Ee*l.bb+h.Fe*l.eb+h.He*l.Ee,I=h.Ee*l.jb+h.Fe*l.ab+h.He*l.Fe,k=h.Ee*l.Ze+h.Fe*l.Ge+h.He*l.He,A=h.Gb*l.bb+h.Lb*l.eb+h.hg*l.Ee+l.Gb,P=h.Gb*l.jb+h.Lb*l.ab+h.hg*l.Fe+l.Lb;h=h.Gb*l.Ze+h.Lb*l.Ge+h.hg*l.He+l.hg,s.bb=a,s.jb=c,s.Ze=f,s.eb=y,s.ab=v,s.Ge=_,s.Ee=$,s.Fe=I,s.He=k,s.Gb=A,s.Lb=P,s.hg=h},x.inverse=function(h,l){var s=h.bb*(h.ab*h.He-h.Ge*h.Fe)-h.jb*(h.eb*h.He-h.Ge*h.Ee)+h.Ze*(h.eb*h.Fe-h.ab*h.Ee);if(s==0)throw d.i.fa("math singularity");var a=1/s;s=(h.ab*h.He-h.Ge*h.Fe)*a;var c=-(h.eb*h.He-h.Ge*h.Ee)*a,f=(h.eb*h.Fe-h.ab*h.Ee)*a,y=-(h.jb*h.He-h.Fe*h.Ze)*a,v=(h.bb*h.He-h.Ze*h.Ee)*a,_=-(h.bb*h.Fe-h.jb*h.Ee)*a,$=(h.jb*h.Ge-h.Ze*h.ab)*a,I=-(h.bb*h.Ge-h.Ze*h.eb)*a;a*=h.bb*h.ab-h.jb*h.eb;var k=-(h.Gb*s+h.Lb*c+h.hg*f),A=-(h.Gb*y+h.Lb*v+h.hg*_);h=-(h.Gb*$+h.Lb*I+h.hg*a),l.bb=s,l.jb=y,l.Ze=$,l.eb=c,l.ab=v,l.Ge=I,l.Ee=f,l.Fe=_,l.He=a,l.Gb=k,l.Lb=A,l.hg=h},x.prototype.Of=function(){var h=new x;return h.bb=this.bb,h.jb=this.jb,h.Ze=this.Ze,h.eb=this.eb,h.ab=this.ab,h.Ge=this.Ge,h.Ee=this.Ee,h.Fe=this.Fe,h.He=this.He,h.Gb=this.Gb,h.Lb=this.Lb,h.hg=this.hg,h},x}();d.JY=O}(Y||(Y={})),function(d){var O=function(h){function l(s){if(s!==void 0)s=h.call(this,s.cc(),s)||this;else{(s=h.call(this)||this).bg=[],s.bg[0]=0,s.Aa=1,s.uh=[];for(var a=0;10>a;a++)s.uh[a]=-1;s.uh[s.bg[0]]=0}return s.jq=!0,s}return Kt(l,h),l.prototype.re=function(s){this.hasAttribute(s)||(this.uh[s]=0,this.jD())},l.prototype.removeAttribute=function(s){if(s==0)throw d.i.N("Position attribue cannot be removed");this.hasAttribute(s)&&(this.uh[s]=-1,this.jD())},l.prototype.reset=function(){this.bg[0]=0,this.Aa=1;for(var s=0;s<this.uh.length;s++)this.uh[s]=-1;this.uh[this.bg[0]]=0,this.jq=!0},l.prototype.EF=function(){return x.kz().add(this)},l.og=function(){return x.kz().$R()},l.prototype.tM=function(){var s=this.cc();return new d.ra(s,this)},l.prototype.jD=function(){for(var s=this.Aa=0,a=0;10>s;s++)0<=this.uh[s]&&(this.bg[a]=s,this.uh[s]=a,a++,this.Aa++);this.jq=!0},l.prototype.cc=function(){return this.jq&&(this.wl=this.An(),this.jq=!1),this.wl},l.prototype.Nb=function(s){if(s==null)return!1;if(s==this)return!0;if(!(s instanceof l)||s.Aa!=this.Aa)return!1;for(var a=0;a<this.Aa;a++)if(this.bg[a]!=s.bg[a])return!1;return this.jq==s.jq},l.prototype.GG=function(s){if(s.Aa!=this.Aa)return!1;for(var a=0;a<this.Aa;a++)if(this.bg[a]!=s.bg[a])return!1;return!0},l.Iw=function(s,a){for(var c=[],f=0;f<s.Aa;f++)c[f]=-1;f=0;for(var y=s.Aa;f<y;f++)c[f]=a.Pf(s.kd(f));return c},l.BR=function(s,a){return(s=new l(s)).re(a),s.EF()},l.CR=function(s,a){for(var c=null,f=0;10>f;f++)!s.hasAttribute(f)&&a.hasAttribute(f)&&(c==null&&(c=new l(s)),c.re(f));return c!=null?c.EF():s},l}(d.ra);d.ee=O;var x=function(){function h(){this.map=[];var l=new O;this.add(l),(l=new O).re(1),this.add(l)}return h.kz=function(){return h.bL},h.prototype.$R=function(){return h.ft},h.prototype.add=function(l){var s=l.cc();if(h.ft!=null&&h.ft.cc()==s&&l.GG(h.ft))return h.ft;if(h.Dw!=null&&h.Dw.cc()==s&&l.GG(h.Dw))return h.Dw;var a=null;return this.map[s]!==void 0&&(a=this.map[s]),a==null&&((a=l.tM()).Aa==1?h.ft=a:a.Aa==2&&a.kd(1)==1?h.Dw=a:this.map[s]=a),a},h.bL=new h,h}()}(Y||(Y={}));var Kl={feet:9002,kilometers:9036,meters:9001,miles:9093,"nautical-miles":9030,yards:9096},JS={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109439,"square-yards":109442},Mh=new(function(){function d(){this.RM=50,this.np=new Map,this.gj=[]}return d.prototype.clear=function(){this.gj.length=0,this.np.clear()},d.prototype.delete=function(O){return!!this.np.delete(O)&&(this.gj.splice(this.gj.indexOf(O),1),!0)},d.prototype.get=function(O){var x=this.np.get(O);if(x!==void 0)return this.gj[0]!==O&&(this.gj.splice(this.gj.indexOf(O),1),this.gj.unshift(O)),x},d.prototype.has=function(O){return this.np.has(O)},d.prototype.set=function(O,x){return this.get(O)!==void 0&&this.delete(O),this.gj.unshift(O),this.np.set(O,x),this.oM(),this},d.prototype.oM=function(){for(;this.gj.length&&this.gj.length>this.RM;){var O=this.gj.pop();this.np.delete(O)}},d}()),Pe=((pn={}).convertJSONToGeometry=function(d){return Y.$b.fP(d)},pn.hasM=function(d){return d.hasAttribute(Y.Ih.M)},pn.hasZ=function(d){return d.hasAttribute(Y.Ih.Z)},pn.getPointX=function(d){return d.Lg()},pn.getPointY=function(d){return d.ih()},pn.getPointZ=function(d){return d.bS()},pn.getPointM=function(d){return d.zR()},pn.getXMin=function(d){return d.es()},pn.getYMin=function(d){return d.gs()},pn.getXMax=function(d){return d.ds()},pn.getYMax=function(d){return d.fs()},pn.getZExtent=function(d){return d.Tg(Y.Ih.Z,0)},pn.getMExtent=function(d){return d.Tg(Y.Ih.M,0)},pn.exportPaths=function(d){var O=[],x=d.da(),h=null,l=null,s=d.hasAttribute(Y.Ih.Z),a=d.hasAttribute(Y.Ih.M);s&&(h=d.ub(Y.Ih.Z)),a&&(l=d.ub(Y.Ih.M));for(var c=new Y.h,f=0;f<x;f++){for(var y=d.Ba(f),v=d.Ja(f),_=0,$=0,I=NaN,k=NaN,A=NaN,P=NaN,D=d.dc(f),j=[],B=y;B<y+v;B++){d.D(B,c),P=A=NaN;var q=[c.x,c.y];s&&(A=h.get(B),q.push(A)),a&&(P=l.get(B),q.push(P)),B==y&&D&&(_=c.x,$=c.y,I=A,k=P),j.push(q)}!D||_==c.x&&$==c.y&&(!s||isNaN(I)&&isNaN(A)||I==A)&&(!a||isNaN(k)&&isNaN(P)||k==P)||j.push(j[0].slice(0)),O.push(j)}return O},pn.exportPathsFlat=function(){},pn.exportPoints=function(d){var O=d.hasAttribute(Y.Ih.Z),x=d.hasAttribute(Y.Ih.M),h=null,l=null;O&&(h=d.ub(Y.Ih.Z)),x&&(l=d.ub(Y.Ih.M));for(var s=new Y.h,a=d.I(),c=[],f=0;f<a;f++){d.D(f,s);var y=[s.x,s.y];O&&y.push(h.get(f)),x&&y.push(l.get(f)),c.push(y)}return c},pn.exportPointsFlat=function(){},pn),cd=new Map;return function(){function d(){}return d.buffer=yt,d.clip=E,d.contains=L,d.convexHull=de,d.crosses=R,d.cut=C,d.densify=to,d.difference=ge,d.disjoint=J,d.distance=F,d.equals=V,d.extendedSpatialReferenceInfo=T,d.generalize=eo,d.geodesicArea=Ha,d.geodesicBuffer=qe,d.geodesicDensify=On,d.geodesicLength=oa,d.intersect=ke,d.intersects=U,d.isSimple=oe,d.nearestCoordinate=ei,d.nearestVertex=jr,d.nearestVertices=cs,d.offset=Fe,d.overlaps=X,d.planarArea=Is,d.planarLength=sa,d.relate=te,d.simplify=pe,d.symmetricDifference=we,d.touches=W,d.union=$e,d.within=H,d.rotate=Y.Ex.rotate,d.flipHorizontal=Y.Ex.JQ,d.flipVertical=Y.Ex.KQ,d.intersectLinesToPoints=s9,d.ExtendedParams=Y.yC,d.clearDefaultSpatialReferenceTolerance=n9,d.changeDefaultSpatialReferenceTolerance=hw,d._enableProjection=hn,d._project=og,d._getTransformation=Wl,d._getTransformationBySuitability=sg,d}()}var r=i();r!==void 0&&(t.exports=r)})(joe);var Voe=joe.exports;const Lt=qee(Voe),U8e=z8e({__proto__:null,default:Lt},[Voe]),G8e=Object.freeze(Object.defineProperty({__proto__:null,G:Lt,g:U8e},Symbol.toStringTag,{value:"Module"})),si={convertToGEGeometry:B8e,exportPoint:q8e,exportPolygon:H8e,exportPolyline:W8e,exportMultipoint:J8e,exportExtent:Z8e};function B8e(t,e){if(e==null)return null;let i="cache"in e?e.cache._geVersion:void 0;return i==null&&(i=t.convertJSONToGeometry(e),"cache"in e&&(e.cache._geVersion=i)),i}function q8e(t,e,i){const r=t.hasZ(e),n=t.hasM(e),o=new Ke({x:t.getPointX(e),y:t.getPointY(e),spatialReference:i});return r&&(o.z=t.getPointZ(e)),n&&(o.m=t.getPointM(e)),o.cache._geVersion=e,o}function H8e(t,e,i){const r=new xo({rings:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:i});return r.cache._geVersion=e,r}function W8e(t,e,i){const r=new Bn({paths:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:i});return r.cache._geVersion=e,r}function J8e(t,e,i){const r=new lh({hasZ:t.hasZ(e),hasM:t.hasM(e),points:t.exportPoints(e),spatialReference:i});return r.cache._geVersion=e,r}function Z8e(t,e,i){const r=t.hasZ(e),n=t.hasM(e),o=new jt({xmin:t.getXMin(e),ymin:t.getYMin(e),xmax:t.getXMax(e),ymax:t.getYMax(e),spatialReference:i});if(r){const u=t.getZExtent(e);o.zmin=u.vmin,o.zmax=u.vmax}if(n){const u=t.getMExtent(e);o.mmin=u.vmin,o.mmax=u.vmax}return o.cache._geVersion=e,o}const K8e=Object.freeze(Object.defineProperty({__proto__:null,hydratedAdapter:si},Symbol.toStringTag,{value:"Module"}));function ci(t){return Array.isArray(t)?t[0].spatialReference:t&&t.spatialReference}function Y8e(t){return Lt.extendedSpatialReferenceInfo(t)}function X8e(t,e){return Lt.clip(si,ci(t),t,e)}function Q8e(t,e){return Lt.cut(si,ci(t),t,e)}function eRe(t,e){return Lt.contains(si,ci(t),t,e)}function tRe(t,e){return Lt.crosses(si,ci(t),t,e)}function iRe(t,e,i){return Lt.distance(si,ci(t),t,e,i)}function rRe(t,e){return Lt.equals(si,ci(t),t,e)}function nRe(t,e){return Lt.intersects(si,ci(t),t,e)}function sRe(t,e){return Lt.touches(si,ci(t),t,e)}function oRe(t,e){return Lt.within(si,ci(t),t,e)}function aRe(t,e){return Lt.disjoint(si,ci(t),t,e)}function lRe(t,e){return Lt.overlaps(si,ci(t),t,e)}function uRe(t,e,i){return Lt.relate(si,ci(t),t,e,i)}function cRe(t){return Lt.isSimple(si,ci(t),t)}function hRe(t){return Lt.simplify(si,ci(t),t)}function pRe(t,e=!1){return Lt.convexHull(si,ci(t),t,e)}function dRe(t,e){return Lt.difference(si,ci(t),t,e)}function fRe(t,e){return Lt.symmetricDifference(si,ci(t),t,e)}function yRe(t,e){return Lt.intersect(si,ci(t),t,e)}function mRe(t,e=null){return Lt.union(si,ci(t),t,e)}function gRe(t,e,i,r,n,o){return Lt.offset(si,ci(t),t,e,i,r,n,o)}function vRe(t,e,i,r=!1){return Lt.buffer(si,ci(t),t,e,i,r)}function bRe(t,e,i,r,n,o){return Lt.geodesicBuffer(si,ci(t),t,e,i,r,n,o)}function wRe(t,e,i=!0){return Lt.nearestCoordinate(si,ci(t),t,e,i)}function _Re(t,e){return Lt.nearestVertex(si,ci(t),t,e)}function SRe(t,e,i,r){return Lt.nearestVertices(si,ci(t),t,e,i,r)}function AF(t){var e;return"xmin"in t?"center"in t?t.center:null:"x"in t?t:"extent"in t?((e=t.extent)==null?void 0:e.center)??null:null}function xRe(t,e,i){if(t==null)throw new kb;const r=t.spatialReference;if((i=i??AF(t))==null)throw new kb;const n=t.constructor.fromJSON(Lt.rotate(t,e,i));return n.spatialReference=r,n}function $Re(t,e){if(t==null)throw new kb;const i=t.spatialReference;if((e=e??AF(t))==null)throw new kb;const r=t.constructor.fromJSON(Lt.flipHorizontal(t,e));return r.spatialReference=i,r}function TRe(t,e){if(t==null)throw new kb;const i=t.spatialReference;if((e=e??AF(t))==null)throw new kb;const r=t.constructor.fromJSON(Lt.flipVertical(t,e));return r.spatialReference=i,r}function ERe(t,e,i,r){return Lt.generalize(si,ci(t),t,e,i,r)}function IRe(t,e,i){return Lt.densify(si,ci(t),t,e,i)}function MRe(t,e,i,r=0){return Lt.geodesicDensify(si,ci(t),t,e,i,r)}function kRe(t,e){return Lt.planarArea(si,ci(t),t,e)}function CRe(t,e){return Lt.planarLength(si,ci(t),t,e)}function ARe(t,e,i){return Lt.geodesicArea(si,ci(t),t,e,i)}function LF(t,e,i){return Lt.geodesicLength(si,ci(t),t,e,i)}function LRe(t,e){return Lt.intersectLinesToPoints(si,ci(t),t,e)}function ORe(t,e){Lt.changeDefaultSpatialReferenceTolerance(t,e)}function PRe(t){Lt.clearDefaultSpatialReferenceTolerance(t)}let kb=class extends Error{constructor(){super("Illegal Argument Exception")}};const Wit=Object.freeze(Object.defineProperty({__proto__:null,buffer:vRe,changeDefaultSpatialReferenceTolerance:ORe,clearDefaultSpatialReferenceTolerance:PRe,clip:X8e,contains:eRe,convexHull:pRe,crosses:tRe,cut:Q8e,densify:IRe,difference:dRe,disjoint:aRe,distance:iRe,equals:rRe,extendedSpatialReferenceInfo:Y8e,flipHorizontal:$Re,flipVertical:TRe,generalize:ERe,geodesicArea:ARe,geodesicBuffer:bRe,geodesicDensify:MRe,geodesicLength:LF,intersect:yRe,intersectLinesToPoints:LRe,intersects:nRe,isSimple:cRe,nearestCoordinate:wRe,nearestVertex:_Re,nearestVertices:SRe,offset:gRe,overlaps:lRe,planarArea:kRe,planarLength:CRe,relate:uRe,rotate:xRe,simplify:hRe,symmetricDifference:fRe,touches:sRe,union:mRe,within:oRe},Symbol.toStringTag,{value:"Module"}));function Jit(t){return u0(t)&&b0(t)||ea(t)}function zoe(t,e,i,...r){return u0(t)&&b0(t)?e.apply(void 0,r):ea(t)?i.apply(void 0,r):null}function Zit(t){const{spatialReference:e}=t;return zoe(e,NRe,DRe,t)}function Kit(t,e){if(!Ki(t.spatialReference,e.spatialReference))return null;const{spatialReference:i}=t;return g$[0]=t.x,g$[1]=t.y,g$[2]=t.hasZ?t.z:0,v$[0]=e.x,v$[1]=e.y,v$[2]=e.hasZ?e.z:0,OF(g$,v$,i)}function OF(t,e,i){return zoe(i,RRe,FRe,t,e,i)}function RRe(t,e,i){return kS(tg(VRe,t,e,i).distance,"meters")}function FRe(t,e,i){return kS(LF(jRe(t,e,i),"meters"),"meters")}function NRe(t){return kS(DR([t],"meters")[0],"meters")}function DRe(t){return kS(LF(t,"meters"),"meters")}function jRe(t,e,i){return{type:"polyline",spatialReference:i,paths:[[[...t],[...e]]]}}const VRe=new ow,g$=be(),v$=be();let zRe=class extends ZM{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,o=[];if(n<1)return o;const{spatialReference:u}=i,p=Xs(e,u,Jr,this.view),{view:g}=this,w=r.edges[n-1];let S=w;do{if(this.edgeExceedsShortLineThreshold(S,i)){const T=sI(S,g,i);this._processCandidateProposal(T.left,T.right,e,p,i,o)}S=S.leftVertex.leftEdge}while(S&&S!==w);return o}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,o=n.component;if(o.edges.length<2)return r;const{view:u}=this,{spatialReference:p}=i,g=Xs(e,p,Jr,u),w=n.leftEdge,S=n.rightEdge;w&&S&&this.edgeExceedsShortLineThreshold(w,i)&&this.edgeExceedsShortLineThreshold(S,i)&&this._processCandidateProposal(Tn(w.leftVertex.pos,u,i),Tn(S.rightVertex.pos,u,i),e,g,i,r);const T=o.edges[0];let E=T;do{if(E!==n.leftEdge&&E!==n.rightEdge&&this.edgeExceedsShortLineThreshold(E,i)){const C=sI(E,u,i);this._processCandidateProposal(C.left,C.right,e,g,i,r)}E=E.rightVertex.rightEdge}while(E&&E!==T);return r}_processCandidateProposal(e,i,r,n,o,u){var T;const{spatialReference:p,pointer:g}=o,w=be();URe(w,e,i,r,o);const S=Kf(w);ig(n,Xs(S,p,Jr,this.view))<this.squaredProximityThreshold(g)&&u.push(new Doe({lineStart:e,lineEnd:i,targetPoint:S,isDraped:((T=o.elevationInfo)==null?void 0:T.mode)==="on-the-ground"}))}};function URe(t,e,i,r,n){GRe(t,e,i,r,n)||BRe(t,r,e,i)}function GRe(t,e,i,r,{spatialReference:n}){const o=L3(e,i,n,n);if(o==null)return!1;const u=L3(i,r,n,n);if(u==null)return!1;const p=OF(i,r,n);if(p==null)return!1;const g=Math.abs(G1e.shortestSignedDiff(o,u))>Math.PI/2?iX.normalize(o+Math.PI):o;return Bne(t,i,n,NR(p,"meters"),ic(g,"radians","geographic"),"geodesic"),t[2]=r[2],!0}function BRe(t,e,i,r){mF(e,{start:i,end:r,type:br.LINE},t),t[2]=e[2]}let qRe=class Uoe extends JM{constructor(e,i,r,n=Hn.ALL){super(r,n),this.lineStart=e,this.lineEnd=i}equals(e){return e instanceof Uoe&&Si(this.lineStart,e.lineStart)&&Si(this.lineEnd,e.lineEnd)}},Goe=class extends cw{constructor({referenceLine:e,lineStart:i,targetPoint:r,isDraped:n}){const o=xs(i),{left:u,right:p}=e;Xi(o,nr(o,o,p),u),super(r,new $oe(i,o),n,Hn.SELF),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new wh(ql.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new qRe(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new wh(ql.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const i={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(r=>{Si(e.right,r.edge.left)&&(r.fadeLeft=!1,i.fadeRight=!1),Si(e.right,r.edge.right)&&(r.fadeRight=!1,i.fadeRight=!1),Si(e.left,r.edge.right)&&(r.fadeRight=!1,i.fadeLeft=!1),Si(e.left,r.edge.left)&&(r.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},HRe=class extends ZM{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,o=r.vertices.length,u=[];if(n<2)return u;const{view:p}=this,g=Xs(e,i.spatialReference,Jr,p),w=Tn(r.vertices[o-1].pos,p,i),S=Tn(r.vertices[0].pos,p,i),T=r.edges[n-1];let E=T;do{if(this.edgeExceedsShortLineThreshold(E,i)){const C=sI(E,p,i);this._checkEdgeForParallelLines(C,w,e,g,i,u),this._checkEdgeForParallelLines(C,S,e,g,i,u)}E=E.leftVertex.leftEdge}while(E&&E!==T);return u}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,o=n.component;if(o.edges.length<3)return r;const{view:u}=this,p=Xs(e,i.spatialReference,Jr,u),g=n.leftEdge,w=n.rightEdge,S=o.vertices[0],T=Tn(S.pos,u,i),E=o.vertices.length,C=o.vertices[E-1],L=Tn(C.pos,u,i),R=o.edges[0];let F=R;do{if(F!==g&&F!==w&&this.edgeExceedsShortLineThreshold(F,i)){const V=sI(F,u,i);g&&this._checkEdgeForParallelLines(V,Tn(g.leftVertex.pos,u,i),e,p,i,r),w&&this._checkEdgeForParallelLines(V,Tn(w.rightVertex.pos,u,i),e,p,i,r),n===S?this._checkEdgeForParallelLines(V,L,e,p,i,r):n===C&&this._checkEdgeForParallelLines(V,T,e,p,i,r)}F=F.rightVertex.rightEdge}while(F&&F!==R);return r}_checkEdgeForParallelLines(e,i,r,n,o,u){var E;const p=e.left,g=e.right;if(jO(Xy,i,p,g),tc(Xy,i)<Bp.parallelLineThreshold)return;jO(Xy,r,p,g,i);const{spatialReference:w,pointer:S}=o,T=Kf(rc(Xy[0],Xy[1],r[2]));if(ig(n,Xs(T,w,Jr,this.view))<this.squaredProximityThreshold(S)){if(this.isVertical(T,i,o)||this.isVertical(p,g,o)||WRe(e,u))return;u.push(new Goe({referenceLine:e,lineStart:i,targetPoint:T,isDraped:((E=o.elevationInfo)==null?void 0:E.mode)==="on-the-ground"}))}}};function WRe(t,e){const i=t.left,r=t.right;for(const n of e)if(jO(Xy,r,n.constraint.start,n.constraint.end,i),tc(Xy,r)<Bp.parallelLineThreshold)return n.addReferenceLine(t),!0;return!1}const Xy=Nt();let JRe=class extends ZM{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=[];if(r.vertices.length<2)return n;const{view:o}=this,u=Xs(e,i.spatialReference,Jr,o),p=r.vertices.at(-1);this._checkForSnappingCandidate(zf.LastVertex,n,p.leftEdge,p,p.leftEdge.leftVertex,e,u,i);const g=r.vertices[0];return this._checkForSnappingCandidate(zf.FirstVertex,n,g.rightEdge,g,g.rightEdge.rightVertex,e,u,i),n}snapExistingVertex(e,i){const r=[],n=i.vertexHandle;if(n.component.vertices.length<3)return r;const{view:o}=this,u=Xs(e,i.spatialReference,Jr,o),p=n.leftEdge,g=n.rightEdge;if(p!=null&&p.leftVertex.leftEdge){const w=p.leftVertex.leftEdge;this._checkForSnappingCandidate(zf.ExistingEdge,r,w,w.rightVertex,w.leftVertex,e,u,i)}if(g!=null&&g.rightVertex.rightEdge){const w=g.rightVertex.rightEdge;this._checkForSnappingCandidate(zf.ExistingEdge,r,w,w.leftVertex,w.rightVertex,e,u,i)}return r}_checkForSnappingCandidate(e,i,r,n,o,u,p,g){if(!this.edgeExceedsShortLineThreshold(r,g))return;const w=this.view,S=Tn(n.pos,w,g),T=Tn(o.pos,w,g);ZRe(pB,T,S,u,g),this._checkForSnappingCandidateAlongProjectedRay(e,i,T,S,pB,u,p,g)}_checkForSnappingCandidateAlongProjectedRay(e,i,r,n,o,u,p,g){var F;const{spatialReference:w,pointer:S}=g,T=Wr(BO,u,n),E=od(o,T)/bh(o),C=Dl(BO,n,o,E),L=Kf(rc(C[0],C[1],u[2]));if(ig(p,Xs(L,w,Jr,this.view))>this.squaredProximityThreshold(S)||this.isVertical(L,n,g)||this.isVertical(n,r,g))return;const R=ji(be(),n,o,Math.sign(E));i.push(new CF({targetPoint:L,constraint:new xoe(n,R),previousVertex:r,otherVertex:n,otherVertexType:Mb.CENTER,selfSnappingType:e,isDraped:((F=g.elevationInfo)==null?void 0:F.mode)==="on-the-ground"}))}};function ZRe(t,e,i,r,n){KRe(t,e,i,r,n)||YRe(t,e,i)}function KRe(t,e,i,r,{spatialReference:n}){const o=L3(e,i,n,n);if(o==null)return!1;const u=L3(i,r,n,n);if(u==null)return!1;const p=Math.sign(iX.shortestSignedDiff(o,u))*Math.PI*.5,g=ic(o+p,"radians","geographic"),w=be(),S=OF(i,r,n);return S!=null&&(Bne(w,i,n,NR(S,"meters"),g,"geodesic"),Xi(t,w,i),!0)}function YRe(t,e,i){const r=Wr(BO,i,e);Qt(t,r[1],-r[0],0)}const BO=Nt(),pB=be();let Boe=class extends cw{constructor({targetPoint:e,point1:i,point2:r,isDraped:n}){super(e,new Soe(VI(be(),i,r,.5),.5*g0(i,r)),n,Hn.SELF),this._p1=i,this._p2=r}get hints(){return[new wh(ql.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new wh(ql.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new Foe(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}},XRe=class extends ZM{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=[],o=r.vertices.length;if(i.editGeometryOperations.data.type!=="polygon"||o<2)return n;const{view:u}=this,p=r.vertices[0],g=r.vertices[o-1],w=Tn(p.pos,u,i),S=Tn(g.pos,u,i);return this._processCandidateProposal(w,S,e,i,n),n}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,o=n.component;if(o.edges.length<2||i.editGeometryOperations.data.type==="polyline"&&(n.index===0||n.index===o.vertices.length-1))return r;const{view:u}=this,p=Tn(n.leftEdge.leftVertex.pos,u,i),g=Tn(n.rightEdge.rightVertex.pos,u,i);return this._processCandidateProposal(p,g,e,i,r),r}_processCandidateProposal(e,i,r,n,o){var C;if(!this.exceedsShortLineThreshold(e,i,n))return;const u=TM(dB,e,i,.5),p=.5*g0(e,i),g=qPe(dB,r,u,p),w=Kf(rc(g[0],g[1],r[2])),{spatialReference:S,pointer:T}=n,E=Xs(r,S,Jr,this.view);if(ig(E,Xs(w,S,Jr,this.view))<this.squaredProximityThreshold(T)){if(this.isVertical(e,w,n)||this.isVertical(w,i,n))return;o.push(new Boe({targetPoint:w,point1:e,point2:i,isDraped:((C=n.elevationInfo)==null?void 0:C.mode)==="on-the-ground"}))}}};const dB=Nt();let q1=class extends Te{constructor(e){super(e),this.updating=!1,this._snappers=new Ie,this._domain=Hn.SELF}initialize(){this._snappers.push(new HRe(this.view,this.options),new zRe(this.view,this.options),new JRe(this.view,this.options),new XRe(this.view,this.options))}set options(e){this._set("options",e);for(const i of this._snappers)i.options=e}async fetchCandidates(e,i,r){if(!(i&this._domain&&this.options.effectiveSelfEnabled))return[];const n=[];for(const o of this._snappers.items)for(const u of o.snap(e,r))n.push(u);return IF(e,n),n}};m([b({readOnly:!0})],q1.prototype,"updating",void 0),m([b({constructOnly:!0})],q1.prototype,"view",void 0),m([b()],q1.prototype,"options",null),q1=m([G("esri.views.interactive.snapping.SelfSnappingEngine")],q1);function QRe(t,e){return[new q1({view:t,options:e}),new df({view:t,options:e,spatialReference:t.spatialReference})]}let ff=class extends Te{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new Ie}};m([b({constructOnly:!0})],ff.prototype,"layer",void 0),m([b()],ff.prototype,"enabled",void 0),m([b()],ff.prototype,"updating",void 0),m([b()],ff.prototype,"availability",void 0),m([b()],ff.prototype,"sublayerSources",void 0),ff=m([G("esri.views.interactive.snapping.FeatureSnappingLayerSource")],ff);const KM=ff;let Vs=class extends Te{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.attributeRulesEnabled=!1,this.featureSources=new Ie,this.distance=Bp.distance,this.touchSensitivityMultiplier=Bp.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var g;const e=this.featureSources;e.some(fB)&&fe.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const i=e.filter(tFe),r=((g=this._get("_effectiveFeatureSources"))==null?void 0:g.filter(fB))??new Ie;for(const w of i){const S=r.find(T=>T.layer===w.layer.parent);if(S)S.sublayerSources.includes(w)||S.sublayerSources.add(w);else if(w.layer.parent){const T=new KM({layer:w.layer.parent});T.sublayerSources.add(w),r.add(T)}}for(const w of r){const S=w.sublayerSources.filter(T=>!i.includes(T));w.sublayerSources.removeMany(S)}r.removeMany(r.filter(w=>w.sublayerSources.length===0));const n=e.filter(eFe),o=this._get("_effectiveFeatureSources")??new Ie,{added:u,removed:p}=w4(o.toArray(),[...n,...r]);return o.removeMany(p),o.addMany(u),o}};m([b()],Vs.prototype,"enabled",void 0),m([b()],Vs.prototype,"enabledToggled",void 0),m([b()],Vs.prototype,"forceDisabled",void 0),m([b()],Vs.prototype,"selfEnabled",void 0),m([b()],Vs.prototype,"featureEnabled",void 0),m([b()],Vs.prototype,"attributeRulesEnabled",void 0),m([b({type:Ie.ofType(KM)})],Vs.prototype,"featureSources",void 0),m([b()],Vs.prototype,"distance",void 0),m([b()],Vs.prototype,"touchSensitivityMultiplier",void 0),m([b({readOnly:!0})],Vs.prototype,"effectiveEnabled",null),m([b({readOnly:!0})],Vs.prototype,"effectiveSelfEnabled",null),m([b({readOnly:!0})],Vs.prototype,"effectiveFeatureEnabled",null),m([b({readOnly:!0})],Vs.prototype,"_effectiveFeatureSources",null),Vs=m([G("esri.views.interactive.snapping.SnappingOptions")],Vs);const rg=Vs;function fB(t){return t.layer.type==="subtype-group"}function eFe(t){return t.layer.type!=="subtype-group"}function tFe(t){return t.layer.type==="subtype-sublayer"}let iFe=class qoe extends JM{constructor(e,i,r=Hn.ALL){super(i,r),this.intersectionPoint=e}equals(e){return e instanceof qoe&&Si(this.intersectionPoint,e.intersectionPoint)}},f5=class extends cw{constructor(e,i,r,n){super(e,new uw(e),n,Hn.ALL),this.first=i,this.second=r}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new iFe(this.targetPoint,this.isDraped,this.domain)]}},xl=class extends Ar.EventedMixin(Te){constructor(e){super(e),this.options=new rg,this.snappingEnginesFactory=QRe,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Ep.MAIN}initialize(){this.addHandles([ce(()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:r,distance:n}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:r,distance:n}},()=>{this.doneSnapping(),this.emit("changed")},$s),ce(()=>this.options,e=>{for(const i of this._engines)i.options=e},$s),ce(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:e,snappingEnginesFactory:i})=>this._recreateEngines(e,i),ri)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)}_recreateEngines(e,i){if(this._destroyEngines(),!e)return;const{view:r,options:n}=this;this._engines=i(r,n)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,r=e*i;return r*r}snap(e){return sFe(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:i,context:r}=e;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return i;const o=this._selectUpdateInput(e);if(o==null)return i;const{spatialReference:u}=r,p=Ts(o,u);if(p==null)return i;const{view:g}=this,{elevationInfo:w,visualizer:S}=r,T=[],E=i2(p,g,w),C=n.constraint.closestTo(E);if(!this._arePointsWithinScreenThreshold(E,C,r)||!t4(n,r.drawConstraints))return this._resetSnappingState(),i;n.targetPoint=Kf(C),T.push(...n.hints);for(const L of this._currentOtherActiveCandidates)t4(L,r.drawConstraints)&&(L.targetPoint=Kf(C),T.push(...L.hints));return S!=null&&this.addHandles(S.draw(T,{spatialReference:u,elevationInfo:oFe(r),view:g,selfSnappingZ:r.selfSnappingZ}),e4),eB(C,g,i,r)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:i}){switch(this._currentSnappedType){case Ep.MAIN:return e;case Ep.SCENE:return i}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Ep.MAIN}_removeVisualization(){this.removeHandles(e4)}async _snapSinglePoint({point:e,context:i,signal:r}){const{view:n}=this,{elevationInfo:o}=i,u=i2(e,n,o),p=await this._fetchCandidates(u,Hn.ALL,i,r);return this._createSnapResult(u,Ep.MAIN,p,n,e,i,r)}async _snapMultiPoint({point:e,scenePoint:i,context:r,signal:n}){const{view:o}=this,{coordinateHelper:u,elevationInfo:p,spatialReference:g}=r;await vh(i.spatialReference,g);const w=Ts(i,g),S=i2(w,o,p),T=await this._fetchCandidates(S,Hn.FEATURE,r,n);if(T.length>0){const L=await this._fetchCandidates(S,Hn.SELF,r,n);return this._createSnapResult(S,Ep.SCENE,[...T,...L],o,w,r,n)}const E=i2(e,o,p),C=await this._fetchCandidates(E,Hn.SELF,r,n);return this._createSnapResult(E,Ep.MAIN,C,o,{z:u.hasZ()&&e.hasZ?e.z??0:void 0,m:u.hasM()&&e.hasM?e.m??0:void 0},r,n)}async _fetchCandidates(e,i,r,n){return(await Promise.all(this._engines.map(o=>o.fetchCandidates(e,i,r,n)))).flat()}_createSnapResult(e,i,r,n,o,u,p){return{get valid(){return!Xo(p)},apply:()=>{const{spatialReference:g}=u,{snappedPoint:w,hints:S}=this._processCandidates(e,i,r,u);return this._removeVisualization(),u.visualizer!=null&&this.addHandles(u.visualizer.draw(S,{spatialReference:g,elevationInfo:Jr,view:n,selfSnappingZ:u.selfSnappingZ}),e4),eB(w,n,o,u)}}}_processCandidates(e,i,r,n){if(r.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==i&&this._resetSnappingState(),IF(e,r);const o=this._currentMainCandidate;if(o!=null){const u=nFe(o,r);if(u>=0){if(!(r[u]instanceof f5))return this._intersectWithOtherCandidates(u,r,e,i,n);if(this._arePointsWithinScreenThreshold(e,o.targetPoint,n))return this._updateSnappingCandidate(o,i,r,n)}}return this._intersectWithOtherCandidates(0,r,e,i,n)}_intersectWithOtherCandidates(e,i,r,n,o){const{coordinateHelper:u}=o,p=i[e],g=[];for(let w=0;w<i.length;++w){if(w===e)continue;const S=i[w],T=p.constraint.intersect(S.constraint);if(T)for(const E of T.closestPoints(p.targetPoint))g.push([new f5(Kf(E),p,S,S.isDraped),this._squaredScreenDistance(r,E,u)])}return g.length>0&&(g.sort((w,S)=>w[1]-S[1]),g[0][1]<this._squaredPointProximityThreshold(o.pointer))?this._updateSnappingCandidate(g[0][0],n,i,o):t4(p,o.drawConstraints)?this._updateSnappingCandidate(p,n,i,o):{snappedPoint:r,hints:[]}}_updateSnappingCandidate(e,i,r,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=i;const o=this._currentMainCandidate.targetPoint,u=[];u.push(...e.hints);for(const p of r){if(e instanceof f5){if(p.constraint.equals(e.first.constraint)||p.constraint.equals(e.second.constraint))continue}else if(p.constraint.equals(e.constraint))continue;const g=p.constraint.closestTo(o);this._squaredScreenDistance(g,o,n.coordinateHelper)<rFe()&&(p.targetPoint=o,this._currentOtherActiveCandidates.push(p),u.push(...p.hints))}return{snappedPoint:o,hints:u}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,i,r){return this._squaredScreenDistance(e,i,r.coordinateHelper)<this._squaredPointProximityThreshold(r.pointer)}_squaredScreenDistance(e,i,r){return ig(this._toScreen(e,r),this._toScreen(i,r))}_toScreen(e,i){return Xs(e,i.spatialReference,Jr,this.view)}get test(){}};var Ep;m([b({constructOnly:!0})],xl.prototype,"view",void 0),m([b()],xl.prototype,"options",void 0),m([b({readOnly:!0})],xl.prototype,"updating",null),m([b()],xl.prototype,"snappingEnginesFactory",void 0),m([b()],xl.prototype,"_engines",void 0),m([b()],xl.prototype,"_squaredMouseProximityThreshold",null),m([b()],xl.prototype,"_squaredTouchProximityThreshold",null),xl=m([G("esri.views.interactive.snapping.SnappingManager")],xl),function(t){t[t.MAIN=0]="MAIN",t[t.SCENE=1]="SCENE"}(Ep||(Ep={}));const e4="visualization-handle";function rFe(){return Bp.satisfiesConstraintScreenThreshold*Bp.satisfiesConstraintScreenThreshold}function t4(t,e){return!e||e.direction==null&&e.distance==null||!(t instanceof Poe||t instanceof Roe||t instanceof Doe||t instanceof Goe||t instanceof Boe)&&(!(t instanceof CF)||e.direction==null&&t.selfSnappingType===zf.LastVertex)}function nFe(t,e){return t instanceof f5?i4(e,t.first)>=0&&i4(e,t.second)>=0?0:-1:i4(e,t)}function i4(t,e){let i=-1;for(let r=0;r<t.length;++r)if(e.constraint.equals(t[r].constraint)){i=r;break}return i}function sFe(t){return t.scenePoint!=null}function oFe({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?Jr:e}function aFe(t,e){switch(t){case"point":case"multipoint":return lFe();case"polyline":return uFe(e);case"polygon":return cFe(e);default:return}}function lFe(t){return"point"}function uFe(t){return(t!=null&&t.type==="polyline"&&t.paths.length?t.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}function cFe(t){const e=t!=null&&t.type==="polygon"&&t.rings.length?t.rings[0].length:0;return e<3?"polylineZeroVertices":e<4?"polygonOneVertex":"polygonTwoVertices"}let Nc=class extends Te{constructor(e){super(e),this.creationInfo=null,this.editorItem=null,this.parent=null,this.pendingFeatures=new Ie,this.sketchOptions=null,this.snappingManager=null,this.viewModel=null,this.upload=null}};m([b()],Nc.prototype,"creationInfo",void 0),m([b()],Nc.prototype,"editorItem",void 0),m([b()],Nc.prototype,"parent",void 0),m([b({constructOnly:!0})],Nc.prototype,"sketchOptions",void 0),m([b()],Nc.prototype,"snappingManager",void 0),m([b()],Nc.prototype,"viewModel",void 0),m([b()],Nc.prototype,"upload",void 0),Nc=m([G("esri.widgets.Editor.CreateFeaturesWorkflowData")],Nc);function r4(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function hFe(t){let e=0,i=0;for(let r=0;r<t.length;r++){const n=t[r].size;typeof n=="number"&&(e+=n,i++)}return e/i}function yB(t,e){var i;return typeof t=="number"?t:(i=t==null?void 0:t.stops)!=null&&i.length?hFe(t.stops):e}function pFe(t,e){if(!e)return t;const i=e.filter(u=>u.type==="size").map(u=>{const{maxSize:p,minSize:g}=u;return(yB(p,t)+yB(g,t))/2});let r=0;const n=i.length;if(n===0)return t;for(let u=0;u<n;u++)r+=i[u];const o=Math.floor(r/n);return Math.max(o,t)}function Hoe(t){var o;const e=t==null?void 0:t.renderer,i=t==null?void 0:t.pointerType,r=i==="touch"?9:6;if(!e)return r;const n="visualVariables"in e?pFe(r,e.visualVariables):r;if(e.type==="simple")return r4(n,e.symbol);if(e.type==="unique-value"){let u=n;return(o=e.uniqueValueInfos)==null||o.forEach(p=>{u=r4(u,p.symbol)}),u}if(e.type==="class-breaks"){let u=n;return e.classBreakInfos.forEach(p=>{u=r4(u,p.symbol)}),u}return e.type==="dot-density"||e.type,n}let kf=class extends Ar.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};m([b({constructOnly:!0})],kf.prototype,"graphic",void 0),m([b()],kf.prototype,"tracking",void 0),m([b()],kf.prototype,"displaying",void 0),m([b()],kf.prototype,"isDraped",void 0),kf=m([G("esri.views.3d.layers.graphics.GraphicState")],kf);function Woe(t,e,i,r=new jt){let n=0;if(i.type==="2d")n=e*(i.resolution??0);else if(i.type==="3d"){const S=i.overlayPixelSizeInMapUnits(t),T=i.basemapSpatialReference;n=T==null||T.equals(i.spatialReference)?e*S:hr(T)/hr(i.spatialReference)}const o=t.x-n,u=t.y-n,p=t.x+n,g=t.y+n,{spatialReference:w}=i;return r.xmin=Math.min(o,p),r.ymin=Math.min(u,g),r.xmax=Math.max(o,p),r.ymax=Math.max(u,g),r.spatialReference=w,r}function crt(t,e,i){const r=i.toMap(t);return r==null?!1:Woe(r,Hoe(),i,dFe).intersects(e)}const dFe=new jt;async function fFe(t,e){if(t.type==="2d")return t.hitTest(e);const i=await t.hitTest(e);if(i.results.length===0)return i;const r=i.results[0],n=(r.distance??0)*(1+yFe),o=i.results.findIndex(u=>(u.distance??0)>n);return o!==-1&&(i.results=i.results.slice(0,o)),r&&i.ground.distance>n&&(i.ground.mapPoint=null),i}const yFe=.05;function Joe(t){return(t==null?void 0:t.type)==="graphic"}function mFe(t){return t.find(Joe)??null}function Zoe(t){return t.filter(Joe)}function PF(t){const e=t.sourceLayer;if(!e||e.type!=="feature"||!_Fe(e.renderer))return{rotation:null,size:null};let i=null,r=null;const n=e.renderer.getVisualVariablesForType("rotation").filter(u=>(!u.axis||u.axis==="heading")&&u.field&&!u.valueExpression&&w8(u,t)!=null);n.length===1&&(i=gFe(n[0],e));const o=e.renderer.getVisualVariablesForType("size").filter(u=>u.field&&!u.useSymbolValue&&!u.valueExpression&&vQ(u)===xn.RealWorldSize&&yS(u,t)!=null);return o.length===1&&(r=wFe(o[0],e)),{rotation:i,size:r}}function gFe(t,e){const i=(t.axis||"heading")==="heading"&&t.rotationType==="arithmetic"?-1:1,r=t.field,n=e.fields&&e.fields.filter(p=>p.name===r),o=n&&n.length===1?n[0].type:"double",u={initial:0,current:0};return{field:r,fieldType:o,getDefault:()=>Promise.resolve(0),getValue:p=>(u.current=u.initial-i*p,qO((u.current+360)%360,o)),setInitialValue:p=>{u.initial=p,u.current=0},isUpdatingInteractively:!1,rotationType:t.rotationType??"geographic"}}function vFe(t,e){switch(e){case"width":return t[0];case"depth":return t[1];case"height":return t[2];default:return t[2]||t[1]||t[0]}}async function bFe(t,e,i){if(e==null)return 0;const{symbol:r}=Pm(e);if(r==null||r.type==="web-style"||r.type==="cim")return 0;const n=r.symbolLayers.at(0);if(!n)return 0;switch(n.type){case"icon":{const{computeIconLayerResourceSize:o}=await ie(()=>import("./symbolLayerUtils-2oEqaIpv.js"),[]);return n.size||Math.min(Sd.icon,(await o(n,Sd.icon))[0])||Sd.icon}case"text":return n.size||Sd.text;case"line":return n.size||Sd.line;case"object":{const{computeObjectLayerResourceSize:o}=await ie(()=>import("./symbolLayerUtils-2oEqaIpv.js"),[]);return vFe(await o(n,t.scale/Sd.viewScaleSizeFactor),i)}case"path":return(n.width!=null?n.width:n.height)||t.scale/Sd.viewScaleSizeFactor;case"extrude":return n.size||t.scale/Sd.viewScaleSizeFactor;default:return 0}}function wFe(t,e){const i=t.field,r=t.axis,n=e.fields&&e.fields.filter(w=>w.name===i),o=n&&n.length===1?n[0].type:"double",u={initial:0,current:0},p=fS[t.valueUnit]??1;let g;return g=t.valueRepresentation==="area"?w=>(w*p/2)**2*Math.PI:t.valueRepresentation==="radius"||t.valueRepresentation==="distance"?w=>w*p/2:w=>w*p,{field:i,fieldType:o,getDefault:async(w,S)=>qO(g(await bFe(S,w,r)),o),getValue:(w,S)=>(u.initial||(u.initial=S.pixelSizeAt(S.center)),u.current=u.initial*w,qO(u.current,o)),setInitialValue:w=>{u.initial=w,u.current=0},isUpdatingInteractively:!1,displayUnit:FFe(t.valueUnit),axis:t.axis}}function qO(t,e){switch(e){case"small-integer":case"integer":case"long":return Math.round(t);case"double":case"single":return t;default:return 0}}function _Fe(t){switch(t==null?void 0:t.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}async function qp(t,e,i){const r=await AO(t,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:e,scale:i});vee(t.symbol,r)!=null&&(t.symbol=r)}function SFe(t){if(!t)throw new Error("no geometry type");return t==="multipatch"?"mesh":t}async function xFe(t,e,i){var S;const r=e.layer,n={...(S=e.template)==null?void 0:S.prototype.attributes,...e.attributeOverrides};let o=null;const{view:u}=t,p=(u==null?void 0:u.type)==="2d";if(await mB(t,r,n,i,p?u.scale:null),p){const T=Da(E=>mB(t,r,n,i,E));o=ce(()=>u.scale,E=>T(E))}const{data:g,editing:w}=r.capabilities;return t.layer.elevationInfo=r.elevationInfo,e.geometryToPlace==null?await t.create(SFe(r.geometryType),{graphicProperties:{attributes:n,sourceLayer:r},hasZ:g.supportsZ,defaultZ:(p?w.zDefault:null)??t.defaultCreateOptions.defaultZ}):await t.place(e.geometryToPlace,{graphicProperties:{attributes:n,sourceLayer:r}}),o??We()}async function mB(t,e,i,r,n){const o=new Cr({sourceLayer:e,attributes:i}),{rotation:u,size:p}=PF(o);let g=await AO(o,{useSourceLayer:!0,webStyleCache:r,scale:n}),w=!1;for(const S of[p,u])S!=null&&i[S.field]==null&&(i[S.field]=await S.getDefault(g,t.view),w=!0);switch(w&&(g=await AO(o,{useSourceLayer:!0,webStyleCache:r,scale:n})),g==null?void 0:g.type){case"simple-fill":case"polygon-3d":t.polygonSymbol=g;break;case"simple-line":case"line-3d":t.polylineSymbol=g;break;case"simple-marker":case"picture-marker":case"point-3d":case"cim":t.pointSymbol=g;break;case"mesh-3d":t.meshSymbol=g}Koe(t.tooltipOptions,p,u)}function Koe(t,e,i){t.visualVariables=e!=null||i!=null?{size:e!=null?{unit:e.displayUnit,axis:e.axis,valueType:e.fieldType}:null,rotation:i!=null?{valueType:i.fieldType,rotationType:i.rotationType??"geographic"}:null}:null}function $Fe(t,e){return t==null?void 0:t.find(i=>i.layer===e)}async function TFe(t,e,i,r){switch(e.type){case"3d":return EFe(t,e,i,r);case"2d":return IFe(t,e,i,r)}}async function EFe(t,e,i,r){if(t.length===0)return[];const{updatable:n,graphicsByLayer:o}=await i.async(async()=>{const{results:u}=await zl(fFe(e,i),r),p=new Map,g=S=>{const T=S.layer,E=p.get(T);if(!E){const C=new Array;return p.set(T,C),C}return E};Zoe(u).forEach(({graphic:S})=>g(S).push(S));const w=t.filter(({capabilities:S,layer:T})=>S.update.enabled&&p.has(T));return w.length!==0&&i.stopPropagation(),{updatable:w,graphicsByLayer:p}});return zl(Promise.allSettled(n.map(async({layer:u})=>{const p=o.get(u),g=Yoe(u);if(p.every(T=>TX(g,T)))return p;const w=[];for(const T of p){w.push(T.getObjectId());const E=Object.keys(T.attributes);que(g,E)}const S=u.createQuery();return S.returnGeometry=!1,S.objectIds=w,S.outFields=Hm(u.fieldsIndex,g),u.queryFeatures(S,{signal:r}).then(({features:T})=>T)})),r)}async function IFe(t,e,i,r){if(t.length===0)return[];const{mapPoint:n}=i;if(n==null)return[];let o=null;const u=await i.async(async()=>{const{results:p}=await zl(e.hitTest(i),r);if(p.length===0)return[];const g=new Set;o=Zoe(p),o.forEach(({graphic:S})=>S&&g.add(S.layer));const w=t.filter(S=>g.has(S.layer)&&S.supportsUpdateWorkflow);return w.length>0&&i.stopPropagation(),w});return zl(Promise.allSettled(u.map(async({layer:p})=>{const g=p.createQuery();g.returnGeometry=!1,g.outFields=Yoe(p);const w="renderer"in p?Hoe({renderer:p.renderer,pointerType:i.pointerType}):0;g.geometry=Woe(n,w,e),g.outSpatialReference=e.spatialReference;const{features:S}=await p.queryFeatures(g,{signal:r});return o==null||o.forEach(({graphic:T})=>{T.layer!==p||S.some(E=>E.getObjectId()===T.getObjectId())||S.push(T)}),S})),r)}function Yoe(t){return Hm(t.fieldsIndex,[t.objectIdField,XP({displayField:"displayField"in t?t.displayField:null,fields:t.fields})])}async function MFe(t,e,i){const{sourceLayer:r}=t,n=r.createQuery();n.objectIds=[t.getAttribute(r.objectIdField)],n.outFields=["*"],n.returnM=r.capabilities.data.supportsM,n.returnZ=r.capabilities.data.supportsZ,r.type==="scene"&&r.infoFor3D!=null||(n.outSpatialReference=e);const o=await r.queryFeatures(n,{signal:i});return At(i),o.features[0]}async function HO(t){var S;const{graphic:e,sketchViewModel:i,sourceLayer:r,visualVariables:n,webStyleCache:o}=t;let u=!1;const{rotation:p,size:g}=n;if([p,g].forEach(async T=>{if(T==null)return;const E=e.getAttribute(T.field);if(E!=null)T.setInitialValue(E);else{const C=await T.getDefault(e.symbol,i.view);T.setInitialValue(C),e.setAttribute(T.field,C),u=!0}}),u){const T=((S=i.view)==null?void 0:S.type)==="2d"?i.view.scale:null;await qp(e,o,T)}const w={multipleSelectionEnabled:!1};return r.geometryType==="point"&&(w.enableRotation=p!=null,w.enableScaling=g!=null),Koe(i.tooltipOptions,g,p),i.layer.elevationInfo=r.elevationInfo,i.update(e,w)}function kFe(t){return t==null||t.type!=="rotate-start"&&t.type!=="rotate"&&t.type!=="rotate-stop"?null:t}function CFe(t){return t==null||t.type!=="scale-start"&&t.type!=="scale"&&t.type!=="scale-stop"?null:t}async function Xoe(t,e,i,r,n){var w;if(e.geometry==null||((w=e.geometry)==null?void 0:w.type)!=="point")return;const o=r.rotation,u=kFe(i.toolEventInfo);if(o!=null&&u!=null){const{field:S,getValue:T}=o;u.type==="rotate-stop"?(o.isUpdatingInteractively=!1,o.setInitialValue(e.getAttribute(S))):(o.isUpdatingInteractively=!0,e.setAttribute(S,T(u.angle,t)))}const p=r.size,g=CFe(i.toolEventInfo);if(p!=null&&g!=null){const{field:S,getValue:T}=p;g.type==="scale-stop"?(p.isUpdatingInteractively=!1,p.setInitialValue(e.getAttribute(S))):(p.isUpdatingInteractively=!0,e.setAttribute(S,T(g.xScale,t)))}await qp(e,n,t.type==="2d"?t.scale:null)}async function AFe({feature:t,featureClone:e,visualVariableAttributes:i,sketchViewModel:r,view:n,onUpdate:o,webStyleCache:u}){var F;await qp(e,u,n.type==="2d"?n.scale:null);let p=null;if(((F=r==null?void 0:r.view)==null?void 0:F.type)==="2d"){const V=Da(U=>qp(e,u,U));p=ce(()=>{var U;return(U=r==null?void 0:r.view)==null?void 0:U.scale},U=>V(U))}const g=e.sourceLayer,w=Cb(n,g);await HO({graphic:e,sketchViewModel:r,sourceLayer:g,visualVariables:i,webStyleCache:u});let S=null;w.then(V=>S=V).catch(()=>{});const T=i.size,E=i.rotation,C=ce(()=>t.attributes,async V=>{let U=!1;for(const W in V){const H=V[W];H!==e.getAttribute(W)&&(e.setAttribute(W,H),T==null||T.isUpdatingInteractively||T.field!==W||T.setInitialValue(H),E==null||E.isUpdatingInteractively||E.field!==W||E.setInitialValue(H),(S==null||S.requiredFields.includes(W))&&(U=!0))}U&&await qp(e,u,n.type==="2d"?n.scale:null)}),L=r.on("update",async V=>{const U=V.graphics[0];if(V.state==="complete")return HO({graphic:U,sketchViewModel:r,sourceLayer:g,visualVariables:i,webStyleCache:u});await Xoe(n,U,V,i,u),o(WO(U),V)}),R=r.on(["undo","redo"],async V=>{o(WO(V.graphics[0]),V)});return In([R,L,We(()=>r.cancel()),C,p])}async function LFe(t,e,i){const r=t.view;t.layer.add(i);const n=e.sourceLayer,o=e.layer,u=e.getAttribute(o.objectIdField);let p=null;function g(w){p==null||p.abort(),p=Sh(async S=>{var E;const T=await Cb(r,n);At(S),(E=T.setVisibility)==null||E.call(T,u,w)})}return await PFe(r,i),g(!1),In([OFe(r,i,w=>g(!w)),We(async()=>{g(!0);try{const w=await Cb(r,n);await vr(()=>!w.updating)}finally{t.layer.remove(i)}})])}function OFe(t,e,i){if(t.type==="3d"){const r=new kf({graphic:e});return In([t.trackGraphicState(r),ce(()=>r.displaying,i)])}return ce(()=>e.visible,i)}async function PFe(t,e){if(t.type==="3d"){const i=new kf({graphic:e}),r=t.trackGraphicState(i);await vr(()=>i.displaying),r.remove()}else await vr(()=>e.visible)}const Sd={icon:Jn(24),text:Jn(12),line:Jn(1),viewScaleSizeFactor:100};function Qoe(t,e,i){let r=!1;return t.filter(n=>!!r||(r=n===e,r)).map(n=>i[n]())}function RFe(t,e){t.viewModel.syncFeatureTemplates();const i=t.creationInfo;if(e[0].id==="awaiting-feature-creation-info"&&i){const r=i.layer,n=eI(r);n.length===1&&r.type!=="scene"&&(i.template=n[0],e.shift())}return e}function FFe(t){switch(t){case"unknown":case"decimal-degrees":return null;default:return t}}function NFe(t){t.filesEnabled=!0,t.mode="view",t.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}}const eae=t=>/-stop/.test(t)||/vertex-/.test(t),Cb=(t,e)=>{const i=e.type==="subtype-sublayer"?e.parent:e;return t.whenLayerView(i)};function DFe(t){return"createInteractiveEditSession"in t}function WO(t){var i;const e=t.geometry;if((e==null?void 0:e.type)==="mesh"){const r=t.cloneShallow();return r.attributes=ae(t.attributes),r.geometry=e.cloneShallow(),r.geometry.transform=((i=e.transform)==null?void 0:i.clone())??null,r}return t.clone()}function JO(t){const e=t.cursor;return t.cursor="progress",We(()=>t.cursor=e)}async function jFe({view:t,data:e,signal:i,next:r,cancel:n}){const{creationInfo:o}=e;if(!o||!K2(o))return We();const{layer:u}=o,p=o.geometryToPlace!=null;if(o.geometryToPlace=null,p)return n(),We();const{Upload:g}=await ie(()=>import("./Upload-CgP3A_h1.js"),__vite__mapDeps([305,306]));At(i);const w=new g;e.upload=w;let S=null;const T=()=>S==null?void 0:S.remove(),E=In([ce(()=>w.state,C=>{switch(C){case"default":case"error":T();break;case"pending":T(),S=JO(t);break;case"success":o.maxFeatures=1,o.geometryToPlace=w.result,T(),r()}}),We(()=>{w.cancel(),T()})]);return w.uploadTo(u),E}function K2(t){const e=t==null?void 0:t.layer;return(e==null?void 0:e.type)==="scene"}let Vn=class extends Ar.EventedAccessor{constructor(e){super(e),this._indexHistory=[],this._lastStepIndex=-1,this._stepIndex=-1,this._updatingHandles=new Ua,this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},this.data=void 0,this.started=!1,this.steps=[],this.type=null,this._pendingOperation=null}destroy(){this._updatingHandles.destroy()}get hasNextStep(){const{steps:e}=this;return!!(e&&this._stepIndex<e.filter(i=>!i.parent).length-1)}get hasPreviousStep(){return this._stepIndex>0}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){const{steps:e}=this,i=e&&e[this._stepIndex];return i&&i.id}get helpMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}get updating(){return this._updatingHandles.updating}async back(e=()=>Promise.resolve(!0)){this.hasPendingEdits&&!await e()||(this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0}))}async cancel(e={force:!0}){return e.force!==!1?this._cancel(e):new Promise((i,r)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...e,force:!0}).then(i)},deny:()=>r(new re("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.removeHandles(this._handleKeys.beforeCommit),this.onCommit&&await this.onCommit(this.data),this.removeHandles(this._handleKeys.afterCommit),this.emit("commit")}async go(e){const{steps:i}=this,r=i.findIndex(n=>n.id===e);this._indexHistory.push(this._stepIndex),await this._go(r)}async next(){this._indexHistory.push(this._stepIndex),await this._go(this._stepIndex+1)}async previous(e={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),e.cancelCurrentStep)}async reset(){await this._cancel({emitCancelEvent:!1}),await this.start()}async save(){await this.commit(),await this.reset()}async start(){this._set("started",!0);const e=this._stepIndex===-1?0:this._stepIndex;await this._go(e)}async _cancel({emitCancelEvent:e=!0,error:i}={}){this.started&&(this._set("started",!1),await this._transaction(()=>{var r;return(r=this.steps[this._stepIndex])==null?void 0:r.tearDown({canceled:!0})})),this.removeHandles([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(e),e&&this.emit("cancel",{error:i})}_go(e=-1,i=!1){return this._transaction(async()=>{const{steps:r}=this;if(!(e<=-1||e>=r.length)){if(!this.started)return this._stepIndex=e,void this._notifyStepProps();this._lastStepIndex>-1&&await r[this._lastStepIndex].tearDown({canceled:i});try{await r[e].setUp()}catch(n){D5(n)}this._lastStepIndex=e,this._stepIndex=e,this._notifyStepProps()}})}async _transaction(e){const i=this._pendingOperation,r=os(),n=(i??Promise.resolve()).then(()=>r.promise);this._pendingOperation=n,this._updatingHandles.addPromise(n);try{i&&await i,await e()}finally{r.resolve(),n===this._pendingOperation&&(this._pendingOperation=null)}}_resetIndexing(e=!0){this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,e&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}};m([b()],Vn.prototype,"data",void 0),m([b()],Vn.prototype,"hasNextStep",null),m([b()],Vn.prototype,"hasPreviousStep",null),m([b()],Vn.prototype,"onCommit",void 0),m([b()],Vn.prototype,"reliesOnOwnerAdminPrivileges",null),m([b()],Vn.prototype,"hasInvalidFormTemplate",null),m([b()],Vn.prototype,"shouldShowAttachments",null),m([b()],Vn.prototype,"shouldAllowAttachmentEditing",null),m([b()],Vn.prototype,"started",void 0),m([b({readOnly:!0})],Vn.prototype,"stepId",null),m([b()],Vn.prototype,"steps",void 0),m([b({readOnly:!0})],Vn.prototype,"type",void 0),m([b()],Vn.prototype,"helpMessage",null),m([b()],Vn.prototype,"hasPendingEdits",null),m([b()],Vn.prototype,"keyboardCancellationEnabled",null),m([b()],Vn.prototype,"updating",null),Vn=m([G("esri.widgets.Editor.Workflow")],Vn);const RF=Vn;function gB(t){switch(t){case Ji.SUPPORTED:break;case Ji.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case Ji.GEOMETRY_MISSING:return"no geometry";case Ji.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case Ji.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case Ji.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var Ji;(function(t){t[t.SUPPORTED=0]="SUPPORTED",t[t.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",t[t.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",t[t.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",t[t.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",t[t.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(Ji||(Ji={}));function VFe(t){var r,n;if(t.graphic&&((r=t.graphic.layer)==null?void 0:r.type)!=="graphics")return Ji.GRAPHICS_LAYER_MISSING;const e=(n=t.operations)==null?void 0:n.data.type;if(!e)return Ji.GEOMETRY_TYPE_UNSUPPORTED;switch(e){case"polygon":case"point":case"polyline":case"mesh":break;default:return Ji.GEOMETRY_TYPE_UNSUPPORTED}const i=t.elevationInfo;return OS(i)?Ji.ELEVATION_MODE_UNSUPPORTED:Ji.SUPPORTED}function zFe(t){return UFe(t).result}function UFe(t){var r;if(t.graphic&&((r=t.graphic.layer)==null?void 0:r.type)!=="graphics")return{result:Ji.GRAPHICS_LAYER_MISSING};if(!t.operations)return{result:Ji.GEOMETRY_MISSING};if(OS(t.elevationInfo))return{result:Ji.ELEVATION_MODE_UNSUPPORTED};const e=t.operations.data.type,i=t.operations.data.geometry;return e==="point"||e==="mesh"||e==="polyline"||e==="polygon"?{result:Ji.SUPPORTED,geometry:i}:{result:Ji.GEOMETRY_TYPE_UNSUPPORTED}}function GFe(t){var i;if(((i=t.layer)==null?void 0:i.type)!=="graphics")return Ji.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return Ji.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return Ji.SUPPORTED;default:return Ji.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return!e||!e.some(r=>r.type==="object")?Ji.SYMBOL_TYPE_UNSUPPORTED:H7e(t)!=="on-the-ground"&&Hse(t)?Ji.ELEVATION_MODE_UNSUPPORTED:Ji.SUPPORTED}function vB(t,e,i){if(!e||!(t!=null&&t.map))return;const{map:r}=t,n=r.layers.find(o=>o===e);n||r.add(e,i),n&&i!=null&&r.layers.reorder(n,i)}function BFe(t,e){const i=(e==null?void 0:e.type)==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(r=>{const n=r.layer;return n===i||"sublayers"in n&&n.sublayers!=null&&n.sublayers.includes(i)})}let gs=class extends Ar.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:this.activeComponent}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};m([b()],gs.prototype,"activeComponent",void 0),m([b()],gs.prototype,"cancelled",void 0),m([b()],gs.prototype,"history",void 0),m([b()],gs.prototype,"tool",null),m([b()],gs.prototype,"type",void 0),m([b()],gs.prototype,"canUndo",null),m([b()],gs.prototype,"canRedo",null),m([b()],gs.prototype,"onEnd",void 0),m([b()],gs.prototype,"undo",null),m([b()],gs.prototype,"redo",null),m([b()],gs.prototype,"toggleTool",void 0),m([b()],gs.prototype,"addToSelection",void 0),m([b()],gs.prototype,"removeFromSelection",void 0),gs=m([G("esri.widgets.Sketch.support.OperationHandle")],gs);let y5=class extends gs{};m([b()],y5.prototype,"activeComponent",void 0),y5=m([G("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],y5);let Lp=class extends gs{};m([b()],Lp.prototype,"activeComponent",void 0),Lp=m([G("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],Lp);const bB={defaultZ:0},Rw={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let $i=class extends Ar.EventedAccessor{constructor(e){var i;super(e),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new LS({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new kn({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new na({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new cn({color:[130,130,130,1],width:2}),this.meshSymbol=new Xb({symbolLayers:new Ie([new f0])}),this.updateGraphics=new Ie,this.updateOnGraphicClick=!0,this.vertexSymbol=new kn({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new w0,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=bB,this.defaultUpdateOptions=Rw,this.snappingOptions=((i=e==null?void 0:e.snappingManager)==null?void 0:i.options)??(e==null?void 0:e.snappingOptions)??new rg}initialize(){this.addHandles([gi(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),gi(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const i of e.removed)this.updateGraphics.includes(i)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(i):this._operationHandle.cancel())}),ce(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},ri),ce(()=>this.view,e=>{this._defaultSnappingManager=ot(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new xl({view:e,options:this.snappingOptions})),e.type==="2d"?ie(()=>import("./editingTools-BlLARBY8.js"),__vite__mapDeps([307,308,309,301,310,129,130,51,49,88,311,312,313,314,315,316])):e.type==="3d"&&(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])),ie(()=>import("./GraphicsLayerView3D-BlPN3ywE.js"),__vite__mapDeps([329,319,95,54,320,45,72,77,40,110,43,311,156,168,155,314,321,88,42,104,130,144,37,38,39,44,46,146,74,108,67,107,109,330,52,55,331,332,323,13,14,29,30,322,12,15,47,79,80,81,82,69,83,75,333,158,334,51,49,53,27,177,335,174]))))},ri),ce(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,i)=>{e&&i&&!e.equals(i)&&this.cancel()})]),L8e(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=ot(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...bB,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...Rw,...e,reshapeOptions:{...Rw.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...Rw.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=ot(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:i}=this;!this._defaultSnappingManager&&i&&(this._defaultSnappingManager=new xl({options:this.snappingOptions,view:i})),this._clearOverride("snappingManager")}}get state(){var r;const e=!(!((r=this.view)!=null&&r.ready)||!this.layer),i=this._operationHandle;return e&&i?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const i=this._get("view");if(i){const{container:n,map:o}=i;n&&(i.cursor=null),o==null||o.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const r="view-ready";this.removeHandles(r),e&&this.addHandles(Fr(()=>e.ready,n=>{this.removeHandles(this._viewHandlesKey),n&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},ri),r),this._set("view",e)}cancel(){this._moduleLoaderAbortController=En(this._moduleLoaderAbortController),this._viewReadyAbortController=En(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:i}=this;if(e==="active"&&i.length){const{activeTool:r,layer:n}=this,o=i.toArray();n.removeMany(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:r})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(i=>i.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,i){this.cancel(),await this._waitViewReady();const{view:r,layer:n}=this;if(!r||this.state==="disabled")throw n||this._logMissingLayer(),ni();if(r.activeTool!=null&&(r.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");vB(r,this._internalGraphicsLayer);const o=await this._setupCreateOperation(e,i);if(o==null||this.destroyed)return void r.map.remove(this._internalGraphicsLayer);const u=()=>{var p;if(o===this._operationHandle){const g=this.createGraphic,w=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(p=this.view)!=null&&p.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||g==null||n.add(g),this.emit("create",{graphic:g,state:w?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};o.on("complete",u),this._operationHandle=o,r.ready&&r.focus()}async place(e,i){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...i})}async update(e,i){this.cancel(),await this._waitViewReady();const{layer:r,view:n,state:o}=this;if(!n||o==="disabled")throw r||this._logMissingLayer(),ni();n.activeTool!=null&&(n.activeTool=null);const u=Array.isArray(e)?e:[e];if(e==null||!(u!=null&&u.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(u.some(g=>g.layer!==r?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):g.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const p=await this._setupUpdateOperation(u,i);this.destroyed||p==null||fn(p)||(vB(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(p,i),this.emit("update",{graphics:u,state:"start",aborted:!1,tool:p.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const i=this.view;if(i){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const r of e)r.geometry==null||r.geometry.type==="mesh"||Ki(r.geometry.spatialReference,i.spatialReference)||(Ba(r.geometry.spatialReference,i.spatialReference)||Eh()||await gh(),r.geometry=Ts(r.geometry,i.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const i=this.view;if(!i)return this._logMissingView(),null;if(i.type==="2d"){const o=[];i.map.allLayers.forEach(p=>{p.type!=="vector-tile"&&p.type!=="imagery"||o.push(p)});const u=await i.hitTest(e,{exclude:o});return mFe(u.results)}const r=[i.map.ground];i.map.allLayers.forEach(o=>{Ufe(o.type)&&r.push(o)});const n=await i.hitTest(e,{exclude:r});if(n.results.length>0){const o=n.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!n.ground.mapPoint||i.map.ground.opacity<1||n.ground.distance-(o.distance??0)>-Math.min(3*n.ground.distance,i.viewingMode==="global"?PI(i.renderCoordsHelper.spatialReference).radius/i.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null}_generateViewHandles(e){return[e.on("immediate-click",async i=>{var u;const r=this.state==="active"&&((u=this._operationHandle)==null?void 0:u.type)==="create";if(this.state==="disabled"||r||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const n=await i.async(()=>this._getFirstHit(Sl(i)));let o=null;if(n!=null){const p=n.graphic;this.updateGraphics.includes(p)||p.layer===this.layer?(i.stopPropagation(),o=p):e.type!=="2d"||this._isComponentGraphic(p)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();o==null||this.updateGraphics.includes(o)||await this.update([o],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},ii.WIDGET)]}async _setupCreateOperation(e,i){const r=this.view;if(!r)return this._logMissingView(),null;const n={hasZ:r.type==="3d",...this.defaultCreateOptions,...i},o=await this._setupDrawGraphicTool(e,r,n);return o==null?null:(r.tools.add(o),r.activeTool=o,this._setupCreateOperationHandle(o))}async _setupDrawGraphicTool(e,i,r){if(e==="multipoint"&&i.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!i)return this._logMissingView(),null;const{cursor:n,defaultZ:o,hasZ:u,geometryToPlace:p,graphicProperties:g,mode:w,preserveAspectRatio:S}=r,T=e==="rectangle"||e==="circle"?"hybrid":"click",E=S??e!=="rectangle",C={centered:e!=="rectangle"&&!(e==="circle"&&!E),cursor:n,defaultZ:o,forceUniformSize:E,graphicProperties:g,geometryToPlace:p,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:u,mode:w??T,snappingManager:this.snappingManager,snapToScene:!1,view:i};return i.type==="2d"?this._makeDrawGraphicTool2D(C):this._makeDrawGraphicTool3D(C)}async _makeDrawGraphicTool2D(e){const i=await this._requireModule(ie(()=>import("./editingTools-BlLARBY8.js"),__vite__mapDeps([307,308,309,301,310,129,130,51,49,88,311,312,313,314,315,316])));return fn(i)||this.destroyed?null:new i.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:HFe(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const i=await this._requireModule(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])));if(fn(i)||this.destroyed)return null;const{elevationInfo:r}=this.layer;return new i.module.DrawGraphicTool3D({...e,elevationInfo:r,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const i=this.view;if(!i)return this._logMissingView(),null;let r=null;const n=e.forceUniformSize,o=e.centered,u=[i.on("key-down",g=>{if(g.key===zr.pan)g.stopPropagation(),g.repeat||(e.enabled=!1);else if(g.key===zr.complete)g.stopPropagation(),e.completeCreateOperation();else if(g.key!==zr.vertexAdd||g.repeat)g.key===zr.undo?(g.stopPropagation(),p.undo()):g.key===zr.redo?(g.stopPropagation(),p.redo()):g.key!==zr.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||g.repeat?g.key===zr.center&&(g.repeat||(e.centered=!o,g.stopPropagation())):(e.forceUniformSize=!n,g.stopPropagation());else{const w=e.drawOperation.geometryType;w!=="polyline"&&w!=="polygon"&&w!=="multipoint"||(g.stopPropagation(),e.drawOperation.commitStagedVertex())}},ii.WIDGET),i.on("key-up",g=>{g.key===zr.pan?e.enabled=!0:g.key!==zr.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?g.key===zr.center&&(e.centered=o,g.stopPropagation()):(e.forceUniformSize=n,g.stopPropagation())},ii.WIDGET),e.on("vertex-add",g=>{switch(r=r==null?"start":"active",g.operation){case"apply":this.emit("create",{graphic:e.graphic,state:r,tool:this.activeTool,toolEventInfo:g,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",g=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:g.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",g=>{switch(g.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:g,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",g=>{this._set("createGraphic",g.graphic),r="complete",g.aborted?p&&p.cancel():p&&p.complete()}),ce(()=>this._getGraphicSymbolFromTool(e.geometryType),g=>{e.graphicSymbol=g})],p=new y5({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var g;u.forEach(w=>w.remove()),u.length=0,(g=i.tools)==null||g.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return p}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,i){var p;const{layer:r,view:n}=this;if(!n)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...i,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...i==null?void 0:i.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...i==null?void 0:i.highlightOptions}};let u=o.tool??Rw.tool;for(const g of e)r.remove(g),r.add(g);if(n.type==="3d"){if(e.length===0)return null;switch(u){case"move":return this._setupMove3DOperation(e,o,n,u);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,n);case"transform":return this._setupGraphicTransform3DOperation(e,o,n)}}switch(u){case"move":return this._setupMove2DOperation(e,o,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,u,o,n);case"transform":if(e.length===1){const g=(p=e[0].geometry)==null?void 0:p.type;g!=="point"&&g!=="multipoint"||(u="reshape")}return this._setupTransformOrReshape2DOperation(e,u,o,n)}}async _setupMove3DOperation(e,i,r,n,o=!1){const u=await this._requireModule(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])));if(fn(u))return u;const{ManipulatedObject3DGraphic:p,MoveTool3D:g}=u.module,w=new Map,S=()=>{w.forEach(L=>L.destroy()),w.clear()};for(const L of e){const R=new p({view:r,graphic:L}),F=VFe(R);if(F!==Ji.SUPPORTED)return S(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${gB(F)}).`),null;w.set(L,R)}const T=new g({view:r,enableZ:i.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(T),T.objects.addMany(Array.from(w.values())),o||this.updateGraphics.addMany(e);const E=[],C=new Lp({activeComponent:T,tool:n,type:"update",onEnd:()=>{var L;E.forEach(R=>R.remove()),E.length=0,(L=r.tools)==null||L.remove(T),T.destroyed||T.destroy(),S()},undo:()=>{_B(this.view,T),b$(C,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{w$(C,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:L=>{this.updateGraphics.push(L);const R=new p({view:r,graphic:L});w.set(L,R),T.objects.push(R),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[L],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:L=>{const R=this.updateGraphics.indexOf(L);if(C.history.undo.forEach(V=>V.updates.splice(R,1)),C.history.redo.forEach(V=>V.updates.splice(R,1)),this.updateGraphics.remove(L),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[L],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void C.complete();const F=w.get(L);F&&(T.objects.remove(F),F.destroy(),w.delete(L))},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1||n!=="transform")return;const L=this.updateGraphics.at(0),R=await this._setupReshape3DOperation(L,i,r,!0);R&&!fn(R)&&(C.onEnd(),C.destroy(),this._setUpdateOperationHandle(R,i))}});return E.push(...this._getHandlesForComponent(C,i),r.on("immediate-click",L=>this._getCommonUpdateOperationClickHandlers(C,L,i),ii.WIDGET),r.on("key-down",L=>{this._getCommonUpdateOperationKeyDownHandlers(C,L)},ii.WIDGET)),C}_setupGraphicTransform3DOperation(e,i,r,n=!1){if(e.length===1&&GFe(e[0])===Ji.SUPPORTED){const o=e[0],u=o.geometry;if(u!=null&&(u.type==="point"||u.type==="mesh"))return this._setupPointTransform3DOperation(o,i,r);if(u!=null&&(u.type==="polygon"||u.type==="polyline"))return this._setupPolyTransform3DOperation(o,i,r,n)}return this._setupMove3DOperation(e,i,r,"transform",n)}async _setupPointTransform3DOperation(e,i,r){const n="transform",{enableRotation:o,enableScaling:u,enableZ:p}=i,g=await this._requireModule(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])));if(fn(g))return g;const{TransformTool3D:w,ManipulatedObject3DGraphic:S}=g.module,T=new S({graphic:e,view:r}),E=new w({object:T,view:r,enableRotation:o,enableScaling:u,enableZ:p,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(E),this.updateGraphics.add(e);const C=[],L=new Lp({activeComponent:E,tool:n,type:"update",onEnd:()=>{var R;C.forEach(F=>F.remove()),C.length=0,(R=r.tools)==null||R.remove(E),E.destroyed||E.destroy(),T.destroy()},undo:()=>{_B(this.view,E),b$(L,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{w$(L,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async R=>{this.updateGraphics.add(R),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[R],removed:[],type:"selection-change"},type:"update"}),L.onEnd(),L.destroy();const F=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(F)||this._setUpdateOperationHandle(F,i)},removeFromSelection:R=>{this.updateGraphics.remove(R),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[R],type:"selection-change"},type:"update"}),L.complete()},toggleTool:()=>{}});return C.push(...this._getHandlesForComponent(L,i),r.on("immediate-click",R=>this._getCommonUpdateOperationClickHandlers(L,R,i),ii.WIDGET),r.on("key-down",R=>{this._getCommonUpdateOperationKeyDownHandlers(L,R)},ii.WIDGET)),L}async _setupPolyTransform3DOperation(e,i,r,n=!1){var U,W;const o="transform",{enableRotation:u,enableScaling:p,enableZ:g,preserveAspectRatio:w}=i,S=await this._requireModule(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])));if(fn(S))return S;const{ManipulatedObject3DGraphic:T,ExtentTransformTool:E}=S.module,C=(W=(U=this.view)==null?void 0:U.inputManager)==null?void 0:W.isModifierKeyDown(zr.constraint),L=new T({view:r,graphic:e}),R=new E({object:L,view:r,enableRotation:u,enableScaling:p,enableZ:g,preserveAspectRatio:!!w!=!!C,sketchOptions:this.sketchOptions});r.tools.add(R),n||this.updateGraphics.add(e);const F=[],V=new Lp({activeComponent:R,tool:o,type:"update",onEnd:()=>{var H;F.forEach(J=>J.remove()),F.length=0,(H=r.tools)==null||H.remove(R),R.destroyed||R.destroy(),L.destroy()},canUndo:()=>R.canUndo,undo:()=>{R.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},canRedo:()=>R.canRedo,redo:()=>{R.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async H=>{this.updateGraphics.add(H),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[H],removed:[],type:"selection-change"},type:"update"}),V.onEnd(),V.destroy();const J=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(J)||this._setUpdateOperationHandle(J,i)},removeFromSelection:H=>{this.updateGraphics.remove(H),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[H],type:"selection-change"},type:"update"}),V.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1)return;const H=await this._setupReshape3DOperation(e,i,r,!0);H&&!fn(H)&&(V.onEnd(),V.destroy(),this._setUpdateOperationHandle(H,i))}});return F.push(...this._getHandlesForComponent(V,i),r.on("immediate-click",H=>this._getCommonUpdateOperationClickHandlers(V,H,i),ii.WIDGET),r.on("key-down",H=>this._getCommonUpdateOperationKeyDownHandlers(V,H),ii.WIDGET),r.on("key-down",H=>{H.key!==zr.constraint||H.repeat||(R.preserveAspectRatio=!R.preserveAspectRatio,H.stopPropagation())},ii.WIDGET),r.on("key-up",H=>{H.key===zr.constraint&&(R.preserveAspectRatio=!R.preserveAspectRatio,H.stopPropagation())},ii.WIDGET)),V}async _setupMove2DOperation(e,i,r){const n="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const o=await this._getGraphicMover(e,i,r);if(fn(o))return o;const u=new Lp({activeComponent:o,tool:n,type:"update",onEnd:()=>{var S;this._displayDefaultCursor(),w.forEach(T=>T.remove()),g.forEach(T=>T.remove()),w=[],g=[],o.destroy(),(S=this._internalGraphicsLayer)==null||S.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const S=this.updateGraphics.toArray();b$(u,S),u.refreshComponent(),this._emitUndoEvent({graphics:S,tool:n})},redo:()=>{const S=this.updateGraphics.toArray();w$(u,S),u.refreshComponent(),this._emitRedoEvent({graphics:S,tool:n})},addToSelection:async S=>{await this._updateSpatialReference(S),this.updateGraphics.push(S),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[S],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:S=>{const T=this.updateGraphics.indexOf(S);u.history.undo.forEach(C=>C.updates.splice(T,1)),u.history.redo.forEach(C=>C.updates.splice(T,1)),this.updateGraphics.remove(S);const E=this.updateGraphics.toArray();this.emit("update",{graphics:E,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[S],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=E:u.complete()}});let p=!1,g=[r.on("immediate-click",S=>this._getCommonUpdateOperationClickHandlers(u,S,i),ii.WIDGET),r.on("key-down",S=>{this._getCommonUpdateOperationKeyDownHandlers(u,S),S.key!==zr.constraint||S.repeat||(p=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},ii.WIDGET),r.on("key-up",S=>{S.key===zr.constraint&&p&&(p=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},ii.WIDGET)],w=this._getHandlesForComponent(u,i);return u}async _setupReshape3DOperation(e,i,r,n=!1){const o="reshape",u=await this._requireModule(ie(()=>import("./editingTools-Dr1cynXz.js"),__vite__mapDeps([317,310,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108,322,323,309,301,129,51,49,312,313,324,325,326,123,327,328,315])));if(fn(u))return u;const{ManipulatedObject3DGraphic:p,ReshapeTool3D:g}=u.module,w=new p({view:r,graphic:e}),S=zFe(w);if(S!==Ji.SUPPORTED)return w.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${gB(S)}).`),null;const T=i.reshapeOptions,E=new g({view:r,object:w,enableZVertex:i.enableZ&&(T==null?void 0:T.vertexOperation)==="move",enableZShape:i.enableZ&&(T==null?void 0:T.shapeOperation)==="move",enableMoveObject:(T==null?void 0:T.shapeOperation)==="move"||(T==null?void 0:T.shapeOperation)==="move-xy",enableMidpoints:(T==null?void 0:T.edgeOperation)==="split",enableEdgeOffset:(T==null?void 0:T.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});r.tools.add(E),n||this.updateGraphics.add(w.graphic);const C=[],L=new Lp({activeComponent:E,tool:o,type:"update",onEnd:()=>{var R;C.forEach(F=>F.remove()),C.length=0,(R=r.tools)==null||R.remove(E),E.destroyed||E.destroy(),w.destroy()},canUndo:()=>E.canUndo,undo:()=>{E.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},canRedo:()=>E.canRedo,redo:()=>{E.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async R=>{this.updateGraphics.add(R),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[R],removed:[],type:"selection-change"},type:"update"}),L.onEnd(),L.destroy();const F=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(F)||this._setUpdateOperationHandle(F,i)},removeFromSelection:R=>{this.updateGraphics.remove(R),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[R],type:"selection-change"},type:"update"}),L.complete()},toggleTool:async()=>{if(i.toggleToolOnClick===!1)return;L.onEnd(),L.destroy();const R=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),i,r,!0);fn(R)||this._setUpdateOperationHandle(R,i)}});return C.push(...this._getHandlesForComponent(L,i),r.on("immediate-click",R=>this._getCommonUpdateOperationClickHandlers(L,R,i),ii.WIDGET),r.on("key-down",R=>{this._getCommonUpdateOperationKeyDownHandlers(L,R)},ii.WIDGET)),L}async _setupTransformOrReshape2DOperation(e,i,r,n){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const o=i==="transform"?await this._getBox(e,r,n):await this._getReshape(e,r,n);if(fn(o))return o;const u=new Lp({activeComponent:o,type:"update",onEnd:()=>{g.forEach(w=>w.remove()),p.forEach(w=>w.remove()),g=[],p=[],u.activeComponent&&!u.activeComponent.destroyed&&u.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{b$(u,this.updateGraphics.toArray()),u.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:u.tool})},redo:()=>{w$(u,this.updateGraphics.toArray()),u.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:u.tool})},addToSelection:async w=>{let S=u.activeComponent;if((S==null?void 0:S.type)==="reshape"){const T=[...this.updateGraphics,w];this.updateGraphics.removeAll(),u.onEnd(),u.destroy();const E=await this._setupTransformOrReshape2DOperation(T,"transform",r,n);if(fn(E))return;this._setUpdateOperationHandle(E,r)}else this.updateGraphics.add(w),S.graphics=this.updateGraphics.toArray(),S.refresh(),u.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[w],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async w=>{const S=this.updateGraphics.indexOf(w);u.history.undo.forEach(E=>E.updates.splice(S,1)),u.history.redo.forEach(E=>E.updates.splice(S,1)),this.updateGraphics.remove(w);const T=this.updateGraphics.toArray();if(T.length===0)u.complete();else{const E=T[0].geometry;T.length!==1||E==null||E.type!=="point"&&E.type!=="multipoint"?u.activeComponent.graphics=T:u.toggleTool()}this.emit("update",{graphics:T,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[w],type:"selection-change"},type:"update"})},toggleTool:async()=>{var E;if(this.updateGraphics.length>1)return;const w=this.updateGraphics.at(0),S=w.geometry;if(S!=null&&(u.tool==="reshape"&&(S.type==="point"||S.type==="multipoint")||u.tool==="transform"&&S.type==="extent"))return;let T=null;u.tool==="transform"?T=await this._getReshape([w],r,n):u.tool==="reshape"&&(T=await this._getBox([w],r,n)),fn(T)||((E=u.activeComponent)==null||E.destroy(),u.activeComponent=T,u.activeComponent&&(g.forEach(C=>C.remove()),g=this._getHandlesForComponent(u,r)))}});let p=[n.on("immediate-click",w=>this._getCommonUpdateOperationClickHandlers(u,w,r),ii.WIDGET),n.on("key-down",w=>{if(this._getCommonUpdateOperationKeyDownHandlers(u,w),w.key===zr.constraint&&!w.repeat&&u){const S=u.activeComponent;S&&S.type==="box"&&(S.preserveAspectRatio=!S.preserveAspectRatio)}},ii.WIDGET),n.on("key-up",w=>{if(w.key===zr.constraint&&u){const S=u.activeComponent;S&&S.type==="box"&&(S.preserveAspectRatio=!S.preserveAspectRatio)}},ii.WIDGET)],g=this._getHandlesForComponent(u,r);return u}async _getGraphicMover(e,i,r){const{enableMoveAllGraphics:n,highlightOptions:o}=i,u=await this._requireModule(ie(()=>import("./GraphicMover-NTua9M1W.js"),__vite__mapDeps([336,316,315])));return fn(u)?u:new u.module.default({enableMoveAllGraphics:n,highlightsEnabled:!!(o!=null&&o.enabled),indicatorsEnabled:!1,graphics:e,view:r,callbacks:{onGraphicMoveStart:({dx:p,dy:g,graphic:w})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:g,mover:w,type:"move-start"},type:"update"})},onGraphicMove:({dx:p,dy:g,graphic:w})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:g,mover:w,type:"move"},type:"update"}),onGraphicMoveStop:({dx:p,dy:g,graphic:w})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:g,mover:w,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,i,r){var S,T;const{enableRotation:n,enableScaling:o,highlightOptions:u,preserveAspectRatio:p}=i,g=await this._requireModule(ie(()=>import("./Box-CkfANLzB.js"),__vite__mapDeps([337,316,336,315,338,310,328,325])));if(fn(g))return g;const w=(T=(S=this.view)==null?void 0:S.inputManager)==null?void 0:T.isModifierKeyDown(zr.constraint);return new g.module.default({graphics:e,enableRotation:n,enableScaling:o,highlightsEnabled:!!(u!=null&&u.enabled),preserveAspectRatio:!!p!=!!w,layer:this._internalGraphicsLayer,view:r,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onMove:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onMoveStop:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onScaleStart:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onScale:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onScaleStop:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onRotateStart:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onRotate:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"}),onRotateStop:E=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...E},type:"update"})}})}async _getReshape(e,i,r){var g,w,S;const n=((g=i.reshapeOptions)==null?void 0:g.edgeOperation)==="split",o=((w=i.reshapeOptions)==null?void 0:w.shapeOperation)==="move",u=!!((S=i.highlightOptions)!=null&&S.enabled),p=await this._requireModule(ie(()=>import("./Reshape-BhmEx87d.js"),__vite__mapDeps([339,308,309,301,310,129,130,51,49,88,311,316,336,315,324,325,338])));return fn(p)?p:new p.module.default({enableMidpoints:n,enableMovement:o,graphic:e[0],highlightsEnabled:u,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:r,callbacks:{onReshapeStart:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onReshape:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onReshapeStop:({mover:T,type:E})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:T,type:E},type:"update"}),onMoveStart:({dx:T,dy:E,mover:C,type:L})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:T,dy:E,mover:C,type:L},type:"update"}),onMove:({dx:T,dy:E,mover:C,type:L})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:T,dy:E,mover:C,type:L},type:"update"}),onMoveStop:({dx:T,dy:E,mover:C,type:L})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:T,dy:E,mover:C,type:L},type:"update"}),onVertexAdd:({added:T,type:E,vertices:C})=>{const L=T.map(R=>OD(R.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:L,vertices:C,type:E},type:"update"})},onVertexRemove:({removed:T,type:E,vertices:C})=>{const L=T.map(R=>OD(R.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:L,vertices:C,type:E},type:"update"})}}})}_getHandlesForComponent(e,i){const r=e.activeComponent;if(!r)return[];switch(r.type){case"graphic-mover":return[r.on("graphic-click",({graphic:n,viewEvent:o})=>{var u;(u=o.native)!=null&&u.shiftKey&&(o.stopPropagation(),e.removeFromSelection(n))}),r.on("graphic-move-start",n=>e.addToHistory(xd(n.allGraphics)))];case"box":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(xd(n.graphics))),r.on("rotate-start",n=>e.addToHistory(xd(n.graphics))),r.on("scale-start",n=>e.addToHistory(xd(n.graphics)))];case"reshape":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(xd([n.mover]))),r.on("reshape-start",n=>e.addToHistory(xd([n.graphic]))),r.on("vertex-add",n=>e.addToHistory(xd([n.oldGraphic]))),r.on("vertex-remove",n=>e.addToHistory(xd([n.oldGraphic])))];case"move-3d":return[r.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),r.events.on("move-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-start"},type:"update"})}),r.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n.dx,dy:n.dy,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move"},type:"update"})}),r.events.on("move-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-stop"},type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})];case"transform-3d":return[r.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),r.events.on("translate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-start"},type:"update"})}),r.events.on("translate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-stop"},type:"update"})}),r.events.on("rotate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-start"},type:"update"})}),r.events.on("rotate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-stop"},type:"update"})}),r.events.on("scale-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-start"},type:"update"})}),r.events.on("scale-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-stop"},type:"update"})}),r.events.on("translate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move"},type:"update"})}),r.events.on("rotate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate"},type:"update"})}),r.events.on("scale",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale"},type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})];case"reshape-3d":return[r.events.on("reshape",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),r.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),r.events.on("vertex-add",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.events.on("vertex-remove",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,i):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,i,r){var u;const{graphic:n,viewEvent:o}=r;return(u=o.native)!=null&&u.shiftKey&&n.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(n)):i.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,i){var o;this._operationHandle=e;const r=(o=this.view)==null?void 0:o.map;this._disablePopup(i);const n=()=>{if(e===this._operationHandle){const u=this.updateGraphics.toArray(),p=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),r&&r.remove(this._internalGraphicsLayer),this._restorePopup(i),this.emit("update",{graphics:u,state:"complete",aborted:e.cancelled,tool:p,toolEventInfo:null,type:"update"})}};e.on("complete",n)}async _getCommonUpdateOperationClickHandlers(e,i,r){const n=Sl(i),o=await i.async(()=>this._getFirstHit(n));if(o==null)return void e.complete();if(i.native.shiftKey&&this._toggleSelection([o.graphic],e,r))return void i.stopPropagation();this.updateGraphics.includes(o.graphic)?i.stopPropagation():e.complete()}_toggleSelection(e,i,r){const n=!!r.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!n||o.layer!==this.layer)&&(this.updateGraphics.includes(o)?i.removeFromSelection(o):i.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,i){if(!e)return;const r=i.key;r===zr.undo&&e.canUndo()?(i.stopPropagation(),e.undo()):r===zr.redo&&e.canRedo()?(i.stopPropagation(),e.redo()):r===zr.cancel?(i.stopPropagation(),e.cancel()):this.allowDeleteKey&&zr.delete.includes(r)&&this._onDeleteKey(i)}_onDeleteKey(e){var n;if(!this._operationHandle||this._operationHandle.type!=="update")return;const i=this.activeComponent,r=this.updateGraphics.toArray();i!=null&&(i.type!=="reshape"||r.length===1&&((n=r[0].geometry)==null?void 0:n.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,i;this._internalGraphicsLayer&&((i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=ot(this._internalGraphicsLayer))}_isComponentGraphic(e){var r;const{activeComponent:i}=this;return!(!e||i==null)&&(((r=e.attributes)==null?void 0:r.esriSketchTool)||i.type==="draw-2d"&&i.graphic===e||(i.type==="box"||i.type==="reshape")&&i.isUIGraphic(e))}_displayPointerCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,i,r){fe.getLogger(this).error(new re(e,i,r))}async _requireModule(e){const i=new AbortController;this._moduleLoaderAbortController=i;const r=await e;return this._moduleLoaderAbortController!==i||i.signal.aborted?{requireError:"aborted"}:{module:r}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return vr(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var i;return((i=this.view)==null?void 0:i.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(En(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await zl(vr(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",wB("view"))}_logMissingLayer(){this._logError(qFe,wB("layer"))}};m([b()],$i.prototype,"_defaultSnappingManager",void 0),m([b()],$i.prototype,"updating",null),m([b()],$i.prototype,"_operationHandle",void 0),m([b({readOnly:!0})],$i.prototype,"activeTool",null),m([b()],$i.prototype,"activeFillSymbol",void 0),m([b()],$i.prototype,"activeLineSymbol",void 0),m([b()],$i.prototype,"activeVertexSymbol",void 0),m([b()],$i.prototype,"allowDeleteKey",void 0),m([b({readOnly:!0})],$i.prototype,"createGraphic",null),m([b()],$i.prototype,"defaultCreateOptions",null),m([b()],$i.prototype,"defaultUpdateOptions",null),m([b({type:nF,nonNullable:!0})],$i.prototype,"labelOptions",null),m([b()],$i.prototype,"layer",void 0),m([b({types:zu})],$i.prototype,"pointSymbol",void 0),m([b({types:zu})],$i.prototype,"polygonSymbol",void 0),m([b({types:zu})],$i.prototype,"polylineSymbol",void 0),m([b()],$i.prototype,"meshSymbol",void 0),m([b({type:rg,nonNullable:!0})],$i.prototype,"snappingOptions",null),m([b()],$i.prototype,"snappingManager",null),m([b({readOnly:!0})],$i.prototype,"state",null),m([b({type:sF,nonNullable:!0})],$i.prototype,"tooltipOptions",null),m([b({readOnly:!0})],$i.prototype,"updateGraphics",void 0),m([b()],$i.prototype,"updateOnGraphicClick",void 0),m([b({type:RM,nonNullable:!0})],$i.prototype,"valueOptions",null),m([b({types:zu})],$i.prototype,"vertexSymbol",void 0),m([b({value:null})],$i.prototype,"view",null),m([b({constructOnly:!0,type:w0})],$i.prototype,"sketchOptions",void 0),$i=m([G("esri.widgets.Sketch.SketchViewModel")],$i);const qFe="sketch:missing-property",wB=t=>`Property '${t}' is missing on SketchViewModel.`;function HFe(t){return t==="polygon"||t==="rectangle"||t==="circle"}function b$(t,e){tae("undo",t.history.undo,t.history.redo,e)}function w$(t,e){tae("redo",t.history.redo,t.history.undo,e)}function tae(t,e,i,r){const n=e.pop();if(!n)return;const o=n.updates,u=[];r.forEach((p,g)=>{const w=o[g];w!=null&&("geometry"in w&&w.geometry!=null&&(u.push({geometry:p.geometry}),p.geometry=w.geometry),"symbol"in w&&w.symbol!=null&&(u.push({symbol:p.symbol}),p.symbol=w.symbol),"undo"in w&&(u.push(w),w[t](p)))}),i.push({updates:u})}function _B(t,e){t!=null&&e.hasGrabbedManipulators&&(t.activeTool=null)}function xd(t){return{updates:t.map(({geometry:e})=>(e==null?void 0:e.type)==="mesh"?{geometry:e.cloneShallow()}:{geometry:e})}}function fn(t){return"requireError"in t&&t.requireError==="aborted"}const YM=$i;var m5;const n4=Symbol(),Og=Symbol(),_$=Symbol();let ts=m5=class extends RF{constructor(t){super(t),this.type="create-features",this.createFeatureState="create-new",this.data=void 0,this.isNested=!1,this._getDrawMeshHelpMessage=void 0,this._featureFormHandle=null,this._visualVariableAttributes={rotation:null,size:null},this._featureFormViewModel=new JR,this._sketchViewModel=null,this._attachmentFileInfos=new Map,this._highlightHandles=new Map,this._preventDefaultActionOnCancel=!1,this._lastActiveGraphics=[],this._isActive=!0,this._updateGraphicDebounced=Da((e,i,r)=>qp(e,i,r))}initialize(){this.isNested&&(this._isActive=!1),this._initializeSketchViewModel()}destroy(){this._sketchViewModel.destroy()}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){var o,u;if(this.numPendingFeatures>0)return!0;const{creationInfo:t,upload:e}=this.data,i=this._sketchViewModel,{activeComponent:r}=i,n=(u=(o=i.createGraphic)==null?void 0:o.geometry)==null?void 0:u.type;return!(n!=="polyline"&&n!=="polygon"&&n!=="multipoint"||(r==null?void 0:r.type)!=="draw-2d"&&(r==null?void 0:r.type)!=="draw-3d")&&r.drawOperation.committedVertices.length>0||!(!e||e.state!=="pending"&&e.state!=="success")||!!(t!=null&&t.geometryToPlace)}get helpMessage(){var n;const{creationInfo:t,viewModel:e}=this.data;if(this.stepId!=="creating-features"||!t)return;const i=t.layer.geometryType,r=this._sketchViewModel.createGraphic;if(i==="mesh"){this._getDrawMeshHelpMessage||ie(()=>import("./helpMessageUtils3d-ChbE8t4G.js"),[]).then(u=>{this._getDrawMeshHelpMessage=u.getDrawMeshHelpMessage});const{view:o}=e;return(o==null?void 0:o.type)==="3d"?(n=this._getDrawMeshHelpMessage)==null?void 0:n.call(this,r,o):void 0}return aFe(i,r==null?void 0:r.geometry)}get layer(){var t;return(t=this.data.creationInfo)==null?void 0:t.layer}get numPendingFeatures(){return this.pendingFeatures.length}get parent(){return this.data.parent}get parentLayer(){var t;return(t=this.parent)==null?void 0:t.data.editorItem.layer}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return this.numPendingFeatures===0}get reliesOnOwnerAdminPrivileges(){var t;return((t=this.data.editorItem)==null?void 0:t.capabilities.create.reliesOnOwnerAdminPrivileges)??!1}get shouldShowAttachments(){var t;return((t=this.data.editorItem)==null?void 0:t.capabilities.create.attachments.enabled)??!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get sketchViewModel(){return this._sketchViewModel}get test(){}async enter(){this._isActive=!0,this.stepId!=="awaiting-feature-creation-info"&&this._setUpCreatingFeaturesStep()}exit(){this._isActive=!1,this.removeHandles([_$])}async updatePendingFeature(t,e){return this._preventDefaultActionOnCancel=!0,this._sketchViewModel.cancel(),L5(this._lastActiveGraphics,t),this._startUpdating(t,e)}async start(){var t;return await super.start(),um((t=this.data.creationInfo)==null?void 0:t.layer)?null:{enter:async()=>{},exit:async()=>{},viewModel:this._sketchViewModel}}static create(t){const{addAttachmentsCallback:e,applyEditsCallback:i,isNested:r,creationInfo:n,parent:o,snappingManager:u,startAt:p,viewModel:g}=t,w=t.sketchOptions??new w0,S=n==null?void 0:n.layer,T=S?g.findEditorItemForLayer(S):void 0,E=new m5({data:new Nc({creationInfo:n,editorItem:T,parent:o,sketchOptions:w,snappingManager:u,viewModel:g}),isNested:r,onCommit:async C=>{var H;const{creationInfo:L}=C;if(!L)return;const R=C.pendingFeatures.toArray(),{layer:F}=L,V=((H=F.capabilities)==null?void 0:H.editing.supportsGlobalId)&&"globalIdField"in F,U=E._attachmentFileInfos;if(V){const J=ZFe(R,F,U);return void await i(F,J,{globalIdUsed:!0})}const W=await i(F,{addFeatures:R});if(U.size>0){const J=(W==null?void 0:W.addFeatureResults)??[];await e(F,JFe(R,J,F,U))}}});return E._set("steps",this._createWorkflowSteps(E,p)),E}_fadeExistingFeatures(t){if("effect"in t){const i=t.effect;return t.effect="saturate(0.6) opacity(0.8)",We(()=>t.effect=i)}const e=t.opacity;return t.opacity=.7,We(()=>t.opacity=e)}_highlight(t){const e=this.data.viewModel.view;(e==null?void 0:e.type)==="3d"&&this._highlightHandles.set(t,e.highlight(t))}_removeHighlight(t){Vi(this._highlightHandles.get(t)),this._highlightHandles.delete(t)}async _startCreating(t){this.removeHandles(Og);const{creationInfo:e}=this.data;if(!e)return;this.createFeatureState="create-new";const i=await xFe(this._sketchViewModel,e,t);this.addHandles(i,Og)}async _startUpdating(t,e){var L;const{pendingFeatures:i}=this;i.includes(t)||i.add(t);const{_featureFormViewModel:r,_sketchViewModel:n}=this,{creationInfo:o,viewModel:u}=this.data,{attachmentsViewModel:p,layerInfos:g,view:w}=u;if(!w||!o)return;const S=o.layer,T=$Fe(g,S),E=T==null?void 0:T.formTemplate,C=w.spatialReference;if(r.set({arcadeEditType:"INSERT",feature:t,formTemplate:E,spatialReference:C,map:w.map}),p.mode!=="add"&&p.mode!=="edit"||((L=u.activeWorkflow)==null||L.previous()),p.graphic=t,p.fileInfos.removeAll(),p.mode="view",(this._attachmentFileInfos.get(t)||[]).forEach(({file:R,form:F})=>p.addFile(R,F)),this._removeHighlight(t),await qp(t,e,w.type==="2d"?w.scale:null),this.removeHandles(Og),Vi(this._featureFormHandle),w.type==="2d"){const R=ce(()=>w.scale,F=>this._updateGraphicDebounced(t,e,F));this.addHandles(R,Og)}return this._featureFormHandle=In([r.on("value-change",async()=>{t.attributes=r.getValues(),await qp(t,e,w.type==="2d"?w.scale:null)}),n.on(["update","undo","redo"],R=>{(R.type==="undo"||R.type==="redo"||R.type==="update"&&R.toolEventInfo!=null&&eae(R.toolEventInfo.type))&&r.notifyFeatureGeometryChanged()})]),this.createFeatureState="update-pending",this._visualVariableAttributes=PF(t),um(S)?void 0:HO({graphic:t,sketchViewModel:n,sourceLayer:S,visualVariables:this._visualVariableAttributes,webStyleCache:e})}static _createWorkflowSteps(t,e="awaiting-feature-creation-info"){const{data:i}=t,r=Qoe(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){const{creationInfo:n,viewModel:o}=i,{view:u}=o;u&&(K2(n)?t.addHandles(await jFe({view:u,data:i,next:()=>t.next(),cancel:()=>o.cancelWorkflow({warnIfNoWorkflow:!1})}),this.id):(i.parent&&n&&(t.addHandles(o.lockFeatureTemplatesViewModel(),this.id),o.featureTemplatesViewModel.layers=[n.layer]),t.addHandles(o.featureTemplatesViewModel.on("select",({item:p})=>{p&&(i.creationInfo={...i.creationInfo,layer:p.layer,template:p.template},t.next())}),this.id)))},async tearDown(){t.removeHandles([this.id,Og])}}),"creating-features":()=>({id:"creating-features",async setUp(){t._isActive&&await t._setUpCreatingFeaturesStep()},async tearDown(n){const{viewModel:o}=i;n.canceled&&(t.removeHandles([_$,n4,Og]),o.attachmentsViewModel.fileInfos.removeAll(),t._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:n}=i.viewModel,{graphic:o,fileInfos:u}=n;t._attachmentFileInfos.set(o,u.toArray()),n.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:n}=i.viewModel,{graphic:o,fileInfos:u}=n;t._attachmentFileInfos.set(o,u.toArray()),n.mode="view"}})});return RFe(i,r)}static _configureSketchViewModel(t,e){const{data:i}=t,{creationInfo:r,viewModel:n}=i,{view:o}=n,u=t._sketchViewModel;let p=null;const g=[];if(!o)return We();o.type==="2d"&&r&&g.push(t._fadeExistingFeatures(r.layer));const w=async L=>{if(L.state==="cancel"){if(t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);if(t._lastActiveGraphics.length<1)return t._startCreating(e);const R=t._lastActiveGraphics.pop();return t._startUpdating(R,e)}if(L.state==="complete"&&L.graphic)return t._startUpdating(L.graphic,e)},S=async L=>{var X;const{attachmentsViewModel:R}=n,{_featureFormViewModel:F}=t,V=L.graphics[0];if(L.state==="complete"){V!==p&&(t._lastActiveGraphics.push(V),t._highlight(V)),p=null;const{hasPendingSubtypeChoice:te,submittable:oe}=F;if(t.numPendingFeatures===(r==null?void 0:r.maxFeatures)||te||!oe){!oe&&F.submit();const pe=t._lastActiveGraphics.pop();return t._startUpdating(pe,e)}if(R.mode!=="add"&&R.mode!=="edit"||((X=n.activeWorkflow)==null||X.previous()),L.aborted&&t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);t.addHandles([JO(o),o.on("click",pe=>pe.preventDefault())],n4),await vr(()=>!F.updating),t.removeHandles(n4),t._startCreating(e)}L.state==="start"&&t._removeHighlight(V);const U=t._visualVariableAttributes;await Xoe(o,V,L,U,e);const W=V.attributes,{rotation:H,size:J}=U;if(H!=null){const{field:te}=H;F.setValue(te,W[te])}if(J!=null){const{field:te}=J;F.setValue(te,W[te])}},T=L=>{const R=L.graphics[0];t.pendingFeatures.remove(R),L5(t._lastActiveGraphics,R),p=R},E=async L=>{if(K2(r))return;const{results:R}=await o.hitTest(L,{include:u.layer}),F=R.find(U=>U.type==="graphic"&&U.graphic.sourceLayer===(r==null?void 0:r.layer));if(!F)return;const V=F.graphic;if(u.activeTool==="transform"||u.activeTool==="reshape"){if(u.updateGraphics.at(0)===V)return;const{submittable:U,hasPendingSubtypeChoice:W}=t._featureFormViewModel;if(!U||W)return;await t.updatePendingFeature(V,e)}};g.push(u.on("create",L=>t._updatingHandles.addPromise(w(L))),u.on("update",L=>t._updatingHandles.addPromise(S(L))),u.on("delete",L=>T(L)),o.on("immediate-click",L=>t._updatingHandles.addPromise(E(L)),ii.TOOL),We(()=>{t._preventDefaultActionOnCancel=!0,u.cancel()}),WFe(u,i));const C=In(g);return u.addHandles(C),C}_initializeSketchViewModel(){var n;const{data:t}=this,{view:e}=t.viewModel,i=new LS({elevationInfo:(n=t.creationInfo)==null?void 0:n.layer.elevationInfo,internal:!0,listMode:"hide"}),r=new YM({layer:i,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:e});this._sketchViewModel=r,e==null||e.map.add(i),this.addHandles(We(()=>{e!=null&&e.destroyed||(e==null||e.map.remove(i)),i.destroy()}))}async _setUpCreatingFeaturesStep(){var L;if(this.hasHandles(_$))return;const{creationInfo:t,viewModel:e}=this.data,{attachmentsViewModel:i,view:r}=e;if(!r||!(t!=null&&t.layer))throw new re("missing-parameters","CreateFeaturesWorkflow requires a view and creationInfo.");const{initialFeature:n,layer:o}=t,u=this._sketchViewModel,p=new Map,g=[];this._lastActiveGraphics=[],this._featureFormHandle=Vi(this._featureFormHandle),this._visualVariableAttributes={rotation:null,size:null},this.data.editorItem=e.findEditorItemForLayer(t.layer),NFe(i),g.push(ce(()=>i.mode,R=>{switch(R){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}}));const w=JO(r);g.push(w);const S=um(t.layer);try{if(S){const R=n??new Cr({attributes:{...(L=t.template)==null?void 0:L.prototype.attributes,...t.attributeOverrides},sourceLayer:o});await this._startUpdating(R,p)}else g.push(m5._configureSketchViewModel(this,p)),n?(u.layer.add(n),await this._startUpdating(n,p)):await this._startCreating(p)}finally{w.remove()}const T=We(()=>this.pendingFeatures.drain(R=>u.layer.remove(R))),E=ce(()=>r==null?void 0:r.timeZone,R=>this._featureFormViewModel.timeZone=R,Qe),C=We(()=>{K2(t)&&e.cancelWorkflow({warnIfNoWorkflow:!1})});this._featureFormHandle&&g.push(this._featureFormHandle),this.addHandles(g,this._handleKeys.beforeCommit),this.addHandles([We(()=>i.fileInfos.removeAll()),In(g),C,T,E],_$)}};function WFe(t,e){let i=null;const r=()=>t.snappingOptions.featureSources,n=()=>(i=new KM({layer:t.layer}),r().add(i),i),o=()=>{i!=null&&(r().remove(i),i=ot(i))};return In([ce(()=>{var g;const u=(g=e.creationInfo)==null?void 0:g.layer,p=r().find(w=>w.layer===u);return{hasFeatureLayerSource:!!p,enabled:(p==null?void 0:p.enabled)??!1}},({hasFeatureLayerSource:u,enabled:p})=>{if(!u)return o();i??(i=n()),i.enabled=p},ri),We(o)])}function JFe(t,e,i,r){const n=[];return e.forEach((o,u)=>{if(!o.error){const p=t[u],g=r.get(p)||[];p.attributes[i.objectIdField]=o.objectId,g.forEach(({form:w})=>n.push({feature:p,attachment:w}))}}),n}function ZFe(t,e,i){const r=[],n=e.globalIdField;return t.forEach((o,u)=>{var p;(p=t[u].attributes)[n]??(p[n]=PV()),((i==null?void 0:i.get(o))||[]).forEach(({file:g})=>r.push({feature:o,attachment:{globalId:PV(),data:g}}))}),r.length?{addFeatures:t,addAttachments:r}:{addFeatures:t}}m([b()],ts.prototype,"createFeatureState",void 0),m([b()],ts.prototype,"data",void 0),m([b({constructOnly:!0})],ts.prototype,"isNested",void 0),m([b()],ts.prototype,"featureFormViewModel",null),m([b()],ts.prototype,"hasPendingEdits",null),m([b()],ts.prototype,"_getDrawMeshHelpMessage",void 0),m([b()],ts.prototype,"helpMessage",null),m([b()],ts.prototype,"layer",null),m([b()],ts.prototype,"parent",null),m([b()],ts.prototype,"parentLayer",null),m([b()],ts.prototype,"keyboardCancellationEnabled",null),m([b()],ts.prototype,"reliesOnOwnerAdminPrivileges",null),m([b()],ts.prototype,"shouldShowAttachments",null),m([b()],ts.prototype,"shouldAllowAttachmentEditing",null),m([b()],ts.prototype,"sketchViewModel",null),ts=m5=m([G("esri.widgets.Editor.CreateFeaturesWorkflow")],ts);const iae=ts;let g5=class extends Te{constructor(e){super(e),this.view=null}add(e){const i=!e||Array.isArray(e)?e:[e];i!=null&&i.length&&i.forEach(r=>this._highlight(r))}remove(e){const i=!e||Array.isArray(e)?e:[e];i!=null&&i.length&&i.forEach(r=>this._removeHighlight(r))}removeAll(){this.removeAllHandles()}_highlight(e){const i=BFe(this.view,e.layer);MF(i)&&this.addHandles(i.highlight(e),lG(e))}_removeHighlight(e){e&&this.removeHandles(lG(e))}};m([b()],g5.prototype,"view",void 0),g5=m([G("esri.views.draw.support.HighlightHelper")],g5);const rae=g5;function SB(t){return t==null?null:JSON.stringify(t)}let yp=class extends Te{constructor(e){super(e),this._stagedForDelete=!1,this.feature=null,this.initialFeature=null}get attributesModified(){return this._stringifyAttributes(this.feature)!==this._stringifyAttributes(this.initialFeature)}get geometryModified(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(){var e;this.initialFeature=(e=this.feature)==null?void 0:e.clone()}updateAttributes(e){const{feature:i}=this;i&&(i.attributes=e,this.notifyChange("attributesModified"))}updateGeometry(e){const{feature:i}=this;i&&(i.geometry=e,this.notifyChange("geometryModified"))}_stringifyAttributes(e){return SB(e==null?void 0:e.attributes)}_stringifyGeometry(e){const i=e==null?void 0:e.geometry;return SB((i==null?void 0:i.type)==="mesh"?{transform:i.transform,vertexSpace:i.vertexSpace}:i)}};m([b()],yp.prototype,"_stagedForDelete",void 0),m([b()],yp.prototype,"attributesModified",null),m([b()],yp.prototype,"feature",void 0),m([b()],yp.prototype,"geometryModified",null),m([b()],yp.prototype,"initialFeature",void 0),m([b()],yp.prototype,"modified",null),yp=m([G("esri.widgets.Editor.Edits")],yp);var v5;let Dc=v5=class extends Te{constructor(t){super(t),this.editorItem=null,this.edits=null,this.parent=null,this.relatedRecordCallbacks=null,this.viewModel=null}get attachmentsCapabilities(){const t=this.editorItem.capabilities.update.attachments.enabled;return{editing:!0,operations:{add:t,update:t,delete:t}}}get formTemplate(){return this.editorItem.formTemplate}static async create(t){const e=v5._makeConstructorProps(t);return new v5(e)}static _makeConstructorProps(t){const{feature:e,parent:i,relatedRecordCallbacks:r,viewModel:n}=t,o=n.editorItems.find(u=>u.layer===e.layer);if(!o)throw new re("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified Graphic's layer");return{editorItem:o,edits:new yp({feature:e}),parent:i,relatedRecordCallbacks:r,viewModel:n}}};m([b()],Dc.prototype,"attachmentsCapabilities",null),m([b({constructOnly:!0})],Dc.prototype,"editorItem",void 0),m([b()],Dc.prototype,"edits",void 0),m([b()],Dc.prototype,"formTemplate",null),m([b()],Dc.prototype,"parent",void 0),m([b()],Dc.prototype,"relatedRecordCallbacks",void 0),m([b()],Dc.prototype,"viewModel",void 0),Dc=v5=m([G("esri.widgets.Editor.UpdateRecordWorkflowData")],Dc);const nae=Dc;var b5;let H1=b5=class extends nae{constructor(t){super(t),this.sketchOptions=null,this.snappingManager=null}static async create(t){const{feature:e,snappingManager:i,viewModel:r}=t,n=t.sketchOptions??new w0,{view:o}=r;if(!o)throw new re("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");const u=await Cb(o,e.layer);return new b5({...b5._makeConstructorProps(t),layerView:u,sketchOptions:n,snappingManager:i})}};m([b()],H1.prototype,"layerView",void 0),m([b({constructOnly:!0})],H1.prototype,"sketchOptions",void 0),m([b()],H1.prototype,"snappingManager",void 0),H1=b5=m([G("esri.widgets.Editor.UpdateFeatureWorkflowData")],H1);const KFe=H1;var ZO;const KO={exit:Symbol()};let yo=ZO=class extends RF{constructor(t){super(t),this._highlightHelper=null,this.fullFeature=null,this.type="update-table-record"}initialize(){const{data:t}=this,{edits:e}=t,{view:i}=t.viewModel,r=e.feature,n=new AbortController;this.addHandles(_ce(n)),this._updatingHandles.addPromise(MFe(r,t.viewModel.view.spatialReference,n.signal).then(o=>{Xo(n)||(this._onFullFeatureLoaded(o),this._initializeFeatureFormViewModel())},o=>this.cancel({force:!0,error:new re("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:o}})}))),i&&(this._highlightHelper=new rae({view:i}),this.addHandles(We(()=>{var o;return(o=this._highlightHelper)==null?void 0:o.removeAll()})))}get editorItem(){return this.data.editorItem}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){return this.data.edits.modified}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get parentLayer(){var t;return(t=this.parent)==null?void 0:t.data.editorItem.layer}get shouldShowAttachments(){return this.editorItem.capabilities.attachments.enabled}get shouldAllowAttachmentEditing(){return this.editorItem.capabilities.update.attachments.enabled}get reliesOnOwnerAdminPrivileges(){const t=this.editorItem.capabilities;return t.update.reliesOnOwnerAdminPrivileges||t.delete.reliesOnOwnerAdminPrivileges}async deleteAndCommit(){return this.data.edits.stageDelete(),this.commit()}async enter(){this._configureAttachmentsViewModel()}exit(t){this.removeHandles(KO.exit)}async start(){return await super.start(),null}_configureAttachmentsViewModel(){const{data:t,fullFeature:e}=this,{attachmentsCapabilities:i,viewModel:r}=t,{attachmentsViewModel:n}=r;n.set({capabilities:i,graphic:e,filesEnabled:!1,mode:"view"}),this.addHandles([We(()=>n.fileInfos.removeAll()),ce(()=>n.mode,o=>{switch(o){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}})],KO.exit)}_initializeFeatureFormViewModel(){const{edits:t,formTemplate:e,viewModel:{view:i}}=this.data,r=this._featureFormViewModel=new JR({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:e,highlightHelper:this._highlightHelper,map:i==null?void 0:i.map,spatialReference:i.spatialReference,timeZone:i==null?void 0:i.timeZone});r.relatedRecordCallbacks={...this.data.relatedRecordCallbacks,showAllRelatedRecords:o=>r.relationshipId=o.relationshipId};const{initialFeature:n}=t;n&&r.overrideInitialFeature(n),this.addHandles([r.on("value-change",()=>{t.updateAttributes(r.getValues()),this.fullFeature.attributes=t.feature.attributes}),ce(()=>i==null?void 0:i.timeZone,o=>r.timeZone=o)])}_onFullFeatureLoaded(t){this.fullFeature=t;const{edits:e}=this.data;e.updateAttributes(t.attributes),e.trackChanges()}static async create(t){const e=new ZO({data:await nae.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}static _createWorkflowSteps(t){const{attachmentsViewModel:e}=t.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){e.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){e.mode="view"}}]}};yo._onCommitFactory=t=>async e=>{var p;const{edits:i}=e,{feature:r}=i;if(!r)return;const n=r.sourceLayer,o=r.clone();if(!i.attributesModified||i.stagedForDelete){const g=n.objectIdField;if(o.attributes={[g]:r.getAttribute(g)},F2e()&&O2e()&&n.type==="scene"&&n.infoFor3D!=null){const w=(p=n.associatedLayer)==null?void 0:p.globalIdField;w!=null&&o.setAttribute(w,r.getAttribute(w))}}i.geometryModified&&!i.stagedForDelete||(o.geometry=null);const u=i.stagedForDelete?"deleteFeatures":"updateFeatures";await t(n,{[u]:[o]})},m([b()],yo.prototype,"editorItem",null),m([b()],yo.prototype,"featureFormViewModel",null),m([b()],yo.prototype,"fullFeature",void 0),m([b()],yo.prototype,"hasPendingEdits",null),m([b()],yo.prototype,"layer",null),m([b()],yo.prototype,"parent",null),m([b()],yo.prototype,"parentLayer",null),m([b()],yo.prototype,"shouldShowAttachments",null),m([b()],yo.prototype,"shouldAllowAttachmentEditing",null),m([b()],yo.prototype,"reliesOnOwnerAdminPrivileges",null),yo=ZO=m([G("esri.widgets.Editor.UpdateRecordWorkflow")],yo);var YO;const ru={...KO,highlights:Symbol(),sketchGraphics:Symbol(),sketchViewModel:Symbol()};let W1=YO=class extends yo{constructor(t){super(t),this.type="update-feature",this._layerViewEditSession=null,this._sketchGraphicClone=null,this._sketchViewModel=null,this._webStyleCache=new Map}destroy(){var t;(t=this._layerViewEditSession)==null||t.rollback()}async commit(){this.removeHandles(ru.sketchGraphics);try{const t=this.data.edits.stagedForDelete;await super.commit();const e=this._layerViewEditSession;t?e==null||e.rollback():e==null||e.commit()}catch(t){throw await this._configureSketchViewModel(),new re("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:t})}}async start(){return await super.start(),await this._initializeSketchViewModel()}_initializeFeatureFormViewModel(){super._initializeFeatureFormViewModel(),this.addHandles(this._featureFormViewModel.on("value-change",t=>{var e;(e=this._layerViewEditSession)==null||e.setAttribute(t.fieldName,t.value)}))}_configureHighlight(){const{edits:t,layerView:e}=this.data;MF(e)&&this.addHandles(e.highlight(t.feature),ru.highlights)}async _configureSketchViewModel(){const t=this._sketchViewModel;if(!t)return;const{data:e,_featureFormViewModel:i,_sketchGraphicClone:r}=this,{edits:n,viewModel:o}=e,u=n.feature,{view:p}=o,g=PF(u),w=await AFe({feature:u,featureClone:r,visualVariableAttributes:g,sketchViewModel:t,view:p,onUpdate:({geometry:S,attributes:T},E)=>{if(n.updateAttributes(T),n.updateGeometry(S),i.feature.geometry=S,g.rotation!=null){const{field:C}=g.rotation;i.setValue(C,T[C])}if(g.size!=null){const{field:C}=g.size;i.setValue(C,T[C])}(E.type==="undo"||E.type==="redo"||E.type==="update"&&E.toolEventInfo!=null&&eae(E.toolEventInfo.type))&&i.notifyFeatureGeometryChanged()},webStyleCache:this._webStyleCache});this.addHandles(w,ru.sketchGraphics),t.addHandles(w)}async _initializeSketchViewModel(){const{data:t,_sketchGraphicClone:e}=this,i=t.edits.feature,{capabilities:r,layer:n}=t.editorItem,{view:o}=t.viewModel;if(this.removeHandles([ru.highlights,ru.sketchGraphics,ru.sketchViewModel]),!r.update.geometry||(o==null?void 0:o.type)==="3d"&&OS(n.elevationInfo))return{enter:async()=>{this.hasHandles(ru.highlights)||this._configureHighlight()},exit:()=>this.removeHandles([ru.highlights])};const u=new LS({elevationInfo:n.elevationInfo,internal:!0,listMode:"hide"}),p=new YM({allowDeleteKey:!1,layer:u,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:o});return this._sketchViewModel=p,o==null||o.map.add(u),this.addHandles(We(()=>{o!=null&&o.destroyed||(o==null||o.map.remove(u)),u.destroy(),this._sketchViewModel=ot(p)}),ru.sketchViewModel),await qp(e,this._webStyleCache,(o==null?void 0:o.type)==="2d"?o.scale:null),this.addHandles([await LFe(p,i,e)]),{enter:async()=>{this.hasHandles(ru.sketchGraphics)||await this._configureSketchViewModel()},exit:()=>this.removeHandles([ru.sketchGraphics]),viewModel:p}}_onFullFeatureLoaded(t){super._onFullFeatureLoaded(t);const e=this._sketchGraphicClone=WO(t),{edits:i,layerView:r}=this.data;i.updateGeometry(t.geometry),i.trackChanges(),DFe(r)&&(this._layerViewEditSession=r.createInteractiveEditSession(e))}static async create(t){const e=new YO({data:await KFe.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}get test(){}};m([b()],W1.prototype,"_layerViewEditSession",void 0),m([b()],W1.prototype,"_sketchGraphicClone",void 0),m([b()],W1.prototype,"_sketchViewModel",void 0),W1=YO=m([G("esri.widgets.Editor.UpdateFeatureWorkflow")],W1);let jc=class extends Te{constructor(e){super(e),this.addAttachmentsCallback=null,this.applyEditsCallback=null,this.candidates=null,this.rootFeature=null,this.sketchOptions=null,this.snappingManager=null,this.viewModel=null}};m([b()],jc.prototype,"addAttachmentsCallback",void 0),m([b()],jc.prototype,"applyEditsCallback",void 0),m([b()],jc.prototype,"candidates",void 0),m([b()],jc.prototype,"rootFeature",void 0),m([b({constructOnly:!0})],jc.prototype,"sketchOptions",void 0),m([b()],jc.prototype,"snappingManager",void 0),m([b()],jc.prototype,"viewModel",void 0),jc=m([G("esri.widgets.Editor.UpdateWorkflowData")],jc);const YFe=jc;var XO;const sae="esri.widgets.Editor.UpdateWorkflow",XFe=()=>fe.getLogger(sae);let zs=XO=class extends RF{constructor(t){super(t),this._workflowStack=new mb(NN),this._sketchStack=new mb(NN),this.data=void 0,this.type="update"}get activeEditorItem(){var t;return((t=this.activeWorkflow)==null?void 0:t.data.editorItem)??void 0}get activeFeatureFormViewModel(){var t;return(t=this.activeWorkflow)==null?void 0:t.featureFormViewModel}get activeSketchViewModel(){var t;return(t=this._sketchStack.peek())==null?void 0:t.viewModel}get activeWorkflow(){return this._workflowStack.last()}get hasUpdatableCandidates(){const{candidates:t,viewModel:e}=this.data;return t.some(({layer:i})=>{var r;return(r=e.findEditorItemForLayer(i))==null?void 0:r.supportsUpdateWorkflow})}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){var t;return!!((t=this.activeEditorItem)!=null&&t.capabilities.attachments.enabled)}get shouldAllowAttachmentEditing(){var t;return!!((t=this.activeEditorItem)!=null&&t.capabilities.update.attachments.enabled)}get hasPendingEdits(){return Array.from(this._workflowStack).some(t=>t.hasPendingEdits)}get helpMessage(){var t;return(t=this.activeWorkflow)!=null&&t.helpMessage?this.activeWorkflow.helpMessage:this.stepId==="awaiting-feature-to-update"?"select":void 0}get reliesOnOwnerAdminPrivileges(){var t;return((t=this.activeWorkflow)==null?void 0:t.reliesOnOwnerAdminPrivileges)??!1}get hasInvalidFormTemplate(){var t;return!!((t=this.activeEditorItem)!=null&&t.hasInvalidFormTemplate)}async back(t=()=>Promise.resolve(!0)){const{activeWorkflow:e}=this;if((e==null?void 0:e.featureFormViewModel.relationshipId)==null)if(e){if(e.hasPendingEdits&&!await t())return;e.hasPreviousStep?await e.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0});else e.featureFormViewModel.relationshipId=null}async cancelActiveWorkflow(t){var e;await((e=this.activeWorkflow)==null?void 0:e.cancel(t)),await this._popWorkflow()}async commit(){await this._drainWorkflowStack(t=>t.commit()),await super.commit()}static create(t){const{viewModel:e,snappingManager:i,startAt:r,addAttachmentsCallback:n,applyEditsCallback:o}=t,u=t.sketchOptions??new w0,p=new XO({data:new YFe({addAttachmentsCallback:n,applyEditsCallback:o,sketchOptions:u,snappingManager:i,viewModel:e}),onCommit:async()=>{}});return p._set("steps",this._createWorkflowSteps(p,r)),p}async save(){var t;this.nestedWorkflowCount>1?(await((t=this.activeWorkflow)==null?void 0:t.commit()),await this._popWorkflow()):await this.commit()}async startCreatingRelatedRecord(t){try{const e=await this._createNestedCreateFeaturesWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new re("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:e})}}async startUpdating(t){try{const e=await this._createNestedUpdateWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new re("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:e})}}async deleteActiveFeature(){const{activeWorkflow:t}=this;if(!t)throw new re("editor:nothing-to-delete","There is no feature to delete");QFe(t)?await t.deleteAndCommit():await t.cancel(),this.nestedWorkflowCount===1?await this.reset():await this._popWorkflow()}async cancelAll(){await this._drainWorkflowStack(t=>t.cancel({force:!0}))}async _createNestedCreateFeaturesWorkflow(t){var S;const{relatedLayer:e}=t,{addAttachmentsCallback:i,applyEditsCallback:r,sketchOptions:n,snappingManager:o,viewModel:u}=this.data;if(!h3(e))throw new re("editor:unsupported-layer","Editing is not supported on the provided layer");const p=this._getCreationInfoForNestedCreateFeaturesWorkflow(t),g=p.template||p.initialFeature?"creating-features":"awaiting-feature-creation-info",w=((S=this.activeWorkflow)==null?void 0:S.type)!=="create-features"?this.activeWorkflow:void 0;return iae.create({addAttachmentsCallback:i,applyEditsCallback:r,creationInfo:p,isNested:!0,parent:w,sketchOptions:n,snappingManager:o,startAt:g,viewModel:u})}_getCreationInfoForNestedCreateFeaturesWorkflow(t){const{relatedLayer:e}=t;if(!h3(e)||sv(e))throw new re("editor:unsupported-layer","Editing is not supported on the provided layer");const i={layer:e,maxFeatures:1},r=this._makeRelatedRecordAttributes(t),n=eI(e);return(n==null?void 0:n.length)>0?(i.attributeOverrides=r,n.length===1&&(i.template=n[0])):i.initialFeature=new Cr({sourceLayer:e,attributes:r}),i}async _createNestedUpdateWorkflow(t){var g;const e=um(t.sourceLayer)?yo:W1,{applyEditsCallback:i,sketchOptions:r,snappingManager:n,viewModel:o}=this.data,u=((g=this.activeWorkflow)==null?void 0:g.type)!=="create-features"?this.activeWorkflow:void 0,p=await e.create({feature:t,parent:u,sketchOptions:r,snappingManager:n,viewModel:o,applyEdits:i,relatedRecordCallbacks:{addRelatedRecord:async w=>await this.startCreatingRelatedRecord(w),editRelatedRecord:async({relatedFeature:w})=>await this.startUpdating(w)}});return await vr(()=>!p.updating),p}async _drainWorkflowStack(t){const e=this._workflowStack,i=[];for(;e.length>0;){const r=e.pop();this._sketchStack.pop();const n=t(r).then(()=>r.destroy());this._updatingHandles.addPromise(n),i.push(n)}await Promise.all(i)}_makeRelatedRecordAttributes(t){var g,w;const{parentFeature:e,relatedLayer:i,relationshipId:r}=t;if(!UAe(e))return;const n=(g=i.relationships)==null?void 0:g.find(S=>S.id===r);if(!n)return void Fw("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.");if(n.role==="origin")return void Fw("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");const o=e.sourceLayer;n.relatedTableId!==o.layerId&&Fw("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");const u=(w=o.relationships)==null?void 0:w.find(S=>S.id===r);if(!u)return void Fw("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.");const p=e.getAttribute(u.keyField);return p||Fw("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[n.keyField]:p}}async _popWorkflow(){var e;(e=this._workflowStack.pop())==null||e.destroy(),this._sketchStack.pop();const t=await this._reconcileWorkflowStack();if(t.failureCount>0)throw new re("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",t)}async _pushWorkflow(t){var u;const e=this._workflowRequiresSketchViewModel(t);(u=this.activeWorkflow)==null||u.exit({removeSketchHandles:e});const i=this._sketchStack,r=await(t==null?void 0:t.start()),n=i.peek();r?(n==null||n.exit(),i.push(r)):i.push(this._cloneSketchController(n)),this._workflowStack.push(t);const o=await this._reconcileWorkflowStack();if(o.failureCount>0)throw new re("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",o)}async _reconcileWorkflowStack(){var i;const t=this._workflowStack,e=this._sketchStack;try{const r=t.peek();return await(r==null?void 0:r.enter()),await((i=e.peek())==null?void 0:i.enter()),{activeWorkflow:r,failureCount:0}}catch{t.pop().destroy(),e.pop();const{activeWorkflow:n,failureCount:o}=await this._reconcileWorkflowStack();return{activeWorkflow:n,failureCount:o+1}}}_cloneSketchController(t){return{enter:(t==null?void 0:t.enter)??(async()=>{}),exit:(t==null?void 0:t.exit)??(async()=>{}),viewModel:t==null?void 0:t.viewModel}}_workflowRequiresSketchViewModel(t){var i;const{type:e}=t;return e==="update-feature"||e==="create-features"&&!um((i=t.data.creationInfo)==null?void 0:i.layer)}static _createWorkflowSteps(t,e="awaiting-feature-to-update"){const{data:i}=t;return Qoe(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const{spinnerViewModel:r}=i.viewModel,n=i.viewModel.view;let o=null;t.addHandles(We(()=>{o=En(o)}),this.id),i.rootFeature=null,i.candidates=[];const u=n.on("immediate-click",async p=>{r.location=p.mapPoint,r.visible=!0,o==null||o.abort();const{editorItems:g}=i.viewModel;o=new AbortController;const w=await p.async(()=>new Promise((S,T)=>{Zo(o==null?void 0:o.signal,()=>T(ni())),S(TFe(g,n,p,o==null?void 0:o.signal))}));At(o),i.candidates=w.filter(S=>S.status==="fulfilled").flatMap(S=>S.value).filter(S=>!S.isAggregate),r.visible=i.candidates.length===1,i.candidates.length!==0&&(p.stopPropagation(),i.candidates.length===1?(i.rootFeature=i.candidates[0],t.go("editing-existing-feature").catch(()=>{}).then(()=>r.visible=!1)):t.next())},ii.TOOL);n.focus(),t.addHandles(u,this.id)},async tearDown(){i.candidates.length===0&&(i.viewModel.spinnerViewModel.visible=!1),t.removeHandles(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){i.rootFeature=null;const{view:r}=i.viewModel;if(!r)return;const n=new rae({view:r});t.addHandles([ce(()=>i.rootFeature,(o,u)=>{n.remove(u),n.add(o)},$s),We(()=>n.removeAll())],this.id)},async tearDown(){t.removeHandles(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const{rootFeature:r,viewModel:n}=t.data;if(!r)throw new re("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await t.startUpdating(r),n.spinnerViewModel.visible=!1;const o=Da(async()=>{await vr(()=>!t.updating),t.previous()});t.addHandles([ce(()=>t.nestedWorkflowCount,(u,p)=>{u===0&&p!==0&&o()},$s)],this.id)},async tearDown(){await t.cancelAll(),t.removeHandles(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}})})}};m([b()],zs.prototype,"activeEditorItem",null),m([b()],zs.prototype,"activeFeatureFormViewModel",null),m([b()],zs.prototype,"activeSketchViewModel",null),m([b()],zs.prototype,"activeWorkflow",null),m([b()],zs.prototype,"data",void 0),m([b()],zs.prototype,"hasUpdatableCandidates",null),m([b()],zs.prototype,"nestedWorkflowCount",null),m([b()],zs.prototype,"shouldShowAttachments",null),m([b()],zs.prototype,"shouldAllowAttachmentEditing",null),m([b()],zs.prototype,"hasPendingEdits",null),m([b()],zs.prototype,"helpMessage",null),m([b()],zs.prototype,"reliesOnOwnerAdminPrivileges",null),m([b()],zs.prototype,"hasInvalidFormTemplate",null),zs=XO=m([G(sae)],zs);const Fw=(t,e)=>XFe().warn(`editor:${t}`,e,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature."),QFe=t=>!!t&&/update-/.test(t.type),eNe=zs;let Do=class extends Te{constructor(e){super(e),this.layer=null}get attachments(){var e;return{enabled:this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.data.supportsAttachment)}}get create(){var p;const{_effectiveCapabilities:e,layer:i}=this,r=this._createEnabled,n=r,o=(p=i.capabilities)==null?void 0:p.operations.supportsAdd,u=!!(e!=null&&e.operations.supportsAdd);return{attachments:{enabled:r&&this.attachments.enabled},attributes:r,enabled:r,geometry:n,reliesOnOwnerAdminPrivileges:!o&&u}}get delete(){var o;const{_effectiveCapabilities:e,layer:i}=this,r=(o=i.capabilities)==null?void 0:o.operations.supportsDelete,n=!!(e!=null&&e.operations.supportsDelete);return{enabled:this._effectiveEnabled&&!!(e!=null&&e.operations.supportsDelete),reliesOnOwnerAdminPrivileges:!r&&n}}get reliesOnOwnerAdminPrivileges(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}get update(){var w;const{_effectiveCapabilities:e,layer:i}=this,r=this._updateEnabled,n=!(!r||!(e!=null&&e.editing.supportsGeometryUpdate)),o=(w=i.capabilities)==null?void 0:w.operations.supportsUpdate,u=!!(e!=null&&e.operations.supportsUpdate),p=this.attachments.enabled,g=p&&this._canCreateOrUpdate;return{attachments:{enabled:p,create:g,update:g},attributes:r,enabled:r,geometry:n,reliesOnOwnerAdminPrivileges:!o&&u}}get _createEnabled(){var e;return this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.operations.supportsAdd)}get _updateEnabled(){var e;return this._effectiveEnabled&&!!((e=this._effectiveCapabilities)!=null&&e.operations.supportsUpdate)}get _canCreateOrUpdate(){return!(!this._createEnabled&&!this._updateEnabled)}get _effectiveEnabled(){return TZ(this.layer)}get _effectiveCapabilities(){return Cm(this.layer)}};m([b()],Do.prototype,"attachments",null),m([b()],Do.prototype,"create",null),m([b()],Do.prototype,"delete",null),m([b()],Do.prototype,"layer",void 0),m([b()],Do.prototype,"reliesOnOwnerAdminPrivileges",null),m([b()],Do.prototype,"update",null),m([b()],Do.prototype,"_createEnabled",null),m([b()],Do.prototype,"_updateEnabled",null),m([b()],Do.prototype,"_canCreateOrUpdate",null),m([b()],Do.prototype,"_effectiveEnabled",null),m([b()],Do.prototype,"_effectiveCapabilities",null),Do=m([G("esri.layers.support.EditingCapabilities")],Do);const xB=Do,tNe=[["binary","application/octet-stream","bin",""]];function wrt(t,e){return lae(e.name,(t==null?void 0:t.supportedFormats)??[])!=null}function _rt(t,e){if(!t)return!1;const i=iNe(e,t.supportedFormats??[]);return i!=null&&t.editFormats.includes(i)}function Srt(t){return XM((t==null?void 0:t.supportedFormats)??[]).flatMap(cae).map(e=>`.${e}`)}function oae(t,e){return FF(nNe(t,e))}function aae(t,e){return FF(lae(t,e))}function xrt(t,e){return uae(rNe(t,e))}function iNe(t,e){return aae(t.name,e)??oae(t.type,e)}function XM(t){return[...tNe,...t]}function rNe(t,e){return XM(e).find(i=>FF(i)===t)}function nNe(t,e){const i=t.toLowerCase();return XM(e).find(r=>uae(r)===i)}function lae(t,e){const i=t.toLowerCase();return XM(e).find(r=>cae(r).some(n=>i.endsWith(n)))}function FF(t){return t==null?void 0:t[0]}function uae(t){return t==null?void 0:t[1].toLowerCase()}function cae(t){return(t==null?void 0:t[2].split(",").map(e=>e.toLowerCase()))??[]}function $rt(t){var e;return(e=t.tables)==null?void 0:e.find(i=>i.role==="assetMaps")}const Pg="esri.views.layers.support.editableLayerViews";function sNe(t,e){const{associatedLayer:i}=t,r=i==null?void 0:i.infoFor3D;if(!r)return!1;const{supportedFormats:n,queryFormats:o}=r,u=oae("model/gltf-binary",n)??aae("glb",n);if(!(u!=null&&o.includes(u)))return fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because it does not support GLB queries.`),!1;const p=t.spatialReference,g=i.spatialReference;if(!Ki(p,g))return fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because its spatial reference (wkid:${p.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${g.wkid}).`),!1;const w=i.sourceJSON.sourceSpatialReference;if(!(w==null||Ki(w,g)))return fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${g.wkid}) is different from its source spatial reference (wkid:${w.wkid}).`),!1;const{view:S}=e;if(e.destroyed||S==null)return!1;const T=S.spatialReference,{viewingMode:E}=S.state,C=u0(p),L=E===Xp.Global;return C&&!L?(fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${p.wkid}) is geographic. Please consider changing the viewing mode to global.`),!1):!C&&L?(fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${p.wkid}) is projected. Please consider changing the viewing mode to local.`),!1):!!(Ki(p,T)||L&&ea(T)&&Qf(p))||(fe.getLogger(Pg).warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) does not support geometry edits because its spatial reference (wkid:${p.wkid}) does not match the view spatial reference (wkid:${T.wkid}).`),!1)}let dl=class extends xB{constructor(e){super(e),this.layerInfo=null,this.layerView=null}get attachments(){const e=this.defaults.attachments.enabled,i=this.layerInfo;return{enabled:e&&(i==null?void 0:i.enabled)!==!1}}get create(){const{attachments:e,defaults:i,layerInfo:r,layer:n,layerView:o}=this,u=i.create,p=(r==null?void 0:r.enabled)!==!1&&(r==null?void 0:r.addEnabled)!==!1,g=u.enabled&&p;return{attributes:g&&u.attributes,enabled:g,geometry:g&&u.geometry&&$B(n,o),attachments:{enabled:e.enabled&&g&&(r==null?void 0:r.attachmentsOnCreateEnabled)!==!1},reliesOnOwnerAdminPrivileges:u.reliesOnOwnerAdminPrivileges}}get defaults(){return new xB({layer:this.layer})}get delete(){const{defaults:e,layerInfo:i}=this,r=e.delete,n=(i==null?void 0:i.enabled)!==!1&&(i==null?void 0:i.deleteEnabled)!==!1;return{enabled:r.enabled&&n,reliesOnOwnerAdminPrivileges:r.reliesOnOwnerAdminPrivileges}}get formTemplate(){const{layer:e,layerInfo:i}=this;return i!=null&&i.formTemplate?i.formTemplate:e&&"formTemplate"in e?e.formTemplate:null}get relationship(){var n,o,u;const{layer:e}=this,i=!(!CS(e)||!((n=e.relationships)!=null&&n.length)),r=!!((u=(o=this.formTemplate)==null?void 0:o.elements)!=null&&u.some(p=>p.type==="relationship"));return{enabled:i&&r}}get update(){const{attachments:e,defaults:i,layerInfo:r,layer:n,layerView:o}=this,u=i.update,p=(r==null?void 0:r.enabled)!==!1&&(r==null?void 0:r.updateEnabled)!==!1,g=u.enabled&&p,w=g&&u.attributes&&(r==null?void 0:r.attributeUpdatesEnabled)!==!1,S=g&&u.geometry&&(r==null?void 0:r.geometryUpdatesEnabled)!==!1&&$B(n,o),T=e.enabled&&(r==null?void 0:r.attachmentsOnUpdateEnabled)!==!1;return{attributes:w,enabled:g,geometry:S,attachments:{enabled:T,create:T&&u.attachments.create,update:T&&u.attachments.update},reliesOnOwnerAdminPrivileges:u.reliesOnOwnerAdminPrivileges}}};function $B(t,e){return t.type!=="scene"||e!=null&&"type"in e&&e.type==="scene-layer-3d"&&sNe(t,e)}m([b()],dl.prototype,"attachments",null),m([b()],dl.prototype,"create",null),m([b()],dl.prototype,"defaults",null),m([b()],dl.prototype,"delete",null),m([b()],dl.prototype,"formTemplate",null),m([b()],dl.prototype,"layerInfo",void 0),m([b()],dl.prototype,"layerView",void 0),m([b()],dl.prototype,"relationship",null),m([b()],dl.prototype,"update",null),dl=m([G("esri.widgets.Editor.support.EditorEditingCapabilities")],dl);const oNe=dl;let Us=class extends Te{constructor(e){super(e),this.disabled=!1,this.layer=null,this.layerInfo=null,this.layerView=null}get _suspended(){var e;return!!((e=this.layerView)!=null&&e.suspended)}get capabilities(){return new oNe({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}get editable(){const{create:e,relationship:i,update:r,delete:{enabled:n}}=this.capabilities,o=e.attachments.enabled||r.attachments.enabled;return!this.disabled&&(e.enabled||r.enabled||o||n||i.enabled)}get formTemplate(){return this.capabilities.formTemplate}get hasInvalidFormTemplate(){return vLe(this.layer,this.formTemplate)}get isTable(){return um(this.layer)}get supportsCreateFeaturesWorkflow(){if(this.disabled)return!1;const{enabled:e,geometry:i}=this.capabilities.create;return this.isTable?e:e&&i}get supportsUpdateWorkflow(){const{capabilities:e}=this;return!this.disabled&&(e.update.enabled||e.update.attachments.enabled||e.delete.enabled)}get visible(){const{layer:e}=this,i=e.parent;return!this._suspended&&e.visible&&(!i||!("visible"in i)||i.visible)}};m([b()],Us.prototype,"_suspended",null),m([b()],Us.prototype,"capabilities",null),m([b()],Us.prototype,"disabled",void 0),m([b()],Us.prototype,"editable",null),m([b()],Us.prototype,"formTemplate",null),m([b()],Us.prototype,"hasInvalidFormTemplate",null),m([b()],Us.prototype,"isTable",null),m([b()],Us.prototype,"layer",void 0),m([b()],Us.prototype,"layerInfo",void 0),m([b()],Us.prototype,"layerView",void 0),m([b()],Us.prototype,"supportsCreateFeaturesWorkflow",null),m([b()],Us.prototype,"supportsUpdateWorkflow",null),m([b()],Us.prototype,"visible",null),Us=m([G("esri.widgets.Editor.support.EditorItem")],Us);const aNe=Us,hae="esri.widgets.Editor.EditorViewModel",lNe=()=>fe.getLogger(hae),pae=["create-features","update"];function A0(t,e,i){lNe().error(new re(t,e,i))}function uNe(t,e){return t==null?void 0:t.find(i=>i.layer===e)}let Vt=class extends Ar.EventedAccessor{constructor(e){super(e),this._sketchEventListenerHandle=null,this._sketchGraphicsLayer=new LS({listMode:"hide",internal:!0}),this._snappingManager=null,this._updateItemsTask=null,this._updatingHandles=new Ua,this._featureTemplatesViewModelLocked=!1,this.activeWorkflow=null,this._activityQueue=new Ie,this.editorItems=new Ie,this.failures=[],this.hideTemplatesForInactiveLayers=!1,this.attachmentsViewModel=new GR({capabilities:{editing:!0}}),this.featureTemplatesViewModel=new PO({disabledItemFunction:({layer:i})=>this._itemIsSuspended(i)}),this.layerInfos=null,this.ownSketchViewModel=new YM({layer:this._sketchGraphicsLayer}),this.sketchOptions=new w0,this.snappingOptions=new rg({attributeRulesEnabled:!0}),this.spinnerViewModel=new rF,this.pageStack=[],this.showDiscardEditsPrompt=()=>Promise.resolve(!0),this._candidateCommitted=!1,this.back=async()=>{var i;this.canGoBack&&((i=this.activeWorkflow)!=null&&i.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))},this.saveWorkflow=async()=>{var r;const{featureFormViewModel:i}=this;if(i){if(i.submit(),!i.submittable||i.hasPendingSubtypeChoice)return;const n=i.getValues();if(i.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length>0)return}await((r=this.activeWorkflow)==null?void 0:r.save())},this.selectFeature=(i,r=!1)=>{const n=this.activeWorkflow;this._candidateCommitted||(n==null?void 0:n.type)!=="update"||(n.data.rootFeature=i,r&&(n.next(),this._candidateCommitted=!0))}}initialize(){this.addHandles([ce(()=>{var o;const e=this.view,i=(o=e==null?void 0:e.map)==null?void 0:o.editableLayers,r=e==null?void 0:e.allLayerViews,n=r==null?void 0:r.filter(u=>!!(i!=null&&i.includes(u.layer)));return[i,n,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditorItems(),ri),ce(()=>this.hideTemplatesForInactiveLayers,()=>this.syncFeatureTemplates()),gi(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),gi(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),gi(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit"),this._set("activeWorkflow",null)}),Fr(()=>{var e;return(e=this.view)==null?void 0:e.map},e=>e.add(this._sketchGraphicsLayer),Qe),gi(()=>this.editorItems,"change",()=>this._afterEditorItemsChange()),ce(()=>[this.canCreate,this.canUpdateVisible],()=>this._afterEditorItemsChange()),ce(()=>this.page,(e,i)=>{const r=[...this.pageStack];if(r.indexOf(e)===-1)r.push(e);else for(;r.length&&r.at(-1)!==e;)r.pop();this.pageStack=r},ri),Fr(()=>this.state==="awaiting-update-feature-candidate",()=>this._candidateCommitted=!1),gi(()=>this.featureTemplatesViewModel,"select",async({item:e,oldItem:i})=>{var o;const{activeWorkflow:r}=this;if(r){if(r.type==="update"&&((o=r.activeWorkflow)==null?void 0:o.stepId)==="awaiting-feature-creation-info")return;try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{return void this.featureTemplatesViewModel.select(i,{emit:!1})}}if(!e)return;const n={layer:e.layer,template:e.template};if(e.supportsUpload)return this.featureTemplatesViewModel.select(i,{emit:!1}),this.startCreateFeaturesWorkflow(n);this.startCreateFeaturesWorkflowAtFeatureCreation(n)}),gi(()=>this.view,"key-down",e=>{var i;e.key==="Escape"&&((i=this.activeWorkflow)!=null&&i.keyboardCancellationEnabled)&&(e.stopPropagation(),this.back())}),gi(()=>this.sketchViewModel,["create","delete","update"],e=>{var p,g;const{activeWorkflow:i}=this,r=(i==null?void 0:i.type)==="update",n=r?(p=i.activeWorkflow)==null?void 0:p.layer:i==null?void 0:i.layer,o=r?(g=i==null?void 0:i.activeWorkflow)==null?void 0:g.parentLayer:void 0,u=`sketch-${e.type}`;this.emit(u,{type:u,detail:e,layer:n,parentLayer:o})},$s),ce(()=>this.view,e=>{if(this._snappingManager=ot(this._snappingManager),!e)return;const i=this.snappingOptions;this._snappingManager=new xl({view:e,options:i})},ri),ce(()=>this.snappingOptions,e=>{this._snappingManager&&(this._snappingManager.options=e)},ri)])}destroy(){this._cancelWorkflow({warnIfNoWorkflow:!1}).then(()=>{var e,i;(i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._sketchGraphicsLayer),this.view=null}),this._updateItemsTask=En(this._updateItemsTask),this._updatingHandles.destroy(),this._sketchEventListenerHandle=Vi(this._sketchEventListenerHandle)}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(e){wo(fe.getLogger(this),"allowedWorkflows",{replacement:"Editor.visibleElements",version:"4.29",warnOnce:!0}),e&&e.length!==0||(e=[...pae]),this._set("allowedWorkflows",e)}get canCreate(){return this.editorItems.some(e=>e.supportsCreateFeaturesWorkflow)}get canCreateVisible(){return!!this.featureTemplatesLayers.length}get canUpdate(){return this.editorItems.some(e=>e.supportsUpdateWorkflow)}get canUpdateVisible(){return this.editorItems.some(e=>e.supportsUpdateWorkflow&&e.visible)}get featureTemplatesLayers(){const e=new Ie;for(const i of this.editorItems){const r=i.supportsCreateFeaturesWorkflow&&!i.isTable,n=this.hideTemplatesForInactiveLayers&&!i.visible;r&&!n&&e.push(i.layer)}return e}get editableItems(){return wo(fe.getLogger(this),"editableItems",{replacement:"editorItems",version:"4.29",warnOnce:!0}),this.editorItems.map(e=>{const{capabilities:i,disabled:r,hasInvalidFormTemplate:n,layer:o}=e,u=[],p=i.create,g=i.update,w=i.delete;return p.enabled&&u.push("create"),g.enabled&&u.push("update"),w.enabled&&u.push("delete"),{layer:o,supports:u,suspended:r,attributeUpdatesEnabled:g.attributes,geometryUpdatesEnabled:g.geometry,attachmentsOnCreateEnabled:p.attachments.enabled,attachmentsOnUpdateEnabled:g.attachments.enabled,hasInvalidFormTemplate:n,hasAttachments:i.attachments.enabled}})}get featureFormViewModel(){const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"?e.activeFeatureFormViewModel:(e==null?void 0:e.type)==="create-features"?e.featureFormViewModel:null}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get sketchViewModel(){const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"?e.activeSketchViewModel:(e==null?void 0:e.type)==="create-features"?e.sketchViewModel:this.ownSketchViewModel}get state(){var r,n;if(!((r=this.view)!=null&&r.ready))return"disabled";const e=this.attachmentsViewModel.mode;if(e==="add")return"adding-attachment";if(e==="edit")return"editing-attachment";const{activeWorkflow:i}=this;return i!=null&&i.stepId?i.type==="update"&&((n=i.activeWorkflow)!=null&&n.stepId)?i.activeWorkflow.stepId:i.stepId:"ready"}get syncing(){return this._activityQueue.length>0}get updating(){var e;return this._updatingHandles.updating||((e=this.activeWorkflow)==null?void 0:e.updating)===!0}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}set view(e){this.ownSketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}get page(){const{activeWorkflow:e,state:i}=this;if((e==null?void 0:e.type)==="update"&&e.stepId==="awaiting-feature-to-update")return"ready";if((e==null?void 0:e.type)==="create-features"&&e.numPendingFeatures===0){const r=e.data.upload;if(r)return r.state==="default"?"ready":"creating-features-upload-details"}return i??"disabled"}get featureFormDisabled(){var i;const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"&&((i=e.activeEditorItem)==null?void 0:i.capabilities.update.attributes)===!1}get canGoBack(){return this.activeWorkflow!=null&&!this.syncing}get shouldShowDeleteButton(){var i;const{activeWorkflow:e}=this;return!!e&&e.type==="update"&&!!((i=e.activeEditorItem)!=null&&i.capabilities.delete.enabled)}get hasPendingEdits(){var e;return((e=this.activeWorkflow)==null?void 0:e.hasPendingEdits)??!1}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateFeaturesWorkflowAtFeatureCreation(e){return this.startCreateFeaturesWorkflow(e,"creating-features")}async startCreateFeaturesWorkflow(e,i="awaiting-feature-creation-info"){if(await vr(()=>!this.updating),!this.canCreate)throw new re("editing:unsupported-workflow","Creating features is unsupported or disabled.");const r=this._createUpdatingResolver();try{await this._cancelWorkflow();const n=this._createCreateFeaturesWorkflow(e,i);this._set("activeWorkflow",n),await n.start()}catch(n){this._logErrorAndCancelWorkflow(n)}finally{r.resolve()}}async startCreateFeaturesWorkflowAtFeatureEdit(e){await vr(()=>!this.updating);const i=this._createUpdatingResolver();try{const{initialFeature:r}=e,n=r.sourceLayer=r.layer,o=n?this.findEditorItemForLayer(n):void 0;if(!(o!=null&&o.supportsCreateFeaturesWorkflow))throw new re("editing:unsupported-workflow","Creating features is unsupported or disabled for this layer.");await this._cancelWorkflow();const u=this._createCreateFeaturesWorkflow({initialFeature:r,layer:o.layer,maxFeatures:1},"creating-features");this._set("activeWorkflow",u),await u.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startUpdateWorkflowAtFeatureSelection(){if(await vr(()=>!this.updating),!this.canUpdate)return void A0("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const e=this._createUpdatingResolver();try{await this._cancelWorkflow();const i=this._createUpdateWorkflow();this._set("activeWorkflow",i),await i.start()}catch(i){this._logErrorAndCancelWorkflow(i)}finally{e.resolve()}}async startUpdateWorkflowAtMultipleFeatureSelection(e){if(await vr(()=>!this.updating),!this.canUpdate)return void A0("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createUpdateWorkflow("awaiting-update-feature-candidate");r.data.candidates=e,this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startUpdateWorkflowAtFeatureEdit(e){if(await vr(()=>!this.updating),!this.canUpdate)return void A0("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createUpdateWorkflow("editing-existing-feature");r.data.rootFeature=e,this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async deleteFeatureFromWorkflow(){const{activeWorkflow:e}=this;e&&e.type==="update"?await e.deleteActiveFeature():A0("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(e){return this._cancelWorkflow({warnIfNoWorkflow:!0,...e})}findEditorItemForLayer(e){return this.editorItems.find(i=>i.layer===e)}itemHasInvalidFormTemplate(e){var i;return e!=null&&((i=this.findEditorItemForLayer(e.layer))==null?void 0:i.hasInvalidFormTemplate)===!0}syncFeatureTemplates(){this._featureTemplatesViewModelLocked||(this.featureTemplatesViewModel.layers=this.featureTemplatesLayers.toArray())}async toggleUpdateWorkflow(){this.canUpdate&&(this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&this.state==="awaiting-feature-to-update"?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection()))}lockFeatureTemplatesViewModel(){return this._featureTemplatesViewModelLocked=!0,We(()=>{this._featureTemplatesViewModelLocked=!1,this.syncFeatureTemplates()})}async _getEditorItemCandidates(e){const{view:i}=this;if(!(i!=null&&i.map))return[];const{map:r}=i,n=r.editableLayers.toArray()??[],o=r.allTables.toArray().filter(w2)??[];return await Promise.allSettled([...n.map(u=>u.type==="subtype-group"?u.loadAll():Promise.resolve()),...o.map(u=>u.load())]),At(e),[...n.reverse(),...o.reverse()].filter(u=>h3(u)&&(u.geometryType!=="mesh"||i.type==="3d")).flatMap(u=>u.type==="subtype-group"?u.sublayers.toArray():u)}_drainEditorItems(){this.editorItems.drain(e=>e.destroy())}async _updateEditorItems(){En(this._updateItemsTask);const{view:e}=this,i=Sh(async r=>{if(!(e!=null&&e.map)||!(e!=null&&e.allLayerViews))return;const n=await this._getEditorItemCandidates(r);if(!n.length)return void this._drainEditorItems();const o=[],u=[],p=[],{layerInfos:g}=this;for(const S of n){const T=uNe(g,S),E=await Cb(e,S).catch(()=>null);(T?o:E?u:p).push(new aNe({layer:S,layerInfo:T,layerView:E}))}g!=null&&g.length&&o.sort((S,T)=>g.findIndex(({layer:E})=>E===S.layer)-g.findIndex(({layer:E})=>E===T.layer));const w=[...o,...u,...p];r.aborted||(this._drainEditorItems(),this.editorItems.addMany(w))});this._updatingHandles.addPromise(i.promise),this._updateItemsTask=i}_afterEditorItemsChange(){const{activeWorkflow:e}=this;if(this.syncFeatureTemplates(),!e)return;const{stepId:i}=e;e.type!=="create-features"?e.type==="update"&&(i==="awaiting-feature-to-update"&&!this.canUpdateVisible||i==="awaiting-update-feature-candidate"&&!e.hasUpdatableCandidates)&&this._cancelWorkflow():i!=="awaiting-feature-creation-info"||this.canCreate||this._cancelWorkflow()}async _cancelWorkflow(e){const i=this.activeWorkflow;if(!i)return void((e==null?void 0:e.warnIfNoWorkflow)&&A0("editing:no-active-workflow","There is no active workflow to cancel."));if(!e||e.force!==!1)return this.emit("workflow-cancel"),this._set("activeWorkflow",null),void await i.cancel(e);await i.cancel(e),this._set("activeWorkflow",null)}_createCreateFeaturesWorkflow(e,i){return iae.create({viewModel:this,creationInfo:e,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:i,applyEditsCallback:(r,n,o)=>this._applyEdits(r,n,o),addAttachmentsCallback:(r,n)=>this._addAttachments(r,n)})}_createUpdateWorkflow(e){return eNe.create({viewModel:this,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:e,applyEditsCallback:(i,r,n)=>this._applyEdits(i,r,n),addAttachmentsCallback:(i,r)=>this._addAttachments(i,r)})}_addAttachments(e,i){const r=i.map(n=>this._addAttachment(e,n.feature,n.attachment))??[];return Promise.all(r)}async _addAttachment(e,i,r){var o;let n=null;if(!("addAttachment"in e)||((o=e.capabilities)==null?void 0:o.attachment)==null)throw new re("editor:attachments-not-supported","Adding attachments is not supported for this layer type");return await this._queueOperation(async()=>{var u;return n=await((u=e.addAttachment)==null?void 0:u.call(e,i,r).catch(p=>{throw(p==null?void 0:p.error)||p}))??null,n}),n}async _applyEdits(e,i,r){let n=null;const o=e.url?await xP(e.url):null,u={returnServiceEditsOption:(!o||!j4(o))&&!RegExp("/hosted/","i").test(e.url)?"original-and-current-features":void 0,...r};return await this._queueOperation(async()=>{const{view:p}=this;if(!p)return null;const g=await Cb(p,e).catch(()=>null);return n=await e.applyEdits(i,u),g&&await vr(()=>!g.updating),n}),n}_queueOperation(e){this._activityQueue.push(e);const i=(r,n)=>{const o=n.indexOf(r);o>-1&&n.splice(o,1)};return e().then(r=>{if(r!=null&&"error"in r&&r.error!=null)throw r.error;if(r!=null&&"addFeatureResults"in r){const{addFeatureResults:n,deleteFeatureResults:o,updateFeatureResults:u}=r,p=n.find(g=>!!g.error)||u.find(g=>!!g.error)||o.find(g=>!!g.error);if(p)throw p.error}return r}).catch(r=>{A0("editing:operation-error","An error occurred.",{error:r});const n={error:r,retry:()=>(i(n,this.failures),this._queueOperation(e)),cancel:()=>{i(n,this.failures)}};this._set("failures",[...this.failures,n])}).then(()=>{i(e,this._activityQueue)})}_createUpdatingResolver(){const e=os();return this._updatingHandles.addPromise(e.promise),e}_logErrorAndCancelWorkflow(e){const{name:i,message:r,details:n}=e;A0(i??"editing:workflow-start-failed",r??void 0,n??e),this._cancelWorkflow({force:!0})}_itemIsSuspended(e){const i=this.findEditorItemForLayer(e);return i!=null&&(!i.visible||i.disabled)}};m([b({readOnly:!0})],Vt.prototype,"activeWorkflow",void 0),m([b({readOnly:!0})],Vt.prototype,"_activityQueue",void 0),m([b({value:[...pae]})],Vt.prototype,"allowedWorkflows",null),m([b({readOnly:!0})],Vt.prototype,"canCreate",null),m([b()],Vt.prototype,"canCreateVisible",null),m([b({readOnly:!0})],Vt.prototype,"canUpdate",null),m([b()],Vt.prototype,"canUpdateVisible",null),m([b()],Vt.prototype,"featureTemplatesLayers",null),m([b()],Vt.prototype,"editableItems",null),m([b()],Vt.prototype,"editorItems",void 0),m([b({readOnly:!0})],Vt.prototype,"failures",void 0),m([b()],Vt.prototype,"hideTemplatesForInactiveLayers",void 0),m([b()],Vt.prototype,"attachmentsViewModel",void 0),m([b()],Vt.prototype,"featureFormViewModel",null),m([b()],Vt.prototype,"featureTemplatesViewModel",void 0),m([b()],Vt.prototype,"labelOptions",null),m([b()],Vt.prototype,"layerInfos",void 0),m([b()],Vt.prototype,"ownSketchViewModel",void 0),m([b()],Vt.prototype,"sketchOptions",void 0),m([b()],Vt.prototype,"sketchViewModel",null),m([b({type:rg,nonNullable:!0})],Vt.prototype,"snappingOptions",void 0),m([b()],Vt.prototype,"spinnerViewModel",void 0),m([b()],Vt.prototype,"state",null),m([b({readOnly:!0})],Vt.prototype,"syncing",null),m([b()],Vt.prototype,"updating",null),m([b()],Vt.prototype,"tooltipOptions",null),m([b()],Vt.prototype,"valueOptions",null),m([b()],Vt.prototype,"view",null),m([b()],Vt.prototype,"pageStack",void 0),m([b()],Vt.prototype,"showDiscardEditsPrompt",void 0),m([b()],Vt.prototype,"_candidateCommitted",void 0),m([b()],Vt.prototype,"page",null),m([b()],Vt.prototype,"featureFormDisabled",null),m([b()],Vt.prototype,"canGoBack",null),m([b()],Vt.prototype,"shouldShowDeleteButton",null),m([b()],Vt.prototype,"hasPendingEdits",null),Vt=m([G(hae)],Vt);const cNe=Vt;let mp=class extends Te{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.header=!1,this.layerList=!0,this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};m([b({type:Boolean,nonNullable:!0})],mp.prototype,"enabledToggle",void 0),m([b({type:Boolean,nonNullable:!0})],mp.prototype,"featureEnabledToggle",void 0),m([b({type:Boolean,nonNullable:!0})],mp.prototype,"header",void 0),m([b({type:Boolean,nonNullable:!0})],mp.prototype,"layerList",void 0),m([b({type:Boolean,nonNullable:!0})],mp.prototype,"layerListToggleLayersButton",void 0),m([b({type:Boolean,nonNullable:!0})],mp.prototype,"selfEnabledToggle",void 0),mp=m([G("esri.widgets.support.SnappingControls.VisibleElements")],mp);const DS=mp;let fl=class extends Te{constructor(e){super(e),this.createFeaturesSection=!0,this.directionModePicker=!1,this.editFeaturesSection=!0,this.labelsToggle=!0,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new DS,this.tooltipsToggle=!0,this.undoRedoButtons=!1}};m([b({type:Boolean,nonNullable:!0})],fl.prototype,"createFeaturesSection",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"directionModePicker",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"editFeaturesSection",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"labelsToggle",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"settingsMenu",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"snappingControls",void 0),m([b({type:DS,nonNullable:!0})],fl.prototype,"snappingControlsElements",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"tooltipsToggle",void 0),m([b({type:Boolean,nonNullable:!0})],fl.prototype,"undoRedoButtons",void 0),fl=m([G("esri.widgets.Editor.VisibleElements")],fl);const dae=fl,Nw="esri-editor__panel-content",j3={base:Nw,message:`${Nw}__message`,section:`${Nw}__section`,sectionGroup:`${Nw}__section__group`,scrimContainer:`${Nw}__scrim-container`},jS=()=>zi({scrim:()=>ie(()=>import("./calcite-scrim-CBy6Hnad.js"),__vite__mapDeps([268,250,225,220,226,227,228,230]))});function Uf(t,...e){return N("div",{class:Uu(j3.base,t!=null&&t.showScrimOverlay?j3.scrimContainer:void 0),key:(t==null?void 0:t.key)??"panel-content"},...e,t!=null&&t.showScrimOverlay?N("calcite-scrim",null):void 0)}function NF(t,...e){return N("div",{class:j3.message,"data-testid":"panel-content-message",key:(t==null?void 0:t.key)??"panel-content-message"},...e)}function Gv(t,...e){return N("div",{class:j3.section,key:(t==null?void 0:t.key)??"panel-content-section"},...e)}function hNe(t,...e){return N("div",{class:j3.sectionGroup,key:(t==null?void 0:t.key)??"panel-content-section-group"},...e)}const pNe=()=>jS();function dNe({helpMessage:t}){return N(Uf,{key:"creating-features-panel-content"},N(NF,{key:"content-message"},t))}const fNe=()=>jS();function yNe({editorItems:t,filterText:e,id:i,messagesTemplates:r,onFilterTextChange:n,onSelectFeature:o,workflow:u}){const p=new Map,g=u.data.candidates;let w=0;g.map(E=>({label:mNe(E),id:E.attributes[E.layer.objectIdField],data:E})).filter(({label:E,data:C})=>{const L=e.toLowerCase(),{title:R}=C.layer,F=t.find(V=>V.layer===C.sourceLayer);return F?F.supportsUpdateWorkflow&&(!L||(E==null?void 0:E.toLowerCase().includes(L))||(R==null?void 0:R.toLowerCase().includes(L))):null}).filter(Rt).forEach(E=>{var L;w++;const C=E.data.layer;p.has(C)?(L=p.get(C))==null||L.items.push(E):p.set(C,{id:`${C.id}`,label:C.title??"",items:[E]})});const S=t.toArray().map(({layer:E})=>p.get(E)).filter(Rt),T=w>10||e.length>0;return N(Uf,{key:"feature-list"},N(Gv,null,zse({enableListScroll:!1,filterEnabled:T,filterText:e,id:i,items:S,messages:{filterPlaceholder:r.filterPlaceholder,noItems:r.noItems,noMatches:r.noMatches},onFilterChange:E=>n(E),onItemMouseEnter:E=>o(E.data),onItemMouseLeave:()=>o(null),onItemSelect:E=>o(E.data,!0)})))}function mNe(t){const e=t.layer;if(!e)return null;const i=e.fieldsIndex.get(e.objectIdField),r=i.alias||i.name,{attributes:n}=t,o=XP(e);return o&&n[o]&&`${n[o]}`||`${r}: ${n[i.name]}`}const gNe={base:"esri-editor__actions"},DF=()=>zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230]))});function oI({buttons:t,key:e}){return N("div",{class:gNe.base,key:e??"footer-actions",slot:"footer"},t.filter(Rt).map(({disabled:i,onClick:r,label:n,...o},u)=>N("calcite-button",{disabled:i??!1,key:`action-${u}`,onclick:()=>{i||r()},slot:"footer-actions",width:"full",...o},n)))}const vNe={notice:"esri-editor__notice"},fae=()=>zi({notice:()=>ie(()=>import("./calcite-notice-mqUu1NoI.js"),__vite__mapDeps([266,267,227,220,224,225,226,228,247,223,229]))});function bNe({workflow:t,messages:e}){return N(Jf,null,t!=null&&t.reliesOnOwnerAdminPrivileges?N(QO,{message:e.ownerAdminNotice}):void 0,t!=null&&t.hasInvalidFormTemplate?N(QO,{icon:BR,message:e.formFieldUpdateError}):void 0)}function QO({message:t,...e}){return N("calcite-notice",{class:vNe.notice,open:!0,scale:"s",...e},N("div",{slot:"message"},t))}const wNe={absolute:"absolute-direction",relative:"relative-direction"},yae=()=>Promise.all([zi({icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),switch:()=>ie(()=>import("./calcite-switch-Bg2wMLH-.js"),__vite__mapDeps([269,220,219,221,226,222,223,224])),tooltip:()=>ie(()=>import("./calcite-tooltip-Ci-tYktH.js"),__vite__mapDeps([340,220,244,245,247,249]))})]),S$="esri-labeled-switch",x$={label:`${S$}__label`,labelContent:`${S$}__label-content`,icon:`${S$}__icon`,tooltip:`${S$}__tooltip`};function Y2({checked:t,disabled:e,hint:i,key:r,label:n,onChange:o}){return N("calcite-label",{class:x$.label,disabled:e,key:r,layout:"inline-space-between",scale:"s"},N("div",{class:x$.labelContent,key:"label-content"},i?N(Jf,null,N("div",null,n),N("calcite-icon",{class:x$.icon,icon:"information",id:r,scale:"s"}),N("calcite-tooltip",{class:x$.tooltip,referenceElement:r},i)):n),N("calcite-switch",{checked:t,disabled:e,scale:"s",onCalciteSwitchChange:u=>o(u.target.checked)}))}let Ry=class extends Te{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};m([b({type:Boolean,nonNullable:!0})],Ry.prototype,"directionModePicker",void 0),m([b({type:Boolean,nonNullable:!0})],Ry.prototype,"header",void 0),m([b({type:Boolean,nonNullable:!0})],Ry.prototype,"labelsToggle",void 0),m([b({type:Boolean,nonNullable:!0})],Ry.prototype,"tooltipsToggle",void 0),Ry=m([G("esri.widgets.support.SketchTooltipControls.VisibleElements")],Ry);const mae=Ry,Dw="esri-sketch-tooltip-controls",$$={base:Dw,block:`${Dw}__block`,blockContent:`${Dw}__block-content`,hintIcon:`${Dw}__hint-icon`,radioButtonLabelWrapper:`${Dw}__radio-button-label-wrapper`};let yf=class extends vi{constructor(e,i){super(e,i),this.viewModel=null,this.visibleElements=new mae,this.sketchOptions=new w0,this.viewType=void 0,this._onTooltipsEnabledChange=r=>{this.sketchOptions.tooltips.enabled=r},this._onLabelsEnabledChange=r=>{this.sketchOptions.labels.enabled=r},this._onDirectionModeChange=r=>{this.sketchOptions.values.directionMode=r.target.selectedItem.value}}loadDependencies(){return Promise.all([zi({block:()=>ie(()=>import("./calcite-block-DOM6q34Z.js"),__vite__mapDeps([281,267,227,220,221,225,226,228,248,224,247,244,245,233,223,229,230,241,242,243,246,249,264,250])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),"radio-button":()=>ie(()=>import("./calcite-radio-button-CcS5x8sg.js"),__vite__mapDeps([279,242,220,219,221,222,223,224])),"radio-button-group":()=>ie(()=>import("./calcite-radio-button-group-DAXgLR4O.js"),__vite__mapDeps([280,227,220,224,253,229,255]))}),yae()])}render(){const{label:e,visibleElements:i}=this,r=this._renderContent();return N("div",{"aria-label":e,class:this.classes($$.base,Ee.widget)},r?N("calcite-block",{class:$$.block,heading:i.header?this.label:"",key:"content-block",open:!0},N("div",{class:$$.blockContent,key:"content"},r)):void 0)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:i}=this,r=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&i!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(Rt);return r.length===0?null:r}_renderTooltipsToggle(){const{messages:e,sketchOptions:i}=this;return N(Y2,{checked:i.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:i}=this;return N(Y2,{checked:i.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:i}=this,{directionMode:r}=i.values;return N("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,N("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:r,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",r,e.directionModeRelative),this._renderDirectionModeOption("absolute",r,e.directionModeAbsolute)))}_renderDirectionModeOption(e,i,r){return N("calcite-label",{key:e,layout:"inline",scale:"s"},N("calcite-radio-button",{checked:e===i,scale:"s",value:e}),N("div",{class:$$.radioButtonLabelWrapper,key:"label-wrapper"},N("calcite-icon",{icon:wNe[e],scale:"s"}),r))}};m([b()],yf.prototype,"label",null),m([b({type:mae,nonNullable:!0})],yf.prototype,"visibleElements",void 0),m([b(),vt("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],yf.prototype,"messages",void 0),m([b({nonNullable:!0,type:w0})],yf.prototype,"sketchOptions",void 0),m([b({type:String})],yf.prototype,"viewType",void 0),yf=m([G("esri.widgets.support.SketchTooltipControls")],yf);const _Ne=yf,gae={hide:"hide",hideChildren:"hide-children"},SNe=10,xNe=2;function $Ne({exclusive:t,visible:e,visibilityAppearance:i}){const r=i==="checkbox";return e?t?"circle-f":r?"check-square-f":"view-visible":t?"circle":r?"square":"view-hide"}function TNe({connectionStatus:t,publishing:e}){return t?t==="connected"?"beacon":"offline":e?"square":"bullet-point"}function ENe(t){return(t==null?void 0:t.listMode)===gae.hideChildren}function aI(t){return(t==null?void 0:t.listMode)??void 0}function INe(t){if(!t)return"inherited";const e=CNe(zF(t)?t.layer:t);return e!=null?e?"independent":"inherited":"visibilityMode"in t&&t.visibilityMode!=null?t.visibilityMode:"independent"}function jF(t){if(t&&(!("type"in t)||t.type!=="wmts"))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function MNe(t){const e=(t!=null&&t.layer&&zF(t.layer)?t.layer.layer:void 0)??(t==null?void 0:t.layer);return!!e&&e.type!=="catalog"&&(ANe(e)??!0)}function VF(t){return aI(t)!==gae.hide}function vae(t,e){t==null||t.sort((i,r)=>{const n="uid"in i?e.indexOf(i.uid):-1,o="uid"in r?e.indexOf(r.uid):-1;return n>o?-1:n<o?1:0})}function kNe(t,e){const i=t==null?void 0:t.layer;if(!i)return;const r=jF(i);if(!r)return;let n;r==="layers"&&"layers"in i?n=i.layers:r==="sublayers"&&"sublayers"in i&&(n=i.sublayers),vae(n,e)}function TB(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function zF(t){return t!=null&&"layer"in t&&t.layer!=null}function CNe(t){const e=bae(t);return e!=null&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function ANe(t){const e=bae(t);return e!=null&&"supportsDynamicLayers"in e?e.supportsDynamicLayers:void 0}function bae(t){return t&&"capabilities"in t&&t.capabilities!=null&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}function uc(t){return t==null?void 0:t["data-item"]}function EB(t){return t==null?void 0:t.getAttribute("data-layer-type")}function LNe({children:t,error:e,incompatible:i}){return!!(t!=null&&t.filter(r=>!r.hidden).length)&&!e&&!i}var e7;let mf=e7=class extends uS{constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new e7({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};m([b()],mf.prototype,"displayValueEnabled",void 0),m([b()],mf.prototype,"max",void 0),m([b()],mf.prototype,"min",void 0),m([b()],mf.prototype,"step",void 0),m([b()],mf.prototype,"value",void 0),mf=e7=m([G("esri.support.actions.ActionSlider")],mf);const ONe=mf;let ys=class extends nc(vi){constructor(e,i){super(e,i),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([ce(()=>this._canCreateLegend,()=>this._createLegend(),Qe),ce(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),Qe)])}destroy(){this._legend=ot(this._legend)}get _canCreateLegend(){const{content:e,listItem:i}=this;if(!i)return!1;const r="legend";return e===r||e!=null&&!!Array.isArray(e)&&e.includes(r)}get _legendOptions(){const{listItem:e,_legendLayerInfo:i}=this,r=e==null?void 0:e.view;return i&&r?{view:r,layerInfos:[i]}:{}}get _legendLayerInfo(){var u;const e=(u=this.listItem)==null?void 0:u.layer;if(!e||e.type==="subtype-sublayer")return null;const i=zF(e)?e:null,r=e==null?void 0:e.parent,n=r!=null&&"type"in r&&r.type==="map-image"?i==null?void 0:i.source:null,o="";return n&&r?{layer:r,title:o,sublayerIds:[n.mapLayerId]}:{layer:e,title:o}}get disabled(){var n;const{listItem:e,_legend:i,content:r}=this;return!e||!(Array.isArray(r)&&r.length>1)&&!!i&&(!((n=i.activeLayerInfos)!=null&&n.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,i=this._getFirstWidget();return this._get("icon")??(!e&&i?i.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){var e;return this._get("title")||(((e=this._getFirstWidget())==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return N("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:i,disabled:r,open:n}=this;return e&&!r&&n?e==="legend"&&i?N("div",{key:"legend-widget"},i.render()):typeof e=="string"?N("div",{innerHTML:e,key:e}):B2(e)?N("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?N("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:i}=this;return i?Array.isArray(e)?e.map(r=>this._renderContent(r)):this._renderContent(e):null}async _createLegend(){if(ot(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await ie(()=>Promise.resolve().then(()=>tze),void 0),i=new e(this._legendOptions);this._legend=i}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:B2(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(i=>this._getWidget(i)).find(i=>i):this._getWidget(e)}};m([b()],ys.prototype,"_legend",void 0),m([b()],ys.prototype,"_canCreateLegend",null),m([b()],ys.prototype,"_legendOptions",null),m([b()],ys.prototype,"_legendLayerInfo",null),m([b()],ys.prototype,"className",void 0),m([b()],ys.prototype,"content",void 0),m([b()],ys.prototype,"disabled",null),m([b()],ys.prototype,"flowEnabled",void 0),m([b()],ys.prototype,"icon",null),m([b()],ys.prototype,"image",void 0),m([b()],ys.prototype,"listItem",void 0),m([b()],ys.prototype,"open",void 0),m([b()],ys.prototype,"title",null),m([b()],ys.prototype,"visible",void 0),ys=m([G("esri.widgets.LayerList.ListItemPanel")],ys);const wae=ys;var n2;const PNe=Ie.ofType({key:"type",defaultKeyValue:"button",base:uS,typeMap:{button:LX,toggle:OX,slider:ONe}}),_ae=Ie.ofType(PNe),s4="layer",T$="child-list-mode",RNe="hide";let Ri=n2=class extends nc(Te){constructor(t){super(t),this.actionsSections=new _ae,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Ie.ofType(n2)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([ce(()=>{var t;return[this.layer,(t=this.layer)==null?void 0:t.listMode,this.listModeDisabled]},()=>this._watchLayerProperties(this.layer),Qe),ce(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),Qe),ce(()=>this.view,t=>this._updateChildrenView(t),Qe),ce(()=>this.panel,t=>this._setListItemOnPanel(t),Qe)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){var t;(t=this.panel)==null||t.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}get layerView(){const{layer:t,view:e}=this;if(!t||!e||t.type==="sublayer")return null;const i=t.type==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(r=>r.layer===i)??null}castPanel(t){var e;return(e=this.panel)!=null&&e.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new wae(t):null}get sortable(){var t;return((t=this.layer)==null?void 0:t.type)!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(t){this._set("sortable",t)}get title(){const t=Ks(this,"layer.layer");return(!t||t&&Ks(this,"layer.layer.loaded"))&&Ks(this,"layer.title")||Ks(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var i;const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&((i=t.publishingInfo)==null?void 0:i.status)==="publishing"}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:r}=this;return!r&&!e&&(t?t.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var t;return(t=this.layer)==null?void 0:t.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){var t;return((t=this.layerView)==null?void 0:t.visibleAtCurrentScale)??!0}get visibleAtCurrentTimeExtent(){var t;return((t=this.layerView)==null?void 0:t.visibleAtCurrentTimeExtent)??!0}get visibilityMode(){return INe(this.layer)}clone(){return new n2({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach(i=>i.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(i=>i.view=t)}_createChildren(t){const{listModeDisabled:e,children:i}=this,r=t.filter(n=>!i.some(o=>o.layer===n));i.addMany(this._createChildItems(r,e))}_destroyChildren(t){const{children:e}=this,i=e.filter(r=>!t.includes(r.layer));e.destroyMany(i)}_sortChildren(t){this.children.sort((e,i)=>t.indexOf(i.layer)-t.indexOf(e.layer))}_destroyAllChildren(){this.removeHandles(T$),this.children.destroyAll()}_watchChildLayerListMode(t){this.removeHandles(T$),this.listModeDisabled||this.addHandles(t.toArray().map(e=>ce(()=>e.listMode,()=>this._compileChildren(t))),T$)}_compileChildren(t){const e=this.listModeDisabled?t:t==null?void 0:t.filter(i=>aI(i)!==RNe);e!=null&&e.length?(this._createChildren(e),this._destroyChildren(e),this._sortChildren(e),this._watchChildLayerListMode(t)):this._destroyAllChildren()}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",()=>this._compileChildren(t)),s4)}_initializeChildLayers(t){this._compileChildren(t),this._watchSublayerChanges(t)}_createChildItems(t,e){return t.map(i=>e||VF(i)?new n2({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(Rt).reverse()}_watchLayerProperties(t){if(this.removeHandles(s4),this.removeHandles(T$),!t)return;if((!this.listModeDisabled&&aI(t))==="hide-children")return void this.children.destroyAll();const e=jF(t);e&&this.addHandles(ce(()=>t[e],i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)},Qe),s4)}};m([b({type:_ae})],Ri.prototype,"actionsSections",void 0),m([b()],Ri.prototype,"actionsOpen",void 0),m([b()],Ri.prototype,"checkPublishStatusEnabled",void 0),m([b({type:Ie})],Ri.prototype,"children",void 0),m([b()],Ri.prototype,"childrenSortable",void 0),m([b({readOnly:!0})],Ri.prototype,"connectionStatus",null),m([b({readOnly:!0})],Ri.prototype,"error",null),m([b()],Ri.prototype,"hidden",void 0),m([b({readOnly:!0})],Ri.prototype,"incompatible",null),m([b()],Ri.prototype,"layer",void 0),m([b({readOnly:!0})],Ri.prototype,"layerView",null),m([b()],Ri.prototype,"listItemCreatedFunction",void 0),m([b({nonNullable:!0})],Ri.prototype,"listModeDisabled",void 0),m([b()],Ri.prototype,"open",void 0),m([b({type:wae})],Ri.prototype,"panel",void 0),m([Dt("panel")],Ri.prototype,"castPanel",null),m([b()],Ri.prototype,"parent",void 0),m([b({value:!0})],Ri.prototype,"sortable",null),m([b()],Ri.prototype,"title",null),m([b({readOnly:!0})],Ri.prototype,"publishing",null),m([b({readOnly:!0})],Ri.prototype,"updating",null),m([b()],Ri.prototype,"view",void 0),m([b()],Ri.prototype,"visible",null),m([b({readOnly:!0})],Ri.prototype,"visibleAtCurrentScale",null),m([b({readOnly:!0})],Ri.prototype,"visibleAtCurrentTimeExtent",null),m([b({readOnly:!0})],Ri.prototype,"visibilityMode",null),Ri=n2=m([G("esri.widgets.LayerList.ListItem")],Ri);const QM=Ri,nu={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},FNe="hide",Sae=Ie.ofType(QM);let Vc=class extends Ar.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new Sae,this.view=null}initialize(){this.addHandles([ce(()=>{var e;return((e=this.view)==null?void 0:e.ready)===!0},()=>this._viewHandles(),Qe),ce(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList())],nu.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e!=null&&e.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,i){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:i})}moveListItem(e,i,r,n){var C,L;const o=e==null?void 0:e.layer;if(!o||o.type==="subtype-sublayer"||o.type==="sublayer")return;const u=(L=(C=this.view)==null?void 0:C.map)==null?void 0:L.layers,p=i?TB(i):u,g=r?TB(r):u;if(!p||!g)return;const{operationalItems:w}=this,S=(i==null?void 0:i.children)||w,T=(r==null?void 0:r.children)||w,E=g.length-n;e.parent=r||null,S.remove(e),p.remove(o),T.includes(e)||T.add(e,E),g.includes(o)||g.add(o,E),this._compileList()}_createLayerViewHandles(e){this.removeHandles(nu.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),nu.layerViews)}_createMapLayerHandles(e){this.removeHandles(nu.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),nu.mapLayers)}_createListItem(e){const{view:i,listItemCreatedFunction:r,checkPublishStatusEnabled:n,listModeDisabled:o}=this;return new QM({checkPublishStatusEnabled:n,listModeDisabled:o,layer:e,listItemCreatedFunction:r,view:i})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(i=>aI(i)!==FNe):void 0}_watchLayersListMode(e){this.removeHandles(nu.layerListMode),e&&!this.listModeDisabled&&this.addHandles(ce(()=>e.filter(i=>"listMode"in i).map(i=>i.listMode).toArray(),()=>this._compileList()),nu.layerListMode)}_compileList(){var r,n;const e=(n=(r=this.view)==null?void 0:r.map)==null?void 0:n.layers;this._watchLayersListMode(e);const i=this._getViewableLayers(e);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:i}=this;e.forEach(r=>{i.some(n=>n.layer===r)||i.add(this._createListItem(r))})}_removeItems(e){const{operationalItems:i}=this,r=[];i.forEach(n=>{n&&e&&e.includes(n.layer)||r.push(n)}),i.destroyMany(r)}_sortItems(e){const{operationalItems:i}=this;i.sort((r,n)=>{const o=e.indexOf(r.layer),u=e.indexOf(n.layer);return o>u?-1:o<u?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([nu.mapLayers,nu.layerViews,nu.viewLayers]),e!=null&&e.ready?this.addHandles([ce(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.allLayers},i=>this._createMapLayerHandles(i),Qe),ce(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),Qe)],nu.viewLayers):this._removeAllItems()}};m([b()],Vc.prototype,"checkPublishStatusEnabled",void 0),m([b()],Vc.prototype,"listItemCreatedFunction",void 0),m([b({nonNullable:!0})],Vc.prototype,"listModeDisabled",void 0),m([b({type:Sae})],Vc.prototype,"operationalItems",void 0),m([b({readOnly:!0})],Vc.prototype,"state",null),m([b()],Vc.prototype,"totalItems",null),m([b()],Vc.prototype,"view",void 0),Vc=m([G("esri.widgets.LayerList.LayerListViewModel")],Vc);const UF=Vc,GF=t=>NNe(t)||DNe(t),NNe=t=>{if(!("type"in t))return!1;switch(t.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},DNe=t=>{const e=jF(t);if(e!=null&&t.hasOwnProperty(e)&&t[e]!=null){for(const i of t[e])if(GF(i))return!0}return!1},w5=(t,e)=>e!=null&&t!=null&&(e.test(t.title)?"self":!!t.children.some(i=>w5(i,e)!==!1)&&"children");var t7;let gp=t7=class extends QM{constructor(t){super(t),this.children=new Ie,this.parent=null}get enabled(){const{children:t}=this;if(t.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let e=!1,i=!1;for(const r of t){if(r.enabled==="indeterminate")return r.enabled;if(r.enabled==="enabled"?e=!0:r.enabled==="disabled"&&(i=!0),i&&e)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(t=>[t.layer.id,...t.childLayerIds])}get featureSource(){const{layer:t,getFeatureSnappingSources:e}=this;return e().find(i=>i.layer===t)}_initializeChildLayers(t){if(!t)return;const e=t.filter(GF);super._initializeChildLayers(e)}_createChildItems(t){return t.map(e=>VF(e)?new t7({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(Rt).reverse()}};m([b()],gp.prototype,"enabled",null),m([b()],gp.prototype,"children",void 0),m([b()],gp.prototype,"childLayerIds",null),m([b()],gp.prototype,"featureSource",null),m([b({constructOnly:!0})],gp.prototype,"getFeatureSnappingSources",void 0),m([b()],gp.prototype,"parent",void 0),gp=t7=m([G("esri.widgets.support.SnappingControls.SnappingListItem")],gp);let Fy=class extends UF{constructor(){super(...arguments),this.featureSnappingSources=new Ie}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>{var i;return!((i=e.children)!=null&&i.length)})}_compileList(){var n,o;const e=(o=(n=this.view)==null?void 0:n.map)==null?void 0:o.layers;if(!e)return;const i=e.filter(GF);this._watchLayersListMode(i);const r=this._getViewableLayers(i);r!=null&&r.length?(this._createNewItems(r),this._removeItems(r),this._sortItems(r)):this._removeAllItems()}_createListItem(e){return new gp({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};m([b()],Fy.prototype,"featureSnappingSources",void 0),m([b()],Fy.prototype,"operationalItems",void 0),m([b()],Fy.prototype,"operationalItemsFlat",null),m([b()],Fy.prototype,"selectableItems",null),Fy=m([G("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],Fy);let zc=class extends Te{constructor(e){super(e),this.layerListViewModel=new Fy,this.snappingOptions=new rg,this.view=null}initialize(){this.addHandles([ce(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:i})=>{e.view=i},Qe),ce(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:i})=>{e.featureSnappingSources=i},Qe)])}get allLayersEnabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>i.enabled==="enabled")}get allLayersDisabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>!i.enabled)}get layersEnabledCount(){var e,i;return((i=(e=this.layerListViewModel)==null?void 0:e.selectableItems)==null?void 0:i.filter(r=>r.enabled==="enabled").length)??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,i){e==null||e.forEach(r=>i?this.enableSnappingForLayer(r):this.disableSnappingForLayer(r))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:{id:i}})=>{e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(e){const i=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);i&&(i.enabled=!0)}disableSnappingForLayer(e){const i=this._findSnappingSourceForLayer(e);i&&(i.enabled=!1)}updateEnabledFeatureSources(e){for(const i of this.snappingOptions.featureSources)VF(i.layer)&&(i.enabled=e.includes(i.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(i=>i.layer.id===e)}_makeSnappingSourceForLayer(e){var n;const i=(n=this.layerListViewModel.operationalItemsFlat.find(o=>o.layer.id===e))==null?void 0:n.layer;if(!i)throw new re("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if(i.type==="group")return;const r=new KM({layer:i});return this.snappingOptions.featureSources.add(r),r}};m([b()],zc.prototype,"allLayersEnabled",null),m([b()],zc.prototype,"allLayersDisabled",null),m([b({constructOnly:!0})],zc.prototype,"layerListViewModel",void 0),m([b()],zc.prototype,"layersEnabledCount",null),m([b({type:rg,nonNullable:!0})],zc.prototype,"snappingOptions",void 0),m([b()],zc.prototype,"state",null),m([b()],zc.prototype,"view",void 0),zc=m([G("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],zc);const jNe=zc,su="esri-snapping-controls",cc={base:su,container:`${su}__container`,item:`${su}__item`,toggleBlock:`${su}__toggle-block`,layerListBlock:`${su}__layer-list-block`,layerList:`${su}__layer-list`,layerListFilter:`${su}__layer-list__filter`,layerListButton:`${su}__layer-list__button`,layerListItem:`${su}__layer-list__item`,layerListGroup:`${su}__layer-list__group`,nestedContainer:`${su}__nested-container`};let jo=class extends vi{constructor(e,i){super(e,i),this._defaultViewModel=null,this._layerListFilter=null,this.layerListOpen=!0,this.messages=null,this.visibleElements=new DS,this._enableSnappingSwitchChange=u=>{this.snappingOptions.enabled=u},this._featureEnabledSwitchChange=u=>{this.snappingOptions.featureEnabled=u},this._selfEnabledSwitchChange=u=>{this.snappingOptions.selfEnabled=u},this._onToggleLayersButtonClick=u=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),requestAnimationFrame(()=>u.target.setFocus())};const{snappingOptions:r,view:n,viewModel:o}=e;this.viewModel=o??(this._defaultViewModel=new jNe({snappingOptions:r,view:n}))}normalizeCtorArgs(e){const{snappingOptions:i,view:r,viewModel:n,...o}=e;return o}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=ot(this._defaultViewModel))}loadDependencies(){return Promise.all([zi({block:()=>ie(()=>import("./calcite-block-DOM6q34Z.js"),__vite__mapDeps([281,267,227,220,221,225,226,228,248,224,247,244,245,233,223,229,230,241,242,243,246,249,264,250])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),input:()=>ie(()=>import("./calcite-input-Dl0Mk_X_.js"),__vite__mapDeps([251,252,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),checkbox:()=>ie(()=>import("./calcite-checkbox-UYHQBuOi.js"),__vite__mapDeps([341,220,219,221,226,222,223,224]))}),yae()])}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===e||(this._defaultViewModel=ot(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return N("div",{"aria-label":e,class:this.classes(cc.base,Ee.widget)},N("div",{class:cc.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList()]}_renderToggles(){const{visibleElements:e}=this,i=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null].filter(Rt),r=[e.enabledToggle?this._renderEnabledToggle():null,i.length>0?N("div",{class:cc.nestedContainer},i):null].filter(Rt);return r.length===0?null:N("calcite-block",{class:cc.toggleBlock,heading:e.header?this.label:"",key:"toggle-block",open:!0},r)}_renderEnabledToggle(){const{messages:e,viewModel:i}=this,{snappingOptions:r}=i;return N(Y2,{checked:r.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:e.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){const{messages:e,viewModel:i}=this,{snappingOptions:r}=i,n=r.enabled&&r.selfEnabled;return N(Y2,{checked:n,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:e.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){const{messages:e,viewModel:i}=this,{snappingOptions:r}=i,n=r.enabled&&r.featureEnabled;return N(Y2,{checked:n,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:e.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:i}=this,r=({target:{value:p}})=>{this._layerListFilter=p===""?null:new RegExp(p,"i")},n=i.layerListViewModel.operationalItems.length>9?N("calcite-input",{class:cc.layerListFilter,clearable:!0,placeholder:e==null?void 0:e.searchLayers,onCalciteInputInput:r}):null,o=this._secondaryElementsDisabled,u=this.layerListOpen&&!o;return N("calcite-block",{class:cc.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:e.snappingLayers,key:"list-block",open:u,onCalciteBlockToggle:p=>this.layerListOpen=p.target.open},n,this._renderToggleLayersButton(),N("calcite-list",{class:cc.layerList,selectionMode:"none"},this._renderLayerListItemCollection(i.layerListViewModel.operationalItems)))}_renderLayerListItemCollection(e){const i=this._layerListFilter;return e.map(r=>{switch(i?w5(r,i):null){case"children":{const n=r.children.filter(o=>w5(o,i)!==!1);return this._renderLayerListItemGroup(r,n)}case"self":case null:return this._renderLayerListItemOrGroup(r);case!1:return w5(r.parent,i)==="self"?this._renderLayerListItemOrGroup(r):null}}).toArray().filter(Rt)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:i}=this,r=e?i.disableAllLayers:i.enableAllLayers;return N("calcite-button",{appearance:"transparent",class:cc.layerListButton,label:r,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},r)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:i}}=this,r=e.title||i,n=()=>{this.viewModel.toggleSnappingForLayers([e.layer.id],e.enabled!=="enabled")};return N("calcite-list-item",{class:cc.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:r,onCalciteListItemSelect:o=>{o.stopPropagation(),n()}},N("calcite-checkbox",{checked:e.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:n}))}_renderLayerListItemGroup(e,i){const{children:r,title:n}=e,o=n||this.messages.untitledLayer,u=n&&n!==""?n:Fp(),p=!!(i!=null&&i.length),g=i??r,w=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,e.enabled!=="enabled")};return N("calcite-list-item",{class:cc.layerListGroup,key:u,label:o,open:p,onCalciteListItemSelect:S=>{S.stopPropagation(),w()}},N("calcite-checkbox",{checked:e.enabled==="enabled",indeterminate:e.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:w}),N("calcite-list",null,this._renderLayerListItemCollection(g)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};m([b()],jo.prototype,"_defaultViewModel",void 0),m([b()],jo.prototype,"_layerListFilter",void 0),m([b()],jo.prototype,"label",null),m([b({type:Boolean,nonNullable:!0})],jo.prototype,"layerListOpen",void 0),m([b(),vt("esri/widgets/support/SnappingControls/t9n/SnappingControls")],jo.prototype,"messages",void 0),m([b()],jo.prototype,"snappingOptions",null),m([b()],jo.prototype,"view",null),m([b()],jo.prototype,"viewModel",null),m([b({type:DS,nonNullable:!0})],jo.prototype,"visibleElements",void 0),m([b()],jo.prototype,"_enabledToggleDisabled",null),m([b()],jo.prototype,"_secondaryElementsDisabled",null),jo=m([G("esri.widgets.support.SnappingControls")],jo);const VNe=jo,zNe={settingsContainer:"esri-editor__settings"},UNe=()=>zi({accordion:()=>ie(()=>import("./calcite-accordion-KX8zrHgK.js"),__vite__mapDeps([342,227])),"accordion-item":()=>ie(()=>import("./calcite-accordion-item-DdVyXs_s.js"),__vite__mapDeps([343,267,227,220,223,224,229]))});function GNe({editorViewModel:t,messagesCommon:e,visibleElements:i}){const{snappingOptions:r,sketchOptions:n,view:o}=t,u=[],p={directionModePicker:i.directionModePicker,labelsToggle:i.labelsToggle,tooltipsToggle:i.tooltipsToggle};return zEe(p)&&u.push(N(_Ne,{sketchOptions:n,viewType:o==null?void 0:o.type,visibleElements:p})),i.snappingControls&&u.push(N(VNe,{afterCreate:g=>g.layerListOpen=!1,snappingOptions:r,view:o,visibleElements:i.snappingControlsElements??new DS})),u.length===0?null:N("calcite-accordion",{appearance:"transparent",class:zNe.settingsContainer,key:"settings"},N("calcite-accordion-item",{"data-testid":"settings",heading:e.settings,iconStart:"gear"},u))}const BNe={base:"esri-editor__panel-toolbar"},qNe=()=>Promise.all([zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230]))}),UNe()]);function HNe({editorViewModel:t,messagesCommon:e,visibleElements:i}){const{sketchViewModel:r}=t;return N("div",{class:BNe.base,key:"panel-toolbar"},N(GNe,{editorViewModel:t,messagesCommon:e,visibleElements:i}),i.undoRedoButtons?[N("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(r!=null&&r.canUndo()),iconStart:"undo",key:"undo-button",kind:"neutral",label:e.undo,onclick:()=>r==null?void 0:r.undo(),scale:"l"},e.undo),N("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(r!=null&&r.canRedo()),iconStart:"redo",key:"redo-button",kind:"neutral",label:e.redo,onclick:()=>r==null?void 0:r.redo(),scale:"l"},e.redo)]:null)}const WNe=()=>Promise.all([DF(),fae(),jS()]);function IB({editorViewModel:t,headingLevel:e,messages:i,messagesCommon:r,onDelete:n,onSave:o,renderAttachments:u,renderFeatureForm:p}){const{activeWorkflow:g,featureFormViewModel:w,syncing:S}=t;if(!g||!w)return null;const T=g.type,E="activeWorkflow"in g?g.activeWorkflow:void 0,C=E==null?void 0:E.type,L=E&&!E.hasPendingEdits||T==="update"&&!g.hasPendingEdits||S||w.updating,R=T==="update"&&C!=="create-features"?r.update:r.create,F=T==="create-features"&&g.createFeatureState==="create-new",V=T==="create-features"?g.numPendingFeatures:0,U=V>1?qn(i.createFeaturesTemplate,{numFeatures:V}):R,W=g.shouldShowAttachments&&!w.activeRelationshipInput,H=w.inputs.every(J=>!J.visible)&&!W?N(NF,{key:"panel-content-message"},qn(i.clickToFinishTemplate,{button:R})):N(Gv,{key:"panel-content-section"},N(bNe,{messages:i,workflow:g}),N(hNe,null,p(),W?N("div",{key:"attachments"},N(jl,{level:zv(e)},i.attachments),u()):null));return N(Jf,null,N(Uf,{key:"attribute-panel-content",showScrimOverlay:F},H),N(oI,{buttons:[{onClick:o,disabled:L,label:U},t.shouldShowDeleteButton?{appearance:"outline",onClick:n,disabled:S,kind:"danger",label:r.delete}:void 0]}))}const ld="upload-assets",_0=()=>new Error;let Nrt=class extends re{constructor(){super(`${ld}:unsupported`,"Layer does not support asset uploads.",_0())}},jrt=class extends re{constructor(){super(`${ld}:no-glb-support`,"Layer does not support glb.",_0())}},zrt=class extends re{constructor(){super(`${ld}:no-supported-source`,"No supported external source found",_0())}},Grt=class extends re{constructor(){super(`${ld}:not-base-64`,"Expected gltf data in base64 format after conversion.",_0())}},qrt=class extends re{constructor(){super(`${ld}:unable-to-prepare-options`,"Unable to prepare uploadAsset request options.",_0())}},Wrt=class extends re{constructor(e,i){super(`${ld}:bad-response`,`Bad response. Uploaded ${e} items and received ${i} results.`,_0())}},Zrt=class extends re{constructor(e,i){super(`${ld}-layer:upload-failed`,`Failed to upload mesh file ${e}. Error code: ${(i==null?void 0:i.code)??"-1"}. Error message: ${(i==null?void 0:i.messages)??"unknown"}`,_0())}},Yrt=class extends re{constructor(e){super(`${ld}-layer:unsupported-format`,`The service allowed us to upload an asset of FormatID ${e}, but it does not list it in its supported formats.`,_0())}},JNe=class extends re{constructor(){super(`${ld}:convert3D-failed`,"convert3D failed.")}},ZNe=class extends re{constructor(){super("invalid-input:no-model","No supported model found")}},KNe=class extends re{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}};const Mo="esri-editor__upload-details",Al={base:Mo,status:`${Mo}__status`,titleWrapper:`${Mo}__title-wrapper`,title:`${Mo}__title`,description:`${Mo}__description`,loader:`${Mo}__loader`,iconSuccess:`${Mo}__icon ${Mo}__icon--success`,iconError:`${Mo}__icon ${Mo}__icon--error`,fileList:`${Mo}__file-list`,file:`${Mo}__file`,fileIcon:`${Mo}__file-icon`,fileName:`${Mo}__file-name`},YNe=()=>Promise.all([zi({icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227]))}),DF(),jS()]);function XNe(t){const{messages:e,key:i,upload:r}=t;return N(Jf,null,N(Uf,{key:i??"upload-details"},N(Gv,null,QNe(t))),r.state==="error"?N(oI,{buttons:[{onClick:()=>r.retry(),label:e.modelUploads.error.uploadNew,iconStart:"upload-to"}],key:"upload-details-footer-actions"}):null)}function QNe(t){const e=eDe(t);return e?N("div",{class:Al.base,"data-testid":"upload-details",key:"upload-details-content"},N("div",{class:Al.status,key:"status"},e.iconContent,N("div",{class:Al.titleWrapper,key:"text"},N("div",{class:Al.title,key:"title"},e.title),N("div",{class:Al.description,key:"description"},e.description))),iDe(t.upload)):null}function eDe({helpMessage:t,messages:e,upload:i}){switch(i.state){case"pending":{const{title:r,description:n}=e.modelUploads.pending;return{title:r,description:n,iconContent:N("calcite-loader",{"aria-hidden":"true",class:Al.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*i.progress),i.progress===1?100:99)})}}case"success":{const{title:r}=e.modelUploads.success;return{title:r,description:t||e.helpMessages3d.mesh,iconContent:N("calcite-icon",{class:Uu(Al.iconSuccess),icon:"check",scale:"l"})}}case"error":{const{title:r}=e.modelUploads.error;return{title:r,description:tDe(i.error,e),iconContent:N("calcite-icon",{class:Uu(Al.iconError),icon:"exclamation-mark-circle",scale:"l"})}}default:return null}}function tDe(t,e){if(!t)return null;const i=e.modelUploads.error.messages;switch(t.constructor){case ZNe:return i.noModel;case KNe:return i.multipleModels;case JNe:return i.conversionFailed;default:return i.default}}function iDe(t){return N("div",{class:Al.fileList,key:"file-list"},t.files.map(e=>N("div",{class:Al.file,key:`file-${e.name}`},N("calcite-icon",{class:Al.fileIcon,icon:nDe(e),scale:"s"}),N("span",{class:Al.fileName},rDe(e.name)))))}function rDe(t){var e;return((e=t.split("/").pop())==null?void 0:e.split("\\").pop())??""}function nDe(t){var i;const e=(i=t.name.split(".").pop())==null?void 0:i.toLowerCase();return(e?oDe[e]:null)??sDe}const sDe="file",MB="file-shape",E$="file-image",oDe={glb:MB,gltf:MB,jpeg:E$,jpg:E$,png:E$,svg:E$,zip:"file-zip"};let Ti=class extends vi{constructor(e,i){super(e,i),this._featureForm=new iOe,this._attachments=new eLe({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._featureTemplates=new z7e({enableListScroll:!1,renderItemContentEnd:r=>r.supportsUpload?N("calcite-icon",{class:Ag.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):null,renderItemLabel:r=>r.label,renderCustomGroupContent:r=>this._renderCustomTemplateGroupContent(r)}),this._filterText="",this._prompt=null,this._spinner=new G7e,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.messagesTemplates=null,this.supportingWidgetDefaults=null,this.viewModel=new cNe,this.visibleElements=new dae,this._renderSelectIcon=()=>N("calcite-icon",{icon:"cursor",slot:"content-start"}),this.EditorPanel=({heading:r,key:n},...o)=>{const{visibleElements:u}=this;return N("calcite-flow-item",{closable:!1,heading:r,headingLevel:this.headingLevel,key:n,loading:this._loading,onCalciteFlowItemBack:this._onBack},u.settingsMenu?N(HNe,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:u}):null,...o)},this._showDiscardEditsPrompt=()=>{var o;const{messages:r,activeWorkflow:n}=this;return(n==null?void 0:n.type)==="create-features"&&K2(n.data.creationInfo)?this._showPromptAndWait(((o=n.data.upload)==null?void 0:o.state)==="success"?r.modelUploads.cancelPlacementPrompt:r.modelUploads.cancelUploadPrompt):this._showPromptAndWait({title:r.cancelEditTitle,message:r.cancelEditWarningMessage,yesLabel:r.discardEdits,noLabel:r.continueEditing})},this._showGenericCancelPrompt=()=>{const{messages:r,messagesCommon:n}=this;return this._showPromptAndWait({title:r.cancelRequestTitle,message:r.cancelRequestWarningMessage,yesLabel:n.form.yes,noLabel:n.form.no})},this._showPrompt=r=>{var n,o;(o=(n=this._prompt)==null?void 0:n.cancel)==null||o.call(n),this._prompt=r},this._clearPrompt=()=>{this._prompt=null},this._onSave=()=>{this.viewModel.saveWorkflow()},this._onDelete=()=>{const{messages:r,messagesCommon:n}=this;this._showPrompt({title:r.deleteWarningTitle,message:r.deleteWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:()=>{this.deleteFeatureFromWorkflow(),this._clearPrompt()}},secondary:{label:r.keepFeature,action:this._clearPrompt}}})},this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow(),this._onBack=r=>(r==null||r.stopPropagation(),this.viewModel.back()),this._onAttachmentAdd=()=>{var n;const{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"||r.type==="update"&&((n=r.activeWorkflow)==null?void 0:n.type)==="create-features"?(this._attachments.addFile(),r.back()):this._attachments.addAttachment().then(()=>r.back()))},this._onAttachmentUpdate=()=>{const{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"?(this._attachments.updateFile(),r.back()):this._attachments.updateAttachment().then(()=>r.back()))},this._onAttachmentDelete=()=>{const{messages:r,messagesCommon:n}=this;this._showPrompt({title:r.deleteAttachmentWarningTitle,message:r.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:r.keepAttachment,action:this._clearPrompt}}})},this._onAttachmentDeleteConfirm=async()=>{const r=this._attachments,{activeWorkflow:n}=this.viewModel;n&&(n.type==="create-features"?r.deleteFile():(await r.deleteAttachment(r.viewModel.activeAttachmentInfo),this._clearPrompt()),await n.back(),this._clearPrompt())},this._onAttachmentsError=r=>{this._showPrompt({title:this.messages.errorWarningTitle,message:r.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}})}}initialize(){this._featureForm.showPrompt=this._showPrompt,this._featureForm.clearPrompt=this._clearPrompt,this.addHandles([ce(()=>zv(this.headingLevel),e=>{this._featureForm.headingLevel=e,this._featureTemplates.headingLevel=e},Qe),gi(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:e})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(i=>i?e.allow():e.deny())}),Fr(()=>this.viewModel.featureFormViewModel,e=>{this._featureForm.viewModel=e},Qe),ce(()=>this.viewModel,e=>{this._attachments.viewModel=(e==null?void 0:e.attachmentsViewModel)??null,this._featureTemplates.viewModel=(e==null?void 0:e.featureTemplatesViewModel)??null,this._spinner.viewModel=(e==null?void 0:e.spinnerViewModel)??null,e.showDiscardEditsPrompt=this._showDiscardEditsPrompt},Qe),ce(()=>this.view,(e,i)=>{const r=`editor-${this.id}-spinner`;i==null||i.ui.remove(this._spinner,r),e==null||e.ui.add(this._spinner,{key:r,position:"manual"})},Qe),ce(()=>[this.supportingWidgetDefaults,this.viewModel.sketchViewModel],([e])=>{var i;e&&(this._featureForm.set(e.featureForm),this._attachments.set(e.attachments),this._featureTemplates.set(e.featureTemplates),(i=this.viewModel.sketchViewModel)==null||i.set(e.sketch))},Qe),Fr(()=>{var e;return(e=this._attachments)==null?void 0:e.error},e=>this._onAttachmentsError(e)),Fr(()=>{var e;return(e=this.viewModel)==null?void 0:e.failures},e=>{const{messages:i}=this,[{error:r,retry:n,cancel:o}]=e;this._showPrompt({title:i.errorWarningTitle,message:qn(i.errorWarningMessageTemplate,{errorMessage:r.message}),context:"warning",actions:{primary:{label:i.retry,action:()=>{n(),this._clearPrompt()}},secondary:{label:i.ignore,action:()=>{o(),this._clearPrompt()}}}})}),ce(()=>{var e;return(e=this.viewModel)==null?void 0:e.state},e=>{switch(e){case"awaiting-feature-to-update":case"ready":case"disabled":this._filterText="",this._featureTemplates.filterText=""}}),ce(()=>this.viewModel.featureFormDisabled,e=>this._featureForm.disabled=e)])}destroy(){this._attachments.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy()}loadDependencies(){return Promise.all([zi({"flow-item":()=>ie(()=>import("./calcite-flow-item-BieRNoUa.js"),__vite__mapDeps([239,220,221,224,225,226,227,228,240,241,242,233,223,229,230,243,244,245,246,247,248,249,250])),flow:()=>ie(()=>import("./calcite-flow-CExHLkC9.js"),__vite__mapDeps([238,227,224])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250]))}),pNe(),fNe(),DF(),fae(),jS(),qNe(),tLe(),WNe(),YNe()])}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}get _loading(){const{viewModel:e}=this;return e.syncing||e.updating||this._attachments.submitting}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(e){wo(fe.getLogger(this),"allowedWorkflows",{replacement:"visibleElements",version:"4.29",warnOnce:!0}),this.viewModel.allowedWorkflows=e}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(e){this.viewModel.hideTemplatesForInactiveLayers=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureCreation(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}startCreateFeaturesWorkflowAtFeatureEdit(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(e)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}startUpdateWorkflowAtFeatureEdit(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(e){return this.viewModel.cancelWorkflow(e)}render(){const{viewModel:e}=this,i=this.classes(Ag.base,Ee.widget,Ee.panel);return e?N("div",{class:i,key:"base"},N("calcite-flow",{key:"flow"},e.pageStack.map(r=>this._renderPage(r))),this._prompt?N(tse,{...this._prompt,headingLevel:this.headingLevel}):void 0):N("div",{class:i,key:"empty"})}_renderPage(e){switch(e){case"disabled":break;case"ready":return this._renderReady();case"awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo();case"creating-features-upload-details":return this._renderUploadDetails();case"creating-features":return this._renderCreatingFeatures();case"editing-existing-feature":case"editing-attributes":return this._renderUpdateFeature();case"awaiting-update-feature-candidate":return this._renderFeatureList();case"adding-attachment":return this._renderAttachmentAdding();case"editing-attachment":return this._renderAttachmentEditing()}return N("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(){const{EditorPanel:e,messages:i}=this;return N(e,{heading:i.selectTemplate,key:"templates-panel"},N(Uf,{key:"feature-templates"},N(Gv,null,this._featureTemplates.render())))}_renderUploadDetails(){const{EditorPanel:e,activeWorkflow:i,messages:r}=this;if((i==null?void 0:i.type)!=="create-features")return null;const n=i.data.upload;return n?N(e,{heading:r.createFeatures,key:"upload-details-panel"},N(XNe,{helpMessage:this._helpMessage,messages:r,upload:n})):null}_renderCreatingFeatures(){var g,w;const{EditorPanel:e,activeWorkflow:i,messages:r,messagesCommon:n,headingLevel:o,viewModel:u}=this;if(!i)return null;const p=i.type==="create-features"&&i.numPendingFeatures>0||i.type==="update"&&((g=i==null?void 0:i.activeWorkflow)==null?void 0:g.type)==="create-features"&&((w=i.activeWorkflow)==null?void 0:w.numPendingFeatures)>0;return N(e,{heading:r.createFeatures,key:"create-features-panel"},p?N(IB,{editorViewModel:u,headingLevel:o,messages:r,messagesCommon:n,renderAttachments:()=>this._attachments.render(),renderFeatureForm:()=>this._featureForm.render(),onDelete:this._onDelete,onSave:this._onSave}):N(dNe,{helpMessage:this._helpMessage}))}_renderUpdateFeature(){const{EditorPanel:e,messages:i,messagesCommon:r,headingLevel:n,viewModel:o}=this;return N(e,{heading:i.editFeature,key:"update-feature-panel"},N(IB,{editorViewModel:o,headingLevel:n,messages:i,messagesCommon:r,renderAttachments:()=>this._attachments.render(),renderFeatureForm:()=>this._featureForm.render(),onDelete:this._onDelete,onSave:this._onSave}))}_renderCustomTemplateGroupContent(e){const{messages:i,viewModel:r}=this,n=Qv(e.group.items,o=>r.itemHasInvalidFormTemplate(o)?i.formFieldCreateError:void 0);return n?N(QO,{icon:BR,message:n}):null}_renderAttachmentAdding(){const{EditorPanel:e,_attachments:i,messages:r,messagesCommon:n}=this;return N(e,{heading:r.addAttachment,key:"attachment-adding-panel"},N(Uf,{key:"attachments"},i.render()),N(oI,{buttons:[{label:i.submitting?n.cancel:n.add,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentAdd}]}))}_renderAttachmentEditing(){const{EditorPanel:e,_attachments:i,activeWorkflow:r,messages:n,messagesCommon:o}=this;return r?N(e,{heading:n.editAttachment,key:"attachment-editing-panel"},N(Uf,{key:"attachments"},i.render()),r.shouldAllowAttachmentEditing?N(oI,{buttons:[{label:o.update,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,onClick:this._onAttachmentDelete,disabled:i.submitting,label:o.delete}]}):void 0):null}_renderReady(){const{EditorPanel:e,messages:i,viewModel:r,visibleElements:n}=this,o=this._helpMessage;return N(e,{heading:i.widgetLabel,key:"landing-panel"},N(Uf,{key:"landing-content"},r.editorItems.length?[n.editFeaturesSection?N(Gv,{key:"edit-actions"},this._renderUpdateActions()):null,n.createFeaturesSection&&r.canCreateVisible?N(Gv,{key:"create-actions"},this._renderCreateActions()):null]:N(NF,{key:"no-content"},i.noEditableLayers)),o?N("div",{class:Ag.helpMessage,key:"footer-actions",slot:"footer"},o):void 0)}get _helpMessage(){var o;const{activeWorkflow:e,messages:i,view:r}=this,n=e==null?void 0:e.helpMessage;return n?(o=i[(r==null?void 0:r.type)==="3d"?"helpMessages3d":"helpMessages2d"])==null?void 0:o[n]:void 0}_renderUpdateActions(){var o;const{messages:e,messagesCommon:i,viewModel:r}=this,n={id:"select",label:i.select};return N("div",{class:Ag.updateActions,key:"update-actions"},N(jl,{level:zv(this.headingLevel)},e.editFeatures),N("calcite-list",{class:Ag.updateActionsList,selectionAppearance:"border",selectionMode:"single"},iF({disabled:!r.canUpdateVisible,grouped:!1,item:n,selectedItem:((o=r.activeWorkflow)==null?void 0:o.stepId)==="awaiting-feature-to-update"?n:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return N("div",{key:"create-actions"},N(jl,{level:zv(this.headingLevel)},this.messages.createFeatures),N("div",{class:Ag.featureTemplatesContainer,key:"templates"},this._featureTemplates.render()))}_renderFeatureList(){const{EditorPanel:e,viewModel:i}=this,{activeWorkflow:r}=i;if((r==null?void 0:r.type)!=="update")return null;const n=r.data.candidates,o=qn(this.messages.multipleFeaturesTemplate,{total:n.length});return N(e,{heading:o,key:"feature-list"},N(yNe,{editorItems:i.editorItems,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:r,onFilterTextChange:u=>this._filterText=u,onSelectFeature:(u,p)=>i.selectFeature(u,p)}))}_showPromptAndWait({title:e,message:i,yesLabel:r,noLabel:n}){const o=os(),{view:u}=this,p=u==null?void 0:u.focused;return this._showPrompt({title:e,message:i,context:"danger",actions:{primary:{label:r,action:()=>o.resolve(!0)},secondary:{label:n,action:()=>o.resolve(!1)}}}),o.promise.finally(()=>{this._clearPrompt(),p&&(u==null||u.focus())})}};m([b()],Ti.prototype,"_featureForm",void 0),m([b()],Ti.prototype,"_attachments",void 0),m([b()],Ti.prototype,"_featureTemplates",void 0),m([b()],Ti.prototype,"_filterText",void 0),m([b()],Ti.prototype,"_prompt",void 0),m([b()],Ti.prototype,"_spinner",void 0),m([b()],Ti.prototype,"_deleteButtonCommonInfo",null),m([b()],Ti.prototype,"_loading",null),m([b({readOnly:!0})],Ti.prototype,"activeWorkflow",null),m([b()],Ti.prototype,"allowedWorkflows",null),m([b()],Ti.prototype,"headingLevel",void 0),m([b()],Ti.prototype,"hideTemplatesForInactiveLayers",null),m([b()],Ti.prototype,"icon",null),m([b()],Ti.prototype,"label",null),m([b()],Ti.prototype,"labelOptions",null),m([b()],Ti.prototype,"layerInfos",null),m([b(),vt("esri/widgets/Editor/t9n/Editor")],Ti.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Ti.prototype,"messagesCommon",void 0),m([b(),vt("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Ti.prototype,"messagesTemplates",void 0),m([b()],Ti.prototype,"snappingOptions",null),m([b()],Ti.prototype,"tooltipOptions",null),m([b()],Ti.prototype,"supportingWidgetDefaults",void 0),m([b({type:RM,nonNullable:!0})],Ti.prototype,"valueOptions",null),m([b()],Ti.prototype,"view",null),m([b(),v0(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],Ti.prototype,"viewModel",void 0),m([b({type:dae,nonNullable:!0})],Ti.prototype,"visibleElements",void 0),m([b()],Ti.prototype,"_helpMessage",null),Ti=m([G("esri.widgets.Editor")],Ti);const aDe=Ti,lI=new et({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),_5=lI.fromJSON.bind(lI),xae=lI.toJSON.bind(lI);let Uc=class extends Te{constructor(e){super(e),this.state="pending",this.url=""}initialize(){this.addHandles(ce(()=>[this.extension,this.name],()=>this._setFormattedFileName(),Qe))}_setFormattedFileName(){this.name&&this.extension&&(this.formattedName=this.count?`${this.name}(${this.count})${this.extension}`:`${this.name}.${this.extension}`)}};m([b()],Uc.prototype,"count",void 0),m([b()],Uc.prototype,"error",void 0),m([b()],Uc.prototype,"extension",void 0),m([b()],Uc.prototype,"formattedName",void 0),m([b()],Uc.prototype,"name",void 0),m([b()],Uc.prototype,"state",void 0),m([b()],Uc.prototype,"url",void 0),Uc=m([G("esri.widgets.Print.FileLink")],Uc);const $ae=Uc;var i7;let Gc=i7=class extends Te{constructor(t){super(t),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnColumnName=!1,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}static from(t){return J3(i7,t)}};m([b({type:Ge})],Gc.prototype,"outSpatialReference",void 0),m([b({type:jt})],Gc.prototype,"processExtent",void 0),m([b({type:Ge})],Gc.prototype,"processSpatialReference",void 0),m([b({nonNullable:!0})],Gc.prototype,"returnColumnName",void 0),m([b({nonNullable:!0})],Gc.prototype,"returnFeatureCollection",void 0),m([b({nonNullable:!0})],Gc.prototype,"returnM",void 0),m([b({nonNullable:!0})],Gc.prototype,"returnZ",void 0),Gc=i7=m([G("esri.rest.geoprocessor.GPOptions")],Gc);const BF=Gc;let Eu=class extends ye{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};m([b({type:jt})],Eu.prototype,"extent",void 0),m([b()],Eu.prototype,"height",void 0),m([b()],Eu.prototype,"href",void 0),m([b()],Eu.prototype,"opacity",void 0),m([b()],Eu.prototype,"rotation",void 0),m([b()],Eu.prototype,"scale",void 0),m([b()],Eu.prototype,"visible",void 0),m([b()],Eu.prototype,"width",void 0),Eu=m([G("esri.layers.support.MapImage")],Eu);const lDe=Eu,Tae={esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriUnknownUnits:"unknown",esriYards:"yards"},snt=dt()(Tae),uDe=dt()({...Tae,esriIntFeet:"international-feet",esriIntInches:"international-inches",esriIntMiles:"international-miles",esriIntNauticalMiles:"international-nautical-miles",esriIntYards:"international-yards"}),cDe=dt()({esriAcres:"international-acres",esriAcresUS:"us-acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-international-feet",esriSquareFeetUS:"square-us-feet",esriSquareInches:"square-international-inches",esriSquareInchesUS:"square-us-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-international-miles",esriSquareMilesUS:"square-us-miles",esriSquareMillimeters:"square-millimeters",esriSquareYards:"square-international-yards",esriSquareYardsUS:"square-us-yards",esriUnknownAreaUnits:"unknown"}),ont=dt()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"});dt()({esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds"});const ant=dt()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards",esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds",esriNAUKilometersPerHour:"kilometers-per-hour",esriNAUMilesPerHour:"miles-per-hour",esriNAUUnknown:"unknown"}),lnt=dt()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTFeatureSets:"featuresets",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),unt=dt()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"});dt()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"});const cnt=dt()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"});dt()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"});dt()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"});const hnt=dt()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"}),pnt=dt()({0:"either-side-of-vehicle",1:"right-side-of-vehicle",2:"left-side-of-vehicle",3:"no-u-turn"},{useNumericKeys:!0}),dnt=dt()({0:"stop",1:"waypoint",2:"break"},{useNumericKeys:!0}),fnt=dt()({0:"ok",1:"not-located",2:"network-element-not-located",3:"element-not-traversable",4:"invalid-field-values",5:"not-reached",6:"time-window-violation",7:"not-located-on-closest"},{useNumericKeys:!0}),ynt=dt()({1:"right",2:"left"},{useNumericKeys:!0}),mnt=dt()({0:"restriction",1:"scaled-cost",2:"added-cost"},{useNumericKeys:!0}),gnt=dt()({0:"permit",1:"restrict"},{useNumericKeys:!0}),vnt=dt()({1:"header",50:"arrive",51:"depart",52:"straight",100:"on-ferry",101:"off-ferry",102:"central-fork",103:"roundabout",104:"u-turn",150:"door",151:"stairs",152:"elevator",153:"escalator",154:"pedestrian-ramp",200:"left-fork",201:"left-ramp",202:"clockwise-roundabout",203:"left-handed-u-turn",204:"bear-left",205:"left-turn",206:"sharp-left",207:"left-turn-and-immediate-left-turn",208:"left-turn-and-immediate-right-turn",300:"right-fork",301:"right-ramp",302:"counter-clockwise-roundabout",303:"right-handed-u-turn",304:"bear-right",305:"right-turn",306:"sharp-right",307:"right-turn-and-immediate-left-turn",308:"right-turn-and-immediate-right-turn",400:"up-elevator",401:"up-escalator",402:"up-stairs",500:"down-elevator",501:"down-escalator",502:"down-stairs",1e3:"general-event",1001:"landmark",1002:"time-zone-change",1003:"traffic-event",1004:"scaled-cost-barrier-event",1005:"boundary-crossing",1006:"restriction-violation",1007:"lane"},{useNumericKeys:!0}),bnt=dt()({0:"unknown",1:"segment",2:"maneuver-segment",3:"restriction-violation",4:"scaled-cost-barrier",5:"heavy-traffic",6:"slow-traffic",7:"moderate-traffic"},{useNumericKeys:!0}),wnt=dt()({"NA Campus":"campus","NA Desktop":"desktop","NA Navigation":"navigation"}),_nt=dt()({Kilometers:"kilometers",Miles:"miles",Meters:"meters"},{ignoreUnknown:!1}),Snt=dt()({Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),xnt=dt()({Kilometers:"kilometers",Miles:"miles",Meters:"meters",Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),$nt=dt()({"Any Hazmat Prohibited":"any-hazmat-prohibited","Avoid Carpool Roads":"avoid-carpool-roads","Avoid Express Lanes":"avoid-express-lanes","Avoid Ferries":"avoid-ferries","Avoid Gates":"avoid-gates","Avoid Limited Access Roads":"avoid-limited-access-roads","Avoid Private Roads":"avoid-private-roads","Avoid Roads Unsuitable for Pedestrians":"avoid-roads-unsuitable-for-pedestrians","Avoid Stairways":"avoid-stairways","Avoid Toll Roads":"avoid-toll-roads","Avoid Toll Roads for Trucks":"avoid-toll-roads-for-trucks","Avoid Truck Restricted Roads":"avoid-truck-restricted-roads","Avoid Unpaved Roads":"avoid-unpaved-roads","Axle Count Restriction":"axle-count-restriction","Driving a Bus":"driving-a-bus","Driving a Taxi":"driving-a-taxi","Driving a Truck":"driving-a-truck","Driving an Automobile":"driving-an-automobile","Driving an Emergency Vehicle":"driving-an-emergency-vehicle","Height Restriction":"height-restriction","Kingpin to Rear Axle Length Restriction":"kingpin-to-rear-axle-length-restriction","Length Restriction":"length-restriction","Preferred for Pedestrians":"preferred-for-pedestrians","Riding a Motorcycle":"riding-a-motorcycle","Roads Under Construction Prohibited":"roads-under-construction-prohibited","Semi or Tractor with One or More Trailers Prohibited":"semi-or-tractor-with-one-or-more-trailers-prohibited","Single Axle Vehicles Prohibited":"single-axle-vehicles-prohibited","Tandem Axle Vehicles Prohibited":"tandem-axle-vehicles-prohibited","Through Traffic Prohibited":"through-traffic-prohibited","Truck with Trailers Restriction":"truck-with-trailers-restriction","Use Preferred Hazmat Routes":"use-preferred-hazmat-routes","Use Preferred Truck Routes":"use-preferred-truck-routes",Walking:"walking","Weight Restriction":"weight-restriction"},{ignoreUnknown:!1}),Tnt=dt()({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),Ent=dt()({esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"envelope",esriGeometryMultipoint:"multipoint"}),Int=dt()({esriNAUTCost:"cost",esriNAUTDescriptor:"descriptor",esriNAUTRestriction:"restriction",esriNAUTHierarchy:"hierarchy"}),Mnt=dt()({esriDSTAltName:"alt-name",esriDSTArrive:"arrive",esriDSTBranch:"branch",esriDSTCrossStreet:"cross-street",esriDSTCumulativeLength:"cumulative-length",esriDSTDepart:"depart",esriDSTEstimatedArrivalTime:"estimated-arrival-time",esriDSTExit:"exit",esriDSTGeneral:"general",esriDSTLength:"length",esriDSTServiceTime:"service-time",esriDSTStreetName:"street-name",esriDSTSummary:"summary",esriDSTTime:"time",esriDSTTimeWindow:"time-window",esriDSTToward:"toward",esriDSTViolationTime:"violation-time",esriDSTWaitTime:"wait-time"});let s2=class extends ye{constructor(e){super(e),this.area=0,this.units=null}};m([b({json:{write:!0}})],s2.prototype,"area",void 0),m([ze(cDe)],s2.prototype,"units",void 0),s2=m([G("esri.rest.support.ArealUnit")],s2);const hDe=s2;let o2=class extends ye{constructor(e){super(e),this.itemId=null,this.url=null}};m([b({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],o2.prototype,"itemId",void 0),m([b({type:String,json:{write:!0}})],o2.prototype,"url",void 0),o2=m([G("esri.rest.support.DataFile")],o2);const o4=o2;let a2=class extends ye{constructor(e){super(e),this.distance=0,this.units=null}};m([b({json:{write:!0}})],a2.prototype,"distance",void 0),m([ze(uDe)],a2.prototype,"units",void 0),a2=m([G("esri.rest.support.LinearUnit")],a2);const pDe=a2,Bs="multi-value-",qF=new et({GPArealUnit:"areal-unit",GPBoolean:"boolean",GPComposite:"composite",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",Field:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string",GPValueTable:"value-table","GPMultiValue:GPArealUnit":`${Bs}areal-unit`,"GPMultiValue:GPBoolean":`${Bs}boolean`,"GPMultiValue:GPComposite":`${Bs}composite`,"GPMultiValue:GPDataFile":`${Bs}data-file`,"GPMultiValue:GPDate":`${Bs}date`,"GPMultiValue:GPDouble":`${Bs}double`,"GPMultiValue:GPFeatureRecordSetLayer":`${Bs}feature-record-set-layer`,"GPMultiValue:Field":`${Bs}field`,"GPMultiValue:GPLinearUnit":`${Bs}linear-unit`,"GPMultiValue:GPLong":`${Bs}long`,"GPMultiValue:GPRasterData":`${Bs}raster-data`,"GPMultiValue:GPRasterDataLayer":`${Bs}raster-data-layer`,"GPMultiValue:GPRecordSet":`${Bs}record-set`,"GPMultiValue:GPString":`${Bs}string`});let J1=class extends ye{constructor(e){super(e),this.dataType=null,this.paramName=null,this.value=null}};m([ze(qF,{ignoreUnknown:!1})],J1.prototype,"dataType",void 0),m([b()],J1.prototype,"paramName",void 0),m([b()],J1.prototype,"value",void 0),J1=m([G("esri.rest.support.ParameterValue")],J1);const dDe=J1;let Z1=class extends ye{constructor(e){super(e),this.format=null,this.itemId=null,this.url=null}};m([b()],Z1.prototype,"format",void 0),m([b({json:{read:{source:"itemID"},write:{target:"itemID"}}})],Z1.prototype,"itemId",void 0),m([b()],Z1.prototype,"url",void 0),Z1=m([G("esri.rest.support.RasterData")],Z1);const fDe=Z1;async function Eae(t,e,i,r,n){const o={},u={},p=[];return yDe(r,p,o),tre(p).then(g=>{const{outSpatialReference:w,processExtent:S,processSpatialReference:T,returnColumnName:E,returnFeatureCollection:C,returnM:L,returnZ:R}=i,{path:F}=Du(t);for(const X in o){const[te,oe]=o[X];u[X]=g.slice(te,oe)}const V=w?w.wkid||w:null,U=T?T.wkid||T:null,W=e==="execute"?{returnColumnName:E||void 0,returnFeatureCollection:C||void 0,returnM:L||void 0,returnZ:R||void 0}:null,H=uI({...S?{context:{extent:S,outSR:V,processSR:U}}:{"env:outSR":V,"env:processSR":U},...r,...W,f:"json"},null,u),J={...n,query:H};return nt(`${F}/${e}`,J)})}function yDe(t,e,i){for(const r in t){const n=t[r];if(n&&typeof n=="object"&&n instanceof gb){const{features:o}=n;i[r]=[e.length,e.length+o.length],o.forEach(u=>{e.push(u.geometry)})}}}async function r7(t,e){switch(t){case"areal-unit":return hDe.fromJSON(e);case"boolean":case"double":case"long":case"string":case"value-table":return e;case"date":return new Date(e);case"data-file":return o4.fromJSON(e);case"linear-unit":return pDe.fromJSON(e);case"feature-record-set-layer":if("url"in e)return o4.fromJSON(e);if("layerDefinition"in e){const i=new(await ie(async()=>{const{default:o}=await Promise.resolve().then(()=>kTe);return{default:o}},void 0)).default,{layerDefinition:r,featureSet:n}=e;return i.read({layerDefinition:r,featureSet:n},{origin:"portal-item"}),i.spatialReference=Ge.fromJSON(n.spatialReference??r.spatialReference??r.extent.spatialReference),i}return gb.fromJSON(e);case"record-set":return"url"in e?o4.fromJSON(e):gb.fromJSON(e);case"raster-data":case"raster-data-layer":return"mapImage"in e?lDe.fromJSON(e.mapImage):fDe.fromJSON(e);case"field":return dM.fromJSON(e)}}function mDe(t){return t.startsWith(Bs)}function gDe(t){return t.replace(Bs,"")}async function vDe(t,e){const i=gDe(t),r=i==="composite"?e.map(n=>r7(qF.fromJSON(n.dataType),n.value)):e.map(n=>r7(i,n));return Promise.all(r)}async function n7(t){const e=qF.fromJSON(t.dataType),{paramName:i}=t,r=mDe(e)?await vDe(e,t.value):await r7(e,t.value);return new dDe({dataType:e,paramName:i,value:r})}function uI(t,e,i){for(const r in t){const n=t[r];Array.isArray(n)?t[r]=JSON.stringify(n.map(o=>uI({item:o},!0).item)):n instanceof Date&&(t[r]=n.getTime())}return $S(t,e,i)}const kB=new et({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let l2=class extends ye{constructor(e){super(e),this.description=null,this.type=null}};m([b({type:String,json:{write:!0}})],l2.prototype,"description",void 0),m([b({type:String,json:{read:kB.read,write:kB.write}})],l2.prototype,"type",void 0),l2=m([G("esri.rest.support.GPMessage")],l2);const Iae=l2;async function Mae(t,e,i,r){return i=BF.from(i||{}),Eae(t,"execute",i,e??{},r).then(async({data:n})=>{var o,u;return{results:await Promise.all(((o=n.results)==null?void 0:o.map(n7))??[]),messages:((u=n.messages)==null?void 0:u.map(p=>Iae.fromJSON(p)))??[]}})}var S5;const bDe=dt()({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"},{ignoreUnknown:!1});let vp=S5=class extends ye{constructor(t){super(t),this.jobId=null,this.jobStatus=null,this.messages=null,this.progress=null,this.requestOptions=null,this.sourceUrl=null,this._timer=void 0}async cancelJob(t){const{jobId:e,sourceUrl:i}=this,{path:r}=Du(i),n={...this.requestOptions,...t,query:{f:"json"}};this._clearTimer();const o=`${r}/jobs/${e}/cancel`,{data:u}=await nt(o,n),{messages:p,jobStatus:g,progress:w}=S5.fromJSON(u);return this.set({messages:p,jobStatus:g,progress:w}),this}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const{path:e}=Du(this.sourceUrl),i={...this.requestOptions,...t,query:{f:"json"}},r=`${e}/jobs/${this.jobId}`,{data:n}=await nt(r,i),{messages:o,jobStatus:u,progress:p}=S5.fromJSON(n);return this.set({messages:o,jobStatus:u,progress:p}),this}async fetchResultData(t,e,i){e=BF.from(e||{});const{returnColumnName:r,returnFeatureCollection:n,returnM:o,returnZ:u,outSpatialReference:p}=e,{path:g}=Du(this.sourceUrl),w=uI({returnColumnName:r||null,returnFeatureCollection:n||null,returnM:o||null,returnZ:u||null,outSR:p,returnType:"data",f:"json"},null),S={...this.requestOptions,...i,query:w},T=`${g}/jobs/${this.jobId}/results/${t}`,{data:E}=await nt(T,S);return n7(E)}async fetchResultImage(t,e,i){const{path:r}=Du(this.sourceUrl),n={...e.toJSON(),f:"json"},o=uI(n),u={...this.requestOptions,...i,query:o},p=`${r}/jobs/${this.jobId}/results/${t}`,{data:g}=await nt(p,u);return n7(g)}async fetchResultMapImageLayer(){const{path:t}=Du(this.sourceUrl),e=t.indexOf("/GPServer/"),i=`${t.substring(0,e)}/MapServer/jobs/${this.jobId}`;return new(await ie(async()=>{const{default:r}=await import("./MapImageLayer-VzX6JjA_.js");return{default:r}},__vite__mapDeps([344,345,132,133,60,58,59,14,13,15,134,135,12,346]))).default({url:i})}async waitForJobCompletion(t={}){const{interval:e=1e3,signal:i,statusCallback:r}=t;return new Promise((n,o)=>{Zo(i,()=>{this._clearTimer(),o(ni())}),this._clearTimer();const u=setInterval(()=>{this._timer||o(ni()),this.checkJobStatus(this.requestOptions).then(p=>{const{jobStatus:g}=p;switch(this.jobStatus=g,g){case"job-succeeded":this._clearTimer(),n(this);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":r&&r(this);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":this._clearTimer(),o(this)}})},e);this._timer=u})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};m([b()],vp.prototype,"jobId",void 0),m([ze(bDe,{ignoreUnknown:!1})],vp.prototype,"jobStatus",void 0),m([b({type:[Iae]})],vp.prototype,"messages",void 0),m([b()],vp.prototype,"progress",void 0),m([b()],vp.prototype,"requestOptions",void 0),m([b({json:{write:!0}})],vp.prototype,"sourceUrl",void 0),vp=S5=m([G("esri.rest.support.JobInfo")],vp);const wDe=vp;async function kae(t,e,i,r){return i=BF.from(i||{}),Eae(t,"submitJob",i,e??{},r).then(({data:n})=>{const o=wDe.fromJSON(n);return o.sourceUrl=t,o})}const cI=new et({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),u2=cI.fromJSON.bind(cI),_De=cI.toJSON.bind(cI);function SDe(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function xDe(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function CB(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function $De(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function TDe(t,e=15){const i=t.canvas.width,r=t.canvas.height,n=t.getImageData(0,0,i,r).data;let o,u,p,g,w,S;e:for(u=r;u--;)for(o=i;o--;)if(n[4*(i*u+o)+3]>e){S=u;break e}if(!S)return null;e:for(o=i;o--;)for(u=S+1;u--;)if(n[4*(i*u+o)+3]>e){w=o;break e}e:for(o=0;o<=w;++o)for(u=S+1;u--;)if(n[4*(i*u+o)+3]>e){p=o;break e}e:for(u=0;u<=S;++u)for(o=p;o<=w;++o)if(n[4*(i*u+o)+3]>e){g=u;break e}return{x:p,y:g,width:w-p,height:S-g}}function EDe(t,e){var n,o;const i=((n=e.color)==null?void 0:n.clone())??new Ce([0,255,255]),r=((o=e.haloColor)==null?void 0:o.clone())??i.clone();switch(t){case"envelope":case"polygon":return i.a*=e.fillOpacity??.25,new na({color:i,outline:new cn({color:r}),style:"solid"});case"polyline":return new cn({color:r});default:return r.a=1,new kn({color:r,outline:null})}}function IDe(t,e){const i=t.allLayerViews.items;if(e===t.scale)return i.filter(n=>!n.suspended);const r=new Array;for(const n of i){const o=n.parent;o&&o!==n.view&&(CDe(o)||ADe(o))&&!r.includes(o)||n.visible&&n.visibleAtCurrentTimeExtent&&O8e(n.layer.effectiveScaleRange,e)&&r.push(n)}return r}function MDe(t){return(t==null?void 0:t.type)==="bing-maps"}function Cae(t){return t&&"blendMode"in t&&"effect"in t}function kDe(t){return(t==null?void 0:t.type)==="csv"}function CDe(t){return t.layer.type==="catalog"}function ADe(t){return t.layer.type==="group"}function LDe(t){const e=t.layer;if(Cae(e)){const i=e.blendMode;if((!i||i==="normal")&&(e.effect||"featureEffect"in t&&t.featureEffect))return!0}return!1}let zn=class extends Te{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format="png32",this.includeCharts=!1,this.includeTables=!1,this.label=null,this.layout="map-only",this.layoutItem=null,this.layoutOptions=null,this.outScale=0,this.report=null,this.reportItem=null,this.reportOptions=null,this.scalePreserved=!0,this.showLabels=!0}};m([b()],zn.prototype,"attributionVisible",void 0),m([b()],zn.prototype,"exportOptions",void 0),m([b()],zn.prototype,"forceFeatureAttributes",void 0),m([b()],zn.prototype,"format",void 0),m([b()],zn.prototype,"includeCharts",void 0),m([b()],zn.prototype,"includeTables",void 0),m([b()],zn.prototype,"label",void 0),m([b()],zn.prototype,"layout",void 0),m([b({type:Nl})],zn.prototype,"layoutItem",void 0),m([b()],zn.prototype,"layoutOptions",void 0),m([b()],zn.prototype,"outScale",void 0),m([b()],zn.prototype,"report",void 0),m([b({type:Nl})],zn.prototype,"reportItem",void 0),m([b()],zn.prototype,"reportOptions",void 0),m([b()],zn.prototype,"scalePreserved",void 0),m([b()],zn.prototype,"showLabels",void 0),zn=m([G("esri.rest.support.PrintTemplate")],zn);const Aae=zn,hI=new et({"Attribute List Letter ANSI A Landscape":"attribute-list-letter-ansi-a-landscape","Attribute List Letter ANSI A Portrait":"attribute-list-letter-ansi-a-portrait","Attribute List With Group Letter ANSI A Landscape":"attribute-list-with-group-letter-ansi-a-landscape","Attribute List With Group Letter ANSI A Portrait":"attribute-list-with-group-letter-ansi-a-portrait","Page per Feature Letter ANSI A Landscape":"page-per-feature-letter-ansi-a-landscape","Page per Feature Letter ANSI A Portrait":"page-per-feature-letter-ansi-a-portrait"});hI.fromJSON.bind(hI);const ODe=hI.toJSON.bind(hI),AB={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},LB=new et({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),PDe=new et({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),s7=new Map;async function RDe(t,e,i){var p;const r=await HF(t,i),n=await NDe(e,r);if(await Lae(t,i)==="sync"){const{results:g}=await Mae(t,n,void 0,i);return(p=g==null?void 0:g[0])==null?void 0:p.value}const o=await kae(t,n,void 0,i);await o.waitForJobCompletion({interval:e.updateDelay});const{value:u}=await o.fetchResultData("Output_File",null,i);return u}async function HF(t,e){const i=jDe(t),r=s7.get(i)??{gpServerUrl:i,legendLayerNameMap:{},legendLayers:[]};return r.gpMetadata??(r.gpMetadata=(await nt(i,xS({f:"json"},e))).data),r.cimVersion=r.gpMetadata.cimVersion,s7.set(i,r),r}async function Lae(t,e){return oje(await HF(t,e))}async function FDe(t,e){return(await HF(t,e)).gpMetadata.tasks}async function NDe(t,e){var T,E,C,L,R;e=e||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]};const i=t.template||new Aae;i.showLabels==null&&(i.showLabels=!0);const r=i.exportOptions;let n;const o=_De(i.layout);if(r&&(n={dpi:r.dpi},o.toLowerCase()==="map_only"||o==="")){const F=r.width,V=r.height;n.outputSize=F!=null&&V!=null?[F,V]:void 0}const u=i.layoutOptions;let p;if(u){let F,V;u.scalebarUnit==="Miles"||u.scalebarUnit==="Kilometers"?(F="Kilometers",V="Miles"):u.scalebarUnit!=="Meters"&&u.scalebarUnit!=="Feet"||(F="Meters",V="Feet"),p={titleText:u.titleText,authorText:u.authorText,copyrightText:u.copyrightText,customTextElements:u.customTextElements,elementOverrides:u.elementOverrides,scaleBarOptions:{metricUnit:LB.toJSON(F),metricLabel:F?AB[F]:void 0,nonMetricUnit:LB.toJSON(V),nonMetricLabel:V?AB[V]:void 0}}}let g=null;u!=null&&u.legendLayers&&(g=u.legendLayers.map(F=>{const V=F.layerId;e.legendLayerNameMap[V]=F.title;const U={id:V};return F.subLayerIds&&(U.subLayerIds=F.subLayerIds),U}));const w=await DDe(t,i,e);if(w.operationalLayers){const F=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),V=/[\u0600-\u06FF]/,U=W=>{var te;const H=W.text,J=W.font,X=(te=J==null?void 0:J.family)==null?void 0:te.toLowerCase();H&&J&&(X==="arial"||X==="arial unicode ms")&&(J.family=F.test(H)?"Arial Unicode MS":"Arial",J.style!=="normal"&&V.test(H)&&(J.family="Arial Unicode MS"))};for(const W of w.operationalLayers)if((T=W.featureCollection)!=null&&T.layers)for(const H of W.featureCollection.layers){if((L=(C=(E=H.layerDefinition)==null?void 0:E.drawingInfo)==null?void 0:C.renderer)!=null&&L.symbol){const J=H.layerDefinition.drawingInfo.renderer;J.symbol.type==="esriTS"&&U(J.symbol)}if((R=H.featureSet)!=null&&R.features)for(const J of H.featureSet.features)J.symbol&&J.symbol.type==="esriTS"&&U(J.symbol)}}t.outSpatialReference&&(w.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(w,{exportOptions:n,layoutOptions:p||{}}),Object.assign(w.layoutOptions,{legendOptions:{operationalLayers:g??e.legendLayers.slice()}}),e.legendLayers.length=0,s7.set(e.gpServerUrl,e);const S={Web_Map_as_JSON:JSON.stringify(w),Format:xae(i.format),Layout_Template:o,Layout_Item_ID:void 0,Report_Template:ODe(i.report),Report_Item_ID:void 0};if(i.layoutItem){delete S.Layout_Template;const F=i.layoutItem;await F.load(),F.access!=="public"&&rt&&await rt.getCredential(e.gpServerUrl),S.Layout_Item_ID=JSON.stringify({id:F.id})}if(i.reportItem){delete S.Report_Template;const F=i.reportItem;await F.load(),F.access!=="public"&&rt&&await rt.getCredential(e.gpServerUrl),S.Report_Item_ID=JSON.stringify({id:F.id})}return t.extraParameters&&Object.assign(S,t.extraParameters),S}async function DDe(t,e,i){const r=t.view;let n=r.spatialReference;const o={operationalLayers:await VDe(r,e,i)};e.includeTables&&(o.tables=await eje(r));let u=t.extent||i.ssExtent||r.extent;if(n!=null&&n.isWrappable&&(u=u.clone()._normalize(!0),n=u.spatialReference),o.mapOptions={extent:u&&u.toJSON(),spatialReference:n&&n.toJSON(),showAttribution:e.attributionVisible},i.ssExtent=null,r.background&&(o.background=r.background.toJSON()),r.rotation&&(o.mapOptions.rotation=-r.rotation),e.scalePreserved&&(o.mapOptions.scale=e.outScale||r.scale),r.timeExtent!=null){const p=r.timeExtent.start!=null?r.timeExtent.start.getTime():null,g=r.timeExtent.end!=null?r.timeExtent.end.getTime():null;o.mapOptions.time=[p,g]}return e.reportOptions&&(o.reportOptions=e.reportOptions),o}function jDe(t){let e=t;const i=e.lastIndexOf("/GPServer/");return i>0&&(e=e.slice(0,i+9)),e}async function VDe(t,e,i){var p;const r=[],n={layerView:null,printTemplate:e,view:t};let o=0;e.scalePreserved&&(o=e.outScale||t.scale);const u=IDe(t,o);for(const g of u){const w=g.layer;if(!w.loaded||"layers"in w)continue;let S;n.layerView=g,S=LDe(g)?await Ab(w,n,i):MDe(w)?zDe(w):kDe(w)?await GDe(w,n,i):(w==null?void 0:w.type)==="catalog-footprint"?await UDe(w,n,i):(w==null?void 0:w.type)==="feature"?await BDe(w,n,i):(w==null?void 0:w.type)==="geojson"?await qDe(w,n,i):(w==null?void 0:w.type)==="graphics"?await HDe(w,n,i):(w==null?void 0:w.type)==="imagery"?WDe(w,i):(w==null?void 0:w.type)==="imagery-tile"?await JDe(w,n,i):(w==null?void 0:w.type)==="kml"?await ZDe(w,n,i):(w==null?void 0:w.type)==="map-image"?KDe(w,n,i):(w==null?void 0:w.type)==="map-notes"?await YDe(n,i):(w==null?void 0:w.type)==="open-street-map"?XDe():(w==null?void 0:w.type)==="stream"?await QDe(w,n,i):(w==null?void 0:w.type)==="tile"?tje(w,i):(w==null?void 0:w.type)==="vector-tile"?await ije(w,n,i):(w==null?void 0:w.type)==="web-tile"?rje(w):(w==null?void 0:w.type)==="wms"?nje(w,i):(w==null?void 0:w.type)==="wmts"?sje(w):await Ab(w,n,i),S&&(Array.isArray(S)?r.push(...S):(S.id=w.id,S.title=i.legendLayerNameMap[w.id]||w.title,S.opacity=g.fullOpacity,S.minScale=w.minScale||0,S.maxScale=w.maxScale||0,Cae(w)&&w.blendMode&&w.blendMode!=="normal"&&(S.blendMode=w.blendMode),r.push(S)))}if(o)for(const g of r)g.minScale=0,g.maxScale=0;if((p=t.graphics)!=null&&p.length){const g=await _h(null,t.graphics,e,i);g&&r.push(g)}return r}function zDe(t){return{culture:t.culture,key:t.key,type:"BingMaps"+(t.style==="aerial"?"Aerial":t.style==="hybrid"?"Hybrid":"Road")}}async function UDe(t,{layerView:e,printTemplate:i},r){if(parseFloat(r.cimVersion)<3.1)return _h(t,await VS(e),i,r);const n=t.parent,o={id:(u=Ih(n,"web-map")).id,url:u.url,layerType:u.layerType,customParameters:u.customParameters,dynamicGroupLayer:{visibility:!1},footprintLayer:u.footprintLayer,layerDefinition:u.layerDefinition};var u;return ng(o,n),o}async function GDe(t,e,i){t.legendEnabled&&i.legendLayers.push({id:t.id});const r=e.layerView,n=e.printTemplate;if(!(r.filter||t.portalItem&&t.portalItem.access!=="public")){const o=Ih(t,"web-map");return o.type="CSV",delete o.popupInfo,delete o.layerType,o.showLabels=n.showLabels&&t.labelsVisible,o}return _h(t,await VS(r),n,i)}async function _h(t,e,i,r){var F,V,U,W,H,J;let n;const o=xDe(),u=$De(),p=CB(),g=SDe(),w=CB();if(w.layerDefinition.name="textLayer",delete w.layerDefinition.drawingInfo,t){if(t.declaredClass==="esri.layers.FeatureLayer"||t.declaredClass==="esri.layers.StreamLayer"?o.layerDefinition.name=u.layerDefinition.name=p.layerDefinition.name=g.layerDefinition.name=r.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:t.declaredClass==="esri.layers.GraphicsLayer"&&(e=t.graphics.items),t.renderer){const X=t.renderer.toJSON(),te=o.layerDefinition.drawingInfo;te&&(te.renderer=X);const oe=u.layerDefinition.drawingInfo;oe&&(oe.renderer=X);const pe=p.layerDefinition.drawingInfo;pe&&(pe.renderer=X);const de=g.layerDefinition.drawingInfo;de&&(de.renderer=X)}if(i.showLabels&&t.labelsVisible&&typeof t.write=="function"){const X=Ih(t,"web-map"),te=(V=(F=X.layerDefinition)==null?void 0:F.drawingInfo)==null?void 0:V.labelingInfo;if(te){n=!0;const oe=o.layerDefinition.drawingInfo;oe&&(oe.labelingInfo=te);const pe=u.layerDefinition.drawingInfo;pe&&(pe.labelingInfo=te);const de=p.layerDefinition.drawingInfo;de&&(de.labelingInfo=te);const ge=g.layerDefinition.drawingInfo;ge&&(ge.labelingInfo=te)}}}let S;t!=null&&t.renderer||n||(delete o.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete p.layerDefinition.drawingInfo,delete g.layerDefinition.drawingInfo);const T=t==null?void 0:t.fieldsIndex,E=t==null?void 0:t.renderer;if(T){const X=new Set;n&&await kve(X,t),E&&typeof E.collectRequiredFields=="function"&&await E.collectRequiredFields(X,T),S=Array.from(X);const te=T.fields.map(oe=>oe.toJSON());o.layerDefinition.fields=te,u.layerDefinition.fields=te,p.layerDefinition.fields=te,g.layerDefinition.fields=te}const C=e==null?void 0:e.length;let L;for(let X=0;X<C;X++){const te=e[X]||e.at(X);if(te.visible!==!1&&te.geometry){if(L=te.toJSON(),L.hasOwnProperty("popupTemplate")&&delete L.popupTemplate,(U=L.geometry)!=null&&U.z&&delete L.geometry.z,L.symbol&&(L.symbol.angle||delete L.symbol.angle,$5(L.symbol)?L.symbol=await x5(L.symbol,r):L.symbol.text&&delete L.attributes),(!i||!i.forceFeatureAttributes)&&(S==null?void 0:S.length)){const oe={};for(const pe of S)(W=L.attributes)!=null&&W.hasOwnProperty(pe)&&(oe[pe]=L.attributes[pe]);L.attributes=oe}te.geometry.type==="polygon"?o.featureSet.features.push(L):te.geometry.type==="polyline"?u.featureSet.features.push(L):te.geometry.type==="point"?(H=L.symbol)!=null&&H.text?w.featureSet.features.push(L):p.featureSet.features.push(L):te.geometry.type==="multipoint"?g.featureSet.features.push(L):te.geometry.type==="extent"&&(L.geometry=xo.fromExtent(te.geometry).toJSON(),o.featureSet.features.push(L))}}const R=[o,u,g,p,w].filter(X=>X.featureSet.features.length>0);for(const X of R){const te=X.featureSet.features.every(oe=>oe.symbol);if(te&&(!i||!i.forceFeatureAttributes))for(const oe of X.featureSet.features)delete oe.attributes;te&&delete X.layerDefinition.drawingInfo,(J=X.layerDefinition.drawingInfo)!=null&&J.renderer&&await Oae(X.layerDefinition.drawingInfo.renderer,r)}return R.length?{featureCollection:{layers:R},showLabels:n}:null}async function BDe(t,e,i){var T,E,C,L,R,F,V;let r;const n=t.renderer,o=parseFloat(i.cimVersion);if(((T=t.featureReduction)==null?void 0:T.type)==="binning"||((E=t.featureReduction)==null?void 0:E.type)==="cluster"&&o<2.9||(n==null?void 0:n.type)==="pie-chart"||(n==null?void 0:n.type)==="dot-density"&&o<2.6)return Ab(t,e,i);t.legendEnabled&&i.legendLayers.push({id:t.id});const u=e.layerView,{printTemplate:p,view:g}=e,w=((C=t.source)==null?void 0:C.type)!=="feature-layer"&&((L=t.source)==null?void 0:L.type)!=="ogc-feature";if(u.filter||w||!n||"field"in n&&n.field!=null&&!t.getField(n.field)){const U=await VS(u);r=await _h(t,U,p,i)}else{if(r={id:(S=Ih(t)).id,title:S.title,url:S.url,layerType:S.layerType,customParameters:S.customParameters,layerDefinition:S.layerDefinition,charts:p.includeCharts?S.charts:void 0},r.showLabels=p.showLabels&&t.labelsVisible,ng(r,t),((F=(R=r.layerDefinition)==null?void 0:R.drawingInfo)==null?void 0:F.renderer)&&(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,await Oae(r.layerDefinition.drawingInfo.renderer,i),"visualVariables"in n&&n.visualVariables&&n.visualVariables[0])){const W=n.visualVariables[0];if(W.type==="size"&&W.maxSize&&typeof W.maxSize!="number"&&W.minSize&&typeof W.minSize!="number"){const H=TQ(W,g.scale);r.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=H.minSize,r.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=H.maxSize}}const U=Moe(u);if(U&&(r.layerDefinition??(r.layerDefinition={}),r.layerDefinition.definitionExpression=r.layerDefinition.definitionExpression?`(${r.layerDefinition.definitionExpression}) AND (${U})`:U),t.gdbVersion&&(r.layerDefinition??(r.layerDefinition={}),r.layerDefinition.gdbVersion=t.gdbVersion),((V=u.hasHighlight)==null?void 0:V.call(u))&&"getHighlightIds"in u){const W=u;r.selectionObjectIds=W.getHighlightIds(),r.selectionSymbol=EDe(t.geometryType,W.highlightOptions??g.highlightOptions)}}var S;return r}async function qDe(t,e,i){var r,n;return((r=t.featureReduction)==null?void 0:r.type)==="binning"||((n=t.featureReduction)==null?void 0:n.type)==="cluster"?Ab(t,e,i):(t.legendEnabled&&i.legendLayers.push({id:t.id}),_h(t,await VS(e.layerView),e.printTemplate,i))}async function HDe(t,{printTemplate:e},i){return _h(t,null,e,i)}function WDe(t,e){var n;t.legendEnabled&&e.legendLayers.push({id:t.id});const i={layerType:(r=Ih(t)).layerType,customParameters:r.customParameters};var r;return i.bandIds=t.bandIds,i.compressionQuality=t.compressionQuality,i.format=t.format,i.interpolation=t.interpolation,(t.mosaicRule||t.definitionExpression)&&(i.mosaicRule=t.exportImageServiceParameters.mosaicRule.toJSON()),t.rasterFunction&&(i.renderingRule=t.rasterFunction.toJSON()),t.renderer&&(i.layerDefinition??(i.layerDefinition={}),(n=i.layerDefinition).drawingInfo??(n.drawingInfo={}),i.layerDefinition.drawingInfo.renderer=t.renderer.toJSON()),ng(i,t),i}async function JDe(t,e,i){var o;if(((o=t.renderer)==null?void 0:o.type)==="flow")return Ab(t,e,i);t.legendEnabled&&i.legendLayers.push({id:t.id});const r={bandIds:(n=Ih(t)).bandIds,customParameters:n.customParameters,interpolation:n.interpolation,layerDefinition:n.layerDefinition};var n;return r.layerType="ArcGISImageServiceLayer",ng(r,t),r}async function ZDe(t,e,i){const r=e.printTemplate;if(!t.portalItem||t.portalItem.access==="public"){const g=Ih(t,"web-map");return g.type="kml",delete g.layerType,g.url=ws(t.url),g}const n=[],o=e.layerView;o.allVisibleMapImages.forEach((g,w)=>{const S={id:`${t.id}_image${w}`,type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:o.fullOpacity,extent:g.extent};g.href.substr(0,22)==="data:image/png;base64,"?S.imageData=g.href.substr(22):S.url=g.href,n.push(S)});const u=[...o.allVisiblePoints.items,...o.allVisiblePolylines.items,...o.allVisiblePolygons.items],p={id:t.id,...await _h(null,u,r,i)};return n.push(p),n}function KDe(t,{view:e},i){var w,S;let r;const n={id:t.id,subLayerIds:[]};let o=[];const u=e.scale,p=T=>{const E=u===0,C=T.minScale===0||u<=T.minScale,L=T.maxScale===0||u>=T.maxScale;if(T.visible&&(E||C&&L))if(T.sublayers)T.sublayers.forEach(p);else{const R=T.toExportImageJSON(),F={id:T.id,name:T.title,layerDefinition:{drawingInfo:R.drawingInfo,definitionExpression:R.definitionExpression,source:R.source}};o.unshift(F),n.subLayerIds.push(T.id)}};var g;return t.sublayers&&t.sublayers.forEach(p),o.length&&(o=o.map(({id:T,name:E,layerDefinition:C})=>({id:T,name:E,layerDefinition:C})),r={layerType:(g=Ih(t)).layerType,customParameters:g.customParameters},r.layers=o,r.visibleLayers=(S=(w=t.capabilities)==null?void 0:w.exportMap)!=null&&S.supportsDynamicLayers?void 0:n.subLayerIds,t.gdbVersion&&(r.gdbVersion=t.gdbVersion),ng(r,t),t.legendEnabled&&i.legendLayers.push(n)),r}async function YDe({layerView:t,printTemplate:e},i){const r=[],n=t.layer;if(n.featureCollections!=null)for(const o of n.featureCollections){const u=await _h(o,o.source,e,i);u&&r.push(...u.featureCollection.layers)}else if(n.sublayers!=null)for(const o of n.sublayers){const u=await _h(null,o.graphics,e,i);u&&r.push(...u.featureCollection.layers)}return{featureCollection:{layers:r}}}function XDe(){return{type:"OpenStreetMap"}}async function Ab(t,{printTemplate:e,view:i},r){var T;const n={type:"image"},o={format:"png",ignoreBackground:!0,ignorePadding:!0,layers:[t]};i.rotation!==0&&(o.rotation=0);const u=r.ssExtent||i.state.extent.clone();let p=96,g=!0,w=!0;if(e.exportOptions){const E=e.exportOptions;E.dpi!=null&&E.dpi>0&&(p=E.dpi),E.width!=null&&E.width>0&&(g=E.width%2==i.width%2),E.height!=null&&E.height>0&&(w=E.height%2==i.height%2)}if(e.layout==="map-only"&&e.scalePreserved&&(!e.outScale||e.outScale===i.scale)&&p===96&&(!g||!w)&&i.state.extent.equals(i.extent)&&(o.area={x:0,y:0,width:i.width,height:i.height},g||(o.area.width-=1),w||(o.area.height-=1),!r.ssExtent)){const E=i.toMap(Mr(o.area.width,o.area.height));u.ymin=E.y,u.xmax=E.x,r.ssExtent=u}n.extent=u.clone()._normalize(!0).toJSON();const S=await i.takeScreenshot(o);return n.imageData=(T=xm(S.dataUrl))==null?void 0:T.data,n}async function QDe(t,{layerView:e,printTemplate:i},r){return t.legendEnabled&&r.legendLayers.push({id:t.id}),_h(t,await VS(e),i,r)}async function eje(t){var n,o;const e=[],i=[];for(const u of t.map.allTables)u.type!=="feature"||u.loaded||i.push(u.load());i.length&&await Promise.allSettled(i);for(const u of t.map.allTables)if(u.type==="feature"&&u.loaded&&u.isTable&&((n=u.source)==null?void 0:n.type)==="feature-layer"){const p={id:(r=Ih(u)).id,title:r.title,customParameters:r.customParameters,layerDefinition:{definitionExpression:(o=r.layerDefinition)==null?void 0:o.definitionExpression},url:r.url};ng(p,u),e.push(p)}var r;return e.length?e:void 0}function tje(t,e){t.legendEnabled&&e.legendLayers.push({id:t.id});const i={layerType:(r=Ih(t)).layerType,customParameters:r.customParameters};var r;return ng(i,t),i}async function ije(t,e,i){if(t.serviceUrl&&t.styleUrl){const r=ME(t.styleUrl,t.apiKey),n=ME(t.serviceUrl,t.apiKey);if(!r&&!n||i.cimVersion!=="2.1.0"){const o={type:"VectorTileLayer"};return o.styleUrl=ws(t.styleUrl),o.token=r,n!==r&&(o.additionalTokens=[{url:t.serviceUrl,token:n}]),o}}return Ab(t,e,i)}function rje(t){var r;const e=(r=t.urlTemplate)==null?void 0:r.replace(/\${/g,"{"),i={type:"WebTiledLayer",urlTemplate:e,credits:t.copyright};return t.subDomains&&t.subDomains.length>0&&(i.subDomains=t.subDomains),i}function nje(t,e){let i;const r=[],n=o=>{o.visible&&(o.sublayers?o.sublayers.forEach(n):o.name&&r.unshift(o.name))};return t.sublayers&&t.sublayers.forEach(n),r.length&&(t.legendEnabled&&e.legendLayers.push({id:t.id,subLayerIds:r}),i={type:"wms",customLayerParameters:t.customLayerParameters,customParameters:t.customParameters,transparentBackground:t.imageTransparency,visibleLayers:r,url:ws(t.url),version:t.version}),i}function sje(t){const e=t.activeLayer;return{type:"wmts",customLayerParameters:t.customLayerParameters,customParameters:t.customParameters,format:e.imageFormat,layer:e.id,style:e.styleId,tileMatrixSet:e.tileMatrixSetId,url:ws(t.url)}}function ng(t,e){e.url&&(t.url=ws(t.url||e.url),t.token=ME(t.url,e.apiKey))}async function x5(t,e){var u;e.canvas||(e.canvas=document.createElement("canvas"));const i=1024;e.canvas.width=i,e.canvas.height=i;const r=e.canvas.getContext("2d");let n,o;if(t.path){const p=new Path2D(t.path);p.closePath(),r.fillStyle=Array.isArray(t.color)?`rgba(${t.color[0]},${t.color[1]},${t.color[2]},${t.color[3]/255})`:"rgb(0,0,0)",r.fill(p);const g=TDe(r);if(!g)return null;r.clearRect(0,0,i,i);const w=Zi(t.size)/Math.max(g.width,g.height);r.scale(w,w);const S=i/w,T=S/2-g.width/2-g.x,E=S/2-g.height/2-g.y;if(r.translate(T,E),Array.isArray(t.color)&&r.fill(p),((u=t.outline)==null?void 0:u.width)&&Array.isArray(t.outline.color)){const L=t.outline;r.lineWidth=Zi(L.width)/w,r.lineJoin="round",r.strokeStyle=`rgba(${L.color[0]},${L.color[1]},${L.color[2]},${L.color[3]/255})`,r.stroke(p),g.width+=r.lineWidth,g.height+=r.lineWidth}g.width*=w,g.height*=w;const C=r.getImageData(i/2-g.width/2,i/2-g.height/2,Math.ceil(g.width),Math.ceil(g.height));n=C.width,o=C.height,r.canvas.width=n,r.canvas.height=o,r.putImageData(C,0,0)}else{const p=t.contentType==="image/svg+xml"?"data:image/svg+xml;base64,"+t.imageData:t.url,g=(await nt(p,{responseType:"image"})).data;n=Zi(t.width),o=Zi(t.height),r.canvas.width=n,r.canvas.height=o,r.drawImage(g,0,0,r.canvas.width,r.canvas.height)}return{type:"esriPMS",imageData:r.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:Jn(o),width:Jn(n),xoffset:t.xoffset,yoffset:t.yoffset}}async function Oae(t,e){const i=t.type;if(i==="simple"&&$5(t.symbol))t.symbol=await x5(t.symbol,e);else if(i==="uniqueValue"||i==="classBreaks"){$5(t.defaultSymbol)&&(t.defaultSymbol=await x5(t.defaultSymbol,e));const r=t[i==="uniqueValue"?"uniqueValueInfos":"classBreakInfos"];if(r)for(const n of r)$5(n.symbol)&&(n.symbol=await x5(n.symbol,e))}}async function VS(t){return t.queryFeatures(t.createQuery()).then(e=>e.features)}function Ih(t,e){return t.write({},{ignorePersistenceEnabled:!0,origin:e})??{}}function oje(t){var e;return(e=t.gpMetadata)!=null&&e.executionType?PDe.fromJSON(t.gpMetadata.executionType):"sync"}function $5(t){var e;return t&&(t.path||t.contentType==="image/svg+xml"||((e=t.url)==null?void 0:e.endsWith(".svg")))}let bp=class extends Te{constructor(e){super(e),this.extent=null,this.extraParameters=null,this.outSpatialReference=null,this.template=null,this.updateDelay=1e3,this.view=null}};m([b()],bp.prototype,"extent",void 0),m([b()],bp.prototype,"extraParameters",void 0),m([b()],bp.prototype,"outSpatialReference",void 0),m([b()],bp.prototype,"template",void 0),m([b()],bp.prototype,"updateDelay",void 0),m([b()],bp.prototype,"view",void 0),bp=m([G("esri.rest.support.PrintParameters")],bp);const aje=bp;let Br=class extends Te{constructor(e){super(e),this.strokeDash=[],this.strokeWidth=2,this.strokeColor=[0,0,0,1],this.strokeBackgroundColor=[0,0,0,0],this.fillColor=[0,0,0,0],this.backgroundFillColor=[0,0,0,.5],this.visible=!0,this.isDecoration=!1,this.boxWidth=0,this.boxHeight=0,this.backgroundWidth=0,this.backgroundHeight=0,this.padding={left:0,top:0,right:0,bottom:0}}get _strokeStyle(){return`rgba(${this.strokeColor.join()})`}get _strokeBackgroundStyle(){return`rgba(${this.strokeBackgroundColor.join()})`}get _fillStyle(){return`rgba(${this.fillColor.join()})`}get _backgroundFillStyle(){return`rgba(${this.backgroundFillColor.join()})`}render(){const{backgroundWidth:e,backgroundHeight:i,boxWidth:r,boxHeight:n,padding:o}=this,u=o.left,p=o.top,g=this.x??u+e/2-r/2,w=this.y??p+i/2-n/2,S=g+r,T=w+n;return N("div",{classes:{"esri-box-overlay-item":!0},styles:{left:"0px",top:"0px",width:"100%",height:"100%",visibility:this.visible?"visible":"hidden"}},N("svg",{styles:{width:"100%",height:"100%"}},N("path",{d:`M ${u} ${p} L ${e+u} ${p} L ${e+u} ${i+p} L ${u} ${i+p} Z M ${g} ${w} L ${g} ${T} L ${S} ${T} L ${S} ${w} Z`,fill:this._backgroundFillStyle,stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),N("rect",{fill:this._fillStyle,height:n,stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.join(" ")||void 0,"stroke-width":this.strokeWidth,width:r,x:g,y:w})))}renderCanvas(){}};m([b()],Br.prototype,"strokeDash",void 0),m([b()],Br.prototype,"strokeWidth",void 0),m([b()],Br.prototype,"strokeColor",void 0),m([b()],Br.prototype,"strokeBackgroundColor",void 0),m([b()],Br.prototype,"fillColor",void 0),m([b()],Br.prototype,"backgroundFillColor",void 0),m([b()],Br.prototype,"visible",void 0),m([b()],Br.prototype,"isDecoration",void 0),m([b()],Br.prototype,"boxWidth",void 0),m([b()],Br.prototype,"boxHeight",void 0),m([b()],Br.prototype,"backgroundWidth",void 0),m([b()],Br.prototype,"backgroundHeight",void 0),m([b()],Br.prototype,"x",void 0),m([b()],Br.prototype,"y",void 0),m([b()],Br.prototype,"padding",void 0),m([b({readOnly:!0})],Br.prototype,"_strokeStyle",null),m([b({readOnly:!0})],Br.prototype,"_strokeBackgroundStyle",null),m([b({readOnly:!0})],Br.prototype,"_fillStyle",null),m([b({readOnly:!0})],Br.prototype,"_backgroundFillStyle",null),Br=m([G("esri.views.overlay.BoxOverlayItem")],Br);const lje=Br;let Bc=class extends ye{constructor(e){super(e),this.description=null,this.format=null,this.label=null,this.layout=null,this.layoutItem=null,this.layoutOptions=null,this.layoutTemplateInfo=null}};m([b()],Bc.prototype,"description",void 0),m([b({json:{read:_5}})],Bc.prototype,"format",void 0),m([b()],Bc.prototype,"label",void 0),m([b({json:{read:u2}})],Bc.prototype,"layout",void 0),m([b({type:Nl})],Bc.prototype,"layoutItem",void 0),m([b()],Bc.prototype,"layoutOptions",void 0),m([b()],Bc.prototype,"layoutTemplateInfo",void 0),Bc=m([G("esri.widgets.Print.CustomTemplate")],Bc);const c2=Bc;let tn=class extends Te{constructor(e){super(e),this.attributionEnabled=!0,this.author=null,this.copyright=null,this.customTextElements=null,this.dpi=96,this.fileName=null,this.forceFeatureAttributes=!1,this.format="pdf",this.height=null,this.includeTables=!0,this.layout="letter-ansi-a-landscape",this.layoutItem=null,this.legendEnabled=!0,this.northArrowEnabled=!1,this.scale=null,this.scaleEnabled=!1,this.title=null,this.width=null}};m([b()],tn.prototype,"attributionEnabled",void 0),m([b()],tn.prototype,"author",void 0),m([b()],tn.prototype,"copyright",void 0),m([b()],tn.prototype,"customTextElements",void 0),m([b()],tn.prototype,"dpi",void 0),m([b()],tn.prototype,"fileName",void 0),m([b()],tn.prototype,"forceFeatureAttributes",void 0),m([b()],tn.prototype,"format",void 0),m([b()],tn.prototype,"height",void 0),m([b()],tn.prototype,"includeTables",void 0),m([b()],tn.prototype,"layout",void 0),m([b({type:Nl})],tn.prototype,"layoutItem",void 0),m([b()],tn.prototype,"legendEnabled",void 0),m([b()],tn.prototype,"northArrowEnabled",void 0),m([b()],tn.prototype,"scale",void 0),m([b()],tn.prototype,"scaleEnabled",void 0),m([b()],tn.prototype,"title",void 0),m([b()],tn.prototype,"width",void 0),tn=m([G("esri.widgets.Print.TemplateOptions")],tn);const Pae=tn,uje=new Set(["GISProfessionalStdUT","GISProfessionalAdvUT"]),cje=/(\/GPServer\/).+/i,hje=new et({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),pI=Ie.ofType(c2);function pje(t){var i;t.layoutOptions??(t.layoutOptions={}),(i=t.layoutOptions).customTextElements??(i.customTextElements=[]);const e="date";if(!t.layoutOptions.customTextElements.find(r=>e in r)){const{customTextElements:r}=t.layoutOptions;let n=ln(Date.now(),bo("short-date"));vZ()==="ar"&&(n="â€"+n),r.push({date:n})}}let ir=class extends Qo{constructor(e){super(e),this._serviceTemplateCustomTextElements=null,this._layoutToTemplateInfo=new fm,this._isFreeHand=!1,this._freeHandWidth=0,this._freehandHeight=0,this._asyncPrintTaskUrl=null,this._layoutInfoTaskUrl=null,this.allowedFormats="all",this.allowedLayouts="all",this.browseTemplates=new pI,this.defaultTemplates=new pI,this.error=null,this.extraParameters=null,this.includeDefaultTemplates=!0,this.portal=wr.getDefault(),this.portalTemplateIds=[],this.showPrintAreaEnabled=!1,this.printServiceUrl=null,this.printTimeout=12e4,this.templatesInfo=null,this.updateDelay=1e3,this.view=null,this.templateCustomTextElements=null,this.templateOptions=new Pae}initialize(){this.addHandles(ce(()=>this.showPrintAreaEnabled,e=>{var i,r;e?this._enablePrintPreview():(this.removeHandles("overlay-handler"),(r=(i=this.view)==null?void 0:i.overlay)==null||r.removeItem(this._getOverlayItem()))}))}destroy(){var e;this.removeHandles("overlay-handler"),this.view&&(this._overlayItem&&((e=this.view.overlay)==null||e.removeItem(this._overlayItem),this._overlayItem.destroy(),this._overlayItem=null),this.view=null)}get effectivePrintServiceUrl(){return this.printServiceUrl??null}get effectiveTemplateCustomTextElements(){if(!this._serviceTemplateCustomTextElements)return{};const e=ae(this._serviceTemplateCustomTextElements);return this.templateCustomTextElements&&Object.keys(this.templateCustomTextElements).forEach(i=>{var n;const r=e[i];if(r){const o=(n=this.templateCustomTextElements)==null?void 0:n[i];r.forEach(u=>{const[p]=Object.entries(u)[0];o==null||o.forEach(g=>{const[w,S]=Object.entries(g)[0];p===w&&(u[p]=S)})})}}),Object.freeze(e)}get layoutTemplateInfo(){var i;const e=((i=this.templateOptions.layoutItem)==null?void 0:i.id)??this.templateOptions.layout;return e?this._layoutToTemplateInfo.get(e):null}get state(){var e;return this.loadStatus==="loading"?"initializing":this.loadStatus==="failed"||this.error?"error":this.loadStatus==="loaded"&&((e=this.view)!=null&&e.ready)?"ready":"disabled"}get layoutTemplateNorthArrowInfo(){var e,i;return(i=(e=this.layoutTemplateInfo)==null?void 0:e.layoutOptions)!=null&&i.mapSurroundInfos?this.layoutTemplateInfo.layoutOptions.mapSurroundInfos.find(r=>r.type==="CIMMarkerNorthArrow"):null}async load(e){return this.addResolvingPromise(this._loadResources(e).catch(i=>this.error=i)),this}async print(e){var g;const{view:i,extraParameters:r,updateDelay:n}=this;if(!i)throw new re("print:view-required","view is not set");pje(e);const o=this._getOverlayItem(),u=e.scalePreserved||!this.showPrintAreaEnabled?void 0:ore(new jt,i.viewpoint,e.layout==="MAP_ONLY"?[e.exportOptions.width,e.exportOptions.height]:[o.boxWidth,o.boxHeight]),p=new aje({view:i,template:e,extent:u,extraParameters:r,updateDelay:n});try{const w=!!((g=e.layoutItem)!=null&&g.id)&&(this.portalTemplateIds.includes(e.layoutItem.id)||this.browseTemplates.some(S=>{var T,E;return((T=S.layoutItem)==null?void 0:T.id)===((E=e.layoutItem)==null?void 0:E.id)}));return await RDe(w&&this._asyncPrintTaskUrl?this._asyncPrintTaskUrl:this.effectivePrintServiceUrl,p,{timeout:this.printTimeout})}catch(w){throw new re("print:export-error","An error occurred while exporting the web map.",{error:w})}}toPrintTemplate({attributionEnabled:e,author:i,copyright:r,customTextElements:n,dpi:o,forceFeatureAttributes:u,format:p,height:g,includeTables:w,layout:S,layoutItem:T,legendEnabled:E,northArrowEnabled:C,scale:L,scaleEnabled:R,title:F,width:V}){if(!S)throw new re("print:layout-required","layout is not set");const U=new Aae({attributionVisible:e,forceFeatureAttributes:u,format:p,includeTables:w,layout:S,layoutItem:T,layoutOptions:{authorText:i||"",copyrightText:r||"",customTextElements:n,titleText:F||""},outScale:L??0,scalePreserved:R});V&&(U.exportOptions.width=V),g&&(U.exportOptions.height=g),o&&(U.exportOptions.dpi=o),!E&&U.layoutOptions&&(U.layoutOptions.legendLayers=[]);const W=this.layoutTemplateNorthArrowInfo;return W&&W.visible!==C&&U.layoutOptions&&(U.layoutOptions.elementOverrides={[W.name]:{visible:C}}),U}async fetchLayoutTemplateInfo(e,i){var w;if(!((w=e.layoutItem)!=null&&w.id))return;const r=await this._fetchPortalLayoutTemplateInfo(e.layoutItem,i);this._layoutToTemplateInfo.set(e.layoutItem.id,r),e.layoutTemplateInfo=r;const{hasLegend:n,mapSurroundInfos:o,customTextElements:u}=r.layoutOptions,p=o.some(({type:S,visible:T})=>S==="CIMMarkerNorthArrow"&&T);e.layoutOptions={legend:n,northArrow:p};const g=ae(this._serviceTemplateCustomTextElements)??{};g[e.layoutItem.id]=u,this._serviceTemplateCustomTextElements=Object.freeze(g)}getLayoutTemplateInfo(e){return this._layoutToTemplateInfo.get(e)}async addPortalTemplate(e){const i=new c2({label:e.title,layoutItem:e});this.browseTemplates.add(i)}removePortalTemplate(e){var i,r,n,o;(i=e.layoutItem)!=null&&i.id&&((r=this.templateOptions.layoutItem)==null?void 0:r.id)===e.layoutItem.id&&(this.templateOptions.layout=this.defaultTemplates.length||this.browseTemplates.length?null:(o=(n=this.templatesInfo)==null?void 0:n.layout)==null?void 0:o.defaultValue,this.templateOptions.layoutItem=null),this._layoutToTemplateInfo.delete(e.layoutItem.id),this.browseTemplates.remove(e)}async _loadResources(e){var p,g,w;let i=[];if(this.printServiceUrl)this._set("effectivePrintServiceUrl",this.printServiceUrl),await this._updateLayoutInfoTaskUrl(this.effectivePrintServiceUrl);else{if(this.destroyed)return;try{await this.portal.load(e)}catch(S){throw new re("print:could-not-load-portal","Cannot load print resource information from portal",{error:S,url:this.effectivePrintServiceUrl})}if(this.portal.helperServices){const{asyncPrintTask:S,layoutInfoTask:T,printTask:E}=this.portal.helperServices;E&&(this._set("effectivePrintServiceUrl",E.url),i=((p=E.templates)==null?void 0:p.map(C=>c2.fromJSON(C)))??[]),this._asyncPrintTaskUrl=S==null?void 0:S.url,await this._updateLayoutInfoTaskUrl((T==null?void 0:T.url)||this.effectivePrintServiceUrl)}}this.defaultTemplates.addMany(i);const r=(g=this.effectivePrintServiceUrl)==null?void 0:g.toLowerCase().split("/");if(!(r!=null&&r.includes("gpserver")))throw new re("print:invalid-print-service-url","Can't fetch print templates information from provided URL",{url:this.effectivePrintServiceUrl});const[n,o,u]=await Promise.all([this._getPrintServiceLayouts(e),this._getPrintServiceTemplates(e),this._getPortalCustomTemplates(e)]);if(this._processPrintServiceLayouts(n),this._processPrintServiceTemplates(o),this._processPortalTemplates(u),(w=this.templateOptions.layoutItem)==null?void 0:w.id){const S=this.templateOptions.layoutItem.id;let T=this.defaultTemplates.find(E=>{var C;return((C=E.layoutItem)==null?void 0:C.id)===S});T||(T=new c2({label:this.templateOptions.layoutItem.title,layoutItem:this.templateOptions.layoutItem})),await this.fetchLayoutTemplateInfo(T,e),this.templateOptions.layout=S}this._updateOverLayItem()}async _updateLayoutInfoTaskUrl(e,i){if(!e)return;const r=(await FDe(e,i)).find(n=>n.includes("Get Layout Templates Info"));r&&(this._layoutInfoTaskUrl=e.replace(cje,`$1${encodeURI(r)}`))}async _getPortalCustomTemplates(e){if(this.printServiceUrl||!this.portal)return[];const{layoutGroupQuery:i,user:r}=this.portal,n=W7.test(this.portal.url),o=r==null?void 0:r.userLicenseTypeId,u=o&&uje.has(o);if(!i||n&&!u)return[];const p=new Ml({query:i,disableExtraQuery:!0}),g=await this.portal.queryGroups(p,e);if(!g.total)return[];const w=g.results[0],S=new Ml({num:100,query:"type:Layout",sortField:w.sortField,sortOrder:w.sortOrder??void 0}),T=(await w.queryItems(S,e)).results;return T.length?T.map(E=>new c2({label:E.title,layoutItem:E})):[]}async _fetchPortalLayoutTemplateInfo(e,i){const{id:r}=e,n=this._layoutInfoTaskUrl;if(!n)throw new re("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:n});e.access!=="public"&&rt&&await rt.getCredential(n);const o={Layout_Item_ID:JSON.stringify({id:r})};return(await this._fetchLayoutTemplateInfos(o,i))[0]}async _fetchLayoutTemplateInfos(e,i){const r=this._layoutInfoTaskUrl;if(!r)throw new re("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:r});if(await Lae(r)==="async"){const n=await kae(r,e,void 0,i||void 0);return await n.waitForJobCompletion({interval:1e3}),(await n.fetchResultData("Output_JSON")).value}return(await Mae(r,e,null,i)).results[0].value}_processPortalTemplates(e){var i;if(e){this.defaultTemplates.addMany(e);for(const r of e)(i=r.layoutItem)!=null&&i.id&&this.portalTemplateIds.push(r.layoutItem.id)}}_processPrintServiceTemplates(e){this._set("templatesInfo",e)}async _getPrintServiceLayouts(e){let i=[];try{i=await this._fetchLayoutTemplateInfos(void 0,e)}catch{}return i}_processPrintServiceLayouts(e){const i={};for(const r of e){const{layoutTemplate:n,layoutOptions:o}=r,u=u2(n);this._layoutToTemplateInfo.set(u,r),i[u]=o.customTextElements}this._serviceTemplateCustomTextElements=Object.freeze(i)}async _getPrintServiceTemplates(e){let i;try{({data:i}=await nt(this.effectivePrintServiceUrl,{...e,query:{f:"json"},timeout:this.printTimeout}))}catch(u){throw Cn(u)?u:new re("print:unavailable-service-info","Can't fetch templates info from service",{error:u})}const{parameters:r}=i,n=r.find(({name:u})=>u==="Format"),o=r.find(({name:u})=>u==="Layout_Template");return{format:this._getFormat(n),layout:this._getLayout(o)}}_getFormat(e){const i=this.allowedFormats==="all"?e.choiceList:e.choiceList.filter(u=>this.allowedFormats.includes(_5(u))),r=(i.length?i:e.choiceList).map(_5).filter(Rt),n=_5(e.defaultValue),o=r.includes(n)?n:r[0];return{choiceList:r,defaultValue:o}}_getLayout(e){const i=e.choiceList.filter(p=>p.toLowerCase()!=="map_only"),r=this.allowedLayouts==="all"?i:i.filter(p=>this.allowedLayouts.includes(u2(p))),n=(r.length?r:i).map(u2).filter(Rt),o=u2(e.defaultValue),u=n.includes(o)?o:n.find(p=>/(?=.*letter)(?=.*landscape)/i.test(p))??n.find(p=>/(?=.*a4)(?=.*landscape)/i.test(p))??n[0];return{choiceList:n,defaultValue:u}}_getOverlayItem(){return this._overlayItem||(this._overlayItem=new lje({strokeDash:[5],strokeWidth:2,strokeColor:[30,144,255,255]})),this._overlayItem}_enablePrintPreview(){var r,n,o;if(!((r=this.view)!=null&&r.overlay))return;const e=this.templateOptions,i=this._getOverlayItem();this.addHandles([ce(()=>{var u,p,g,w;return[e.width,e.height,e.scaleEnabled,e.scale,e.layout,e.layoutItem,(u=this.view)==null?void 0:u.scale,(p=this.view)==null?void 0:p.size,(g=this.view)==null?void 0:g.state.paddedViewState.size,(w=this.view)==null?void 0:w.state.padding]},()=>this._updateOverLayItem(),Qe),(n=this.view)==null?void 0:n.on("drag",["Shift"],u=>this._handleDrag(u),ii.WIDGET),(o=this.view)==null?void 0:o.on("key-down",["Escape"],()=>this._resetDrag(),ii.WIDGET)],"overlay-handler"),this.view.overlay.addItem(i)}_updateOverLayItem(){var L;if(!this.view)return;const e=this.templateOptions,i=this._getOverlayItem(),r=((L=e.layoutItem)==null?void 0:L.id)??e.layout,n=this.view,o=n.spatialReference,[u,p]=n.state.paddedViewState.size,g=n.state.padding;let w=0,S=0;if(r==="MAP_ONLY")e.width!=null&&e.height!=null&&(w=e.width,S=e.height);else if(r){const{webMapFrameSize:R,pageUnits:F}=this._layoutToTemplateInfo.get(r)??{};let V=!1;if(R&&F)if(this._isFreeHand){const U=R[0]/R[1];w=this._freeHandWidth,S=this._freehandHeight,w>S?S=w/U:w=S*U}else{const U=hje.fromJSON(F.toLowerCase()),W=o.unit;Zp(U)===Zp(W)?(w=lt(R[0],U,W),S=lt(R[1],U,W)):(V=!0,w=R[0],S=R[1])}if(!this._isFreeHand)if(e.scaleEnabled&&e.scale){const U=V?Math.min(u/w,p/S):hr(o)*pP*e.dpi;w*=U,S*=U}else if(w===0||S===0)w=u,S=p;else{const U=(u-.1*u)/w,W=(p-.1*p)/S,H=Math.min(U,W);w*=H,S*=H}}const{scaleEnabled:T,scale:E}=e,C=T&&E?E/this.view.scale:1;i.boxWidth=w*C||u,i.boxHeight=S*C||p,g&&(i.padding=g),i.backgroundWidth=u??0,i.backgroundHeight=p??0}_resetDrag(){this._isFreeHand=!1,this._updateOverLayItem()}_handleDrag(e){switch(e.action){case"start":this._start();break;case"update":this._update(e);break;case"end":this._end()}e.stopPropagation()}_start(){this._isFreeHand=!0}_update(e){const i=this._getOverlayItem(),{x:r,y:n}=e,{x:o,y:u}=e.origin;r>o?(i.x=o,i.boxWidth=r-o):(i.x=r,i.boxWidth=o-r),n>u?(i.y=u,i.boxHeight=n-u):(i.y=n,i.boxHeight=u-n)}_end(){const e=this._getOverlayItem();if(!this.view||e.x==null||e.y==null)return;const i=this.view,r=i.toMap(Mr(e.x+.5*e.boxWidth,e.y+.5*e.boxHeight));e.x=null,e.y=null,i.goTo({center:r}),this._freeHandWidth=e.boxWidth,this._freehandHeight=e.boxHeight,this.templateOptions.layout==="MAP_ONLY"&&(this.templateOptions.width=this._freeHandWidth,this.templateOptions.height=this._freehandHeight),this.templateOptions.scale=this.view.scale,this._updateOverLayItem()}};m([b()],ir.prototype,"_serviceTemplateCustomTextElements",void 0),m([b()],ir.prototype,"_layoutToTemplateInfo",void 0),m([b()],ir.prototype,"allowedFormats",void 0),m([b()],ir.prototype,"allowedLayouts",void 0),m([b({type:pI})],ir.prototype,"browseTemplates",void 0),m([b({type:pI})],ir.prototype,"defaultTemplates",void 0),m([b()],ir.prototype,"error",void 0),m([b()],ir.prototype,"extraParameters",void 0),m([b()],ir.prototype,"includeDefaultTemplates",void 0),m([b({readOnly:!0})],ir.prototype,"effectivePrintServiceUrl",null),m([b()],ir.prototype,"effectiveTemplateCustomTextElements",null),m([b()],ir.prototype,"layoutTemplateInfo",null),m([b({type:wr})],ir.prototype,"portal",void 0),m([b()],ir.prototype,"portalTemplateIds",void 0),m([b()],ir.prototype,"showPrintAreaEnabled",void 0),m([b()],ir.prototype,"printServiceUrl",void 0),m([b()],ir.prototype,"printTimeout",void 0),m([b({readOnly:!0})],ir.prototype,"state",null),m([b({readOnly:!0})],ir.prototype,"templatesInfo",void 0),m([b()],ir.prototype,"updateDelay",void 0),m([b()],ir.prototype,"view",void 0),m([b()],ir.prototype,"templateCustomTextElements",void 0),m([b({type:Pae})],ir.prototype,"templateOptions",void 0),m([b()],ir.prototype,"layoutTemplateNorthArrowInfo",null),ir=m([G("esri.widgets.Print.PrintViewModel")],ir);const Rae=ir,Fae=Ie.ofType($ae),Nae="MAP_ONLY";var Bt;(function(t){t.layout="layoutTab",t.mapOnly="mapOnlyTab",t.export="exportTab"})(Bt||(Bt={}));const $t="esri-print",Rg=`${$t}__advanced-options-button`,Ye={base:$t,headerTitle:`${$t}__header-title`,layoutTabList:`${$t}__layout-tab-list`,layoutTab:`${$t}__layout-tab`,layoutSection:`${$t}__layout-section`,mapOnlySection:`${$t}__map-only-section`,panelItemsCentered:`${$t}__panel-items--centered`,loader:`${$t}__loader`,advancedOptionsButton:Rg,advancedOptionsButtonContainer:`${Rg}-container`,advancedOptionsButtonTitle:`${Rg}-title`,advancedOptionsButtonIconOpened:`${Rg}-icon--opened`,advancedOptionsButtonIconClosed:`${Rg}-icon--closed`,advancedOptionsButtonIconClosed_RTL:`${Rg}-icon--closed-rtl`,swapButton:`${$t}__swap-button`,printButton:`${$t}__export-button`,templateSelectContainer:`${$t}__template-select-container`,templateSelectBlock:`${$t}__template-select-block`,templateSelectIcon:`${$t}__template-select-icon`,formSectionContainer:`${$t}__form-section-container`,formCheckboxLabel:`${$t}__form-checkbox-label`,advancedOptionsSection:`${$t}__advanced-options-section`,advancedOptionsContainer:`${$t}__advanced-options-container`,browseTemplateButtonContainer:`${$t}__browse-template-button-container`,exportedFilesContainer:`${$t}__export-panel-container`,exportedFilesTitle:`${$t}__export-title`,exportedFile:`${$t}__exported-file`,exportedFileLink:`${$t}__exported-file-link`,exportedFileLinkTitle:`${$t}__exported-file-link-title`,exportedFilesEmpty:`${$t}__exported-files-empty`,printWidgetContainer:`${$t}__container`,content:`${$t}__content`,panelContainer:`${$t}__panel-container`,scaleInfoContainer:`${$t}__scale-info-container`,scaleInputContainer:`${$t}__scale-input-container`,scaleInput:`${$t}__scale-input`,sizeContainer:`${$t}__size-container`,panelError:`${$t}__panel--error`,exportedFileError:`${$t}__exported-file--error`,exportedFileLoader:`${$t}__exported-file--loader`,exportSection:`${$t}__export-section`,exportSectionCentered:`${$t}__export-section--centered`,templateButtonContainer:`${$t}__template-button-container`,templateDoneButton:`${$t}__template-done-button`,templateSelectFlowItemContainer:`${$t}__template-select-flow-item-container`,templateSelectFlowItemContent:`${$t}__template-select-flow-item-content`,templateSelectFlowItemListHeading:`${$t}__template-select-flow-item-list-heading`};function dje(t,e,i,r){const n=i/e,o=r/e;return{width:Math.round(t*n),height:Math.round(t*o)}}function fje(t){return!isNaN(t)&&t>0}function a4(t){return(t==null?void 0:t.toUpperCase())===Nae}function yje(t){var r;const{state:e,extension:i}=t;switch(e){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return(r=i==null?void 0:i.toLowerCase())!=null&&r.includes("pdf")?"file-pdf":"file"}}function Fg(t,e){return!!e&&t.some(i=>{var r;return((r=i.layoutItem)==null?void 0:r.id)===e||i.layout===e})}const mje=new et({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});let Er=class extends vi{constructor(e,i){super(e,i),this._activeTabFocusRequested=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._selectedTab=Bt.layout,this._pendingExportScroll=!1,this._rootNode=null,this._selectedLayout=null,this._abortController=null,this._showTemplates=!1,this.browseTemplateButtonOnClick=null,this.exportedLinks=new Fae,this.headingLevel=3,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new Rae,this._onInput=r=>{this._selectedTab===Bt.layout?this.templateOptions.title=r.target.value:this._selectedTab===Bt.mapOnly&&(this.templateOptions.fileName=r.target.value)},this._removeLink=r=>{const n=r.currentTarget["data-item"];n&&this.exportedLinks.remove(n)},this._handleLinkClick=r=>{const n=r.currentTarget["data-item"];if(!n||n.state!=="ready"||!n.url)return;const o=ME(this.viewModel.effectivePrintServiceUrl),u=n.url,p=document.createElement("a");if(p.target="_blank",p.href=u,p.rel="noreferrer",p.download=n.formattedName??"",!o)return p.click(),void r.stopPropagation();r.preventDefault();const g=new URL(u);g.searchParams.set("token",o),p.href=g.href,p.click(),p.href=u},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([ce(()=>{var n;return[this.templateOptions.format,(n=this.viewModel.templatesInfo)==null?void 0:n.format.defaultValue]},([n,o])=>{if(o&&!n)return void(this.templateOptions.format=o);if(!n||!o||!this.viewModel.templatesInfo||this.viewModel.templatesInfo.format.choiceList.includes(n))return;const u=this.viewModel.templatesInfo.format.choiceList.find(p=>p.toUpperCase().includes(`(${n.toUpperCase()})`));this.templateOptions.format=u??o}),ce(()=>{var n;return[this.templateOptions.layout,(n=this.viewModel.templatesInfo)==null?void 0:n.layout.defaultValue]},async([n,o])=>{if(this._selectedTab=a4(n)?Bt.mapOnly:Bt.layout,this._selectedTab!==Bt.layout)return;const{includeDefaultTemplates:u,viewModel:p,_selectedLayout:g}=this,{portalTemplateIds:w,browseTemplates:S,templatesInfo:T}=p,E=p.defaultTemplates.filter(({layoutItem:F})=>w.includes(F==null?void 0:F.id)),C=p.defaultTemplates.filter(({layoutItem:F})=>!w.includes(F==null?void 0:F.id)),L=u&&C.length;n?(L?Fg(C,n):T!=null&&T.layout.choiceList.includes(n))||Fg(E,n)||Fg(S,n)||(this.templateOptions.layout=null,this.templateOptions.layoutItem=null):(g&&((L?Fg(C,g):T!=null&&T.layout.choiceList.includes(g))||Fg(E,g)||Fg(S,g))?await this._applyTemplate(g):(this.templateOptions.layout=null,this.templateOptions.layoutItem=null),this.templateOptions.layout||L||!o||await this._applyTemplate(o)),this._selectedLayout=this.templateOptions.layout;const R=!!this.templateOptions.layout&&this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];this.templateOptions.customTextElements=R?ae(R):null}),ce(()=>this.templateOptions.dpi,n=>{n<=0&&(this.templateOptions.dpi=1)}),ce(()=>{var n;return(n=this.viewModel.view)==null?void 0:n.scale},n=>{!n||this.templateOptions.scaleEnabled&&this.templateOptions.scale||(this.templateOptions.scale=n)})]);const{height:e,width:i}=this.templateOptions;this.templateOptions.width=i||800,this.templateOptions.height=e||1100;const r=setTimeout(()=>{this._awaitingServerResponse=!0,this.scheduleRender()},500);this.viewModel.load().then(()=>{clearTimeout(r),this._awaitingServerResponse=!1})}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),block:()=>ie(()=>import("./calcite-block-DOM6q34Z.js"),__vite__mapDeps([281,267,227,220,221,225,226,228,248,224,247,244,245,233,223,229,230,241,242,243,246,249,264,250])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),checkbox:()=>ie(()=>import("./calcite-checkbox-UYHQBuOi.js"),__vite__mapDeps([341,220,219,221,226,222,223,224])),combobox:()=>ie(()=>import("./calcite-combobox-DJcusimv.js"),__vite__mapDeps([282,283,262,245,220,244,219,221,222,223,224,225,226,227,247,228,253,284,236,229,285,267,255])),"combobox-item":()=>ie(()=>import("./calcite-combobox-item-C0Ck8epN.js"),__vite__mapDeps([286,285,267,227,220,221,284,223,229])),flow:()=>ie(()=>import("./calcite-flow-CExHLkC9.js"),__vite__mapDeps([238,227,224])),"flow-item":()=>ie(()=>import("./calcite-flow-item-BieRNoUa.js"),__vite__mapDeps([239,220,221,224,225,226,227,228,240,241,242,233,223,229,230,243,244,245,246,247,248,249,250])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),input:()=>ie(()=>import("./calcite-input-Dl0Mk_X_.js"),__vite__mapDeps([251,252,220,219,221,226,222,223,224,225,227,228,253,254,229,255,256])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227])),switch:()=>ie(()=>import("./calcite-switch-Bg2wMLH-.js"),__vite__mapDeps([269,220,219,221,226,222,223,224])),chip:()=>ie(()=>import("./calcite-chip-CizeI5-9.js"),__vite__mapDeps([235,236,220,224,228,225,226,227,221,223,229]))})}destroy(){this.viewModel.destroy()}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get icon(){return"print"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get showPrintAreaEnabled(){return this.viewModel.showPrintAreaEnabled}set showPrintAreaEnabled(e){this.viewModel.showPrintAreaEnabled=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get templateOptions(){return this.viewModel.templateOptions}set templateOptions(e){this.viewModel.templateOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var to,On,Is,sa,Ha,oa,hn,Wl,sg,og;const{messages:e,templateOptions:i,viewModel:r,view:n}=this,{attributionEnabled:o,author:u,copyright:p,dpi:g,format:w,height:S,layout:T,legendEnabled:E,northArrowEnabled:C,scaleEnabled:L,scale:R,width:F}=i,V=r.state!=="ready"||this._awaitingServerResponse||!T,U=this._renderTitleOrFileNameSection(),W=N("div",{class:Ye.formSectionContainer},N("calcite-label",null,e.fileFormatTitle,N("calcite-combobox",{clearDisabled:!0,label:e.formatDefaultOption,maxItems:6,placeholder:e.formatDefaultOption,selectionMode:"single-persist",onCalciteComboboxChange:({target:Eo})=>{this.templateOptions.format=Eo.selectedItems[0].value}},(On=(to=r.templatesInfo)==null?void 0:to.format)==null?void 0:On.choiceList.sort().map((Eo,hw)=>N("calcite-combobox-item",{key:`file-format-${hw}`,selected:Eo===this.templateOptions.format,textLabel:xae(Eo),value:Eo}))))),H=N("calcite-label",{layout:"inline"},N("calcite-switch",{checked:this.showPrintAreaEnabled,onCalciteSwitchChange:Eo=>{this.showPrintAreaEnabled=!!Eo.target.checked}}),e.printPreview),J=N("div",null,N("div",{class:Ye.formSectionContainer},N("calcite-label",null,e.template,N("div",{class:Ye.templateSelectContainer,onclick:()=>{this._showTemplates=!0}},N("calcite-block",{class:Ye.templateSelectBlock,description:this._getPageSizeLabel(T),heading:this._getTemplateLabel()}),N("calcite-icon",{class:Ye.templateSelectIcon,icon:Nm()?"chevron-left":"chevron-right",scale:"s"})))),H),X=N("div",{class:Ye.formSectionContainer},N("calcite-label",null,e.dpi,N("calcite-input",{bind:this,"data-input-name":"dpi",min:1,tabIndex:0,type:"number",value:`${g}`,onCalciteInputInput:this._handleDPIChange}))),te=N("div",{class:this.classes(Ye.scaleInfoContainer,Ye.formSectionContainer)},N("calcite-label",{layout:"inline"},N("calcite-checkbox",{bind:this,checked:L,"data-option-name":"scaleEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),e.scale),N("div",{class:Ye.scaleInputContainer},N("calcite-input",{"aria-label":e.scaleLabel,"aria-valuenow":`${R}`,bind:this,class:Ye.scaleInput,"data-input-name":"scale",disabled:!L,tabIndex:0,type:"number",value:`${R}`,onCalciteInputInput:this._updateInputValue}),N("calcite-button",{appearance:"outline","aria-label":e.reset,bind:this,disabled:!L,iconStart:"refresh",kind:"neutral",onclick:this._resetToCurrentScale,tabIndex:0}))),oe=N("div",{"aria-labelledby":`${this.id}__advancedOptionsForLayout`,class:Ye.advancedOptionsContainer,key:"advanced-section-for-layout"},te,((sa=(Is=this.viewModel.layoutTemplateInfo)==null?void 0:Is.layoutOptions)==null?void 0:sa.hasAuthorText)??1?N("div",{class:Ye.formSectionContainer,key:"author-info"},N("calcite-label",null,e.author,N("calcite-input",{bind:this,"data-input-name":"author",tabIndex:0,value:u??"",onCalciteInputInput:this._updateInputValue}))):null,((oa=(Ha=this.viewModel.layoutTemplateInfo)==null?void 0:Ha.layoutOptions)==null?void 0:oa.hasCopyrightText)??1?N("div",{class:Ye.formSectionContainer,key:"copyright-text"},N("calcite-label",null,e.copyright,N("calcite-input",{bind:this,"data-input-name":"copyright",tabIndex:0,value:p??"",onCalciteInputInput:this._updateInputValue}))):null,X,this._renderCustomTextElementSection(),((Wl=(hn=this.viewModel.layoutTemplateInfo)==null?void 0:hn.layoutOptions)==null?void 0:Wl.hasLegend)??1?N("div",{class:Ye.formSectionContainer,key:"legend-info"},N("calcite-label",{layout:"inline"},N("calcite-checkbox",{bind:this,checked:E,"data-option-name":"legendEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),e.legend)):null,this.viewModel.layoutTemplateNorthArrowInfo?N("div",{class:Ye.formSectionContainer,key:"north-arrow"},N("calcite-label",{layout:"inline"},N("calcite-checkbox",{bind:this,checked:C,"data-option-name":"northArrowEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),e.northArrow)):null),pe=N("div",{"aria-labelledby":`${this.id}__advancedOptionsForMapOnly`,class:Ye.advancedOptionsContainer},te,X,N("div",{class:Ye.formSectionContainer},N("calcite-label",{layout:"inline"},N("calcite-checkbox",{bind:this,checked:o,"data-option-name":"attributionEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),e.attribution)),this._renderCustomTextElementSection()),de=this.exportedLinks.toArray(),ge=this._renderExportedLink(de),we={[Ye.exportSectionCentered]:!de.length},ke=this._selectedTab===Bt.layout?N("section",{"aria-labelledby":`${this.id}__layoutTab`,class:Ye.layoutSection,id:`${this.id}__layoutContent`,key:"esri-print__layoutContent",role:"tabpanel"},N("div",{class:Ye.panelContainer},((og=(sg=this.viewModel.layoutTemplateInfo)==null?void 0:sg.layoutOptions)==null?void 0:og.hasTitleText)??1?U:null,J,this._selectedTab===Bt.layout?W:null,N("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(Ye.panelContainer,Ye.advancedOptionsSection),collapsible:!0,disabled:!T,heading:e.advancedOptions,id:"advancedOptionsForLayout",key:"advanced-options-for-layout"},oe))):this._selectedTab===Bt.mapOnly?N("section",{"aria-labelledby":`${this.id}__mapOnlyTab`,class:Ye.mapOnlySection,id:`${this.id}__mapOnlyContent`,key:"esri-print__mapOnlyContent",role:"tabpanel"},N("div",{class:Ye.panelContainer},U,W,N("div",null,N("div",{class:this.classes(Ye.sizeContainer,Ye.formSectionContainer)},N("calcite-label",null,e.width,N("calcite-input",{bind:this,"data-input-name":"width",tabIndex:0,type:"number",value:`${F}`,onCalciteInputInput:this._updateInputValue})),N("calcite-label",null,e.height,N("calcite-input",{bind:this,"data-input-name":"height",tabIndex:0,type:"number",value:`${S}`,onCalciteInputInput:this._updateInputValue})),N("button",{"aria-label":e.swap,bind:this,class:this.classes(Ee.widgetButton,Ye.swapButton,$n.swap),onclick:this._switchInput,tabIndex:0,type:"button"})),H),N("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(Ye.panelContainer,Ye.advancedOptionsSection),collapsible:!0,heading:e.advancedOptions,id:"advancedOptionsForMapOnly",key:"advanced-options-for-map-only"},pe))):N("section",{"aria-labelledby":`${this.id}__exportTab`,class:this.classes(Ye.exportSection,we),id:`${this.id}__exportContent`,key:"esri-print__exportContent",role:"tabpanel"},N("div",{class:Ye.panelContainer},N("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:Ye.exportedFilesContainer},de.length===0?N("div",{class:Ye.exportedFilesEmpty},N("calcite-icon",{icon:"file",scale:"l"}),N("div",null,N(jl,{class:Ye.exportedFilesTitle,level:this.headingLevel},e.noExportedFiles),N("div",null,e.exportHint))):ge))),$e={[Ee.buttonDisabled]:V||!T&&!w},Fe=!n||n.type!=="2d",yt=N("div",{class:Ye.panelError},Fe?e.sceneViewError:e.serviceError),qe=de.some(({state:Eo})=>Eo==="pending"),Ue=N("div",{class:Ye.content,key:"panel"},N("div",null,N("ul",{bind:this,class:Ye.layoutTabList,onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},N("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===Bt.layout}`,class:Ye.layoutTab,"data-tab-id":Bt.layout,id:`${this.id}__layoutTab`,role:"tab",tabIndex:0},e.layoutTab),N("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===Bt.mapOnly}`,class:Ye.layoutTab,"data-tab-id":Bt.mapOnly,id:`${this.id}__mapOnlyTab`,role:"tab",tabIndex:0},e.mapOnlyTab),N("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===Bt.export}`,class:Ye.layoutTab,"data-tab-id":Bt.export,id:`${this.id}__exportedFilesTab`,role:"tab",tabIndex:0},qe?N("calcite-loader",{inline:!0,label:"loading",scale:"s"}):null,e.exportsTab)),ke),this._selectedTab!==Bt.export?N("button",{"aria-label":e.exportDescription,bind:this,class:this.classes(Ye.printButton,Ee.button,$e),disabled:V,onclick:this._handlePrintMap,tabIndex:0,type:"button"},e.export):null),ei=N("calcite-flow",{key:"root-flow"},N("calcite-flow-item",{bind:this,key:"root-flow-item"},N("div",{class:Ye.printWidgetContainer},N("header",{class:Ye.headerTitle},e.export),this.error||Fe||!n?yt:Ue)),this._renderChooseTemplateFlowItem()),jr=r.state==="initializing",cs=jr?this._renderLoader():ei,eo={[Ye.panelItemsCentered]:jr};return N("div",{bind:this,class:this.classes(Ye.base,Ee.widget,Ee.panel,eo)},cs)}_getPageSizeLabel(e){if(!e)return;const i=this.viewModel.getLayoutTemplateInfo(e);if(!i)return;const r=mje.fromJSON(i.pageUnits.toLowerCase());return`${as(i.pageSize[0])} x ${as(i.pageSize[1])} ${jR(this.messagesUnits,r,"abbr")}`}_getTemplateLabel(){var p;const{messages:e,includeDefaultTemplates:i,templateOptions:r,viewModel:n}=this,{layout:o}=r,u=o?(i?n.defaultTemplates.find(({layoutItem:g,layout:w})=>o===(g==null?void 0:g.id)||o===w):null)??n.browseTemplates.find(({layoutItem:g})=>o===(g==null?void 0:g.id)):null;return((p=u==null?void 0:u.label)==null?void 0:p.replaceAll("_"," "))??e[o]??(o==null?void 0:o.replaceAll("_"," "))??e.selectTemplate}_renderChooseTemplateFlowItem(){var L,R;if(!this._showTemplates)return null;const{includeDefaultTemplates:e,messages:i,viewModel:r}=this,{defaultTemplates:n,templatesInfo:o,browseTemplates:u,portalTemplateIds:p}=r,g=W7.test((L=this.portal)==null?void 0:L.url),w=u.length?u.toArray().sort((F,V)=>(F.label??"")>(V.label??"")?1:-1).map((F,V)=>{var J,X,te;const U=((J=F.layoutItem)==null?void 0:J.id)??F.layout,W=this._getPageSizeLabel(U),H=U===this.templateOptions.layout;return N("calcite-list-item",{description:W,key:`browse-template-${V}`,label:((X=F==null?void 0:F.label)==null?void 0:X.replaceAll("_"," "))??i.untitled,selected:H,title:F.description??"",value:U},!W&&H&&((te=F.layoutItem)!=null&&te.id)?N("calcite-loader",{inline:!0,key:`browse-template-loader-${V}`,label:"loading",scale:"s",slot:"content-end"}):null,N("calcite-action",{icon:"trash",onclick:()=>r.removePortalTemplate(F),slot:"actions-end",text:"delete"}))}):null,S=n.length&&e?n.toArray().filter(({label:F,layoutItem:V})=>!a4(F)&&p.includes(V==null?void 0:V.id)).map((F,V)=>{var J,X,te;const U=((J=F.layoutItem)==null?void 0:J.id)??F.layout,W=this._getPageSizeLabel(U),H=U===this.templateOptions.layout;return N("calcite-list-item",{description:W,key:`portal-template-${U}-${H}`,label:((X=F==null?void 0:F.label)==null?void 0:X.replaceAll("_"," "))??i.untitled,selected:H,title:F.description??"",value:U},!W&&H&&((te=F.layoutItem)!=null&&te.id)?N("calcite-loader",{inline:!0,key:`portal-template-loader-${V}`,label:"loading",scale:"s",slot:"content-end"}):null)}):null,T=n.length&&e?n.toArray().filter(({label:F,layoutItem:V})=>!a4(F)&&!p.includes(V==null?void 0:V.id)).sort((F,V)=>(F.label??"")>(V.label??"")?1:-1).map((F,V)=>{var J,X,te;const U=((J=F.layoutItem)==null?void 0:J.id)??F.layout,W=this._getPageSizeLabel(U),H=U===this.templateOptions.layout;return N("calcite-list-item",{description:W,key:`default-template-${V}`,label:((X=F==null?void 0:F.label)==null?void 0:X.replaceAll("_"," "))??i.untitled,selected:H,title:F.description??"",value:U},!W&&H&&((te=F.layoutItem)!=null&&te.id)?N("calcite-loader",{inline:!0,key:`default-template-loader-${V}`,label:"loading",scale:"s",slot:"content-end"}):null)}):null,E=!((R=o==null?void 0:o.layout)!=null&&R.choiceList.length)||e&&(T!=null&&T.length)?null:o.layout.choiceList.map(F=>({label:i[F]??F.replaceAll("_"," "),value:F})).sort((F,V)=>F.label>V.label?1:0).map(({label:F,value:V},U)=>N("calcite-list-item",{description:this._getPageSizeLabel(V),key:`service-template-${U}`,label:F,selected:V===this.templateOptions.layout,value:V})),C=((w==null?void 0:w.length)??0)+((S==null?void 0:S.length)??0)+((T==null?void 0:T.length)??0)+((E==null?void 0:E.length)??0)>15;return N("calcite-flow-item",{bind:this,closable:!1,heading:i.chooseTemplate,key:"template-flow-item",onCalciteFlowItemBack:F=>{F.preventDefault(),this._showTemplates=!1}},N("div",{class:Ye.templateSelectFlowItemContainer},N("div",{class:Ye.templateSelectFlowItemContent},this.browseTemplateButtonOnClick?N("calcite-button",{appearance:"outline",class:Ye.browseTemplateButtonContainer,key:"browse-template-button",onclick:this.browseTemplateButtonOnClick},"Browse Templates"):null,N("calcite-list",{filterEnabled:C,key:"template-list",selectionMode:"single-persist",onCalciteListChange:({target:F})=>this._applyTemplate(F.selectedItems[0].value)},w!=null&&w.length?N("div",{key:"my-templates"},N("div",{class:Ye.templateSelectFlowItemListHeading},i.myTemplates,N("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:i.beta},i.beta)),w):null,S!=null&&S.length?N("div",{key:"org-templates"},N("div",{class:Ye.templateSelectFlowItemListHeading},i.organizationTemplates,g?N("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:i.beta},i.beta):null),S):null,w!=null&&w.length||S!=null&&S.length?T!=null&&T.length?N("div",{key:"default-templates"},N("div",{class:Ye.templateSelectFlowItemListHeading},i.defaultTemplates),T):null:T,w!=null&&w.length||S!=null&&S.length?E!=null&&E.length?N("div",{key:"service-templates"},N("div",{class:Ye.templateSelectFlowItemListHeading},i.defaultTemplates),E):null:E)),N("div",{class:Ye.templateButtonContainer},N("calcite-button",{class:Ye.templateDoneButton,onclick:()=>this._showTemplates=!1},this.messagesCommon.done))))}_renderCustomTextElementSection(){const{customTextElements:e}=this.templateOptions;return e?N("div",{class:Ye.formSectionContainer,key:"custom-text-elements"},e.map((i,r)=>{const[n,o]=Object.entries(i)[0];return n==="date"?null:N("calcite-label",{key:`custom-text-elements-${n}-${r}`},n,N("calcite-input",{bind:this,"data-input-custom":!0,"data-input-name":n,value:o??"",onCalciteInputInput:this._updateInputValue}))})):null}async _applyTemplate(e){var S,T;if(this._abortController&&(this._abortController.abort(),this._abortController=null),!e)return;const i=this.viewModel.defaultTemplates.find(({layoutItem:E})=>e===(E==null?void 0:E.id))??this.viewModel.browseTemplates.find(({layoutItem:E})=>e===(E==null?void 0:E.id));if(!i)return this.templateOptions.layout=e,void(this.templateOptions.layoutItem=null);const{layoutItem:r}=i,n=i.format??this.templateOptions.format,o=(r==null?void 0:r.id)??i.layout??this.templateOptions.layout;if(this.templateOptions.layout=o,!i.layoutOptions)try{this._abortController=new AbortController,await this.viewModel.fetchLayoutTemplateInfo(i,{signal:this._abortController.signal})}catch{return}finally{this._abortController=null}const u=((S=i.layoutOptions)==null?void 0:S.legend)??this.templateOptions.legendEnabled,p=((T=i.layoutOptions)==null?void 0:T.northArrow)??this.templateOptions.northArrowEnabled,g=o?this.viewModel.effectiveTemplateCustomTextElements[o]:null,w=g?ae(g):null;this.templateOptions.set({customTextElements:w,format:n,layout:o,layoutItem:r,legendEnabled:u,northArrowEnabled:p})}_renderTitleOrFileNameSection(){const{title:e,fileName:i,titlePlaceHolder:r,fileNamePlaceHolder:n}=this.messages,o=this._selectedTab===Bt.layout?e:i,u=this._selectedTab===Bt.layout?r:n,p=this._selectedTab===Bt.layout?this.templateOptions.title:this.templateOptions.fileName;return N("div",{class:Ye.formSectionContainer,key:o},N("calcite-label",null,o,N("calcite-input",{placeholder:u,value:p??"",onCalciteInputInput:this._onInput})))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const i=e.getAttribute("data-tab-id");(i==="layoutTab"&&this._selectedTab===Bt.layout||i==="mapOnlyTab"&&this._selectedTab===Bt.mapOnly||i==="exportTab"&&this._selectedTab===Bt.export)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[Ye.loader]:this._awaitingServerResponse};return N("div",{class:this.classes(e),key:"loader"})}_createFileLink(e,i){const r=i||this.messages.untitled,n=e.format.toLowerCase(),o=n.includes("png")?"png":n,u=r+o;return this._exportedFileNameMap[u]!==void 0?this._exportedFileNameMap[u]++:this._exportedFileNameMap[u]=0,new $ae({name:r,extension:o,count:this._exportedFileNameMap[u]})}_resetToCurrentScale(){var e;this.templateOptions.scale=(e=this.viewModel.view)==null?void 0:e.scale}_updateCustomTextElementValue(e,i,r){e.find(n=>{const[o]=Object.entries(n)[0];return o===i})[i]=r}_updateInputValue(e){const i=e.target,r=i.getAttribute("data-input-name"),n=!!i["data-input-custom"],{templateOptions:o}=this;if(n)return void this._updateCustomTextElementValue(o.customTextElements,r,i.value);let u;if(i.type==="number"){const p=Number(i.value);if(!fje(p)){const g=o[r];return void(i.value=`${g}`)}u=p}else u=i.value;o[r]=u}_handleDPIChange(e){const{templateOptions:i}=this,r=i.dpi;this._updateInputValue(e);const n=i.dpi,{height:o,width:u}=dje(n,r,i.width,i.height);i.height=o,i.width=u}_handlePrintMap(){var o;this._pendingExportScroll=!0;const{templateOptions:e}=this,i=this.viewModel.toPrintTemplate(e),r=this._selectedTab===Bt.layout?(o=i.layoutOptions)==null?void 0:o.titleText:e.fileName,n=this._createFileLink(i,r);this.exportedLinks.add(n),this.emit("submit",{link:n}),this._selectedTab=Bt.export,this.viewModel.print(i).then(u=>{n.set({url:u&&u.url,state:"ready"})}).catch(u=>{n.set({error:u,state:"error"})}).then(()=>{this.emit("complete",{link:n}),this.scheduleRender()})}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_scrollExportIntoView(){if(!this._pendingExportScroll)return;this._pendingExportScroll=!1;const e=this._rootNode;if(!e)return;const{clientHeight:i,scrollHeight:r}=e,n=r-i;n>0&&(e.scrollTop=n)}_toggleInputValue(e){const i=e.target,r=i.getAttribute("data-option-name");this.templateOptions[r]=i.checked,r==="scaleEnabled"&&this._resetToCurrentScale()}_renderExportedLink(e){const i=this.messages,r=e.map(n=>{const{error:o,url:u,state:p}=n,g=n.formattedName??"",w=p==="error",S=p==="pending",T=p==="ready";let E=u||null;E&&(E=Tpe(E));const C=Sm(u,location.href);let L;L=S?i.pending:T?i.ready:i.errorMessage;const R=w?(o==null?void 0:o.name)==="print-task:cim-symbol-unsupported"?i.exportWebMapCIMError:i.exportWebMapError:"";return N("calcite-list-item",{"aria-label":L,class:Ye.exportedFile,"data-item":n,description:S?i.generatingExport:R||(C?i.ready:i.linkReady),key:g,label:g,title:R,onCalciteListItemSelect:this._handleLinkClick},S?N("calcite-loader",{class:Ye.exportedFileLoader,inline:!0,key:`${g}-loader`,label:i.generatingExport,scale:"m",slot:"content-start"}):N("calcite-icon",{icon:yje(n),key:`${g}-start-icon`,scale:"s",slot:"content-start"}),T?N("calcite-icon",{"aria-label":`${g}. ${i.linkReady}`,icon:C?"download-to":"launch",key:`${g}-end-icon`,scale:"s",slot:"content-end"}):null,S?null:N("calcite-action",{"aria-label":`${R}`,"data-item":n,icon:"x",key:`${g}-action`,onclick:this._removeLink,slot:"actions-end",text:`${R}`}))});return N("calcite-list",{filterEnabled:(e==null?void 0:e.length)>10},r)}_toggleLayoutPanel(e){const i=e.target;this._toggleTab(i.getAttribute("data-tab-id"))}_toggleTab(e,i=!0){var r,n;if(this._selectedTab=e,this._selectedTab===Bt.mapOnly)this.templateOptions.layout=Nae,this.templateOptions.layoutItem=null,this.templateOptions.customTextElements=null;else if(this._selectedTab===Bt.layout){const o=this._selectedLayout??(this.includeDefaultTemplates&&this.viewModel.defaultTemplates.length?null:(n=(r=this.viewModel.templatesInfo)==null?void 0:r.layout)==null?void 0:n.defaultValue);o?this._applyTemplate(o):(this.templateOptions.layout=null,this.templateOptions.layoutItem=null,this.templateOptions.customTextElements=null)}i&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const{key:i}=e,r=e.target.getAttribute("data-tab-id");if(gR(i))return this._toggleTab(r),e.preventDefault(),void e.stopPropagation();if(i==="ArrowLeft"||i==="ArrowRight"){switch(r){case Bt.layout:this._toggleTab(i==="ArrowLeft"?Bt.export:Bt.mapOnly);break;case Bt.mapOnly:this._toggleTab(i==="ArrowLeft"?Bt.layout:Bt.export);break;case Bt.export:this._toggleTab(i==="ArrowLeft"?Bt.mapOnly:Bt.layout)}e.preventDefault(),e.stopPropagation()}}};m([b()],Er.prototype,"_showTemplates",void 0),m([b()],Er.prototype,"allowedFormats",null),m([b()],Er.prototype,"allowedLayouts",null),m([b()],Er.prototype,"browseTemplateButtonOnClick",void 0),m([b()],Er.prototype,"error",null),m([b({type:Fae})],Er.prototype,"exportedLinks",void 0),m([b()],Er.prototype,"extraParameters",null),m([b()],Er.prototype,"headingLevel",void 0),m([b()],Er.prototype,"icon",null),m([b()],Er.prototype,"includeDefaultTemplates",null),m([b()],Er.prototype,"label",null),m([b(),vt("esri/widgets/Print/t9n/Print")],Er.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Er.prototype,"messagesCommon",void 0),m([b(),vt("esri/core/t9n/Units")],Er.prototype,"messagesUnits",void 0),m([b()],Er.prototype,"portal",null),m([b()],Er.prototype,"showPrintAreaEnabled",null),m([b()],Er.prototype,"printServiceUrl",null),m([b()],Er.prototype,"templateCustomTextElements",null),m([b()],Er.prototype,"templateOptions",null),m([b()],Er.prototype,"view",null),m([b({type:Rae})],Er.prototype,"viewModel",void 0),Er=m([G("esri.widgets.Print")],Er);const gje=Er;let yl=class extends Te{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=eT("hybrid",this._basemapCache),this.view=null}initialize(){ce(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},Qe)}destroy(){this.view=null,pK(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return Uye(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,i;return eT(((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return eT(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!e.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:i,state:r,view:n}=this;if(!n||r==="disabled"||r==="incompatible-next-basemap")return;const o=this._viewSpatialReferenceLocked;if(!o){if(await vr(()=>!this._nextBasemapSpatialReferenceTask.updating),i!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:u}=this._nextBasemapSpatialReferenceTask;if(u==null||Ki(n.spatialReference,u)||Eh()||Ba(n.spatialReference,u)||(this._loadingProjectionEngine=!0,await gh(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||e!==this.activeBasemap)return}n.map.basemap=i,o||this._nextBasemapSpatialReferenceTask.spatialReference==null||Ki(n.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(n.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return yK(e)}};m([b()],yl.prototype,"_loadingProjectionEngine",void 0),m([b({readOnly:!0})],yl.prototype,"_nextBasemapSpatialReferenceTask",null),m([b({readOnly:!0})],yl.prototype,"_viewSpatialReferenceLocked",null),m([b({readOnly:!0})],yl.prototype,"activeBasemap",null),m([b()],yl.prototype,"nextBasemap",void 0),m([Dt("nextBasemap")],yl.prototype,"castNextBasemap",null),m([b({readOnly:!0})],yl.prototype,"state",null),m([b()],yl.prototype,"view",void 0),m([b()],yl.prototype,"toggle",null),yl=m([G("esri.widgets.BasemapToggle.BasemapToggleViewModel")],yl);const Dae=yl,L0="esri-basemap-toggle",jw="esri-basemap-thumbnail",hc={base:L0,secondaryBasemapImage:`${L0}__image--secondary`,container:`${jw} ${L0}__container`,image:`${jw}__image ${L0}__image`,imageLoading:`${L0}__image--loading`,overlay:`${jw}__overlay ${L0}__image-overlay`,title:`${jw}__title ${L0}__title`,overlayScrim:`${jw}__overlay-scrim`};function OB(t){const e=yK(t);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const PB={title:!1};let ml=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Dae,this.visibleElements={...PB},this.toggle=()=>this.viewModel.toggle()}loadDependencies(){return zi({button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),scrim:()=>ie(()=>import("./calcite-scrim-CBy6Hnad.js"),__vite__mapDeps([268,250,225,220,226,227,228,230]))})}get activeBasemap(){return this.viewModel.activeBasemap}get icon(){return"layer-basemap"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...PB,...e}}render(){const e=this.viewModel,i=e.state==="disabled"?null:e.activeBasemap,r=e.state==="disabled"?null:e.nextBasemap,n=e.state==="loading",o=e.state==="incompatible-next-basemap",u=(r==null?void 0:r.title)??"",p=r&&r.loadStatus!=="loaded";let g;const w=this.visibleElements.title&&u,S=o;return(w||S)&&(g=N("div",{class:hc.overlay,key:"overlay"},w?N("span",{class:hc.title,title:u},u):null,S?N("calcite-scrim",{class:hc.overlayScrim,title:this.messages.incompatibleSpatialReference},N("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),N("div",{class:this.classes(hc.base,Ee.widget)},N("calcite-button",{appearance:"transparent","data-basemap-id":r?r.id:"",disabled:o,kind:"neutral",label:this.label,onclick:()=>{this.toggle()},title:this.label},N("div",{class:this.classes(hc.container,hc.secondaryBasemapImage)},N("div",{class:hc.image,styles:OB(i)})),N("div",{class:hc.container},N("div",{class:this.classes(hc.image,p?hc.imageLoading:null),styles:OB(r)},p||n?N("calcite-scrim",null,N("span",{"aria-hidden":"true",class:Ee.loaderAnimation,role:"presentation"})):null),g)))}};m([b({readOnly:!0})],ml.prototype,"activeBasemap",null),m([b()],ml.prototype,"icon",null),m([b()],ml.prototype,"label",null),m([b(),vt("esri/widgets/BasemapToggle/t9n/BasemapToggle")],ml.prototype,"messages",void 0),m([b()],ml.prototype,"nextBasemap",null),m([b()],ml.prototype,"view",null),m([b({type:Dae})],ml.prototype,"viewModel",void 0),m([b()],ml.prototype,"visibleElements",void 0),m([Dt("visibleElements")],ml.prototype,"castVisibleElements",null),ml=m([G("esri.widgets.BasemapToggle")],ml);const vje=ml;function RB(t,e){const i=t.featureReduction;return i&&i.type!=="selection"&&(!("maxScale"in i)||!i.maxScale||i.maxScale<e.scale)?i:null}const V3=-1;let qc=class extends Te{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=me("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(FB(e))}catch(i){this._transitionTo([]),fe.getLogger(this).warn("Invalid Effect",{effect:e,error:i})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&NB(this._current,FB(e),this.scale)}catch{return!1}}transitionStep(e,i){this._applyTimeTransition(e),this._updateForScale(i)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&NB(this._current,e,this.scale)?(this._final=e,this._to=ae(e),bje(this._current,this._to,this.scale),this._from=ae(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?ae(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const i=Math.min(1,this._time/this.duration);for(let r=0;r<this._current.length;r++){const n=this._current[r],o=this._from[r],u=this._to[r];n.scale=wje(o.scale,u.scale,i);for(let p=0;p<n.effects.length;p++){const g=n.effects[p],w=o.effects[p],S=u.effects[p];g.interpolate(w,S,i)}}i===1&&(this._current=this._final,this._set("effects",this._current[0]?ae(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const i=this._current,r=this._current.length-1;let n,o,u=1;if(i.length===1||e>=i[0].scale)o=n=i[0].effects;else if(e<=i[r].scale)o=n=i[r].effects;else for(let p=0;p<r;p++){const g=i[p],w=i[p+1];if(g.scale>=e&&w.scale<=e){u=(e-g.scale)/(w.scale-g.scale),n=g.effects,o=w.effects;break}}for(let p=0;p<this.effects.length;p++)this.effects[p].interpolate(n[p],o[p],u)}};function FB(t){const e=U8(t)||[];return _je(e)?[{scale:V3,effects:e}]:e}function NB(t,e,i){var r,n,o,u;return!((r=t[0])!=null&&r.effects)||!((n=e[0])!=null&&n.effects)?!0:!((((o=t[0])==null?void 0:o.scale)===V3||((u=e[0])==null?void 0:u.scale)===V3)&&(t.length>1||e.length>1)&&i<=0)&&cK(t[0].effects,e[0].effects)}function bje(t,e,i){const r=t.length>e.length?t:e,n=t.length>e.length?e:t,o=n[n.length-1],u=(o==null?void 0:o.scale)??i,p=(o==null?void 0:o.effects)??[];for(let g=n.length;g<r.length;g++)n.push({scale:u,effects:[...p]});for(let g=0;g<r.length;g++)n[g].scale=n[g].scale===V3?i:n[g].scale,r[g].scale=r[g].scale===V3?i:r[g].scale,hK(n[g].effects,r[g].effects)}function wje(t,e,i){return t+(e-t)*i}function _je(t){const e=t[0];return!!e&&"type"in e}m([b()],qc.prototype,"_to",void 0),m([b()],qc.prototype,"duration",void 0),m([b({value:""})],qc.prototype,"effect",null),m([b({readOnly:!0})],qc.prototype,"effects",void 0),m([b({readOnly:!0})],qc.prototype,"hasEffects",null),m([b({value:0})],qc.prototype,"scale",null),m([b({readOnly:!0})],qc.prototype,"transitioning",null),qc=m([G("esri.layers.effects.EffectView")],qc);const jae=96;function qnt(t,e){const i=t.extent,r=t.width,n=hr(i==null?void 0:i.spatialReference);return i&&r?i.width/r*n*pP*jae:0}function Sje(t,e){return t/(hr(e)*pP*jae)}function xje(t,e){const i=t.extent,r=t.width-(t.padding?t.padding.left+t.padding.right:0),n=Sje(e,i.spatialReference);return i.clone().expand(n*r/i.width)}function $je(t,e,i){return Tje(t,e)&&Eje(t,i)}function Tje(t,e){return e===0||Sv(t,e)||t<e}function Eje(t,e){return e===0||Sv(t,e)||t>e}function Hnt(t,e,i){return e.flatten(({sublayers:n})=>n).length!==t.length?!0:!!t.some(n=>n.originIdOf("minScale")>i||n.originIdOf("maxScale")>i||n.originIdOf("renderer")>i||n.originIdOf("labelingInfo")>i||n.originIdOf("opacity")>i||n.originIdOf("labelsVisible")>i||n.originIdOf("source")>i)||!Vae(t,e)}function Ije(t,e,i){return!!t.some(r=>{const n=r.source,o=!n||n.type==="map-layer"&&n.mapLayerId===r.id&&(n.gdbVersion==null||n.gdbVersion===i);return r.commitProperty("renderer"),r.commitProperty("labelingInfo"),r.commitProperty("opacity"),r.commitProperty("labelsVisible"),!o||r.originIdOf("renderer")>ut.SERVICE||r.originIdOf("labelingInfo")>ut.SERVICE||r.originIdOf("opacity")>ut.SERVICE||r.originIdOf("labelsVisible")>ut.SERVICE})||!Vae(t,e)}function Vae(t,e){if(!(t!=null&&t.length)||e==null)return!0;const i=e.slice().reverse().flatten(({sublayers:o})=>o&&o.toArray().reverse()).map(o=>o.id).toArray();if(t.length>i.length)return!1;let r=0;const n=i.length;for(const{id:o}of t){for(;r<n&&i[r]!==o;)r++;if(r>=n)return!1}return!0}function Wnt(t){return!!t&&t.some(e=>{var i;return e.minScale!=null||((i=e.layerDefinition)==null?void 0:i.minScale)!=null})}const Mje={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let gl=class extends Te{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(i=>{const r=aB(this.floors,i);return i.toExportImageJSON(r)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&Ije(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",i=>this.notifyChange(Mje[i.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(i=>i.id).join(","):"show:-1":null}get layerDefs(){var r;const e=!!((r=this.floors)!=null&&r.length),i=this.visibleSublayers.filter(n=>n.definitionExpression!=null||e&&n.floorInfo!=null);return i.length?JSON.stringify(i.reduce((n,o)=>{const u=aB(this.floors,o),p=aS(u,o.definitionExpression);return p!=null&&(n[o.id]=p),n},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const i=this.layer.sublayers,r=this.scale,n=u=>{u.visible&&(r===0||$je(r,u.minScale,u.maxScale))&&(u.sublayers?u.sublayers.forEach(n):e.unshift(u))};i&&i.forEach(n);const o=this._get("visibleSublayers");return!o||o.length!==e.length||o.some((u,p)=>e[p]!==u)?e:o}toJSON(){const e=this.layer;let i={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?i.dynamicLayers=this.dynamicLayers:i={...i,layers:this.layers,layerDefs:this.layerDefs},i}};m([b({readOnly:!0})],gl.prototype,"dynamicLayers",null),m([b()],gl.prototype,"floors",void 0),m([b({readOnly:!0})],gl.prototype,"hasDynamicLayers",null),m([b()],gl.prototype,"layer",null),m([b({readOnly:!0})],gl.prototype,"layers",null),m([b({readOnly:!0})],gl.prototype,"layerDefs",null),m([b({type:Number})],gl.prototype,"scale",void 0),m([b({readOnly:!0})],gl.prototype,"version",null),m([b({readOnly:!0})],gl.prototype,"visibleSublayers",null),gl=m([G("esri.layers.support.ExportImageParameters")],gl);const kje=9999999e31,Cje=2e-7,Aje={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function o7(t){return Aje[t]??[-34028234663852886e22,34028234663852886e22]}function Znt(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function Knt(t){return((t==null?void 0:t.startsWith("s"))||(t==null?void 0:t.startsWith("u")))??!1}function Ynt(t,e,i){var E,C;if(t.depthCount&&t.depthCount>1)return;const{pixels:r,statistics:n,pixelType:o}=t,u=r[0].length,p=t.bandMasks??[],g=t.mask??new Uint8Array(u).fill(255),w=o==="f32"||o==="f64",S=o7(o);let T=!1;for(let L=0;L<r.length;L++){const R=typeof e=="number"?e:e[L];if(R==null)continue;const F=((E=n==null?void 0:n[L])==null?void 0:E.minValue)??S[0],V=((C=n==null?void 0:n[L])==null?void 0:C.maxValue)??S[1];if(F>R+Number.EPSILON||V<R-Number.EPSILON)continue;const U=p[L]||g.slice(),W=r[L],H=i==null?void 0:i.customFloatTolerance;if(w&&H!==0){let J=H;J||(J=Math.abs(R)>=kje?Cje*Math.abs(R):o==="f32"?2**-23:Number.EPSILON);for(let X=0;X<W.length;X++)U[X]&&Math.abs(W[X]-R)<J&&(W[X]=0,U[X]=0,g[X]=0,T=!0)}else for(let J=0;J<W.length;J++)U[J]&&W[J]===R&&(W[J]=0,U[J]=0,g[J]=0,T=!0);p[L]=U}T&&(t.bandMasks=t.bandMasks||t.pixels.length>1?p:null,t.mask=g),T&&"updateStatistics"in t&&t.updateStatistics()}function zae(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function Xnt(t,e){if(t==null)return null;if(!zae(t))return new re("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type||t.declaredClass}'`,{renderer:t});switch(t.type){case"simple":return Lje(t,e);case"unique-value":return Oje(t,e);case"class-breaks":return Pje(t,e);case"dictionary":case"heatmap":return null}return null}function WF(t,e){if(!e)return null;let i;if(i=Array.isArray(e)?e:[e],i.length>0){const r=i.map(o=>o.details.symbol.type||o.details.symbol.declaredClass).filter(o=>!!o);r.sort();const n=[];return r.forEach((o,u)=>{u!==0&&o===r[u-1]||n.push(o)}),new re("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:i})}return null}function Lje(t,e){const i={...Mp,...e,cimFallbackEnabled:!0};return WF(t,Pm(t.symbol,i).error)}function Oje(t,e){var o;const i={...Mp,...e,cimFallbackEnabled:!0},r=(o=t.uniqueValueInfos)==null?void 0:o.map(u=>Pm(u.symbol,i).error).filter(Rt),n=Pm(t.defaultSymbol,i);return n.error&&(r==null||r.unshift(n.error)),WF(t,r)}function Pje(t,e){const i={...Mp,...e,cimFallbackEnabled:!0},r=t.classBreakInfos.map(o=>Pm(o.symbol,i).error).filter(Rt),n=Pm(t.defaultSymbol,i);return n.error&&r.unshift(n.error),WF(t,r)}var DB,jB,VB,zB,UB,GB,BB,qB,HB,WB,JB,ZB,KB,YB,XB,QB,eq,tq,iq,rq,nq,sq,oq,aq,lq,uq,cq,hq,pq,dq,fq,yq,mq,gq,vq,bq,wq,_q,Sq,xq,$q,Tq,Eq,Iq,Mq,kq,Cq,Aq,Lq,Oq,Pq,Rq,Fq,Nq,Dq,jq,Vq,zq,Uq,Gq,Bq;(function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"})(DB||(DB={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(jB||(jB={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(VB||(VB={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(zB||(zB={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(UB||(UB={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(GB||(GB={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(BB||(BB={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(qB||(qB={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(HB||(HB={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(WB||(WB={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(JB||(JB={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(ZB||(ZB={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(KB||(KB={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(YB||(YB={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(XB||(XB={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(QB||(QB={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(eq||(eq={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(tq||(tq={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(iq||(iq={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(rq||(rq={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks"}(nq||(nq={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(sq||(sq={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(oq||(oq={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(aq||(aq={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(lq||(lq={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(uq||(uq={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(cq||(cq={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(hq||(hq={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(pq||(pq={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(dq||(dq={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(fq||(fq={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(yq||(yq={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(mq||(mq={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(gq||(gq={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(vq||(vq={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(bq||(bq={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(wq||(wq={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(_q||(_q={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(Sq||(Sq={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(xq||(xq={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}($q||($q={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(Tq||(Tq={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(Eq||(Eq={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(Iq||(Iq={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(Mq||(Mq={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(kq||(kq={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(Cq||(Cq={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(Aq||(Aq={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(Lq||(Lq={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(Oq||(Oq={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(Pq||(Pq={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(Rq||(Rq={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(Fq||(Fq={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(Nq||(Nq={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(Dq||(Dq={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(jq||(jq={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(Vq||(Vq={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(zq||(zq={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(Uq||(Uq={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(Gq||(Gq={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(Bq||(Bq={}));var a7;function Rje(t){switch(t){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function JF(t){var e;return(t==null?void 0:t.type)==="CIMVectorMarker"?(e=t.markerGraphics)==null?void 0:e[0]:void 0}function Uae(t){var e,i;return((e=t==null?void 0:t.symbol)==null?void 0:e.type)==="CIMPolygonSymbol"?(i=t.symbol.symbolLayers)==null?void 0:i[0]:void 0}function Fje(t,e){(t==null?void 0:t.type)==="CIMVectorMarker"&&e!=null&&(t.size=e)}function Nje(t,e){const i=JF(t);i&&e!=null&&(i.geometry=Rje(e))}function Dje(t,e){const i=Uae(JF(t));i&&e!=null&&(i.color=e.toArray())}function jje(t,e,i){const r=Uae(JF(t));r&&e!=null&&i&&(r.colorLocked=e)}function Gae(t,e){var w;const{outerRingSize:i,innerDotSize:r,type:n,color:o,colorLocked:u,primitiveOverrides:p}=e,g=((w=t.data.symbol)==null?void 0:w.type)==="CIMPolygonSymbol"?t.data.symbol.symbolLayers:null;if((g==null?void 0:g.length)===2)for(const S of g){const T=S.primitiveName===a7.OuterRing;Fje(S,T?i:r),Nje(S,n),Dje(S,o),jje(S,u,T)}return i!=null&&r!=null&&(t.data.primitiveOverrides=null),p!==void 0&&(t.data.primitiveOverrides=ae(p)),t}(function(t){t.OuterRing="reference-size-outer-ring",t.InnerDot="reference-size-inner-dot"})(a7||(a7={}));function Vje(t,e,i){const r=t.effectiveClusterRenderer;if(!r||!("visualVariables"in r)||!r.visualVariables)return null;const n=r.visualVariables.find(S=>S.type==="size");if(!("stops"in n)||!n.stops)return null;const o=n.stops.find(S=>S.useMinValue),u=n.stops.find(S=>S.useMaxValue);if(o==null||u==null)return null;const p=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,g=n.field,w=e.getDisplayStatistics(p,g);return w?new mS({field:n.field,minSize:t.clusterMinSize,minDataValue:w.minValue,maxSize:t.clusterMaxSize,maxDataValue:w.maxValue}):null}const zje=/^-?(\d+)(\.(\d+))?$/i;function Uje(t,e){return t-e}function Gje(t,e){let i,r;return i=Number(t.toFixed(e)),i<t?r=i+1/10**e:(r=i,i-=1/10**e),i=Number(i.toFixed(e)),r=Number(r.toFixed(e)),[i,r]}function Bje(t,e,i,r,n){const o=T5(t,e,i,r),u=o.previous==null||o.previous<=n,p=o.next==null||o.next<=n;return u&&p||o.previous+o.next<=2*n}function dI(t){const e=String(t),i=e.match(zje);if(i!=null&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const r=e.split("e"),n=r[0],o=r[1];if(n&&o){const u=Number(n);let p=Number(o);const g=p>0;g||(p=Math.abs(p));const w=dI(u);return g?(w.integer+=p,p>w.fractional?w.fractional=0:w.fractional-=p):(w.fractional+=p,p>w.integer?w.integer=1:w.integer-=p),w}}return{integer:0,fractional:0}}function T5(t,e,i,r){const n={previous:null,next:null};if(i!=null){const o=t-i,u=e-i-o;n.previous=Math.floor(Math.abs(100*u/o))}if(r!=null){const o=r-t,u=r-e-o;n.next=Math.floor(Math.abs(100*u/o))}return n}function fI(t,e={}){const i=t.slice(0),{tolerance:r=2,strictBounds:n=!1,indexes:o=i.map((u,p)=>p)}=e;o.sort(Uje);for(let u=0;u<o.length;u++){const p=o[u],g=i[p],w=p===0?null:i[p-1],S=p===i.length-1?null:i[p+1],T=dI(g).fractional;if(T){let E,C=0,L=!1;for(;C<=T&&!L;){const R=Gje(g,C);E=n&&u===0?R[1]:R[0],L=Bje(g,E,w,S,r),C++}L&&(i[p]=E)}}return i}const qje={maximumFractionDigits:20};function Hje(t){return as(t,qje)}const Bae="<",qae=">";function Hae(t,e,i,r){let n="";return e===0?n=`${Bae} `:e===i&&(n=`${qae} `),n+(r?VR(t,r):Hje(t))}const Wje=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function l7(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(u=>u.type==="color");if(!e)return null;let i=null,r=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;i=e.stops[0].value,r=e.stops[e.stops.length-1].value}const n=i!=null&&r!=null?i+(r-i)/2:0,{getColor:o}=await ie(async()=>{const{getColor:u}=await Promise.resolve().then(()=>Ym);return{getColor:u}},void 0);return o(e,n)??null}async function Wae(t,e){const i=t.trailCap,r=t.trailWidth||1,n=e||await l7(t)||t.color;return new cn({cap:i,color:n,width:r})}function qq(t){return t!=null&&typeof t=="object"&&"min"in t&&"max"in t}function Jje(t,e){var i,r;if(!e.field)return null;if("featureReduction"in t)switch((i=t.featureReduction)==null?void 0:i.type){case"cluster":case"binning":{const n=t.featureReduction.fields.find(({name:o})=>o.toLowerCase()===e.field.toLowerCase());return n&&"getField"in t?t.getField(n.onStatisticField):null}}return"getField"in t?(r=t.getField)==null?void 0:r.call(t,e.field):null}function Zje(t,e){var r,n,o;const i="popupTemplate"in t?(r=t.popupTemplate)==null?void 0:r.fieldInfos:null;if(i!=null&&i.length&&e)return(o=(n=i.find(u=>{var p;return((p=u.fieldName)==null?void 0:p.toLowerCase())===e.toLowerCase()}))==null?void 0:n.format)==null?void 0:o.dateFormat}function Kje(t,e,i){var o,u,p,g;const r=Jje(t,e);if(!r||!P3(r)&&!db(r))return null;let n=Zje(t,r.name);if(!n&&r.type==="date"){let w=0,S=0;e.stops?(w=((u=(o=e.stops)==null?void 0:o.at(0))==null?void 0:u.value)??w,S=((g=(p=e.stops)==null?void 0:p.at(-1))==null?void 0:g.value)??S):"minDataValue"in e&&"maxDataValue"in e&&(w=e.minDataValue??w,S=e.maxDataValue??S),n=S-w>2*SC.days?"short-date":"short-date-short-time"}return{fieldType:r.type,format:n,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function u7(t){var e,i;if("authoringInfo"in t)return(i=(e=t.authoringInfo)==null?void 0:e.visualVariables)==null?void 0:i.find(({theme:r})=>r==="reference-size")}const Yje=new Ce([64,64,64]);function Jae(t,e){const i=[],r=t.length-1;return t.length===5?i.push(0,2,4):i.push(0,r),t.map((n,o)=>i.includes(o)?Hae(n,o,r,e):null)}async function c7(t,e,i){let r=!1,n=[],o=[];if(t.stops){const w=t.stops;n=w.map(S=>S.value),r=w.some(S=>!!S.label),r&&(o=w.map(S=>S.label))}const u=n[0],p=n[n.length-1];if(u==null&&p==null)return null;const g=r?null:Jae(n,i);return(await Promise.all(n.map(async(w,S)=>({value:w,color:t.type==="opacity"?await Xje(w,t,e):(await ie(async()=>{const{getColor:T}=await Promise.resolve().then(()=>Ym);return{getColor:T}},void 0)).getColor(t,w),label:r?o[S]:(g==null?void 0:g[S])??""})))).reverse()}async function Xje(t,e,i){const r=new Ce(i??Yje),n=(await ie(async()=>{const{getOpacity:o}=await Promise.resolve().then(()=>Ym);return{getOpacity:o}},void 0)).getOpacity(e,t);return n!=null&&(r.a=n),r}function Qje(t){let e=!1,i=[],r=[];i=t.map(p=>p.value),e=t.some(p=>!!p.label),e&&(r=t.map(p=>p.label??""));const n=i[0],o=i[i.length-1];if(n==null&&o==null)return null;const u=e?null:Jae(i);return i.map((p,g)=>({value:p,color:Zae(p,t),label:e?r[g]:(u==null?void 0:u[g])??""})).reverse()}function Zae(t,e){const{startIndex:i,endIndex:r,weight:n}=eVe(t,e);if(i===r)return e[i].color;const o=Ce.blendColors(e[i].color,e[r].color,n);return new Ce(o)}function eVe(t,e){let i=0,r=e.length-1;return e.some((n,o)=>t<n.value?(r=o,!0):(i=o,!1)),{startIndex:i,endIndex:r,weight:(t-e[i].value)/(e[r].value-e[i].value)}}function tVe(t,e){let i=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((r,n)=>{n===0?i.push({value:e.max,color:new Ce(r.toColor),label:"high"}):i.push({value:null,color:new Ce(r.toColor),label:""}),n===t.colorRamps.length-1?i.push({value:e.min,color:new Ce(r.fromColor),label:"low"}):i.push({value:null,color:new Ce(r.fromColor),label:""})});else{let r,n;t&&t.type==="algorithmic"?(r=t.fromColor,n=t.toColor):(r=[0,0,0,1],n=[255,255,255,1]),i=[{value:e.max,color:new Ce(n),label:"high"},{value:e.min,color:new Ce(r),label:"low"}]}return i}function Kae(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let i=e.length-1;if(e&&e[0]){const r=e[i];r&&r.ratio!==1&&(e.push(new C2({ratio:1,color:r.color})),i++)}return e.map((r,n)=>{var u,p;let o="";return n===0?o=((u=t.legendOptions)==null?void 0:u.minLabel)||"low":n===i&&(o=((p=t.legendOptions)==null?void 0:p.maxLabel)||"high"),{color:r.color,label:o,ratio:r.ratio}}).reverse()}const h7=30,p7=12,d7=24,Yae=[255,255,255],ZF=[200,200,200],gv=[128,128,128],iVe=20,rVe=5;function nVe(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function sVe(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function oVe(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function aVe(t){return t.declaredClass==="esri.symbols.TextSymbol"}function lVe(t,e){const i=t.length-1;return t.map((r,n)=>Hae(r,n,i,e))}async function uVe(t,e,i,r,n,o,u){const p=e.legendOptions,g=p==null?void 0:p.customValues,w=u||await dVe(t,i),S=e.stops,T=!!w,E=!!g,C=e.minSize!=null&&e.maxSize!=null,L=S&&S.length>1,R=!!e.target;if(!T||!E&&!(C||L&&!R))return;const F=NM(w);let V=!1,U=null,W=null;U=F&&!L?fI([e.minDataValue,e.maxDataValue]):g??await yVe(e,w,r,n==null?void 0:n.type);const H=t==null?void 0:t.authoringInfo,J=(H==null?void 0:H.type)==="univariate-color-size",X=J&&(H==null?void 0:H.univariateTheme)==="above-and-below",te=!!u7(t);if(!U&&L&&(U=S.map(ge=>ge.value),V=S.some(ge=>!!ge.label),t.type==="flow"&&(U=fI(U)),V&&(W=S.map(ge=>ge.label))),F&&U!=null&&(U==null?void 0:U.length)>2&&!X&&(U=[U[0],U[U.length-1]]),!U)return null;J&&(U==null?void 0:U.length)!==5&&(U=ele({minSize:U[0],maxSize:U[U.length-1]}));const oe=F?cVe(t,U):null,pe=ROe(w),de=V?null:lVe(U,o);return(await Promise.all(U.map(async(ge,we)=>{const ke=F?oe[we]:await K1(e,w,ge,r,n==null?void 0:n.type);return{value:ge,symbol:!te||t.type!=="class-breaks"&&t.type!=="unique-value"?vVe(X&&t.type==="class-breaks"?pVe(t,we):w,ke):hVe(t,ke,e.maxSize,i)??w,label:V?W[we]:de[we],size:te?d7:ke,outlineSize:pe}}))).reverse()}function cVe(t,e){const i=t==null?void 0:t.authoringInfo,r=(i==null?void 0:i.type)==="univariate-color-size";let n=[p7,h7];if(r){const o=e[0],u=e[e.length-1],p=p7,g=h7;n=e.map(w=>p+(w-o)/(u-o)*(g-p))}return r&&(i==null?void 0:i.univariateTheme)==="below"&&n.reverse(),n}function hVe(t,e,i,r){var u,p,g,w,S,T;const n=t.type==="class-breaks",o=n?(g=(p=(u=t.classBreakInfos)==null?void 0:u[0])==null?void 0:p.symbol)==null?void 0:g.clone():(T=(S=(w=t.uniqueValueInfos)==null?void 0:w[0])==null?void 0:S.symbol)==null?void 0:T.clone();return o&&"type"in o&&o.type==="cim"?(Gae(o,{color:r??(n?null:new Ce(ZF)),innerDotSize:e*(d7/i)||1,outerRingSize:d7}),o):null}function pVe(t,e){const i=t.classBreakInfos,r=i.length,n=r<2||!(e>=2)?i[0].symbol.clone():i[r-1].symbol.clone();return t.visualVariables.some(o=>o.type==="color")&&(n.type.includes("3d")?Xae(n):Qae(n)),n}async function dVe(t,e){var n,o;if(t.type==="flow")return Wae(t,e);if(t.type==="pie-chart")return new kn({color:null,outline:(n=t.outline)!=null&&n.width?t.outline:new cn});let i=null,r=null;if(t.type==="simple")i=t.symbol;else if(t.type==="class-breaks"){const u=t.classBreakInfos;i=u&&u[0]&&u[0].symbol,r=u.length>1}else if(t.type==="unique-value"){const u=t.uniqueValueInfos;i=(o=u==null?void 0:u[0])==null?void 0:o.symbol,r=u!=null&&u.length>1}return!i||fVe(i)?null:(i=i.clone(),(e||r)&&(i.type.includes("3d")?Xae(i):Qae(i)),i)}function fVe(t){return t?mh(t)?!!t.symbolLayers&&t.symbolLayers.some(e=>e&&e.type==="fill"):t.type.includes("fill"):!1}function Xae(t){t.type==="line-3d"?t.symbolLayers.forEach(e=>{e.material={color:gv}}):t.symbolLayers.forEach(e=>{var i;e.type!=="icon"||(i=e.resource)!=null&&i.href?e.material={color:ZF}:(e.material={color:Yae},e.outline={color:gv,size:1.5})})}function Qae(t){var i,r;const e=Wre();t.type==="cim"?mse(t,new Ce(ZF)):t.type.includes("line")?t.color=gv:(t.color=e?gv:Yae,t.type==="simple-marker"&&(t.outline?((r=(i=t.outline)==null?void 0:i.color)==null?void 0:r.toHex())==="#ffffff"&&(t.outline.color=gv):t.outline={color:gv,width:1.5}))}async function yVe(t,e,i,r){const n=(await ie(async()=>{const{getSizeRangeAtScale:p}=await Promise.resolve().then(()=>Ym);return{getSizeRangeAtScale:p}},void 0)).getSizeRangeAtScale(t,i,r),o=n&&ele(n);if(!n||!o)return;let u=o.map(p=>mVe(p,t,n));u=fI(u);for(let p=1;p<u.length-1;p++){const g=await gVe(t,e,u[p],u[p-1],i,r);g&&(u[p]=g[0],o[p]=g[1])}return u}function ele(t){const e=t.minSize,i=t.maxSize,r=rVe,n=(i-e)/(r-1),o=[];for(let u=0;u<r;u++)o.push(e+n*u);return o}function mVe(t,e,i){const r=i.minSize,n=i.maxSize,o=e.minDataValue,u=e.maxDataValue;let p;return t<=r?p=o:t>=n?p=u:p=(t-r)/(n-r)*(u-o)+o,p}async function gVe(t,e,i,r,n,o){const u=await K1(t,e,i,n,o),p=await K1(t,e,r,n,o),g=dI(i),w=g.fractional,S=iVe;let T=g.integer,E=null,C=null;i>0&&i<1&&(E=10**w,T=dI(i*=E).integer);for(let L=T-1;L>=0;L--){const R=10**L;let F=Math.floor(i/R)*R,V=Math.ceil(i/R)*R;E!=null&&(F/=E,V/=E);let U=(F+V)/2;[,U]=fI([F,U,V],{indexes:[1]});const W=await K1(t,e,F,n,o),H=await K1(t,e,V,n,o),J=await K1(t,e,U,n,o),X=T5(u,W,p,null),te=T5(u,H,p,null),oe=T5(u,J,p,null);let pe=X.previous<=S,de=te.previous<=S;if(pe&&de&&(X.previous<=te.previous?(pe=!0,de=!1):(de=!0,pe=!1)),pe?C=[F,W]:de?C=[V,H]:oe.previous<=S&&(C=[U,J]),C)break}return C}async function K1(t,e,i,r,n){const{getSize:o}=await ie(()=>Promise.resolve().then(()=>Ym),void 0);return o(t,i,{scale:r,view:n,shape:e.type==="simple-marker"?e.style:null})}function vVe(t,e){const i=t.clone();if(mh(i))NM(i)||i.symbolLayers.forEach(r=>{r.type!=="fill"&&(r.size=e)});else if(nVe(i))i.size=e;else if(sVe(i)){const r=i.width,n=i.height;i.height=e,i.width=e*(r/n)}else oVe(i)?i.width=e:aVe(i)&&i.font&&(i.font.size=e);return i}bo("short-date");async function ca(t,e,i){Bf(t,e,()=>[]).push(...i)}async function Qnt(t){var i,r;const e=new Map;if(!t)return e;if("visualVariables"in t&&t.visualVariables){const n=t.visualVariables.filter(o=>o.type==="color");for(const o of n){const u=(await c7(o)??[]).map(p=>p.color);await ca(e,o.field||o.valueExpression,u)}}if(t.type==="heatmap"){const n=Kae(t).map(o=>o.color);await ca(e,t.field||t.valueExpression,n)}else if(t.type==="pie-chart"){for(const n of t.attributes)await ca(e,n.field||n.valueExpression,[n.color]);await ca(e,"default",[(i=t==null?void 0:t.othersCategory)==null?void 0:i.color,Ig(t.backgroundFillSymbol,null)])}else if(t.type==="dot-density"){for(const n of t.attributes)await ca(e,n.field||n.valueExpression,[n.color]);await ca(e,"default",[t.backgroundColor])}else if(t.type==="unique-value")if(((r=t.authoringInfo)==null?void 0:r.type)==="predominance")for(const n of t.uniqueValueInfos??[])await ca(e,n.value.toString(),[Ig(n.symbol,null)]);else{const n=(t.uniqueValueInfos??[]).map(w=>Ig(w.symbol,null)),{field:o,field2:u,field3:p,valueExpression:g}=t;(o||g)&&await ca(e,o||g,n),u&&await ca(e,u,n),p&&await ca(e,p,n)}else if(t.type==="class-breaks"){const n=t.classBreakInfos.map(p=>Ig(p.symbol,null)),{field:o,valueExpression:u}=t;await ca(e,o??u,n)}else t.type==="simple"&&await ca(e,"default",[Ig(t.symbol,null)]);return"defaultSymbol"in t&&t.defaultSymbol&&await ca(e,"default",[Ig(t.defaultSymbol,null)]),e.forEach((n,o)=>{const u=Jue(n.filter(Boolean),(p,g)=>JSON.stringify(p)===JSON.stringify(g));e.set(o,u)}),e}function bVe(t){const i=Math.floor(Math.log10(Math.abs(t)))+1,r=i<4||i>6?4:i,n=1e6,o=Math.abs(t)>=n?"compact":"standard";return as(t,{notation:o,minimumSignificantDigits:2,maximumSignificantDigits:r})}const Hq=16,wVe="https://utility.arcgis.com/sharing/tools/legend",_Ve="esri.layers.ImageryLayer",SVe="esri.layers.ImageryTileLayer",xVe="esri.layers.WCSLayer",I$=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,$Ve=new et({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),M$=new kn({size:6,outline:{color:[128,128,128,.5],width:.5}}),TVe=new na({style:"solid"});function f7(t){return t.type==="flow"}function tle(t){return t.type==="vector-field"}function ile(t){return t.type==="raster-colormap"}function rle(t){return t.type==="raster-stretch"}function nle(t){return t.type==="raster-shaded-relief"}function Y1(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function Ny(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function h2(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function sle(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function EVe(t){return KF(t)||YF(t)||XF(t)||IVe(t)}function IVe(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function KF(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function YF(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function XF(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function ole(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function ale(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function MVe(t,e){return Y1(t)||Ny(t)||h2(t)||sle(t)||ole(t)||ale(t)?e.type==="2d"||zae(t):rle(t)||ile(t)||nle(t)||KF(t)||YF(t)||XF(t)||tle(t)||f7(t)}function kVe(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function l4(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function CVe(t){return t.declaredClass==="esri.layers.VoxelLayer"}function AVe(t){return t.declaredClass==="esri.layers.WMSLayer"}function LVe(t){return t.declaredClass==="esri.layers.WMTSLayer"}function u4(t){return t.declaredClass==="esri.layers.MapImageLayer"}function Wq(t){return t.declaredClass==="esri.layers.TileLayer"}function Ng(t){return t.declaredClass===_Ve}function k$(t){return t.declaredClass===SVe}function OVe(t){return t.declaredClass===xVe}function PVe(t){return t.type==="stretch-ramp"}function RVe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"}function FVe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"&&(e==null?void 0:e.univariateTheme)==="above-and-below"}function Jq(t){return"sublayers"in t}async function Fh(t,e){const i=await DI("esri/widgets/Legend/t9n/Legend");return t!=="previewTemplateAriaLabel"||e||(t="previewAriaLabel"),qn(i[t],{label:e})}const NVe=new kn({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Dg={},rn=class extends Te{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpressionClause=null,this.children=new Ie,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([gi(()=>this.children,"change",e=>{const{added:i,removed:r}=e;i.forEach(n=>{const o=`activeLayerInfo-ready-watcher-${n.layer.uid}`;this.addHandles(ce(()=>n.ready,t,Qe),o)}),r.forEach(n=>this.removeHandles(n.layer.uid)),t()})]),this.keepCacheOnDestroy||(Dg={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(Dg=null),this._layerDefinitionExpressionClause=null}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new qc,e.effect=t.effect,e.endTransitions(),e.scale=this.scale),e}get opacity(){var n;const t=this.layer.opacity,e=(n=this.parent)==null?void 0:n.opacity,i=this.layer.parent,r=i&&"uid"in i?this._getParentLayerOpacity(i):null;return e!=null?e*t:r!=null?r*t:t}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){var t;return((t=this.view)==null?void 0:t.scale)??0}get isScaleDriven(){const t=this.layer;if(t===null)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if(t.featureReduction.type==="cluster")return!0;if(t.featureReduction.type==="binning"&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,i=>{var r;if(w2(i))return this._getRendererLegendElements(i.renderer,{title:i.title});if((r=i.featureSet)!=null&&r.features.length){const n=i.layerDefinition,o=n==null?void 0:n.drawingInfo,u=o&&Y2e(o.renderer),p=$Ve.read(n.geometryType);return u?this._getRendererLegendElements(u,{title:i.name,geometryType:p}):(fe.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const i=[],r=await Promise.allSettled(e);for(const n of r)if(n.status==="fulfilled")for(const o of n.value??[])i.push(o);this.legendElements=i,this.notifyChange("ready")}catch(i){fe.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(e){fe.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(e){fe.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){var e,i;const t=this.layer;if(CVe(t))this._constructLegendElementsForVoxelLayer();else if(LVe(t))this._constructLegendElementsForWMTSlayer();else if(AVe(t))await this._constructLegendElementsForWMSSublayers();else if(kVe(t))await this._constructLegendElementsForBuildingSceneLayer();else if(u4(t)||Wq(t)||l4(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let r="default";if(Ng(t)){const n=t;r=(((e=n==null?void 0:n.rasterFunction)==null?void 0:e.functionName)||"default")+"_"+((i=t.bandIds)!=null&&i.length?t.bandIds.join(""):"###")}if(k$(t))return;await this._getLegendLayers(`${t.uid}-${r}`).then(async n=>{this.legendElements=[],this.notifyChange("ready");const o=n.map(async u=>{if(Ng(t)){const g=ce(()=>["renderingRule"in t&&t.rasterFunction,t.bandIds],()=>Da(async()=>{Dg.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()})());this.addHandles(g,"imageryLayers-watcher")}const p=this._generateSymbolTableElementForLegendLayer(u);p!=null&&p.infos.length&&(Ng(t)&&(p.title=t.title),this.legendElements.push(p)),this.notifyChange("ready")});await Promise.allSettled(o)}).catch(n=>{fe.getLogger(this).warn("Request to server for legend has failed!",n)})}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,i=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!i&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await vr(()=>!e.updating);const r=i?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();return r?(r.geometry=this.view.extent,(i?"queryFeatureCount"in e&&await e.queryFeatureCount(r):"queryFeatureCount"in t&&await t.queryFeatureCount(r))!==0):!0}_getParentLayerOpacity(t){let e=1;const i=t.parent;return i&&"uid"in i&&(e=this._getParentLayerOpacity(i)),t.opacity*e}_isGroupActive(){return this.children.some(t=>t.ready)}_isRendererScaleDriven(t){if(t.type==="dot-density")return!0;const e="valueExpression"in t?t.valueExpression:null;if(I$.test(e))return!0;const i="visualVariables"in t?t.visualVariables:null;return!!(i!=null&&i.some(r=>this._isScaleDrivenSizeVariable(r)))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){var e;switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some(i=>this._isScaleDrivenSymbol(i.symbol));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!((e=t.uniqueValueInfos)!=null&&e.some(i=>this._isScaleDrivenSymbol(i.symbol)))}return!1}_isScaleDrivenSymbol(t){if((t==null?void 0:t.type)==="cim"){const{primitiveOverrides:e,minScale:i,maxScale:r}=t.data,n=(e==null?void 0:e.some(o=>{var u;return/\$view\.scale/.test(((u=o.valueExpressionInfo)==null?void 0:u.expression)||"")}))??!1;return i!=null||r!=null||n}return!1}_isScaleDrivenSizeVariable(t){if(t&&t.type!=="size")return!1;const e=t,i=e.minSize,r=e.maxSize;return!(typeof i!="object"||!i||!this._isScaleDrivenSizeVariable(i))||!(typeof r!="object"||!r||!this._isScaleDrivenSizeVariable(r))||I$.test(e.valueExpression)}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some(i=>this._isLayerScaleDriven(i));const e=t.parent;if(t.loaded===!1&&e&&u4(e)&&"source"in t&&t.source&&t.source.type==="map-layer"){for(const i of e.sourceJSON.layers??[])if(i.id===t.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxelLayer(){var o;this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(ce(()=>t.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable"),this.addHandles(ce(()=>t.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");const e=t.getVariableStyle(null),i=[];if(e){if((o=e.uniqueValues)!=null&&o.length){const u=[];e.uniqueValues.forEach(p=>{p.enabled&&u.push({label:p.label||`${p.value}`,value:p.value,symbol:new na({color:p.color,outline:null})})}),u.length&&i.push({type:"symbol-table",title:e.label,infos:u})}else if(e.transferFunction){const{colorStops:u,stretchRange:p}=e.transferFunction,g=u.toArray().reverse(),w=p.map((T,E)=>`${E===0?Bae:qae} ${bVe(T)}`).reverse(),S=g.map(T=>({color:T.color,value:null,label:null}));S[0].label=w[0],S[S.length-1].label=w[1],i.push({type:"color-ramp",title:e.label,infos:S,preview:Ay(g.map(T=>T.color),{ariaLabel:await Fh("previewColorRampAriaLabel")})})}}const r=t.opacity,n=i.reduce((u,p)=>[...u,...this._getAllInfos(p)],[]).filter(u=>!!(u!=null&&u.symbol)).map(u=>this._getSymbolPreview(u,r));await Promise.allSettled(n),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){var i,r;this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(ce(()=>{const{layer:n}=this;return n&&"activeLayer"in n&&n.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");const e=t.styleId?(r=(i=t.styles)==null?void 0:i.find(({id:n})=>n===t.styleId))==null?void 0:r.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(ce(()=>{const{layer:i}=this;return i&&"sublayers"in i&&i.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){var u,p;const i=this.layer,r=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const n=((p=(u=this.sublayerIds)==null?void 0:u.map(g=>i.findSublayerById(g)))==null?void 0:p.filter(Rt))??[],o=n.length?n:t.toArray();for(const g of o){const w=ce(()=>[g.title,g.visible,g.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this.addHandles(w,"wms-sublayers-watcher"),!this.respectLayerVisibility||g.visible&&g.legendEnabled){const S=await this._generateSymbolTableElementForWMSSublayer(g,e);S!=null&&S.infos.length&&r.unshift(S)}}return r}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter(r=>r);return{type:"symbol-table",title:t.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){var u;let i=t.legendUrl;if(!i)return;const r={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(i=q$(i,e));let n=null;const o=(u=t.layer)==null?void 0:u.opacity;try{n=(await nt(i,{responseType:"image"})).data,n&&(n.style.opacity=o)}catch{}return r.infos.push({src:i,preview:n,opacity:o}),r}_getLegendLayers(t,e){const i=Dg&&Dg[t];return i?Promise.resolve(i):this._legendRequest(e).then(r=>{const n=r.layers;return Dg[t]=n,n})}_legendRequest(t){var n;const e=this.layer;let i={f:"json",dynamicLayers:t};if(Ng(e)){const o=e.exportImageServiceParameters.rasterFunction;if(o&&(i.renderingRule=JSON.stringify(((n=o.functionDefinition)==null?void 0:n.toJSON())||o.toJSON())),e.bandIds&&(i.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:u,viewId:p,customParameters:g}=e;i={raster:u,viewId:p,...i,...g}}}let r=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const o=r.indexOf("?");o>-1?r=r.substring(0,o)+"/legend"+r.substring(o):r+="/legend"}else{const o=r.toLowerCase().indexOf("/rest/"),u=r.substring(0,o)+r.substring(o+5,r.length);r=wVe+"?soapUrl="+encodeURI(u)+"&returnbytes=true"}return nt(r,{query:i}).then(o=>o.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(ce(()=>t.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){fe.getLogger(this).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(t,e){let i=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const r=t.toArray();for(const n of r){const o=ce(()=>["renderer"in n&&n.renderer,n.opacity,n.title,n.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this.addHandles(o,"sublayers-watcher"),!this.respectLayerVisibility||n.visible){const u=(n==null?void 0:n.opacity)!=null?n.opacity:null,p=u!=null?u*e:e;if(n.type==="building-group"){const g={type:"symbol-table",title:n.title,infos:[]},w=await this._generateLegendElementsForBuildingSublayers(n.sublayers,p);g.infos.push(...w),i=[g,...i]}else n.renderer&&(i=[...await this._getRendererLegendElements(n.renderer,{title:n.title,opacity:p,sublayer:n}),...i])}}return i.filter(n=>!!n&&(!("infos"in n)||!n.infos||n.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(u4(t)||Wq(t)||l4(t)){this.addHandles(ce(()=>t.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){fe.getLogger(this).warn("Request to server for legend has failed!",e)}}}async _generateLegendElementsForSublayers(t,e,i){const r=this.layer;let n=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let o=t.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(o=l4(r)?this.sublayerIds.map(u=>r.findSublayerForSubtypeCode(u)).filter(Rt):this.sublayerIds.map(u=>r.findSublayerById(u)).filter(Rt));for(const u of o){const p=ce(()=>[u.renderer,u.opacity,u.title,u.visible,u.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this.addHandles(p,"sublayers-watcher"),!this.respectLayerVisibility||u.visible&&u.legendEnabled&&this._isSublayerInScale(u)){const g=(u==null?void 0:u.opacity)!=null?u.opacity:null,w=g!=null?g*e:e,S=!Jq(u)||u.originIdOf("renderer")>ut.SERVICE&&!u.sublayers;if(u.renderer&&S)await u.load(),n=[...await this._getRendererLegendElements(u.renderer,{title:u.title,opacity:w,sublayer:u}),...n];else if(Jq(u)){const T=await this._generateSymbolTableElementForSublayer(u,w,i);T&&n.unshift(T)}}}return n.filter(u=>!!u&&(!("infos"in u)||!u.infos||u.infos.length>0))}async _generateSymbolTableElementForSublayer(t,e,i){if(!i){i=new Map;const n=this.layer,o=t.source;let u=null;if(!(!o||o.type==="map-layer"&&o.mapLayerId===t.id&&(!o.gdbVersion||o.gdbVersion===("gdbVersion"in n&&n.gdbVersion)))||t.originIdOf("renderer")>ut.SERVICE||t.originIdOf("labelingInfo")>ut.SERVICE||t.originIdOf("labelsVisible")>ut.SERVICE){const g=new gl({layer:this.layer});u=g.hasDynamicLayers?g.dynamicLayers:null,g.destroy()}const p=u||`${n.uid}-default`;(await this._getLegendLayers(p,u)).forEach(g=>i.set(g.layerId,g))}const r=i.get(t.id);if((!r||r!=null&&r.subLayerIds&&r.defaultVisibility)&&t.sublayers){const n=await this._generateLegendElementsForSublayers(t.sublayers,e,i);return{type:"symbol-table",title:t.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(r,t,e)}_generateSymbolTableElementForLegendLayer(t,e,i){if(!(t!=null&&t.legend)||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const r=e==null?void 0:e.renderer;let n=(e==null?void 0:e.title)||t.layerName;if(r&&(!e||(e==null?void 0:e.originIdOf("renderer"))>ut.SERVICE)){const p=(e==null?void 0:e.title)||this._getRendererTitle(r,e);p&&(n&&typeof p!="string"&&"title"in p&&(p.title=n),n=p)}const o={type:"symbol-table",title:n,legendType:t.legendType||null,infos:[]},u=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach(p=>{var w;const g={type:"symbol-table",title:p.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(u.filter(S=>S.groupId===p.id),t.layerId,i)};((w=g.infos)==null?void 0:w.length)>0&&o.infos.push(g)}):o.infos=this._generateSymbolTableElementInfosForLegendLayer(u,t.layerId,i),o.infos.length>0?o:null}_generateSymbolTableElementInfosForLegendLayer(t,e,i){return t.map(r=>{let n=r.url;if(r.imageData&&r.imageData.length>0)n=`data:image/png;base64,${r.imageData}`;else{if(n.indexOf("http")===0)return null;n=zpe(`${this.layer.url}/${e}/images/${n}`)}return{label:r.label,src:n,opacity:i??this.opacity,width:r.width,height:r.height}}).filter(Rt)}_isSublayerInScale(t){const e=t.minScale||0,i=t.maxScale||0;return!(e>0&&e<this.scale||i>this.scale)}_isLegendLayerInScale(t,e){const i=e||this.layer;let r=null,n=null,o=!0;return!i.minScale&&i.minScale!==0||!i.maxScale&&i.maxScale!==0?(t.minScale===0&&i.tileInfo&&(r=i.tileInfo.lods[0].scale),t.maxScale===0&&i.tileInfo&&(n=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(r=Math.min(i.minScale,t.minScale)||i.minScale||t.minScale,n=Math.max(i.maxScale,t.maxScale)),(r>0&&r<this.scale||n>this.scale)&&(o=!1),o}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||t.length===0)return t;const i=e.renderer,r=t.some(u=>u.values);let n=0,o=null;return r&&t.some((u,p)=>(u.values||(n=p,o=u,o.label||(o.label="others")),o!=null)),i?i.type==="unique-value"?o&&(t.splice(n,1),t.push(o)):i.type==="class-breaks"&&(o&&t.splice(n,1),t.reverse(),o&&t.push(o)):o&&(t.splice(n,1),t.push(o)),t}async _getRendererLegendElements(t,e={}){if(!MVe(t,this.view))return fe.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(EVe(t))return this._constructPointCloudRendererLegendElements(t,e);if(ole(t))return this._constructDotDensityRendererLegendElements(t);const i=await this._loadRenderer(t);return ale(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return t.type==="binning"?e=t.renderer:t.type==="cluster"&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){var e;return(((e=t.legendOptions)==null?void 0:e.title)||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){var p;const i=e.title,r=[];let n=null,o=null;if(KF(t))n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach(g=>{n.infos.unshift({label:g.label||g.minValue+" - "+g.maxValue,value:[g.minValue,g.maxValue],symbol:this._getAppliedCloneSymbol(M$,g.color)})});else if(YF(t)){const g=t.stops;let w=null;if(g!=null&&g.length&&(g.length===1&&(w=g[0].color),!w)){const T=g[0].value,E=g[g.length-1].value;T!=null&&E!=null&&(w=Zae(T+(E-T)/2,g))}n={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(M$,w||M$.color)}]};const S=Qje(t.stops??[])??[];o={type:"color-ramp",title:i||this._getPointCloudRendererTitle(t),infos:S,preview:Ay(S.map(T=>T.color),{ariaLabel:await Fh("previewColorRampAriaLabel")})}}else XF(t)&&(n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},(p=t.colorUniqueValueInfos)==null||p.forEach(g=>{n.infos.push({label:g.label||g.values.join(", "),value:g.values.join(", "),symbol:this._getAppliedCloneSymbol(M$,g.color)})}));n!=null&&n.infos.length&&r.push(n),o!=null&&o.infos.length&&r.push(o);const u=r.reduce((g,w)=>[...g,...w.infos??[]],[]).filter(g=>!!g.symbol).map(g=>this._getSymbolPreview(g,this.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}}));return await Promise.allSettled(u),r}async _getElementInfoForDotDensity(t,e){const{color:i,label:r,valueExpressionTitle:n}=e,{backgroundColor:o,outline:u,dotSize:p}=t,g=this.effectList,w=g==null?void 0:g.effects.map(V=>V.toJSON()),S=xE(w),T=await Fh("previewTemplateAriaLabel",r||n),E=p+"-"+i+"-"+o+"-"+(u&&JSON.stringify(u.toJSON()))+"-"+S,C=this._dotDensityUrlCache,L=C.has(E)?C.get(E):S7e(t,i,{ariaLabel:T});C.set(E,L);const R={shape:{type:"image",x:0,y:0,width:L.width,height:L.height,src:L.src},fill:null,stroke:null,offset:[0,0]},F=AS([[R]],[L.width,L.height],{effectView:this.effectList,ariaLabel:T});return{opacity:1,src:L.src,preview:F,width:L.width,height:L.height}}async _constructDotDensityRendererLegendElements(t){var n;const e=t.calculateDotValue(this.view.scale),i=(n=t.legendOptions)==null?void 0:n.unit,r={type:"symbol-table",title:{value:e&&Math.round(e),unit:i||""},infos:[]};for(const o of t.attributes){const u=await this._getElementInfoForDotDensity(t,o);u.label=o.label||o.valueExpressionTitle||o.field,r.infos.push(u)}return[r]}async _constructPieChartRendererLegendElements(t){var g,w,S,T;const e=this.layer.opacity,i=[];let r=null;const n=t.outline;t.attributes.forEach(E=>{const C=new kn({color:E.color,outline:n}),L=E.label||E.valueExpressionTitle||E.field;i.push({label:L,symbol:C})});const o=i.length?[...i]:[];if((g=t.othersCategory)!=null&&g.color&&((w=t.othersCategory)==null?void 0:w.threshold)!==0){const E=new kn({color:t.othersCategory.color,outline:n});r=t.othersCategory.label||"Other",i.push({label:r,symbol:E})}if((S=t.defaultColor)!=null&&S.a){const E=new kn({color:t.defaultColor,outline:n});i.push({label:t.defaultLabel,symbol:E})}const u=await this._getVisualVariableLegendElements(t,this.layer)||[];if(i.length){u.unshift({type:"symbol-table",title:null,infos:i});const E=o.filter(L=>L.label!==r).map(L=>L.symbol.color).filter(Boolean),C=x7e(E,{holePercentage:t.holePercentage,backgroundColor:(T=t.backgroundFillSymbol)==null?void 0:T.color,effectList:this.effectList,outline:n,ariaLabel:await Fh("previewPieChartAriaLabel")});u.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:i,preview:C})}const p=u.reduce((E,C)=>[...E,...this._getAllInfos(C)],[]).filter(E=>!!(E!=null&&E.symbol)&&!(E!=null&&E.preview)).map(E=>this._getSymbolPreview(E,e,{effectList:this.effectList}));return await Promise.allSettled(p),u}async _constructRendererLegendElements(t,e={}){var F,V,U,W,H;const{title:i,sublayer:r}=e,n=r||this.layer,o=u7(t);"definitionExpression"in n&&n.definitionExpression&&!this._layerDefinitionExpressionClause&&this.respectLayerDefinitionExpression&&(this._layerDefinitionExpressionClause=await ZP(n.definitionExpression,n.fieldsIndex)),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const u=await this._getVisualVariableLegendElements(t,n)||[],p={type:"symbol-table",title:i||this._getRendererTitle(t,n),infos:[]};let g=null,w=!1;const S=new Set;if(f7(t)&&!this._hasSizeRamp){const J=await Wae(t);p.infos.push({label:null,symbol:J})}else if(RVe(t)){let J=i;const X=FVe(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",te=u.findIndex(we=>we.type==="color-ramp"),oe=te!==-1?u.splice(te,1)[0]:null,pe=u.findIndex(we=>we.type==="size-ramp"),de=pe!==-1?u.splice(pe,1)[0]:null,ge=[];oe&&(J=oe.title,ge.push(oe)),de&&(J=de.title,ge.push(de)),ge.length>0&&u.push({type:X,title:J,infos:ge})}else if(sle(t)){const J=Kae(t);u.push({type:"heatmap-ramp",title:i||this._getRendererTitle(t,n),infos:J,preview:Ay(J.map(X=>X.color),{effectList:this.effectList,ariaLabel:await Fh("previewColorRampAriaLabel")})})}else if(h2(t)){const J=t&&t.authoringInfo;if(J&&J.type==="relationship"){const{numClasses:X,field1:te,field2:oe}=J,pe=J.focus;if(X&&te&&oe){const de=[te,oe];let ge=jse(pe)||0;for(const ke of de){const{field:$e,normalizationField:Fe,label:yt}=ke,qe=yt||{field:this._getFieldAlias($e,n),normField:Fe&&this._getFieldAlias(Fe,n)},Ue=NVe.clone();Ue.angle=ge,p.infos.push({label:qe,symbol:Ue}),S.add(Ue),ge+=90}const we=_7e({focus:pe,numClasses:X,infos:t.uniqueValueInfos??[]});u.unshift(we)}}else if(Ng(this.layer)||k$(this.layer)){const{field:X,field2:te}=t;(F=t.uniqueValueInfos)==null||F.forEach(oe=>{oe.symbol&&(X&&this._checkDefinitionExpression(X,oe.value)||te)&&p.infos.push({label:oe.label||oe.value,value:oe.value,symbol:oe.symbol})})}else{const{field:X,field2:te,field3:oe,fieldDelimiter:pe,valueExpression:de,defaultSymbol:ge}=t,we=!(!X&&!de||!te&&!oe),ke=[];if((V=t.uniqueValueGroups)==null||V.forEach($e=>{var yt;const Fe={type:"symbol-table",title:$e.heading,infos:[]};(yt=$e.classes)==null||yt.forEach(qe=>{const{symbol:Ue,values:ei}=qe;if(Ue){const jr=[],cs=[];for(const Is of ei??[]){const{value:sa,value2:Ha,value3:oa}=Is,hn=[],Wl=[];(X||de)&&(hn.push(sa),Wl.push(this._getDomainName(X,sa,n))),te&&(hn.push(Ha),Wl.push(this._getDomainName(te,Ha,n))),oe&&(hn.push(oa),Wl.push(this._getDomainName(oe,oa,n))),jr.push(we?hn.join(pe||""):hn[0]),cs.push(Wl.join(" - "))}const eo=jr.join(", ");let to=qe.label;if(!to){const Is=cs.filter(Boolean);to=Is.length?Is.join(", "):eo}const On=Ue.clone();On.type==="cim"&&o&&Gae(On,{innerDotSize:.5*Hq,outerRingSize:Hq}),(this._checkDefinitionExpression(X,eo)||te)&&Fe.infos.push({label:to,value:eo,symbol:On})}}),Fe.infos.length&&ke.push(Fe)}),ke.length){const $e=ke[0];ke.length===1&&"title"in $e&&!$e.title?p.infos.push(...$e.infos??[]):(ge&&(ke.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:ge}]}),w=!0),p.infos.push(...ke)),i||(U=t.legendOptions)!=null&&U.title||t.valueExpressionTitle||(p.title=null)}}t.defaultSymbol&&!w&&(p.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),w=!0)}else if(Ny(t)){if(!o){if(g=this._isUnclassedRenderer(t),!g||!this._hasSizeRamp){const J=t.classBreakInfos.filter(({symbol:X})=>X);for(const{label:X,minValue:te,maxValue:oe,symbol:pe}of J)p.infos.unshift({label:X||(g?null:`${te} - ${oe}`),value:[te,oe],symbol:pe});g&&(p.title=null),this._updateInfosForClassedSizeRenderer(t,p.infos)}t.defaultSymbol&&!g&&(p.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),w=!0)}}else if(rle(t))if(k$(this.layer)||OVe(this.layer)){const J=await this._constructTileImageryStretchRendererElements(t);PVe(J)?u.push(J):p.infos=J}else{const J=this.layer;let X,te;if((W=t.statistics)!=null&&W.length){const ge=t.statistics[0];qq(ge)?(X=ge.min,te=ge.max):[X,te]=ge}let oe=[],pe=J.serviceRasterInfo;if(J.rasterFunction)try{pe=await J.generateRasterInfo(J.rasterFunction)}catch{}const de=o7(pe.pixelType);if(pe.bandCount===1){const ge=((H=J.bandIds)==null?void 0:H[0])||0;X=X??(pe.statistics?pe.statistics[ge].min:de[0]),te=te??(pe.statistics?pe.statistics[ge].max:de[1]),X||te?u.push(await this._getStretchLegendElements(t,{min:X,max:te})):this._getServerSideLegend()}else if(J.bandIds&&J.bandIds.length===1)X=X??(pe.statistics?pe.statistics[J.bandIds[0]].min:de[0]),te=te??(pe.statistics?pe.statistics[J.bandIds[0]].max:de[1]),X||te?u.push(await this._getStretchLegendElements(t,{min:X,max:te})):this._getServerSideLegend();else if(pe.bandCount>=3){const{bandInfos:ge}=pe,{bandIds:we}=J;ge.length>=pe.bandCount?(we==null?void 0:we.length)===3?(oe=we.map(ke=>ge[ke].name),p.infos=this._createSymbolTableElementMultiBand(oe)):J.format==="lerc"?(oe=[0,1,2].map(ke=>ge[ke].name),p.infos=this._createSymbolTableElementMultiBand(oe)):this._getServerSideLegend():J.format==="lerc"?(oe=["band1","band2","band3"],p.infos=this._createSymbolTableElementMultiBand(oe)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(ile(t))t.colormapInfos.forEach(J=>{p.infos.push({label:J.label,value:J.value,symbol:this._getAppliedCloneSymbol(TVe,J.color)})});else if(Y1(t)){let J=t.symbol;switch(e.geometryType){case"point":J="pointSymbol"in n?n.pointSymbol:null;break;case"polyline":J="lineSymbol"in n?n.lineSymbol:null;break;case"polygon":J="polygonSymbol"in n?n.polygonSymbol:null}const X=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&X&&p.infos.push({label:t.label,symbol:J})}else if(tle(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),p.title=t.attributeField;const J=t.getClassBreakInfos();J!=null&&J.length?J.forEach(X=>{p.infos.push({label:X.minValue+" - "+X.maxValue,symbol:X.symbol})}):p.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else nle(t)&&u.push(await this._getStretchLegendElements(t,{min:0,max:255}));const T=t.defaultSymbol;!T||w||Y1(t)||g&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||u.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:T}]}),p.infos.length&&u.unshift(p);const E=e.opacity==null?this.opacity:e.opacity,C=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),L=Ng(this.layer)||k$(this.layer),R=u.reduce((J,X)=>[...J,...this._getAllInfos(X)],[]).filter(J=>!!(J!=null&&J.symbol)).filter(J=>{if(J.symbol.type==="cim"){const{minScale:X,maxScale:te}=J.symbol.data;if(X&&X<this.scale||te&&te>this.scale)return!1}return!0}).map(J=>this._getSymbolPreview(J,E,{isDefault:J.symbol===T,applyScaleDrivenSize:!S.has(J.symbol),symbolConfig:{isTall:C,isSquareFill:L},effectList:S.has(J.symbol)?null:this.effectList}));return t=null,await Promise.allSettled(R),u}_checkDefinitionExpression(t,e){return!t||typeof t!="string"||!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature({[t]:e})}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(t){const e=t==null?void 0:t.infos;return e?e.reduce((i,r)=>i.concat(this._getAllInfos(r)),[]):[t]}async _constructTileImageryStretchRendererElements(t){var p,g,w;const e=this.layer,i=e.symbolizer.rasterInfo??e.raster.rasterInfo;let r,n;const o=(p=t==null?void 0:t.statistics)!=null&&p.length?t.statistics:i==null?void 0:i.statistics;if(o){const S=o[0];qq(S)?(r=S.min,n=S.max):[r,n]=S}else{const S=o7(i.pixelType);r=S[0],n=S[1]}if(e.hasStandardTime()&&(r=e.getStandardTimeValue(r),n=e.getStandardTimeValue(n)),i.bandCount===1||((g=e.bandIds)==null?void 0:g.length)===1)return this._getStretchLegendElements(t,{min:r,max:n});const u=((w=e==null?void 0:e.bandIds)!=null&&w.length?e.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map(S=>i.bandInfos[S].name);return u.length<3?u.push(u[1]):u.length>3&&u.splice(3),this._createSymbolTableElementMultiBand(u)}async _getStretchLegendElements(t,e){const i=t.colorRamp,r=tVe(i,e);return{type:"stretch-ramp",title:"",infos:r,preview:Ay(r.map(n=>n.color),{ariaLabel:await Fh("previewColorRampAriaLabel")})}}_getClusterSymbol(){var r;const t=this.layer,e="featureReduction"in t&&t.featureReduction,i=e&&"symbol"in e&&e.renderer;return i&&((r=i==null?void 0:i.authoringInfo)==null?void 0:r.isAutoGenerated)!==!0?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,i,r){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await uVe(i,e,await l7(i),this.scale,this.view,r,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],i=["red","green","blue"];return t.forEach((r,n)=>{e.push({label:{colorName:i[n],bandName:r},src:Wje[n],opacity:this.opacity??1})}),e}_updateInfosForClassedSizeRenderer(t,e){const i=t.authoringInfo&&t.authoringInfo.type==="class-breaks-size",r=t.classBreakInfos.some(n=>NM(n.symbol));if(i&&r){const n=h7,o=p7,u=t.classBreakInfos.length,p=(n-o)/(u>1?u-1:u);e.forEach((g,w)=>{g.size=n-p*w})}}_isTallSymbol(t){let e=!1,i=!1;if(t)for(let r=0;r<t.length&&(!e||!i);r++){const n=t[r];n.type==="size"&&(n.axis==="height"&&(e=!0),n.axis==="width-and-depth"&&(i=!0))}return e&&i}async _getSymbolPreview(t,e,i){var o,u,p;let r=!(i!=null&&i.isDefault)&&t.size==null&&this._hasSizeRamp?Jn(Ln.size):t.size;if(this._scaleDrivenSizeVariable&&(i!=null&&i.applyScaleDrivenSize)){const{getSize:g}=await ie(()=>Promise.resolve().then(()=>Ym),void 0);r=g(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:t.symbol.type==="simple-marker"?t.symbol.style:null})}const n=!(i!=null&&i.isDefault)&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!(i!=null&&i.applyScaleDrivenSize));return tF(t.symbol,{size:r,opacity:e,scale:!1,symbolConfig:i==null?void 0:i.symbolConfig,effectView:i==null?void 0:i.effectList,style:"legend",cimOptions:{allowScalingUp:n,viewParams:this.isScaleDriven?{viewingMode:((o=this.view)==null?void 0:o.type)==="2d"?"map":(u=this.view)==null?void 0:u.viewingMode,scale:(p=this.view)==null?void 0:p.scale}:null},ariaLabel:t.label&&typeof t.label!="string"?null:await Fh("previewTemplateAriaLabel",t.label)}).then(g=>(t.preview=g,t)).catch(()=>(t.preview=null,t))}_getClusterRenderer(t){var n,o;this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,i=((n=t.renderer)==null?void 0:n.clone())||(e==null?void 0:e.clone()),r=Vje(t,this.layerView,this.view);if(r&&i!=null&&"visualVariables"in i&&!((o=i.visualVariables)==null?void 0:o.some(p=>p.type==="size"&&p.target!=="outline"&&!I$.test(p.valueExpression)))){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:g,clusterMaxSize:w}=t;r.legendOptions=new mQ({showLegend:g!==w})}const p=i.visualVariables||[];i.visualVariables=p.concat([r]),this._hasClusterSizeVariable=!0}return i}async _loadRenderer(t){const e=[],i=t.clone(),r=await l7(i);if(Ny(i)||h2(i)){const n=(i.classBreakInfos||i.uniqueValueInfos).map(o=>this._fetchSymbol(o.symbol,r).then(u=>{o.symbol=u}).catch(()=>{o.symbol=null}));Array.prototype.push.apply(e,n)}return e.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:r).then(n=>{this._applySymbolToRenderer(i,n,Y1(i))}).catch(()=>{this._applySymbolToRenderer(i,null,Y1(i))})),await Promise.allSettled(e),i}_applySymbolToRenderer(t,e,i){i?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if(t.type==="web-style"){const i=this._webStyleSymbolCache;try{const r=await(this.view.type==="2d"?t.fetchCIMSymbol({cache:i}):t.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(r,e)}catch{throw fe.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const i=t.clone(),r=e&&e.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,r):i.type==="cim"?mse(i,e):i.color&&(i.color=new Ce(r||i.color)),i}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach(i=>{i&&(i.material||(i.material={}),i.material.color=new Ce(e))})}async _getVisualVariableLegendElements(t,e){var T,E;if(!("visualVariables"in t)||t.type==="vector-field")return null;const i=t.visualVariables??[],r=[],n=[],o=[],u=u7(t);if(((T=u==null?void 0:u.sizeStops)==null?void 0:T.length)===2&&(Ny(t)||h2(t))){const[C,L]=u.sizeStops;n.push(new mS({field:u.field??void 0,normalizationField:u.normalizationField,minSize:C.size,maxSize:L.size,minDataValue:C.value,maxDataValue:L.value}))}for(const C of i)C.type==="color"?r.push(C):C.type==="size"?n.push(C):C.type==="opacity"&&o.push(C);const p=[...r,...n,...o];let g,w;if(r.length===0&&Ny(t)&&t.classBreakInfos&&t.classBreakInfos.length===1){const C=t.classBreakInfos[0];g=C&&C.symbol}if(r.length===0&&Y1(t)&&(g=t.symbol),g)if(g.type.includes("3d")){const C=g.symbolLayers.at(0);C.type==="water"?C.color!=null&&(w=C.color):((E=C.material)==null?void 0:E.color)!=null&&(w=C.material.color)}else g.url||(w=g.color);const S=this.effectList;return(await Promise.all(p.map(async C=>{if(!C.legendOptions||C.legendOptions.showLegend!==!1){const L=f7(t)?C.field:this._getRampTitle(C,e);let R=null;const F=Kje(e,C,this.view.timeZone);if(C.type==="color"){const V=await c7(C,null,F)??[];R={type:"color-ramp",title:L,infos:V,preview:Ay(V.map(U=>U.color),{effectList:S,ariaLabel:await Fh("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=V.length>0)}else if(C.type==="size"&&C.target!=="outline")I$.test(C.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=C):(R=await this._getSizeLegendElement(L,C,t,F),this._hasSizeRamp||(this._hasSizeRamp=!(R.infos==null||!R.infos.length)));else if(C.type==="opacity"){const V=await c7(C,w,F)??[];R={type:"opacity-ramp",title:L,infos:V,preview:Ay(V.map(U=>U.color),{effectList:S,ariaLabel:await Fh("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=V.length>0)}return R!=null&&R.infos?R:null}}))).filter(Rt)}_getDomainName(t,e,i){var r;if(t&&typeof t!="function"){const n="getField"in i&&((r=i.getField)==null?void 0:r.call(i,t)),o=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name):null;return(o==null?void 0:o.type)==="coded-value"?o.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,i=t.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const r=e.featureReduction,n="popupTemplate"in r&&r.popupTemplate,o=n&&n.fieldInfos;if(o){for(const u of o)if(u.fieldName===i)return i==="cluster_count"?u.label||{showCount:!0}:u.label}}return{showCount:!0}}_getRampTitle(t,e){var w,S;let i=t.field,r=t.normalizationField,n=!1,o=!1,u=!1,p=null;i=typeof i=="function"?null:i,r=typeof r=="function"?null:r;const g=(w=t.legendOptions)==null?void 0:w.title;if(g!=null)p=g;else if(t.valueExpressionTitle)p=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&((S=e.renderer.authoringInfo)!=null&&S.visualVariables)){const T=e.renderer.authoringInfo.visualVariables;for(let E=0;E<T.length;E++){const C=T[E];if(C.type==="color"){if(C.style==="ratio"){n=!0;break}if(C.style==="percent"){o=!0;break}if(C.style==="percent-of-total"){u=!0;break}}}}p={field:i&&this._getFieldAlias(i,e),normField:r&&this._getFieldAlias(r,e),ratio:n,ratioPercent:o,ratioPercentTotal:u}}return p}_getRendererTitle(t,e){var p;const i=t;if((p=i.legendOptions)!=null&&p.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let r=i.field,n=null,o=null;if(Ny(i)&&(n=i.normalizationField,o=i.normalizationType==="percent-of-total"),r=typeof r=="function"?null:r,n=typeof n=="function"?null:n,h2(i)){const{field2:g,field3:w,fieldDelimiter:S}=i;let T=r&&this._getFieldAlias(r,e);return g&&(T=`<${T}>${S}<${this._getFieldAlias(g,e)}>`,w&&(T=`${T}${S}<${this._getFieldAlias(w,e)}>`)),T}let u=null;return(r||n)&&(u={field:r&&this._getFieldAlias(r,e),normField:n&&this._getFieldAlias(n,e),normByPct:o}),u}_getFieldAlias(t,e){var S,T;const i="popupTemplate"in e?e.popupTemplate:null,r=i==null?void 0:i.fieldInfos;let n=r==null?void 0:r.find(E=>t===E.fieldName),o=null;"getField"in e&&e.getField?o=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(o=e.fieldsIndex.get(t));let u=null;const p="featureReduction"in e&&e.featureReduction;p&&(n??(n="popupTemplate"in p?(T=(S=p.popupTemplate)==null?void 0:S.fieldInfos)==null?void 0:T.find(E=>{var C;return(t==null?void 0:t.toLowerCase())===((C=E.fieldName)==null?void 0:C.toLowerCase())}):void 0),"fields"in p&&p.fields&&(u=p.fields.find(E=>{var C;return((C=E.name)==null?void 0:C.toLowerCase())===(t==null?void 0:t.toLowerCase())})));const g=n||o||u;let w=null;return g&&(w=(n==null?void 0:n.label)||(o==null?void 0:o.alias)||(u==null?void 0:u.alias)||"name"in g&&g.name||"fieldName"in g&&g.fieldName||null),w}_isUnclassedRenderer(t){const e=t.visualVariables;let i=!1;return Ny(t)&&t.classBreakInfos&&t.classBreakInfos.length===1&&e&&(i=t.field?e.some(r=>!(!r||t.field!==r.field||(t.normalizationField||r.normalizationField)&&t.normalizationField!==r.normalizationField)):!!e.length),i}};m([b()],rn.prototype,"children",void 0),m([b({readOnly:!0})],rn.prototype,"effectList",null),m([b()],rn.prototype,"layerView",void 0),m([b()],rn.prototype,"layer",void 0),m([b()],rn.prototype,"legendElements",void 0),m([b({readOnly:!0})],rn.prototype,"opacity",null),m([b()],rn.prototype,"parent",void 0),m([b({readOnly:!0,dependsOn:[]})],rn.prototype,"ready",null),m([b()],rn.prototype,"hideLayersNotInCurrentView",void 0),m([b()],rn.prototype,"keepCacheOnDestroy",void 0),m([b()],rn.prototype,"respectLayerDefinitionExpression",void 0),m([b()],rn.prototype,"respectLayerVisibility",void 0),m([b({readOnly:!0})],rn.prototype,"scale",null),m([b()],rn.prototype,"sublayerIds",void 0),m([b({readOnly:!0})],rn.prototype,"isScaleDriven",null),m([b()],rn.prototype,"title",void 0),m([b({readOnly:!0,dependsOn:["ready"],value:0})],rn.prototype,"version",null),m([b()],rn.prototype,"view",void 0),rn=m([G("esri.widgets.Legend.support.ActiveLayerInfo")],rn);const lle=rn,O0={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},ule=Ie.ofType(lle),DVe=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer"]),cle="view.basemapView.baseLayerViews",hle="view.groundView.layerViews",ple="view.basemapView.referenceLayerViews",jVe=[cle,hle,"view.layerViews",ple];let Ea=class extends Te{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new Ie,this.activeLayerInfos=new ule,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(ce(()=>this.view,()=>this._viewHandles(),Qe),O0.view),this.addHandles(FI(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(O0.state),this.view&&this.addHandles(ce(()=>this.state,()=>this._stateHandles(),Qe),O0.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([O0.allLayerViews,O0.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const i=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],i!=null&&i.parent&&i.parent.children.remove(i)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:i}=e;i.length&&this._refresh(),this.addHandles(i.on("change",r=>this._propertiesChangeHandle()),O0.allLayerViews),this.addHandles(ce(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),O0.legendProperties)}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const i=this.view;if(e.length<2||!i)return;const r=[];e.forEach(o=>{if(!o.parent){const u=o.layer.parent,p=u&&"uid"in u&&this._layerViewByLayerId[u.uid],g=p&&this._activeLayerInfosByLayerViewId[p.uid];g&&e.includes(g)&&(r.push(o),o.parent=g,g.children.add(o),this._sortActiveLayerInfos(g.children))}}),e.removeMany(r);const n={};i.allLayerViews.forEach((o,u)=>n[o.layer.uid]=u),e.sort((o,u)=>{const p=n[o.layer.uid]||0;return(n[u.layer.uid]||0)-p})}_generateLayerViews(){const e=[];return jVe.filter(this._filterLayerViews,this).map(i=>Ks(this,i)).filter(i=>i!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const i=!this.basemapLegendVisible&&(e===cle||e===ple),r=!this.groundLegendVisible&&e===hle;return!i&&!r}_collectLayerViews(e,i){const r=n=>(n&&n.forEach(o=>{i.push(o),r(o[e])}),i);return r}_filterLayerViewsByLayerInfos(e){const i=this.layerInfos;return!i||!i.length||i.some(r=>this._hasLayerInfo(r,e))}_hasLayerInfo(e,i){const r=this._isLayerUIDMatching(e.layer,i.layer.uid);return r&&(this._layerInfosByLayerViewId[i.uid]=e),r}_isLayerUIDMatching(e,i){return e&&(e.uid===i||this._hasLayerUID(e.layers,i))}_hasLayerUID(e,i){return e&&e.some(r=>this._isLayerUIDMatching(r,i))}_isLayerViewSupported(e){return!!DVe.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(ce(()=>{var i;return[e.legendEnabled,(i=e.layer)==null?void 0:i.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){var i;return!this.respectLayerVisibility||e.legendEnabled&&((i=e.layer)==null?void 0:i.legendEnabled)}_buildActiveLayerInfo(e){var p;const i=e.layer,r=e.uid,n=this._layerInfosByLayerViewId[r];let o=this._activeLayerInfosByLayerViewId[r];if(!o){const g=(n==null?void 0:n.title)!==void 0&&n.layer.uid===i.uid;o=new lle({layer:i,layerView:e,title:g?n.title:i.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:(n==null?void 0:n.sublayerIds)||[]}),this._activeLayerInfosByLayerViewId[r]=o}const u=i.parent&&"uid"in i.parent?this._layerViewByLayerId[(p=i.parent)==null?void 0:p.uid]:null;if(o.parent=this._activeLayerInfosByLayerViewId[u==null?void 0:u.uid],!this.hasHandles(r)){const g=[ce(()=>i.title,w=>this._titleHandle(w,o)),ce(()=>[i.opacity,"renderer"in i&&i.renderer,"pointSymbol"in i&&i.pointSymbol,"lineSymbol"in i&&i.lineSymbol,"polygonSymbol"in i&&i.polygonSymbol],()=>this._constructLegendElements(o)),Fr(()=>{var w;return((w=this.view)==null?void 0:w.stationary)===!0},()=>this._scaleHandle(o),Qe),ce(()=>e.layer?RB(e.layer,e.view):null,()=>this._constructLegendElements(o)),ce(()=>e.updating,()=>{e.layer!=null&&RB(e.layer,e.view)!=null&&this._constructLegendElements(o)}),ce(()=>"effect"in i&&i.effect,()=>this._constructLegendElements(o)),Fr(()=>{var w;return(w=this.view)==null?void 0:w.timeZone},()=>this._constructLegendElements(o),Qe)];if(this.respectLayerVisibility){const w=ce(()=>e.legendEnabled,T=>this._legendEnabledHandle(T,o)),S=ce(()=>i.legendEnabled,T=>this._legendEnabledHandle(T,o));g.push(w,S)}this.addHandles(g,r)}o.isScaleDriven||this._constructLegendElements(o),this._addActiveLayerInfo(o)}_titleHandle(e,i){i.title=e,this._constructLegendElements(i)}_legendEnabledHandle(e,i){e?this._addActiveLayerInfo(i):this._removeActiveLayerInfo(i)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var n;const{layerView:i,layer:r}=e;if(this._isLayerActive(i)&&!this.activeLayerInfos.includes(e)){const o=e.parent;if(o)o.children.includes(e)||o.children.push(e),this._sortActiveLayerInfos(o.children);else{const u=(n=this.layerInfos)==null?void 0:n.some(p=>p.layer.uid===r.uid);r.parent&&"uid"in r.parent&&!u?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const u=[];this._activeLayerInfosWithNoParent.forEach(p=>{const g=p.layer.parent,w=g&&"uid"in g?this._layerViewByLayerId[g==null?void 0:g.uid]:null,S=this._activeLayerInfosByLayerViewId[w==null?void 0:w.uid];S&&(u.push(p),p.parent=S)}),u.length&&(this._activeLayerInfosWithNoParent.removeMany(u),u.forEach(p=>this._addActiveLayerInfo(p)))}}}_removeActiveLayerInfo(e){const i=e.parent;i?i.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const i=e.layer;"featureCollections"in i&&i.featureCollections?e.buildLegendElementsForFeatureCollections(i.featureCollections):"featureReduction"in i&&i.featureReduction&&"renderer"in i.featureReduction&&(i.featureReduction.type==="binning"||i.featureReduction.type==="cluster")&&(!this.view||i.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(i.featureReduction):"renderer"in i&&i.renderer&&!("sublayers"in i)?e.buildLegendElementsForRenderer(i.renderer):"url"in i&&i.url&&i.type!=="catalog"?e.buildLegendElementsForTools():e.children.forEach(r=>this._constructLegendElements(r))}};m([b({type:ule})],Ea.prototype,"activeLayerInfos",void 0),m([b()],Ea.prototype,"basemapLegendVisible",void 0),m([b()],Ea.prototype,"groundLegendVisible",void 0),m([b()],Ea.prototype,"hideLayersNotInCurrentView",void 0),m([b()],Ea.prototype,"keepCacheOnDestroy",void 0),m([b()],Ea.prototype,"respectLayerDefinitionExpression",void 0),m([b()],Ea.prototype,"respectLayerVisibility",void 0),m([b()],Ea.prototype,"layerInfos",void 0),m([b({readOnly:!0})],Ea.prototype,"state",null),m([b()],Ea.prototype,"view",void 0),Ea=m([G("esri.widgets.Legend.LegendViewModel")],Ea);const VVe=Ea,ai="esri-legend--card",jg="esri-legend",Je={activated:`${ai}__carousel-indicator--activated`,base:ai,stacked:`${jg}--stacked`,carouselTitle:`${ai}__carousel-title`,indicator:`${ai}__carousel-indicator`,intervalSeparator:`${ai}__interval-separator`,imageryLayerStretchedImage:`${ai}__imagery-layer-image--stretched`,imageLabel:`${ai}__image-label`,layerCaption:`${ai}__layer-caption`,labelElement:`${ai}__label-element`,layerRow:`${ai}__layer-row`,labelCell:`${ai}__label-cell`,message:`${ai}__message`,rampLabel:`${ai}__ramp-label`,section:`${ai}__section`,relationshipSection:`${ai}__relationship-section`,serviceCaptionText:`${ai}__service-caption-text`,serviceContent:`${ai}__service-content`,service:`${ai}__service`,groupLayer:`${ai}__group-layer`,groupLayerChild:`${ai}__group-layer-child`,symbol:`${ai}__symbol`,sizeRampRow:`${ai}__size-ramp-row`,symbolRow:`${ai}__symbol-row`,symbolCell:`${ai}__symbol-cell`,indicatorContainer:`${ai}__carousel-indicator-container`,intervalSeparatorsContainer:`${ai}__interval-separators-container`,relationshipLabelContainer:`${ai}__relationship-label-container`,labelContainer:`${ai}__label-container`,serviceCaptionContainer:`${ai}__service-caption-container`,symbolContainer:`${ai}__symbol-container`,sizeRampContainer:`${ai}__size-ramp-container`,sizeRampPreview:`${ai}__size-ramp-preview`,pieChartRampPreview:`${ai}__pie-chart-ramp-preview`,rampContainer:`${jg}__ramps`,sizeRampHorizontal:`${jg}__size-ramp--horizontal`,rampLabelsContainer:`${jg}__ramp-labels`,layerInfo:`${jg}__layer-cell ${jg}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"},zVe=OE(),dle=10,QF=20,e9=10,eN=20,tN={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function UVe(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?N("svg",{height:"4",width:"10"},N("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):N("svg",{height:"10",width:"10"},N("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function GVe(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${QF}px`,i.className=tN.univariateAboveAndBelowSymbol,t!=null&&(i.style.opacity=t.toString()),zVe.append(i,UVe.bind(null,e)),i}function fle(t,e,i="vertical",r){t.infos.forEach((n,o)=>{if(r&&o===2)n.preview=GVe(e,i);else{const u=Zi(n.size)+(i==="horizontal"?eN:e9),p=n.preview,g=(p==null?void 0:p.tagName.toLowerCase())==="div",w=g?p:document.createElement("div");w.className=tN.univariateAboveAndBelowSymbol,i==="horizontal"?w.style.width=`${u}px`:w.style.height=`${u}px`,!g&&p&&w.appendChild(p),n.preview=w}})}function yI(t,e="classic"){const i=t.infos;return e==="classic"?(Zi(i[0].size)+e9)/2:(Zi(i[0].size)-Zi(i[i.length-1].size))/2}function Bv(t,e){if(!t)return null;const i=t.infos.map(n=>n.color),r=Ay(e.type==="full"?i:e.type==="above"?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return r.className=tN.colorRamp,e.opacity!=null&&(r.style.opacity=e.opacity.toString()),r}function y7(t,e,i,r="vertical"){let n=0;const o=t.infos,u=Math.floor(o.length/2),p=e==="full"||e==="above"?0:u,g=e==="full"||e==="below"?o.length-1:u;for(let w=p;w<=g;w++)i&&w===u?n+=r==="horizontal"?dle:QF:n+=Zi(o[w].size)+(r==="horizontal"?eN:e9);return Math.round(n)}function qv(t,e,i,r="vertical"){const n=y7(t,e,i,r),o=t.infos,u=Math.floor(o.length/2),p=e==="full"||e==="above"?0:u,g=e==="full"||e==="below"?o.length-1:u,w=e==="full"?o[p].size+o[g].size:e==="above"?o[p].size:o[g].size,S=i?r==="vertical"?QF:dle:0,T=r==="vertical"?e9*(e==="full"?2:1):eN*(e==="full"?2:1);return Math.round(n-(Zi(w)/2+S/2+T/2))}function yle(t,e,i="vertical"){const r=t.infos;let n=r.find(({type:u})=>u==="size-ramp"),o=r.find(({type:u})=>u==="color-ramp");return n&&(n={...n},n.infos=[...n.infos],fle(n,e,i,!0)),o&&(o={...o},o.infos=[...o.infos]),i==="horizontal"&&(n==null||n.infos.reverse(),o==null||o.infos.reverse()),{sizeRampElement:n,colorRampElement:o}}function mle(t,e="vertical"){const i=t.infos;let r=i.find(({type:o})=>o==="size-ramp"),n=i.find(({type:o})=>o==="color-ramp");return r&&(r={...r},r.infos=[...r.infos],fle(r,null,e,!1)),n&&(n={...n},n.infos=[...n.infos]),e==="horizontal"&&(r==null||r.infos.reverse(),n==null||n.infos.reverse()),{sizeRampElement:r,colorRampElement:n}}function BVe(t,e){return e}function Gn(t){const e=this;t.appendChild(e)}function Gf(t,e,i){if(!e)return;if(typeof e=="number")return e;if(typeof e=="string")return hce(e);if("value"in e||"unit"in e)return qn(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let r=null;return BVe(e,i)?r=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:gle(e,i)&&(r=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),r?qn(r==="showField"?"{field}":t[r],{field:e.field,normField:e.normField}):void 0}function gle(t,e){return!e}function vle(t,e){return!!(e&&e==="Stretched"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}function ble(t,e){var i;return t.label?e[t.label]+": "+(typeof t.value=="string"?t.value:as(t.value??0,{style:"decimal",notation:(i=t.value)!=null&&i.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}const qVe=25,HVe=25,WVe=768,JVe=100,ZVe="#ddd",Vg=window.devicePixelRatio;function KVe(t){var e,i;if(t){if(t.type.includes("3d")){const r=(e=t.symbolLayers)==null?void 0:e.length;if(!r)return;const n=t.symbolLayers.at(r-1),o=(i=n.resource)==null?void 0:i.primitive;return o==="circle"||o==="cross"||o==="kite"||o==="sphere"||o==="cube"||o==="diamond"}{const r=t.style;return r==="circle"||r==="diamond"||r==="cross"}}}function YVe(t){var e;if(t){if(t.type.includes("3d")){const i=(e=t.symbolLayers)==null?void 0:e.length;if(!i)return;const r=t.symbolLayers.at(i-1).get("resource.primitive");return r==="triangle"||r==="cone"||r==="tetrahedron"}return t.style==="triangle"}}let Iu=class extends vi{constructor(e,i){super(e,i),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(ce(()=>this.activeLayerInfos,e=>{this.removeAllHandles(),this._watchForSectionChanges(e)}))}render(){const{view:e}=this;this._hasIndicators=this.layout==="auto"&&e&&e.container.clientWidth<=WVe||this.layout==="stack";const i=this.activeLayerInfos,r=i==null?void 0:i.toArray().map(w=>this._renderLegendForLayer(w)).filter(w=>!!w);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,o=this._sectionNames.map((w,S)=>{const T=qn(this.messagesCommon.pagination.pageText,{index:S+1,total:n});return N("div",{"aria-controls":`${w}-panel`,"aria-label":T,"aria-selected":(this._selectedSectionName===w).toString(),bind:this,class:this.classes(Je.indicator,{[Je.activated]:this._selectedSectionName===w}),"data-section-name":w,id:w,key:w,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===w?0:-1,title:T})}),u=this._hasIndicators&&n>1?N("div",{class:Je.indicatorContainer,key:"carousel-navigation",role:"tablist"},o):null,p=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):r!=null&&r.length?r:null,g={[Je.stacked]:this._hasIndicators};return N("div",{class:this.classes(Je.base,g)},p||N("div",{class:Je.message},this.messages.noLegend),u)}_selectSection(e){const i=e.target.getAttribute("data-section-name");i&&(this._selectedSectionName=i)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const i=e.key,r=i==="ArrowLeft"?-1:1,n=e.target.getAttribute("data-section-name"),o=this._sectionNames.indexOf(n),u=this._sectionNames;let p=null;o!==-1&&(u[o+r]?p=document.getElementById(u[o+r]):i==="ArrowLeft"?p=document.getElementById(u[u.length-1]):i==="ArrowRight"&&(p=document.getElementById(u[0])),p==null||p.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(r=>{const n=`activeLayerInfo-${r.layer.uid}-version-change`;this.removeHandles(n),this._watchForSectionChanges(r.children),this.addHandles(ce(()=>r.version,()=>this._generateSectionNames()),n)});const i="activeLayerInfos-collection-change";this.removeHandles(i),this.addHandles(e.on("change",()=>this._watchForSectionChanges(e)),i)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,i,r){return`${this.id}${e.uid}-type-${i.type}-${r}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((i,r)=>{this._sectionNames.push(this._getSectionName(e.layer,i,r))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const i=e.children.map(r=>this._renderLegendForLayer(r)).toArray();return N("div",{class:this.classes(Je.service,Je.groupLayer),key:e.layer.uid},N("div",{class:Je.serviceCaptionContainer},e.title),i)}{const i=e.legendElements;if(i&&!i.length)return null;const r=i.some(u=>u.type==="relationship-ramp"),n=i.map((u,p)=>this._renderLegendForElement(u,e,p,r)).filter(u=>!!u);if(!n.length)return null;const o={[Je.groupLayerChild]:!!e.parent};return N("div",{class:this.classes(Je.service,o),key:e.layer.uid},N("div",{class:Je.serviceCaptionContainer},N("div",{class:Je.serviceCaptionText},e.title)),N("div",{class:Je.serviceContent},n))}}_renderLegendForElement(e,i,r,n=!1,o=!1){var R;const u=e.type==="color-ramp",p=e.type==="opacity-ramp",g=i.layer;let w=null;if(typeof e.title=="string")w=e.title;else if(e.title){const F=e.title,V=Gf(this.messages,F,u||p);w=F.title?`${F.title} (${V})`:V}const S=this._getSectionName(g,e,r),T=this._hasIndicators&&!o?N("div",null,N(jl,{class:Je.carouselTitle,level:this.headingLevel},i.title),N(jl,{class:Je.layerCaption,level:zv(this.headingLevel)},w)):w?N(jl,{class:Je.layerCaption,level:this.headingLevel},w):null,E=i.effectList;let C=null;switch(e.type){case"symbol-table":{const F=e.infos.map((V,U)=>this._renderLegendForElementInfo(V,i,e.legendType,U)).filter(V=>!!V);if(F.length){const V=(R=F[0].properties.classes)==null?void 0:R[Je.symbolRow],U={[Je.labelContainer]:!V&&!n,[Je.relationshipLabelContainer]:n};C=N("div",{class:this.classes(U)},F)}break}case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":C=this._renderLegendForRamp(e,g.opacity,E);break;case"size-ramp":C=this._renderSizeRamp(e,g.opacity);break;case"pie-chart-ramp":C=this._renderPieChartRamp(e);break;case"relationship-ramp":C=Cse(e,this.id,{opacity:g.opacity,effectList:E,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case"univariate-above-and-below-ramp":C=this._renderUnivariateAboveAndBelowRamp(e,g.opacity,E);break;case"univariate-color-size-ramp":C=this._renderUnivariateColorSizeRamp(e,g.opacity,E)}if(!C)return null;const L=N("div",{"aria-labelledby":S,class:Je.section,id:`${S}-panel`,key:S,role:"tabpanel",tabIndex:0},[T,C]);return o||this._sectionMap.set(S,L),L}_renderPieChartRamp(e){return N("div",{afterCreate:Gn,bind:e.preview,class:Je.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(e,i,r){var J;const{sizeRampElement:n,colorRampElement:o}=yle(e,i,"horizontal");if(!n)return null;const u=y7(n,"full",!0,"horizontal"),p=qv(n,"above",!0,"horizontal"),g=qv(n,"below",!0,"horizontal"),w=12,S=(J=this.messages)==null?void 0:J.previewColorRampAriaLabel,T=Bv(o,{width:p,height:w,rampAlignment:"horizontal",opacity:i,type:"above",effectList:r,ariaLabel:S}),E=Bv(o,{width:g,height:w,rampAlignment:"horizontal",opacity:i,type:"below",effectList:r,ariaLabel:S}),C=yI(n,"card"),L=n.infos.map(X=>X.label),R=L.length-1,F=L.map((X,te)=>te===0||te===R?N("div",{key:te},X):null),V={display:"flex",flexDirection:"column"},U={display:"flex",flexDirection:"row"},W={marginTop:"3px",display:"flex"};Nm(this.container)?W.marginRight=`${C}px`:W.marginLeft=`${C}px`;const H={width:`${u}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return N("div",{class:Je.layerRow,key:"size-ramp-preview",styles:V},N("div",{class:this.classes(Je.symbolContainer,Je.sizeRampHorizontal),styles:U},n.infos.map((X,te)=>N("div",{afterCreate:Gn,bind:X.preview,class:Je.symbol,key:te}))),T?N("div",{class:Je.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:W},N("div",{afterCreate:Gn,bind:T}),N("div",{afterCreate:Gn,bind:E})):null,N("div",{class:Je.layerInfo},N("div",{class:Je.rampLabelsContainer,styles:H},F)))}_renderUnivariateColorSizeRamp(e,i,r){var F;const{sizeRampElement:n,colorRampElement:o}=mle(e,"horizontal");if(!n)return null;const u=y7(n,"full",!1,"horizontal"),p=qv(n,"full",!1,"horizontal"),g=Bv(o,{width:p,height:12,rampAlignment:"horizontal",opacity:i,type:"full",effectList:r,ariaLabel:(F=this.messages)==null?void 0:F.previewColorRampAriaLabel}),w=yI(n,"card"),S=n.infos.length-1,T=n.infos.map((V,U)=>U===0||U===S?N("div",{key:U},V.label):null),E={display:"flex",flexDirection:"column"},C={display:"flex",flexDirection:"row"},L={marginTop:"3px",display:"flex"};Nm(this.container)?L.marginRight=`${w}px`:L.marginLeft=`${w}px`;const R={width:`${u}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return N("div",{class:Je.layerRow,key:"size-ramp-preview",styles:E},N("div",{class:this.classes(Je.symbolContainer,Je.sizeRampHorizontal),styles:C},n.infos.map((V,U)=>N("div",{afterCreate:Gn,bind:V.preview,class:Je.symbol,key:U}))),N("div",{class:Je.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:L},N("div",{afterCreate:Gn,bind:g})),N("div",{class:Je.layerInfo},N("div",{class:Je.rampLabelsContainer,styles:R},T)))}_renderLegendForElementInfo(e,i,r,n){var g,w,S,T,E;const o=i.layer;if(e.type)return this._renderLegendForElement(e,i,n,!1,!0);const u=vle(o,r),p=Gf(this.messages,e.label,!1)??"";if(e.preview){if(!((g=e.symbol)!=null&&g.type.includes("simple-fill"))){if(!e.label)return N("div",{afterCreate:Gn,bind:e.preview,key:n});const de={[Je.symbolCell]:this._hasIndicators};return N("div",{class:this.classes(Je.layerRow,{[Je.symbolRow]:this._hasIndicators}),key:n},N("div",{afterCreate:Gn,bind:e.preview,class:this.classes(de)}),N("div",{class:this.classes(Je.imageLabel,{[Je.labelCell]:this._hasIndicators})},p))}let C=255,L=255,R=255,F=0,V=255,U=255,W=255,H=0;const J=(w=e.symbol.color)==null?void 0:w.a,X=(T=(S=e.symbol.outline)==null?void 0:S.color)==null?void 0:T.a;J&&(C=e.symbol.color.r,L=e.symbol.color.g,R=e.symbol.color.b,F=e.symbol.color.a*o.opacity),X&&(V=e.symbol.outline.color.r,U=e.symbol.outline.color.g,W=e.symbol.outline.color.b,H=e.symbol.outline.color.a*o.opacity);const te=((E=e.symbol.color)==null?void 0:E.isBright)??!0,oe=te?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",pe={background:J?`rgba(${C}, ${L}, ${R}, ${F})`:"none",color:te?"black":"white",textShadow:`-1px -1px 0 ${oe},
                                              1px -1px 0 ${oe},
                                              -1px 1px 0 ${oe},
                                              1px 1px 0 ${oe}`,border:X?`1px solid rgba(${V}, ${U}, ${W}, ${H})`:"none",filter:D3(i.effectList)??void 0};return N("div",{class:Je.layerRow,key:n},N("div",{class:Je.labelElement,styles:pe},p))}if(e.src){const C=this._renderImage(e,o,u);return N("div",{class:Je.layerRow,key:n},C,N("div",{class:Je.imageLabel},p))}}_renderImage(e,i,r){const{label:n,src:o,opacity:u}=e,p={[Je.imageryLayerStretchedImage]:r,[Je.symbol]:!r},g={opacity:`${u??i.opacity}`};return N("img",{alt:Gf(this.messages,n,!1),"aria-label":Gf(this.messages,n,!1),border:0,class:this.classes(p),height:e.height,src:o,styles:g,width:e.width})}_renderSizeRampLines(e){const i=e.infos,r=i[0],n=i[i.length-1],o=r.symbol,u=this._hasIndicators,p=Zi(r.size+r.outlineSize)*Vg,g=Zi(n.size+n.outlineSize)*Vg,w=u?p:p+50*Vg,S=u?p/2+50*Vg:p,T=YVe(o),E=KVe(o),C=document.createElement("canvas");C.width=w,C.height=S,C.style.width=C.width/Vg+"px",C.style.height=C.height/Vg+"px";const L=C.getContext("2d");if(u){L.beginPath();const R=0,F=0,V=w/2-g/2,U=S;L.moveTo(R,F),L.lineTo(V,U);const W=w,H=0,J=w/2+g/2,X=S;L.moveTo(W,H),L.lineTo(J,X)}else{L.beginPath();const R=0,F=S/2-g/2,V=w;L.moveTo(R,F),L.lineTo(V,0);const W=0,H=S/2+g/2,J=w,X=S;L.moveTo(W,H),L.lineTo(J,X)}return L.strokeStyle=ZVe,L.stroke(),N("div",{afterCreate:Gn,bind:C,styles:u?{display:"flex",marginTop:`-${T?0:E?p/2:0}px`,marginBottom:`-${T?g:E?g/2:0}px`}:{display:"flex",marginRight:`-${T?0:E?p/2:0}px`,marginLeft:`-${T?0:E?g/2:0}px`}})}_renderSizeRamp(e,i){const r=e.infos,n=r[0].label,o=r[r.length-1].label;let u=r[0].preview,p=r[r.length-1].preview;const g=this._hasIndicators,w={"flex-direction":g?"column":"row-reverse"};u&&(u=u.cloneNode(!0),u.style.display="flex"),p&&(p=p.cloneNode(!0),p.style.display="flex");const S={opacity:i!=null?`${i}`:""};return N("div",{class:this.classes(Je.layerRow,{[Je.sizeRampRow]:g})},N("div",{class:Je.rampLabel},g?n:o),N("div",{class:Je.sizeRampContainer,styles:w},N("div",{afterCreate:Gn,bind:u,class:Je.sizeRampPreview,styles:S}),this._renderSizeRampLines(e),N("div",{afterCreate:Gn,bind:p,class:Je.sizeRampContainer,styles:S})),N("div",{class:Je.rampLabel},g?o:n))}_getRampStopLabel(e,i){switch(i){case"heatmap-ramp":return this.messages[e.label];case"stretch-ramp":return ble(e,this.messages);default:return e.label}}_renderLegendForRamp(e,i,r){const n=e.infos,o=e.type,u=o==="heatmap-ramp",p=n.length-1,g=HVe,w=p>2&&!u?qVe*p:JVe,S=w+20,T=10,E=n.slice(0).reverse(),C=E.length-1,L=E.length%2!=0?E[E.length/2|0]:null,R=L&&N("div",{class:Je.intervalSeparatorsContainer},N("div",{class:Je.intervalSeparator},"|"),N("div",{class:Je.rampLabel},this._getRampStopLabel(L,o))),F=[[{shape:{type:"path",path:`M0 ${g/2} L${T} 0 L${T} ${g} Z`},fill:E[0].color,stroke:{width:0}},{shape:{type:"rect",x:T,y:0,width:w,height:g},fill:{type:"linear",x1:T,y1:0,x2:w+T,y2:0,colors:E.map((H,J)=>({color:H.color,offset:u&&"ratio"in H?H.ratio:J/p}))},stroke:{width:0}},{shape:{type:"path",path:`M${w+T} 0 L${S} ${g/2} L${w+T} ${g} Z`},fill:E[C].color,stroke:{width:0}}]],V=Ese(F,S,g),U={filter:D3(r)??void 0,opacity:i==null?void 0:`${i}`},W={justifyContent:"center"};return N("div",{class:Je.layerRow,styles:W},N("div",{class:Je.rampLabel},this._getRampStopLabel(E[0],o)),N("div",{class:Je.symbolContainer},N("div",{styles:U},V),R),N("div",{class:Je.rampLabel},this._getRampStopLabel(E[C],o)))}};m([b()],Iu.prototype,"activeLayerInfos",void 0),m([b()],Iu.prototype,"headingLevel",void 0),m([b()],Iu.prototype,"layout",void 0),m([b(),vt("esri/widgets/Legend/t9n/Legend")],Iu.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Iu.prototype,"messagesCommon",void 0),m([b({readOnly:!0})],Iu.prototype,"type",void 0),m([b()],Iu.prototype,"view",void 0),m([mm()],Iu.prototype,"_selectSection",null),Iu=m([G("esri.widgets.Legend.styles.Card")],Iu);const c4=Iu,di="esri-legend",at={service:`${di}__service`,label:`${di}__service-label`,layer:`${di}__layer`,groupLayer:`${di}__group-layer`,groupLayerChild:`${di}__group-layer-child`,layerTable:`${di}__layer-table`,layerTableSizeRamp:`${di}__layer-table--size-ramp`,layerChildTable:`${di}__layer-child-table`,layerCaption:`${di}__layer-caption`,layerBody:`${di}__layer-body`,layerRow:`${di}__layer-row`,layerCell:`${di}__layer-cell`,layerInfo:`${di}__layer-cell ${di}__layer-cell--info`,imageryLayerStretchedImage:`${di}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${di}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${di}__imagery-layer-info--stretched`,symbolContainer:`${di}__layer-cell ${di}__layer-cell--symbols`,symbol:`${di}__symbol`,rampContainer:`${di}__ramps`,sizeRamp:`${di}__size-ramp`,colorRamp:`${di}__color-ramp`,opacityRamp:`${di}__opacity-ramp`,borderlessRamp:`${di}__borderless-ramp`,rampTick:`${di}__ramp-tick`,rampFirstTick:`${di}__ramp-tick-first`,rampLastTick:`${di}__ramp-tick-last`,rampLabelsContainer:`${di}__ramp-labels`,rampLabel:`${di}__ramp-label`,message:`${di}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},XVe=`${di}__`,QVe=24,Zq={display:"flex",alignItems:"flex-start"},h4={marginLeft:"3px"},zg={display:"table-cell",verticalAlign:"middle"};let Dy=class extends vi{constructor(e,i){super(e,i),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,i=e==null?void 0:e.toArray().map(r=>this._renderLegendForLayer(r)).filter(r=>!!r);return N("div",null,i!=null&&i.length?i:N("div",{class:at.message},this.messages.noLegend))}_renderLegendForLayer(e){if(!e.ready)return null;const i=!!e.children.length,r=`${XVe}${e.layer.uid}-version-${e.version}`,n=e.title?jl({level:this.headingLevel,class:this.classes(Ee.heading,at.label)},e.title):null;if(i){const o=e.children.map(u=>this._renderLegendForLayer(u)).toArray();return N("div",{class:this.classes(at.service,at.groupLayer),key:r},n,o)}{const o=e.legendElements;if(o&&!o.length)return null;const u=o.map(g=>this._renderLegendForElement(g,e.layer,e.effectList)).filter(g=>!!g);if(!u.length)return null;const p={[at.groupLayerChild]:!!e.parent};return N("div",{class:this.classes(at.service,p),key:r},n,N("div",{class:at.layer},u))}}_renderLegendForElement(e,i,r,n){const o=e.type==="color-ramp",u=e.type==="opacity-ramp",p=e.type==="size-ramp";let g=null;if(e.type==="symbol-table"||p){const L=e.infos.map(R=>this._renderLegendForElementInfo(R,i,r,p,e.legendType)).filter(R=>!!R);L.length&&(g=N("div",{class:at.layerBody},L))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?g=this._renderLegendForRamp(e,i.opacity):e.type==="relationship-ramp"?g=Cse(e,this.id,{opacity:i.opacity,effectList:r,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):e.type==="pie-chart-ramp"?g=this._renderPieChartRamp(e):e.type==="univariate-above-and-below-ramp"?g=this._renderUnivariateAboveAndBelowRamp(e,i.opacity,r):e.type==="univariate-color-size-ramp"&&(g=this._renderUnivariateColorSizeRamp(e,i.opacity,r));if(!g)return null;const w=e.title;let S=null;if(typeof w=="string")S=w;else if(w){const L=Gf(this.messages,w,o||u);S=gle(w,o||u)&&w.title?`${w.title} (${L})`:L}const T=n?at.layerChildTable:at.layerTable,E=S?N("div",{class:at.layerCaption},S):null,C={[at.layerTableSizeRamp]:p||!n};return N("div",{class:this.classes(T,C)},E,g)}_renderPieChartRamp(e){return N("div",{afterCreate:Gn,bind:e.preview})}_renderUnivariateAboveAndBelowRamp(e,i,r){var X;const{sizeRampElement:n,colorRampElement:o}=yle(e,i);if(!n)return null;const u=(X=this.messages)==null?void 0:X.previewColorRampAriaLabel,p=qv(n,"above",!0),g=qv(n,"below",!0),w=12,S=Bv(o,{width:w,height:p,rampAlignment:"vertical",opacity:i,type:"above",effectList:r,ariaLabel:u}),T=Bv(o,{width:w,height:g,rampAlignment:"vertical",opacity:i,type:"below",effectList:r,ariaLabel:u}),E=yI(n),C=n.infos.map(te=>te.label),L=C.map((te,oe)=>oe===0?N("div",{class:te?S?at.univariateAboveAndBelowLabel:at.rampLabel:void 0,key:oe},te):oe===2?N("div",null):null),R=C.length-1,F=Math.floor(C.length/2),V=C.map((te,oe)=>oe===F||oe===R?N("div",{class:te?S?at.univariateAboveAndBelowLabel:at.rampLabel:void 0,key:oe},te):null),U={display:"table-cell",verticalAlign:"middle"},W={marginTop:`${E}px`},H={height:`${p}px`},J={height:`${g}px`};return N("div",{key:"univariate-above-and-below-ramp-preview",styles:Zq},N("div",{class:at.layerBody},n.infos.map((te,oe)=>N("div",{class:this.classes(at.layerRow,at.sizeRamp)},N("div",{afterCreate:Gn,bind:te.preview,class:at.symbol,styles:U}),S||oe%2!=0?null:N("div",{class:at.layerInfo},C[oe])))),S?N("div",{key:"color-ramp-preview",styles:W},N("div",{styles:h4},N("div",{styles:zg},N("div",{afterCreate:Gn,bind:S,class:at.rampContainer})),N("div",{styles:zg},N("div",{class:at.rampLabelsContainer,styles:H},L))),N("div",{styles:h4},N("div",{styles:zg},N("div",{afterCreate:Gn,bind:T,class:at.rampContainer})),N("div",{styles:zg},N("div",{class:at.rampLabelsContainer,styles:J},V)))):null)}_renderUnivariateColorSizeRamp(e,i,r){var R;const{sizeRampElement:n,colorRampElement:o}=mle(e);if(!n)return null;const u=yI(n),p=12,g=qv(n,"full",!1),w=Bv(o,{width:p,height:g,rampAlignment:"vertical",opacity:i,type:"full",effectList:r,ariaLabel:(R=this.messages)==null?void 0:R.previewColorRampAriaLabel}),S=n.infos.length-1,T=n.infos.map((F,V)=>V===0||V===S?N("div",{class:F.label?o?at.univariateAboveAndBelowLabel:at.rampLabel:void 0,key:V},F.label):null),E={display:"table-cell",verticalAlign:"middle"},C={marginTop:`${u}px`},L={height:`${g}px`};return N("div",{key:"univariate-above-and-below-ramp-preview",styles:Zq},N("div",{class:at.layerBody},n.infos.map(F=>N("div",{class:this.classes(at.layerRow,at.sizeRamp)},N("div",{afterCreate:Gn,bind:F.preview,class:at.symbol,styles:E})))),N("div",{key:"color-ramp-preview",styles:C},N("div",{styles:h4},N("div",{styles:zg},N("div",{afterCreate:Gn,bind:w,class:at.rampContainer})),N("div",{styles:zg},N("div",{class:at.rampLabelsContainer,styles:L},T)))))}_renderLegendForRamp(e,i){const r=e.infos,n=e.type==="opacity-ramp",o=e.type==="heatmap-ramp",u=e.type==="stretch-ramp",p=e.preview,g=n?at.opacityRamp:"";p.className=`${at.colorRamp} ${g}`,i!=null&&(p.style.opacity=i.toString());const w=r.map(E=>N("div",{class:E.label?at.rampLabel:void 0},o?this.messages[E.label]||E.label:u?ble(E,this.messages):E.label)),S={width:`${QVe}px`},T={height:p.style.height};return N("div",{class:at.layerRow},N("div",{class:at.symbolContainer,styles:S},N("div",{afterCreate:Gn,bind:p,class:at.rampContainer})),N("div",{class:at.layerInfo},N("div",{class:at.rampLabelsContainer,styles:T},w)))}_renderLegendForElementInfo(e,i,r,n,o){if(e.type)return this._renderLegendForElement(e,i,r,!0);let u=null;const p=vle(i,o);if(e.preview?u=N("div",{afterCreate:Gn,bind:e.preview,class:at.symbol}):e.src&&(u=this._renderImage(e,i,p)),!u)return null;const g={[at.imageryLayerInfoStretched]:p},w={[at.imageryLayerInfoStretched]:p,[at.sizeRamp]:!p&&n};return N("div",{class:at.layerRow},N("div",{class:this.classes(at.symbolContainer,w)},u),N("div",{class:this.classes(at.layerInfo,g)},Gf(this.messages,e.label,!1)||""))}_renderImage(e,i,r){const{label:n,src:o,opacity:u}=e,p={[at.imageryLayerStretchedImage]:r,[at.symbol]:!r},g={opacity:`${u??i.opacity}`};return N("img",{alt:Gf(this.messages,n,!1),"aria-label":Gf(this.messages,n,!1),border:0,class:this.classes(p),height:e.height,src:o,styles:g,width:e.width})}};m([b()],Dy.prototype,"activeLayerInfos",void 0),m([b()],Dy.prototype,"headingLevel",void 0),m([b(),vt("esri/widgets/Legend/t9n/Legend")],Dy.prototype,"messages",void 0),m([b({readOnly:!0})],Dy.prototype,"type",void 0),Dy=m([G("esri.widgets.Legend.styles.Classic")],Dy);const Ug=Dy,eze={base:"esri-legend"};let Un=class extends vi{constructor(e,i){super(e,i),this.headingLevel=3,this.messages=null,this.style=new Ug,this.viewModel=new VVe}initialize(){this.addHandles([gi(()=>this.view,"resize",()=>this.scheduleRender()),gi(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),ce(()=>this.headingLevel,e=>{const{style:i}=this;i&&(i.headingLevel=e)}),ce(()=>this.style,(e,i)=>{i&&e!==i&&i.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},Qe)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof c4||e instanceof Ug)return e;if(typeof e=="string")return e==="card"?new c4:new Ug;if(e&&typeof e.type=="string"){const i={...e};return delete i.type,new(e.type==="card"?c4:Ug)(i)}return new Ug}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return N("div",{class:this.classes(eze.base,Ee.widget,this.style instanceof Ug?Ee.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach(i=>{this.removeHandles(`version_${i.layer.uid}`),this._renderOnActiveLayerInfoChange(i)}),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const i=ce(()=>e.version,()=>this.scheduleRender());this.addHandles(i,`version_${e.layer.uid}`);const r=gi(()=>e.children,"change",()=>e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n)),Qe);this.addHandles(r,`version_${e.layer.uid}`),e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))}};m([b()],Un.prototype,"activeLayerInfos",null),m([b()],Un.prototype,"basemapLegendVisible",null),m([b()],Un.prototype,"groundLegendVisible",null),m([b()],Un.prototype,"headingLevel",void 0),m([b()],Un.prototype,"hideLayersNotInCurrentView",null),m([b()],Un.prototype,"keepCacheOnDestroy",null),m([b()],Un.prototype,"respectLayerDefinitionExpression",null),m([b()],Un.prototype,"respectLayerVisibility",null),m([b()],Un.prototype,"icon",null),m([b()],Un.prototype,"label",null),m([b()],Un.prototype,"layerInfos",null),m([b(),vt("esri/widgets/Legend/t9n/Legend")],Un.prototype,"messages",void 0),m([b()],Un.prototype,"style",void 0),m([Dt("style")],Un.prototype,"castStyle",null),m([b()],Un.prototype,"view",null),m([b()],Un.prototype,"viewModel",void 0),Un=m([G("esri.widgets.Legend")],Un);const wle=Un,tze=Object.freeze(Object.defineProperty({__proto__:null,default:wle},Symbol.toStringTag,{value:"Module"})),er="esri-search",Ai={base:er,hasMultipleSources:`${er}--multiple-sources`,isLoading:`${er}--loading`,isSearching:`${er}--searching`,showSuggestions:`${er}--show-suggestions`,showSources:`${er}--sources`,showWarning:`${er}--warning`,container:`${er}__container`,input:`${er}__input`,inputContainer:`${er}__input-container`,form:`${er}__form`,submitButton:`${er}__submit-button`,sourcesButton:`${er}__sources-button`,sourcesButtonDown:`${er}__sources-button--down`,sourcesButtonUp:`${er}__sources-button--up`,clearButton:`${er}__clear-button`,sourceName:`${er}__source-name`,suggestionsMenu:`${er}__suggestions-menu`,suggestionList:`${er}__suggestions-list`,suggestionListCurrentLocation:`${er}__suggestions-list--current-location`,sourcesMenu:`${er}__sources-menu`,source:`${er}__source`,warningMenu:`${er}__warning-menu`,warningMenuBody:`${er}__warning-body`,warningMenuHeader:`${er}__warning-header`,warningMenuText:`${er}__warning-text`,noValueText:`${er}__no-value-text`},P0="esri-search-result-renderer",R0={base:P0,showMoreResults:`${P0}__more-results--show-more-results`,moreResults:`${P0}__more-results`,moreResultsList:`${P0}__more-results-list`,moreResultsHeader:`${P0}__more-results-header`,moreResultsItem:`${P0}__more-results-item`,moreResultsListHeader:`${P0}__more-results-list-header`};function Kq(t){var e;switch(t==null?void 0:t.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":case"polyline":return(e=t.extent)==null?void 0:e.center;default:return null}}async function ize(t,e){var n,o;if(t.hasZ||e.type==="2d")return t;const i=(n=e.map)==null?void 0:n.ground;if(!(i!=null&&i.layers.length))return t;const{geometry:r}=await i.queryElevation(t,{cache:(o=e.basemapTerrain)==null?void 0:o.elevationQueryCache});return r}function m7(t,e,i){return _le(t.center,e,i)}function iN(t,e,i){switch(t==null?void 0:t.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return _le(t,e,i);default:return null}}function _le(t,e,i){const r=t.hasZ?t.z:void 0;if(e!=null&&e.map)return(i!=null?xje(e,i):e.extent).clone().centerAt(t).set({zmax:r,zmin:r});const{x:n,y:o,spatialReference:u}=t;return new jt({xmin:n-.25,ymin:o-.25,xmax:n+.25,ymax:o+.25,spatialReference:u,zmin:r,zmax:r})}let nn=class extends nc(ye){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};m([b()],nn.prototype,"autoNavigate",void 0),m([b()],nn.prototype,"filter",void 0),m([b()],nn.prototype,"getResults",void 0),m([b()],nn.prototype,"getSuggestions",void 0),m([b()],nn.prototype,"maxResults",void 0),m([b()],nn.prototype,"maxSuggestions",void 0),m([b()],nn.prototype,"minSuggestCharacters",void 0),m([b()],nn.prototype,"outFields",void 0),m([b()],nn.prototype,"placeholder",void 0),m([b()],nn.prototype,"popupEnabled",void 0),m([b()],nn.prototype,"popupTemplate",void 0),m([b()],nn.prototype,"prefix",void 0),m([b()],nn.prototype,"resultGraphicEnabled",void 0),m([b()],nn.prototype,"resultSymbol",void 0),m([b()],nn.prototype,"suggestionsEnabled",void 0),m([b()],nn.prototype,"suffix",void 0),m([b()],nn.prototype,"withinViewEnabled",void 0),m([b()],nn.prototype,"zoomScale",void 0),nn=m([G("esri.widgets.Search.SearchSource")],nn);const rN=nn,rze=/https?:\/\/services.*\.arcgis\.com/i,nze=/(?:\{([^}]+)\})/g,Hv=()=>fe.getLogger("esri.widgets.Search.support.layerSearchUtils");function sze(t,e){const{exactMatch:i=!1,location:r,maxResults:n,spatialReference:o,source:u,sourceIndex:p,suggestResult:g,view:w}=t,{layer:S,filter:T,zoomScale:E}=u,C=w==null?void 0:w.scale,L=Sle(u,w),R=e==null?void 0:e.signal;return $le(S).then(()=>{const F=S.popupTemplate;return F?F.getRequiredFields(S.fieldsIndex):null}).then(F=>{var ge,we,ke,$e;const{objectIdField:V,returnZ:U}=S,W=Cle(u);if(!nN(S,W))throw Hv().error("invalid-field: displayField is invalid."),new re("getResults():invalid-field","displayField is invalid.");const H=F!=null&&F.length?F:[W],J=u.outFields||H,X=xle(J);if(J.includes(V)||X||J.push(V),(ge=S.floorInfo)!=null&&ge.floorField&&J.push(S.floorInfo.floorField),!(X||mI(S,J)))throw Hv().error("invalid-field: outField is invalid."),new re("getResults():invalid-field","outField is invalid.");const te=S.createQuery(),{orderByFields:oe}=u;if(oe&&(te.orderByFields=oe),o){te.outSpatialReference=o;const Fe=1/hr(o);Fe&&(te.maxAllowableOffset=Fe)}const pe=S.geometryType==="mesh"||S.geometryType==="multipatch",de=((ke=(we=S.capabilities)==null?void 0:we.data)==null?void 0:ke.supportsZ)&&!pe;if(te.returnZ=de&&U!==!1,te.returnGeometry=!0,te.multipatchOption=pe?"xyFootprint":null,J&&(te.outFields=J),r)te.geometry=r;else if(g.key)te.objectIds=[g.key];else{const Fe=u.searchFields||[W];if(!mI(S,Fe))throw Hv().error("invalid-field: search field is invalid."),new re("getResults():invalid-field","search field is invalid.");if(kle(S)&&(te.num=n),L&&(te.geometry=L),!(($e=g.text)==null?void 0:$e.trim()))return[];const qe=g.text,{prefix:Ue="",suffix:ei=""}=u,jr=Ale(`${Ue}${qe}${ei}`);Mle(S)&&Ele(S,Fe)&&!i&&qe&&(te.fullText=Ile({text:qe,searchFields:Fe}));const cs=Lle({searchTerm:jr,layer:S,searchFields:Fe,filter:T,exactMatch:i,query:te,type:"search"});if(te.where=cs,!Tle(te))return[]}return S.queryFeatures(te,{signal:R}).then(Fe=>vze(Fe,w,u,p,W,C,E))})}function oze(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:o,maxSuggestions:u,sourceIndex:p,exactMatch:g}=t,{layer:w,filter:S}=i,T=e==null?void 0:e.signal,E=Sle(i,n);return $le(w).then(()=>{if(!kle(w))return[];const C=Cle(i),L=i.searchFields||[C],R=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(nze,(de,ge)=>(R.push(ge),de)):R.push(C);const F=xle(R);R.includes(w.objectIdField)||F||R.push(w.objectIdField);const V=nN(w,C),U=F||mI(w,R),W=mI(w,L);if(!V)throw Hv().error("invalid-field: displayField is invalid."),new re("getSuggestions():invalid-field","displayField is invalid.");if(!U)throw Hv().error("invalid-field: outField is invalid."),new re("getSuggestions():invalid-field","outField is invalid.");if(!W)throw Hv().error("invalid-field: search field is invalid."),new re("getSuggestions():invalid-field","search field is invalid.");const H=w.createQuery(),{orderByFields:J}=i;if(J&&(H.orderByFields=J),H.outSpatialReference=r,H.returnGeometry=!1,H.num=u,H.outFields=R,E&&(H.geometry=E),!o.trim())return[];const{prefix:X="",suffix:te=""}=i,oe=Ale(`${X}${o}${te}`);Mle(w)&&Ele(w,L)&&!g&&o&&(H.fullText=Ile({text:o,searchFields:L}));const pe=Lle({searchTerm:oe,layer:w,searchFields:L,filter:S,exactMatch:g,query:H,type:"suggest"});return H.where=pe,Tle(H)?w.queryFeatures(H,{signal:T}).then(de=>yze(de,i,p,C)):[]})}function Sle(t,e){const{filter:i,withinViewEnabled:r}=t,n=e==null?void 0:e.extent;return(i==null?void 0:i.geometry)??(r&&n?n:void 0)}function xle(t){return t&&t.includes("*")}async function $le(t){t&&await t.load()}function Tle(t){return!(!t.fullText&&!t.where)}function Ele(t,e){const i=t==null?void 0:t.indexes;return!i||!(e!=null&&e.length)?!1:i.filter(r=>r.indexType==="FullText").some(r=>{var o;const n=((o=r.fields)==null?void 0:o.split(",").map(u=>u.trim().toLowerCase()))||[];return e.every(u=>n.includes(u.toLowerCase()))})}function Ile({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new ete({onFields:e,searchTerm:i,searchType:"prefix"}))}function Mle(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsFullTextSearch)??!1}function kle(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsPagination)??!1}function aze(t){var e,i,r;return((r=(i=(e=t==null?void 0:t.fieldsIndex)==null?void 0:e.fields)==null?void 0:i.find(n=>n.type==="string"))==null?void 0:r.name)??""}function Cle(t){return t.displayField||t.layer.displayField||aze(t.layer)}function mI(t,e){return!(!t||!(e!=null&&e.length))&&e.every(i=>nN(t,i))}function nN(t,e){return!!t.getField(e)}function lze(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function uze({codedValues:t},e,i){return Qv(t??[],r=>{const n=r.name,o=i?n:n.toLowerCase();return(i?e:e.toLowerCase())===o?r.code.toString():null})??null}function Ale(t){return t.replaceAll("'","''")}function Vw(t,e){const i=e==null?void 0:e.where;return i?`(${t}) AND (${i})`:t}function cze({currentTerm:t,field:e,filter:i,exactMatch:r,url:n,type:o}){const u=e==null?void 0:e.type,p=e==null?void 0:e.name;if(u==="string"||u==="date"||u==="global-id"){const g=rze.test(n??""),w=g&&lze(t)?"N":"";return Vw(r&&o==="search"?`${p} = ${w}'${t}'`:g?`${p} LIKE ${w}${`'${t}%'`}`:`${`LOWER(${p})`} LIKE ${w}${`'${t.toLowerCase()}%'`}`,i)}if(u==="oid"||u==="small-integer"||u==="integer"||u==="single"||u==="double"){const g=Number(t);return isNaN(g)?null:Vw(`${p} = ${g}`,i)}return Vw(`${p} = ${t}`,i)}function hze(t,e){return t?` OR (${e})`:`(${e})`}function Lle({searchTerm:t,layer:e,searchFields:i,filter:r,exactMatch:n,query:o,type:u}){const{definitionExpression:p,url:g}=e;let w="";return!o.fullText&&t&&i&&i.forEach(S=>{const T=e.getField(S),E=typeof e.getFieldDomain=="function"&&e.getFieldDomain(S),C=(E&&E.type==="coded-value"?uze(E,t,n):null)||t||null;if(C!==null){const L=cze({currentTerm:C,field:T,filter:r,exactMatch:n,url:g,type:u});L&&(w+=hze(w,L))}}),p&&w?`(${p}) AND (${w})`:p||w}function pze(t,e){let i=null;const{codedValues:r}=t;return r&&r.length&&r.some(n=>n.code===e&&(i=n.name,!0)),i}function dze(t,e){return t[e]??t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function Ole(t,e,i){const r=t.sourceLayer,{attributes:n}=t,o=typeof r.getFieldDomain=="function"&&r.getFieldDomain(i);if(e)return qn(e,n);if(i&&n){const u=r.getField(i),p=dze(n,i);return p==null?"":o&&o.type==="coded-value"?pze(o,p)??"":(u==null?void 0:u.type)==="date"?ln(new Date(p)):typeof p=="number"?p.toString():typeof p!="string"?"":p.trim()}return""}function fze(t,e,i,r){const n=t.sourceLayer,{attributes:o}=t,{objectIdField:u}=n,p=u?o[u]:null;return{text:Ole(t,e.suggestionTemplate,r),key:p,sourceIndex:i}}function yze(t,e,i,r){return t.features.map(n=>fze(n,e,i,r))}function mze(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function gze(t,e,i,r,n,o,u){const p=t.clone(),g=t.sourceLayer,w=g==null?void 0:g.objectIdField,S=w?t.attributes[w]:null,T=Ole(t,i.searchTemplate,n);o!=null&&mze(g)&&(g.minScale&&g.minScale<o?o=g.minScale:g.maxScale&&g.maxScale>o&&(o=g.maxScale));const E=p.geometry?iN(p.geometry,e??void 0,o??void 0):void 0,C=typeof u=="number"&&E?m7(ae(E),e??void 0,u):E,L=t.clone();return C!=null&&(L.geometry=xo.fromExtent(C)),{extent:C,target:L,feature:p,key:S,name:T,sourceIndex:r}}function vze(t,e,i,r,n,o,u){return t.features.map(p=>gze(p,e,i,r,n,o,u))}var g7;let Mu=g7=class extends rN{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>sze({source:this,...e},i),this.getSuggestions=(e,i)=>oze({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new g7({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ae(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?ae(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var t,e;return((e=(t=this.layer.fieldsIndex)==null?void 0:t.fields.find(i=>i.type==="string"))==null?void 0:e.name)??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;return t.loaded?`: ${(e||[this._getDisplayField()]).map(i=>{const r=t.getField(i);return(r==null?void 0:r.alias)||i}).join(", ")}`:""}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};m([b({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Mu.prototype,"displayField",void 0),m([b({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Mu.prototype,"exactMatch",void 0),m([b({value:null})],Mu.prototype,"layer",null),m([b()],Mu.prototype,"name",null),m([b({type:[String],json:{write:!0}})],Mu.prototype,"orderByFields",void 0),m([b()],Mu.prototype,"searchFields",void 0),m([b()],Mu.prototype,"searchTemplate",void 0),m([b()],Mu.prototype,"suggestionTemplate",void 0),Mu=g7=m([G("esri.widgets.Search.LayerSearchSource")],Mu);const X1=Mu;function bze(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function wze(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let gf=class extends ye{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};m([b({type:String,json:{write:!0}})],gf.prototype,"address",void 0),m([b({type:Object,json:{write:!0}})],gf.prototype,"attributes",void 0),m([b({type:jt,json:{write:!0}})],gf.prototype,"extent",void 0),m([b({type:Ke,json:{write:!0}})],gf.prototype,"location",void 0),m([b({type:Number,json:{write:!0}})],gf.prototype,"score",void 0),gf=m([G("esri.rest.support.AddressCandidate")],gf);const Ple=gf,sN={type:String,json:{read:{source:"token"},write:{target:"token"}}};let ms=class extends ye{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};m([b({type:Object,json:{write:!0}})],ms.prototype,"address",void 0),m([b(sN)],ms.prototype,"apiKey",void 0),m([b({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],ms.prototype,"categories",void 0),m([b({type:String,json:{write:!0}})],ms.prototype,"countryCode",void 0),m([b({type:Boolean,json:{write:!0}})],ms.prototype,"forStorage",void 0),m([b({type:Ke,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],ms.prototype,"location",void 0),m([b({type:String,json:{write:!0}})],ms.prototype,"locationType",void 0),m([b({type:String,json:{write:!0}})],ms.prototype,"magicKey",void 0),m([b({type:Number,json:{write:!0}})],ms.prototype,"maxLocations",void 0),m([b({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],ms.prototype,"outFields",void 0),m([b({type:Ge,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ms.prototype,"outSpatialReference",void 0),m([b({type:jt,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],ms.prototype,"searchExtent",void 0),ms=m([G("esri.rest.support.AddressToLocationsParameters")],ms),ms.from=Yi(ms);const Rle=ms;async function _ze(t,e,i){e=Rle.from(e);const r=Du(t),{address:n,...o}=e.toJSON(),u={...n,...o,f:"json"},p=$S({...r.query,...u}),g=xS(p,i),w=`${r.path}/findAddressCandidates`;return nt(w,g).then(Sze)}function Sze({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(r=>{if(!r)return;const{extent:n,location:o}=r,u=!n||wze(n);return bze(o)&&u?(n&&(n.spatialReference=i),o&&(o.spatialReference=i),Ple.fromJSON(r)):void 0}):[]}let wp=class extends ye{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};m([b(sN)],wp.prototype,"apiKey",void 0),m([b({type:Ke,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,r=i!==void 0;e.location=r?i:null}}}})],wp.prototype,"location",void 0),m([b({type:String,json:{write:!0}})],wp.prototype,"locationType",void 0),m([b({type:Ge,json:{read:{source:"outSR"},write:{target:"outSR"}}})],wp.prototype,"outSpatialReference",void 0),wp=m([G("esri.rest.support.LocationToAddressParameters")],wp),wp.from=Yi(wp);const Fle=wp;async function xze(t,e,i){e=Fle.from(e);const r=Du(t),n={...e.toJSON(),f:"json"},o=$S({...r.query,...n}),u=xS(o,i),p=`${r.path}/reverseGeocode`;return nt(p,u).then($ze)}function $ze({data:t}){if(!t)return;const{address:e,location:i}=t,r=(e==null?void 0:e.Match_addr)||"";return Ple.fromJSON({address:r,attributes:e||{},location:i,score:100})}let Q1=class extends ye{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};m([b({type:Boolean,json:{write:!0}})],Q1.prototype,"isCollection",void 0),m([b({type:String,json:{write:!0}})],Q1.prototype,"magicKey",void 0),m([b({type:String,json:{write:!0}})],Q1.prototype,"text",void 0),Q1=m([G("esri.rest.support.SuggestionCandidate")],Q1);const Tze=Q1;let Ia=class extends ye{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};m([b(sN)],Ia.prototype,"apiKey",void 0),m([b({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Ia.prototype,"categories",void 0),m([b({type:String,json:{write:!0}})],Ia.prototype,"countryCode",void 0),m([b({type:Ke,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Ia.prototype,"location",void 0),m([b({type:Number,json:{write:!0}})],Ia.prototype,"maxSuggestions",void 0),m([b({type:Ge,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ia.prototype,"outSpatialReference",void 0),m([b({type:jt,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],Ia.prototype,"searchExtent",void 0),m([b({type:String,json:{write:!0}})],Ia.prototype,"text",void 0),Ia=m([G("esri.rest.support.SuggestLocationsParameters")],Ia),Ia.from=Yi(Ia);const Nle=Ia;async function Eze(t,e,i){const r=Du(t),n={...(e=Nle.from(e)).toJSON(),f:"json"},o=$S({...r.query,...n}),u=xS(o,i),p=`${r.path}/suggest`;return nt(p,u).then(Ize)}function Ize(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(r=>new Tze(r)):[]}const Mze="Single Line Input",kze=3e5;function Cze(t,e){return t.location?Rze(t,e):Fze(t,e)}function Dle(t,e){var r;if(e.localSearchDisabled)return null;const i=t==null?void 0:t.scale;return typeof i=="number"&&i<=kze?(r=t==null?void 0:t.extent)==null?void 0:r.center:null}async function Aze(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:o,maxSuggestions:u,sourceIndex:p}=t,g=new Nle,{apiKey:w,url:S}=i,T=jle(i,n),E=e==null?void 0:e.signal;if(!S)return null;w&&(g.apiKey=w),i.categories&&(g.categories=i.categories),r&&(g.outSpatialReference=r);const C=Dle(n,i);if(C&&(g.location=C),!o.trim())return null;const{prefix:L="",suffix:R=""}=i,F=`${L}${o}${R}`;return g.text=F,T&&(g.searchExtent=T),g.maxSuggestions=u,i.countryCode&&(g.countryCode=i.countryCode),Eze(S,g,{signal:E}).then(V=>Dze(V,p))}function Lze(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Oze(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Yq(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const Pze="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function Rze(t,e){const{source:i,spatialReference:r,location:n,sourceIndex:o,view:u}=t,{apiKey:p,url:g,zoomScale:w,defaultZoomScale:S}=i;if(g==null)return[];const T=u==null?void 0:u.scale,E=e==null?void 0:e.signal,C=new Fle({location:n});p&&(C.apiKey=p),r&&(C.outSpatialReference=r);try{return Vle([await xze(g,C,{signal:E})],{sourceIndex:o,scale:T,view:u,zoomScale:w,defaultZoomScale:S})}catch{return[]}}function jle(t,e){const{filter:i,withinViewEnabled:r}=t,n=e==null?void 0:e.scale,o=e==null?void 0:e.extent,u=i==null?void 0:i.geometry;return(u?iN(u,e??void 0,n):void 0)||(r&&o?o:void 0)}async function Fze(t,e){var te;const{source:i,suggestResult:r,spatialReference:n,view:o,maxResults:u,sourceIndex:p}=t,g=i==null?void 0:i.zoomScale,w=i==null?void 0:i.defaultZoomScale;if(!((te=r.text)==null?void 0:te.trim()))return null;const T=!r.key&&i.prefix?i.prefix:"",E=!r.key&&i.suffix?i.suffix:"",C=`${T}${r.text}${E}`,L=new Rle,{apiKey:R,url:F}=i,V=o==null?void 0:o.scale,U=jle(i,o),W=e==null?void 0:e.signal;if(R&&(L.apiKey=R),!F)return null;i.categories&&(L.categories=i.categories),i.locationType&&(L.locationType=i.locationType),n&&(L.outSpatialReference=n);const H=Dle(o,i);H&&(L.location=H),L.maxLocations=u,U&&(L.searchExtent=U),i.countryCode&&(L.countryCode=i.countryCode);const{key:J}=r,X=`${J}`;return J&&(L.magicKey=X),L.address={},L.address[i.singleLineFieldName||Mze]=C,i.outFields&&(L.outFields=i.outFields),_ze(F,L,{signal:W}).then(oe=>Vle(oe,{key:X,scale:V,sourceIndex:p,view:o,zoomScale:g,defaultZoomScale:w}))}function Nze(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function Dze(t,e){return t.map(i=>Nze(i,e))}function jze(t,e){const{key:i,scale:r,sourceIndex:n,view:o,zoomScale:u,defaultZoomScale:p}=e,{attributes:g,extent:w,location:S,address:T}=t,E=new Cr({geometry:S,attributes:g}),C=w||S,L=C?iN(C,o??void 0,r??void 0):void 0,R=L?typeof u=="number"?m7(L,o??void 0,u):typeof p=="number"&&(C==null?void 0:C.type)==="point"?m7(L,o??void 0,p):L:null,F=S?`${S.x},${S.y}`:"",V=T||F,U=E.clone();return R!=null&&(U.geometry=xo.fromExtent(R)),{extent:R,feature:E,target:U,key:i,name:V,sourceIndex:n}}function Vle(t,e){return t.filter(Boolean).map(i=>jze(i,e))}var v7;let Gs=v7=class extends rN{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>Cze({source:this,...e},i),this.getSuggestions=(e,i)=>Aze({source:this,...e},i)}clone(){return new v7({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ae(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?ae(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};m([b()],Gs.prototype,"apiKey",void 0),m([b()],Gs.prototype,"categories",void 0),m([b()],Gs.prototype,"countryCode",void 0),m([b({json:{write:!0}})],Gs.prototype,"defaultZoomScale",void 0),m([b()],Gs.prototype,"localSearchDisabled",void 0),m([b()],Gs.prototype,"locationType",void 0),m([b({json:{write:!0}})],Gs.prototype,"name",void 0),m([b({json:{write:!0}})],Gs.prototype,"placeholder",void 0),m([b()],Gs.prototype,"searchTemplate",void 0),m([b({json:{write:!0}})],Gs.prototype,"singleLineFieldName",void 0),m([b({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Gs.prototype,"suggestionsEnabled",void 0),m([b({json:{write:!0}})],Gs.prototype,"url",void 0),m([b({json:{write:!0}})],Gs.prototype,"zoomScale",void 0),Gs=v7=m([G("esri.widgets.Search.LocatorSearchSource")],Gs);const zle=Gs,Ule=()=>fe.getLogger("esri.widgets.support.geolocationUtils"),Vze={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function zze(){const t=me("esri-geolocation");return t||Ule().warn("geolocation-unsupported","Geolocation unsupported."),t}function Uze(){const t=window.isSecureContext;return t||Ule().warn("insecure-context","Geolocation requires a secure origin."),t}function Xq(){return zze()&&Uze()}function Gze(t){return t||(t=Vze),new Promise((i,r)=>{setTimeout(()=>r(new re("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,r,t??void 0)})}function Bze(t,e){const{position:i,view:r}=t,n=qze(i),o=n==null?void 0:n.coords;if(!o)throw new re("geometry-service:no-coords","Geolocation has no coordinates");return Wze(Hze(o),r,e)}function qze(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t&&{coords:i,timestamp:t.timestamp}}function Hze({longitude:t,latitude:e,altitude:i}){return new Ke({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function Wze(t,e,i){if(!e)return Promise.resolve(t);const r=e.spatialReference;return r.isWGS84?Promise.resolve(t):r.isWebMercator?Promise.resolve(Dp(t)):Jze(i).then(n=>{if(!n)throw new re("geometry-service:missing-url","Geometry service URL is missing");const o=new uR({geometries:[t],outSpatialReference:r});return Jte(n,o,i).then(u=>u[0])})}function Jze(t){if(Ct.geometryServiceUrl)return Promise.resolve(Ct.geometryServiceUrl);const e=wr.getDefault();return e.load(t).catch(()=>{}).then(()=>{var i,r;return(r=(i=e.helperServices)==null?void 0:i.geometry)==null?void 0:r.url})}function Ps(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const Zze=()=>DI("esri/widgets/Search/t9n/Search"),Qq="highlight",E5=Ie.ofType({key:t=>t.layer?"layer":"locator",base:rN,typeMap:{layer:X1,locator:zle}}),eH=Ge.WGS84,Kze="esri/images/search/search-symbol-32.png",Yze=/<[\s\S]*?>/g,ev=-1;let St=class extends LM(Ar.EventedMixin(Te)){constructor(e){super(e),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new E5,this.defaultSymbols={point:new Qb({url:qt(Kze),size:24,width:24,height:24}),polyline:new cn({color:[130,130,130,1],width:2}),polygon:new na({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=wr.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new E5,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const i=await Zze();this.messages=i,this.defaultPopupTemplate=new Wm({title:i.searchResult,content:"{Match_addr}"})};e(),this.addHandles([ce(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),Qe),FI(e)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:ev}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){var e;return(e=this.messages)==null?void 0:e.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:i,includeDefaultSources:r}=this,n=typeof r=="function"?r.call(null,{sources:e,defaultSources:i}):r?i.concat(e):e,o=this._get("allSources")||new E5;return o.removeAll(),o.addMany(n.filter(Boolean)),o}get locationEnabled(){return this._get("locationEnabled")||Xq()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const i=Xq();if(e&&!i){const r=new re("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});fe.getLogger(this).error(r)}this._override("locationEnabled",!!e&&i)}get placeholder(){const{allSources:e,activeSourceIndex:i,allPlaceholder:r}=this;if(i===ev)return r??"";const n=e.at(i);return(n==null?void 0:n.placeholder)??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:i}=this;e&&i&&e.graphics.remove(i),this._set("resultGraphic",null)}search(e,i){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),n=(async()=>{var o;try{await this.when();const u=await this._getResultsFromSources(r,i);if((o=i==null?void 0:i.signal)!=null&&o.aborted)return null;const p={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(p,u,r);const g=this._getFirstResult(p.results),w=r.location&&g?g.name:r.text,S=w==null?void 0:w.replace(Yze,"");return this._set("searchTerm",S),(r.key&&typeof r.sourceIndex=="number"||r.location)&&this._set("selectedSuggestion",r),this._set("results",p.results),this._set("resultCount",p.results.reduce((T,E)=>{var C;return T+(((C=E.results)==null?void 0:C.length)??0)},0)),this.emit("search-complete",p),await this._selectFirstResult(g),p}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(e){if(!this.locationEnabled){const r=new re("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw fe.getLogger(this).error(r),r}const i=(async()=>{try{const r=await Gze(),n=await Bze({position:r,view:this.view},e);return await this.search(n,e)}finally{this._clearSearching()}})();return this._searching=i,i}async select(e){if(this.clearGraphics(),!e){const de=new re("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});throw fe.getLogger(this).error(de),de}const{view:i}=this,r=Ps(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),n=r!=null?this.allSources.at(r):null;if(!n){const de=new re("select:missing-source","Cannot select without a source.",{source:n});throw fe.getLogger(this).error(de),de}const o=n instanceof X1?this._getLayerSourcePopupTemplate(n):n.popupTemplate,u=n.resultSymbol||this._getDefaultSymbol(e),p=Ps(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,g=Ps(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,w=Ps(n,"popupEnabled")?n.popupEnabled:this.popupEnabled,S=w?o||this.popupTemplate||this.defaultPopupTemplate:null,{feature:T}=e;if(!T){const de=new re("select:missing-feature","Cannot select without a feature.",{feature:T});throw fe.getLogger(this).error(de),de}const{attributes:E,geometry:C,layer:L,sourceLayer:R}=T,F=C?Kq(C):null,V={layerViewQuery:this._getLayerView(T),elevationQuery:i&&F!=null?ize(F,i):Promise.resolve(F)},U=await Qy(V),W=U.layerViewQuery.value,H=U.elevationQuery.value;u instanceof Zm&&(u.text=e.name);const J=i&&g?e.target||e.extent:null;await(J!=null?this._goToSearchResult(J):Promise.resolve());const te=W?T:new Cr({geometry:C,symbol:u,attributes:E,layer:L,sourceLayer:R,popupTemplate:S}),oe=i==null?void 0:i.popup,pe=oe&&w&&te.getEffectivePopupTemplate(oe.defaultPopupTemplateEnabled);return pe&&await i.openPopup({features:[te],location:H}),W&&MF(W)&&!pe&&this._highlightFeature({graphic:te,layerView:W}),!W&&p&&i&&i.graphics.push(te),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",te),this.emit("select-result",{result:e,source:n,sourceIndex:r}),e}async suggest(e,i,r){const n=e||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(i,r);const o=await this._suggestImmediate(n,r);return this._set("suggestions",o==null?void 0:o.results),this._set("suggestionCount",(o==null?void 0:o.results.reduce((u,p)=>{var g;return u+(((g=p.results)==null?void 0:g.length)??0)},0))??null),this.emit("suggest-complete",o),o}async when(){await vr(()=>!this.updating)}async _update(){const{portal:e,view:i}=this;if(this.includeDefaultSources){const r=this._updatingPromise=Qy([e==null?void 0:e.load(),i==null?void 0:i.when()]);if(this.destroyed||(await r,r!==this._updatingPromise))return}await vr(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){var i,r;const e=(r=(i=this.portal)==null?void 0:i.helperServices)==null?void 0:r.geocode;return e?e.map(n=>{var g;if(n.placefinding===!1)return;const o=Ct.apiKey&&Yq(n.url)?{url:Pze}:null,u=zle.fromJSON({...n,...o}),p=u.url;if(Yq(p)||Oze(p)||Lze(p)){const w=u.outFields??["Addr_type","Match_addr","StAddr","City"],S=(u.placeholder||((g=this.messages)==null?void 0:g.placeholder))??"",T=typeof u.defaultZoomScale=="number"?u.defaultZoomScale:2500;u.singleLineFieldName="SingleLine",u.outFields=w,u.placeholder=S,u.defaultZoomScale=T}return u.singleLineFieldName?u:void 0}).filter(Rt):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e==null?void 0:e.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(o=>{const u=r.findLayerById(o.id);if(!u)return;const p=this._getLayerJSON(o),g=X1.fromJSON(p);return g.placeholder=i,this._getLayer(u,p).then(w=>{g.layer=w}),g}).filter(Rt).toArray()}_getTableSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(o=>{if(!o.id)return;const u=r.findTableById(o.id);if(!u)return;const p=this._getLayerJSON(o),g=X1.fromJSON(p);return g.placeholder=i,this._getLayer(u,p).then(w=>{g.layer=w}),g}).filter(Rt).toArray()}_convertApplicationProperties(){var p,g,w;const e=(p=this.view)==null?void 0:p.map,i=(w=(g=e==null?void 0:e.applicationProperties)==null?void 0:g.viewing)==null?void 0:w.search;if(!i)return[];const{enabled:r,hintText:n,layers:o,tables:u}=i;return r?[...this._getLayerSources(o,n),...this._getTableSources(u,n)]:[]}async _getSubLayer(e,i){var o;if(await e.load(),!e.allSublayers)throw new Error;const r=e.allSublayers.find(u=>u.id===i.subLayer);if(!r)throw new Error;const n=await((o=r.createFeatureLayer)==null?void 0:o.call(r));if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(e,i){await e.load();const r=e.allSublayers.find(n=>n.id===i.subLayer);if((r==null?void 0:r.type)!=="building-component")throw new Error;if(await r.load(),r.associatedLayer==null)throw new Error;return await r.associatedLayer.load(),r}async _getLayer(e,i){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,i)}catch{const n=new re("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return fe.getLogger(this).error(n),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,i):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:i}=this;this._destroyFeatureLayers(),e.removeAll(),i&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var o;const e=(o=this.view)==null?void 0:o.popup,{resultGraphic:i}=this;if(!e||!i)return;const r="selectedFeature"in e,n=r?e.selectedFeature:null;r&&n&&n===i&&e.close()}_suggestTimer(e,i){const r=e??this.suggestionDelay;return Db(r,null,i==null?void 0:i.signal)}_createLocationForSearch(e){return e instanceof Cr&&e.geometry?Kq(e.geometry):e instanceof Ke?e:Array.isArray(e)&&e.length===2?new Ke({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Ps(e,"key")&&Ps(e,"text")&&Ps(e,"sourceIndex"))return e;const i=this._createLocationForSearch(e),r=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:n,selectedResult:o}=this,u=!e&&n&&o,p=u&&n.key===o.key&&n.sourceIndex===o.sourceIndex,g=u&&n.location;return p||g?n:{location:i,text:i?"":r,sourceIndex:null,key:null}}_getFirstResult(e){return Qv(e,({results:i})=>i==null?void 0:i[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,i){var o;await this.when();const r=await this._getSuggestionsFromSources(e,i);if((o=i==null?void 0:i.signal)!=null&&o.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,r),n}_formatSourceResponse(e,i,r){const n=(i==null?void 0:i.value)||[],o=i==null?void 0:i.error,u=this.allSources.at(r);if(o){const p={sourceIndex:r,source:u,error:o};e.errors.push(p),fe.getLogger(this).error(o),e.numErrors++}else{const p={sourceIndex:r,source:u,results:n};e.results.push(p),e.numResults+=n.length}}_formatResponse(e,i,r){if(i)if(e.activeSourceIndex===ev){const n=r&&Ps(r,"sourceIndex")&&r.sourceIndex!==-1?r.sourceIndex:void 0;i.forEach((o,u)=>{const p=n!==void 0?n:u;this._formatSourceResponse(e,o,p)})}else this._formatSourceResponse(e,i[0],e.activeSourceIndex)}async _getResultsFromSources(e,i){const{allSources:r}=this,n=!e.location&&Ps(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,o=[];if(!r.length){const u=new re("search:no-sources-defined","At least one source is required.",{allSources:r});throw fe.getLogger(this).error(u),u}return n===ev?r.forEach((u,p)=>{o.push(this._getResultsFromSource(e,p,i))}):o.push(this._getResultsFromSource(e,n,i)),Qy(o)}async _getSuggestionsFromSources(e,i){const{allSources:r,activeSourceIndex:n}=this,o=[];if(!r.length){const u=new re("suggest:no-sources-defined","At least one source is required.",{allSources:r});throw fe.getLogger(this).error(u),u}return n===ev?r.forEach((u,p)=>{o.push(this._getSuggestionsFromSource(e,p,i))}):o.push(this._getSuggestionsFromSource(e,n,i)),Qy(o)}async _getResultsFromSource(e,i,r){var S,T;const n=i!=null?this.allSources.at(i):null;if(!n)return null;const{location:o=null}=e,u=((S=this.view)==null?void 0:S.spatialReference)||eH,p=Ps(n,"maxResults")?n.maxResults:this.maxResults,g=!!(n instanceof X1&&Ps(n,"exactMatch"))&&n.exactMatch,{view:w}=this;return(T=n.getResults)==null?void 0:T.call(n,{view:w,sourceIndex:i,location:o,suggestResult:e,spatialReference:u,exactMatch:g,maxResults:p},r)}async _getSuggestionsFromSource(e,i,r){var g,w;const n=this.allSources.at(i);if(!n)return null;e??(e="");const o=Ps(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,u=e==null?void 0:e.length,p=Ps(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(o&&e.trim()&&u>=p){const S=((g=this.view)==null?void 0:g.spatialReference)||eH,T=Ps(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:E}=this,C=!!(n instanceof X1&&Ps(n,"exactMatch"))&&n.exactMatch;return(w=n.getSuggestions)==null?void 0:w.call(n,{view:E,sourceIndex:i,suggestTerm:e,spatialReference:S,maxSuggestions:T,exactMatch:C},r)}return null}_getLayerSourcePopupTemplate(e){const{layer:i}=e;if(i)return Ps(e,"popupTemplate")?e.popupTemplate:i.popupTemplate}_getSourceIndexOfResult(e){return Qv(this.results??[],({results:i,sourceIndex:r})=>(i==null?void 0:i.includes(e))?r:null)??null}async _goToSearchResult(e){this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{signal:i.signal}};e||(r.options.animate=!1),await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){var n;const{defaultSymbols:i}=this,r=(n=e.feature)==null?void 0:n.geometry;if(r==null)return null;switch(r.type){case"point":case"multipoint":return i.point;case"polyline":return i.polyline;case"extent":case"polygon":return i.polygon;default:return null}}_removeHighlight(){this.removeHandles(Qq)}async _getLayerView(e){var n,o;const{view:i}=this;if(!e||!i||((n=e.layer)==null?void 0:n.type)==="building-component"||((o=e.layer)==null?void 0:o.type)==="subtype-sublayer")return null;const{layer:r}=e;return r?(await i.when(),i.whenLayerView(r)):null}_highlightFeature(e){const{graphic:i,layerView:r}=e,{attributes:n,layer:o}=i,{objectIdField:u}=o,p=(u&&(n==null?void 0:n[u]))??null,g=r.highlight(p??i);this.addHandles(g,Qq)}_setResultFloor(e){var o,u,p;const{view:i}=this,r=(o=e.feature)==null?void 0:o.attributes,n=(u=e.feature)==null?void 0:u.sourceLayer;if(n&&"floorInfo"in n&&((p=n==null?void 0:n.floorInfo)!=null&&p.floorField)&&r){const g=r[n.floorInfo.floorField];i==null||i.emit("select-result-floor",g)}}};St.ALL_INDEX=ev,m([b()],St.prototype,"_searching",void 0),m([b()],St.prototype,"_updatingPromise",void 0),m([b({readOnly:!0,value:null})],St.prototype,"activeSource",null),m([b()],St.prototype,"activeSourceIndex",null),m([b()],St.prototype,"allPlaceholder",null),m([b({readOnly:!0})],St.prototype,"allSources",null),m([b()],St.prototype,"autoNavigate",void 0),m([b()],St.prototype,"autoSelect",void 0),m([b()],St.prototype,"defaultPopupTemplate",void 0),m([b({readOnly:!0})],St.prototype,"defaultSources",void 0),m([b()],St.prototype,"defaultSymbols",void 0),m([b()],St.prototype,"includeDefaultSources",void 0),m([b()],St.prototype,"locationEnabled",null),m([b()],St.prototype,"maxInputLength",void 0),m([b()],St.prototype,"maxResults",void 0),m([b()],St.prototype,"maxSuggestions",void 0),m([b()],St.prototype,"messages",void 0),m([b()],St.prototype,"minSuggestCharacters",void 0),m([b({readOnly:!0})],St.prototype,"placeholder",null),m([b()],St.prototype,"popupEnabled",void 0),m([b({type:Wm})],St.prototype,"popupTemplate",void 0),m([b({type:wr})],St.prototype,"portal",void 0),m([b()],St.prototype,"resultCount",void 0),m([b()],St.prototype,"resultGraphicEnabled",void 0),m([b({readOnly:!0})],St.prototype,"resultGraphic",void 0),m([b({readOnly:!0})],St.prototype,"results",void 0),m([b({readOnly:!0})],St.prototype,"selectedSuggestion",void 0),m([b()],St.prototype,"searchAllEnabled",void 0),m([b({readOnly:!0})],St.prototype,"selectedResult",void 0),m([b()],St.prototype,"searchTerm",null),m([b({type:E5})],St.prototype,"sources",void 0),m([b({readOnly:!0})],St.prototype,"state",null),m([b()],St.prototype,"suggestionDelay",void 0),m([b()],St.prototype,"suggestionCount",void 0),m([b({readOnly:!0})],St.prototype,"suggestions",void 0),m([b()],St.prototype,"suggestionsEnabled",void 0),m([b({readOnly:!0})],St.prototype,"updating",null),m([b()],St.prototype,"view",void 0),m([b()],St.prototype,"clear",null),St=m([G("esri.widgets.Search.SearchViewModel")],St);const vv=St;let vf=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[R0.showMoreResults]:this.showMoreResultsOpen};return N("div",{class:this.classes(R0.base,Ee.widget)},N("div",{class:this.classes(R0.moreResults,e),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return N("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){var r;const e=(r=this.viewModel)==null?void 0:r.selectedResult,i=(e==null?void 0:e.name)||"";return N("div",{class:R0.moreResultsItem,key:"esri-search-renderer__result-name"},i)}_renderMoreResultsLists(){const{viewModel:e}=this;if(!e)return[];const i=e.results;if((e.resultCount??0)<2)return null;const r=i==null?void 0:i.map(n=>this._renderMoreResultsList(n));return N("div",{class:R0.moreResultsList,key:"esri-search-renderer__more-results-container"},r)}_renderMoreResultsButton(){const{messages:e,viewModel:i}=this;return i?(i.resultCount??0)<2?null:N("div",{class:R0.moreResultsItem,key:"esri-search-renderer__more-results-button"},N("a",{bind:this,class:Ee.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults)):null}_renderMoreResultsHeader(e,i){return N("div",{class:R0.moreResultsListHeader,key:`esri-search-result-renderer__header-${i}`},e)}_renderMoreResultsList(e){var T,E,C;const{results:i}=e,r=(i==null?void 0:i.length)??0,n=r>0,o=(T=this.viewModel)==null?void 0:T.selectedResult,u=r===1&&i[0]===o,p=this._getSourceName(e.source,e.sourceIndex),g=(((C=(E=this.viewModel)==null?void 0:E.results)==null?void 0:C.length)??0)>1&&!u?this._renderMoreResultsHeader(p,e.sourceIndex):null,w=n&&i.map((L,R)=>this._renderMoreResultsListItem(L,R)),S=n&&!u?N("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},w):null;return n?N("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},g,S):null}_renderMoreResultsListItem(e,i){var n;const r=(n=this.viewModel)==null?void 0:n.selectedResult;return e!==r?N("li",{key:`esri-search-result-renderer__list-item-${i}`},N("a",{bind:this,class:Ee.anchor,"data-result":e,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},e.name)):null}_showMoreResultsClick(e){var r,n;e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const i=(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.popup;i&&"reposition"in i&&i.reposition()}_selectResultClick(e){var r;e.preventDefault();const i=e.currentTarget["data-result"];(r=this.viewModel)==null||r.select(i)}_getSourceName(e,i){return i===vv.ALL_INDEX?this.messages.all:e.name}};m([b(),vt("esri/widgets/Search/t9n/Search")],vf.prototype,"messages",void 0),m([b()],vf.prototype,"showMoreResultsOpen",void 0),m([b()],vf.prototype,"viewModel",void 0),m([mm()],vf.prototype,"_showMoreResultsClick",null),m([mm()],vf.prototype,"_selectResultClick",null),vf=m([G("esri.widgets.Search.SearchResultRenderer")],vf);const Xze=vf,Qze=/<[a-z/][\s\S]*>/i,eUe=(t,e)=>{const i=cce(e).split(/\s/),r=new RegExp(`(${i.join("|")})`,"gi");return t.replace(r,n=>`<strong>${n}</strong>`)};let Tt=class extends vi{constructor(e,i){super(e,i),this._activeMenuItemIndex=-1,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new Xze,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new vv,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=r=>{var o;const n=r.relatedTarget;n&&((o=this._container)!=null&&o.contains(n))||this._clearActiveMenu()},this.addHandles([ce(()=>this.searchTerm,r=>{var n,o;(r&&this.activeMenu==="warning"||!r&&!((o=(n=this.viewModel)==null?void 0:n.selectedSuggestion)!=null&&o.location))&&this._clearActiveMenu()}),gi(()=>{var r;return(r=this.viewModel)==null?void 0:r.allSources},"change",()=>this._watchSourceChanges()),ce(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),Qe),ce(()=>{var r;return(r=this.viewModel)==null?void 0:r.defaultPopupTemplate},r=>{r&&(r.content=this._renderSearchResultsContent.bind(this))},Qe)])}destroy(){this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=ot(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){var e;return(e=this.viewModel)==null?void 0:e.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"search"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){var e;return(e=this.viewModel)==null?void 0:e.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this.viewModel.clear()}focus(){var e;(e=this._inputNode)==null||e.focus(),this.emit("search-focus")}blur(){var e;(e=this._inputNode)==null||e.blur(),this.emit("search-blur")}async search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const i=new AbortController,{signal:r}=i;this._searchController=i;try{const n=await this.viewModel.search(e,{signal:r});return this._searchController!==i?void 0:(this.activeMenu=n!=null&&n.numResults?"none":"warning",this._searchController=null,n)}catch{return this._searchController!==i?void 0:(this._clearActiveMenu(),void(this._searchController=null))}}async suggest(e){this._cancelSuggest();const i=new AbortController,{signal:r}=i;this._suggestController=i;try{const n=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==i?void 0:(this._suggestController=null,n!=null&&n.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n)}catch{return this._suggestController!==i||(this._suggestController=null),null}}render(){const{state:e}=this.viewModel,i={[Ee.disabled]:e==="disabled",[Ee.widgetDisabled]:this.disabled};return N("div",{class:this.classes(Ai.base,Ee.widget,i)},e==="loading"?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const{messages:e,disabled:i}=this;return N("button",{"aria-label":e.searchButtonTitle,bind:this,class:this.classes(Ai.submitButton,Ee.widgetButton),disabled:i,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},N("span",{"aria-hidden":"true",class:$n.search}))}_renderWarningMenu(){return N("div",{class:this.classes(Ee.menu,Ai.warningMenu),key:"esri-search__error-menu"},N("div",{class:Ai.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const{messages:e,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n,disabled:o}=this,{activeSourceIndex:u,allSources:p}=this.viewModel;return p.length>1?N("button",{afterCreate:hv,"aria-controls":r,"aria-expanded":(i==="source").toString(),"aria-haspopup":"true","aria-label":e.searchIn,bind:this,class:this.classes(Ai.sourcesButton,Ee.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:o,id:n,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,title:e.searchIn,type:"button"},N("span",{"aria-hidden":"true",class:this.classes($n.downArrow,Ai.sourcesButtonDown)}),N("span",{"aria-hidden":"true",class:this.classes($n.upArrow,Ai.sourcesButtonUp)}),N("span",{class:Ai.sourceName},this._getSourceName(u))):null}_renderSourcesList(){const{allSources:e,searchAllEnabled:i}=this.viewModel,{_activeMenuItemIndex:r,activeMenu:n,sourceMenuId:o,sourceMenuButtonId:u}=this,p=n==="source"&&r>-1?this._buildId("source-item",r):null;return e.length>1?N("ul",{afterCreate:hv,"aria-activedescendant":p,"aria-labelledby":u,bind:this,class:Ee.menuList,"data-node-ref":"_sourceListNode",id:o,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},i?this._renderSource(vv.ALL_INDEX):null,e.map((g,w)=>this._renderSource(w)).toArray()):null}_renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?N("div",{class:this.classes(Ee.menu,Ai.sourcesMenu),key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const{messages:e,messagesCommon:i,disabled:r}=this;return N("div",{class:Ee.loader,key:"base-loader",tabIndex:r?-1:void 0},N("span",{"aria-hidden":"true",class:Ee.loaderAnimation}),N("span",{class:$n.fontFallbackText},e.searchButtonTitle),N("span",{class:Ee.loaderText},i.loading))}_renderContainer(){const{allSources:e,state:i}=this.viewModel,{activeMenu:r}=this,n={[Ai.hasMultipleSources]:e.length>1,[Ai.isLoading]:i==="loading",[Ai.isSearching]:i==="searching",[Ai.showWarning]:r==="warning",[Ai.showSources]:r==="source",[Ai.showSuggestions]:r==="suggestion"};return N("div",{afterCreate:o=>{this._container=o,o.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:o=>{o.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,Ai.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?N("button",{bind:this,class:this.classes(Ai.clearButton,Ee.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},N("span",{"aria-hidden":"true",class:$n.close})):null}_renderLocationGroup(){const{messages:e,locationEnabled:i,displayedSearchTerm:r}=this,n=i&&!r,o=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return n?N("ul",{class:this.classes(Ee.menuList,Ai.suggestionList,Ai.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},N("li",{"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),bind:this,class:this.classes(Ee.menuItem,o?Ee.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",0),onclick:this._handleUseCurrentLocationClick,role:"option"},N("span",{"aria-hidden":"true",class:$n.locateCircled})," ",e.useCurrentLocation)):null}_renderInput(){const{activeMenu:e,locationEnabled:i,displayedSearchTerm:r,messages:n,suggestionsMenuId:o,inputId:u,_activeMenuItemIndex:p,disabled:g}=this,{maxInputLength:w,placeholder:S,searchTerm:T,suggestionCount:E}=this.viewModel,C=!(!(i&&!r)&&!E),L=e==="suggestion"&&p>-1?this._buildId("suggestion-item",p):null;return N("input",{afterCreate:hv,"aria-activedescendant":L,"aria-autocomplete":"list","aria-controls":C?o:null,"aria-expanded":(C&&e==="suggestion").toString(),"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(Ee.input,Ai.input),"data-node-ref":"_inputNode",disabled:g,id:u,maxlength:w,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:S,role:"combobox",title:T?"":S,type:"text",value:T})}_renderForm(){return N("form",{bind:this,class:Ai.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(e){const{sourceIndex:i}=e,{results:r}=e;return(r==null?void 0:r.length)?N("ul",{class:this.classes(Ee.menuList,Ai.suggestionList),key:`esri-search__suggestion-list-${i}`,role:"group"},r==null?void 0:r.map(o=>this._renderSuggestion(o,this._menuItemCount++))):null}_renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map(i=>[this._renderSuggestionHeader(i),this._renderSuggestList(i)]):[]}_renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:i,suggestionsMenuId:r,inputId:n}=this,{suggestionCount:o}=this.viewModel,u=i&&!e||o;return this._menuItemCount=0,u?N("div",{afterCreate:hv,"aria-labelledby":n,bind:this,class:this.classes(Ee.menu,Ai.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:r,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),this._renderSuggestionsGroup()):null}_renderInputContainer(){return N("div",{class:Ai.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(e){var p;const{allSources:i,activeSourceIndex:r}=this.viewModel,{sourceIndex:n}=e,o=(p=e.results)==null?void 0:p.length,u=i.length>1&&r===vv.ALL_INDEX;return o&&u?N("div",{class:Ee.menuHeader,key:`esri-search__suggestion-header-${n}`},this._getSourceName(n)):null}_renderSuggestion(e,i){const{_activeMenuItemIndex:r,viewModel:{searchTerm:n}}=this;if(!n)return;const o=this.activeMenu==="suggestion"&&r===i;return N("li",{"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===i).toString(),bind:this,class:this.classes(Ee.menuItem,o?Ee.menuItemFocus:null),"data-suggestion":e,id:this._buildId("suggestion-item",i),innerHTML:this._getSuggestResultHTML(e.text,n),key:`esri-search__suggestion_${i}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(e){const{activeSourceIndex:i,searchAllEnabled:r}=this.viewModel,n={[Ee.menuItemActive]:e===i,[Ee.menuItemFocus]:this.activeMenu==="source"&&e===(r?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},o=r?e+1:e;return N("li",{"aria-checked":(e===i).toString(),bind:this,class:this.classes(Ai.source,Ee.menuItem,n),"data-source-index":e,id:this._buildId("source-item",o),key:`esri-search__source-${e}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(e))}_renderNoResultsWarning(e){const{messages:i}=this,r=e?qn(i.noResultsFoundForValue,{value:`"${e}"`}):i.noResultsFound;return N("div",{key:"esri-search__no_results"},N("div",{class:Ai.warningMenuHeader},i.noResults),N("div",{class:Ai.warningMenuText},r))}_renderEmptySearchWarning(){const{messages:e}=this;return N("div",{key:"esri-search__empty-search"},N("span",{"aria-hidden":"true",class:$n.noticeTriangle}),N("span",{class:Ai.noValueText},e.emptyValue))}_renderLocateWarning(){const{messages:e}=this;return N("div",{key:"esri-search__locate-error"},N("span",{"aria-hidden":"true",class:$n.noticeTriangle}),N("span",{class:Ai.noValueText},e.locateError))}_renderWarning(){var n;const{displayedSearchTerm:e,_locateFailed:i}=this,{viewModel:r}=this;return i?this._renderLocateWarning():(n=r.selectedSuggestion)!=null&&n.location||e?this._renderNoResultsWarning(e):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,i){return`${this.id}-${e}${i===void 0?"":`-${i}`}`}_watchSourceChanges(){const{viewModel:{allSources:e}}=this,i="sources";this.removeHandles(i),e.forEach(r=>this.addHandles(ce(()=>r.name,()=>this.scheduleRender()),i))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var i;const e=this.activeMenu==="source";this.activeMenu=e?"none":"source",this.renderNow(),this.activeMenu==="source"&&((i=this._sourceListNode)==null||i.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const i=tH(e.currentTarget);i&&(this._focus(),this.search(i))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e,(async()=>{try{const r=await this.viewModel.searchNearby({signal:i});this.activeMenu=r!=null&&r.numResults?"none":"warning"}catch{this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var r;if(!e)return;const i=tUe(e);i!=null&&(this.viewModel.activeSourceIndex=i,this._clearActiveMenu(),(r=this._sourceMenuButtonNode)==null||r.focus())}_cancelSuggest(){this._suggestController=En(this._suggestController)}_cancelSearch(){this._searchController=En(this._searchController),this._locateFailed=!1}_handleInputKeyup(e){var o;const{key:i}=e;if(e.ctrlKey||e.metaKey||i==="Copy"||i==="ArrowLeft"||i==="ArrowRight"||i==="Shift")return;if(i==="Tab"||i==="Escape"||e.shiftKey&&i==="Tab")return this._cancelSuggest(),void(i==="Escape"&&this._clearActiveMenu());const r=i==="Home"||i==="End"||i==="ArrowUp"||i==="ArrowDown";if(i==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=(o=this._suggestionListNode)==null?void 0:o.getElementsByTagName("li");if(n!=null&&n.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),r)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(i,n,this._suggestionListNode);const u=n[this._activeMenuItemIndex];if(i==="Enter"&&u){const p=tH(u);return void(p?(this._focus(),this.search(p)):iUe(u)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(e,i,r){const n=this._activeMenuItemIndex;e==="Home"&&(this._activeMenuItemIndex=0),e==="End"&&(this._activeMenuItemIndex=i.length-1),e==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?i.length-1:this._activeMenuItemIndex-1),e==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===i.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&r&&VEe(i[this._activeMenuItemIndex],r)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const i=e.target;this.viewModel.searchTerm!==i.value&&(this.viewModel.searchTerm=i.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){var r;const{key:i}=e;if(gR(i)){e.preventDefault();const n=(r=this._sourceListNode)==null?void 0:r.getElementsByTagName("li"),o=n==null?void 0:n[this._activeMenuItemIndex];this._setSourceFromMenuItem(o)}else i!=="ArrowUp"&&i!=="ArrowDown"&&i!=="End"&&i!=="Home"||e.preventDefault()}_handleSourceMenuKeyup(e){var o,u,p;const{key:i}=e,r=i==="ArrowUp"||i==="ArrowDown"||i==="End"||i==="Home";if(r&&e.preventDefault(),i==="Escape")return this._clearActiveMenu(),void((o=this._sourceMenuButtonNode)==null?void 0:o.focus());const n=(u=this._sourceListNode)==null?void 0:u.getElementsByTagName("li");return n&&n.length!==0&&r?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(i,n,(p=this._sourceListNode)==null?void 0:p.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(e){const{messages:i}=this,r=this.viewModel,{allSources:n}=r,o=n.at(e);return e===vv.ALL_INDEX?i.all:o&&o.name||i.untitledSource}_getSuggestResultHTML(e,i){return e?Qze.test(e)?e:eUe(e,i):this.messages.untitledResult}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};function tH(t){return t==null?void 0:t["data-suggestion"]}function tUe(t){return t==null?void 0:t["data-source-index"]}function iUe(t){return!!(t!=null&&t["data-current-location-item"])}m([b()],Tt.prototype,"_activeMenuItemIndex",void 0),m([b()],Tt.prototype,"displayedSearchTerm",null),m([b({readOnly:!0})],Tt.prototype,"inputId",null),m([b({readOnly:!0})],Tt.prototype,"suggestionsMenuId",null),m([b({readOnly:!0})],Tt.prototype,"sourceMenuId",null),m([b({readOnly:!0})],Tt.prototype,"sourceMenuButtonId",null),m([b()],Tt.prototype,"activeMenu",void 0),m([b({readOnly:!0})],Tt.prototype,"activeSource",null),m([b()],Tt.prototype,"activeSourceIndex",null),m([b()],Tt.prototype,"allPlaceholder",null),m([b({readOnly:!0})],Tt.prototype,"allSources",null),m([b()],Tt.prototype,"autoNavigate",null),m([b()],Tt.prototype,"autoSelect",null),m([b({readOnly:!0})],Tt.prototype,"defaultSources",null),m([b()],Tt.prototype,"disabled",void 0),m([b()],Tt.prototype,"goToOverride",null),m([b()],Tt.prototype,"icon",null),m([b()],Tt.prototype,"includeDefaultSources",null),m([b()],Tt.prototype,"label",null),m([b()],Tt.prototype,"locationEnabled",null),m([b()],Tt.prototype,"maxResults",null),m([b()],Tt.prototype,"maxSuggestions",null),m([b(),vt("esri/widgets/Search/t9n/Search")],Tt.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Tt.prototype,"messagesCommon",void 0),m([b()],Tt.prototype,"minSuggestCharacters",null),m([b()],Tt.prototype,"popupEnabled",null),m([b()],Tt.prototype,"popupTemplate",null),m([b()],Tt.prototype,"portal",null),m([b()],Tt.prototype,"resultGraphic",null),m([b()],Tt.prototype,"resultGraphicEnabled",null),m([b({readOnly:!0})],Tt.prototype,"results",null),m([b()],Tt.prototype,"searchAllEnabled",null),m([b()],Tt.prototype,"searchTerm",null),m([b({readOnly:!0})],Tt.prototype,"selectedResult",null),m([b()],Tt.prototype,"sources",null),m([b({readOnly:!0})],Tt.prototype,"suggestions",null),m([b()],Tt.prototype,"suggestionsEnabled",null),m([b()],Tt.prototype,"view",null),m([v0(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),b({type:vv})],Tt.prototype,"viewModel",void 0),Tt=m([G("esri.widgets.Search")],Tt);const rUe=Tt;function nUe(t){var n,o;const e="metric";if(t==null)return e;const i=t.map,r=(i&&"portalItem"in i?(n=i.portalItem)==null?void 0:n.portal:null)??wr.getDefault();switch(((o=r.user)==null?void 0:o.units)??r.units){case e:return e;case"english":return"imperial"}return Wde(t.spatialReference)??e}const Gle={readOnly:!0,get(){return nUe(this.view)}},no="esri-scale-bar",sr={base:no,labelContainer:`${no}__label-container`,rulerLabelContainer:`${no}__label-container--ruler`,lineLabelContainer:`${no}__label-container--line`,topLabelContainer:`${no}__label-container--top`,bottomLabelContainer:`${no}__label-container--bottom`,label:`${no}__label`,line:`${no}__line`,topLine:`${no}__line--top`,bottomLine:`${no}__line--bottom`,ruler:`${no}__ruler`,rulerBlock:`${no}__ruler-block`,barContainer:`${no}__bar-container`,rulerBarContainer:`${no}__bar-container--ruler`,lineBarContainer:`${no}__bar-container--line`};function sUe(t){return t>.5?{min:.5,max:1}:t>.2?{min:.2,max:.5}:{min:.1,max:.2}}function oUe(t,e){switch(e){case"metric":return t>1e3?{distance:lt(t,"meters","kilometers"),unit:"kilometer"}:t>1?{distance:t,unit:"meter"}:t>.01?{distance:lt(t,"meters","centimeters"),unit:"centimeter"}:{distance:lt(t,"meters","millimeters"),unit:"millimeter"};case"imperial":return t>1609.344?{distance:lt(t,"meters","miles"),unit:"mile"}:t>.3048?{distance:lt(t,"meters","feet"),unit:"foot"}:{distance:lt(t,"meters","inches"),unit:"inch"}}}function aUe(t){var n;const{isWebMercator:e,wkt:i,wkt2:r}=t;return e||(((n=r||i)==null?void 0:n.includes("WGS_1984_Web_Mercator"))??!1)}function iH({state:{paddedViewState:t},spatialReference:e,width:i}){return e.isWrappable&&t.worldScreenWidth<i}function rH(t,e){const{x:i,y:r}=t?em(e,!0):e;return[i,r]}let tv=class extends Te{constructor(e){super(e),this.scaleComputedFrom=Mr(),this.view=null}get state(){var e,i;return(e=this.view)!=null&&e.ready&&((i=this.view)==null?void 0:i.type)==="2d"?"ready":"disabled"}getScaleBarProperties(e,i){if(this.state==="disabled"||isNaN(e)||!i||!this.view)return null;const r=this._getDistanceInMeters();return r==null?null:this._getScaleBarProps(e,r,i)}_getDistanceInMeters(){const{state:e,spatialReference:i}=this.view;if(!Jo(i))return null;const{isGeographic:r}=i,n=aUe(i);if(!r&&!n)return e.extent.width*(aZ(i)??1);const[o,u]=this._getScaleMeasuringPoints(),p=n||r&&!b0(i)?Ge.WGS84:i,g=new Bn({paths:[[rH(n,o),rH(n,u)]],spatialReference:p}),w=ere(g,10);let S;try{[S]=DR([w],"meters")}catch{return null}return S}_getScaleMeasuringPoints(){const e=this.view,{width:i,height:r,position:n,spatialReference:o}=e;if(iH(e)){const w=_s(o),{valid:S}=w;return[new Ke(S[0],0,o),new Ke(S[1],0,o)]}let u=this.scaleComputedFrom.y-n[1];u>r?u=r:u<0&&(u=0);const p=Mr(0,u),g=Mr(i,u);return[e.toMap(p),e.toMap(g)]}_getScaleBarProps(e,i,r){const n=this.view,o=e*i/(iH(n)?n.state.paddedViewState.worldScreenWidth:n.width);if(o<.001)return null;const u=oUe(o,r),{distance:p,unit:g}=u;let w=p,S=0;for(;w>=1;)w/=10,S++;const{min:T,max:E}=sUe(w),C=E/w>=w/T?T:E;return{length:e*(C/w),value:10**S*C,unit:g}}};m([b()],tv.prototype,"scaleComputedFrom",void 0),m([b({readOnly:!0})],tv.prototype,"state",null),m([b()],tv.prototype,"view",void 0),tv=m([G("esri.widgets.ScaleBar.ScaleBarViewModel")],tv);const lUe=tv;function nH(t,e){return as(t,{style:"unit",unit:e,unitDisplay:"short"})}let ku=class extends vi{constructor(e,i){super(e,i),this.messages=null,this.style="line",this.viewModel=new lUe}initialize(){this.addHandles(ce(()=>{const{view:e}=this;return[e==null?void 0:e.stationary,e==null?void 0:e.center,e==null?void 0:e.scale,e==null?void 0:e.zoom]},([e])=>{e&&this.scheduleRender()}))}get icon(){return"actual-size"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this._defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel.state==="disabled",i={[Ee.disabled]:e};let r,n;if(!e){const{unit:o,style:u}=this,p=o==="metric"||o==="dual",g=100,w=o==="dual"?"line":u;if(o==="imperial"||o==="dual"){const S=this.viewModel.getScaleBarProperties(g,"imperial");S&&(n=w==="ruler"?this._renderRuler(S):this._renderLine(S,"bottom"))}if(p){const S=this.viewModel.getScaleBarProperties(g,"metric");S&&(r=w==="ruler"?this._renderRuler(S):this._renderLine(S,"top"))}}return N("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(sr.base,Ee.widget,i)},r,n)}_renderRuler(e){const{length:i,unit:r,value:n}=e,o=Math.round(i),u=nH(n,r);return N("div",{class:this.classes(sr.barContainer,sr.rulerBarContainer),key:sr.rulerBarContainer},N("div",{class:sr.ruler,styles:{width:`${o}px`}},N("div",{class:sr.rulerBlock}),N("div",{class:sr.rulerBlock}),N("div",{class:sr.rulerBlock}),N("div",{class:sr.rulerBlock})),N("div",{class:this.classes(sr.labelContainer,sr.rulerLabelContainer)},N("div",{class:sr.label},"0"),N("div",{class:sr.label},u)))}_renderLine(e,i){const{length:r,unit:n,value:o}=e,u=Math.round(r),p=nH(o,n),g={[sr.topLabelContainer]:i==="top",[sr.bottomLabelContainer]:i==="bottom"},w=N("div",{class:this.classes(sr.labelContainer,sr.lineLabelContainer,g),key:sr.labelContainer},N("div",{class:sr.label},p)),S={[sr.topLine]:i==="top",[sr.bottomLine]:i==="bottom"},T=N("div",{class:this.classes(sr.line,S),key:sr.line,styles:{width:`${u}px`}});return N("div",{class:this.classes(sr.barContainer,sr.lineBarContainer),key:sr.lineBarContainer},[T,w])}_handleRootCreateOrUpdate(e){if(!this.viewModel)return;const{scaleComputedFrom:i}=this.viewModel,r=e.getBoundingClientRect(),n=r.left+window.pageXOffset,o=r.top+window.pageYOffset,u=Mr(n,o);(u.x!==i.x||u.y!==i.y)&&(this.viewModel.scaleComputedFrom=u)}};m([b(Gle)],ku.prototype,"_defaultUnit",void 0),m([b()],ku.prototype,"icon",null),m([b()],ku.prototype,"label",null),m([b(),vt("esri/widgets/ScaleBar/t9n/ScaleBar")],ku.prototype,"messages",void 0),m([b({type:["ruler","line"]})],ku.prototype,"style",void 0),m([b({type:["metric","imperial","dual"]})],ku.prototype,"unit",null),m([b()],ku.prototype,"view",null),m([b()],ku.prototype,"viewModel",void 0),ku=m([G("esri.widgets.ScaleBar")],ku);const uUe=ku;function sH(t){return t.icon?t.icon:"image"in t&&t.image||t.className?void 0:"question"}function cUe(t){return t?{backgroundImage:`url(${t})`}:{}}function yst({action:t,feature:e}){const i=e==null?void 0:e.attributes,r="image"in t?t.image:void 0;return r&&i?qn(r,i):r??""}const vl="esri-layer-list",ou=`${vl}__item`,Li={base:vl,actionMenu:`${vl}__action-menu`,actionGroup:`${vl}__action-group`,filterNoResults:`${vl}__filter-no-results`,item:ou,itemActive:`${ou}--active`,itemContent:`${ou}-content`,itemContentBottom:`${ou}-content-bottom`,itemMessage:`${ou}-message`,itemInvisible:`${ou}--invisible`,itemActionIcon:`${ou}-action-icon`,itemActionImage:`${ou}-action-image`,itemTemporaryIcon:`${ou}-temporary-icon`,itemTableIcon:`${ou}-table-icon`,itemCatalogIcon:`${ou}-catalog-icon`,statusIndicator:`${vl}__status-indicator`,publishing:`${vl}__publishing`,updating:`${vl}__updating`,connectionStatus:`${vl}__connection-status`,connectionStatusConnected:`${vl}__connection-status--connected`,visibleToggle:`${vl}__visible-toggle`,visibleIcon:`${vl}__visible-icon`};let bl=class extends Te{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};m([b({type:Boolean,nonNullable:!0})],bl.prototype,"catalogLayerList",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"closeButton",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"collapseButton",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"errors",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"filter",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"flow",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"heading",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"statusIndicators",void 0),m([b({type:Boolean,nonNullable:!0})],bl.prototype,"temporaryLayerIndicators",void 0),bl=m([G("esri.widgets.LayerList.LayerListVisibleElements")],bl);const Ble=bl,hUe=Ie.ofType(QM);let Mt=class extends nc(vi){constructor(e,i){super(e,i),this._activeItem=null,this._tooltipReferenceMap=new fm,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusTableListFlowItem=!1,this._focusCatalogFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=xNe,this.minFilterItems=SNe,this.openCatalogItem=null,this.openTableListItem=null,this.selectedItems=new hUe,this.selectionMode="none",this.tableList=null,this.viewModel=new UF,this.visibilityAppearance="default",this.visibleElements=new Ble,this._canMove=({dragEl:r,fromEl:n,toEl:o},u)=>{var J,X,te;const p=u==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,g=uc(r);if(!(g!=null&&g.sortable))return!1;const w=uc(n),S=EB(n),T=uc(o),E=EB(o),C=!!S&&!!E&&S===E,L={selected:g,from:w,to:T},R=n.group,F=o.group,V=((J=w==null?void 0:w.layer)==null?void 0:J.type)??"",U=((X=T==null?void 0:T.layer)==null?void 0:X.type)??"",W=new Set(["map-image","catalog","knowledge-graph"]);return R&&F&&typeof p=="function"?p.call(null,L):C&&!W.has(V)&&!W.has(U)&&((te=g==null?void 0:g.layer)==null?void 0:te.type)!=="sublayer"},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=r=>{if(this.visibilityAppearance!=="default")return;const n=Array.from(r.composedPath()).find(o=>{var u;return(u=o.classList)==null?void 0:u.contains(Li.item)});this._activeItem=uc(n)},this._onCalciteListOrderChange=r=>{const{_lastDragDetail:n}=this,{toEl:o,fromEl:u,dragEl:p,newIndex:g}=r;if(u&&o&&!((n==null?void 0:n.newIndex)===g&&(n==null?void 0:n.dragEl)===p&&(n==null?void 0:n.toEl)===o&&(n==null?void 0:n.fromEl)===u))if(this._lastDragDetail=r,u!==o)this._moveLayerFromChildList({toEl:o,fromEl:u,dragEl:p,newIndex:g});else{const w=Array.from(u.children).filter(S=>S==null?void 0:S.matches("calcite-list-item")).map(S=>S.value);this._sortLayers(u,w)}}}initialize(){this.addHandles([ce(()=>this.openCatalogItem,e=>e?this._createCatalog():this._destroyCatalog()),ce(()=>this.openTableListItem,e=>e?this._createTableList():this._destroyTableList())])}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),"action-group":()=>ie(()=>import("./calcite-action-group-DplWbV3U.js"),__vite__mapDeps([347,348,267,227,224,225,220,226,228,241,242,233,221,223,229,230,243,244,245,246,247,248,249])),"action-menu":()=>ie(()=>import("./calcite-action-menu-E8cc6COU.js"),__vite__mapDeps([349,241,242,220,226,224,233,221,225,227,223,228,229,230,243,244,245,246,247,248,249])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),flow:()=>ie(()=>import("./calcite-flow-CExHLkC9.js"),__vite__mapDeps([238,227,224])),"flow-item":()=>ie(()=>import("./calcite-flow-item-BieRNoUa.js"),__vite__mapDeps([239,220,221,224,225,226,227,228,240,241,242,233,223,229,230,243,244,245,246,247,248,249,250])),icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227])),list:()=>ie(()=>import("./calcite-list-5FytLBV3.js"),__vite__mapDeps([259,220,221,227,260,261,224,228,225,226,262,245,229,252,219,222,223,253,254,255,256,230,250])),"list-item":()=>ie(()=>import("./calcite-list-item-0BU0z9Zo.js"),__vite__mapDeps([263,220,221,225,226,227,228,224,261,260,233,223,229,230,264])),notice:()=>ie(()=>import("./calcite-notice-mqUu1NoI.js"),__vite__mapDeps([266,267,227,220,224,225,226,228,247,223,229])),tooltip:()=>ie(()=>import("./calcite-tooltip-Ci-tYktH.js"),__vite__mapDeps([340,220,244,245,247,249]))})}destroy(){this._destroyTableList(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(i=>i.layer.type!=="catalog-dynamic-group")).length}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get multipleSelectionEnabled(){return wo(fe.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode==="multiple"}set multipleSelectionEnabled(e){wo(fe.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get selectionEnabled(){return wo(fe.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.selectionMode!=="none"&&this.dragEnabled}set selectionEnabled(e){wo(fe.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,i){return this.viewModel.triggerAction(e,i)}render(){var n,o;const e=(n=this.viewModel)==null?void 0:n.state,i={[Ee.hidden]:e==="loading",[Ee.disabled]:e==="disabled"},r=(o=this.operationalItems)==null?void 0:o.filter(u=>!u.hidden&&(this.visibleElements.errors||!u.error));return N("div",{class:this.classes(Li.base,Ee.widget,Ee.panel,i)},r!=null&&r.length?[this._renderItemTooltips(r),this._renderItems(r)]:this._renderNoItems())}_renderItemTooltip(e){const{_tooltipReferenceMap:i,messages:r}=this;return e?N("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:i.get(e.layer.uid)},r.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var i;return e.incompatible?this._renderItemTooltip(e):(i=e.children)==null?void 0:i.filter(r=>!r.hidden).toArray().map(r=>this._renderItemTooltipNodes(r))}_renderItemTooltips(e){return e==null?void 0:e.toArray().map(i=>this._renderItemTooltipNodes(i))}_renderNoItemsMessage(){return N("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return N("div",{class:Li.itemMessage,key:"esri-layer-list__no-items"},N("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}_destroyCatalog(){var e;(e=this.catalogLayerList)==null||e.destroy(),this._set("catalogLayerList",null)}_destroyTableList(){var e;(e=this.tableList)==null||e.destroy(),this._set("tableList",null)}async _createCatalog(){var T;this._destroyCatalog();const{default:e}=await ie(()=>import("./CatalogLayerList-nsaUfv3_.js"),[]),{headingLevel:i,catalogOptions:r,view:n,filterPlaceholder:o,listItemCreatedFunction:u,minFilterItems:p,selectionMode:g,visibilityAppearance:w}=this,S=(T=this.openCatalogItem)==null?void 0:T.layer;this._set("catalogLayerList",new e({headingLevel:i,view:n,filterPlaceholder:o,listItemCreatedFunction:u,minFilterItems:p,selectionMode:g,visibilityAppearance:w,...r,catalogLayer:S}))}_getTableListParams(e){const i=e==null?void 0:e.layer;return(i==null?void 0:i.type)==="knowledge-graph"?{...this.knowledgeGraphOptions,tables:i==null?void 0:i.tables}:null}async _createTableList(){var u;this._destroyTableList();const{default:e}=await ie(()=>import("./TableList-DuaOwUQT.js"),[]),i=this._getTableListParams(this.openTableListItem);if(!((u=i==null?void 0:i.tables)!=null&&u.length))return;const{headingLevel:r,selectionMode:n,dragEnabled:o}=this;this._set("tableList",new e({headingLevel:r,selectionMode:n,dragEnabled:o,...i}))}_renderCatalogFlowItem(){var n;const{openCatalogItem:e,messages:i}=this;if(!e)return null;const r=this._getLayerTitle(e);return N("calcite-flow-item",{afterCreate:this._focusCatalogFlowItemNode,afterUpdate:this._focusCatalogFlowItemNode,bind:this,description:r,heading:i.catalogLayers,headingLevel:this.headingLevel,key:`flow-catalog-${e.uid}`,onCalciteFlowItemBack:o=>{o.preventDefault(),this.openCatalogItem=null,this._focusRootFlowItem=!0}},(n=this.catalogLayerList)==null?void 0:n.render())}_renderTableListFlowItem(){var n;const{openTableListItem:e,messages:i}=this;if(!e)return null;const r=this._getLayerTitle(e);return N("calcite-flow-item",{afterCreate:this._focusTableListFlowItemNode,afterUpdate:this._focusTableListFlowItemNode,bind:this,description:r,heading:i.tables,headingLevel:this.headingLevel,key:`flow-table-list-${e.uid}`,onCalciteFlowItemBack:o=>{o.preventDefault(),this.openTableListItem=null,this._focusRootFlowItem=!0}},(n=this.tableList)==null?void 0:n.render())}_renderPanelFlowItems(e){return e?e.flatten(i=>i.children).filter(({hidden:i,panel:r})=>!i&&(r==null?void 0:r.open)&&!r.disabled&&r.flowEnabled).toArray().map(({title:i,panel:r})=>{const n=()=>this._handlePanelFlowItemBack(r);return N("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:i,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,onCalciteFlowItemBack:o=>{o.preventDefault(),n()}},r.render(),N("calcite-button",{appearance:"transparent",onclick:n,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusCatalogFlowItemNode(e){this._focusCatalogFlowItem&&(this._focusCatalogFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusTableListFlowItemNode(e){this._focusTableListFlowItem&&(this._focusTableListFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_renderItems(e){const{visible:i,collapsed:r,_filterEnabled:n,_rootGroupUid:o,visibleElements:{closeButton:u,collapseButton:p,heading:g,flow:w},_dragEnabled:S,selectionMode:T,filterText:E,filterPlaceholder:C,messages:L}=this,R=[N("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:u,closed:!i,collapsed:r,collapsible:p,heading:g?L.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},N("calcite-list",{afterCreate:F=>{F.addEventListener("focusin",this._setActiveItem),F.addEventListener("focusout",this._clearActiveItem)},afterRemoved:F=>{F.removeEventListener("focusin",this._setActiveItem),F.removeEventListener("focusout",this._clearActiveItem)},canPull:F=>this._canMove(F,"pull"),canPut:F=>this._canMove(F,"put"),"data-layer-type":o,dragEnabled:S,filterEnabled:n,filterPlaceholder:C,filterText:n?E:"",group:o,key:"root-list",label:L.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:T,onCalciteListChange:F=>this._handleCalciteListChange(F),onCalciteListDragEnd:F=>this._handleCalciteListDragEnd(F.detail),onCalciteListFilter:F=>{var V;return this.filterText=((V=F.target)==null?void 0:V.filterText)??""},onCalciteListOrderChange:F=>this._onCalciteListOrderChange(F.detail)},e==null?void 0:e.toArray().map(F=>this._renderItem(F)),e!=null&&e.length&&n?N("div",{class:Li.filterNoResults,slot:"filter-no-results"},N("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(e),this._renderTableListFlowItem(),this._renderCatalogFlowItem()];return i?w?N("calcite-flow",{key:"root-flow"},R):R:null}_renderChildList(e,i=[]){var T,E,C,L;const{_dragEnabled:r,_rootGroupUid:n,viewModel:{listModeDisabled:o},messages:u,selectionMode:p}=this,{children:g}=e,w=((T=e.layer)==null?void 0:T.type)!=="catalog-dynamic-group"&&LNe(e),S=!(!o&&ENe(e.layer))&&!w&&r&&((E=e.layer)==null?void 0:E.type)==="group";return w||S?N("calcite-list",{canPull:R=>this._canMove(R,"pull"),canPut:R=>this._canMove(R,"put"),"data-item":e,"data-layer-type":n,dragEnabled:!!r&&e.childrenSortable&&MNe(e),group:`${n}-${e.layer.uid}`,key:`child-list-${e.layer.uid}`,selectionAppearance:"border",selectionMode:p},g==null?void 0:g.filter(R=>!R.hidden).toArray().map(R=>this._renderItem(R,e,[...i,e.title])),(L=(C=this._getTableListParams(e))==null?void 0:C.tables)!=null&&L.length?N("calcite-list-item",{class:Li.item,"data-layer-id":e.layer.id,dragDisabled:!0,key:`list-item-table-list-tables-${e.layer.uid}`,title:u.tables,onCalciteListItemSelect:()=>{this.openTableListItem=e,this._focusTableListFlowItem=!0}},N("div",{class:Li.itemContent,slot:"content"},u.tables),N("calcite-icon",{class:Li.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),N("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null):null}_renderItemMessage(e){return e.error?N("div",{class:Li.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},N("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},N("div",{slot:"message"},this.messages.layerError))):e.incompatible?N("div",{class:Li.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},N("calcite-notice",{afterCreate:i=>this._setTooltipReference(i,e),afterRemoved:()=>this._removeTooltipReference(e),bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},N("div",{slot:"message"},this.messages.layerIncompatible))):null}_getLayerTitle(e){return e.title||this.messages.untitledLayer}_renderItem(e,i,r){var H,J,X,te;const{_activeItem:n,_selectedDragItemLayerUid:o,selectionMode:u,selectedItems:p,messages:g,visibleElements:w}=this,S=this._getLayerTitle(e),T=e.visibleAtCurrentTimeExtent?e.visibleAtCurrentScale?S:`${S} (${g.layerInvisibleAtScale})`:`${S} (${g.layerInvisibleAtTime})`,E=this._filterActions(e.actionsSections),C=this._countActions(E),L=((J=(H=e.parent)==null?void 0:H.layer)==null?void 0:J.type)==="catalog",R=((X=e.layer)==null?void 0:X.type)==="catalog-footprint",F=((te=e.layer)==null?void 0:te.type)==="catalog-dynamic-group",V=R?N("calcite-icon",{class:Li.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null,U=F?N("calcite-icon",{class:Li.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null,W=w.catalogLayerList&&F?N("calcite-action",{appearance:"transparent",disabled:!e.layer.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>{this.openCatalogItem=i,this._focusCatalogFlowItem=!0},scale:"s",slot:"actions-end",text:S}):null;return N("calcite-list-item",{afterCreate:oe=>this._focusSelectedDragEl(oe,e),afterUpdate:oe=>this._focusSelectedDragEl(oe,e),class:this.classes(Li.item,{[Li.itemActive]:n===e}),"data-item":e,"data-layer-id":e.layer.id,dragDisabled:!e.sortable||L,dragSelected:e.layer.uid===o,id:e.layer.uid,key:`list-item-${e.layer.uid}`,label:S,metadata:{parentTitles:r,title:S},open:e.open,selected:u!=="none"&&p.includes(e),title:T,value:e.layer.uid,onCalciteListItemDragHandleChange:oe=>this._handleCalciteListItemDragHandleChange(oe,e),onCalciteListItemSelect:oe=>this._handleCalciteListItemSelect(oe,e,i),onCalciteListItemToggle:oe=>this._handleCalciteListItemToggle(oe,e)},V,U,N("div",{class:this.classes({[Li.itemContent]:!0,[Li.itemInvisible]:!e.visibleAtCurrentScale||!e.visibleAtCurrentTimeExtent}),slot:"content"},S),this._renderItemStatus(e,i),this._renderItemToggle(e,i),W,this._renderItemTemporaryIcon(e),this._renderChildList(e,r),this._renderItemMessage(e),this._renderPanel(e.panel),this._renderPanelAction(e.panel),C>1?this._renderActionsSections(e,E):C===1?this._renderAction({item:e,action:this._getSingleAction(E),textEnabled:!1}):null)}_renderItemStatus(e,i){const{visibleElements:r}=this;if(!r.statusIndicators)return null;const{connectionStatus:n,publishing:o,updating:u}=e,p=u&&!i,g=!!n;return N("calcite-icon",{class:this.classes({[Li.statusIndicator]:!0,[Li.publishing]:o,[Li.updating]:p,[Li.connectionStatus]:g,[Li.connectionStatusConnected]:g&&n==="connected"}),icon:TNe({connectionStatus:n,publishing:o}),key:"layer-item-status",scale:"s",slot:"actions-end"})}_renderItemTemporaryIcon(e){return this.visibleElements.temporaryLayerIndicators&&"persistenceEnabled"in e.layer&&!e.layer.persistenceEnabled?N("calcite-icon",{class:Li.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}_renderItemToggle(e,i){const{messages:r,visibilityAppearance:n}=this,{visible:o}=e,u=i==null?void 0:i.visibilityMode;if(u==="inherited")return null;const p=$Ne({visible:o,exclusive:u==="exclusive",visibilityAppearance:n}),g=n==="checkbox",w=r.layerVisibility;return N("calcite-action",{appearance:"transparent",class:Li.visibleToggle,icon:g?p:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(e,i),scale:"s",slot:g?"actions-start":"actions-end",text:w,title:w},g?null:N("calcite-icon",{class:this.classes({[Li.visibleIcon]:u!=="exclusive"&&o}),icon:p,scale:"s"}))}_renderPanel(e){return!(e!=null&&e.open)||e.disabled||e.flowEnabled?null:N("div",{class:Li.itemContentBottom,key:`content-panel-${e.uid}`,slot:"content-bottom"},e.render())}_renderPanelAction(e){if(!(e!=null&&e.visible))return null;const{open:i,title:r,disabled:n}=e;return N("calcite-action",{active:i,appearance:"transparent",disabled:n,icon:sH(e),key:`action-${e.uid}`,onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:r??"",title:r??void 0},this._renderFallbackIcon(e))}_renderActionsSections(e,i){const r=this.messagesCommon.options;return N("calcite-action-menu",{appearance:"transparent",class:Li.actionMenu,key:"item-action-menu",label:this.messagesCommon.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:n=>e.actionsOpen=n.target.open},N("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:r,title:r}),i.toArray().map((n,o)=>this._renderActionSection(e,n,o)))}_renderActionSection(e,i,r){return N("calcite-action-group",{class:Li.actionGroup,key:`action-section-${r}`},i.toArray().map(n=>this._renderAction({item:e,action:n,textEnabled:!0})))}_renderFallbackIcon(e){const{className:i,icon:r}=e;if(r)return null;const n="image"in e?e.image:void 0,o={[Li.itemActionIcon]:!!i,[Li.itemActionImage]:!!n};return i&&(o[i]=!0),n||i?N("span",{"aria-hidden":"true",class:this.classes(Li.itemActionIcon,o),key:"icon",styles:cUe(n)}):null}_renderAction(e){const{item:i,action:r,textEnabled:n}=e;if(!r)return null;const{active:o,disabled:u,title:p,type:g,indicator:w}=r;return N("calcite-action",{active:g==="toggle"&&r.value,appearance:"transparent",disabled:u,icon:sH(r),indicator:w,key:`action-${r.uid}`,loading:o,onclick:()=>this._triggerAction(i,r),scale:"s",slot:n?void 0:"actions-end",text:p??"",textEnabled:n,title:p??void 0},this._renderFallbackIcon(r))}_setTooltipReference(e,i){this._tooltipReferenceMap.set(i.layer.uid,e)}_removeTooltipReference(e){this._tooltipReferenceMap.delete(e.layer.uid)}_moveLayerFromChildList({toEl:e,fromEl:i,dragEl:r,newIndex:n}){const o=uc(r),u=uc(e),p=uc(i);this.viewModel.moveListItem(o,p,u,n)}_handleCalciteListDragEnd(e){const{fromEl:i,dragEl:r,oldIndex:n}=e;i.insertBefore(r,i.children[n])}_sortLayers(e,i){var r,n;if(e)if(e.group===this._rootGroupUid)vae((n=(r=this.view)==null?void 0:r.map)==null?void 0:n.layers,i);else{const o=uc(e);if(!o)return;kNe(o,i)}}_getSingleAction(e){return e.reduce(i=>i).find(i=>i&&(i.type==="button"||i.type==="toggle"))}_filterActions(e){return e.map(i=>i.filter(r=>r.visible))}_countActions(e){return e.reduce((i,r)=>i+r.length,0)}_triggerAction(e,i){i&&e&&(i.type==="toggle"&&(i.value=!i.value),this.triggerAction(i,e))}_handleCalciteListChange(e){const{selectionMode:i,selectedItems:r}=this;if(i==="none")return;const n=e.target.selectedItems.map(o=>uc(o)).filter(Boolean);r.removeAll(),r.addMany(n)}_handleCalciteListItemToggle(e,i){e.stopPropagation(),i.open=e.target.open}_focusSelectedDragEl(e,i){this._selectedDragItemLayerUid===i.layer.uid&&requestAnimationFrame(()=>e==null?void 0:e.setFocus())}_handleCalciteListItemDragHandleChange(e,i){e.stopPropagation();const r=e.target.dragSelected;this._selectedDragItemLayerUid=r?i.layer.uid:null}_handleCalciteListItemSelect(e,i,r){uc(e.target)===i&&this.selectionMode==="none"&&(r==null?void 0:r.visibilityMode)!=="inherited"&&this._toggleVisibility(i,r)}_togglePanel(e){e.open=!e.open,e.open&&(this._focusPanelFlowItem=!0)}_toggleVisibility(e,i){if(!e)return;(i==null?void 0:i.visibilityMode)==="exclusive"&&e.visible||(e.visible=!e.visible)}};m([b()],Mt.prototype,"_activeItem",void 0),m([b()],Mt.prototype,"_tooltipReferenceMap",void 0),m([b()],Mt.prototype,"_focusRootFlowItem",void 0),m([b()],Mt.prototype,"_focusPanelFlowItem",void 0),m([b()],Mt.prototype,"_focusTableListFlowItem",void 0),m([b()],Mt.prototype,"_focusCatalogFlowItem",void 0),m([b()],Mt.prototype,"_totalItems",null),m([b()],Mt.prototype,"_dragEnabled",null),m([b()],Mt.prototype,"_filterEnabled",null),m([b({readOnly:!0})],Mt.prototype,"catalogLayerList",void 0),m([b()],Mt.prototype,"catalogOptions",void 0),m([b()],Mt.prototype,"collapsed",void 0),m([b()],Mt.prototype,"dragEnabled",void 0),m([b()],Mt.prototype,"filterPlaceholder",void 0),m([b()],Mt.prototype,"filterText",void 0),m([b()],Mt.prototype,"headingLevel",void 0),m([b()],Mt.prototype,"icon",null),m([b()],Mt.prototype,"knowledgeGraphOptions",void 0),m([b()],Mt.prototype,"label",null),m([b()],Mt.prototype,"listItemCanGiveFunction",void 0),m([b()],Mt.prototype,"listItemCanReceiveFunction",void 0),m([b()],Mt.prototype,"listItemCreatedFunction",null),m([b(),vt("esri/widgets/LayerList/t9n/LayerList")],Mt.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Mt.prototype,"messagesCommon",void 0),m([b()],Mt.prototype,"minDragEnabledItems",void 0),m([b()],Mt.prototype,"minFilterItems",void 0),m([b()],Mt.prototype,"multipleSelectionEnabled",null),m([b()],Mt.prototype,"openCatalogItem",void 0),m([b()],Mt.prototype,"openTableListItem",void 0),m([b()],Mt.prototype,"operationalItems",null),m([b()],Mt.prototype,"selectionEnabled",null),m([b()],Mt.prototype,"selectedItems",void 0),m([b()],Mt.prototype,"selectionMode",void 0),m([b({readOnly:!0})],Mt.prototype,"tableList",void 0),m([b()],Mt.prototype,"view",null),m([v0("trigger-action"),b({type:UF})],Mt.prototype,"viewModel",void 0),m([b()],Mt.prototype,"visibilityAppearance",void 0),m([b({type:Ble,nonNullable:!0})],Mt.prototype,"visibleElements",void 0),Mt=m([G("esri.widgets.LayerList")],Mt);const pUe=Mt,hi="esri-slider",Pt={base:hi,reversed:`${hi}--reversed`,horizontalLayout:`${hi}--horizontal`,verticalLayout:`${hi}--vertical`,contentElement:`${hi}__content`,extraContentElement:`${hi}__extra-content`,trackElement:`${hi}__track`,ticksContainerElement:`${hi}__ticks`,tickElement:`${hi}__tick`,tickLabelElement:`${hi}__tick-label`,maxElement:`${hi}__max`,minElement:`${hi}__min`,maxElementInteractive:`${hi}__max--interactive`,minElementInteractive:`${hi}__min--interactive`,rangeElementActive:`${hi}__range--active`,rangeInput:`${hi}__range-input`,anchorElement:`${hi}__anchor`,movingAnchorElement:`${hi}__anchor--moving`,lastMovedAnchorElement:`${hi}__anchor--moved`,anchorElementActive:`${hi}__anchor--active`,anchorElementIndexPrefix:`${hi}__anchor-`,segmentElement:`${hi}__segment`,segmentElementIndexPrefix:`${hi}__segment-`,segmentElementInteractive:`${hi}__segment--interactive`,segmentElementActive:`${hi}__segment--active`,effectiveSegmentElement:`${hi}__effective-segment`,effectiveMaxSegmentElement:`${hi}__effective-max-segment`,effectiveMinSegmentElement:`${hi}__effective-min-segment`,thumbElement:`${hi}__thumb`,labelElement:`${hi}__label`,labelElementInteractive:`${hi}__label--interactive`,labelInput:`${hi}__label-input`};let ho=class extends Te{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:i,values:r}=this,n=r!=null&&r.length?r.map((o,u)=>this.getLabelForValue(o,"value",u)):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(i,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:i}=this;return e!=null&&i!=null&&e>i?"ready":"disabled"}set values(e){const{max:i,min:r}=this,n=this.values;n&&e&&n.length===e.length&&n.every((o,u)=>o===e[u])||(this._set("values",null),e!=null&&e.length&&(r!=null&&e.some(o=>o<r)&&(this.min=Math.min(...e)),i!=null&&e.some(o=>o>i)&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:i,min:r,precision:n}=this,o=i!=null&&r!=null&&i-r>10?2:n;return parseFloat(e.toFixed(o)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:i,max:r,min:n}=this;return{min:i!=null&&n!=null?Math.max(n,i):n,max:e!=null&&r!=null?Math.min(r,e):r}}getBoundsForValueAtIndex(e){const{thumbsConstrained:i,values:r}=this,{min:n,max:o}=this.getBounds();if(i&&r){const u=e-1,p=e+1;return{min:r[u]!=null?r[u]:n,max:r[p]!=null?r[p]:o}}return{min:n,max:o}}getLabelForValue(e,i,r){return e==null?null:this.labelFormatFunction?this.labelFormatFunction(e,i,r):this.defaultLabelFormatFunction(e)}setMax(e){const{max:i,values:r}=this;if(e==null)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(i!==n&&(this._set("max",n),r==null?void 0:r.length))for(let o=0;o<r.length;o++)n<r[o]&&this.setValue(o,n)}setMin(e){const{min:i,values:r}=this;if(e==null)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(i!==n&&(this._set("min",n),r==null?void 0:r.length))for(let o=0;o<r.length;o++)n>r[o]&&this.setValue(o,n)}setEffectiveMax(e){if(e==null)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const i=this.toPrecision(e);this.effectiveMax!==i&&this._set("effectiveMax",this._applyBoundsToValue(i))}setEffectiveMin(e){if(e==null)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const i=this.toPrecision(e);this.effectiveMin!==i&&this._set("effectiveMin",this._applyBoundsToValue(i))}setValue(e,i){if(isNaN(i))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:r}=this;if(r==null)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=r[e],o=this.toPrecision(i);if(n===o)return;const u=[...r];u[e]=o,this._set("values",u),this.notifyChange("labels")}_applyBoundsToValue(e){const{max:i,min:r}=this;return r!=null&&e<r?r:i!=null&&e>i?i:e}_logError(e,i,r){fe.getLogger(this).error(new re(e,i,r))}};m([b()],ho.prototype,"effectiveMax",null),m([b()],ho.prototype,"effectiveMin",null),m([b()],ho.prototype,"labelFormatFunction",null),m([b()],ho.prototype,"inputFormatFunction",null),m([b()],ho.prototype,"inputParseFunction",null),m([b({readOnly:!0})],ho.prototype,"labels",null),m([b()],ho.prototype,"max",null),m([b()],ho.prototype,"min",null),m([b()],ho.prototype,"precision",void 0),m([b({readOnly:!0})],ho.prototype,"state",null),m([b()],ho.prototype,"thumbsConstrained",void 0),m([b()],ho.prototype,"values",null),ho=m([G("esri.widgets.Slider.SliderViewModel")],ho);const dUe=ho,ko={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},oH={labels:!1,rangeLabels:!1};let kt=class extends vi{constructor(e,i){super(e,i),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=[],this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new Ie,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new Ie,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new Ie,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new Ie,this.tickElements=new Ie,this.trackElement=null,this.viewModel=new dUe,this.visibleElements={...oH},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get icon(){return"caret-double-horizontal"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:i,_isMinInputActive:r,_dragStartInfo:n,_segmentDragStartInfo:o,disabled:u,viewModel:p}=this;return u?"disabled":e===null&&!i&&!r?n!=null||o!=null?"dragging":p.state:"editing"}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...oH,...e}}render(){const{label:e}=this,i=this.classes(Pt.base,Ee.widget,this._isHorizontalLayout()?Pt.horizontalLayout:Pt.verticalLayout,this._isReversedLayout()?Pt.reversed:null,this._isDisabled()?Ee.disabled:null);return this._storeTrackDimensions(),N("div",{afterCreate:this._afterContainerCreate,"aria-label":e,bind:this,class:i,"touch-action":"none"},this._renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}getCurrentPosition(){var e;return this._positionFromValue(((e=this.values)==null?void 0:e[0])??0)}_renderContent(){const{max:e,min:i}=this;if(!(i==null||e==null||i>=e))return[this._renderMin(),this._renderSliderContainer(),this._renderMax()]}_renderSliderContainer(){return N("div",{bind:this,class:Pt.contentElement,key:"slider-container"},this._renderTrackElement(),this._renderTicksContainer(),this._renderExtraContentElements())}_renderTrackElement(){return N("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:Pt.trackElement,"touch-action":"none"},this._renderEffectiveSegmentElements(),this._renderSegmentElements(),this._renderAnchorElements())}_renderEffectiveSegmentElements(){var g;if(!this.trackElement||!((g=this.values)!=null&&g.length))return;const e=this.effectiveMax!=null,i=this.effectiveMin!=null;if(!e&&!i)return;const{max:r,min:n,viewModel:o}=this,u=o.getBounds(),p=[];return i&&p.push(this._renderEffectiveSegmentElement(n,u.min,!0)),e&&p.push(this._renderEffectiveSegmentElement(u.max,r,!1)),p}_renderSegmentElements(){var r;if(!this.trackElement||!((r=this.values)!=null&&r.length))return;const e=this.values.length,i=[];for(let n=0;n<=e;n++)i.push(this._renderSegmentElement(n));return i}_renderSegmentElement(e){const{_trackHeight:i,_trackWidth:r,draggableSegmentsEnabled:n,id:o,state:u}=this,p=this.values,g=this._isHorizontalLayout(),w=g?r:i,S=this.viewModel.getBounds(),T=this._positionFromValue(S.max),E=this._positionFromValue(S.min),C=e===(p==null?void 0:p.length)?null:e,L=e===0?null:e-1,R=C!=null,F=L!=null;let V,U;const W=[...p].sort((oe,pe)=>oe-pe);this._isReversedLayout()?(V=F?this._positionFromValue(W[L]):E,U=R?this._positionFromValue(W[C]):T):(V=R?this._positionFromValue(W[C]):T,U=F?this._positionFromValue(W[L]):E);const H=this._applyPrecisionToPosition(100*U/w),J=(V-U)/w,X=g?`transform: translate(${H}%, 0px) scale(${J}, 1);`:`transform: translate(0px, ${H}%) scale(1, ${J});`,te=this.classes(Pt.segmentElement,Pt.segmentElementIndexPrefix+e,n&&R&&F&&u!=="disabled"?Pt.segmentElementInteractive:null);return N("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:te,"data-max-thumb-index":C,"data-min-thumb-index":L,"data-segment-index":e,key:`${o}-segment-${e}`,style:X,"touch-action":"none"})}_renderEffectiveSegmentElement(e,i,r){const{_trackHeight:n,_trackWidth:o,layout:u}=this,p=this._positionFromValue(e),g=this._positionFromValue(i),w=this._isHorizontalLayout(),S=w?o:n,T=this._applyPrecisionToPosition(100*p/S);let E=null;if(u==="horizontal"){const R=r?S-g:g,F=p===S?0:T;E=`clip-path: inset(0% ${g===S?0:this._applyPrecisionToPosition(R/S*100)}% 0% ${F}%);`}else{const R=(g-p)/S;E=w?`transform: translate(${T}%, 0px) scale(${R}, 1);`:`transform: translate(0px, ${T}%) scale(1, ${R});`}const C=r?Pt.effectiveMinSegmentElement:Pt.effectiveMaxSegmentElement,L=this.classes(Pt.segmentElement,Pt.effectiveSegmentElement,C);return N("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:L,style:E,"touch-action":"none"})}_renderAnchorElements(){const{trackElement:e,values:i}=this;if(i!=null&&i.length)return this._zIndices=i.map((r,n)=>{const o=this._positionFromValue(r),u=this._positionToPercent(o),p=(this._isHorizontalLayout()?u>50:u<50)?-1:1;return this._zIndexOffset+(i.length+p*n)}),e&&i&&i.length?i.map((r,n)=>this._renderAnchorElement(r,n)):null}_renderAnchorElement(e,i){const r=this._positionFromValue(e),n=this._valueFromPosition(r);if(n==null||isNaN(n))return;const{_dragStartInfo:o,_lastMovedHandleIndex:u,id:p,layout:g,visibleElements:{labels:w}}=this,S=this.values,T=o&&o.index===i,E=u===i,C=this.classes(Pt.anchorElement,Pt.anchorElementIndexPrefix+i,T?Pt.movingAnchorElement:null,E?Pt.lastMovedAnchorElement:null),L=this.labels.values[i],R=this._getStyleForAnchor(e,i,T||E),{min:F,max:V}=this.viewModel.getBoundsForValueAtIndex(i),{disabled:U,messages:W}=this,H=S.length===2?qn(i===0?W.rangeMinimum:W.rangeMaximum,{value:e}):L,J=S.length===1?null:i===0?`${p}-handle-${i+1}`:i===S.length-1?`${p}-handle-${i-1}`:`${p}-handle-${i-1} ${p}-handle-${i+1}`;return N("div",{afterCreate:this._afterAnchorCreate,afterRemoved:this._afterAnchorRemoved,afterUpdate:this._afterAnchorUpdate,"aria-controls":J,"aria-label":W.sliderValue,"aria-labelledby":w?`${p}-label-${i}`:null,"aria-orientation":g,"aria-valuemax":V==null?void 0:V.toString(),"aria-valuemin":F==null?void 0:F.toString(),"aria-valuenow":e.toString(),"aria-valuetext":H,bind:this,class:C,"data-thumb-index":i,"data-value":e,id:`${p}-handle-${i}`,key:`${p}-handle-${i}`,onkeydown:this._onAnchorKeyDown,role:"slider",style:R,tabIndex:U?-1:0,"touch-action":"none"},N("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:Pt.thumbElement,"data-thumb-index":i,"touch-action":"none"}),this.renderThumbLabel(i))}renderThumbLabel(e){const{id:i,labels:r,labelInputsEnabled:n,state:o}=this,u=this.visibleElements.labels,p=r.values[e],g=this.classes(Pt.labelElement,u?null:Ee.hidden,n&&o!=="disabled"?Pt.labelElementInteractive:null);return N("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!u).toString(),bind:this,class:g,"data-thumb-index":e,id:`${i}-label-${e}`,key:`${i}-label-${e}`,role:n?"button":null,"touch-action":"none"},this._activeLabelInputIndex===e?this._renderValueInput(e):p)}_renderValueInput(e){const{disabled:i,values:r}=this;if(r==null)return;const n=r[e];return N("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:Pt.labelInput,"data-input-index":e,"data-input-type":"thumb",key:`value-input-${e}`,onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:i?-1:0,type:"text",value:this._formatInputValue(n,"value",e)})}_renderMax(){const{_isMaxInputActive:e,labels:i,rangeLabelInputsEnabled:r,state:n}=this,o=this.visibleElements.rangeLabels,u=this.classes(Pt.maxElement,{[Ee.hidden]:!o,[Pt.maxElementInteractive]:r&&n!=="disabled",[Pt.rangeElementActive]:e});return N("div",{afterCreate:this._afterMaxLabelCreate,"aria-hidden":(!o).toString(),bind:this,class:u,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this._renderMaxInput():i.max)}_renderMin(){const{_isMinInputActive:e,labels:i,rangeLabelInputsEnabled:r,state:n}=this,o=this.visibleElements.rangeLabels,u=this.classes(Pt.minElement,{[Ee.hidden]:!o,[Pt.minElementInteractive]:r&&n!=="disabled",[Pt.rangeElementActive]:e});return N("div",{afterCreate:this._afterMinLabelCreate,"aria-hidden":(!o).toString(),bind:this,class:u,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this._renderMinInput():i.min)}_renderMaxInput(){return N("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:Pt.rangeInput,"data-input-type":"max",onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max")})}_renderMinInput(){return N("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:Pt.rangeInput,"data-input-type":"min",onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min")})}_renderExtraContentElements(){return N("div",{bind:this,class:Pt.extraContentElement},this.extraNodes)}_renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(this._trackHeight!==0||this._trackWidth!==0))return this.tickConfigs.map((e,i)=>N("div",{class:this.classes(Pt.ticksContainerElement),key:"ticks-container"},this._renderTicks(e,i)))}_renderTicks(e,i){const{mode:r,values:n}=e;if(this.tickElements.at(i)||this.tickElements.add(new Ie,i),r==="position"){const p=Array.isArray(n)?n:[n];return this._calculateTickPositions(p).map((g,w)=>this._renderTickGroup(e,w,i,g))}if(r==="percent"&&Array.isArray(n)){const p=this.min??0,g=(this.max??0)-p,w=n.map(S=>this._applyPrecisionToPosition(S/100*g+p));return this._calculateTickPositions(w).map((S,T)=>this._renderTickGroup(e,T,i,S))}const o=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,u=this._getTickCounts(o,e);return this._calculateEquidistantTickPositions(u).map((p,g)=>this._renderTickGroup(e,g,i,p))}_renderTickGroup(e,i,r,n){const o=e.mode==="position"?Array.isArray(e.values)?e.values[i]:e.values:this._valueFromPosition(n);if(o!=null&&!isNaN(o))return N("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":o,key:`tick-group-${i}`,onclick:this._onTickGroupClick},this._renderTickLine(e,i,r,o),e.labelsVisible?this._renderTickLabel(e,i,r,o):null)}_renderTickLine(e,i,r,n){return N("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:Pt.tickElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":n,key:`tick-label-${i}`,style:this._getPositionStyleForElement(n)})}_renderTickLabel(e,i,r,n){const o=e.labelFormatFunction?e.labelFormatFunction(n,"tick",i):this.viewModel.getLabelForValue(n,"tick",i);return N("div",{afterCreate:this._afterTickLabelCreate,"aria-label":o,"aria-valuenow":n.toString(),"aria-valuetext":o,bind:this,class:Pt.tickLabelElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":i,"data-value":n,key:`tick-label-${i}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},o)}_afterContainerCreate(e){this.addHandles(yR(e,()=>this.scheduleRender()))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const i=zw(e),r=p4(e),n=this.thumbElements.at(i),o=this.labelElements.at(i)||null;this.thumbCreatedFunction(i,r,n,o)}}_afterAnchorUpdate(e){this._focusedAnchorIndex!=null&&zw(e)===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const i=this._anchorElements.indexOf(e,0);i>-1&&this._anchorElements.splice(i,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const i=e.getAttribute("data-input-type"),r=i==="thumb"?fUe(e):null;this.inputCreatedFunction(e,i,r)}}_afterTickLineCreate(e){const i=Uw(e),r=C$(e),n=this.tickElements.at(i),o=n.at(r);o?o.tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},r)}_afterTickLabelCreate(e){const i=Uw(e),r=C$(e),n=this.tickElements.at(i),o=n.at(r);o?o.labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},r)}_afterTickGroupRemoved(e){const i=Uw(e),r=this.tickElements.items[i],n=r==null?void 0:r.find(o=>o.groupElement===e);n&&r.remove(n)}_afterTickGroupCreate(e){var r,n;const i=aH(e);if(i!=null&&i.tickCreatedFunction){const o=Uw(e),u=C$(e),p=p4(e),g=(n=(r=this.tickElements)==null?void 0:r.at(o))==null?void 0:n.at(u);if(g){g.groupElement=e;const w=g.tickElement||null,S=g.labelElement||null;i.tickCreatedFunction(p,w,S)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled()||this.state==="editing")return;const{key:i,target:r}=e,n=this.values,o=zw(r),u=this._anchorElements[o],p=n[o],g=[ko.moveAnchorUp,ko.moveAnchorDown,ko.moveAnchorLeft,ko.moveAnchorRight];if(i===ko.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=o,this.notifyChange("state");else if(g.includes(i)){e.preventDefault();const{steps:w}=this,S=i===ko.moveAnchorUp||i===ko.moveAnchorRight?1:-1;if(w!=null)this._toStep(o,this._isReversedLayout()?-1*S:S);else{const{precision:E}=this,C=this._getPositionOfElement(u),L=this._valueFromPosition(C),R=this._isHorizontalLayout()?S:-1*S;let F;F=E===0?this._positionFromValue(L+R):E===1?this._positionFromValue(L+.1*R):C+R,this._toPosition(o,F)}const T=this.values[o];p!==T&&this._emitThumbChangeEvent({index:o,oldValue:p,value:T})}else if(i===ko.moveAnchorToMax||i===ko.moveAnchorToMin){e.preventDefault();const{min:w,max:S}=this._getAnchorBoundsInPixels(o),T=this._isPositionInverted()?i===ko.moveAnchorToMax?w:S:i===ko.moveAnchorToMin?w:S;this._toPosition(o,T);const E=this.values[o];p!==E&&this._emitThumbChangeEvent({index:o,oldValue:p,value:E})}}_onAnchorPointerDown(e){if(this._isDisabled())return;const{target:i,clientX:r,clientY:n}=e,o=zw(i);o!=null&&(e.preventDefault(),this._anchorElements[o]&&this._anchorElements[o].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:r,clientY:n,index:o,position:this._getPositionOfElement(this._anchorElements[o])},this.notifyChange("state"),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if(this.state==="editing"||!this._dragStartInfo)return;e.preventDefault();const{values:i,_anchorElements:r,_dragged:n,_dragStartInfo:o,_dragStartInfo:{index:u,position:p}}=this,{clientX:g,clientY:w}=e,S=n?"drag":"start",T=r[u],E=this._getPositionOfElement(T),C=this._applyPrecisionToPosition(this._isHorizontalLayout()?p+g-o.clientX:p+w-o.clientY);if(E===C)return;const L=i[u];this._dragged=!0,this._toPosition(u,C);const R=this.values[u];n?L!==R&&this._emitThumbDragEvent({index:u,state:S,value:R}):this._emitThumbDragEvent({index:u,state:S,value:L})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:i}=this._dragStartInfo,r=this._dragged,n=this.values[i];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=i,this.notifyChange("state"),r?this._emitThumbDragEvent({index:i,state:"stop",value:n}):(this.scheduleRender(),this.state!=="editing"&&this._emitThumbClickEvent({index:i,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:i,snapOnClickEnabled:r,state:n,values:o}=this;if(this._isDisabled()||n==="editing"||i||(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!r||!(o!=null&&o.length)))return;const{steps:u}=this,{clientX:p,clientY:g}=e,w=this._getCursorPositionFromEvent(e),S=this._valueFromPosition(w),T=this._getIndexOfNearestValue(S),E=o[T],C=o.some((V,U)=>V===E&&U!==T)&&S>E?o.lastIndexOf(E):T;if(C==null)return;const L=o[C],R=u!=null?this._calculateNearestStepPosition(w):w;this._toPosition(C,R),this._dragged=!0,this._dragStartInfo={clientX:p,clientY:g,index:C,position:R},this._focusedAnchorIndex=C,this.notifyChange("state"),this._emitThumbDragEvent({index:C,state:"start",value:L});const F=this.values[C];L!==F&&this._emitThumbDragEvent({index:C,state:"drag",value:F}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const i=this._getCursorPositionFromEvent(e),r=this._valueFromPosition(i);this._emitTrackClickEvent({value:r})}}_onSegmentPointerDown(e){var g,w;e.preventDefault();const i=e.target,r=yUe(i),n=mUe(i),o=gUe(i);if(this._isDisabled()||n==null||o==null)return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const u=this._getAnchorDetails(n),p=this._getAnchorDetails(o);this.syncedSegmentsEnabled?(this.segmentElements.forEach(S=>S.classList.add(Pt.segmentElementActive)),this._anchorElements.forEach(S=>S.classList.add(Pt.anchorElementActive))):(this.segmentElements.at(r).classList.add(Pt.segmentElementActive),(g=this._anchorElements[u.index])==null||g.classList.add(Pt.anchorElementActive),(w=this._anchorElements[p.index])==null||w.classList.add(Pt.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:r,details:this._normalizeSegmentDetails({min:u,max:p})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this.notifyChange("state"),this._emitSegmentDragEvent({index:r,state:"start",thumbIndices:[n,o]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:i,_trackWidth:r,_segmentDragStartInfo:{index:n,cursorPosition:o,details:{min:u,max:p}}}=this,{index:g,position:w,value:S}=u,{index:T,position:E,value:C}=p;this._dragged=!0;const L=this._getCursorPositionFromEvent(e);if(L===o)return;const R=this._positionToPercent(o),F=this._positionToPercent(L)-R,V=this._positionToPercent(w)+F,U=this._positionToPercent(E)+F,{min:W}=this._getAnchorBoundsAsPercents(g),{max:H}=this._getAnchorBoundsAsPercents(T);let J=!1,X=!1;if(V<W?J=!0:U>H&&(X=!0),J){const{min:$e,max:Fe}=this.viewModel.getBoundsForValueAtIndex(g),yt=this._isPositionInverted()?Fe:$e,qe=yt,Ue=C+(yt-S),ei=Ue-this.values[T];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(ei):this._updateAnchorValues([g,T],[qe,Ue]))}if(X){const{min:$e,max:Fe}=this.viewModel.getBoundsForValueAtIndex(T),yt=this._isPositionInverted()?$e:Fe,qe=yt,Ue=S+(yt-C),ei=Ue-this.values[g];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(ei):this._updateAnchorValues([g,T],[Ue,qe]))}const te=this._isHorizontalLayout()?r:i,oe=U/100*te,pe=V/100*te,de=this.values,ge=[de[g],de[T]],we=this._getValueForAnchorAtPosition(g,pe),ke=this._getValueForAnchorAtPosition(T,oe);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(we-ge[0]):this._updateAnchorValues([g,T],[we,ke]),[this.values[g],this.values[T]].every(($e,Fe)=>$e===ge[Fe])||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[g,T]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:i}=this,r=this.min,n=this.max,o=this.values,{index:u,details:{min:{index:p},max:{index:g}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach(w=>w.classList.remove(Pt.segmentElementActive)),this._anchorElements.forEach(w=>w.classList.remove(Pt.anchorElementActive)),this.draggableSegmentsEnabled){const w=n-r,S=o[p],T=o[g];this._lastMovedHandleIndex=S===T?S>w/2?p:g:null,this._dragged=!1,this._segmentDragStartInfo=null,this.notifyChange("state"),this._emitSegmentDragEvent({index:u,state:"stop",thumbIndices:[p,g]})}if(!i){const w=this._getCursorPositionFromEvent(e),S=this._valueFromPosition(w);this._emitSegmentClickEvent({index:u,value:S,thumbIndices:[p,g]})}}_onTickGroupClick(e){const i=e.target;if(aH(i)){const r=Uw(i),n=C$(i),o=p4(i);this._emitTickClickEvent({configIndex:r,groupIndex:n,value:o})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=this._applyPrecisionToPosition(e.height),this._trackWidth=this._applyPrecisionToPosition(e.width)}}_onLabelPointerDown(){this._isDisabled()||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled()||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled())return;const i=zw(e.target);this.labelInputsEnabled&&!this._dragged&&i!=null&&(this._activeLabelInputIndex=i),this._dragged=!1,this.notifyChange("state"),document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:i,values:r,viewModel:n}=this,o=e.target.value;if(this._activeLabelInputIndex=null,this.notifyChange("state"),!o||i==null||r==null)return;const u=this._parseInputValue(o,"value",i),p=r[i],{min:g,max:w}=this.viewModel.getBoundsForValueAtIndex(i);if(u<g||u>w)return;n.setValue(i,u);const S=this.values[i];p!==S&&this._emitThumbChangeEvent({index:i,oldValue:p,value:S})}_onInputKeyDown(e){var S;if(this._isDisabled())return;const{key:i,target:r}=e,{hideInput1:n,hideInput2:o,hideInput3:u}=ko,{_activeLabelInputIndex:p,_anchorElements:g}=this,w=r;if(i===n||i===o||i===u){e.stopPropagation();const T=p;w.blur(),T!=null?g[T].focus():(S=w.parentElement)==null||S.focus()}}_onMaxLabelClick(){this._isDisabled()||(this._emitMaxRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0,this.notifyChange("state")))}_onMaxLabelKeyDown({key:e}){this._isDisabled()||e!==ko.showInput||(this._isMaxInputActive=!0,this.notifyChange("state"))}_onMaxInputBlur(e){const i=e.target.value;if(this._isMaxInputActive=!1,this.notifyChange("state"),!i)return;const r=this.max,n=this._parseInputValue(i,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==r&&this._emitMaxChangeEvent({oldValue:r,value:this.max}))}_onMinLabelClick(){this._isDisabled()||(this._emitMinRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0,this.notifyChange("state")))}_onMinLabelKeyDown({key:e}){this._isDisabled()||e!==ko.showInput||(this._isMinInputActive=!0,this.notifyChange("state"))}_onMinInputBlur(e){const i=e.target.value;if(this._isMinInputActive=!1,this.notifyChange("state"),!i)return;const r=this.min,n=this._parseInputValue(i,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==r&&this._emitMinChangeEvent({oldValue:r,value:this.min}))}_isDisabled(){return this.disabled||this.state==="disabled"}_positionFromValue(e){const{_trackHeight:i,_trackWidth:r}=this,n=this.min??0,o=this.max??0,u=o-n;if(u===0||e==null)return 0;const p=this._isHorizontalLayout();let g=p?this._applyPrecisionToPosition(r*(e-n)/u):this._applyPrecisionToPosition(i*(o-e)/u);return this._isReversedLayout()&&(g=p?r-g:i-g),g}_valueFromPosition(e){const{_trackHeight:i,_trackWidth:r,precision:n}=this,o=this.min??0,u=this.max??0,p=u-o;let g=this._isHorizontalLayout()?e*p/r+o:p*(1e3-e/i*1e3)/1e3+o;return this._isReversedLayout()&&(g=u+o-g),parseFloat(g.toFixed(n))}_positionToPercent(e){const{_trackHeight:i,_trackWidth:r}=this,n=100*e/(this._isHorizontalLayout()?r:i);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return e==="horizontal-reversed"||e==="vertical"}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:i,max:r}=e;return{min:r,max:i}}return e}_parseInputValue(e,i,r){return this.inputParseFunction?this.inputParseFunction(e,i,r):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,i,r){return this.inputFormatFunction?this.inputFormatFunction(e,i,r):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const i=this.values,r=[...i].sort((o,u)=>o-u)[e],n=i.indexOf(r);return{index:n,position:this._getPositionOfElement(this._anchorElements[n]),value:r}}_updateAnchorStyle(e,i){const r=this._anchorElements[e];r&&(this._isHorizontalLayout()?r.style.left=`${i}`:r.style.top=`${i}`)}_getStyleForAnchor(e,i,r){var u;const n=this._getPositionStyleForElement(e);if(((u=this.values)==null?void 0:u.length)===1)return`${n}`;const o=this._zIndices[i];return`${n}; z-index: ${r?this._zIndexOffset+o:o}`}_getPositionStyleForElement(e){const i=this._positionFromValue(e),r=this._positionToPercent(i);return`${this._isHorizontalLayout()?"left":"top"}: ${r}%`}_getPositionOfElement(e){const i=this._getDimensions(e.offsetParent),r=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(r.left-i.left):this._applyPrecisionToPosition(r.top-i.top)}_updateAnchorValues(e,i){e.forEach((r,n)=>this._toValue(r,i[n]))}_updateAnchorValuesByDifference(e){const{min:i,max:r,values:n}=this;n==null||n.forEach((o,u)=>this._toValue(u,Math.max(Math.min(o+e,r),i)))}_toValue(e,i){this.steps!=null&&(i=this._getStepValues()[this._getIndexOfNearestStepValue(i)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(i)),this.viewModel.setValue(e,i)}_toPosition(e,i){const r=this.steps!=null?this._getStepValueForAnchorAtPosition(e,i):this._getValueForAnchorAtPosition(e,i);this._updateAnchorStyle(e,this._getPositionStyleForElement(r)),this.viewModel.setValue(e,r)}_getValueForAnchorAtPosition(e,i){const{min:r,max:n}=this._getAnchorBoundsInPixels(e),{min:o,max:u}=this.viewModel.getBoundsForValueAtIndex(e);let p,g,w=null;return this._isPositionInverted()?(p=o,g=u):(p=u,g=o),w=i>n?p:i<r?g:this._valueFromPosition(i),w>u?w=u:w<o&&(w=o),w}_getStepValueForAnchorAtPosition(e,i){const r=this._getStepValues(),n=this._calculateNearestStepPosition(i),o=this._getValueForAnchorAtPosition(e,n);return r[this._getIndexOfNearestStepValue(o)]}_getAnchorBoundsAsPercents(e){const{min:i,max:r}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(i),max:this._positionToPercent(r)}}_getAnchorBoundsInPixels(e){const{_anchorElements:i,_trackHeight:r,_trackWidth:n,effectiveMax:o,effectiveMin:u,thumbsConstrained:p}=this,g=i[e-1],w=i[e+1],S=this._isHorizontalLayout()?n:r;let T,E;return this._isPositionInverted()?(T=u!=null?this._positionFromValue(u):S,E=o!=null?this._positionFromValue(o):0):(T=o!=null?this._positionFromValue(o):S,E=u!=null?this._positionFromValue(u):0),p?this._isPositionInverted()?{max:g?this._getPositionOfElement(g):T,min:w?this._getPositionOfElement(w):E}:{max:w?this._getPositionOfElement(w):T,min:g?this._getPositionOfElement(g):E}:{max:T,min:E}}_getIndexOfNearestValue(e){const i=this.values;return i.indexOf(i.reduce((r,n)=>Math.abs(n-e)<Math.abs(r-e)?n:r))}_getCursorPositionFromEvent(e){const i=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?this._applyPrecisionToPosition(e.clientX-i.left):this._applyPrecisionToPosition(e.clientY-i.top)}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:i,min:r}=this;if(r==null||i==null||e==null)return[];const n=Math.ceil((i-r)/e),o=[];for(let u=0;u<=n;u++){const p=r+e*u;o.push(p>i?i:p)}return o}_toStep(e,i){const r=this.values[e],n=this._getStepValues(),o=n.indexOf(r);let u=null;if(o>-1){let p=n[o+i];isNaN(p)&&(p=n[o]);const g=this._positionFromValue(p);u=this._getStepValueForAnchorAtPosition(e,g)}else u=n[this._getIndexOfNearestStepValue(r)+i];this.viewModel.setValue(e,u)}_getIndexOfNearestStepValue(e){const{steps:i}=this;if(i==null)return null;const r=this._getStepValues(),n=r.reduce((o,u)=>Math.abs(u-e)<Math.abs(o-e)?u:o);return r.indexOf(n)}_calculateNearestStepPosition(e){const i=this._valueFromPosition(e),r=this._getIndexOfNearestStepValue(i),n=this._getStepValues();return this._positionFromValue(n[r])}_getTickCounts(e,i){const{mode:r}=i;return r==="count"||r==="position"?e||0:r==="percent"&&100/e||0}_calculateTickPositions(e){return e.map(i=>this._positionFromValue(i))}_calculateEquidistantTickPositions(e){const{_trackWidth:i,_trackHeight:r}=this,n=this._isHorizontalLayout()?i:r,o=n/(e-1),u=[];if(e===1)return[n/2];for(let p=0;p<e;p++){const g=p*o;g<=n&&u.push(g)}return u}_getDimensions(e){try{return a0(e),e.getBoundingClientRect()}catch(i){if(typeof i=="object"&&i!==null)return new DOMRect(0,0,0,0);throw i}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitMinRangeLabelClickEvent(e){this.emit("min-click",e)}_emitMaxRangeLabelClickEvent(e){this.emit("min-click",e)}};function zw(t){return t==null?void 0:t["data-thumb-index"]}function fUe(t){return t==null?void 0:t["data-input-index"]}function yUe(t){return t==null?void 0:t["data-segment-index"]}function mUe(t){return t==null?void 0:t["data-min-thumb-index"]}function gUe(t){return t==null?void 0:t["data-max-thumb-index"]}function p4(t){return t==null?void 0:t["data-value"]}function Uw(t){return t==null?void 0:t["data-tick-config-index"]}function C$(t){return t==null?void 0:t["data-tick-group-index"]}function aH(t){return t==null?void 0:t["data-config"]}m([b()],kt.prototype,"disabled",void 0),m([b()],kt.prototype,"draggableSegmentsEnabled",void 0),m([b()],kt.prototype,"effectiveMax",null),m([b()],kt.prototype,"effectiveMin",null),m([b({readOnly:!0})],kt.prototype,"effectiveSegmentElements",void 0),m([b()],kt.prototype,"extraNodes",void 0),m([b()],kt.prototype,"inputCreatedFunction",void 0),m([b()],kt.prototype,"inputFormatFunction",null),m([b()],kt.prototype,"inputParseFunction",null),m([b()],kt.prototype,"icon",null),m([b()],kt.prototype,"label",null),m([b({readOnly:!0})],kt.prototype,"labelElements",void 0),m([b()],kt.prototype,"labelInputsEnabled",void 0),m([b()],kt.prototype,"labelFormatFunction",null),m([b({readOnly:!0})],kt.prototype,"labels",null),m([b({value:"horizontal"})],kt.prototype,"layout",null),m([b()],kt.prototype,"max",null),m([b({readOnly:!0})],kt.prototype,"maxLabelElement",void 0),m([b(),vt("esri/widgets/Slider/t9n/Slider")],kt.prototype,"messages",void 0),m([b()],kt.prototype,"min",null),m([b({readOnly:!0})],kt.prototype,"minLabelElement",void 0),m([b()],kt.prototype,"precision",null),m([b()],kt.prototype,"rangeLabelInputsEnabled",void 0),m([b({readOnly:!0})],kt.prototype,"segmentElements",void 0),m([b()],kt.prototype,"snapOnClickEnabled",void 0),m([b({readOnly:!0})],kt.prototype,"state",null),m([b()],kt.prototype,"steps",void 0),m([b()],kt.prototype,"syncedSegmentsEnabled",void 0),m([b()],kt.prototype,"thumbsConstrained",null),m([b()],kt.prototype,"thumbCreatedFunction",void 0),m([b({readOnly:!0})],kt.prototype,"thumbElements",void 0),m([b()],kt.prototype,"tickConfigs",null),m([b({readOnly:!0})],kt.prototype,"tickElements",void 0),m([b({readOnly:!0})],kt.prototype,"trackElement",void 0),m([b()],kt.prototype,"values",null),m([b()],kt.prototype,"viewModel",void 0),m([b()],kt.prototype,"visibleElements",void 0),m([Dt("visibleElements")],kt.prototype,"castVisibleElements",null),kt=m([G("esri.widgets.Slider")],kt);const vUe=kt,Oi="esri-time-slider",xt={timeSlider:`${Oi}`,timeSliderOutOfBounds:`${Oi}--out-of-bounds`,timeSliderMode:`${Oi}__mode--`,timeSliderLayout:`${Oi}__layout--`,timeSliderRow:`${Oi}__row`,animation:`${Oi}__animation`,animationButton:`${Oi}__animation-button`,timeExtent:`${Oi}__time-extent`,timeExtentGroup:`${Oi}__time-extent-group`,timeExtentDate:`${Oi}__time-extent-date`,timeExtentTime:`${Oi}__time-extent-time`,timeExtentSeparator:`${Oi}__time-extent-separator`,playbackControls:`${Oi}__playback-controls`,min:`${Oi}__min`,minDate:`${Oi}__min-date`,minTime:`${Oi}__min-time`,slider:`${Oi}__slider`,sliderMajorTick:"majorTick",sliderMinorTick:"minorTick",max:`${Oi}__max`,maxDate:`${Oi}__max-date`,maxTime:`${Oi}__max-time`,previous:`${Oi}__previous`,previousButton:`${Oi}__previous-button`,next:`${Oi}__next`,nextButton:`${Oi}__next-button`,warning:`${Oi}__warning`,warningText:`${Oi}__warning-text`,hasActions:`${Oi}--has-actions`,actions:`${Oi}__actions`,actionsButton:`${Oi}__actions-button`},lH=1e4;function b7(t){return t!=null&&t.count!==void 0}function gI(t){return t!=null&&t.interval!==void 0}function uH(t){return t!=null&&t.dates!==void 0}let vn=class extends Ar.EventedAccessor{constructor(e){super(e),this._animationController=null,this._isViewTimeExtentInitialized=!1,this._timerId=null,this.actions=new Ie,this.fullTimeExtent=null,this.loop=!1,this.mode="time-window",this.stops={count:10},this.timeExtent=null,this.view=null}initialize(){this.addHandles([ce(()=>this.effectiveStops,()=>{this.timeExtent==null&&(this.timeExtent=this._getDefaultTimeExtent())},Qe),ce(()=>this.view,(e,i)=>{this._unregisterWidget(i),this._registerWidget(e)},ri),ce(()=>this.timeExtent,e=>{if(this.view==null)return;const i=this.view.timeExtent;(e!=null&&!e.isAllTime||i!=null&&!i.isAllTime)&&(e!=null&&i!=null&&e.equals(i)||(this.view.timeExtent=e))},Qe),ce(()=>{var e;return(e=this.view)==null?void 0:e.timeExtent},e=>{this._isViewTimeExtentInitialized?(e!=null&&!e.isAllTime||this.timeExtent!=null&&!this.timeExtent.isAllTime)&&(e!=null&&this.timeExtent!=null&&e.equals(this.timeExtent)||(this.timeExtent=e)):this._isViewTimeExtentInitialized=!0})])}destroy(){this._timerId!=null&&(clearInterval(this._timerId),this._timerId=null),this._unregisterWidget(this.view),this.view=null,this._animationController!=null&&(this._animationController.abort(),this._animationController=null)}get effectiveStops(){const{fullTimeExtent:e,stops:i}=this;if(uH(i)){const{dates:r}=i;if(r==null||r.length===0)return null;const n=r.sort((p,g)=>p.getTime()-g.getTime());if(e==null)return n;const{start:o,end:u}=e;return o==null||u==null?n:n.filter(p=>!(p.getTime()<o.getTime()||p.getTime()>u.getTime()))}if(b7(i)){const r=i.timeExtent??e;return this._divideTimeExtentByCount(r,i.count)}if(gI(i)){const r=i.timeExtent??e;return this._divideTimeExtentByInterval(r,i.interval)}return[]}set playRate(e){e<=0||e>36e5||(this.state==="playing"&&this._startAnimation(),this._set("playRate",e))}get state(){return this.fullTimeExtent==null?"disabled":this._animationController!=null?"playing":"ready"}get timeExtentValues(){const{mode:e,timeExtent:i}=this;if(i==null||i.isAllTime||i.isEmpty)return null;const{start:r,end:n}=i;switch(e){case"cumulative-from-end":case"instant":return r!=null?[r.getTime()]:null;case"cumulative-from-start":return n!=null?[n.getTime()]:null;case"time-window":return r!=null&&n!=null?[r.getTime(),n.getTime()]:null}}static async getPropertiesFromWebMap(e,i){xI(fe.getLogger("esri.widgets.TimeSlider.TimeSliderViewModel"),"`TimeSliderViewModel.getPropertiesFromWebMap` is deprecated in favor of 'timeUtils.getTimeSliderSettingsFromWebDocument'",{replacement:"timeUtils.getTimeSliderSettingsFromWebDocument",version:"4.29",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-support-timeUtils.html#getTimeSliderSettingsFromWebDocument",warnOnce:!0});const{getTimeSliderSettingsFromWebDocument:r}=await ie(()=>import("./timeUtils-DYBWcYWP.js"),__vite__mapDeps([180,181]));return r(e,i)}next(){this._step({forward:!0,allowRestart:!1})}play(){this._startAnimation()}previous(){this._step({forward:!1,allowRestart:!1})}stop(){this._stopAnimation()}triggerAction(e){this.emit("trigger-action",{action:e})}updateWebDocument(e){const i=new Bte({currentTimeExtent:this.timeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:b7(this.stops)?this.stops.count:null,numThumbs:this.mode==="time-window"?2:1,stopDelay:this.playRate,stopInterval:gI(this.stops)?this.stops.interval:null,stops:uH(this.stops)?this.stops.dates:null});e.widgets?e.widgets.timeSlider=i:e.widgets=new qte({timeSlider:i})}valuesToTimeExtent(e){if(e==null)return null;const i=e.sort((o,u)=>o-u).map(o=>new Date(o)),r=i.length>0?i[0]:null,n=i.length>1?i[1]:null;switch(this.mode){case"time-window":return new Di({start:r,end:n});case"instant":return new Di({start:r,end:r});case"cumulative-from-start":return new Di({start:null,end:r});case"cumulative-from-end":return new Di({start:r,end:null});default:return Di.allTime}}async _animate(){var e;try{const i=this.view,r=(e=this._animationController)==null?void 0:e.signal;await Promise.all([Db(this.playRate,null,r),i!=null&&vr(()=>i.updating===!1,r)])}catch(i){return Cn(i)||fe.getLogger(this).error(i),void(this._animationController=null)}this._step({forward:!0,allowRestart:!1}),this._animationController!=null&&this._animate()}_divideTimeExtentByCount(e,i=10){if(!e||!i)return[];const{start:r,end:n}=e;if(r==null||n==null)return[];if(i>lH)return this._divideTimeExtentByCount(e);const o=[],u=r.getTime(),p=n.getTime()-u;for(let g=0;g<=i;g++)o.push(new Date(u+g/i*p));return o}_divideTimeExtentByInterval(e,i,r=lH){if(!e||!i)return[];const{start:n,end:o}=e;if(n==null||o==null)return[];const u=o.getTime()-n.getTime(),p=i.toMilliseconds();if(p<=0||u/p>r)return this._divideTimeExtentByCount(e);const g=[],{value:w,unit:S}=i;let T=n;for(;T.getTime()<=o.getTime();)g.push(new Date(T.getTime())),T=$2(T,w,S);return g}_getDefaultTimeExtent(){const{effectiveStops:e,mode:i}=this;if(e==null||!i)return null;switch(i){case"time-window":return e.length>1?new Di({start:e[0],end:e[1]}):null;case"cumulative-from-start":return e.length>0?new Di({start:null,end:e[0]}):null;case"cumulative-from-end":return e.length>0?new Di({start:e[0],end:null}):null;case"instant":return e.length>0?new Di({start:e[0],end:e[0]}):null;default:return null}}_registerWidget(e){e!=null&&(e.persistableViewModels.includes(this)||e.persistableViewModels.add(this))}_startAnimation(){this._stopAnimation(),this._animationController=new AbortController,this._step({forward:!0,allowRestart:!0}),this._animate()}_step(e){const{forward:i,allowRestart:r}=e,{effectiveStops:n}=this;if(this.timeExtentValues==null||n==null)return;const o=n.map(T=>T.getTime()),u=this.timeExtentValues.map(T=>{const E=o.indexOf(T);if(E!==-1)return E;const C=o.reduce((L,R)=>Math.abs(R-T)<Math.abs(L-T)?R:L);return o.indexOf(C)}),p=u.map(T=>T+(i?1:-1)),g=p.some(T=>T<0||T>o.length-1),{loop:w,state:S}=this;if(g)if(w||r){const T=Math.min(...u),E=Math.max(...u),C=(i?u.map(L=>L-T):u.map(L=>L+(o.length-1-E))).map(L=>o[L]);this.timeExtent=this.valuesToTimeExtent(C)}else S==="playing"&&this.stop();else{const T=p.map(E=>o[E]);this.timeExtent=this.valuesToTimeExtent(T)}}_stopAnimation(){this._animationController!=null&&(this._animationController.abort(),this._animationController=null)}_unregisterWidget(e){e!=null&&e.persistableViewModels.remove(this)}};m([b()],vn.prototype,"_animationController",void 0),m([b({type:Ie})],vn.prototype,"actions",void 0),m([b({readOnly:!0})],vn.prototype,"effectiveStops",null),m([b({type:Di})],vn.prototype,"fullTimeExtent",void 0),m([b({nonNullable:!0})],vn.prototype,"loop",void 0),m([b({nonNullable:!0})],vn.prototype,"mode",void 0),m([b({nonNullable:!0,value:1e3})],vn.prototype,"playRate",null),m([b({readOnly:!0})],vn.prototype,"state",null),m([b({cast:t=>t==null?null:(gI(t)&&(t.interval=Yi(Yp,t.interval)),(gI(t)||b7(t))&&(t.timeExtent=Yi(Di,t.timeExtent)),t)})],vn.prototype,"stops",void 0),m([b({type:Di})],vn.prototype,"timeExtent",void 0),m([b({readOnly:!0})],vn.prototype,"timeExtentValues",null),m([b()],vn.prototype,"view",void 0),m([b()],vn.prototype,"next",null),m([b()],vn.prototype,"play",null),m([b()],vn.prototype,"previous",null),m([b()],vn.prototype,"stop",null),m([b()],vn.prototype,"updateWebDocument",null),vn=m([G("esri.widgets.TimeSlider.TimeSliderViewModel")],vn);const w7=vn,bUe=3,wUe=858,_Ue=[{minor:{value:100,unit:"milliseconds"},major:{value:1,unit:"seconds"},format:{second:"numeric"}},{minor:{value:500,unit:"milliseconds"},major:{value:5,unit:"seconds"},format:{second:"numeric"}},{minor:{value:1,unit:"seconds"},major:{value:20,unit:"seconds"},format:{minute:"numeric",second:"numeric"}},{minor:{value:2,unit:"seconds"},major:{value:30,unit:"seconds"},format:{minute:"numeric",second:"numeric"}},{minor:{value:10,unit:"seconds"},major:{value:1,unit:"minutes"},format:{minute:"numeric"}},{minor:{value:15,unit:"seconds"},major:{value:5,unit:"minutes"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:1,unit:"minutes"},major:{value:20,unit:"minutes"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:5,unit:"minutes"},major:{value:2,unit:"hours"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:15,unit:"minutes"},major:{value:6,unit:"hours"},format:{hour:"numeric",minute:"numeric"}},{minor:{value:1,unit:"hours"},major:{value:1,unit:"days"},format:{day:"numeric",month:"short"}},{minor:{value:6,unit:"hours"},major:{value:1,unit:"weeks"},format:{day:"numeric",month:"short"}},{minor:{value:1,unit:"days"},major:{value:1,unit:"months"},format:{month:"long"}},{minor:{value:2,unit:"days"},major:{value:1,unit:"months"},format:{month:"short"}},{minor:{value:3,unit:"days"},major:{value:1,unit:"months"},format:{month:"short"}},{minor:{value:4,unit:"days"},major:{value:3,unit:"months"},format:{month:"short",year:"numeric"}},{minor:{value:1,unit:"weeks"},major:{value:1,unit:"years"},format:{year:"numeric"}},{minor:{value:1,unit:"months"},major:{value:1,unit:"years"},format:{year:"numeric"}},{minor:{value:2,unit:"months"},major:{value:2,unit:"years"},format:{year:"numeric"}},{minor:{value:1,unit:"years"},major:{value:1,unit:"decades"},format:{year:"numeric"}},{minor:{value:2,unit:"years"},major:{value:5,unit:"decades"},format:{year:"numeric"}},{minor:{value:5,unit:"decades"},major:{value:10,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:1,unit:"centuries"},major:{value:10,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:2,unit:"centuries"},major:{value:20,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:5,unit:"centuries"},major:{value:50,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:10,unit:"centuries"},major:{value:100,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:20,unit:"centuries"},major:{value:200,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:50,unit:"centuries"},major:{value:500,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:100,unit:"centuries"},major:{value:1e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:200,unit:"centuries"},major:{value:1e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:500,unit:"centuries"},major:{value:5e3,unit:"centuries"},format:{era:"short",year:"numeric"}},{minor:{value:1e3,unit:"centuries"},major:{value:1e4,unit:"centuries"},format:{era:"short",year:"numeric"}}];let Ei=class extends vi{constructor(e,i){super(e,i),this._ignoreNextSliderUpdate=!1,this._slider=new vUe({precision:0,visibleElements:{rangeLabels:!1},rangeLabelInputsEnabled:!1,thumbsConstrained:!1}),this._tickFormat=null,this.disabled=!1,this.labelFormatFunction=null,this.messages=null,this.messagesCommon=null,this.tickConfigs=null,this.timeVisible=!1,this.viewModel=new w7}initialize(){this.addHandles([ce(()=>this._slider.values,e=>{if(this._ignoreNextSliderUpdate)return void(this._ignoreNextSliderUpdate=!1);const i=this.viewModel.valuesToTimeExtent(e);this.timeExtent!=null?i!=null?this.timeExtent.equals(i)||(this.timeExtent=i):this.timeExtent=null:i!=null&&(this.timeExtent=i)}),ce(()=>this.effectiveStops,()=>this._updateSliderSteps(),Qe)])}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),"action-menu":()=>ie(()=>import("./calcite-action-menu-E8cc6COU.js"),__vite__mapDeps([349,241,242,220,226,224,233,221,225,227,223,228,229,230,243,244,245,246,247,248,249]))})}destroy(){this._slider.destroy(),this._tickFormat=null}get _dateFormat(){return this._getIntlOptions("short-date")}get _timeFormat(){return this._getIntlOptions("long-time")}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}get effectiveStops(){return this.viewModel.effectiveStops}get fullTimeExtent(){return this.viewModel.fullTimeExtent}set fullTimeExtent(e){this.viewModel.fullTimeExtent=e}get icon(){return"clock"}set icon(e){this._overrideIfSome("icon",e)}get interactive(){return!(this.disabled||this.viewModel.state==="disabled"||this.timeZone===Kp)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){["auto","compact","wide"].includes(e)||(e="auto"),this._set("layout",e)}get loop(){return this.viewModel.loop}set loop(e){this.viewModel.loop=e}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}get playRate(){return this.viewModel.playRate}set playRate(e){this.viewModel.playRate=e}get stops(){return this.viewModel.stops}set stops(e){this.viewModel.stops=e}get tickFormats(){const{timeZone:e}=this;return _Ue.map(({minor:i,major:r,format:n})=>({minor:new Yp(i),major:new Yp(r),format:{...n,timeZone:e}}))}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(e){this.viewModel.timeExtent=e}get timeZone(){var e;return((e=this.viewModel.view)==null?void 0:e.timeZone)??$o}set timeZone(e){this._overrideIfSome("timeZone",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}static async getPropertiesFromWebMap(e,i){return xI(fe.getLogger("esri.widgets.TimeSlider"),"`TimeSlider.getPropertiesFromWebMap` is deprecated in favor of 'timeUtils.getTimeSliderSettingsFromWebDocument'",{replacement:"timeUtils.getTimeSliderSettingsFromWebDocument",version:"4.29",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-support-timeUtils.html#getTimeSliderSettingsFromWebDocument",warnOnce:!0}),w7.getPropertiesFromWebMap(e,i)}next(){return this.viewModel.next()}play(){return this.viewModel.play()}previous(){return this.viewModel.previous()}stop(){return this.viewModel.stop()}render(){var yt,qe;const{_slider:e,actions:i,domNode:r,effectiveStops:n,fullTimeExtent:o,interactive:u,messages:p,messagesCommon:g,mode:w,tickConfigs:S,timeExtent:T,timeVisible:E,viewModel:{state:C,timeExtentValues:L}}=this;if(o!=null){const{start:Ue,end:ei}=o;if(Ue!=null&&ei!=null){const jr=Ue.getTime(),cs=ei.getTime(),eo=e.min!==jr||e.max!==cs;if(eo&&(e.min=jr,e.max=cs),S!=null)e.tickConfigs!==S&&(e.tickConfigs=S);else{const to=(cs-jr)/(((yt=e.trackElement)==null?void 0:yt.offsetWidth)||400),On=this.tickFormats.find(sa=>sa.minor.toMilliseconds()>bUe*to)??this.tickFormats.at(-1),Is=this._tickFormat!==On&&On!=null;if(Is&&(this._tickFormat=On),eo||Is){const sa={mode:"position",values:this._getTickPositions(On.minor),labelsVisible:!1,tickCreatedFunction:(oa,hn)=>{hn==null||hn.classList.add(xt.sliderMinorTick)}},Ha={mode:"position",values:this._getTickPositions(On.major),labelsVisible:!0,tickCreatedFunction:(oa,hn)=>{hn==null||hn.classList.add(xt.sliderMajorTick)},labelFormatFunction:oa=>ln(oa,On.format)};e.tickConfigs=[sa,Ha]}}}}const R=((qe=this.fullTimeExtent)==null?void 0:qe.start)==null||this.fullTimeExtent.end==null||this.timeExtent==null||this.timeExtent.isAllTime||this.timeExtent.isEmpty||this.timeExtent.start!=null&&(this.timeExtent.start<this.fullTimeExtent.start||this.timeExtent.start>this.fullTimeExtent.end)||this.timeExtent.end!=null&&(this.timeExtent.end>this.fullTimeExtent.end||this.timeExtent.end<this.fullTimeExtent.start);if(R)switch(this._ignoreNextSliderUpdate=!0,w){case"time-window":e.values=[e.min,e.max];break;case"instant":case"cumulative-from-end":e.values=[e.min];break;case"cumulative-from-start":e.values=[e.max]}else L!=null?Rb(e.values,L)||(e.values=L):e.values=null;e.disabled=!u;const F=C==="ready",V=C==="playing",U=R||!u||n==null||n.length===0,W=this.layout==="auto"?r.clientWidth<wUe?"compact":"wide":this.layout,H=N("div",{class:xt.animation},N("button",{"aria-disabled":U?"true":"false","aria-label":V?g.control.stop:g.control.play,bind:this,class:this.classes(Ee.widgetButton,xt.animationButton,U&&Ee.buttonDisabled),disabled:U,onclick:this._playOrStopClick,title:V?g.control.stop:g.control.play,type:"button"},N("div",{class:this.classes((F||U)&&$n.play,V&&$n.pause)}))),J=this.labelFormatFunction!=null?N("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:xt.timeExtentDate,"data-date":T?[T.start,T.end]:null,"data-layout":W,"data-type":"extent",key:"extent"}):T==null||T!=null&&T.isAllTime?[N("div",{class:this.classes(xt.warning,$n.noticeTriangle)}),N("div",{class:xt.warningText,key:"warning-text"},p.noTimeExtent)]:T.isEmpty?[N("div",{class:this.classes(xt.warning,$n.noticeTriangle)}),N("div",{class:xt.warningText,key:"warning-text"},p.emptyTimeExtent)]:[T.start!=null&&N("div",{class:xt.timeExtentGroup,key:"start-date-group"},N("div",{class:xt.timeExtentDate,key:"start-date"},this._formatDate(T.start)),E?N("div",{class:xt.timeExtentTime,key:"start-time"},this._formatTime(T.start)):null),T.start!=null&&T.end!=null&&T.start.getTime()!==T.end.getTime()&&N("div",{class:xt.timeExtentSeparator,key:"separator"},"â€“"),T.end!=null&&(T.start==null||T.start.getTime()!==T.end.getTime())&&N("div",{class:xt.timeExtentGroup,key:"end-date-group"},N("div",{class:xt.timeExtentDate,key:"end-date"},this._formatDate(T.end)),E?N("div",{class:xt.timeExtentTime,key:"end-time"},this._formatTime(T.end)):null)],X=N("div",{class:this.classes(xt.timeExtent,!u&&Ee.buttonDisabled)},[J]),te=this.labelFormatFunction!=null?N("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:xt.minDate,"data-date":o==null?void 0:o.start,"data-layout":W,"data-type":"min",key:"min-date"}):(o==null?void 0:o.start)!=null&&[N("div",{class:xt.minDate,key:"min-date"},this._formatDate(o.start)),E&&N("div",{class:xt.minTime,key:"min-time"},this._formatTime(o.start))],oe=N("div",{class:this.classes(xt.min,!u&&Ee.buttonDisabled)},[te]),pe=N("div",{class:xt.slider},e.render()),de=this.labelFormatFunction!=null?N("div",{afterCreate:this._createLabel,afterUpdate:this._createLabel,bind:this,class:xt.maxDate,"data-date":o==null?void 0:o.end,"data-layout":W,"data-type":"max",key:"max-date"}):(o==null?void 0:o.end)!=null&&[N("div",{class:xt.maxDate,key:"max-date"},this._formatDate(o.end)),E&&N("div",{class:xt.maxTime,key:"max-time"},this._formatTime(o.end))],ge=N("div",{class:this.classes(xt.max,!u&&Ee.buttonDisabled)},[de]),we=N("div",{class:xt.previous},N("button",{"aria-disabled":U?"true":"false","aria-label":g.pagination.previous,bind:this,class:this.classes(Ee.widgetButton,xt.previousButton,(V||U)&&Ee.buttonDisabled),disabled:U,onclick:this._previousClick,title:g.pagination.previous,type:"button"},N("div",{class:$n.reverse}))),ke=N("div",{class:xt.next},N("button",{"aria-disabled":U?"true":"false","aria-label":g.pagination.next,bind:this,class:this.classes(Ee.widgetButton,xt.nextButton,(V||U)&&Ee.buttonDisabled),disabled:U,onclick:this._nextClick,title:g.pagination.next,type:"button"},N("div",{class:$n.forward}))),$e=(i==null?void 0:i.length)>0,Fe=$e&&N("div",{class:xt.actions,title:g.options},N("calcite-action-menu",{class:xt.actionsButton,label:g.options},i.toArray().map(Ue=>N("calcite-action",{bind:this,icon:Ue.icon,id:Ue.id,onclick:()=>this.viewModel.triggerAction(Ue),text:Ue.title,textEnabled:!0,title:Ue.title}))));return N("div",{afterCreate:Ue=>{this.addHandles(yR(Ue,()=>this.scheduleRender()))},"aria-label":p.widgetLabel,class:this.classes(xt.timeSlider,Ee.widget,`${xt.timeSliderMode}${w}`,`${xt.timeSliderLayout}${W}`,!u&&Ee.disabled,R&&xt.timeSliderOutOfBounds,$e&&xt.hasActions,Jre())},W==="wide"&&N("div",{class:xt.timeSliderRow},N("div",{class:xt.playbackControls},[H,X,oe,pe,ge,we,ke]),Fe),W==="compact"&&[N("div",{class:xt.timeSliderRow,key:"time-slider-row-1"},[X,Fe]),N("div",{class:xt.timeSliderRow,key:"time-slider-row-2"},[pe]),N("div",{class:xt.timeSliderRow,key:"time-slider-row-3"},[oe,we,H,ke,ge])])}updateWebDocument(e){var i;(i=this.viewModel)==null||i.updateWebDocument(e)}_createLabel(e){if(this.labelFormatFunction==null)return;const i=e.getAttribute("data-type"),r=e.getAttribute("data-layout"),n=e["data-date"];this.labelFormatFunction(n,i,e,r)}_formatDate(e){return ln(e,this._dateFormat)}_formatTime(e){return ln(e,this._timeFormat)}_getIntlOptions(e){const{timeZone:i}=this;return{...bo(e),timeZone:i}}_getTickPositions(e){const{fullTimeExtent:i}=this;if((i==null?void 0:i.start)==null||i.end==null)return[];const{start:r,end:n}=i,o=[],{value:u,unit:p}=e;let g=xC(r,p,this.timeZone);for(;g.getTime()<=n.getTime();)g.getTime()>=r.getTime()&&o.push(g.getTime()),g=$2(g,u,p,this.timeZone);return o}_updateSliderSteps(){this._slider.steps=this.effectiveStops!=null&&this.effectiveStops.length>0?this.effectiveStops.map(e=>e.getTime()):null}_playOrStopClick(){switch(this.viewModel.state){case"ready":this.viewModel.play();break;case"playing":this.viewModel.stop();break;case"disabled":break;default:this.viewModel.state}}_previousClick(){this.viewModel.previous()}_nextClick(){this.viewModel.next()}};m([b()],Ei.prototype,"_dateFormat",null),m([b()],Ei.prototype,"_timeFormat",null),m([b()],Ei.prototype,"actions",null),m([b()],Ei.prototype,"disabled",void 0),m([b()],Ei.prototype,"effectiveStops",null),m([b()],Ei.prototype,"fullTimeExtent",null),m([b()],Ei.prototype,"icon",null),m([b({readOnly:!0})],Ei.prototype,"interactive",null),m([b()],Ei.prototype,"label",null),m([b()],Ei.prototype,"labelFormatFunction",void 0),m([b({value:"auto"})],Ei.prototype,"layout",null),m([b()],Ei.prototype,"loop",null),m([b(),vt("esri/widgets/TimeSlider/t9n/TimeSlider")],Ei.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],Ei.prototype,"messagesCommon",void 0),m([b()],Ei.prototype,"mode",null),m([b()],Ei.prototype,"playRate",null),m([b()],Ei.prototype,"stops",null),m([b()],Ei.prototype,"tickConfigs",void 0),m([b()],Ei.prototype,"tickFormats",null),m([b()],Ei.prototype,"timeExtent",null),m([b({nonNullable:!0})],Ei.prototype,"timeVisible",void 0),m([b()],Ei.prototype,"timeZone",null),m([b()],Ei.prototype,"view",null),m([b({type:w7}),v0("trigger-action")],Ei.prototype,"viewModel",void 0),m([mm()],Ei.prototype,"_playOrStopClick",null),m([mm()],Ei.prototype,"_previousClick",null),m([mm()],Ei.prototype,"_nextClick",null),Ei=m([G("esri.widgets.TimeSlider")],Ei);const cH=Ei;function Hu(t){let e,i,r=[],n=!1;function o(...u){return n&&e===this&&SUe(u,r)||(i=t.apply(this,u),e=this,r=u,n=!0),i}return o}function SUe(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}const Pn="esri-elevation-profile",Yr={base:`${Pn}`,portrait:`${Pn}--portrait`,refined:`${Pn}--refined`,mainContainer:`${Pn}__main-container`,promptContainer:`${Pn}__prompt-container`,header:`${Pn}__header`,zoomOutButton:`${Pn}__zoom-out-button`,clearButton:`${Pn}__clear-button`,actionButton:`${Pn}__action-button`,sketchButton:`${Pn}__sketch-button`,sketchCancelButton:`${Pn}__sketch-cancel-button`,sketchDoneButton:`${Pn}__sketch-done-button`,selectButton:`${Pn}__select-button`,selectCancelButton:`${Pn}__select-cancel-button`,chartContainer:`${Pn}__chart-container`,chartSpinner:`${Pn}__chart-spinner`,chartSpinnerVisible:`${Pn}__chart-spinner--visible`,chartSpinnerSmall:`${Pn}__chart-spinner--small`,footer:`${Pn}__footer`},xUe={base:"esri-elevation-profile-legend"},Nh="esri-elevation-profile-legend-item",Dh={base:Nh,disabled:`${Nh}--disabled`,expanded:`${Nh}--expanded`,colorIndicator:`${Nh}__color-indicator`,header:`${Nh}__header`,content:`${Nh}__content`,collapseToggle:`${Nh}__collapse-toggle`,label:`${Nh}__label`,checkbox:`${Nh}__checkbox`},Gw="esri-elevation-profile-statistics",Bw={base:Gw,statistic:`${Gw}__statistic`,statisticLabel:`${Gw}__statistic__label`,statisticValue:`${Gw}__statistic__value`,slopeValue:`${Gw}__slope-value`},A$="esri-elevation-profile-settings",L$={base:`${A$}`,popoverContent:`${A$}__popover-content`,uniformChartScalingLabel:`${A$}__uniform-scaling-label`,uniformChartScalingCheckbox:`${A$}__uniform-scaling-checkbox`};let $Ue=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,i){this._store.put(e,i,i.values.byteLength+256)}};function qle(t,e,i,r){let n=null,o=1e3;typeof e=="number"?(o=e,r=i):(n=e??null,o=i);let u,p=0;const g=()=>{p=0,t.apply(r,u)},w=(...S)=>{n&&n.apply(r,S),u=S,o?p||(p=setTimeout(g,o)):g()};return w.remove=()=>{p&&(clearTimeout(p),p=0)},w.forceUpdate=()=>{p&&(clearTimeout(p),g())},w.hasPendingUpdates=()=>!!p,w}let TUe=class{};const EUe=TUe;function hH(t,...e){let i="";for(let r=0;r<e.length;r++)i+=t[r]+e[r];return i+=t[t.length-1],i}(function(t){function e(r){return Math.round(r).toString()}function i(r){return r.toPrecision(8)}t.int=e,t.float=i})(hH||(hH={}));var pH,dH,fH,yH,mH,gH,vH,_7,bH;(function(t){t[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.COUNT=3]="COUNT"})(pH||(pH={})),function(t){t[t.Less=0]="Less",t[t.Lequal=1]="Lequal",t[t.COUNT=2]="COUNT"}(dH||(dH={})),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.UPDATE=1]="UPDATE"}(fH||(fH={})),function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(yH||(yH={})),function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(mH||(mH={})),function(t){t[t.Highlight=0]="Highlight",t[t.MaskOccludee=1]="MaskOccludee",t[t.COUNT=2]="COUNT"}(gH||(gH={})),function(t){t[t.Blend=0]="Blend",t[t.Opaque=1]="Opaque",t[t.Mask=2]="Mask",t[t.MaskBlend=3]="MaskBlend",t[t.COUNT=4]="COUNT"}(vH||(vH={})),function(t){t[t.OFF=0]="OFF",t[t.ON=1]="ON"}(_7||(_7={})),function(t){t.DDS_ENCODING="image/vnd-ms.dds",t.KTX2_ENCODING="image/ktx2",t.BASIS_ENCODING="image/x.basis"}(bH||(bH={}));let IUe=class{constructor(){this.id=Fp()}};var S7;(function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"})(S7||(S7={}));var qr;function Tst(t){return t===qr.POSITION}(function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.TANGENT="tangent",t.OFFSET="offset",t.PERSPECTIVEDIVIDE="perspectiveDivide",t.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",t.LENGTH="length",t.PREVPOSITION="prevPosition",t.NEXTPOSITION="nextPosition",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.INSTANCEMODELORIGINHI="instanceModelOriginHi",t.INSTANCEMODELORIGINLO="instanceModelOriginLo",t.INSTANCEMODEL="instanceModel",t.INSTANCEMODELNORMAL="instanceModelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMAL2COMPRESSED="normal2Compressed",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"})(qr||(qr={}));const MUe=new Map([[qr.POSITION,0],[qr.NORMAL,1],[qr.NORMALCOMPRESSED,1],[qr.UV0,2],[qr.COLOR,3],[qr.COLORFEATUREATTRIBUTE,3],[qr.SIZE,4],[qr.TANGENT,4],[qr.CENTEROFFSETANDDISTANCE,5],[qr.SYMBOLCOLOR,5],[qr.FEATUREATTRIBUTE,6],[qr.INSTANCEFEATUREATTRIBUTE,6],[qr.INSTANCECOLOR,7],[qr.OBJECTANDLAYERIDCOLOR,7],[qr.INSTANCEOBJECTANDLAYERIDCOLOR,7],[qr.INSTANCEMODEL,8],[qr.INSTANCEMODELNORMAL,12],[qr.INSTANCEMODELORIGINHI,11],[qr.INSTANCEMODELORIGINLO,15]]);function kUe(t){return Math.abs(t*t*t)}function Hle(t,e,i){const r=i.parameters;return d4.scale=Math.min(r.divisor/(e-r.offset),1),d4.factor=kUe(t),d4}function Wle(t,e){return Pf(t*Math.max(e.scale,e.minScaleFactor),t,e.factor)}function CUe(t,e,i){const r=Hle(t,e,i);return r.minScaleFactor=0,Wle(1,r)}function Est(t,e,i,r){r.scale=CUe(t,e,i),r.factor=0,r.minScaleFactor=i.minScaleFactor}function Ist(t,e,i=[0,0]){const r=Math.min(Math.max(e.scale,e.minScaleFactor),1);return i[0]=t[0]*r,i[1]=t[1]*r,i}function AUe(t,e,i,r){return Wle(t,Hle(e,i,r))}const d4={scale:0,factor:0,minScaleFactor:0};function Mst(t,e,i,r,n){let o=(i.screenLength||0)*t.pixelRatio;n!=null&&(o=AUe(o,r,e,n));const u=o*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return An(u*e,i.minWorldLength||0,i.maxWorldLength!=null?i.maxWorldLength:1/0)}function Jle(t,e){const i=e?Jle(e):{};for(const r in t){let n=t[r];n!=null&&n.forEach&&(n=OUe(n)),n==null&&r in i||(i[r]=n)}return i}function LUe(t,e){let i=!1;for(const r in e){const n=e[r];n!==void 0&&(Array.isArray(n)?t[r]===null?(t[r]=n.slice(),i=!0):Zue(t[r],n)&&(i=!0):t[r]!==n&&(i=!0,t[r]=n))}return i}function OUe(t){const e=[];return t.forEach(i=>e.push(i)),e}const kst={multiply:1,ignore:2,replace:3,tint:4};let Cst=class extends IUe{constructor(e,i){super(),this.type=S7.Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._vertexAttributeLocations=MUe,this._pp0=un(0,0,1),this._pp1=un(0,0,0),this._parameters=Jle(e,i),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(e){return!1}setParameters(e,i=!0){LUe(this._parameters,e)&&(this.validateParameters(this._parameters),i&&this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleForOutput(e.output)&&(!this.parameters.isDecoration||e.bindParameters.decorations===_7.ON)&&!!(this.parameters.renderOccluded&e.renderOccludedMask)}isVisibleForOutput(e){return!0}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){var e;(e=this.repository)==null||e.materialChanged(this)}queryRenderOccludedState(e){return this.isVisible()&&this.parameters.renderOccluded===e}intersectDraped(e,i,r,n,o,u){return this._pp0[0]=this._pp1[0]=n[0],this._pp0[1]=this._pp1[1]=n[1],this.intersect(e,i,r,this._pp0,this._pp1,o)}};var vI;(function(t){t[t.None=0]="None",t[t.Occlude=1]="Occlude",t[t.Transparent=2]="Transparent",t[t.OccludeAndTransparent=4]="OccludeAndTransparent",t[t.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",t[t.Opaque=16]="Opaque"})(vI||(vI={}));let Lst=class extends EUe{constructor(){super(...arguments),this.renderOccluded=vI.Occlude,this.isDecoration=!1}};var Ho,_n;(function(t){t.Disabled="disabled",t.Ready="ready",t.Creating="creating",t.Created="created",t.Selecting="selecting",t.Selected="selected"})(Ho||(Ho={})),function(t){t.NoValidInput="no-valid-input",t.NoVisibleProfiles="no-visible-profiles",t.InvalidGeometry="invalid-geometry",t.TooComplex="too-complex",t.InvalidElevationInfo="invalid-elevation-info",t.UnknownError="unknown-error",t.RefinedButNoChartData="refined-but-no-chart-data",t.None="none"}(_n||(_n={}));let Zle={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:Zle.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:lt(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,outlineSize:0,falloff:0,outlineColor:HQ([1,1,1,0]),renderOccluded:vI.Opaque},hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function Vl(){return Zle}const PUe=" â€• ",RUe={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null},Kle="ProfileGenerationError";var Rl;(function(t){t.TooComplex="too-complex",t.InvalidGeometry="invalid-geometry",t.InvalidElevationInfo="invalid-elevation-info",t.ElevationQueryError="elevation-query-error"})(Rl||(Rl={}));let Wv=class extends Error{constructor(e){super("profile could not be generated",{cause:e}),this.type=Kle}};function FUe(t){return t.type===Kle}async function NUe(t,e,i,r,n,o,u){let p,g,w;const S=t.spatialReference,T=S.isGeographic||S.isWebMercator;let E=0;if(!T){const{planarLength:R}=await ie(()=>import("./geometryEngineAsync-C4GvRa5-.js"),[]);At(u),E=await R(t,"meters"),At(u)}const C=1/hr(r),L=n.geodesicDistanceThreshold??1/0;if(T||E>=L){await vh([{source:S,dest:r},{source:S,dest:Ge.WGS84}],u);const R=JUe(t);p=DR([R],"meters")[0];const F=wH(p,n);if(xH(t,p,F)>o)throw new Wv(Rl.TooComplex);const V=_H(R,e,i);({densifiedPath:g,distances:w}=zUe(V,F,C)),g=Ts(g,r)}else{await vh([{source:S,dest:r}],u),p=E;const R=wH(p,n);if(xH(t,p,R)>o)throw new Wv(Rl.TooComplex);const F=_H(t,e,i);({densifiedPath:g,distances:w}=VUe(F,R,C)),At(u),g=Ts(g,r)}return{densifiedPath:g,pathLength:p*C,distances:w}}function wH(t,e){const i=t/e.densificationMaxSamples;return Math.max(e.samplingDistance,i)}function _H(t,e,i){if(e==null)return SH(t);const r=t.spatialReference,n=e.mode,o=jM(e,r);let u=null;switch(i.type){case"2d":u=DUe(t,n,o);break;case"3d":u=jUe(t,n,o,i)}return u==null?SH(t):new Bn({hasZ:!0,hasM:!1,spatialReference:r,paths:Yle(t.paths,u)})}function DUe({hasZ:t},e,i){return e==="absolute-height"?t?([r,n,o])=>[r,n,o+i]:([r,n])=>[r,n,i]:null}function jUe({spatialReference:t,hasZ:e},i,r,{elevationProvider:n}){const o=(u,p,g,w)=>(n==null?void 0:n.getElevation(u,p,g,t,w))??0;switch(i){case"on-the-ground":return([u,p])=>[u,p,o(u,p,0,"ground")];case"absolute-height":return e?([u,p,g])=>[u,p,g+r]:([u,p])=>[u,p,r];case"relative-to-ground":return e?([u,p,g])=>[u,p,g+o(u,p,g,"ground")+r]:([u,p])=>[u,p,o(u,p,0,"ground")+r];case"relative-to-scene":return e?([u,p,g])=>[u,p,g+o(u,p,g,"scene")+r]:([u,p])=>[u,p,o(u,p,0,"scene")+r];default:return null}}function SH(t){return t.hasZ?new Bn({hasZ:!1,hasM:!1,spatialReference:t.spatialReference,paths:Yle(t.paths,([e,i])=>[e,i])}):t}function Yle(t,e){const i=t.length,r=new Array(i);for(let n=0;n<i;++n){const o=t[n],u=o.length,p=new Array(o.length);r[n]=p;for(let g=0;g<u;++g)p[g]=e(o[g])}return r}function oN(t){return zS(t)&&t.paths.length>0&&t.paths.every(e=>e.length>=2)}function zS(t){return t!=null&&t.type==="polyline"}function Xle(t,e,i,r,n){const{spatialReference:o,hasZ:u}=t,p={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:o,metersPerSR:hr(o)},g=[],w=[];let S=0;for(let T=0;T<t.paths.length;++T){const E=t.paths[T],C=new Array,L=new Array;let R=0;for(let F=1;F<E.length;++F){const V=E[F-1],U=E[F],W=r(p,V,U);let H;for(H=R;H<W.distance&&!C0e(H,W.distance);H+=e)C.push(n(W,H)),L.push((S+H)*i);R=H-W.distance,S+=W.distance,C.push(U),L.push(S*i)}g[T]=C,w[T]=L}return{densifiedPath:new Bn({spatialReference:o,hasZ:u,paths:g}),distances:w}}function VUe(t,e,i){const{hasZ:r}=t;return Xle(t,e,i,GUe,r?WUe:HUe)}function zUe(t,e,i){const{hasZ:r}=t;return Xle(t,e,i,UUe,r?qUe:BUe)}function UUe(t,e,i){return t.distance=0,tg(t,e,i,t.spatialReference),t.from=e,t.to=i,t}function GUe(t,e,i){return t.from=e,t.to=i,t.distance=g0(i,e)*t.metersPerSR,t}function BUe({from:t,azimuth:e,spatialReference:i},r){return Gp([0,0],t,e,r,i)}function qUe({from:t,to:e,azimuth:i,distance:r,spatialReference:n},o){const u=o/r,p=[0,0,Pf(t[2],e[2],u)];return Gp(p,t,i,o,n),p}function HUe({from:t,to:e,distance:i},r){return TM([0,0],t,e,r/i)}function WUe({from:t,to:e,distance:i},r){return VI([0,0,0],t,e,r/i)}function JUe(t){return b0(t.spatialReference)?t:Ts(t,Ge.WGS84)}function Qle(t){return t.paths.reduce((e,i)=>e+i.length,0)}function xH(t,e,i){return Qle(t)+Math.floor(e/i)+Math.max(0,t.paths.reduce(r=>1+r,0)-1)}const eue=Symbol("Yield");let ZUe=class{constructor(){this._tasks=new Array,this._runningTasks=I3(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return eue;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,i,r){return++this._runningTasks.value,new Promise((n,o)=>this._tasks.push(new $H(n,o,e,i,r))).finally(()=>--this._runningTasks.value)}unshift(e,i,r){return++this._runningTasks.value,new Promise((n,o)=>this._tasks.unshift(new $H(n,o,e,i,r))).finally(()=>--this._runningTasks.value)}_process(e){var r;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const n=Xo(i.signal);if(n&&!i.abortCallback)i.reject(ni());else{const o=n?(r=i.abortCallback)==null?void 0:r.call(i,ni()):i.callback(e);ed(o)?o.then(i.resolve,i.reject):i.resolve(o)}}catch(n){i.reject(n)}return!0}cancelAll(){const e=ni();for(const i of this._tasks)if(i.abortCallback){const r=i.abortCallback(e);i.resolve(r)}else i.reject(e);this._tasks.length=0}},$H=class{constructor(e,i,r,n=void 0,o=void 0){this.resolve=e,this.reject=i,this.callback=r,this.signal=n,this.abortCallback=o}},p2=class extends Te{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};m([b()],p2.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),m([b()],p2.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),p2=m([G("esri.views.support.debugFlags")],p2);const KUe=new p2;var ka;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(ka||(ka={}));var Et;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"})(Et||(Et={}));const eh=0,TH=new Map([[Et.RESOURCE_CONTROLLER_IMMEDIATE,eh],[Et.RESOURCE_CONTROLLER,4],[Et.SLIDE,eh],[Et.STREAM_DATA_LOADER,eh],[Et.ELEVATION_QUERY,eh],[Et.TERRAIN_SURFACE,1],[Et.SURFACE_GEOMETRY_UPDATES,1],[Et.LOD_RENDERER,2],[Et.GRAPHICS_CORE,2],[Et.I3S_CONTROLLER,2],[Et.POINT_CLOUD_LAYER,2],[Et.FEATURE_TILE_FETCHER,2],[Et.OVERLAY,4],[Et.STAGE,4],[Et.GRAPHICS_DECONFLICTOR,4],[Et.FILTER_VISIBILITY,4],[Et.SCALE_VISIBILITY,4],[Et.FRUSTUM_VISIBILITY,4],[Et.CLOUDS_GENERATOR,4],[Et.POINT_OF_INTEREST_FREQUENT,6],[Et.POINT_OF_INTEREST_INFREQUENT,30],[Et.LABELER,8],[Et.FEATURE_QUERY_ENGINE,8],[Et.FEATURE_TILE_TREE,16],[Et.FEATURE_TILE_TREE_ACTIVE,eh],[Et.ELEVATION_ALIGNMENT,12],[Et.ELEVATION_ALIGNMENT_SCENE,14],[Et.TEXT_TEXTURE_ATLAS,12],[Et.TEXTURE_UNLOAD,12],[Et.LINE_OF_SIGHT_TOOL,16],[Et.LINE_OF_SIGHT_TOOL_INTERACTIVE,eh],[Et.SNAPPING,eh],[Et.SHADOW_ACCUMULATOR,30]]);function EH(t){return TH.has(t)?TH.get(t):typeof t=="number"?t:1}const YUe=6.5,IH=1,XUe=30,QUe=1e3/30,eGe=100,MH=.9;var x7,F0;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(o=>o.needsUpdate)}constructor(){this._updating=I3(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new g2("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=ka.INTERACTING,this._tasks=new om,this._runQueue=new om,this._load=0,this._idleStateCallbacks=new om,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=ce(()=>KUe.SCHEDULER_LOG_SLOW_TASKS,o=>this._debug=o,Qe);for(const o of Object.keys(Et))this.performanceInfo.tasks.set(Et[o],new g2(Et[o]))}destroy(){this._tasks.toArray().forEach(o=>o.remove()),this._tasks.clear(),Vi(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(o){this._updatingChanged(),o&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())}))}registerTask(o,u){const p=new i(this,o,u);return this._tasks.push(p),this._updatingChanged(),this.performanceInfo.tasks.has(o)||this.performanceInfo.tasks.set(o,new g2(o)),p}registerIdleStateCallbacks(o,u){const p={idleBegin:o,idleEnd:u};this._idleStateCallbacks.push(p),this.state===ka.IDLE&&this._idleUpdatesStartFired&&p.idleBegin();const g=this;return{remove:()=>this._removeIdleStateCallbacks(p),set idleBegin(w){g._idleUpdatesStartFired&&(p.idleEnd(),g._state===ka.IDLE&&w()),p.idleBegin=w},set idleEnd(w){p.idleEnd=w}}}get load(){return this._load}set state(o){this._state!==o&&(this._state=o,this.state!==ka.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(u=>u.idleEnd())))}get state(){return this._state}updateBudget(o){++this._frameNumber;let u=YUe,p=o.frameDuration,g=IH;switch(this.state){case ka.IDLE:u=0,p=Math.max(eGe,o.frameDuration),g=XUe;break;case ka.INTERACTING:p=Math.max(QUe,o.frameDuration);case ka.ANIMATING:}return p=p-o.elapsedFrameTime-u,this.state!==ka.IDLE&&p<IH&&!this._forceTask?(this._forceTask=!0,!1):(p=Math.max(p,g),this._budget.reset(p,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case ka.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(o=>o.idleBegin())),this._runIdle();break;case ka.INTERACTING:this._runInteracting();break;default:this._runAnimating()}}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(o){this._idleUpdatesStartFired&&o.idleEnd(),this._idleStateCallbacks.removeUnordered(o)}removeTask(o){this._tasks.removeUnordered(o),this._runQueue.removeUnordered(o),this._updatingChanged()}_updateTask(o){this._tasks.forAll(u=>{u.name===o&&u.setPriority(o)})}_getState(o){if(this._runQueue.some(p=>p.name===o))return F0.SCHEDULED;let u=F0.IDLE;return this._tasks.forAll(p=>{p.name===o&&p.needsUpdate&&(p.schedulePriority<=1?u=F0.READY:u!==F0.READY&&(u=F0.WAITING))}),u}_getRuntime(o){let u=0;return this._tasks.forAll(p=>{p.name===o&&(u+=p.runtime)}),u}_resetRuntimes(){this._tasks.forAll(o=>o.runtime=0)}_getRunning(){const o=new Map;if(this._tasks.forAll(p=>{p.needsUpdate&&o.set(p.name,(o.get(p.name)||0)+1)}),o.size===0)return null;let u="";return o.forEach((p,g)=>{u+=p>1?` ${p}x ${g}`:` ${g}`}),u}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const o=this._tasks.reduce((u,p)=>p.needsUpdate?++u:u,0);this._load=this._load*MH+o*(1-MH)}_schedule(){for(this._runQueue.filterInPlace(o=>!!o.needsUpdate||(o.schedulePriority=o.basePriority,!1)),this._tasks.forAll(o=>{o.basePriority===eh&&o.needsUpdate&&!this._runQueue.includes(o)&&o.blockFrame!==this._frameNumber&&this._runQueue.unshift(o)});this._runQueue.length===0;){let o=!1,u=0;if(this._tasks.forAll(p=>{p.needsUpdate&&p.schedulePriority!==0&&p.basePriority!==eh&&p.blockFrame!==this._frameNumber&&(o=!0,u=Math.max(u,p.basePriority),p.schedulePriority===1?(p.schedulePriority=0,this._runQueue.push(p)):--p.schedulePriority)}),!o)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const o=this._budget.now();this._startFrameTaskTimes();do for(;this._runQueue.length>0;){const u=this._budget.now(),p=this._runQueue.pop();this._budget.resetProgress();try{p.task.runTask(this._budget)===eue&&(p.blockFrame=this._frameNumber)}catch(w){fe.getLogger("esri.views.support.Scheduler").error(`Exception in task "${p.name}"`,w),p.blockFrame=this._frameNumber}!this._budget.hasProgressed&&p.blockFrame!==this._frameNumber&&p.needsUpdate&&(p.name,Et.I3S_CONTROLLER,p.blockFrame=this._frameNumber),p.schedulePriority=p.basePriority;const g=this._budget.now()-u;if(p.runtime+=g,this._frameTaskTimes.set(p.priority,this._frameTaskTimes.get(p.priority)+g),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-o)}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-o)}_startFrameTaskTimes(){for(const o of Object.keys(Et))this._frameTaskTimes.set(Et[o],0)}_recordFrameTaskTimes(o){this._frameTaskTimes.forEach((u,p)=>this.performanceInfo.tasks.get(p).record(u)),this.performanceInfo.total.record(o)}get test(){}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(o,u,p){this._scheduler=o,this.name=u,this.blockFrame=0,this.runtime=0,this._queue=new ZUe,this._handles=new Fb,this._basePriority=EH(u),this.schedulePriority=this._basePriority,this._task=I3(p??this._queue),this._handles.add(Fr(()=>this.task.running,g=>o.taskRunningChanged(g)))}remove(){this.processQueue(tue),this._scheduler.removeTask(this),this.schedule=kH.schedule,this.reschedule=kH.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(o){if(this.name===o)return;this.name=o;const u=EH(o);this._basePriority!==eh&&this.schedulePriority===0||(this.schedulePriority=u),this._basePriority=u}get priority(){return this.name}set priority(o){this.setPriority(o)}get needsUpdate(){return this.updating||this.task.running}schedule(o,u,p){return this._queue.push(o,u,p)}reschedule(o,u,p){return this._queue.unshift(o,u,p)}processQueue(o){return this._queue.runTask(o)}}class r{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=ka.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(o){return!this.done&&(o()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(o){this._enabled=o}reset(o,u){this._begin=this.now(),this._budget=o,this._state=u,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=r})(x7||(x7={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(F0||(F0={}));const tue=(()=>{const t=new x7.Budget;return t.enabled=!1,t})();let tGe=class{remove(){}processQueue(){}schedule(e,i,r){try{if(Xo(i)){const n=ni();return r?Promise.resolve(r(n)):Promise.reject(n)}return E4(e(tue))}catch(n){return Promise.reject(n)}}reschedule(e,i,r){return this.schedule(e,i,r)}};const kH=new tGe;function iGe(t,e){const i=t.length;if(i===0)return null;const r=t[0],n=r.sampledZ;let o=n,u=n,p=0,g=0,w=null,S=null,T=n??0,E=0,C=0,L=n!=null?1:0,R=0,F=0;const V=hr(e),U=Gl(e),W=Vl().minSlopeSampleDistance/V,H=2*W,J=new CH,X=new CH,te=()=>{pe(),J.copy(X),X.reset()},oe=(de,ge)=>{te(),de>0&&de-J.start<=H&&(de=J.start+W),X.restart(de,ge)},pe=()=>{if(J.isHole||X.isHole)return;const de=X.avgElevation-J.avgElevation,ge=X.start-J.start,we=de*U,ke=ge*V,$e=lt(Math.atan2(we,ke),"radians","degrees");$e>0?(E+=$e,w=Rp(w,$e),R++):$e<0&&(C-=$e,S=Rp(S,-$e),F++)};r.sampledZ!=null&&oe(r.distance,r.sampledZ);for(let de=1;de<i;++de){const ge=t[de-1],we=t[de],ke=we.sampledZ;if(ke==null){X.isHole||te();continue}L++,T+=ke,o=aN(o,ke),u=Rp(u,ke),X.isHole||we.distance-X.start>=W?oe(we.distance,ke):X.insert(ke);const $e=ge.sampledZ;if($e!=null){const Fe=ke-$e;Fe>0?p+=Fe:Fe<0&&(g-=Fe)}}return te(),L===0?null:{maxDistance:t[i-1].distance,minElevation:o,maxElevation:u,avgElevation:L===0?null:T/L,elevationGain:p,elevationLoss:g,maxPositiveSlope:w,maxNegativeSlope:S,avgPositiveSlope:R===0?null:E/R,avgNegativeSlope:F===0?null:C/F}}function rGe(t){const e=t.filter(Rt),i=e.length;if(i===0)return null;const r=e[0];if(i===1)return r;let n=r.maxDistance,o=r.minElevation,u=r.maxElevation,p=r.maxPositiveSlope,g=r.maxNegativeSlope;for(let w=1;w<e.length;++w){const S=e[w];n=Rp(n,S.maxDistance),o=aN(o,S.minElevation),u=Rp(u,S.maxElevation),p=Rp(p,S.maxPositiveSlope),g=Rp(g,S.maxNegativeSlope)}return{maxDistance:n,minElevation:o,maxElevation:u,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:p,maxNegativeSlope:g,avgPositiveSlope:null,avgNegativeSlope:null}}function nGe(t){let e=null,i=null,r=null;for(const n of t){if(n==null)continue;const{statistics:o,spatialReference:u}=n;if(o==null)continue;const p=hr(u);e=Rp(e,f4(o.maxDistance,p));const g=Gl(u);r=aN(r,f4(o.minElevation,g)),i=Rp(i,f4(o.maxElevation,g))}return{minDistance:0,maxDistance:e??0,minElevation:r??0,maxElevation:i??0}}function aN(t,e){return e==null?t:t!=null?Math.min(t,e):e}function Rp(t,e){return e==null?t:t!=null?Math.max(t,e):e}function f4(t,e){return t!=null&&e!=null?t*e:null}let CH=class{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return this._sampleCount===0}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,i){this._start=e,this._sampleCount=1,this._totalElevation=i}insert(e){++this._sampleCount,this._totalElevation+=e}};function sGe(t,e,i=[]){if(t>=e||(i.push(t),e-t<2))return i;const r=e-1;i.push(r);const n=$7(t+1,r);for(;;){const o=n.next();if(o.done)break;i.push(o.value)}return i}function*$7(t,e){if(t>=e)return;const i=t+Math.floor((e-t)/2);yield i;const r=$7(t,i),n=$7(i+1,e);for(;;){const o=r.next(),u=n.next();if(o.done&&u.done)break;o.done||(yield o.value),u.done||(yield u.value)}}async function*oGe(t,e){const{view:i,geometry:r,elevationInfo:n,providers:o,options:u}=t,p=i.spatialReference;if(!p||r==null||!oN(r))throw new Wv(Rl.InvalidGeometry);const g=o.length;if(g===0)return null;const w=Math.round(u.maxTotalSamples/g);if(Qle(r)>w)throw new Wv(Rl.TooComplex);const S=await NUe(r,n,i,p,u,w,e);let T=0;const E=new Array(g),C=new Array(g);for(let F=0;F<g;F++){const V=pGe(S);E[F]=V,T+=V.samples.length;const U={...t,provider:o[F],result:V,densificationResult:S};C[F]=aGe(U,e)[Symbol.iterator]()}if(T>u.maxTotalSamples)throw new Wv(Rl.TooComplex);const L=await Promise.all(C.map(F=>{const V=F.next();return V.done===!0?Promise.resolve(null):V.value}));At(e);for(let F=0;F<g;F++)E[F]=L[F];yield E,await Db(t.delayAfterPreview??Vl().delayAfterPreviewMillis,null,e.signal);const R=[];try{let F;do{F=!1;for(let V=0;V<g;V++){const U=C[V].next();U.done===!1&&(R.push({resultPromise:U.value,index:V}),F=!0)}}while(F)}finally{C.forEach(F=>{var V;return(V=F.return)==null?void 0:V.call(F)})}for(const{resultPromise:F,index:V}of R)E[V]=await F,At(e),yield E;for(const F of E)F!=null&&(F.progress=1);yield E}function*aGe(t,e){const{densificationResult:i}=t,r={...t,abortOptions:e,densificationResult:i},n=sGe(0,r.result.samples.length),o=n.slice(0,r.provider.numSamplesForPreview);yield AH(r,o,!0);const u=Kue(n,r.provider.numSamplesPerChunk);for(const p of u)yield AH(r,p,!1)}async function AH({densificationResult:t,result:e,provider:i,queue:r,abortOptions:n,cache:o},u,p){const{densifiedPath:g,pathLength:w}=t,S=e.spatialReference,{samples:T}=e,E=[];for(let C=0;C<u.length;C++){const L=T[u[C]];E[C]=L.coordinate}try{return await r.push({geometry:new lh({spatialReference:S,points:E,hasZ:g.hasZ}),provider:i,indices:u,preview:p,result:e,queryOptions:{...Vl().defaultQueryOptions(),minDemResolution:Math.round(p?w/i.numSamplesForPreview:w/T.length),cache:o}},n),{...e}}catch(C){return Cn(C)?null:RUe}}function lGe(t){return new Ore({priority:Et.ELEVATION_PROFILE,concurrency:1,scheduler:t,process:async e=>{At(e.queryOptions);try{await uGe(e)}catch(i){D5(i)}}})}async function uGe({geometry:t,provider:e,indices:i,preview:r,result:n,queryOptions:o}){if(i.length===0)return;const u=(await yGe(e,t,o)).geometry,{hasZ:p,points:g}=u,w=o.noDataValue,{samples:S}=n;for(let T=0;T<i.length;T++){const E=S[i[T]];if(E.isHole)continue;const C=p?g[T][2]:null;C===null||C===w?E.sampledZ=null:(n.hasZ=!0,E.sampledZ=C),E.sampled=!0}cGe(S),n.progress=r?0:n.progress+i.length/S.length,n.statistics=iGe(n.samples,n.spatialReference)}function cGe(t){const e=t.length-1;let i=0;for(let r=1;r<=e;r++)(t[r].sampled||r===e)&&(hGe(t,i,r),i=r)}function hGe(t,e,i){if(i-e==1)return;const r=t[e],n=r.sampledZ,o=t[i],u=o.sampledZ;if(n==null||u==null){for(let w=e+1;w<i;w++)t[w].sampledZ=null;return}const p=r.distance,g=o.distance-p;for(let w=e+1;w<i;w++){const S=t[w],T=(S.distance-p)/g;S.sampledZ=Pf(n,u,T)}}function pGe({densifiedPath:t,distances:e}){const i=t.spatialReference,r=_s(i),n=t.paths,o=n.length,u=[];let p=null,g=0;for(let w=0;w<o;w++){const S=n[w],T=S.length,E=e[w];for(let C=0;C<T;C++){const L=S[C],R=E[C];r&&(L[0]=wK(L[0],r.valid[0],r.valid[1])),p&&C===0&&dGe(u,p,L,g,R),u.push(fGe(L,R)),p=L,g=R}}return{progress:0,samples:u,hasZ:!1,statistics:null,spatialReference:i}}function dGe(t,e,i,r,n){t.push(LH(e,r)),t.push(LH(i,n))}function fGe(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!1,isHole:!1}}function LH(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!0,isHole:!0}}async function yGe(t,e,i){try{return await t.queryElevation(e,i)}catch{throw new Wv(Rl.ElevationQueryError)}}const OH="line-change";let bf=class extends Te{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=Hu((i,r,n)=>({stationary:i,visibleProfiles:r,generationParameters:n})),this._getGenerationParametersMemoized=Hu((i,r,n,o,u,p,g)=>zS(r)&&oN(r)&&o!=null?{view:i,geometry:r,elevationInfo:n,options:p,queue:o,cache:u,slicePlane:g}:null),this._getElevationInfoMemoized=Hu((i,r)=>({mode:i,offset:r})),this._getOptionsMemoized=Hu((i,r,n)=>{const{densificationMaxSamples:o,maxTotalSamples:u}=Vl();return{geodesicDistanceThreshold:i,samplingDistance:r,densificationMaxSamples:Math.round(o/n),maxTotalSamples:u}}),this._updateThrottled=qle(i=>Wu(this._update(i)),Vl().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([ce(()=>e.profiles.toArray(),i=>{this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(OH),this.addHandles(i.map(r=>In([r.attach(this.viewModel),r.on("change",()=>{this._invalidateProfile(r)})])),OH)},ri),this._updateThrottled,ce(()=>this._updateParameters,this._updateThrottled,ri)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,i=e.view;return this._getUpdateParametersMemoized(i==null||i.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:i,queue:r,tileCache:n}=this.viewModel;return e!=null&&e.ready?this._getGenerationParametersMemoized(e,i==null?void 0:i.geometry,this._elevationInfo,r,n,this._options,e.type==="3d"?e.slicePlane:null):null}get _elevationInfo(){const e=this.viewModel.input,i=e?Hse(e)?null:oF(e):null;return i!=null?this._getElevationInfoMemoized(i.mode,i.offset):null}get _options(){const e=this.viewModel,i=e.visibleProfiles.length;let r=e.minDemResolution??Vl().defaultDemResolution;return r=parseFloat(r.toFixed(2)),this._getOptionsMemoized(e.geodesicDistanceThreshold,r,i)}async _update({stationary:e,visibleProfiles:i,generationParameters:r}){this._abortUpdate(),e&&(r!=null?this._updateTask=Sh(async n=>{this.viewModel.error=null;const o=i.filter(p=>!this._isProfileValid(p,r)),u=oGe({...r,providers:o},{signal:n});try{for await(const p of u){At(n),this._clearInvalidResults(r);for(let g=0;g<o.length;g++)o[g].result=p[g]}for(const p of o)this._paramsPerProfile.set(p,r)}catch(p){Ra(p),this._abortUpdate(),this.viewModel.error=p,o.forEach(g=>{g.result=null})}}):this._clearResults())}_abortUpdate(){this._updateTask=En(this._updateTask)}_isProfileValid(e,i){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===i}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const i of this.viewModel.profiles.items)this._isProfileValid(i,e)||(i.result=null,this._paramsPerProfile.delete(i))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};m([b({nonNullable:!0})],bf.prototype,"viewModel",void 0),m([b()],bf.prototype,"_updateParameters",null),m([b()],bf.prototype,"_generationParameters",null),m([b()],bf.prototype,"_elevationInfo",null),m([b()],bf.prototype,"_options",null),bf=m([G("esri.widgets.ElevationProfile.ElevationProfileController")],bf);function mGe(t,e){if(t==null||e==null)return null;const{samples:i,spatialReference:r}=t,{distance:n,elevation:o}=e,u=hr(r),p=Gl(r),g=i.length,w=new Array(g);for(let S=0;S<g;++S){const T=i[S],E=T.sampledZ,C=T.coordinate;w[S]={x:C[0],y:C[1],z:E,distance:iue(T.distance,u,n),elevation:iv(E,p,o)}}return w}function gGe(t,e){if(t==null||e==null||t.statistics==null||t.spatialReference==null)return null;const{distance:i,elevation:r}=e,{statistics:n,spatialReference:o}=t,u=hr(o),p=Gl(o);return{maxDistance:iue(n.maxDistance,u,i),minElevation:iv(n.minElevation,p,r),maxElevation:iv(n.maxElevation,p,r),avgElevation:iv(n.avgElevation,p,r),elevationGain:iv(n.elevationGain,p,r),elevationLoss:iv(n.elevationLoss,p,r),maxPositiveSlope:n.maxPositiveSlope,maxNegativeSlope:n.maxNegativeSlope,avgPositiveSlope:n.avgPositiveSlope,avgNegativeSlope:n.avgNegativeSlope}}function iue(t,e,i){return t==null?null:lt(t*e,"meters",i)}function iv(t,e,i){return t==null?null:lt(t*e,"meters",i)}let Rr=class extends Ar.EventedAccessor{constructor(e){super(e),this.type=null,this.id=yM(),this.title=null,this.color=new Ce("#000000"),this.visible=!0,this._getSamplesMemoized=Hu((i,r)=>mGe(i,r)),this._getStatisticsMemoized=Hu((i,r)=>gGe(i,r)),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return this.result!=null&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var i;const e=(i=this._viewModel)==null?void 0:i.hoveredChartPosition;return e!=null?this._getPoint(e):null}get available(){return!0}get hasZ(){const e=this.result;return e!=null&&e.hasZ}get minDemResolution(){return Vl().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,In([ce(()=>e.effectiveUnits,i=>{this.effectiveUnits=i},ri),ce(()=>[e.input],()=>this._onChange(),$s)])}toggleVisibility(e){this.visible=e===void 0?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:i,result:r}=this;if(i==null||r==null)return null;const n=i.length;if(n===0)return null;const o=i[n-1].distance,u=Yue(i,e*o,S=>S.distance);if(u==null)return null;const{x:p,y:g,z:w}=u;return w==null?null:new Ke({x:p,y:g,z:w,spatialReference:r.spatialReference})}};m([b({nonNullable:!0})],Rr.prototype,"id",void 0),m([b({nonNullable:!0})],Rr.prototype,"title",void 0),m([b({type:Ce,nonNullable:!0})],Rr.prototype,"color",void 0),m([b({nonNullable:!0})],Rr.prototype,"visible",void 0),m([b({readOnly:!0})],Rr.prototype,"progress",null),m([b({readOnly:!0})],Rr.prototype,"samples",null),m([b({readOnly:!0})],Rr.prototype,"statistics",null),m([b()],Rr.prototype,"hoveredPoint",null),m([b()],Rr.prototype,"viewVisualizationEnabled",void 0),m([b()],Rr.prototype,"available",null),m([b()],Rr.prototype,"result",void 0),m([b()],Rr.prototype,"effectiveUnits",void 0),m([b()],Rr.prototype,"numSamplesForPreview",void 0),m([b()],Rr.prototype,"numSamplesPerChunk",void 0),m([b()],Rr.prototype,"chartFillEnabled",void 0),m([b()],Rr.prototype,"chartStrokeWidth",void 0),m([b()],Rr.prototype,"chartStrokeOffsetY",void 0),m([b({readOnly:!0})],Rr.prototype,"hasZ",null),m([b({readOnly:!0})],Rr.prototype,"minDemResolution",null),m([b()],Rr.prototype,"_viewModel",void 0),Rr=m([G("esri.widgets.ElevationProfile.ElevationProfileLine")],Rr);const US=Rr;function rue(t){if(t==null)return null;if(t instanceof u3)return nue(t);const e=t.tileInfo;if(e==null)return null;const i=Hue(e.lods);return i==null?null:i.resolution*hr(e.spatialReference)}function nue(t){if(t==null)return null;const e=t.layers.items.map(vGe).filter(Rt);return fW(e)??null}function vGe(t){return t&&"tileInfo"in t?rue(t):null}let Hc=class extends US{constructor(e){super(e),this.type="ground",this.color=new Ce("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=Hu((i,r)=>({ground:i,groundLayers:r}))}get available(){const e=this._ground;return e!=null&&e.layers.some(i=>i.visible)}get minDemResolution(){return nue(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e,i,r;return(r=(i=(e=this._viewModel)==null?void 0:e.view)==null?void 0:i.map)==null?void 0:r.ground}get _groundLayers(){var e,i;return((i=(e=this._ground)==null?void 0:e.layers)==null?void 0:i.toArray())??[]}async queryElevation(e,i){const r=this._queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=r;if(n==null)throw new Error("No ground configured in the view");const o=await n.queryElevation(e,i),u=Gl(e.spatialReference),p=Gl(n.layers.at(0).spatialReference);if(u!==p){const g=o.geometry;g.points=g.points.map(([w,S,T])=>[w,S,T===i.noDataValue?T:T*p/u])}return o}attach(e){return In([super.attach(e),ce(()=>this._queryElevationDependencies,()=>this._onChange())])}};m([b({type:Ce,nonNullable:!0})],Hc.prototype,"color",void 0),m([b()],Hc.prototype,"viewVisualizationEnabled",void 0),m([b()],Hc.prototype,"available",null),m([b({readOnly:!0})],Hc.prototype,"minDemResolution",null),m([b()],Hc.prototype,"_queryElevationDependencies",null),m([b()],Hc.prototype,"_ground",null),m([b()],Hc.prototype,"_groundLayers",null),Hc=m([G("esri.widgets.ElevationProfile.ElevationProfileLineGround")],Hc);const sue=Hc,lN=()=>fe.getLogger("esri.layers.support.ElevationSampler");let oue=class{queryElevation(e){return wGe(e.clone(),this)}on(){return We()}projectIfRequired(e,i){return aue(e,i)}},bGe=class extends oue{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){super(),this.tile=e,this.noDataValue=r;const n=e.tile.extent;this.extent=xK(n,i.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=n;const o=hr(i.spatialReference),u=i.lodAt(e.tile.level).resolution*o;this.demResolution={min:u,max:u}}contains(e){const i=this.projectIfRequired(e,this.spatialReference);return i!=null&&this.containsAt(i.x,i.y)}containsAt(e,i){return EK(this._aaExtent,e,i)}elevationAt(e,i){if(!this.containsAt(e,i)){const r=this.extent,n=`${r.xmin}, ${r.ymin}, ${r.xmax}, ${r.ymax}`;return lN().warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e,i)??this.noDataValue}},PH=class extends oue{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){let n;super(),typeof i=="number"?(this.noDataValue=i,n=null):(n=i,this.noDataValue=r),this.samplers=n?e.map(u=>new bGe(u,n,this.noDataValue)):e;const o=this.samplers[0];if(o){this.extent=o.extent.clone();const{min:u,max:p}=o.demResolution;this.demResolution={min:u,max:p};for(let g=1;g<this.samplers.length;g++){const w=this.samplers[g];this.extent.union(w.extent),this.demResolution.min=Math.min(this.demResolution.min,w.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,w.demResolution.max)}}else this.extent=xK(bs(),n.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,i){let r,n=!1;for(const o of this.samplers)if(o.containsAt(e,i)&&(n=!0,r=o.elevationAt(e,i),r!==o.noDataValue))return r;return r??(n||lN().warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler`),this.noDataValue)}};function wGe(t,e){const i=aue(t,e.spatialReference);if(!i)return null;switch(t.type){case"point":_Ge(t,i,e);break;case"polyline":SGe(t,i,e);break;case"multipoint":xGe(t,i,e)}return t}function aue(t,e){if(t==null)return null;const i=t.spatialReference;if(i.equals(e))return t;const r=Y3(t,e);return r||lN().error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${e.wkid})`),r}function _Ge(t,e,i){t.z=i.elevationAt(e.x,e.y)}function SGe(t,e,i){ih.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.paths.length;n++){const o=t.paths[n],u=e.paths[n];for(let p=0;p<o.length;p++){const g=o[p],w=u[p];ih.x=w[0],ih.y=w[1],r&&(g[3]=g[2]),g[2]=i.elevationAt(ih.x,ih.y)}}t.hasZ=!0}function xGe(t,e,i){ih.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.points.length;n++){const o=t.points[n],u=e.points[n];ih.x=u[0],ih.y=u[1],r&&(o[3]=o[2]),o[2]=i.elevationAt(ih.x,ih.y)}t.hasZ=!0}const ih=new Ke;let $Ge=class{constructor(e,i){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(i[2]-i[0]),this.dy=(e.width-1)/(i[3]-i[1]),this.x0=i[0],this.y1=i[3]}},lue=class{constructor(e,i=null){if(this.tile=e,i!=null&&e!=null){const r=e.extent;this._samplerData=new $Ge(i,r)}}get zmin(){return this._samplerData!=null?this._samplerData.data.minValue:0}get zmax(){return this._samplerData!=null?this._samplerData.data.maxValue:0}get hasNoDataValues(){var e;return!!((e=this._samplerData)!=null&&e.data.hasNoDataValues)}sample(e,i){if(this._samplerData==null)return;const{safeWidth:r,data:n,dx:o,dy:u,y1:p,x0:g}=this._samplerData,{width:w,values:S,noDataValue:T}=n,E=RH(u*(p-i),0,r),C=RH(o*(e-g),0,r),L=Math.floor(E),R=Math.floor(C),F=L*w+R,V=F+w,U=S[F],W=S[V],H=S[F+1],J=S[V+1];if(U!==T&&W!==T&&H!==T&&J!==T){const X=C-R,te=U+(H-U)*X;return te+(W+(J-W)*X-te)*(E-L)}}};function RH(t,e,i){return t<e?e:t>i?i:t}let TGe=class{async queryAll(e,i,r){if(!(e=r!=null&&r.ignoreInvisibleLayers?e.filter(w=>w.visible):e.slice()).length)throw new re("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const n=zm.fromGeometry(i);let o=!1;r!=null&&r.returnSampleInfo||(o=!0);const u={...O$,...r,returnSampleInfo:!0},p=await this.query(e[e.length-1],n,u),g=await this._queryAllContinue(e,p,u);return g.geometry=g.geometry.export(),o&&delete g.sampleInfo,g}async query(e,i,r){if(!e)throw new re("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||!(i instanceof zm)&&i.type!=="point"&&i.type!=="multipoint"&&i.type!=="polyline")throw new re("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const n={...O$,...r},o=new EGe(e,i.spatialReference,n),u=n.signal;return await e.load({signal:u}),await MGe(o,i,u),await this._selectTiles(o,u),await P$(o,u),PGe(o),RGe(o,u)}async createSampler(e,i,r){if(!e)throw new re("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new re("elevation-query:invalid-extent","Invalid or undefined extent");const n={...O$,...r};return this._createSampler(e,i,n)}async createSamplerAll(e,i,r){if(!(e=r!=null&&r.ignoreInvisibleLayers?e.filter(u=>u.visible):e.slice()).length)throw new re("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new re("elevation-query:invalid-extent","Invalid or undefined extent");const n={...O$,...r,returnSampleInfo:!0},o=await this._createSampler(e[e.length-1],i,n);return this._createSamplerAllContinue(e,i,o,n)}async _createSampler(e,i,r,n){const o=r.signal;await e.load({signal:o});const u=i.spatialReference,p=e.tileInfo.spatialReference;u.equals(p)||(await vh([{source:u,dest:p}],{signal:o}),i=Ts(i,p));const g=new IGe(e,i,r,n);return await this._selectTiles(g,o),await P$(g,o),new PH(g.elevationTiles,g.layer.tileInfo,g.options.noDataValue)}async _createSamplerAllContinue(e,i,r,n){if(e.pop(),!e.length)return r;const o=r.samplers.filter(w=>!w.tile.hasNoDataValues).map(w=>dme(w.extent)),u=await this._createSampler(e[e.length-1],i,n,o);if(u.samplers.length===0)return r;const p=r.samplers.concat(u.samplers),g=new PH(p,n.noDataValue);return this._createSamplerAllContinue(e,i,g,n)}async _queryAllContinue(e,i,r){const n=e.pop(),o=i.geometry.coordinates,u=i.sampleInfo;a0(u);const p=[],g=[];for(let E=0;E<o.length;E++){const C=u[E];C.demResolution>=0?C.source||(C.source=n):e.length&&(p.push(o[E]),g.push(E))}if(!e.length||p.length===0)return i;const w=i.geometry.clone(p),S=await this.query(e[e.length-1],w,r),T=S.sampleInfo;if(!T)throw new Error("no sampleInfo");return g.forEach((E,C)=>{o[E].z=S.geometry.coordinates[C].z,u[E].demResolution=T[C].demResolution}),this._queryAllContinue(e,i,r)}async _selectTiles(e,i){e.type==="geometry"&&kGe(e);const r=e.options.demResolution;if(typeof r=="number")AGe(e,r);else if(r==="finest-contiguous")await this._selectTilesFinestContiguous(e,i);else{if(r!=="auto")throw new re("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${r}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,i)}}async _selectTilesFinestContiguous(e,i){const{tileInfo:r,tilemapCache:n}=e.layer,o=uN(r,n,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,o,i)}async _selectTilesFinestContiguousAt(e,i,r){const n=e.layer;if(e.selectTilesAtLOD(i),i<0)return;const o=n.tilemapCache,u=e.getTilesToFetch();try{if(o&&!T7(o))await zl(Promise.all(u.map(p=>o.fetchAvailability(p.level,p.row,p.col,{signal:r}))),r);else if(await P$(e,r),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new re("elevation-query:has-unavailable-tiles")}catch(p){Ra(p),await this._selectTilesFinestContiguousAt(e,i-1,r)}}async _selectTilesAuto(e,i){LGe(e),OGe(e);const r=e.layer.tilemapCache;if(!r||T7(r))return this._selectTilesAutoPrefetchUpsample(e,i);const n=e.getTilesToFetch(),o={},u=n.map(async p=>{const g=new hR(null,0,0,0,bs()),w=await Z3(r.fetchAvailabilityUpsample(p.level,p.row,p.col,g,{signal:i}));w.ok!==!1?p.id!=null&&(o[p.id]=g):Ra(w.error)});await zl(Promise.all(u),i),e.remapTiles(o)}async _selectTilesAutoPrefetchUpsample(e,i){const r=e.layer.tileInfo;await P$(e,i);let n=!1;e.forEachTileToFetch((o,u)=>{r.upsampleTile(o)?n=!0:u()}),n&&await this._selectTilesAutoPrefetchUpsample(e,i)}},zm=class I5{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const i=new I5;return i.geometry=this.geometry,i.spatialReference=this.spatialReference,i.coordinates=e||this.coordinates.map(r=>r.clone()),i._exporter=this._exporter,i}async project(e,i){if(this.spatialReference.equals(e))return this.clone();await vh([{source:this.spatialReference,dest:e}],{signal:i});const r=new lh({spatialReference:this.spatialReference,points:this.coordinates.map(p=>[p.x,p.y])}),n=Ts(r,e);if(!n)return null;const o=this.coordinates.map((p,g)=>{const w=p.clone(),S=n.points[g];return w.x=S[0],w.y=S[1],w}),u=this.clone(o);return u.spatialReference=e,u}static fromGeometry(e){const i=new I5;if(i.geometry=e,i.spatialReference=e.spatialReference,e instanceof I5)i.coordinates=e.coordinates.map(r=>r.clone()),i._exporter=(r,n)=>{const o=e.clone(r);return o.spatialReference=n,o};else switch(e.type){case"point":{const r=e,{hasZ:n,hasM:o}=r;i.coordinates=n&&o?[new Ya(r.x,r.y,r.z,r.m)]:n?[new Ya(r.x,r.y,r.z)]:o?[new Ya(r.x,r.y,null,r.m)]:[new Ya(r.x,r.y)],i._exporter=(u,p)=>e.hasM?new Ke(u[0].x,u[0].y,u[0].z,u[0].m,p):new Ke(u[0].x,u[0].y,u[0].z,p);break}case"multipoint":{const r=e,{hasZ:n,hasM:o}=r;i.coordinates=n&&o?r.points.map(u=>new Ya(u[0],u[1],u[2],u[3])):n?r.points.map(u=>new Ya(u[0],u[1],u[2])):o?r.points.map(u=>new Ya(u[0],u[1],null,u[2])):r.points.map(u=>new Ya(u[0],u[1])),i._exporter=(u,p)=>e.hasM?new lh({points:u.map(g=>[g.x,g.y,g.z,g.m]),hasZ:!0,hasM:!0,spatialReference:p}):new lh(u.map(g=>[g.x,g.y,g.z]),p);break}case"polyline":{const r=e,n=[],o=[],{hasZ:u,hasM:p}=e;let g=0;for(const w of r.paths)if(o.push([g,g+w.length]),g+=w.length,u&&p)for(const S of w)n.push(new Ya(S[0],S[1],S[2],S[3]));else if(u)for(const S of w)n.push(new Ya(S[0],S[1],S[2]));else if(p)for(const S of w)n.push(new Ya(S[0],S[1],null,S[2]));else for(const S of w)n.push(new Ya(S[0],S[1]));i.coordinates=n,i._exporter=(w,S)=>{const T=e.hasM?w.map(C=>[C.x,C.y,C.z,C.m]):w.map(C=>[C.x,C.y,C.z]),E=o.map(C=>T.slice(C[0],C[1]));return new Bn({paths:E,hasM:e.hasM,hasZ:!0,spatialReference:S})};break}}return i}},Ya=class uue{constructor(e,i,r=null,n=null,o=null,u=null){this.x=e,this.y=i,this.z=r,this.m=n,this.tile=o,this.elevationTile=u}clone(){return new uue(this.x,this.y,this.z,this.m)}},cue=class{constructor(e,i){this.layer=e,this.options=i}},EGe=class extends cue{constructor(e,i,r){super(e,r),this.outSpatialReference=i,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach(i=>i.tile=null);else{const{tileInfo:i,tilemapCache:r}=this.layer,n=z3(i,r)[e].level;this.geometry.coordinates.forEach(o=>o.tile=i.tileAt(n,o.x,o.y))}}allElevationTilesFetched(){return!this.geometry.coordinates.some(e=>!e.elevationTile)}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){var i;for(const r of this.geometry.coordinates)!r.elevationTile&&((i=r.tile)!=null&&i.id)&&(r.elevationTile=e[r.tile.id])}remapTiles(e){var i;for(const r of this.geometry.coordinates){const n=(i=r.tile)==null?void 0:i.id;r.tile=n?e[n]:null}}getTilesToFetch(){var r;const e={},i=[];for(const n of this.geometry.coordinates){const o=n.tile;if(!o)continue;const u=(r=n.tile)==null?void 0:r.id;n.elevationTile||!u||e[u]||(e[u]=o,i.push(o))}return i}forEachTileToFetch(e){for(const i of this.geometry.coordinates)i.tile&&!i.elevationTile&&e(i.tile,()=>{i.tile=null})}},IGe=class extends cue{constructor(e,i,r,n){super(e,r),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=i.clone().intersection(e.fullExtent),this.maskExtents=n}selectTilesAtLOD(e,i){const r=this._maximumLodForRequests(i),n=Math.min(r,e);n<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(n)}_maximumLodForRequests(e){const{tileInfo:i,tilemapCache:r}=this.layer,n=z3(i,r);if(!e)return n.length-1;const o=this.extent;if(o==null)return-1;for(let u=n.length-1;u>=0;u--){const p=n[u],g=p.resolution*i.size[0],w=p.resolution*i.size[1];if(Math.ceil(o.width/g)*Math.ceil(o.height/w)<=e)return u}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const i of this._candidateTiles){const r=i.id&&e[i.id];r&&(this._fetchedCandidates.add(i),this.elevationTiles.push(r))}}remapTiles(e){this._candidateTiles=FH(this._candidateTiles.map(i=>e[i.id]))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,i){const r=this._candidateTiles;this._candidateTiles=[],r.forEach(n=>{if(this._fetchedCandidates.has(n))return void(i&&i(n));let o=!1;e(n,()=>o=!0),o?i&&i(n):this._candidateTiles.push(n)}),this._candidateTiles=FH(this._candidateTiles,i)}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const i=this.extent;if(i==null)return;const{tileInfo:r,tilemapCache:n}=this.layer,o=z3(r,n)[e],u=r.tileAt(o.level,i.xmin,i.ymin),p=u.extent;if(p==null)return;const g=o.resolution*r.size[0],w=o.resolution*r.size[1],S=Math.ceil((i.xmax-p[0])/g),T=Math.ceil((i.ymax-p[1])/w);for(let E=0;E<T;E++)for(let C=0;C<S;C++){const L=new hR(null,u.level,u.row-E,u.col+C);r.updateTileInfo(L),this._tileIsMasked(L)||this._candidateTiles.push(L)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some(i=>e.extent&&OP(i,e.extent))}};function uN(t,e,i=0){const r=z3(t,e);let n=r.length-1;if(i>0){const o=i/hr(t.spatialReference),u=r.findIndex(p=>p.resolution<o);u===0?n=0:u>0&&(n=u-1)}return n}const O$={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};async function MGe(t,e,i){let r;const n=t.layer.tileInfo.spatialReference;if(e instanceof zm?r=await e.project(n,i):(await vh([{source:e.spatialReference,dest:n}],{signal:i}),r=Ts(e,n)),!r)throw new re("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${e.spatialReference.wkid}' on an elevation service in '${n.wkid}'`);t.geometry=zm.fromGeometry(r)}function kGe(t){if(t.layer.fullExtent==null)return;const e=new lue(null);e.sample=()=>t.options.noDataValue,t.outsideExtentTile=e;const i=t.layer.fullExtent;t.geometry.coordinates.forEach(r=>{const n=r.x,o=r.y;(n<i.xmin||n>i.xmax||o<i.ymin||o>i.ymax)&&(r.elevationTile=e)})}function CGe(t,e){const{tileInfo:i,tilemapCache:r}=t.layer,n=e/hr(i.spatialReference),o=z3(i,r);let u=o[0],p=0;for(let g=1;g<o.length;g++){const w=o[g];Math.abs(w.resolution-n)<Math.abs(u.resolution-n)&&(u=w,p=g)}return p}function AGe(t,e){const i=CGe(t,e);t.selectTilesAtLOD(i)}function LGe(t){const{tileInfo:e,tilemapCache:i}=t.layer,r=uN(e,i,t.options.minDemResolution);t.selectTilesAtLOD(r,t.options.maximumAutoTileRequests)}function z3(t,e){const i=t.lods;if(T7(e)){const{effectiveMinLOD:r,effectiveMaxLOD:n}=e;return i.filter(o=>o.level>=r&&o.level<=n)}return i}async function P$(t,e){const i=t.getTilesToFetch(),r={},n=t.options.cache,o=t.options.noDataValue,u=i.map(async p=>{if(p.id==null)return;const g=`${t.layer.uid}:${p.id}:${o}`,w=n!=null?n.get(g):null,S=w??await t.layer.fetchTile(p.level,p.row,p.col,{noDataValue:o,signal:e});n!=null&&n.put(g,S),r[p.id]=new lue(p,S)});await zl(Promise.allSettled(u),e),t.populateElevationTiles(r)}function OGe(t){const e=t.layer.tileInfo;let i=0;const r={},n=p=>{p.id!=null&&(p.id in r?r[p.id]++:(r[p.id]=1,i++))},o=p=>{if(p.id==null)return;const g=r[p.id];g===1?(delete r[p.id],i--):r[p.id]=g-1};t.forEachTileToFetch(n,o);let u=!0;for(;u&&(u=!1,t.forEachTileToFetch(p=>{i<=t.options.maximumAutoTileRequests||(o(p),e.upsampleTile(p)&&(u=!0),n(p))},o),u););}function PGe(t){t.geometry.coordinates.forEach(e=>{const i=e.elevationTile;let r=t.options.noDataValue;if(i){const n=i.sample(e.x,e.y);n!=null?r=n:e.elevationTile=null}e.z=r})}function FH(t,e){const i={},r=[];for(const o of t){const u=o.id;u&&!i[u]?(i[u]=o,r.push(o)):e&&e(o)}const n=r.sort((o,u)=>o.level-u.level);return n.filter((o,u)=>{for(let p=0;p<u;p++){const g=n[p].extent;if(g&&o.extent&&OP(g,o.extent))return e&&e(o),!1}return!0})}async function RGe(t,e){const i=await t.geometry.project(t.outSpatialReference,e);a0(i);const r={geometry:i.export(),noDataValue:t.options.noDataValue};return t.options.returnSampleInfo&&(r.sampleInfo=FGe(t)),t.geometry.coordinates.forEach(n=>{n.tile=null,n.elevationTile=null}),r}function FGe(t){const e=t.layer.tileInfo,i=hr(e.spatialReference);return t.geometry.coordinates.map(r=>{let n=-1;return r.elevationTile&&r.elevationTile!==t.outsideExtentTile&&(n=e.lodAt(r.elevationTile.tile.level).resolution*i),{demResolution:n}})}function T7(t){return(t==null?void 0:t.tileInfo)!=null}const NH=Object.freeze(Object.defineProperty({__proto__:null,ElevationQuery:TGe,GeometryDescriptor:zm,getFinestLodIndex:uN},Symbol.toStringTag,{value:"Module"}));let _p=class extends US{constructor(e){super(e),this.type="input",this.color=new Ce("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=Hu((i,r,n,o,u)=>i?{elevationInfo:i,visibleLayers:r,view:n,stationary:o,spatialReference:u}:null)}get queryElevationDependencies(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e==null?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){var e;return!((e=this._viewModel)!=null&&e.inputIsSketched)}get _elevationInfo(){var i;const e=(i=this._viewModel)==null?void 0:i.input;return e?oF(e):null}get _visibleLayers(){var e,i,r,n;return((n=(r=(i=(e=this._viewModel)==null?void 0:e.view)==null?void 0:i.map)==null?void 0:r.allLayers)==null?void 0:n.filter(o=>o.visible).toArray())??[]}async queryElevation(e,{noDataValue:i,signal:r}){const n=this.queryElevationDependencies;if(n==null)throw new Error("ElevationProfileLineInput: no dependencies");const{view:o,elevationInfo:u,spatialReference:p}=n;if(u.mode==="on-the-ground"&&o.type==="3d"&&p){const g=await zm.fromGeometry(e).project(p,r);if(!g)return{geometry:e,noDataValue:i};const w=o.elevationProvider;return g.coordinates.forEach(S=>{S.z=w.getElevation(S.x,S.y,0,p,"ground")??0}),{geometry:g.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const i=()=>this._onChange();return In([super.attach(e),ce(()=>this.queryElevationDependencies,i),gi(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};m([b({type:Ce,nonNullable:!0})],_p.prototype,"color",void 0),m([b()],_p.prototype,"viewVisualizationEnabled",void 0),m([b()],_p.prototype,"queryElevationDependencies",null),m([b()],_p.prototype,"available",null),m([b()],_p.prototype,"_elevationInfo",null),m([b()],_p.prototype,"_visibleLayers",null),_p=m([G("esri.widgets.ElevationProfile.ElevationProfileLineInput")],_p);const NGe=_p;let wf=class extends US{constructor(e){super(e),this.type="query",this.color=new Ce("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return rue(this.source)}get available(){const e=this.source;return!!e&&(e.visible==null||e.visible)&&(e.layers==null||e.layers.some(i=>i.visible))}queryElevation(e,i){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,i)}attach(e){return In([super.attach(e),ce(()=>this.source,()=>this._onChange(),$s)])}};m([b({type:Ce,nonNullable:!0})],wf.prototype,"color",void 0),m([b()],wf.prototype,"viewVisualizationEnabled",void 0),m([b()],wf.prototype,"source",void 0),m([b({readOnly:!0})],wf.prototype,"minDemResolution",null),m([b()],wf.prototype,"available",null),wf=m([G("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],wf);const DGe=wf,jGe="OBJECTID";let yr=class extends Te{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};m([b()],yr.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),m([b()],yr.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),m([b()],yr.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),m([b()],yr.prototype,"DECONFLICTOR_SHOW_GRID",void 0),m([b()],yr.prototype,"LABELS_SHOW_BORDER",void 0),m([b()],yr.prototype,"TEXT_SHOW_BASELINE",void 0),m([b()],yr.prototype,"TEXT_SHOW_BORDER",void 0),m([b()],yr.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),m([b()],yr.prototype,"OVERLAY_SHOW_CENTER",void 0),m([b()],yr.prototype,"SHOW_POI",void 0),m([b()],yr.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),m([b()],yr.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),m([b()],yr.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),m([b()],yr.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),m([b()],yr.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),m([b()],yr.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),m([b()],yr.prototype,"I3S_TREE_SHOW_TILES",void 0),m([b()],yr.prototype,"I3S_SHOW_MODIFICATIONS",void 0),m([b()],yr.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),m([b()],yr.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),m([b()],yr.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),m([b()],yr.prototype,"LINE_WIREFRAMES",void 0),yr=m([G("esri.views.3d.support.debugFlags")],yr);const tot=new yr;var To,Lb;(function(t){t[t.OBJECT=0]="OBJECT",t[t.HUD=1]="HUD",t[t.TERRAIN=2]="TERRAIN",t[t.OVERLAY=3]="OVERLAY",t[t.I3S=4]="I3S",t[t.PCL=5]="PCL",t[t.LOD=6]="LOD",t[t.VOXEL=7]="VOXEL",t[t.TILES3D=8]="TILES3D"})(To||(To={}));let VGe=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=Lb.ALL,this.normalRequired=!0}};(function(t){t[t.MIN=0]="MIN",t[t.MINMAX=1]="MINMAX",t[t.ALL=2]="ALL"})(Lb||(Lb={}));let zGe=class{constructor(e,i,r){this.object=e,this.geometryId=i,this.triangleNr=r}};class UGe extends zGe{constructor(e,i,r,n){super(e,i,r),this.center=n!=null?xs(n):null}}let GGe=class{constructor(e){this.layerUid=e}},hue=class extends GGe{constructor(e,i){super(e),this.graphicUid=i}};function GS(t){return t?{origin:xs(t.origin),vector:xs(t.vector)}:{origin:be(),vector:be()}}function BGe(t,e){const i=WGe.get();return i.origin=t,i.vector=e,i}function oot(t,e=GS()){return qGe(t.origin,t.vector,e)}function qGe(t,e,i=GS()){return ki(i.origin,t),ki(i.vector,e),i}function aot(t,e,i=GS()){return ki(i.origin,t),Xi(i.vector,e,t),i}function HGe(t,e){const i=Xi(pt.get(),e,t.origin),r=Ft(t.vector,i),n=Ft(t.vector,t.vector),o=An(r/n,0,1),u=Xi(pt.get(),Mi(pt.get(),t.vector,o),i);return Ft(u,u)}function lot(t,e,i){return E7(t,e,0,1,i)}function uot(t,e,i){return nr(i,t.origin,Mi(i,t.vector,e))}function E7(t,e,i,r,n){const{vector:o,origin:u}=t,p=Xi(pt.get(),e,u),g=Ft(o,p)/Am(o);return Mi(n,o,An(g,i,r)),nr(n,n,t.origin)}function cot(t,e){if(pue(t,BGe(e.origin,e.direction),!1,bI)){const{tA:i,pB:r,distance2:n}=bI;if(i>=0&&i<=1)return n;if(i<0)return ph(t.origin,r);if(i>1)return ph(nr(pt.get(),t.origin,t.vector),r)}return null}function hot(t,e,i){return!!pue(t,e,!0,bI)&&(ki(i,bI.pA),!0)}function pue(t,e,i,r){const o=t.origin,u=nr(pt.get(),o,t.vector),p=e.origin,g=nr(pt.get(),p,e.vector),w=pt.get(),S=pt.get();if(w[0]=o[0]-p[0],w[1]=o[1]-p[1],w[2]=o[2]-p[2],S[0]=g[0]-p[0],S[1]=g[1]-p[1],S[2]=g[2]-p[2],Math.abs(S[0])<1e-6&&Math.abs(S[1])<1e-6&&Math.abs(S[2])<1e-6)return!1;const T=pt.get();if(T[0]=u[0]-o[0],T[1]=u[1]-o[1],T[2]=u[2]-o[2],Math.abs(T[0])<1e-6&&Math.abs(T[1])<1e-6&&Math.abs(T[2])<1e-6)return!1;const E=w[0]*S[0]+w[1]*S[1]+w[2]*S[2],C=S[0]*T[0]+S[1]*T[1]+S[2]*T[2],L=w[0]*T[0]+w[1]*T[1]+w[2]*T[2],R=S[0]*S[0]+S[1]*S[1]+S[2]*S[2],F=(T[0]*T[0]+T[1]*T[1]+T[2]*T[2])*R-C*C;if(Math.abs(F)<1e-6)return!1;let V=(E*C-L*R)/F,U=(E+C*V)/R;i&&(V=An(V,0,1),U=An(U,0,1));const W=pt.get(),H=pt.get();return W[0]=o[0]+V*T[0],W[1]=o[1]+V*T[1],W[2]=o[2]+V*T[2],H[0]=p[0]+U*S[0],H[1]=p[1]+U*S[1],H[2]=p[2]+U*S[2],r.tA=V,r.tB=U,r.pA=W,r.pB=H,r.distance2=ph(W,H),!0}const bI={tA:0,tB:0,pA:be(),pB:be(),distance2:0},WGe=new RS(()=>GS()),y4=()=>fe.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let JGe=class{constructor(){this.plane=us(),this.origin=be(),this.basis1=be(),this.basis2=be()}};const ZGe=JGe;function BS(t=Sue){return{plane:us(t.plane),origin:xs(t.origin),basis1:xs(t.basis1),basis2:xs(t.basis2)}}function KGe(t,e,i){const r=hBe.get();return r.origin=t,r.basis1=e,r.basis2=i,r.plane=dPe(0,0,0,0),i9(r),r}function t9(t,e=BS()){return due(t.origin,t.basis1,t.basis2,e)}function YGe(t,e){ki(e.origin,t.origin),ki(e.basis1,t.basis1),ki(e.basis2,t.basis2),Yse(e.plane,t.plane)}function due(t,e,i,r=BS()){return ki(r.origin,t),ki(r.basis1,e),ki(r.basis2,i),i9(r),uBe(r,"fromValues()"),r}function i9(t){RO(t.basis2,t.basis1,t.origin,t.plane)}function fue(t,e,i){t!==i&&t9(t,i);const r=Mi(pt.get(),Qp(t),e);return nr(i.origin,i.origin,r),i.plane[3]-=e,i}function XGe(t,e,i){return yue(e,i),fue(i,pN(t,t.origin),i),i}function yue(t,e=BS()){const i=(t[2]-t[0])/2,r=(t[3]-t[1])/2;return Qt(e.origin,t[0]+i,t[1]+r,0),Qt(e.basis1,i,0,0),Qt(e.basis2,0,r,0),hF(0,0,1,0,e.plane),e}function cN(t,e,i){return!!mPe(t.plane,e,i)&&wue(t,i)}function QGe(t,e,i){if(cN(t,e,i))return i;const r=mue(t,e,pt.get());return nr(i,e.origin,Mi(pt.get(),e.direction,Gm(e.origin,r)/cr(e.direction))),i}function mue(t,e,i){const r=wI.get();_ue(t,e,r,wI.get());let n=Number.POSITIVE_INFINITY;for(const o of fN){const u=dN(t,o,r9.get()),p=pt.get();if(gPe(r,u,p)){const g=zZ(pt.get(),e.origin,p),w=Math.abs(MP(Ft(e.direction,g)));w<n&&(n=w,ki(i,p))}}return n===Number.POSITIVE_INFINITY?gue(t,e,i):i}function gue(t,e,i){if(cN(t,e,i))return i;const r=wI.get(),n=wI.get();_ue(t,e,r,n);let o=Number.POSITIVE_INFINITY;for(const u of fN){const p=dN(t,u,r9.get()),g=pt.get();if(vPe(r,p,g)){const w=xPe(e,g);if(!pF(n,g))continue;w<o&&(o=w,ki(i,g))}}return hN(t,e.origin)<o&&vue(t,e.origin,i),i}function vue(t,e,i){const r=dF(t.plane,e,pt.get()),n=E7(DH(t,t.basis1),r,-1,1,pt.get()),o=E7(DH(t,t.basis2),r,-1,1,pt.get());return Xi(i,nr(pt.get(),n,o),t.origin),i}function bue(t,e,i){const{origin:r,basis1:n,basis2:o}=t,u=Xi(pt.get(),e,r),p=gm(n,u),g=gm(o,u),w=gm(Qp(t),u);return Qt(i,p,g,w)}function hN(t,e){const i=bue(t,e,pt.get()),{basis1:r,basis2:n}=t,o=cr(r),u=cr(n),p=Math.max(Math.abs(i[0])-o,0),g=Math.max(Math.abs(i[1])-u,0),w=i[2];return p*p+g*g+w*w}function eBe(t,e){return Math.sqrt(hN(t,e))}function tBe(t,e){let i=Number.NEGATIVE_INFINITY;for(const r of fN){const n=dN(t,r,r9.get()),o=HGe(n,e);o>i&&(i=o)}return Math.sqrt(i)}function iBe(t,e){return pF(t.plane,e)&&wue(t,e)}function rBe(t,e,i,r){return lBe(t,i,r)}function pN(t,e){const i=-t.plane[3];return gm(Qp(t),e)-i}function nBe(t,e,i,r){const n=pN(t,e),o=Mi(cBe,Qp(t),i-n);return nr(r,e,o),r}function sBe(t,e){return Si(t.basis1,e.basis1)&&Si(t.basis2,e.basis2)&&Si(t.origin,e.origin)}function oBe(t,e,i){return t!==i&&t9(t,i),GI(Gg,e),Bl(Gg,Gg),Ll(i.basis1,t.basis1,Gg),Ll(i.basis2,t.basis2,Gg),Ll(i.plane,t.plane,Gg),Ll(i.origin,t.origin,e),yPe(i.plane,i.plane,i.origin),i}function aBe(t,e,i,r){return t!==r&&t9(t,r),LP(m4,e,i),Ll(r.basis1,t.basis1,m4),Ll(r.basis2,t.basis2,m4),i9(r),r}function Qp(t){return t.plane}function lBe(t,e,i){switch(e){case Ju.X:ki(i,t.basis1),ta(i,i);break;case Ju.Y:ki(i,t.basis2),ta(i,i);break;case Ju.Z:ki(i,Qp(t))}return i}function wue(t,e){const i=Xi(pt.get(),e,t.origin),r=Am(t.basis1),n=Am(t.basis2),o=Ft(t.basis1,i),u=Ft(t.basis2,i);return-o-r<0&&o-r<0&&-u-n<0&&u-n<0}function DH(t,e){const i=r9.get();return ki(i.origin,t.origin),ki(i.vector,e),i}function dN(t,e,i){const{basis1:r,basis2:n,origin:o}=t,u=Mi(pt.get(),r,e.origin[0]),p=Mi(pt.get(),n,e.origin[1]);nr(i.origin,u,p),nr(i.origin,i.origin,o);const g=Mi(pt.get(),r,e.direction[0]),w=Mi(pt.get(),n,e.direction[1]);return Mi(i.vector,nr(g,g,w),2),i}function uBe(t,e){Math.abs(Ft(t.basis1,t.basis2)/(cr(t.basis1)*cr(t.basis2)))>1e-6&&y4().warn(e,"Provided basis vectors are not perpendicular"),Math.abs(Ft(t.basis1,Qp(t)))>1e-6&&y4().warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Ft(Qp(t),t.origin)-t.plane[3])>1e-6&&y4().warn(e,"Plane offset is not consistent with plane origin")}function _ue(t,e,i,r){const n=Qp(t);RO(n,e.direction,e.origin,i),RO(i,n,e.origin,r)}const Sue={plane:us(),origin:un(0,0,0),basis1:un(1,0,0),basis2:un(0,1,0)},wI=new RS(us),r9=new RS(GS),cBe=be(),hBe=new RS(()=>BS()),fN=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Gg=Bu(),m4=Bu();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:ZGe,altitudeAt:pN,axisAt:rBe,closestPoint:gue,closestPointOnSilhouette:mue,copy:t9,copyWithoutVerify:YGe,create:BS,distance:eBe,distance2:hN,distanceToSilhouette:tBe,elevate:fue,equals:sBe,extrusionContainsPoint:iBe,fromAABoundingRect:yue,fromValues:due,intersectRay:cN,intersectRayClosestSilhouette:QGe,normal:Qp,projectPoint:vue,projectPointLocal:bue,rotate:aBe,setAltitudeAt:nBe,setExtent:XGe,transform:oBe,up:Sue,updateUnboundedPlane:i9,wrap:KGe},Symbol.toStringTag,{value:"Module"}));function ud(t){return(t==null?void 0:t.dist)!=null}function pBe(t){return ud(t)&&t.intersector===To.OBJECT&&!!t.target}function dBe(t){return ud(t)&&t.intersector===To.HUD&&!!t.target&&"center"in t.target&&t.target.center!=null}function fBe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function xue(t,e,i){i*=.5;const r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t}function yBe(t,e){const i=2*Math.acos(e[3]),r=Math.sin(i/2);return r>kr()?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),i}function yN(t,e,i){const r=e[0],n=e[1],o=e[2],u=e[3],p=i[0],g=i[1],w=i[2],S=i[3];return t[0]=r*S+u*p+n*w-o*g,t[1]=n*S+u*g+o*p-r*w,t[2]=o*S+u*w+r*g-n*p,t[3]=u*S-r*p-n*g-o*w,t}function mBe(t,e,i){i*=.5;const r=e[0],n=e[1],o=e[2],u=e[3],p=Math.sin(i),g=Math.cos(i);return t[0]=r*g+u*p,t[1]=n*g+o*p,t[2]=o*g-n*p,t[3]=u*g-r*p,t}function gBe(t,e,i){i*=.5;const r=e[0],n=e[1],o=e[2],u=e[3],p=Math.sin(i),g=Math.cos(i);return t[0]=r*g-o*p,t[1]=n*g+u*p,t[2]=o*g+r*p,t[3]=u*g-n*p,t}function vBe(t,e,i){i*=.5;const r=e[0],n=e[1],o=e[2],u=e[3],p=Math.sin(i),g=Math.cos(i);return t[0]=r*g+n*p,t[1]=n*g-r*p,t[2]=o*g+u*p,t[3]=u*g-o*p,t}function bBe(t,e){const i=e[0],r=e[1],n=e[2];return t[0]=i,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),t}function M5(t,e,i,r){const n=e[0],o=e[1],u=e[2],p=e[3];let g,w,S,T,E,C=i[0],L=i[1],R=i[2],F=i[3];return w=n*C+o*L+u*R+p*F,w<0&&(w=-w,C=-C,L=-L,R=-R,F=-F),1-w>kr()?(g=Math.acos(w),S=Math.sin(g),T=Math.sin((1-r)*g)/S,E=Math.sin(r*g)/S):(T=1-r,E=r),t[0]=T*n+E*C,t[1]=T*o+E*L,t[2]=T*u+E*R,t[3]=T*p+E*F,t}function wBe(t){const e=eS,i=e(),r=e(),n=e(),o=Math.sqrt(1-i),u=Math.sqrt(i);return t[0]=o*Math.sin(2*Math.PI*r),t[1]=o*Math.cos(2*Math.PI*r),t[2]=u*Math.sin(2*Math.PI*n),t[3]=u*Math.cos(2*Math.PI*n),t}function _Be(t,e){const i=e[0],r=e[1],n=e[2],o=e[3],u=i*i+r*r+n*n+o*o,p=u?1/u:0;return t[0]=-i*p,t[1]=-r*p,t[2]=-n*p,t[3]=o*p,t}function bm(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function $ue(t,e){const i=e[0]+e[4]+e[8];let r;if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,u=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*u+u]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+u]-e[3*u+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[u]=(e[3*u+n]+e[3*n+u])*r}return t}function SBe(t,e,i,r){const n=.5*Math.PI/180;e*=n,i*=n,r*=n;const o=Math.sin(e),u=Math.cos(e),p=Math.sin(i),g=Math.cos(i),w=Math.sin(r),S=Math.cos(r);return t[0]=o*g*S-u*p*w,t[1]=u*p*S+o*g*w,t[2]=u*g*w-o*p*S,t[3]=u*g*S+o*p*w,t}function xBe(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const $Be=v3,Tue=T8,TBe=NQ,EBe=yN,IBe=zQ,MBe=M8,kBe=k8,Eue=E8,CBe=Eue,Iue=I8,ABe=Iue,mN=BQ,LBe=qQ,OBe=aM;function PBe(t,e,i){const r=Ft(e,i);return r<-.999999?(Ko(pc,RBe,e),UZ(pc)<1e-6&&Ko(pc,FBe,e),ta(pc,pc),xue(t,pc,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ko(pc,e,i),t[0]=pc[0],t[1]=pc[1],t[2]=pc[2],t[3]=1+r,mN(t,t))}const pc=be(),RBe=un(1,0,0),FBe=un(0,1,0);function NBe(t,e,i,r,n,o){return M5(jH,e,n,o),M5(VH,i,r,o),M5(t,jH,VH,2*o*(1-o)),t}const jH=ad(),VH=ad();function DBe(t,e,i,r){const n=jBe;return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=r[0],n[4]=r[1],n[7]=r[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],mN(t,$ue(t,n))}const jBe=aw();Object.freeze(Object.defineProperty({__proto__:null,add:TBe,calculateW:bBe,conjugate:bm,copy:$Be,dot:MBe,equals:OBe,exactEquals:LBe,fromEuler:SBe,fromMat3:$ue,getAxisAngle:yBe,identity:fBe,invert:_Be,len:CBe,length:Eue,lerp:kBe,mul:EBe,multiply:yN,normalize:mN,random:wBe,rotateX:mBe,rotateY:gBe,rotateZ:vBe,rotationTo:PBe,scale:IBe,set:Tue,setAxes:DBe,setAxisAngle:xue,slerp:M5,sqlerp:NBe,sqrLen:ABe,squaredLength:Iue,str:xBe},Symbol.toStringTag,{value:"Module"}));const VBe=new Ge(tZ),d2=new Ge(LI),f2=new Ge(OI),dot=new Ge(iZ);function U3(t){const e=zH.get(t);if(e)return e;let i=VBe;if(t)if(t===d2)i=d2;else if(t===f2)i=f2;else{const r=t.wkid,n=t.latestWkid;if(r!=null||n!=null)nb(r)||nb(n)?i=d2:(sb(r)||sb(n))&&(i=f2);else{const o=t.wkt2??t.wkt;if(o){const u=o.toUpperCase();u===zBe?i=d2:u===UBe&&(i=f2)}}}return zH.set(t,i),i}const zH=new Map,zBe=d2.wkt.toUpperCase(),UBe=f2.wkt.toUpperCase();function Mue(t,e,i){const r=Math.sin(t),n=Math.cos(t),o=Math.sin(e),u=Math.cos(e),p=i;return p[0]=-r,p[4]=-o*n,p[8]=u*n,p[12]=0,p[1]=n,p[5]=-o*r,p[9]=u*r,p[13]=0,p[2]=0,p[6]=u,p[10]=o,p[14]=0,p[3]=0,p[7]=0,p[11]=0,p[15]=1,p}function GBe(t,e,i){return Mue(t,e,i),Bl(i,i),i}function BBe(t,e,i,r){if(t==null||r==null)return!1;const n=EE(t,j$e),o=EE(r,V$e);if(n===o&&!UH(o)&&(n!==ue.UNKNOWN||Ki(t,r)))return KZ(i,e),!0;if(UH(o)){const u=N_[n][ue.LON_LAT],p=N_[ue.LON_LAT][o];return u!=null&&p!=null&&(u(e,0,$d,0),p($d,0,Td,0),Mue(R$*$d[0],R$*$d[1],i),i[12]=Td[0],i[13]=Td[1],i[14]=Td[2],!0)}if(!(o!==ue.WEB_MERCATOR&&o!==ue.PLATE_CARREE&&o!==ue.WGS84&&o!==ue.CGCS2000||n!==ue.WGS84&&n!==ue.SPHERICAL_ECEF&&n!==ue.WEB_MERCATOR&&n!==ue.CGCS2000)){const u=N_[n][ue.LON_LAT],p=N_[ue.LON_LAT][o];return u!=null&&p!=null&&(u(e,0,$d,0),p($d,0,Td,0),n===ue.SPHERICAL_ECEF?GBe(R$*$d[0],R$*$d[1],i):iS(i),i[12]=Td[0],i[13]=Td[1],i[14]=Td[2],!0)}return!1}function UH(t){return t===ue.SPHERICAL_ECEF||t===ue.SPHERICAL_MARS_PCPF||t===ue.SPHERICAL_MOON_PCPF}const R$=tS(1),$d=be(),Td=be();let gN=class{constructor(e,i,r=i){this.data=e,this.size=i,this.stride=r}};class yot extends gN{constructor(e,i,r,n=!1,o=r){super(e,r,o),this.indices=i,this.exclusive=n}}const Ob=1e-6,qw=be(),F$=be();function qBe(t,e){const{data:i,size:r}=t,n=i.length/r;if(n<=0)return;const o=new tqe(t);M7(qw,o.minProj,o.maxProj),y2(qw,qw,.5),El(F$,o.maxProj,o.minProj);const u=I7(F$),p=new iqe;p.quality=u,n<14&&(t=new gN(new Float64Array(o.buffer,112,42),3));const g=be(),w=be(),S=be(),T=be(),E=be(),C=be(),L=be();switch(HBe(o,t,L,g,w,S,T,E,C,p)){case 1:return void HH(qw,F$,e);case 2:return void QBe(t,T,e)}WBe(t,L,g,w,S,T,E,C,p),kue(t,p.b0,p.b1,p.b2,Zv,Kv);const R=be();El(R,Kv,Zv),p.quality=I7(R),p.quality<u?Cue(p.b0,p.b1,p.b2,Zv,Kv,R,e):HH(qw,F$,e)}function HBe(t,e,i,r,n,o,u,p,g,w){return JBe(t,r,n),k7(r,n)<Ob?1:(El(u,r,n),is(u,u),ZBe(e,r,u,o)<Ob?2:(El(p,n,o),is(p,p),El(g,o,r),is(g,g),Il(i,p,u),is(i,i),jy(e,i,u,p,g,w),0))}const Hw=be(),Ww=be(),Xa=be(),Qa=be(),el=be(),Ed=be(),Id=be(),Md=be();function WBe(t,e,i,r,n,o,u,p,g){KBe(t,e,i,Hw,Ww),Hw[0]!==void 0&&(El(Xa,Hw,i),is(Xa,Xa),El(Qa,Hw,r),is(Qa,Qa),El(el,Hw,n),is(el,el),Il(Ed,Qa,o),is(Ed,Ed),Il(Id,el,u),is(Id,Id),Il(Md,Xa,p),is(Md,Md),jy(t,Ed,o,Qa,Xa,g),jy(t,Id,u,el,Qa,g),jy(t,Md,p,Xa,el,g)),Ww[0]!==void 0&&(El(Xa,Ww,i),is(Xa,Xa),El(Qa,Ww,r),is(Qa,Qa),El(el,Ww,n),is(el,el),Il(Ed,Qa,o),is(Ed,Ed),Il(Id,el,u),is(Id,Id),Il(Md,Xa,p),is(Md,Md),jy(t,Ed,o,Qa,Xa,g),jy(t,Id,u,el,Qa,g),jy(t,Md,p,Xa,el,g))}function JBe(t,e,i){let r=k7(t.maxVert[0],t.minVert[0]),n=0;for(let o=1;o<7;++o){const u=k7(t.maxVert[o],t.minVert[o]);u>r&&(r=u,n=o)}Na(e,t.minVert[n]),Na(i,t.maxVert[n])}const tl=[0,0,0];function ZBe(t,e,i,r){const{data:n,size:o}=t;let u=Number.NEGATIVE_INFINITY,p=0;for(let g=0;g<n.length;g+=o){tl[0]=n[g]-e[0],tl[1]=n[g+1]-e[1],tl[2]=n[g+2]-e[2];const w=i[0]*tl[0]+i[1]*tl[1]+i[2]*tl[2],S=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],T=tl[0]*tl[0]+tl[1]*tl[1]+tl[2]*tl[2]-w*w/S;T>u&&(u=T,p=g)}return Na(r,n,p),u}const on=Nt();function KBe(t,e,i,r,n){XBe(t,e,on,n,r);const o=Lue(i,e);on[1]-Ob<=o&&(r[0]=void 0),on[0]+Ob>=o&&(n[0]=void 0)}const GH=be(),BH=be(),qH=be(),Bg=be(),qg=be(),N$=be();function jy(t,e,i,r,n,o){if(Aue(e)<Ob)return;Il(GH,i,e),Il(BH,r,e),Il(qH,n,e),Jv(t,e,on),qg[1]=on[0],Bg[1]=on[1],N$[1]=Bg[1]-qg[1];const u=[i,r,n],p=[GH,BH,qH];for(let g=0;g<3;++g){Jv(t,u[g],on),qg[0]=on[0],Bg[0]=on[1],Jv(t,p[g],on),qg[2]=on[0],Bg[2]=on[1],N$[0]=Bg[0]-qg[0],N$[2]=Bg[2]-qg[2];const w=I7(N$);w<o.quality&&(Na(o.b0,u[g]),Na(o.b1,e),Na(o.b2,p[g]),o.quality=w)}}const YBe=be();function Jv(t,e,i){const{data:r,size:n}=t;i[0]=Number.POSITIVE_INFINITY,i[1]=Number.NEGATIVE_INFINITY;for(let o=0;o<r.length;o+=n){const u=r[o]*e[0]+r[o+1]*e[1]+r[o+2]*e[2];i[0]=Math.min(i[0],u),i[1]=Math.max(i[1],u)}}function XBe(t,e,i,r,n){const{data:o,size:u}=t;Na(r,o),Na(n,r),i[0]=Lue(YBe,e),i[1]=i[0];for(let p=u;p<o.length;p+=u){const g=o[p]*e[0]+o[p+1]*e[1]+o[p+2]*e[2];g<i[0]&&(i[0]=g,Na(r,o,p)),g>i[1]&&(i[1]=g,Na(n,o,p))}}function HH(t,e,i){i.center=t,i.halfSize=Mi(e,e,.5),i.quaternion=uF}const jh=be(),Hg=be(),Jw=be(),Zv=be(),Kv=be(),WH=be();function QBe(t,e,i){Na(jh,e),Math.abs(e[0])>Math.abs(e[1])&&Math.abs(e[0])>Math.abs(e[2])?jh[0]=0:Math.abs(e[1])>Math.abs(e[2])?jh[1]=0:jh[2]=0,Aue(jh)<Ob&&(jh[0]=jh[1]=jh[2]=1),Il(Hg,e,jh),is(Hg,Hg),Il(Jw,e,Hg),is(Jw,Jw),kue(t,e,Hg,Jw,Zv,Kv),El(WH,Kv,Zv),Cue(e,Hg,Jw,Zv,Kv,WH,i)}function kue(t,e,i,r,n,o){Jv(t,e,on),n[0]=on[0],o[0]=on[1],Jv(t,i,on),n[1]=on[0],o[1]=on[1],Jv(t,r,on),n[2]=on[0],o[2]=on[1]}const N0=be(),Zw=be(),D$=be(),dc=Kse(1,0,0,0,1,0,0,0,1),eqe=ad();function Cue(t,e,i,r,n,o,u){dc[0]=t[0],dc[1]=t[1],dc[2]=t[2],dc[3]=e[0],dc[4]=e[1],dc[5]=e[2],dc[6]=i[0],dc[7]=i[1],dc[8]=i[2],u.quaternion=rqe(eqe,dc),M7(N0,r,n),y2(N0,N0,.5),y2(Zw,t,N0[0]),y2(D$,e,N0[1]),M7(Zw,Zw,D$),y2(D$,i,N0[2]),u.center=nr(Zw,Zw,D$),u.halfSize=Mi(N0,o,.5)}const ha=7;let tqe=class{constructor(e){this.minVert=new Array(ha),this.maxVert=new Array(ha);const i=64*ha;this.buffer=new ArrayBuffer(i);let r=0;this.minProj=new Float64Array(this.buffer,r,ha),r+=8*ha,this.maxProj=new Float64Array(this.buffer,r,ha),r+=8*ha;for(let g=0;g<ha;++g)this.minVert[g]=new Float64Array(this.buffer,r,3),r+=24;for(let g=0;g<ha;++g)this.maxVert[g]=new Float64Array(this.buffer,r,3),r+=24;for(let g=0;g<ha;++g)this.minProj[g]=Number.POSITIVE_INFINITY,this.maxProj[g]=Number.NEGATIVE_INFINITY;const n=new Array(ha),o=new Array(ha),{data:u,size:p}=e;for(let g=0;g<u.length;g+=p){let w=u[g];w<this.minProj[0]&&(this.minProj[0]=w,n[0]=g),w>this.maxProj[0]&&(this.maxProj[0]=w,o[0]=g),w=u[g+1],w<this.minProj[1]&&(this.minProj[1]=w,n[1]=g),w>this.maxProj[1]&&(this.maxProj[1]=w,o[1]=g),w=u[g+2],w<this.minProj[2]&&(this.minProj[2]=w,n[2]=g),w>this.maxProj[2]&&(this.maxProj[2]=w,o[2]=g),w=u[g]+u[g+1]+u[g+2],w<this.minProj[3]&&(this.minProj[3]=w,n[3]=g),w>this.maxProj[3]&&(this.maxProj[3]=w,o[3]=g),w=u[g]+u[g+1]-u[g+2],w<this.minProj[4]&&(this.minProj[4]=w,n[4]=g),w>this.maxProj[4]&&(this.maxProj[4]=w,o[4]=g),w=u[g]-u[g+1]+u[g+2],w<this.minProj[5]&&(this.minProj[5]=w,n[5]=g),w>this.maxProj[5]&&(this.maxProj[5]=w,o[5]=g),w=u[g]-u[g+1]-u[g+2],w<this.minProj[6]&&(this.minProj[6]=w,n[6]=g),w>this.maxProj[6]&&(this.maxProj[6]=w,o[6]=g)}for(let g=0;g<ha;++g){let w=n[g];Na(this.minVert[g],u,w),w=o[g],Na(this.maxVert[g],u,w)}}},iqe=class{constructor(){this.b0=un(1,0,0),this.b1=un(0,1,0),this.b2=un(0,0,1),this.quality=0}};function I7(t){return t[0]*t[1]+t[0]*t[2]+t[1]*t[2]}function M7(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2]}function El(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2]}function y2(t,e,i){t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}function Na(t,e,i=0){t[0]=e[i],t[1]=e[i+1],t[2]=e[i+2]}function Il(t,e,i){const r=e[0],n=e[1],o=e[2],u=i[0],p=i[1],g=i[2];t[0]=n*g-o*p,t[1]=o*u-r*g,t[2]=r*p-n*u}function is(t,e){const i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(i>0){const r=1/Math.sqrt(i);t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r}}function Aue(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function k7(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n}function Lue(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function rqe(t,e){const i=e[0]+e[4]+e[8];if(i>0){let r=Math.sqrt(i+1);t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r}else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const n=(r+1)%3,o=(r+2)%3;let u=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*o+o]+1);t[r]=.5*u,u=.5/u,t[3]=(e[3*n+o]-e[3*o+n])*u,t[n]=(e[3*n+r]+e[3*r+n])*u,t[o]=(e[3*o+r]+e[3*r+o])*u}return t}let Oue=class k5{constructor(e=OZ,i=fqe,r=uF){this._data=[e[0],e[1],e[2],i[0],i[1],i[2],r[0],r[1],r[2],r[3]]}clone(){const e=new k5;return e._data=this._data.slice(),e}invalidate(){this._data[3]=-1}get isValid(){return this._data[3]>=0}static fromData(e){const i=new k5;return i._data=e.slice(),i}static fromJSON(e){return new k5(e.center,e.halfSize,e.quaternion)}copy(e){this._data=e.data.slice()}get center(){return Qt(pt.get(),this._data[0],this._data[1],this._data[2])}get centerX(){return this._data[0]}get centerY(){return this._data[1]}get centerZ(){return this._data[2]}getCenter(e){return e[0]=this._data[0],e[1]=this._data[1],e[2]=this._data[2],e}set center(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2]}setCenter(e,i,r){this._data[0]=e,this._data[1]=i,this._data[2]=r}get halfSize(){return Qt(pt.get(),this._data[3],this._data[4],this._data[5])}get halfSizeX(){return this._data[3]}get halfSizeY(){return this._data[4]}get halfSizeZ(){return this._data[5]}getHalfSize(e){return e[0]=this._data[3],e[1]=this._data[4],e[2]=this._data[5],e}set halfSize(e){this._data[3]=e[0],this._data[4]=e[1],this._data[5]=e[2]}get quaternion(){return Tue(pPe.get(),this._data[6],this._data[7],this._data[8],this._data[9])}getQuaternion(e){return e[0]=this._data[6],e[1]=this._data[7],e[2]=this._data[8],e[3]=this._data[9],e}set quaternion(e){this._data[6]=e[0],this._data[7]=e[1],this._data[8]=e[2],this._data[9]=e[3]}get data(){return this._data}getCorners(e){const i=Ni,r=this._data;i[0]=r[6],i[1]=r[7],i[2]=r[8],i[3]=r[9];for(let n=0;n<8;++n){const o=e[n];o[0]=(1&n?-1:1)*r[3],o[1]=(2&n?-1:1)*r[4],o[2]=(4&n?-1:1)*r[5],Pa(o,o,i),o[0]+=r[0],o[1]+=r[1],o[2]+=r[2]}}doesIntersectFrustumConservativeApproximation(e){return this.intersectPlane(e[0])<=0&&this.intersectPlane(e[1])<=0&&this.intersectPlane(e[2])<=0&&this.intersectPlane(e[3])<=0&&this.intersectPlane(e[4])<=0&&this.intersectPlane(e[5])<=0}get radius(){const e=this._data[3],i=this._data[4],r=this._data[5];return Math.sqrt(e*e+i*i+r*r)}intersectSphere(e){mt[0]=this._data[0]-e[0],mt[1]=this._data[1]-e[1],mt[2]=this._data[2]-e[2];const i=this.getQuaternion(Op);return bm(Ni,i),Pa(mt,mt,Ni),lb(mt,mt),Vh[0]=Math.min(mt[0],this._data[3]),Vh[1]=Math.min(mt[1],this._data[4]),Vh[2]=Math.min(mt[2],this._data[5]),aC(Vh,mt)<e[3]*e[3]}intersectSphereWithMBS(e,i=this.radius){const r=this._data;mt[0]=r[0]-e[0],mt[1]=r[1]-e[1],mt[2]=r[2]-e[2];const n=e[3],o=n+i;return!(a3(mt)>o*o)&&(Ni[0]=-r[6],Ni[1]=-r[7],Ni[2]=-r[8],Ni[3]=r[9],Pa(mt,mt,Ni),lb(mt,mt),Vh[0]=Math.min(mt[0],r[3]),Vh[1]=Math.min(mt[1],r[4]),Vh[2]=Math.min(mt[2],r[5]),aC(Vh,mt)<n*n)}intersectPlane(e){const i=e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3],r=this.projectedRadius(e);return i>r?1:i<-r?-1:0}intersectRay(e,i,r=0){const n=this._data,o=Ni;o[0]=-n[6],o[1]=-n[7],o[2]=-n[8],o[3]=n[9],mt[0]=e[0]-n[0],mt[1]=e[1]-n[1],mt[2]=e[2]-n[2];const u=Pa(mt,mt,Ni),p=Pa(Vh,i,Ni);let g=-1/0,w=1/0;const S=this.getHalfSize(Yv);for(let T=0;T<3;T++){const E=u[T],C=p[T],L=S[T]+r;if(Math.abs(C)>1e-6){const R=(L-E)/C,F=(-L-E)/C;g=Math.max(g,Math.min(R,F)),w=Math.min(w,Math.max(R,F))}else if(E>L||E<-L)return!1}return g<=w}projectedArea(e,i,r,n){const o=this.getQuaternion(Op);bm(Ni,o),mt[0]=e[0]-this._data[0],mt[1]=e[1]-this._data[1],mt[2]=e[2]-this._data[2],Pa(mt,mt,Ni);const u=this.getHalfSize(Yv),p=mt[0]<-u[0]?-1:mt[0]>u[0]?1:0,g=mt[1]<-u[1]?-1:mt[1]>u[1]?1:0,w=mt[2]<-u[2]?-1:mt[2]>u[2]?1:0,S=Math.abs(p)+Math.abs(g)+Math.abs(w);if(S===0)return 1/0;const T=S===1?4:6,E=6*(p+3*g+9*w+13);FE(rv,o),gre(rv,rv,u);const C=this.getCenter(ju);for(let F=0;F<T;F++){const V=oqe[E+F];Qt(mt,((1&V)<<1)-1,(2&V)-1,((4&V)>>1)-1),jZ(mt,mt,rv),nr(D0,C,mt),D0[3]=1,C8(D0,D0,i);const U=1/Math.max(1e-6,D0[3]);au[2*F]=D0[0]*U,au[2*F+1]=D0[1]*U}const L=2*T-2;let R=au[0]*(au[3]-au[L+1])+au[L]*(au[1]-au[L-1]);for(let F=2;F<L;F+=2)R+=au[F]*(au[F+3]-au[F-1]);return Math.abs(R)*r*n*.125}projectedRadius(e){const i=this.getQuaternion(Op);return bm(Ni,i),Pa(mt,e,Ni),Math.abs(mt[0]*this._data[3])+Math.abs(mt[1]*this._data[4])+Math.abs(mt[2]*this._data[5])}minimumDistancePlane(e){return e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3]-this.projectedRadius(e)}maximumDistancePlane(e){return e[0]*this._data[0]+e[1]*this._data[1]+e[2]*this._data[2]+e[3]+this.projectedRadius(e)}toAaBoundingBox(e){const i=this.getQuaternion(Op),r=FE(rv,i),n=this._data[3]*Math.abs(r[0])+this._data[4]*Math.abs(r[3])+this._data[5]*Math.abs(r[6]),o=this._data[3]*Math.abs(r[1])+this._data[4]*Math.abs(r[4])+this._data[5]*Math.abs(r[7]),u=this._data[3]*Math.abs(r[2])+this._data[4]*Math.abs(r[5])+this._data[5]*Math.abs(r[8]);e[0]=this._data[0]-n,e[1]=this._data[1]-o,e[2]=this._data[2]-u,e[3]=this._data[0]+n,e[4]=this._data[1]+o,e[5]=this._data[2]+u}transform(e,i,r,n=0,o=U3(r),u=U3(i),p=vM(i,u)){if(r===o)i.isGeographic?hqe(this,e,i,n,u):cqe(this,e,i,n,u,p);else if(i.isWGS84&&(r.isWebMercator||X4(r)))lqe(i,this,r,e,n);else if(i.isWebMercator&&X4(r))uqe(i,this,r,e,n);else{const g=this.getCenter(ju);g[2]+=n,Th(g,i,0,g,r,0,1),e.center=g,this!==e&&(e.quaternion=this.getQuaternion(Op),e.halfSize=this.getHalfSize(Yv))}}};const Ni=ad(),Op=ad(),nqe=ad(),mt=be(),Vh=be(),D0=$h();function sqe(t,e=new Oue){return qBe(t,e),e}const au=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],oqe=(()=>{const t=new Int8Array(162);let e=0;const i=r=>{for(let n=0;n<r.length;n++)t[e+n]=r[n];e+=6};return i([6,2,3,1,5,4]),i([0,2,3,1,5,4]),i([0,2,3,7,5,4]),i([0,1,3,2,6,4]),i([0,1,3,2,0,0]),i([0,1,5,7,3,2]),i([0,1,3,7,6,4]),i([0,1,3,7,6,2]),i([0,1,5,7,6,2]),i([0,1,5,4,6,2]),i([0,1,5,4,0,0]),i([0,1,3,7,5,4]),i([0,2,6,4,0,0]),i([0,0,0,0,0,0]),i([1,3,7,5,0,0]),i([2,3,7,6,4,0]),i([2,3,7,6,0,0]),i([2,3,1,5,7,6]),i([0,1,5,7,6,2]),i([0,1,5,7,6,4]),i([0,1,3,7,6,4]),i([4,5,7,6,2,0]),i([4,5,7,6,0,0]),i([4,5,1,3,7,6]),i([0,2,3,7,5,4]),i([6,2,3,7,5,4]),i([6,2,3,1,5,4]),t})();function aqe(t,e,i,r,n){const o=t.getQuaternion(Op);n.quaternion=o,bm(Ni,o);const u=t.getCenter(ju),p=t.getHalfSize(Yv);if(r===Xp.Global){Pa(mi,u,Ni),lb(Fu,mi),NZ(da,Fu,p),Js(da,Fu,da);const g=cr(da);nr(da,Fu,p);const w=cr(da);if(g<i)n.center=u,Qt(mi,i,i,i),n.halfSize=nr(mi,p,mi);else{const S=w>0?1+e/w:1,T=g>0?1+i/g:1,E=(T+S)/2,C=(T-S)/2;Mi(da,Fu,C),n.halfSize=ji(da,da,p,E),Mi(da,Fu,E),ji(da,da,p,C),FZ(mi,mi),IP(mi,da,mi);const L=t.getQuaternion(nqe);n.center=Pa(mi,mi,L)}}else{n.center=ji(mi,u,o3,(i+e)/2);const g=Pa(mi,o3,Ni);lb(g,g),n.halfSize=ji(Fu,p,g,(i-e)/2)}return n}function lqe(t,e,i,r,n){e.getCenter(ju),ju[2]+=n;const o=U3(i);Th(ju,t,0,ju,o,0,1),Pue(o,e,ju,i,r)}function uqe(t,e,i,r,n){e.getCenter(ju),ju[2]+=n,Pue(t,e,ju,i,r)}function Pue(t,e,i,r,n){const o=e.getQuaternion(Op),u=FE(rv,o),p=e.getHalfSize(Yv);for(let g=0;g<8;++g){for(let w=0;w<3;++w)rh[w]=p[w]*(g&1<<w?-1:1);for(let w=0;w<3;++w){let S=i[w];for(let T=0;T<3;++T)S+=rh[T]*u[3*T+w];C5[3*g+w]=S}}Th(C5,t,0,C5,r,0,8),sqe(pqe,n)}function cqe(t,e,i,r,n=U3(i),o=vM(i,n)){t.getCorners(JH),t.getCenter(rh),rh[2]+=r,BBe(i,rh,pa,n),e.setCenter(pa[12],pa[13],pa[14]);const u=2*Math.sqrt(1+pa[0]+pa[5]+pa[10]);Ni[0]=(pa[6]-pa[9])/u,Ni[1]=(pa[8]-pa[2])/u,Ni[2]=(pa[1]-pa[4])/u,Ni[3]=.25*u;const p=t.getQuaternion(Op);e.quaternion=yN(Ni,Ni,p),bm(Ni,Ni),Qt(Fu,0,0,0);const g=e.getCenter(dqe);for(const w of JH)w[2]+=r,o(w,0,w,0),Js(mi,w,g),Pa(mi,mi,Ni),lb(mi,mi),DZ(Fu,Fu,mi);e.halfSize=Fu}function hqe(t,e,i,r,n=U3(i)){const o=PI(i),u=1+Math.max(0,r)/(o.radius+t.centerZ);t.getCenter(rh),rh[2]+=r,Th(rh,i,0,rh,n,0,1),e.center=rh;const p=t.getQuaternion(Op);e.quaternion=p,bm(Ni,p),Qt(mi,0,0,1),Pa(mi,mi,Ni);const g=t.getHalfSize(Yv);Qt(mi,g[0]*Math.abs(mi[0]),g[1]*Math.abs(mi[1]),g[2]*Math.abs(mi[2])),Mi(mi,mi,o.inverseFlattening),nr(mi,g,mi),e.halfSize=Mi(mi,mi,u)}const C5=new Array(24),pqe=new gN(C5,3),rh=be(),ju=be(),dqe=be(),Yv=be(),rv=aw(),pa=Bu(),JH=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],mi=be(),Fu=be(),da=be(),fqe=un(-1,-1,-1);let yqe=class{constructor(){this._transform=Bu(),this._transformInverse=new j$({value:this._transform},GI,Bu),this._transformInverseTranspose=new j$(this._transformInverse,Bl,Bu),this._transformTranspose=new j$({value:this._transform},Bl,Bu),this._transformInverseRotation=new j$({value:this._transform},vre,aw)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){p3(this._transform,e)}multiplyTransform(e){AP(this._transform,this._transform,e)}set(e){p3(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,i){this.setTransformMatrix(e),this.multiplyTransform(i),this._invalidateLazyTransforms()}},j$=class{constructor(e,i,r){this._original=e,this._update=i,this._dirty=!0,this._transform=r()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},mqe=class{constructor(e=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=be(),this._tmpMbs=FS(),this._tmpObb=new Oue,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=cr(e)}applyToVertex(e,i,r){const n=Qt(Rue,e,i,r),o=Qt(bqe,e,i,r+this.componentLocalOriginLength),u=this._totalOffset/cr(o);return ji(this._tmpVertex,n,o,u),this._tmpVertex}applyToAabb(e){const i=this.componentLocalOriginLength,r=e[0],n=e[1],o=e[2]+i,u=e[3],p=e[4],g=e[5]+i,w=Math.abs(r),S=Math.abs(n),T=Math.abs(o),E=Math.abs(u),C=Math.abs(p),L=Math.abs(g),R=.5*(1+Math.sign(r*u))*Math.min(w,E),F=.5*(1+Math.sign(n*p))*Math.min(S,C),V=.5*(1+Math.sign(o*g))*Math.min(T,L),U=Math.max(w,E),W=Math.max(S,C),H=Math.max(T,L),J=Math.sqrt(R*R+F*F+V*V),X=Math.sign(w+r),te=Math.sign(S+n),oe=Math.sign(T+o),pe=Math.sign(E+u),de=Math.sign(C+p),ge=Math.sign(L+g),we=this._totalOffset;if(J<we)return e[0]-=(1-X)*we,e[1]-=(1-te)*we,e[2]-=(1-oe)*we,e[3]+=pe*we,e[4]+=de*we,e[5]+=ge*we,e;const ke=we/Math.sqrt(U*U+W*W+H*H),$e=we/J,Fe=$e-ke,yt=-Fe;return e[0]+=r*(X*yt+$e),e[1]+=n*(te*yt+$e),e[2]+=o*(oe*yt+$e),e[3]+=u*(pe*Fe+ke),e[4]+=p*(de*Fe+ke),e[5]+=g*(ge*Fe+ke),e}applyToMbs(e){const i=cr(e),r=this._totalOffset/i;return ji(this._tmpMbs,e,e,r),this._tmpMbs[3]=e[3]+e[3]*this._totalOffset/i,this._tmpMbs}applyToObb(e){return aqe(e,this._totalOffset,this._totalOffset,Xp.Global,this._tmpObb),this._tmpObb}};class gqe{constructor(e=0){this.offset=e,this.sphere=FS(),this.tmpVertex=be()}applyToVertex(e,i,r){const n=this.objectTransform.transform,o=Qt(Rue,e,i,r),u=Ll(o,o,n),p=this.offset/cr(u);ji(u,u,u,p);const g=this.objectTransform.inverse;return Ll(this.tmpVertex,u,g),this.tmpVertex}applyToMinMax(e,i){const r=this.offset/cr(e);ji(e,e,e,r);const n=this.offset/cr(i);ji(i,i,i,n)}applyToAabb(e){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e){const i=cr(e),r=this.offset/i;return ji(this.sphere,e,e,r),this.sphere[3]=e[3]+e[3]*this.offset/i,this.sphere}}const ZH=new gqe;function KH(t){return t!=null?(ZH.offset=t,ZH):null}new mqe;const vqe="terrain",Rue=be(),bqe=be(),YH=1e-5;let wqe=class{constructor(e){this.options=new VGe,this._results=new Sqe,this.transform=new yqe,this.tolerance=YH,this.verticalOffset=null,this._ray=Cl(),this._rayEnd=be(),this._rayBeginTransformed=be(),this._rayEndTransformed=be(),this.viewingMode=e??Xp.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,i,r){this.resetWithRay(fF(e,i,this._ray),r)}resetWithRay(e,i){this.camera=i,e!==this._ray&&NO(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===Xp.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,nr(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,i,r,n,o){var p;this.point=i,this.filterPredicate=n,this.tolerance=r??YH;const u=KH(this.verticalOffset);if(e&&e.length>0){const g=o?w=>{o(w)&&this.intersectObject(w)}:w=>{this.intersectObject(w)};for(const w of e){const S=(p=w.getSpatialQueryAccelerator)==null?void 0:p.call(w);S!=null?(u!=null?S.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,g,u):S.forEachAlongRay(this._ray.origin,this._ray.direction,g),this.options.selectionMode&&this.options.hud&&S.forEachDegenerateObject(g)):w.objects.forAll(T=>g(T))}}this.sortResults()}intersectObject(e){const i=e.geometries;if(!i)return;const r=e.effectiveTransformation,n=KH(this.verticalOffset);for(const o of i){if(!o.visible)continue;const{material:u,id:p}=o;this.transform.setAndInvalidateLazyTransforms(r,o.transformation),Ll(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Ll(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const g=this.transform.transform;n!=null&&(n.objectTransform=this.transform),u.intersect(o,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(w,S,T,E,C,L)=>{if(w>=0){if(this.filterPredicate!=null&&!this.filterPredicate(this._ray.origin,this._rayEnd,w))return;const R=E?this._results.hud:this._results,F=E?V=>{const U=new UGe(e,p,T,L);V.set(To.HUD,U,w,S,lF,C)}:V=>V.set(To.OBJECT,{object:e,geometryId:p,triangleNr:T},w,S,g,C);if((R.min.drapedLayerOrder==null||C>=R.min.drapedLayerOrder)&&(R.min.dist==null||w<R.min.dist)&&F(R.min),this.options.store!==Lb.MIN&&(R.max.drapedLayerOrder==null||C<R.max.drapedLayerOrder)&&(R.max.dist==null||w>R.max.dist)&&F(R.max),this.options.store===Lb.ALL)if(E){const V=new C7(this._ray);F(V),this._results.hud.all.push(V)}else{const V=new Xv(this._ray);F(V),this._results.all.push(V)}}})}}sortResults(e=this._results.all){e.sort((i,r)=>i.dist!==r.dist?(i.dist??0)-(r.dist??0):i.drapedLayerOrder!==r.drapedLayerOrder?XH(i.drapedLayerOrder,r.drapedLayerOrder):XH(i.drapedLayerGraphicOrder,r.drapedLayerGraphicOrder))}};function XH(t,e){return(e??-Number.MAX_VALUE)-(t??-Number.MAX_VALUE)}function _qe(t){return new wqe(t)}class Sqe{constructor(){this.min=new Xv(Cl()),this.max=new Xv(Cl()),this.hud={min:new C7(Cl()),max:new C7(Cl()),all:new Array},this.ground=new Xv(Cl()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}}let Xv=class{get ray(){return this._ray}get distanceInRenderSpace(){return this.dist!=null?(Mi(V$,this.ray.direction,this.dist),cr(V$)):null}getIntersectionPoint(e){return!!ud(this)&&(Mi(V$,this.ray.direction,this.dist),nr(e,this.ray.origin,V$),!0)}getTransformedNormal(e){return ki(Kw,this.normal),Kw[3]=0,C8(Kw,Kw,this.transformation),ki(e,Kw),ta(e,e)}constructor(e){this.intersector=To.OBJECT,this.normal=be(),this.transformation=Bu(),this._ray=Cl(),this.init(e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=To.OBJECT,NO(e,this._ray)}set(e,i,r,n,o,u,p){this.intersector=e,this.dist=r,ki(this.normal,n??o3),p3(this.transformation,o??lF),this.target=i,this.drapedLayerOrder=u,this.drapedLayerGraphicOrder=p}copy(e){NO(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,ki(this.normal,e.normal),p3(this.transformation,e.transformation)}},C7=class extends Xv{constructor(){super(...arguments),this.intersector=To.HUD}};function $ot(t){return new Xv(t)}const V$=be(),Kw=$h();function xqe(t){return ud(t)&&t.intersector===To.PCL&&!!t.target}function $qe(t){return ud(t)&&t.intersector===To.I3S&&!!t.target}function Tqe(t){return ud(t)&&t.intersector===To.VOXEL&&!!t.target}function Eqe(t){return ud(t)&&t.intersector===To.TILES3D&&!!t.target}let Tot=class extends hue{constructor(e,i,r){super(e,i),this.triangleNr=r}};function Iqe(t){return ud(t)&&t.intersector===To.OVERLAY&&!!t.target}let Iot=class extends hue{constructor(e,i,r,n,o,u){super(e,i),this.layerUid=e,this.graphicUid=i,this.geometryId=r,this.triangleNr=n,this.baseBoundingSphere=o,this.numLodLevels=u}};function Mqe(t){return ud(t)&&t.intersector===To.LOD&&!!t.target}function kqe(t,e){const i=Cqe(t,e);return i!=null&&i.type==="graphic"?i.graphic:null}function Cqe(t,e){var i;if(t==null)return null;if(pBe(t)||dBe(t))return QH((i=t.target)==null?void 0:i.object,e);if(xqe(t)){const r=t.target.createGraphic();return{type:"graphic",graphic:r,layer:r.layer}}if(Tqe(t)){const r=t.target.createVoxelGraphic();return{type:"graphic",graphic:r,layer:r.layer}}if(Eqe(t)){const r=t.target.createTiles3DGraphic();return{type:"graphic",graphic:r,layer:r.layer}}return Iqe(t)||Mqe(t)?QH(t.target,e):$qe(t)?Aqe(t.target,e):null}function QH(t,e){if((t==null?void 0:t.graphicUid)==null)return null;const i=Fue(t,e);if(i==null)return null;if(i===e.graphics)return e.graphicsView==null||typeof t.graphicUid!="number"?null:e.graphicsView.getHit(t.graphicUid);const r=e.allLayerViews.find(n=>n.layer===i);return!r||r.suspended||t.graphicUid==null?null:"getHit"in r?r.getHit(t.graphicUid):null}function Aqe(t,e){const i=Fue(t,e);if(i==null)return null;const r=e.allLayerViews.find(n=>n.layer===i);return r&&!r.suspended&&"getGraphicFromIntersectorTarget"in r?Lqe(r.getGraphicFromIntersectorTarget(t)):null}function Lqe(t){return t!=null?{type:"graphic",graphic:t,layer:t.layer}:null}function Fue(t,e){return(t==null?void 0:t.layerUid)==null?null:e.graphicsView!=null&&t.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.allLayers.find(i=>i.uid===t.layerUid)}function Oqe(t){var n;const e=t.sourceLayer,i=t.layer,r=e&&"objectIdField"in e?e:i&&"objectIdField"in i?i:e;if(r){const o=r.objectIdField??jGe,u=(n=t.attributes)==null?void 0:n[o];if(u)return`o-${r.id}-${u}`}return`u-${t.uid}`}function eW(t,e){const i=A7(t,e.include,Pb.INCLUDE),r=A7(t,e.exclude,Pb.EXCLUDE);return{include:i.layerUids,exclude:r.layerUids,graphics:{include:i.graphicUids,exclude:r.graphicUids},mediaElements:{include:i.mediaElements,exclude:r.mediaElements}}}function A7(t,e,i,r={layerUids:void 0,graphicUids:void 0,mediaElements:void 0}){if(!e)return r;if(e instanceof Cr)Pqe(r,Oqe(e)),i===Pb.INCLUDE&&(t.graphicsView!=null&&e.layer===t?Wg(r,t.graphicsView.processor.layer.id):e.layer&&Wg(r,e.layer.uid));else if("layer"in e&&"element"in e)Rqe(r,e.element),i===Pb.INCLUDE&&Wg(r,e.layer.uid);else if(Q2(e))for(const n of e)n===t.graphics&&t.graphicsView!=null?Wg(r,t.graphicsView.processor.layer.id):n===t.map.ground?Wg(r,vqe):A7(t,n,i,r);else"uid"in e&&Wg(r,e.uid);return r}function Wg(t,e){t.layerUids||(t.layerUids=new Set),t.layerUids.add(e)}function Pqe(t,e){t.graphicUids||(t.graphicUids=new Set),t.graphicUids.add(e)}function Rqe(t,e){t.mediaElements||(t.mediaElements=new Set),t.mediaElements.add(e)}var Pb;(function(t){t[t.INCLUDE=0]="INCLUDE",t[t.EXCLUDE=1]="EXCLUDE"})(Pb||(Pb={}));const Fqe=2e5;let po=class extends US{constructor(t){super(t),this.type="view",this.color=new Ce("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=Hu((e,i,r,n,o,u,p)=>({inputGraphicUid:e!=null?Nue(e):null,visibleLayers:i,maxIntersectionDistance:r,intersectOptions:n,view:o,stationary:u,spatialReference:p})),this._vecA=be(),this._vecB=be(),this._ray=Cl()}get minDemResolution(){var i,r,n;const t=(i=this._viewModel)==null?void 0:i.view;if(t==null||t.type!=="3d")return null;const e=(n=(r=t.pointsOfInterest)==null?void 0:r.focus)==null?void 0:n.worldUnitsPerContentPixel;return e==null?null:e*Gl(t.spatialReference)}get queryElevationDependencies(){var e;const t=this._view;return t?this._getQueryElevationDependencies((e=this._viewModel)==null?void 0:e.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,t,t.stationary,t.spatialReference):null}get _visibleLayers(){var t,e,i;return((i=(e=(t=this._view)==null?void 0:t.map)==null?void 0:e.allLayers)==null?void 0:i.filter(r=>r.visible).toArray())??[]}get _intersectOptions(){const t=this._view;if(t==null||t.destroyed)return{};const e=eW(t,{include:this.include,exclude:this.exclude}),i=eW(t,{exclude:this._pointCloudLayers});return e.exclude=U7(e.exclude,i.exclude),e}get _pointCloudLayers(){const t=this._view;return t==null?[]:t.allLayerViews.toArray().filter(e=>{var i;return((i=e.layer)==null?void 0:i.type)==="point-cloud"}).map(e=>e.layer)}get _view(){var e;const t=(e=this._viewModel)==null?void 0:e.view;return t!=null&&t.type==="3d"?t:null}get _maxIntersectionDistance(){const t=this._view;return t!=null&&t.renderCoordsHelper?PI(t.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const t=this._view;if(t==null)return null;const e=_qe(t.state.viewingMode),i=e.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=Lb.ALL,e}async queryElevation(t,{noDataValue:e,signal:i}){const r=this.queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineInput: no dependencies");const n=this._intersector;if(n==null)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:o,view:u,spatialReference:p}=r,g=u.renderCoordsHelper,w=u.sceneIntersectionHelper,S=this._vecA,T=this._vecA,E=this._vecB,C=this._ray;if(!p)return{geometry:t,noDataValue:e};const L=await zm.fromGeometry(t).project(p,i);if(!L)return{geometry:t,noDataValue:e};const R=L.coordinates,F=R.length;for(let V=0;V<F;++V){const U=R[V];Qt(E,U.x,U.y,U.z??0),g.toRenderCoords(E,p,E),g.setAltitude(S,Fqe,E);const W=fF(S,E,C);w.computeIntersection(W,n,o,!0);const H=Nqe(r,n.results.all);H?(H.getIntersectionPoint(T),g.fromRenderCoords(T,T,p),U.z=T[2]):U.z=e}return{geometry:L.export(),noDataValue:e}}attach(t){const e=()=>this._onChange();return In([super.attach(t),ce(()=>this.queryElevationDependencies,e),gi(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e})])}};function Nqe({view:t,inputGraphicUid:e,maxIntersectionDistance:i},r){for(const n of r){if(n.distanceInRenderSpace!=null&&n.distanceInRenderSpace>i)continue;const o=kqe(n,t);if(o==null||Nue(o)!==e)return n}return null}function Nue(t){if(t.layer&&"objectIdField"in t.layer){const e=t.attributes[t.layer.objectIdField];if(e)return`o-${t.layer.id}-${e}`}return`u-${t.uid}`}m([b({type:Ce,nonNullable:!0})],po.prototype,"color",void 0),m([b()],po.prototype,"viewVisualizationEnabled",void 0),m([b()],po.prototype,"include",void 0),m([b()],po.prototype,"exclude",void 0),m([b({readOnly:!0})],po.prototype,"minDemResolution",null),m([b()],po.prototype,"queryElevationDependencies",null),m([b()],po.prototype,"_visibleLayers",null),m([b()],po.prototype,"_intersectOptions",null),m([b()],po.prototype,"_pointCloudLayers",null),m([b()],po.prototype,"_view",null),m([b()],po.prototype,"_maxIntersectionDistance",null),m([b()],po.prototype,"_intersector",null),po=m([G("esri.widgets.ElevationProfile.ElevationProfileLineView")],po);const Dqe=po,jqe={base:US,key:"type",typeMap:{ground:sue,input:NGe,query:DGe,view:Dqe},errorContext:"elevation-profile-line"},Vqe=Ie.ofType(jqe);var Fi,Ca;function zqe(t){return t==="2d"?new id({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new cn({color:[0,0,0,0]})}(function(t){t.Ready="ready",t.Creating="creating",t.Reshaping="reshaping",t.ReshapingDisabled="reshaping-disabled",t.Selecting="selecting",t.Selected="selected"})(Fi||(Fi={})),function(t){t.View="view",t.Main="main",t.Interaction="interaction"}(Ca||(Ca={}));let Ma=class extends Te{constructor(t){super(t),this.state=Fi.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles(ce(()=>({view:this.tool.viewModel.view,visible:this.tool.visible}),({view:t,visible:e})=>{t!=null&&e?this._attach(t):this._detach()},ri),Ca.View)}destroy(){this._detach()}get canStopCreating(){const t=this._geometry,e=this._shouldRemoveLastPoint?3:2;return zS(t)&&t.paths.length>0&&t.paths[0].length>=e}get _input(){return this.tool.viewModel.input}set _input(t){this.tool.viewModel.input=t}get _geometry(){var t;return(t=this._input)==null?void 0:t.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){}start(t={mode:"sketch"}){if(!this.tool.editable)return;const e=this._view;if(e!=null&&e.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),this._previousInputInfo==null&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),t.mode){case"sketch":this._set("state",Fi.Creating),this._startCreationInteraction();break;case"select":this._set("state",Fi.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=t}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",Fi.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(t){return t!=null&&this._sketchedGraphics.has(t)}_attach(t){this._detach();const e={mode:t.type==="3d"?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new LS({listMode:"hide",internal:!0,elevationInfo:e});const i=zqe(t.type);this._sketchVM=new YM({layer:this._graphicsLayer,view:t,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([Fr(()=>t.ready,()=>{const r=this._pendingStartOptions;r&&this.start(r)},ri),ce(()=>[this._input,this._visibleAndEditable],()=>this._update(),ri),ce(()=>({map:t.map,graphicsLayer:this._graphicsLayer}),({map:r,graphicsLayer:n})=>{r!=null&&n!=null&&r.add(n),this._update()},ri)],Ca.Main)}_detach(){var i;this.removeHandles(Ca.Main),this._sketchVM=ot(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const t=(i=this._view)==null?void 0:i.map,e=this._graphicsLayer;t!=null&&e!=null&&t.remove(e),this._graphicsLayer=ot(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",Fi.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const t=this._view,e=this._sketchVM;if(t==null||e==null)return;this._shouldRemoveLastPoint=!1;const i=e.on("create",n=>{var u;const o=n.graphic;switch(n.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(o),((u=n.toolEventInfo)==null?void 0:u.type)==="cursor-update"&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(o)}}),r=()=>{var u;i.remove();const n=this.canStopCreating,o=(u=this._geometry)==null?void 0:u.clone();e.cancel(),this._creationToolPromise=null,o!=null&&n?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new Cr({geometry:Uqe(o)})):this._input=null};this.removeHandles(Ca.Interaction),this.addHandles(We(r),Ca.Interaction),this._creationToolPromise=Wu(e.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const t=this._view,e=this._sketchVM;if(t==null||e==null)return;const i=e.on("update",o=>{const u=o.graphics[0];switch(o.state){case"complete":this._setSketchedGraphic(u),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(u)}}),r=()=>{i.remove(),e.cancel(),this._updateToolPromise=null};this.removeHandles(Ca.Interaction),this.addHandles(We(r),Ca.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=Wu(e.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const t=this._view;if(t==null)return;const e=t.cursor,i=We(()=>t.cursor=e);t.cursor="crosshair",t.closePopup();let r=null;const n=We(()=>En(r)),o=t.on("immediate-click",p=>{p.async(async()=>{En(r),r=Sh(async g=>{const{results:w}=await t.hitTest(p);At(g);const S=w.filter(T=>T.type==="graphic"&&T.graphic!=null).map(T=>T.graphic).find(T=>T.geometry!=null&&T.geometry.type==="polyline");S&&(p.preventDefault(),p.stopPropagation(),this._input=S,this._clearPreviousInput(),this._stopInteractionAndUpdate())}),await r.promise})},ii.TOOL),u=t.on("key-down",p=>{p.key==="Escape"&&this.cancel()});this.removeHandles(Ca.Interaction),this.addHandles([o,u,n,i],Ca.Interaction),t.ready&&t.focus()}_stopInteraction(){this.removeHandles(Ca.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(Ca.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",Fi.Ready),this._update()}_update(){if(this._updateDisabled)return;const t=this.state;if(t!==Fi.Selecting){if(this._visibleAndEditable){if(t===Fi.Creating||t===Fi.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return this._input==null?Fi.Ready:this.isSketchedGraphic(this._input)?this.state===Fi.Creating?Fi.Creating:this._visibleAndEditable?Fi.Reshaping:Fi.ReshapingDisabled:Fi.Selected}_updateVisuals(){switch(this.state){case Fi.Creating:break;case Fi.Reshaping:this._startReshapeInteraction();break;case Fi.ReshapingDisabled:{this._stopInteractionAndUpdate();const t=this._input;t!=null&&this.isSketchedGraphic(t)&&(t.visible=!1);break}case Fi.Ready:case Fi.Selected:this._stopInteractionAndUpdate();case Fi.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(t){this._previousInputInfo={graphic:t}}_restorePreviousInput(){const t=this._previousInputInfo;t!=null&&(this._clearPreviousInput(),this._input=t.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const t=this._graphicsLayer;if(t==null)return;const e=t.graphics,i=this._input;if(i==null||!this.isSketchedGraphic(i))return void e.removeAll();if(e.indexOf(i)===-1)e.removeAll(),e.add(i);else if(e.length!==1){const r=e.filter(n=>n!==i);e.removeMany(r)}}_setSketchedGraphic(t){t!=null&&this._sketchedGraphics.add(t),this._input=t,this._updateSketchedGraphic()}};function Uqe(t){if(zS(t)){const e=t.clone();return e.paths=[e.paths[0].slice(0,-1)],e}return t}m([b({nonNullable:!0})],Ma.prototype,"state",void 0),m([b({nonNullable:!0})],Ma.prototype,"tool",void 0),m([b()],Ma.prototype,"canStopCreating",null),m([b()],Ma.prototype,"_graphicsLayer",void 0),m([b()],Ma.prototype,"_sketchVM",void 0),m([b()],Ma.prototype,"_input",null),m([b()],Ma.prototype,"_geometry",null),m([b()],Ma.prototype,"_visibleAndEditable",null),m([b()],Ma.prototype,"_view",null),m([b()],Ma.prototype,"_shouldRemoveLastPoint",void 0),Ma=m([G("esri.widgets.ElevationProfile.ElevationProfileInteraction")],Ma);let A5=class extends Te{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles(ce(()=>{var e;return{tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!((e=this.tool.viewModel.view)!=null&&e.ready)}},({tool:e,view:i,visible:r})=>{i!=null&&r?this._show(i,e):this._hide()},ri))}destroy(){this._hide()}_show(e,i){this._loadingTask=En(this._loadingTask),this._loadingTask=Sh(async r=>{if(e.type==="2d"){const n=ie(()=>import("./ElevationProfileView2D-CQSqbbmy.js"),__vite__mapDeps([350,351])),o=(await zl(n,r)).ElevationProfileView2D;this._implementation=new o(e,i)}else if(e.type==="3d"){const n=ie(()=>import("./ElevationProfileView3D-BVJSDWPy.js"),__vite__mapDeps([352,351,318,151,104,40,319,95,54,320,45,72,77,110,43,311,156,168,155,314,321,88,42,130,144,37,38,39,44,46,146,74,108])),o=(await zl(n,r)).ElevationProfileView3D;this._implementation=new o(e,i)}})}_hide(){this._loadingTask=En(this._loadingTask),this._implementation=ot(this._implementation)}};m([b()],A5.prototype,"tool",void 0),A5=m([G("esri.widgets.ElevationProfile.support.ElevationProfileView")],A5);let Sp=class extends Te{constructor(t){super(t),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new A5({tool:this}),this.interaction=new Ma({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var e;switch((e=this.interaction)==null?void 0:e.state){case Fi.Ready:return Ho.Ready;case Fi.Creating:return Ho.Creating;case Fi.Selecting:return Ho.Selecting;case Fi.Selected:return Ho.Selected;case Fi.Reshaping:case Fi.ReshapingDisabled:return Ho.Created}}};m([b({nonNullable:!0})],Sp.prototype,"viewModel",void 0),m([b()],Sp.prototype,"view",void 0),m([b()],Sp.prototype,"interaction",void 0),m([b()],Sp.prototype,"editable",void 0),m([b()],Sp.prototype,"visible",void 0),m([b()],Sp.prototype,"highlightEnabled",void 0),Sp=m([G("esri.widgets.ElevationProfile.ElevationProfileTool")],Sp);let Xt=class extends Te{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=Hu((i,r)=>({distance:i,elevation:r})),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new sue,this._userUnitOptions=null,this._userUnit=null,e!=null&&e.profiles||(this.profiles=new Ie([this._defaultProfileLineGround]))}initialize(){this.addHandles(ce(()=>this.view,e=>{var n;if(e==null)return void fe.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(tW);const i=e.type==="3d"?e.resourceController:void 0;(n=this.queue)==null||n.destroy(),this.queue=lGe(i==null?void 0:i.scheduler);const r=i==null?void 0:i.addUpdatingObject(this);r&&this.addHandles(r,tW)},ri)),this.tool=new Sp({viewModel:this}),this._controller=new bf({viewModel:this})}destroy(){this._defaultProfileLineGround=ot(this._defaultProfileLineGround),this._controller=ot(this._controller),this._currentTileCache=ot(this._currentTileCache),this.tool=ot(this.tool),this.queue=ot(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const i=this._get("profiles"),r=e??new Ie;this._set("profiles",Jp(r,i))}get state(){const e=this.view;return e!=null&&e.ready?this.tool.state:Ho.Disabled}get progress(){let e=0,i=0;for(const r of this.visibleProfiles)e++,i+=r.progress;return e>0?i/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=nGe(this.visibleProfiles.map(n=>n.result)),i=jde(e.maxDistance,"meters",this.unit),r=Vde(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(i,r)}get geodesicDistanceThreshold(){return this._get("geodesicDistanceThreshold")}set geodesicDistanceThreshold(e){wo(fe.getLogger(this),"geodesicDistanceThreshold",{version:"4.29",warnOnce:!0}),this._set("geodesicDistanceThreshold",e)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){var i;const e=(i=this.input)==null?void 0:i.geometry;return zS(e)&&e.paths.reduce((r,n)=>r+n.length,0)>0}get hoveredPoints(){return this.input!=null&&this.visible&&this.tool.editable?this.visibleProfiles.map(e=>{const i=e.hoveredPoint;return i!=null?{hoveredPoint:i,color:e.color}:null}).filter(Rt):[]}get statistics(){return rGe(this.visibleProfiles.map(e=>e.statistics))}get chartData(){if(this.input==null)return null;const{effectiveUnits:e,progress:i,statistics:r,visibleProfiles:n,uniformChartScaling:o}=this,u=n.filter(p=>p.hasZ).map(p=>({id:p.id,type:p.type,title:p.title,color:p.color,samples:p.samples,progress:p.progress,chartFillEnabled:p.chartFillEnabled,chartStrokeWidth:p.chartStrokeWidth,chartStrokeOffsetY:p.chartStrokeOffsetY,viewVisualizationEnabled:p.viewVisualizationEnabled}));return u.length===0?null:{lines:u,effectiveUnits:e,statistics:r,refined:i===1,dynamicElevationRange:n.some(p=>p.type==="view"),uniformScaling:o}}get visibleProfiles(){return this.profiles.toArray().filter(e=>e.available&&e.visible)}get minDemResolutions(){const e=[];for(const{minDemResolution:i}of this.visibleProfiles)i!=null&&e.push(i);return e}get minDemResolution(){return fW(this.minDemResolutions)}get errorState(){var i;const e=(i=this.input)==null?void 0:i.geometry;if(!oN(e))return _n.NoValidInput;if(this.error!=null){if(FUe(this.error))switch(this.error.cause){case Rl.TooComplex:return _n.TooComplex;case Rl.InvalidGeometry:return _n.InvalidGeometry;case Rl.InvalidElevationInfo:return _n.InvalidElevationInfo;case Rl.ElevationQueryError:return _n.NoValidInput}return _n.UnknownError}return this.visibleProfiles.length===0?_n.NoVisibleProfiles:this.chartData==null&&this.progress===1?_n.RefinedButNoChartData:_n.None}get tileCache(){var i;this._currentTileCache=ot(this._currentTileCache);const e=this.view;if(e!=null&&(e==null?void 0:e.type)==="3d"){const r=(i=e.basemapTerrain)==null?void 0:i.elevationQueryCache;if(r!=null)return r}return this._currentTileCache==null&&(this._currentTileCache=new $Ue(new $8(20*O3.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return e!=null&&e.type==="3d"?e.elevationProvider:null}get updating(){var r;const{progress:e}=this,i=!!((r=this.queue)!=null&&r.updating);return e>0&&e<1||i}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,i){const r=this.unitOptions;return e!=null&&r.includes(e)?e:i?this._findSelectableUnit(i):r[0]}_filteredOrAllUnits(e){const i=(e??[]).filter(r=>oE.includes(r));return i.length===0?oE.slice():i}};m([b()],Xt.prototype,"view",void 0),m([b({type:Cr})],Xt.prototype,"input",void 0),m([b({type:Vqe,nonNullable:!0})],Xt.prototype,"profiles",null),m([b({readOnly:!0})],Xt.prototype,"state",null),m([b({readOnly:!0})],Xt.prototype,"progress",null),m([b()],Xt.prototype,"unitOptions",null),m([b()],Xt.prototype,"unit",null),m([b({readOnly:!0})],Xt.prototype,"effectiveUnits",null),m([b()],Xt.prototype,"geodesicDistanceThreshold",null),m([b()],Xt.prototype,"hoveredChartPosition",void 0),m([b()],Xt.prototype,"uniformChartScaling",void 0),m([b()],Xt.prototype,"highlightEnabled",null),m([b({readOnly:!0})],Xt.prototype,"hoveredPoints",null),m([b({readOnly:!0})],Xt.prototype,"statistics",null),m([b()],Xt.prototype,"chartData",null),m([b()],Xt.prototype,"visibleProfiles",null),m([b()],Xt.prototype,"minDemResolutions",null),m([b({readOnly:!0})],Xt.prototype,"minDemResolution",null),m([b({readOnly:!0})],Xt.prototype,"errorState",null),m([b(Gle)],Xt.prototype,"defaultUnit",void 0),m([b()],Xt.prototype,"queue",void 0),m([b()],Xt.prototype,"tileCache",null),m([b()],Xt.prototype,"tool",void 0),m([b()],Xt.prototype,"visible",null),m([b()],Xt.prototype,"error",void 0),m([b()],Xt.prototype,"inputIsSketched",null),m([b()],Xt.prototype,"elevationProvider",null),m([b()],Xt.prototype,"updating",null),m([b()],Xt.prototype,"_defaultProfileLineGround",void 0),m([b()],Xt.prototype,"_userUnitOptions",void 0),m([b()],Xt.prototype,"_controller",void 0),m([b()],Xt.prototype,"_userUnit",void 0),Xt=m([G("esri.widgets.ElevationProfile.ElevationProfileViewModel")],Xt);const tW=Symbol("updating-object"),Due=Xt;let Cu=class extends Te{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};m([b()],Cu.prototype,"legend",void 0),m([b()],Cu.prototype,"chart",void 0),m([b()],Cu.prototype,"clearButton",void 0),m([b()],Cu.prototype,"settingsButton",void 0),m([b()],Cu.prototype,"sketchButton",void 0),m([b()],Cu.prototype,"selectButton",void 0),m([b()],Cu.prototype,"unitSelector",void 0),m([b()],Cu.prototype,"uniformChartScalingToggle",void 0),Cu=m([G("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],Cu);const jue=Cu,Gqe=100;let Vy=class extends vi{constructor(t,e){super(t,e),this._updateLayout=i=>{const r=i.parentElement,n=i.style.display;r==null||r.removeChild(i),document.body.appendChild(i),i.style.display="block";let o=80;for(const u of i.childNodes)u instanceof HTMLElement&&(o=Math.max(o,u.offsetWidth));document.body.removeChild(i),r==null||r.appendChild(i),i.style.display=n,i.style.setProperty("--max-width",`${o}px`)},this._updateLayoutThrottled=qle(this._updateLayout,Gqe)}loadDependencies(){return zi({icon:()=>ie(()=>import("./calcite-icon-C251eVDJ.js"),__vite__mapDeps([231,229,220,227]))})}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return N("div",{afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled,bind:this,class:Bw.base},this._renderStatistics())}_renderStatistics(){var e;const t=(e=this._messages)==null?void 0:e.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(t,e){const i=Vl().formatPrecision,r=this._renderValue(t,n=>{const o=this.effectiveUnits.distance;return o0(this._messagesUnits,n,o,i)});return this._renderStatistic(e,r)}_renderElevationStatistic(t,e){const i=Vl().formatPrecision,r=this._renderValue(t,n=>{const o=this.effectiveUnits.elevation;return o0(this._messagesUnits,n,o,i)});return this._renderStatistic(e,r)}_renderSlopeStatistic(t,e,i){const r=Vl().formatPrecision,n=N("div",{class:Bw.slopeValue,key:"slope-up"},N("calcite-icon",{icon:"arrow-up",scale:"s"}),this._renderValue(t,o=>tG(o,"degrees","geographic","geographic",r)),N("calcite-icon",{icon:"arrow-down",scale:"s"}),this._renderValue(e,o=>tG(o,"degrees","geographic","geographic",r)));return this._renderStatistic(i,n)}_renderStatistic(t,e){return N("div",{class:Bw.statistic},N("label",{class:Bw.statisticLabel},t),N("div",{class:Bw.statisticValue},e))}_renderValue(t,e){const i=this.line,r=i.progress===1?i.statistics:null,n=r==null?void 0:r[t];return n!=null?e(n):PUe}};m([b()],Vy.prototype,"effectiveUnits",void 0),m([b()],Vy.prototype,"line",void 0),m([b(),vt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Vy.prototype,"_messages",void 0),m([b(),vt("esri/core/t9n/Units")],Vy.prototype,"_messagesUnits",void 0),Vy=m([G("esri.widgets.ElevationProfile.components.Statistics")],Vy);function iW(t,{profiles:e}){const i=t.title;if(i!=null)return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}let Au=class extends vi{constructor(t,e){super(t,e),this.checkboxVisible=!0,this.expanded=!1}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),checkbox:()=>ie(()=>import("./calcite-checkbox-UYHQBuOi.js"),__vite__mapDeps([341,220,219,221,226,222,223,224])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),tooltip:()=>ie(()=>import("./calcite-tooltip-Ci-tYktH.js"),__vite__mapDeps([340,220,244,245,247,249]))})}initialize(){this._statistics=new Vy(this._statisticsProps),this.addHandles(ce(()=>this._statisticsProps,t=>this._statistics.set(t)))}destroy(){this._statistics=ot(this._statistics)}render(){const t=this.expanded;return N("div",{class:this.classes(Dh.base,{[Dh.disabled]:this.disabled,[Dh.expanded]:t}),key:this},this._renderColorIndicator(),N("div",{class:Dh.header,key:"header"},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),t?N("div",{class:Dh.content,key:"content"},this._statistics.render()):null)}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return N("div",{class:Dh.colorIndicator,key:"color-indicator",styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const{expanded:t,messages:e}=this,i=t?e.hideDetails:e.showDetails;return N("calcite-action",{appearance:"transparent",bind:this,class:Dh.collapseToggle,"data-testid":"legend-toggle",icon:t?"chevron-up":"chevron-down",key:"collapse-toggle",onclick:this._onCollapseToggleClick,scale:"s",text:i,title:i})}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:t,checkboxVisible:e,disabled:i,messages:r}=this,n=`label-${t.id}`;return N("calcite-label",{class:Dh.label,disabled:i,key:n,layout:"inline"},e?this._renderCheckbox(t.id):null,iW(t,r))}_renderCheckbox(t){const{disabled:e,line:i,messages:r}=this,n=i.visible,o=`${t}-checkbox`,u=n?r.hideProfile:r.showProfile,p=qn(u,{name:iW(i,r)});return N(Jf,null,N("calcite-checkbox",{checked:n,class:Dh.checkbox,disabled:e,id:o,key:"checkbox",onCalciteCheckboxChange:()=>i.toggleVisibility()}),N("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:o},p))}};m([b()],Au.prototype,"checkboxVisible",void 0),m([b()],Au.prototype,"disabled",null),m([b({nonNullable:!0})],Au.prototype,"effectiveUnits",void 0),m([b()],Au.prototype,"expanded",void 0),m([b({nonNullable:!0})],Au.prototype,"line",void 0),m([b()],Au.prototype,"messages",void 0),m([b()],Au.prototype,"onExpandedToggle",void 0),m([b()],Au.prototype,"_statistics",void 0),Au=m([G("esri.widgets.ElevationProfile.components.LegendItem")],Au);let zy=class extends vi{constructor(){super(...arguments),this._expandedLine=null}render(){const{profiles:e,messages:i,effectiveUnits:r,_expandedLine:n}=this;return N("div",{class:xUe.base},e.map(o=>N(Au,{checkboxVisible:e.length>1,effectiveUnits:r,expanded:o===n,line:o,messages:i,onExpandedToggle:()=>this._onExpandedToggle(o)})))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e}};m([b()],zy.prototype,"effectiveUnits",void 0),m([b()],zy.prototype,"messages",void 0),m([b()],zy.prototype,"profiles",void 0),m([b()],zy.prototype,"_expandedLine",void 0),zy=m([G("esri.widgets.ElevationProfile.components.Legend")],zy);const g4="esri-unit-select",v4={base:g4,label:`${g4}__label`,select:`${g4}__select`};let _f=class extends vi{constructor(t,e){super(t,e),this._onSelectChange=i=>{this.onChange(i.target.value)}}loadDependencies(){return zi({label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),option:()=>ie(()=>import("./calcite-option-CiypywlM.js"),__vite__mapDeps([353,227])),select:()=>ie(()=>import("./calcite-select-Cw0k5ryP.js"),__vite__mapDeps([354,220,219,221,222,223,224,227,253,229,255]))})}render(){const{messages:t,options:e,selectLabel:i,value:r,_onSelectChange:n}=this;return N("div",{class:v4.base,key:"units"},N("calcite-label",{class:v4.label},i,N("calcite-select",{class:v4.select,label:i,onCalciteSelectChange:n},e.map(o=>{var u;return N("calcite-option",{key:o,selected:o===r,value:o},Nde(o)?t.systems[o]:(u=t.units[o])==null?void 0:u.pluralCapitalized)}))))}};m([b()],_f.prototype,"options",void 0),m([b()],_f.prototype,"onChange",void 0),m([b()],_f.prototype,"selectLabel",void 0),m([b()],_f.prototype,"value",void 0),m([b(),vt("esri/core/t9n/Units")],_f.prototype,"messages",void 0),_f=m([G("esri.widgets.support.UnitSelect")],_f);let wl=class extends vi{constructor(){super(...arguments),this.messages=null,this._popover=null,this._popoverIsOpen=!1,this._onPopoverAfterCreate=t=>{this._popover=t},this._onUniformChartScalingChange=t=>{this.onUniformChartScalingChange(t.target.checked)}}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),checkbox:()=>ie(()=>import("./calcite-checkbox-UYHQBuOi.js"),__vite__mapDeps([341,220,219,221,226,222,223,224])),label:()=>ie(()=>import("./calcite-label-BqccM8mP.js"),__vite__mapDeps([258,222,220,223])),popover:()=>ie(()=>import("./calcite-popover-CjjGVWYj.js"),__vite__mapDeps([277,243,244,220,245,246,247,248,225,226,227,228,224,249,223,233,221,229,230])),tooltip:()=>ie(()=>import("./calcite-tooltip-Ci-tYktH.js"),__vite__mapDeps([340,220,244,245,247,249]))})}initialize(){const t=()=>this._popover;this.addHandles([gi(t,"calcitePopoverOpen",()=>this._popoverIsOpen=!0),gi(t,"calcitePopoverClose",()=>this._popoverIsOpen=!1)])}render(){const{id:t,messages:e,visibleElements:i}=this,{unitSelector:r,uniformChartScalingToggle:n}=i;if(!e||!r&&!n)return N("div",{key:`${t}-empty`});const o=`${t}__action`,u=this._popoverIsOpen?e.hideSettings:e.showSettings;return N("div",{class:L$.base,key:this},N("calcite-popover",{afterCreate:this._onPopoverAfterCreate,autoClose:!0,label:u,overlayPositioning:"fixed",placement:"bottom-end",referenceElement:o},this._renderPopoverContent()),N("calcite-action",{appearance:"transparent","data-testid":"settings-button",icon:"gear",id:o,scale:"s",text:u,title:u}))}_renderPopoverContent(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;return N("div",{class:L$.popoverContent},t?this._renderUnitSelector():null,e?this._renderUniformChartScalingToggle():null)}_renderUnitSelector(){const{messages:t}=this;return N(_f,{key:"unit-selector-label",options:this.unitOptions,selectLabel:(t==null?void 0:t.unitSelectLabel)??"",value:this.unit,onChange:this.onUnitChange})}_renderUniformChartScalingToggle(){const{messages:t}=this,e=this.uniformChartScaling,i=`${this.id}__uniform-chart-scaling-toggle`,r=(t==null?void 0:t[e?"uniformChartScalingDisable":"uniformChartScalingEnable"])??"";return N("calcite-label",{class:L$.uniformChartScalingLabel,key:"uniform-chart-scaling-label",layout:"inline"},N("calcite-checkbox",{checked:e,class:L$.uniformChartScalingCheckbox,id:i,onCalciteCheckboxChange:this._onUniformChartScalingChange}),N("calcite-tooltip",{overlayPositioning:"fixed",referenceElement:i},r),t==null?void 0:t.uniformChartScalingLabel)}};m([b()],wl.prototype,"messages",void 0),m([b()],wl.prototype,"onUniformChartScalingChange",void 0),m([b()],wl.prototype,"onUnitChange",void 0),m([b()],wl.prototype,"uniformChartScaling",void 0),m([b()],wl.prototype,"unit",void 0),m([b()],wl.prototype,"unitOptions",void 0),m([b()],wl.prototype,"visibleElements",void 0),m([b()],wl.prototype,"_popover",void 0),m([b()],wl.prototype,"_popoverIsOpen",void 0),wl=m([G("esri.widgets.ElevationProfile.components.SettingsButton")],wl);var Vo;(function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"})(Vo||(Vo={}));const Yw=[{type:Vo.Select},{type:Vo.Sketch}],Bqe={[_n.None]:null,[_n.NoValidInput]:"noProfile",[_n.NoVisibleProfiles]:"noProfile",[_n.RefinedButNoChartData]:"noProfile",[_n.TooComplex]:"tooComplex",[_n.UnknownError]:"unknown",[_n.InvalidGeometry]:"invalidGeometry",[_n.InvalidElevationInfo]:"invalidElevationInfo"},b4=Symbol("resize-observer-handle");let qi=class extends vi{constructor(t,e){super(t,e),this.viewModel=null,this.visibleElements=new jue,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._contentWrapper=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=Hu((i,r,n,o)=>({chart:i,data:r,stationary:n,messages:o})),this._onZoomOutButtonClick=()=>{var i;(i=this._chart)==null||i.zoomOut()},this._onClearButtonClick=()=>{this.viewModel.clear()},t!=null&&t.viewModel||(this._defaultViewModel=new Due({view:t==null?void 0:t.view}),this.viewModel=this._defaultViewModel)}loadDependencies(){return zi({action:()=>ie(()=>import("./calcite-action-DBBzvUB2.js"),__vite__mapDeps([232,233,220,221,224,225,226,227,223,228,229,230])),button:()=>ie(()=>import("./calcite-button-BzJqMxwJ.js"),__vite__mapDeps([217,218,219,220,221,222,223,224,225,226,227,228,229,230])),loader:()=>ie(()=>import("./calcite-loader-BdVH7ICK.js"),__vite__mapDeps([265,230,220,225,226,227]))})}postInitialize(){this.addHandles([ce(()=>({container:this._chartContainer,width:this._width}),({container:t,width:e})=>{this._destroyChart(),t!=null&&e>0&&this._initializeChart(t)},Qe),ce(()=>this._chartUpdateParams,()=>this._updateChart(this._chartUpdateParams),Qe)])}destroy(){this._destroyChart(),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get input(){return this.viewModel.input}set input(t){this.viewModel.input=t}get profiles(){return this.viewModel.profiles}set profiles(t){this.viewModel.profiles=t}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(t){this.viewModel.unitOptions=t}get unit(){return this.viewModel.unit}set unit(t){this.viewModel.unit=t}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(t){this.viewModel.geodesicDistanceThreshold=t}get icon(){return"altitude"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}get _portrait(){return this._width<Vl().portraitModePixelBreakpoint}get _chartUpdateParams(){const t=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,t==null||t.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _profilesArray(){return this.profiles.toArray()}render(){const{viewModel:t,visible:e}=this;return N("div",{"aria-label":this.messages.widgetLabel,class:this.classes({[Yr.base]:e,[Ee.widget]:e,[Ee.panel]:e,[Ee.widgetDisabled]:e&&t.state==="disabled",[Yr.portrait]:this._portrait,[Yr.refined]:t.progress===1}),key:this},N("div",{afterCreate:this._onContentWrapperUpdate,afterRemoved:this._onContentWrapperRemoved,afterUpdate:this._onContentWrapperUpdate,bind:this,key:"content-wrapper"},e?this._renderContentForState():null))}_renderContentForState(){switch(this.viewModel.state){case Ho.Ready:return this._renderContentForReadyState();case Ho.Selecting:return this._renderContentForSelectingState();case Ho.Creating:return this._renderContentForCreatingState();case Ho.Selected:return this._renderContentForSelectedState();case Ho.Created:return this._renderContentForCreatedState();case Ho.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var n;const{sketchButton:t,selectButton:e}=this.visibleElements,i=this.messages;let r;return r=t&&e?i.readyPrompt:t?i.readyPromptCreateOnly:e?i.readyPromptSelectOnly:(n=i.errors)==null?void 0:n.noProfile,this._renderContent({prompt:r,chart:!1,actions:Yw})}_renderContentForSelectingState(){const t=this.view;if(t==null)return null;const e=this.messages[`selectingPrompt-${t.type}`];return this._renderContent({prompt:e,chart:!1,actions:[{type:Vo.SelectCancel}]})}_renderContentForCreatingState(){const{view:t,viewModel:e}=this;if(t==null)return null;const i=e.hasVertices?[{type:Vo.SketchCancel},{type:Vo.SketchDone,disabled:!e.tool.interaction.canStopCreating}]:[{type:Vo.Select},{type:Vo.Sketch,disabled:!0}];if(e.errorState===_n.NoValidInput){const n=this.messages[`creatingPrompt-${t.type}`];return this._renderContent({chart:!1,actions:i,prompt:n})}const r=this._getErrorMessage();return r?this._renderContent({chart:!1,actions:i,prompt:r}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Yw,prompt:t}):this._renderContent({chart:!0,actions:Yw})}_renderContentForCreatedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Yw,prompt:t}):this._renderContent({chart:!0,actions:Yw})}_getErrorMessage(){var e,i;const t=Bqe[this.viewModel.errorState];return t?(i=(e=this.messages)==null?void 0:e.errors)==null?void 0:i[t]:null}_renderContent(t){const e=t.prompt!=null?this._renderPrompt(t.prompt):t.chart&&this._renderChart(),{viewModel:i}=this,r=i.input!=null;return N(Jf,null,N("header",{class:Yr.header,key:"header"},this._zoomOutButtonVisible?this._renderZoomOutButton():null,this.visibleElements.clearButton&&r?this._renderClearButton():null,this.visibleElements.settingsButton?N(wl,{messages:this.messages,uniformChartScaling:i.uniformChartScaling,unit:i.unit,unitOptions:i.unitOptions,visibleElements:this.visibleElements,onUniformChartScalingChange:n=>i.uniformChartScaling=n,onUnitChange:n=>i.unit=n}):null),N("div",{class:Yr.mainContainer,key:"main-container"},e),this.visibleElements.legend?N(zy,{effectiveUnits:i.effectiveUnits,messages:this.messages,profiles:this._profilesArray}):null,this._renderActions(t))}_renderZoomOutButton(){const t=this.messages.zoomOut;return N("calcite-action",{appearance:"transparent",class:Yr.zoomOutButton,"data-testid":"zoom-out-button",icon:"magnifying-glass-minus",key:"zoom-out",onclick:this._onZoomOutButtonClick,scale:"s",text:t,title:t})}_renderClearButton(){const t=this.messages.clearProfile;return N("calcite-action",{appearance:"transparent",class:Yr.clearButton,"data-testid":"clear-button",icon:"trash",key:"clear-profile",onclick:this._onClearButtonClick,scale:"s",text:t,title:t})}_renderPrompt(t){return[N("div",{bind:this,class:Yr.promptContainer,key:"prompt-container"},N("p",null,t))]}_renderChart(){if(!this.visibleElements.chart)return N("div",{class:Yr.chartContainer,key:"empty-chart-container"});const{chartData:t,progress:e}=this.viewModel,i=this._chartIsRefined||this._canRenderChart(),r=t!=null&&e<1;return i?N(Jf,null,this._renderSpinner({size:i?"small":"large",visible:r}),N("div",{afterCreate:this._onChartContainerUpdate,afterRemoved:this._onChartContainerRemoved,afterUpdate:this._onChartContainerUpdate,bind:this,class:Yr.chartContainer,key:"chart-container"})):N(Jf,null,this._renderSpinner({size:"large",visible:r}),N("div",{class:Yr.chartContainer,key:"chart-container-empty"}))}_renderSpinner(t){const e=t.size==="small",i=t.visible??!0;return N("calcite-loader",{class:this.classes(Yr.chartSpinner,e&&Yr.chartSpinnerSmall,i&&Yr.chartSpinnerVisible),inline:e,key:"spinner",label:"",scale:"s"})}_canRenderChart(){const t=this.viewModel.chartData;if(t==null)return!1;if(!this.viewModel.inputIsSketched)return t.refined;let e=0;for(const{samples:i}of t.lines)e+=i!=null?i.length:0;return t.refined||e<=Vl().largeChartSamples}_renderActions({actions:t}){const e=t.map(i=>{switch(i.type){case Vo.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:i,className:Yr.sketchButton,label:this.messages.sketchButtonLabel,onClick:this._onSketchButtonClick,primary:!0});case Vo.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:i,onClick:this._onCancelButtonClick,className:Yr.sketchCancelButton,label:this.messagesCommon.cancel,primary:!1});case Vo.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:i,onClick:this._onDoneButtonClick,className:Yr.sketchDoneButton,label:this.messagesCommon.done,primary:!0});case Vo.Select:return this.visibleElements.selectButton&&this._renderAction({action:i,onClick:this._onSelectButtonClick,className:Yr.selectButton,label:this.messages.selectButtonLabel,primary:!1});case Vo.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:i,onClick:this._onCancelButtonClick,className:Yr.selectCancelButton,label:this.messagesCommon.cancel,primary:!1})}}).filter(Boolean);return e.length?N("footer",{class:Yr.footer,key:"footer"},e):null}_renderAction({action:t,className:e,label:i,onClick:r,primary:n}){return N("calcite-button",{appearance:n?"solid":"outline-fill",bind:this,class:this.classes(Yr.actionButton,e),disabled:t.disabled,key:`action-${t.type}`,onclick:r},i)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperUpdate(t){t!==this._contentWrapper&&(this._contentWrapper=t,this.removeHandles(b4),this.addHandles(yR(t,e=>{this._width=e.contentRect.width}),b4))}_onContentWrapperRemoved(){this.removeHandles(b4),this._contentWrapper=null}_updateChart(t){const{data:e,chart:i,messages:r,stationary:n}=t;i!=null&&r!=null&&n&&this._canRenderChart()&&(i.update(t),this._chartIsRefined=e!=null&&e.refined)}_onChartContainerUpdate(t){this._chartContainer=t}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(t){En(this._chartInitTask),this._chartInitTask=Sh(async e=>{const{createChart:i}=await ie(()=>import("./chartUtils-B0ZcHlLN.js"),__vite__mapDeps([355,356,357,358,359,360,361,362,363,364]));At(e);const r=await i({container:t,abortOptions:{signal:e},onRangeChange:(n,o)=>{this._zoomOutButtonVisible=n!==1||o!==1},onCursorPositionChange:n=>{this.viewModel.hoveredChartPosition=n}});if(e.aborted)throw ot(r),ni();this._chart=r,this._updateChart(this._chartUpdateParams)})}_destroyChart(){this._chartInitTask=En(this._chartInitTask),this._chart=ot(this._chart),this._chartIsRefined=!1}};m([b({type:Due})],qi.prototype,"viewModel",void 0),m([b()],qi.prototype,"view",null),m([b()],qi.prototype,"input",null),m([b()],qi.prototype,"profiles",null),m([b()],qi.prototype,"unitOptions",null),m([b()],qi.prototype,"unit",null),m([b()],qi.prototype,"geodesicDistanceThreshold",null),m([b({type:jue,nonNullable:!0})],qi.prototype,"visibleElements",void 0),m([b()],qi.prototype,"icon",null),m([b()],qi.prototype,"label",null),m([b()],qi.prototype,"visible",null),m([b(),vt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],qi.prototype,"messages",void 0),m([b(),vt("esri/t9n/common")],qi.prototype,"messagesCommon",void 0),m([b(),vt("esri/core/t9n/Units")],qi.prototype,"messagesUnits",void 0),m([b()],qi.prototype,"_contentWrapper",void 0),m([b()],qi.prototype,"_chartContainer",void 0),m([b()],qi.prototype,"_chart",void 0),m([b()],qi.prototype,"_chartInitTask",void 0),m([b()],qi.prototype,"_chartIsRefined",void 0),m([b()],qi.prototype,"_width",void 0),m([b()],qi.prototype,"_portrait",null),m([b()],qi.prototype,"_zoomOutButtonVisible",void 0),m([b()],qi.prototype,"_chartUpdateParams",null),m([b()],qi.prototype,"_chartMessages",null),m([b()],qi.prototype,"_profilesArray",null),qi=m([G("esri.widgets.ElevationProfile")],qi);const qqe=qi;let Hs;window.parent.postMessage("ready","*");const rW=new URL(window.location.href),qS="b4cfa4a48dbb49b8b150c14bb6cca6f9",HS="https://www.arcgis.com";if(rW.searchParams.get("locale")&&Sn>4.15){const t=rW.searchParams.get("locale");Sfe(t),console.log(Sn,"-- locale:",t)}console.log(Sn,"-- webmap:",qS,"from",HS);footerDiv.innerHTML+=" <a href='about.html' target='_blank'>About</a> this app";footerDiv.innerHTML+=" -- <a target='_blank' href='"+HS+"/home/item.html?id="+qS+"'>item page</a>";footerDiv.innerHTML+=" -- <a target='_blank' href='"+HS+"/sharing/rest/content/items/"+qS+"/data?f=pjson'>webmap JSON</a>";Ct.portalUrl=HS;Hs=new j5e({portalItem:{id:qS,portal:HS}});Hs.when(function(){cH.getPropertiesFromWebMap(Hs).then(t=>{if(t){console.log(Sn,"-- timeslider smartness added at 4.22:",t);const e=new cH({container:"timeSlider",...t,view:Ht});Ht.ui.add(e,"manual")}else console.log(Sn,"-- no timeslider properties.")}),console.log(Sn,"-- webmap (version "+Hs.resourceInfo.version+") with "+Hs.resourceInfo.operationalLayers.length+" operational layers and "+Hs.resourceInfo.baseMap.baseMapLayers.length+" basemap layers."),Hs.bookmarks&&Hs.bookmarks.length?(console.log(Sn,"-- webmap has",Hs.bookmarks.length,"bookmarks."),nW()):(editbookmarks&&editbookmarks!="false"&&(console.log(Sn,"-- editbookmarks:",editbookmarks),nW()),debug&&console.log(Sn,"No bookmarks in this webmap.")),show.includes("editor")&&Hqe(),show.includes("basemaptoggle")&&Wqe()}).catch(function(t){versionDiv.innerHTML+="<font color='red'><br><br><i>Hmm, we got a problem!</i><br><br>",t.name&&(versionDiv.innerHTML+="<b>name:</b> "+t.name+"<br>"),t.message&&(versionDiv.innerHTML+="<b>message:</b> "+t.message+"<br>"),t.details&&(versionDiv.innerHTML+="<b>details:</b> "+JSON.stringify(t.details)+"<br>")});const Ht=new Y6e({container:"viewDiv",map:Hs,padding:{bottom:40}});Ht.when(function(){{Hs.ground="world-topobathymetry";const w=new qqe({view:Ht});Ht.ui.add(w,"bottom-right")}ce(()=>Ht.stationary,w=>{scaleDiv.innerHTML="1:"+Ht.scale,scaleDiv.style.display="block",Ht.zoom,Ht.zoom=="-1"?(zoomDiv.innerHTML="No LODs",zoomDiv.style.display="block"):(zoomDiv.innerHTML="L:"+Ht.zoom,zoomDiv.style.display="block")});const t=new Zy({view:Ht,expandTooltip:"webmap metadata",content:"<div class='esri-widget' style='width:400px;padding:3px;border:thin solid darkgray;border-radius:9px;'>WebMap title: <a target='_blank' href='"+Ct.portalUrl+"/home/item.html?id="+qS+"'>"+Hs.portalItem.title+"</a><br>Created: "+new Date(Hs.portalItem.created).toLocaleString()+"<br>Last modified: "+new Date(Hs.portalItem.modified).toLocaleString()+"<br>Owner: "+Hs.portalItem.owner+"</div>",expanded:!0});Ht.ui.add(t,{position:"top-left",index:0});let e=0;Hs.layers.items.forEach(function(w){if(console.log(Sn,"----",++e+". '"+w.type+"' layer: ",w.title,"--",w.id),w.type=="feature"&&w.source&&(w.url?console.log(Sn,"------ Service-based FL on the way",w):w.source?console.log(Sn,"------ Featurecollection FL on the way?",w):console.log(Sn,"------ Hmm, what FL is on the way?",w),Ht.whenLayerView(w).then(function(T){w&&w.source&&w.source.items&&(console.log(Sn,"------ items in featurecollection",w.source.items.length),w.source.items.forEach(function(E){E.attributes.No_Storeys&&console.log(Sn,"item",E.attributes.GlobalID,"has",E.attributes.No_Storeys)}))})),w.loadError){var S=w.loadError;S.name==="layer:unknown-layer-type"&&(versionDiv.innerHTML+="<font color='red'><br><br><i>unknown layer type</i><br><br>",S.name&&(versionDiv.innerHTML+="<b>name:</b> "+S.name+"<br>"),S.message&&(versionDiv.innerHTML+="<b>message:</b> "+S.message+"<br>"),S.details&&(versionDiv.innerHTML+="<b>details:</b> "+JSON.stringify(S.details)+"<br>")),console.log("layer",w.loadError)}else w.accessInformation&&console.log(Sn,"layer.accessInformation:",w.accessInformation),w.portalItem&&console.log(Sn,"layer.portalItem:",w.portalItem)});const i=new Tne({view:Ht}),r=new rAe({view:Ht});Ht.ui.add([r,i],"top-left");const n=new Zy({view:Ht,content:new pUe({view:Ht})}),o=new Zy({view:Ht,content:new wle({view:Ht}),group:"bottomrightgroup"}),u=new Zy({view:Ht,content:new gje({view:Ht})}),p=new Zy({view:Ht,content:new rUe({view:Ht})});Ht.ui.add([p,u],{position:"top-right"}),Ht.ui.add([o],{position:"bottom-right"});const g=new uUe({view:Ht,unit:"dual"});Ht.ui.add(g,{position:"bottom-right"}),Ht.ui.add([n],{position:"bottom-left"})});versionDiv.innerHTML="v"+Sn;versionDiv.style.display="block";function nW(){const t=new Zy({view:Ht,content:new eAe({view:Ht,editingEnabled:editbookmarks}),expanded:!1,group:"goodidea"});Ht.ui.add(t,{position:"top-right"})}function Hqe(){const t=new Zy({view:Ht,content:new aDe({view:Ht}),expanded:!0,group:"bottomrightgroup"});Ht.ui.add(t,{position:"bottom-right"})}function Wqe(){const t=new vje({view:Ht,nextBasemap:"osm"});Ht.ui.add(t,"bottom-right")}export{Ce as $,nP as A,QHe as B,wr as C,nt as D,xW as E,$W as F,Ki as G,YQe as H,Zr as I,Xqe as J,fe as K,CWe as L,nce as M,dHe as N,xm as O,THe as P,ppe as Q,em as R,Nl as S,Cn as T,Uye as U,ib as V,Ipe as W,VK as X,pH as Y,Vre as Z,ie as _,eTe as a,nc as a$,UK as a0,xv as a1,GK as a2,zK as a3,kj as a4,wZe as a5,iJe as a6,a0 as a7,An as a8,xb as a9,Zqe as aA,Zu as aB,Ra as aC,rt as aD,m as aE,b as aF,OYe as aG,GTe as aH,Me as aI,Le as aJ,Bn as aK,G as aL,ye as aM,J3 as aN,jt as aO,Du as aP,xS as aQ,$S as aR,BTe as aS,gb as aT,ec as aU,dm as aV,Gke as aW,gQe as aX,bQe as aY,Woe as aZ,s0 as a_,wre as aa,CW as ab,bs as ac,_s as ad,J5 as ae,ea as af,Xx as ag,fJe as ah,Xie as ai,ime as aj,sm as ak,me as al,DB as am,jB as an,LWe as ao,Hp as ap,We as aq,JB as ar,EHe as as,qee as at,Nt as au,OCe as av,iet as aw,KQe as ax,ret as ay,XQe as az,Rte as b,YHe as b$,Bb as b0,Ar as b1,Te as b2,Ua as b3,ot as b4,Rit as b5,gi as b6,FJe as b7,Hm as b8,ce as b9,tZe as bA,SZe as bB,Jp as bC,BJ as bD,r5 as bE,KXe as bF,yre as bG,kR as bH,nO as bI,gre as bJ,mre as bK,ure as bL,c3 as bM,om as bN,_4 as bO,k4e as bP,yW as bQ,Gt as bR,Sh as bS,os as bT,Srt as bU,H3 as bV,V5e as bW,RN as bX,V3e as bY,L5 as bZ,eSe as b_,Qe as ba,Ie as bb,Wm as bc,Y2e as bd,tw as be,Cr as bf,Rt as bg,Eh as bh,gh as bi,Ts as bj,hr as bk,xo as bl,Ke as bm,Ba as bn,H4 as bo,gr as bp,q4 as bq,J4 as br,rE as bs,Mte as bt,Uie as bu,ae as bv,q$ as bw,u8 as bx,Cj as by,mJe as bz,qWe as c,cn as c$,kWe as c0,Rb as c1,w4 as c2,SYe as c3,_Ye as c4,wm as c5,Si as c6,iNe as c7,oae as c8,aae as c9,tS as cA,lye as cB,GZ as cC,yBe as cD,yN as cE,Ko as cF,ta as cG,x0e as cH,$h as cI,CTe as cJ,PYe as cK,Gl as cL,Qt as cM,oF as cN,Z7e as cO,$8 as cP,uZe as cQ,$Ze as cR,Wr as cS,lit as cT,Wie as cU,id as cV,Jn as cW,Bp as cX,bq as cY,xq as cZ,kn as c_,Pwe as ca,Rwe as cb,Fwe as cc,be as cd,r0e as ce,un as cf,xs as cg,xue as ch,uye as ci,GI as cj,Bu as ck,xye as cl,ad as cm,rYe as cn,FV as co,TZ as cp,Cm as cq,PV as cr,tre as cs,DJe as ct,u0 as cu,Qf as cv,ki as cw,s0e as cx,o0e as cy,o3 as cz,Fte as d,et as d$,dh as d0,_I as d1,SI as d2,sw as d3,OD as d4,cb as d5,JM as d6,RS as d7,GS as d8,Xi as d9,FWe as dA,v9e as dB,jZ as dC,_We as dD,OZ as dE,lF as dF,BBe as dG,AP as dH,$ye as dI,sD as dJ,YJ as dK,XJ as dL,aw as dM,Nr as dN,bH as dO,Dt as dP,d5e as dQ,vTe as dR,Ede as dS,IKe as dT,AKe as dU,SC as dV,db as dW,P3 as dX,fh as dY,Zi as dZ,LKe as d_,cr as da,Pet as db,sHe as dc,rce as dd,lJ as de,$I as df,_P as dg,Q3 as dh,s3 as di,Of as dj,ja as dk,Cfe as dl,AI as dm,Afe as dn,bte as dp,ZHe as dq,IWe as dr,AWe as ds,gZe as dt,sZe as du,pJe as dv,sJe as dw,Th as dx,U3 as dy,k9e as dz,eYe as e,Y3e as e$,ze as e0,bZe as e1,Ss as e2,cce as e3,C0e as e4,y0e as e5,Z0e as e6,mWe as e7,lt as e8,zne as e9,tP as eA,gce as eB,vh as eC,dM as eD,$me as eE,XKe as eF,KOe as eG,Ln as eH,uOe as eI,F3 as eJ,W2 as eK,wse as eL,jtt as eM,AS as eN,B_e as eO,cOe as eP,TZe as eQ,SKe as eR,dee as eS,Jee as eT,pTe as eU,Dte as eV,sSe as eW,m$e as eX,tTe as eY,XI as eZ,uTe as e_,Ll as ea,QJ as eb,RQ as ec,V8 as ed,Ave as ee,NJe as ef,ra as eg,rS as eh,mve as ei,Mv as ej,$X as ek,VJe as el,mE as em,e8 as en,jJe as eo,Jo as ep,RWe as eq,Wo as er,Y3 as es,Oue as et,P7 as eu,R7 as ev,Ul as ew,hHe as ex,Ape as ey,Sm as ez,Ge as f,xK as f$,CSe as f0,gl as f1,ut as f2,Hnt as f3,qnt as f4,nE as f5,Di as f6,lP as f7,gTe as f8,fE as f9,Qb as fA,na as fB,U1e as fC,z1e as fD,Kye as fE,Da as fF,oC as fG,nh as fH,So as fI,$s as fJ,nr as fK,iZ as fL,NZ as fM,DZ as fN,Js as fO,oit as fP,rit as fQ,sit as fR,ZSe as fS,R5 as fT,t0 as fU,Bf as fV,Zm as fW,oR as fX,nJe as fY,Ete as fZ,dJe as f_,WSe as fa,WP as fb,zt as fc,ri as fd,U7e as fe,Vl as ff,Kf as fg,Poe as fh,Roe as fi,rc as fj,kF as fk,uw as fl,iit as fm,Hu as fn,Pit as fo,Oit as fp,zl as fq,JW as fr,IF as fs,Vtt as ft,Et as fu,Xue as fv,Um as fw,YSe as fx,JSe as fy,Es as fz,jI as g,H$e as g$,Wn as g0,LS as g1,PD as g2,Ef as g3,r3 as g4,Bee as g5,jb as g6,xrt as g7,Tpe as g8,zpe as g9,Vx as gA,V7 as gB,$9e as gC,D5 as gD,xI as gE,gO as gF,$2 as gG,Wu as gH,aS as gI,UHe as gJ,$U as gK,En as gL,Sn as gM,K7 as gN,Fr as gO,wn as gP,vP as gQ,yfe as gR,dme as gS,w9e as gT,S9e as gU,fre as gV,R2 as gW,Fb as gX,Mr as gY,Zce as gZ,IHe as g_,bAe as ga,Nx as gb,kV as gc,tYe as gd,td as ge,q2 as gf,RLe as gg,ed as gh,Ett as gi,Dp as gj,WWe as gk,qt as gl,Wre as gm,Nm as gn,In as go,qn as gp,iW as gq,o0 as gr,PUe as gs,as as gt,jR as gu,Yue as gv,I3 as gw,kr as gx,wo as gy,NTe as gz,tet as h,lL as h$,ZT as h0,eWe as h1,Qo as h2,wxe as h3,z3e as h4,RV as h5,BT as h6,iYe as h7,JA as h8,Db as h9,w0 as hA,nv as hB,$L as hC,Fp as hD,rHe as hE,bm as hF,Pa as hG,ji as hH,FS as hI,APe as hJ,aot as hK,lot as hL,zPe as hM,Vi as hN,MF as hO,Ho as hP,hR as hQ,km as hR,w$e as hS,f$e as hT,zSe as hU,xj as hV,mX as hW,wTe as hX,J8 as hY,mM as hZ,rk as h_,$rt as ha,Ru as hb,Vee as hc,DTe as hd,H7e as he,rte as hf,VZe as hg,GWe as hh,tc as hi,crt as hj,Gm as hk,V0e as hl,NWe as hm,hH as hn,qr as ho,us as hp,vit as hq,Ju as hr,Qse as hs,vK as ht,vB as hu,rae as hv,Sl as hw,BFe as hx,ii as hy,lh as hz,Q$e as i,fHe as i$,W8 as i0,cM as i1,H2e as i2,HSe as i3,sR as i4,dTe as i5,Yi as i6,hce as i7,FD as i8,Vte as i9,sxe as iA,axe as iB,lxe as iC,uxe as iD,cxe as iE,hxe as iF,pxe as iG,dxe as iH,fxe as iI,yxe as iJ,jte as iK,KSe as iL,net as iM,Nrt as iN,zrt as iO,Wrt as iP,Zrt as iQ,Yrt as iR,JNe as iS,jrt as iT,Grt as iU,qrt as iV,E3 as iW,Mtt as iX,Ttt as iY,Itt as iZ,set as i_,qf as ia,Fpe as ib,hh as ic,ws as id,Xu as ie,_3 as ig,K8 as ih,QSe as ii,XSe as ij,zb as ik,mxe as il,Oee as im,rd as io,F8 as ip,OQ as iq,MQ as ir,IQ as is,EQ as it,Vxe as iu,OSe as iv,_xe as iw,tSe as ix,rxe as iy,nxe as iz,zye as j,uc as j$,_S as j0,nHe as j1,O3 as j2,ihe as j3,Xo as j4,Zo as j5,ni as j6,Cl as j7,NO as j8,Mi as j9,$xe as jA,cL as jB,MYe as jC,Ixe as jD,Mxe as jE,Wnt as jF,vI as jG,kf as jH,PW as jI,qle as jJ,HQ as jK,z8 as jL,rSe as jM,nSe as jN,fm as jO,wte as jP,MI as jQ,IJ as jR,AJ as jS,K$e as jT,De as jU,an as jV,QKe as jW,lpe as jX,QM as jY,aI as jZ,SNe as j_,Yse as ja,hPe as jb,C8 as jc,cPe as jd,Xse as je,_it as jf,nd as jg,ioe as jh,$it as ji,UM as jj,FPe as jk,VI as jl,ph as jm,Let as jn,KWe as jo,Xp as jp,gK as jq,zr as jr,GSe as js,IE as jt,PQ as ju,wYe as jv,hte as jw,G7 as jx,mh as jy,h1 as jz,QQe as k,QWe as k$,zi as k0,N as k1,Ee as k2,LNe as k3,ENe as k4,TNe as k5,JZ as k6,sH as k7,cUe as k8,vt as k9,Ite as kA,vce as kB,c8 as kC,rZe as kD,eZe as kE,qse as kF,K as kG,dWe as kH,G3 as kI,ome as kJ,sme as kK,cJe as kL,DE as kM,UZe as kN,GZe as kO,zZe as kP,Jre as kQ,sce as kR,JHe as kS,hpe as kT,CI as kU,tWe as kV,Gve as kW,Bve as kX,EKe as kY,DK as kZ,gJe as k_,v0 as ka,$Ne as kb,vi as kc,LPe as kd,ait as ke,Zie as kf,RE as kg,Sb as kh,EM as ki,tO as kj,_R as kk,rw as kl,jHe as km,O8e as kn,Ije as ko,aB as kp,h0 as kq,Hoe as kr,Sje as ks,Om as kt,o7 as ku,o9 as kv,Wt as kw,EC as kx,JP as ky,Tl as kz,ine as l,YX as l$,Kwe as l0,qZe as l1,EI as l2,Ebe as l3,tue as l4,Ft as l5,MP as l6,zZ as l7,gde as l8,U7 as l9,kSe as lA,VSe as lB,i$e as lC,b$e as lD,hTe as lE,qc as lF,sbe as lG,Yp as lH,F2e as lI,CJe as lJ,xxe as lK,_rt as lL,ZNe as lM,KNe as lN,wrt as lO,nit as lP,Hf as lQ,XV as lR,l3 as lS,kG as lT,IG as lU,BS as lV,yue as lW,eBe as lX,Loe as lY,Pp as lZ,y8 as l_,PHe as la,OHe as lb,ahe as lc,YW as ld,iHe as le,ice as lf,aJe as lg,RI as lh,W$ as li,K3 as lj,pfe as lk,bfe as ll,X3 as lm,SWe as ln,B2 as lo,uS as lp,LX as lq,OX as lr,ONe as ls,Ks as lt,xNe as lu,EB as lv,T8 as lw,ZP as lx,r0 as ly,MSe as lz,kC as m,m0e as m$,qbe as m0,Kb as m1,Pf as m2,sv as m3,cB as m4,KUe as m5,SW as m6,OJ as m7,iP as m8,WHe as m9,t9 as mA,QZe as mB,mFe as mC,Cit as mD,lMe as mE,Ait as mF,qm as mG,Nu as mH,YZe as mI,Qwe as mJ,_9e as mK,bMe as mL,TM as mM,Vp as mN,OWe as mO,EP as mP,HP as mQ,l0 as mR,KHe as mS,WW as mT,q0 as mU,Ibe as mV,nZe as mW,Q7 as mX,cye as mY,PZ as mZ,aye as m_,eZ as ma,j4 as mb,wZ as mc,rCe as md,iWe as me,Kse as mf,dot as mg,dYe as mh,bnt as mi,zu as mj,vnt as mk,xnt as ml,mnt as mm,pnt as mn,gnt as mo,fnt as mp,ynt as mq,$nt as mr,_nt as ms,snt as mt,Snt as mu,hnt as mv,cnt as mw,dnt as mx,mse as my,_ie as mz,Jte as n,JOe as n$,oye as n0,LP as n1,uF as n2,yH as n3,EUe as n4,Eye as n5,Tye as n6,S7 as n7,yZe as n8,mZe as n9,RX as nA,aYe as nB,Ore as nC,iSe as nD,Ynt as nE,Znt as nF,vZ as nG,pWe as nH,Mn as nI,CM as nJ,are as nK,cre as nL,t9e as nM,YXe as nN,u9e as nO,jv as nP,XXe as nQ,C3 as nR,z9e as nS,vee as nT,k2e as nU,ew as nV,b8 as nW,awe as nX,lwe as nY,mS as nZ,yQ as n_,dt as na,kv as nb,fwe as nc,LBe as nd,aPe as ne,SBe as nf,pg as ng,NSe as nh,T9e as ni,XZe as nj,Xm as nk,U_e as nl,Wy as nm,aHe as nn,lHe as no,oHe as np,kpe as nq,Z3 as nr,tye as ns,nPe as nt,J0e as nu,K0e as nv,_W as nw,vo as nx,oYe as ny,vde as nz,aXe as o,gWe as o$,Ewe as o0,ZOe as o1,w8 as o2,_E as o3,hQ as o4,L2 as o5,OZe as o6,PZe as o7,RZe as o8,ant as o9,IM as oA,ES as oB,Sv as oC,cZ as oD,aZ as oE,Gde as oF,PI as oG,Gp as oH,zp as oI,zMe as oJ,SR as oK,PBe as oL,_Be as oM,YWe as oN,hRe as oO,nme as oP,iRe as oQ,i2 as oR,HE as oS,qa as oT,eB as oU,wO as oV,a8e as oW,NR as oX,Bde as oY,aF as oZ,kS as o_,Int as oa,ont as ob,Iae as oc,Mnt as od,Ent as oe,Tnt as of,sN as og,lnt as oh,wnt as oi,unt as oj,lM as ok,c0e as ol,vJe as om,RZ as on,IP as oo,pve as op,av as oq,ln as or,bo as os,qxe as ot,$o as ou,Kp as ov,HWe as ow,xKe as ox,VB as oy,th as oz,uR as p,Tit as p$,Soe as p0,WE as p1,qo as p2,EF as p3,r8e as p4,ic as p5,Bne as p6,xoe as p7,uAe as p8,l8e as p9,Uet as pA,VZ as pB,kit as pC,Cet as pD,Aet as pE,cAe as pF,Fet as pG,QU as pH,sAe as pI,Jit as pJ,pZ as pK,vWe as pL,dPe as pM,Am as pN,Sit as pO,zoe as pP,jet as pQ,ARe as pR,g0 as pS,sMe as pT,_Me as pU,k8 as pV,v3 as pW,aM as pX,ePe as pY,PS as pZ,VM as p_,Ret as pa,Jr as pb,aFe as pc,zet as pd,Net as pe,M3 as pf,eJ as pg,tit as ph,kH as pi,RG as pj,nF as pk,q7e as pl,L8e as pm,Lu as pn,J7e as po,yit as pp,od as pq,hMe as pr,pMe as ps,i9 as pt,S0e as pu,SMe as pv,iFe as pw,wh as px,qRe as py,Foe as pz,GCe as q,TX as q$,br as q0,gm as q1,pF as q2,eoe as q3,XWe as q4,GR as q5,jl as q6,eLe as q7,ttt as q8,itt as q9,ott as qA,htt as qB,ctt as qC,ptt as qD,dtt as qE,tAe as qF,Jf as qG,$n as qH,LM as qI,Kq as qJ,AO as qK,jGe as qL,yst as qM,G7e as qN,xn as qO,fS as qP,RB as qQ,CKe as qR,UB as qS,jSe as qT,Moe as qU,kve as qV,LJe as qW,PJe as qX,OJe as qY,RJe as qZ,_o as q_,n8 as qa,rtt as qb,Xne as qc,Jue as qd,stt as qe,NAe as qf,OAe as qg,ntt as qh,zR as qi,kAe as qj,tbe as qk,qAe as ql,Qnt as qm,kie as qn,Kne as qo,utt as qp,ebe as qq,gE as qr,bE as qs,y3 as qt,GLe as qu,att as qv,ltt as qw,MAe as qx,JAe as qy,CS as qz,eet as r,_Ke as r$,wN as r0,AJe as r1,CMe as r2,Hy as r3,F4e as r4,Jqe as r5,Qc as r6,eC as r7,HJ as r8,cP as r9,fWe as rA,yWe as rB,wNe as rC,hCe as rD,lq as rE,rq as rF,Qye as rG,nq as rH,Q_e as rI,wq as rJ,JWe as rK,sq as rL,yJe as rM,hq as rN,Mq as rO,kq as rP,Cq as rQ,yme as rR,eJe as rS,tme as rT,Aq as rU,tJe as rV,g9e as rW,cKe as rX,uA as rY,uKe as rZ,TKe as r_,Z4 as ra,MJe as rb,tG as rc,ett as rd,Bet as re,Jet as rf,FM as rg,qet as rh,Het as ri,Wet as rj,Xet as rk,Zet as rl,Ket as rm,Yet as rn,Qet as ro,YI as rp,Tde as rq,sE as rr,Kit as rs,Zit as rt,OF as ru,nUe as rv,Uu as rw,rhe as rx,LHe as ry,Dde as rz,re as s,mH as s$,vKe as s0,gKe as s1,bKe as s2,wKe as s3,Jj as s4,Kj as s5,Zj as s6,yKe as s7,mKe as s8,Vq as s9,GQe as sA,XHe as sB,Xde as sC,Yde as sD,bWe as sE,FSe as sF,Phe as sG,Knt as sH,xD as sI,HKe as sJ,pP as sK,E3e as sL,NKe as sM,FKe as sN,eb as sO,bU as sP,I0e as sQ,IUe as sR,gH as sS,tot as sT,iS as sU,Q0e as sV,Y0e as sW,X0e as sX,p3 as sY,c0 as sZ,Gpe as s_,QB as sa,BB as sb,qB as sc,HB as sd,pq as se,jq as sf,Uq as sg,eq as sh,tM as si,rJe as sj,dKe as sk,fKe as sl,QQ as sm,aKe as sn,aee as so,uM as sp,pKe as sq,e2e as sr,$Ke as ss,hKe as st,X_e as su,L8 as sv,MM as sw,lKe as sx,qre as sy,tb as sz,ZQe as t,UWe as t$,Lt as t0,Tst as t1,mit as t2,hJe as t3,SK as t4,zQ as t5,qQ as t6,Bl as t7,pye as t8,iO as t9,EPe as tA,sYe as tB,E$e as tC,EMe as tD,Wle as tE,Ist as tF,Est as tG,Mst as tH,ZWe as tI,W$e as tJ,x_e as tK,cS as tL,hS as tM,pS as tN,uot as tO,oot as tP,LUe as tQ,qGe as tR,fF as tS,iKe as tT,tKe as tU,rKe as tV,DI as tW,lA as tX,pt as tY,Jse as tZ,F8e as t_,GQ as ta,a3 as tb,aC as tc,mye as td,jWe as te,ka as tf,T_e as tg,Cst as th,HGe as ti,hot as tj,E_e as tk,yot as tl,_7 as tm,Hie as tn,$p as to,Zwe as tp,eHe as tq,Tot as tr,Lb as ts,$ot as tt,To as tu,MUe as tv,ohe as tw,yye as tx,KZ as ty,mPe as tz,fne as u,AZe as u$,cit as u0,X7e as u1,Hn as u2,uit as u3,hit as u4,ql as u5,Lst as u6,lZe as u7,dZe as u8,B7e as u9,Vz as uA,sKe as uB,G1e as uC,xPe as uD,hye as uE,pPe as uF,kst as uG,vH as uH,aMe as uI,rPe as uJ,fH as uK,dH as uL,KH as uM,H9e as uN,W9e as uO,ece as uP,HG as uQ,YIe as uR,HXe as uS,Qtt as uT,Det as uU,Twe as uV,Ube as uW,_Ze as uX,pZe as uY,cZe as uZ,uHe as u_,eit as ua,zWe as ub,Uz as uc,VWe as ud,cot as ue,uJe as uf,jM as ug,zz as uh,iR as ui,Mue as uj,wce as uk,yHe as ul,W7e as um,fZe as un,EK as uo,fit as up,rye as uq,eye as ur,nKe as us,eKe as ut,VFe as uu,Ji as uv,Oet as uw,sPe as ux,dF as uy,NM as uz,yM as v,CZe as v0,tHe as v1,dde as v2,oZe as v3,oJe as v4,vZe as v5,hZe as v6,q0e as v7,iZe as v8,FOe as v9,_qe as vA,Pm as vB,rIe as vC,ZUe as vD,DHe as vE,$x as vF,cz as vG,BWe as vH,iM as vI,BZe as vJ,Km as vK,zae as vL,Xnt as vM,oA as vN,OP as vO,RO as vP,wit as vQ,lJe as vR,Ym as vS,cYe as vT,gYe as vU,bYe as vV,kTe as vW,ktt as vX,Wit as vY,NH as vZ,oKe as va,fse as vb,lv as vc,f2e as vd,Dbe as ve,X4 as vf,wee as vg,Fse as vh,Nse as vi,z2e as vj,Yqe as vk,Bue as vl,Kqe as vm,git as vn,MPe as vo,Iot as vp,aZe as vq,xZe as vr,_b as vs,gN as vt,nMe as vu,PWe as vv,mMe as vw,bit as vx,eue as vy,MHe as vz,vr as w,At as x,Qy as y,Ct as z};
