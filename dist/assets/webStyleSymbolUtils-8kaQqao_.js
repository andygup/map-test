import{$S as e,BT as t,Bd as n,Fr as r,Ih as i,Ir as a,Mr as o,Nr as s,Pr as c,Wr as l,gC as u,xd as d,yC as f,zd as p}from"./index-CzMixifc.js";import{n as m,t as h}from"./devEnvironmentUtils-BL8rxKsk.js";var g=[`web-gltf`,`web`,`cim`];function _(e,n,r){let i=e.name;return i==null?Promise.reject(new t(`symbolstyleutils:style-symbol-reference-name-missing`,`Missing name in style symbol reference`)):e.styleName===`Esri2DPointSymbolsStyle`?b(i,n,r):s(e,n,r).then(e=>y(e,i,n,a,r))}function v(e,t){return t.items.find(t=>t.name===e)}async function y(a,o,s,_,y){let b=s?.portal==null?i.getDefault():s.portal,x={portal:b,url:u(a.baseUrl)},S=v(o,a.data);if(!S)throw new t(`symbolstyleutils:symbol-name-not-found`,`The symbol name '${o}' could not be found`,{symbolName:o});let C=y?.acceptedFormats??g,w=_(S,C);if(!w)throw new t(`symbolstyleutils:symbol-reference-no-accepted-format`,`The symbol name '${o}' does not have an accepted format (one of ${C})`,{symbolName:o});let{url:T,format:E}=w,D=e(T,x),O=S.thumbnail?.href??null,k=S.thumbnail?.imageData;m()&&(D=h(D)??``,O=h(O));let A={portal:b,url:u(f(D)),origin:`portal-item`};return r(D,y).then(t=>{let r=E===`cim`?c(t.data):t.data,i=l(r,A);if(i&&d(i)){if(O){let t=e(O,x);i.thumbnail=new p({url:t})}else k&&(i.thumbnail=new p({url:`data:image/png;base64,${k}`}));a.styleUrl?i.styleOrigin=new n({portal:s.portal,styleUrl:a.styleUrl,name:o}):a.styleName&&(i.styleOrigin=new n({portal:s.portal,styleName:a.styleName,name:o}))}return i})}function b(e,t,n){let a=o.replaceAll(/\{SymbolName\}/gi,e),s=t.portal==null?i.getDefault():t.portal;return r(a,n).then(e=>{let t=c(e.data);return l(t,{portal:s,url:u(f(a)),origin:`portal-item`})})}export{_ as n,y as r,v as t};