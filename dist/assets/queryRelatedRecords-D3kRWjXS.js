import{TS as e,ZS as t}from"./index-BN8X5Ryz.js";import{t as n}from"./urlUtils-CW4cnJ3W.js";function r(t,n){let r=t.toJSON();return r.objectIds&&=r.objectIds.join(`,`),r.orderByFields&&=r.orderByFields.join(`,`),r.outFields&&!n?.returnCountOnly?r.outFields.includes(`*`)?r.outFields=`*`:r.outFields=r.outFields.join(`,`):delete r.outFields,r.outSR&&=e(r.outSR),r.dynamicDataSource&&(r.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r}async function i(e,t,n){let r=await o(e,t,n),i=r.data,a=i.geometryType,s=i.spatialReference,c={};for(let e of i.relatedRecordGroups){let t={fields:void 0,geometryType:a,spatialReference:s,hasZ:!!i.hasZ,hasM:!!i.hasM,features:e.relatedRecords};if(e.objectId!=null)c[e.objectId]=t;else for(let n of Object.keys(e))n!==`relatedRecords`&&(c[e[n]]=t)}return{...r,data:c}}async function a(e,t,n){let r=await o(e,t,n,{returnCountOnly:!0}),i=r.data,a={};for(let e of i.relatedRecordGroups)e.objectId!=null&&(a[e.objectId]=e.count);return{...r,data:a}}async function o(e,i,a={},o){let s=n({...e.query,f:`json`,...o,...r(i,o)});return t(e.path+`/queryRelatedRecords`,{...a,query:{...a.query,...s}})}export{r as n,i as r,a as t};