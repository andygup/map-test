import{$T as e,Fr as t,Ir as n,MC as r,Mr as i,Nr as a,Pr as o,Wr as s,Xd as c,Yd as l,fC as u,jd as d,kC as f,qh as p}from"./index-BN8X5Ryz.js";import{n as m,t as h}from"./devEnvironmentUtils-Yxtjm7qW.js";var g=[`web-gltf`,`web`,`cim`];function _(t,r,i){let o=t.name;return o==null?Promise.reject(new e(`symbolstyleutils:style-symbol-reference-name-missing`,`Missing name in style symbol reference`)):t.styleName===`Esri2DPointSymbolsStyle`?b(o,r,i):a(t,r,i).then(e=>y(e,o,r,n,i))}function v(e,t){return t.items.find(t=>t.name===e)}async function y(n,i,a,_,y){let b=a?.portal==null?p.getDefault():a.portal,x={portal:b,url:f(n.baseUrl)},S=v(i,n.data);if(!S)throw new e(`symbolstyleutils:symbol-name-not-found`,`The symbol name '${i}' could not be found`,{symbolName:i});let C=y?.acceptedFormats??g,w=_(S,C);if(!w)throw new e(`symbolstyleutils:symbol-reference-no-accepted-format`,`The symbol name '${i}' does not have an accepted format (one of ${C})`,{symbolName:i});let{url:T,format:E}=w,D=u(T,x),O=S.thumbnail?.href??null,k=S.thumbnail?.imageData;m()&&(D=h(D)??``,O=h(O));let A={portal:b,url:f(r(D)),origin:`portal-item`};return t(D,y).then(e=>{let t=E===`cim`?o(e.data):e.data,r=s(t,A);if(r&&d(r)){if(O){let e=u(O,x);r.thumbnail=new l({url:e})}else k&&(r.thumbnail=new l({url:`data:image/png;base64,${k}`}));n.styleUrl?r.styleOrigin=new c({portal:a.portal,styleUrl:n.styleUrl,name:i}):n.styleName&&(r.styleOrigin=new c({portal:a.portal,styleName:n.styleName,name:i}))}return r})}function b(e,n,a){let c=i.replaceAll(/\{SymbolName\}/gi,e),l=n.portal==null?p.getDefault():n.portal;return t(c,a).then(e=>{let t=o(e.data);return s(t,{portal:l,url:f(r(c)),origin:`portal-item`})})}export{_ as n,y as r,v as t};